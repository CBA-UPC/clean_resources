/*! For license information please see app-bundle-7b7c9f72694be0c1fe3f.js.LICENSE.txt */
!function(e){unction n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,r=1;r<n.length;r++)0!==o[n[r]]&&(i=!1);i&&(a.splice(t--,1),e=c(c.s=n[0]))}return 0===a.length&&(l.forEach((),l.length=0),e}var i={},r={135:0},o={135:0},a=[],l=[];function s(e){return c.p+""+({14:"officehome-async-styles",20:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~appbar~cc~cc-rc~copd-rc~draft-cnt~ew~72ec8b1c",25:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~appbar~cc~cc-rc~copd-rc~draft-cnt~ew~3cf7f8ec",26:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~appbar~cc~cc-rc~copd-rc~draft-cnt~ew~e17c2de3",27:"fluent~action-context-menu-rc~app-gallery-rc~appbar~cc~cc-rc~copd-rc~draft-cnt~ew-os~ew-rc~first-dra~0a00db43",29:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~cc~cc-rc~copd-rc~draft-cnt~ew-os~ew-~ee27e821",30:"fluent~action-context-menu-rc~app-gallery-rc~appbar~cc~cc-rc~copd-rc~draft-cnt~ew-os~ew-rc~first-dra~15bd2475",32:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~appbar-control-tilecontextmenu~comme~42c79b08",36:"fluent~cc~cc-rc~coh~coh-rc~ew-os~ew-rc~mc~qa~rec1-os~rec1-rc~upload-rc",40:"fluent~action-context-menu-rc~draft-cnt~ew-os~ew-rc~mc~qa~rec1-os~rec1-rc",41:"fluent~ew-os~ew-rc~fl-cnt~mc~qa~rec1-os~rec1-rc~upload-rc",48:"calendar~forms-group~mru~officeforms-group-forms~officeforms-my-forms~places",49:"fluent~ew-os~ew-rc~mc~qa~rec1-os~rec1-rc",53:"auto-suggest~bc~search-preload~search-results",54:"fluent~cc~cc-rc~coh~coh-rc",55:"fluent~ew-os~ew-rc~mc~qa",56:"vendors~app-create~coh-rc~start-page-simple-create~template-page-create-component",57:"vendors~auto-suggest~bc~search-preload~search-results",63:"fluent~draft-cnt~rec1-os~rec1-rc",64:"fluent~ew-os~ew-rc~mc",65:"vendors~appbar~task-dialog-rc~teaching-ui-rc",66:"vendors~edgeworth~input-dialog~wac-start",67:"vendors~mstart~start-page-rc~template-page-rc",68:"vendors~officeflonedssink~oteljs1ds~task-dialog-rc",78:"fl-cnt~share-control",79:"fluent~app-gallery-rc~appbar",80:"fluent~app-host-component~first-draft-component",81:"fluent~app-host-component~task-dialog-rc",82:"fluent~cc~cc-rc",83:"fluent~commercial-install-component~consumer-install-component",84:"fluent~draft-cnt~first-draft-component",85:"fluent~draft-cnt~first-run-rc",86:"fluent~first-run-rc~template-stage-component",87:"fluent~fl-cnt~template-stage-component",88:"fluent~flerrordialog~leap",89:"fluent~rec1-os~rec1-rc",90:"templates~wac-start",91:"vendors~appbar~feed-component",92:"vendors~appbar~toast-container-rc",93:"vendors~coh~coh-rc",94:"vendors~commercial-install-component~consumer-install-component",95:"vendors~flerrordialog~leap",96:"vendors~search-page-bootstrapper~search-results",97:"vendors~sharecallout~sharedialog",98:"wac-cnt",133:"action-context-menu-rc",134:"announcement",136:"app-gallery-ag",137:"app-gallery-rc",138:"app-gallery-wrapper",139:"app-header",140:"app-host-component",141:"appbar",142:"appbar-control-flyoutbuttonbadge",143:"appbar-control-flyoutsearchresults",144:"appbar-control-lazydndcontext",145:"appbar-control-quickaccesstile",146:"appbar-control-tilecontextmenu",147:"ashautils",148:"auto-suggest",149:"banner",150:"bc",151:"calendar",152:"cc",153:"cc-rc",154:"cc-wrapper",155:"cnt-actions-helper",156:"coh",157:"coh-rc",158:"coh-wrapper",159:"commercial-install-component",160:"confirmation-dialog-rc",161:"consumer-install-component",162:"context-menu",163:"copd-rc",164:"create-links-control-icns",165:"create-menu",166:"createnewmodule",167:"default-tdp",168:"draft-cnt",169:"edgeworth",170:"edgeworth-trie-webworker",171:"edgeworth-worker",172:"error-dialog",173:"error-dialog-rc",174:"ew-os",175:"ew-rc",176:"fb-theme",177:"feature-callout",178:"feature-tooltip-container",179:"feed",180:"feedback",181:"first-run",182:"first-run-rc",183:"first-run-wrapper",184:"fl-cnt",185:"fl-unsupported-page",186:"flcontainerstrings0",187:"flcontainerstrings1",188:"flcontainerstrings10",189:"flcontainerstrings11",190:"flcontainerstrings12",191:"flcontainerstrings13",192:"flcontainerstrings14",193:"flcontainerstrings15",194:"flcontainerstrings16",195:"flcontainerstrings17",196:"flcontainerstrings18",197:"flcontainerstrings19",198:"flcontainerstrings2",199:"flcontainerstrings20",200:"flcontainerstrings21",201:"flcontainerstrings22",202:"flcontainerstrings23",203:"flcontainerstrings24",204:"flcontainerstrings25",205:"flcontainerstrings26",206:"flcontainerstrings27",207:"flcontainerstrings28",208:"flcontainerstrings29",209:"flcontainerstrings3",210:"flcontainerstrings30",211:"flcontainerstrings31",212:"flcontainerstrings32",213:"flcontainerstrings33",214:"flcontainerstrings34",215:"flcontainerstrings35",216:"flcontainerstrings36",217:"flcontainerstrings37",218:"flcontainerstrings38",219:"flcontainerstrings39",220:"flcontainerstrings4",221:"flcontainerstrings40",222:"flcontainerstrings41",223:"flcontainerstrings42",224:"flcontainerstrings43",225:"flcontainerstrings44",226:"flcontainerstrings45",227:"flcontainerstrings46",228:"flcontainerstrings47",229:"flcontainerstrings48",230:"flcontainerstrings49",231:"flcontainerstrings5",232:"flcontainerstrings50",233:"flcontainerstrings51",234:"flcontainerstrings52",235:"flcontainerstrings53",236:"flcontainerstrings54",237:"flcontainerstrings55",238:"flcontainerstrings56",239:"flcontainerstrings57",240:"flcontainerstrings58",241:"flcontainerstrings59",242:"flcontainerstrings6",243:"flcontainerstrings60",244:"flcontainerstrings61",245:"flcontainerstrings62",246:"flcontainerstrings63",247:"flcontainerstrings64",248:"flcontainerstrings65",249:"flcontainerstrings66",250:"flcontainerstrings67",251:"flcontainerstrings68",252:"flcontainerstrings69",253:"flcontainerstrings7",254:"flcontainerstrings70",255:"flcontainerstrings71",256:"flcontainerstrings72",257:"flcontainerstrings73",258:"flcontainerstrings74",259:"flcontainerstrings75",260:"flcontainerstrings76",261:"flcontainerstrings77",262:"flcontainerstrings78",263:"flcontainerstrings79",264:"flcontainerstrings8",265:"flcontainerstrings80",266:"flcontainerstrings81",267:"flcontainerstrings82",268:"flcontainerstrings83",269:"flcontainerstrings84",270:"flcontainerstrings85",271:"flcontainerstrings9",272:"flframework-hashfallback",273:"floating-action-button",274:"fluent-theme-provider",275:"fluent~action-context-menu-rc",276:"fluent~announcement",277:"fluent~app-gallery-rc",278:"fluent~app-host-component",279:"fluent~appbar",280:"fluent~appbar-control-lazyflyout",281:"fluent~confirmation-dialog-rc",282:"fluent~copd-rc",283:"fluent~draft-cnt",284:"fluent~error-dialog-rc",285:"fluent~first-draft-component",286:"fluent~fl-cnt",287:"fluent~flerrordialog",288:"fluent~floating-action-button",289:"fluent~iwc",290:"fluent~learning-shelf-rc",291:"fluent~left-nav-rc",292:"fluent~mc",293:"fluent~menu-view-service",294:"fluent~onenote-ip-dialog",295:"fluent~task-dialog-rc",296:"fluent~template-page-create-component",297:"fluent~template-stage-component",298:"fluent~toast-container-rc",299:"fluent~upload-rc",300:"fluent~wb-rc",301:"forms-group",302:"home",303:"hostdefaultsstrings0",304:"hostdefaultsstrings1",305:"hostdefaultsstrings10",306:"hostdefaultsstrings11",307:"hostdefaultsstrings12",308:"hostdefaultsstrings13",309:"hostdefaultsstrings14",310:"hostdefaultsstrings15",311:"hostdefaultsstrings16",312:"hostdefaultsstrings17",313:"hostdefaultsstrings18",314:"hostdefaultsstrings19",315:"hostdefaultsstrings2",316:"hostdefaultsstrings20",317:"hostdefaultsstrings21",318:"hostdefaultsstrings22",319:"hostdefaultsstrings23",320:"hostdefaultsstrings24",321:"hostdefaultsstrings25",322:"hostdefaultsstrings26",323:"hostdefaultsstrings27",324:"hostdefaultsstrings28",325:"hostdefaultsstrings29",326:"hostdefaultsstrings3",327:"hostdefaultsstrings30",328:"hostdefaultsstrings31",329:"hostdefaultsstrings32",330:"hostdefaultsstrings33",331:"hostdefaultsstrings34",332:"hostdefaultsstrings35",333:"hostdefaultsstrings36",334:"hostdefaultsstrings37",335:"hostdefaultsstrings38",336:"hostdefaultsstrings39",337:"hostdefaultsstrings4",338:"hostdefaultsstrings40",339:"hostdefaultsstrings41",340:"hostdefaultsstrings42",341:"hostdefaultsstrings43",342:"hostdefaultsstrings44",343:"hostdefaultsstrings45",344:"hostdefaultsstrings46",345:"hostdefaultsstrings47",346:"hostdefaultsstrings48",347:"hostdefaultsstrings49",348:"hostdefaultsstrings5",349:"hostdefaultsstrings50",350:"hostdefaultsstrings51",351:"hostdefaultsstrings52",352:"hostdefaultsstrings53",353:"hostdefaultsstrings54",354:"hostdefaultsstrings55",355:"hostdefaultsstrings56",356:"hostdefaultsstrings57",357:"hostdefaultsstrings58",358:"hostdefaultsstrings59",359:"hostdefaultsstrings6",360:"hostdefaultsstrings60",361:"hostdefaultsstrings61",362:"hostdefaultsstrings62",363:"hostdefaultsstrings63",364:"hostdefaultsstrings64",365:"hostdefaultsstrings65",366:"hostdefaultsstrings66",367:"hostdefaultsstrings67",368:"hostdefaultsstrings68",369:"hostdefaultsstrings69",370:"hostdefaultsstrings7",371:"hostdefaultsstrings70",372:"hostdefaultsstrings71",373:"hostdefaultsstrings72",374:"hostdefaultsstrings73",375:"hostdefaultsstrings74",376:"hostdefaultsstrings75",377:"hostdefaultsstrings76",378:"hostdefaultsstrings77",379:"hostdefaultsstrings78",380:"hostdefaultsstrings79",381:"hostdefaultsstrings8",382:"hostdefaultsstrings80",383:"hostdefaultsstrings81",384:"hostdefaultsstrings82",385:"hostdefaultsstrings83",386:"hostdefaultsstrings84",387:"hostdefaultsstrings85",388:"hostdefaultsstrings9",389:"hostuxstrings0",390:"hostuxstrings1",391:"hostuxstrings10",392:"hostuxstrings11",393:"hostuxstrings12",394:"hostuxstrings13",395:"hostuxstrings14",396:"hostuxstrings15",397:"hostuxstrings16",398:"hostuxstrings17",399:"hostuxstrings18",400:"hostuxstrings19",401:"hostuxstrings2",402:"hostuxstrings20",403:"hostuxstrings21",404:"hostuxstrings22",405:"hostuxstrings23",406:"hostuxstrings24",407:"hostuxstrings25",408:"hostuxstrings26",409:"hostuxstrings27",410:"hostuxstrings28",411:"hostuxstrings29",412:"hostuxstrings3",413:"hostuxstrings30",414:"hostuxstrings31",415:"hostuxstrings32",416:"hostuxstrings33",417:"hostuxstrings34",418:"hostuxstrings35",419:"hostuxstrings36",420:"hostuxstrings37",421:"hostuxstrings38",422:"hostuxstrings39",423:"hostuxstrings4",424:"hostuxstrings40",425:"hostuxstrings41",426:"hostuxstrings42",427:"hostuxstrings43",428:"hostuxstrings44",429:"hostuxstrings45",430:"hostuxstrings46",431:"hostuxstrings47",432:"hostuxstrings48",433:"hostuxstrings49",434:"hostuxstrings5",435:"hostuxstrings50",436:"hostuxstrings51",437:"hostuxstrings52",438:"hostuxstrings53",439:"hostuxstrings54",440:"hostuxstrings55",441:"hostuxstrings56",442:"hostuxstrings57",443:"hostuxstrings58",444:"hostuxstrings59",445:"hostuxstrings6",446:"hostuxstrings60",447:"hostuxstrings61",448:"hostuxstrings62",449:"hostuxstrings63",450:"hostuxstrings64",451:"hostuxstrings65",452:"hostuxstrings66",453:"hostuxstrings67",454:"hostuxstrings68",455:"hostuxstrings69",456:"hostuxstrings7",457:"hostuxstrings70",458:"hostuxstrings71",459:"hostuxstrings72",460:"hostuxstrings73",461:"hostuxstrings74",462:"hostuxstrings75",463:"hostuxstrings76",464:"hostuxstrings77",465:"hostuxstrings78",466:"hostuxstrings79",467:"hostuxstrings8",468:"hostuxstrings80",469:"hostuxstrings81",470:"hostuxstrings82",471:"hostuxstrings83",472:"hostuxstrings84",473:"hostuxstrings85",474:"hostuxstrings9",475:"hwalaunchurl",476:"informationprotectionstrings0",477:"informationprotectionstrings1",478:"informationprotectionstrings10",479:"informationprotectionstrings11",480:"informationprotectionstrings12",481:"informationprotectionstrings13",482:"informationprotectionstrings14",483:"informationprotectionstrings15",484:"informationprotectionstrings16",485:"informationprotectionstrings17",486:"informationprotectionstrings18",487:"informationprotectionstrings19",488:"informationprotectionstrings2",489:"informationprotectionstrings20",490:"informationprotectionstrings21",491:"informationprotectionstrings22",492:"informationprotectionstrings23",493:"informationprotectionstrings24",494:"informationprotectionstrings25",495:"informationprotectionstrings26",496:"informationprotectionstrings27",497:"informationprotectionstrings28",498:"informationprotectionstrings29",499:"informationprotectionstrings3",500:"informationprotectionstrings30",501:"informationprotectionstrings31",502:"informationprotectionstrings32",503:"informationprotectionstrings33",504:"informationprotectionstrings34",505:"informationprotectionstrings35",506:"informationprotectionstrings36",507:"informationprotectionstrings37",508:"informationprotectionstrings38",509:"informationprotectionstrings39",510:"informationprotectionstrings4",511:"informationprotectionstrings40",512:"informationprotectionstrings41",513:"informationprotectionstrings42",514:"informationprotectionstrings43",515:"informationprotectionstrings44",516:"informationprotectionstrings45",517:"informationprotectionstrings46",518:"informationprotectionstrings47",519:"informationprotectionstrings48",520:"informationprotectionstrings49",521:"informationprotectionstrings5",522:"informationprotectionstrings50",523:"informationprotectionstrings51",524:"informationprotectionstrings52",525:"informationprotectionstrings53",526:"informationprotectionstrings54",527:"informationprotectionstrings55",528:"informationprotectionstrings56",529:"informationprotectionstrings57",530:"informationprotectionstrings58",531:"informationprotectionstrings59",532:"informationprotectionstrings6",533:"informationprotectionstrings60",534:"informationprotectionstrings61",535:"informationprotectionstrings62",536:"informationprotectionstrings63",537:"informationprotectionstrings64",538:"informationprotectionstrings65",539:"informationprotectionstrings66",540:"informationprotectionstrings67",541:"informationprotectionstrings68",542:"informationprotectionstrings69",543:"informationprotectionstrings7",544:"informationprotectionstrings70",545:"informationprotectionstrings71",546:"informationprotectionstrings72",547:"informationprotectionstrings73",548:"informationprotectionstrings74",549:"informationprotectionstrings75",550:"informationprotectionstrings76",551:"informationprotectionstrings77",552:"informationprotectionstrings78",553:"informationprotectionstrings79",554:"informationprotectionstrings8",555:"informationprotectionstrings80",556:"informationprotectionstrings81",557:"informationprotectionstrings82",558:"informationprotectionstrings83",559:"informationprotectionstrings84",560:"informationprotectionstrings85",561:"informationprotectionstrings9",562:"initialize-fluent-theme",563:"input-dialog",564:"install",565:"install-rc",566:"install-wizard",567:"install-wrapper",568:"instrumentation-service",569:"learning-home-dataprovider",570:"learning-shelf-card",571:"learning-shelf-rc",572:"learning-word-dataprovider",573:"left-nav-rc",574:"m365-apps",575:"mc",576:"mobile-app-banner",577:"move-to-folder-control",578:"mru",579:"mstart",580:"new-consumer-experience",581:"new-user-shelf",582:"northstar-prefetch-service",583:"odsp-start-onedrive",584:"odsp-start-sharepoint",585:"office-theme",586:"officeflonedssink",587:"officeforms-group-forms",588:"officeforms-my-forms",589:"oteljs1ds",590:"places",592:"portal-preload",593:"previewlabelcallout",594:"qa",595:"rec1-os",596:"rec1-rc",597:"renderdiscovermenu",598:"search-preload",599:"search-results",600:"semb",601:"share-control",602:"sharecallout",603:"sharedialog",604:"side-popup-menu",605:"skip-to-main",606:"start-page-rc",607:"start-page-simple-create",608:"start-page-wrapper",609:"summarymodule",610:"support-central-rc",611:"task-dialog-rc",612:"teaching-ui-rc",613:"template-page-create-component",614:"template-page-rc",615:"template-stage-component",616:"templates",617:"templates-page-wrapper",618:"text-encoder-lite",619:"toast-container-rc",620:"upload-button",621:"upload-dialog",622:"upload-rc",623:"user-settings-control",625:"vendors~action-context-menu-rc",626:"vendors~announcement",627:"vendors~app-create",628:"vendors~appbar-control-lazyflyout",629:"vendors~appbar-control-suggestedapptile",630:"vendors~cnt-actions-helper",631:"vendors~coh-rc",632:"vendors~commercial-install-component",633:"vendors~confirmation-dialog-rc",634:"vendors~consumer-install-component",635:"vendors~copd-rc",636:"vendors~custom-tdp",637:"vendors~data-prefetch-service",638:"vendors~edgeworth",639:"vendors~enterprise-tdp",640:"vendors~error-dialog-rc",641:"vendors~feed",642:"vendors~feed-component",643:"vendors~first-draft-component",644:"vendors~first-run-rc",645:"vendors~fl-cnt",646:"vendors~fl-debugger",647:"vendors~flerrordialog",648:"vendors~floating-action-button",649:"vendors~hwalaunchfile",650:"vendors~install-rc",651:"vendors~iwc",652:"vendors~learning-iris-dataprovider",653:"vendors~learning-shelf-rc",654:"vendors~left-nav-rc",655:"vendors~m365-apps",656:"vendors~menu-view-service",657:"vendors~midgard-bootstrapper",658:"vendors~onenote-ip-dialog",659:"vendors~renderdiscovermenu",660:"vendors~rf-dataprovider",661:"vendors~search-page-bootstrapper",662:"vendors~search-preload",663:"vendors~sharepointnotificationservice",664:"vendors~skip-to-main",665:"vendors~socketmodule",666:"vendors~support-central-rc",667:"vendors~task-dialog-rc",668:"vendors~teaching-ui-rc",669:"vendors~teamsservicefile",670:"vendors~toast-container-rc",671:"vendors~visual-background-rc",672:"vendors~vroom-service",673:"vendors~wb-rc",674:"visual-background-rc",675:"wac-start",676:"wb-rc",677:"web-vitals",678:"workspace-nav"}[e]||e)+"."+{0:"a16c74be2d08a5a14127",1:"f90162e64b0d153998d2",2:"11452b39a1d39088d111",3:"4d6f98eef5f252a49db4",4:"5a5a7ab7c6b58906aef5",5:"cf4db54f8057c7d680e2",6:"f4d7747e062046bdcfb6",7:"9ca205769bcc0701b8ef",8:"db02a476049e0f3a6ce5",9:"537d6063e3603b8fdc6f",10:"00bf3556d7a0aaca3bf7",11:"6a8622bc6f0526d0a172",12:"1c62d400679b332074bc",13:"062dd927111473156b06",14:"d0ec923b788ec406dfd5",15:"74ee2aaf4fa8452e7c59",16:"c1c8de78c011649846e4",17:"07c9d963ed01f15d1423",18:"144847fd72bc8e3f4ef5",19:"e4b98028590a8529810c",20:"b88ac6f1a891b69c1344",21:"ca9eef156a4203287a29",22:"693bf046c556481dc7f7",23:"fe5aef4dee4f88499177",24:"4416190289f787a0dba6",25:"76a24b7367467ac6b118",26:"b51f2ac739dc424b5e31",27:"f4eea2a7362f0b8f885f",28:"c517e032fb361169e258",29:"eb15679206a15ce5a525",30:"7a5d6620ab16d158d3f4",31:"c2c105f6256cbea0c6f2",32:"10f340380ed73a648c3d",33:"4f14b594fd75f39d0910",34:"dce6b0a252596b472562",35:"36a02c57545c04103823",36:"914397497893f8904288",37:"c11591a73b7be776ab7d",38:"b642e7f2968bccdde95e",39:"bff94b1aea5cdbe79709",40:"68fb4db4eca80e0113a4",41:"08f80870b811e54a5b05",42:"4c216100ab15a537319c",43:"5f17249073b90f1a3e84",44:"2fea2be0aeedd9472084",45:"eaf8e0fa967deca0e51f",46:"41c7ecb5a774a7119bc5",47:"1cd7cbfa6bbfbe9a7807",48:"474ba2934710ada5df54",49:"27f5b2762ac4a33859c4",50:"ce2f872b4e41308ff6a3",51:"a730c70c9c0e048527a2",52:"640e1721d5834af74561",53:"c43ff2e1cb9529a099a6",54:"ee024d9070926297e1cc",55:"649e255fcf454c380864",56:"5184f31bb7d47a5e7d95",57:"795fb00a9576e3ceaa45",58:"86234452b95cf565688b",59:"4c60797957c3b0e5159c",60:"8f8c241223209c3f3edd",61:"54052887927befa26c17",62:"8420f585f2266cde72a9",63:"63c24b94cfeedb92630f",64:"6b06c23fcb5efa8ad857",65:"8aa9c94ae5fe7f5ebd2f",66:"51e496b63b1e32a44ef9",67:"a166dfe46d34f84b3bff",68:"5d81f14146df6e6adfec",69:"247d42ae5a2d32706ab3",70:"c89ceea8e10a4e5ccfe3",71:"6049d126ba77f679e708",72:"836050783b189c5af0fc",73:"b498a3950a6706d1062b",74:"32e925de9ef8726dc8ba",75:"e7186abb9e7e08fd655f",76:"f89d17908bd134b2d353",77:"5cf20ccb6ba5b349d448",78:"e0d38b7a71eb27d78fd0",79:"be682ded7ff4c892f8ae",80:"dbee656a1e4735a69d11",81:"cfdf56b1094be2d416df",82:"742bca43965e2a83b5ec",83:"cd4bcda84fd05e36e6c3",84:"52db34df3014f4bffc11",85:"cf9827b9728d1d322fd6",86:"538afd4e8ffe3015cb1e",87:"f00c165505a2826a64e3",88:"91c98596be50b53a8ff4",89:"fa6fc46a5516aa91db8a",90:"bc8eb6593394d18d8434",91:"345d57a295f574cec161",92:"1ad6a0111e38117eaf3b",93:"a2c854968668c169b96c",94:"18afef1158e7abf878f4",95:"b0d9394edd94e1a953ec",96:"5fcdd7d88c62c322a9b8",97:"b5a6088e3157778ad4c4",98:"383996290d262f409be7",99:"89c0517c4b64a5342969",100:"9ced3756b894f4725852",101:"76bb803617356c57ec1e",102:"d52b2f0a4a668f1db07e",103:"f07237a216929546a12c",104:"7e1d3bcca1b214718b06",105:"d5e8da9c70009c05d740",106:"67ab21c0bf2e5951dfba",107:"2097bce6338a877f416a",108:"a3ec8ababd050639778c",109:"c0e41a6acbf2ef3f6bd4",110:"a4826d789dc16a4f3441",111:"92dd2dd708483affe126",112:"d08f9b6725300938433b",113:"d9bd2b1814a97abac542",114:"ae8d8a170509cfabc442",115:"7f92eefc45db6b6dba92",116:"fe2b18473138d8620f6a",117:"cdc44d259bdc63563c30",118:"65f8e2cd718b66c71713",119:"763da243589115b7a0a9",120:"e44d40b4d6e69361096f",121:"003eff78766491d6485d",122:"066b3263052ec05cd9ec",123:"b92f2a84c42bb18714ba",124:"15ba86b4e4ab7bbb7e45",125:"82500fa0c7a88f6790b6",126:"5ba371a990116453a38c",127:"c9c7fb8df3b3e4d9c06f",128:"041117113856fae0f1b4",129:"0fb829ad8e337f4938a9",130:"64b6d9fdc0cc4f566b49",131:"e8496b8d24f48422d6aa",132:"19cb599f456ef19aa17b",133:"f4d3fb1f25c2109b1dd7",134:"0784d3c716794ba14934",136:"8ecd9a6b0fc0526af479",137:"176f0749b2d72214c630",138:"94792062434d77ebd9cb",139:"6b4590fd34cd4cb0a9a9",140:"680aa76da5ee54247693",141:"3910db2aa42b50a8e58f",142:"01671be827cd0eafa4c2",143:"e8f91600e545a8e26574",144:"be225658ecd2593b6fb4",145:"79cd2a80e966423804de",146:"b248bce13081a1558c14",147:"55bae14b9cffd7b4a4b7",148:"a508a3f798a516bb4bda",149:"a5359d7cbf754771673d",150:"24a7cce8cb3085d342e1",151:"c605fbb443f7655db73d",152:"03a1318244be3ed1f20c",153:"a0ac90df3c238e1a9951",154:"1d1da0b89af19f6b5f5e",155:"d05e9110b10708187a29",156:"c0afb35579afe1f74a1a",157:"99c6160c63500cb543c7",158:"1fa3c815b91434df594a",159:"e0fe3ac5745c907df1c8",160:"714029b186363a0520c5",161:"e1c58626591a255ff969",162:"b32b6bc9a8fdbe0ff524",163:"b96b34232f59cd8d5f70",164:"515c899886aeef0ffdb7",165:"0e46fdf591730413c4f9",166:"6a15c1c767aed26bcf31",167:"7cf4ceff459aa63c259f",168:"8c4dea44822858312b52",169:"2915dede66c7f6d99a87",170:"dad43fcee31fb8828d82",171:"e827fcc7e0f07cd9b05d",172:"e7e1a6e1a8c89da3fcd0",173:"f2b3ce83ab82f493ad6a",174:"78dd415cad9cd9c6f658",175:"e90add54be95cbdbc4ac",176:"56d50d922c09aa8876df",177:"97cef4129b44c10c469e",178:"1e3784d9d993d0135918",179:"f40954857c4e307d1b67",180:"e82b42cc9b75c6386d4a",181:"78b0451829c30e692763",182:"580461e1730dfd2366ef",183:"4cd13fcbfba3a8d35a55",184:"4091dd2fa1562aaa7774",185:"4111f14c7641ea7259e8",186:"1038de9df6c145fa79f1",187:"b16f6a9be592708ff8e2",188:"733c1c788c9ab59e696c",189:"02e1393cf869dbc551c3",190:"997b7e96dc0e1530a8e7",191:"4ae3a0881f59648f07ad",192:"80fb499c0e3ec35e97c1",193:"c5c9ba83fd1960dc7117",194:"84d8eece0a70dc3ed70d",195:"f5830e8fc72b1a13b025",196:"3d25ab16994d75b01552",197:"cbe35d6a04e0af5a2977",198:"0bff614d0b39f45d5fd7",199:"7cb646c7afdbdf100cb4",200:"5f188ab537af18a40435",201:"1cbd1e82f12b4fd7573a",202:"6cbd891d83856c7cd5bd",203:"89e1ffa4b03f480008f6",204:"44f14ac042d4146dbaaf",205:"7fe9a5034056ed4d0149",206:"5594cf43f9cead6036d0",207:"a913d6ba21d32406cb40",208:"450e600ebff3efeb9390",209:"008d91031c552cf092dc",210:"e79dea05d2a564833972",211:"61c89f9d24a6417e4aa8",212:"ead12ee1e33b6a757427",213:"706d1d6c7bf0073c3ea2",214:"b8d68d8403dbf1e3f49f",215:"73c3b97940f38f7fc8d3",216:"ea60a8b4e178ccc9178a",217:"abb48e18aa773d19d938",218:"56344e2d15f06bcd2196",219:"bf52d694b6c8f6a2e222",220:"ddd56e5da8b593d20632",221:"bc5e755fb587c5da19c9",222:"3e29e8fb005c86fbbd3e",223:"71b7d0a48e541b469a26",224:"995b4f149f0d78078f36",225:"d387e4d4516b9eee3047",226:"97284f7d230f3a17d9df",227:"4ee57085360992699ff4",228:"372e379180286594a3c9",229:"fb87cd2256285070d0dd",230:"59201c5177ed4d1d865a",231:"901f4491b72fffb95c41",232:"ec0b350f534994034239",233:"379bc8f30eb5114e9f10",234:"d00ef8692c979fb99448",235:"930b9fd5c688cd2999de",236:"02600ac26de180ff1168",237:"bff5c839eca6227de3f9",238:"3cc9754b3d76d8548b89",239:"e9cbab36cdb827515bbd",240:"5715a503e99f55886de5",241:"34a349f68067e7a95d6a",242:"7a5780ae44ec4bbfc35d",243:"4ddec7b4a65d8b12121a",244:"c0bc00c6d423651c8f5a",245:"d741793c3c05fb37f006",246:"eea2e674ea83d09ecef1",247:"7f9523790ed28fbf92cd",248:"cde33f8f355f7869e3be",249:"f68c99a1fa5cabae2826",250:"70d0035c1ceff242297c",251:"9a6874852396a8e9c98e",252:"c5620b4f8f59325da85a",253:"7ccb8f07e71a3a3c25c6",254:"0fe98e8e093714a160cf",255:"67b1d7f5c1a21f630f99",256:"5dcf07d29a12cadd58f6",257:"3c36bda86e8917ac8eb1",258:"ceb65354fc81231c05e9",259:"00b53088eeadad31c8c0",260:"edd9f1283b3a75e62abd",261:"568d5f2cd2b0411e5b3a",262:"2b1959c79af648e35688",263:"de9716b39cdb72aa0fd7",264:"ad50d0574f4127ef4518",265:"11f9fc33f3930c020cba",266:"4e86aca49862523a0dc2",267:"d52524662a64b43a63ee",268:"37672dc550ec2b6882d3",269:"41012e6a2ff13e11fa23",270:"9b043be318c3c7bfc1ca",271:"6c4a4fc10b3bd75e08e1",272:"86968bd3a069855a7ff1",273:"a65446cf971426daed3f",274:"1a99b98c1fa89d23e2bc",275:"082a6b3fbdd24d59fa3a",276:"178a26129cfc6ed0c007",277:"e1116ace1bfc4cf2290c",278:"f18f291161d47a89cbe8",279:"f59eaf2beb88a7bf9d82",280:"8b51569f57a023d48b98",281:"ea132c2a7eef7300150a",282:"4c508f89b2f4470c8e7f",283:"ef37ae237af27156b39b",284:"0854db9c05696777a4fc",285:"e110826890c39a307d4f",286:"398f5fe44b1d0bb3c7e6",287:"43abcefda3608910d1ee",288:"95c5bd2d15a72ef22a29",289:"7e48234d02894a08d389",290:"719b3a1f27c6868ac464",291:"d9172a14b042b9472108",292:"e2ff2992cfc70f65bb84",293:"ae05cfe2b858366090c4",294:"48a546a053c2f660e236",295:"3c33b2947a98d136d64c",296:"dbae04a0c309bf941a20",297:"3e4e45c3013508f57354",298:"65e4b67afca58a8bb314",299:"ab698282753d7b5008a1",300:"9db45cf31cefc6582fca",301:"c761b40ef3a0c92c0b0d",302:"613883a477a4d1eabf8b",303:"5057848e4343e7eaf371",304:"34287e2cafc11feb06da",305:"2cbaf1ff4d69f47c2dd5",306:"96166b0ff009e52704f0",307:"7a93dcc2b3737147347b",308:"f14108877de18d2e4261",309:"e6bbf2bd9c04e7403a8f",310:"9098d2084cafa7d6631e",311:"e919b5ec25d9644938a3",312:"d8ecbd310e6ab1f90113",313:"419ecf7aa86e2b56f0dd",314:"3a15e0644777884c4565",315:"35d6daf7006ec05c65ba",316:"a83fdcad0c7fa86affd6",317:"bcbad0872165b6f0e54d",318:"a804fc257de4c3286e26",319:"8f286158d07db0c6ef82",320:"f4132283db1b5771639d",321:"fdbb7325527145f87712",322:"751e9f4c8b3ce995471e",323:"0a3aef996e6aeb46cf41",324:"080ffefc9a077e023013",325:"0d4b1eeb66d2dd658371",326:"fcf995d9d34e82ea2072",327:"3125f5b1a44efb772628",328:"751f4db25ee83fec3877",329:"9d87572ae6569a06cf26",330:"603ee735a7091907966d",331:"a2843ffd29d85c4ee402",332:"a9fb9b58291eeec68570",333:"5dcc902f6719b3a588bb",334:"9a6118aab972cd1ece18",335:"e678f98679dfaa50c66b",336:"0f31277fa2a3dd18e01f",337:"6a0fd1954ada6a07eeb5",338:"fbfdbbff412a43bc9a02",339:"1ace16a6594b678b2dda",340:"90b09ab5fb86f7e33a44",341:"0f420f4cfffea4b1b6d4",342:"5057006e931c882c1021",343:"0f787116bf6fa576c289",344:"1a03bfecfa98b3e1e67e",345:"60f593ccb41c90b058ec",346:"d00f2ab4c190c8c7a402",347:"ba9bbb1c01de3eb7e640",348:"0fe86e7ba1c8c1e6a46e",349:"101b96d2fe59faa33d61",350:"606fdd96329dea1527f1",351:"c79292322cbaa78ae869",352:"82f34b3f4e8b0415d4c0",353:"fadf9fad415eb74e8d46",354:"aea4e0a3b31a27171c18",355:"354007327295e83e290a",356:"9dfe29e1668cb5f95972",357:"72ea637e40aa3eb1ceac",358:"21458b0cda05e3e734e2",359:"0a63cd8db184e87222df",360:"5545caec009a3c5aed4a",361:"673575fd34f49ef500b1",362:"ab8c841cd2959387d2e0",363:"637033d11373e853b7f1",364:"aa8741b1e04749b44e2c",365:"57ea22a281bff128a046",366:"3dac89a48fc99894ef6d",367:"f6f14600ac5e83b24d14",368:"df012ae932a47d48256e",369:"4c92cb59941018cd0147",370:"00f4f9759e5527052f1b",371:"fde1a264bb928e6afcac",372:"a3c68ebf12050386be68",373:"6688d4a3f4e87995d473",374:"6affe49d228344348122",375:"6fd5c0d004508a52690c",376:"d504af6c449ca760f26a",377:"87195359ce7623b0d8ad",378:"80cf775c884b6da6bb75",379:"21dbd5bc1722f2129299",380:"3cec969fcf8008472067",381:"c739b8aeb00f634baa67",382:"bdaae04072c8b4a69e47",383:"876a81a5f989a9759808",384:"21f06c56656febf3a4a5",385:"b655a2624f024badfe98",386:"a5d881892679793510a5",387:"bf918867c2403d71c0b9",388:"c7001d084e3f20ddd299",389:"4f773fb7fc1caea7cb8f",390:"dbc4b084783af564d3ce",391:"f8f72a257e1c66f0699f",392:"cb977453b5eebcbcbf6f",393:"8a44bdcff62b74bf8bb1",394:"eaea18cdf286a42c2918",395:"60527955ae68fba0fcd0",396:"0e2a7519d7f360d6dc62",397:"fbd6557d9140e6697dcd",398:"055f07bfefe051970081",399:"dfb024da7fe14c55b50c",400:"2b42375391fd31e9575c",401:"8400d70987f72eea06a2",402:"6b23f811909518f19386",403:"2ee3129bc9ca99f31796",404:"db2df0c25ec84d5232d9",405:"c56acd778b95d1d07195",406:"25e53d59823ad2433d04",407:"db37318d349a91268745",408:"9dffd6b711622f103f6c",409:"83c89fc6443571db31ff",410:"d1c407cb69993c2a3131",411:"d7aebfb40e6cc21fc00f",412:"cde216a369ce6d0bd8e1",413:"167f900b31f1661e10de",414:"e1fa5c0272c5f93c9b77",415:"cd7dd5a466b79652cd1b",416:"0b989bab94558293984a",417:"92eda0919fc122c273bc",418:"f88191cde44f2d87e8c9",419:"3b3557722c5de6355790",420:"62c0cef38aaaa9cdb7a5",421:"a373ff65af36393750e4",422:"4bc768159f5e7f593371",423:"9939df8d641c08afd605",424:"1ca3e35ba76addac1d67",425:"d5aad5d49e56f9114f0d",426:"fd0b86625c772b89d99f",427:"d3a3daf7d6f354611dbb",428:"b9b8c3081702b6fa70dc",429:"dd9f96e1c8ff8629d56c",430:"efb595df4665cd0b06ca",431:"a4da0df620c9ef203763",432:"731486bf99093c39d0d9",433:"d3dcf23c161409bd1281",434:"08059c2856270ad161fb",435:"eb27a8fad795ced26d4c",436:"9b82bfa9c659c1996829",437:"0581da200a2701ad60c1",438:"c7c6416a86ad3f860794",439:"b4eb798ea697f1e910d9",440:"43de0524aaf3f8ffffe3",441:"800a09378dde99311eb8",442:"eaf9ef558cf7010c43b3",443:"0a0e378ac477b7a03c5e",444:"1fdb83e330e12a20ca0c",445:"ecd11732c9ac0773d29f",446:"bc2732a86ccb8025b457",447:"17dc5a229ee2357d2a0f",448:"0caacfb2eae760fba0e5",449:"dada484fae111c587673",450:"09fc4e6b257c0e913c79",451:"ad0257c35e8b8e961ceb",452:"51b91496ca9b3c025664",453:"3bb18d6452f1480e9bdd",454:"782af494bcc663d15ea4",455:"80b966eb338ca10d6177",456:"6d3aa24edfff9fced824",457:"171a7b4fe1395a3f4552",458:"79558816444f1564aff2",459:"b3aded9ae2aede0676b5",460:"12bca7bb8309f2c274e9",461:"66f14c044cd31061b36c",462:"9722f9cd2f8572be399f",463:"9be14ffb4c1ba0189110",464:"b23faa3ce77fb72b7102",465:"26e41f7541cea8061fe9",466:"59b92b0256e965992d24",467:"53d2aa3896853b66033d",468:"0d236f02b47ceffa1a49",469:"5661be41b5b9af66fa73",470:"eebcbfa187bf12816f0f",471:"131e0b4f8d05824d7c04",472:"8a1144b4a0b1e8e915b7",473:"bfdadce6389f760955e0",474:"bccc2c98ae9572f2793b",475:"7e376397fc3df4e79b86",476:"a2713cdcc16ae983d157",477:"ae930136eb3ccfca2e97",478:"88dc7ab7de20e2579af4",479:"bad20d2de3ec1a5a984b",480:"36f0edaf1ce8eaef25cf",481:"0cf433f9f47f294452c6",482:"3b5130acd754963fc8bd",483:"2dc2238d357b3bcdd785",484:"3902ffd7e154b96b534a",485:"deb3872d8b9799e89043",486:"3d8791e51d5ee0e4c466",487:"3278a4f10329343d115c",488:"9fb73b908163648b6e56",489:"48bd2074f5ad26a92847",490:"1a0bcf8445c1ce96f86e",491:"613d81eb3de1183f8deb",492:"7273b7de24139231f4ec",493:"bdf1aaddd2978f51c163",494:"7401aa72ae5c3bbddf45",495:"d8e7906d5d0e24c955ec",496:"851ae21f37c11114876c",497:"5efa946a1805d4e3d920",498:"51fc30b21fb7095845d8",499:"5ca6fce5eb7d3148a819",500:"63cb69b6272b3e485828",501:"64478d2112b4fba326ed",502:"d1877334b09e34d0c50d",503:"1385e707cabed7616c84",504:"83850d38f7e5359175bf",505:"4b179ca080dc994fa5bd",506:"bdb57deac93bc983e42a",507:"a9f60ddb18c742dacf90",508:"2dd7b9700fef864ed7f7",509:"4e1b9f38773f2d9dbefb",510:"063c36d8dd681ebaa343",511:"d117a0f1b9353d783c25",512:"62cecd96421b14043c4f",513:"a511ef9e63d8f90777bd",514:"7ff49568468aed1ba3c2",515:"270c6b15e363278ca6eb",516:"335d1618aa487bac2aa8",517:"4d03bd134dfbbd9cfa8c",518:"f7a8ab5c1ef0c65f664b",519:"32808fc421a9e07bb160",520:"81749063dceb4b27edaa",521:"d0f7975f944388d0eb29",522:"20f06f9231ec51ea59aa",523:"ccd95989c8f93802c688",524:"984936d3e84250ddae68",525:"4da43c970dbdd51ae902",526:"e4321905154e5d7118e3",527:"3802f39fc6f015069d05",528:"2d6728f4d92693d55dc9",529:"81b6ed3ccd8fc2ebad29",530:"4de3180e90bf2ebec2fa",531:"0fa04a4a6f08c7bd07f0",532:"106f765fc5af472001bd",533:"86c4653b26e6a08b4e67",534:"258629048fef26786a19",535:"d8458cfc884b41d5d361",536:"3728f8e386d754ee2463",537:"eb4618176654bf570375",538:"5a386a2b10aa11bb0b76",539:"f68b2341fd2dd7d8227f",540:"8a7f2cfc707c7348b33b",541:"da733408e6c13d001d1f",542:"f62f8b50e6fd204bb0e2",543:"a8a46d0a62ecbb467e51",544:"324099b5dfbd3ddaa4b3",545:"c084a4412bbfcf4147e8",546:"13be4f4bb7002c2b4892",547:"fff1160bf45b9aa2e966",548:"9390db4834e27835c7b5",549:"fd4fbaac4f12bc5ecc72",550:"96eded032a5e7fa4342d",551:"80eaaee1b4c412848edd",552:"b2d7aea7ac7650c5d476",553:"29f01008eade16fc542f",554:"242eb19464ab4cd03805",555:"52e265a73ee36328f75e",556:"9d798a2d8b7a349bdb3b",557:"6d6063601ffe60183a51",558:"590a3ecae404b42c5a7f",559:"ae56344d221d31921be9",560:"c16cc58f3a7900496673",561:"67c058fc657b42a966c2",562:"a8ac37fe6a6d47c24d72",563:"1508546c1695142e20aa",564:"2cb2e082e269c4d7ab22",565:"f9be5cd59d495a39974a",566:"ed1051d2e4f8ebbcc313",567:"2c30e9a0f71b3d0ee469",568:"562a051026630d43fd0e",569:"141942e73d329b479723",570:"b30058795409fd942850",571:"c31bc8859aa5d1a7216b",572:"a1636eceded998875932",573:"cb25bcdef70a53793ddb",574:"a00854d6dfc391dea465",575:"6794ebe0f9767fb1297c",576:"bdcd3f75a10524ffd0d5",577:"62a2ed112b41d5ed5fc9",578:"a7a2a817c05dcedd6e1e",579:"e9737320a83ea1dbf3c0",580:"81326873e4a15c889bb9",581:"c8eb3099b4841e1f9924",582:"852b631ad1c3363201c9",583:"feeffa6ecab98185668a",584:"a6c09c7c8893242fbb1f",585:"b4ec00b4d94b85830686",586:"fe3ee4299bcb7d20473b",587:"30aeb5716453f58f2392",588:"ccaefadefd9856c379cf",589:"a1e068a39fb91d55fd72",590:"afe7f2c428c11b3b2c87",592:"eef844c8a000466db63d",593:"c0a61d0696d093f31842",594:"df5f491b61461fdb9a51",595:"adffe46e44f87f6f6be4",596:"81fe1ab578bba72a3ad3",597:"c0f9e62019a3cf08bb32",598:"9b34835d5517abc36ddb",599:"21068f21fd4ec845d812",600:"e51aa70e573bbb59000b",601:"50e5507818c52258b1da",602:"3087d37524fbfd17b81e",603:"72a79c9446804f10f41f",604:"95be04f4d73cc1716310",605:"7b5f61e5f6d2c6e77e1f",606:"0d8835a6b9a2a15de0ce",607:"165d83172eda37e1a8fe",608:"c071ec00ebd3e4fe152b",609:"be4df12a487cbafd3aa8",610:"f8c0d606063bdd17f068",611:"d58683cddf9dd331c474",612:"c36b9cbb2e3493754c21",613:"3fdb549ab5b898cbfe4d",614:"16ff932994e34a0fa357",615:"37041ad134f5721ba94f",616:"6048165f0725fb2c8a93",617:"52bfc806b1b6447db6ef",618:"e19375fe606dd5cae260",619:"47d8933e67a60faae843",620:"e046dcbb9b3e02a09e3d",621:"702d1d15c2880e383da1",622:"8dc6705982d8cda027fb",623:"925dae45d1059b082e3d",625:"54ae0a969aa8a5facfff",626:"95c57bd7157c49d0e832",627:"ef3b7930cd1876386493",628:"665cc7604675128dfc4c",629:"4ff170a8311e30947080",630:"54f1d351ab04f8a74738",631:"22fa98567eb898c87ba3",632:"8b1004f23ad779f209bf",633:"a8010a5236777213e39d",634:"d58e020b31ced881cc44",635:"ece2b846a0cfab087aba",636:"79f2da6acf5f3d866d5b",637:"288a90f5560f30bc781a",638:"fc6cb4310cb273512e2f",639:"ba94f7084f1576e62ef1",640:"11e869cc91dfe7116d64",641:"a95b5aec2bee0f4c5ac1",642:"6e8c741eeecaa05027cc",643:"b25ae1c2d679d308c2ee",644:"cee03307ab1163236f19",645:"5f2ef5d345c31adc2b9c",646:"b08aed78b299d417bf76",647:"b1e7c8ed2daf7ad08e0d",648:"496584bd9ca2402d80c0",649:"15c1890e4163e94a9ef4",650:"525419bf024c0333d856",651:"07e53b8adf9dc238e45b",652:"8cce80f819412532a13f",653:"41a5c605d3033c0e7655",654:"1166e63b68e7697fe3ff",655:"94f94d4539db9bf9b7d5",656:"988d6e3f48b8c22abcea",657:"b4590fc54d237199cadf",658:"6d3420a7266305257ea1",659:"e3f0b0834d2e0c7ba341",660:"a05f94fef16244c2a70f",661:"7b93ae2c429d6bb5f7a6",662:"d2377dc2f7da8ecfb2da",663:"3cb7a3f82b645d4a9abc",664:"de17a7f5a2b028903ac4",665:"d61b4234ec9469e9958e",666:"a027a2e605ee9bde371f",667:"299abafecd3ba875f1ee",668:"cc01d4d196ae7059cc51",669:"d7104b9eccb8b684ead8",670:"423207b53e22ced86bb2",671:"f0d98c4c26aa3355b2c6",672:"4675cf4b95eacf3072f8",673:"ceb2f54c652632a8e19c",674:"330947e26f81e06d8d74",675:"fba1d431d188c212536a",676:"3ee8fd8e28266938be27",677:"84d482456d5a78a19048",678:"58f9c473a7a7010020bd",679:"d8913205d24d17b54d6b",680:"0897755dc453b5048b73",681:"976e65fdfe5801516c3e",682:"3c2eaa214b4efce50534",683:"dc18eef750917115f0cf",684:"3fdfda75b4c1b0583c7c",685:"fba5a67b5179b2ca4189",686:"e21099b50eb97939d840",687:"052dc0cb84bb66e47c1b",688:"f27a8724b4ba3b92122f",689:"6ce24fe6debf400513b6",690:"3840626236c9d4f2feaf",691:"94e50f66ae61355fd3e1",692:"9e73295c3c3136ad350e",693:"0df836ec0a1132019a46",694:"bb3826fe2aa178a07c39",695:"40e968c399d7c86cbeb9",696:"114bb02d0a7ec383f041",697:"25d49c5d8e88ae60b4dd",698:"421b241e5d30fb7d9b22",699:"ca61aa016414b44ba6d0",700:"3c8c1bf33639fe16cd95",701:"3aeeabb72d01be4218cb",702:"57b99f9146836ab9d3ac",703:"4f424bb4066fd516360b",704:"8d81033d2de634ab2b08",705:"8f9bfc9fcec6659df279",706:"d0bc876cd1385bad65fe",707:"8fb3c04ca56b83f57a82",708:"39ef8e32d76fc012a8ed",709:"9d118746f8ede5857816",710:"92d90d05225b1efc8152",711:"f4bc8b31efd3b2858b04",712:"4a61aee98760b67c1e72",713:"1870c193ca41874e6a52",714:"38f295ad3d9f7da51b8b",715:"4adafc2592691af84965",716:"7ab6c1938b716f2e8ccc",717:"5cb8e04d4ef85dd9253b",718:"cc3654e8a8cddfe0b96c",719:"327304f68dc6a5a0ecbb",720:"de073be12c2230b88b10",721:"ab20007a4b0d5e61bfbb",722:"36481d3c0b3d401e9f4f",723:"a4edc9af997eaa155d12",724:"54f60455576eaf42a6b4",725:"517e66c0d9de877eeef9",726:"3afe7cb5d476a8f6194f",727:"7f4a407a030a0fca1028",728:"6ba1473a4f5d30438bc5",729:"a5fde4ebda5f6aacdbec",730:"94872a6697641d7aecee",731:"e7d15b4a3dfcb2d97902",732:"4768d20d903415f37509",733:"3306b996037958766601",734:"2fcd5139039dce6ba600",735:"62d80866a1f4fb2dae5e",736:"4705ae1ef95256cbfce7",737:"08454d05b196dfed6013",738:"134aa9a61b0c643013ef",739:"b64699fb6dec4b0a11bf",740:"5fca9c79c8551d0235ab",741:"56c4395fe2f725f7f3d6",742:"39ae0040e50248616e58",743:"cad2e892a719c3548cd9",744:"8d412f9be735e628a585",745:"4b3731be5688ba4b91a0",746:"02905d63eb146345f7f9",747:"bc33bb8908526805802e",748:"72f5d37f88c928850e98",749:"3878c81f006b5cb847d8",750:"9065c5183b13fc8fca03",751:"595778be75ecbf2e8dd2",752:"a0cb64f3cf4c63f474ed",753:"9ff587870d25474cca39",754:"6bfa422bc50fc2e2c615",755:"0f8bfbfbbd586ed5d9ee",756:"00adf9ea1db90fb8a4f7",757:"99bddcadafc13d83c42a",758:"41899511a15971e31664",759:"ca6a3a7826ff1cdc52f5",760:"22a8d77c297db123f0b1",761:"09cf199e1021348303a6",762:"848da0657a227c9d5d65",763:"99e4af571130d5f139b0",764:"5a4919ca30c77edca4bd",765:"02daf5560a72902c2d3a",766:"c630059df622b5d47334",767:"9ed1e9e9e11b7053fb88",768:"65623fa256666d2cfd70",769:"5c1bd3826d8de6158b80",770:"bdd39a72802f37022b81",771:"00b3eb261ac450ae0a9e",772:"49e13bd31e5617804498",773:"533be8c3ffc93969153f",774:"51ebac94c76892303f5b",775:"84d5b474c3274336b629",776:"3a07cdf51ef631f41315",777:"c9886ee0118886f8a0e3",778:"392b4d76d1269e2db701",779:"1d4930cf38d25af7475b",780:"e0fe9b967eefb878955c",781:"b3db4942006462762bf1",782:"58c994870e3e013d9391",783:"d0b4ec764631e6970a4f",784:"8098329faa1ecd191268",785:"f152aaf4657222dd0b3d",786:"c6d6036cb0d372727162",787:"917848cc2bb49bbcc404",788:"fe0ef0652471aa1be006",789:"1c1980185d40fa569faa",790:"d38b32e416e903bb4232",791:"cec165508b35ff2d72cd",792:"00a0fe736c0f091ab1fa",793:"f825202d7efa595abc0e",794:"592f90315f827c8bf8df",795:"5cb37a8a7f8107c3e70d",796:"5bfbe6dc493f032331eb",797:"e3c62d6a4a0593bc2cc0",798:"5dea070044a42e1329ba",799:"50a304bcbc36fb4c6517",800:"5ca4714e9d1c0577306e",801:"aa64a2446d490d04982e",802:"eed1239df4bd956862d5",803:"5f214785f740c36a7a80",804:"e9e39cbb44df5225a944",805:"09fa92d89687c655ff3c",806:"21e91a4abfaf1783c7e7",807:"76dbeebd2a4730481cfc",808:"36aab04b893884e8233a",809:"5334adfea49bb9953eea",810:"091c6b4dcacbfc2aa0ab",811:"58bebb46e9b48df51a9a",812:"75880b25db74fbdc6a13",813:"0de1b19c52f185ccc172",814:"1c50e36d3a4bdb62f12f",815:"20652858526f4a201c9d",816:"8fd9adf3b632193c2392",817:"b9094addc938c47e4e02",818:"ad5035082135399a9a5c",819:"4c03a512936bd97c3cad",820:"f6a3658925f93ed33131",821:"b4fd420f089f4d36da15",822:"7826762e4530aca03fce",823:"dd4e4c70733b71f85c66",824:"b7b7c5f2b75d12d30577",825:"0aeb64279e3220a506b5",826:"dc44d068f574da3c1c1a",827:"29df754e654ff0cc2f7a",828:"375a1b38af07d1e7af66",829:"e81b0e2b6741ade5c28e",830:"e446bc547b1c0d78d301",831:"7a5be0e6517a228a9036",832:"ec8b38cef3fed623c19a",833:"35e946dd4b7eeff834ed",834:"12d1bda5a1d499c9b4ac",835:"18e85a483b9e307fe8b5",836:"6e349da20c7b6acf62eb",837:"f309e8c98a206a47437a",838:"cfb7f1d9f94b7d1a7e79",839:"945dd89841484c3c5ca4",840:"f1e1f4579eb97dcaa6ef",841:"afb76ffc04b08220cece",842:"affe463f74494ff03249",843:"cf791e86c869ed46ca38",844:"0642b0cc0ad0c37da232",845:"5bb3db2577286cfaa93d",846:"00f00babe615d206990d",847:"c26e7975a06a7e043679",848:"ff5632a93abf1c84e3ba",849:"4275f4d24ad14d14c8ae",850:"fb7be0a65e607c165e0e",851:"43c274854f5aaa6c69c3",852:"55b76cb143afde7c07e1",853:"2fdd4b3fcfd8f467466d",854:"f4ca24b1910d6f4a52b1",855:"ee40129a06b6699ac583",856:"fc4d99774553cd3efb72",857:"b17f5dd1899f6bbde6c2",858:"65260a2424eb7f0522cb",859:"58cda81786866857b455",860:"1949101ade55583d098a",861:"5f5802a0dbc154ec5e99",862:"76afaca7ee3b3781b466",863:"78c0c2235275fcf1e688",864:"ff3cdf135ec5cbb64b4f",865:"e56012d02f3d498ca834",866:"84fb8ea6adacde859ab3",867:"cc63e8c81e1d7a174be4",868:"182014bb2ef9c5214d10",869:"56a676a7e06cd57edaf4",870:"4353ecdb843f787a1b3a",871:"59e76bcd31f740c3fb1f",872:"1e56a6d3c98701d426f3",873:"0829c4746c7387e3a656",874:"03ddb6e0802ec54b2ac9",875:"c5d1506d944a2bbc23b8",876:"2a268abfeec10c7305fd",877:"571d309e4916db23b9f8",878:"44d55dc61fa2465a251e",879:"dba9490998d566556db7",880:"39acd5e076b6446070b2",881:"d80e068378abc54a0eb8",882:"28555a80701187ab4249",883:"90babe9972d0f6bdb4a4",884:"89be5c2d1a12adb91a2e",885:"92851bbe64e624f824c0",886:"9c40255f1a67b2db1c07",887:"6eb2be186b4468752224",888:"ff42c2ad5a7327748a8f",889:"1d9927c7f9a76a92cdb6",890:"0c6f469a5bbd05a23834",891:"874b923883c2139224da",892:"46dcd81f0da9ca329383",893:"bff44de3128b82201283",894:"33b68b13005a7cead2c4",895:"2ef63980e743e58001ca",896:"0c965ab4e4193b384240",897:"abaac5a479b5767a7071",898:"4195536ac5e72110622e",899:"6025addb37aa60c84a79",900:"f4ee6bf332ff5ecdefae",901:"5fe9dbd7d23e3f8e609f",902:"98bbb20ea17fd7100b99",903:"ac3a04ee807a7223cf57",904:"4f70b7126c923d59318a",905:"67ad1cfb225c548ed08d",906:"db656af3671804a4a5f5",907:"be2d1a61d4020d7793a8",908:"eaf9119b8a1132c108fc",909:"0ed7b7c184b7e10fe115",910:"c386c0c3335de8e5e548",911:"87511839c35d5f15ec8b",912:"0160869f5d19548479ca",913:"dcc22c1c6a6192197a02",914:"ba19292742c6dd841b81",915:"634dc2f3b9dc6fe886f2",916:"dc24f6d1700ac732cdcd",917:"a8e44ba05990676f7cae",918:"c5fd5abb0847491097f0",919:"35251710e7c466961cd2",920:"b63e2d14e471cd7fa52a",921:"e743b396865fccf6ba46",922:"1e53b1276a10e0c05f91",923:"51ca87c06c1e1126a1bd",924:"a6974669982a56b46b71",925:"5ff2e20c66eb72b25c2b",926:"0bdea5e77a44974b4454",927:"f9003e78b108f7d35d2a",928:"73e6e51275587fbb439d",929:"b22b80c05997a9d46fd3",930:"d99e84cecc1e3a14880c",931:"572d6237cbad8debc379",932:"630be025e4673a3fd9ae",933:"f69217081a47d043c731",934:"6bae1e6ca0f6f3352320",935:"f524a58b916f6e24a04a",936:"ba45e677dd8f6bc937ba",937:"83d45bf94b8c98302f1b",938:"1b58a68849f666920572",939:"5ec0e82e4156e3ed7e27",940:"817882d96207dfaa7ac9",941:"e9a7c89fdda675606f8d",942:"45f70c316c294dc86b78",943:"c4cfb97272c31f457459",944:"a461b1898e13bd03a1e8",945:"9b2518a2e87f0db7f2f2",946:"58a11dfa020a88de29f4",947:"aa4e3f6ed5bdd9aac11f",948:"baecb76b11b7f2e03604",949:"f510ee484360fdb9a672",950:"6e1212d8ba3429f450d9",951:"60489dcd442e1cc93e19",952:"35aa309687ff0797bbe8",953:"c86f4623b0e7f0b90365",954:"929f41a179c7b54cac71",955:"6f0c15c8eae95635530f",956:"9c918faa1ccc9482d764",957:"182016dbcd9b8e4f4b9d",958:"f0997693c7e27e13c91a",959:"f96a06ea3702ac09bb32",960:"a696eafe67bccffe813b",961:"e8ac5e38c955b1730e67",962:"d1be625d140c4a5478ff",963:"c23bc8e1c7609b028a9f",964:"9b38d4bfba490f9ae00e",965:"c179161f8384646cb52b",966:"cb326511f57f8376d670",967:"42028d93a8e212cc17c2",968:"8d97d607a51cf6fb1517",969:"f92a8cc7ece768487a10",970:"e2319aa0a11901c265e2",971:"df79446e68926989be5b",972:"a440d5d0ff549b6000b9",973:"8012198a595099d817b7",974:"d960c0b50901c7aa16aa",975:"d92e6d46fd4c525bed59",976:"7ef6c51753416adadabd",977:"204a810581dd6b4e431e",978:"bfc57a68f0a406f3e311",979:"b329e2f7a9dd6e72bdc4",980:"d96055240409dcb4b0ad",981:"7596faad0478f65e8641",982:"e0901edbb4b56ff6b077",983:"31e32e315c4cefe1b707",984:"d394de10485a9f59efad",985:"b9e462c5dc2b5c53a131",986:"418c32a3658a930c8c03",987:"45e8fdef85f71aa66793",988:"1fb6c765bb554441c19e",989:"a6278adeb65cbd731947",990:"ba8b216a34e48b1ca2a1",991:"871518b93cc1d84d4a87",992:"8dc3da02ca17d1ea3d1e"}[e]+".chunk.v7.js"}.e=function(e){var t=[];r[e]?t.push(r[e]):0!==r[e]&&{14:1,70:1,72:1,90:1,93:1,100:1,118:1,120:1,136:1,137:1,139:1,140:1,141:1,148:1,151:1,152:1,153:1,168:1,174:1,175:1,177:1,181:1,301:1,566:1,575:1,578:1,587:1,594:1,595:1,596:1,599:1,615:1,616:1,622:1,626:1,633:1,635:1,643:1,645:1,654:1,664:1,666:1,667:1,675:1,699:1,713:1,738:1}[e]&&t.push(r[e]=new Promise((function(t,n){for(var i=({14:"officehome-async-styles",20:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~appbar~cc~cc-rc~copd-rc~draft-cnt~ew~72ec8b1c",25:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~appbar~cc~cc-rc~copd-rc~draft-cnt~ew~3cf7f8ec",26:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~appbar~cc~cc-rc~copd-rc~draft-cnt~ew~e17c2de3",27:"fluent~action-context-menu-rc~app-gallery-rc~appbar~cc~cc-rc~copd-rc~draft-cnt~ew-os~ew-rc~first-dra~0a00db43",29:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~cc~cc-rc~copd-rc~draft-cnt~ew-os~ew-~ee27e821",30:"fluent~action-context-menu-rc~app-gallery-rc~appbar~cc~cc-rc~copd-rc~draft-cnt~ew-os~ew-rc~first-dra~15bd2475",32:"fluent~action-context-menu-rc~app-gallery-rc~app-host-component~appbar-control-tilecontextmenu~comme~42c79b08",36:"fluent~cc~cc-rc~coh~coh-rc~ew-os~ew-rc~mc~qa~rec1-os~rec1-rc~upload-rc",40:"fluent~action-context-menu-rc~draft-cnt~ew-os~ew-rc~mc~qa~rec1-os~rec1-rc",41:"fluent~ew-os~ew-rc~fl-cnt~mc~qa~rec1-os~rec1-rc~upload-rc",48:"calendar~forms-group~mru~officeforms-group-forms~officeforms-my-forms~places",49:"fluent~ew-os~ew-rc~mc~qa~rec1-os~rec1-rc",53:"auto-suggest~bc~search-preload~search-results",54:"fluent~cc~cc-rc~coh~coh-rc",55:"fluent~ew-os~ew-rc~mc~qa",56:"vendors~app-create~coh-rc~start-page-simple-create~template-page-create-component",57:"vendors~auto-suggest~bc~search-preload~search-results",63:"fluent~draft-cnt~rec1-os~rec1-rc",64:"fluent~ew-os~ew-rc~mc",65:"vendors~appbar~task-dialog-rc~teaching-ui-rc",66:"vendors~edgeworth~input-dialog~wac-start",67:"vendors~mstart~start-page-rc~template-page-rc",68:"vendors~officeflonedssink~oteljs1ds~task-dialog-rc",78:"fl-cnt~share-control",79:"fluent~app-gallery-rc~appbar",80:"fluent~app-host-component~first-draft-component",81:"fluent~app-host-component~task-dialog-rc",82:"fluent~cc~cc-rc",83:"fluent~commercial-install-component~consumer-install-component",84:"fluent~draft-cnt~first-draft-component",85:"fluent~draft-cnt~first-run-rc",86:"fluent~first-run-rc~template-stage-component",87:"fluent~fl-cnt~template-stage-component",88:"fluent~flerrordialog~leap",89:"fluent~rec1-os~rec1-rc",90:"templates~wac-start",91:"vendors~appbar~feed-component",92:"vendors~appbar~toast-container-rc",93:"vendors~coh~coh-rc",94:"vendors~commercial-install-component~consumer-install-component",95:"vendors~flerrordialog~leap",96:"vendors~search-page-bootstrapper~search-results",97:"vendors~sharecallout~sharedialog",98:"wac-cnt",133:"action-context-menu-rc",134:"announcement",136:"app-gallery-ag",137:"app-gallery-rc",138:"app-gallery-wrapper",139:"app-header",140:"app-host-component",141:"appbar",142:"appbar-control-flyoutbuttonbadge",143:"appbar-control-flyoutsearchresults",144:"appbar-control-lazydndcontext",145:"appbar-control-quickaccesstile",146:"appbar-control-tilecontextmenu",147:"ashautils",148:"auto-suggest",149:"banner",150:"bc",151:"calendar",152:"cc",153:"cc-rc",154:"cc-wrapper",155:"cnt-actions-helper",156:"coh",157:"coh-rc",158:"coh-wrapper",159:"commercial-install-component",160:"confirmation-dialog-rc",161:"consumer-install-component",162:"context-menu",163:"copd-rc",164:"create-links-control-icns",165:"create-menu",166:"createnewmodule",167:"default-tdp",168:"draft-cnt",169:"edgeworth",170:"edgeworth-trie-webworker",171:"edgeworth-worker",172:"error-dialog",173:"error-dialog-rc",174:"ew-os",175:"ew-rc",176:"fb-theme",177:"feature-callout",178:"feature-tooltip-container",179:"feed",180:"feedback",181:"first-run",182:"first-run-rc",183:"first-run-wrapper",184:"fl-cnt",185:"fl-unsupported-page",186:"flcontainerstrings0",187:"flcontainerstrings1",188:"flcontainerstrings10",189:"flcontainerstrings11",190:"flcontainerstrings12",191:"flcontainerstrings13",192:"flcontainerstrings14",193:"flcontainerstrings15",194:"flcontainerstrings16",195:"flcontainerstrings17",196:"flcontainerstrings18",197:"flcontainerstrings19",198:"flcontainerstrings2",199:"flcontainerstrings20",200:"flcontainerstrings21",201:"flcontainerstrings22",202:"flcontainerstrings23",203:"flcontainerstrings24",204:"flcontainerstrings25",205:"flcontainerstrings26",206:"flcontainerstrings27",207:"flcontainerstrings28",208:"flcontainerstrings29",209:"flcontainerstrings3",210:"flcontainerstrings30",211:"flcontainerstrings31",212:"flcontainerstrings32",213:"flcontainerstrings33",214:"flcontainerstrings34",215:"flcontainerstrings35",216:"flcontainerstrings36",217:"flcontainerstrings37",218:"flcontainerstrings38",219:"flcontainerstrings39",220:"flcontainerstrings4",221:"flcontainerstrings40",222:"flcontainerstrings41",223:"flcontainerstrings42",224:"flcontainerstrings43",225:"flcontainerstrings44",226:"flcontainerstrings45",227:"flcontainerstrings46",228:"flcontainerstrings47",229:"flcontainerstrings48",230:"flcontainerstrings49",231:"flcontainerstrings5",232:"flcontainerstrings50",233:"flcontainerstrings51",234:"flcontainerstrings52",235:"flcontainerstrings53",236:"flcontainerstrings54",237:"flcontainerstrings55",238:"flcontainerstrings56",239:"flcontainerstrings57",240:"flcontainerstrings58",241:"flcontainerstrings59",242:"flcontainerstrings6",243:"flcontainerstrings60",244:"flcontainerstrings61",245:"flcontainerstrings62",246:"flcontainerstrings63",247:"flcontainerstrings64",248:"flcontainerstrings65",249:"flcontainerstrings66",250:"flcontainerstrings67",251:"flcontainerstrings68",252:"flcontainerstrings69",253:"flcontainerstrings7",254:"flcontainerstrings70",255:"flcontainerstrings71",256:"flcontainerstrings72",257:"flcontainerstrings73",258:"flcontainerstrings74",259:"flcontainerstrings75",260:"flcontainerstrings76",261:"flcontainerstrings77",262:"flcontainerstrings78",263:"flcontainerstrings79",264:"flcontainerstrings8",265:"flcontainerstrings80",266:"flcontainerstrings81",267:"flcontainerstrings82",268:"flcontainerstrings83",269:"flcontainerstrings84",270:"flcontainerstrings85",271:"flcontainerstrings9",272:"flframework-hashfallback",273:"floating-action-button",274:"fluent-theme-provider",275:"fluent~action-context-menu-rc",276:"fluent~announcement",277:"fluent~app-gallery-rc",278:"fluent~app-host-component",279:"fluent~appbar",280:"fluent~appbar-control-lazyflyout",281:"fluent~confirmation-dialog-rc",282:"fluent~copd-rc",283:"fluent~draft-cnt",284:"fluent~error-dialog-rc",285:"fluent~first-draft-component",286:"fluent~fl-cnt",287:"fluent~flerrordialog",288:"fluent~floating-action-button",289:"fluent~iwc",290:"fluent~learning-shelf-rc",291:"fluent~left-nav-rc",292:"fluent~mc",293:"fluent~menu-view-service",294:"fluent~onenote-ip-dialog",295:"fluent~task-dialog-rc",296:"fluent~template-page-create-component",297:"fluent~template-stage-component",298:"fluent~toast-container-rc",299:"fluent~upload-rc",300:"fluent~wb-rc",301:"forms-group",302:"home",303:"hostdefaultsstrings0",304:"hostdefaultsstrings1",305:"hostdefaultsstrings10",306:"hostdefaultsstrings11",307:"hostdefaultsstrings12",308:"hostdefaultsstrings13",309:"hostdefaultsstrings14",310:"hostdefaultsstrings15",311:"hostdefaultsstrings16",312:"hostdefaultsstrings17",313:"hostdefaultsstrings18",314:"hostdefaultsstrings19",315:"hostdefaultsstrings2",316:"hostdefaultsstrings20",317:"hostdefaultsstrings21",318:"hostdefaultsstrings22",319:"hostdefaultsstrings23",320:"hostdefaultsstrings24",321:"hostdefaultsstrings25",322:"hostdefaultsstrings26",323:"hostdefaultsstrings27",324:"hostdefaultsstrings28",325:"hostdefaultsstrings29",326:"hostdefaultsstrings3",327:"hostdefaultsstrings30",328:"hostdefaultsstrings31",329:"hostdefaultsstrings32",330:"hostdefaultsstrings33",331:"hostdefaultsstrings34",332:"hostdefaultsstrings35",333:"hostdefaultsstrings36",334:"hostdefaultsstrings37",335:"hostdefaultsstrings38",336:"hostdefaultsstrings39",337:"hostdefaultsstrings4",338:"hostdefaultsstrings40",339:"hostdefaultsstrings41",340:"hostdefaultsstrings42",341:"hostdefaultsstrings43",342:"hostdefaultsstrings44",343:"hostdefaultsstrings45",344:"hostdefaultsstrings46",345:"hostdefaultsstrings47",346:"hostdefaultsstrings48",347:"hostdefaultsstrings49",348:"hostdefaultsstrings5",349:"hostdefaultsstrings50",350:"hostdefaultsstrings51",351:"hostdefaultsstrings52",352:"hostdefaultsstrings53",353:"hostdefaultsstrings54",354:"hostdefaultsstrings55",355:"hostdefaultsstrings56",356:"hostdefaultsstrings57",357:"hostdefaultsstrings58",358:"hostdefaultsstrings59",359:"hostdefaultsstrings6",360:"hostdefaultsstrings60",361:"hostdefaultsstrings61",362:"hostdefaultsstrings62",363:"hostdefaultsstrings63",364:"hostdefaultsstrings64",365:"hostdefaultsstrings65",366:"hostdefaultsstrings66",367:"hostdefaultsstrings67",368:"hostdefaultsstrings68",369:"hostdefaultsstrings69",370:"hostdefaultsstrings7",371:"hostdefaultsstrings70",372:"hostdefaultsstrings71",373:"hostdefaultsstrings72",374:"hostdefaultsstrings73",375:"hostdefaultsstrings74",376:"hostdefaultsstrings75",377:"hostdefaultsstrings76",378:"hostdefaultsstrings77",379:"hostdefaultsstrings78",380:"hostdefaultsstrings79",381:"hostdefaultsstrings8",382:"hostdefaultsstrings80",383:"hostdefaultsstrings81",384:"hostdefaultsstrings82",385:"hostdefaultsstrings83",386:"hostdefaultsstrings84",387:"hostdefaultsstrings85",388:"hostdefaultsstrings9",389:"hostuxstrings0",390:"hostuxstrings1",391:"hostuxstrings10",392:"hostuxstrings11",393:"hostuxstrings12",394:"hostuxstrings13",395:"hostuxstrings14",396:"hostuxstrings15",397:"hostuxstrings16",398:"hostuxstrings17",399:"hostuxstrings18",400:"hostuxstrings19",401:"hostuxstrings2",402:"hostuxstrings20",403:"hostuxstrings21",404:"hostuxstrings22",405:"hostuxstrings23",406:"hostuxstrings24",407:"hostuxstrings25",408:"hostuxstrings26",409:"hostuxstrings27",410:"hostuxstrings28",411:"hostuxstrings29",412:"hostuxstrings3",413:"hostuxstrings30",414:"hostuxstrings31",415:"hostuxstrings32",416:"hostuxstrings33",417:"hostuxstrings34",418:"hostuxstrings35",419:"hostuxstrings36",420:"hostuxstrings37",421:"hostuxstrings38",422:"hostuxstrings39",423:"hostuxstrings4",424:"hostuxstrings40",425:"hostuxstrings41",426:"hostuxstrings42",427:"hostuxstrings43",428:"hostuxstrings44",429:"hostuxstrings45",430:"hostuxstrings46",431:"hostuxstrings47",432:"hostuxstrings48",433:"hostuxstrings49",434:"hostuxstrings5",435:"hostuxstrings50",436:"hostuxstrings51",437:"hostuxstrings52",438:"hostuxstrings53",439:"hostuxstrings54",440:"hostuxstrings55",441:"hostuxstrings56",442:"hostuxstrings57",443:"hostuxstrings58",444:"hostuxstrings59",445:"hostuxstrings6",446:"hostuxstrings60",447:"hostuxstrings61",448:"hostuxstrings62",449:"hostuxstrings63",450:"hostuxstrings64",451:"hostuxstrings65",452:"hostuxstrings66",453:"hostuxstrings67",454:"hostuxstrings68",455:"hostuxstrings69",456:"hostuxstrings7",457:"hostuxstrings70",458:"hostuxstrings71",459:"hostuxstrings72",460:"hostuxstrings73",461:"hostuxstrings74",462:"hostuxstrings75",463:"hostuxstrings76",464:"hostuxstrings77",465:"hostuxstrings78",466:"hostuxstrings79",467:"hostuxstrings8",468:"hostuxstrings80",469:"hostuxstrings81",470:"hostuxstrings82",471:"hostuxstrings83",472:"hostuxstrings84",473:"hostuxstrings85",474:"hostuxstrings9",475:"hwalaunchurl",476:"informationprotectionstrings0",477:"informationprotectionstrings1",478:"informationprotectionstrings10",479:"informationprotectionstrings11",480:"informationprotectionstrings12",481:"informationprotectionstrings13",482:"informationprotectionstrings14",483:"informationprotectionstrings15",484:"informationprotectionstrings16",485:"informationprotectionstrings17",486:"informationprotectionstrings18",487:"informationprotectionstrings19",488:"informationprotectionstrings2",489:"informationprotectionstrings20",490:"informationprotectionstrings21",491:"informationprotectionstrings22",492:"informationprotectionstrings23",493:"informationprotectionstrings24",494:"informationprotectionstrings25",495:"informationprotectionstrings26",496:"informationprotectionstrings27",497:"informationprotectionstrings28",498:"informationprotectionstrings29",499:"informationprotectionstrings3",500:"informationprotectionstrings30",501:"informationprotectionstrings31",502:"informationprotectionstrings32",503:"informationprotectionstrings33",504:"informationprotectionstrings34",505:"informationprotectionstrings35",506:"informationprotectionstrings36",507:"informationprotectionstrings37",508:"informationprotectionstrings38",509:"informationprotectionstrings39",510:"informationprotectionstrings4",511:"informationprotectionstrings40",512:"informationprotectionstrings41",513:"informationprotectionstrings42",514:"informationprotectionstrings43",515:"informationprotectionstrings44",516:"informationprotectionstrings45",517:"informationprotectionstrings46",518:"informationprotectionstrings47",519:"informationprotectionstrings48",520:"informationprotectionstrings49",521:"informationprotectionstrings5",522:"informationprotectionstrings50",523:"informationprotectionstrings51",524:"informationprotectionstrings52",525:"informationprotectionstrings53",526:"informationprotectionstrings54",527:"informationprotectionstrings55",528:"informationprotectionstrings56",529:"informationprotectionstrings57",530:"informationprotectionstrings58",531:"informationprotectionstrings59",532:"informationprotectionstrings6",533:"informationprotectionstrings60",534:"informationprotectionstrings61",535:"informationprotectionstrings62",536:"informationprotectionstrings63",537:"informationprotectionstrings64",538:"informationprotectionstrings65",539:"informationprotectionstrings66",540:"informationprotectionstrings67",541:"informationprotectionstrings68",542:"informationprotectionstrings69",543:"informationprotectionstrings7",544:"informationprotectionstrings70",545:"informationprotectionstrings71",546:"informationprotectionstrings72",547:"informationprotectionstrings73",548:"informationprotectionstrings74",549:"informationprotectionstrings75",550:"informationprotectionstrings76",551:"informationprotectionstrings77",552:"informationprotectionstrings78",553:"informationprotectionstrings79",554:"informationprotectionstrings8",555:"informationprotectionstrings80",556:"informationprotectionstrings81",557:"informationprotectionstrings82",558:"informationprotectionstrings83",559:"informationprotectionstrings84",560:"informationprotectionstrings85",561:"informationprotectionstrings9",562:"initialize-fluent-theme",563:"input-dialog",564:"install",565:"install-rc",566:"install-wizard",567:"install-wrapper",568:"instrumentation-service",569:"learning-home-dataprovider",570:"learning-shelf-card",571:"learning-shelf-rc",572:"learning-word-dataprovider",573:"left-nav-rc",574:"m365-apps",575:"mc",576:"mobile-app-banner",577:"move-to-folder-control",578:"mru",579:"mstart",580:"new-consumer-experience",581:"new-user-shelf",582:"northstar-prefetch-service",583:"odsp-start-onedrive",584:"odsp-start-sharepoint",585:"office-theme",586:"officeflonedssink",587:"officeforms-group-forms",588:"officeforms-my-forms",589:"oteljs1ds",590:"places",592:"portal-preload",593:"previewlabelcallout",594:"qa",595:"rec1-os",596:"rec1-rc",597:"renderdiscovermenu",598:"search-preload",599:"search-results",600:"semb",601:"share-control",602:"sharecallout",603:"sharedialog",604:"side-popup-menu",605:"skip-to-main",606:"start-page-rc",607:"start-page-simple-create",608:"start-page-wrapper",609:"summarymodule",610:"support-central-rc",611:"task-dialog-rc",612:"teaching-ui-rc",613:"template-page-create-component",614:"template-page-rc",615:"template-stage-component",616:"templates",617:"templates-page-wrapper",618:"text-encoder-lite",619:"toast-container-rc",620:"upload-button",621:"upload-dialog",622:"upload-rc",623:"user-settings-control",625:"vendors~action-context-menu-rc",626:"vendors~announcement",627:"vendors~app-create",628:"vendors~appbar-control-lazyflyout",629:"vendors~appbar-control-suggestedapptile",630:"vendors~cnt-actions-helper",631:"vendors~coh-rc",632:"vendors~commercial-install-component",633:"vendors~confirmation-dialog-rc",634:"vendors~consumer-install-component",635:"vendors~copd-rc",636:"vendors~custom-tdp",637:"vendors~data-prefetch-service",638:"vendors~edgeworth",639:"vendors~enterprise-tdp",640:"vendors~error-dialog-rc",641:"vendors~feed",642:"vendors~feed-component",643:"vendors~first-draft-component",644:"vendors~first-run-rc",645:"vendors~fl-cnt",646:"vendors~fl-debugger",647:"vendors~flerrordialog",648:"vendors~floating-action-button",649:"vendors~hwalaunchfile",650:"vendors~install-rc",651:"vendors~iwc",652:"vendors~learning-iris-dataprovider",653:"vendors~learning-shelf-rc",654:"vendors~left-nav-rc",655:"vendors~m365-apps",656:"vendors~menu-view-service",657:"vendors~midgard-bootstrapper",658:"vendors~onenote-ip-dialog",659:"vendors~renderdiscovermenu",660:"vendors~rf-dataprovider",661:"vendors~search-page-bootstrapper",662:"vendors~search-preload",663:"vendors~sharepointnotificationservice",664:"vendors~skip-to-main",665:"vendors~socketmodule",666:"vendors~support-central-rc",667:"vendors~task-dialog-rc",668:"vendors~teaching-ui-rc",669:"vendors~teamsservicefile",670:"vendors~toast-container-rc",671:"vendors~visual-background-rc",672:"vendors~vroom-service",673:"vendors~wb-rc",674:"visual-background-rc",675:"wac-start",676:"wb-rc",677:"web-vitals",678:"workspace-nav"}[e]||e)+"."+{0:"31d6cfe0d16ae931b73c",1:"31d6cfe0d16ae931b73c",2:"31d6cfe0d16ae931b73c",3:"31d6cfe0d16ae931b73c",4:"31d6cfe0d16ae931b73c",5:"31d6cfe0d16ae931b73c",6:"31d6cfe0d16ae931b73c",7:"31d6cfe0d16ae931b73c",8:"31d6cfe0d16ae931b73c",9:"31d6cfe0d16ae931b73c",10:"31d6cfe0d16ae931b73c",11:"31d6cfe0d16ae931b73c",12:"31d6cfe0d16ae931b73c",13:"31d6cfe0d16ae931b73c",14:"0be316346ddb52951dee",15:"31d6cfe0d16ae931b73c",16:"31d6cfe0d16ae931b73c",17:"31d6cfe0d16ae931b73c",18:"31d6cfe0d16ae931b73c",19:"31d6cfe0d16ae931b73c",20:"31d6cfe0d16ae931b73c",21:"31d6cfe0d16ae931b73c",22:"31d6cfe0d16ae931b73c",23:"31d6cfe0d16ae931b73c",24:"31d6cfe0d16ae931b73c",25:"31d6cfe0d16ae931b73c",26:"31d6cfe0d16ae931b73c",27:"31d6cfe0d16ae931b73c",28:"31d6cfe0d16ae931b73c",29:"31d6cfe0d16ae931b73c",30:"31d6cfe0d16ae931b73c",31:"31d6cfe0d16ae931b73c",32:"31d6cfe0d16ae931b73c",33:"31d6cfe0d16ae931b73c",34:"31d6cfe0d16ae931b73c",35:"31d6cfe0d16ae931b73c",36:"31d6cfe0d16ae931b73c",37:"31d6cfe0d16ae931b73c",38:"31d6cfe0d16ae931b73c",39:"31d6cfe0d16ae931b73c",40:"31d6cfe0d16ae931b73c",41:"31d6cfe0d16ae931b73c",42:"31d6cfe0d16ae931b73c",43:"31d6cfe0d16ae931b73c",44:"31d6cfe0d16ae931b73c",45:"31d6cfe0d16ae931b73c",46:"31d6cfe0d16ae931b73c",47:"31d6cfe0d16ae931b73c",48:"31d6cfe0d16ae931b73c",49:"31d6cfe0d16ae931b73c",50:"31d6cfe0d16ae931b73c",51:"31d6cfe0d16ae931b73c",52:"31d6cfe0d16ae931b73c",53:"31d6cfe0d16ae931b73c",54:"31d6cfe0d16ae931b73c",55:"31d6cfe0d16ae931b73c",56:"31d6cfe0d16ae931b73c",57:"31d6cfe0d16ae931b73c",58:"31d6cfe0d16ae931b73c",59:"31d6cfe0d16ae931b73c",60:"31d6cfe0d16ae931b73c",61:"31d6cfe0d16ae931b73c",62:"31d6cfe0d16ae931b73c",63:"31d6cfe0d16ae931b73c",64:"31d6cfe0d16ae931b73c",65:"31d6cfe0d16ae931b73c",66:"31d6cfe0d16ae931b73c",67:"31d6cfe0d16ae931b73c",68:"31d6cfe0d16ae931b73c",69:"31d6cfe0d16ae931b73c",70:"9d2088d319da24a93e53",71:"31d6cfe0d16ae931b73c",72:"8e21ebe31315a121a872",73:"31d6cfe0d16ae931b73c",74:"31d6cfe0d16ae931b73c",75:"31d6cfe0d16ae931b73c",76:"31d6cfe0d16ae931b73c",77:"31d6cfe0d16ae931b73c",78:"31d6cfe0d16ae931b73c",79:"31d6cfe0d16ae931b73c",80:"31d6cfe0d16ae931b73c",81:"31d6cfe0d16ae931b73c",82:"31d6cfe0d16ae931b73c",83:"31d6cfe0d16ae931b73c",84:"31d6cfe0d16ae931b73c",85:"31d6cfe0d16ae931b73c",86:"31d6cfe0d16ae931b73c",87:"31d6cfe0d16ae931b73c",88:"31d6cfe0d16ae931b73c",89:"31d6cfe0d16ae931b73c",90:"0df2f875bc90bc6cd1d9",91:"31d6cfe0d16ae931b73c",92:"31d6cfe0d16ae931b73c",93:"7d597dbf2be15112dc4d",94:"31d6cfe0d16ae931b73c",95:"31d6cfe0d16ae931b73c",96:"31d6cfe0d16ae931b73c",97:"31d6cfe0d16ae931b73c",98:"31d6cfe0d16ae931b73c",99:"31d6cfe0d16ae931b73c",100:"3426b13474ee06511541",101:"31d6cfe0d16ae931b73c",102:"31d6cfe0d16ae931b73c",103:"31d6cfe0d16ae931b73c",104:"31d6cfe0d16ae931b73c",105:"31d6cfe0d16ae931b73c",106:"31d6cfe0d16ae931b73c",107:"31d6cfe0d16ae931b73c",108:"31d6cfe0d16ae931b73c",109:"31d6cfe0d16ae931b73c",110:"31d6cfe0d16ae931b73c",111:"31d6cfe0d16ae931b73c",112:"31d6cfe0d16ae931b73c",113:"31d6cfe0d16ae931b73c",114:"31d6cfe0d16ae931b73c",115:"31d6cfe0d16ae931b73c",116:"31d6cfe0d16ae931b73c",117:"31d6cfe0d16ae931b73c",118:"17e9689b579b42b42f54",119:"31d6cfe0d16ae931b73c",120:"986be05ad1a1999b9fbd",121:"31d6cfe0d16ae931b73c",122:"31d6cfe0d16ae931b73c",123:"31d6cfe0d16ae931b73c",124:"31d6cfe0d16ae931b73c",125:"31d6cfe0d16ae931b73c",126:"31d6cfe0d16ae931b73c",127:"31d6cfe0d16ae931b73c",128:"31d6cfe0d16ae931b73c",129:"31d6cfe0d16ae931b73c",130:"31d6cfe0d16ae931b73c",131:"31d6cfe0d16ae931b73c",132:"31d6cfe0d16ae931b73c",133:"31d6cfe0d16ae931b73c",134:"31d6cfe0d16ae931b73c",136:"ec162b3a117cc182f843",137:"ca2c8e27fa1219fd2045",138:"31d6cfe0d16ae931b73c",139:"0204c2912294804195aa",140:"5f18874a2cd62755d12e",141:"a431b4da94b002d571b8",142:"31d6cfe0d16ae931b73c",143:"31d6cfe0d16ae931b73c",144:"31d6cfe0d16ae931b73c",145:"31d6cfe0d16ae931b73c",146:"31d6cfe0d16ae931b73c",147:"31d6cfe0d16ae931b73c",148:"4af15026cfd35658fac5",149:"31d6cfe0d16ae931b73c",150:"31d6cfe0d16ae931b73c",151:"530a88dd2a91db3d250e",152:"aabb3162ca01d8de70a5",153:"aabb3162ca01d8de70a5",154:"31d6cfe0d16ae931b73c",155:"31d6cfe0d16ae931b73c",156:"31d6cfe0d16ae931b73c",157:"31d6cfe0d16ae931b73c",158:"31d6cfe0d16ae931b73c",159:"31d6cfe0d16ae931b73c",160:"31d6cfe0d16ae931b73c",161:"31d6cfe0d16ae931b73c",162:"31d6cfe0d16ae931b73c",163:"31d6cfe0d16ae931b73c",164:"31d6cfe0d16ae931b73c",165:"31d6cfe0d16ae931b73c",166:"31d6cfe0d16ae931b73c",167:"31d6cfe0d16ae931b73c",168:"a3cef315965dc11d4c5c",169:"31d6cfe0d16ae931b73c",170:"31d6cfe0d16ae931b73c",171:"31d6cfe0d16ae931b73c",172:"31d6cfe0d16ae931b73c",173:"31d6cfe0d16ae931b73c",174:"df4779d216e398345652",175:"df4779d216e398345652",176:"31d6cfe0d16ae931b73c",177:"e79a2d51d9dfd8a3b78b",178:"31d6cfe0d16ae931b73c",179:"31d6cfe0d16ae931b73c",180:"31d6cfe0d16ae931b73c",181:"d2384a4b91b259a1e867",182:"31d6cfe0d16ae931b73c",183:"31d6cfe0d16ae931b73c",184:"31d6cfe0d16ae931b73c",185:"31d6cfe0d16ae931b73c",186:"31d6cfe0d16ae931b73c",187:"31d6cfe0d16ae931b73c",188:"31d6cfe0d16ae931b73c",189:"31d6cfe0d16ae931b73c",190:"31d6cfe0d16ae931b73c",191:"31d6cfe0d16ae931b73c",192:"31d6cfe0d16ae931b73c",193:"31d6cfe0d16ae931b73c",194:"31d6cfe0d16ae931b73c",195:"31d6cfe0d16ae931b73c",196:"31d6cfe0d16ae931b73c",197:"31d6cfe0d16ae931b73c",198:"31d6cfe0d16ae931b73c",199:"31d6cfe0d16ae931b73c",200:"31d6cfe0d16ae931b73c",201:"31d6cfe0d16ae931b73c",202:"31d6cfe0d16ae931b73c",203:"31d6cfe0d16ae931b73c",204:"31d6cfe0d16ae931b73c",205:"31d6cfe0d16ae931b73c",206:"31d6cfe0d16ae931b73c",207:"31d6cfe0d16ae931b73c",208:"31d6cfe0d16ae931b73c",209:"31d6cfe0d16ae931b73c",210:"31d6cfe0d16ae931b73c",211:"31d6cfe0d16ae931b73c",212:"31d6cfe0d16ae931b73c",213:"31d6cfe0d16ae931b73c",214:"31d6cfe0d16ae931b73c",215:"31d6cfe0d16ae931b73c",216:"31d6cfe0d16ae931b73c",217:"31d6cfe0d16ae931b73c",218:"31d6cfe0d16ae931b73c",219:"31d6cfe0d16ae931b73c",220:"31d6cfe0d16ae931b73c",221:"31d6cfe0d16ae931b73c",222:"31d6cfe0d16ae931b73c",223:"31d6cfe0d16ae931b73c",224:"31d6cfe0d16ae931b73c",225:"31d6cfe0d16ae931b73c",226:"31d6cfe0d16ae931b73c",227:"31d6cfe0d16ae931b73c",228:"31d6cfe0d16ae931b73c",229:"31d6cfe0d16ae931b73c",230:"31d6cfe0d16ae931b73c",231:"31d6cfe0d16ae931b73c",232:"31d6cfe0d16ae931b73c",233:"31d6cfe0d16ae931b73c",234:"31d6cfe0d16ae931b73c",235:"31d6cfe0d16ae931b73c",236:"31d6cfe0d16ae931b73c",237:"31d6cfe0d16ae931b73c",238:"31d6cfe0d16ae931b73c",239:"31d6cfe0d16ae931b73c",240:"31d6cfe0d16ae931b73c",241:"31d6cfe0d16ae931b73c",242:"31d6cfe0d16ae931b73c",243:"31d6cfe0d16ae931b73c",244:"31d6cfe0d16ae931b73c",245:"31d6cfe0d16ae931b73c",246:"31d6cfe0d16ae931b73c",247:"31d6cfe0d16ae931b73c",248:"31d6cfe0d16ae931b73c",249:"31d6cfe0d16ae931b73c",250:"31d6cfe0d16ae931b73c",251:"31d6cfe0d16ae931b73c",252:"31d6cfe0d16ae931b73c",253:"31d6cfe0d16ae931b73c",254:"31d6cfe0d16ae931b73c",255:"31d6cfe0d16ae931b73c",256:"31d6cfe0d16ae931b73c",257:"31d6cfe0d16ae931b73c",258:"31d6cfe0d16ae931b73c",259:"31d6cfe0d16ae931b73c",260:"31d6cfe0d16ae931b73c",261:"31d6cfe0d16ae931b73c",262:"31d6cfe0d16ae931b73c",263:"31d6cfe0d16ae931b73c",264:"31d6cfe0d16ae931b73c",265:"31d6cfe0d16ae931b73c",266:"31d6cfe0d16ae931b73c",267:"31d6cfe0d16ae931b73c",268:"31d6cfe0d16ae931b73c",269:"31d6cfe0d16ae931b73c",270:"31d6cfe0d16ae931b73c",271:"31d6cfe0d16ae931b73c",272:"31d6cfe0d16ae931b73c",273:"31d6cfe0d16ae931b73c",274:"31d6cfe0d16ae931b73c",275:"31d6cfe0d16ae931b73c",276:"31d6cfe0d16ae931b73c",277:"31d6cfe0d16ae931b73c",278:"31d6cfe0d16ae931b73c",279:"31d6cfe0d16ae931b73c",280:"31d6cfe0d16ae931b73c",281:"31d6cfe0d16ae931b73c",282:"31d6cfe0d16ae931b73c",283:"31d6cfe0d16ae931b73c",284:"31d6cfe0d16ae931b73c",285:"31d6cfe0d16ae931b73c",286:"31d6cfe0d16ae931b73c",287:"31d6cfe0d16ae931b73c",288:"31d6cfe0d16ae931b73c",289:"31d6cfe0d16ae931b73c",290:"31d6cfe0d16ae931b73c",291:"31d6cfe0d16ae931b73c",292:"31d6cfe0d16ae931b73c",293:"31d6cfe0d16ae931b73c",294:"31d6cfe0d16ae931b73c",295:"31d6cfe0d16ae931b73c",296:"31d6cfe0d16ae931b73c",297:"31d6cfe0d16ae931b73c",298:"31d6cfe0d16ae931b73c",299:"31d6cfe0d16ae931b73c",300:"31d6cfe0d16ae931b73c",301:"2b85442a3b0af53ce369",302:"31d6cfe0d16ae931b73c",303:"31d6cfe0d16ae931b73c",304:"31d6cfe0d16ae931b73c",305:"31d6cfe0d16ae931b73c",306:"31d6cfe0d16ae931b73c",307:"31d6cfe0d16ae931b73c",308:"31d6cfe0d16ae931b73c",309:"31d6cfe0d16ae931b73c",310:"31d6cfe0d16ae931b73c",311:"31d6cfe0d16ae931b73c",312:"31d6cfe0d16ae931b73c",313:"31d6cfe0d16ae931b73c",314:"31d6cfe0d16ae931b73c",315:"31d6cfe0d16ae931b73c",316:"31d6cfe0d16ae931b73c",317:"31d6cfe0d16ae931b73c",318:"31d6cfe0d16ae931b73c",319:"31d6cfe0d16ae931b73c",320:"31d6cfe0d16ae931b73c",321:"31d6cfe0d16ae931b73c",322:"31d6cfe0d16ae931b73c",323:"31d6cfe0d16ae931b73c",324:"31d6cfe0d16ae931b73c",325:"31d6cfe0d16ae931b73c",326:"31d6cfe0d16ae931b73c",327:"31d6cfe0d16ae931b73c",328:"31d6cfe0d16ae931b73c",329:"31d6cfe0d16ae931b73c",330:"31d6cfe0d16ae931b73c",331:"31d6cfe0d16ae931b73c",332:"31d6cfe0d16ae931b73c",333:"31d6cfe0d16ae931b73c",334:"31d6cfe0d16ae931b73c",335:"31d6cfe0d16ae931b73c",336:"31d6cfe0d16ae931b73c",337:"31d6cfe0d16ae931b73c",338:"31d6cfe0d16ae931b73c",339:"31d6cfe0d16ae931b73c",340:"31d6cfe0d16ae931b73c",341:"31d6cfe0d16ae931b73c",342:"31d6cfe0d16ae931b73c",343:"31d6cfe0d16ae931b73c",344:"31d6cfe0d16ae931b73c",345:"31d6cfe0d16ae931b73c",346:"31d6cfe0d16ae931b73c",347:"31d6cfe0d16ae931b73c",348:"31d6cfe0d16ae931b73c",349:"31d6cfe0d16ae931b73c",350:"31d6cfe0d16ae931b73c",351:"31d6cfe0d16ae931b73c",352:"31d6cfe0d16ae931b73c",353:"31d6cfe0d16ae931b73c",354:"31d6cfe0d16ae931b73c",355:"31d6cfe0d16ae931b73c",356:"31d6cfe0d16ae931b73c",357:"31d6cfe0d16ae931b73c",358:"31d6cfe0d16ae931b73c",359:"31d6cfe0d16ae931b73c",360:"31d6cfe0d16ae931b73c",361:"31d6cfe0d16ae931b73c",362:"31d6cfe0d16ae931b73c",363:"31d6cfe0d16ae931b73c",364:"31d6cfe0d16ae931b73c",365:"31d6cfe0d16ae931b73c",366:"31d6cfe0d16ae931b73c",367:"31d6cfe0d16ae931b73c",368:"31d6cfe0d16ae931b73c",369:"31d6cfe0d16ae931b73c",370:"31d6cfe0d16ae931b73c",371:"31d6cfe0d16ae931b73c",372:"31d6cfe0d16ae931b73c",373:"31d6cfe0d16ae931b73c",374:"31d6cfe0d16ae931b73c",375:"31d6cfe0d16ae931b73c",376:"31d6cfe0d16ae931b73c",377:"31d6cfe0d16ae931b73c",378:"31d6cfe0d16ae931b73c",379:"31d6cfe0d16ae931b73c",380:"31d6cfe0d16ae931b73c",381:"31d6cfe0d16ae931b73c",382:"31d6cfe0d16ae931b73c",383:"31d6cfe0d16ae931b73c",384:"31d6cfe0d16ae931b73c",385:"31d6cfe0d16ae931b73c",386:"31d6cfe0d16ae931b73c",387:"31d6cfe0d16ae931b73c",388:"31d6cfe0d16ae931b73c",389:"31d6cfe0d16ae931b73c",390:"31d6cfe0d16ae931b73c",391:"31d6cfe0d16ae931b73c",392:"31d6cfe0d16ae931b73c",393:"31d6cfe0d16ae931b73c",394:"31d6cfe0d16ae931b73c",395:"31d6cfe0d16ae931b73c",396:"31d6cfe0d16ae931b73c",397:"31d6cfe0d16ae931b73c",398:"31d6cfe0d16ae931b73c",399:"31d6cfe0d16ae931b73c",400:"31d6cfe0d16ae931b73c",401:"31d6cfe0d16ae931b73c",402:"31d6cfe0d16ae931b73c",403:"31d6cfe0d16ae931b73c",404:"31d6cfe0d16ae931b73c",405:"31d6cfe0d16ae931b73c",406:"31d6cfe0d16ae931b73c",407:"31d6cfe0d16ae931b73c",408:"31d6cfe0d16ae931b73c",409:"31d6cfe0d16ae931b73c",410:"31d6cfe0d16ae931b73c",411:"31d6cfe0d16ae931b73c",412:"31d6cfe0d16ae931b73c",413:"31d6cfe0d16ae931b73c",414:"31d6cfe0d16ae931b73c",415:"31d6cfe0d16ae931b73c",416:"31d6cfe0d16ae931b73c",417:"31d6cfe0d16ae931b73c",418:"31d6cfe0d16ae931b73c",419:"31d6cfe0d16ae931b73c",420:"31d6cfe0d16ae931b73c",421:"31d6cfe0d16ae931b73c",422:"31d6cfe0d16ae931b73c",423:"31d6cfe0d16ae931b73c",424:"31d6cfe0d16ae931b73c",425:"31d6cfe0d16ae931b73c",426:"31d6cfe0d16ae931b73c",427:"31d6cfe0d16ae931b73c",428:"31d6cfe0d16ae931b73c",429:"31d6cfe0d16ae931b73c",430:"31d6cfe0d16ae931b73c",431:"31d6cfe0d16ae931b73c",432:"31d6cfe0d16ae931b73c",433:"31d6cfe0d16ae931b73c",434:"31d6cfe0d16ae931b73c",435:"31d6cfe0d16ae931b73c",436:"31d6cfe0d16ae931b73c",437:"31d6cfe0d16ae931b73c",438:"31d6cfe0d16ae931b73c",439:"31d6cfe0d16ae931b73c",440:"31d6cfe0d16ae931b73c",441:"31d6cfe0d16ae931b73c",442:"31d6cfe0d16ae931b73c",443:"31d6cfe0d16ae931b73c",444:"31d6cfe0d16ae931b73c",445:"31d6cfe0d16ae931b73c",446:"31d6cfe0d16ae931b73c",447:"31d6cfe0d16ae931b73c",448:"31d6cfe0d16ae931b73c",449:"31d6cfe0d16ae931b73c",450:"31d6cfe0d16ae931b73c",451:"31d6cfe0d16ae931b73c",452:"31d6cfe0d16ae931b73c",453:"31d6cfe0d16ae931b73c",454:"31d6cfe0d16ae931b73c",455:"31d6cfe0d16ae931b73c",456:"31d6cfe0d16ae931b73c",457:"31d6cfe0d16ae931b73c",458:"31d6cfe0d16ae931b73c",459:"31d6cfe0d16ae931b73c",460:"31d6cfe0d16ae931b73c",461:"31d6cfe0d16ae931b73c",462:"31d6cfe0d16ae931b73c",463:"31d6cfe0d16ae931b73c",464:"31d6cfe0d16ae931b73c",465:"31d6cfe0d16ae931b73c",466:"31d6cfe0d16ae931b73c",467:"31d6cfe0d16ae931b73c",468:"31d6cfe0d16ae931b73c",469:"31d6cfe0d16ae931b73c",470:"31d6cfe0d16ae931b73c",471:"31d6cfe0d16ae931b73c",472:"31d6cfe0d16ae931b73c",473:"31d6cfe0d16ae931b73c",474:"31d6cfe0d16ae931b73c",475:"31d6cfe0d16ae931b73c",476:"31d6cfe0d16ae931b73c",477:"31d6cfe0d16ae931b73c",478:"31d6cfe0d16ae931b73c",479:"31d6cfe0d16ae931b73c",480:"31d6cfe0d16ae931b73c",481:"31d6cfe0d16ae931b73c",482:"31d6cfe0d16ae931b73c",483:"31d6cfe0d16ae931b73c",484:"31d6cfe0d16ae931b73c",485:"31d6cfe0d16ae931b73c",486:"31d6cfe0d16ae931b73c",487:"31d6cfe0d16ae931b73c",488:"31d6cfe0d16ae931b73c",489:"31d6cfe0d16ae931b73c",490:"31d6cfe0d16ae931b73c",491:"31d6cfe0d16ae931b73c",492:"31d6cfe0d16ae931b73c",493:"31d6cfe0d16ae931b73c",494:"31d6cfe0d16ae931b73c",495:"31d6cfe0d16ae931b73c",496:"31d6cfe0d16ae931b73c",497:"31d6cfe0d16ae931b73c",498:"31d6cfe0d16ae931b73c",499:"31d6cfe0d16ae931b73c",500:"31d6cfe0d16ae931b73c",501:"31d6cfe0d16ae931b73c",502:"31d6cfe0d16ae931b73c",503:"31d6cfe0d16ae931b73c",504:"31d6cfe0d16ae931b73c",505:"31d6cfe0d16ae931b73c",506:"31d6cfe0d16ae931b73c",507:"31d6cfe0d16ae931b73c",508:"31d6cfe0d16ae931b73c",509:"31d6cfe0d16ae931b73c",510:"31d6cfe0d16ae931b73c",511:"31d6cfe0d16ae931b73c",512:"31d6cfe0d16ae931b73c",513:"31d6cfe0d16ae931b73c",514:"31d6cfe0d16ae931b73c",515:"31d6cfe0d16ae931b73c",516:"31d6cfe0d16ae931b73c",517:"31d6cfe0d16ae931b73c",518:"31d6cfe0d16ae931b73c",519:"31d6cfe0d16ae931b73c",520:"31d6cfe0d16ae931b73c",521:"31d6cfe0d16ae931b73c",522:"31d6cfe0d16ae931b73c",523:"31d6cfe0d16ae931b73c",524:"31d6cfe0d16ae931b73c",525:"31d6cfe0d16ae931b73c",526:"31d6cfe0d16ae931b73c",527:"31d6cfe0d16ae931b73c",528:"31d6cfe0d16ae931b73c",529:"31d6cfe0d16ae931b73c",530:"31d6cfe0d16ae931b73c",531:"31d6cfe0d16ae931b73c",532:"31d6cfe0d16ae931b73c",533:"31d6cfe0d16ae931b73c",534:"31d6cfe0d16ae931b73c",535:"31d6cfe0d16ae931b73c",536:"31d6cfe0d16ae931b73c",537:"31d6cfe0d16ae931b73c",538:"31d6cfe0d16ae931b73c",539:"31d6cfe0d16ae931b73c",540:"31d6cfe0d16ae931b73c",541:"31d6cfe0d16ae931b73c",542:"31d6cfe0d16ae931b73c",543:"31d6cfe0d16ae931b73c",544:"31d6cfe0d16ae931b73c",545:"31d6cfe0d16ae931b73c",546:"31d6cfe0d16ae931b73c",547:"31d6cfe0d16ae931b73c",548:"31d6cfe0d16ae931b73c",549:"31d6cfe0d16ae931b73c",550:"31d6cfe0d16ae931b73c",551:"31d6cfe0d16ae931b73c",552:"31d6cfe0d16ae931b73c",553:"31d6cfe0d16ae931b73c",554:"31d6cfe0d16ae931b73c",555:"31d6cfe0d16ae931b73c",556:"31d6cfe0d16ae931b73c",557:"31d6cfe0d16ae931b73c",558:"31d6cfe0d16ae931b73c",559:"31d6cfe0d16ae931b73c",560:"31d6cfe0d16ae931b73c",561:"31d6cfe0d16ae931b73c",562:"31d6cfe0d16ae931b73c",563:"31d6cfe0d16ae931b73c",564:"31d6cfe0d16ae931b73c",565:"31d6cfe0d16ae931b73c",566:"7e4431d02c76777d3eb3",567:"31d6cfe0d16ae931b73c",568:"31d6cfe0d16ae931b73c",569:"31d6cfe0d16ae931b73c",570:"31d6cfe0d16ae931b73c",571:"31d6cfe0d16ae931b73c",572:"31d6cfe0d16ae931b73c",573:"31d6cfe0d16ae931b73c",574:"31d6cfe0d16ae931b73c",575:"dbb578b07e34b759f2b2",576:"31d6cfe0d16ae931b73c",577:"31d6cfe0d16ae931b73c",578:"2781c83dfc80c6276e2f",579:"31d6cfe0d16ae931b73c",580:"31d6cfe0d16ae931b73c",581:"31d6cfe0d16ae931b73c",582:"31d6cfe0d16ae931b73c",583:"31d6cfe0d16ae931b73c",584:"31d6cfe0d16ae931b73c",585:"31d6cfe0d16ae931b73c",586:"31d6cfe0d16ae931b73c",587:"397f730ada5c16c31c29",588:"31d6cfe0d16ae931b73c",589:"31d6cfe0d16ae931b73c",590:"31d6cfe0d16ae931b73c",592:"31d6cfe0d16ae931b73c",593:"31d6cfe0d16ae931b73c",594:"b6775cc19d58380ed558",595:"27d302d892f2a0f0150c",596:"27d302d892f2a0f0150c",597:"31d6cfe0d16ae931b73c",598:"31d6cfe0d16ae931b73c",599:"bbbc105b7b9dd8e9c85e",600:"31d6cfe0d16ae931b73c",601:"31d6cfe0d16ae931b73c",602:"31d6cfe0d16ae931b73c",603:"31d6cfe0d16ae931b73c",604:"31d6cfe0d16ae931b73c",605:"31d6cfe0d16ae931b73c",606:"31d6cfe0d16ae931b73c",607:"31d6cfe0d16ae931b73c",608:"31d6cfe0d16ae931b73c",609:"31d6cfe0d16ae931b73c",610:"31d6cfe0d16ae931b73c",611:"31d6cfe0d16ae931b73c",612:"31d6cfe0d16ae931b73c",613:"31d6cfe0d16ae931b73c",614:"31d6cfe0d16ae931b73c",615:"ab582969ca7f965c6374",616:"16ffd87724de6f831ddb",617:"31d6cfe0d16ae931b73c",618:"31d6cfe0d16ae931b73c",619:"31d6cfe0d16ae931b73c",620:"31d6cfe0d16ae931b73c",621:"31d6cfe0d16ae931b73c",622:"808f5bd3dfac8452635a",623:"31d6cfe0d16ae931b73c",625:"31d6cfe0d16ae931b73c",626:"228cc219ccdfc134f8d7",627:"31d6cfe0d16ae931b73c",628:"31d6cfe0d16ae931b73c",629:"31d6cfe0d16ae931b73c",630:"31d6cfe0d16ae931b73c",631:"31d6cfe0d16ae931b73c",632:"31d6cfe0d16ae931b73c",633:"dfeba6d2f30a569fc8bd",634:"31d6cfe0d16ae931b73c",635:"0f2064c93ac77fff349a",636:"31d6cfe0d16ae931b73c",637:"31d6cfe0d16ae931b73c",638:"31d6cfe0d16ae931b73c",639:"31d6cfe0d16ae931b73c",640:"31d6cfe0d16ae931b73c",641:"31d6cfe0d16ae931b73c",642:"31d6cfe0d16ae931b73c",643:"ad3b5b85cb33094db2f9",644:"31d6cfe0d16ae931b73c",645:"79e9c3cc789944885d6b",646:"31d6cfe0d16ae931b73c",647:"31d6cfe0d16ae931b73c",648:"31d6cfe0d16ae931b73c",649:"31d6cfe0d16ae931b73c",650:"31d6cfe0d16ae931b73c",651:"31d6cfe0d16ae931b73c",652:"31d6cfe0d16ae931b73c",653:"31d6cfe0d16ae931b73c",654:"fbe9697bcf129d81061f",655:"31d6cfe0d16ae931b73c",656:"31d6cfe0d16ae931b73c",657:"31d6cfe0d16ae931b73c",658:"31d6cfe0d16ae931b73c",659:"31d6cfe0d16ae931b73c",660:"31d6cfe0d16ae931b73c",661:"31d6cfe0d16ae931b73c",662:"31d6cfe0d16ae931b73c",663:"31d6cfe0d16ae931b73c",664:"a5277f50d4e9aad9d1ca",665:"31d6cfe0d16ae931b73c",666:"b3dcc33c7607ec42a8cb",667:"604d3a9f217b81b1ce24",668:"31d6cfe0d16ae931b73c",669:"31d6cfe0d16ae931b73c",670:"31d6cfe0d16ae931b73c",671:"31d6cfe0d16ae931b73c",672:"31d6cfe0d16ae931b73c",673:"31d6cfe0d16ae931b73c",674:"31d6cfe0d16ae931b73c",675:"1c7bf52aea5b5661229e",676:"31d6cfe0d16ae931b73c",677:"31d6cfe0d16ae931b73c",678:"31d6cfe0d16ae931b73c",679:"31d6cfe0d16ae931b73c",680:"31d6cfe0d16ae931b73c",681:"31d6cfe0d16ae931b73c",682:"31d6cfe0d16ae931b73c",683:"31d6cfe0d16ae931b73c",684:"31d6cfe0d16ae931b73c",685:"31d6cfe0d16ae931b73c",686:"31d6cfe0d16ae931b73c",687:"31d6cfe0d16ae931b73c",688:"31d6cfe0d16ae931b73c",689:"31d6cfe0d16ae931b73c",690:"31d6cfe0d16ae931b73c",691:"31d6cfe0d16ae931b73c",692:"31d6cfe0d16ae931b73c",693:"31d6cfe0d16ae931b73c",694:"31d6cfe0d16ae931b73c",695:"31d6cfe0d16ae931b73c",696:"31d6cfe0d16ae931b73c",697:"31d6cfe0d16ae931b73c",698:"31d6cfe0d16ae931b73c",699:"7737d38c10393c2c1404",700:"31d6cfe0d16ae931b73c",701:"31d6cfe0d16ae931b73c",702:"31d6cfe0d16ae931b73c",703:"31d6cfe0d16ae931b73c",704:"31d6cfe0d16ae931b73c",705:"31d6cfe0d16ae931b73c",706:"31d6cfe0d16ae931b73c",707:"31d6cfe0d16ae931b73c",708:"31d6cfe0d16ae931b73c",709:"31d6cfe0d16ae931b73c",710:"31d6cfe0d16ae931b73c",711:"31d6cfe0d16ae931b73c",712:"31d6cfe0d16ae931b73c",713:"07b16f4e064b8271c0a7",714:"31d6cfe0d16ae931b73c",715:"31d6cfe0d16ae931b73c",716:"31d6cfe0d16ae931b73c",717:"31d6cfe0d16ae931b73c",718:"31d6cfe0d16ae931b73c",719:"31d6cfe0d16ae931b73c",720:"31d6cfe0d16ae931b73c",721:"31d6cfe0d16ae931b73c",722:"31d6cfe0d16ae931b73c",723:"31d6cfe0d16ae931b73c",724:"31d6cfe0d16ae931b73c",725:"31d6cfe0d16ae931b73c",726:"31d6cfe0d16ae931b73c",727:"31d6cfe0d16ae931b73c",728:"31d6cfe0d16ae931b73c",729:"31d6cfe0d16ae931b73c",730:"31d6cfe0d16ae931b73c",731:"31d6cfe0d16ae931b73c",732:"31d6cfe0d16ae931b73c",733:"31d6cfe0d16ae931b73c",734:"31d6cfe0d16ae931b73c",735:"31d6cfe0d16ae931b73c",736:"31d6cfe0d16ae931b73c",737:"31d6cfe0d16ae931b73c",738:"0295bb292c0dd07d23b2",739:"31d6cfe0d16ae931b73c",740:"31d6cfe0d16ae931b73c",741:"31d6cfe0d16ae931b73c",742:"31d6cfe0d16ae931b73c",743:"31d6cfe0d16ae931b73c",744:"31d6cfe0d16ae931b73c",745:"31d6cfe0d16ae931b73c",746:"31d6cfe0d16ae931b73c",747:"31d6cfe0d16ae931b73c",748:"31d6cfe0d16ae931b73c",749:"31d6cfe0d16ae931b73c",750:"31d6cfe0d16ae931b73c",751:"31d6cfe0d16ae931b73c",752:"31d6cfe0d16ae931b73c",753:"31d6cfe0d16ae931b73c",754:"31d6cfe0d16ae931b73c",755:"31d6cfe0d16ae931b73c",756:"31d6cfe0d16ae931b73c",757:"31d6cfe0d16ae931b73c",758:"31d6cfe0d16ae931b73c",759:"31d6cfe0d16ae931b73c",760:"31d6cfe0d16ae931b73c",761:"31d6cfe0d16ae931b73c",762:"31d6cfe0d16ae931b73c",763:"31d6cfe0d16ae931b73c",764:"31d6cfe0d16ae931b73c",765:"31d6cfe0d16ae931b73c",766:"31d6cfe0d16ae931b73c",767:"31d6cfe0d16ae931b73c",768:"31d6cfe0d16ae931b73c",769:"31d6cfe0d16ae931b73c",770:"31d6cfe0d16ae931b73c",771:"31d6cfe0d16ae931b73c",772:"31d6cfe0d16ae931b73c",773:"31d6cfe0d16ae931b73c",774:"31d6cfe0d16ae931b73c",775:"31d6cfe0d16ae931b73c",776:"31d6cfe0d16ae931b73c",777:"31d6cfe0d16ae931b73c",778:"31d6cfe0d16ae931b73c",779:"31d6cfe0d16ae931b73c",780:"31d6cfe0d16ae931b73c",781:"31d6cfe0d16ae931b73c",782:"31d6cfe0d16ae931b73c",783:"31d6cfe0d16ae931b73c",784:"31d6cfe0d16ae931b73c",785:"31d6cfe0d16ae931b73c",786:"31d6cfe0d16ae931b73c",787:"31d6cfe0d16ae931b73c",788:"31d6cfe0d16ae931b73c",789:"31d6cfe0d16ae931b73c",790:"31d6cfe0d16ae931b73c",791:"31d6cfe0d16ae931b73c",792:"31d6cfe0d16ae931b73c",793:"31d6cfe0d16ae931b73c",794:"31d6cfe0d16ae931b73c",795:"31d6cfe0d16ae931b73c",796:"31d6cfe0d16ae931b73c",797:"31d6cfe0d16ae931b73c",798:"31d6cfe0d16ae931b73c",799:"31d6cfe0d16ae931b73c",800:"31d6cfe0d16ae931b73c",801:"31d6cfe0d16ae931b73c",802:"31d6cfe0d16ae931b73c",803:"31d6cfe0d16ae931b73c",804:"31d6cfe0d16ae931b73c",805:"31d6cfe0d16ae931b73c",806:"31d6cfe0d16ae931b73c",807:"31d6cfe0d16ae931b73c",808:"31d6cfe0d16ae931b73c",809:"31d6cfe0d16ae931b73c",810:"31d6cfe0d16ae931b73c",811:"31d6cfe0d16ae931b73c",812:"31d6cfe0d16ae931b73c",813:"31d6cfe0d16ae931b73c",814:"31d6cfe0d16ae931b73c",815:"31d6cfe0d16ae931b73c",816:"31d6cfe0d16ae931b73c",817:"31d6cfe0d16ae931b73c",818:"31d6cfe0d16ae931b73c",819:"31d6cfe0d16ae931b73c",820:"31d6cfe0d16ae931b73c",821:"31d6cfe0d16ae931b73c",822:"31d6cfe0d16ae931b73c",823:"31d6cfe0d16ae931b73c",824:"31d6cfe0d16ae931b73c",825:"31d6cfe0d16ae931b73c",826:"31d6cfe0d16ae931b73c",827:"31d6cfe0d16ae931b73c",828:"31d6cfe0d16ae931b73c",829:"31d6cfe0d16ae931b73c",830:"31d6cfe0d16ae931b73c",831:"31d6cfe0d16ae931b73c",832:"31d6cfe0d16ae931b73c",833:"31d6cfe0d16ae931b73c",834:"31d6cfe0d16ae931b73c",835:"31d6cfe0d16ae931b73c",836:"31d6cfe0d16ae931b73c",837:"31d6cfe0d16ae931b73c",838:"31d6cfe0d16ae931b73c",839:"31d6cfe0d16ae931b73c",840:"31d6cfe0d16ae931b73c",841:"31d6cfe0d16ae931b73c",842:"31d6cfe0d16ae931b73c",843:"31d6cfe0d16ae931b73c",844:"31d6cfe0d16ae931b73c",845:"31d6cfe0d16ae931b73c",846:"31d6cfe0d16ae931b73c",847:"31d6cfe0d16ae931b73c",848:"31d6cfe0d16ae931b73c",849:"31d6cfe0d16ae931b73c",850:"31d6cfe0d16ae931b73c",851:"31d6cfe0d16ae931b73c",852:"31d6cfe0d16ae931b73c",853:"31d6cfe0d16ae931b73c",854:"31d6cfe0d16ae931b73c",855:"31d6cfe0d16ae931b73c",856:"31d6cfe0d16ae931b73c",857:"31d6cfe0d16ae931b73c",858:"31d6cfe0d16ae931b73c",859:"31d6cfe0d16ae931b73c",860:"31d6cfe0d16ae931b73c",861:"31d6cfe0d16ae931b73c",862:"31d6cfe0d16ae931b73c",863:"31d6cfe0d16ae931b73c",864:"31d6cfe0d16ae931b73c",865:"31d6cfe0d16ae931b73c",866:"31d6cfe0d16ae931b73c",867:"31d6cfe0d16ae931b73c",868:"31d6cfe0d16ae931b73c",869:"31d6cfe0d16ae931b73c",870:"31d6cfe0d16ae931b73c",871:"31d6cfe0d16ae931b73c",872:"31d6cfe0d16ae931b73c",873:"31d6cfe0d16ae931b73c",874:"31d6cfe0d16ae931b73c",875:"31d6cfe0d16ae931b73c",876:"31d6cfe0d16ae931b73c",877:"31d6cfe0d16ae931b73c",878:"31d6cfe0d16ae931b73c",879:"31d6cfe0d16ae931b73c",880:"31d6cfe0d16ae931b73c",881:"31d6cfe0d16ae931b73c",882:"31d6cfe0d16ae931b73c",883:"31d6cfe0d16ae931b73c",884:"31d6cfe0d16ae931b73c",885:"31d6cfe0d16ae931b73c",886:"31d6cfe0d16ae931b73c",887:"31d6cfe0d16ae931b73c",888:"31d6cfe0d16ae931b73c",889:"31d6cfe0d16ae931b73c",890:"31d6cfe0d16ae931b73c",891:"31d6cfe0d16ae931b73c",892:"31d6cfe0d16ae931b73c",893:"31d6cfe0d16ae931b73c",894:"31d6cfe0d16ae931b73c",895:"31d6cfe0d16ae931b73c",896:"31d6cfe0d16ae931b73c",897:"31d6cfe0d16ae931b73c",898:"31d6cfe0d16ae931b73c",899:"31d6cfe0d16ae931b73c",900:"31d6cfe0d16ae931b73c",901:"31d6cfe0d16ae931b73c",902:"31d6cfe0d16ae931b73c",903:"31d6cfe0d16ae931b73c",904:"31d6cfe0d16ae931b73c",905:"31d6cfe0d16ae931b73c",906:"31d6cfe0d16ae931b73c",907:"31d6cfe0d16ae931b73c",908:"31d6cfe0d16ae931b73c",909:"31d6cfe0d16ae931b73c",910:"31d6cfe0d16ae931b73c",911:"31d6cfe0d16ae931b73c",912:"31d6cfe0d16ae931b73c",913:"31d6cfe0d16ae931b73c",914:"31d6cfe0d16ae931b73c",915:"31d6cfe0d16ae931b73c",916:"31d6cfe0d16ae931b73c",917:"31d6cfe0d16ae931b73c",918:"31d6cfe0d16ae931b73c",919:"31d6cfe0d16ae931b73c",920:"31d6cfe0d16ae931b73c",921:"31d6cfe0d16ae931b73c",922:"31d6cfe0d16ae931b73c",923:"31d6cfe0d16ae931b73c",924:"31d6cfe0d16ae931b73c",925:"31d6cfe0d16ae931b73c",926:"31d6cfe0d16ae931b73c",927:"31d6cfe0d16ae931b73c",928:"31d6cfe0d16ae931b73c",929:"31d6cfe0d16ae931b73c",930:"31d6cfe0d16ae931b73c",931:"31d6cfe0d16ae931b73c",932:"31d6cfe0d16ae931b73c",933:"31d6cfe0d16ae931b73c",934:"31d6cfe0d16ae931b73c",935:"31d6cfe0d16ae931b73c",936:"31d6cfe0d16ae931b73c",937:"31d6cfe0d16ae931b73c",938:"31d6cfe0d16ae931b73c",939:"31d6cfe0d16ae931b73c",940:"31d6cfe0d16ae931b73c",941:"31d6cfe0d16ae931b73c",942:"31d6cfe0d16ae931b73c",943:"31d6cfe0d16ae931b73c",944:"31d6cfe0d16ae931b73c",945:"31d6cfe0d16ae931b73c",946:"31d6cfe0d16ae931b73c",947:"31d6cfe0d16ae931b73c",948:"31d6cfe0d16ae931b73c",949:"31d6cfe0d16ae931b73c",950:"31d6cfe0d16ae931b73c",951:"31d6cfe0d16ae931b73c",952:"31d6cfe0d16ae931b73c",953:"31d6cfe0d16ae931b73c",954:"31d6cfe0d16ae931b73c",955:"31d6cfe0d16ae931b73c",956:"31d6cfe0d16ae931b73c",957:"31d6cfe0d16ae931b73c",958:"31d6cfe0d16ae931b73c",959:"31d6cfe0d16ae931b73c",960:"31d6cfe0d16ae931b73c",961:"31d6cfe0d16ae931b73c",962:"31d6cfe0d16ae931b73c",963:"31d6cfe0d16ae931b73c",964:"31d6cfe0d16ae931b73c",965:"31d6cfe0d16ae931b73c",966:"31d6cfe0d16ae931b73c",967:"31d6cfe0d16ae931b73c",968:"31d6cfe0d16ae931b73c",969:"31d6cfe0d16ae931b73c",970:"31d6cfe0d16ae931b73c",971:"31d6cfe0d16ae931b73c",972:"31d6cfe0d16ae931b73c",973:"31d6cfe0d16ae931b73c",974:"31d6cfe0d16ae931b73c",975:"31d6cfe0d16ae931b73c",976:"31d6cfe0d16ae931b73c",977:"31d6cfe0d16ae931b73c",978:"31d6cfe0d16ae931b73c",979:"31d6cfe0d16ae931b73c",980:"31d6cfe0d16ae931b73c",981:"31d6cfe0d16ae931b73c",982:"31d6cfe0d16ae931b73c",983:"31d6cfe0d16ae931b73c",984:"31d6cfe0d16ae931b73c",985:"31d6cfe0d16ae931b73c",986:"31d6cfe0d16ae931b73c",987:"31d6cfe0d16ae931b73c",988:"31d6cfe0d16ae931b73c",989:"31d6cfe0d16ae931b73c",990:"31d6cfe0d16ae931b73c",991:"31d6cfe0d16ae931b73c",992:"31d6cfe0d16ae931b73c"}[e]+".chunk.v7.css",o=c.p+i,a=document.getElementsByTagName("link"),l=0;l<a.length;l++){var s=(d=a[l]).getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(s===i||s===o))return t()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){var d;if((s=(d=u[l]).getAttribute("data-href"))===i||s===o)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onerror=p.onload=p.href=o,0!==p.href.indexOf(window.location.origin+"/")&&(p.crossOrigin="anonymous"),document.head.appendChild(p)})).then(());var n=o[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise(();t.push(n[2]=i);var a,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=s(e),0!==l.src.indexOf(window.location.origin+"/")&&(l.crossOrigin="anonymous");var u=new Error;a=var d=setTimeout((,12e4);l.onerror=l.onload=a,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=i,c.d=c.r=c.t=c.n=c.o=c.p="",c.oe=var u=window.officehome_webpackJsonp=window.officehome_webpackJsonp||[],d=u.push.bind(u);u.push=t,u=u.slice();for(var p=0;p<u.length;p++)t(u[p]);var f=d;a.push([0,624]),n()}({"+1lv":function(e,t,n){"use strict";n.d(t,"a",(function(){return G})),n.d(t,"c",(function(){return z})),n.d(t,"b",(function(){return K})),n.d(t,"e",(function(){return Y})),n.d(t,"d",(function(){return $}));var i=n("QjXU"),r=n("TPkS"),o=n("J78o"),a=n("aCzR"),l=(n("bgLm"),n("av1u")),s=n("3M/p"),c=n("inRP");function u(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(618).then(n.t.bind(null,"yfDh",7))];case 1:return[2,e.sent().default]}}))}))}function d(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e?[2,new TextEncoder]:[4,u()];case 1:return[2,new(t.sent().TextEncoderLite)]}}))}))}n("V9hE");var p=n("pdjy"),f=n("gB6C"),h=n("ZBSS"),m=n("zGJG"),b=function(){eturn e.prototype.queueEvent=function(e){this.queuedEvents.push(e)},e.prototype.drainQueue=e}(),g=n("uqr+"),v=n("Yvbg"),S=n("Zmq1");function y(e,t){void 0===t&&(t=!1);var n=!1,i=function(i,r){var o=void 0;return t&&r&&(o=r(i)),n||(n=!0,e()),!t&&r&&(o=r(i)),o},r=window.onbeforeunload;window.onbeforeunload=function(e){return i(e,r&&r.bind(window))};var o=Object(S.a)(),a=o.platform.platformType;if(("iPhone"===a||"iPad"===a)&&"Safari"===o.browser.browserType){var l=window.onpagehide;window.onpagehide=function(e){return i(e,l&&l.bind(window))}}}var C,w,T,k,I,_,A,P,E,O,F,D,M,R="",x=!1,L=!1,U="",N=!1,W=!1,j=new b,H=new b,B=new b,G=new Promise((),q="",V="Automation";function z(e){var t=this;return e.oTelEnabled&&e.oTelAriaTenant&&se(e.correlationId,e.sessionId,e.identity.tenantId)&&!W?(N=!0,U=e.oTelAriaNameSpace,Promise.all([Z(p.e),Q(e.appPlatform,p.e)]).then((function(){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return(k=new o.a(void 0,void 0,{enableQueue:e.win11DetectionEnabled})).setTenantToken(e.oTelAriaNameSpace,e.oTelAriaTenant,a.b),[4,ie(e.appName,e.appPlatform,e.appWorkload,e.bundleBuildDate,e.correlationId,e.deploymentEnvironment,e.deviceType,e.flights,e.isCorpNet,e.isTestTraffic,e.sessionId,e.serverLocation,e.requestOrigin,!1,e.identity,e.userSegment,e.ecsRing,e.appWorkloadType,e.networkType,e.serviceWorkerState,e.firstVisitAgeInDays,e.domainOrigin,e.initialPageName,e.dataBoundary,e.preferredCulture)];case 1:return O=n.sent(),e.oTelDiagnosticAriaNameSpace&&e.oTelDiagnosticAriaTenant&&(q=e.oTelDiagnosticAriaNameSpace,(M=new o.a(void 0,void 0,{enableQueue:e.win11DetectionEnabled})).setTenantToken(e.oTelDiagnosticAriaNameSpace,e.oTelDiagnosticAriaTenant,a.b)),t=le(),e.win11DetectionEnabled?X().then((function(n){T=new _(O,{endpointUrl:re(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:t?[new r.a,n]:[n],extensionConfig:t?{PrivacyGuardPlugin:ue(e.oTelAriaNameSpace,e.oTelAriaTenant)}:{}}),J(e.IsSamplingEnabled,e.identity.puid,e.correlationId),k.addSink(T),e.oTelDiagnosticAriaNameSpace&&e.oTelDiagnosticAriaTenant&&(D=new _(O,{endpointUrl:re(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:t?[new r.a]:[],extensionConfig:t?{PrivacyGuardPlugin:ue(e.oTelDiagnosticAriaNameSpace,e.oTelDiagnosticAriaTenant)}:{}}),M.addSink(D)),W=!0,oe(j,Y)})):(T=new _(O,{endpointUrl:re(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:t?[new r.a]:[],extensionConfig:t?{PrivacyGuardPlugin:ue(e.oTelAriaNameSpace,e.oTelAriaTenant)}:{}}),J(e.IsSamplingEnabled,e.identity.puid,e.correlationId),k.addSink(T),e.oTelDiagnosticAriaNameSpace&&e.oTelDiagnosticAriaTenant&&(D=new _(O,{endpointUrl:re(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:t?[new r.a]:[],extensionConfig:t?{PrivacyGuardPlugin:ue(e.oTelDiagnosticAriaNameSpace,e.oTelDiagnosticAriaTenant)}:{}}),M.addSink(D)),W=!0,oe(j,Y)),[2]}}))}))})).catch((function(){N=!1}))):Promise.resolve()}function K(e){var t=this;return e.oTelEnabled&&e.oTelAriaTenant&&se(e.correlationId,e.sessionId,e.identity.tenantId)&&!L?(x=!0,U=e.oTelAriaNameSpace,Promise.all([Z(e.schedulerPriority),Q(e.appPlatform,e.schedulerPriority)]).then((function(){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return(w=new o.a(void 0,void 0,{enableQueue:e.win11DetectionEnabled})).setTenantToken(e.oTelAriaNameSpace,e.oTelAriaTenant,a.b),[4,ie(e.appName,e.appPlatform,e.appWorkload,e.bundleBuildDate,e.correlationId,e.deploymentEnvironment,e.deviceType,e.flights,e.isCorpNet,e.isTestTraffic,e.sessionId,e.serverLocation,e.requestOrigin,!1,e.identity,e.userSegment,e.ecsRing,e.appWorkloadType,e.networkType,e.serviceWorkerState,e.firstVisitAgeInDays,e.domainOrigin,e.initialPageName,e.dataBoundary,e.preferredCulture)];case 1:return O=n.sent(),e.oTelDiagnosticAriaNameSpace&&e.oTelDiagnosticAriaTenant&&(q=e.oTelDiagnosticAriaNameSpace,(M=new o.a(void 0,void 0,{enableQueue:e.win11DetectionEnabled})).setTenantToken(e.oTelDiagnosticAriaNameSpace,e.oTelDiagnosticAriaTenant,a.b)),t=le(),e.win11DetectionEnabled?X().then((function(n){P=new _(O,{endpointUrl:re(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:t?[new r.a,n]:[n],extensionConfig:t?{PrivacyGuardPlugin:ue(e.oTelAriaNameSpace,e.oTelAriaTenant)}:{}}),F(P),J(e.IsSamplingEnabled,e.identity.puid,e.correlationId),w.addSink(P),e.oTelDiagnosticAriaNameSpace&&e.oTelDiagnosticAriaTenant&&(D=new _(O,{endpointUrl:re(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:t?[new r.a,n]:[n],extensionConfig:t?{PrivacyGuardPlugin:ue(e.oTelDiagnosticAriaNameSpace,e.oTelDiagnosticAriaTenant)}:{}}),M.addSink(D)),L=!0,oe(H,$),y((function(){ce(!1)}),!0)})):(P=new _(O,{endpointUrl:re(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:t?[new r.a]:[],extensionConfig:t?{PrivacyGuardPlugin:ue(e.oTelAriaNameSpace,e.oTelAriaTenant)}:{}}),F(P),J(e.IsSamplingEnabled,e.identity.puid,e.correlationId),w.addSink(P),e.oTelDiagnosticAriaNameSpace&&e.oTelDiagnosticAriaTenant&&(D=new _(O,{endpointUrl:re(e.deploymentEnvironment,e.dataBoundary,e.IsEudbEndpointEnabled),plugins:t?[new r.a]:[],extensionConfig:t?{PrivacyGuardPlugin:ue(e.oTelDiagnosticAriaNameSpace,e.oTelDiagnosticAriaTenant)}:{}}),M.addSink(D)),L=!0,oe(H,$),y((function(){ce(!1)}),!0)),[2]}}))}))})).catch((function(){x=!1}))):Promise.resolve()}function Z(e){return new Promise((function(t,i){Object(f.a)((function(){Promise.all([n.e(46),n.e(68),n.e(589)]).then(n.bind(null,"uTS/")).then((function(e){_=e.OneDSSink,A=e.OneDSEndpoint,E=e.OsPlugin,C=e.Sampler,t()})).catch((function(e){i(e)}))}),null!=e?e:p.b)}))}function Q(e,t){return"Web"===e?Promise.resolve():new Promise((function(e){Object(f.a)((function(){Promise.all([n.e(0),n.e(1),n.e(51),n.e(689)]).then(n.bind(null,"fTj/")).then((function(e){return e.getDeviceId()})).then(().catch(()}),null!=t?t:p.b)}))}function X(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,()}))}function J(e,t,n){if(e){var i=new C;t?i.enableWithIdentifier("PrimaryIdentityHash",t):i.enableWithIdentifier("SessionId",n),i.setSampleRate(.02),P.addPreprocessor(i)}}function Y(e,t,n,i){if(N)if(W){var r=i?[q,e].join("."):[U,e].join("."),o=ae(t);ne(i?M:k,r,o,2,110,n?1:0)}else j.queueEvent({eventName:e,params:t,isSampled:n})}function $(e,t,n,i){te(e,t,!1,n,i)}unction te(e,t,n,i,r){if(!n&&x)if(!n&&L){var o=r?[q,e].join("."):[U,e].join("."),a=ae(t);ne(n?I:r?M:w,o,a,2,110,i?1:0)}else{var l={eventName:e,params:t,isSampled:i,isDiagnostic:r};n?B.queueEvent(l):H.queueEvent(l)}}function ne(e,t,n,i,r,o){e.sendTelemetryEvent({eventName:t,dataFields:n,eventFlags:{dataCategories:i,diagnosticLevel:r,samplingPolicy:o}})}function ie(e,t,n,r,o,a,u,p,f,b,v,S,y,C,w,T,k,I,_,A,P,E,O,F,D,M){return Object(i.__awaiter)(this,void 0,void 0,(function(){var M,x,L,U,N,W,j,H;return Object(i.__generator)(this,(function(B){switch(B.label){case 0:return M="0",x=r.split(" ")[0].split("-").join(""),L=[x,M].join("."),V=function(e,t,n){if(n)return"Automation";switch(e){case"dev":case"ppe":case"prodprv":return"Automation";case"prod":case"bfprod":case"pfprod":case"tbprod":case"unprod":case"usprod":return t?"Microsoft":"Production";default:return"Automation"}}(a,f,b),U=Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([],Object(i.__read)(l.b.getFields({platform:t,name:e,version:L})),!1),Object(i.__read)(l.e.getFields({id:o})),!1),[Object(s.d)(Object(g.a)([h.cb,h.k]),V),Object(s.d)(h.o,a)],!1),C?U.push.apply(U,Object(i.__spreadArray)([],Object(i.__read)(l.f.getFields({isAnonymous:!0})),!1)):(W="",(N=null==w?void 0:w.puid)&&(W=(null==w?void 0:w.isMsa)?"MsaPuid":"OrgIdPuid"),U.push.apply(U,Object(i.__spreadArray)([],Object(i.__read)(l.f.getFields({primaryIdentityHash:N,primaryIdentitySpace:W,tenantId:null==w?void 0:w.tenantId,tenantGroup:(null==w?void 0:w.isMsa)?"Consumer":"Commercial",isAnonymous:!1})),!1))),j=[Object(s.d)(h.C,m.c),Object(s.d)(h.fb,y),Object(s.d)(h.l,v),Object(s.d)(h.h,n),Object(s.d)(h.gb,S),Object(s.d)(h.q,u)],(null==T?void 0:T.isAdmin)&&j.push(Object(s.a)(Object(g.a)([h.lb,h.M]),T.isAdmin)),(null==T?void 0:T.isDynamics)&&j.push(Object(s.a)(Object(g.a)([h.lb,h.N]),T.isDynamics)),(null==T?void 0:T.isEdu)&&j.push(Object(s.a)(Object(g.a)([h.lb,h.O]),T.isEdu)),(null==T?void 0:T.isEduFaculty)&&j.push(Object(s.a)(Object(g.a)([h.lb,h.P]),T.isEduFaculty)),(null==T?void 0:T.isEduStudent)&&j.push(Object(s.a)(Object(g.a)([h.lb,h.Q]),T.isEduStudent)),(null==T?void 0:T.isFirstVisit)&&j.push(Object(s.a)(Object(g.a)([h.lb,h.R]),T.isFirstVisit)),(null==T?void 0:T.isIw)&&j.push(Object(s.a)(Object(g.a)([h.lb,h.T]),T.isIw)),(null==T?void 0:T.isSmb)&&j.push(Object(s.a)(Object(g.a)([h.lb,h.U]),T.isSmb)),p?(j.push(Object(s.d)(h.F,p)),[4,Object(c.a)(crypto.subtle,p,"",(function(e){return function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,d("TextEncoder"in window)];case 1:return[2,t.sent().encode(e)]}}))}))}(e)}))]):[3,2];case 1:H=B.sent(),j.push(Object(s.d)(h.G,H)),B.label=2;case 2:return I&&j.push(Object(s.d)(h.i,I)),k&&j.push(Object(s.d)(h.u,k)),_&&j.push(Object(s.d)(h.W,_)),A&&j.push(Object(s.d)(h.hb,A)),P&&j.push(Object(s.c)(h.E,P)),E&&j.push(Object(s.d)(h.t,E)),O&&j.push(Object(s.d)(h.L,O)),F&&j.push(Object(s.d)(h.m,F)),D&&j.push(Object(s.d)(h.g,D)),"Universal"===t&&j.push(Object(s.d)(h.p,R)),[2,Object(i.__spreadArray)(Object(i.__spreadArray)([],Object(i.__read)(U),!1),Object(i.__read)(j),!1)]}}))}))}function re(e,t,n){if("EU"===t&&n)return A.EUDB;switch(e){case"pfprodprv":case"pfprod":return A.USGOV_DOD;case"tbprodprv":case"tbprod":return A.USGOV_DOJ;default:return A.PUBLIC}}function oe(e,t){e.drainQueue().forEach((function(e){e.eventName&&t(e.eventName,e.params||{},e.isSampled,e.isDiagnostic)}))}function ae(e){return Object.keys(e).filter(().map((function(t){var n=e[t];return"boolean"==typeof n?Object(s.a)(t,n):"number"==typeof n?Number.isInteger(n)?Object(s.c)(t,n):Object(s.b)(t,n):Object(s.d)(t,n)}))}function le(){switch(V){case"Automation":return!0;case"Microsoft":case"Production":default:return!1}}function se(e,t,n){return Object(v.a)(e)&&Object(v.a)(t)&&(!n||Object(v.a)(n))}function ce(e){if(!e&&x&&L){oe(e?B:H,e?ee:$);try{(e?I:w).telemetrySinks.forEach((function(e){var t,n;null===(n=(t=e).flush)||void 0===n||n.call(t,!1)}))}catch(e){console.log(e)}}}function ue(e,t){return{notificationEventName:e+".PrivacyConcern",iKey:t,scanForUrls:!1}}},"+2OL":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("serviceWorkerConfig")||{diskPreloadEnabled:!1,enabled:!1,pilotFlights:[],serviceWorkerAllowedFlights:[],scope:"",scriptUrl:""}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},"+P5Z":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("p6wn"),r=n("hhzZ"),o=function(){function e(){}return e.forRoot,e}()},"+YV+":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("lrJm"),r=n("OWzB"),o=n("4/We"),a=n("keVe"),l=function()return e.prototype.init=function(){var e=this;this.createLinksPromise=this.createDocumentService.getCreateLinks(),this.createButtonEnabledPromise=new Promise((function(t){e.createLinksPromise.then((function(n){t(e.capabilitiesService.capabilities.createDocumentSupported&&n.length>0)})).catch((function(n){e.globalErrorHandler.handleError(n,"wmh4W"),t(!1)}))}))},e.ɵprov=a.kc({factory:function(){return new e(a.lc(r.a),a.lc(o.a),a.lc(i.b))},token:e,providedIn:"root"}),e}()},"+a0u":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"+ucO":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("QjXU"),r=n("dFxn"),o=n("uzn7"),a=n("cgnd"),l=n("/I02"),s=n("keVe"),c=function(){function e(t,n,i,r){this.localStorageService=t,this.contextService=n,this.configParserService=i,this.clientStartupConfig=r,this.config=i.parse("appGalleryConfig")||{numberOfBusinessApps:0,learnMoreLinks:[],resources:null,categoryId:"TipsAndTricks",workspaceBatches:!1,myApplicationsUrl:"",ecsAppGalleryUpdatesEnabled:!1,filterAllAppsFirstPartyEnabled:!1},this.config.categoryId="TipsAndTricks",e.appCategoryRefreshLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid,e.appCategoriesLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid,e.appCategoriesOfficeMarketLocalStorageDataKey+="_"+this.clientStartupConfig.config.tenantId+"_"+this.clientStartupConfig.config.puid}return e.prototype.getCategory=function(){var t=this;return this.categoriesPromise||(this.categoriesPromise=new Promise((function(n){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,r,o,a,l,s;return Object(i.__generator)(this,(function(i){return t=this.localStorageService.get(e.appCategoryRefreshLocalStorageDataKey)||0,r=(new Date).getTime()-t,o=this.contextService.sharedContext.officeMarket,a=this.localStorageService.get(e.appCategoriesOfficeMarketLocalStorageDataKey)||"",r<=864e5&&o===a&&(l=this.localStorageService.get(e.appCategoriesLocalStorageDataKey)||{}).Apps?[2,n(l)]:(s=this.configParserService.parse("appCategoryData")||{},this.saveToLocalStorage(o,s),n(s),[2])}))}))}))),this.categoriesPromise},e.prototype.saveToLocalStorage=function(t,n){this.localStorageService.set(e.appCategoryRefreshLocalStorageDataKey,(new Date).getTime()),this.localStorageService.set(e.appCategoriesOfficeMarketLocalStorageDataKey,t),this.localStorageService.set(e.appCategoriesLocalStorageDataKey,n)},e.appCategoryRefreshLocalStorageDataKey=e.appCategoryRefreshDataKey="AppCategoryRefresh",e.appCategoriesLocalStorageDataKey=e.appCategoriesDataKey="AppCategories",e.appCategoriesOfficeMarketLocalStorageDataKey=e.appCategoriesOfficeMarketDataKey="AppCategoryLanguage",e.ɵprov=s.kc({factory:function(){return new e(s.lc(o.a),s.lc(l.a),s.lc(r.a),s.lc(a.b))},token:e,providedIn:"root"}),e}()},"/6za":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("sharePointConfig")}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},"/I02":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("H90i"),r=n("dFxn"),o=n("hZW2"),a=n("Z0U4"),l=n("Ax7d"),s=n("4/We"),c=n("keVe"),u=n("jidT"),d=function(){function e(e,t,n,i,r,o){var a=this;this.capabilitiesService=e,this.cookieService=t,this.documentService=n,this.officeRouteService=i,this.webPwaService=r,this.sharedContext=o.parse("sharedContext")||{abtSignoutPath:null,activityLifetimeInSeconds:0,activityTrackingEnabled:!1,accessTokenMaxRetryAttempts:0,consumerShellServiceEndpoint:null,createButtonTextCompleteStopCount:0,createButtonTextEmptyStopCount:0,createButtonTextTypingSpeed:0,dataUpdateCooldownInSeconds:0,dataUpdateIntervalInSeconds:0,dataUpdateMaxConsecutiveFailures:0,dataUpdateTimeoutInSeconds:0,dateOverride:null,defaultLinkTarget:"_blank",fluentHeroImageUrl:null,formsResourceUrl:null,graphApiRoot:null,graphApiRootRefreshIntervalInSeconds:0,heroImageUrl:null,heroTitleGradientImageUrl:null,iceApplicationId:-1,inactivityTimeoutInSeconds:60,inMockMode:!1,metaResourcePath:null,msaAppId:null,msaTokenRedirectUrl:null,msaTokenTimeoutMs:0,officeHomeApiRoot:null,officeMarket:"en-us",officeMarketLcid:1033,officeStartManifestVersion:null,oneDriveConsumerApi:null,oneDriveResourceId:null,oneDriveUrl:null,outlookServiceRoot:null,recommendedIceApplicationId:-1,serviceWorkerIntervalUpdateEnabled:!1,sharePointResourceId:null,signOutRedirectUrl:null,signOutUrlTemplate:null,supportDocsUrl:null,teamsUrl:null,tokenLoginUrlTemplate:null,updateDataOnViewEnabled:!1,uploadv2Experience:!1,usingOneDriveResourceAsSharePointResource:!1,wacHostAppPrebootTimeout:0};var l=this.documentService.nativeDocument.getElementsByTagName("html");this.isRtl=l&&l[0]&&"rtl"===l[0].getAttribute("dir"),this.defaultLinkTarget=this.sharedContext.defaultLinkTarget,this.webPwaService.isStandalone.subscribe((function(e){a.isStandalone=e,a.sharedContext.defaultLinkTarget=e&&!a.webPwaService.isOfficeApp()?"_self":a.defaultLinkTarget}));var s=this.sharedContext.officeMarket;s&&-1===s.indexOf("-")&&s.indexOf("_")>=0&&(this.sharedContext.officeMarket=s.split("_").join("-"))}return e.prototype.getCsrfToken=function(){return this.cookieService.get("AjaxSessionKey")},e.prototype.getWdOrigin=function(e){return"OFFICECOM-"+this.getWdOriginApp()+"."+this.getWdOriginPage()+"."+e},e.prototype.getCurrentPageForLogging=function(){return this.officeRouteService.getCurrentPageForLogging()},e.prototype.getWdOriginApp=function(){return this.isStandalone?i.c.PWA:this.capabilitiesService.capabilities.pwaEnabled?i.c.HWA:this.capabilitiesService.capabilities.isEmbedMode?i.c.Embed:i.c.Web},e.prototype.getHybridAuth=function(){return this.capabilitiesService.capabilities.hybridAuthEnabled},e.prototype.getWdOriginPage=function(){var e=this.officeRouteService.getCurrentRoute();if(e)switch(e.route){case"Start":return i.d.Start;case"Templates":return i.d.Templates;case"Content":return i.d.Content;case"Search":return i.d.Search;default:return i.d.Home}return i.d.Home},e.ɵprov=c.kc({factory:function(){return new e(c.lc(s.a),c.lc(u.a),c.lc(o.a),c.lc(a.a),c.lc(l.a),c.lc(r.a))},token:e,providedIn:"root"}),e}(l")},"0XE2":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i,r=!1;function o(){return r||(i=!!document.getElementById("AppShellEnabled"),r=!0),i}},"0ZeC":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.MarkTaskAsDone="MarkTaskAsDone",e.MarkAsNotATask="MarkAsNotATask",e.PromoteTask="PromoteTask",e.DismissAction="DismissAction",e.UndoTask="UndoTask"}(i||(i={}))},"1Bt+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("pd4Y"),n("uH9+"),n("PBJH");var i=function(){function e(e,t,n){this.dateService=e,this.locService=t,this.timestampFormatService=n}return e.prototype.transform=function(e,t,n,i){return e?(null==n&&(n=e.toDateString()),this.commonFormat(e,t,n,i)):""},e.prototype.commonFormat=function(e,t,n,i){if(!this.locService.supportsLocaleSpecifiers)return n;var r=this.dateService.timespanInSeconds(e);switch(this.timestampFormatService.getTimestampType(e)){case 9:return this.timespanString(r,this.locService.NumberMinutesInShort,-60);case 0:return"";case 1:return i?this.locService.JustNowLowerCase:this.locService.JustNow;case 2:return this.timespanString(r,this.locService.NumberMinutesAgoShort,60);case 3:return this.timespanString(r,this.locService.NumberHoursAgoShort,3600);case 4:return t?i?this.locService.YesterdayLowerCase:this.locService.Yesterday:this.locService.format(i?this.locService.TimeYesterdayLowerCase:this.locService.TimeYesterday,this.locService.formatTimeFromDate(e));case 5:return t?this.locService.localizedWeekday(e):this.locService.format(this.locService.TimeDayOfWeek,this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e));case 6:return this.locService.localizedMonthDate(e);default:return this.locService.localizedDateStringMedium(e)}},e.prototype.timespanString=function(e,t,n){var i=Math.round(e/n);return this.locService.format(t,this.locService.localizedNumberString(i))},e}()},"1GMS":function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v}));var i=n("keVe"),r=n("TOqr"),o=n("6wOV"),a=n("AY/E"),l=n("pzhl"),s=n("PkQn"),c=n("4/We"),u=n("cAxl"),d=n("3bNC"),p=i.Fb({encapsulation:2,styles:[],data:{}});function f(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"img",[],[[8,"src",4],[8,"title",0]],null,null,null,null)),i.Gb(1,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"person-picture-upcoming-meeting__display":0,"person-picture__image":1,"person-picture__image--card":2}),i.Gb(3,212992,null,0,o.a,[i.o,a.a],{upn:[0,"upn"]},null)],(function(e,t){var n=t.component,r=i.Ob(1,"person-picture__",n.iconSize,""),o=e(t,2,0,n.isUpcomingMeeting,!n.isUpcomingMeeting,n.personPictureCard);e(t,1,0,r,o),e(t,3,0,null==n.person?null:n.person.email)}),(function(e,t){var n=t.component;e(t,0,0,"data:image/png;base64,"+t.context.ngIf,i.Ob(1,"",null==n.person?null:n.person.fullName,""))}))}function h(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card__attendee_status_image"],["size","16"]],null,null,null,l.b,l.a)),i.Gb(2,638976,null,0,s.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,2,0,"upcomingMeeting-card__attendee_status_image",t.component.status,"16")}),null)}function m(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[["aria-hidden","true"],["class","person-picture-upcoming-meeting__display"]],[[8,"title",0]],null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"div",[["class","person-picture-upcoming-meeting__text"]],null,null,null,null,null)),(e()(),i.gc(2,null,[" "," "]))],null,(function(e,t){var n=t.component;e(t,0,0,i.Ob(1,"",null==n.person?null:n.person.fullName,"")),e(t,2,0,null==n.person?null:n.person.fullName.slice(0,1))}))}function b(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["aria-hidden","true"],["class","person-picture__image person-picture__image--icon"],["style","font-size: 24px;"]],[[8,"title",0]],null,null,null,null)),i.Gb(1,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"person-picture__placeholder--padding--7":0}),(e()(),i.Hb(3,0,null,null,1,"ohp-icon-font",[["iconFontName","Person"],["size","16"]],null,null,null,l.b,l.a)),i.Gb(4,638976,null,0,s.a,[c.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){var n=e(t,2,0,t.component.hasPadding);e(t,1,0,"person-picture__image person-picture__image--icon",n),e(t,4,0,"Person","16")}),(function(e,t){var n=t.component;e(t,0,0,i.Ob(1,"",null==n.person?null:n.person.fullName,""))}))}function g(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,1,null,m)),i.Gb(1,16384,null,0,r.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,b)),i.Gb(3,16384,null,0,r.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,null,null,0ng)}),null)}function v(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,2,null,f)),i.Gb(1,16384,null,0,r.k,[i.W,i.S],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),i.Yb(131072,r.b,[i.h]),(e()(),i.qb(16777216,null,null,1,null,h)),i.Gb(4,16384,null,0,r.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,[["placeholder",2]],null,0,null,g))],(function(e,t){var n=t.component;e(t,1,0,i.hc(t,1,0,i.Wb(t,2).transform(n.imageBase64Promise)),i.Wb(t,5)),e(t,4,0,"Accepted"===n.status||"Declined"===n.status||"TentativelyAccepted"===n.status)}),null)}i.Db("ohp-person-picture",u.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-person-picture",[],null,null,null,v,p)),i.Gb(1,573440,null,0,u.a,[d.a],null,null)],null,null)}),{person:"person",pictureId:"pictureId",fetchImage:"fetchImage",imageBase64:"imageBase64",isUpcomingMeeting:"isUpcomingMeeting",status:"status",iconSize:"iconSize",hasPadding:"hasPadding",personPictureCard:"personPictureCard"},{},[])},"1Hgo":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("edgeworthConfig")}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},"1LNb":function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var i=n("QjXU"),r=n("hEo6"),o=n("bN1B"),a=n("lUkk"),l=n("CMIS"),s=n("Cin9"),c=n("BMb5"),u=n("hhzZ"),d=n("BaAg"),p=n("4/We"),f=n("cgnd"),h=n("/I02"),m=n("JH4S"),b=n("fGsv"),g=n("W3Zz"),v=n("hZW2"),S=n("dFxn"),y=n("keVe"),C=function(){function e(e){this.config=e.parse("feedbackConfig")}return e.ɵprov=y.kc({factory:function(){return new e(y.lc(S.a))},token:e,providedIn:"root"}),e}(),w=n("J7Ur"),T={palette:{themePrimary:"#323130",themeLighterAlt:"#e7e6e5",themeLighter:"#d0cfce",themeLight:"#bab8b7",themeTertiary:"#a3a2a0",themeSecondary:"#8d8b8a",themeDarkAlt:"#767573",themeDark:"#605e5d",themeDarker:"#494847",neutralLighterAlt:"#f8f8f8",neutralLighter:"#f4f4f4",neutralLight:"#eaeaea",neutralQuaternaryAlt:"#dadada",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#111111",neutralSecondary:"#171616",neutralSecondaryAlt:"#171616",neutralPrimaryAlt:"#1d1c1b",neutralPrimary:"#323130",neutralDark:"#282726",black:"#2d2c2c",white:"#ffffff"}},k={palette:{themePrimary:"#ffffff",themeLighterAlt:"#767676",themeLighter:"#a6a6a6",themeLight:"#c8c8c8",themeTertiary:"#d0d0d0",themeSecondary:"#dadada",themeDarkAlt:"#eaeaea",themeDark:"#f4f4f4",themeDarker:"#f8f8f8",neutralLighterAlt:"#323130",neutralLighter:"#31302f",neutralLight:"#2f2e2d",neutralQuaternaryAlt:"#2c2b2a",neutralQuaternary:"#2a2928",neutralTertiaryAlt:"#282726",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralSecondaryAlt:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#323130"}},I=n("8/lW");function _(){!function(e){Object(a.a)({eventName:"ShellOcvFeedbackModalDismissed",area:"ShellHeader",id:"ShellOcvFeedbackModalDismissed",result:"Close",target:"FeedbackDialogHarmony"},I.a.Enhanced)}()}var A=n("Z0U4"),P=n("Uqr9"),E=n("casz"),O=n("5aVq"),F=n("OtXi"),D=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f,h){this.capabilitiesService=e,this.clientStartupConfigService=t,this.deviceDetector=n,this.documentService=i,this.feedbackConfigService=r,this.instrumentationService=o,this.routeService=a,this.startupConfigService=l,this.userContextService=s,this.scheduler=c,this.windowService=u,this.shellShimService=d,this.contextService=p,this.adminPolicyService=f,this.wrapperVersion=h,this.feedbackScript="feedback-script",this.scriptLoadStarted=!1,this.feedbackServiceInitializePromise=null,this.feedbackServiceInitializePromise=this.initialize()}return e.prototype.getOCVTelemetryData=function(e){var t=this.getTelemetryGroup();return{applicationGroup:{appData:JSON.stringify({userCategories:this.getUserCategories(),latency:e})},telemetryGroup:t,webGroup:{browser:this.deviceDetector.getDeviceInfo().browser.keyword,sourcePageName:this.getSourcePageName()}}},e.prototype.loadOCVFeedback=function(e,t){var n,i=this;if(this.capabilitiesService.capabilities.firstDraftFeedbackEnabled){var a=function(e){var t=e.ocvLaunchOptions,n=e.policy;return{appId:r.b,ageGroup:w.a.Undefined,authenticationType:w.b.AAD,callbackFunctions:{onDismiss:_},isProduction:!0,clientName:"Harmony",feedbackConfig:{appData:t.applicationGroup.appData,complianceChecks:{connectedExperiences:1===(null==n?void 0:n.ConnectedExperience.PolicyValue)?w.d.Enabled:w.d.Disabled,policyAllowContact:w.d.Disabled,policyAllowContent:1===(null==n?void 0:n.LogCollection.PolicyValue)?w.d.Enabled:w.d.Disabled,policyAllowFeedback:1===(null==n?void 0:n.SendFeedback.PolicyValue)?w.d.Enabled:w.d.Disabled,policyAllowScreenshot:1===(null==n?void 0:n.ScreenShot.PolicyValue)?w.d.Enabled:w.d.Disabled,policyAllowSurvey:1===(null==n?void 0:n.SendSurvey.PolicyValue)?w.d.Enabled:w.d.Disabled,policyEmailCollectionDefault:1===(null==n?void 0:n.EmailCollection.PolicyValue)?w.d.Enabled:w.d.Disabled},zIndex:1000001,feedbackUiType:w.g.Modal,hostPlatform:w.c.Web,isDisplayed:!0,isFileUploadEnabled:!1,isMyFeedbackEnabled:!0,isScreenshotEnabled:!0,isScreenRecordingEnabled:!1,isThankYouPageDisabled:!1,screenshotInfo:{providedScreenshotType:w.e.AutoCapture}},telemetry:{audienceGroup:t.telemetryGroup.audienceGroup,browser:t.webGroup.browser,deviceType:t.telemetryGroup.deviceType,featureArea:t.telemetryGroup.featureArea,flights:t.telemetryGroup.flights,officeBuild:t.telemetryGroup.officeBuild,platform:t.telemetryGroup.platform,processSessionId:t.telemetryGroup.processSessionId,sourcePageName:t.webGroup.sourcePageName},tenantId:t.telemetryGroup.tenantId,themeOptions:{baseTheme:e.darkMode?k:T},userId:t.telemetryGroup.loggableUserId}}({ocvLaunchOptions:this.getOCVTelemetryData("0"),policy:this.OCVAdminPolicy,FeedbackInitOptions:{},darkMode:t}),l={hostName:r.c,language:null!==(n=this.contextService.sharedContext.officeMarket)&&void 0!==n?n:"en-US"};Object(o.a)(l),Object(o.b)(a)}else{if("undefined"==typeof OfficeBrowserFeedback)return;OfficeBrowserFeedback.initOptions.appId=this.getOcvAppId(),OfficeBrowserFeedback.initOptions.onD&&e()},OfficeBrowserFeedback.multiFeedback||this.scriptLoadStarted?this.displayOCVFeedback(0):this.addOCVScriptToPage((function(e){i.displayOCVFeedback(e)}))}},e.prototype.addOCVScriptToPage=function(e){var t=this,n=this.feedbackConfigService.config;return!!n&&(this.scriptLoadStarted||(this.scriptLoadStarted=!0,this.scheduler.scheduleWork((function(){var i=P.a.now();t.documentService.addScriptToPage(n.scriptUrl,(function(){var t=Math.ceil(P.a.now()-i);e(t)}),(function(){}),!0,t.feedbackScript,!0)}),4)),!0)},e.prototype.getOcvAppId=function(){return this.getSourcePageName()===this.feedbackConfigService.config.fluidContentPage?this.feedbackConfigService.config.fluidAppId:this.feedbackConfigService.config.appId},e.prototype.initialize=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o,a=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.currentPageView=this.getCurrentPageView(this.routeService.getCurrentRoute()),this.routeService.subscribeToRouteChangeoute)})),this.capabilitiesService.capabilities.adminPolicyEnabled?(e=this,[4,this.adminPolicyService.getAdminPolicy()]):[3,2];case 1:e.OCVAdminPolicy=i.sent(),i.label=2;case 2:return"undefined"==typeof OfficeBrowserFeedback||OfficeBrowserFeedback.initOptions||(t=this.feedbackConfigService.config,n=this.startupConfigService.config.sharedClientStartupContext,OfficeBrowserFeedback.initOptions={appId:void 0,stylesUrl:t.stylesUrl,intlUrl:t.intlUrl,environment:t.environment,sessionId:n.correlationId,build:n.buildId,locale:this.contextService.sharedContext.officeMarket,screenshot:t.screenshotEnabled,userEmail:t.autopopulateEmail?this.startupConfigService.config.userPrincipalName:""},this.OCVAdminPolicy&&(OfficeBrowserFeedback.initOptions.screenshot=this.OCVAdminPolicy.ScreenShot.State,OfficeBrowserFeedback.initOptions.showEmailAddress=this.OCVAdminPolicy.EmailCollection.State)),this.capabilitiesService.capabilities.shellFeedbackEnabled?(r=this.getOCVTelemetryData("0"),o=this,[4,this.shellShimService.getShellShim()]):[3,4];case 3:i.sent().NFD.OnFeedbackMetadataRequested((function(e,t){o.windowService.nativeWindow.OfficeBrowserFeedback.html2canvas(a.documentService.nativeDocument.body,{background:"#ffffff"})eg"))}));var n=(e=e||{options:{telemetryGroup:{},webGroup:{}}}).options;n.appId=a.getOcvAppId(),n.userVoiceEnabled=!1,n.applicationGroup.appData=r.applicationGroup.appData,n.disableIncludeScreenshot=!1,a.OCVAdminPolicy&&(n.emailPolicyValue=a.OCVAdminPolicy.EmailCollection.PolicyValue,n.screenshotPolicyValue=a.OCVAdminPolicy.ScreenShot.PolicyValue,n.sendFeedbackPolicyValue=a.OCVAdminPolicy.SendFeedback.PolicyValue,n.logCollectionPolicyValue=a.OCVAdminPolicy.LogCollection.PolicyValue);var i=n.telemetryGroup;return i.audienceGroup=r.telemetryGroup.audienceGroup,i.featureArea=a.getSourcePageName(),i.flights=r.telemetryGroup.flights,i.processSessionId=o.startupConfigService.config.sharedClientStartupContext.correlationId,i.officeBuild=r.telemetryGroup.officeBuild,n.webGroup.sourcePageName=a.getSourcePageName(),e})),i.label=4;case 4:return[2]}}))}))},e.prototype.getTelemetryGroup=function(){var e=this.startupConfigService.config.authType===f.a.MSA?this.startupConfigService.config.fixedConsumerTenantId:this.startupConfigService.config.tenantId,t=this.wrapperVersion?this.wrapperVersion.major+"."+this.wrapperVersion.minor+"."+this.wrapperVersion.build+"."+this.wrapperVersion.revision+"|":"",n={audienceGroup:this.getAudienceGroup(),deviceType:this.getDeviceType(),flights:this.startupConfigService.config.sharedClientStartupContext.flights,loggableUserId:this.startupConfigService.config.puid,officeBuild:t+this.startupConfigService.config.sharedClientStartupContext.buildId,platform:this.deviceDetector.getDeviceInfo().platform.keyword,tenantId:e},r=Object(i.__assign)(Object(i.__assign)({},n),{channel:"CC"});return this.capabilitiesService.capabilities.isPwaInWebView2||this.capabilitiesService.capabilities.isPwaInUwp?r:n},e.prototype.logDismissOCVFeedback=function(e){this.instrumentationService.logGenericEvent(e?"Feedback_OCV_Submitted":"Feedback_OCV_Dismissed",{}),Object(a.a)({id:"feedback-dismiss",area:"Feedback",result:e?"New":"Cancel",target:"Feedback"})},e.prototype.displayOCVFeedback=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t={},n=e.toString(),t.Latency=n,this.capabilitiesService.capabilities.shellFeedbackEnabled?[4,this.shellShimService.getShellShim()]:[3,2];case 1:return i.sent().NFD.OpenFeedback(),[3,3];case 2:r=this.getOCVTelemetryData(n),OfficeBrowserFeedback.multiFeedback(r).then((function(){}),(function(e){t.Error=e,o.instrumentationService.logGenericEvent("Feedback_OCV_Error",t),Object(l.a)({eventName:"Feedback_OCV",errorType:"Feedback_Error",message:e})})),i.label=3;case 3:return this.instrumentationService.logGenericEvent("Feedback_OCV_Click",t),Object(a.a)({id:"feedback-button",area:"Feedback",result:"Open",target:"Feedback"}),Object(s.a)({eventName:"OCV_Script_Downloaded",latency:e,area:"Feedback"}),[2]}}))}))},e.prototype.getDeviceType=function(){return this.deviceDetector.isDesktopDevice()?"Desktop":this.deviceDetector.isTabletDevice()?"Tablet":this.deviceDetector.isMobileDevice()?"Phone":"Laptop"},e.prototype.getAudienceGroup=function(){return"WorldWide"===this.clientStartupConfigService.config.sharedClientStartupContext.ecsRing?"Production":this.clientStartupConfigService.config.sharedClientStartupContext.ecsRing},e.prototype.getSourcePageName=function(){return this.currentPageView},e.prototype.getUserCategories=function(){var e=[];return this.startupConfigService.config.authType===f.a.OrgId?e.push("Commercial"):this.startupConfigService.config.authType===f.a.MSA&&e.push("Consumer"),this.userContextService.user.isAdmin&&e.push("Admin"),this.userContextService.user.isEdu&&e.push("Edu"),this.userContextService.user.isEduStudent&&e.push("EduStudent"),this.userContextService.user.isEduFaculty&&e.push("EduFaculty"),this.userContextService.user.isSmb&&e.push("Smb"),this.userContextService.user.isDynamics&&e.push("Dynamics365"),this.userContextService.user.isFirstRelease&&e.push("FirstRelease"),e},e.prototype.getCurrentPageView=function(e){if(!e||!e.route)return"Unknown";switch(e.route){case"OfficeHome":return"Home_PageView";case"AppGallery":return"AppGallery_PageView";case"Search":case"SearchSiteScoped":case"SearchTopicScoped":case"SearchMeetingScoped":case"SearchPersonScoped":case"SearchPersonScopedOverview":return"Search_PageView";default:return""+(e.app?d.b[e.app]:"")+e.route}},e.ɵprov=y.kc({factory:function(){return new e(y.lc(p.a),y.lc(f.b),y.lc(g.c),y.lc(v.a),y.lc(C),y.lc(u.a),y.lc(A.a),y.lc(f.b),y.lc(m.a),y.lc(E.a),y.lc(c.b),y.lc(O.a),y.lc(h.a),y.lc(b.a),y.lc(F.a,8))},token:e,providedIn:"root"}),e}()},"1rn/":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("8/lW"),r=n("a3FV"),o=n("4CZh");function a(e,t,n,a){void 0===n&&(n={}),void 0===a&&(a=i.a.Security),n.Latency=t.toString(),Object(o.b)(e,r.a.PerformanceDump,a,n,[],!0)}},"24t9":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.getKey=function(t){return e.KeysToKeyboardKeys[t.key]||e.KeyCodesToKeyboardKeys[t.keyCode]||0},e.KeysToKeyboardKeys={Tab:1,Enter:2,Shift:16,Esc:3,Escape:3,Up:4,ArrowUp:4,Down:5,ArrowDown:5,Spacebar:32," ":32,Zero:48,Nine:57,a:65,z:90,A:65,Z:90,"/":191},e.KeyCodesToKeyboardKeys={9:1,13:2,16:16,27:3,32:32,38:4,40:5,48:48,57:57,65:65,90:90,191:191},e}()},"2CtU":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("AlWG"),r=n("keVe"),o=function(){function e(){this._onenotePageDialog=new i.a(null)}return e.prototype.showOneNotePageDialog=function(e){this._onenotePageDialog.next(e)},Object.defineProperty(e.prototype,"onenotePageDialog",{get:function(){return this._onenotePageDialog.asObservable()},enumerable:!0,configurable:!0}),e.ɵprov=r.kc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"2lMP":function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var i=n("QjXU"),r=n("keVe"),o=n("YPlO"),a=n("bJUw"),l=n("lLc4"),s=n("IO/W"),c=n("bMT6"),u=n("RtYo"),d=n("lUkk"),p=n("CMIS"),f=n("rTyw"),h=n("zvoD"),m=(n("DQbD"),n("GmnP"),n("kaEK")),b=(n("uNUv"),n("0ZeC")),g=(n("dOgD"),n("OPwp")),v=(n("6u39"),n("dx17"),n("M56G"),n("1Bt+"),n("A/um")),S=n("hhzZ"),y=n("BaAg"),C=n("p6Zr"),w=n("L/Tc"),T=(n("QOOv"),n("JT1q")),k=(n("7Rc8"),n("fKR7")),I=(n("kpuN"),n("pd4Y"),n("W3Zz"),n("hZW2"),n("7Gwk"),n("U8M1"),n("Bc8L"),n("Z0U4"),n("Dpxn"),n("EqbI"),n("Uqr9"),n("Xc4i"),n("TIi1"),n("EUVs")),_=(n("BMb5"),n("hoyd"),n("4/We"),n("cgnd")),A=(n("/I02"),n("PBJH"),n("Qqp8")),P=n("uUrA"),E=n("24t9"),O=n("WFKr"),F=n("ZBli"),D=n("H90i"),M=(n("qCYW"),n("kfAr"),n("7J/E"),function(){function e(t,n,o,a,l,s,c,u,d,p,f,h,m,v,S,C,w,T,k,I,A,P,E,O,F,D,M,R,x,L,U,N,W,j,H,B){var G=this;this.activityDescriptionService=t,this.capabilitiesService=n,this.clientStartupConfigService=o,this.contentActionsService=a,this.contextService=l,this.dateService=s,this.deviceDetector=c,this.documentService=u,this.domSanitizer=d,this.eventService=p,this.instrumentationService=f,this.localAppLauncherService=h,this.locService=m,this.mruConfigService=v,this.mruItemInflationService=S,this.mruItemService=C,this.officeFeedService=w,this.officeRouteService=T,this.oneDriveService=k,this.onenoteService=I,this.performanceService=A,this.renderer=P,this.responsiveRelativeDatePipe=E,this.shareControlService=O,this.thumbnailInstrumentationService=F,this.uploadLocalFileService=D,this.urlLauncherService=M,this.uiHostBootstrapperService=R,this.wacContentService=x,this.windowService=L,this.workloadsService=U,this.mruDataService=N,this.fluidHostContext=W,this.fluidInstrumentationService=j,this.accessTokenService=H,this.floodgateService=B,this.leftAlignActionsMenu=!1,this.ShareControlMode=g.a,this.PotentialActionType=b.a,this.shareControlOutputs=iss(!0)}},this.MRU_ITEM_LOADING_STATE=0,this.MYA_ITEM_VIEW_STATE=2,this.MYA_ITEM_ADDED_STATE=0,this.getToDoUrl=function(){return Object(i.__awaiter)(G,void 0,void 0,(function(){var e,t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.workloadsPromise];case 1:return e=n.sent(),[2,null==(t=null==e?void 0:e.find((function(e){return"ShellToDo"===e.Id})))?void 0:t.Url]}}))}))},this.addItem=new r.q,this.deleteItem=new r.q,this.changePinState=new r.q;var q=this.mruConfigService.config;this.activityEnabled=q.activityEnabled,this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled,this.isConsumer=this.clientStartupConfigService.config.authType===_.a.MSA,this.thumbnailApiEnabled=this.capabilitiesService.capabilities.thumbnailEndpointEnabled,this.actionContextMenuEnabled=this.capabilitiesService.capabilities.contentActionsEnabled&&this.capabilitiesService.capabilities.contentActionsOHomeEnabled,this.downloadActionEnabled=this.capabilitiesService.capabilities.downloadActionEnabled,this.replacePinActionEnabled=this.capabilitiesService.capabilities.replacePinActionEnabled,this.isPwa=this.capabilitiesService.capabilities.isPwaInUwp,e.applicationConversionMap||((e.applicationConversionMap=new Map).set(y.b.Word,{iconFontClass:q.wordIconFontClass,iconFontColor:"#185ABD",nativeUriScheme:"ms-word:ofe|u|"}),e.applicationConversionMap.set(y.b.Excel,{iconFontClass:q.excelIconFontClass,iconFontColor:"#107C41",nativeUriScheme:"ms-excel:ofv|ofc|u|"}),e.applicationConversionMap.set(y.b.Visio,{iconFontClass:q.visioIconFontClass,iconFontColor:"#4C68B1",nativeUriScheme:"ms-visio:ofe|u|"}),e.applicationConversionMap.set(y.b.PowerPoint,{iconFontClass:q.powerPointIconFontClass,iconFontColor:"#C43E1C",nativeUriScheme:"ms-powerpoint:ofe|u|"}),e.applicationConversionMap.set(y.b.OneNote,{iconFontClass:q.oneNoteIconFontClass,iconFontColor:"#7719AA",nativeUriScheme:"onenote:"}),e.applicationConversionMap.set(y.b.Sway,{iconFontClass:q.swayIconFontClass,iconFontColor:"#038387"}),e.applicationConversionMap.set(y.b.Forms,{iconFontClass:q.formsIconFontClass,iconFontColor:"#038387"}),e.applicationConversionMap.set(y.b.PowerBI,{iconFontClass:q.powerBIIconFontClass,iconFontColor:"#FFB900"}),e.applicationConversionMap.set(y.b.Stream,{iconFontClass:q.streamIconFontClass,iconFontColor:"#BC1948"}),e.applicationConversionMap.set(y.b.StreamsVideo,{iconFontClass:q.streamIconFontClass,iconFontColor:"#BC1948"}))}return e.prototype.ngOnInit=function(){var e=this;this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.isMicrosoftForms=this.item.fileType===y.b.Forms||this.item.fileType===y.b.FormsQuiz,this.disableFileNavigation=this.item.isDeleted,this.mruItemStateSubscription=this.eventService.events.withScope(0).pipe(Object(h.a)((function(e){return"mruItemStateChange"===e.name}))).subscribe((function(t){t.args[1].docId===e.item.docId&&(0!==t.args[0]&&1!==t.args[0]||(e.mruItemState=t.args[0]))})),this.myAnalyticsState=2,this.uiCardType=this.isMicrosoftForms?"borderless":"normal",this.isCardCreateByLabel=this.isMicrosoftForms;var t=this.mruConfigService.config;this.shortDate=this.windowService.innerWidth<640,this.locService.supportsLocaleSpecifiers&&(this.dateSubscription=this.eventService.events.withScope(1).pipe(Object(h.a)((function(e){return"contentWidthChanged"===e.name}))).subscribe((function(t){var n;n=Object(i.__read)(t.args,1),e.shortDate=n[0]<640}))),this.thumbnailSWEnabled=t.thumbnailSWEnabled,this.permissionsEnabled=t.permissionsEnabled,this.sharedText=this.locService.SharedText,this.privateText=this.locService.OnlyYouText,this.shareActionTitle=this.locService.ShareActionTitle,this.copyLinkActionTitle=this.locService.CopyLinkActionTitle,this.suggestedActionsReplyTitle=this.locService.SuggestedActionReply,this.suggestedActionsMeetingTitle=this.locService.SuggestedActionJoinMeeting,this.suggestedActionsViewChangesTitle=this.locService.SuggestedActionViewChanges,this.suggestedActionsAddToToDoTitle=this.locService.AddToToDo,this.suggestedActionsViewTaskTitle=this.locService.SuggestedActionViewTask,this.dismissSquareRegular=this.domSanitizer.bypassSecurityTrustHtml(l),this.dismissSquareFilled=this.domSanitizer.bypassSecurityTrustHtml(a),this.checklistIcon=this.domSanitizer.bypassSecurityTrustHtml(c),this.meetingIcon=this.domSanitizer.bypassSecurityTrustHtml(s),this.replyIcon=this.domSanitizer.bypassSecurityTrustHtml(o),this.saveAClassNotebook=this.locService.SaveAClassNotebook,this.uploadLocalFileTitle=this.locService.UploadToOneDriveTitle,this.uploadAndOpen=this.locService.PwaUploadAndOpenMenuItem,this.isMobile=this.deviceDetector.isMobileDevice(),this.isTouch=this.isMobile||this.deviceDetector.isTabletDevice(),this.showMobileShareAndActivity=this.mruConfigService.config.mobileShareAndActivityEnabled,this.showOnlyMruActivity=this.item.format===k.a.Recent&&this.mruConfigService.config.onlyMruActivityEnabled,this.mruActivity=this.mruConfigService.config.mruActivityEnabled,this.recommendedDeepLinkEnabled=this.capabilitiesService.capabilities.recommendedDeepLinkEnabled,this.recommendedTeamsLinkEnabled=this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled,this.recommendedMotion=t.recommendedMotionEnabled&&!this.fluentRefresh,this.recommendedNewCards=t.recommendedNewCardsEnabled,this.isStreamsVideo=this.item.format===k.a.StreamsVideo,this.leftNavEnabled=this.capabilitiesService.capabilities.leftNavReact,this.wacHostHoverPrebootEnabled=this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType)&&this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(this.item.fileType),this.dismissItemTitle=this.locService.RemoveDocumentActionTitle,this.isNewTitle=this.locService.IsNewTitle,this.centerThumbnail=this.item.fileType===y.b.PowerPoint,this.mruAppSuffix=this.mruAppType?"-"+y.b[this.mruAppType].toLowerCase():"",this.upcomingMeetingAttendeeDisplayMax=t.upcomingMeetingAttendeeDisplayMax,this.isUpcomingMeetingAccepted=this.item.isUpcomingMeetingAccepted,this.addToToDoText=this.locService.AddToToDo,this.viewInToDoText=this.locService.ViewInToDo,this.doneText=this.locService.Done,this.notATaskText=this.locService.NotATask,this.pinActionTitle=this.locService.PinDocumentActionTitle,this.unpinActionTitle=this.locService.UnpinDocumentActionTitle,this.pinActionId="pin_menu",this.unpinActionId="unpin_menu",this.pinActionIcon="PinDown",this.unpinActionIcon="Unpin",this.replacePinActionEnabled&&(this.pinActionTitle=this.locService.FavoriteActionTitle,this.unpinActionTitle=this.locService.UnfavoriteActionTitle,this.pinActionIcon="FavoriteStar",this.unpinActionIcon="Unfavorite"),this.actionContextMenuEnabled&&(this.replacePinActionEnabled?(this.pinActionId="Favorite",this.unpinActionId="Unfavorite",this.pinActionIconReact={type:u.a.ActionContextMenuIcon,iconName:"StarIcon"},this.unpinActionIconReact={type:u.a.ActionContextMenuIcon,iconName:"StarOffIcon"}):(this.pinActionId="pin",this.unpinActionId="unpin",this.pinActionIconReact={type:u.a.ActionContextMenuIcon,iconName:"PinIcon"},this.unpinActionIconReact={type:u.a.ActionContextMenuIcon,iconName:"UnpinIcon"})),this.workloadsPromise=this.workloadsService.getWorkloads(),this.workloadColorPromise=this.workloadsPromise.then((function(t){var n;return(null===(n=null==t?void 0:t.find((function(t){return t.FileType===e.item.fileType})))||void 0===n?void 0:n.Color)||""})),this.initializeItemFeatures()},e.prototype.ngOnChanges=function(e){var t=this;e.hasOwnProperty("item")&&(!e.hasOwnProperty("index")||this.isRecommended||this.isOfficeFeed)&&(this.initializeItemFeatures(),this.isStreamsVideo=this.item.format===k.a.StreamsVideo,this.thumbnailAltText=this.createThumbnailAltText(this.item.fileType)),!e.hasOwnProperty("view")||e.view.firstChange||"Tile"!==e.view.currentValue&&"Card"!==e.view.currentValue||this.isRecommended||this.isOfficeFeed||this.thumbnailLoaded||this.thumbnailUrl||this.mruItemInflationService.inflateThumbnails(this.item).then((function(){t.thumbnailUrl=t.getThumbnailUrl(),t.onThumbnailLoad(),t.thumbnailAltText=t.createThumbnailAltText(t.item.fileType)}))},e.prototype.ngOeners()},e.prototype.showAsis.view},e.prototype.showAsTile=function(){return"Tile"===this.view&&this.item.format!==k.a.Trending},e.prototype.showAsCard=function(){return"Card"===this.view||"Tile"===this.view&&this.item.format===k.a.Trending},e.prototype.showAsSuggestedAction=function(){return this.capabilitiesService.capabilities.suggestedActionsEnabled&&"SuggestedAction"===this.view},e.prototype.iconFontClass=function(){var t=e.applicationConversionMap.get(this.item.fileType);return t?t.iconFontClass:null},e.prototype.iconFontColor=function(){var t=e.applicationConversionMap.get(this.item.fileType);return t?t.iconFontColor:null},e.prototype.onItemClick=function(t){var r,o=this;if(this.disableFileNavigation)t.preventDefault();else if(!t.defaultPrevented){this.isOfficeFeed&&this.officeFeedService.logInstrumentation([this.item.feedbackId],["click"],[this.item.fromCache?"cache":"service"]),t.preventDefault();var a=Object(i.__read)(this.getLaunchUrlAndClickId(this.url),2),l=a[0],s=a[1],c=this.getClickData(t),u=c.params.ElementId||"Unknown";s&&(c.params.RequestId=s),c.params.IsEmailAttachment=this.item.isEmailAttachment?"true":"false",c.params.IsOnPremOrVanity=this.item.isOnPremOrVanity?"true":"false";var p=!1,h=function(t,n,i,r){if(!p){p=!0;var a=t?c.params.Referral:"";if(r&&(c.params.ClickDestination="ContentPage"),o.instrumentationService.logClickEvent(c.eventName,u,o.instrumentationArea,a,n,c.params,c.metrics,o.dataSecurityThreshold,i),Object(d.a)({eventName:c.eventName,id:u,area:o.instrumentationArea,subArea:"Document",result:a?"Refer":"Navigate",target:a?Object(f.a)(a):"Other"},o.dataSecurityThreshold),e.isFirstClick&&!o.isRecommended){var l=o.performanceService.getRecordedMarkerNameBySubstring("Paint_MRU");l&&o.performanceService.mark("MRU_First_ItemClick",l),e.isFirstClick=!1}}};"_blank"!==this.contextService.sharedContext.defaultLinkTarget&&h(!0,"Web");var m=this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType),b=this.capabilitiesService.capabilities.fluidSupportEnabled&&this.item.fileType===y.b.Fluid,g=y.b.Forms===this.item.fileType?"_self":"_blank",v=function(){var e=(!o.item.isOnPremOrVanity||o.isConsumer)&&o.accessTokenService.hasOneDriveToken()||o.contextService.sharedContext.inMockMode;if(m&&e||b)if(t.ctrlKey){var i="/"+"launch/:app/content".replace(":app",y.b[o.item.fileType]),r=F.a.replacePathAndAddParams(o.windowService.nativeWindow.location.href,i,I.a.getParamsForMruFileItem(o.item,b?{siteUrl:o.item.sharepointIds.siteUrl}:{}));o.urlLauncherService.openUrl(r,"OpenMruItem",g).then((function(){h(!0,"Web")}),(function(){h(!1)}))}else{var a=Date.now();b&&(o.fluidInstrumentationService.logPerformanceBootStart(o.fluidHostContext.getBootId()),o.fluidHostContext.hostScenarioLifecycle="Load",o.fluidHostContext.hostScenarioName=o.item.fileType===y.b.Fluid?"Canvas":"MeetingNotes",o.fluidHostContext.hostScenarioEntryPoint="MRU",o.fluidHostContext.hostScenarioStartTime=a),h(!0,"Web",!0,!0),m?o.wacContentService.bootstrapAndRouteMruFileItem(o.item,o.getWdOrigin(!1),void 0,a,o.inflationPromise):o.officeRouteService.navigateTo({route:"Content",app:o.item.fileType},!1,I.a.getParamsForMruFileItem(o.item,b?{siteUrl:o.item.sharepointIds.siteUrl}:{}))}else{if(o.item.fileType===y.b.Pdf&&!o.item.isEmailAttachment){var s=Object(T.h)(o.item);(o.isRecommended||o.isOfficeFeed)&&(s.Application="PdfViewer",s.MruV2Type="DocumentUrl"),o.mruDataService.writeMruDocument(s)}var c=l||o.item.webUrl;o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(c,{action:"OpenMruItem",linkTarget:o.isMicrosoftForms?"_self":void 0}).then((function(){h(!0,"Web")}),(function(){h(!1)}))})):o.urlLauncherService.openUrl(c,"OpenMruItem",o.isMicrosoftForms?"_self":null).then((function(){h(!0,"Web")}),(function(){h(!1)}))}};this.item.isEmailAttachment||this.capabilitiesService.capabilities.contentLauncherEnabled?function(){if(o.capabilitiesService.capabilities.contentLauncherEnabled){var e=o.getOfficeStartDocument();Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchContent({action:"OpenMruItem",document:e,linkTarget:o.isPwa||t&&t.ctrlKey?"_blank":y.b.Forms===o.item.fileType||y.b.FormsQuiz===o.item.fileType?"_self":"_blank",useWebUrl:!0,wdOriginType:"REC","Web")}),(function(){h(!1)}))}))}else v()}():this.localAppLauncherService.launchOfficeApp(this.item.application,this.item.canonicalUrl,null).then((function(e){return e||o.item.isLocal?e:(v(),!0)})).then((function(e){e?h(!0,"Native"):(o.openUploadLocalModal(1),h(!1))})).catch((function(){v()})),"OfficeHome"===(null===(r=this.officeRouteService.getCurrentRoute())||void 0===r?void 0:r.route)&&this.floodgateService.recordFloodgate(["ClickedOnDocument"])}},e.prototype.onPathClick=function(e){e.preventDefault(),this.openFolder();var t=this.getAttributionClickData(),n=t.params.ElementId||"Unknown",i=t.params.Referral;this.instrumentationService.logClickEvent(t.eventName,n,this.instrumentationArea,i,this.item.isLocal?"Native":"Web",t.params,t.metrics,this.dataSecurityThreshold),Object(d.a)({eventName:t.eventName,id:n,area:this.instrumentationArea,subArea:"DocumentPath",result:i?"Refer":"Navigate",target:i?Object(f.a)(i):"Other"},this.dataSecurityThreshold)},e.prototype.onMyAnalyticsClick=function(e,t){var n,i;e.preventDefault();var r=this.getClickData(e);this.instrumentationService.logClickEvent(r.eventName,r.params.ElementId||"Unknown",this.instrumentationArea);var o=e.target;this.officeFeedService.performAction(this.item.feedbackId,t,this.getActionPayLoadByName(t)),o===(null===(n=this.myAnalyticsAddToDoElement)||void 0===n?void 0:n.nativeElement)?(this.myAnalyticsState=0,this.actionContextMenuEnabled?(this.addToContextMenuReact(this.createViewInToDoActionItemReact()),this.removeFromContextMenuReact(this.addToToDoText)):(this.addToContextMenu(this.createViewInToDoActionItem()),this.removeFromContextMenu(this.addToToDoText)),this.showAsSuggestedAction&&this.setViewInToDoAsPrimaryAction()):o===(null===(i=this.myAnalyticsTaskDoneElement)||void 0===i?void 0:i.nativeElement)&&this.removeItem()},e.prototype.onViewToDoClick=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,r,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.getToDoUrl()];case 1:return t=i.sent(),r=new URL(t),o=""+r.origin+r.pathname+"/inbox"+r.search,this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o,{action:"OpenToDoLink"})})):this.urlLauncherService.openUrl(o,"OpenToDoLink"),this.instrumentAction("open",e),[2]}}))}))},e.prototype.disableClick=function(){event.preventDefault()},e.prototype.onShareClick=function(e,t,n){var i=this;if(e&&e.preventDefault(),this.item.isLocal)this.openUploadLocalModal(2);else{if(this.shareControlMode=n,this.showDesktopShareControl=!this.mobileMenusEnabled,this.shareControlLoading=!0,this.currentShareSource=t,this.showDesktopShareControl){var r=function(e){if(!i.shareControlLoading&&i.showDesktopShareControl&&!(e instanceof MouseEvent&&2===e.button)){if(i.shareControl.nativeElement.contains(e.target))return;i.onShareControlDismiss(!1)}};this.shareControlClickListener=this.renderer.listen(this.documentService.nativeDocument,"click",r),this.shareControlTouchListener=this.renderer.listen(this.documentService.nativeDocument,"touchend",r),this.shareControlKeyListener=this.renderer.listen(this.documentService.nativeDocument,"keyup",(function(e){var t=E.a.getKey(e);i.showDesktopShareControl&&3===t&&i.onShareControlDismiss(!0)})),setTimeout((function(){return i.shareControlLoading=!1}),0)}this.mobileMenusEnabled&&(this.shareControlKeyboardFocus=e instanceof KeyboardEvent,this.shareControlService.showControl({file:this.item,index:this.index,mode:this.shareControlMode}),this.shareControlService.subscribeToCloseEvents((function(e){i.item===e.file&&i.index===e.index&&i.onShareControlDismiss(i.shareControlKeyboardFocus)}))),this.instrumentAction(g.a[n].toLowerCase()+"_"+t)}},e.prototype.onShareControlDismiss=function(e){this.showDesktopShareControl=!1,this.removeShareControlListeners(),e&&this.focusOnShareAction(),this.currentShareSource=""},e.prototype.pinItem=function(e,t){if(this.item.isLocal)return e&&e.preventDefault(),void this.openUploadLocalModal(this.replacePinActionEnabled?3:0);this.updatePinnedState(!0,e,t)},e.prototype.u!1,e,t)},e.prototype.onThumbnailLoad=function(){var e=this;setTimeout((function(){e.isStreamsVideo?(e.streamsThumbnailLoaded=!0,e.thumbnailLoaded=!1):(e.thumbnailLoaded=!0,e.streamsThumbnailLoaded=!1)})),this.thumbnailInstrumentationService.instrumentThumbnailLoad(!0,this.thumbnailUrl,this.listId,this.index,this.item.fileType)},e.prototype.onThumbnailError=function(){var e=this;setTimeout((function(){e.item.thumbnails=null,e.streamsThumbnailLoaded=!1,e.thumbnailLoaded=!1})),this.thumbnailInstrumentationService.instrumentThumbnailLoad(!1,this.thumbnailUrl,this.listId,this.index,this.item.fileType)},e.prototype.onActionsMenuToggle=function(e){this.actionsMenuOpen=e,this.recommendedMotion&&(this.isHovered="unhovered")},e.prototype.onFocus=function(){this.itemFocused=!0},e.prototype.onBlur=function(){this.itemFocused=!1},e.prototype.onAnalyticsDescriptionChanged=function(e){this.analyticsDescriptiveAriaLabel=e,this.setDescriptiveAriaLabel()},e.prototype.uploadLocal=function(e){var t=this;e&&e.preventDefault(),this.uploadLocalFileService.getLocalFileInfo(this.item.url,this.item.fileName).then((function(e){t.uploadLocalFileService.uploadFile(e,"upload-local-file-commanding")}))},e.prototype.recommendedHover=function(e){!this.actionsMenuOpen&&this.recommendedMotion&&(this.isHovered=e)},e.prototype.dismissHover=function(e){this.dismissIsHover=e},e.prototype.getWdOriginTaskForClick=function(e){return void 0===e&&(e=!1),this.isRecommended||this.isOfficeFeed?e?"REC-OIB":"REC":"unpinned-mru"===this.listId?e?"MRU-OIB":"MRU":"OTHER"},e.prototype.onSelectPrimaryAction=function(e){e&&(e.preventDefault(),"id"in this.primaryAction?this.primaryAction.executeAction():this.primaryAction.executeAction(e))},e.prototype.removeItem=function(e){var t=this;e&&e.preventDefault(),this.actionContextMenuEnabled?this.runUnregisteredAction("index})})):(this.deleteItem.emit({item:this.item,index:this.index}),this.instrumentAction("remove"))},e.prototype.suggestedAct20x20")},e.prototype.onSuggestedActionsClick=function(e,t,i,r,o){var a=this;void 0===o&&(o=!1);var l=function(){a.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchUrl(e||a.url,{action:t.toString()})})):a.urlLauncherService.openUrl(e||a.url,t),a.instrumentAction(i,r)};o?(this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(t){return t.launchApp({action:"OpenDocument",appName:a.item.application,url:e||a.item.canonicalUrl,useUrl:!0})})):this.localAppLauncherService.launchOfficeApp(this.item.application,e||this.item.canonicalUrl,null)).then((function(e){e?a.instrumentAction("openInApp",r):l()})).catch((function(){l()})):l()},e.prototype.addToContextMenu=function(e,t){this.contextMenu&&-1===this.contextMenu.items.findIndex((function(t){return t.getId()===e.getId()}))&&(void 0!==t&&t>=0&&t<this.contextMenu.items.length?this.contextMenu.items.splice(t,0,e):this.contextMenu.items.push(e))},e.prototype.removeFromContextMenu=function(e){var t,n,i=this.contextMenu.items.findIndex((function(t){return t.title===e}));-1!==i&&(null===(n=null===(t=this.contextMenu)||void 0===t?void 0:t.items)||void 0===n||n.splice(i,1))},e.prototype.addToContextMenuReact=function(e,t){if(this.actionContextMenu){var n=this.actionContextMenu.actions.findIndex((function(t){return t.id===e.id}));-1===n&&(this.actionContextMenu.actions=void 0!==t&&t>=0&&t<this.contextMenu.items.length?this.actionContextMenu.actions.slice(0,n).concat(e,this.actionContextMenu.actions.slice(n,this.actionContextMenu.actions.length)):this.actionContextMenu.actions.concat(e))}},e.prototype.removeFromContextMenuReact=function(e){var t=this.actionContextMenu.actions.findIndex((function(t){return t.title===e}));-1!==t&&(this.actionContextMenu.actions=this.actionContextMenu.actions.slice(0,t).concat(this.actionContextMenu.actions.slice(t+1,this.actionContextMenu.actions.length)))},e.prototype.getDisplayTime=function(){return this.item.format===k.a.Shared||this.item.format===k.a.SharedForm?this.item.sharedTime>new Date("1980-01-01T00:00:00Z")?this.item.sharedTime:null:this.item.format===k.a.Trending||this.item.format===k.a.ClassNoteBook||this.item.format===k.a.NoteBook||this.item.format===k.a.Form||this.item.format===k.a.MyAnalytics?this.item.lastModifiedTime:this.item.lastViewedTime},e.prototype.openUploadLocalModal=function(e){this.uploadLocalFileService.showModal(this.item.url,this.item.fileName,e)},e.prototype.onAddToDoCallback=function(e,t,n){var i=this;void 0===e&&(e=!1),void 0===t&&(t=!0),t&&(this.capabilitiesService.capabilities.contentActionsEnabled&&(e?this.contentActionsService.createToDoSuccessNotification((function(){i.onViewToDoClick(n)})):this.contentActionsService.createToDoErrorNotification()),this.maybeAddViewTodo(e))},e.prototype.maybeAddViewTodo=function(e){e&&(this.myAnalyticsState=0,this.actionContextMenuEnabled?(this.addToContextMenuReact(this.createViewInToDoActionItemReact()),this.removeFromContextMenuReact(this.addToToDoText)):(this.addToContextMenu(this.createViewInToDoActionItem()),this.removeFromContextMenu(this.addToToDoText)),this.showAsSuggestedAction&&this.setViewInToDoAsPrimaryAction())},e.prototype.initializeItemFeatures=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.isMicrosoftForms&&this.initializeFormsFeature(),t=this.mruConfigService.config,this.showSharing=this.showSharing&&!(this.mruAppType===y.b.OneNote&&(k.a.Shared===this.item.format||k.a.ClassNoteBook===this.item.format||k.a.NoteBook===this.item.format))&&!(this.isMicrosoftForms&&this.item.format===k.a.Shared),this.isRecommended=this.item.format===k.a.Recommended,this.isOfficeFeed=this.item.format===k.a.News||this.item.format===k.a.OfficeFeedDocument||this.item.format===k.a.StreamsVideo||this.item.format===k.a.UpcomingMeeting||this.item.format===k.a.MyAnalytics,this.isNewsArticle=this.item.format===k.a.News,this.isUpcomingMeeting=this.item.format===k.a.UpcomingMeeting,this.isMyAnalytics=this.item.format===k.a.MyAnalytics,this.instrumentationArea=this.showAsSuggestedAction()?S.b.SuggestedActions:this.isRecommended||this.isOfficeFeed?S.b.Recommended:S.b.Documents,this.url=t.webUrlMruConsumerEnabled&&this.isConsumer&&this.item.webUrl?this.item.webUrl:this.item.url,n=this.item.fileType!==y.b.Sway&&this.item.fileType!==y.b.Project&&this.item.fileType!==y.b.ProjectOperations,r=O.a.Format(this.item.isEmailAttachment&&this.item.emailReference&&this.item.emailReference.Subject?[this.item.emailReference.Subject]:this.item.isEmailAttachment?[this.locService.OpenFileLocationActionTitle]:this.item.pathArray,this.contextService.isRtl,e.shortPathCharacterLimit),this.shortPath=n?r[1]:null,this.plainTextPath=n?r[0]:null,this.openFolderAriaLabel=this.item.isEmailAttachment?this.locService.OpenFileLocationActionTitle:this.locService.format(this.locService.OpenFileLocationActionWithLocationTitle,this.plainTextPath),this.displayTime=this.getDisplayTime(),this.displayTimeString=this.displayTime?this.locService.localizedDateString(this.displayTime):null,this.shareControlEnabled=t.shareControlEnabled&&this.item.fileType!==y.b.PowerBI&&this.item.fileType!==y.b.Project&&this.item.fileType!==y.b.ProjectOperations&&this.item.fileType!==y.b.Portfolio&&this.item.fileType!==y.b.Sway&&this.item.fileType!==y.b.Forms&&this.item.fileType!==y.b.StreamsVideo&&!(this.item.format===k.a.Shared&&this.item.isEmailAttachment)&&this.item.format!==k.a.UpcomingMeeting&&this.item.fileType!==y.b.MyAnalytics,this.copyLinkEnabled=t.copyLinkEnabled&&this.shareControlEnabled,this.mruPinEnabled=t.mruPinEnabled&&this.item.format===k.a.Recent,this.clickableFolderEnabled=t.clickableFolderEnabled&&!!this.item.attributionUrl,this.actionContextMenuEnabled?[4,this.setupActionsMenuReact()]:[3,2];case 1:return i.sent(),[3,3];case 2:this.setupActionsMenu(),i.label=3;case 3:return this.updateAnimation(this.item),this.setDescriptiveAriaLabel(),this.thumbnailLoaded=this.thumbnailUrl&&this.thumbnailUrl===this.getThumbnailUrl(),this.dataSecurityThreshold=this.item.isLocal?2:0,this.activityDeepLink=this.recommendedDeepLinkEnabled&&this.item.navigationId?this.addLoginHint(this.url+"&nav="+this.item.navigationId):void 0,this.teamsDeepLink=this.recommendedTeamsLinkEnabled&&this.item.teamsDeepLink,this.inflationPromise=this.mruItemInflationService.inflateItem(this.item,"Card"===this.view||"Tile"===this.view,this.showAnalytics,this.mruAppType),this.inflationPromise.then((function(e){o.updateAnimation(e),o.thumbnailUrl=o.getThumbnailUrl(),o.thumbnailLoaded=!!o.thumbnailUrl,o.setBorderlessCardDetail1(),o.setDescriptiveAriaLabel(),o.capabilitiesService.wacHostEnabledForFileType(o.item.fileType)&&o.item.wopiData&&o.item.wopiData.wac&&o.item.wopiData.wac.bootstrapperUrl&&o.uiHostBootstrapperService.loadBootstrapper(o.item.wopiData.wac.bootstrapperUrl,o.item.wopiData.wac.applicationUrl,o.item.fileType,!0).then((function(){var e;"Start"===(null===(e=o.officeRouteService.getCurrentRoute())||void 0===e?void 0:e.route)&&o.wacContentService.prebootApplication(o.item.fileType,o.contextService.getWdOrigin("PREBOOT"))})),o.updateActionItemsOnInflated()})),[2]}}))}))},e.prototype.initializeFormsFeature=function(){this.isFormResponsesEnabled=this.mruAppType===y.b.Forms,this.formEnumType=this.item.getFormEnumType(),this.categoryIcon={},"poll"===this.formEnumType?(this.categoryIcon.categoryFontIcon=v.a.PollResults,this.categoryIcon.categoryTooltip=this.locService.FormsPoll):"assignments"===this.formEnumType&&(this.categoryIcon.categoryFontIcon=v.a.AccountActivity,this.categoryIcon.categoryTooltip=this.locService.FormsAssignment)},e.prototype.updateActionItemsOnInflated=function(){var e=this;this.mruItemService.updateActionItemsOnInflated(this.index,this.item,this.isConsumer).forEach(this.actionContextMenuEnabled?function(t){e.actionContextMenu.actions=e.actionContextMenu.actionsitem.id}));var n=Object(i.__spread)(e.actionContextMenu.actions);n.splice(t.start,t.deleteCount,e.wrapAdditionalActionReact(t.item)),e.actionContextMenu.actions=n}:function(t){e.contextMenu.items=e.contextMenu.items.filter((function(e){return e.getId()!==t.item.id})),e.contextMenu.items.splice(t.start,t.deleteCount,e.wrapAdditionalAction(t.item))})},e.prototype.setBorderlessCardDetail1=function(){this.isMicrosoftForms&&(this.borderlessCardDetail1=this.item.metaData&&null!=this.item.metaData.formsResponseCount?this.locService.format(this.locService.ResponsesText,this.item.metaData.formsResponseCount.toString()):"")},e.prototype.setDescriptiveAriaLabel=function(){var e=[this.locService.format(this.locService.DocumentDescriptiveAriaLabelTitle,this.item.title)];this.showSharing&&this.item.sharing&&e.push(this.locService.format(this.item.sharing.shared?this.locService.DocumentDescriptiveAriaLabelShared:this.locService.DocumentDescriptiveAriaLabelPrivate,this.item.fileTypeName));var t=this.buildDescriptiveDate();if(t&&e.push(t),this.showActivity&&!this.isRecommended&&!this.isOfficeFeed){var n=this.activityDescriptionService.activityDescription(this.item.activities,this.item.lastViewedTime,!1);e.push(n&&n.plainText?this.locService.format(this.locService.DocumentDescriptiveAriaLabelActivity,n.plainText):this.locService.DocumentDescriptiveAriaLabelNoActivity)}this.showAnalytics&&this.analyticsDescriptiveAriaLabel&&e.push(this.analyticsDescriptiveAriaLabel),this.isCardCreateByLabel&&(this.item.createdBy&&e.push(this.locService.format(this.locService.DocumentDescriptiveAriaLabelCreatedBy,this.item.createdBy)),this.item.metaData&&null!=this.item.metaData.formsResponseCount&&e.push(this.locService.format(this.locService.DocumentDescriptiveAriaLabelNumResponses,this.item.metaData.formsResponseCount.toString()))),this.descriptiveAriaLabel=e.join(" ")},e.prototype.buildDescriptiveDate=function(){var e=this.responsiveRelativeDatePipe.transform(this.displayTime,!1,this.displayTimeString,!1),t=e;if(e)switch(this.item.format){case k.a.Trending:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelLastModified,e);break;case k.a.Shared:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelDateShared,e);break;case k.a.Recommended:case k.a.News:case k.a.OfficeFeedDocument:t=this.item.activity&&this.item.activity.plainText?this.item.activity.plainText+e:"";break;default:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelLastOpened,e)}return t},e.prototype.focusOnShareAction=function(){"topLevel"===this.currentShareSource?this.shareTopLevelElement.nativeElement.focus():this.actionsMenuElement.dropdownMenu.dropdownLink.nativeElement.focus()},e.prototype.removeShareControlLtener()},e.prototype.updateAnimation=function(e){this.isNew=e.isNew,this.isNewAnimationState=this.isNew?"active":"inactive"},e.prototype.updatePinnedState=function(e,t,n){var i=this;if(t&&t.preventDefault(),this.item.lastViewedTime=this.dateService.getCurrentDate(),this.displayTime=this.getDisplayTime(),this.displayTimeString=this.displayTime?this.locService.localizedDateString(this.displayTime):null,this.changePinState.emit({item:this.item,isPinned:e,element:this.mruListItem,index:this.index}),this.actionContextMenuEnabled){if(!("id"in this.pinAction)||!("id"in this.unpinAction))return;if(-1===(r=this.actionContextMenu.actions.findIndex((function(t){return t.id===(e?i.pinActionId:i.unpinActionId)}))))return;this.actionContextMenu.actions=this.actionContextMenu.actions.slice(0,r).concat(e?this.unpinAction:this.pinAction,this.actionContextMenu.actions.slice(r+1,this.actionContextMenu.actions.length))}else{if(!("getId"in this.pinAction)||!("getId"in this.unpinAction))return;var r;if(-1===(r=this.contextMenu.items.findIndex((function(t){return t.getId()===(e?i.pinActionId:i.unpinActionId)}))))return;this.contextMenu.items[r]=e?this.unpinAction:this.pinAction,this.instrumentAction((e?"pin":"unpin")+"_"+n)}this.itemFocused=!1},e.prototype.setupActionsMenuReact=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o,a=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=this.mruConfigService.config,this.item.downloadUrl=this.item.documentUrl,t=this.showAsSuggestedAction()?"SuggestedActions":this.isRecommended||this.isOfficeFeed?"Recommended":"Documents",[4,this.contentActionsService.createDocumentActions(this.item,this.listId+"-"+this.item.id,t,this.listId)];case 1:return n=i.sent(),[4,this.contentActionsService.getContentActionsGroupInfo()];case 2:return r=i.sent(),this.item.isLocal&&(n=n.concat(this.createUploadActionItemReact())),this.item.format===k.a.Recent&&this.mruPinEnabled&&(this.createPinUnpinActionItemsReact(),n=n.concat(this.item.isPinned?this.unpinAction:this.pinAction)),!this.item.isLocal&&(this.item.format===k.a.Recent||(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&e.recommendedRemoveItemEnabled)&&(o=this.createRemoveActionItemReact(),n=n.concat(o)),this.item.format===k.a.ClassNoteBook&&(n=n.concat(this.createCopyClassNoteBookActionItemReact())),this.mruItemService.generateAdditionalActionsMenuItems(this.index,this.item,this.isConsumer).act(e))})),this.item.fileType===y.b.MyAnalytics&&this.item.potentialAction.forEach((function(e){var t=e.name,i=a.getTextByActionType(t);n=n.concat({id:t,title:i,ariaLabel:i,contentActionOptions:{icon:a.getIconReactByActionType(t)},executeAction:function(){a.executeFeedAction(t,a.item.feedbackId,t,e.actionPayload),t!==b.a.DismissAction&&t!==b.a.MarkAsNotATask&&t!==b.a.MarkTaskAsDone||a.removeItem()},disabled:!1})})),this.actionContextMenu={id:this.getContextMenuId(),itemIndex:this.index,actions:n,groupInfo:r,mouseEvent:void 0,targetElement:void 0},this.showActionsMenu=n.length>0,this.contextMenu={id:this.getContextMenuId(),items:[]},this.showAsSuggestedAction()&&this.item.activity&&this.item.activity.reasonType&&this.setupPrimaryAction(),[2]}}))}))},e.prototype.setupActionsMenu=function(){var t,r,o=this,a=this.mruConfigService.config,l=e.applicationConversionMap.get(this.item.fileType),s=a.newMruActions&&l;if(this.item.isEmailAttachment){var c=this.item.format===k.a.OfficeFeedDocument||1===this.item.emailReference.AttachmentType?this.locService.OpenInOutlookActionTitle:this.locService.format(this.locService.OpenOnlineActionTitle,this.item.application);return r=[{getId:function(){return"open"},title:c,ariaLabel:c,iconCssClass:s?l.iconFontClass:"",icon:s?null:v.a.FolderOpen,iconColor:s?l.iconFontColor:null,executeAction:function(){o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o.url,{action:"OpenAttachment"})})):o.urlLauncherService.openUrl(o.url,"OpenAttachment"),o.instrumentAction("open")}}],this.shareControlEnabled&&1!==(null===(t=this.item.emailReference)||void 0===t?void 0:t.AttachmentType)&&this.getShareControlElements(r),(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&a.recommendedRemoveItemEnabled&&r.push(this.createRemoveActionItem()),this.showActionsMenu=!0,this.contextMenu={id:this.getContextMenuId(),items:r,customLogging:!0,cssClass:e.actionsMenuCssClass},this.primaryAction=r[0],void(this.primaryActionIconFont=v.a.FolderOpen)}r=[],this.disableFileNavigation||this.item.fileType===y.b.MyAnalytics||r.push({getId:function(){return"open"},title:this.isUpcomingMeeting?this.locService.OpenInCalendar:this.locService.OpenInBrowser,ariaLabel:this.isUpcomingMeeting?this.locService.OpenInCalendar:this.locService.OpenInBrowser,iconCssClass:s?l.iconFontClass:"",icon:s?null:this.isUpcomingMeeting?v.a.Calendar:v.a.FolderOpen,iconColor:s?l.iconFontColor:null,executeAction:this.item.isLocal?function(){return o.openUploadLocalModal(1)}:function(){var e,t=Object(i.__read)(o.getLaunchUrlAndClickId(null!==(e=o.item.webUrl)&&void 0!==e?e:o.url,!0),1)[0];o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenFile"})})):o.urlLauncherService.openUrl(t,"OpenFile"),o.instrumentAction("open")},disabled:this.item.isLocal}),this.item.isLocal&&r.push(this.createUploadActionItem()),this.shareControlEnabled&&(this.showDesktopShareControl=!1,this.getShareControlElements(r));var u,d=this.item.fileType!==y.b.PowerBI&&this.item.fileType!==y.b.Sway&&this.item.fileType!==y.b.OneNote&&this.item.fileType!==y.b.Forms&&this.item.fileType!==y.b.Project&&this.item.fileType!==y.b.ProjectOperations&&this.item.fileType!==y.b.Portfolio&&this.item.fileType!==y.b.StreamsVideo&&this.item.format!==k.a.UpcomingMeeting&&this.item.format!==k.a.MyAnalytics;if(a.newMruActions){if(l&&l.nativeUriScheme){var f=this.deviceDetector.isDesktopDevice()?this.locService.OpenInDesktopApp:this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice()?this.locService.OpenInApp:this.locService.OpenActionTitle;r.splice(1,0,{getId:function(){return"openInApp"},title:f,ariaLabel:f,iconCssClass:s?l.iconFontClass:"",icon:s?null:v.a.FolderOpen,iconColor:s?l.iconFontColor:null,executeAction:function(){o.localAppLauncherService.launchOfficeApp(o.item.application,o.item.canonicalUrl).then((function(e){if(!e){if(!o.item.isLocal)throw new Error("fallback to protocol handler");var t=""+l.nativeUriScheme+o.item.canonicalUrl;o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenInApp",linkTarget:"_self"}).catch((function(){o.openUploadLocalModal(1)}))})):o.urlLauncherService.openUrl(t,"OpenInApp","_self"odal(1)}))}})).catch((function(){var e=o.item.canonicalUrl.lastIndexOf("?"),t=o.item.canonicalUrl;e>0&&(t=t.substring(0,e));var i=""+l.nativeUriScheme+t;o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9"self"})})):o.urlLauncherService.openUrl(i,"OpenInApp","_self")})),o.instrumentAction("openInApp")}})}this.downloadActionEnabled&&d&&a.showDownloadAction&&!this.item.isLocal&&this.item.format!==k.a.News&&this.item.fileType!==y.b.Fluid&&!Object(A.a)(this.item.fileType)&&this.item.driveId&&this.item.documentUrl&&r.push({getId:function(){return"download"},title:this.locService.DownloadMruItemActionTitle,ariaLabel:this.locService.DownloadMruItemActionTitle,icon:v.a.Download,executeAction:function(){o.oneDriveService.getDownloadUrl({driveId:o.item.driveId,itemId:o.item.docId,itemUrl:o.item.documentUrleturn e})).catch((function(e){var t;return o.instrumentationService.logGenericEvent("Get_DownloadUrl_Error",((t={}).Error=(null==e?void 0:e.toString())||"",t.Area=o.instrumentationArea,t)),Object(p.a)({eventName:"Get_DownloadUrl_Error",message:(null==e?void 0:e.toString())||"",debugInfo:o.instrumentationArea}),o.item.documentUrl})).then((function(e){o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(t){t.launchUrl(e,{action:"Download"})})):o.urlLauncherService.openUrl(e,"Download"),o.instrumentAction("download")}))}}),d&&r.push({getId:function(){return"openFileLocation"},title:this.locService.OpenFileLocationActionTitle,ariaLabel:this.openFolderAriaLabel,icon:v.a.Folder,execuation")}})}this.item.format===k.a.Recent&&this.mruPinEnabled&&(this.createPinUnpinActionItems(),u=this.item.isPinned?this.unpinAction:this.pinAction,a.newMruActions&&d?r.splice(r.length-(this.item.isLocal?1:2),0,u):r.push(u));if(!this.item.isLocal&&(this.item.format===k.a.Recent||(this.isRecommended||this.isOfficeFeed&&!this.isMyAnalytics)&&a.recommendedRemoveItemEnabled)){var h=this.createRemoveActionItem();a.newMruActions&&d?r.splice(r.length-1,0,h):r.push(h)}this.item.format===k.a.ClassNoteBook&&r.push(this.createCopyClassNoteBookActionItem()),this.mruItemService.generateAdditionalActionsMenuItems(this.index,this.item,this.isConsumer).forEach((function(e){return r.push(o.wrapAdditionalAction(e))})),this.item.fileType===y.b.MyAnalytics&&(r.push({getId:function(){return"open"},title:this.locService.OpenInOutlookActionTitle,ariaLabel:this.locService.OpenInOutlookActionTitle,icon:v.a.Outlook,executeAction:function(){var e,t=Object(i.__read)(o.getLaunchUrlAndClickId(null!==(e=o.item.webUrl)&&void 0!==e?e:o.url,!0),1)[0];o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenFile"})})):o.urlLauncherService.openUrl(t,"OpenFile"),o.instrumentAction("open")},disabled:!1}),this.item.potentialAction.forEach((function(e){var t=o.getTextByActionType(e.name),n=e.name;r.push({getId:function(){return n},title:t,ariaLabel:t,icon:o.getIconByActionType(e.name),executeAction:function(){o.executeFeedAction(n,o.item.feedbackId,n,e.actionPayload),n!==b.a.DismissAction&&n!==b.a.MarkAsNotATask&&n!==b.a.MarkTaskAsDone||o.removeItem(),o.instrumentAction(n)},disabled:!1})}))),this.showActionsMenu=!(1===r.length&&"open"===r[0].getId()),this.contextMenu={id:this.getContextMenuId(),items:r,customLogging:!0,cssClass:(this.leftNavEnabled?"actions-menu--left-nav ":"")+e.actionsMenuCssClass+(this.isTouch&&(this.isRecommended||this.isOfficeFeed)?" actions-menu--mobile":"")},this.showAsSuggestedAction()&&this.item.activity&&this.item.activity.reasonType&&this.setupPrimaryAction()},e.prototype.setupPrimaryAction=function(){var e=this;switch(this.item.activity.reasonType){case m.a.MyAnalytics:this.primaryAction={title:this.addToToDoText,ariaLabel:this.addToToDoText,getId:function(){return"suggestedActionsAddToToDo"},executeAction:function(){e.executeFeedAction("add_todo",e.item.feedbackId,b.a.PromoteTask,e.getActionPayLoadByName(b.a.PromoteTask),"add_todo")}},this.primaryActionIconFont=v.a.ToDo;break;case m.a.Task:this.primaryAction={title:this.suggestedActionsViewTaskTitle,ariaLabel:this.suggestedActionsViewTaskTitle,getId:function(){return"suggestedActionsViewTask"},executeAction:function(){return Object(i.__awaiter)(e,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return this.onSuggestedActionsClick(this.activityDeepLink,"OpenFile","open","view_task",!0),[2]}))}))}},this.showListSvg=!0;break;case m.a.Comment:case m.a.Mention:this.primaryAction={title:this.suggestedActionsReplyTitle,ariaLabel:this.suggestedActionsReplyTitle,getId:function(){return"suggestedActionsReply"},executeAction:function(){e.onSuggestedActionsClick(e.activityDeepLink,"OpenFile","open","reply",!0)}},this.showReplySvg=!0;break;case m.a.Edit:case m.a.Trending:this.primaryAction={title:this.suggestedActionsViewChangesTitle,ariaLabel:this.suggestedActionsViewChangesTitle,getId:function(){return"suggestedActionsViewChanges"},executeAction:function(){e.onSuggestedActionsClick(e.activityDeepLink,"OpenFile","open","view_changes",!0)}},this.primaryActionIconFont=v.a.Pencil;break;case m.a.Meeting:this.primaryAction={title:this.suggestedActionsMeetingTitle,ariaLabel:this.suggestedActionsMeetingTitle,getId:function(){return"suggestedActionsMeeting"},executeAction:function(){e.onSuggestedActionsClick(e.item.joinUrl,"OpenTeamsMeeting","join_meeting","upcoming_meeting")}},this.showMeetingSvg=!0;break;default:this.primaryAction=this.actionContextMenuEnabled?this.actionContextMenu.actions[0]:this.contextMenu.items[0],this.primaryActionIconFont=v.a.Compass}},e.prototype.getTextByActionType=function(e){var t="";switch(e){case b.a.DismissAction:t=this.locService.RemoveDocumentActionTitle;break;case b.a.PromoteTask:t=this.addToToDoText;break;case b.a.MarkAsNotATask:t=this.notATaskText;break;case b.a.MarkTaskAsDone:t=this.doneText;break;default:t=""}return t},e.prototype.getIconByAceturn t},e.prototype.getIconReactByActionType=function(e){switch(e){case b.a.DismissAction:return{type:u.a.ActionContextMenuIcon,iconName:"SubtractIcon"};case b.a.PromoteTask:return{type:u.a.Svg,iconName:"ToDoSvgIcon"};case b.a.MarkAsNotATask:return{type:u.a.ActionContextMenuIcon,iconName:"DismissIcon"};case b.a.MarkTaskAsDone:return{type:u.a.ActionContextMenuIcon,iconName:"CheckmarkIcon"};default:return{type:u.a.Svg,iconName:"ToDoSvgIcon"}}},e.prototype.getIconReactByIconFontType=function(e){switch(e){case v.a.Copy:return{type:u.a.ActionContextMenuIcon,iconName:"CopyIcon"};case v.a.Delete:return{type:u.a.ActionContextMenuIcon,iconName:"DeleteIcon"};case v.a.Move:return{type:u.a.ActionContextMenuIcon,iconName:"MoveFolderIcon"};case v.a.Restore:return{type:u.a.ActionContextMenuIcon,iconName:"RestoreIcon"};case v.a.Unpin:return{type:u.a.ActionContextMenuIcon,iconName:"UnpinIcon"};default:return{type:u.a.ActionContextMenuIcon,iconName:"DocumentIcon"}}},e.prototype.getShareControlElements=function(e){var t=this;e.push({getId:function(){return"share"},title:this.shareActionTitle,ariaLabel:this.shareActionTitle,icon:v.a.Share2,executeAction:function(e){t.onShareClick(e,"menu",g.a.Share)},disabled:this.item.isLocal}),this.copyLinkEnabled&&e.push({getId:function(){return"copylink"},title:this.copyLinkActionTitle,ariaLabel:this.copyLinkActionTitle,icon:v.a.Link,execupyLink)},disabled:this.item.isLocal}),this.item.isOnPremOrVanity||this.shareControlService.getToken(this.item.documentUrl,!1,this.item.fileType)},e.prototype.createCopyClassNoteBookActionItem=function(){var e=this;return{getId:function(){return"copyClassNoteBook"},title:this.locService.SaveAClassNotebook,ariaLabel:this.saveAClassNotebook,icon:v.a.Save,executeAction:function(){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(t){t.launchUrl(e.onenoteService.generateSaveCopyClassNotebookLink(e.item.docId,e.item.fileName,e.url),{action:"CopyNotebook",linkTarget:"_NewSaveCopyWindow",width:500,height:500})})):e.urlLauncherService.openUrl(e.onenoteService.generateSaveCopyClassNotebookLink(e.item.docId,e.item.fileName,e.url),"CopyNotebook","_NewSaveCopyWindow",500,500),e.instrumentAction("copyClassNoteBook")}}},e.prototype.createCopyClassNoteBookActionItemReact=function(){var e=this;return{id:"copyClassNoteBook",title:this.locService.SaveAClassNotebook,ariaLabel:this.saveAClassNotebook,contentActionOptions:{icon:{type:u.a.ActionContextMenuIcon,iconName:"SaveIcon"}},executeAction:function(){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(t){t.launchUrl(e.onenoteService.generateSaveCopyClassNotebookLink(e.item.docId,e.item.fileName,e.url),{action:"CopyNotebook",linkTarget:"_NewSaveCopyWindow",width:500,height:500})})):e.urlLauncherService.openUrl(e.onenoteService.generateSaveCopyClassNotebookLink(e.item.docId,e.item.fileName,e.url),"CopyNotebook","_NewSaveCopyWindow",500,500),e.instrumentAction("copyClassNoteBook")},disabled:!1}},e.prototype.createPinUnpinActionItems=function(){var e=this;this.pinAction={getId:function(){return e.pinActionId},title:this.pinActionTitle,ariaLabel:this.pinActionTitle,icon:v.a[this.pinActionIcon],executeAction:function(){return e.pinItem(null,"menu")},disabled:this.item.isLocal},this.unpinAction={getId:function(){return e.unpinActionId},title:this.unpinActionTitle,ariaLabel:this.unpinActionTitle,icon:v.a[this.unpinActionIcon],executeAction:function(){return e.unpinItem(null,"menu")},disabled:this.item.isLocal}},e.prototype.createPinUnpinActionItemsReact=function(){var e=this;this.pinAction={id:this.pinActionId,title:this.pinActionTitle,ariaLabel:this.pinActionTitle,contentActionOptions:{icon:this.pinActionIconReact},executeAction:function(){return e.runUnregisteredAction(e.pinActionId,(function(){return e.pinItem(null,"menu")}))},disabled:this.item.isLocal},this.unpinAction={id:this.unpinActionId,title:this.unpinActionTitle,ariaLabel:this.unpinActionTitle,contentActionOptions:{icon:this.unpinActionIconReact},executeAction:function(){return e.runUnregisteredAction(e.unpinA"menu")}))},disabled:this.item.isLocal}},e.prototype.createRemoveActionItem=function(){var e=this;return{getId:function(){return"remove"},title:this.locService.RemoveDocumentActionTitle,ariaLabel:this.locService.RemoveDocumentActionTitle,icon:v.a.Minus,executeAction:function(){return e.removeItem()}}},e.prototype.createRemoveActionItemReact=function(){var e=this;return{id:"remove",title:this.locService.RemoveDocumentActionTitle,ariaLabel:this.locService.RemoveDocumentActionTitle,contentActionOptions:{icon:{type:u.a.ActionContextMenuIcon,iconName:"SubtractIcon"}},executeAction:function(){return e.removeItem()},disabled:!1}},e.prototype.createUploadActionItem=function(){var e=this;return{getId:function(){return"upload"},title:this.uploadAndOpen,ariaLabel:this.uploadAndOpen,icon:v.a.Upload,executeAction:function(){e.uploadLocal()}}},e.prototype.createUploadActionItemReact=function(){var e=this;return{id:"upload",title:this.uploadAndOpen,ariaLabel:this.uploadAndOpen,contentActionOptions:{icon:{type:u.a.ActionContextMenuIcon,iconName:"UploadIcon"}},executeAction:function(){return e.runUnregisteredAction("upload",e.uploadLocal)},disabled:!1}},e.prototype.createViewInToDoActionItem=function(e){var t=this;return{getId:function(){return"todo"},title:this.viewInToDoText,ariaLabel:this.viewInToDoText,icon:v.a.ToDo,executeAction:function(){t.onViewToDoClick(e)},disabled:!1}},e.prototype.createViewInToDoActionItemReact=function(e){var t=this;return{id:"todo",title:this.viewInToDoText,ariaLabel:this.viewInToDoText,contentActionOptions:{icon:{type:u.a.Svg,iconName:"ToDoSvgIcon"}},executeAction:function(){return t.runUnregisteredAction("todo",(function(){return t.onViewToDoClick(e)}))},disabled:!1}},e.prototype.setViewInToDoAsPrimaryAction=function(){this.primaryAction=this.createViewInToDoActionItem("view_todo"),this.primaryActionIconFont=v.a.ToDo},e.prototype.getConteitem.id},e.prototype.executeFeedAction=function(e,t,n,i,r){var o=this,a=n===b.a.PromoteTask;this.actionContextMenuEnabled?this.runUnregisteredAction(e,(function(){o.officeFeedService.performAction(t,n,i).then((function(e){o.onAddToDoCallback(e,a,r)})).catch((function(e){o.onAddToDoCallback(!1,a,r)}))})):this.officeFeedService.performAction(t,n,i).then((function(e){o.onAddToDoCallback(e,a,r)})!1,a,r)}))},e.prototype.runUnregisteredAction=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return Object(i.__generator)(this,(function(i){return n=this.maybeGetReferralAndPlatform(e),r=n.referral,o=n.referralPlatform,this.contentActionsService.runUnregisteredAction(e,t,this.instrumentationArea,this.getInstrumentationParams(),r,o),[2]}))}))},e.prototype.getClickData=function(e){var t=this.showAsSuggestedAction()?"Suggested_Action_Click":this.isRecommended||this.isOfficeFeed?"Recommended_Click":"Mru_Click",n=this.item.getClickData(t,"Click",this.index),i=e.target;if(n.params.ItemId=this.titleElement&&i===this.titleElement.nativeElement?"title":this.fileIconElement&&i===this.fileIconElement.nativeElement?"icon":this.attributionElement&&i===this.attributionElement.nativeElement?"attribution":this.timestampElement&&i===this.timestampElement.nativeElement?"timestamp":this.myAnalyticsTaskDoneElement&&i===this.myAnalyticsTaskDoneElement.nativeElement?"taskDoneLink":this.myAnalyticsAddToDoElement&&i===this.myAnalyticsAddToDoElement.nativeElement?"addToDoLink":"item",void 0!==this.relativeIndex&&(n.params.RelativeIndex=this.relativeIndex.toString()),n.params.ItemCategory=this.listId,n.params.State=this.view,n.params.ResourceId=this.item.resourceId,this.activityEnabled){var r=this.item.activities||[],o=this.activityDescriptionService.filterActivities(r,this.item.lastViewedTime)||[];n.params.ActivityCommentsCount=o.filter((function(e){return e.action.type===w.a.Comment})).length.toString(),n.params.ActivityEditsCount=o.filter((function(e){return e.action.type===w.a.Edit})).length.toString(),n.params.ActivityMentionsCount=oMention})).length.toString(),n.params.ActivityTotalCount=r.length.toString(),n.params.ActivityCountSinceLastOpened=o.length.toString(),n.params.ActivityCollaboration=this.getActivityCollab(),n.params.ActivityDisplayed=w.a[this.activityDescriptionService.displayedActivityType(o,this.item.lastViewedTime,!1)]}return n.params.ClickDestination="ExternalPage",n},e.prototype.getAttributionClickData=function(){var e=this.item.getClickDataForPath("Mru_Path_Click","Click",this.index);return e.params.ItemCategory=this.listId,e.params.ResourceId=this.item.resourceId,e},e.prototype.getInstrumentationParams=function(e){var t={};return t.RenderSize=this.contextMenu.items.length.toString(),t.Index=this.index.toString(),t.DocumentType=this.item.fileTypeName,t.ItemCategory=this.listId,t.Pinned=this.item.isPinned.toString(),t.State=this.view,t.ResourceId=this.item.resourceId,t.ActivityCollaboration=this.getActivityCollab(),t.SuggestedActionType=e,void 0!==this.relativeIndex&&(t.RelativeIndex=this.relativeIndex.toString()),t},e.prototype.maybeGetReferralAndPlatform=function(e){var t,n=null;return"open"===e||"openInApp"===e?(n=k.b.referralFromFileType(this.item.fileType),t="open"===e?"Web":"Native"):"openFileLocation"===e?(n=k.b.referralFromFileLocation(this.url),t=this.item.isLocal?"Native":"Web"):"join_meeting"===e&&(n="Teams",t="Web"),{referral:n,referralPlatform:t}},e.prototype.instrumentAction=function(e,t){var n=this.getInstrumentationParams(t),i=this.maybeGetReferralAndPlatform(e),r=i.referral,o=i.referralPlatform;if(this.item.format===k.a.OfficeFeedDocument||this.item.format===k.a.News||this.item.format===k.a.UpcomingMeeting){var a="click";switch(e){case"copylink_menu":a="copyLink";break;case"share_menu":a="share"}"join_meeting"===e?this.officeFeedService.logInstrumentation([this.item.feedbackId],[a],[this.item.fromCache?"cache":"service"],["joinMeeting"]):"remove"!==e&&"myAnalyticsInsight"!==this.item.mruV2Category&&this.officeFeedService.logInstrumentation([this.item.feedbackId],[a],[this.item.fromCache?"cache":"service"])}this.instrumentationService.logClickEvent("Actions_Menu_Item_Click",e,this.instrumentationArea,r,o,n,[],this.dataSecurityThreshold),Object(d.a)({eventName:"Actions_Menu_Item_Click",id:e,area:this.instrumentationArea,subArea:"ActionsMenuItem",result:r?"Refer":"Navigate",target:r?Object(f.a)(r):"Actions"},this.dataSecurityThreshold)},e.prototype.getActivityCollab=function(){var e=this;return(this.isRecommended||this.isOfficeFeed)&&this.item.isCollab?"true":(this.item.activities||[r.user)})).toString()},e.prototype.getThumbnailUrl=function(){var t=this;if(!this.item.thumbnails)return null;if(this.isMicrosoftForms)return this.item.thumbnails.large;var n=e.acceptedThumbnailExtensions.includes(this.item.extension);return n&&this.item.format===k.a.StreamsVideo?(this.streamsVideoThumbnail=this.officeFeedService.getStreamsThumbnail(this.item.thumbnails.recommendedThumbnail),this.streamsVideoThumbnail.then((function(e){t.onThumbnailLoad()})).catch((function(){t.onThumbnailError()})),null):n&&this.thumbnailApiEnabled&&!this.isNewsArticle?(this.thumbnail=this.oneDriveService.getThumbnailString(this.item.thumbnails.recommendedThumbnail),this.thumbnail.then((function(e){t.onThumbnailLoad()})).catch((function(e){t.onThumbnailError()})),null):this.item.thumbnails&&!this.thumbnailApiEnabled?(this.onThumbnailLoad(),this.isRecommended||this.isOfficeFeed||this.item.format===k.a.Trending?this.item.thumbnails.recommendedThumbnail||this.item.thumbnails.large:this.item.thumbnails.medium):void this.onThumbnailError()},e.prototype.openFolder=function(){if(this.item.isLocal)this.localAppLauncherService.openPathInExplorer(this.item.attributionUrl);else{var e=this.isUpcomingMeeting?this.item.joinUrl:this.item.isEmailAttachment?this.url:this.item.attributionUrl;e=this.addLoginHint(e),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9"tion"})})):this.urlLauncherService.openUrl(e,"OpenFileLocation"),this.isUpcomingMeeting&&this.instrumentAction("join_meeting")}},e.prototype.getWdOrigin=function(e){return void 0===e&&(e=!1),this.contextService.getWdOrigin(this.getWdOriginTaskForClick(e))},e.prototype.addLoginHint=function(e){return this.item.shouldAddLoginHint()&&(e=F.a.appendLoginHint(e,this.clientStartupConfigService.config.loginHint,this.capabilitiesService.capabilities.outgoingLoginHintEnabled)),e},e.prototype.getLaunchUrlAndClickId=function(e,t){if(void 0===t&&(t=!1),e=this.addLoginHint(e),this.mruConfigService.config.addWacParams&&this.item.fileType!==y.b.Sway&&this.item.fileType!==y.b.Forms&&this.item.fileType!==y.b.Pdf&&this.item.fileType!==y.b.Fluid&&this.item.fileType!==y.b.PowerBI&&!this.item.isLocal&&!this.item.isOnPremOrVanity&&!this.item.isEmailAttachment&&this.item.format!==k.a.News){var n=Date.now(),r=P.a.createGuid(),o=this.capabilitiesService.capabilities.scenarioId,a=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({ct:n,wdOrigin:this.getWdOrigin(t)},this.isConsumer?{}:{cid:r}),this.item.fileType===y.b.Stream?{web:1}:{}),this.wacContentService.getWacHostControlQueryParams(this.item.fileType)),o?{wdscenarioid:o}:{});return[F.a.appendAndReplaceQueryParams(e,a,!0),r]}if(this.isMicrosoftForms){var l=this.officeRouteService.getCurrentRoute(),s=this.clientStartupConfigService.config.sharedClientStartupContext;return[F.a.appendAndReplaceQueryParams(e,{lang:this.contextService.sharedContext.officeMarket,origin:"prodprv"===s.deploymentEnvironment&&"scu"===s.geoName?D.b:D.a,route:l&&l.route?l.route:void 0,sessionId:this.clientStartupConfigService.config.sharedClientStartupContext.sessionId},!0),void 0]}return this.item.fileType===y.b.Stream?[F.a.appendQueryParam(e,"web","1"),void 0]:[e,void 0]},e.prototype.createThumbnailAltText=function(e){var t=this.locService.ThumbnailImageAltText;switch(e){case y.b.Word:return this.locService.format(t,this.locService.ThumbnailWordType);case y.b.Excel:return this.locService.format(t,this.locService.ThumbnailExcelType);case y.b.PowerPoint:return this.locService.format(t,this.locService.ThumbnailPowerPointType);case y.b.OneNote:case y.b.OneNoteClassNoteBook:return this.locService.format(t,this.locService.ThumbnailOneNoteType);case y.b.Pdf:return this.locService.format(t,this.locService.ThumbnailPdfType);case y.b.Visio:return this.locService.format(t,this.locService.ThumbnailVisioType);case y.b.Text:return this.locService.format(t,this.locService.ThumbnailTextType);case y.b.Sway:return this.locService.format(t,this.locService.ThumbnailSwayType);case y.b.Forms:return this.locService.format(t,this.locService.ThumbnailFormsType);case y.b.Project:case y.b.ProjectOperations:return this.locService.format(t,this.locService.ThumbnailProjectType);case y.b.Portfolio:return this.locService.format(t,this.locService.ThumbnailProjectPortfolioType);case y.b.NewsArticle:return this.locService.format(t,this.locService.ThumbnailNewsType);case y.b.PowerBI:return this.locService.format(t,this.locService.ThumbnailPowerBIType);default:return""}},e.prototype.getActionPayLoadByName=function(e){var t;return null===(t=this.item.potentialAction.filter((function(t){return t.name===e}))[0])||void 0===t?void 0:t.actionPayload},e.prototype.getOfficeStartDocument=function(){var e,t=y.a.referralFromFileLocation(this.item.url);return{app:this.item.application,attribution:this.item.attribution,canonicalUrl:this.item.canonicalUrl,deepLinkUrl:this.item.teamsDeepLink,docId:this.item.docId,downloadUrl:this.item.documentUrl,driveId:this.item.driveId,extension:this.item.extension,fileType:y.b[this.item.fileType],id:this.item.id,isEmailAttachment:this.item.isEmailAttachment,isLocalFile:this.item.isLocal,isMsftDogfood:this.item.isMsftDogfood,isOnPremOrVanity:this.item.isOnPremOrVanity,iconUrl:this.item.iconUrl,isRedeemed:null!==(e=this.item.isRedeemed)&&void 0!==e?e:t===C.a.OneDrive||t===C.a.SharePoint,title:this.item.title,url:this.item.url,webUrl:this.item.webUrl}},e.prototype.wrapAdditionalAction=function(e){var t=this;return Object(i.__assign)(Object(i.__assign)({},e),{getId:function(){return e.id},executeAction:function(){t.instrumentAction(e.id),e.executeAction().then((function(e){e.forEach((function(e){switch(e.key){case"add":t.addItem.emit(e.props);break;case"delete":t.deleteItem.emit(e.props);break;case"disableAction":t.contextMenu.items=t.contextMenu.items.filter((function(t){return t.getId()!==e.props.id}))}}))}))}})},e.prototype.wrapAdditionalActionReact=function(e){var t=this;return{id:e.id,title:e.title,ariaLabel:e.ariaLabel,contentActionOptions:{icon:this.getIconReactByIconFontType(e.icon)},executeAction:function(){return t.runUnregisteredAction(e.id,(function(){return e.executeAction().then((function(e){e.forEach((function(e){switch(e.key){case"add":t.addItem.emit(e.props);break;case"delete":t.deleteItem.emit(e.props);break;case"disableAction":t.contextMenu.items=t.contextMenu.itemsrops.id}))}}))}))}))},disabled:e.disabled}},e.shortPathCharacterLimit=25,e.actionsMenuCssClass="actions-menu",e.acceptedThumbnailExtensions=["flac","m4a","mp3","opus","wma","dwg","cool","fbx","glb","obj","ply","stl","3mf","dcm","dcm30","dic","dicm","dicom","epub","htm","html","eml","msg","md","markdown","cur","ico","icon","mat","pict","psb","psd","webp","xbm","xcf","xpm","txt","bas","bash","bat","c","cbl","cfg","cmd","cpp","cs","css","csv","h","java","js","json","log","php","pl","ps1","py","rb","sh","sql","vb","xaml","yaml","yml","key","numbers","pages","sketch","xd","doc","docx","dot","dotx","dotm","odt","rtf","ods","xls","xlsb","xlsm","xlsx","xltx","odp","ppt","pptx","pptm","pot","potx","potm","pps","ppsx","ppsxm","pano","fppx","hcp","ai","epdf","pdf","pdfa","mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg","bmp","dib","rle","gif","jpeg","jpe","jpg","jfif","exif","png","tiff","tif","dng","wdp","jxr","hdp","dds","heic","heif","avci","heics","heifs","avcs","arw","cr2","crw","erf","kdc","mrw","nef","nrw","orf","pef","raf","raw","rw2","rwl","sr2","srw","3fr","ari","bay","cap","cr3","dcs","dcr","drf","eip","fff","iiq","k25","mef","mos","ori","ptx","pxn","srf","x3f"],e}())},"32VK":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"3GGT":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){retsponse"}(i||(i={}))},"3XMr":function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var i=n("QjXU"),r=n("tyUq"),o=n("Dn7E"),a=n("2dXW"),l=n("SQAW"),s=n("1zhX"),c=n("3GGT"),u=n("hhzZ"),d=n("R7NL"),p=n("7ma0"),f=n("kpuN"),h=n("1Hgo"),m=n("uzn7"),b=n("wwmn"),g=n("Uqr9"),v=n("casz"),S=n("BMb5"),y=n("pOWU"),C=n("cgnd"),w=n("/I02"),T=n("uUrA"),k=n("ksTh"),I=n("IA5y"),_=n("keVe"),A=n("TOqr"),P=function(e){function t(t,n,i,r,o,l,s,c,u,d,p,f){var h=e.call(this,r,i,l,"Substrate",o,s,c,d)||this;h.localStorageService=t,h.windowService=n,h.instrumentationService=i,h.aadAppId=p,h.syncTimestampStorageKey=k.d+"."+h.windowService.nativeWindow.ewDbVersion,h._syncTimestampUpdated=new a.a,h.initialFullSyncCompleted=!1,h.startupConfig=u.config;var m=f.config;if(m){var b=0===m.substrateApiEndpoint.indexOf("/")?""+h.windowService.nativeWindow.location.origin+m.substrateApiEndpoint:m.substrateApiEndpoint;h.endpoint=""+b+m.edgeworthApiRootPath+m.deltaSyncApiPath+"?"+k.c+h.contextService.sharedContext.officeMarket}return h}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"syncTimestampUpdated",{get:function(){return this._syncTimestampUpdated.asObservable()},enumerable:!0,configurable:!0}),t.prototype.syncDocuments=function(){var e=this;return this.serverSyncTimestamp=null,new l.a((function(t){!function(){Object(i.__awaiter)(e,void 0,void 0,(function(){var e,n,a,l,s,u,d,p,f,h,m,b,v,S,y,C,w,k,I,_;return Object(i.__generator)(this,(function(A){switch(A.label){case 0:e=g.a.now(),n=new URL(this.endpoint),a=this.readLastSyncTimestamp(),l=T.a.createGuid(),a&&n.searchParams.append("startDateTime",a),s=n.toString(),u=1,d=0,A.label=1;case 1:p=void 0,A.label=2;case 2:return A.trys.push([2,4,,5]),[4,this.getPage(s,u,l)];case 3:return p=A.sent(),[3,5];case 4:return f=A.sent(),t.error(f),[2];case 5:return m=p.nextPageLink,b=p.hasFailures,v=p.version,(null==(h=p.items)?void 0:h.length)&&!this.serverSyncTimestamp&&(d+=h.length,S=Object(i.__read)(h,1),y=S[0],this.serverSyncTimestamp=2===v?y.last_store_modified_datetime:y.last_recommended_modified_datetime),t.next({items:h,hasPluginFailures:b}),!(C=m?this.endpoint+"&"+m:void 0)||s===C||u>40?[3,6]:(++u,s=C,[3,1]);case 6:return this.initialFullSyncCompleted||(w=g.a.now(),k=w-e,(_={}).ActualSize=d.toString(),_.ItemId=l,_.ItemCount=u.toFixed(),this.instrumentationService.logRequestEvent("EdgeworthFullSyncRequest",c.a.OK,k,null,!1,I=_),Object(r.a)({eventName:"EdgeworthFullSync",httpCode:c.a.OK,latency:k,fromCache:!1}),Object(o.a)({featureName:"Edgeworth",eventName:"EdgeworthFullSyncRequest",params:I}),this.initialFullSyncCompleted=!0),t.complete(),[2]}}))}))}()})).pipe(Object(s.a)(1))},t.prototype.markSyncCompleted=function(){if(this.serverSyncTimestamp){var e=this.getStorageKey();this.localStorageService.set(e,this.serverSyncTimestamp),this._syncTimestampUpdated.next(),this.serverSyncTimestamp=null}},t.prototype.resetTeKey())},t.prototype.handleQueryParam=function(e,t,n){"mockmru"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.readLastSyncT.get(e)},t.prototype.getPage=function(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r=this;return Object(i.__generator)(this,(function(i){return[2,new Promise((function(i,o){r.get("EdgeworthSubstrateDeltaSyncPageRequest","EdgeworthSubstrateDeltaSyncPage",e,(function(e){e.instrument((function(e,i){var o;i.ActualSize=((null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.files)?e.data.files.length:-1).toString(),i.RequestId=r.getRequestIdFromResponse(e),i.Index=t.toFixed(),i.ImpressionId=n,i.DebugInfo=Object(I.f)(e)})).then((function(e){var t,n,o,a,l=!(null===(t=e.data)||void 0===t?void 0:t.is_complete);i({items:r.parse(e.data.files||[]),nextPageLink:e.data.next_page_link,hasFailures:l,version:parseInt(null===(a=null===(o=null===(n=e.data)||void 0===n?void 0:n.diagnostics_data)||void 0===o?void 0:o.extended_info)||void 0===a?void 0:a.Version)||0}),r.scheduler.scheduleWork((function(){var t,n=(null===(t=e.data.files)||void 0===t?void 0:t.filter((function(e){return e.is_deleted})).map((function(e){return new Promise((function(t,n){r.scheduler.scheduleWork((function(){var i;null===(i=r.windowService.nativeWindow.ewIdb)||void 0===i||i.deleteItem(e.id).then(t).catch(n)}),4)}))})))||[];Promise.all(n).catch((function(e){var t,n;r.instrumentationService.logGenericEvent("Edgeworth_Cache_Delete_Error",((t={}).Error=(null===(n=null==e?void 0:e.toString)||void 0===n?void 0:n.call(e))||"",t))}))}),4)}))}),o,Object(I.a)(r.startupConfig.objectId+"@"+r.startupConfig.tenantId,r.contextService.sharedContext.recommendedIceApplicationId.toString(),r.startupConfig.objectId,r.aadAppId,T.a.createGuid(),r.contextService.getCurrentPageForLogging()),"network-only")}))]}))}))},t.prototype.parse=function(e){return e.map((function(e){var t=e.user_relationship,n=e.activities?e.activities.map((function(e){var t;try{t=JSON.parse(e.a)}catch(t){console.log("Error parsing activity: "+e.a)}return Object(i.__assign)(Object(i.__assign)({},e),{t:new Date(e.t),da:Object(i.__assign)(Object(i.__assign)({},e.da),{t:new Date(e.da.t)}),a:t})})):[],r=e.activity_badge?Object(i.__assign)(Object(i.__assign)({},e.activity_badge),{timestamp:e.activity_badge.timestamp?new Date(e.activity_badge.timestamp):void 0}):void 0;return Object(i.__assign)(Object(i.__assign)({},e),{last_recommended_modified_datetime:e.last_recommended_modified_datetime,last_store_modified_datetime:e.last_store_modified_datetime,user_relationship:Object(I.i)(t),activities:n,activity_badge:r,created_datetime:Object(I.j)(e.created_datetime),creation_info:e.creation_info?Object(i.__assign)(Object(i.__assign)({},e.creation_info),{timestamp:Object(I.j)(e.creation_info.timestamp)}):null,indexed:!1})}))},t.prototype.getStorageKey=function(){return this.syncTimestampStorageKey},t.ɵprov=_.kc({factory:function(){return new t(_.lc(m.a),_.lc(S.b),_.lc(u.a),_.lc(f.b),_.lc(w.a),_.lc(d.a),_.lc(b.a),_.lc(A.q),_.lc(C.b),_.lc(v.a),_.lc(p.a),_.lc(h.a))},token:t,providedIn:"root"}),t}(y.a)},"3anA":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("A/um"),r=function(){function e(){}return e.ge.a[t],n)},e.getCssClassFromGlyphName=function(t,n){var i=e.iconTypeToCssClass[t];return n&&(i=i+" "+e.SvgIconCssClass),i||"ms-Icon--placeholder"},e.FluentIconCssClass="ms-ohp-Icon",e.SvgIconCssClass="ms-ohp-svg-Icon",e.iconTypeToCssClass={Accepted:"ms-ohp-Icon--accepted",Access:"ms-ohp-Icon--accessLogo",AccountActivity:"ms-ohp-Icon--accountActivity",Add:"ms-ohp-Icon--add",AddTo:"ms-ohp-Icon--addTo",Alert:"ms-ohp-Icon--alert",ArrowLeft:"ms-ohp-Icon--back",ArrowRight:"ms-ohp-Icon--forward",At:"ms-ohp-Icon--accounts",Attach:"ms-ohp-Icon--attach",Calendar:"ms-ohp-Icon--calendar",ContactCardSettings:"ms-ohp-Icon--contactCardSettings",Chat:"ms-ohp-Icon--chatSolid",CheckMark:"ms-ohp-Icon--checkMark",ChevronDown:"ms-ohp-Icon--chevronDown",ChevronLeft:"ms-ohp-Icon--chevronLeft",ChevronRight:"ms-ohp-Icon--chevronRight",ChevronUp:"ms-ohp-Icon--chevronUp",CircleFill:"ms-ohp-Icon--circleFill",CircleInfo:"ms-ohp-Icon--circleInfo",Comment:"ms-ohp-Icon--chat",Compass:"ms-ohp-Icon--compassNW",Copy:"ms-ohp-Icon--copy",Declined:"ms-ohp-Icon--declined",Delete:"ms-ohp-Icon--delete",Devices3:"ms-ohp-Icon--devices3",Diamond:"ms-ohp-Icon--diamond",Document:"ms-ohp-Icon--page",Download:"ms-ohp-Icon--download",Ellipsis:"ms-ohp-Icon--moreVertical",Excel:"ms-ohp-Icon--excelLogo",FavoriteStar:"ms-ohp-Icon--favoriteStar",Filter:"ms-ohp-Icon--filter",FilterSolid:"ms-ohp-Icon--filterSolid",Folder:"ms-ohp-Icon--folder",FolderOpen:"ms-ohp-Icon--openFolderHorizontal",GiftCard:"ms-ohp-Icon--giftCard",Glimmer:"ms-ohp-Icon--glimmer",Group:"ms-ohp-Icon--group",Hide:"ms-ohp-Icon--hide",HighLander:"ms-ohp-Icon--highLanderLogo",Home:"ms-ohp-Icon--home",Link:"ms-ohp-Icon--link",ListBullets:"ms-ohp-Icon--list",Location:"ms-ohp-Icon--location",Mail:"ms-ohp-Icon--mail",Microsoft365:"ms-ohp-Icon--m365Logo",Minus:"ms-ohp-Icon--remove",Move:"ms-ohp-Icon--moveToFolder",News:"ms-ohp-Icon--newsfeedLogo",OfficeForms:"ms-ohp-Icon--formsLogo",Office:"ms-ohp-Icon--officeLogo",Office2:"ms-ohp-Icon--officeLogo2",OfficeStore:"ms-ohp-Icon--officeStore",OfficeThreshold:"ms-Icon--officeThreshold",OneDrive:"ms-ohp-Icon--oneDriveLogo",Outlook:"ms-ohp-Icon--outlookLogo",Onenote2:"ms-ohp-Icon--onenoteLogo",Page:"ms-ohp-Icon--page",Pencil:"ms-ohp-Icon--edit",PencilSolid:"ms-ohp-Icon--editSolid",People2:"ms-ohp-Icon--people",Permissions:"ms-ohp-Icon--permissions",Person:"ms-ohp-Icon--person",PhotoVideoMedia:"ms-ohp-Icon--photoVideoMedia",PinDown:"ms-ohp-Icon--pinned",PlayerSettings:"ms-ohp-Icon--playerSettings",PlaylistMusic:"ms-ohp-Icon--playlistMusic",PollResults:"ms-ohp-Icon--pollResults",PowerBI:"ms-ohp-Icon--powerBILogo",PowerPoint:"ms-ohp-Icon--powerpointLogo",Preview:"ms-ohp-Icon--preview",PreviewLink:"ms-ohp-Icon--previewLink",Project:"ms-ohp-Icon--projectLogo",Publisher:"ms-ohp-Icon--publisherLogo",Question:"ms-ohp-Icon--question",Restore:"ms-ohp-Icon--revToggleKey",Save:"ms-ohp-Icon--save",Search:"ms-ohp-Icon--search",Settings:"ms-ohp-Icon--settings",Share2:"ms-ohp-Icon--share",SharePoint:"ms-ohp-Icon--sharepointLogo",SkypeForBusiness:"ms-ohp-Icon--skypeForBusinessLogo",SortDown:"ms-ohp-Icon--sortDown",SortUp:"ms-ohp-Icon--sortUp",Stream:"ms-ohp-Icon--streamLogo",Sync:"ms-ohp-Icon--sync",System:"ms-ohp-Icon--system",Sway:"ms-ohp-Icon--swayLogo",Task:"ms-ohp-Icon--tasksLogo",Teams:"ms-ohp-Icon--teamsLogo",TentativelyAccepted:"ms-ohp-Icon--tentativelyAccepted",TextDocument:"ms-ohp-Icon--textDocument",ToDo:"ms-ohp-Icon--toDoLogoInverse",TileView:"ms-ohp-Icon--viewAll",Trending:"ms-ohp-Icon--trending12",Unfavorite:"ms-ohp-Icon--unfavorite",Unpin:"ms-ohp-Icon--unpin",Upload:"ms-ohp-Icon--upload",Video:"ms-ohp-Icon--video",Visio:"ms-ohp-Icon--visioLogo",Waffle:"ms-ohp-Icon--waffle",Word:"ms-ohp-Icon--wordLogo",X:"ms-ohp-Icon--cancel",X2:"ms-ohp-Icon--cancel"},e}()},"3bNC":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("QjXU"),r=n("lrJm"),o=n("hhzZ"),a=n("R7NL"),l=n("/I02"),s=n("kpuN"),c=n("aQ3G"),u=n("wwmn"),d=n("casz"),p=n("keVe"),f=n("TOqr"),h=function(e){function t(t,n,i,r,o,a,l,s){var c=e.call(this,t,n,i,r,o,a,l,s)||this;return c.cache=new Map,c}return Object(i.__extends)(t,e),t.prototype.getPeoplePictures=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.getPeoplePicture(e[n]));return Promise.all(t).then((function(e){return[].concat.apply([],Object(i.__spread)(e))}))},t.prototype.getPeoplePicture=function(e,t){var n=this;if(void 0===t&&(t=void 0),this.cache.has(e))return this.cache.get(e);var i=void 0===t?"users/"+e+"/photo/$value":"users/"+e+"/photos/"+t+"/$value",r=new FileReader,o=new Promise((function(e){n.getGraph("OneDrive_Graph_People_Picture_Request","OneDrive_Graph_People_Picture",i,"network-only",null,!0,null,null,null,!1,"blob").then((function(t){t&&t.ok?(r.onloadend=function(){var t=r.result&&"string"==typeof r.result&&r.result.split(",")||[];e(t.length>1?t[1]:null)},r.onerror=function(){return e(null)},r.onabort=function(){return e(null)},r.readAsDataURL(t.data)):e(null)})).catch((function(t){n.globalErrorHandler.handleError(t,"H5HgW"),e(null)}))}));return this.cache.set(e,o),o},t.ɵprov=p.kc({factory:function(){return new t(p.lc(s.b),p.lc(o.a),p.lc(a.a),p.lc(l.a),p.lc(u.a),p.lc(f.q),p.lc(r.b),p.lc(d.a))},token:t,providedIn:"root"}),t}(c.a)},"3g20":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("searchConfig"),this.config&&(this.config.searchInHeaderEnabled=this.config.searchInHeaderEnabled)}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},"3iMk":function(e,t,n){"use strict";function i(e,t,n){for(var i=0;i<e.length;i+=t){for(var r=[],o=[],a=0;a<t&&i+a<e.length;++a){var l=i+a;r.push(e[l]),o.push(l)}n(r,o)}}n.d(t,"a",(function(){return i}))},"3vWs":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.MSA=0]="MSA",e[e.OrgId=1]="OrgId",e[e.Unknown=-1]="Unknown"}(i||(i={}))},"4/We":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n("QjXU"),r=n("f0qX"),o=n("0XE2"),a=n("BaAg"),l=n("dFxn"),s=n("W3Zz"),c=n("uzn7"),u=n("5aVq"),d=n("keVe"),p=function(){function e(e,t){this.localStorageService=e,this.shellShimService=t}return e.parseBooleanFlagsAndFilter=function(e,t){return void 0===t&&(t=new Set),Object.keys(e).filter((function(n){return"boolean"==typeof e[n]&&!t.has(n)[n]=e[n],t}),{})},e.prototype.registerFlagsAerrides(e)},e.prototype.mergeConfigWithOverrides=function(e){var t=this.getOverrides();return Object.keysr?r:e[i],n}),{})},e.prototype.getOverrides=function(){var t;return null!==(t=this.localStorageService.getGlobal(e.localStorageKey))&&void 0!==t?t:{}},e.prototype.registerFeatures=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return t.sent().FeatureFlags.AddFeatureFlags(e),[2]}}))}))},e.localStorageKey="ShellFeatureFlags",e.ɵprov=d.kc({factory:function(){return new e(d.lc(c.a),d.lc(u.a))},token:e,providedIn:"root"}),e}(),f=n("Ax7d"),h=n("BMb5"),m=function(){function e(e,t,n,i,l){var c=this;if(this.featureManagerService=n,this.shouldOpenWithUIHost=!1,this.capabilities=t.parse("capabilities")||{accountSwitchingEnabled:!1,adminPolicyEnabled:!1,activityBasedTimeoutEnabled:!1,addToDoEnabled:!1,appBarEnabled:!1,appBarOverflowOnlyEnabled:!1,appBarAdminTileEnabled:!1,appBarFlyoutAddAppsStoreLinkEnabled:!1,appBarFlyoutMoreAppsGalleryLinkEnabled:!1,appBarMicaStylesEnabled:!1,appBarDragDropEnabled:!1,appBarMSAAppsInFlyoutEnabled:!1,appBarPinningEnabled:!1,appsModuleEnabled:!1,appManifestEnabled:!1,appsInHero:!1,altaBrandingChangesEnabled:!1,bottomTrayEnabled:!1,calendarEnabled:!1,capPopupEnabled:!1,captureScanEnabled:!1,clientTokenFetchEnabled:!1,contentActionsEnabled:!1,contentActionsOHomeEnabled:!1,contentLauncherEnabled:!1,compliantShareApiEnabled:!1,contextMenu20Enabled:!1,convertToPdfEnabled:!1,createBackgroundEnabled:!1,createCenterEnabled:!1,createCenterReactEnabled:!1,createClipchampEnabled:!1,createDesignerEnabled:!1,createTemplatesSeeMoreEnabled:!1,createDocAspxExcelEnabled:!1,createDocAspxPowerPointEnabled:!1,createDocAspxVisioEnabled:!1,createDocAspxWordEnabled:!1,createDocumentSupported:!1,createDynamicOrderingEnabled:!1,createOneDriveDocApiEnabled:!1,createOneNotePageEnabled:!1,createOnHomeEnabled:!1,createOnHomeReactEnabled:!1,createOnHomeListsEnabled:!1,createOnHomeDesignerEnabled:!1,createOnHomeHeaderTextRefreshEnabled:!1,createPaneSvgsEnabled:!1,createSharingLinkApiEnabled:!1,createStreamDocumentEnabled:!1,createStreamPlaylistEnabled:!1,createStreamRecorderEnabled:!1,createScreenRecordingDocumentEnabled:!1,createPlaylistWithNewUrlEnabled:!1,createVisioEnabled:!1,clientPwasEnabled:!1,darkModeEnabled:!1,darkModeOverride:!1,defaultHeaderLayoutEnabled:!1,delayedServiceWorkerInit:!1,deleteActionEnabled:!1,downloadActionEnabled:!1,dimeBrokerEnabled:!1,disableAnimation:!1,draftEnabled:!1,earlierStreamPlacementEnabled:!1,edgeworthEnabled:!1,edgeworthReactEnabled:!1,embedAppCachingEnabled:!1,embedHost:"",embedModeEnabled:!1,embedThemingEnabled:!1,favoriteTemplatesEnabled:!1,featureFlagsEnabled:!1,firstDraftFeedbackEnabled:!1,firstRunEnabled:!1,firstRunReactEnabled:!1,fluentHeader:!1,fluentRefresh:!1,fluentIconFontEnabled:!1,fluidAudience:"Unknown",fluidCapPopupEnabled:!1,fluidCreateAbpEnabled:!1,fluidCreateNewEnabled:!1,fluidFirst:!1,fluidMipEnabled:!1,fluidMockMipEnabled:!1,fluidSupportEnabled:!1,fluidUseServiceDeliveredDriver:!1,fluidVersionHistoryEnabled:!1,formsCalloutEnabled:!1,formsCapLoginEnabled:!1,gettingToKnowYouEnabled:!1,greetingRefreshEnabled:!1,heroGradientEnabled:!1,homeReorderedEnabled:!1,hoverPreloadTelemetryEnabled:!1,isConsumerUser:!1,isEmbedMode:!1,isPwaInUwp:!1,isPwaInWebView2:!1,installButtonReactEnabled:!1,installButtonReactMenuForConsumerEnabled:!1,irisForLearningShelfEnabled:!1,learningShelfEnabled:!1,leftNavCalloutEnabled:!1,leftNavReact:!1,leftNavEmptyImage:"",limitNetworkRequests:!1,listsCreateEnabled:!1,lorByDefaultEnabled:!1,maxInitialPlaces:0,maxTotalPlaces:0,memoryProfilingEnabled:!1,metaExtensionsFetchEnabled:!1,mobileContextMenusEnabled:!1,mobileCustomSearchEnabled:!1,msaClientTokensEnabled:!1,m365AppsAboutEnabled:!1,m365AppsEnabled:!1,m365DefaultThemeEnabled:!1,m365TestAppEnabled:!1,mosAppsHostedAtRoot:"",mosAppHostedAtRootEnabled:!1,feedEnabled:!1,modernStartAppsArray:new Array,modernStartPageEnabled:!1,modernStreamStartPageEnabled:!1,modernVisioStartPageEnabled:!1,modernLoopStartPageEnabled:!1,modernWhiteboardStartPageEnabled:!1,modernDesignerStartPageEnabled:!1,modernClipChampStartPageEnabled:!1,modernStartPageRootPath:null,modernTemplatesAppsArray:new Array,modernTemplatesPageEnabled:!1,myContentEnabled:!1,myContentGridViewEnabled:!1,myContentUsqEnabled:!1,m365AppsPageRootPath:null,nativeSearchInHeaderEnabled:!1,newConsumerExperienceEnabled:!1,newConsumerOverride:!1,newMruEmptyStateEnabled:!1,newUserShelfEnabled:!1,newUserShelfOverride:!1,northStarEnabled:!1,officeHomeFloodgate:!1,officeStartUsedThirdPartyAppsEnabled:!1,oneDriveApisEnabled:!1,oneDriveUploadEnabled:!1,otherFlights:"",outgoingLoginHintEnabled:!1,parkEnabled:!1,peopleCardsEnabled:!1,peopleListViewEnabled:!1,pinningPeopleEnabled:!1,powerBiCreateEnabled:!1,prefetchDataEnabled:!1,pwaEnabled:!1,quickAccessV1Enabled:!1,quickAccessV1GridViewEnabled:!1,quickAccessV1CustomPivotEnabled:!1,reactAppToggleEnabled:!1,recommendedDeepLinkEnabled:!1,recommendedFloodgate:!1,recommendedReact:!1,recommendedTeamsLinkEnabled:!1,redirectWhenSignedOutFromWorkloads:!0,reloadWhenAuthExpired:!0,reloadWhenPolicyCheckFailed:!0,reloadWhenReauthRequired:!0,remoteModulesEnabled:!1,replacePinActionEnabled:!1,scenarioId:null,scheduleEnabled:!1,secondaryTokensEnabled:!1,secondRunSREConsumerEnabled:!1,sharedServicesEnabled:!1,sharePointEnabled:!1,shareTokenClaimsEnabled:!1,shareToTeamsEnabled:!1,shellDocumentTitleEnabledInFluid:!1,shellFeedbackEnabled:!1,shellPinEnabled:!1,showA2HSPrompt:!1,showBusinessApps:!1,showFeedback:!1,showFloodgate:!1,showFolders:!1,showPwaFeelingsSurvey:!1,showSearch:!1,sideloadAppButtonEnabled:!1,surfaceExpEnabled:!1,spfxAppEnabled:!1,storeAppEnabled:!1,startPageAppsArray:new Array,startPageRootPath:null,stickyPagesEnabled:!1,suggestedActionsEnabled:!1,supportCentralEnabled:!1,svgAppIconsEnabled:!1,swayCreateNewEnabled:!1,teachingUiEnabled:!1,teachingUiReactEnabled:!1,teachingUiReactNewUserEnabled:!1,templatePageRootPath:null,templatesEnabled:!1,themeOverridesEnabled:!1,thumbnailEndpointEnabled:!1,threeSRdlFeedExperiment:"",threeSRdlFlightHeader:"",toDoM365AppEnabled:!1,unifiedHostPath:"",unityEnabled:!1,unityCalloutEnabled:!1,universalMeControlPWAEnabled:!1,universalMeControlSafetyFlightEnabled:!1,upgradeMosAppEnabled:!1,uploadV2Enabled:!1,streamUploadV2Enabled:!1,userConsentCallEnabled:!1,userPreferenceEnabled:!1,useVroomForOneDriveApis:!1,visualAppsModuleEnabled:!1,visualBackgroundEnabled:!1,visualBackgroundGradientEnabled:!1,visualCreateCenterModuleEnabled:!1,visualEnabled:!1,visualFeedModuleEnabled:!1,visualMyContentModuleEnabled:!1,visualSettingEnabled:!1,wacExcelJsApiV2Enabled:!1,wacHostAppsArray:new Array,wacHostPrebootAppsArray:new Array,wacHostTimeoutTeardownEnabled:!1,wacHostEnabled:!1,wacHostControlFlight:!1,wacHostHoverPreloadEnabled:!1,wacHostPagePath:"",wacSharingLinkEnabled:!1,wacStartPageEnabled:!1,wacHostExternalLinkEnabled:!1,wacHostOrgTemplatesEnabled:!1,wacHostGetAuthTokenEnabled:!1,wacHostGetCustomAuthConfigEnabled:!1,wacHostHoverPrebootAppsArray:new Array,wacHostHoverPrebootControlFlight:!1,wacWordJsApiV2Enabled:!1,wacHostMoveToFolderEnabled:!1,wbShowStoragePercentageEnabled:!1,webVitalsEnabled:!1,welcomeBadgeEnabled:!1,welcomeBadgeV2Enabled:!1,whiteboardCreateEnabled:!1,workloadPublicDataEnabled:!1,yammerCreateEnabled:!1,yammerM365AppEnabled:!1,claimsChallengeEnabled:!1,m365StringLogoEnabled:!1,m365MobileDesktopRebrandEnabled:!1,portalPreloadEnabled:!1,announcementEnabled:!1,useUSQEnabled:!1,showEnforcementEnabled:!1,hybridAuthEnabled:!1},this.capabilities.featureFlagsEnabled&&this.updateWithOverrides(),this.capabilities.oneDriveUploadEnabled=this.capabilities.oneDriveUploadEnabled&&e.isDesktopDevice(),this.capabilities.createDocumentSupported=!e.isMobileDevice()&&!e.isTabletDevice(s.e.AndroidTablet),this.capabilities.isPwaInUwp=this.capabilities.pwaEnabled&&e.isUwp(),this.capabilities.isPwaInWebView2=this.capabilities.pwaEnabled&&e.isWebView2(),this.capabilities.disableAnimation=this.capabilities.pwaEnabled,this.capabilities.mobileContextMenusEnabled=e.isMobileDevice(),this.capabilities.leftNavReact=this.capabilities.leftNavReact&&!e.isMobileDevice(),this.capabilities.appBarEnabled=this.capabilities.appBarEnabled&&!e.isMobileDevice(),this.capabilities.suggestedActionsEnabled=this.capabilities.suggestedActionsEnabled&&!e.isMobileDevice(),this.capabilities.universalMeControlPWAEnabled=this.capabilities.universalMeControlSafetyFlightEnabled&&this.capabilities.universalMeControlPWAEnabled,this.capabilities.mobileCustomSearchEnabled=e.isMobileDevice()&&!this.capabilities.nativeSearchInHeaderEnabled,this.capabilities.visualEnabled=!e.isMobileDevice()&&this.capabilities.visualEnabled,this.capabilities.contentActionsEnabled||(this.capabilities.addToDoEnabled=!1,this.capabilities.compliantShareApiEnabled=!1,this.capabilities.contextMenu20Enabled=!1,this.capabilities.convertToPdfEnabled=!1,this.capabilities.scheduleEnabled=!1,this.capabilities.shareTokenClaimsEnabled=!1,this.capabilities.shareToTeamsEnabled=!1,this.capabilities.createSharingLinkApiEnabled=!1,this.capabilities.contentActionsOHomeEnabled=!1),this.capabilities.m365AppsEnabled||(this.capabilities.m365TestAppEnabled=!1,this.capabilities.parkEnabled=!1,this.capabilities.spfxAppEnabled=!1,this.capabilities.storeAppEnabled=!1,this.capabilities.toDoM365AppEnabled=!1,this.capabilities.yammerM365AppEnabled=!1),Object(o.a)()&&(this.capabilities.clientTokenFetchEnabled=!0),this.capabilities.wacHostAppsArray&&(this.capabilities.wacHostApps=new Set(this.capabilities.wacHostAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)})))),this.capabilities.startPageAppsArray&&(this.capabilities.startPageApps=new Set(this.capabilities.startPageAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)})))),this.capabilities.modernStartAppsArray&&(this.capabilities.modernStartApps=new Set(this.capabilities.modernStartAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)}))),this.capabilities.modernStartApps.add(a.b.Visio)),this.capabilities.wacHostPrebootAppsArray&&(this.capabilities.wacHostPrebootApps=new Set(this.capabilities.wacHostPrebootAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)})))),this.capabilities.wacHostHoverPrebootAppsArray&&(this.capabilities.wacHostHoverPrebootApps=new Set(this.capabilities.wacHostHoverPrebootAppsArray.map((function(e){return a.a.fileTypeNameToFileType(e)})))),this.openWithUIHost=i.isStandalone.pipe(Object(r.a)((function(e){return c.capabilities.wacHostEnabled||c.capabilities.clientPwasEnabled&&e}))),this.openWithUIHosithUIHost=e})),void 0===this.capabilities.templatesEnabled){var u=l.nativeWindow.location.hostname;this.capabilities.templatesEnabled=u&&u.length>3&&u.lastIndexOf(".com")===u.length-4}this.capabilities.edgeworthEnabled=this.capabilities.edgeworthEnabled&&"Proxy"in l.nativeWindow&&(!this.capabilities.isPwaInUwp||this.capabilities.isPwaInWebView2)}return e.prototype.wacHostHoverPrebootEnabledForFileType=function(e){var t=this.capabilities.wacHostHoverPrebootApps;return!!t&&t.has(e)},e.prototype.wacHostEnabledForFileType=function(e){var t=this.capabilities.wacHostApps;return this.wacHostEnabled()&&!!t&&t.has(e)},e.prototype.wacHostEnabled=function(){return this.shouldOpenWithUIHost},e.prototypeofficehome"},e.prototype.updateWithOverrides=function(){var e,t,n=new Set(["featureFlagsEnabled","disableAnimation","createDocumentSupported"]),r=this.featureManagerService.registerFlagsAndGetConfig(p.parseBooleanFlagsAndFilter(this.capabilities,n)),o=Object.keys(r);try{for(var a=Object(i.__values)(o),l=a.next();!l.done;l=a.next()){var s=l.value;this.capabilities[s]=r[s]}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}},e.ɵprov=d.kc({factory:function(){return new e(d.lc(s.c),d.lc(l.a),d.lc(p),d.lc(f.a),d.lc(h.b))},token:e,providedIn:"root"}),e}()},"4CZh":function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return g}));var i=n("tjsK"),r=n("8/lW"),o=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","g"),a=new RegExp("file(:|%3A|%253A).*","gi");function l(e){return e?e.replace(o,"email_removed").replace(a,"file_removed"):e}var s,c=[],u=[],d=!1,p=r.a.Full;function f(e,t,n,i,r,o){void 0===i&&(i={}),void 0===r&&(r=[]),void 0===o&&(o=!1),i.EventName=e,s&&s(i,t);var a={params:i,metrics:r,record:function(){return function(e,t,n,i){var r=n&&(n.EventName&&n.EventName.indexOf("Error")>-1||n.Error&&"OK"!==n.Error);if(!(p<t||d&&!r)){!function(e,t){Object.keys(e).forEach((function(nyThreshold")})(i)&&(e[n]=t>=i.securityThreshold?i.defaultValue:i.fallbackValue)}))}(n,p);var o=n&&n.Error;o&&"string"==typeof o&&(n.Error=l(o));var a=n&&n.DebugInfo;a&&"string"==typeof a&&(n.DebugInfo=l(a)),u.lengthEvent(e,n,i)})):function(e){c.push(e)}({streamName:e,eventName:n.EventName,eventParams:n,metrics:i,securityThreshold:t})}}(t,n,i,r)}};return o&&a.record(),a}(0,c.length)})().forEach((function(e){f(e.eventName,e.streamName,e.securityThreshold,e.eventParams||{},e.metrics,!0)}))}function m(e,t,n,r){if(void 0===r&&(r=!1),u.length>0)throw new i.a("initializeInstrumentationService is not allowed to be called more than once");if(!e||0===e.length)throw new i.a("Must specify at least one event factory when calling initializeInstrumentation");u=e.slice(),s=t,"number"==typeof n&&(p=n),d=r,h()}function b(){h(),u.forEach((function(e)g(){return p}},"4ach":function(e,t,n){"use strict";var i,r;n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(ups="groups"}(i||(i={})),function(e){e[e.Good=0]="Good",e[e.Normal=1]="Normal",e[e.Suspicious=2]="Suspicious",e[e.Bad=3]="Bad",e[e.Evil=4]="Evil"}(r||(r={}));var o=function(){function e(){}return e.getOwnerPrincipalTypeToFormType=function(e){return"user"===e.toLowerCase()?i.Users:"group"===e.toLowerCase()?i.Groups:void 0},e.getExtensionToFormType=function(e){return"form"===e.toLowerCase()?i.Users:"groupform"===e.toLowerCase()?i.Groups:void 0},e}()},"4d0o":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe")rageConfig")}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},"511z":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").u)("SERVICE_WORKER_API_AVAILABLE")},"55A9":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("AlWG"),r=n("keVe"),o=function(){function e(){this.sidePopupMenuEmitter=new i.a(null)}return e.ɵprov=r.kc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"5FMq":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("2dXW"),r=n("zvoD"),o=n("f0qX"),a=n("keVextMenu=new i.a}return e.prototype.showMenu=function(e){this.updateNext(e,0)},e.protpdateNext(e,1)},e.prototype.subscribeToOpenEvents=function(e){return this.contextMenu.asObservable().pipe(Object(r.a)((function(e){return e&&0===e.type}ocusFirstItem}}))).subscribe(e)},e.prototype.subscribeToCloseEvents=function(e){return this.contextMenu.asObservable().pi e&&1===e.type}on:e.position}}))).subscribe(e)},e.prototype.updateNext=function(e,t){e&&e.menu&&e.position&&this.contextMenu.next({type:t,menu:e.menu,position:e.position,focusFirstItem:e.focusFirstItem})},e.ɵprov=a.kc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"5MEU":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").u)("WorkloadQueryParameter")},"5ZNw":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p){void 0===o&&(o=!1),this.announcementType=e,this.title=t,this.subTitle=n,this.iconClass=i,this.dismissCookieName=r,this.alignBottom=o,this.cssClass=a,this.fontCssClass=l,this.dismissObservable=s,this.dismissible=c,this.titleRedirectionSuggestion=u,this.dismissTimeoutInSecond=d,this.titleUseSubtitleStyle=p,this.importance=1,this.index=0}return e.p.title.length>0},e}()},"5aVq":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("QjXU"),r=n("zvoD"),o=n("3Vsh"),a=n("7Gwk"),l=n("BMb5"),s=n("keVe"),c=function(){function e(e,t){this.windowService=e,this.eventService=t,this.afterShellRendered=this.onEventFired("shellRendered"),this.afterShellPlusLoaded=this.onEventFired("shellPlusLoaded")}return e.prototype.getShellShim=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.afterShellRendered];case 1:return e.sent(),[2,this.windowService.nativeWindow.O365Shell]}}))}))},e.prototype.onEventFired=function(e){return this.eventService.events.withScope(0).pipe(Object(r.a)((function(t){return t.name===e})),Object(o.a)(1)).toPromise()},e.ɵprov=s.kc({factory:function(){return new e(s.lc(l.b),s.lc(a.a))},token:e,providedIn:"root"}),e}()},"6GOa":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("swayConfig")||{analyticsBatchSize:1,apiUrl:null,myEndpoint:null,thumbnailsEnabled:!1,uploadMaxFileSize:0,uploadSupportedExtensions:[]}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},"6Po3":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("ke=e,this.inRAF=!1}return e.prototype.runAfterPaint=function(e,t){var n=this;return void 0===t&&(t=!0),t?this.afterPaint(e):this.ngZone.runOutsideAngular((function(){return n.afterPaint(e)}))},e.prototype.runBeforeLayout=function(e,t){var n=this;return void 0===t&&(t=!0),t?this.beforeLayout(e):this.ngZone.n.beforeLayout(e)}))},AnimationFrame(e)},e.prototype.afterPaint=function(e){return ){setTimeout(e,0)}))},e.prototype.beforeLayout=function(e){var t=this;if(!this.inRAF)return requestAnimationFrame((function(){t.inRAF=!0,e(),Promition(){t.inRAF=!1}))}));e()},e.ɵprov=i.kc({factory:function(){return new e(i.lc(i.F))},token:e,providedIn:"root"}),e}()},"6cfW":function(e,t,n){"use strict";function i(e){return e instanceof Error&&e.message&&"the operation is insecure."===e.message.toLowerCase()}n.d(t,"a",(function(){return i}))},"6ib3":function(e,t,n){"use strict";var i;n.d(t,"a",(fun,e.Yammer="Yammer"}(i||(i={}))},"6nG3":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return i})),n.d(t,"a",(fund=9]="NotDetected"}(i||(i={}));var r=function(){return function(){}}()},"6u39":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("AlWG"),r=n("dFxn"),o=n("keVe"),a=function(){function e(e){this.config=e.parse("pwaConfig")||{bridgeTimeoutInSeconds:0,diagnosticsTimeoutInSeconds:30,enablePwaIdleCallback:!1,installedAppsToLookFor:null,officeUriProtocolEnabled:!1,oobToWeb:!1,pwaJumpListEnabled:!1,PwaStartPageEnabled:!1,resourceUrlMap:null,rfmToWeb:!1,shellAndConfigApiEndpoint:null},this.config.mock&&(window.appsLaunched=new Array,this.config.mock.appsLaunched=window.appsLaunched)}return e.ɵprov=o.kc({factory:function(){return new e(o.lc(r.a))},token:e,providedIn:"root"}),e}(),l=n("hhzZ"),s=n("7Gwk"),c=n("uUrA"),u=n("k+kJ"),d=n("vHlr"),p=function(){function e(e,t,n,r){this.eventService=e,this.pwaConfigService=t,this.uploadButtonService=n,this.instrumentationService=r,this._modalInfo=new i.a(null),this.updateNextSessionId()}return efileName:t,type:n})},Object.defineProperty(e.prototype,"modalInfo",{get:function(){return this._modalInfo.asObservable()},enumerable:!0,configurable:!0}),e.prototype.uploadFile=function(e,t){this.currentUploadSessionId=this.nextUploadSessionId,this.updateNextSessionId(),this.uploadButtonService.uploadFile(e,null,this.currentUploadSessionId,t,u.d.Button)},e.prototype.getLocalFileInfo=function(e,t){var n=this;return new Promise((function(i){n.pwaConfigService.config.mock?i(new File([],t)):Windows.Storage.StorageFile.getFileFromPathAsync(e).then((function(e){if(!e)throw new Error("Null file returned for path");return Windows.Storage.FileIO.readBufferAsync(e).then((fun to create buffer")}))}),(function(){throw n.eventService.broadcastEvent({name:"needAccessToFileSystem",args:["allow-file-system-access-upload"]}),new Error("Unable to access local file")})).then((function(e){if(!e)throw new Error("Null buffer");try{for(var n=Windows.Storage.Streams.DataReader.fromBuffer(e),r=n.unconsumedBufferLength,o=new Uint8Array(r),a=0;a<r;a++)o[a]=n.readByte();var l=new Blob([o]);l.lastModifiedDate=new Date,l.name=t,i(l)}catch(e){throw new Error("Error reading from buffer")}})).then(null,(function(e){var t={};t.Error=e?e.message:"",t.ItemCategory=u.d[u.d.Button],n.instrumentationService.logGenericEvent("Upload_Local_Error",t,[],2)}))}))},e.prototypeId=c.a.createGuid()},e.ɵprov=o.kc({factory:function(){return new e(o.lc(s.a),o.lc(a),o.lc(d.a),o.lc(l.a))},token:e,providedIn:"root"}),e}()},"6wOV":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("AY/E");var i=function(){function e(e,t){this.elementRef=e,this.peopleCardService=t}return e.prototype.ngOnInit=function(){this.upn&&(this.renderPromise=this.peopleCardService.addPersonaCard(this.elementRef.nativeElement,this.upn))},e.prototype.ngOnDestroy=function(){var e=this;this.renderPromise&&thinativeElement,e.upn)}))},e}()},"7Gwk":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("zvoD"),r=n("3Vsh"),o=n("MFXD"),a=n("BMb5"),l=n("keVe"),s=function(){function e(e){this.windowService=e,this._events=new o.a,this.mutateGlobalWindowState()}return e.prototype.broadcastEvent=function(e){this._events.next(e)},Object.defineProperty(e.prototype,"events",{get:function(){return this._events.asScopableObservable()},enumerable:!0,configurable:!0}),e.prototype.whenEventFired=function(e,t){return this.events.withScope(t).pipe(Object(i.a)((function(t){return t.name===e})),Object(r.a)(1)).toPromise()},e.prototype.mutateGlobalWindowState=function(){this.windowService.nativeWindow.ng2EventService=this},e.ɵprov=l.kc({factory:function(){return new e(l.lc(a.b))},token:e,providedIn:"root"}),e}()},"7IJ8":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("keVe"),o=n("CMIS"),a=(n("hhzZ"),n("6Po3"),n("WLAd"),n("casz"),n("cgnd"),n("QhWD"),n("RsrG"),function(){function e(e,t,n,i,o,a,l,s,c){this.lazyViewLoaderService=e,this.viewRef=t,this.instrumentationService=n,this.clientStartupConfigService=i,this.scheduler=o,this.modulePriorityService=a,this.browserPaintService=l,this.ngZone=s,this.pageVisibilityService=c,this.componentLoaded=new r.q,this.outputsSubscriptionMap=new Map}return e.prototype.ngOnInit=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!this.ngModulePath)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.loadComponent()];case 2:return i.sent(),[3,4];case 3:return e=i.sent(),t="Error message: "+((null==e?void 0:e.message)||"not available"),n="Call stack: "+((null==e?void 0:e.stack)||"not available"),Object(o.a)({eventName:"ChunkLoadError",debugInfo:n,message:t}),this.instrumentationService.logDebugCacheEvent("Chunk_Load_Error",((r={}).Error=t,r.DebugInfo=n,r)),[3,4];case 4:return[2]}}))}))},e.prototype.ngDoCheck=function(){this.setInputsOutputs()},e.prototype.ngOnDestroy=function(){this.creationHandle&&this.browserPaintService.cancel(this.creationHandle),this.outputsSubscriptionMap.forEach((function(e){return e.unsubscribe()})),this.viewRef.clear()},e.prototype.setInputsOutputs=function(){if(this.lazyComponentRef){for(var e in this.inputs)this.lazyComponentRef.instance[e]=this.inputs[e];for(var t in this.outputs)if(!this.outputsSubscriptionMap.has(t)){var n=this.lazyComponentRef.instance[t];if(n&&n instanceof r.q){var i=n.subscribe(this.outputs[t]);this.outputsSubscriptionMap.set(t,i)}}}},e.prototype.loadComponent=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.lazyViewLoaderService.loadLazyViewFromModule(this.ngModulePath)];caset(r.lazyComponentRef)},"idle-callback"===this.clientStartupConfigService.config.chunkLoadStrategy&&this.pageVisibilityService.isVisible()?(n=this.modulePriorityService.getSchedulePriority(this.ngModulePath),this.scheduler.scheduleWork((function(){r.ngZone.run((function(){r.creationHandle=r.browserPaintService.runBeforeLayout((function(){r.creationHandle=null,t(),r.setInputsOutputs()}))}))}),n)):t(),[2]}}))}))},e}())},"7J/E":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("QjXU"),r=n("A/um"),o=n("BaAg"),a=n("4ach"),l=n("JT1q"),s=n("fKR7"),c=(n("EYcb"),n("7Gwk"),n("TDzr"),n("55A9"),n("cgnd"),n("/I02"),n("PBJH"),ntartupConfigService=a}return e.proteChange",args:[e,t]})},e.prototype.generateAdditionalActionsMenuItems=function(e,t,n){var i=this,l=[],c=t.format,u=t.isDeleted,d=t.isLocal;switch(t.fileType){case o.b.Forms:case o.b.FormsQuiz:var p=t.getFormEnumType();c===s.a.SharedForm&&l.push({id:"formsSharedUnpin",title:this.locService.RemoveFromSharedWithMe,ariaLabel:this.locService.RemoveFromSharedWithMe,icon:r.a.Unpin,executeAction:function(){return Promise.resolve([{key:"delete",props:{index:e,item:t,deleteOption:5}}])},disabled:d}),c!==s.a.Form||u||t.ownerType===a.a.Groups||"poll"===p||"assignments"===p||n||l.push(this.generateFormsMoveAction(t,e)),c!==s.a.Form&&c!==s.a.SharedForm||u||"poll"===p||"assignments"===p||l.push(this.generateFormsCopyAction(t,n)),c===s.a.Form&&u&&!d&&l.push({id:"restore",title:this.locService.RestoreActionMenuLabel,ariaLabel:this.locService.RestoreActionMenuLabel,icon:r.a.Restore,executeAction:function(){return i.sendMruItemState(0,t),i.attachFormsErrorHandler(i.formsService.setFormsRecycleState(t.docId,t.ownerId,t.ownerType,!1).then((function(){return i.formsService.pushFormsAnnouncements("FormsRestored",t.fileName)})).then((function(){return[{key:"delete",props:{index:e,item:t,deleteOption:4}}]})).finally((function(){i.sendMruItemState(1,t)})))},disabled:!1}),c!==s.a.Form||d||l.push({id:"delete",title:this.locService.DeleteActionMenuLabel,ariaLabel:this.locService.DeleteActionMenuLabel,icon:r.a.Delete,executeAction:function(){var n;return i.sendMruItemState(0,t),n=u?i.formsService.hardDeleteForm(t.docId,t.owneyDeleted",t.fileName)})):i.formsService.setFormsRecycleState(t.docId,t.ownerId,t.ownerType,!0).then((function(){return i.formsService.pushFormsAnnouncements("FormsMoveToRecycleBin")})),i.attachFormsErrorHandler(n.then((function(){return[{key:"delete",props:{index:e,item:t,deleteOption:u?2:1}}]})).finally((function(){i.sendMruItemState(1,t)})))},disabled:!1})}return l},e.prototype.updateActionItemsOnInflated=function(e,t,n){var i,r,l=[];switch(t.fileType){case o.b.Forms:case o.b.FormsQuiz:t.format===s.a.Recent&&"poll"!==t.getFormEnumType()&&"assignments"!==t.getFormEnumType()&&void 0!==(null===(i=t.metaData)||void 0===i?void 0:i.formsResponseCount)&&null!==(null===(r=t.metaData)||void 0===r?void 0:r.formsResponseCount)&&(t.ownerType===a.a.Groups||n||l.push({start:1,deleteCount:0,item:this.generateFormsMoveAction(t,e)}),l.push({start:1,deleteCount:0,item:this.generateFormsCopyAction(t,n)}))}return l},e.prototype.generateFormsCopyAction=function(e,t){var n=this;return{id:"copy",title:this.locService.CopyActionMenuLabel,ariaLabel:this.locService.CopyActionMenuLabel,icon:r.a.Copy,executeAction:function(){var i;n.sendMruItemState(0,e);var r=e.ownerType;return e.ownerType===a.a.Users?i=t?e.ownerId:n.clientStartupConfigService.config.objectId:e.ownerType===a.a.Groups&&(i=e.ownerId),n.attachFormsErrorHandler(n.formsService.postCopyForm(e.docId,e.title,e.ownerTenantId,e.ownerId,i,e.ownerType,r).then((function(t){return n.formsService.setFormsCopySuccessAnnouncement(t.title,r,e.format!==s.a.Form,i,e.createdBy),[{key:"add",props:{addOption:1,addedItem:Object(l.b)(t,o.a.fileTypeNameFromType(o.b.Forms)+"_item_"+t.id,o.a.fileTypeNameFromType(o.b.Forms)+"Impression",n.contextService.isRtl,n.clientStartupConfigService.config.authType,!1,null,e.ownerType)}}]})).finally((function(){n.sendMruItemState(1,e)})))},disabled:e.isLocal}},e.prototype.generateFormsMoveAction=function(e,t){var n=this;return{id:"move",title:this.locService.MoveActionMenuLabel,ariaLabel:this.locService.MoveActionMenuLabel,icon:r.a.Move,executeAction:function(){var r=Object(i.__read)(Object(c.a)(),2),o=r[0];return n.sidePopupMenuService.sidePopupMenuEmitter.next({isShown:!0,type:0,movingFileItem:e,index:t,resolveMoveModel:r[1]}),o.then((function(i){var r=e;n.sendMruItemState(0,r);var o=i.moveTargetId,l=i.moveTargetName;return n.attachFormsErrorHandler(n.formsService.postMoveForms(r.docId,r.ownerType,r.ownerId,a.a.Groups,o).then((function(i){return n.formsService.setFormsMoveToGroupSuccessAnnouncement(r.fileName,o,l),e.createdBy=l,e.ownerType=a.a.Groups,e.ownerId=o,e.docId=i.id,[{key:"delete",props:{index:t,item:e,deleteOption:3}},{key:"disableAction",props:{idsendMruItemState(1,r)})))}))},disabled:e.isLocal}},e.prototype.attachFormsErrorHandler=function(e){var t=this;return e.catch((function(e){var n,i,r,o;switch(null===(r=null===(i=null===(n=e.httpResponse)||void 0===n?void 0:n.data)||void 0===i?void 0:i.error)||void 0===r?void 0:r.code){case"6102":o="AutoBlockedForm";break;case"6100":o="TakenDownForm";break;default:o="Generic"}throw t.errorDialog.showErrorDialog({category:"ActionMenu",error:o}),e}))},e}()},"7Rc8":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return _}));var i,r=n("lrJm"),o=n("hhzZ"),a=n("R7NL"),l=n("BaAg"),s=n("kpuN"),c=n("W3Zz"),u=n("Z0U4"),d=n("wwmn"),p=n("Uqr9"),f=n("casz"),h=n("ZtId"),m=n("BJbw"),b=n("BMb5"),g=n("4/We"),v=n("cgnd"),S=n("/I02"),y=n("JH4S"),C=n("QOOv"),w=n("RR/o"),T=n("keVe"),k=n("TOqr"),I=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g){var v=this;this.mruService=new w.b(e,n,t,i,r,o,a,l,s,c,u,p,f,h,m,b,g),m.capabilities.edgeworthEnabled||d.subscrCache(e.currentRoute)}))}return e.prototype.getMruService=function(){return this.mruService},e.prototype.warmDocumentCache=function(e){switch(e.route){case"OfficeHome":case"Pwa":this.mruService.getMruDocuments();break;case"Start":e.app!==l.b.SharePoint&&e.app!==l.b.OneDrive&&this.mruService.getMruDocuments(new Set([e.app]))}},e.ɵprov=T.kc({factory:function(){return new e(T.lc(s.b),T.lc(a.a),T.lc(o.a),T.lc(S.a),T.lc(d.a),T.lc(y.a),T.lc(C.a),T.lc(k.q),T.lc(r.b),T.lc(v.b),T.lc(p.b),T.lc(u.a),T.lc(h.a),T.lc(f.a),T.lc(b.b),T.lc(g.a),T.lc(m.a),T.lc(c.c))},token:e,providedIn:"root"}),e}();!function(e){e[e.Unknown=0]="Unknown",e[e.SkyDrive=1]="SkyDrive",e[e.SkyDrivePro=2]="SkyDrivePro",e[e.SharePointOnline=3]="SharePointOnline"}(i||(i={}));var _=function(){function e(){}return e.ɵprov=T.kc({factory:function(){return function(e){return e.getMruService()}(T.lc(I))},token:e,providedIn:"root"}),e}()},"7ma0":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("keVe"),r=n("4/We"),o=new i.u("AAD_APP_ID",{providedIn:"root",factory:function(){return Object(i.db)(r.a).capabilities.pwaEnabled?"0ec893e0-5785-4de6-99da-4ed124e5296c":"4345a7b9-9a63-4910-a426-35363201d503"}})},"7wk3":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("TOqr"),r=n("BaAg"),o=n("6Po3"),a=n("Z0U4"),l=n("WLAd"),s=n("Uqr9"),c=n("keVe"),u=function(){function e(e,t,n,i,r){var o=this;this.performanceService=e,this.platformId=t,this.pageVisibilityService=n,this.browserPaintService=i,this.queuedEvents=new Set,this.markedEvents=new Set,this.setupOnHiddenListener(),r.subsentRoute=e.currentRoute}))}return e.prototype.recordWhenPainted=function(e){var t=this,n=e+(this.currentRoute&&this.currentRoute.route?"_"+this.currentRoute.route+(this.currentRoute.app?r.b[this.currentRoute.app]:""):"");Object(i.t)(this.platformId)&&!this.markedEvents.has(n)&&this.pageVisibilityService.isVisible()&&(this.queuedEvents.add(e),this.markedEvents.add(n),this.paintListenerHandle||(this.paintListenerHandle=this.browserPaintService.runAfterPaint((function(){t.pageVisibilityService.isVisible()&ervice.mark("Paint_"+e)})),t.resetListener()}),!1)))},e.prototype.setupOnHiddenListener=function(){var e=this;this.pageVisibilityServicee.cancelPaintListener()}))},e.protoe),this.resetListener()},eaintListenerHandle=null},e.ɵprov=c.kc({factory:function(){return new e(c.lc(s.b),c.lc(c.I),c.lc(l.a),c.lc(o.a),c.lc(a.a))},token:e,providell=3]="Full"}(i||(i={}))},"81FX":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.Slow2g="Slow2g",e.Standard2g="Standard2g",e.Standard3g="Standard3g",e.Standard4g="Standard4g",e.Unknown="Unknown"}(i||(i={}))},"8wW2":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i,r=n("cenr"),o=n("V9hE"),a=n("a3FV"),l=n("CMIS"),s="UnknownError";function c(){if(!i){var e=new Map,t=function(t,n){var i="",c="";t=t||new Error(s);var u=!1;try{var d=t.filename;d?(d=d.replace(/^.*[\\\/]/,""),i="Error location: ".concat(d,", line: ").concat(t.lineno,", col: ").concat(t.colno)):t.id?i="Error id: ".concat(t.id):(i="Error location: unknown",u=!0);var p=t.error||t;p.originalError?(i+="\nHandled error is a wrapper with message: ".concat(p.message),c="Wrapper call stack: ".concat(p.stack||"Call stack trace is not available"),c+="\nOriginal call stack: ".concat((p=p.originalError).stack||"Call stack trace is not available")):c="Call stack: ".concat(p.stack||"Call stack trace is not available"),p.message&&(i+="\nError message: ".concat(p.message))}catch(e){i="Error caught inside error logger: ".concat(e&&e.message||s),c="Call stack: ".concat(e&&e.stack||"Call stack trace is not available"),n="React",console.log(e)}finally{(function(t,n,i,s){var c;void 0===s&&(s=!1);try{var u=function(t){return 1+(e.get(t)||0)}(t);if(e.set(t,u),function(e){var t=e.toString().length,n=Math.pow(10,t-1);return n<2||e%n==0}(u)){var d=((c={}).Error=t,c.DebugInfo={value:n,kind:2},c.ItemCategory=i,c.ItemCount=u.toString(),c);Object(r.a)(a.a.UnhandledException,d),s&&(d.DebugInfo=n,Object(o.a)(a.a.UnhandledException,d)),Object(l.a)({eventName:"Unhandled_Exception",errorType:"Unhandled_Exception",errorCategory:i,occurrenceCount:u,message:t,debugInfo:n})}}catch(e){console.log(e)}})(i,c,n,u),console.log(t)}},n=function(e,n){(function(e){if(e&&e.stack&&!e.promise)return!1;if(e&&e.promise&&e.rejection){var t=e.rejection;if(t.stack&&"Error"!==t.name)return!1}return!0})(e)||(function(e,t){e&&"object"==typeof e&&t&&(e.id=t)}(e,n),t(e,"React"))};!function(){var e=window.onerror;window.onerror=function(i,r,o,a,l){var c=null;if("object"==typeof i&&i.type&&"error"===i.type.toLowerCase()?c=i:l?((c=l).message=l.message||i,Object.assign&&Object.assign(c,{filename:r,lineno:o,colno:a})):"string"==typeof i?(c=new Error(i||s),Object.assign&&Object.assign(c,{filename:r,lineno:o,colno:a})):(c=new Error(s),Object.assign&&Object.assign(c,{filename:r,lineno:o,colno:a})),t(c,"Global"),e)try{e.apply(window,[i,r,o,a,l])}catch(e){n(e)}}}(),i={handleError:n,handleCacheObservableError:function(e,t,i){e&&(e.networkError&&n(e.networkError,i),e.cacheError&&n(e.cacheError,t))}}}return i}},9260:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("QjXU"),r=(n("lrJm"),n("hhzZ"),n("R7NL"),n("BaAg")),o=(n("QOOv"),n("RR/o")),a=(n("7ma0"),n("kpuN"),n("wwmn"),n("casz"),n("ZtId"),n("BMb5"),n("pOWU")),l=(n("4/We"),n("cgnd"),n("/I02"),n("uUrA")),s=n("oAX+"),c=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,f,h){var m=e.call(this,t,r,o,"Substrate",i,l,s,p)||this;m.capabilitiesService=n,m.mruConfigService=a,m.globalErrorHandler=c,m.startupConfigService=u,m.updateContentService=d,m.windowService=f,m.aadAppId=h,m.fetchRequestIndex=0;var b=m.mruConfigService.config;return m.allApps=["Word","Excel","PowerPoint","OneNote","Video","PlayList"],b.recommendedPdfEnabled&&m.allApps.push("Pdf"),b.recommendedVisioEnabled&&m.allApps.push("Visio"),b.recommendedFluidEnabled&&m.allApps.push("Fluid","Bohemia","Loop"),m.sources=["EmailAttachment","OneDrive","Sharepoint"],m.capabilitiesService.capabilities.isPwaInUwp&&m.sources.push("LocalFile"),m.baseUrl=(m.inMockMode?m.contextService.sharedContext.officeHomeApiRoot:b.substrateApiEndpoint)+(b.useThreeSRecommendationsApi?"/"+b.threeSRecommendationsRootPath+"/":"/"+b.recommendedB2ApiRootPath+"/"),m.recommendedDataStreams=new Map,m}return Object(i.__extends)(t,e),t.prototype.getRecommendedDocs=function(e){var t=this,n=this.getUrl(e);if(this.recommendedDataStreams.has(n))return this.recommendedDataStreams.get(n);var i=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchRecommendedDocs(n):this.fetchRecommendedDocs("network-first",n,e),r=this.updateContentService.getOrAddUpdateStream(thocs("network-first",n,e)})),o=s.a.createResultsWithCacheObservable(this.fetchRecommendedDocs("cache-only",n,e),i,r,(function(e){return t.recommendedDataStreams.delete(n)}));return this.recommendedDataStreams.set(n,o),o},t.prototype.updateRecommendedDocs=function(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))},t.prototype.removeDocument=function(e,t){var n=this,i=l.a.createGuid(),r=this.createRequestConfig(i);return new Promise((function(i,o){n.post("Recommended_Delete_Request","Recommended_Delete",n.baseUrl+(n.mruConfigService.config.useThreeSRecommendationsApi?n.mruConfigService.config.threeSRecommendedDocumentsDismissPath:n.mruConfigService.config.recommendedApiDismissedDocumentsPath),{id:e,until:t},(function(e){e.then((function(){return i(null)}))}),o,r)}))},t.prototype.fetchRecommendedDocs=function(e,n,i){var r=this;return new Promise((function(o,a){var s=l.a.createGuid(),c=r.createRequestConfig(s);r.get("Recommended_Request","Recommended",n,(function(n){n.instrument((function(e,n){if(n.RequestId=r.getRequestIdFromResponse(e),n.DebugInfo=r.getServerDebugInfo(e),n.Index=(r.fetchRequestIndex++).toString(),n.ImpressionId=!!e.headers&&e.headers.get(t.clientRequestIdHeader)||s,n.DocumentType=i?r.getTypesParam(i):"All",e.ok&&e.data){var o=0;e.data.documents_group&&e.data.documents_group.documents&&(o=e.data.documents_group.documents.length,n.ResourceIdDistribution=e.data.documents_group.documents.map((function(e){return e.resource_id})).toString()),n.ActualSize=o.toString()}})).then((function(n){return r.processLocalRecommendedData(n.data).then((function(i){o({items:i||[],impressionId:!!n.headers&&n.headers.get(t.clientRequestIdHeader)||s,fromCache:"cache-only"===e})}))})).catch((function(e){r.globalErrorHandler.handleError(e,"QG6EV")}))}),a,c,e)}))},t.prototype.prefetchRecommendedDocs=function(e){var t=this;return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then((function(e){return e?t.processLocalRecommendedData(e).then((function(t){return{items:t,impressionId:e.recommendedRequestId||"",fromCache:!1}})):Promise.reject("Prefetch failed")})):this.fetchRecommendedDocs("network-first",e)},t.prototype.handleQueryParam=function(e,t,n){"mockrecommended"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.fileType=function(e){var n=r.a.fileTypeFromExtension(e.extension);return n&&n!==r.b.None||(n=t.fileTypeFromAppName(e.app)||r.b.Unknown)peNameToFileType(e):null},t.prototype.createRequestConfig=function(e){var n=this.startupConfigService.config,i=new Map([["X-AnchorMailbox",n.objectId+"@"+n.tenantId],["X-Office-Application",this.contextService.sharedContext.recommendedIceApplicationId.toString()],["X-Office-Scenario",this.contextService.getCurrentPageForLogging()],["X-RoutingParameter-SessionKey",n.objectId],["X-Ms-ClientAppId",this.aadAppId],[t.clientRequestIdHeader,e]]);return this.capabilitiesService.capabilities.threeSRdlFlightHeader&&i.set("X-Client-Flights",this.capabilitiesService.capabilities.threeSRdlFlightHeader),{headers:i}},t.prototype.getUrl=function(e){var n=this.getTypesParam(e),i=this.sources.join(",");return this.baseUrl+(this.mruConfigService.config.useThreeSRecommendationsApi?this.mruConfigService.config.threeSRecommendedDocumentsPath:this.mruConfigService.config.recommendedB2ApiFilesPath)+"?"+t.countParam+this.mruConfigService.config.numRecommendedToRequest+"&"+t.skipCacheParam+"&"+t.appsParam+n+"&"+t.locParam+this.contextService.sharedContext.officeMarket+"&"+t.sourcesParam+i},t.prototype.getTypesParam=function(e){return(e&&e.size?this.allApps.filter((function(t){return e.has(r.a.fileTypeNameToFileType(t))})):this.allApps).join(",")},t.prototype.getUpdateStreamKey=function(e){return"recommended-"+e},t.prototype.convertToMruDataItem=function(e,n){var i;void 0===n&&(n=!1);var a=e.activity_info?e.activity_info.badge:void 0,l=a&&a.timestamp?new Date(a.timestamp):null,s="PlayList"===e.app,c="EmailAttachment"===e.service_info.service_id||"FP_EXCHANGE_ORGID"===e.service_info.service_id,u=null;c&&(u={AttachmentType:1,ConversationId:"",Subject:a&&a.conversation_info?a.conversation_info.subject:""});var d=void 0;return this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&a&&a.sharing_action&&1===a.sharing_action.medium&&(d=a.sharing_action.web_url),{Application:e.app,Category:"Document",DocId:e.onedrive_info&&e.onedrive_info.item_id,DriveId:e.onedrive_info&&e.onedrive_info.drive_id,Extension:e.extension||r.a.getFileExtensionFromUrl(e.url),FileName:e.title,Title:e.title,Url:c||s||n?e.web_url:e.url,WebUrl:e.web_url,LastAccessedTime:l,FileType:r.b[t.fileType(e)],PathArray:null,Provenance:r.f[r.f.Substrate],ResourceId:e.resource_id,UrlAlreadyEncoded:!0,Activity:e.activity_info?o.b.convertMruActivityToActivityDescription(e.activity_info):void 0,IsCollab:!!e.activity_info&&e.activity_info.is_collab,IsEmailAttachment:c,IsLocal:n,OneDriveInfo:e.onedrive_info,SharepointInfo:e.sharepoint_info,SPOId:e.id,EmailReference:u,NavigationId:e.activity_info&&e.activity_info.badge&&e.activity_info.badge.navigation_info?e.activity_info.badge.navigation_info.id:null,TeamsDeepLink:d,IconUrl:null===(i=e.app_info)||void 0===i?void 0:i.icon_url}},t.prototype.processLocalRecommendedData=function(e){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(i.__generator)(this,(function(i){return n=(null===(t=null==e?void 0:e.documents_group)||void 0===t?void 0:t.documents)||[],[2,Promise.all(n.map((function(e){return r.checkLocalFileAndProcess(e)}))).then((function(e){return e.filter((function(e){return null!==e&&e.Activity&&e.Activity.formatString}))}))]}))}))},t.prototype.getServerDebugInfo=function(e){if(!e||!e.headers)return"";var t=e.headers;return"BE: "+(t.get("X-CalculatedBETarget")||"")+". FE: "+(t.get("X-FEServer")||"")+"."},t.prototype.checkLocalFileAndProcess=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){return[2,new Promise((function(n){var i;if("LocalFile"!==(null===(i=e.service_info)||void 0===i?void 0:i.service_id))n(t.convertToMruDataItem(e));else if(t.capabilitiesService.capabilities.isPwaInUwp){var r=e.web_url;try{Windows.Storage.StorageFile.getFileFromPathAsync(r).then((function(i){n(i?t.convertToMl)}),(function(){n(null)}))}catch(e){n(null)}}else n(null)}))]}))}))},t.clientRequestIdHeader="client-request-id",t.countParam="show=",t.skipCacheParam="skipCache=false",t.appsParam="apps=",t.locParam="rs=",t.sourcesParam="sources=",t}(a.a)},"94Ef":function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return y}));var i=n("keVe"),r=n("pzhl"),o=n("PkQn"),a=n("4/We"),l=n("TOqr"),s=n("tuJr"),c=n("s+Eq"),u=n("5FMq"),d=n("M56G"),p=n("jrGV"),f=n("hZW2"),h=n("W3Zz"),m=n("hhzZ"),b=n("PBJH"),g=i.Fb({encapsulation:2,styles:[],data:{}});function v(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,6,"div",[["class","actions-menu-item__flex-content"],["role","menuitem"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,r.b,r.a)),i.Gb(2,638976,null,0,o.a,[a.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"]},null),(e()(),i.Hb(3,0,null,null,3,"div",[["class","list-item__title menu-item__title ms-fcl-bl"]],null,null,null,null,null)),i.Gb(4,278528,null,0,l.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(5,{"menu-item__title--disabled":0}),(e()(),i.gc(6,null,["",""]))],(function(e,t){e(t,2,0,t.context.item.iconColor,i.Ob(1,"actions-menu-item__icon ms-fcl-bl ",t.context.item.disabled?" menu-item__icon--disabled":"",""),t.context.item.iconCssClass,t.context.item.icon,"16");var n=e(t,5,0,t.context.item.disabled);e(t,4,0,"list-item__title menu-ite,0,t.context.item.title)}))}function S(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,8,"ohp-dropdown-menu",[],null,[[null,"toggleMenu"],[null,"selectIt==r.onFocusLink(n)&&i),i}),s.b,s.a)),i.Gb(1,4440064,[[1,4]],1,c.a,[i.h,u.a],{menuModel:[0,"menuModel"],mobileContextMenu:[1,"mobileContextMenu"],leftAlignedCard:[2,"leftAlignedCard"],hideContent:[3,"hideContent"]},{toggleMenu:"toggleMenu",selectItem:"selectItem",focusLink:"focusLink"}),i.cc(603979776,2,{menuItems:1}),(e()(),i.Hb(3,0,null,0,3,"div",[["ohpMenuLinkContent",""]],null,null,null,null,null)),i.Gb(4,16384,null,0,c.c,[],null,null),(e()(),i.Hb(5,0,null,null,1,"ohp-icon-font",[["iconFontName","Ellipsis"],["size","16"]],null,null,null,r.b,r.a)),i.Gb(6,638976,null,0,o.a,[a.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),i.qb(0,null,null,1,null,v)),i.Gb(8,16384,[[2,4]],0,c.b,[i.S],null,null)],(function(e,t){var n=t.component;e(t,1,0,n.dropdownMenuModel,n.mobileMenusEnabled,n.leftAlignedCard,n.actionContextMenuEnabled),e(t,6,0,(n.iconClass?n.iconClass+" ":"")+(n.fluentRefresh?"actions-menu__icon--fluent"+(n.isOpen?" ms-fcl-tp":""):"actions-menu__icon ms-fcl-ns ms-fcl-nd-h ms-fcl-nd-f"),"Ellipsis","16",!0)}),null)}function y(e){return i.jc(0,[i.cc(671088640,1,{dropdownMenu:0}),(e()(),i.qb(16777216,null,null,1,null,S)),i.Gb(2,16384,null,0,l.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,(null==n.dropdownMenuModel||null==n.dropdownMenuModel.items?null:n.dropdownMenuModel.items.length)||n.actionContextMenuEnabled)}),null)}i.Db("ohp-actions-menu",d.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-actions-menu",[],null,null,null,y,g)),i.Gb(1,770048,null,0,d.a,[p.a,a.a,f.a,i.o,h.c,m.a,b.a,i.K],null,null)],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",listItemIndex:"listItemIndex",iconClass:"iconClass",area:"area",dataSecurity:"dataSecurity",leftAlignedCard:"leftAlignedCard",documentName:"documentName",horizontalEllipsis:"horizontalEllipsis",actionContextMenuEnabled:"actionContextMenuEnabled",actionContextMenu:"actionContextMenu"},{menuToggled:"menuToggled",menuFocused:"menuFocused"},[])},"9InZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"9KSV":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),r=new RegExp("file(:|%3A|%253A).*","gim"),o=new RegExp("([&?]q=)(.+?)(?=[&].*| |, |$)","gmi");function a(e){return e?e.replace(/[\n\r\t\b]/gm,"").replace(i,"email_removed").replace(r,"file_removed").replace(o,"$1query_removed"):e}},"9MHL":function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var i=n("AlWG"),r=n("lrJm"),o=n("3GGT"),a=n("hhzZ"),l=n("BaAg"),s=n("p6Zr"),c=n("Dpxn"),u=n("TIi1"),d=n("BMb5"),p=n("4/We"),f=n("cgnd"),h=n("/I02"),m=n("PBJH"),b=function(){function e(){}return e.resolveGraphError=function(e,t){var n=e.httpResponse||e;if(n&&"number"==typeof n.status){var i=n.status,r=n.data;if(r&&r.error){for(var o=[],a=r.error;a;)o.push(a),a=a.innererror;for(a=o.pop();a;){var l=t(a.code);if(void 0!==l)return l;a=o.pop()}}return t(i)}},e}(),g=n("ZBli"),v=n("k+kJ"),S=n("JScD"),y=n("QjXU"),C=n("Uqr9"),w=function(){function e(e,t){this.totalBytes=t,this.startTime=C.a.now(),this.expirationTime=this.startTime+e,this.progressPoints=0}return e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this.getRateRatio(e);return void 0===t||t<=1},e.prototype.didActivityHaveExtraCapacity=function(){var e=C.a.now();return this.expirationTime-e>e-this.startTime},e.prototype.getRateRatio=function(e){this.progressPoints++;var t,n=C.a.now(),i=n-this.startTime,r=this.expirationTime-n;return this.progressPoints>=4&&i>=4e3&&r>0&&i>0&&(t=(this.totalBytes-e)/r/(e/i)),t},e}()is.uploadConfig=t.config}return e.prototype.advanceState=function(e,t,n){var i=this;return(t.sessionUrl?t.nextExpectedRanges?this.uploadItemState(e,t,n):this.getStatusState(e,t,n):this.createSessionState(e,t,n)).then((function(e){return e.error?i.handleGeneralErrorState(e,n):i.getState(e,{waitDuration:void 0,clientAttemptsRemaining:void 0,serverAttemptsRemaining:void 0})}))},e.prototype.createSessionState=function(e,t,n){var i=this;return this.oneDriveService.createUploadSession(e.file,e.sessessionUrl:e.uploadUrl})}),(function(e){return i.getState(t,{error:e})}))},e.prototype.getStatusState=function(e,t,n){var i=this;return this.oneDriveService.getUploadSessionStatus(t.sessios: i.getState(t,{error:e})}))},e.prototype.uploadItemState=function(e,t,n){var i=this,r=e.file.size,o=this.getNextRange(r,t.nextExpectedRanges);return(o&&o.start<r?this.uploadFragmentState(o,e,t,n):this.cancelSessionState(e,t,n)).then((function(e){return e.error?i.handleUploadItemErrorState(e,n):e}))},e.prototype.uploadFragmentState=function(e,t,n,i){var r=this,o=n.sessionUrl,a=n.speed,l=void 0===a?this.uploadConfig.initialSpeed:a,s=e.start,c=e.end;t.updateProgress(s);var u=this.getFragmentSize(l),d=Math.min(s+u,c),p=l>this.uploadConfig.minSpeed?this.uploadConfig.fragmentTimeoutInMs:this.uploadConfig.fragmentTimeoutInMs*this.uploadConfig.slowFragmentTimeoutMultiplier,f=new w(p,d-s),h=t.file,m=nl((function(){m.cancel()})),new Promise((function(e){r.oneDriveService.uploadFragment(o,s,d,h.size,h.slice(s,d),t.sessionId,(function(i){var o=s+i.loaded;l>r.uploadConfig.minSpeed&&!f.doesActivityHaveRemainingCapacity(o-s)&&(m.cancel(),e(r.getState(n,{speed:Math.max(l*r.uploadConfig.slowSpeedDowngradeRatio,r.uploadConfig.minSpeed),nextExpectedRanges:void 0}))),t.updateProgress(o)}),m,p).then((function(i){t.updateProgress(d),n=r.isDriveItem(i)?r.getState(n,{item:i}):r.getState(n,{nextExpectedRanges:i.nextExpectedRanges,speed:Math.min(f.didActivityHaveExtraCapacity()?l*r.uploadConfig.speedUpr.getState(n,{error:t}))}))}))},e.prototype.cancelSessionState=function(e,t,n){var i=this;return this.oneDriveService.cancelUploadSession(t.sessionUrl,e.sessionId,n).then((function(){return i.getState(t,{sessionUrl:void 0})}),(function(){return i.getState(t,{sessionUrl:void 0})}))},e.prototype.handleUploadItemErrorState=function(e,t){var n=this,i=e.speed,r=void 0===i?1:i;return e=this.getState(e,{nextExpectedRanges:void 0}),this.handleErrorState(e,(function(i){switch(i){case o.a.Offline:case o.a.Unknown:return n.windowService.nativeWindow.navigator.onLine?Promise.resolve(n.getState(e,{speed:Math.max(r*n.uploadConfig.speedDowngradeRatio,n.uploadConfig.minSpeed)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case o.a.NotFound:return Promise.resolve(n.getState(e,{error:void 0,sessionUrl:void 0}));case"invalidRange":case o.a.RangeNotSatisfiable:return n.wait(n.uploadConfig.standardWaitDurationInMs,t).then((function(){return n.getState(e,{error:void 0})}))}}))},e.prototype.handleGeneralErrorState=function(e,t){var n=this,i=e.waitDuration,r=void 0===i?this.uploadConfig.initialWaitDurationInMs:i,a=e.clientAttemptsRemaining,l=void 0===a?this.uploadConfig.numClientAttempts:a,s=e.serverAttemptsRemaining,c=void 0===s?this.uploadConfig.numServerAttempts:s;return this.handleErrorState(e,(function(i){switch(i){case"unauthenticated":case o.a.Unauthorized:case"lockMismatch":case o.a.Locked:case o.a.NotImplemented:case"quotaLimitReached":case o.a.InsufficientStorage:case o.a.Offline:return}if("number"==typeof i){if(i>=400&&i<500)return;if(0===i||i>=500&&i<600){if(!c)return;return n.wait(r,t,!0).then((function(){return n.getState(e,{error:void 0,waitDuration:Math.min(2*r,n.uploadConfig.maxWaitDurationInMs),serverAttemptsRemaining:Math.max(c-1,0)})}))}if(!l)return;return n.wait(n.uploadConfig.standardWaitDurationInMs,t).then((function(){return n.getState(e,{error:void 0,waitDuration:void 0,clientAttemptsRemaining:Math.max(l-1,0)})}))}}))},e.prototype.handleErrorState=function(e,t){var n=b.resolveGraphError(e.error,t);return void 0===n&&(n=Promise.resolve(e)ect(y.__assign)({},e),t)},e.prototype.getNextRange=function(e,t){return void 0===t&&(t=[]),t.reduce((function(t,n){var i=Object(y.__read)(n.split("-",2),2),r=i[1],o=parseInt(i[0],10);return!t||o<t.start&&o<e?{start:o,end:""===r?e:Math.min(parseInt(r,10)+1,e)}:t}),void 0)function(e){return!!e.id},e.prototype.getFragmentSize=function(e){var t=e*this.uploadConfig.maxFragmentSize;return Math.min(Math.max(t>this.uploadConfig.discreteChunkSize?t-t%this.uploadConfig.discreteChunkSize:t-t%this.uploadConfig.minFragmentSize,this.uploadConfig.minFragmentSize),this.uploadConfig.maxFragmentSize)},e.prototype.wait=function(e,t,n){var i,r=this;void 0===n&&(n=!1);var o,a=new Promise((function(t){i=setTimeout((function(){t()}),e)})),l=new Promise((function(e){r.windowService.nativeWindow.adine",o=function(){n&urn Promise.reject(null)})):new Promise((function(){}));return new Promise((function(e){Prs]).then((function(){e()}),(function(){})).then((function(){r.windowService.nativeWindow.removeEventListener("online",o),clearTimeout(i)}))}))},e}(),I=n("keVe"),_=function(){function e(e,t,n,i,r,o,a,l,s){this.contextService=e,this.locService=t,this.oneDriveService=n,this.uploadConfigService=i,this.urlLauncherService=r,this.windowService=o,this.capabilitiesService=a,this.globalErrorHandler=l,this.clientStartupConfigService=s,this.setupUploadPromise(),this.uploadConfigService.config&&(this.stateMachine=new k(this.oneDriveService,this.uploadConfigService,this.windowService))}return e.prototype.upload=function(e,t,n){var r=this,o=this.uploadConfigService.config;if(!o)return null;var a=new v.b(t,e,n),l=new i.a(a);return a.cancellationToken.onCancel((function(){a.sessionUrl&&!a.finished()&&r.oneDriveService.cancelUploadSession(a.sessionUrl,a.sessionId),a.state=v.c.Cancelled,l.next(a)})),a.markComplletedAndOpened,l.next(a)},this.isValidFileType(e)?this.startUpload(a,l):(a.error=this.suggestOneDriveErrorWithText(o.oneDriveResources.errorTitle,this.locService.format(o.oneDriveResources.unsupportedFile,this.locService.OpenOneDrive),v.a.InvalidFileType,a),a.state=v.c.Failed,l.next(a)),l.asObservable()},e.prototype.setupUploadPromise=function(){var e=this;return this.uploadEnabledPromise=new Promise((function(t){e.capabilitiesService.capabilities.oneDriveUploadEnabled&&e.uploadConfigService.config?e.oneDriveService.then((function(e){t(!!e)})).catch((function(n){var i;e.globalErrorHandler.handleError(n,"IRW0y");var r=null===(i=null==n?void 0:n.networkError)||void 0===i?void 0:i.httpResponse,a=e.clientStartupConfigService.config.authType===f.a.MSA;t(!(e.capabilitiesService.capabilities.isPwaInUwp||!a&&!e.uploadConfigService.config.capPopupEnabled||(null==r?void 0:r.status)!==o.a.TokenUnavailable||!a&&"CAP_Error"!==(null==r?void 0:r.data)))})):t(!1)})),this.uploadEnabledPromise},e.prototype.startUpload=function(e,t){var n=this;e.state=v.c.Started,t.next(e),this.uploadToOneDrive(e).then((function(n){-1!==e.file.type.indexOf("video")&&(n.webUrl=g.a.appendQueryParam(n.webUrl,"web","1")),e.result=n,e.state=v.c.Completed,t.next(e)}),(function(i){e.error=n.getUploadSessionError(i,e,t),e.state=v.c.Failed,t.next(e)}))},e.prototype.isValidFileType=function(e){var t=l.a.fileTypeFromFileName(e.name);return this.uploadConfigService.config.uploadFileTypes.has(t)},e.prototype.uploadToOneDrive=function(e){var t=this;return(e.file.size<this.uploadConfigService.config.simpleUploadMaxSize?this.uploadSmall(e):this.uploadLarge(e)).then((function(n){var i={};n.webDavUrl&&(i.canonicalUrl=n.webDavUrl);var r=n.webUrl,o=l.a.fileTypeFromFileName(e.file.name);if(t.uploadConfigService.config.editableFileTypes.has(o)){var a="action=edit";-1===(r=r.replace(new RegExp("([?&])action[^&]*"),"$1action=edit")).lastIndexOf(a)&&(r=g.a.appendQuery(r,a))}return i.webUrl=r,i}))},e.prototype.uploadSmall=function(e){return this.oneDriveService.uploadFile(e.file,e.sessionId,null,null,(function(t){return e.updateProgress(t.loaded)}),e.cancellationToken)n this.uploadState(e,{})},e.prototype.uploadState=function(e,t){var n=this,i=t.sessionUrl,r=t.item,o=t.error;return e.sessionUrl=i,new Promise((function(a,l){r?a(r):o&&!i?l(o):o?n.oneDriveService.cancelUploadSession(i,e.sessionId,e.cancellationToken).ca((function(){return l(o)})):n.stateMachine.advanceState(e,t,eloadState(e,t).then(a,l)}),l)}))},e.prototype.getUploadSessionError=function(e,t,n){var i=this,r=this.uploadConfigService.config.oneDriveResources;if(!e.httpResponse||e.clientError)return{title:r.errorTitle,type:v.a.Unknown,message:""};var a=this.uploadConfigService.config.commonResources;return b.resolveGraphError(e,(function(e){switch(e){case"quotaLimitReached":case o.a.InsufficientStorage:return i.suggestOneDriveErrorWithText(r.errorTitle,r.outOfSpace,v.a.OutOfSpace,t);case"maxFileSizeExceeded":case o.a.RequestEntityTooLarge:return{title:r.errorTitle,type:v.a.FileTooLarge,message:r.largeFile};case o.a.Offline:return i.retryErrorWithText(r.errorTitle,a.checkConnection,v.a.BadConnection,t,n);case o.a.TokenUnavailable:case o.a.TokenRefreshFailed:return{title:r.errorTitle,type:v.a.Auth,message:""}}}))||{title:r.errorTitle,type:v.a.Unknown,message:""}},e.prototype.retryErrorWithText=function(e,t,n,i,r){var o=this,a=this.uploadConfigService.config.commonResources;return{title:e,type:n,message:t,recourseAction:{text:a.retryButtonTitle,ariaLabel:a.reion(){o.startUpload(i,r)},clickData:this.recourseClickDataWithId("upload-retry",i.sessionId,i.uploadSource)}}},e.prototype.suggestOneDriveErrorWithText=function(e,t,i,r){var o=this;return this.contextService.sharedContext.oneDriveUrl?{title:e,type:i,message:t,recourseAction:{text:this.locService.OpenOneDrive,ariaLabel:this.locService.OpenOneDrive,action:function(){o.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o.contextService.sharedContext.oneDriveUrl,{action:"OpenOneDriveUploadAction"})})):o.urlLauncherService.openUrl(o.contextService.sharedContext.oneDriveUrl,"OpenOneDriveUploadAction")},clickData:this.recourseClickDataWithId("upload-open-onedrive",r.sessionId,r.uploadSource,s.a.OneDrive)}}:{title:e,type:v.a.Unknown,message:""}},e.prototype.recourseClickDataWithId=function(e,t,n,i){var r={};return r.UploadSessionId=t,r.ElementId=e,r.Referral=i,r.Area=a.b.UploadDialog,r.ItemCategory=v.d[n],{eventName:"Upload_Click",params:r,metrics:[]}},e.ɵprov=I.kc({factory:function(){return new e(I.lc(h.a),I.lc(m.a),I.lc(c.a),I.lc(S.a),I.lc(u.a),I.lc(d.b),I.lc(p.a),I.lc(r.b),I.lc(f.b))},token:e,providedIn:"root"}),e}()},"9WrL":function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var i=n("DQbD"),r=n("GmnP"),o=n("FHrx"),a=n("JWB6"),l=n("6u39"),s=n("fpaX"),c=n("hhzZ"),u=n("Vwd8"),d=n("7ma0"),p=n("kpuN"),f=n("AXqk"),h=n("W3Zz"),m=n("EYcb"),b=n("U8M1"),g=n("Z0U4"),v=n("wwmn"),S=n("Uqr9"),y=n("casz"),C=n("EUVs"),w=n("4/We"),T=n("cgnd"),k=n("/I02"),I=n("ufVG"),_=n("JH4S"),A=n("QjXU"),P=n("ConB"),E=n("81FX"),O=n("zPZ9"),F=n("8/lW"),D=n("+1lv"),M=n("pdjy"),R=n("uV9m")ult:return"InvalidInput"}},N=n("BaAg"),W=n("jCfB"),j=!1;function H(e){if(e.route){var t=e.route;switch(t){case"M365Apps":if(e)return{route:t,appId:e.appId,entityId:e.entityId,subEntityId:e.subPageId};break;case"MyContent":return{route:"MyContent",entityId:e.entityId,subEntityId:e.subEntityId};default:return{route:t,app:N.b[e.app]}}}}function B(e){if(null==e?void 0:e.route){var t=e.route;switch(e.route){case"M365Apps":return{route:"M365Apps",app:e.appId,entityId:e.entityId,subPageId:e.subEntityId};case"MyContent":return{route:"MyContent",entityId:e.entityId,subEntityId:e.subEntityId};default:return{route:t,app:N.b[e.app]}}}}function G(e,t){var n,i,r,o,a,l,s;return{isAdmin:null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.isAdmin,isDynamics:null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.isDynamics,isEdu:null===(r=null==e?void 0:e.user)||void 0===r?void 0:r.isEdu,isEduFaculty:null===(o=null==e?void 0:e.user)||void 0===o?void 0:o.isEduFaculty,isEduStudent:null===(a=null==e?void 0:e.user)||void 0===a?void 0:a.isEduStudent,isFirstVisit:null==t?void 0:t.isFirstVisit(),isIw:null===(l=null==e?void 0:e.user)||void 0===l?void 0:l.isIw,isSmb:null===(s=null==e?void 0:e.user)||al";default:return"Web"}}function z(e){switch(e.getDeviceInfo().platform.platformType){case h.e.AndroidPhone:return"AndroidPhone";case h.e.AndroidTablet:return"AndroidTablet";case h.e.Chromebook:return"Chromebook";case h.e.Linux:return"Linux";case h.e.Mac:return"Mac";case h.e.PC:return"PC";case h.e.WindowsPhone:return"WindowsPhone";case h.e.iPad:return"iPad";case h.e.iPhone:return"iPhone";default:return"Other"}}function K(e,t){if(t.capabilities.isPwaInWebView2)return"WebView2";if(t.capabilities.isPwaInUwp){var n=new RegExp("1[0-9]{2}10");return(null==e?void 0:e.build)&&n.test(e.build.toStrinturn"EU";default:return}}var X=n("keVe"),J=n("5MEU"),Y=n("OtXi"),$=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S,y,C,w,T,k,I,_){this.clientStartupConfigService=e,this.aadAppId=t,this.accessTokenService=n,this.capabilitiesService=i,this.contextService=r,this.errorDialogService=o,this.fluidHostContext=a,this.fluidInstrumentationService=l,this.instrumentationService=s,this.officeHomeApiConfigService=c,this.officeRouteService=u,this.performanceService=d,this.ariaEventFactoryService=p,this.scheduler=f,this.serviceWorkerStateService=h,this.dataSecurityService=m,this.deviceDetector=b,this.ngZone=g,this.wacContentService=v,this.workloadQueryParam=S,this.uploadLocalFileService=y,this.userContextService=C,this.userProfileService=w,this.reactShellConfigService=T,this.encryptionConfigService=k,this.wrapperVersion=I,this.floodgateService=_}return e.prototype.bootstrapOfficeStart=function(){return function(e,t,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S,y,w,k,I,_,M,X,J){var Y,$,ee,te,ne,ie,re={aadAppId:e,buildDateUtc:d.config.sharedClientStartupContext.buildDateUtc,buildVersion:"53e722e1-1fae-9b16-8174-18529a8e07ce",cdnDomain:d.config.officeStartCdnDomain,correlationId:d.config.sharedClientStartupContext.correlationId,dataBoundary:Q(d.config.dataBoundary),defaultLinkTarget:r.sharedContext.defaultLinkTarget,deploymentEnvironment:d.config.sharedClientStartupContext.deploymentEnvironment,domainOrigin:d.config.sharedClientStartupContext.domainOrigin,ecsRing:d.config.sharedClientStartupContext.ecsRing,flights:d.config.sharedClientStartupContext.flights,geoName:d.config.sharedClientStartupContext.geoName,getAccessToken:function(e,n,i,r,o,a,l,s,c){return t.getAccessToken(e,n,i,!1===l,{category:s?U(s.category):void 0,fileType:s?N.a.fileTypeNameToFileType(s.fileType):ve.clientId,scope){return r.getCsrfToken()},getIdentity:function(){return Promise.resolve({authType:d.config.authType,authVersion:d.config.authVersion,encryptionConfig:null==M?void 0:M.config,isMsa:d.config.authType===T.a.MSA,isOrgId:d.config.authType===T.a.OrgId,isPipl:d.config.isPipl,objectId:d.config.objectId,puid:d.config.puid,tenantId:d.config.tenantId,userCountryCode:d.config.userCountryCode,userPrincipalName:d.config.userPrincipalName,identityIssuedTimeUnixMs:d.config.identityIssuedTimeUnixMs,tenantRegionScope:d.config.tenantRegionScope,dataBoundary:d.config.dataBoundary,loginHint:d.config.loginHint,activityTimeout:_.reactShellConfig.activityTimeout,controlsClaim:_.reactShellConfig.controlsClaim,signInState:_.reactShellConfig.signinState,userDisplayName:_.reactShellConfig.userDisplayName})},inMockMode:r.sharedContext.inMockMode,isCorpNet:d.config.sharedClientStartupContext.corpNet,jwtAuthEnabled:c.config.jwtAuthEnabled,officeHomeApiRoot:r.sharedContext.officeHomeApiRoot,officeMarketLcid:r.sharedContext.officeMarketLcid,officeStartManifestVersion:r.sharedContext.officeStartManifestVersion,preferredCulture:r.sharedContext.officeMarket,requestOrigin:d.config.sharedClientStartupContext.requestOrigrn B(u.getCurrentRoute())},getCurrentRouteQueryParams:function(){return u.getCurrentRouteQueryParams()},getCurrentPageForLogging:function(){return u.getCurrentPageForLogging()},getRouteObservable:function(){return u.getRouteChangeEndObservable().pipe(Object(L.a)((function(e){return B(e.currentRoute)})))},getSearchParams:function(){var e=u.getCurrentRouteQueryParams();return new URLSearc u.getUrlForRoute(H(e),t)},navigateTo:function(e,t,n,i,r){return v.runTask((function(){return u.navigateTo(H(e)tion(){return u.back()}))},openHostedDocument:function(e,t,n,i,r,o){var s;if(i)return l.logPerformanceBootStart(a.getBootId()),a.hostScenarioName=r,a.hostScenarioStartTime=t,u.navigateTo({route:"Content",app:N.b.Fluid},!1,C.a.getWacParams(e.driveId,e.docId,e.canonicalUrl,e.sharepointIds?{siteUrl:e.sharepointIds.siteUrl}:void 0));var c=null==o?void 0:o.actnavid,d=S.bootstrapAndRoute(function(e,t,n){return{docId:e.docId,docUrl:e.canonicalUrl,driveId:e.driveId,fileType:N.b[e.fileType],fileName:e.fileName,wdOrigin:t,applicationUrlParams:n}}(e,n,o),c?((s={})[W.a.Nav]=c,s):void 0,t);return Promise.resolve(!!d)}},sessionId:d.config.sharedClientStartupContext.sessionId,stringsContainerName:"officestartstrings",workload:y,wrapperVersion:null!=X?X:void 0,oneDriveUrl:r.sharedContext.oneDriveUrl,oneDriveResourceId:r.sharedContext.oneDriveResourceId,sharePointResourceId:r.sharedContext.sharePointResourceId,loginHint:d.config.loginHint,uiConreturn w.showModal(e,t,n)},showErrorDialog:function(e){return o.showErrorDialog(Object(A.__assign)(Object(A.__assign)({},e),{category:e.category,error:e.error,fileType:N.b[e.fileid 0:J.recordFloodgate(e)},testTraffic:_.reactShellConfig.testTraffic,thirdPartyNoticeUrl:null===(Y=_.reactShellConfig)||void 0===Y?void 0:Y.thirdPartyNoticeUrl,logoutUrl:null===($=_.reactShellConfig)||void 0===$?void 0:$.logoutUrl,appSwitchUrl:null===(te=null===(ee=_.reactShellConfig)||void 0===ee?void 0:ee.acctSwitchingConfig)||void 0===te?void 0:te.appSwitchUrl,appSwitchToUrl:null===(ie=null===(ne=_.reactShellConfig)||void 0===ne?void 0:ne.acctSwitchingConfig)||void 0===ie?void 0:ie.appSwitchToUrl};if(!j){j=!0,n.e(568).then(n.bind(null,"kje2")).then((function(e){e.initializeeateEvent(e,t,n).record()},flush:function(){f.flush()}}],(function(t){e.applyCommonStateParams(t,u.getCurrentPageForLogging()?u.getCurrentPageForLogging():"OfficeHome",u.getInitialPageForLogging()?u.getInitialPageForLogging():"OfficeHome",P.a[h.currentState],F.a[b.securityLevel.toString()],E.a[g.getNetworkInfo()])}))})),Object(O.b)(re);var oe=d.config.sharedClientStartupContext.clientOTelImmediateSchedulePriorityEnabled?0:d.config.sharedClientStartupContext.clientOTelHighSchedulePriorityEnabled?1:d.config.sharedClientStartupContext.clientOTelMediumSchedulePriorityEnabled?2:3;m.scheduleWork((function(){Object(D.b)({appName:d.config.sharedClientStartupContext.oTelAppName,appPlatform:V(y),appWorkload:q(y),appWorkloadType:X?K(X,i):void 0,bundleBuildDate:d.config.sharedClientStartupContext.buildDateUtc,bundleBuildId:d.config.sharedClientStartupContext.buildId,correlationId:d.config.sharedClientStartupContext.correlationId,dataBoundary:Q(d.config.dataBoundary),deploymentEnvironment:re.deploymentEnvironment,deviceType:z(g),domainOrigin:d.config.sharedClientStartupContext.domainOrigin,ecsRing:d.config.sharedClientStartupContext.ecsRing,firstVisitAgeInDays:null==I?void 0:I.fullDaysSinceFirstVisit(),flights:d.config.sharedClientStartupContext.flights,identity:{isMsa:d.config.authType===T.a.MSA,objectId:d.config.objectId,puid:d.config.puid,tenantId:d.config.tenantId,encryptionConfig:null==M?void 0:M.config,userPrincipalName:d.config.userPrincipalName,authType:d.config.authType,isOrgId:d.config.authType===T.a.OrgId},initialPageName:u.getInitialPageForLogging()?u.getInitialPageForLogging():"OfficeHome",isCorpNet:d.config.sharedClientStartupContext.corpNet,IsEudbEndpointEnabled:d.config.sharedClientStartupContext.oTelEudbEndpointEnabled,IsSamplingEnabled:d.config.sharedClientStartupContext.oTelSamplingEnabled,isTestTraffic:r.sharedContext.inMockMode,networkType:E.a[g.getNetworkInfo()],oTelAriaNameSpace:d.config.sharedClientStartupContext.oTelNameSpace,oTelAriaTenant:d.config.sharedClientStartupContext.oTelAriaTenant,oTelEnabled:d.config.sharedClientStartupContext.oTelEnabled,preferredCulture:r.sharedContext.officeMarket,requestOrigin:re.requestOrigin,schedulerPriority:Z(oe),serverLocation:d.config.sharedClientStartupContext.geoName.toLowerCase(),serviceWorkerState:P.a[h.currentState],sessionId:re.sessionId,userSegment:G(k,I),win11DetectionEnabled:d.config.sharedClientStartupContext.oTelWin11DetectionEnabled,oTelDiagnosticAriaNameSpace:d.config.sharedClientStartupContext.oTelDiagnosticEnabled?d.config.sharedClientStartupContext.oTelDiagnosticNameSpace:void 0,oTelDiagnosticAriaTenant:d.config.sharedClientStartupContext.oTelDiagnosticEnabled?d.config.sharedClientStartupContext.oTelDiagnosticAriaTenant:void 0}).then((function(){Object(R.d)([{logEvent:D.d,flush:function(){}}],(function(){return B(u.getCurrentRoute())}),{actionEnabled:d.config.sharedClientStartupContext.oTelClickEnabled,diagnosticEnabled:d.config.sharedClientStartupContext.oTelDiagnosticEnabled,errorEnabled:d.config.sharedClientStartupContext.oTelErrorEnabled,featureEnabled:d.config.sharedClientStartupContext.oTelFeatureEnabled,impressionEnabled:d.config.sharedClientStartupContext.oTelImpressionEnabled,pageViewEnabled:d.config.sharedClientStartupContext.oTelPageViewEnabled,perfEnabled:d.config.sharedClientStartupContext.oTelPerfEnabled,requestEnabled:d.config.sharedClientStartupContext.oTelRequestEnabled},{perfSamplingEnabled:d.config.sharedClientStartupContext.oTelSamplingPerformanceEnabled,requestSamplingEnabled:d.config.sharedClientStartupContext.oy;case 3:return x.a.Full}}(b.securityLevel),d.config.sharedClientStartupContext.flights)})).then((function(){p.mark("OTEL_Ready")})).catch((function(e){var t,n,i=((t={}).Error=(null===(n=null==e?void 0:e.toString)||void 0===n?void 0:n.call(e))||"",t);s.logDebugCacheEvent("OTEL_Initialization_Error",i)}))}),oe)}return re}(this.aadAppId,this.accessTokenService,this.capabilitiesService,this.contextService,this.errorDialogService,this.fluidHostContext,this.fluidInstrumentationService,this.instrumentationService,this.officeHomeApiConfigService,this.officeRouteService,this.clientStartupConfigService,this.performanceService,this.ariaEventFactoryService,this.serviceWorkerStateService,this.scheduler,this.dataSecurityService,this.deviceDetector,this.ngZone,this.wacContentService,this.workloadQueryParam,this.uploadLocalFileService,this.userContextService,this.userProfileService,this.reactShellConfigService,this.encryptionConfigService,this.wrapperVersion,this.floodgateService)},e.ɵprov=X.kc({factory:function(){return new e(X.lc(T.b),X.lc(d.a),X.lc(p.b),X.lc(w.a),X.lc(k.a),X.lc(m.a),X.lc(i.a),X.lc(r.a),X.lc(c.a),X.lc(v.a),X.lc(g.a),X.lc(S.b),X.lc(s.a),X.lc(y.a),X.lc(a.a),X.lc(f.a),X.lc(h.c),X.lc(X.F),X.lc(C.a),X.lc(J.a),X.lc(l.a),X.lc(_.a),X.lc(u.b),X.lc(I.a),X.lc(o.a,8),X.lc(Y.a,8),X.lc(b.a,8))},token:e,providedIn:"root"}),e}()},"9c4X":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("iXzu"),r=n("keVe"),o=function(){function e(e){this.ngZone=e}return e.prototype.createAndObserve=function(e,t){var n=new i.a(e);return this.ngZone.runOutsideAngular((function(){n.observe(t)})),n},e.ɵprov=r.kc({factory:function(){return new e(r.lc(r.F))},token:e,providedIn:"root"}),e}()},"9gjh":function(e,t,n){"use strict";n.d(t,"a",(function(){return Fe})),n.d(t,"b",(function(){return ni}));var i=n("keVe"),r=n("EVbV"),o=n("Jn4Q"),a=n("dx17"),l=n("4/We"),s=n("hZW2"),c=n("y1jW"),u=n("7Gwk"),d=n("hhzZ"),p=n("PBJH"),f=n("kfAr"),h=n("AY/E"),m=n("1Bt+"),b=n("TIi1"),g=n("EUVs"),v=n("BMb5"),S=n("TOqr"),y=n("6wOV"),C=n("pzhl"),w=n("PkQn"),T=n("94Ef"),k=n("M56G"),I=n("jrGV"),_=n("W3Zz"),A=n("u51t"),P=n("g0MB"),E=n("w1PR"),O=function(){function e(e){this.locService=e,this.updateAriaLabel=new i.q}return e.prototype.ngOnChanges=function(){if(this.state=this.analytics?"active":"inactive",this.analytics){var e=this.formatSingularOrPluralString(this.analytics.viewCount,this.locService.DocumentAnalyticsSingleTotalView,this.locService.DocumentAnalyticsMultipleTotalViews),t=this.locService.format(this.locService.DocumentAnalyticsAvgTimeSpent,this.getAvgTimeSpent(this.analytics.averageTimeSpentMs)),n=this.locService.format(this.locService.DocumentAnalyticsAvgCompletion,this.locService.localizedNumberString(Math.floor(100*this.analytics.averageCompletionRatio))),i=this.locService.format(this.locService.DocumentAnalyticsGlancedViews,this.locService.localizedNumberString(this.analytics.glancedReads)),r=this.formatSingularOrPluralString(this.analytics.quickReads,this.locService.DocumentAnalyticsSingleQuickRead,this.locService.DocumentAnalyticsMultipleQuickReads),o=this.formatSingularOrPluralString(this.analytics.deepReads,this.locService.DocumentAnalyticsSingleDeepRead,this.locService.DocumentAnalyticsMultipleDeepReads);this.generalInfo=this.locService.format(this.locService.DocumentAnalyticsTotalViewsAvgTimeSpentAndAvgCompletionFormat,e,t,n),this.detailedViewInfo=this.locService.format(this.locService.DocumentAnalyticsDetailedViewsInfoFormat,i,r,o),this.updateDescription()}},e.prototype.getAvgTimeSpent=function(t){var n=t/6e4;return n<e.spentTimeLessThanStringThreshold?this.locService.format(this.locService.DocumentAnalyticsLessThanAvgTimeSpent,this.locService.localizedNumberString(e.spentTimeLessThanStringThreshold)):this.locService.format(this.locService.DocumentAnalyticsAvgTimeSpentMinutes,this.locService.localizedNumberString(Math.round(n)))},e.prototype.formatSingularOrPluralString=function(e,t,n){return this.locService.format(1===e?t:n,this.locService.localizedNumberString(e))},e.prototype.updateDescription=function(){var e=this.locService.format(this.locService.DocumentDescriptiveAriaLabelAnalytics,this.generalInfo,this.detailedViewInfo);this.updateAriaLabel.emit(e)},e.spentTimeLessThanStringThreshold=1,e}(),F=i.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}}]}});function D(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"div",[["class","analytics-description__data-piece-label ms-fcl-np"]],null,null,null,null,null)),(e()(),i.gc(2,null,["",""])),(e()(),i.Hb(3,0,null,null,1,"div",[["class","analytics-description__data-piece-label ms-fcl-np"]],null,null,null,null,null)),(e()(),i.gc(4,null,["",""]))],null,(function(e,t){var n=t.component;e(t,2,0,n.generalInfo),e(t,4,0,n.detailedViewInfo)}))}function M(e){return i.jc(2,[(e()(),i.Hb(0,0,null,null,2,"div",[],[[24,"@fadeIn",0]],null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,D)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.analytics)}),(function(e,t){e(t,0,0,t.component.state)}))}i.Db("ohp-analytics-description",O,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-analytics-description",[],null,null,null,M,F)),i.Gb(1,573440,null,0,O,[p.a],null,null)],null,null)}),{analytics:"analytics"},{updateAriaLabel:"updateAriaLabel"},[]);var R=n("7IJ8"),x=n("QhWD"),L=n("cgnd"),U=n("casz"),N=n("RsrG"),W=n("6Po3"),j=n("WLAd"),H=n("1GMS"),B=n("cAxl"),G=n("3bNC"),q=n("POe7"),V=n("QjXU"),z=n("+2OL"),K=n("JWB6"),Z=n("R7NL"),Q=n("oAX+"),X=function(){function e(e,t,n,i){this.instrumentedHttp=e,this.domSanitizer=t,this.serviceWorkerStateService=n,this.serviceWorkerConfigService=i}return e.prototype.transform=function(e){return Q.a.createResultsWithCacheObservable(this.getData(e,"cache-only"),this.getData(e,"network-first")).results},e.prototype.getData=function(e,t){return Object(V.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(V.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.instrumentedHttp.get("Thumbnail_Cache_Pipe_Load","Thumbnail_Cache_Pipe_Load",e,{headers:"Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled?new Map([["X-SW-OHP-ThumbnailCacheable","ODSP_THUMBNAIL_CACHEABLE"]]):null,responseType:"blob"},t)];case 1:return n=r.sent(),i=URL.createObjectURL(n.data),[2,this.domSanitizer.bypassSecurityTrustUrl(i)]}}))}))},e}(),J=n("pd4Y"),Y=n("uH9+"),$=function(){function e(){}return e.prototype.transform=function(e){return{email:e.address,fullName:e.name}},e}(),ee=function(){function e(e,t){this.actionContextMenuService=e,this.deviceDetector=t}return e.prototype.ngOnInit=function(){this.desktop=this.deviceDetector.isDesktopDevice()},e.prototype.onContextMenu=function(e){this.desktop&&this.model&&e&&!this.disabled&&(e.preventDefault(),this.actionContextMenuService.openMenu({id:this.model.id,itemIndex:this.model.itemIndex,actions:this.model.actions,groupInfo:this.model.groupInfo,mouseEvent:e,targetElement:void 0}))},e}(),te=n("ttrr"),ne=n("5FMq"),ie=n("R0N1"),re=n("/I02"),oe=n("xSeq"),ae=n("rbdM"),le=n("kq70"),se=n("7J/E"),ce=n("55A9"),ue=n("TDzr"),de=n("EYcb"),pe=n("2lMP"),fe=n("qCYW"),he=n("Bc8L"),me=n("QOOv"),be=n("dOgD"),ge=n("Z0U4"),ve=n("Dpxn"),Se=n("EqbI"),ye=n("Uqr9"),Ce=n("OPwp"),we=n("uNUv"),Te=n("6u39"),ke=n("Xc4i"),Ie=n("hoyd"),_e=n("7Rc8"),Ae=n("DQbD"),Pe=n("GmnP"),Ee=n("kpuN"),Oe=n("U8M1"),Fe=i.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeInIsNew",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}},{type:7,name:"recommendedCardHover",definitions:[{type:0,name:"hovered",styles:{type:6,styles:{transform:"scale(1.05)"},offset:null},options:void 0},{type:1,expr:"* => hovered",animation:{type:4,styles:null,timings:"100ms linear"},options:null}],options:{}}]}});function De(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[["class","mru-list-item-overlay"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"div",[["class","spinner-container spinner-container--wh-100"]],null,null,null,null,null)),(e()(),i.Hb(2,0,null,null,0,"div",[["class","ms-Spinner-circle ms-Spinner--large"]],null,null,null,null,null))],null,null)}function Me(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(1,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.item.lastModifiedActivity,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea)}),null)}function Re(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,6,"div",[["class","document-card__header"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__header--fluent":0}),(e()(),i.Hb(3,0,null,null,3,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(4,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],activityDeepLink:[2,"activityDeepLink"],docId:[3,"docId"],activityDescriptionInput:[4,"activityDescriptionInput"],index:[5,"index"],fileType:[6,"fileType"],navId:[7,"navId"],numLines:[8,"numLines"],teamsDeepLink:[9,"teamsDeepLink"],area:[10,"area"]},null),(e()(),i.qb(16777216,null,0,1,null,Me)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fluentRefresh);e(t,1,0,"document-card__header",i),e(t,4,1,[n.item.activities,n.item.lastViewedTime,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.item.activity,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea]),e(t,6,0,n.item.lastModifiedActivity&&!n.item.activity)}),null)}function xe(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(1,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.item.lastModifiedActivity,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea)}),null)}function Le(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,8,"div",[["class","document-card__header"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__header--fluent":0}),i.Gb(3,212992,null,0,y.a,[i.o,h.a],{upn:[0,"upn"]},null),(e()(),i.Hb(4,0,null,null,4,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(5,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],showIcon:[2,"showIcon"],person:[3,"person"],activityDeepLink:[4,"activityDeepLink"],docId:[5,"docId"],activityDescriptionInput:[6,"activityDescriptionInput"],index:[7,"index"],fileType:[8,"fileType"],navId:[9,"navId"],numLines:[10,"numLines"],teamsDeepLink:[11,"teamsDeepLink"],area:[12,"area"]},null),i.ac(6,1),(e()(),i.qb(16777216,null,0,1,null,xe)),i.Gb(8,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=e(t,2,0,n.fluentRefresh);e(t,1,0,"document-card__header",r),e(t,3,0,n.item.activityUser.email);var o=n.item.activities,a=n.item.lastViewedTime,l=i.hc(t,5,3,e(t,6,0,i.Wb(t.parent.parent,0),null==n.item.activity?null:n.item.activity.people[0]));e(t,5,1,[o,a,!1,l,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.item.activity,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea]),e(t,8,0,n.item.lastModifiedActivity&&!n.item.activity)}),null)}function Ue(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Ne(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,i.Ob(1,"",t.componnent.item.mediaDuration)}))}function je(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,8,"div",[],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Ue)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(3,0,null,null,3,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),(e()(),i.qb(16777216,null,null,2,null,Ne)),i.Gb(5,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),i.Yb(131072,S.b,[i.h]),(e()(),i.qb(16777216,null,null,1,null,We)),i.Gb(8,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.streamsThumbnailLoaded),e(t,5,0,i.hc(t,5,0,i.Wb(t,6).transform(n.streamsVideoThumbnail))),e(t,8,0,n.item.mediaDuration)}),(function(e,t){e(t,3,0,!t.component.streamsThumbnailLoaded)}))}function He(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Be(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,i.Ob(1,"",t.component.thumbnailAltText,""))}))}function Ge(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"div",[["class","document-card--suggested-actions--fallback-background"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Yb(131072,S.b,[i.h]),i.Zb(3,{"background-color":0})],(function(e,t){var n=t.component,r=e(t,3,0,i.hc(t,1,0,i.Wb(t,2).transform(n.workloadColorPromise)));e(t,1,0,r)}),null)}function qe(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,He)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(3,0,null,null,3,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),(e()(),i.qb(16777216,null,null,2,null,Be)),i.Gb(5,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),i.Yb(131072,S.b,[i.h]),(e()(),i.qb(16777216,null,null,1,null,Ge)),i.Gb(8,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,n.thumbnailLoaded),e(t,5,0,i.hc(t,5,0,i.Wb(t,6).transform(n.thumbnail))),e(t,8,0,!n.thumbnailLoaded&&n.fluentRefresh)}),(function(e,t){e(t,3,0,!t.component.thumbnailLoaded)}))}function Ve(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function ze(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__thumbnail-officefeed-news":0}),i.ac(3,1),i.Yb(131072,S.b,[i.h])],(function(e,t){var n=e(t,2,0,t.component.isNewsArticle);e(t,1,0,"document-card__thumbnail",n)}),(function(e,t){var n=t.component,r=i.hc(t,0,0,i.Wb(t,4).transform(i.hc(t,0,0,e(t,3,0,i.Wb(t.parent.parent.parent.parent,1),n.thumbnailUrl))));e(t,0,0,r,i.Ob(1,"",n.thumbnailAltText,""))}))}function Ke(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__thumbnail-officefeed-news":0})],(function(e,t){var n=e(t,2,0,t.component.isNewsArticle);e(t,1,0,"document-card__thumbnail",n)}),(function(e,t){var n=t.component;e(t,0,0,n.thumbnailUrl,i.Ob(1,"",n.thumbnailAltText,""))}))}function Ze(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,9,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Ve)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(3,0,null,null,6,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),i.Gb(4,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Zb(5,{"background-color":0}),(e()(),i.qb(16777216,null,null,1,null,ze)),i.Gb(7,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ke)),i.Gb(9,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.thumbnailLoaded);var i=e(t,5,0,n.item.thumbnails&&n.item.thumbnails.backgroundColor?n.item.thumbnails.backgroundColor:"transparent");e(t,4,0,i),e(t,7,0,n.thumbnailSWEnabled),e(t,9,0,!n.thumbnailSWEnabled)}),(function(e,t){e(t,3,0,!t.component.thumbnailLoaded)}))}function Qe(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,1,0,t.component.item.documentIconWithSize("64x64"))}),null)}function Xe(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Ob(1,"",t.component.item.iconUrl,""))}))}function Je(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","document-card__thumbnail-placeholder"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Qe)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Xe)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,!n.item.iconUrl),e(t,4,0,n.item.iconUrl)}),null)}function Ye(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","mru-list-item__icon-in-preview"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Zb(2,{color:0}),(e()(),i.Hb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,C.b,C.a)),i.Gb(4,638976,[[3,4],["fileIconElement",4]],0,w.a,[l.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.iconFontColor());e(t,1,0,i),e(t,4,0,n.iconFontClass(),"16")}),null)}function $e(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function et(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Ye)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,$e)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.iconFontClass()),e(t,4,0,!n.iconFontClass())}),null)}function tt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Je)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,et)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,!n.thumbnailLoaded&&!n.isStreamsVideo||!n.streamsThumbnailLoaded&&n.isStreamsVideo),e(t,4,0,!n.recommendedNewCards&&(n.thumbnailLoaded||n.streamsThumbnailLoaded&&n.isStreamsVideo)&&!n.isNewsArticle&&"borderless"!==n.uiCardType&&!n.fluentRefresh)}),null)}function nt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,1,0,t.component.item.documentIconWithSize("64x64"))}),null)}function it(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Ob(1,"",t.component.item.iconUrl,""))}))}function rt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","document-card__thumbnail-placeholder"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,nt)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,it)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,!n.item.iconUrl),e(t,4,0,n.item.iconUrl)}),null)}function ot(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","mru-list-item__icon-in-preview"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Zb(2,{color:0}),(e()(),i.Hb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,C.b,C.a)),i.Gb(4,638976,[[3,4],["fileIconElement",4]],0,w.a,[l.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.iconFontColor());e(t,1,0,i),e(t,4,0,n.iconFontClass(),"16")}),null)}function at(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function lt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,ot)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,at)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.iconFontClass()),e(t,4,0,!n.iconFontClass())}),null)}function st(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,rt)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,lt)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,(!n.thumbnailLoaded||!n.thumbnailUrl)&&!n.isStreamsVideo||!n.streamsThumbnailLoaded&&n.isStreamsVideo),e(t,4,0,!n.recommendedNewCards&&(n.thumbnailUrl&&n.thumbnailLoaded||n.streamsThumbnailLoaded&&n.isStreamsVideo)&&!n.isNewsArticle&&"borderless"!==n.uiCardType&&!n.fluentRefresh)}),null)}function ct(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,12,"div",[["class","document-card__thumbnail-container"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__thumbnail-container--recommended":0,"document-card_thumbnail-container--rounded document-card__thumbnail-container--borderless":1,"document-card__thumbnail-container--rounded-card":2,"document-card__thumbnail-container--suggested-actions":3}),(e()(),i.qb(16777216,null,null,1,null,je)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,qe)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ze)),i.Gb(8,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,tt)),i.Gb(10,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,st)),i.Gb(12,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isRecommended||n.isOfficeFeed,"borderless"===n.uiCardType,(n.isRecommended||n.isOfficeFeed)&&n.recommendedNewCards,n.fluentRefresh);e(t,1,0,"document-card__thumbnail-container",i),e(t,4,0,n.isStreamsVideo),e(t,6,0,n.thumbnailApiEnabled&&!n.isStreamsVideo&&!n.isNewsArticle&&!n.isMicrosoftForms),e(t,8,0,(!n.thumbnailApiEnabled||n.isNewsArticle||n.isMicrosoftForms)&&n.thumbnailUrl&&!n.isStreamsVideo),e(t,10,0,n.thumbnailApiEnabled),e(t,12,0,!n.thumbnailApiEnabled)}),null)}function ut(e){return i.jc(0,[(e()(),i.qb(0,null,null,0))],null,null)}function dt(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,1,null,ut)),i.Gb(1,540672,null,0,S.o,[i.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){e(t,1,0,i.Wb(t.parent.parent,38))}),null)}function pt(e){return i.jc(0,[(e()(),i.qb(0,null,null,0))],null,null)}function ft(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,1,null,pt)),i.Gb(1,540672,null,0,S.o,[i.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){e(t,1,0,i.Wb(t.parent.parent,39))}),null)}function ht(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(1,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],iconSize:[1,"iconSize"],activityDeepLink:[2,"activityDeepLink"],title:[3,"title"],docId:[4,"docId"],index:[5,"index"],fileType:[6,"fileType"],navId:[7,"navId"],numLines:[8,"numLines"],teamsDeepLink:[9,"teamsDeepLink"],area:[10,"area"]},null)],(function(e,t){var n=t.component;e(t,1,1,[n.item.lastModifiedActivity,20,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.recommendedNewCards&&n.item.title,n.item.docId,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea])}),null)}function mt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,3,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(2,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconSize:[2,"iconSize"],activityDeepLink:[3,"activityDeepLink"],title:[4,"title"],docId:[5,"docId"],activityDescriptionInput:[6,"activityDescriptionInput"],index:[7,"index"],fileType:[8,"fileType"],numLines:[9,"numLines"],teamsDeepLink:[10,"teamsDeepLink"],area:[11,"area"]},null),(e()(),i.qb(16777216,null,0,1,null,ht)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,1,[n.item.activities,n.item.lastViewedTime,20,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.recommendedNewCards&&n.item.title,n.item.docId,n.item.activity,n.index,n.item.fileType,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea]),e(t,4,0,n.item.lastModifiedActivity&&!n.item.activity)}),null)}function bt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","document-card__menu"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__menu--hidden":0}),(e()(),i.Hb(3,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,n){var i=!0,r=e.component;return"menuToggled"===t&&(i=!1!==r.onActionsMenuToggle(n)&&i),"menuFocused"===t&&(i=!1!==(n?r.onFocus():r.onBlur())&&i),i}),T.b,T.a)),i.Gb(4,770048,[[10,4]],0,k.a,[I.a,l.a,s.a,i.o,_.c,d.a,p.a,i.K],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],area:[3,"area"],dataSecurity:[4,"dataSecurity"],leftAlignedCard:[5,"leftAlignedCard"],documentName:[6,"documentName"],actionContextMenuEnabled:[7,"actionContextMenuEnabled"],actionContextMenu:[8,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var n=t.component,i=e(t,2,0,!n.isTouch);e(t,1,0,"document-card__menu",i),e(t,4,0,n.contextMenu,n.index,n.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",n.instrumentationArea,n.dataSecurityThreshold,n.leftAlignActionsMenu,n.item.fileName,n.actionContextMenuEnabled,n.actionContextMenu)}),null)}function gt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,6,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__info--expanded":0,"document-card__info--fluent":1}),(e()(),i.qb(16777216,null,null,1,null,mt)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,bt)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType,n.fluentRefresh);e(t,1,0,"document-card__info centered-flex-container",i),e(t,4,0,n.showActivity),e(t,6,0,n.showActionsMenu)}),null)}function vt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__title-icon--hidden":0})],(function(e,t){var n=t.component,i="document-card__title-icon "+n.item.documentIconWithSize("32x32"),r=e(t,2,0,n.isUpcomingMeeting||n.isMyAnalytics);e(t,1,0,i,r)}),null)}function St(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"img",[["class","document-icon--32x32 document-card__title-icon"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Ob(1,"",t.component.item.iconUrl,""))}))}function yt(e){return i.jc(0,[(e()(),i.Hb(0,0,[[1,0],["titleElement",1]],null,4,"span",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,n){var r=!0;return"mouseenter"===t&&(r=!1!==i.Wb(e,3).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Wb(e,3).onMouseLeave()&&r),"click"===t&&(r=!1!==i.Wb(e,3).onClick()&&r),r}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(2,{"ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),i.Gb(3,16384,null,0,A.a,[l.a,d.a],{area:[0,"area"]},null),(e()(),i.gc(4,null,["",""]))],(function(e,t){var n=t.component,i=e(t,2,0,n.clickableFolderEnabled);e(t,1,0,i),e(t,3,0,n.instrumentationArea)}),(function(e,t){var n=t.component;e(t,0,0,n.item.title),e(t,4,0,n.item.title)}))}function Ct(e){return i.jc(0,[(e()(),i.Hb(0,0,[[1,0],["titleElement",1]],null,4,"h4",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,n){var r=!0;return"mouseenter"===t&&(r=!1!==i.Wb(e,3).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Wb(e,3).onMouseLeave()&&r),"click"===t&&(r=!1!==i.Wb(e,3).onClick()&&r),r}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(2,{"ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),i.Gb(3,16384,null,0,A.a,[l.a,d.a],{area:[0,"area"]},null),(e()(),i.gc(4,null,["",""]))],(function(e,t){var n=t.component,i=e(t,2,0,n.clickableFolderEnabled);e(t,1,0,i),e(t,3,0,n.instrumentationArea)}),(function(e,t){var n=t.component;e(t,0,0,n.item.title),e(t,4,0,n.item.title)}))}function wt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"span",[["class","ms-fcl-ns ms-fcl-tp-h ms-fcl-tdr-f ms-fcl-tdr-a attribution-link"],["role","link"],["tabindex","0"]],[[1,"data-href",0],[1,"aria-label",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onPathClick(n)&&i),"keyup.enter"===t&&(i=!1!==r.onPathClick(n)&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null))],null,(function(e,t){var n=t.component;e(t,0,0,i.Ob(1,"",n.item.isEmailAttachment?n.url:n.item.attributionUrl,""),n.openFolderAriaLabel,i.Ob(1,"",n.openFolderAriaLabel,""),n.shortPath)}))}function Tt(e){return i.jc(0,[(e()(),i.Hb(0,0,[[4,0],["attributionElement",1]],null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.shortPath)}))}function kt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,wt)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Tt)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.clickableFolderEnabled&&(n.item.isEmailAttachment?n.url:n.item.attributionUrl)),e(t,4,0,!n.clickableFolderEnabled)}),null)}function It(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"span",[["class","list-item__text--small list-item__title ms-fcl-ns"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__text--small":0}),(e()(),i.Hb(3,0,null,null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),i.gc(4,null,["",""]))],(function(e,t){var n=e(t,2,0,t.component.fluentRefresh);e(t,1,0,"list-item__text--small list-item__title ms-fcl-ns",n)}),(function(e,t){var n=t.component;e(t,3,0,n.item.createdBy),e(t,4,0,n.item.createdBy)}))}function _t(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["class","categories-card--center"],["size","16"]],[[1,"aria-label",0]],null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontType:[2,"iconFontType"],size:[3,"size"],title:[4,"title"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.categoryIcon.categoryFontIconColor,"categories-card--center"+(n.isCardCreateByLabel&&null!=n.item&&n.item.createdBy?" categories--padding-left":""),n.categoryIcon&&n.categoryIcon.categoryFontIcon,"16",n.categoryIcon.categoryTooltip)}),(function(e,t){e(t,0,0,t.component.categoryIcon.categoryAriaLabel)}))}function At(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","list-item__text--small list-item__tertiary ms-fcl-nd list-item--bottom"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__text--small":0}),(e()(),i.Hb(3,0,[[1,0],["titleElement",1]],null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),i.gc(4,null,["",""]))],(function(e,t){var n=e(t,2,0,t.component.fluentRefresh);e(t,1,0,"list-item__text--small list-item__tertiary ms-fcl-nd list-item--bottom",n)}),(function(e,t){var n=t.component;e(t,3,0,n.borderlessCardDetail1),e(t,4,0,n.borderlessCardDetail1)}))}function Pt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,18,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"list-item--h-100":0}),(e()(),i.Hb(3,0,null,null,6,"div",[["class","list-item__title ms-fcl-nd"]],null,null,null,null,null)),i.Gb(4,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(5,{"list-item__title--double-line":0,"list-item__text--large":1,"list-item__text--large--fluent":2}),(e()(),i.qb(16777216,null,null,1,null,yt)),i.Gb(7,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ct)),i.Gb(9,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,kt)),i.Gb(11,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(12,0,null,null,4,"div",[["style","display:flex;"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,It)),i.Gb(14,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,_t)),i.Gb(16,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,At)),i.Gb(18,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType);e(t,1,0,"list-item__flex-grow",i);var r=e(t,5,0,"borderless"===n.uiCardType,!n.fluentRefresh,n.fluentRefresh);e(t,4,0,"list-item__title ms-fcl-nd",r),e(t,7,0,"borderless"!==n.uiCardType),e(t,9,0,"borderless"===n.uiCardType),e(t,11,0,!n.fluentRefresh&&!!n.shortPath&&"borderless"!==n.uiCardType),e(t,14,0,n.isCardCreateByLabel&&(null==n.item?null:n.item.createdBy)),e(t,16,0,n.categoryIcon&&n.categoryIcon.categoryFontIcon),e(t,18,0,n.isFormResponsesEnabled&&n.borderlessCardDetail1)}),null)}function Et(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,9,"div",[["class","list-item__flex-grow"]],null,[[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onPathClick(n)&&i),"keyup.enter"===t&&(i=!1!==r.onPathClick(n)&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"list-item--h-100":0}),(e()(),i.Hb(3,0,null,null,6,"div",[["class","upcomingMeeting-card__join_text"]],null,null,null,null,null)),i.Gb(4,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(5,{"upcomingMeeting-card__join_text--fluent":0}),(e()(),i.Hb(6,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,C.b,C.a)),i.Gb(7,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),i.Hb(8,0,null,null,1,"span",[["role","link"],["tabindex","0"]],[[1,"data-href",0],[1,"aria-label",0],[8,"title",0]],[[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),(e()(),i.gc(9,null,[""," "]))],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType);e(t,1,0,"list-item__flex-grow",i);var r=e(t,5,0,n.fluentRefresh);e(t,4,0,"upcomingMeeting-card__join_text",r),e(t,7,0,"upcomingMeeting-card_logo"+(n.fluentRefresh?" upcomingMeeting-card_logo--fluent":""),n.item.isTeamsMeeting?"Teams":"Calendar","16")}),(function(e,t){var n=t.component;e(t,8,0,n.item.joinUrl,n.item.joinMeetingText,n.item.joinMeetingText),e(t,9,0,n.item.joinMeetingText)}))}function Ot(e){return i.jc(0,[(e()(),i.Hb(0,0,[[8,0],["myAnalyticsAddToDoLink",1]],null,1,"span",[["class","myAnalytics-card_action_AddToTODo"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),"click"===t&&(i=!1!==r.onMyAnalyticsClick(n,r.PotentialActionType.PromoteTask)&&i),"keyup.enter"===t&&(i=!1!==r.onMyAnalyticsClick(n,r.PotentialActionType.PromoteTask)&&i),i}),null,null)),(e()(),i.gc(1,null,[""," "]))],null,(function(e,t){var n=t.component;e(t,0,0,n.addToToDoText),e(t,1,0,n.addToToDoText)}))}function Ft(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"span",[["class","myAnalytics-card_viewInTodoIcon"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon is-new-icon--tile ms-fcl-tp"],["iconFontName","ToDo"],["size","24"]],[[1,"aria-label",0]],null,null,C.b,C.a)),i.Gb(2,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,2,0,"is-new-icon is-new-icon--tile ms-fcl-tp","ToDo","24",t.component.viewInToDoText)}),(function(e,t){e(t,1,0,t.component.viewInToDoText)}))}function Dt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"span",[["class","myAnalytics-card_action_ViewInToDo"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),"click"===t&&(i=!1!==r.onViewToDoClick()&&i),"keyup.enter"===t&&(i=!1!==r.onViewToDoClick()&&i),i}),null,null)),(e()(),i.gc(1,null,[""," "]))],null,(function(e,t){var n=t.component;e(t,0,0,n.viewInToDoText),e(t,1,0,n.viewInToDoText)}))}function Mt(e){return i.jc(0,[(e()(),i.Hb(0,0,[[9,0],["myAnalyticsTaskDoneLink",1]],null,1,"span",[["class","myAnalytics-card_action_Done"],["role","link"],["tabindex","0"]],[[8,"title",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),"click"===t&&(i=!1!==r.onMyAnalyticsClick(n,r.PotentialActionType.MarkTaskAsDone)&&i),"keyup.enter"===t&&(i=!1!==r.onMyAnalyticsClick(n,r.PotentialActionType.MarkTaskAsDone)&&i),i}),null,null)),(e()(),i.gc(1,null,[""," "]))],null,(function(e,t){var n=t.component;e(t,0,0,n.doneText),e(t,1,0,n.doneText)}))}function Rt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,11,"div",[["class","list-item__flex-grow"]],null,[[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.disableClick()&&i),"keyup.enter"===t&&(i=!1!==r.disableClick()&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"list-item--h-100":0}),(e()(),i.Hb(3,0,null,null,8,"div",[["class","myAnalytics-card_action ms-fcl-tp"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Ot)),i.Gb(5,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ft)),i.Gb(7,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Dt)),i.Gb(9,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Mt)),i.Gb(11,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType);e(t,1,0,"list-item__flex-grow",i),e(t,5,0,n.myAnalyticsState===n.MYA_ITEM_VIEW_STATE),e(t,7,0,n.myAnalyticsState===n.MYA_ITEM_ADDED_STATE),e(t,9,0,n.myAnalyticsState===n.MYA_ITEM_ADDED_STATE),e(t,11,0,n.myAnalyticsState===n.MYA_ITEM_VIEW_STATE)}),null)}function xt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","document-card__menu"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__menu--hidden":0}),(e()(),i.Hb(3,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,n){var i=!0,r=e.component;return"menuToggled"===t&&(i=!1!==r.onActionsMenuToggle(n)&&i),"menuFocused"===t&&(i=!1!==(n?r.onFocus():r.onBlur())&&i),i}),T.b,T.a)),i.Gb(4,770048,[[10,4]],0,k.a,[I.a,l.a,s.a,i.o,_.c,d.a,p.a,i.K],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],area:[3,"area"],dataSecurity:[4,"dataSecurity"],leftAlignedCard:[5,"leftAlignedCard"],documentName:[6,"documentName"],actionContextMenuEnabled:[7,"actionContextMenuEnabled"],actionContextMenu:[8,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var n=t.component,i=e(t,2,0,!n.isTouch);e(t,1,0,"document-card__menu",i),e(t,4,0,n.contextMenu,n.index,n.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",n.instrumentationArea,n.dataSecurityThreshold,n.leftAlignActionsMenu,n.item.fileName,n.actionContextMenuEnabled,n.actionContextMenu)}),null)}function Lt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,14,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__info--expanded":0,"document-card__info--fluent":1}),(e()(),i.qb(16777216,null,null,1,null,vt)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,St)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Pt)),i.Gb(8,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Et)),i.Gb(10,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Rt)),i.Gb(12,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,xt)),i.Gb(14,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,"borderless"===n.uiCardType,n.fluentRefresh);e(t,1,0,"document-card__info centered-flex-container",i),e(t,4,0,n.fluentRefresh&&!n.mruAppType&&!n.item.iconUrl),e(t,6,0,n.fluentRefresh&&!n.mruAppType&&n.item.iconUrl),e(t,8,0,!n.isUpcomingMeeting&&!n.isMyAnalytics),e(t,10,0,n.isUpcomingMeeting),e(t,12,0,n.isMyAnalytics),e(t,14,0,n.showActionsMenu)}),null)}function Ut(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,16,"div",[["class","document-card ms-bgc-w"]],[[24,"@recommendedCardHover",0]],[[null,"mousededHover("unhovered")&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"carousel-card":0,"document-card--no-padding":1,"document-card--motion":2,"document-card--fluent":3}),(e()(),i.qb(16777216,null,null,1,null,Re)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Le)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,ct)),i.Gb(8,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,dt)),i.Gb(10,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,ft)),i.Gb(12,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,gt)),i.Gb(14,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Lt)),i.Gb(16,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isRecommended||n.isOfficeFeed,"borderless"===n.uiCardType||n.fluentRefresh,n.recommendedNewCards,n.fluentRefresh);e(t,1,0,"document-card ms-bgc-w",i),e(t,4,0,n.showActivity&&!n.recommendedNewCards&&!n.isMyAnalytics),e(t,6,0,n.showActivity&&!n.recommendedNewCards&&n.isMyAnalytics),e(t,8,0,!n.isUpcomingMeeting&&!n.isMyAnalytics),e(t,10,0,n.isUpcomingMeeting),e(t,12,0,n.isMyAnalytics),e(t,14,0,n.recommendedNewCards),e(t,16,0,!n.recommendedNewCards)}),(function(e,t){e(t,0,0,t.component.isHovered)}))}function Nt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(1,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"],area:[8,"area"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.item.lastModifiedActivity,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.docId,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea)}),null)}function Wt(e){return i.jc(0,[(e()(),i.qb(0,null,null,0))],null,null)}function jt(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,1,null,Wt)),i.Gb(1,540672,null,0,S.o,[i.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){e(t,1,0,i.Wb(t.parent.parent,38))}),null)}function Ht(e){return i.jc(0,[(e()(),i.qb(0,null,null,0))],null,null)}function Bt(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,1,null,Ht)),i.Gb(1,540672,null,0,S.o,[i.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){e(t,1,0,i.Wb(t.parent.parent,39))}),null)}function Gt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function qt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"div",[["class","document-card--suggested-actions--fallback-background"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Yb(131072,S.b,[i.h]),i.Zb(3,{"background-color":0})],(function(e,t){var n=t.component,r=e(t,3,0,i.hc(t,1,0,i.Wb(t,2).transform(n.workloadColorPromise)));e(t,1,0,r)}),null)}function Vt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,i.Ob(1,"",t.component.thumbnailAltText,""))}))}function zt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Ob(1,"icon--suggested-actions--fallback ",t.component.suggestedActionsIcon(),""))}))}function Kt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,15,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Gt)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,qt)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(5,0,null,null,5,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),i.Gb(6,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(7,{"document-card__thumbnail-wrapper--centered":0}),(e()(),i.qb(16777216,null,null,2,null,Vt)),i.Gb(9,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),i.Yb(131072,S.b,[i.h]),(e()(),i.Hb(11,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),i.Hb(12,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview icon--suggested-actions"]],null,null,null,null,null)),(e()(),i.Hb(13,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,zt)),i.Gb(15,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,n.thumbnailLoaded),e(t,4,0,!n.thumbnailLoaded);var r=e(t,7,0,n.centerThumbnail);e(t,6,0,"document-card__thumbnail-wrapper",r),e(t,9,0,i.hc(t,9,0,i.Wb(t,10).transform(n.thumbnail))),e(t,15,0,!n.thumbnailLoaded)}),(function(e,t){var n=t.component;e(t,5,0,!n.thumbnailLoaded),e(t,13,0,i.Ob(1,"icon--suggested-actions--inner ",n.suggestedActionsIcon(),""))}))}function Zt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Qt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Ob(1,"icon--suggested-actions--fallback ",t.component.suggestedActionsIcon(),""))}))}function Xt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,17,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Zt)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(3,0,null,null,9,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),i.Gb(4,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(5,{"document-card__thumbnail-wrapper--centered":0}),i.Gb(6,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Zb(7,{"background-color":0}),(e()(),i.Hb(8,0,null,null,4,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.Gb(9,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(10,{"document-card__thumbnail-officefeed-news":0}),i.ac(11,1),i.Yb(131072,S.b,[i.h]),(e()(),i.Hb(13,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),i.Hb(14,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview icon--suggested-actions"]],null,null,null,null,null)),(e()(),i.Hb(15,0,null,null,0,"div",[],[[8,"className",0]],null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Qt)),i.Gb(17,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,n.thumbnailLoaded);var i=e(t,5,0,n.centerThumbnail);e(t,4,0,"document-card__thumbnail-wrapper",i);var r=e(t,7,0,n.item.thumbnails&&n.item.thumbnails.backgroundColor?n.item.thumbnails.backgroundColor:"transparent");e(t,6,0,r);var o=e(t,10,0,n.isNewsArticle);e(t,9,0,"document-card__thumbnail",o),e(t,17,0,!n.thumbnailLoaded)}),(function(e,t){var n=t.component;e(t,3,0,!n.thumbnailLoaded);var r=n.thumbnailSWEnabled?i.hc(t,8,0,i.Wb(t,12).transform(i.hc(t,8,0,e(t,11,0,i.Wb(t.parent.parent.parent,1),n.thumbnailUrl)))):n.thumbnailUrl;e(t,8,0,r,i.Ob(1,"",n.thumbnailAltText,"")),e(t,15,0,i.Ob(1,"icon--suggested-actions--inner ",n.suggestedActionsIcon(),""))}))}function Jt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,6,"div",[["class","document-card__thumbnail-container document-card__thumbnail-container--suggested-actions"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__thumbnail-container--recommended":0,"document-card_thumbnail-container--rounded document-card__thumbnail-container--borderless":1}),(e()(),i.qb(16777216,null,null,1,null,Kt)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Xt)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isRecommended||n.isOfficeFeed,"borderless"===n.uiCardType);e(t,1,0,"document-card__thumbnail-container document-card__thumbnail-container--suggested-actions",i),e(t,4,0,n.thumbnailApiEnabled),e(t,6,0,!n.thumbnailApiEnabled&&n.thumbnailUrl)}),null)}function Yt(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","icon--primary-action ms-fcl-bl"]],null,null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"icon--primary-action ms-fcl-bl",t.component.primaryActionIconFont,16)}),null)}function $t(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[["class","suggested-action--svg-icon ms-fcl-bl"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.checklistIcon)}))}function en(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[["class","suggested-action--svg-icon"]],[[8,"innerHTML",1]],null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"suggested-action--svg--teams":0,"ms-fcl-bl":1})],(function(e,t){var n=t.component,i=e(t,2,0,n.item.isTeamsMeeting,!n.item.isTeamsMeeting);e(t,1,0,"suggested-action--svg-icon",i)}),(function(e,t){e(t,0,0,t.component.meetingIcon)}))}function tn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"div",[["class","suggested-action--svg-icon ms-fcl-bl"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.replyIcon)}))}function nn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,n){var i=!0,r=e.component;return"menuToggled"===t&&(i=!1!==r.onActionsMenuToggle(n)&&i),"menuFocused"===t&&(i=!1!==(n?r.onFocus():r.onBlur())&&i),i}),T.b,T.a)),i.Gb(2,770048,[[10,4]],0,k.a,[I.a,l.a,s.a,i.o,_.c,d.a,p.a,i.K],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],dataSecurity:[3,"dataSecurity"],documentName:[4,"documentName"],horizontalEllipsis:[5,"horizontalEllipsis"],actionContextMenuEnabled:[6,"actionContextMenuEnabled"],actionContextMenu:[7,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var n=t.component;e(t,2,0,n.contextMenu,n.index,n.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",n.dataSecurityThreshold,n.item.fileName,!0,n.actionContextMenuEnabled,n.actionContextMenu)}),null)}function rn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,28,"div",[["class","document-card document-card--suggested-action ms-bgc-w"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,6,"div",[["class","document-card__header document-card__header--fluent"]],null,null,null,null,null)),(e()(),i.Hb(2,0,null,null,4,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(3,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],showIcon:[2,"showIcon"],person:[3,"person"],activityDeepLink:[4,"activityDeepLink"],title:[5,"title"],docId:[6,"docId"],activityDescriptionInput:[7,"activityDescriptionInput"],index:[8,"index"],fileType:[9,"fileType"],navId:[10,"navId"],numLines:[11,"numLines"],teamsDeepLink:[12,"teamsDeepLink"],area:[13,"area"],timestampAndTitleInSameLine:[14,"timestampAndTitleInSameLine"]},null),i.ac(4,1),(e()(),i.qb(16777216,null,0,1,null,Nt)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(7,0,null,null,0,"div",[["class","suggested-action--dismiss ms-fcl-bl"],["tabindex","0"]],[[8,"innerHTML",1],[8,"title",0],[1,"aria-label",0]],[[null,"click"],[null,"mouseover"],[null,"mouseleave"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.removeItem(n)&&i),"mouseover"===t&&(i=!1!==r.dismissHover(!0)&&i),"mouseleave"===t&&(i=!1!==r.dismissHover(!1)&&i),i}),null,null)),(e()(),i.qb(16777216,null,null,1,null,jt)),i.Gb(9,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Bt)),i.Gb(11,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Jt)),i.Gb(13,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(14,0,null,null,14,"div",[["class","suggested-actions-buttons-container centered-flex-container"]],null,null,null,null,null)),(e()(),i.Hb(15,0,null,null,11,"div",[["class","section__buttons-container suggested-actions-buttons-container__cta"]],null,null,null,null,null)),(e()(),i.Hb(16,0,null,null,10,"button",[["class","generic-button document-card__button--suggested-actions generic-button--fluentvnext--default"]],null,[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.onSelectPrimaryAction(n)&&i),i}),null,null)),(e()(),i.qb(16777216,null,null,1,null,Yt)),i.Gb(18,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,$t)),i.Gb(20,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,en)),i.Gb(22,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,tn)),i.Gb(24,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(25,0,null,null,1,"span",[["class","generic-button__text ms-fcl-bl"]],null,null,null,null,null)),(e()(),i.gc(26,null,["",""])),(e()(),i.qb(16777216,null,null,1,null,nn)),i.Gb(28,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=n.item.activities,o=n.item.lastViewedTime,a=!((null==n.item.activity||null==n.item.activity.people?null:n.item.activity.people.length)>0),l=i.hc(t,3,3,e(t,4,0,i.Wb(t.parent,0),(null==n.item.activity||null==n.item.activity.people?null:n.item.activity.people.length)>0&&(null==n.item.activity?null:n.item.activity.people[0])));e(t,3,1,[r,o,a,l,n.recommendedDeepLinkEnabled&&n.activityDeepLink,n.item.title,n.item.docId,n.item.activity,n.index,n.item.fileType,n.item.navigationId,2,n.recommendedTeamsLinkEnabled&&n.teamsDeepLink,n.instrumentationArea,!0]),e(t,6,0,n.item.lastModifiedActivity&&!n.item.activity),e(t,9,0,n.isUpcomingMeeting),e(t,11,0,n.isMyAnalytics),e(t,13,0,!n.isUpcomingMeeting&&!n.isMyAnalytics),e(t,18,0,n.primaryActionIconFont),e(t,20,0,!n.primaryActionIconFont&&n.showListSvg),e(t,22,0,!n.primaryActionIconFont&&n.showMeetingSvg),e(t,24,0,!n.primaryActionIconFont&&n.showReplySvg),e(t,28,0,n.showActionsMenu)}),(function(e,t){var n=t.component;e(t,7,0,n.dismissIsHover?n.dismissSquareFilled:n.dismissSquareRegular,n.dismissItemTitle,n.dismissItemTitle),e(t,26,0,n.primaryAction.title)}))}function on(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,5,"img",[["class","generic-tile__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Gb(2,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Zb(3,{"background-color":0}),i.ac(4,1),i.Yb(131072,S.b,[i.h])],(function(e,t){var n=t.component;e(t,1,0,"generic-tile__thumbnail","generic-tile__thumbnail--"+n.item.fileTypeName.toLowerCase());var i=e(t,3,0,n.item.thumbnails&&n.item.thumbnails.backgroundColor?n.item.thumbnails.backgroundColor:"transparent");e(t,2,0,i)}),(function(e,t){var n=t.component,r=i.hc(t,0,0,i.Wb(t,5).transform(i.hc(t,0,0,e(t,4,0,i.Wb(t.parent.parent.parent,1),n.thumbnailUrl))));e(t,0,0,r,i.Ob(1,"",n.thumbnailAltText,""))}))}function an(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"img",[["class","generic-tile__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onThumbnailLoad()&&i),"error"===t&&(i=!1!==r.onThumbnailError()&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Gb(2,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Zb(3,{"background-color":0})],(function(e,t){var n=t.component;e(t,1,0,"generic-tile__thumbnail","generic-tile__thumbnail--"+n.item.fileTypeName.toLowerCase());var i=e(t,3,0,n.item.thumbnails&&n.item.thumbnails.backgroundColor?n.item.thumbnails.backgroundColor:"transparent");e(t,2,0,i)}),(function(e,t){var n=t.component;e(t,0,0,n.thumbnailUrl,i.Ob(1,"",n.thumbnailAltText,""))}))}function ln(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","document-tile__icon"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null),i.Zb(2,{color:0}),(e()(),i.Hb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,C.b,C.a)),i.Gb(4,638976,null,0,w.a,[l.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.iconFontColor());e(t,1,0,i),e(t,4,0,n.iconFontClass(),"16")}),null)}function sn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[["class","document-tile__icon mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"document-tile__icon mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function cn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,10,"div",[],[[8,"hidden",0]],null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(2,{"generic-tile__images":0}),(e()(),i.qb(16777216,null,null,1,null,on)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,an)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,ln)),i.Gb(8,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,sn)),i.Gb(10,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.thumbnailLoaded);e(t,1,0,i),e(t,4,0,n.thumbnailSWEnabled),e(t,6,0,!n.thumbnailSWEnabled),e(t,8,0,n.iconFontClass()),e(t.component.thumbnailLoaded)}))}function un(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngumentIconWithSize("64x64"))}),null)}function dn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"img",[["class","document-icon--64x64"]],[[8,"src",4]],null,null,null,null))],null,(function(e,t){e(t,0,0,i.Ob(1,"",t.component.item.iconUrl,""))}))}function pn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,5,"div",[["class","generic-tile__fallback-image-container document-tile__fallback-image-container"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,4,"div",[["class","document-tile__fallback-image"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,un)),i.Gb(3,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,dn)),i.Gb(5,16384,null,0,S.k,[i.W,i.rl),e(t,5,0,n.item.iconUrl)}),null)}function fn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon is-new-icon--tile ms-fcl-tp"],["iconFontName","Glimmer"],["size","12"]],[[1,"aria-label",0]],null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,1,0,"is-new-icon is-new-icon--tile ms-fcl-tp","Glimmer","12",t.component.isNewTitle)}),(function(e,t){e(t,0,0,t.component.isNewTitle)}))}function hn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","document-tile__sharing document-tile__description__icon ms-fcl-np"],["iconFontName","People2"],["size","12"]],[[1,"aria-label",0]],null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"document-tile__sharing document-tile__description__icon ms-fcl-np","People2","12")}),(function(e,t){e(t,0,0,t.component.sharedText)}))}function mn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link document-tile__attribution"],["role","link"],["tabindex","0"]],[[1,"aria-label",0],[1,"data-href",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onPathClick(n)&&i),"keyup.enter"===t&&(i=!1!==r.onPathClick(n)&&i),i}),null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.openFolderAriaLabel,i.Ob(1,"",n.item.isEmailAttachment?n.url:n.item.attributionUrl,""),i.Ob(1,"",n.openFolderA0,t.component.shortPath)}))}function gn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,6,"div",[["class","document-tile__description"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,hn)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,mn)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,bn)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.showSharing&&(null==n.item.sharing?null:n.item.sharing.shared)),e(t,4,0,n.clickableFolderEnabled&&!!n.shortPath),e(t,6,0,!n.clickableFolderEnabled&&!!n.shortPath)}),null)}function vn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,23,"div",[["class","generic-tile"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"generic-tile--shadowed":0,"ms-bgc-nlh-h ms-bgc-nlp-a":1}),(e()(),i.Hb(3,0,null,null,4,"div",[["class","generic-tile__images_container"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,cn)),i.Gb(5,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,pn)),i.Gb(7,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(8,0,null,null,9,"div",[["class","document-tile__title-and-icons"]],null,null,null,null,null)),(e()(),i.Hb(9,0,null,null,2,"span",[],[[24,"@fadeInIsNew",0]],null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,fn)),i.Gb(11,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(12,0,null,null,5,"div",[["class","document-tile__title list-item__text--medium ms-fcl-np"]],null,null,null,null,null)),(e()(),i.Hb(13,0,[[1,0],["titleElement",1]],null,4,"span",[],null,[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,n){var r=!0;return"mouseenter"===t&&(r=!1!==i.Wb(e,16).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Wb(e,16).onMouseLeave()&&r),"click"===t&&(r=!1!==i.Wb(e,16).onClick()&&r),r}),null,null)),i.Gb(14,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(15,{"ms-fcl-tda-h mru-list-item__title--hover":0}),i.Gb(16,16384,null,0,A.a,[l.a,d.a],{area:[0,"area"]},null),(e()(),i.gc(17,null,["",""])),(e()(),i.Hb(18,0,null,null,5,"div",[["class","document-tile__description-wrapper"]],null,null,null,null,null)),(e()(),i.Hb(19,0,null,null,4,"div",[["class","document-tile__description-container"]],null,null,null,null,null)),(e()(),i.Hb(20,0,null,null,3,"ohp-activity-description",[["iconCssClass","document-tile__description__icon"],["iconSize","12"]],null,null,null,r.b,r.a)),i.Gb(21,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconCssClass:[2,"iconCssClass"],iconSize:[3,"iconSize"],activityDescriptionInput:[4,"activityDescriptionInput"],numLines:[5,"numLines"],useSolidIcon:[6,"useSolidIcon"]},null),(e()(),i.qb(16777216,null,0,1,null,gn)),i.Gb(23,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=e(t,2,0,!n.fluentRefresh,n.fluentRefresh);e(t,1,0,"generic-tile",r),e(t,5,0,n.thumbnailUrl),e(t,7,0,!n.thumbnailUrl||!n.thumbnailLoaded),e(t,11,0,n.isNew);var o=e(t,15,0,n.clickableFolderEnabled);e(t,14,0,o),e(t,16,0,n.instrumentationArea),e(t,21,0,n.showOnlyMruActivity?i.jb:n.item.activities,n.item.lastViewedTime,"document-tile__description__icon","12",n.mruActivity&&n.item.activity,1,!0),e(t,23,0,n.showSharing&&(null==n.item.sharing?null:n.item.sharinate),e(t,17,0,n.item.title)}))}function Sn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon ms-fcl-tp"],["iconFontName","Glimmer"],["size","12"]],[[1,"aria-label",0]],null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,1,0,"is-new-icon ms-fcl-tp","Glimmer","12",t.component.isNewTitle)}),(function(e,t){e(t,0,0,t.component.isNewTitle)}))}function yn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["iconFontName","People2"],["size","14"]],[[1,"aria-label",0]],null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){var n=t.component;e(t,1,0,"ms-fcl-np document-column--name__share-icon"+(n.showMobileShareAndActivity?" document-column--name__share-icon--mobile":""),"People2","14",n.sharedText)}),(function(e,t){e(t,0,0,t.component.sharedText)}))}function Cn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),i.gc(2,null,["",""]))],null,(function(e,t){var n=t.component;e(t,1,0,n.item.createdBy),e(t,2,0,n.item.createdBy)}))}function wn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["class","categories-card--center"],["size","16"]],[[1,"aria-label",0]],null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"],title:[5,"title"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.categoryIcon.categoryFontIconColor,"categories-card--center categories-listview"+(n.isCardCreateByLabel&&null!=n.item&&n.item.createdBy?" categories--padding-left":""),n.categoryIcon.categoryFontIconCssClass?n.categoryIcon.categoryFontIconCssClass:"",n.categoryIcon&&n.categoryIcon.categoryFontIcon,"16",n.categoryIcon.categoryTooltip)}),(function(e,t){e(t,0,0,t.component.categoull,null,null))],null,null)}function kn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(1,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconSize:[2,"iconSize"],activityDescriptionInput:[3,"activityDescriptionInput"],numLines:[4,"numLines"],mobileListItem:[5,"mobileListItem"],useSolidIcon:[6,"useSolidIcon"]},null),(e()(),i.qb(16777216,null,0,1,null,Tn)),i.Gb(3,540672,null,0,S.o,[i.W],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.showOnlyMruActivity?i.jb:n.item.activities,n.item.lastViewedTime,12,n.mruActivity&&n.item.activity,1,!0,!0),e(t,3,0,i.Wb(t.parent,26))}),null)}function In(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link"],["role","link"],["tabindex","0"]],[[1,"aria-label",0],[1,"data-href",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onPathClick(n)&&i),"keyup.enter"===t&&(i=!1!==r.onPathClick(n)&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.openFolderAriaLabel,i.Ob(1,"",n.item.isEmailAttachment?n.url:n.item.attributionUrl,""),i.Ob(1,"",n.openFolderAriaLabel,""),n.item.attribution)}))}function _n(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),i.tem.emailReference.Subject)}))}function An(e){return i.jc(0,[(e()(),i.Hb(0,0,[[4,0],["attributionElement",1]],null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.item.attribution)}))}function Pn(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,1,null,In)),i.Gb(1,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,_n)),i.Gb(3,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,An)),i.Gb(5,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component;e(t,1,0,n.clickableFolderEnabled&&!n.item.isEmailAttachment&&n.item.attribution),e(t,3,0,n.item.isEmailAttachment),e(t,5,0,!n.clickableFolderEnabled&&n.item.attribution)}),null)}function En(e){return i.jc(0,[(e()(),i.Hb(0,0,[[7,0],["shareTopLevel",1]],null,5,"span",[["aria-haspopup","true"],["class","commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onShareClick(n,"topLevel",r.ShareControlMode.Share)&&i),"keyup.enter"===t&&(i=!1!==r.onShareClick(n,"topLevel",r.ShareControlMode.Share)&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"commanding-item--responsive":0,"commanding-item--disabled":1,"column--commanding-mobile":2}),i.Gb(3,4210688,null,0,P.a,[i.o,i.K,E.b],null,null),(e()(),i.Hb(4,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Share2"],["size","16"]],null,null,null,C.b,C.a)),i.Gb(5,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,!n.showMobileShareAndActivity,n.item.isLocal,n.showMobileShareAndActivity);e(t,1,0,"commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a",i),e(t,5,0,"commanding-item__icon ms-fcl-nd","Share2","16",!0)}),(function(e,t){var n=t.component;e(t,0,0,n.shareActionTitle,n.shareActionTitle)}))}function On(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"span",[["aria-haspopup","true"],["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.uploadLocal(n)&&i),"keyup.enter"===t&&(i=!1!==r.uploadLocal(n)&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.Gb(1,4210688,null,0,P.a,[i.o,i.K,E.b],null,null),(e()(),i.Hb(2,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Upload"],["size","16"]],null,null,null,C.b,C.a)),i.Gb(3,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,3,0,"commanding-item__icon ms-fcl-nd","Upload","16",!0)}),(function(e,t){var n=t.component;e(t,0,0,n.uploadLocalFileTitle,n.uploadLocalFileTitle)}))}function Fn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,5,"span",[["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.pinItem(n,"topLevel")&&i),"keyup.enter"===t&&(i=!1!==r.pinItem(n,"topLevel")&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"commanding-item--disabled":0}),i.Gb(3,4210688,null,0,P.a,[i.o,i.K,E.b],null,null),(e()(),i.Hb(4,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["size","16"]],null,null,null,C.b,C.a)),i.Gb(5,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.item.isLocal);e(t,1,0,"commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a",i),e(t,5,0,"commanding-item__icon ms-fcl-nd",n.pinActionIcon,"16",!0)}),(function(e,t){var n=t.component;e(t,0,0,n.pinActionTitle,n.pinActionTitle)}))}function Dn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"span",[["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.unpinItem(n,"topLevel")&&i),"keyup.enter"===t&&(i=!1!==r.unpinItem(n,"topLevel")&&i),"focus"===t&&(i=!1!==r.onFocus()&&i),"blur"===t&&(i=!1!==r.onBlur()&&i),i}),null,null)),i.Gb(1,4210688,null,0,P.a,[i.o,i.K,E.b],null,null),(e()(),i.Hb(2,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["size","16"]],null,null,null,C.b,C.a)),i.Gb(3,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,3,0,"commanding-item__icon ms-fcl-nd",t.component.unpinActionIcon,"16",!0)}),(function(e,t){var n=t.component;e(t,0,0,n.unpinActionTitle,n.unpinActionTitle)}))}function Mn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,12,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"column--commanding--hidden":0}),(e()(),i.qb(16777216,null,null,1,null,En)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,On)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Fn)),i.Gb(8,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Dn)),i.Gb(10,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(11,0,null,null,1,"ohp-actions-menu",[],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,n){var i=!0,r=e.component;return"menuToggled"===t&&(i=!1!==r.onActionsMenuToggle(n)&&i),"menuFocused"===t&&(i=!1!==(n?r.onFocus():r.onBlur())&&i),i}),T.b,T.a)),i.Gb(12,770048,[[10,4]],0,k.a,[I.a,l.a,s.a,i.o,_.c,d.a,p.a,i.K],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],dataSecurity:[3,"dataSecurity"],documentName:[4,"documentName"],actionContextMenuEnabled:[5,"actionContextMenuEnabled"],actionContextMenu:[6,"actionContextMenu"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var n=t.component,i=e(t,2,0,!n.isTouch);e(t,1,0,"list-item-column column--commanding",i),e(t,4,0,n.shareControlEnabled),e(t,6,0,n.item.isLocal),e(t,8,0,!n.item.isPinned&&n.mruPinEnabled),e(t,10,0,n.item.isPinned&&n.mruPinEnabled),e(t,12,0,n.contextMenu,n.index,n.fluentRefresh?"":"commanding-item__icon ms-fcl-nd",n.dataSecurityThreshold,n.item.fileName,n.actionContextMenuEnabled,ull,null,null))],null,null)}function xn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","list-item-column document-column--responses-forms"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,3,"div",[["class","list-item__text--small ms-fcl-ns"]],null,null,null,null,null)),i.Gb(2,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(3,{"list-item__last-accessed":0}),(e()(),i.gc(4,null,[" "," "]))],(function(e,t){var n=e(t,3,0,t.component.showActionsMenu);e(t,2,0,"list-item__text--small ms-fcl-ns",n)}),(function(e,t){e(t,4,0,t.component.borderlessCardDetail1)}))}function Ln(e){return i.jc(0,[(e()(),i.Hb(0,0,[[5,0],["timestampElement",1]],null,4,"div",[["class","list-item__text--small ms-fcl-ns"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"list-item__last-accessed":0}),(e()(),i.gc(3,null,[" "," "])),i.ac(4,4)],(function(e,t){var n=e(t,2,0,t.component.showActionsMenu);e(t,1,0,"list-item__text--small ms-fcl-ns",n)}),(function(e,t){var n=t.component,r=i.hc(t,3,0,e(t,4,0,i.Wb(t.parent.parent,2),n.displayTime,n.shortDate,n.displayTimeString,!1));e(t,3,0,r)}))}function Un(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[["class","activity-user-name sharing-column-name ms-fcl-nd"]],[[8,"title",0]],null,null,null,null)),i.Gb(1,212992,null,0,y.a,[i.o,h.a],{upn:[0,"upn"]},null),(e()(),i.gc(2,null,[" "," "]))],(function(e,t){e(t,1,0,t.component.item.sharedByEmail)}),(function(e,t){var n=t.component;e(t,0,0,i.Ob(1,"",n.item.sharedByUsername,"")),e(t,2,0,n.item.sharedByUsername)}))}function Nn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["aria-hidden","true"],["cssClass","document-column--sharing__share-icon ms-fcl-np"],["iconFontName","People2"],["size","14"]],null,null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"document-column--sharing__share-icon ms-fcl-np","People2","14")}),null)}function Wn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Nn)),i.Gb(2,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(3,0,null,null,3,"div",[["class","list-item__text--small sharing-column--text ms-fcl-ns"]],[[8,"title",0]],null,null,null,null)),i.Gb(4,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(5,{"sharing-column--text-shared":0}),(e()(),i.gc(6,null,[" "," "]))],(function(e,t){var n=t.component;e(t,2,0,null==n.item.sharing?null:n.item.sharing.shared);var i=e(t,5,0,null==n.item.sharing?null:n.item.sharing.shared);e(t,4,0,"list-item__text--small sharing-column--text ms-fcl-ns",i)}),(function(e,t){var n=t.component;e(t,3,0,i.Ob(1,"",n.item.sharing?n.item.sharing.shared?n.sharedText:n.privateText:"","")),e(t,6,0,n.item.sharing?n.item.sharing.shared?n.sharedText:n.privateText:"")}))}function jn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,6,"div",[["class","list-item-column"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-column--sharing":0,"document-column--sharing--right":1}),(e()(),i.qb(16777216,null,null,1,null,Un)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Wn)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.showActivity,!n.showActivity);e(t,1,0,"list-item-column",i),e(t,4,0,"shared-mru"===n.listId),e(t,6,0,"shared-mru"!==n.listId)}),null)}function Hn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,r.b,r.a)),i.Gb(1,5226496,null,0,o.a,[a.a,l.a,i.h,s.a,c.b,u.a,d.a,p.a,f.a,h.a,m.a,b.a,g.a,v.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],activityDescriptionInput:[2,"activityDescriptionInput"],numLines:[3,"numLines"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.showOnlyMruActivity?i.jb:n.item.activities,n.item.lastViewedTime,n.mruActivity&&n.item.activity,n.mruActivity&&n.item.activity?2:void 0)}),null)}function Bn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"div",[["class","list-item-column document-column--activity"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-column--activity-hidden":0}),(e()(),i.qb(16777216,null,null,1,null,Hn)),i.Gb(4,16384,null,0,S.k,[i.W,i.,e(t,4,0,n.activityEnabled)}),null)}function Gn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[["class","list-item-column document-column--analytics document-analytics-container"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-analytics-description",[],null,[[null,"updateAriaLabel"]],(function(e,t,n){var i=!0;return"updateAriaLabel"===t&&(i=!1!==e.component.onAnalyticsDescriptionChanged(n)&&i),i}),M,F)),i.Gb(2,573440,null,0,O,[p.a],{analytics:[0,"analytics"]},{updateAriaLabel:"updateAriaLabel"})],(function(e,t){e(t,2,0,t.component.item.analytics)}),null)}function qn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,43,"div",[["class","centered-flex-container list-item__height-restrictor"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,25,"div",[["class","list-item-column"]],null,null,null,null,null)),i.Gb(2,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Xb(3,3),(e()(),i.Hb(4,0,[[3,0],["fileIconElement",1]],null,0,"div",[],[[8,"className",0],[1,"title",0]],null,null,null,null)),(e()(),i.Hb(5,0,null,null,21,"div",[["class","clip"]],null,null,null,null,null)),(e()(),i.Hb(6,0,null,null,11,"div",[["class","centered-flex-container"]],null,null,null,null,null)),(e()(),i.Hb(7,0,null,null,5,"div",[["class","list-item__text--large list-item__title ms-fcl-nd"]],null,null,null,null,null)),(e()(),i.Hb(8,0,[[1,0],["titleElement",1]],null,4,"span",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,n){var r=!0;return"mouseenter"===t&&(r=!1!==i.Wb(e,11).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Wb(e,11).onMouseLeave()&&r),"click"===t&&(r=!1!==i.Wb(e,11).onClick()&&r),r}),null,null)),i.Gb(9,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(10,{"ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),i.Gb(11,16384,null,0,A.a,[l.a,d.a],{area:[0,"area"]},null),(e()(),i.gc(12,null,["",""])),(e()(),i.Hb(13,0,null,null,2,"span",[],[[24,"@fadeInIsNew",0]],null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Sn)),i.Gb(15,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,yn)),i.Gb(17,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(18,0,null,null,8,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),i.Hb(19,0,null,null,4,"div",[["style","display: flex"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Cn)),i.Gb(21,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,wn)),i.Gb(23,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,kn)),i.Gb(25,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(e()(),i.qb(0,[["showPath",2]],null,0,null,Pn)),(e()(),i.qb(16777216,null,null,1,null,Mn)),i.Gb(28,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Rn)),i.Gb(30,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,xn)),i.Gb(32,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(33,0,null,null,4,"div",[["class","list-item-column"]],null,null,null,null,null)),i.Gb(34,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(35,{"document-column--last-opened":0,"document-column--last-opened--right":1,"document-column--last-opened--subset":2}),(e()(),i.qb(16777216,null,null,1,null,Ln)),i.Gb(37,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,jn)),i.Gb(39,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Bn)),i.Gb(41,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Gn)),i.Gb(43,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=e(t,3,0,"document-column--name"+(n.showActivity||n.showAnalytics?"":"--subset"),n.mruAppSuffix?"document-column--name"+n.mruAppSuffix:"",n.showMobileShareAndActivity?"document-column--name-mobile":"");e(t,2,0,"list-item-column",r);var o=e(t,10,0,n.clickableFolderEnabled);e(t,9,0,o),e(t,11,0,n.instrumentationArea),e(t,15,0,n.isNew),e(t,17,0,n.showSharing&&(null==n.item.sharing?null:n.item.sharing.shared)),e(t,21,0,n.isCardCreateByLabel&&(null==n.item?null:n.item.createdBy)),e(t,23,0,n.categoryIcon&&n.categoryIcon.categoryFontIcon),e(t,25,0,n.showMobileShareAndActivity,i.Wb(t,26)),e(t,28,0,n.showActionsMenu),e(t,30,0,!n.showActionsMenu),e(t,32,0,n.isFormResponsesEnabled);var a=e(t,35,0,n.showActivity||n.showAnalytics,!n.showSharing&&!n.showActivity&&!n.showAnalytics,n.showSharing&&!n.showActivity&&!n.showAnalytics);e(t,34,0,"list-item-column",a),e(t,37,0,n.displayTime),e(t,39,0,n.showSharing),e(t,41,0,n.showActivity),e(t,43,0,n.showAnalytics)}),(function(e,t){var n=t.component;e(t,4,0,i.Ob(1,"list-item__icon ",n.item.documentIcon,""),n.item.fileTypeName),e(t,8,0,n.item.title),e(t,12,0,n.item.title),e(t,13,0,n.isNewAnimationState)}))}function Vn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),i.Hb(1,0,[[6,0],["shareControl",1]],null,5,"div",[["class","share-control"]],null,null,null,null,null)),i.Gb(2,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(3,{"mru-list-item__share-control mru-list-item__share-control--columns":0}),(e()(),i.Hb(4,16777216,null,null,2,null,null,null,null,null,null,null)),i.Gb(5,475136,null,0,R.a,[x.a,i.W,d.a,L.b,U.a,N.a,W.a,i.F,j.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"],outputs:[2,"outputs"]},null),i.Zb(6,{file:0,index:1,mode:2})],(function(e,t){var n=t.component,i=e(t,3,0,n.showAsListItem());e(t,2,0,"share-control",i);var r=e(t,6,0,n.item,n.index,n.shareControlMode);e(t,5,0,"share-control#ShareControlModule",r,n.shareControlOutputs)}),null)}function zn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__title upcomingMeeting-card__title--suggested_action"]],[[8,"title",0]],null,null,null,null)),(e()(),i.gc(1,null,[" "," "]))],null,(function(e,t){var n=t.component;e(t,0,0,n.item.title),e(t,1,0,n.item.title)}))}function Kn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__location"]],[[8,"title",0]],null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card__location__icon"],["iconFontName","Location"],["size","16"]],null,null,null,C.b,C.a)),i.Gb(2,638976,null,0,w.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()ion__icon","Location","16")}),(function(e,t){var n=t.component;e(t,0,0,n.item.location),e(t,3,0,n.item.location)}))}function Zn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"ohp-person-picture",[],null,null,null,H.b,H.a)),i.Gb(1,573440,null,0,B.a,[G.a],{person:[0,"person"],isUpcomingMeeting:[1,"isUpcomingMeeting"],status:[2,"status"]},null),i.ac(2,1)],(function(e,t){var n=i.hc(t,1,0,e(t,2,0,i.Wb(t.parent.parent.parent,3),null==t.parent.context.$implicit?null:t.parent.context.$implicit.emailAddress));e(t,1,0,n,!0,null==t.parent.context.$implicit||null==t.parent.context.$implicit.status?null:t.parent.context.$implicit.status.response)}),null)}function Qn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"div",[["class","upcomingMeeting-card__attendees__position"]],null,null,null,null,null)),i.Gb(1,212992,null,0,y.a,[i.o,h.a],{upn:[0,"upn"]},null),(e()(),i.qb(16777216,null,null,1,null,Zn)),i.Gb(3,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.context.$implicit.emailAddress.address),e(t,3,0,null==t.context.$implicit?null:t.context.$implicit.emailAddress)}),null)}function Xn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[["aria-hidden","true"],["class","person-picture-upcoming-meeting__display "]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"div",[["class","person-picture-upcoming-meeting__text person-picture-upcoming-meeting__placeholder__text"]],null,null,null,null,null)),(e()(),i.gc(2,null,[" +"," "]))],null,(function(e,t){var n=t.component;e(t,2,0,(null==n.item.attendees?null:n.item.attendees.length)-n.upcomingMeetingAttendeeDisplayMax)}))}function Jn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,16,"div",[["class","document-card__thumbnail-container upcomingMeeting-card__details"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__thumbnail-container--suggested-actions":0}),(e()(),i.Hb(3,0,null,null,2,"div",[],null,null,null,null,null)),i.Gb(4,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(5,{"upcomingMeeting-card__left_rectangle":0,"upcomingMeeting-card__left_rectangle_dashed":1}),(e()(),i.qb(16777216,null,null,1,null,zn)),i.Gb(7,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(8,0,null,null,1,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__time"]],null,null,null,null,null)),(e()(),i.gc(9,null,[" "," - "," "])),(e()(),i.qb(16777216,null,null,1,null,Kn)),i.Gb(11,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(12,0,null,null,4,"div",[["class","upcomingMeeting-card__attendees"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,Qn)),i.Gb(14,278528,null,0,S.j,[i.W,i.S,i.x],{ngForOf:[0,"ngForOf"]},null),(e()(),i.qb(16777216,null,null,1,null,Xn)),i.Gb(16,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fluentRefresh);e(t,1,0,"document-card__thumbnail-container upcomingMeeting-card__details",i);var r=e(t,5,0,n.isUpcomingMeetingAccepted,!n.isUpcomingMeetingAccepted);e(t,4,0,r),e(t,7,0,n.item.title),e(t,11,0,n.item.location),e(t,14,0,null==n.item.attendees?null:n.item.attendees.slice(0,n.upcomingMeetingAttendeeDisplayMax)),e(t,16,0,n.upcomingMeetingAttendeeDisplayMax<(null==n.item.attendees?null:m.startTime,n.item.endTime)}))}function Yn(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[["class","myAnalytics-card_icon"],["iconFontName","Outlook"],["size","24"]],null,null,null,C.b,C.a)),i.Gb(1,638976,null,0,w.a,[l.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){e(t,1,0,"Outlook","24")}),null)}function $n(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"span",[["class","myAnalytics-card_title ms-fcl-bl"]],[[8,"title",0]],null,null,null,null)),(e()(),itle),e(t,1,0,n.item.title)}))}function ei(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"div",[["class","document-card__icon-container ms-bgc-w"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-icon-font",[["iconFontName","Outlook"],["size","20"]],null,null,null,C.b,C.a)),i.Gb(2,638976,null,0,w.a,[l.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){e(t,2,0,"Outlook","20")}),null)}function ti(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,17,"div",[["class","document-card__thumbnail-container"]],null,null,null,null,null)),i.Gb(1,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"document-card__thumbnail-container--suggested-actions document-card__thumbnail-container--myAnalytics":0}),(e()(),i.qb(16777216,null,null,1,null,Yn)),i.Gb(4,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,$n)),i.Gb(6,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(7,0,null,null,8,"div",[],null,null,null,null,null)),(e()(),i.Hb(8,0,null,null,7,"span",[["class","myAnalytics-card_text__messageBy ms-fcl-bl"]],null,null,null,null,null)),i.Gb(9,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(10,{"myAnalytics-card_text__messageBy--suggested-action":0}),(e()(),i.gc(11,null,[" ",", "])),(e()(),i.Hb(12,0,null,null,3,"span",[["class","myAnalytics-card_text"]],[[8,"title",0]],null,null,null,null)),i.Gb(13,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(14,{"ms-fcl-bl":0,"myAnalytics-card_text--suggested-action":1}),(e()(),i.gc(15,null,["",""])),(e()(),i.qb(16777216,null,null,1,null,ei)),i.Gb(17,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.showAsSuggestedAction()||n.fluentRefresh);e(t,1,0,"document-card__thumbnail-container",i),e(t,4,0,!n.showAsSuggestedAction()),e(t,6,0,!n.showAsSuggestedAction());var r=e(t,10,0,n.showAsSuggestedAction());e(t,9,0,"myAnalytics-card_text__messageBy ms-fcl-bl",r);var o=e(t,14,0,!n.showAsSuggestedAction(),n.showAsSuggestedAction());e(t,13,0,"myAnalytics-card_text",o),e(t,17,0,n,n.item.insightDescription)}))}function ni(e){return i.jc(0,[i.Yb(0,q.a,[]),i.Yb(0,X,[Z.a,c.b,K.a,z.a]),i.Yb(0,m.a,[J.a,p.a,Y.a]),i.Yb(0,$,[]),i.cc(671088640,1,{titleElement:0}),i.cc(671088640,2,{mruListItem:0}),i.cc(671088640,3,{fileIconElement:0}),i.cc(671088640,4,{attributionElement:0}),i.cc(671088640,5,{timestampElement:0}),i.cc(671088640,6,{shareControl:0}),i.cc(671088640,7,{shareTopLevelElement:0}),i.cc(671088640,8,{myAnalyticsAddToDoElement:0}),i.cc(671088640,9,{myAnalyticsTaskDoneElement:0}),i.cc(671088640,10,{actionsMenuElement:0}),(e()(),i.Hb(14,0,null,null,23,"div",[["class","list-item__body mru-item__body"]],,16).onContextMenu(n)&&r),r}),null,null)),i.Gb(15,81920,null,0,ee,[I.a,_.c],{model:[0,"model"],disabled:[1,"disabled"]},null),i.Gb(16,81920,null,0,te.a,[ne.a,_.c],{model:[0,"model"],disabled:[1,"disabled"]},null),(e()(),i.qb(16777216,null,null,1,null,De)),i.Gb(18,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(19,0,[[2,0],["mruListItem",1]],null,16,"a",[["class","mru-list-item"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"click"],[null,"focus"],[null,"blur"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,n){var r=!0,o=e.component;return"mouseenter"===t&&(r=!1!==i.Wb(e,24).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Wb(e,24).onMouseLeave()&&r),"mouseenter"===t&&(r=!1!==i.Wb(e,26).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==i.Wb(e,26).onMouseLeave()&&r),"click"===t&&(r=!1!==o.onItemClick(n)&&r),"focus"===t&&(r=!1!==o.onFocus()&&r),"blur"===t&&(r=!1!==o.onBlur()&&r),r}),null,null)),i.Gb(20,278528,null,0,S.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(21,{"list-item__focused":0,"mru-list-item__padding":1,"mru-list-item__padding--mobile":2,"mru-list-item--local":3}),i.Gb(22,81920,null,0,ie.a,[re.a],null,null),i.Gb(23,4210688,null,0,oe.a,[i.o,i.h],{focusOnLoad:[0,"focusOnLoad"]},null),i.Gb(24,16384,null,0,ae.a,[l.a,g.a],{hoverDelay:[0,"hoverDelay"],itemInfo:[1,"itemInfo"]},null),i.Zb(25,{item:0,wdOriginType:1}),i.Gb(26,16384,null,0,le.a,[l.a,g.a],{hoverDelay:[0,"hoverDelay"],itemInfo:[1,"itemInfo"]},null),i.Zb(27,{item:0,wdOriginType:1}),(e()(),i.qb(16777216,null,null,1,null,Ut)),i.Gb(29,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,rn)),i.Gb(31,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,vn)),i.Gb(33,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,qn)),i.Gb(35,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Vn)),i.Gb(37,16384,null,0,S.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(0,[["upcomingMeetingTitle",2]],null,0,null,Jn)),(e()(),i.qb(0,[["myAnalyticsTitle",2]],null,0,null,ti))],(function(e,t){var n=t.component;e(t,15,0,n.actionContextMenu,!n.actionContextMenuEnabled),e(t,16,0,n.contextMenu,n.actionsMenuOpen||n.actionContextMenuEnabled),e(t,18,0,n.mruItemState===n.MRU_ITEM_LOADING_STATE);var i=e(t,21,0,n.itemFocused||n.actionsMenuOpen,n.showAsListItem(),n.showAsListItem()&&n.showMobileShareAndActivity,n.item.isLocal);e(t,20,0,"mru-list-item",i),e(t,22,0),e(t,23,0,n.focusOnLoad);var r=n.wacHostHoverPrebootEnabled?500:n.showAsCard()?200:150,o=e(t,25,0,n.item,n.getWdOriginTaskForClick());e(t,24,0,r,o);var a=n.wacHostHoverPrebootEnabled?500:n.showAsCard()?200:150,l=e(t,27,0,n.item,n.getWdOriginTaskForClick());e(t,26,0,a,l),e(t,29,0,n.showAsCard()),e(t,31,0,n.showAsSuggestedAction()&&n.primaryAction),e(t,33,0,n.showAsTile()),e(t,35,0,n.showAsListItem()),e(t,37,0,n.showDesktopShareControl)}),(function(e,t){var n=t.component;e(t,19,0,n.listId+"-"+n.item.id,i.Ob(1,"",n.url,""),n.descriptiveAriaLabel,i.Wb(t,22).target)}))}i.Db("ohp-mru-item",pe.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"ohp-mru-item",[],null,null,null,ni,Fe)),i.bc(512,null,se.a,se.a,[p.a,re.a,ce.a,ue.a,u.a,de.a,L.b]),i.Gb(2,770048,null,0,pe.a,[a.a,l.a,L.b,fe.a,re.a,J.a,_.c,s.a,c.b,u.a,d.a,he.a,p.a,me.a,f.a,se.a,be.a,ge.a,ve.a,Se.a,ye.b,i.K,m.a,Ce.b,we.a,Te.a,b.a,ke.a,g.a,v.b,Ie.a,_e.a,Ae.a,Pe.a,Ee.b,Oe.a],null,null)],(function(e,t){e(t,2,0)}),null)}),{item:"item",index:"index",relativeIndex:"relativeIndex",view:"view",listId:"listId",focusOnLoad:"focusOnLoad",showActivity:"showActivity",showSharing:"showSharing",showAnalytics:"showAnalytics",mruAppType:"mruAppType",leftAlignActionsMenu:"leftAlignActionsMenu"},{addItem:"addItem",deleteItem:"deleteItem",changePinState:"changePinState"},[])},"A/um":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Accepted=1]="Accepted",e[e.Access=2]="Access",e[e.AccountActivity=3]="AccountActivity",e[e.Add=4]="Add",e[e.AddTo=5]="AddTo",e[e.Alert=6]="Alert",e[e.ArrowLeft=7]="ArrowLeft",e[e.ArrowRight=8]="ArrowRight",e[e.At=9]="At",e[e.Attach=10]="Attach",e[e.Calendar=11]="Calendar",e[e.Chat=12]="Chat",e[e.CheckMark=13]="CheckMark",e[e.ChevronDown=14]="ChevronDown",e[e.ChevronLeft=15]="ChevronLeft",e[e.ChevronRight=16]="ChevronRight",e[e.ChevronUp=17]="ChevronUp",e[e.CircleEmpty=18]="CircleEmpty",e[e.CircleInfo=19]="CircleInfo",e[e.Comment=20]="Comment",e[e.Compass=21]="Compass",e[e.ContactCardSettings=22]="ContactCardSettings",e[e.Copy=23]="Copy",e[e.Declined=24]="Declined",e[e.Delete=25]="Delete",e[e.Devices3=26]="Devices3",e[e.Diamond=27]="Diamond",e[e.Document=28]="Document",e[e.Download=29]="Download",e[e.Ellipsis=30]="Ellipsis",e[e.Excel=31]="Excel",e[e.FavoriteStar=32]="FavoriteStar",e[e.Filter=33]="Filter",e[e.FilterSolid=34]="FilterSolid",e[e.Folder=35]="Folder",e[e.FolderOpen=36]="FolderOpen",e[e.GiftCard=37]="GiftCard",e[e.Group=38]="Group",e[e.Hide=39]="Hide",e[e.HighLander=40]="HighLander",e[e.Link=41]="Link",e[e.ListBullets=42]="ListBullets",e[e.Location=43]="Location",e[e.Mail=44]="Mail",e[e.Minus=45]="Minus",e[e.Move=46]="Move",e[e.News=47]="News",e[e.Office2=48]="Office2",e[e.OfficeForms=49]="OfficeForms",e[e.OfficeStore=50]="OfficeStore",e[e.OfficeThreshold=51]="OfficeThreshold",e[e.OneDrive=52]="OneDrive",e[e.Onenote2=53]="Onenote2",e[e.Outlook=54]="Outlook",e[e.Page=55]="Page",e[e.Pencil=56]="Pencil",e[e.PencilSolid=57]="PencilSolid",e[e.People2=58]="People2",e[e.Permissions=59]="Permissions",e[e.SharePoint=60]="SharePoint",e[e.Person=61]="Person",e[e.PhotoVideoMedia=62]="PhotoVideoMedia",e[e.PinDown=63]="PinDown",e[e.PlayerSettings=64]="PlayerSettings",e[e.PlaylistMusic=65]="PlaylistMusic",e[e.Placeholder=66]="Placeholder",e[e.PollResults=67]="PollResults",e[e.PowerBI=68]="PowerBI",e[e.PowerPoint=69]="PowerPoint",e[e.Preview=70]="Preview",e[e.PreviewLink=71]="PreviewLink",e[e.Project=72]="Project",e[e.Publisher=73]="Publisher",e[e.Question=74]="Question",e[e.Restore=75]="Restore",e[e.Save=76]="Save",e[e.Search=77]="Search",e[e.Settings=78]="Settings",e[e.Share2=79]="Share2",e[e.SkypeForBusiness=80]="SkypeForBusiness",e[e.SortDown=81]="SortDown",e[e.SortUp=82]="SortUp",e[e.Stream=83]="Stream",e[e.Sway=84]="Sway",e[e.Sync=85]="Sync",e[e.System=86]="System",e[e.Task=87]="Task",e[e.Teams=88]="Teams",e[e.TentativelyAccepted=89]="TentativelyAccepted",e[e.TextDocument=90]="TextDocument",e[e.TileView=91]="TileView",e[e.ToDo=92]="ToDo",e[e.Trending=93]="Trending",e[e.Unfavorite=94]="Unfavorite",e[e.Unpin=95]="Unpin",e[e.Video=96]="Video",e[e.Visio=97]="Visio",e[e.Upload=98]="Upload",e[e.Waffle=99]="Waffle",e[e.Word=100]="Word",e[e.X=101]="X",e[e.X2=102]="X2"}(i||(i={}))},AGMK: r(){return"visible"===i()}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}))},AXqk:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"AY/E":function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var i=n("31lE"),r=n("laSs"),o=n("Dn7E"),a=n("mXGw"),l=n("xARA"),s=n("hhzZ"),c=n("4/We"),u=n("cgnd"),d=n("/I02"),p=n("JH4S"),f=n("kpuN"),h=n("Bc8L"),m=n("dFxn"),b=n("keVe"),g=function(){function e(e){this.config=e.parse("peopleCardConfig")}return e.ɵprov=b.kc({factory:function(){return new e(b.lc(m.a))},token:e,providedIn:"root"}),e}(),v=n("Uqr9"),S=n("casz"),y=n("w1PR"),C=n("TIi1"),w=n("BMb5"),T=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p){var f=this;if(this.accessTokenService=e,this.capabilitiesService=t,this.contextService=n,this.startupConfigService=i,this.instrumentationService=r,this.peopleCardConfigService=o,this.localAppLauncherService=a,this.urlLauncherService=l,this.windowService=s,this.scheduler=c,this.ngZone=u,this.themingService=d,this.userContextService=p,this.peopleCount=0,this.capabilitiesService.capabilities.darkModeEnabled){var h="rgba(255,255,255,0.75)";this.darkTheme={palette:{themeDarker:h,themeDark:h,themeDarkAlt:h,themePrimary:h,themeSecondary:h,themeTertiary:h,themeLight:h,themeLighter:h,themeLighterAlt:h,black:"#ffffff",blackTranslucent40:"rgba(255, 255, 255, 0.40)",neutralDark:"#ffffff",neutralPrimary:"#f8f8f8",neutralPrimaryAlt:"#f4f4f4",neutralSecondary:"#eaeaea",neutralTertiary:"#a6a6a6",neutralTertiaryAlt:"#767676",neutralQuaternary:"#6b6b6b",neutralQuaternaryAlt:"#707070",neutralLight:"#666666",neutralLighter:"#333333",neutralLighterAlt:"#212121",accent:h,white:"#333333",whiteTranslucent40:"rgba(0, 0, 0, 0.40)"}},this.darkModeSubscription=this.themingService.darkModeSubscription.subscribe((function(e){f.isDarkMode=e,f.lpc&&f.lpc.loadTheme(f.isDarkMode?f.darkTheme:void 0)}))}}return e.prototype.addPersonaCard=function(e,t){var n=this;return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.ngZone.runOutsideAngular((function(){return n.bootstrap().then((function(){n.lpc&&(n.lpc.addedPersonaToPageV2(e,{personaInfo:{identifiers:{Smtp:t,PersonaType:"User"}},externalAppSessionCorrelationId:n.startupConfigService.config.sharedClientStartupContext.correlationId,behavior:{onCardOpen:function(){var o={};o.ElementId=e.id,o.ItemId=new s.d(t,i.AWTPiiKind.SmtpAddress),n.instrumentationService.logImpressionEvent("People_Card_Impression",o),Object(r.a)({eventName:"People_Card",area:"PeopleCard",id:e.id})},onCardClose:null,disableHover:!1}}),n.peopleCount++)}))})):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")},e.prototype.addPersonaCardElement=function(e,t,n,o){var c=this;return void 0===n&&(n=""),void 0===o&&(o=!0),this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.ngZone.runOutsideAngular((function(){return c.bootstrap().then((function(){if(c.lpc){var u={cardParameters:{personaInfo:{identifiers:{AadObjectId:t,PersonaType:"User",Smtp:n}},externalAppSessionCorrelationId:c.startupConfigService.config.sharedClientStartupContext.correlationId,behavior:{onCardOpen:function(){var n={};n.ElementId=e.id,n.ItemId=new s.d(t,i.AWTPiiKind.Identity),c.instrumentationService.logImpressionEvent("People_Card_Impression",n),Object(r.a)({eventName:"People_Card",area:"PeopleCard",id:e.id})},locationToOpen:o?"ExpandedView":"Card"}}};l.render(a.createElement(c.windowService.nativeWindow.LivePersonaCardHoverTargetV2,u,a.createElement("div",{id:"personCardClickElement"})),e)}}))})):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")},e.prototype.removePersonaCard=function(e,t){var n=this;return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.initPromise?this.ngZone.runOutsideAngular((function(){return n.initPromise.then((function(){n.lpc&&(n.lpc.removedPersonaFromPage(e,t),n.peopleCount--)}))})):Promise.reject("removePersonaCard is called without calling addPersonaCard first"):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")},e.prototype.bootstrap=function(){var e=this;if(!this.initPromise)if(this.peopleCardConfigService.config){this.startTime=v.a.now();var t={actionCallbacks:this.capabilitiesService.capabilities.pwaEnabled?{openDocument:function(t){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchApp({action:"OpenDocument",appName:t.TError("faon:"OpenDocFromPeopleCard"})}))})):e.localAppLauncherService.launchOfficeApError("faUrl,"OpenDocFromPeopleCard")}))},composeMail:function(t){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl("mailto:"+t,{action:"EmailFromPeopleCard"})})):e.urlLauncherService.openUrl("mailto:"+t,"EmailFromPeopleCard")},startChat:function(t){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).thn:"OpenChatFromPeopleCard"})})):e.urlLauncherService.openUrl(t.imAddressUrl,"OpenChatFromPeopleCard")},handleContactNumber:function(t){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl("tel:"+t,{action:"HandleNumberFromPeopleCard"})})):e.urlLauncherService.openUrl("tel:"+t,"HandleNumberFromPeopleCard")}}:void 0,culture:this.contextService.sharedContext.officeMarket,region:this.peopleCardConfigService.config.region,clientType:this.peopleCardConfigService.config.clientType,clientContextType:this.peopleCardConfigService.config.clientContextType,clientCorrelationId:this.startupConfigService.config.sharedClientStartupContext.correlationId,getAuthToken:function(t,n){e.getAuthToken((function(i,r){i?t(i,e.startupConfigService.config.sharedClientStartupContext.correlationId):n(r,e.startupConfigService.config.sharedClientStartupContext.correlationId)}))},isConsumer:this.startupConfigService.config.authType===u.a.MSA,complianceEnvironment:this.getLpcEnvironment(),theme:this.isDarkMode?this.darkTheme:void 0},i=new Promise((functionimportBootstrapper().then(t)}),4)}));this.initPromise=i.then((function(n){var i=n.initializeLivePersonaCardAsync;return new Promise((function(n,r){e.scheduler.scheduleWork((function(){i(t).then((function(){return n(null)})).catch(r)}),4)}))})).then((function(){e.windowService.ensureZoneJs(),e.lpc=e.windowService.nativeWindow.LPC;var t=v.a.now()-e.startTime;e.instrumentInitialization("Start",t)}),(function(t){e.windowService.ensureZoneJs();var n=v.a.now()-e.startTime;e.instrumentInitialization("Error",n,t)}))}else this.initPromise=Promise.reject("peopleCardConfigService.config is not defined");return this.initPromise},e.prototype.population=function(){return this.peopleC|void 0===e||e.unsubscribe()},e.prototype.instrumentInitialization=function(t,n,i){var r={};r.State=t,r.Latency=Math.ceil(n).toString(),i&&(r.Error="string"==typeof i&&0===i.indexOf(e.errorPrefix)?i:""),this.instrumentationService.logGenericEvent("People_Card_Initialization",r),Object(o.a)({featureName:"PeopleCard",eventName:"People_Card_Initialization",params:r})},e.prototype.getAuthToken=function(e){this.accessTokenService.getAccessToken("Loki").then((function(t){e(t.token,t.error?"Error : "+t.error:"")}))},e]).then(n.bind(null,"Y1uq"))},e.prototype.getLpcEnvironment=function(){var e=this.peopleCardConfigService.config.complianceEnvironment;return this.userContextService.user.isGcc&&"Prod"===e?"GccModerate":e},e.errorPrefix="LPCError: ",e.ɵprov=b.kc({factory:function(){return new e(b.lc(f.b),b.lc(c.a),b.lc(d.a),b.lc(u.b),b.lc(s.a),b.lc(g),b.lc(h.a),b.lc(C.a),b.lc(w.b),b.lc(S.a),b.lc(b.F),b.lc(y.b),b.lc(p.a))},token:e,providedIn:"root"}),e}()},Ax7d:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("f0qX"),r=n("BaAg"),o=n("dFxn"),a=n("keVe"),l=n("RuSG"),s=function(){function e(e,t){this.breakpointObserver=t,this.manifestData=e.parse("webManifestConfig")||{name:null,short_name:null,start_url:null,scope:null,display:null,orientation:null,icons:[],background_color:null,theme_color:null},this.isStandalone=this.breakpointObserver.observe("(display-mode: standalone)").pipe(Object(i.a)((function(e){return e.matches})))}return ethis.manifestData.short_ice"===this.manifestDataeturn!!this.manifestData.name},e.ɵprov=a.kc({factory:function(){return new e(a.lc(o.a),a.lc(l.a))},token:e,providedIn:"root"}),e}()},BJFG:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("Bc8L"),r=n("Z0U4"),o=n("TIi1"),a=n("keVe"),l=function(){function e(e,t,n){this.localAppLauncherService=e,this.urlLauncherService=t,this.officeRouteService=n}return e.prototype.launchApp=function(e,t,n,i){var r=this;return void 0===i&&(i=!1),this.localAppLauncherService.launchOfficeApp(e.Text,"",!t||t.defaultPrevented||i?null:function(){return t.preventDefault()}).then((function(i){return i?"Native":r.launchO r.launchOfficeWebApp(e,t,i,n)}))},e.prototype.launchOfficeWebApp=function(e,t,n,i){return e.InAppNav&&e.FileType?(!t||t.defaultPrevented||n||t.preventDefault(),this.officeRouteService.navigateTo({route:"Start",app:e.FileType}),Promise.resolve("StartPage")):n||!t||t.defaultPrevented?this.urlLauncherService.openUrl(e.Url,i).then((function(){return"Web"}),(function(){})):Promise.resolve("Web")},e.ɵprov=a.kc({factory:function(){return new e(a.lc(i.a),a.lc(o.a),a.lc(r.a))},token:e,providedIn:"root"}),e}()},BJbw:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("cgnd"),r=n("ZBli"),o=n("pjz5"),a=n("keVe"),l=function(){function e(t){var n=t.config.userPrincipalName,o=t.config.authType;if(n&&o!==i.a.Unknown){var a={};a[e.pvrQueryName]=o===i.a.OrgId?"OrgId":"WindowsLiveId",a[e.upnQueryName]=n,this.authParams=r.a.buildQueryPath(a)}}return e.prototype.appendPvrAndUpnAuthParams=function(t){if(!t||!this.authParams)return t;var n=o.a.getLocation(t),i=o.a.getQueryParams(n.search);return i[e.pvrQueryName]||i[e.upnQueryName]?t:r.a.appendQuery(t,this.authParams)},e.pvrQueryName="auth_pvr",e.upnQueryName="auth_upn",e.ɵprov=a.kc({factory:function(){return new e(a.lc(i.b))},token:e,providedIn:"root"}),e}()},BMb5:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var i,r=n("qSxk"),o=n("f0qX"),a=n("Q3dK"),l=n("Q6ee"),s=n("keVe");!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage"}(i||(i={}));var c=function(){function e(){this._innerWidth=this.getWindow().innerWidth,this.getWindow().shellTokenRequestDictionary={},this.setupInnerWidthListener()}return Object.defineProperty(e.prototype,"innerWidth",{get:function(){return this._innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nativeWindow",{get:function(){return this.getWindow()},enumerable:!0,configurable:!0}),e.prototype.ensureZoneJs=function(){try{Zone.assertZonePatched()}catch(e){window.Promise=window.ZoneJSBackupPromise}},e.prototype.isStandalonePwa=function(){return Object(r.a)(this.getWindow(),"appinstalled").pipe(Object(o.a)((function(e){return!0})),Object(a.a)(this.nativeWindow.matchMedia("(display-mode: standalone)").matches))},e.prototype.getStorage=function(e){if(!this.isStorageAvailable(e))return null;switch(e){case i.LocalStorage:return this.nativeWindow.localStorage;case i.SessionStorage:return this.nativeWindow.sessionStorage;default:return nullrn!!window[e]}catch(e){return!1}},e.prototype.getWindow=function(){return window},e.prototype.setupInnerWidthListener=function(){var e=this;Object(r.a)(this.getWindow(),"resize").pipe(Object(l.a)(10)).subscribe((function(){return e._innerWidth=e.getWindow().innerWidth}))},e.ɵprov=s.kc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},BaAg:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return p}));var i,r,o=n("WFKr"),a=ng",e[e.Clipchamp=51]="Clipchamp"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.OfficeGraph=1]="OfficeGraph",e[e.SharePoint=2]="SharePoint",e[e.Exchange=3]="Exchange",e[e.OfficeMru=4]="OfficeMru",e[e.AADGraph=5]="AADGraph",e[e.OneDriveBusiness=6]="OneDriveBusiness",e[e.Substrate=7]="Substrate"}(r||(r={}));var c=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,u=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,d=/http[s]?:\/\/d\.docs\.live\.net/,p=function(){function e(t,n,r,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S,y,C,w,T,k){if(void 0===v&&(v=!0),void 0===S&&(S=null),void 0===y&&(y=null),void 0===C&&(C=!1),void 0===w&&(w=0),void 0===T&&(T=!1),void 0===k&&(k=!1),this.id=t,this.impressionId=n,this.docId=r,this.driveId=o,this.fileName=a,this.title=l,this.url=s,this.webUrl=c,this.downloadUrl=u,this.lastModifiedTime=d,this.lastViewedTime=p,this.sharedTime=f,this.fileType=h,this.provenance=m,this.pathArray=b,this.lastModifiedBy=S,this.isLocal=T,this.isSafeLink=k,this.fileTypeName=e.fileTypeNameFromType(this.fileType),this.provenanceName=e.provenanceNameFromType(this.provenance),this.documentIcon=e.documentIconFromType(this.fileType),s&&!k){var I=s;if(!T&&(!C||C&&2===w)&&(h===i.Word||h===i.Excel||h===i.OneNote||h===i.PowerPoint||h===i.Visio||h===i.Fluid||h===i.Stream)){var _=-1===s.indexOf("?")?"?":"&";I=s+_+"web=1"}this.url=C||T?I:this.encodeUrl(I,v,this.fileType===i.Forms||this.fileType===i.Portfolio||this.fileType===i.Project||this.fileType===i.ProjectOperations)}this.downloadUrl&&(this.downloadUrl=this.encodeUrl(this.downloadUrl,v)),this.setupAttribution(y,g)}return e.setStreamExtensions=function(t){(null==t?void 0:t.length)>0&&(e.StreamExtensions=t,e.fileTypeStringToExtensions||e.createFileTypeStringToExtensionsValues(),e.fileTypeStringToExtensions[i[i.Stream]]=e.StreamExtensions,e.createExtensionTo.Forms||e===i.FormsQuiz?i.Forms:e},e.fileTypeFromExtension=function(t){return e.extensionToFileType||e.createExtensionToFileTypeValues(),t?e.extensionToFileType[t.toLowerCase()]||i.Unknown:i.None},e.fileExtensionsForType=function(t){return t&&t!==i.None?(e.fileTypeStringToExtensions||e.createFileTypeStringToExtensionsValues(),e.fileTypeStringToExtensions[i[t]]||[]):[]},e.distributionFromFileTypes=function(t){return t?t.reduce((function(t,n,i){return t+(0===i?"":";")+e.fileTypeNameFromType(n)}),""):""},e.distributionFromFileItems=function(t){return t?e.distributionFromFileTypes(t.map((function(e){return e.fileType}))):""},e.fileIconNameFromType=function(e){switch(e){case i.Word:return"Word";case i.Excel:return"Excel";case i.PowerPoint:return"PowerPoint";case i.OneNote:return"OneNote";case i.Pdf:return"PDF";case i.Visio:return"Visio";case i.Sway:return"Sway";case i.Forms:return"Forms";case i.Project:return"Project";case i.ProjectOperations:return"ProjectOperations";case i.Portfolio:return"Portfolio";case i.Fluid:case i.FluidActivityBlueprint:return"Fluid";case i.PowerBI:return"PowerBI";case i.StreamsVideo:case i.Stream:case i.ScreenRecording:return"StreamsVideo";case i.Video:return"Video";case i.List:return"List";case i.PlayLists:return"PlayLists";case i.PlayList:return"PlayList";case i.Trello:return"Trello";case i.NewsArticle:return"NewsArticle";case i.Whiteboard:return"Whiteboard";case i.MeetingNotes:return"MeetingNotes";case i.Photos:return"Photos";case i.MeetingObject:return"MeetingObject";default:return"Document"}},e.fileTypeNameFromType=function(e){switch(e){case i.Word:return"Word";case i.Excel:return"Excel";case i.PowerPoint:return"PowerPoint";case i.OneNote:case i.OneNoteClassNoteBook:case i.MeetingNotes:return"OneNote";case i.Pdf:return"PDF";case i.Visio:return"Visio";case i.Audio:return"Audio";case i.Video:return"Video";case i.Photos:return"Photos";case i.Outlook:return"Outlook";case i.Text:return"Text";case i.Sway:return"Sway";case i.Forms:case i.FormsQuiz:return"Forms";case i.Project:return"Project";case i.ProjectOperations:return"ProjectOperations";case i.Portfolio:return"Portfolio";case i.NewsArticle:return"NewsArticle";case i.Fluid:return"Loop";case i.PowerBI:return"PowerBI";case i.StreamsVideo:return"Streams";case i.Stream:return"Stream";case i.ScreenRecording:return"ScreenRecording";case i.UpcomingMeeting:return"UpcomingMeeting";case i.List:return"List";case i.PlayLists:return"PlayLists";case i.PlayList:return"PlayList";case i.MindMeister:return"MindMeister";case i.Monday:return"monday.com";case i.Trello:return"Trello";case i.Platform:return"Platform";case i.Whiteboard:return"Whiteboard";case i.MeetingObject:return"Meeting Object";case i.MyAnalytics:return"MyAnalytics";case i.Designer:return"Designer";case i.Clipchamp:return"Clipchamp";default:return"Document"}},e.fileTypeNameToFileType=function(t){return t?"Custom"===t?i.ThirdParty:e.NameToFileType[t.toLowerCase()]||i.UnknownmExtension(e.getFileExtenbstrate";default:return"Unknown"}},e.getFileExtension=function(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)},e.getFileExtensionFromUrl=function(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1).split("?")[0]},e.documentIconFromType=function(t,n){return void 0===n&&(n="32x32"),t===i.Portfolio?"document-icon-sprite document-icon-sprite-"+e.fileIconNameFromType(t).toLowerCase()+"-"+n:"document-icon--"+n+" document-icon--"+e.fileIconNameFromType(t).toLowerCase()},e.referralFromFileType=function(t){switch(t){case i.Word:return s.a.Word;case i.Excel:return s.a.Excel;case i.PowerPoint:return s.a.PowerPoint;case i.OneNote:return s.a.OneNote;case i.Sway:return s.a.Sway;case i.Visio:return s.a.Visio;case i.Project:case i.ProjectOperations:case i.Portfolio:return s.a.Project;case i.PowerBI:return s.a.PowerBI;default:return e.fileTypeNameFromType(t)}},e.referralFromFileLocation=function(e){if(e&&e.length){if(e.match(c)||e.match(d))return s.a.OneDrive;if(e.match(u))return s.a.SharePoint}return null},e.isConsumerDocument=function(e){return l.a.getHostName(e).lastIndexOf("live.net")>0},e.fileNameWithoutExtension=function(e){if(!e)return e;var t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)},e.prototype.documentIconWithSize=function(t){return void 0===t&&(t="32x32"),e.documentIconFromType(this.fileType,t)},e.prototype.getClickData=function(t,n,i,r){void 0===r&&(r=!1);var o={};o.ImpressionId=this.impressionId,r?(o.ElementId=t,o.DocumentId=this.id):o.ElementId=this.id,o.Referral=e.referralFromFileType(this.fileType),o.Index=i.toString(),o.DocumentType=this.fileTypeName,o.Action=n;var a=this.timeSinceLastOpenInSeconds();return null!==a&&(o.InactivityDuration=a.toString()),{eventName:t,params:o,metrics:[]}},e.prototype.getClickDataForPath=function(t,n,i){var r=this.getClickData(t,n,i);return r&&r.params&&(r.params.Referral=e.referralFromFileLocation(this.url)),r},e.prototype.timeSinceLastOpenInSeconds=function(){return this.lastViewedTime?Math.round(((new Date).getTime()-this.lastViewedTime.getTime())/1e3):null},e.prototype.getId=function(){return this.id},e.createExtensionToFileTypeValues=function(){e.fileTypeStringToExtensions||e.createFileTypeStringToExtensionsValues(),e.extensionToFileType={};var t=function(t){if(!e.fileTypeStringToExtensions.hasOwnProperty(t))return"continue";var n=e.fileTypeStringToExtensions[t](n){e.extensionToFileType[n]=i[t]}))};for(var n in e.fileTypeStringToExtensions)t(n)},e.createFileTypeStringToExtensionsValues=function(){(e.fileTypeStringToExtensions={})[i[i.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],e.fileTypeStringToExtensions[i[i.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],e.fileTypeStringToExtensions[i[i.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],e.fileTypeStringToExtensions[i[i.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],e.fileTypeStringToExtensions[i[i.Photos]]=["jpg","png","jpeg","gif","svg","bmp","tif","tiff","heic"],e.fileTypeStringToExtensions[i[i.Video]]=e.StreamExtensions,e.fileTypeStringToExtensions[i[i.Outlook]]=["msg","eml"],e.fileTypeStringToExtensions[i[i.OneNote]]=["one"],e.fileTypeStringToExtensions[i[i.Pdf]]=["pdf"],e.fileTypeStringToExtensions[i[i.Audio]]=["mp3"],e.fileTypeStringToExtensions[i[i.Text]]=["txt"],e.fileTypeStringToExtensions[i[i.Fluid]]=["fluid","loop"],e.fileTypeStringToExtensions[i[i.Stream]]=e.StreamExtensions,e.fileTypeStringToExtensions[i[i.Whiteboard]]=["whiteboard"],e.fileTypeStringToExtensions[i[i.MeetingNotes]]=["note"]},e.prototype.encodeUrl=function(e,t,n){try{var i=e;return t&&((i=a.a.decodeUrl(e))||(i=e)),a.a.encodeUrl(i,n)}catch(t){return e}},e.prototype.setupAttribution=function(e,t){if(this.fileType!==i.Sway&&this.fileType!==i.Forms&&this.fileType!==i.Project&&this.fileType!==i.ProjectOperations)if(this.attribution=o.a.Format(this.pathArray,t)[1],e)this.attributionUrl=e;else{var n=this.url?this.url.lastIndexOf(this.isLocal?"\\":"/"):-1;if(this.attributionUrl=-1===n?this.url:this.url.substring(0,n+1),this.attributionUrl&&this.attributionUrl.match(d)){var r=l.a.getLocation(this.attributionUrl).path;r.lastIndexOf("/",r.length-2)<=0&&(this.attributionUrl=this.attributionUrl+"?id=root")}}},e.NameToFileType={none:i.None,unknown:i.Unknown,excel:i.Excel,onenote:i.OneNote,pdf:i.Pdf,powerpoint:i.PowerPoint,audio:i.Audio,video:i.Video,visio:i.Visio,word:i.Word,photos:i.Photos,text:i.Text,outlook:i.Outlook,sway:i.Sway,forms:i.Forms,formsquiz:i.FormsQuiz,project:i.Project,projectoperations:i.ProjectOperations,portfolio:i.Portfolio,news:i.NewsArticle,newsarticle:i.NewsArticle,onedrive:i.OneDrive,sharepoint:i.SharePoint,bohemia:i.Fluid,fluid:i.Fluid,loop:i.Fluid,"loop components":i.Fluid,powerbi:i.PowerBI,streamsvideo:i.StreamsVideo,yammer:i.Yammer,mindmeister:i.MindMeister,stream:i.Stream,monday:i.Monday,trello:i.Trello,platform:i.Platform,whiteboard:i.Whiteboard,meetingnotes:i.MeetingNotes,myanalytics:i.MyAnalytics,list:i.List,playlists:i.PlayLists,playlist:i.PlayList,"meeting object":i.MeetingObject,upcomingmeeting:i.UpcomingMeeting,screenrecording:i.ScreenRecording,designer:i.Designer,clipchamp:i.Clipchamp},e.NameToProvenance={Unknown:r.Unknown,AADGraph:r.AADGraph,Exchange:r.Exchange,OfficeGraph:r.OfficeGraph,OfficeMru:r.OfficeMru,SharePoint:r.SharePoint,Substrate:r.Substrate},e.StreamExtensions=["mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg"],e}()},Bc8L:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Bmgn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Brer:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var i=n("QjXU"),r=n("GMuP"),o=n("3Vsh"),a=n("lrJm"),l=n("hhzZ"),s=n("R7NL"),c=n("BaAg"),u=n("p6Zr"),d=n("L/Tc"),p=n("fKR7"),f=n("4/We"),h=n("cgnd"),m=n("/I02"),b=n("oAX+"),g=n("ZBli"),v=n("pjz5"),S=n("kpuN"),y=n("pd4Y"),C=n("wwmn"),w=(n("Dpxn"),n("casz")),T=n("BMb5"),k=n("pOWU"),I=n("keVe"),_=n("TOqr"),A=function(e){function t(n,i,r,o,a,l,s,c,u,d,p,f){var m=e.call(this,n,o,a,"SharePoint",l,s,d,f,"WLID1.1 ")||this;m.capabilitiesService=i,m.dateService=c,m.windowService=u,m.globalErrorHandler=p,m.requestCache=new Map,m.itemPathPredicate=":/",m.requestConfig={headers:new Map([["accept","application/json"],["Prefer","allow-zerobyte"],["application","officehome"]])},m.inMockMode&&(m.itemPathPredicate="?path=");var b=m.contextService.sharedContext;return m.isConsumer=r.config.authType===h.a.MSA,m.myDriveUrl=(m.isConsumer?m.getConsumerBaseUrl():m.getCommercialBaseUrl(b.oneDriveResourceId))+"/"+t.drivePath,m}return Object(i.__extends)(t,e),t.getItemParams=function(e,n,r,o,a){void 0===o&&(o=""),void 0===a&&(a="open");var l=n?Object(i.__spread)(new Set(e.concat(t.WacDataSelectParams))):e;return[l.length?"$select="+l.join(","):"",r?"$expand=thumbnails":"",n?"action="+a:"",o?"$filter="+o:""].filter(Boolean).join("&")},t.getWopiHostDataFromItem=function(e){var t,n,i,r,o,a,l;return{bundleUrl:null!==(n=null===(t=null==e?void 0:e.officeBundle)||void 0===t?void 0:t.url)&&void 0!==n?n:"",bundleVersion:null!==(r=null===(i=null==e?void 0:e.officeBundle)||void 0===i?void 0:i.version)&&void 0!==r?r:"",downloadUrl:(null==e?void 0:e["@content.downloadUrl"])||(null==e?void 0:e["@microsoft.graph.downloadUrl"]),eTag:null==e?void 0:e.eTag,fileName:null==e?void 0:e.name,fileSize:null==e?void 0:e.size,irmEnabled:null===(o=null==e?void 0:e.sensitivityLabel)||void 0===o?void 0:o.protectionEnabled,isNewFile:!1,readOnly:null===(a=null==e?void 0:e.currentUserRole)||void 0===a?void 0:a.readOnly,wac:null===(l=null==e?void 0:e.openWith)||void 0===l?void 0:l.wac,sharepointIds:null==e?void 0:e.sharepointIds}},t.prototype.getMyDriveRootUrl=function(e){var t=this;if(void 0===e&&(e=0),!this.capabilitiesService.capabilities.oneDriveApisEnabled)return Promise.resolve(null);if(!this.myDriveRootUrlPromise){var n=new Promise((function(n,i){var r=t.getMyDriveRootUrlStream(e);r.results.pipe(Object(o.a)(1)).toPromise().then((function(e){e&&e.userRoot?n(e):i("No/Incomplete data returned.")})),r.initialCompletion.then((function(e){e&&(t.globalErrorHandler.handleCacheObservableError(e,"Escyx","TBMsL"),e.cacheError&&e.networkError&&i(e))}))}));this.myDriveRootUrlPromise=n}return this.myDriveRootUrlPromise},t.prototype.getMyDriveRootUrlStream=function(e){var t=this;if(void 0===e&&(e=0),this.myDriveRootUrlStream)return this.myDriveRootUrlStream;var n=this.getMyDriveRootUrlInternal("cache-only",e),i=this.getMyDriveRootUrlInternal("network-first",e),r=b.a.createResultsWithCacheObservable(n,i,null,(function(e){return t.myDriveRootUrlStream=null}));return this.myDriveRootUrlStream=r,this.myDriveRootUrlStream},t.prototype.getSharedItemWithThumbnail=function(e,n,i,r,o,a,l){return void 0===a&&(a=!1),void 0===l&&(l=0),this.getSharedItemWithParams(e,n,i,t.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],o,!0),r,a,l)},t.prototype.getSharedItemWithoutThumbnail=function(e,n,i,r,o,a,l,s){return void 0===a&&(a="open"),void 0===l&&(l=!1),void 0===s&&(s=0),this.getSharedItemWithParams(e,n,i,t.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],o,!1,"",a),r,l,s)},t.prototype.getSharedItemWithThumbnailAndIds=function(e,n,i,r,o,a,l){return void 0===a&&(a=!1),void 0===l&&(l=0),this.getSharedItemWithParams(e,n,i,t.getItemParams(["id","sharepointIds"],o,!0),r,a,l)},t.prototype.getItemWithWacDataAndThumbnails=function(e,n,i,r){return void 0===i&&(i=!1),void 0===r&&(r=0),this.getItemWithParams(e.url,e.driveId,e.docId,n,t.getItemParams([],!0,!0),i,r)},t.prototype.getItemWithWacData=function(e,n,i,r,o,a,l){return void 0===o&&(o="open"),void 0===a&&(a=!1),void 0===l&&(l=0),this.getItemWithParams(e,n,i,r,t.getItemParams([],!0,!1,null,o),a,l)},t.prototype.getItemAccessForUser=function(e,t,n,i){var r=this,o=this.getApiInfo(e,!0),a=o.baseUrl+"/drives/"+encodeURIComponent(t)+"/items/"+encodeURIComponent(n)+"/oneDrive.checkAccess";return new Promise((function(e,t){var n=r.getRequestConfig();n.headers.set("Content-Type","application/json"),r.post("Vroom_OneDrive_Item_Check_Access_Request","Vroom_OneDrive_Item_Check_Access",a,JSON.stringify({value:[{email:i}]}),(function(n){n.instrument((function(e,t){t.RequestId=r.getRequestIdFromResponse(e)})).then((function(n){n&&n.data&&n.data.value&&n.data.value[0]?e(n.data.value[0]):t(new k.b(n,"No data returned"))})).catch((function(e){r.globalErrorHandler.handleError(e,"B95N9"),t(e)}))}),t,n,null,null,null,null,o.tokenType,o.resourceUrl,null,"network-only",null,null)}))},t.prototype.getEnterpriseTemplatesLibraries=function(){var e=this,n=t.getItemParams(["id","name","organizationAssets"],!1,!1,"organizationAssets/officeTemplateLibrary%20ne%20null"),i=this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)+"/drives"+(n?"?"+n:"");return this.getDriveItems("Template_Libraries_Request","Template_Libraries",i,"cache-only",this.contextService.sharedContext.sharePointResourceId,"SharePoint").catch((function(){return e.getDriveItems("Template_Libraries_Request","Template_Libraries",i,"network-first",e.contextService.sharedContext.sharePointResourceId,"SharePoint",0,"BrowseOrgTemplates","AUO")}))},t.prototype.getDriveItemChildrenWithThumbnails=function(e,n,i,r,o){if(void 0===i&&(i="network-first"),!e)return null;var a=t.getItemParams(["id","name","folder","webUrl","webDavUrl"],!1,!0),l=n?"items/"+encodeURIComponent(n)+"/":"root/",s=this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId)+"/drives/"+encodeURIComponent(e)+"/"+l+"children"+(a?"?"+a:"");return this.getDriveItems("Vroom_Item_Request","Vroom_Item",s,i,this.contextService.sharedContext.sharePointResourceId,"SharePoint",0,r,o)},t.prototype.createNewFile=function(e,t,n){var i=this;void 0===n&&(n=!1);var o=this.myDriveUrl+"root/children?select=webDavUrl,"+(n?"openWith,":"")+"*",a={name:e,file:{},"@name.conflictBehavior":"rename"};return new Promise((function(e,n){i.post("Vroom_Create_File_Request","Vroom_Create_File",o,a,(function(t){t.instrument((function(e,t){t.RequestId=i.getRequestIdFromResponse(e)})).then((function(t){var i=t.data;i&&i.id?e(i):n(new k.b(t,"Could not parse drive item from Vroom response"))})).catch((function(e){if(e&&e.data){var t={};t.DebugInfo=JSON.stringify(e.data),t.HttpCode=e.status.toString(),i.instrumentationService.logDebugCacheEvent("Vroom_Create_File_Request",t),Object(r.a)({eventName:"Vroom_Create_File_Request",params:t})}i.globalErrorHandler.handleError(e,"vcXyA")}))}),(function(e){e&&e.httpResponse?n(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):n()}),i.getRequestConfig(),null,null,null,null,"OneDrive",i.contextService.sharedContext.oneDriveResourceId,null,null,!0,{category:"CreateFile",fileType:t})}))},t.prototype.uploadFile=function(e,t,n,i,r,o,a){var l=this;return new Promise((function(s,c){e&&e.name||c(new k.b(null,"Invalid file"));var u=l.getUploadLocation(l.myDriveUrl,e,n,i)+"content?@name.conflictBehavior=rename&select=webDavUrl,*";l.put("Vroom_Upload_File_Request","Vroom_Upload_FiinstrumentUploadResponse(n,i,e,t)})).then((function(e){var t=e.data;t&&t.id?s(t):c(new k.b(e,"Could not parse drive item from Vroom response"))})).catch((function(e){l.globalErrorHandler.handleError(e,"dSenI")}))}),c,l.getRequestConfig(),r,null,o,a,"OneDrive",l.contextService.sharedContext.oneDriveResourceId)}))},t.prototype.getDownloadUrl=function(e){if(!(e&&e.itemId&&e.driveId&&e.itemUrl))return Promise.reject("Invalid params");var n=t.getItemParams(["id","content.downloadUrl"],!1,!1);return this.getItemWithParams(e.itemUrl,e.driveId,e.itemId,"network-only",n).then((function(e){return e["@content.downloadUrl"]?g.a.removeQueryParams(e["@content.downloadUrl"],["tempAuth","ApiVersion"],!1):Promise.reject("Missing downloadUrl")}))},t.prototype.createUploadSession=function(e,t,n,i,r){var o=this;return new Promise((function(a,l){e&&e.name||l(new k.b(null,"Invalid file"));var s=o.getUploadLocation(o.myDriveUrl,e,n,i)+(o.inMockMode?"":"oneDrive.")+"createUploadSession";o.post("Vroom_Create_Upload_Session_Request","Vroom_Create_Upload_Session",s,{item:{"@name.conflictBehavior":"rename"}},(function(n){n.instrument((function(n,i){if(o.instrumentUploadResponse(n,i,e,t),n.ok){var r=n.data;i.Length=r&&r.uploadUrl?r.uploadUrl.length.toString():"0"}})).then((function(e){var t=e.data;t&&t.uploadUrl?a(t):l(new k.b(e,"Could not parse upload session from Vroom response"))})).catch((function(e){o.globalErrorHandler.handleError(e,"d9WE9")}))}),l,o.getRequestConfig(),null,null,r,null,"OneDrive",o.contextService.sharedContext.oneDriveResourceId)}))},t.prototype.cancelUploadSession=function(e,t,n){return this.cancelUploadSessionInternal(e,t,n,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)},t.prototype.uploadFragment=function(e,t,n,i,r,o,a,l,s){var c=this;return new Promise((function(u,d){e||d(new k.b(null,"Invalid session url"));var p="select=webDavUrl,*";e.endsWith(p)||(e=g.a.appendQuery(e,p));var f=new Map,h=Math.max(0,n-t);f.set("Content-Range","bytes "+t+"-"+(t+h-1)+"/"+i),c.put("OneDrive_Graph_Upload_Fragment_Request","OneDrive_Graph_Upload_Fragment",e,r,(function(e){e.instrument((function(e,n){n.TotalSize=i.toString(),n.ActualSize=h.toString(),n.Index=t.toString(),n.UploadSessionId=o,n.RequestId=c.getRequestIdFromResponse(e)})).then((function(e){return u(e.data)})).catch((function(e){c.globalErrorHandler.handleError(e,"t59Ym")}))}),d,{headers:f},a,null,l,s,"None")}))},t.prototype.getUploadSessionStatus=function(e,t,n){return this.getUploadSessionStatusInternal(e,t,n,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)},t.prototype.getDocumentActivity=function(e,n,i){var r=this;if(void 0===i&&(i=0),!e||!e.driveId||!e.docId)return Promise.reject(new k.b(null,"Drive and doc IDs are required"));var o=n+"_"+e.driveId+"_"+e.docId+"_activity",a=this.getRequestFromCache(o);if(a)return a;var l=new Promise((function(a,l){var s=r.getCommercialApiInfo(e.url);s||l("Invalid document url");var c=s.baseUrl+"/drives/"+encodeURIComponent(e.driveId)+"/items/"+encodeURIComponent(e.docId)+"/activities";r.get("Vroom_Activity_Request","Vroom_Activity",c,(function(n){n.instrument((function(t,n){if(n.RequestId=r.getSharepointRequestId(t),n.FileFormat=p.a[e.format],t&&t.ok&&t.data&&t.data.value){var i=t.data.value.length.toString();n.ActualSize=i,n.Distribution=r.distributionByActionType(t.data.value)}})).then((function(e){e&&e.data&&e.data.value?a(e.data.value.map((function(e){return{action:e.action.hasOwnProperty(t.mentionKey)?{type:d.a.Mention,data:e.action[t.mentionKey]}:e.action.hasOwnProperty(t.commentKey)?{type:d.a.Comment,data:e.action[t.commentKey]}:e.action.hasOwnProperty(t.editKey)?{type:d.a.Edit,data:e.action[t.editKey]}:{type:d.a.Unknown,data:null},actor:e.actor,timestamp:r.getPreferredTime(e.times)}}))):l(new k.b(e,"No data returned"))})).catch((function(e){r.globalErrorHandler.handleError(e,"ACZGk")}))}),(function(e){r.requestCache.delete(o),l(e)}),r.getRequestConfig(),n,null,null,null,s.tokenType,s.resourceUrl,i)}));return this.requestCache.set(o,{promise:l,expiryTime:this.dateService.addSeconds(this.dateService.getCurrentDate(),this.contextService.sharedContext.activityLifetimeInSeconds)}),l},t.prototype.getUploadLocation=function(e,t,n,i){return e+(this.inMockMode?"upload/":(i?"root"+this.itemPathPredicate+i+"/":n?"items/"+n+this.itemPathPredicate:"root"+this.itemPathPredicate)+encodeURIComponent(t.name)+this.itemPathPredicate)},t.prototype.instrumentUploadResponse=function(e,t,n,i){t.TotalSize=n.size.toString(),t.UploadSessionId=i,t.RequestId=this.getRequestIdFromResponse(e)},t.prototype.getRootUrlsFromRootItem=function(e,n){var i=null,r=e?e.webUrl:null;if(!r)return this.instrumentationService.logGenericEvent("OneDrive_Places_Bad_Url"),null;if(!this.isConsumer){var o=t.oneDriveBaseUrlSearchRegex.exec(r);o&&o.length&&(i=o[0])}return{tenantRoot:i,userRoot:r,fromCache:"cache-only"===n}},t.prototype.getSharesUrl=function(e){try{for(var t=this.windowService.nativeWindow.btoa(unescape(encodeURIComponent(e))),n=t.length-1;"="===t.charAt(n);)--n;return"shares/u!"+(t=t.slice(0,n+1).replace(/\+/g,"-").replace(/\//g,"_"))+"/driveItem"}catch(e){return this.globalErrorHandler.handleError(e,"fYwwF"),null}},t.prototype.cancelUploadSessionInternal=function(e,t,n,i,r){var o=this;return new Promise((function(a,l){e||l(new k.b(null,"Invalid session url")),o.delete("OneDrive_Graph_Cancel_Upload_Session_Request","OneDrive_Graph_Cancel_Upload_Session",e,null,(function(e){e.instrument((function(e,n){n.UploadSessionId=t,n.RequestId=o.getRequestIdFromResponse(e)})).then((function(){return a(null)})).catch((function(e){o.globalErrorHandler.handleError(e,"wQvvW")}))}),l,o.getRequestConfig(),n,null,i,r)}))},t.prototype.getUploadSessionStatusInternal=function(e,t,n,i,r){var o=this;return new Promise((function(a,l){e||l(new k.b(null,"Invalid session url")),o.get("OneDrive_Graph_Upload_Status_Request","OneDrive_Graph_Upload_Status",e,(function(e){e.instrument((function(e,n){n.UploadSessionId=t,n.RequestId=o.gehen((function(e){return a(e.data)})).catch((function(e){o.globalErrorHandler.handleError(e,"PPAU2")}))}),l,o.getRequestConfig(),"network-only",null,n,null,in this.getMyDriveItem("root",e,t)},t.prototype.createSharingLink=function(e,t){var n=this;if(this.isConsumer)return Promise.reject("api only available for commercial");var i=this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)+"/drives/"+encodeURIComponent(e)+"/items/"+encodeURIComponent(t)+"/createLink",r={type:"addressBar"},o=this.getRequestConfig();return o.headers.set("Content-Type","application/json"),new Promise((function(e,t){n.post("Vroom_Create_Link_Request","Vroom_Create_Link",i,JSON.stringify(r),(function(i){i.instrument((function(e,t){t.RequestId=n.getRequestIdFromResponse(e)})).then((function(n){var i,r;(null==n?void 0:n.ok)&&(null===(r=null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.link)||void 0===r?void 0:r.webUrl)?e(n.data.link.webUrl):t(n.statusText)})).catch((function(e){n.globalErrorHandler.handleError(e)}))}),t,o)}))},t.prototype.getThumbnailString=function(e){var t=this,n=new FileReader;return new Promise((function(i,r){e=(t.isConsumer?t.getConsumerBaseUrl():t.getCommercialBaseUrl(t.contextService.sharedContext.oneDriveResourceId))+"/"+e;var o=t.getRequestConfig({responseType:"blob"}),a=t.getApiInfo(e);t.get("Vroom_Thumbnail_String_Request","Vroom_Thumbnail_String",e,(function(e){e.instrument((function(e,n){n.RequestId=t.getSharepointRequestId(e)})).then((function(e){e&&e.data?(n.onloadend=function(){var e="string"==typeof n.result&&n.result||"";e.length>0?i(e):r()},n.onerror=r,n.onabort=r,n.readAsDataURL(e.data)):r()})).catch((function(e){t.globalErrorHandler.handleError(e,"AfEUN")}))}),r,o,"network-only",null,null,null,a.tokenType,a.resourceUrl)}))},t.prototype.getFluidEnabled=function(e){var n=this,i=this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)+"/"+t.drivePath+"root/opStream/fluidEnabled";return new Promise((function(t,r){n.get("Vroom_Get_Fluid_Enabled_Request","Vroom_Get_Fluid_Enabled",i,(function(e){e.then((function(e){return andler.handleError(e,"PPAU2"),r()}))}),r,n.getRequestConfig(),e,null,null,null,"SharePoint",n.contextService.sharedContext.sharePointResourceId)}))},t.prototype.handleQueryParam=function(e,t,n){"mockvroom"===e&&this.mockRequestHeader&&(null==n||n.headers.set(this.mockRequestHeader,t))},t.prototype.getRequestIdFromResponse=function(t){var n;return this.isConsumer?this.getHeaderValue(t.headers,"ms-cv"):null!==(n=e.prototype.getRequestIdFromResponse.call(this,t))&&void 0!==n?n:this.getSharepointRequestId(t)},t.prototype.getMyDriveItem=function(e,t,n){return this.getDriveItem("Vroom_Item_Request","Vroom_Item",""+this.myDriveUrl+e,t,null,"OneDrive",this.contextService.sharedContext.oneDriveResourceId,n)},t.prototype.getItemWithParams=function(e,t,n,i,r,o,a){void 0===o&&(o=!1),void 0===a&&(a=0);var l=this.getApiInfo(e);if(!l)return Promise.reject("Invalid document url");var s=l.baseUrl+"/drives/"+encodeURIComponent(t)+"/items/"+encodeURIComponent(n)+"/"+(r?"?"+r:""),c=r.includes("openWith");return this.getDriveItem(c?"Vroom_Item_With_Wac_Data_Request":"Vroom_Item_Request",c?"Vroom_Item_With_Wac_Data":"Vroom_Item",s,i,null,l.tokenType,l.resourceUrl,a,c,o)},t.prototype.getSharedItemWithParams=function(e,t,n,i,r,o,a){var l=this;void 0===o&&(o=!1),void 0===a&&(a=0);var s=this.getSharesUrl(e);if(!s)return Promise.reject(new k.b(null,"Failed to construct shares url"));var u=this.getApiInfo(e),d=this.inMockMode?"shares?itemUrl="+encodeURIComponent(s)+"&currentDate="+this.dateService.getCurrentDateMinuteGranularity().toISOString():s+(i?"?"+i:""),p=u.baseUrl+"/"+d,f=i.includes("openWith");return this.getDriveItem(f?"Vroom_Shares_With_Wac_Data_Request":"Vroom_Shares_Request",f?"Vroom_Shares_With_Wac_Data":"Vroom_Shares",p,r,(function(e,i){if(i.RequestId=l.getSharepointRequestId(e),i.DocumentType=c.b[t],n&&(i.FileFormat=n),e.ok){var r=e.data,o=r?r.thumbnails:null;i.ItemCount=(o?o.length:0).toString()}}),u.tokenType,u.resourceUrl,a,f,o)},t.prototype.getDriveItem=function(e,n,i,r,o,a,l,s,c,u){var d=this;void 0===s&&(s=0),void 0===c&&(c=!1),void 0===u&&(u=!1);var p=i+"/"+r,f=u?void 0:this.getRequestFromCache(p);if(f)return f;var h=new Promise((function(c,u){var f=d.getRequestConfig();f.headers.has(t.scenarioHeader)&&f.headers.delete(t.scenarioHeader),f.headers.has(t.scenarioTypeHeader)&&f.headers.delete(t.scenarioTypeHeader),d.get(e,n,i,(function(e){e.instrument((function(e,t){t.RequestId=d.getRequestIdFromResponse(e),o&&o(e,t)})).then((function(e){e&&e.data?c(e.data):u(new k.b(e,"No data returned"))})).catch((function(e){d.globalErrorHandler.handleError(e,"tIvZK")}))}),(function(e){d.requestCache.delete(p),u(e)}),f,r,null,null,null,a,l,s)}));return this.requestCache.set(p,{promise:h,expiryTime:c?this.dateService.addHours(this.dateService.getCurrentDate(),10):void 0}),h},t.prototype.getDriveItems=function(e,n,i,r,o,a,l,s,c){var u=this;void 0===l&&(l=0);var d=i+"/"+r,p=this.getRequestFromCache(d);if(p)return p;var f=new Promise((function(p,f){var h=u.getRequestConfig();s?h.headers.has(t.scenarioHeader)?h.headers[t.scenarioHeader]=s:h.headers.set(t.scenarioHeader,s):h.headers.has(t.scenarioHeader)&&h.headers.delete(t.scenarioHeader),c?h.headers.has(t.scenarioTypeHeader)?h.headers[t.scenarioTypeHeader]=c:h.headers.set(t.scenarioTypeHeader,c):h.headers.has(t.scenarioTypeHeader)&&h.headers.delete(t.scenarioTypeHeader),u.get(e,n,i,(function(e){e.instrument((function(e,t){t.RequestId=u.getSharepointRequestId(e)})).then((function(e){e&&e.data?p(e.data):f(new k.b(e,"No data returned"))})).catch((function(e){u.globalErrorHa(e){u.requestCache.delete(d),f(e)}),h,r,null,null,null,a,o,l)}));return this.requestCache.set(d,{promise:f}),f},t.prototype.distributionByActionType=function(e){return e?e.map((function(e){if(e&&e.action){var t=Object.keys(e.action);if(t&&t.length)return t[0]}return""})).reduce((function(e,t,n){return e+(0===n?"":";")+t}),""):""},t.prototype.getPreferredTime=function(e){return e?e.observedTime?new Date(e.observedTime):e.recordedTime?new Date(e.recordedTime):null:null},t.prototype.getRequestFromCache=function(e){if(this.requestCache.has(e)){var t=this.requestCache.get(e);if(t.promise&&(!t.expiryTime||t.expiryTime>this.dateService.getCurrentDate()))return t.promise;this.requestCache.delete(e)}re):this.getCommercialApiInfo(e,t)},t.prototype.getConsumerApiInfo=function(e){var t=v.a.getLocation(e);return t&&t.protocol&&t.host?{baseUrl:this.getConsumerBaseUrl(),tokenType:"OneDrive",resourceUrl:this.contextService.sharedContext.oneDriveResourceId,hostname:t.hostname}:null},t.prototype.getCommercialApiInfo=function(e,t){void 0===t&&(t=!1);var n=v.a.getLocation(e);if(!n||!n.protocol||!n.host)return null;var i=n.protocol+"//"+n.host;return{baseUrl:this.getCommercialBaseUrl(i,!1,t),tokenType:this.getTokenType(i),resourceUrl:i,hostname:n.hostname}},t.prototype.getCommercialBaseUrl=function(e,t,n){return void 0===n&&(n=!1),e=this.inMockMode?""+this.contextService.sharedContext.officeHomeApiRoot:e,t?e+"/_api":n?e+"/_api/v2.1":e+"/_api/v2.sharedContext.oneDriveConsumerApi},t.prototype.getTokenType=function(e){return c.a.referralFromFileLocation(e)===u.a.OneDrive?"OneDrive":"SharePoint"},t.prototype.getRequestConfig=function(e){return void 0===e&&(e={}),Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},this.requestConfig),{headers:new Map(this.requestConfig.headers)}),e)},s&&e.headers.get("SPRequestGuid")},t.prototype.getMyDriveRootUrlInternal=function(e,t){var n=this;return this.getMyDriveRoot(e,t).then((function(t){return n.getRootUrlsFromRootItem(t,e)}))},t.WacDataSelectParams=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl"],t.mentionKey="mention",t.commentKey="comment",t.editKey="edit",t.drivePath="drive/",t.oneDriveBaseUrlSearchRegex=/^https?:\/\/(.(?!\/))*.\//i,t.scenarioHeader="scenario",t.scenarioTypeHeader="scenarioType",t.sharesFileTypes=new Set([c.b.Excel,c.b.PowerPoint,c.b.Visio,c.b.Word,c.b.OneNote]),t.ɵprov=I.kc({factory:function(){return new t(I.lc(S.b),I.lc(f.a),I.lc(h.b),I.lc(l.a),I.lc(s.a),I.lc(m.a),I.lc(C.a),I.lc(y.a),I.lc(T.b),I.lc(_.q),I.lc(a.b),I.lc(w.a))},token:t,providedIn:"root"}),t}(k.a)},CC5A:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var i,r=n("QjXU"),o=function(){function e(e){this.onTabAddedOrUpdated=new Array,Object.assign(this,e)}return e.prototype.updateOrAddTab=function(e,t){var n,i;void 0===t&&(t=-1);for(var o=this.tabs,a=!1,l=o.length,s=0;s<o.length;s++)if(o[s].id===e.id){a=!0,l=s,o[s]=e;break}a||(-1===t||t>=o.length?o.push(e):o.splice(t,0,e));try{for(var c=Object(r.__values)(this.onTabAddedOrUpdated),u=c.next();!u.done;u=c.next())(0,u.value)(e,l,a)}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}},e.prototype.registerOnTabAddedOrUpdated=function(e){this.onTabAddedOrUpdated.push(e)},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error"}(i||(i={}))},CCRL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").u)("LAZY_VIEW_ENTRY_COMPONENT")},CMIS:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("TfV2"),r=n("ZBSS"),o=n("uqr+"),a=n("dSKW"),l=n("uV9m"),s=n("GMuP");function c(e,t){void 0===t&&(t=i.a.Security),Object(l.g)("Error",function(e){var t,n,i,s,c={};if(c[r.A]="Error",c[r.B]=e.eventName,c[Object(o.a)([r.y,r.z])]=null!==(t=e.errorType)&&void 0!==t?t:"",c[Object(o.a)([r.y,r.j])]=null!==(n=e.area)&&void 0!==n?n:"",c[Object(o.a)([r.y,r.jb])]=null!==(i=e.subArea)&&void 0!==i?i:"",c[Object(o.a)([r.y,r.w])]=null!==(s=e.errorCategory)&&void 0!==s?s:"",e.occurrenceCount&&(c[Object(o.a)([r.y,r.x])]=e.occurrenceCount),Object(l.e)()){var u=Object(a.b)(Object(l.b)());c[Object(o.a)([r.y,r.Y])]=u,c[Object(o.a)([r.y,r.Z])]=Object(a.d)(u),c[Object(o.a)([r.y,r.X])]=Object(a.c)(u)}return c}(e),t),Object(s.a)({eventName:e.eventName,params:u(e)},t)}function u(e){var t,n,i,o,a,l,s={};return s[r.n]=null!==(t=e.debugInfo)&&void 0!==t?t:"",s[r.v]=null!==(n=e.message)&&void 0!==n?n:"",s[r.z]=null!==(i=e.errorType)&&void 0!==i?i:"",s[r.w]=null!==(o=e.errorCategory)&&void 0!==o?o:"",e.occurrenceCount&&(s[r.x]=e.occurrenceCount),s[r.j]=null!==(a=e.area)&&void 0!==a?a:"",s[r.jb]=null!==(l=e.subArea)&&void 0!==l?l:"",s}},COYM:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));var i=n("BMb5"),r=n("keVe"),o=n("oHg+"),a="CryptoAPI Not Available",l=function(){function e(e,t){this.cryptoApiAvailable=e,this.windowService=t}return Object.defineProperty(e.prototype,"crypto",{get:function(){if(!this.cryptoApiAvailable)throw new Error(a);return this.windowService.nativeWindow.crypto},enumerable:!0,configurable:!0}),e.ɵprov=r.kc({factory:function(){return new e(r.lc(o.a),r.lc(i.b))},token:e,providedIn:"root"}),e}()},CVeG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function/g,"&quot;"){return e?e.replace(/<.*?>/g,""):""},e}()},CfLe:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Cin9:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("TfV2"),r=n("ZBSS"),o=n("dSKW"),a=n("uqr+"),l=n("uV9m");function s(e,t){void 0===t&&(t=i.a.Security),Object(l.g)("Performance",function(e){var t,n,i={};if(i[r.A]="Performance",i[r.B]=e.eventName,Object(l.e)()){var s=Object(o.b)(Object(l.b)());i[Object(a.a)([r.bb,r.Y])]=s,i[Object(a.a)([r.bb,r.Z])]=Object(o.d)(s),i[Object(a.a)([r.bb,r.X])]=Object(o.c)(s)}return i[Object(a.a)([r.bb,r.j])]=null!==(t=e.area)&&void 0!==t?t:"",i[Object(a.a)([r.bb,r.jb])]=null!==(n=e.subArea)&&void 0!==n?n:"",i[Object(a.a)([rsupported="Unsupported"}(i||(i={}))},D6F8:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},D8EG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},DAwf:function(e,t,n){"use strict";function i(e){var t;t=e.length?"https://"+e:window.location.origin,n.p=t+="/bundles/"}n.d(t,"a",(function(){return i}))},DCBR:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("hhzZ"),r=(n("W3Zz"),n("hZW2"),n("4/We"),n("PBJH"),function(){function e(e,t,n,i,r,o){this.capabilitiesService=e,this.changeDetector=t,this.deviceDetector=n,this.documentService=i,this.instrumentationService=r,this.locService=o,this.cardIncrement=4,this.currentCarouselPage=0,this.maxCardsPerLine=4,this.cardMinWidth=217,this.cardMargin=12}return e.prototype.ngOnInit=function(){this.sharedInit(),this.cards=this.carousel.cards,this.canSwipe=!this.deviceDetector.isDesktopDevice(),this.carousel.cards.length>0&&(this.maxCardContainerWidths=[this.maxCardContainerWidth(1),this.maxCardContainerWidth(2),this.maxCardContainerWidth(3),this.maxCardContainerWidth(4)])},e.prototype.navigateCards=function(e){var t=this,n=this.currentCarouselPage+e*this.cardIncrement;return n<this.cards.length&&n>=0&&(this.navigationAnnouncement="",e<0?setTimeout((function(){return t.navigationAnnouncet.navigationAnnouncement=t.nextPage}),0),this.currentCarouselPage=n,this.logNavClick(e),!0)},e.prototype.updateCarouselCardData=function(e){void 0===e&&(e=0),this.carouselElement&&(this.cardIncrement=this.getNue.trackByIndex=function(e){return e},e.prototype.sharedInit=function(){this.cardMinWidth=this.capabilitiesService.capabilities.fluentRefresh&&this.componentArea!==i.b.AppCategory?368:217,this.cardMargin=this.capabilitiesService.capabilities.fluentRefresh&&this.componentArea!==i.b.AppCategory?20:12,this.disableAnimation=this.capabilitiesService.capabilities.disableAnimation,this.nextPage=this.locService.ButtonNextPage,this.previousPage=this.locService.ButtonPreviousPage},e.prototype.maxCardContainerWidth=function(e){return(this.cardMinWidth+this.cardMargin)*e},e.prototype.logNavClick=function(e){var t={};t.Index=this.currentCarouselPage.toString(),t.Increment=this.cardIncrement.toString(),t.TotalSize=this.cards.length.toString(),this.navClickLogging(t,e<0?"NavPrevious":"NavNext")},e.prototype.getNumCards=function(e){if(void 0===e&&(e=0),!this.cards||!this.cards.length)return 0;this.changeDetector.detectChanges();var t=this.carouselContainer.nativeElement.clientWidth+this.cardMargin;!e||this.capabilitiesService.capabilities.fluentRefresh&&this.componentArea!==i.b.AppCategory||(t-=this.cardMargin+e);for(var n=this.maxCardsPerLine;n>0;n--)if(t>=this.maxCardContainerWidths[n-1])return n},e}())},DQbD:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("4/We"),r=n("cgnd"),o=n("/I02"),.userContextService=i,this.bootId=0}return Object.defineProperty(e.prototype,"HostContext",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audience",{get:function(){var e=this.capabilitiesService.capabilities.fluidAudience;return"Production"===e&&this.userContextService.user.isGcc?"GCC":e},enumerable:!0,configurable:!0}),Object.defineProper.sharedClientStartupContext.buildId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostCorrelationId",{get:function(){return this.clientStartupConfigService.config.sharedClientStartupContext.correlationId+"."+this.bootId},enumerable:!0,configurable:!0}),e.prototype.getBootId=function(){return this.bootId},Object.definePropedClientStartupContext.correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(Context.officeMarket.toLowerCase()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostName",{get:function(){return"Office.com"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostAppName",{get:function(){return"Office.com"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostAppPlatform",{get:function(){return"Web"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userContext",{get:function(){return{user:{id:this.clientStartupConfigService.config.puid,tenantId:this.clientStartupConfigService.config.tenantId}}},enumerable:!0,configurable:!0}),e.prototype.resetFluidHostContext=function(e){e&&(this.hostScenarioStartTime=void 0,this.hostScenarioName=void 0),this.bootId++},e.ɵprov=l.kc({factory:function(){return new e(l.lc(r.b),l.lc(o.a),l.lc(i.a),l.lc(a.a))},token:e,providedIn:"root"}),e}()},Dn7E:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("TfV2"),r=n("ZBSS"),o=n("zGJG"),a=n("uqr+"),l=n("9KSV"),s=n("dSKW"),c=n("uV9m");function u(e,t){void 0===t&&(t=i.a.Security),Object(c.g)(function(e){return["Feature",e].join(o.b)}(e.featureName),function(e){var t,n,i={};for(var o in e.params)i[Object(a.a)([r.D,o])]="string"==typeof e.params[o]?Object(l.a)(e.params[o]):e.params[o];if(i[r.A]="Feature",i[r.B]=e.eventName,Object(c.e)()){var u=Object(s.b)(Object(c.b)());i[Object(a.a)([r.D,r.Y])]=u,i[Object(a.a)([r.D,r.Z])]=Object(s.d)(u),i[Object(a.a)([r.D,r.X])]=Object(s.c)(u)}return i[Object(a.a)([r.D,r.j])]=null!==(t=e.area)&&void 0!==t?t:"",i[Object(a.a)([r.D,r.jb])]=null!==(n=e.subArea)&&void 0!==n?n:"",i}(e),t)}},Dpxn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"EH+r":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("TfV2"),r=n("ZBSS"),o=n("GMuP"),a=n("tyUq"),l=["Check_Login"];function s(e,t){void 0===t&&(t=i.a.Security),Object(a.a)({eventName:e.eventName,error:e.error,latency:e.latency,fromCache:e.fromCache,httpCode:e.httpCode,area:e.area,subArea:e.subArea,id:e.instrumentationParams&&e.instrumentationParams.RequestId?e.instrumentationParams.RequestId:""},t,function(e){return l.includes(e)}(e.eventName)),(e.httpCode<200||e.httpCode>=300)&&e.instrumentationParams&&Object.keys(e.instrumentationParams).length>0&&(e.instrumentationParams[r.I]=e.httpCode,e.error&&(e.instrumentationParams[r.v]=e.error),e.fromCache&&(e.instrumentationParams[r.H]=e.fromCache),e.latency&&(e.instrumentationParams[r.V]=e.latency),Object(o.a)({eventName:e.eventName,params:e.instrumentationParams,area:e.area,subArea:e.subArea},t))}},EUVs:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var i=n("QjXU"),r=n("CMIS"),o=n("AlWG"),a=n("f0qX"),l=n("3Vsh"),s=n("DrEg"),c=n("lFv5"),u=n("dpyN"),d=n("6/Wk"),p=n("hhzZ"),f=n("BaAg"),h=n("jCfB"),m=n("4/We"),b=n("/I02"),g=n("ufVG"),v=n("IBRu"),S=n("pjz5"),y=n("y9oG"),C=n("hZW2"),w=n("Z0U4"),T=n("5aVq"),k=n("Xc4i"),I=n("BMb5"),_=n("keVe"),A=n("X+PR"),P=n("TOqr"),E=function(){function e(e,t,n,i,r,a,l,s,c,u,d){this.activatedRoute=e,this.capabilitiesService=t,this.contextService=n,this.documentService=i,this.instrumentationService=r,this.location=a,this.officeRouteService=l,this.reactShellConfigService=s,this.shellShimService=c,this.uiHostBootstrapperService=u,this.windowService=d,this._loadedDocuments=new o.a(new Map),this.capabilitiesService.wacHostEnabled()&&(this.setupAbandonListener(),this.capabilitiesService.capabilities.isEmbedMode||this.setupResetShellListener())}return e.getParamsForDocumentInfo=function(e,t){return void 0===t&&(t={}),this.getWacParams(e.driveId,e.docId,e.docUrl,t)},e.getParamsForMruFileItem=function(e,t){return void 0===t&&(t={}),this.getWacParams(e.driveId,e.docId,e.canonicalUrl,t)},e.getWacParams=function(e,t,n,r){var o;return void 0===r&&(r={}),Object(i.__assign)(Object(i.__assign)({},r),((o={})[h.a.DriveId]=e,o[h.a.ItemId]=t,o[h.a.DocUrl]=n,o))},e.getDocumentInfoForMruFileItem=function(e,t){return{docId:e.docId,docUrl:e.canonicalUrl,driveId:e.driveId,fileType:e.fileType,fileName:e.fileName,wdOrigin:t}},e.isValidDocumentInfo=function(e){return!!e.docId&&!!e.driveId||!!e.docUrl},e.prototype.bootstrapAndRouteMruFileItem=function(t,n,i,r,o){void 0===i&&(i={}),this.bootstrapAndRoute(e.getDocumentInfoForMruFileItem(t,n),i,r,o?this.uiHostBootstrapperService.convertMruInflationPromise(o,n,r):void 0)},e.prototype.bootstrapAndRoute=function(e,t,n,r){return void 0===t&&(t={}),Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)?[4,this.bootstrap(e,n,r)]:[2];case 1:return i.sent()(t),[2]}}))}))},e.prototype.bootstrapZeroByteFile=function(t,n,r,o,a){var l=this;if(this.capabilitiesService.wacHostEnabledForFileType(t.fileType)){var s=r.then((function(n){var i={docId:n.docId,driveId:n.driveId,docUrl:n.canonicalUrl,fileName:n.fileName,wdOrigin:t.wdOrigin,fileType:t.fileType,newFile:!0},r=""+l.windowService.nativeWindow.location.origin+l.getContentPath(t.fileType)+"?"+l.getQueryParamString(e.getParamsForDocumentInfo(i));return i.newFileInfo={NewFilePath:r,TemplateSource:o?{FileGetUrl:"",DocUniqueId:o}:void 0},i})),c=this.uiHostBootstrapperService.bootstrapZeroByteDocument(t,n,s,o,a);return function(){return Object(i.__awaiter)(l,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.logLoadStart(c),[4,this.updateBootedDocumentsMap(c)];case 1:return t.sent()(),cation(c.bootedDocumentInfo.bootId,t)})),[2]}}))}))}}},e.prototype.bootstrapDocumentFromLoader=function(e,t,n){var r,o,a;return void 0===n&&(n=!1),Object(i.__awaiter)(this,void 0,void 0,(function(){var l,s,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)?[4,this.hasLoadedDocumentsObservable().toPromise()]:[2];case 1:return l=i.sent(),n&&l||(s=this.getApplicationParamsFromDocument(e),e.applicationUrlParams=s,(c=e.applicationUrlParams.actnavid)&&!(null===(a=null===(o=null===(r=this.activatedRoute)||void 0===r?void 0:r.snapshot)||void 0===o?void 0:o.queryParams)||void 0===a?void 0:a[h.a.Nav])&&this.officeRouteService.updateQueryParams({nav:c}),this.bootstrap(e,t)),[2]}}))}))},e.prototype.loadMruItem=function(e,t,n){return void 0===n&&(n=!1),this.bootstrap({docId:e.docId,driveId:e.driveId,docUrl:e.canonicalUrl,fileType:e.fileType,wdOrigin:this.contextService.getWdOrigin(t)},Date.now(),void 0,n)},e.prototype.prebootDocument=function(e,t){this.uiHostBootstrapperService.prebootDocument({docId:e.docId,driveId:e.driveId,docUrl:e.url,fileType:e.fileType,wdOrigin:this.contextService.getWdOrigin(t)})},e.prototype.bootstrap=function(e,t,n,i){if(void 0===t&&(t=Date.now()),void 0===i&&(i=!1),this.capabilitiesService.wacHostEnabledForFileType(e.fileType)){var r=this.uiHostBootstrapperService.bootstrapItem(e,t,n);return this.logLoadStart(r),this.updateBootedDocumentsMap(r,i)}},e.prototype.prebootApplication=function(e,t){if(e===f.b.Visio){var n=this.uiHostBootstrapperService.bootstrapApplication(e,t);if(n){var i=n.correlationAndBoot[1],r=new o.a({bootAndLoadInfo:n.loadData,visible:!1,bootCompleted:!1});this._loadedDocuments.next(new Map([[i,r]]))}}},e.prototype.updateBootedDocumentsMap=function(t,n){var r;return void 0===n&&(n=!1),Object(i.__awaiter)(this,void 0,void 0,(function(){var a,l,s,c,u,d,p,h,m,b=this;return Object(i.__generator)(this,(function(g){switch(g.label){case 0:return a=Object(i.__read)(Object(v.a)(),3),l=a[0],s=a[1],c=a[2],[4,this.getCurrentLoadedDocuments()];case 1:return u=g.sent(),(d=u.get(t.bootedDocumentInfo.bootId))?(m=d.getValue(),d.next(Object(i.__assign)(Object(i.__assign)({},m),{visible:!n,bootAndLoadInfo:t}))):(p={bootAndLoadInfo:t,visible:!n,bootCompleted:!1,routeEndPromise:l},this.locationSubscription&&!(null===(r=this.locationSubscription)||void 0===r?void 0:r.closed)||(this.locationSubscription=this.location.subscribe((function(t){var n,i=null!==(n=t.url)&&void 0!==n?n:"",r=S.a.getQueryParams(i),o=b.getAppNameFromUrl(i),a=f.a.fileTypeNameToFileType(o),l=b.getDocumentInfoFromParams(r,a);l&&e.isValidDocumentInfo(l)&&b.bootstrapDocumentFromLoader(l,Date.now(),!1)}))),h=new o.a(p),this._loadedDocuments.next(new Map([[t.bootedDocumentInfo.bootId,h]]))),[2,function(e){void 0===e&&(e={}),b.routeToContentPage(t.boo).then((function(e){return e?s():c()}))}]}}))}))},e.prototype.updateInformation=function(t,n,r,o){var a,l=this;void 0===o&&(o=!1);var s=null===(a=this._loadedDocuments.getValue())||void 0===a?void 0:a.get(t);if(s){var c=s.getValue();if(c){var u=Object(i.__assign)(Object(i.__assign)({},c),{bootAndLoadInfo:{correlationId:c.bootAndLoadInfo.correlationId,bootedDocumentInfo:{bootId:t,documentInfo:null!=n?n:c.bootAndLoadInfo.bootedDocumentInfo.documentInfo},data:c.bootAndLoadInfo.data},visible:null!=r?r:c.visible});s.next(u),o&&c.routeEndPromise.then((function(){var t=e.getParamsForDocumentInfo(u.bootAndLoadInfo.bootedDocumentInfo.documentInfo);l.officeRouteService.updateQueryParams(t)}))}}},e.prototype.unloadAllDocuments=function(){this.locationSubscription.unsubscribe(),this._loadedDocuments.next(new Map)},e.prototype.resetShell=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,o,a=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.capabilitiesService.capabilities.isEmbedMode?[2]:(t=this.documentService.nativeDocument.getElementById("ReactShellHeader"))&&t.childElementCount?(this.documentService.removeCssClassFromElement(t,e.HiddenShellClass),[4,this.shellShimService.getShellShim()]):[3,2];case 1:return(n=i.sent()).Notifications.UnmuteToasts&&n.Notifications.UnmuteToasts(),[3,3];case 2:(o=this.reactShellConfigService.reactShellConfig.resourceUrl)&&the.nativeWindow.bootstrapReactShell()}),(function(){var e,t=((e={}).ShellBootAfterStartup="true",e.ResourceUrl=o,e);a.instrumentationService.logErrorEvent("Shell_Bootstrapper_Load_Error",t),Object(r.a)({eventName:"Shell_Bootstrapper_Error",errorType:"Shell_Bootstrap_Error",message:"Fail to add shell bootstrap script to page.",debugInfo:JSON.stringify(t)})})),i.label=3;case 3:return[2]}}))}))},e.prototype.getLoadedDocumentsObservable=function(){return this._loadedDocuments.asObservable().pipe(Object(a.a)((functiootId:t,data:e.get(t).asObservable()}}))})))},e.prototype.hasLoadedDocumentsObservable=function(){return this._loadedDocumct(a.a)((function(e){return e.size>0})),Object(l.a)(1))},e.prototype.getCurrentLoadedDocuments=function(){return this._loadedDocuments.asObservable().pipe(Object(s.a)()).toPromise()},e.prototype.getDocumentInfoFromParams=function(e,t,n){var i,r,o=e[h.a.ItemId],a=e[h.a.DriveId],l=null!==(r=this.decodeParamWithKey(e,h.a.DocUrl))&&void 0!==r?r:this.decodeParamWithKey(e,h.a.ContentUri),s=e[h.a.Nav];return{docId:o,driveId:a,docUrl:l,wdOrigin:null!=n?n:this.contextService.getWdOrigin("DIRECT"),applicationUrlParams:s?(i={},i.actnavid=s,i):void 0,fileType:t}},e.prototype.getWacHostControlQueryParams=function(t){return e.WacHostControlFileTypes.indexOf(t)>=0&&this.capabilitiesService.capabilities.wacHostControlFlight?this.capabilitiesService.capabilities.pwaEnabled?{wdwachostcf:"hwa"}:{wdwachostcf:"web"}:{}},e.prototype.markBootCompleted=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:return t=this._loadedDocuments.getValue(),[4,(n=t.get(e)).asObservable().pipe(Object(s.a)()).toPromise()];case 1:return r=o.sent(),n.next(Object(i.__assign)(Object(i.__assign)({},r),{bootCompleted:!0})),[2]}}))}))},e.prototype.getApplicationParamsFromDocument=function(e){var t,n=e.docUrl;if(!n)return{};var i=S.a.getQueryParams(n),r=i?i.nav:void 0;return r?((t={}).actnavid=r,t):{}},e.prototype.routeToContentPage=function(t,n){var i=e.getParamsForDocumentInfo(t,n);return this.officeRouteService.navigateTo({route:"Content",app:t.fileType},!1,i)},e.prototype.decodeParamWithKey=function(e,t){var n=e[t];if(n){var i=n;try{i=decodeURIComponent(n.replace(/\+/g," "))}catch(e){i=null!=n?n:void 0}return i}},e.prototype.getContentPath=function(e){return""+this.capabilitiesService.capabilities.startPageRootPath+f.b[e].toLowerCase()+this.capabilitiesService.capabilities.wacHostPagePath},e.prototype.getQueryParamString=function(e){return Object.keys(e).filteunction(t,n){return t+"&"+n+"="+e[n]}),"").slice(1)},e.prototype.getAppNameFromUrl=function(e){if(e){var t=e.split("/");if(t.length>=3)return t[2]}},e.prototype.setupAbandonListener=function(){var e=this;this.getLoadedDocumentsObservable().pipe(Object(c.a)()).subscribe((function(t){var n=Object(i.__read)(t,2),r=n[0],o=n[1];null==r||r.forEach((function(t){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(n){switch(n.label)nction(e){return t.bootId===e.bootId})))?[3,2]:[4,t.data.pipe(Object(s.a)()).toPromise()];case 1:(e=n.sent()).bootCompleted||this.logAbandon(e.bootAndLoadInfo),n.label=2;case 2:return[2]}}))}))}))}))},e.prototype.setupResetShellListener=function(){var e=this;this.hasLoadedDocumentsObservable().pipe(Objcribe((function(t){t||e.resetShell()}))},e.prototype.logLoadStart=function(e){this.instrumentationService.logGenericEvent("WacDocument_Load_Start",Object(y.a)(e.correlationId,e.bootedDocumentInfo.documentInfo))},e.prototype.logAbandon=function(e){this.instrumentationService.logGenericEvent("WacDocument_Abandon",Object(y.a)(e.correlationId,e.bootedDocumentInfo.documentInfo))},e.HiddenShellClass="hide-shell",e.WacHostControlFileTypes=[f.b.Word,f.b.Excel,f.b.PowerPoint],e.ɵprov=_.kc({factory:function(){return new e(_.lc(A.a),_.lc(m.a),_.lc(b.a),_.lc(C.a),_.lc(p.a),_.lc(P.g),_.lc(w.a),_.lc(g.a),_.lc(T.a),_.lc(k.a),_.lc(I.b))},token:e,providedIn:"root"}),e}()},EVbV:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return D}));var i=n("keVe"),r=n("pzhl"),o=n("PkQn"),a=n("4/We"),l=n("1GMS"),s=n("cAxl"),c=n("3bNC"),u=n("TOqr"),d=n("Jn4Q"),p=n("dx17"),f=n("hZW2"),h=n("y1jW"),m=n("7Gwk"),b=n("hhzZ"),g=n("PBJH"),v=n("kfAr"),S=n("AY/E"),y=n("1Bt+"),C=n("TIi1"),w=n("EUVs"),T=n("BMb5"),k=i.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}}]}});function I(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[],[[1,"aria-label",0]],null,null,r.b,r.a)),i.Gb(1,638976,null,0,o.a,[a.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null)],(function(e,t){var n=t.component;e(t,1,0,i.Ob(1,"ms-fcl-tp activity-icon ",n.iconCssClass,""),n.htmlDescription.icon,n.iconSize)}),(function(e,t){var n=t.component;e(t,0,0,null==n.htmlDescription||null==n.htmlDescription.activityDescription?null:n.htmlDescription.activityDescription.plainText)}))}function _(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-person-picture",[],null,null,null,l.b,l.a)),i.Gb(1,573440,null,0,s.a,[c.a],{person:[0,"person"],personPicturn(e,t){(),i.gc(-1,null,[" - "]))],null,null)}function P(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"span",[],null,null,null,null,null)),i.Gb(1,278528,null,0,u.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(2,{"activity-deep-link__underlined ms-fcl-tp":0}),(e()(),i.gc(3,null,["",""]))],(function(e,t){var n=t.component,i=e(t,2,0,n.teamsDeepLink&&n.activityDeepLinkHovered);e(t,1,0,i)}),(function(e,t){e(t,3,0,t.component.inTeams)}))}function E(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,7,"div",[["class","activity-description__date"]],[[8,"title",0]],null,null,null,null)),i.Gb(1,278528,null,0,u.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"activity-description__title--clipped":0,"activity-description__date--fluent ms-fcl-npa":1}),(e()(),i.gc(3,null,[" "," "])),(e()(),i.qb(16777216,null,null,1,null,A)),i.Gb(5,16384,null,0,u.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,P)),i.Gb(7,16384,null,0,u.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,!!n.title,n.fluentRefresh);e(t,1,0,"activity-description__date",i),e(t,5,0,n.teamsecondLine,"")),e(t,3,0,n.secondLine)}))}function O(e){return i.jc(0,[(e()(),i.Hb(0,0,[[1,0],["descriptionElement",1]],null,7,"span",[["class","activity-description ms-fcl-ns"]],null,null,null,null,null)),i.Gb(1,278528,null,0,u.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"activity-description--clipped":0,"activity-description--card":1,"activity-description--card--fluent":2,"activity-description--mobile":3,"activity-description--motion-padding":4,"ms-fcl-ns":5,"ms-fcl-nd":6}),(e()(),i.Hb(3,0,null,null,2,"span",[],[[8,"innerHTML",1]&&(i=!1!==e.component.onHover()&&i),i}),null,null)),i.Gb(4,278528,null,0,u.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(5,{"activity-deep-link ms-fcl-tp":0,"list-item__text--large activity-description__title--clipped ms-fcl-ns":1,"activity-description--large":2}),(e()(),i.qb(16777216,null,null,1,null,E)),i.Gb(7,16384,null,0,u.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.numLines,2===n.numLines&&!n.fluentRefresh,2===n.numLines&&n.fluentRefresh,n.mobileListItem&&2!==n.numLines,!!n.title,!n.fluentRefresh,n.fluentRefresh);e(t,1,0,"activity-description ms-fcl-ns",i);var r=e(t,5,0,n.activityDeepLink&&n.activityDeepLinkHovered,!!n.title,n.timestampAndTitleInSameLine);e(t,4,0,r),e(t,7,0,2===n.numLines)}),(function(e,t){var n=t.component;e(t,3,0,n.htmlDescription.html,i.Ob(1,"",null==n.htmlDescription||null==n.htmlDescription.activityDescription?null:n.htmlDescription.activityDescription.plainText,""))}))}function F(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,null,null,null,null,null,null,null)),i.Vb(null,0),(e()(),i.qb(0,null,null,0))],null,null)}function D(e){return i.jc(0,[i.cc(671088640,1,{descriptionElement:0}),(e()(),i.Hb(1,0,null,null,8,"div",[],[[24,"@fadeIn",0],[8,"id",0]],[[n&&(i=!1!==r.activityUnhovered()&&i),i}),null,null)),i.Gb(2,278528,null,0,u.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(3,{"activity-description__container":0,"activity-description__container--mobile":1}),(e()(),i.qb(16777216,null,null,1,null,I)),i.Gb(5,16384,null,0,u.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,_)),i.Gb(7,16384,null,0,u.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,O)),i.Gb(9,16384,null,0,u.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,F)),i.Gb(11,16384,null,0,u.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,!n.iconOnly,n.mobileListItem);e(t,2,0,i),e(t,5,0,(null==n.htmlDescription?null:n.htmlDescription.icon)&&n.showIcon),e(t,7,0,!n.showIcon&&(null==n.person?null:n.person.email)),e(t,9,0,(null==n.htmlDescription?null:n.htmlDescription.html)&&!n.iconOnly),e(t,11,0,!n.htmlDescription)}),(function(e,t){var n=t.component;e(t,1,0,n.activityState,n.docId?n.getActivityElementId():null)}))}i.Db("ohp-activity-description",d.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,D,k)),i.Gb(1,5226496,null,0,d.a,[p.a,a.a,i.h,f.a,h.b,m.a,b.a,g.a,v.a,S.a,y.a,C.a,w.a,T.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{activities:"activities",lastViewedTime:"lastViewedTime",iconOnly:"iconOnly",showIcon:"showIcon",person:"person",iconCssClass:"iconCssClass",iconSize:"iconSize",activityDeepLink:"activityDeepLink",title:"title",docId:"docId",activityDescriptionInput:"activityDescriptionInput",index:"index",fileType:"fileType",navId:"navId",numLines:"numLines",mobileListItem:"mobileListItem",teamsDeepLink:"teamsDeepLink",area:"area",useSolidIcon:"useSolidIcon",timestampAndTitleInSameLine:"timestampAndTitleInSameLine"},{},["*"])},EYcb:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));vaunction e(){this._error=new i.a(nuialog=function(e){this._error.next(e)},Object.defineProperty(e.prototype,"error",{get:function(){return this._error.asObservable()},enumerable:!0,configurable:!0}),e.ɵprov=r.kc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},Epfv:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));var i=n("QjXU");function r(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(618).then(n.t.bind(null,"yfDh",7))];case 1:return[2,e.sent().default]}}))}))}function o(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e?[2,new TextEncoder]:[4,r()];case 1:return[2,new(t.sent().TextEncoderLite)]}}))}))}function a(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e?[2,new TextDecoder]:[4,r()];case 1:return[2,new(t.sent().TextDecoderLite)]}}))}))}function l(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,o("TextEncoder"in t)];case 1:return[2,n.sent().encode(e)]}}))}))}function s(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,a("TextDecoder"in t)];case 1:return[2,n.sent().decode(e)]}}))}))}},EqbI:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("QjXU"),r=n("hhzZ"),o=n("R7NL"),a=n("/I02"),l=n("kpuN"),s=n("wwmn"),c=n("v3sZ"),u=n("casz"),d=n("pOWU"),p=n("keVe"),f=n("TOqr"),h=function(e){function t(t,n,i,r,o,a,l,s){var c=e.call(this,t,n,i,"OneNote",r,o,l,s)||this;return c.oneNoteConfigService=a,c.COPY_CLASS_NOTEBOOK="/notebooks/saveacopy",c.CLIENT_DEV_MODE_RESOURCE_URL="https://www.onenote.com",c.BASE_URL="/api",c.VERSION="1.0",c.newPageHtml="<!DOCTYPE html>\n    <html>\n      <head>\n        <title>{PAGETITLE}</title>\n      </head>\n      <body>\n      </body>\n    </html>",c.getClassNoteBookPromise=null,c.inMockMode=r.sharedContext.inMockMode,c}return Object(i.__extends)(t,e),t.prototype.getClassNoteBooks=function(){var e=this,t={};return this.getClassNoteBookPromise||(this.getClassNoteBookPromise=new Promise((function(n,i){e.get("Get_ClassNotebooks_Request","Get_ClassNotebooks",e.oneNoteConfigService.config.oneNoteApiPath+e.BASE_URL+"/v"+e.VERSION+"/me/notes/classnotebooks?hasaccessto=true&orderby=lastModifiedTime desc",(function(t){t.instrument((function(t,n){n.RequestId)})).then((function(e){n(e.data.value)}))}),(function(t){e.getClassNoteBookPromise=null,i(t)}),t,"network-only")}))),this.getClassNoteBookPromise},t.prototype.generateSaveCopyClassNotebookLink=function(e,t,n){var i=this.inMockMode?this.CLIENT_DEV_MODE_RESOURCE_URL:this.oneNoteConfigService.config.oneNoteApiPath,r=e.indexOf("-"),o=e.substring(0,r),a=e.substring(r+1).toLowerCase();return""+i+this.COPY_CLASS_NOTEBOOK+"/?notebookId="+o+"|{"+a+"}&notebookName="+t+"&notebookUrl="+n},t.prototype.getNotebookSections=function(e,t,n){var i=this,r="/myOrganization/siteCollections/"+e+"/sites/"+t+"/notes/notebooks/1-"+n+"/sections",o={};return new Promise((function(a,l){i.get("Get_OneNote_Sections_Request","Get_OneNote_Sections",i.oneNoteConfigService.config.oneNoteApiPath+i.BASE_URL+"/v"+i.VERSION+r,(function(r){r.instrument((function(e,t){t.RequestId=i.getRequestIdFromResponse(e)})).then((function(i){var r=(i&&i.data&&i.data.value||[]).map((function(i){return{name:i.name,siteId:e,webId:t,listItemUniqueId:n,sectionId:i.id,key:i.id}}));a(r)}))}),(function(e){l(e)}),o,"network-only")}))},t.prototype.createPageInSection=function(e,t,n,i){var r=this,o={headers:new Map};o.headers.set("Content-Type","text/html");var a="/myOrganization/siteCollections/"+e+"/sites/"+t+"/notes/sections/"+n+"/pages";return new Promise((function(e,t){r.post("Get_OneNote_Page_Request","Get_OneNote_Page",r.oneNoteConfigService.config.oneNoteApiPath+r.BASE_URL+"/v"+r.VERSION+a,r.newPageHtml.replace("{PAGETITLE}",i),(function(n){n.instrument((function(e,t){t.RequestId=r.getRequestIdFromResponse(e)})).then((function(n){var i=n.data;i&&i.links&&i.links.oneNoteWebUrl.href?e(i.links.oneNoteWebUrl.href):t("error parsing response")})).catch((function(e){t(e)}))}),(function(e){e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()}),o)})eturn e.headers.get("X-CorrelationId")},t.ɵprov=p.kc({factory:function(){return new t(p.lc(l.b),p.lc(r.a),p.lc(o.a),p.lc(a.a),p.lc(s.a),p.lc(c.a),p.lc(f.q),p.lc(u.a))},tyed",e[e.Failed=4]="Failed"}(i||(i={}))},EuUe:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Eup2:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("QjXU"),r=n("keVe"),o=n("CMIS"),a=n("laSs"),l=n("lUkk"),s=n("Dn7E"),c=n("zvoD"),u=n("f0qX"),d=n("3Vsh"),p=n("DCBR"),f=(n("lrJm"),n("vcPZ")),h=(n("SPVw"),n("kaEK")),m=n("0ZeC"),b=(n("dOgD"),n("CC5A")),g=n("hhzZ"),v=(n("Vwd8"),n("BaAg")),S=n("Eu1D"),y=(n("QOOv"),n("JT1q")),C=(n("7wk3"),n("AXqk"),n("W3Zz")),w=(n("hZW2"),n("7Gwk"),n("U8M1"),n("rBEp"),n("Uqr9"),n("xoWf"),n("BMb5"),n("4/We"),n("cgnd"),n("/I02"),n("PBJH"),n("RJiy"),n("gO/A"),function(e){function t(t,n,i,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S,y,C,w,T,k){var I=e.call(this,t,n,p,h,m,f)||this;return I.capabilitiesService=t,I.changeDetector=n,I.recommendedService=i,I.contextService=o,I.floodgateService=a,I.globalErrorHandler=l,I.performanceService=s,I.jumpListService=c,I.browserPaintMeasurementService=u,I.mruConfigService=d,I.deviceDetector=p,I.locService=f,I.instrumentationService=m,I.dataSecurityService=b,I.eventService=g,I.userDataStorageService=v,I.featureCalloutService=S,I.userProfileService=y,I.officeFeedService=C,I.clientStartupContextService=w,I.windowService=T,I.visualService=k,I.currentCarouselPage=0,I.translateX="0",I.stateChanged=new r.q,I}return Object(i.__extends)(t,e),t.prototype.ngOnInit=function(){var e=this;this.sharedInit();var n=this.capabilitiesService.capabilities;this.stateChanged.emit({state:S.a.Loading}),this.mruConfig=this.mruConfigService.config,this.fluentRefresh=n.fluentRefresh,this.canSwipeRecommended=this.deviceDetector.isMobileDevice(),this.visibleCardPeek=this.fluentRefresh?0:40,this.appFilter=this.fileType?new Set([this.fileType]):null,this.fileType&&this.fileType===v.b.Stream&&(this.appFilter.add(v.b.Video),this.appFilter.add(v.b.PlayList)),this.isOfficeFeed=(this.mruConfig.officeFeedControlEnabled||this.mruConfig.officeFeedFlightEnabled)&&!this.isStartPage,this.listId=this.isOfficeFeed?t.officeFeedListId:t.recommendedListId,this.recommendedEnabled=this.mruConfig.recommendedEnabled&&this.fileType!==v.b.Sway&&this.fileType!==v.b.OneNote&&this.fileType!==v.b.Forms&&(this.fileType!==v.b.Visio||this.mruConfig.recommendedVisioEnabled),this.showAnalytics=this.mruConfig.analyticsEnabled&&this.fileType===v.b.Sway,this.showActivity=!this.showAnalytics&&this.mruConfig.activityEnabled&&this.fileType!==v.b.OneNote,this.showSharing=!this.showAnalytics&&this.mruConfig.sharingStatusEnabled,this.componentArea=this.isSuggestedActions?g.b.SuggestedActions:g.b.Recommended,this.recommendedMotion=this.mruConfig.recommendedMotionEnabled&&!this.canSwipeRecommended&&this.deviceDetector.deviceInfo.browser.browserType!==C.a.Safari,this.recommendedDocView=this.isSuggestedActions?"SuggestedAction":"Card";var i=function(t){e.eventService.broadcastEvent({name:"recommendedReady",args:[t]})};if(this.recommendedTitle=this.isSuggestedActions?this.locService.RecommendedActionsSectionTitle:this.locService.RecommendedDocumentsSectionTitle,this.recommendedEnabled){var r=void 0;this.isOfficeFeed?(r=this.officeFeedService.getOfficeFeed(),this.officefeedBounce=this.eventServinction(e){returject(u.a)((function(e){return e.args[0]}))).subscribe((function(t){if(e.cards){var n=Math.min(e.currentCarouselPage+e.cardIncrement-1,e.cards.length-1),i=e.cards[n];i&&e.officeFeedService.logInstrumentation([i.feedbackId],["bounce"],[i.fromCache?"cache":"service"],[t])}}))):r=this.recommendedService.getRecommendedDocs(this.appFilter),r?(this.recommendedStream=r.results.subscribe((function(t){return e.processRecommendedTask(t)})),r.resultn((function(e){return i(e.items.length)})),r.initialCompletion.then((function(t){t&&(e.globalErrorHandler.handleCacheObservableError(t,"tCyIn","jtlYX"),e.stateChanged.emit({state:S.a.Failed}),i(0),t.cacheError&&t.networkError&&(e.eventService.broadcastEvent({name:"recommendedFailed",args:[]}),Object(o.a)({eventName:"Recommended_Error",area:e.componentArea})))}))):i(0)}else i(0);this.capabilitiesService.capabilities.visualBackgroundEnabled&&(this.visualRefreshSubscription=this.visualSerisualRefresh=t.visualBackgroundEnabled)})))},t.prototype.onScrollFocus=function(e){(e?this.recommendedNavLeft:this.recommendedNavRight).nativeElement.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})},t.prototype.ngAfterViewChecked=function(){var e=this;this.recommendedEnabled&&this.mruConfig.recommendedCalloutEnabled&&!this.recommendedCalloutPromise&&void 0!==this.carouselElement&&this.cards&&this.cards.length>0&&(this.recommendedCalloutPromise=this.userProfileService.doesMetricExist("Recommended_Callout_Impression",!0),this.recommendedCalloutPromise.then((function(t){t||e.userDataStorageService.get("SawRecommended",1).then((function(t){if(t)e.userProfileService.incrementMetric("Recommended_Callout_Impression");else{var n=e.documentService.nativeDocument.querySelector(".list-header__title--card-carousel");e.featureCalloutService.addCallout(new f.a(n,"Recommended",g.b.Documents,e.locService.RecommendedDocumentsCalloutTitle,e.locService.RecommendedDocumentsCalloutSubtitle,null,null,null,!1,!1,!0)),e.instrumentationService.logImpressionEvent("Recommended_Callout_Impression",{},["Recommended_Callout_Impression"]),Object(a.a)({eventName:"Recommended_Callout",area:"Recommended"})}}))})))},t.prototype.ngOnDestroy=function(){var e;this.recommendedStream&&this.recommendedStream.unsubscribe(),this.officefeedBounce&&this.officefeedBounce.unsubscribe(),null===(e=this.visualRefreshSubscription)||void 0===e||e.unsubscrtate="",this.checkCorrectTranslation())},t.prototype.navigateCards=function(t){var n;if(e.prototype.navigateCards.call(this,t)){if(this.isOfficeFeed){var r=this.cards.slice(this.currentCarouselPage,this.currentCarouselPage+this.cardIncrement);this.logOfficeFeedGeneralViews(r),this.loggedFirstScroll&&this.loggedLimitScroll||this.logOfficeFeedScroll()}if(this.recommendedMotion){var o=Math.min(this.currentCarouselPage+this.cardIncrement+1,this.cards.length-1);o>this.recommendedMotionList.length&&(n=this.recommendedMotionList).push.apply(n,Object(i.__spread)(this.cards.slice(this.recommendedMotionList.length,o+1))),this.setRightOffset(),this.translateX=this.fluentRefresh?"translateX("+100*-t+"%)":"translateX("+100*-t+"%) translateX("+t*(this.cardMargin+this.visibleCardPeek)+"px)",this.motionState="moving"}return this.statusAnnouncement="",this.changeDetector.detectChanges(),this.statusAnnouncement=-1===t?this.locService.RecommendedScrollPreviousAriaAnnouncement:this.locService.RecommendedScrollNextAriaAnnouncement,this.logRecommendedImpression(this.cards[this.currentCarouselPage].fromCache),!0}return!1},t.prototype.updateCarouselCardData=function(){if(e.prototype.updateCarouselCardData.call(this,this.recommendedMotion?this.visibleCardPeek:0),this.recommendedMotion&&this.checkCorrectTranslation(),this.canSwipeRecommended){var t=this.virtualCards&&this.virtualCards.first&&this.virtualCards.first.nativeElement?this.virtualCards.first.nativeElement.clientWidth:null;t&&this.eventService.broadcastEvent({name:"recommendedCardSize",args:[t,501.77>this.windowService.nativeWindow.innerWidth?2:766.98>this.windowService.nativeWindow.innerWidth?3:4]})}},t.prototype.onDeleteRecommendedItem=function(e){var t,n=this.cards.indexOf(e.item);n>-1&&(this.cards.splice(n,1),this.currentCarouselPage>=this.cards.length&&(this.currentCarouselPage=Math.max(0,this.currentCarouselPage-this.cardIncrement)),this.recommendedMotion&&(this.recommendedMotionList=this.cards.slice(0,this.currentCarouselPage+this.cardIncrement+1))),this.isOfficeFeed?"myAnalyticsInsight"!==e.item.mruV2Category?this.officeFeedService.logInstrumentation([e.item.feedbackId],["neverShowAgain"],[e.item.fromCache?"cache":"service"]):this.officeFeedService.performAction(e.item.feedbackId,m.a.DismissAction,null===(t=e.item.potentialAction.filter((function(e){return e.name===m.a.DismissAction}))[0])||void 0===t?void 0:t.actionPayload):this.recommendedService.removeDocument(e.item.spoId),this.cards.length>0&&this.logRecommendedImpression(this.cards[this.currentCarouselPage].fromCache),this.statusAnnouncement="",this.changeDetector.detectChanges(),this.statusAnnouncement=this.locService.RemoveDocumentAriaTitle},t.prototype.logNavClick=function(e){var t={};t.Index=this.currentCarouselPage.toString(),t.Increment=this.cardIncrement.toString(),t.TotalSize=this.cards.length.toString(),t.ItemCategory=this.listId,t.ImpressionId=this.impressionId;var n=e<0?"NavPrevious":"NavNext";this.instrumentationService.logClickEvent("Recommended_Nav_Click",n,this.componentArea,null,null,t),Object(l.a)({id:n,eventName:"Recommended_Nav_Click",result:"Navigate",target:"Recommended",area:this.componentArea}),Object(s.a)({featureName:"Recommended",eventName:"Recommended_Nav_Click",params:t,area:this.componentArea})},t.prototype.checkCorrectTranslation=function(){this.setRightOffset(),this.carouselElement.nativeElement.style.cssText=(this.contextService.isRtl?"left":"right")+": "+this.calcTranslateX},t.prototype.setRightOffset=function(){if(this.cardIncrement){var e=this.currentCarouselPage/this.cardIncrement,t=Math.round(1e4*e)/100;this.calcTranslateX=this.fluentRefresh?"calc("+t+"% + "+20*e+"px)":"calc("+t+"% - "+this.visibleCardPeek*e+"px)"}},t.prototype.processRecommendedTask=function(e){var t=this;if(e.items){this.impressionId=e.impressionId;var n=e.items.map(this.isOfficeFeed?function(n,i){return Object(y.d)(n,"mru_item_"+i,e.impressionId,t.contextService.isRtl,t.clientStartupContextService.config.authType,e.fromCache)}:function(n,i){return Object(y.f)(n,"mru_item_"+i,e.impressionId,t.contextService.isRtl,t.clientStartupContextService.config.authType,e.fromCache)});if(this.cards&&this.copyInflationData(this.cards,n),this.cards=n,this.stateChanged.emit({state:S.a.Displayed}),this.performanceService.mark(e.fromCache?"Cached_Recommended_Ready":"Recommended_Ready"),this.browserPaintMeasurementService.recordWhenPainted("Recommended"),this.cards.length>0){if(this.maxCardContainerWidths=[this.maxCardContainerWidth(1),this.maxCardContainerWidth(2),this.maxCardContainerWidth(3),this.maxCardContainerWidth(4)],this.cardIncrement=this.getNumCards(this.recommendedMotion?this.visibleCardPeek:0),this.recommendedMotion&&(this.recommendedMotionList=this.cards.slice(0,Math.max(this.currentCarouselPage+this.cardIncrement,this.maxCardsPerLine)+1)),this.logRecommendedImpression(e.fromCache),this.isOfficeFeed){var i=this.cards.slice(0,this.cardIncrement);this.logOfficeFeedGeneralViews(i)}this.capabilitiesService.capabilities.recommendedFloodgate&&this.capabilitiesService.capabilities.showFloodgate&&this.floodgateService.recordFloodgate(["RecommendedImpressionGeneral"])}this.appFilter&&0!==this.appFilter.size||this.jumpListService.registerRecommendedJumpList(this.cards)}},t.prototype.logOfficeFeedGeneralViews=function(e){var t=e.map((function(e){return e.feedbackId})),n=e.e){return e.fromCache?"cache":"service"}));this.officeFeedService.logInstrumentation(t,n,i)},t.prototype.logOfficeFeedScroll=function(){var e=[],t=[],n=[];if(this.loggedFirstScroll){if(this.currentCarouselPage+this.cardIncrement>=this.cards.length&&!this.loggedLimitScroll){var i=Math.min(this.currentCarouselPage+this.cardIncrement-1,this.cards.length-1);e.push(this.cards[i].feedbackId),t.push("scrollLimit"),n.push(this.cards[i].fromCache?"cache":"service"),this.loggedLimitScroll=!0}}else{var r=this.cards[this.currentCarouselPage-1];e.push(r.feedbackId),t.push("scrollStart"),n.push(r.fromCache?"cache":"service"),this.loggedFirstScroll=!0}t.length>0&&e.length>0&&n.length>0&&this.officeFeedService.logInstrumentation(e,t,n)},t.prototype.copyInflationData=function(e,t){var n,r,o=function(t){var n=null;e.some((function(e){return e.documentUrl===t.documentUrl&&(n=e,!0)}))&&t.copyInflationData(n,a.mruConfig.mruActivityEnabled)},a=this;try{for(var l=Object(i.__values)(t),s=l.next();!s.done;s=l.next())o(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}},t.prototype.logRecommendedImpression=function(e){var t=this.cards,n=t.slice(this.currentCarouselPage,Math.min(this.currentCarouselPage+this.cardIncrement,this.cards.length)),i=!n||this.dataSecurityService.securityLevel>=2?n:n.filter((function(e){return!e.isLocal})),r=v.a.distributionFromFileItems(i),o={};if(o.RenderSize=(i?i.length:0).toString(),o.Distribution=r,o.ElementId=this.listId,o.TotalSize=this.getNumLoggableItems(t).toString(),o.State="Card",o.TabState=b.a[b.a.Loaded],o.ImpressionId=this.impressionId,o.FromServiceWorkerCache=(!!e).toString(),o.Area=this.componentArea,this.capabilitiesService.capabilities.suggestedActionsEnabled&&(o.SuggestedActionsDistribution=this.getSuggestedActionsDistribution(this.cards)),void 0!==this.currentCarouselPage&&(o.Index=this.currentCarouselPage.toString()),void 0!==this.cardIncrement&&(o.Increment=this.cardIncrement.toString()),t.length>0){var l=t[0].timeSinceLastOpenInSeconds();null!==l&&(o.InactivityDuration=l.toString())}this.instrumentationService.logImpressionEvent("Recommended_Impression",o),Object(a.a)({eventName:"Recommended",area:"Recommended"})},t.prototype.getNumLoggableItems=function(e){return e?this.dataSecurityService.securityLevel>=2?e.length:e.filter((function(e){return!e.isLocal})).length:0},t.prototype.getSuggestedActionsDistribution=function(e){var t=this;return e?e.reduce((function(e,n,i){return e+(0===i?"":";")+t.suggestedActionType(n)}),""):""},t.prototype.suggestedActionType=function(e){switch(e.activity.reasonType){case h.a.MyAnalytics:return"add_todo";case h.a.Task:return"view_task";case h.a.Comment:case h.a.Mention:return"reply";case h.a.Edit:case h.a.Trending:return"view_changes";case h.a.Meeting:return"join_meeting";default:return"open_in_browser"}},t.recommendedListId="recommended-mru",t.officeFeedListId="officefeed-mru",t}(p.a))},"ExL+":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n("QjXU"),r=n("hhzZ"),o=n("R7NL"),a=n("BaAg"),l=n("/I02"),s=n("idgT"),c=n("kpuN"),u=n("dQLD"),d=n("wwmn"),p=n("casz"),f=n("hoyd"),h=n("pOWU"),m=n("keVe"),b=n("TOqr"),g=function(e){function t(t,n,i,r,o,a,l,s,c,u){var d=e.call(this,t,n,i,"OfficeHome",r,o,a,l)||this;return d.odspConfigService=s,d.templatesConfigService=c,d.workloadsService=u,d.requestConfig={headers:new Map([["Accept","application/json"]])},d}return Object(i.__extends)(t,e),t.prototype.getOdspProvisioningStatus=function(e,t){var n=this;if(this.getOdspProvisioningStatusCache)return this.getOdspProvisioningStatusCache;var i=new Promise((function(i,r){n.get("ODSP_Provisioning_Status","ODSP_Provisioning_Status",n.contextService.sharedContext.officeHomeApiRoot+n.odspConfigService.config.odspProvisioningStatusApiPath,(function(e){e.then((function(e){e.data.SharepointUrl||e.data.OneDriveUrl||(n.getOdspProvisioningStatusCache=null),i(e.data)}))}),(function(e){n.getOdspProvisioningStatusCache=null,r(e)}),n.requestConfig,"network-only",void 0,void 0,t,void 0,void 0,e)}));return this.getOdspProvisioningStatusCache=i,i},t.prototype.getLicenseStatus=function(e,t,n,i){var r=this;if(this.getLicenseStatusCache)return this.getLicenseStatusCache;var o=new Promise((function(o,l){var s=r.templatesConfigService.resources(a.b.Visio);r.get("Visio_License_Status","Visio_License_Status",r.contextService.sharedContext.officeHomeApiRoot+s.LicenseStatusApiPath+"?app="+e+"&scenarioId="+t,(function(e){e.then((function(e){e.data.App||e.data.IsLicensed||(r.geton(e){r.getLicenseStatusCache=null,l(e)}),r.requestConfig,"network-only",void 0,void 0,i,void 0,void 0,n)}));return this.getLicenseStatusCache=o,o},t.prototype.checkInAppNavEnabled=function(e){var t=this;return new Promise((function(n){t.workloadsService.getWorkloadsfind((function(t){return t.FileType===e}));n(i&&i.InAppNav)}else{var r=t.find((function(e){return ion(e){return e.FileType===a.b.OneDrive}));n(r&&r.InAppNav||o&&o.InAppNav)}}))}))},t.prototype.initializeProvisioningStatus=function(){var ion(t){t&&e.getOdspProvisioningStatus()}))},t.prototype.handleQueryParam=function(e,t){"mockshellservicemode"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)},t.ɵprov=m.kc({factory:function(){return new t(m.lc(c.b),m.lc(r.a),m.lc(o.a),m.lc(l.a),m.lc(d.a),m.lc(b.q),m.lc(p.a),m.lc(u.a),m.lc(s.a),m.lc(f.a))},token:t,providedIn:"root"}),t}(h.a)},FHrx:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.configParserService=e,this.config=this.configParserService.parse("serviceWorkerEncryptionConfig")||{cryptoKey:null,digestSaltBase64:null}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.ark",e.highContrast="contrast"}(i||(i={}))},FZB6:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("6ib3"),r=n("dy1P");function o(e){switch(e){case i.a.Audio:return r.a.Audio;case i.a.Clipchamp:return r.a.Clipchamp;case i.a.Designer:return r.a.Designer;case i.a.Excel:return r.a.ExcelOnline;case i.a.Fluid:case i.a.MeetingNotes:return r.a.Loop;case i.a.Forms:case i.a.FormsQuiz:return r.a.OfficeForms;case i.a.List:return r.a.Lists;case i.a.MeetingObject:return r.a.MeetingObject;case i.a.MindMeister:case i.a.Monday:return r.a.ThirdPartyApp;case i.a.MyAnalytics:return r.a.MyAnalytics;case i.a.NewsArticle:return r.a.NewsArticle;case i.a.OneNote:case i.a.OneNoteClassNoteBook:case i.a.OneNotePage:return r.a.OneNoteOnline;case i.a.Outlook:return r.a.Mail;case i.a.Pdf:return r.a.PDF;case i.a.Photos:return r.a.Photos;case i.a.Platform:return r.a.Platform;case i.a.PlayLists:return r.a.PlayLists;case i.a.Project:case i.a.ProjectOperations:case i.a.Portfolio:return r.a.Project;case i.a.PowerBI:return r.a.PowerBI;case i.a.PowerPoint:return r.a.PowerPointOnline;case i.a.StreamsVideo:case i.a.Stream:case i.a.ScreenRecording:return r.a.MicrosoftStream;case i.a.Sway:return r.a.Sway;case i.a.Text:return r.a.Text;case i.a.ThirdParty:case i.a.Trello:return r.a.ThirdPartyApp;case i.a.UpcomingMeeting:return r.a.Calendar;case i.a.Video:return r.a.Video;case i.a.Visio:return r.a.VisioOnline;case i.a.Whiteboard:return r.a.Whiteboard;case i.a.Word:return r.a.WordOnlieturn i}));var i="X-SW-OHP-FetchStrategy"},GMuP:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("TfV2"),r=n("zGJG"),o=n("ZBSS"),a=n("uqr+"),l=n("9KSV"),s=n("dSKW"),c=n("uV9m");function u(e,t){void 0===t&&(t=i.a.Security),Object(c.g)(r.a,function(e){var t,n,i={};for(var r in e.params)i[Object(a.a)([o.r,r])]="string"==typeof e.params[r]?Object(l.a)(e.params[r]):e.params[r];if(i[o.A]="Diagnostic",i[o.B]=e.eventName,Object(c.e)()){var u=Object(s.b)(Object(c.b)());i[Object(a.a)([o.r,o.Y])]=u,i[Object(a.a)([o.r,o.Z])]=Object(s.d)(u),i[Object(a.a)([o.r,o.X])]=Object(s.c)(u)}return i[Object(a.a)([o.r,o.j])]=null!==(t=e.area)&&void 0!==t?t:"",i[Object(a.a)([o.r,o.jb])]=null!==(n=e.subArea)&&void 0!==n?n:"",i}(e),t)}},GPFm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},GmnP:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("QjXU"),r=n("Dn7E"),o=n("CMIS"),a=n("lUkk"),l=n("laSs"),s=n("hhzZ"),c=n("Uqr9"),u=n("keVe"),d=function(){function e(e,t){this.instrumentationService=e,this.performanceService=t,this.performanceMarfunction(){this.fluidCorrelationId=void 0},e.prototype.setCorrelationId=function(e){this.fluidCorrelationId=e},e.prototype.instrumentStart=function(e){var t={State:"Start"};this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams(t)),Object(r.a)({featureName:"Fluid",eventName:e,params:t})},e.prototype.instrumentError=function(e,t,n){var i,r=n?JSON.stringify(n):"",a=this.getInstrumentationParams(((i={}).Error=r,i));this.instrumentationService.logErrorEvent(e,a),Object(o.a)({errorType:"Fluid_Error",eventName:t,message:r,debugInfo:"FluidResource: "+a.ResourceId})},e.prototype.instrumentBootError=function(e,t){this.instrumentFailure("Load"===e?"FluidContent_Open":"FluidContent_CreateNew",t)},e.prototype.instrumentSuccess=function(e,t,n,i){void 0===t&&(t=!1);var o={State:"Success"};o.VersionHistory=t.toString(),n&&(o.DebugInfo=n),i&&(o.Consumer=i),this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams(o)),Object(r.a)({featureName:"Fluid",eventName:e,params:o})},e.prototype.instrumentFailure=function(e,t,n,i){void 0===n&&(n=!1);var o={State:"Fail"};o.Error=t?JSON.stringify(t):"",o.VersionHistory=n?"true":"false",i&&(o.Consumer=i),this.instrumentationService.logGenericEvent(e,this.getInstrumentationParams(o)),Object(r.a)({featureName:"Fluid",eventName:e,params:o})},e.prototype.logPerformanceEventFromClick=function(e,t){var n,i,r=null!==(i=this.performanceMarker.get(e))&&void 0!==i?i:{clickTimeMarker:1,instrumentationParams:(n={},n.ResourceId=this.fluidCorrelationId,n)};this.performanceService.mark(t+"."+e,r.clickTimeMarker,void 0,r.instrumentationParams)},e.prototype.logPerformanceBootStart=function(e){var t,n=((t={}).ResourceId=this.fluidCorrelationId,t),i=this.performanceService.mark("FluidContentPerformanceMarker.DocumentLoadStart."+e,0,void 0,n);this.performanceMarker.set(e,{clickTimeMarker:i,instrumentationParams:n})},e.prototype.instrumentClickEvent=function(e,t,n){this.instrumentationService.logClickEvent(e,t,n),Object(a.a)({id:t,eventName:e,area:n,result:"Navigate",target:"Other"})},e.prototype.instrumentImpressionEvent=function(e,t,n,i){this.instrumentationService.logImpressionEvent(e,this.getInstrumentationParams(i)),Object(l.a)({eventName:t,id:this.fluidCorrelationId,area:n})},e.prototype.getInstrumentationParams=function(e){var t;return void 0===e&&(e={}),Object(i.__assign)(((t={}).ResourceId=this.fluidCorrelationId,t),e)},e.ɵprov=u.kc({factory:function(){return new e(u.lc(s.a),u.lc(c.office-start-simple-persistence",r="items"},H90i:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r}));var i,r,o="OfficeDotCom",a="OfficeDotComPrv";!function(e){e.Home="MAIN",e.Start="START",e.Content="CONTENT",e.Templates="TEMPLATES",e.Search="SEARCH"}(i||(i={})),function(e){e.Web="WEB",e.HWA="HWA",e.PWA="PWA",e.NTP="NTP",e.Embed="EMBED"}(r||(r={}))},HQCr:function(e,t,n){"use striector="MicrosoftSharePointOnPremConnector"}(i||(i={}));var r=n("ZBSS"),o=n("rTyw"),a=n("Dn7E"),l=n("lUkk");function s(e,t,n,s,c,u,d,p){var f;void 0===d&&(d=!1);var h=n?Object(o.a)(n,d):"";if(Object(l.a)({id:e,area:t,subArea:s||"Other",result:n?"Refer":"Navigate",target:h||"Other",type:c||"Click",targetId:h,eventName:u||"",pagealues(i).find((function(t){return t===e}))}(n)||"",f[r.j]=t,f);Object(a.a)({featureName:"SubstrateContentDomain",eventName:"SCDItemClicks",params:m})}}},HZp7:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var i,r,o=n("QjXU");function a(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(618).then(n.t.bind(null,"yfDh",7))];case 1:return[2,e.sent().default]}}))}))}function l(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return i?[2,i]:"TextDecoder"in window?[2,i=new TextDecoder]:[4,a()];case 1:return e=t.sent(),[2,i=new e.TextDecoderLite]}}))}))}function s(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return r?[2,r]:"TextEncoder"in window?[2,r=new TextEncoder]:[4,a()];case 1:return e=t.sent(),[2,r=new e.TextEncoderLite]}}))}))}function c(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,s()];case 1:return[2,t.sent().encode(e)]}}))}))}function u(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,l()];case 1:return[2,t.sent().decode(e)]}}))}))}},Hp80:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("QjXU"),r=n("CMIS"),o=n("zvoD"),a=n("3Vsh"),l=n("3GGT"),s=n("hhzZ"),c=n("R7NL"),u=n("kpuN"),d=n("dFxn"),p=n("7Gwk"),f=n("wwmn"),h=n("casz"),m=n("pOWU"),b=n("uWZl"),g=n("4/We"),v=n("cgnd"),S=n("/I02"),y=n("keVe"),C=n("TOqr"),w=function(e){function t(t,n,i,r,o,a,l,s,c,u,d){var p=e.call(this,t,r,i,"OfficeHome",n,o,a,l)||this;return p.capabilitiesService=s,p.configParserService=c,p.startupConfigService=u,p.eventService=d,p.consumerWorkloadPublicDataEndpoint="/api/workloadpublicdata/consumer",p.consumerWorkloadPublicDataForceRefreshQuery="forceRefresh=true",p.requestConfig={headers:new Map([["Accept","application/json"]])},p}return Object(i.__extends)(t,e),t.prototype.getConfig=function(){var e=this;if(!this.configPromise){if(this.startupConfigService.config.authType!==v.a.MSA)return Promise.reject();if(this.capabilitiesService.capabilities.isPwaInUwp)this.configPromise=Promise.resolve(this.configParserService.parse("workloadPublicData"));else{var t=this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(a.a)(1)).toPromise(),n=b.a.fullPageReady();this.configPromise=Promise.race([t,n]).then((function(){return e.configParserService.parse("workloadPublicData")}))}}return this.configPromise},t.prototype.forceRefreshAndGetWorkloadPublicData=function(){var e=this;return new Promise((function(t,n){var i="Office_Consumer_Workload_Public_Data_Fetch";e.get(i,"Office_Consumer_Workload_Public_Data_Fetch",e.contextService.sharedContext.officeHomeApiRoot+e.consumerWorkloadPublicDataEndpoint+"?"+e.consumerWorkloadPublicDataForceRefreshQuery,(function(e){e.instrument((function(e,t){t.HttpCode=e.ok?l.a.OK.toString():l.a.UnexpectedResponse.toString()})).then((function(e){t(e.data)}))}),(function(e){var t="Failed to get consumer workload public data with error: "+e;Object(r.a)({eventName:i,message:t}),n(e)}),e.requestConfig,"network-only")}))},t.ɵprov=y.kc({factory:function(){return new t(y.lc(u.b),y.lc(S.a),y.lc(c.a),y.lc(s.a),y.lc(f.a),y.lc(C.q),y.lc(h.a),y.lc(g.a),y.lc(d.a),y.lc(v.b),y.lc(p.a))},token:t,providedIn:"root"}),t}(m.a)},IA5y:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"b",(functio(e){return e&&"EmailAttachment"===e.source}function a(e){switch(e){case i.b.Word:return"ms-word:ofe|u|";case i.b.Excel:return"ms-excel:ofv|ofc|u|";case i.b.Visio:return"ms-visio:ofe|u|";case i.b.PowerPoint:return"ms-powerpoint:ofe|u|";case i.b.OneNote:return"onenote:"}return null}function l(e){var t=i.b.None;return(t="Custom"===e.type?i.b.ThirdParty:"Lists"===e.type?i.b.List:"Project"===e.type&&"ProjectOperations"===e.sub_type?i.b.ProjectOperations:e.extension?i.a.fileTypeFromExtension(e.extension):i.b[e.type]||i.b.None)&&t!==i.b.None||(t=i.a.fileTypeNameToFileType(e.type)),t}function s(e){var t;return null===(t=e.user_relationshi)||void 0===t?void 0:t.last_access_datetime}function u(e){try{return e?new Date(e):null}catch(e){return null}}function d(e){if(e)return{last_access_datetime:u(e.last_access_datetime),last_modified_datetime:u(e.last_modified_datetime),last_shared_by_id:e.last_shared_by_id,last_shared_datetime:u(e.last_shared_datetime),save_for_later_datetime:u(e.save_for_later_datetime),last_shared_by_history:e.last_shared_by_history,last_shared_display_name:e.last_shared_display_name,last_action_datetime:u(e.last_action_datetime)}}function p(e){var t,n;if(!e||!e.headers)return"";var i=e.headers,o=i.get("X-CalculatedBETarget")||"",a=i.get("X-FEServer")||"",l=i.get(r.b),s="",c=null===(n=null===(t=e.data)||void 0===t?void 0:t.diagnostics_data)||void 0===n?void 0:n.extended_info;return c&&(s="WorkingSetFilesPlugin:"+c.WorkingSetFilesPlugin+", MruFilesPlugin:"+c.MruFilesPlugin+", Version:"+c.Version),"BE:"+o+", FE:"+a+"|"+s+", CID:"+l}function f(e,t,n,i,o,a){return{headers:new Map([["X-AnchorMailbox",e],["X-Office-Application",t],["X-Office-Scenario",a],["X-RoutingParameter-SessionKey",n],["X-Ms-ClientAppId",i],[r.a,o]])}}function h(e){return{headers:new Map([[r.a,e]])}}},IAGz:function(e,t,n){"use strict";n.d(t,;var i=function(){function e(){this.reset()}return e.prototype.cancel=function(){this.cancelPromise()},e.prototype.onCancel=function(e){rew Promise((function(t){e.cancelPromise=t}))},e}()},IBRu:function(e,t,n){"use strit;return[new Promise((function(n,i){e=n,t=i})),e,t]}n.d(t,"a",(function(){return i}))},Ihso:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})!1;function r(e){e&&cancelAnimationFrame(e)}function o(e){return i?void e():requestAnimationFrame(e(),Promise.resolve().then((freturn o((function(){return setTimeout(e,0)}))}},J7Ur:function(e,t,n){"use strict";var i,r,o,a,l,s,c,u,d,p,f,h;n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"c",(function(){return f})),function(e){e.Smile="Smile",e.Frown="Frown",e.Idea="Idea",e.Unclassified="Unclassified",e.Like="Like"}(i||(i={})),function(e){e.Undefined="Undefined",e.MinorWithoutParentalConsent="MinorWithoutParentalConsent",e.MinorWithParentalConsent="MinorWithParentalConsent",e.NotAdult="NotAdult",e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired"}(r||(r={})),function(e){e.DropDown="DropDown",e.MultiSelect="MultiSelect",e.Rating="Ratinwn="AIThumbsDown",e.AIThumbsUp="AIThumbsUp"}(a||(a={})),function(e){e.QuestionNotRequired="QuestionNotRequired",e.CommentNotRequired="CommentNotRequired",e.CommentRequiredWithLastOption="CommentRequiredWithLastOption"}(l||(l={})),function(e){e.MSA="MSA",e.AAD="AAD",e.Unauthenticated="Unauthenticated"}(s||(s={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.NotConfigured="Not Configured"}(c||(c={})),function(e){e.JPEG="jpeg",e.PNG="png"}(u||(u={})),function(e){e.AutoCapture="AutoCapture",e.AutoCaptureWithHtml2Canvas="AutoCaptureWithHtml2Canvas",e.ProvidedAtInitialization="ProvidedAtInitialization",e.DynamicallyProvided="DynamicallyProvided"}(d||(d={})),function(e){e.SidePane="SidePane",e.Modal="Modal",e.NoSurface="NoSurface",e.CallOut="CallOut",e.NoSurfaceWithe="WacTaskPane",e.MacOS="MacOS",e.Web="Web"}(f||(f={})),function(e){e.Success="Success",e.Error="Error",e.Warning="Warning"}(h||(h={}))},JH4S:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.user=e.parse("userContext")||{companyDisplayName:null,displayName:null,hasNoLicense:!1,isAdmin:!1,isEdu:!1,isEduFaculty:!1,isEduStudent:!1,isSmb:!1,isIw:!1,isDynamics:!1,isGcc:!1,isValid:!1,mruAvailable:!1,themed:!1,themeId:"Unknown",isFirstRelease:!1},this.user.mruAvailable=this.user.isValid&&!this.user.hasNoLicense}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},JScD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("BaAg"),r=n("dFxn"),o=n("keVe"),a=function(){function e(e){this.config=e.parse("uploadConfig"),this.config&&(this.config.uploadFileTypes=new Set([i.b.Excel,i.b.Word,i.b.PowerPoint,i.b.Visio,i.b.Stream]),this.config.editableFileTypes=new Set([i.b.Excel,i.b.Word,i.b.PowerPoint]))}return e.ɵprov=o.kc({factory:function(){return new e(o.lc(r.a))},token:e,providedIn:"root"}),e}()},JT1q:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return m}));var i=n("BaAg"),r=n("lwM0"),o=n("4ach"),a=n("fKR7");function l(e){if(e){var t=r.a.decodeUrl(e);if(t){var n=t.split("://");if(n.length>1){var i=n[1].split("/");return i.pop(),i}}}return[]}function s(e,t,n,r,l,s,c){var u,d,p,f,h,m=e.MetaData,b=i.a.fileTypeNameToFileType(e.FileType);if(m){m.SPListId&&m.SPListItemUniqueId&&m.SPSiteId&&m.SPSiteUrl&&m.SPWebId&&(u={listId:m.SPListId,listItemId:null,listItemUniqueId:m.SPListItemUniqueId,siteId:m.SPSiteId,siteUrl:m.SPSiteUrl,webId:m.SPWebId}),m.CreatedDate&&(d=new Date(m.CreatedDate)),m.DriveId&&(p=m.DriveId);var g=m.SwayMetaData;g&&(f=g.ThumbnailId,h=g.IsTransformedFromWord?r.SwayTransformedFromWord:null)}var v=e&&e.MetaData&&b===i.b.Forms?e.MetaData.FormsMetaData:null,S=new a.b(a.a.Recent,t,n,e.DocId||e.ServerDocId,p||e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,null,e.LastAccessedTime,null,b,0,i.a.NameToProvenance[e.Provenance],e.PathArray,l,s,c,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,b===i.b.PowerBI?e.MetaData.PowerBIMetaData.breadcrumb_url:null,e.Category,e.MruV2Type,e.MruId,e.Activity,!1,e.IsLocal,d,u,void 0!==e.Sharing?{shared:!!e.Sharing}:void 0,e.LifecycleInfo,null,null,null,null,{thumbnailId:f},h,null,!1,e.ServiceId,null,null,e.FeedbackId,e.ServerDocId,v?v.owner_name:e&&e.MetaData?e.MetaData.CreatedByUserName:null,null,e.Extension?o.b.getExtensionToFormType(e.Extension):v&&v.owner_type?o.b.getOwnerPrincipalTypeToFormType(v.owner_type):null,v?v.owner_id:null,v?v.owner_tenant_id:null,null,null,null,null,null,null,null,null,null,null,null,null,null,v?v.form_type:null,v?v.category:null);return S.metaData=v,S.extension=e.Extension,S}function c(e,t,n,r,o,s){var c,u=e.SharepointInfo;u&&u.list_id&&u.list_item_unique_id&&u.site_id&&u.site_url&&u.web_id&&(c={listId:u.list_id,listItemId:null,listItemUniqueId:u.list_item_unique_id,siteId:u.site_id,siteUrl:u.site_url,webId:u.web_id});var d=new a.b(a.a.Recommended,t,n,e.DocId,e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,e.LastAccessedTime,e.LastAccessedTime,null,i.a.fileTypeNameToFileType(e.FileType),0,i.a.NameToProvenance[e.Provenance],e.IsEmailAttachment?[]:l(e.Url),r,o,s,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,null,e.Category,null,null,e.Activity,e.IsEmailAttachment,e.IsLocal,null,c,null,!1,e.EmailReference,null,null,null,null,null,e.SPOId,e.IsCollab,null,e.NavigationId,null,null,e.ServerDocId,null,e.TeamsDeepLink);return d.iconUrl=e.IconUrl,d.extension=e.Extension,d}function u(e,t,n,r,o,s,c){var u;void 0===c&&(c=!1);var d,p=e.SharepointInfo;p&&(u={listId:p.list_id,listItemId:null,listItemUniqueId:p.list_item_unique_id,siteId:p.site_id,siteUrl:p.site_url,webId:p.web_id}),e.ThumbnailUrl&&(d={small:e.ThumbnailUrl,medium:e.ThumbnailUrl,large:e.ThumbnailUrl,recommendedThumbnail:e.ThumbnailUrl});var f=new a.b(c?a.a.Trending:function(e){var t=a.a.OfficeFeedDocument;switch(e.toLocaleLowerCase()){case"upcomingmeeting":t=a.a.UpcomingMeeting;break;case"newsarticle":t=a.a.News;break;case"streamsvideo":t=a.a.StreamsVideo;break;case"myanalyticsinsight":t=a.a.MyAnalytics}return t}(e.Category),t,n,e.DocId,e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,e.LastAccessedTime,e.LastAccessedTime,null,i.a.fileTypeNameToFileType(e.FileType),0,i.a.NameToProvenance[e.Provenance],e.PathArray||(e.IsEmailAttachment?[]:l(e.Url)),r,o,s,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,null,e.Category,null,null,e.Activity,e.IsEmailAttachment,!1,null,u,null,!1,e.EmailReference,null,null,null,null,null,e.SPOId,e.IsCollab,null,e.NavigationId,d,e.FeedbackId,e.ServerDocId,null,e.TeamsDeepLink,null,null,null,!1,!1,null,null,null,null,null,null,[],null,null,null,e.MediaDuration);return"upcomingmeeting"===e.Category.toLowerCase()?(f.startTime=e.MeetingStart,f.endTime=e.MeetingEnd,f.location=e.Location,f.attendees=e.Attendees,f.joinUrl=e.JoinUrl,f.organizer=e.Organizer,f.joinMeetingText=e.JoinMeetingText,f.isUpcomingMeetingAccepted=e.IsUpcomingMeetingAccepted,f.isTeamsMeeting=e.IsTeamsMeeting):"myanalyticsinsight"===e.Category.toLocaleLowerCase()&&(f.taskInsight=e.TaskInsight,f.potentialAction=e.PotentialAction,f.insightName=e.InsightName,f.insightDescription=e.InsightDescription,f.insightDescriptionPrefix=e.InsightDescriptionPrefix,f.activityUser=e.Actor,f.url=e.Url),f.iconUrl=e.IconUrl,f.extension=e.Extension,f}function d(e,t,n,r,o,s){return new a.b(a.a.NoteBook,t,n,e.id,null,e.displayName,e.displayName,e.links.oneNoteWebUrl.href,null,null,new Date(e.lastModifiedDateTime),null,null,i.b.OneNote,null,i.a.NameToProvenance[e.displayName],l(e.links.oneNoteWebUrl.href),r,o,s,i.a.fileTypeNameFromType(i.b.OneNote),null,null,!0,!1,{fullName:e.displayName,email:null},null,null,null,null,null,!1,!1,new Date(e.createdDateTime))}function p(e,t,n,r,o,l,s,c){return new a.b(s||a.a.Form,t,n,e.id,null,e.title,e.title,e.url,null,null,new Date(e.modifiedDate),null,new Date(e.dateTimeShared),i.b.Forms,0,null,null,r,o,l,i.b[i.b.Forms],null,null,!0,!1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,{thumbnailId:e.otherInfo&&e.otherInfo.Theme&&e.otherInfo.Theme.Name?e.otherInfo.Theme.Name:null,thumbnailUrl:e.background?e.background.resourceUrl:null,thumbnailFillColor:e.otherInfo?e.otherInfo.SecondaryCustomizedThemeColor:null},null,null,null,null,null,null,null,e.id,e.ownerDisplayName,null,c||e.ownerPrincipalType,e.ownerId,e.ownerTenantId,!!e.softDeleted,!1,null,null,null,null,null,null,null,null,null,null,null,e.type,e.category)}function f(e,t,n,r,o,s){return new a.b(a.a.ClassNoteBook,t,n,e.id,null,e.name,e.name,e.links.oneNoteWebUrl.href,null,null,new Date(e.lastModifiedTime),null,null,i.b.OneNote,null,i.a.NameToProvenance[e.name],l(e.links.oneNoteWebUrl.href),r,o,s,i.a.fileTypeNameFromType(i.b.OneNote),null,null,!0,!1,{fullName:e.lastModifiedBy,email:null},null,null,null,null,null,!1,!1,new Date(e.createdTime))}function h(e,t,n,r,o,s){var c,u=e.SharepointIds;u&&u.ListId&&u.ListItemUniqueId&&u.SiteId&&u.SiteUrl&&u.WebId&&(c={listId:u.ListId,listItemId:null,listItemUniqueId:u.ListItemUniqueId,siteId:u.SiteId,siteUrl:u.SiteUrl,webId:u.WebId});var d=new Date(e.SharedDate),p=e.EmailReference&&1===e.EmailReference.AttachmentType;return new a.b(a.a.Shared,t,n,e.ItemId,e.DriveId,e.FileName,i.a.fileNameWithoutExtension(e.FileName),e.DocumentUrl,e.WebUrl,null,new Date(e.LastModifiedDate),null,d,i.a.fileTypeNameToFileType(e.Application),e.SharingType,i.a.NameToProvenance[e.FileName],p?[]:l(e.DocumentUrl),r,o,s,e.Application,e.ResourceId,e.StorageHost,!0,!1,null,null,null,null,null,null,!!e.EmailReference,!1,new Date(e.CreatedDate),c,null,void 0,e.EmailReference,e.SharedByUserName,e.SharedByUserEmail,null,null,null,null,null,null,null,null,null,e.ItemId,e.CreatedByUserName,null,e.OwnerType,e.OwnerId)}function m(e){return{DocId:e.docId,Extension:e.extension,FileName:e.fileName,Title:e.title,Url:e.documentUrl,WebUrl:e.webUrl,LastAccessedTime:e.lastViewedTime,FileType:e.fileTypeName,Provenance:e.provenanceName,PathArray:e.pathArray,IsPinned:e.isPinned,Application:e.application,ResourceId:e.resourceId,StorageHost:e.storageHost,Category:e.mruV2Category,MruV2Type:e.mruV2Type,MruId:e.mruV2Id,Activity:e.activity,DriveId:e.driveId,EmailReference:e.emailReference,IsEmailAttachment:e.isEmailAttachment,IsLocal:e.isLocal}}},JWB6:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("AlWG"),r=n("lrJm"),o=n("BMb5"),a=n("6cfW"),l=n("keVe"),s=n("511z"),c=function(){function e(e,t,n){var i=this;if(this.hasServiceWorkerApi=e,this.windowService=t,this.globalErrorHandler=n,e){var r=t.nativeWindow.navigator.serviceWorker;r.controller?this.updateCurrentState("Controlled"):(this.updateCurrenontroller&&i.updateCurrentState("Controlled")})).catch((function(e){i.updateCurrentState("Unsupported"),Object(a.a)(e)||n.handleError(e,"E5E2n")})))}else this.updateCurrentState("Unsupported")}return Object.defineProperty(e.prototype,"stateObservable",{get:function(){return this.stateSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentState",{get:function(){return this.currentServiceWorkerState},enumerable:!0,configurable:!0}),e.prototype.updateCurrentState=function(e){this.currentServiceWorkerState=e,this.stateSubject?this.stateSubject.next(e):this.stateSubject=new i.a(e),"Controlled"!==e&&"Unsupported"!==e||this.stateSubject.complete()},e.ɵprov=l.kc({factory:function(){return new e(l.lc(s.a),l.lc(o.b),l.lc(r.b))},token:e,providedIn:"root"}),e}()},Jn4Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("QjXU"),r=n("lUkk"),o=n("Dn7E"),a=n("rTyw"),l=n("zvoD"),s=n("kaEK"),c=n("Eup2"),u=(n("kfAr"),n("1Bt+"),n("A/um")),d=n("hhzZ"),p=n("BaAg"),f=n("jCfB"),h=n("fKR7"),m=(n("hZW2"),n("7Gwk"),n("AY/E"),n("TIi1"),n("EUVs"),n("BMb5"),n("4/We"),n("PBJH"),n("CVeG")),b=(n("dx17"),function(){function e(e,t,n,i,r,o,a,l,s,c,u,p,f,h){this.activityDescriptionService=e,this.capabilitiesService=t,this.changeDetectorRef=n,this.documentService=i,this.domSanitizer=r,this.eventService=o,this.instrumentationService=a,this.locService=l,this.mruItemInflationService=s,this.peopleCardService=c,this.responsiveRelativeDatePipe=u,this.urlLauncherService=p,this.wacContentService=f,this.windowService=h,this.showIcon=!0,this.mobileListItem=!1,this.area=d.b.Recommended,this.useSolidIcon=!1,this.timestampAndTitleInSameLine=!1,this.activityDeepLinkHovered=!1}return e.prototype.ngOnInit=function(){var e=this;this.person=this.person,this.activityState=this.activities?"active":"inactive",this.iconSize=this.iconSize||16,this.shortDate=this.windowService.innerWidth<640,this.inTeams=this.locService.TimeSentInTeams,this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.locService.supportsLocaleSpecifiers&&(this.eventsSubscription=this.eventService.events.withScope(1).pipe(Object(l.a)((function(e){return"contentWidthChanged"===e.name}))).subscribe((function(t){var n;n=Object(i.__read)(t.args,1),e.shortDate=n[0]<640,e.updateDescription()}))),this.updateDescription()},e.prototype.ngOnChanges=function(){this.updateDescription()},e.prototype.ngAfterViewInit=function(){this.softUpdatePeopleCards()},e.prototype.ngDoCheck=function(){this.sription.unsubscribe(),this.removePeopleCards()},e.prototype.onHover=function(){this.updatePeopleCards()},e.prototype.activityHovered=function(){this.activityDeepLinkHovered=!0},e.prototype.activityUnhovered=function(){this.activityDeepLinkHovered=!1},e.prototype.clicked=function(e){var t,n;if(this.activityDeepLink||this.teamsDeepLink){e&&e.preventDefault();var i=this.activityDeepLink||this.teamsDeepLink;!this.teamsDeepLink&&this.capabilitiesService.capabilities.wacHostEnabled&&this.capabilitiesService.capabilities.wacHostApps.has(this.fileType)?(this.logClick(),this.wacContentService.bootstrapAndRoute({docUrl:i,fileType:this.fileType,wdOrigin:"",applicationUrlParams:(t={},t.actnavid=this.navId,t)},((n={})[f.a.Nav]=this.navId,n))):(this.urlLauncherService.openUrl(i,"RecommendedDeepLink"),thison(){return e.activitySectionId+"-"+this.docId},e.prototype.logClick=function(t){void 0===t&&(t=!1);var n={};n.ItemId=this.activityDeepLink?"activity-description":"teams-deep-link",n.Index=this.index.toString(),n.ItemCategory=c.a.recommendedListId,n.State=this.area===d.b.SuggestedActions?"SuggestedAction":"Card",n.ResourceId=this.docId,n.Area=this.area,n.DocumentType=p.b[this.fileType],n.ActivityDisplayed=this.activityReason?s.a[this.activityReason]:"",n.ClickDestination=t?"ContentPage":"ExternalPage";var i=h.b.referralFromFileType(this.fileType),l=this.area===d.b.SuggestedActions?"Suggested_Action_Click":"Recommended_Click";this.instrumentationService.logClickEvent(l,e.activitySectionId,this.area,i,"Web",n),Object(r.a)({id:e.activitySectionId,eventName:l,area:this.area,result:i?"Refer":"Navigate",target:i?Object(a.a)(i):"Other"}),Object(o.a)({featureName:"Recommended",eventName:l,params:n})},e.prototype.updateDescription=function(){var e=this,t=this.activityDescriptionInput||this.activityDescriptionService.activityDescription(this.activities,this.lastViewedTime,this.shortDate,2===this.numLines),n=null;if(t&&(n=this.createDescription(t)),!n||this.htmlDescription&&n.html.toString()===this.htmlDescription.html.toString()?!n&&this.htmlDescription&&(this.removePeopleCards(),this.htmlDescription=null,this.dateString=null,this.activityState="inactive"):(this.removePeopleCards(),this.htmlDescription=n,this.dateString=this.getDateString(this.htmlDescription.activityDescription.timestamp),this.activityState="active",this.needPeopleCardUpdate=!0),this.secondLine=this.timestampAndTitleInSameLine?this.dateString+" · "+this.title:this.title||this.dateString,this.capabilitiesService.capabilities.recommendedDeepLinkEnabled||this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled){this.changeDetectorRef.detectChanges();var i=this.documentService.nativeDocument.getElementById(this.getActivityElementId());i&&(this.clickHandler&&i.removeEventListener("click",this.clickHandler),this.clickHandler=function(t){return e.clicked(t)},i.addEventListener("click",this.clickHandler))}},e.prototype.createDescription=function(e){return this.activityReason=e?e.reasonType:void 0,e&&e.formatString?{activityDescription:e,html:this.generateHtml(e),icon:this.reasonTypeToIcon(e.reasonType,this.useSolidIcon)}:null},e.prototype.generateHtml=function(e){if(!e.people||!e.people.length)return e.formatString;var t=m.a.escapeHtml(e.formatString);if(this.activityDeepLink){for(var n=t.split(/(&lt;c[0-9]+&gt;.*?&lt;\/c[0-9]+&gt;)/),i=0;i<n.length;i++)i%2==0&&(n[i]=" <span class='activity-deep-link__underlined'>"+n[i].trim()+"</span> ");t=n.join("").trim()}for(i=0;i<e.people.length;i++){var r=e.people[i];r.tag&&(t=(t=t.replace(new RegExp("&lt;"+r.tag.trim()+"&gt;","g"),r.upn?'<span class="activity-user-name ms-fcl-nd ms-fcl-nd-h'+(this.fluentRefresh?" activity-user-name--fluent":"")+'" title="'+m.a.escapeHtml(r.name)+'" data-email="'+m.a.escapeHtml(r.upn)+'">':"<span>")).replace(new RegExp("&lt;/"+r.tag.trim()+"&gt;","g"),"</span>"))}return this.domSanitizer.bypassSecurityTrustHtml(t)},e.prototype.reasonTypeToIcon=function(e,t){switch(e){case s.a.Edit:return t?u.a.PencilSolid:u.a.Pencil;case s.a.Comment:return t?u.a.Chat:u.a.Comment;case s.a.Mention:return u.a.At;case s.a.Open:return u.a.FolderOpen;case s.a.Share:return u.a.People2;case s.a.Attachment:return u.a.Attach;case s.a.SnoozeExpiry:return u.a.Calendar;case s.a.Trending:return u.a.Trending;case s.a.News:return u.a.News;case s.a.Meeting:return u.a.Calendar;case s.a.Video:return u.a.Video;case s.a.Task:return u.a.Task;case s.a.Default:default:return u.a.Compass}},e.prototype.getDateString=function(e){var t=this.locService.localizedDateString(e);return this.responsiveRelativeDatePipe.transform(e,this.shortDate,t,!1)},e.prototype.softUpdatePeopleCards=function(){var e=this;if(this.capabilitiesService.capabilities.peopleCardsEnabled){if(this.peopleCardService.population()>0)return void this.updatePeopleCards();if(this.queuedPeopleCardUpdate||!this.needPeopleCardUpdate)return;this.queuedPeopleCardUpdate=this.datePeopleCards(),e.queuedPeopleCardUpdate=null}))}},e.prototype.updatePeopleCards=function(){if(this.capabilitiesService.capabilities.peopleCardsEnabled&&this.needPeopleCardUpdate&&this.htmlDescription&&this.htmlDescription.activityDescription&&this.htmlDescription.activityDescription.people){if(this.descriptionElement&&this.descriptionElement.nativeElement){this.changeDetectorRef.detectChanges();for(var e=this.descriptionElement.nativeElement.querySelectorAll(".activity-user-name"),t=0;t<e.length;t++){var n=e[t].getAttribute("data-email");this.peopleCardService.addPersonaCard(e[t],n)}this.needPeopleCardUpdate=!1}}else this.needPeopleCardUpdate=!1},e.prototype.removePeopleCards=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(this.capabilitiesService.capabilities.peopleCardsEnabled&&this.htmlDescription&&this.htmlDescription.activityDescription&&this.htmlDescription.activityDescription.people&&this.descriptionElement&&this.descriptionElement.nativeElement))return[2];e=this.descriptionElement.nativeElement.querySelectorAll(".activity-user-name"),t=0,i.label=1;case 1:if(!(t<e.length))return[3,6];n=e[t].getAttribute("data-email"),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.peopleCardService.removePersonaCard(e[t],n)];case 3:case 4:return i.sent(),[3,5];case 5:return t++,[3,1];case 6:return[2]}}))}))},e.activitySectionId="activity-description-div",e}())},KoFE:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));v,this.browserPaintService=n,this.resize=new i.q}return e.prototype.ngOnInit=function(){var e=this;this.resizeObserAndObserve((function(t){return e.onResize(t[0])}),this.elementRef.nativeElement)},e.prototype.ngAfterViewInit=function(){vaementRef.nativeElement.getBoundingClientRect())}))},e.prototype.ngOnDestroy=function(){this.r=function(e){e&&this.resize.emit(e.contentRect)},e}())},"L/Tc":function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Edit=2]="Edit",e[e.Comment=3]="Comment",e[e.Mention=4]="Mention"}(i||(i={}))},"L9A/":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},LQqy:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("6nG3"),l=n("7Gwk"),s=n("uWZl"),c=n("4/We"),u=n("cgnd"),d=n("keVe"),p=function(){function e(e,t,n,o){var l=this;this.capabilitiesService=e,this.configParserService=t,this.eventService=n,this.startupConfigService=o,this.eventService.events.withScope(1).pipe(Object(i.a)((function(e){return"convertedToPaid"===e.name})),Object(r.a)(1)).toPromise().then((function(){l.refreshedConfig=l.configPromise.then((function(e){return e?{currentSkuInfo:{skuType:a.b.O365Personal,daysExpired:-365},expiredSkuInfo:e.expiredSkuInfo}:{currentSkuInfo:{skuType:a.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:a.b.NotDetected,daysExpired:-1}}}))}))}return e.prototype.getConfig=function(){var t=this;if(this.refreshedConfig)return this.refreshedConfig;if(!this.configPromise){if(this.startupConfigService.config.authType!==u.a.MSA)return Promise.resolve({currentSkuInfo:{skuType:a.b.NotDetected,daysExpired:-1},expiredSkuInfo:{skuType:a.b.NotDetected,daysExpired:-1}});if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=Promise.resolve(this.configParserService.parse(e.consumerInstallConfigElementId));else{var n=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise(),o=s.a.fullPageReady();this.configPromise=Promise.race([n,o]).then((function(){return t.configParserService.parse(e.consumerInstallConfigElementId)}))}}return this.configPromise},e.prototype.getCurrentSku=function(){var e=this;return new Promise((function(t){e.getConfig().then((function(e){return t(e&&e.currentSkuInfo?e.currentSkuInfo.skuType:a.b.NotDetected)})).catch((function(){return t(a.b.NotDetected)}))}))},e.consumerInstallConfigElementId="consumerInstallInfo",e.ɵprov=d.kc({factory:function(){return new e(d.lc(c.a),d.lc(o.a),d.lc(l.a),d.lc(u.b))},token:e,providedIn:"root"}),e}()},M3TP:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},M56G:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("keVe"),r=n("lUkk"),o=(n("hhzZ"),n("jrGV"),n("W3Zz"),n("hZW2"),n("4/We"),n("PBJH"),n("s+Eq"),function(){function e(e,t,n,r,o,a,l,s){this.actionContextMenuService=e,this.capabilitiesService=t,this.documentService=n,this.elementRef=r,this.deviceDetector=o,this.instrumentationService=a,this.locService=l,this.renderer=s,this.leftAlignedCard=!1,this.horizontalEllipsis=!1,this.actionContextMenuEnabled=!1,this.menuToggled=new i.q,this.menuFocused=new i.q,this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileCthis.initializeDropdownMenuModel(this.menuModel)},e.prototype.ngOnInit=function(){var e=this;this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh||this.horizontalEllipsis,this.initializeDropdownMenuModel(this.menuModel),this.actionContextMenuEnabled&&(this.actionContextMenuClickHandler=function(t){e.elementRef.nativeElement.contains(t.target)||e.isOpen&&e.dropdownMenu.onToggleMenu(!1)},this.actionContextMenuClickListener=this.renderer.listen(this.documentService.nativeDocument,"click",this.actionContextMenuClickHandler))},e.prototype.ngOnDestroy=function(){this.actionContextMenuClickListener&&this.actionContextMenuClickListener()},e.prototype.onFocusLink=function(e){this.menuFocused.emit(e)},e.prototype.onToggleMenu=function(e){this.actionContextMenuEnabled&&this.onToggleActionContextMenu(e),e&&(this.menuModel.rightAligned=!0),this.isOpen=e,this.menuToggled.emit(e),tnction(e){e.item.executeAction(e.nativeDomEvent)},e.prototype.initializeDropdownMenuModel=function(e){if(this.dropdownMenuModel=e,!this.dropdownMenuModel)throw new Error("menuModel must be provided to actions-menu");this.dropdownMenuModel.linkAriaDescription=this.locService.format(this.locService.MruActionsMenuAriaDescription,this.documentName),this.dropdownMenuModel.linkTooltip=this.dropdownMenuModel.linkAriaLabel=this.locService.MruActionsMenuToolTip,this.dropdownMenuModel.linkCssClass="actions-menu-link "+(this.fluentRefresh?"commanding-item--fluent ms-fcl-npa ms-fcl-tp-h ms-fcl-tda-a":"ms-fcl-nd ms-bgc-g40-f ms-bgc-g40-h ms-bgc-g40-a commanding-item ms-bgc-g40-h")+" "+(this.deviceDetector.isDesktopDevice()?" actions-menu-link--hidden":"")},e.prototype.onToggleActionContextMenu=function(e){e?(this.actionContextMenu.targetElement=this.dropdownMenu.dropdownLink.nativeElement,this.actionContextMenuService.openMenu(this.actionContextMenu)):this.actionContextMenuService.closeMenu(this.actionContextMenu)},e.prototype.instrumentToggle=function(e){if(!this.actionContextMenuEnabled){var t=e?"Open":"Close",n={};n.RenderSize=this.menuModel.items.length.toString(),n.Index=this.listItemIndex.toString(),n.Action=t,this.instrumentationService.logClickEvent("Actions_Menu_Toggle","actions-menu-link",this.area,null,null,n,[],this.dataSecurity||0),Object(r.a)({id:"Actions_Menu_Toggle",area:this.area,result:t,target:"ActionsMenu"})}},e}())},MFXD:function(e,t,n){"use strict";n.d(t,"a",(function(){retis.onlyFuture=new i.a,this.pastAndFuture=new r.a}return e.prototype.withScope=function(e){switch(e){case 1:return this.onlyFuture.asObservable();case 0:return this.pastAndFuture.asObservable();default:throw new Erris.onlyFuture.next(e),this.pastAndFuture.next(e)},e.prototype.asScopableObservable=function(){return this},e}()},MMsA:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n("QjXU"),r=n("Dn7E"),o=n("zvoD"),a=n("3Vsh"),l=n("lrJm"),s=n("hhzZ"),c=n("R7NL"),u=n("4/We"),d=n("/I02"),p=n("dFxn"),f=n("keVe"),h=function(){function e(e){this.config=e.parse("authStateConfig")||{authTicketExpiryIntervalInMinutes:0,checkAuthStateEnabled:!1,checkAuthStateEndpoint:null,checkAuthStateIntervalInSeconds:0,reauthenticationForAccessTokenPermanentErrorIntervalInMinutes:0}}return e.ɵprov=f.kc({factory:function(){return new e(f.lc(p.a))},token:e,providedIn:"root"}),e}(),m=n("7Gwk"),b=n("Z0U4"),g=n("wwmn"),v=n("WLAd"),S=n("BMb5"),y=n("X+PR"),C=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d){this.contextService=e,this.configService=t,this.officeHomeApiConfigService=n,this.instrumentationService=i,this.instrumentedHttp=r,this.eventService=o,this.pageVisibilityService=a,this.route=l,this.globalErrorHandler=s,this.windowService=c,this.routeService=u,this.capabilitiesService=d,this.currentState="SignedIn",this.initialized=!1,this.checkAuthStateTimeout=null,this.accessTokenService=null}return e.prototype.initialize=function(e){var t=this;if(this.initialized)throw new l.a("Not allowed to call AuthStateService.initialize() more than once");this.initialized=!0,this.accessTokenService=e;var n=this.configService.config;if(n.checkAuthStateEnabled&&n.checkAuthStateEndpoint){var i=this.contextService.sharedContext;this.checkAuthStateEndpoint=i.officeHomeApiRoot+"/"+n.checkAuthStateEndpoint,this.checkAuthStateRequestOptions={headers:new Map},this.queryParamProcessor=new Promise((function(e,n){i.inMockMode||e(),t.officeHomeApiConfigService.config.mockReques(o.a)((function(e){return Object.keys(e).length>0})),Object(a.a)(1)).toPromise().then((function(n){for(var i in n)i&&n.hasOwnProperty(i)&&"mockchecklogin"===i.toLowerCase()&&t.checkAuthStateRequestOptions.headers.set(t.officeHomeApiConfigService.config.mockRequestHeader,n[i]);e()})).catch((function(e){t.globalErrorHandler.handleError(e,"Jrzf6"),n(e)}))})),this.capabilitiesService.capabilities.hybridAuthEnabled&&(this.checkAuthStateRequestOptions.params=this.checkAuthStateRequestOptions.params||{},this.checkAuthStateRequestOptions.params.hybridauth="1"),this.watchAuthTicketExpiry(),this.watchAccessTokenPermanentError(),this.watchPageVisibilityChanges(),this.scheduleCheckAuthState(),this.setupActivityTimeoutSignoutListener()}},e.prototype.getCurrentState=function(){return this.currentState},e.prototype.watchAuthTicketExpiry=function(){var e=this;if(this.configService.config.authTicketExpiryIntervalInMinutes>0){var t,n=6e4*this.configService.config.authTicketExpiryIntervalInMinutes,i=Date.now();this.routeService.subscribeToRouteChangeEnd((function(r){if("Content"===r.currentRoute.route)t&&(e.windowService.nativeWindow.clearTimeout(t),t=void 0);else if(!t){var o=Math.max(n-(Date.now()-i),0);t=e.windowService.nativeWindow.setTimeout((function(){"SignedIn"===e.currentState&&e.updateCurrentState({LoginState:"Expired"})}),o)}}))}},e.prototype.watchAccessTokenPermanentError=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.accessTokenService.hasPermanentAuthError()];case 1:return n.sent()&&(e=this.configService.config.reauthenticationForAccessTokenPermanentErrorIntervalInMinutentState({LoginState:"ReauthenticationRequired"})}),6e4*e),[2]}}))}))},e.prototype.watchPageVisibilityChanges=function(){var e=this;this.windowService.nativeWindow.setTimeout((functionVisibilityService.isVisible()&&e.checkAuthState()}))}),1e3*this.configService.config.checkAuthStateIntervalInSeconds)},e.prototype.scheduleCheckAuthState=function(){var e=this;"SignedIn"===this.currentState&&!this.checkAuthStateTimeout&&this.configService.config.checkAuthStateIntervalInSeconds>0&&(this.checkAuthStateTimeout=this.windowService.nativeWindow.setTimeout((function(){return e.checkAuthState()}),1e3*this.configService.config.checkAuthStateIntervalInSeconds))},e.prototype.checkAuthState=function(){var e=this;this.checkAuthStateTimeout&&(this.windowService.nativeWindow.clearTimeout(this.checkAuthStateTimeout),this.checkAuthStateTimeout=null),this.queryParamProcessor.then((function(){if("SignedIn"===e.currentState&&e.pageVisibilityService.isVisible())return e.instrumentedHttp.get("Check_Login_Request","Check_Login",e.checkAuthStateEndpoint,e.checkAuthStateRequestOptions,"network-only").then((function(t){var n=t.data;n&&"SignedIn"===e.currentState&&e.updateCurrentState(n)}))})).catch((function(t){e.globalErrorHandler.handleError(t,"QGMJO")})).then((function(){return e.scheduleCheckAuthState()}))},e.prototype.updateCurrentState=function(e){var t=e.LoginState;if(this.currentState!==t){this.currentState=t;var n={};n.State=this.currentState,this.instrumentationService.logGenericEvent("Auth_State_Changed",n),Object(r.a)({featureName:"Auth",eventName:"Auth_State_Changed",params:n}),this.eventService.broadcastEvent({name:"authStateChanged",args:[e]})}},e.prototype.setupActivityTimeoutSignoutListener=function(){var e=this;this.windowService.nativeWindow.addEventListener("message",(function(t){if(t&&t.data){var n=void 0;try{n=JSON.parse(t.data)}catch(e){}n&&"abtSignOutEventForHost"===n.eventId&&e.updateCurrentState({LoginState:"SignedOutBasedOnActivityAuto"}),n&&"abtSignOutEventForHostUserGenerated"===n.eventId&&e.updateCurrentState({LoginState:"SignedOutBasedOnActivityUserClick"})}}))},e.ɵprov=f.kc({factory:function(){return new e(f.lc(d.a),f.lc(h),f.lc(g.a),f.lc(s.a),f.lc(c.a),f.lc(m.a),f.lc(v.a),f.lc(y.a),f.lc(l.b),f.lc(S.b),f.lc(b.a),f.lc(u.a))},token:e,providedIn:"root"}),e}()},MRNN:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("Z0teService=i,this.responsive=!1,this.focusOnLoad=!1}return e.prototype.ngOnInit=function(){var e=this;this.defaultAriaLabel=this.locService.CloseAppGalleryAriaLabel,this.isRtl=this.contextService.isRtl,this.routeSubscription=this.officeRouteService.subscribeToRouteChangeEnd((function(t){return e.backRoute=t.backRoute})),this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh},e.prototype.ngOnDestroy=function(){this.routeSubscription&&this.routeSubscription.unsubscribe()},e.prototype.navigateBack=function(){this.backRoute&&this.backRoute.route?this.officeRouteService.back():this.defaultBackRoute&&this.officeRouteService.navigateTo(this.defaultBackRoute,!0)},e}()},MbTY:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("AlWG"),r=n("keVe"),o=function(){function e(){this._inputDialog=new i.a(null)}return e.prototype.showInputDialog=function(e){this._inputDialog.next(e)},Object.defineProperty(e.prototype,"inputDialog",{get:function(){return this._inputDialog.asObservable()},enumerable:!0,configurable:!0}),e.ɵprov=r.kc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},OOtI:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("QjXU"),r=n("keVe"),o=n("zvoD"),a=(n("mNaV"),n("dOgD"),n("RJiy"),n("+YV+"),n("BaAg")),l=(n("QOOv"),n("7Rc8"),n("7Gwk"),n("gO/A"),n("4/We"),n("cgnd")),s=(n("/I02"),n("PBJH"),n("JScD"),n("9MHL"),function(){function e(e,t,n,i,o,a,l,s,c,u,d,p,f,h,m){var b=this;this.capabilitiesService=e,this.eventService=t,this.mruConfigService=n,this.locService=i,this.mruDataService=o,this.officeFeedService=a,this.createMenuService=l,this.recommendedService=s,this.oneDriveUploadService=c,this.uploadConfigService=u,this.clientStartupConfigService=d,this.startupConfigService=p,this.edgeworthDataService=f,this.contextService=h,this.visualService=m,this.mruOutputs={stateChanged:function(e){return b.onMruStateChange(e)}},this.numLoggableItems=0,this.uploadEnabled=!1,this.mruStateChanged=new r.q}return e.prototype.ngOnInit=function(){var e=this;this.capabilities=this.capabilitiesService.capabilities,this.mruConfig=this.mruConfigService.config,this.sectionLandmarkAriaLabel=this.locService.MruSectionTitleShort,this.title=this.sectionLandmarkAriaLabel,this.isStartpage=!!this.fileType,this.appFilter=this.fileType?new Set([this.fileType]):null,this.fileType&&this.fileType===a.b.Stream&&this.appFilter.add(a.b.Video);var t=[a.b.Excel,a.b.Word,a.b.PowerPoint,a.b.Stream,a.b.Visio];this.edgeworthEnabled=this.capabilities.edgeworthEnabled&&this.fileType!==a.b.Forms&&this.fileType!==a.b.OneNote&&this.fileType!==a.b.Sway,this.edgeworthReactEnabled=this.capabilities.edgeworthReactEnabled,this.quickAccessEnabled=this.capabilities.quickAccessV1Enabled&&!this.isStartpage,this.recommendedReact=this.capabilities.recommendedReact&&(!this.isStartpage||this.fileType in t),this.homeReorderedEnabled=this.capabilities.homeReorderedEnabled,this.leftNavReact=this.capabilities.leftNavReact,this.isConsumer=this.startupConfigService.config.authType===l.a.MSA,this.noGutter=this.capabilities.fluentRefresh||this.quickAccessEnabled&&!this.isConsumer,this.createOnHomeEnabled=this.isConsumer&&this.capabilities.createCenterEnabled&&this.capabilities.createOnHomeEnabled&&!this.isStartpage,this.learningShelfEnabled=this.isConsumer&&this.capabilities.learningShelfEnabled&&!this.isStartpage,this.initializeUpload(),this.initializeCreateButton(),this.initializeRecommended(),this.edgeworthEnabled?(this.contextService.isEdgeworth=!0,this.edgeworthReactEnabled||this.edgeworthDataService.init(this.appFilter)):this.initializeMru(),this.capabilitiesService.capabilities.visualEnabled&&(this.visualConfigSubscription=the.visualBackgroundEnabled=t.visualBackgroundEnabled})))},e.prototype.ngAfterViewInit=function(){var e=this;this.capabilitiesService.capabilities.visualEnabled&&(this.getWidthRestrictorComputedStyle(),this.resizeSubscription=this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"windowResized"===e.name}))).subscribe((function(){e.getWidthRestrictorComputedStyle()})))},e.prototype.ngOnDestroy=function(){var e;this.recommendedSubscription&&this.recommendedSubscription.unsubscribe(),this.mruSubscription&&this.mruSubscription.unsubscribe(),this.visualConfigSubscription&&this.visualConfigSubscription.unsubscribe(),null===(e=this.resizeSubscription)||void 0===e||e.unsubscribe()},e.prototype.onMruStateChange=function(e){this.mruStateChanged.emit(e)},e.prototype.initializeUpload=function(){var e=this;this.capabilities.oneDriveUploadEnabled&&this.uploadConfigService.config&&this.fileType!==a.b.Sway&&this.fileType!==a.b.OneNote&&this.fileType!==a.b.Forms&&this.oneDriveUploadService.uploadEnabledPromise.then((function(t){return e.uploadEnabled=t}))},e.prototype.initializeCreateButton=function(){var e=this;this.createMenuService.createButtonEnabledPromise.then((function(t){return e.createButtonEnabled=t}))},e.prototype.initializeRecommended=function(){var e=this,t=(this.mruConfig.officeFeedControlEnabled||this.mruConfig.officeFeedFlightEnabled)&&!this.fileType;if((!t||!this.capabilitiesService.capabilities.recommendedReact)&&this.mruConfig.recommendedEnabled&&this.fileType!==a.b.Sway&&this.fileType!==a.b.OneNote&&this.fileType!==a.b.Forms){var n=t?this.officeFeedService.getOfficeFeed():this.recommendedService.getRecommendedDocs(this.appFilter);this.recommendedSubscription=n.results.subscribe((function(t){e.eventService.broadcastEvent({name:"recommendedDataReady",args:[t.items.length]}),e.hasRecommendedDocs=t.items.length>0}))}},e.prototype.initializeMru=function(){var e=this;this.recentMruStream=this.mruDataService.getMruDocuments(this.appFilter),this.mruSubscription=this.recentMruStream.results.subscribe((function(t){t.items.length?(e.initialDocsAvailable=!0,e.numLoggableItems=t.items.length):Promise.all([e.createMenuService.createButtonEnabledPromise,e.oneDriveUploadService.uploadEnabledPromise]).then((function(t){var n=Object(i.__read)(t,2);return e.showZeroExperience=e.fileType===a.b.Forms||e.mruConfig.showZeroExperience&&(n[0]||n[1]||e.clientStartupConfigService.config.authType===l.a.OrgId)})),e.eventService.broadcastEvent({name:"mruDataReady",args:[t.items.length]})})),this.clientStartupConfigService.config.authType===l.a.MSA&&this.recentMruStream.initialCompletion.then((function(t){t&&t.cacheError&&t.networkError&&e.eventService.broadcastEvent({name:"mruFailed",args:[]})}))},e.prototype.getWidthRestrictorComputedStyle=function(){var e;if(null===(e=this.widthRestrictorElement)||void 0===e?void 0:e.nativeElement){var t=getComputedStyle(this.widthRestrictorElement.nativeElement);t&&this.eventService.broadcastEvent({name:"widthRestrictorComputedStyle",args:[t]})}},e}())},OPwp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return h}));var i,r=n("2dXW"),o=n("zvoD"),a=n("f0qX"),l=n("BaAg"),s=n("p6Zr"),c=n("kpue[e.Notify=6]="Notify",e[e.AddPeople=7]="AddPeople"}(i||(i={}));var h=function(){function e(e,t,n){var i=this;this.accessTokenService=e,this.capabilitiesService=t,this.themingService=n,this.shareControl=new r.a,this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((function(e){i.isDarkMode=e}))),this.useCompliantShareApi=this.capabilitiesService.capabilities.compliantShareApiEnabled,this.useHasTokenProvider=this.capabilitiesService.capabilities.shareTokendPeople":return i.AddPeople;default:return i.Share}},e.prototype.ngOnDestroy=function(){this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()},e.prototype.getToken=function(e,t,n,i,r){void 0===i&&(i=null);var o=p.a.getLocation(e),a=o?o.protocol+"//"+o.hostname:"";return null===i&&(i=this.getTokenType(e)),this.accessTokenService.getAccessToken(i,!1,a,t,{category:"Share",fileType:n},void 0,void 0,r)},e.prototype.getTokenType=function(e){return l.a.referralFromFileLocation(e)===s.a.OneDrive?"OneDrive":"SharePoint"},e.prototype.showControl=function(e){this.updateNext(e,0)},e.prototype.hideControl=function(e){this.updateNext(e,1)},e.prototype.subscribeToOpenEvents=function(e){return this.shareControl.asObservable().pipe(Object(o.a)((function(e){return e&&0===e.type})),Object(a.a)((function(e){return e.shareControl}))).subscribe(e)},e.prototype.subscribeToCloseEvents=function(e){return this.shareControl.asObservable().pipe(Object(o.a)((function(e){return e&&1===e.type})),Object(a.a)((function(e){return e.shareControl}))).subscribe(e)},e.prototype.getDarkMode=function(){return this.isDarkMode},e.prototype.getUseCompliantShareApi=function(){return this.useCompliantShareApi},e.prototype.getUseHasTokenProvider=function(){return this.useHasTokenProvider},e.prototype.updateNext=function(e,t){e&&e.file&&null!=e.index&&this.shareControl.next({type:t,shareControl:e})},e.ɵprov=f.kc({factory:function(){return new e(f.lc(c.b),f.lc(d.a),f.lc(u.b))},token:e,providedIn:"root"}),e}()},OWzB:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var i=n("QjXU"),r=n("lUkk"),o=n("3Vsh"),a=n("lrJm"),l=n("DQbD"),s=n("BaAg"),c=n("4ach"),u=n("7Rc8"),d=n("4/We"),p=n("cgnd"),f=n("/I02"),h=n("PBJH"),m=n("ZBli"),b=n("pjz5"),g=function(){function e(){}return e.hasNoInvalidCharacter=function(e,t){var n,r;try{for(var o=Object(i.__values)(t),a=o.next();!a.done;a=o.next())if(-1!==e.indexOf(a.value))return!1}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},e.hasNoDuplicates=function(t,n,i){return void 0===i&&(i=!1),i?e.hasNoDuplicatesCaseInsensitiveTrimmed(t,n):-1===n.indexOf(t)},e.isNotStartingWithSpace=function(e){return!e||eanLimitedCharactersotEmptyString=function(e){return null!=e&&e.length>0},e.hasNoDuplicatesCaseInsensitiveTrimmed=function(e,t){var n,r;try{for(var o=Object(i.__values)(t),a=o.next();!a.done;a=o.next()){var l=a.value;if(e.trim().toLowerCase()===l.trim().toLowerCase())return!1}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},e}(),v=n("hhzZ"),S=function(){function e(){}return e.createOnenoteNotebookDialog=function(e,t,n,r,o){var a=[function(e){return g.isNotEmptyString(e)?null:{isValid:!1,message:""}},function(t){return g.hasNoInvalidCharacter(t,["?","*","\\","/",":","<",">","|","'"])?null:{isValid:!1,message:e.CreateNewNoteBookNameInvalidChars}},function(t){return g.isNotStartingWithSpace(t)?null:{isValid:!1,message:e.CreateNewNoteBookNameCannotStartWithSpace}},function(t){return g.isContainingLessThanLimitedCharacters(t,128)?null:{isValid:!1,message:e.CreateNewNoteBookNameExceeds128Chars}}],l=function(t){s.inputValidator=function(e){return c(e,Object(i.__spread)(a))},n.getNoteBooks(t).results.toPromise().then((function(t){if(t&&t.value&&t.value.length){var n=[].concat(a);n.push((function(n){return g.hasNoDuplicates(n,t.value.map((function(e){return e.displayName})),!0)?null:{isValid:!1,message:e.CExist}})),s.inputValidator=function(e){return c(e,n)}}}))},s={title:t.CreateNewBlankText,placeholder:t.CreateFileDialogOneNoteInputPlaceholder,dismissAction:o},c=function(e,t){var n,r;try{for(var o=Object(i.__values)(t),a=o.next();!a.done;a=o.next()){var l=(0,a.value)(e);if(l)return l}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}ridator=function(e){return c(e,Object(i.__spread)(a))},l("cache-firl={executeAction:function(e){r(e),l("network-first")},text:e.CreateFileDialogButtonText},s.componentArea=v.b.Templates,s},e}(),y=n("idgT"),C=n("kpuN"),w=n("dFxn"),T=n("keVe"),k=function(){function e(e){this.config=e.parse("createConfig")||{thirdPartyCreateAppIds:[],createSwayEndpointConsumer:""}}return e.ɵprov=T.kc({factory:function(){return new e(T.lc(w.a))},token:e,providedIn:"root"}),e}(),I=n("2CtU"),_=n("dy1P"),A=n("n826"),P=function(){function e(e,t,n){this.globalErrorHandler=e,this.oneDriveGraphService=t,this.instrumentationService=n}return e.prototype.createStreamContent=function(e,t,n,i,o){var a=Date.now(),l=function(){return Date.now()-a};t===s.b.PlayLists||t===s.b.PlayList?(this.performAction(e,s.b.PlayList,n||v.b.Templates,o),this.instrumentationService.logClickEvent("New_Playlist_Button_Click","CreateNewPlaylist",n||v.b.Templates,s.b.PlayList.toString()),i?i({type:"GoToBlankDoc",latency:l(),platform:"Web"}):Object(r.a)({result:"Refer",target:_.a.PlayLists,area:n||"Templates",id:"CreateNewPlaylist",eventName:"New_Playlist_Button_Click"})):t===s.b.Stream?(this.performAction(e,s.b.Stream,n||v.b.Templates),this.instrumentationService.logClickEvent("New_Video_Recorder_Button_Click","CreateNewVideoRecorder",n||v.b.Templates,s.b.Stream.toString()),i?i({type:"GoToBlankDoc",latency:l(),platform:"Web"}):Object(r.a)({result:"Refer",target:_.a.MicrosoftStream,area:n||"Templates",id:"CreateNewVideoRecorder",eventName:"New_Video_Recorder_Button_Click"})):t===s.b.ScreenRecording&&(this.performAction(e,s.b.ScreenRecording,n||v.b.Templates),this.instrumentationService.logClickEvent("New_Screen_Recorder_Button_Click","CreateNewScreenRecorder",n||v.b.Templates,s.b.Stream.toString()),i?i({type:"GoToBlankDoc",latency:l(),platform:"Web"}):Object(r.a)({result:"Refer",target:_.a.MicrosoftStream,area:n||"Templates",id:"CreateNewScreenRecorder",eventName:"New_Screen_Recorder_Button_Click"}))},e.prototype.performAction=function(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){var o,a,l,c,u,d,p;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.oneDriveGraphService.getMyDriveRootUrl()];case 1:if(o=i.sent(),l=o&&o.userRoot,c="Templates"===n?"StreamStartPage":n,(a=o&&o.tenantRoot)||l){switch(-1===(u=l.lastIndexOf("/Documents"))?(this.instrumentationService.logErrorEvent("OneDrive_User_RootUrl",this.createInstrumentationParams(e,t)),this.globalErrorHandler.handleError("userRootUrl not in expected format","sCtl9"),this.oneDriveUrl=a):this.oneDriveUrl=l.substring(0,u),d="",t){case s.b.Stream:d=this.oneDriveUrl+"/_layouts/15/stream.aspx?action=create&referrer=OfficeHome&referrerScenario="+c+"&cid="+e;break;case s.b.ScreenRecording:d=this.oneDriveUrl+"/_layouts/15/stream.aspx?action=create&referrer=OfficeHome&referrerScenario="+c+"&captureMode=screenrecorder&cid="+e;break;default:d=r?this.oneDriveUrl+"/_layouts/15/lists.aspx?openListTemplateId=3a867b4a-7429-0e1a-b02e-bf4b240ff1ce&workload=Stream&cid="+e:this.oneDriveUrl+"/_layouts/15/lists.aspx?openCreate=true&workload=Stream&cid="+e}window.open(d,"_blank")}return[3,3];case 2:return p=i.sent(),this.instrumentationService.logErrorEvent(t===s.b.PlayLists||t===s.b.PlayList?"New_Playlist_Button_Click":t===s.b.ScreenRecording?"New_Screen_Recorder_Button_Click":"New_Video_Recorder_Button_Click",this.createInstrumentationParams(e)),[2,this.globalErrorHandler.handleError(p,"sCtl9")];case 3:return[2]}}))}))},e.prototype.createInstrumentationParams=function(e,t){var n,i;return t?((n={}).ResourceId=e,n.DocumentType=s.b[t],n):((i={}).ResourceId=e,i)},e.ɵprov=T.kc({factory:function(){return new e(T.lc(a.b),T.lc(A.a),T.lc(v.a))},token:e,providedIn:"root"}),e}(),E=n("hZW2"),O=n("EYcb"),F=n("TDzr"),D=n("MbTY"),M=n("Bc8L"),R=n("Z0U4"),x=n("Dpxn"),L=n("v3sZ"),U=n("p6gk"),N=n("ExL+"),W=n("m+UP"),j=n("TIi1"),H=n("Brer"),B=n("EUVs"),G=n("BMb5"),q=n("hoyd"),V=function(){function e(e,t,n,i,r,o,a,l,c,u,d,f,h,m,b,g,v,S,y,C,w,T,k,I,_,A,P,E,O,F){var D=this;this.accessTokenService=e,this.capabilitiesService=t,this.clientStartupConfigService=n,this.contextService=i,this.createConfigService=r,this.createOneNotePageDialogService=o,this.createStreamService=a,this.documentService=l,this.errorDialogService=c,this.fluidHostContext=u,this.formsService=d,this.globalErrorHandler=f,this.inputDialogService=h,this.instrumentationService=m,this.localAppLauncherService=b,this.locService=g,this.mruDataService=v,this.officeRouteService=S,this.oneDriveService=y,this.oneNoteGraphService=C,this.oneNoteConfigService=w,this.startupConfigService=T,this.shellService=k,this.swayService=I,this.templatesConfigService=_,this.urlLauncherService=A,this.vroomService=P,this.wacContentService=E,this.windowService=O,this.workloadsService=F;var M=this.capabilitiesService.capabilities;this.isPwa=M.pwaEnabled,this.isMsa=this.clientStartupConfigService.config.authType===p.a.MSA,this.fluidSupportEnabled=M.fluidSupportEnabled,this.wacHostApps=new Set(M.wacHostApps),this.numCreatesPending=0,this.createLcidEnabled=this.templatesConfigService.config.createLcidEnabled,this.createLinkCandidates=new Map;var R=M.createOneDriveDocApiEnabled;if(this.createLinkCandidates.set(s.b.Word,{title:g.CreateMenuLinkWordTitle,fileTypeName:g.CreateModalLinkWordTitle,appName:g.WordName,fileType:s.b.Word,newDocName:this.locService.NewWordDocumentFileName,fileExtension:"docx",workloadOnlineName:this.locService.WordName,spinnerColor:"#185ABD",canCreateBlankDocument:R,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!M.startPageApps.has(s.b.Word),createDocAspxEnabled:M.createDocAspxWordEnabled,docAspxId:1}),this.createLinkCandidates.set(s.b.Excel,{title:g.CreateMenuLinkExcelTitle,fileTypeName:g.CreateModalLinkExcelTitle,appName:g.ExcelName,fileType:s.b.Excel,newDocName:this.locService.NewExcelWorkbookFileName,fileExtension:"xlsx",workloadOnlineName:this.locService.ExcelName,spinnerColor:"#107C41",canCreateBlankDocument:R,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!M.startPageApps.has(s.b.Excel),createDocAspxEnabled:M.createDocAspxExcelEnabled,docAspxId:2}),this.createLinkCandidates.set(s.b.PowerPoint,{title:g.CreateMenuLinkPowerPointTitle,fileTypeName:g.CreateModalLinkPowerPointTitle,appName:g.PowerPointName,fileType:s.b.PowerPoint,newDocName:this.locService.NewPowerPointPresentationFileName,fileExtension:"pptx",workloadOnlineName:this.locService.PowerPointName,spinnerColor:"#C43E1C",canCreateBlankDocument:R,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!M.startPageApps.has(s.b.PowerPoint),createDocAspxEnabled:M.createDocAspxPowerPointEnabled,docAspxId:3}),this.createLinkCandidates.set(s.b.Sway,{title:g.CreateMenuLinkSwayTitle,fileTypeName:g.CreateModalLinkSwayTitle,appName:g.SwayName,fileType:s.b.Sway,workloadOnlineName:this.locService.MicrosoftSwayName,spinnerColor:"#038387",canCreateBlankDocument:M.swayCreateNewEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!M.startPageApps.has(s.b.Sway),createDocAspxEnabled:!1}),M.fluidCreateNewEnabled&&this.createLinkCandidates.set(s.b.Fluid,{title:g.CreateMenuLinkFluidTitle,fileTypeName:g.CreateModalLinkFluidTitle,appName:g.FluidName,fileType:s.b.Fluid,canCreateBlankDocument:this.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),M.fluidCreateAbpEnabled&&this.createLinkCandidates.set(s.b.FluidActivityBlueprint,{title:g.CreateMenuLinkFluidAbpTitle,fileTypeName:g.CreateModalLinkFluidAbpTitle,appName:g.FluidName,fileType:s.b.FluidActivityBlueprint,canCreateBlankDocument:this.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),M.startPageApps.has(s.b.Forms)&&(this.createLinkCandidates.set(s.b.Forms,{appName:g.FormsName,title:g.CreateMenuLinkFormsTitle,fileTypeName:g.CreateModalLinkFormsFormTitle,workloadOnlineName:g.FormsName,fileType:s.b.Forms,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,spinnerColor:"#038387"}),this.createLinkCandidates.set(s.b.FormsQuiz,{appName:g.FormsName,title:g.CreateMenuLinkFormsQuizTitle,fileTypeName:g.CreateModalLinkFormsQuizTitle,workloadOnlineName:g.FormsName,fileType:s.b.FormsQuiz,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,spinnerColor:"#038387"})),M.startPageApps.has(s.b.OneNote)&&this.oneNoteConfigService.config.enableOneNoteApis&&this.createLinkCandidates.set(s.b.OneNote,{title:g.CreateMenuLinkOneNoteTitle,fileTypeName:g.CreateModalLinkOneNoteTitle,appName:g.OneNoteName,fileType:s.b.OneNote,workloadOnlineName:this.locService.OneNoteName,spinnerColor:"#7719AA",canCreateBlankDocument:R,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),M.createOneNotePageEnabled&&this.createLinkCandidates.set(s.b.OneNotePage,{title:g.CreateMenuLinkOneNotePageTitle,fileTypeName:g.CreateModalLinkOneNotePageTitle,appName:g.OneNoteName,fileType:s.b.OneNotePage,workloadOnlineName:this.locService.OneNoteName,spinnerColor:"#7719AA",canCreateBlankDocument:R,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),M.startPageApps.has(s.b.Visio)?this.createLinkCandidates.set(s.b.Visio,{title:g.CreateMenuLinkVisioTitle,fileTypeName:g.CreateModalLinkVisioTitle,appName:g.VisioName,fileType:s.b.Visio,newDocName:this.locService.NewVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:this.locService.VisioName,spinnerColor:"#4C68B1",canCreateBlankDocument:R,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:M.createDocAspxVisioEnabled,docAspxId:8}):M.createVisioEnabled&&this.createLinkCandidates.set(s.b.Visio,{title:g.CreateMenuLinkVisioTitle,fileTypeName:g.CreateModalLinkVisioTitle,appName:g.VisioName,fileType:s.b.Visio,newDocName:this.locService.NewVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:this.locService.VisioName,spinnerColor:"#4C68B1",canCreateBlankDocument:R&&M.createDocAspxVisioEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!0,createDocAspxEnabled:M.createDocAspxVisioEnabled,docAspxId:8}),M.createStreamDocumentEnabled&&M.startPageApps.has(s.b.Stream)&&(this.createLinkCandidates.set(s.b.Stream,{title:g.CreateMenuLinkStreamTitle,fileTypeName:g.CreateModalLinkStreamTitle,appName:g.StreamName,fileType:s.b.Stream,fileExtension:"webm",workloadOnlineName:this.locService.StreamName,spinnerColor:"#BC1948",canCreateBlankDocument:R,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),M.createScreenRecordingDocumentEnabled&&this.createLinkCandidates.set(s.b.ScreenRecording,{title:g.CreateMenuLinkScreenRecordingTitle,fileTypeName:g.CreateModalLinkScreenRecordingTitle,appName:g.StreamName,fileType:s.b.ScreenRecording,fileExtension:"webm",workloadOnlineName:this.locService.StreamName,spinnerColor:"#BC1948",canCreateBlankDocument:R,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1})),M.createDocumentSupported&&(M.createDocAspxWordEnabled||M.createDocAspxExcelEnabled||M.createDocAspxPowerPointEnabled)&&this.accessTokenService.getAccessToken("OneDrive",!1,this.contextService.sharedContext.oneDriveResourceId),this.appManifests=new Map([]),M.listsCreateEnabled&&this.appManifests.set("list",{name:g.ListsName,creationFileType:s.b[s.b.List],fileTypeNameLocalized:g.CreateFileTypeNameListsList,id:"ListsAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:g.CreateMenuLinkListsTitle,contentUrl:this.isMsa?"openCreate=true&workload=Office&ocid=OfficeConsumerWebCreate":"openCreate=true&workload=Office&ocid=OfficeWebCreate",websiteUrl:"",scopes:[]}],version:"1.0.0."}),M.yammerCreateEnabled&&this.appManifests.set("yammer",{name:g.YammerName,creationFileType:s.b[s.b.Yammer],fileTypeNameLocalized:g.CreateFileTypeNameYammerPost,id:"YammerAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:g.CreateMenuLinkYammerPostTitle,contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0."}),M.powerBiCreateEnabled&&this.appManifests.set("powerbi",{name:g.PowerBiName,creationFileType:s.b[s.b.PowerBI],fileTypeNameLocalized:g.CreateFileTypeNamePowerBiReport,id:"PowerBIAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:g.CreateMenuLinkPowerBiTitle,contentUrl:"",websiteUrl:"groups/me/quickcreate",scopes:[]}],version:"1.0.0."}),M.whiteboardCreateEnabled){if(!this.whiteboardTenantCheck){var x=this.vroomService.getFluidEnabled("cache-only").catch((function(){return D.vroomService.getFluidEnabled("network-first")}));thiseout((function(){return t(new Error("Timeout"))}),5e3)}));return Promise.race([n,t])}(0,x)}this.whiteboardTenantCheck=this.whiteboardTenantCheck.then((function(e){return e&&D.appManifests.set("whiteboard",{name:g.WhiteboardName,creationFileType:s.b[s.b.Whiteboard],fileTypeNameLocalized:g.CreateFileTypeNameWhiteboardWhiteboards,id:"WhiteboardAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:g.CreateMenuLinkWhiteboardTitle,contentUrl:"openCreate=true",websiteUrl:"",scopes:[]}],version:"1.0.0."}),e}))}else this.whiteboardTenantCheck=Promise.resolve(!0);M.createDesignerEnabled&&this.isMsa&&"en-us"===this.contextService.sharedContext.officeMarket.toLowerCase()&&this.appManifests.set("designer",{name:"Designer",creationFileType:s.b[s.b.Designer],fileTypeNameLocalized:"Design",id:"DesignerAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:"designer",contentUrl:"",websiteUrl:"https://designer.microsoft.com/new?referrer=harmony",scopes:[]}],version:"1.0.0."})}return e.prototype.getCreateLinks=function(t){var n=this;return this.createLinksPromise||(this.createLinksPromise=new Promise((function(e){var i=[];n.workloadsService.getProvisionedWorkloads().then((function(r){r=r||[],n.getMenuOrdering().forEach((function(e){var o;if(o=e===s.b.Fluid||e===s.b.FluidActivityBlueprint?n.getFluidWorkload(e):e===s.b.Trello?n.getThirdPartyWorkload(e):r.find((function(t){return t.FileType===e||e===s.b.FormsQuiz&&t.FileType===s.b.Forms||e===s.b.OneNotePage&&t.FileType===s.b.OneNote||e===s.b.ScreenRecording&&t.FileType===s.b.Stream}))){var a=n.getCreateLinkForWorkload(o,e===s.b.FormsQuiz?s.b.FormsQuiz:e===s.b.OneNotePage?s.b.OneNotePage:e===s.b.ScreenRecording?s.b.ScreenRecording:null,t);a&&i.push(a)}})),e(i)}))})).then((function(t){var i=[];e.thirdPartyOrdering.forEach((function(e){i.push(n.getThirdPartyAppsCreateLink(s.b[e].toLowerCase()))}));var r=[],o=function(){return e.firstPartyCreateIntentOrdering.forEach((function(e){r.push(n.getFirstPartyAppsCreateLink(s.b[e].toLowerCase()))})),n.getCreateTilesOrder().then((function(e){return Promise.all(r.concat(i)).then((function(n){return n=n.filter((function(e){return!!e})),t.concat(n).sort((function(t,n){return e.indexOf(t&&t.workload?t.workload.FileType:s.b.None)-e.indexOf(n&&n.workload?n.workload.FileType:s.b.None)}))}))}))};return n.whiteboardTenantCheck.then(o,o)}))),this.createLinksPromise},e.prototype.getDesignerCreateLink=function(){var t=this.getDesignerWorkload(),n="Designer Design";return{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,n),title:n,fileTypeName:"Design",appName:"Designer",icon:"Designer_AppIcon",svgButtonBackground:e.getCreateButtonBackground(s.b.Designer),url:m.a.appendQuery(t.Url,"cid="+this.clientStartupConfigService.config.sharedClientStartupContext.correlationId),creationFileType:s.b.Designer,getId:function(){return"Designer"},createFromManifest:!0,workload:t}},e.prototype.getListCreateLink=function(){var t=this,n=this.getListsWorkload(),i=this.locService.CreateMenuLinkListsTitle||this.locService.ListsName;return{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,i),title:i,fileTypeName:this.locService.CreateFileTypeNameListsList,appName:this.locService.ListsName,icon:null,svgButtonBackground:e.getCreateButtonBackgro.b.List,getId:function(){return t.locService.ListsName},createFromManifest:!0,workload:this.getListsWorkload()}},e.prototype.getCreateLinksForConsumer=function(){var t=this,n=[],i=this.createConfigService.config;return e.fileTypeToConsumerWorkloadIdMap.forEach((function(r,o){if(o===s.b.List&&t.capabilitiesService.capabilities.createOnHomeListsEnabled){var a=t.getListCreateLink();n.push(a)}else if(o===s.b.Designer&&t.capabilitiesService.capabilities.createOnHomeDesignerEnabled&&"en-us"===t.contextService.sharedContext.officeMarket.toLowerCase())a=t.getDesignerCreateLink(),n.push(a);else{var l=t.createLinkCandidates.get(o);if(!l)return null;var c=o===s.b.Sway?m.a.appendQuery(i.createSwayEndpointConsumer,"campaign=OHPCreateNew"):null;a={ariaLabel:t.locService.format(t.locService.CreateMenuLinkAriaLabelFormat,l.title),title:l.title,fileTypeName:l.fileTypeName,appName:l.appName,icon:s.a.documentIconFromType(o===s.b.FormsQuiz?s.b.Forms:o,"32x32"),svgButtonBackground:e.getCreateButtonBackground(o),url:c,creationFileType:o,getId:function(){return o===s.b.FormsQuiz?r+"Quiz":r}},n.push(a)}})),n},e.prototype.getCreateTilesOrder=function(){var t=this.getCombinedMenuOrdering();if(this.capabilitiesService.capabilities.createDynamicOrderingEnabled){var n=new Array;return this.mruDataService.getMruDocuments(new Set(e.combinedMenuOrdering)).results.pipe(Object(o.a)(1)).toPromise().then((function(e){var r,o;if(!(e||e.items||e.items.length))return t;var a=new Map;e.items.forEach((function(e){var t=e.FileType;a.set(t,a.has(t)?a.get(t)+1:1)ead)(a.entries()).sort((function(e,t){return t[1]-e[1]})));try{for(var c=Object(i.__values)(l.keys()),u=c.next();!u.done;u=c.next()){var d=s.a.fileTypeNameToFileType(u.value);n.push(d)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}return t.forEach((function(e){a.has(s.b[e])||n.push(s.b[s.b[e]])})),Promise.resolve(n)}))}return Promise.resolve(t)},e.prototype.createItem=function(e,t,n,i,r,o,a,l,c){var u=this;void 0===r&&(r=""),void 0===c&&(c=!1);var d=this.capabilitiesService.capabilities.scenarioId;switch(e){case s.b.Visio:return this.workloadsService.getWorkloads().then((function(p){var f=!!p.find((function(e){return e.FileType===s.b.Visio})),h=!!p.find((function(e){return"ShellDocuments"===e.Id}));return f?u.createItemHelper(e,t,n,i,r,o,a,l,c):d?void u.shellService.getLicenseStatus(s.b[e],d).then((function(s){return s.IsLicensed?u.createItemHelper(e,t,n,i,r,o,a,l,c):u.errorDialogService.showErrorDialog({category:"StartPage",error:"NoLicenceVisio",fileType:e})})):u.errorDialogService.showErrorDialog(h?{category:"StartPage",error:"NoLicenceVisio",fileType:e}:{category:"StartPage",error:"NoLicence",fileType:e})}));case s.b.Stream:case s.b.ScreenRecording:return void this.createStreamService.createStreamContent(this.clientStartupConfigService.config.sharedClientStartupContext.correlationId,e,l,i);case s.b.PlayLists:case s.b.PlayList:return void(this.capabilitiesService.capabilities.createStreamPlaylistEnabled&&this.createStreamService.createStreamContent(this.clientStartupConfigService.config.sharedClientStartupContext.correlationId,s.b.PlayList,l,i,this.capabilitiesService.capabilities.createPlaylistWithNewUrlEnabled));default:return this.createItemHelper(e,t,n,i,r,o,a,l,c)}},e.prototype.createItemFromManifest=function(e,t){var n=this,i=Date.now(),r=this.isPwa?void 0:this.windowService.nativeWindow.open("","_blank");return new Promise((function(o){return n.requestNewItemFromManifest(e.FileType,e.IsThirdParty?e.ThirdPartyCckground=function(e){return s.b[e]+"_ButtonBackground"},e.prototype.createItemHelper=function(e,t,i,a,l,c,u,d,p){var f=this;void 0===l&&(l="");var h=this.createLinkCandidates.get(e);if(!h)return a&&a({type:"Error",latency:0,errorMsg:"NotFound",debugInfo:s.b[e]+" candidate not found"}),Promise.resolve();var m=function(){var m=f.shouldOpenInUIHost(e,l);return new Promise((function(b){var g=u||f.getNewDocLinkTarget(e),v=function(e){a&&a(e),b("CreatePending"===e.type)};if(("_self"===g||m)&&f.numCreatesPending>0)v({type:"CreatePending",latency:-1,errorMsg:"MultipleCreates",debugInfo:"createsPending="+f.numCreatesPending});else if(f.numCreatesPending++,h.canCreateBlankDocument){var y,C=Date.now(),w=f.windowService.nativeWindow,T=function(n){h.createDocAspxEnabled&&!m?f.getDocAspxApiUrl(h.docAspxId,f.getOriginParam(!0,!!i),C,i?i.AssetId:null,l).then((function(r){f.accessTokenService.getAccessToken("OneDrive",!1,r[1]).then((function(o){var l=r[0],s=o;if(s&&s.success){var u;"_blank"===g?(y=w.open("","_blank"),f.newTabWindow=y):y=w,y&&y!==w?(y.document.write("<!doctype html> <html> <head> </head> <body> </body> </html> "),u=y.document):u=f.documentService.nativeDocument;var m=f.getDocaspxFormHtml(l,s.token);f.documentService.appendHTMLToElement(u.body,m);var v=u.getElementById("create-new-doc-form");if(v){var S=Date.now()-C;a&&a({type:"GoToBlankDocInstant",latency:S,platform:"Web",errorMsg:"Ok",debugInfo:"docaspx successful"}),v.submit(),b()}else f.requestNewItem(h,e,C,t,y,b,a,n,i,c,null,d,p)}else f.requestNewItem(h,e,C,t,y,b,a,n,i,c,null,d)}))})).catch((function(){f.requestNewItem(h,e,C,t,y,b,a,n,i,c,null,d,p)})):f.reqC,t,y,b,a,n,i,c,l,d,p)},k={NativeWindow:function(){y=w},Blank:function(){f.capabilitiesService.capabilities.contentLauncherEnabled||(y=w.open("","_blank"),f.newTabWindow=y)}},I=f.isPwa||m||"_blank"!==g||f.fluidSupportEnabled&&e===s.b.Fluid?k.NativeWindow:k.Blank;switch(e){case s.b.OneNote:f.instrumentationService.logClickEvent("OneNote_Notebook_Create_Link_Click","OneNoteNotebookCreateLink",d),Object(r.a)({eventName:"OneNote_Notebook_Create_Link_Click",id:"OneNoteNotebookCreateLink",area:d||"InputDialog",result:"Open",target:"Other"});var _=f.templatesConfigService.resources(e);return void f.inputDialogService.showInputDialog(S.createOnencSnction(e){I(),T(e)}),(function(){f.numCreatesPending--})));case s.b.OneNotePage:return f.instrumentationService.logClickEvent("OneNote_Page_Create_Link_Click","OneNotePageCreateLink",d),Object(r.a)({eventName:"OneNote_Page_Create_Link_Click",id:"OneNotePageCreateLink",area:d||"InputDialog",result:"Open",target:"Other"}),void f.mruDataService.getMruDocuments(new Set([s.b.OneNote])).results.pipe(Object(o.a)(1)).toPromise().then((function(e){f.createOneNotePageDialogService.showk:function(){return a({type:"GoToBlankDoc",latency:0})}})}));default:I(),T()}}else f.launchOfficeApp(h.fileType).then((function(){v({type:"GoToLanding",latency:0,platform:"Native",errorMsg:"Ok",debugInfo:"launch office app successful"})})).catch((function(){!function(){if(t&&h.canFallbackToLandingPage)return f.capabilitiesService.capabilities.contentLauncherEnabled?void Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"CreateNewFallback"}).then((function(){v({type:"GoToLanding",latency:0,platform:"Web",errorMsg:"Ok",debugInfo:"fallback to landing page"})})).catch((function(){f.showError("Generic",h.fileType,"OpenFailed",t),v({type:"Error",latency:0,errorMsg:"LaunchFailed",debugInfo:"failed to launch fallback to landing page"})}))})):void f.",errorMsg:"Ok",debugInfo:"fallback to landing page"})})).catch((function(){f.showError("Generic",h.fileType,"OpenFailed",t),v({type:"Error",latency:0,errorMsg:"LaunchFailed",debugInfo:"failed to launch fallback to landing page, contentLauncherNotEnabled"})}));f.showError("Generic",h.fileType),v({type:"Error",latency:0,errorMsg:h.canFallbackToLandingPage?t?"LaunchFailed":"NotFound":"Disabled",debugInfo:h.canFallbackToLandingPage?t?"launch office app failed":"fallback url undefined":"fallback disabled"})}()}))})).then((function(e){e||f.numCreatesPending--}))};return[s.b.Excel,s.b.Visio].includes(e)&&!i&&this.capabilitiesService.capabilities.pwaEnabled?this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(t){return t.launchApp({action:"OpenDocument",event:event,appName:s.b[e],url:""}).then((function(e){return e.success?(a&&a({type:"GoToLanding",latency:0,platform:"Native",errorMsg:"Ok",debugInfo:"launch app not supporting 0-byte successful"}),Promise.resolve()):m()})).catch(m)})):this.localAppLauncherService.launchOfficeApp(s.b[e],"",null,!0).then((function(e){return e?(a&&a({type:"GoToLanding",latency:0,platform:"Native",errorMsg:"Ok",debugInfo:"launch app not supporting 0-byte successful"}),Promise.resolve()):m()})).catch(m):m()},e.prototype.getFirstPartyAppsCreateLink=function(e){var t=this;return new Promise((function(n){var i=t.appManifests.get(e);i?t.getFirstPartyGenericWorkload(i).then((function(e){return n(e?t.getCreateLinkForFirstPartyWorkload(e):null)})).catch((function(){return n(null)})):n(null)}))},e.prototype.getThirdPartyAppsCreateLink=function(e){var t=this;return new Promise((function(n){var i=t.appManifests.get(e);if(i){var r=t.getThirdPartyGenericWorkload(i);n(r?t.getCreateLinkForThirdPartyWorkload(r):null)}else n(null)}))},e.prototype.getFirstPartyGenericWorkload=function(e){var t=this;return this.workloadsService.getWorkloads().then((function(n){var i,r,o;if(!(o=e.creationFileType===s.b[s.b.Designer]?t.getDesignerWorkload():n.find((function(t){var n;return(null==t?void 0:t.AppId)===e.name||(null===(n=t.AppId)||void 0===n?void 0:n.includes(e.name.replace(/\s/g,"")))}))))return null;if(e.creationFileType===s.b[s.b.Designer])r=o.Url+"&cid="+t.clientStartupConfigService.config.sharedClientStartupContext.correlationId;else{var a=null===(i=o.Url)||void 0===i?void 0:i.split("?");r=a[0]+(a[0].endsWith("/")?"":"/")+(e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].websiteUrl?e.staticTabs[0].websiteUrl:"")+"?"+(a[1]?a[1]+"&":"")+(e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].contentUrl?e.staticTabs[0].contentUrl+"&":"")+"cid="+t.clientStartupConfigService.confieturn{getId:function(){return e.name.replace(/\s/g,"")},Id:e.name.replace(/\s/g,""),Referral:e.name.replace(/\s/g,""),FileType:e.creationFileType?s.a.fileTypeNameToFileType(e.creationFileType):void 0,FileTypeNameLocalized:e.fileTypeNameLocalized,Url:r,Color:o.Color,IconUnicodeCodepointCssClass:o.IconUnicodeCodepointCssClass,Text:e.name,SubText:void 0,Title:e.staticTabs&&e.staticTabs[0].name||e.name,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:e.id,CollectorId:void 0,ThirdPartyCreateUrl:""}}))},e.prototype.getThirdPartyGenericWorkload=function(e){return{getId:function(){return e.name},Id:e.name,Referral:e.name,FileType:s.b.ThirdParty,Url:"",Color:e.accentColor,IconUnicodeCodepointCssClass:"",Text:e.name,SubText:void 0,Title:e.name,IsThirdParty:!0,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:e.largeImageUrl&&""!==e.largeImageUrl?e.largeImageUrl:e.smallImageUrl,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:e.id,CollectorId:void 0,ThirdPartyCreateUrl:e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].contentUrl}},e.prototype.getThirdPartyWorkload=function(e){return e===s.b.Trello?{getId:function(){return"ShellTrello"},Id:"ShellTrello",Referral:"Trello",FileType:s.b.Trello,Url:"",Color:"#008FE4",IconUnicodeCodepointCssClass:"ms-ohp-svg-Icon ms-ohp-Icon ms-ohp-Icon--trelloLogo",Text:void 0,SubText:void 0,Title:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0}:null},e.prototype.getListsWorkload=function(){return{getId:function(){return"Lists"},Color:"#974B8B",IconUnicodeCodepointCssClass:"",IconFont:void 0,Id:"Lists",Referral:"Lists",Size:void 0,Text:this.locService.ListsName,SubText:void 0,Title:this.locService.CreateMenuLinkListsTitle||this.locService.ListsName,Url:m.a.appendQuery("https://lists.live.com/?","openCreate=true&workload=Office&ocid=OfficeConsumerWebCreate&cid="+this.clientStartupConfigService.config.sharedClientStartupContext.correlationId),ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,FileType:s.b.List,FileTypeNameLocalized:void 0,ThirdPartyIcon:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0}},e.prototype.getDesignerWorkload=function(){return{getId:function(){return"DesignerAppId"},Color:"#593EF2",IconUnicodeCodepointCssClass:"",IconFont:void 0,Id:"DesignerAppId",Referral:"Designer",Size:void 0,Text:void 0,SubText:void 0,Title:void 0,Url:"https://designer.microsoft.com/new?referrer=harmony",ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,FileType:s.b.Designer,FileTypeNameLocalized:void 0,ThirdPartyIcon:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0}},e.prototype.getFluidWorkload=function(e){var t={getId:function(){return"ShellFluid"},Id:"ShellFluid",Referral:"Fluid",FileType:s.b.Fluid,Url:"",Color:"#0078D4",IconUnicodeCodepointCssClass:"ms-ohp-svg-Icon ms-ohp-Icon ms-ohp-Icon--fluidLogo",Text:void 0,SubText:void 0,Title:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0,ThirdPartyCreateUrl:void 0};switch(e){case s.b.Fluid:return t;case s.b.FluidActivityBlueprint:return t.getId=function(){return"ShellFluidAbp"},t.Id="ShellFluidAbp",t.FileType=s.b.FluidActivityBlueprint,t.Url="",t}},e.prototype.requestNewItem=function(e,t,r,o,a,l,u,d,p,f,h,m,b){var g=this,v=function(e){u&&u(e),l()},S=function(){return Date.now()-r},y=function(t,i,r){var o=function(n,i,o){g.showError("OpenFailed"===n&&"GoToBlankDoc"===r?"OpenNewDocFailed":"Generic",e.fileType,n,"OpenFailed"===n?t:""),v({type:"Error",latency:S(),errorMsg:i,debugInfo:null!=o?o:""})};if(t)return g.isPwa?g.capabilitiesService.capabilities.contentLauncherEnabled?void Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenDocument"}).then((function(){v({type:i,latency:S(),platform:"Web",errorMsg:"Ok",debugInfo:"launch url successful"})}),(function(){o("OpenFailed","LaunchFailed","launchUrl failed")}))})):void g.urlLauncherService.openUrl(t,r).then((function(){v({type:i,latency:S(),platform:"Web",errorMsg:"Ok",debugInfo:"launch url successful"})}),(function(){o("OpenFailed","LaunchFailed","launchUrl failed, contentLauncherNotEnabled")})):void 0!==a.open?(u&&u({type:i,latency:S(),platform:"Web",errorMsg:"Ok",debugInfo:"launch url successful"}),g.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"OpenDocument",linkTarget:"_top",targetTab:a})})):a.open(t,"_top"),void l()):void o("OpenFailed","Generic","openUrl failed, targetTab.open is "+a.open);o("CreateFile","NotFound","url not found")},C=function(t,n,i,r){g.launchOfficeApp(e.fileType,"",a).then((function(){v({type:"GoToLandingFallback",latency:S(),platform:"Native",errorMsg:"Ok",debugInfo:"launch office app successful"})})).catch((function(){!function(){if(o&&e.canFallbackToLandingPage)y(o,"GoToLandingFallback","CreateNewFallback");else{g.showError(t,e.fileType);var a=S();v({type:"Error",latency:a,errorMsg:e.canFallbackToLandingPage&&!o?"NotFound":e.canFallbackToLandingPage?"LaunchFailed":n,debugInfo:e.canFallbackToLandingPage&&!o?"fallback url undefined":e.canFallbackToLandingPage?"launch office app failed":"fallback disabled, "+i,httpCode:null!=r?r:""})}}()}))},w=function(){var o,w=null,T=null,k="GoToBlankDoc";switch(t){case s.b.Sway:w=g.swayService.createNew().then((function(e){return{canonicalUrl:e,webUrl:e}}));break;case s.b.OneNote:w=g.oneNoteGraphService.createNewNotebook(d).then((function(e){var t=g.addLoginHint(e.links.oneNoteWebUrl.href);return{canonicalUrl:t,webUrl:t}}));break;case s.b.Forms:w=p?g.formsService.createFormFromTemplate(p,c.a.Users).then((function(e){return{canonicalUrl:e,webUrl:e}})):g.formsService.createForm(s.b.Forms,f,m).then((function(e){return{canonicalUrl:e,webUrl:e}})),k="CreateNewFallback";break;case s.b.FormsQuf,m).then((function(e){return{canonicalUrl:e,webUrl:e}})),k="CreateNewFallback";break;default:T=(o=Object(i.__read)(g.createOneDriveFile(e,p?p.AssetId:null,r),2))[0],w=o[1]}var I=g.shouldOpenInUIHost(t,h)?g.wacContentService.bootstrapZeroByteFile({fileName:T,fileType:t,wdOrigin:g.getOriginParam(!1,!!p)},r,w,null==p?void 0:p.AssetId,h):void 0,_=!1;g.capabilitiesService.capabilities.contentLauncherEnabled||I&&(e.canOpenBlankDocInNativeApp?g.localAppLauncherService.shouldOpenInOfficeApp(s.b[e.fileType]).then((function(e){e||_||(_=!0,u&&u({type:"GoToBlankDoc",latency:S(),platform:"Web",errorMsg:"Ok",debugInfo:"route to content page successful"}),I(),l())})):(_=!0,u&&u({type:"GoToBlankDoc",latency:S(),platform:"Web",documentUrlPromise:w.then((function(e){return e.canonicalUrl})),errorMsg:"Ok",debugInfo:"route to content page successful"}),b||I(),l())),w.then((function(t){if(!_)if(_=!0,g.capabilitiesService.capabilities.contentLauncherEnabled)Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchContent({action:"OpenDocument",document:{canonicalUrl:t.canonicalUrl,webUrl:t.webUrl,app:s.b[e.fileType],attribution:"",url:t.canonicalUrl,extension:"",title:e.appName,id:t.docId||"",isRedeemed:!0},useWebUrl:!0,wdOriginType:"NEW"}).then((function(e){e.success?v({type:"GoToBlankDoc",latency:S(),platform:"Native",errorMsg:"Ok",debugInfo:"launch content successful"}):g.launchWebApp(t,k,y,u,l,S,I)})).catch((function(){g.launchWebApp(t,k,y,u,l,S,I)}))}));else{if(!e.canOpenBlankDocInNativeApp)return void g.launchWebApp(t,k,y,u,l,S,I);g.launchOfficeApp(e.fileType,t.canonicalUrl,g.isPwa?g.windowService.nativeWindow:a).then((function(){v({type:"GoToBlankDoc",latency:S(),platform:"Native",errorMsg:"O"})})).catch((function(){g.launchWebApp(t,k,y,u,l,S,I)}))}})).catch((function(e){g.globalErrorHandler.handleError(e,"foSs8");var t=e&&e.error&&e.error.code||"";"404"===t?C("OneDriveProvisioning","GraphError","OneDriveProvisioning Error",t):e&&e.error&&"CAP_Error"===e.error.data?C(g.isMsa?"Generic":"ConditionalAccessFallback","GraphError","Graph CAP_Error",t):g.isMsa&&"403"===t?C("OneDriveDisabled","GraphError","OneDriveDisabled",t):t?C("Generic","GraphError","Other graph error",t):C("Generic","Generic","Generic error")}))};if(a||(a=this.windowService.nativeWindow),this.isPwa||void 0!==a.open){if(a!==this.windowService.nativeWindow)try{var T=this.getLoadingPageHtml(t);a.document.write(T)}catch(e){return this.globalErrorHandler.handleError(e,"T3UKJ"),void C("Generic","Generic","failed to write loading html")}this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchTemplate(s.b[t],p?p.TemplateBinaryUrl:null).then((function(e){if(!e)throw new Error("launchOfficeAppWithTemplate failed");v({type:"GoToBlankDoc",latency:S(),platform:"Native",errorMsg:"Ok",debugInfo:"launchOfficeAppWithTemplate successful"})})).catch((function(){t===s.b.Fluid||t===s.b.FluidActivityBlueprint?(g.numCreatesPending--,g.launchFluidExperience(t)):w()}))})):this.localAppLauncherService.launchOfficeAppWithTemplate(s.b[t],p?p.TemplateBinaryUrl:null).then((function(e){if(!e)throw new Error("launchOfficeAppWithTemplate failed");v({type:"GoToBlankDoc",latency:S(),platform:"Native",errorMsg:"Ok",debugInfo:"launchOfficeAppWithTemplate successful"})})).catch((function(){t===s.b.Fluid||t===s.b.FluidActivityBlueprint?(g.numCreatesPending--,g.launchFluidExperience(t)):w()}))}else C("Generic","NotFound","open() is undefined")},e.prototype.requestion(e,t,i,r,o,a){var l=this,s=function(e){r&&r(e),a()},c=function(){return Date.now()-o};this.launchWebApp({canonicalUrl:t,webUrl:t},"OpenFile",(function(t,o,u){var d=function(n,i,r){l.showError("OpenNewDocFailed",e,n,"OpenFailed"===n?t:""),s({type:"Error",latency:c(),errorMsg:i,debugInfo:r})};return l.isPwa?l.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){return e.launchUrl(t,{action:u.toString()}).then((function(){s({type:o,latency:c(),platform:"Web",errorMsg:"Ok",debugInfo:"launch url successful"})}),(function(){d("OpenFailed","LaunchFailed","failed to launch url")}))})):l.urlLauncherService.openUrl(t,u).theed","failed to launch url, contentLauncherNotEnabled")})):(r&&r({type:o,latency:c(),platform:"Web"}),l.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){return e.launchUrl(t,{action:u.toString(),linkTarget:"_totop"),void a()))}),r,a,(function(){return Date.now()-o}))},e.prototype.getHarmonySessionSource=function(){switch(this.capabilitiesService.getWorkload()){case"pwa":return"HarmonyDesktop";case"officehome":case"officehomereact":return"HarmonyWeb";case"embed":return"HarmonyEmbed";default:return"unknown"}},e.prototype.createOneDriveFile=function(e,t,n){var i=this,r=e.newDocName+"."+e.fileExtension,o=this.shouldOpenInUIHost(e.fileType);return[r,new Promise((function(a,l){var s=Date.now();i.oneDriveService.createNewFile(r,e.fileType,o).then((function(e){var r={};e.webDavUrl&&(r.canonicalUrl=i.addLoginHint(e.webDavUrl));var l=i.addLoginHint(e.webUrl),c="action=editnew";-1===(l=l.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew")).lastIndexOf(c)&&(l=m.a.appendQuery(l,c)),t&&(l=l+"&wdTpl="+t),(t||i.createLcidEnabled)&&(l+="&wdlcid="+i.contextService.sharedContext.officeMarketLcid);var u=i.capabilitiesService.capabilities.scenarioId;u&&(l+="&wdscenarioid="+u);var d=i.getOriginParam(!1,!!t);l=m.a.appendQuery(l,"wdNewAndOpenCt="+n+"&ct="+n+"&wdPreviousSession="+i.startupConfigService.config.sharedClientStartupContext.sessionId+"&wdPreviousSessionSrc="+i.getHarmonySessionSource()+"&wdOrigin="+d),r.webUrl=l,o&&(e.parentReference&&(r.docId=e.id,r.driveId=e.parentReference.driveId,r.fileName=e.name),r.wopiFetchData={fetchDiagnostics:{startTime:s},wopiHostData:H.a.getWopiHostDataFromItem(e)}),a(r)})).catch((function(e){i.globalErrorHandler.handleError(e,"dYEKI"),l(e||"Creating new file failed")}))}))]},e.prototype.getNewDocLinkTarget=function(e){var t=this.createLinkCandidates.get(e);return this.capabilitiesService.capabilities.capPopupEnabled&&(e===s.b.Word||e===s.b.Excel||e===s.b.PowerPoint||e===s.b.Visio||e===s.b.OneNote)&&this.accessTokenService.hasCAPError("Graph")||e===s.b.Fluid||e===s.b.FluidActivityBlueprint?"_self":this.isPwa||"_blank"===this.contextService.sharedContext.defaultLinkTarget&&(this.clientStartupConfigService.config.authType===p.a.OrgId||!t.canCreateBlankDocument)?"_blank":"_self"},e.prototype.showError=function(e,t,n,i){void 0===n&&(n="CreateFile"),this.newTabWindow&&(this.newTabWindow.close(),this.newTabWindow=null),this.errorDialogService.showErrorDialog({category:n,error:e,fileType:t,inputText:i})},e.prototype.getLoadingPageHtml=function(e){var t=" <!doctype html> <html> <head> <title>TITLE</title> <meta charset=utf-8 /> <style>body{margin:0;padding:0}.parent{text-align:center;width:100%;height:100%}.title{font-family:'Segoe UI SemiLight','Segoe UI WPC Semilight','Segoe UI',Segoe,Tahoma,Helvetica,Arial,sans-serif;font-size:30px;margin-bottom:-12px}.load_center{position:absolute;left:0;right:0;bottom:50%}.spinner{display:inline-block;margin:25px auto;border-radius:50%;border:1.5px solid #d9d9d9;border-top-color:SPINNERCOLOR;width:40px;height:40px;-webkit-animation:spinAnimation 1.3s infinite cubic-bezier(.53,.21,.29,.67);animation:spinAnimation 1.3s infinite cubic-bezier(.53,.21,.29,.67)}@-webkit-keyframes spinAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spinAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}</style> </head> <body> <div class=parent> <div class=load_center> <div class=title>ONLINEAPPNAME</div> <br> <span role=presentation class=spinner></span> </div> </div> </body> </html> ";return(t=(t=t.replace("TITLE",this.locService.CreateNewDocumentLoadingPageTitle)).replace("SPINNERCOLOR",this.getWorkloadSpinnerColor(e))).replace("ONLINEAPPNAME",this.getWorkloadOnlineName(e))},e.prototype.getDocaspxFormHtml=function(e,t){return"<form id=create-new-doc-form method=post action=APIURL style=display:none target=_top><input id=create-new-doc-token name=access_token value=ONEDRIVETOKEN /></form> ".replace("APIURL",e).replacLinkCandidates.get(e);return t?t.wort(e);return t&&t.spinnerColor?t.spinnerColor:"#2b579a"},e.prototype.getCreateLinkForWorkload=function(t,n,i){var r=n||t.FileType,o=this.createLinkCandidates.get(r),a=t.Id;if(!o)return null;var l=t.Url;return r===s.b.Sway?l=m.a.appendQuery(l,"campaign=OHPCreateNew"):r!==s.b.Forms&&r!==s.b.FormsQuiz||(l=this.formsService.getCreateFormsLink(r,null,i),a=r===s.b.FormsQuiz?t.Id+"Quiz":t.Id),{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,o.title),title:o.title,fileTypeName:o.fileTypeName,appName:o.appName,icon:s.a.documentIconFromType(t.FileType,"32x32"),svgButtonBackground:e.getCreateButtonBackground(r),workload:t,url:l,creationFileType:r,getId:function(){return a}}},e.prototype.getCreateLinkForThirdPartyWorkload=function(e){return{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,e.Title),title:e.Text,fileTypeName:e.Text,appName:e.Text,icon:"",svgButtonBackground:"",workload:e,url:e.ThirdPartyCreateUrl,iconUrl:e.ThirdPartyIcon,creationFileType:s.b.ThirdParty,getId:function(){return e.Id}}},e.prototype.getCreateLinkForFirstPartyWorkload=function(t){return{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,t.Title),title:t.Title,fileTypeName:t.FileTypeNameLocalized,appName:t.Text,icon:t.FileType===s.b.List?null:t.FileType===s.b.Designer?"Designer_AppIcon":t.IconUnicodeCodepointCssClass,workload:t,url:t.Url,svgButtonBackground:e.getCreateButtonBeationFileType:t.FileType,getId:function(){return t.Id},createFromManifest:!0}},e.prototype.getDocAspxApiUrl=function(e,t,n,i,r){var o=this;return new Promise((function(a,l){o.oneDriveService.getMyDriveRootUrl().then((function(s){var c=s.userRoot,u=c.lastIndexOf("/Documents");if(-1!==u){var d=c.substring(0,u)+"/_layouts/15/doc.aspx?action=editnew&doctype="+e+"&wdOrigin="+t+"&docliburl="+c+"&ct="+n;i&&(d+=r?"&templateDriveId="+r+"&templateItemId="+i:"&wdTpl="+i),(i||o.createLcidEnabled)&&(d+="&wdlcid="+o.contextService.sharedContext.officeMarketLcid);var p=o.capabilitiesService.capabilities.scenarioId;p&&(d+="&wdscenarioid="+p),o.capabilitiesService.capabilities.outgoingLoginHintEnabled&&(d+="&login_hint="+encodeURIComponent(o.startupConfigService.config.loginHint)),d=d+"&wdPreviousSession="+o.startupConfigService.config.sharedClientStartupContext.sessionId+"&wdPreviousSessionSrc="+o.getHarmonySessionSource();var f=b.a.getOrigin(c);a([d,f])}else l("docliburl not in expected format")})).catch((function(){l("Failed to get doclib url")}))}))},e.prototype.getOriginParam=function(e,t){return this.contextService.getWdOrigin(t?e?"TEMPLATES-INSTANT":"TEMPLATES":e?"NEW-INSTANT":"NEW")},e.prototype.launchOfficeApp=function(e,t,i){return void 0===t&&(t=""),void 0===i&&(i=void 0),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(n){return n.launchApp({action:t?"OpenDocument":"OpenInApp",event:event,targetTab:i,appName:s.b[e],url:t,useUrl:!0}).then((function(e){if(!e.success)return Promise.reject()}))})):this.localAppLauncherService.launchOfficeApp(s.b[e],t).then((function(e){if(!e)return Promise.reject()}))},e.prototype.shouldOpenInUIHost=function(e,t){return(!t||this.capabilitiesService.capabilities.wacHostOrgTemplatesEnabled)&&this.capabilitiesService.wacHostEnabledForFileType(e)&&this.wacHostApps&&this.wacHostApps.has(e)},e.prototype.launchWebApp=function(e,t,n,i,r,o,a){a?(i&&i({type:"GoToBlankDoc",latency:o(),platform:"Web"}),a(),r()):n(e.webUrl,"GoToBlankDoc",t)},e.prototype.launchFluidExperience=function(e){var t=this;this.fluidHostContext.hostScenarioStartTime=Date.now(),this.setHostScenarioName(e),this.oneDriveService.getMyDriveRoot("network-first").then((function(n){var i=n.webUrl.lastIndexOf("/Documents");if(-1!==i){var r=n.webUrl.substring(0,i);t.officeRouteService.navigateTo({route:"Content",app:s.b.Fluid},!1,{action:"editnew",abpId:e===s.b.Fluid?void 0:1,siteUrl:r,drive:n.bilitiesService.capabilities.outgoingLoginHintEnabled)},e.prototype.setHostScenarioName=function(e){this.fluidHostContext.hostScenarioLifecycle="Create",this.fluidHostContext.hostScenarioName=e===s.b.Fluid?"Canvas":"BlueprintCanvas",this.fluidHostContext.hostScenarioEntryPoint=""},e.prototype.getMenuOrdering=function(){return this.capabilitiesService.capabilities.fluidFirst?e.fluidFirstMenuOrdering:this.capabilitiesService.capabilities.earlierStreamPlacementEnabled?e.streamEarlierMenuOrdering:e.menuOrdering},e.prototype.getCombinedMenuOrdering=function(){return this.capabilitiesService.capabilities.fluidFirst?this.capabilitiesService.capabilities.earlierStreamPlacementEnabled?e.fluidFirstStreamEarlierCombinedMenuOrdering:e.fluidFirstCombinedMenuOrdering:this.capabilitiesService.capabilities.earlierStreamPlacementEnabled?e.streamEarlierCombinedMenuOrdering:e.combinedMenuOrdering},e.menuOrdering=[s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNotePage,s.b.Sway,s.b.OneNote,s.b.Visio,s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Stream,s.b.ScreenRecording],e.streamEarlierMenuOrdering=[s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNotePage,s.b.Sway,s.b.OneNote,s.b.Visio,s.b.Stream,s.b.ScreenRecording,s.b.FluidActivityBlueprint,s.b.Fluid],e.fluidFirstMenuOrdering=[s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNotePage,s.b.Sway,s.b.OneNote,s.b.Visio,s.b.Stream,s.b.ScreenRecording],e.thirdPartyOrdering=[],e.firstPartyCreateIntentOrdering=[s.b.List,s.b.Designer,s.b.Yammer,s.b.PowerBI,s.b.Whiteboard],e.combinedMenuOrdering=[s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNote,s.b.List,s.b.Designer,s.b.OneNotePage,s.b.Sway,s.b.Visio,s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Yammer,s.b.PowerBI,s.b.Whiteboard,s.b.Stream,s.b.ScreenRecording],e.streamEarlierCombinedMenuOrdering=[s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNote,s.b.List,s.b.Designer,s.b.OneNotePage,s.b.Sway,s.b.Visio,s.b.Stream,s.b.ScreenRecording,s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Yammer,s.b.PowerBI,s.b.Whiteboard],e.fluidFirstCombinedMenuOrdering=[s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNote,s.b.List,s.b.Designer,s.b.OneNotePage,s.b.Sway,s.b.Visio,s.b.Yammer,s.b.PowerBI,s.b.Whiteboard,s.b.Stream,s.b.ScreenRecording],e.fluidFirstStreamEarlierCombinedMenuOrdering=[s.b.FluidActivityBlueprint,s.b.Fluid,s.b.Word,s.b.PowerPoint,s.b.Excel,s.b.Forms,s.b.FormsQuiz,s.b.OneNote,s.b.List,s.b.Designer,s.b.OneNotePage,s.b.Sway,s.b.Visio,s.b.Stream,s.b.ScreenRecording,s.b.Yammer,s.b.PowerBI,s.b.Whiteboard],e.fileTypeToConsumerWorkloadIdMap=new Map([[s.b.Word,"ShellWordOnline"],[s.b.PowerPoint,"ShellPowerPointOnline"],[s.b.Excel,"ShellExcelOnline"],[s.b.Forms,"ShellOfficeForms"],[s.b.FormsQuiz,"ShellOfficeForms"],[s.b.List,"ShellLists"],[s.b.Designer,"Designer"],[s.b.Sway,"ShellSway"]]),e.ɵprov=T.kc({factory:function(){return new e(T.lc(C.b),T.lc(d.a),T.lc(p.b),T.lc(f.a),T.lc(k),T.lc(I.a),T.lc(P),T.lc(E.a),T.lc(O.a),T.lc(l.a),T.lc(F.a),T.lc(a.b),T.lc(D.a),T.lc(v.a),T.lc(M.a),T.lc(h.a),T.lc(u.a),T.lc(R.a),T.lc(x.a),T.lc(U.a),T.lc(L.a),T.lc(p.b),T.lc(N.a),T.lc(W.a),T.lc(y.a),T.lc(j.a),T.lc(H.a),T.lc(B.a),T.lc(G.b),T.lc(q.a))},token:e,providedIn:"root"}),e}()},OtXi:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").u)("WRAPPER_VERSION")},OyI4:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("QjXU"),r=n("BaAg"),o=n("pOWU"),a=n("uUrA"),l=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p){var f=e.call(this,t,n,i,"MruPlusPlus",r,o,l,p)||this;f.globalErrorHandler=s,f.startupConfigService=c;var h=f.contextService.sharedContext,m=a.config;return f.supportedApps=d,f.serviceBaseUrl=f.inMockMode?h.officeHomeApiRoot+"/"+u:m.mruServiceRoot+"/"+u,f}return Object(i.__extends)(t,e),t.prototype.requestParams=function(e,n){var i=n&&n.size?this.supportedApps.filter((function(e){return n.has(r.a.fileTypeNameToFileType(e))})):this.supportedApps;return""+t.appSpecifier+i.join(",")+"&"+t.sizeSpecifier+e+"&"+t.localeSpecifier+this.contextService.sharedContext.officeMarket},t.prototype.getNewRequestConfig=function(e){return{headers:this.requestHeaders(e,a.a.createGuid())}},t.prototype.getRequestIdFromResponse=function(t){return e.prototype.getRequestIdFromResponse.call(this,t,"X-CorrelationId")},t.prototype.requestHeaders=function(e,t){var n=this.startupConfigService.config.sharedClientStartupContext,i=new Map([["X-Office-Platform","Web"],["X-Office-Application",this.contextService.sharedContext.iceApplicationId.toString()],["X-Office-Version",n.buildId],["X-CorrelationId",t]]);return e&&i.set("Content-Type","application/json"),i},t.localeSpecifier="rs=",t.sizeSpecifier="show=",t.appSpecifier="apps=",t}(o.a)},PBJH:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("QjXU"),r=n("BaAg"),o=n("dFxn"),a=n("BMb5"),l=n("TJwc"),s=n("/I02"),c=n("keVe"),u=function(){function e(e,t,n){this.windowService=n,this.dateFormatOptionsMap=new Map,this.intlSupported=!0,this.officeMarket=e.sharedContext.officeMarket,this.setSupportsLocaleSpecifiers(),this.dateFormatOptionsMap.set(1,{year:"numeric",month:"short",day:"numeric"}),this.dateFormatOptionsMap.set(2,{year:"numeric",month:"long",day:"numeric",weekday:"long"}),this.dateFormatOptionsMap.set(3,{day:"numeric",weekday:"short"}),this.dateFormatOptionsMap.set(4,{day:"numeric",weekday:"long"}),this.dateFormatOptionsMap.set(5,{month:"short",day:"numeric"}),this.dateFormatOptionsMap.set(6,{weekday:"short"}),this.dateFormatOptionsMap.set(7,{hour:"numeric",minute:"numeric"}),this.intlDateFormatterMap=new Map,this.tryInitializeIntlFormatter();var i=t.parse("resourceStrings");i&&Object.assign&&Object.assign(this,i)}return e.prototype.appResource=function(e,t){return this[""+e+r.b[t]]||this[e]},e.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return l.a.format.apply(l.a,Object(i.__spread)([e],t))},e.prototype.localizedDateString=function(e){return this.formatDate(e,0)},e.prototype.localizedDateStringMedium=function(e){return this.formatDate(e,1)},e.prototype.localizedDateStringLong=function(e){return this.formatDate(e,2)},e.prototype.localizedWeekdayDate=function(e){return this.formatDate(e,3)},e.prototype.localizedWeekdayDateLong=function(e){return this.formatDate(e,4)},e.prototype.localizedMonthDate=function(e){rocalizedWeekday=function(e){return this.formatDate(e,6)},e.prototype.formatTimeFromDate=function(e){return this.intlSupported&&this.intlDateFormatterMap&&(this.intlDateFormatterMap.has(7)||this.tryInitializeIntlFormatter(7))?this.intlDateFormatterMap.get(7).format(e):this.supportsLocaleSpecifiers&&this.dateFormatOptionsMap?e.toLocaleTimeString(this.officeMarket,this.dateFormatOptionsMap.get(7)):e.toTimeString()},e.prototype.localizedNumberString=function(e){return this.intlNumberFormatter?this.intlNumberFormatter.format(e):this.supportsLocaleSpecifiers?e.toLocaleString(this.officeMarket):e.toString()},e.prototype.appName=function(e){switch(e){case r.b.Word:return this.WordName;case r.b.Excel:return this.ExcelName;case r.b.PowerPoint:return this.PowerPointName;case r.b.Sway:return this.SwayName;case r.b.OneNote:return this.OneNoteName;case r.b.Visio:return this.VisioName;case r.b.Forms:case r.b.FormsQuiz:return this.FormsName;case r.b.Stream:return this.StreamName;case r.b.Fluid:case r.b.FluidActivityBlueprint:return this.FluidName;case r.b.Clipchamp:return this.ClipchampName}return""},e.prototype.tryInitializeIntlFormatter=function(e){if(!this.intlSupported)return!1;try{if("Intl"in this.windowService.nativeWindow)return e?(this.intlDateFormatterMap.set(e,new Intl.DateTimeFormat(this.officeMarket,this.dateFormatOptionsMap.get(e))),this.dateFormatOptionsMap.delete(e),0===this.dateFormatOptionsMap.size&&(this.dateFormatOptionsMap=null)):(this.intlDateFormatterMap.set(0,new Intl.DateTimeFormat(this.officeMarket)),this.intlNumberFormatter=new Intl.NumberFormat(this.officeMarket)),!0}catch(e){}return this.intlSupported=!1,this.intlDateFormatterMap=null,this.intlNumberFormatter=null,this.dateFormatOptionsMap=null,!1},e.prototype.formatDate=function(e,t){if(this.intlSupported&&this.intlDateFormatterMap&&(this.intlDateFormatterMap.has(t)||this.tryInitializeIntlFormatter(t)))return this.intlDateFormatterMap.get(t).format(e);if(this.supportsLocaleSpecifiers){if(0===t)return e.toLocaleDateString(this.officeMarket);if(this.dateFormatOptionsMap){var n=this.dateFormatOptionsMap.get(t);return e.toLocaleDateString(this.officeMarket,n)}}return e.toDateString()},e.prototype.setSupportsLring("i")}catch(e){return"RangeError"===e.name}return!1}()},e.ɵprov=c.kc({factory:function(){return new e(c.lc(s.a),c.lc(o.a),c.lc(a.b))},token:e,providedIn:"root"}),e}()},POe7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));vaorm=function(e){if(e)return{email:e.upn,fullName:e.name}},e}()},PTf4:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var i=n("BaAg");function r(e,t,n,r,o,a){if(n.config.moreTemplatesRedirectionEnabled)switch(e){case i.b.Visio:if(r.capabilities.modernTemplatesPageEnabled)return;var l=Date.now(),s=n.config.visioMoreTemplatesUrl;s=s+"&lpOrigin=OFFICECOM-WEB.START&correlationId="+o.config.sharedClientStartupContext.correlationId+"&omkt="+t+"&ds="+(a.user.isGcc?"1":"0")+"&ct="+l;var c=r.capabilities.scenarioId;return c&&(s=s+"&scenarioid="+c),s;default:return}}function o(e,t,n){switch(e){case i.b.Visio:return!n.config.visioUnsupportedTemplatesLocales.includes(t);default:return!0}}function a(e,t,n){switch(n){case i.b.Stream:return e.format(e[t.config.streamPreviewString],t.config.streamDocumentationUrl,t.config.streamCrossLinkUrl);default:return}}},PZOQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("PBJH");var i=function(){funtype.transform=function(e){return this.formatDataSize(e)},e.prototype.formatDataSize=function(e){for(var t=4,n=0;n<1&&t>=0;)n=e/Math.pow(1024,t),t--;var i=n<10&&n%1>=.1?10:1;n=Math.round(n*i)/i;var r=this.locService.localizedNumberString(n),o="";switch(t){case 3:o=this.locService.Terabytes;break;case 2:o=this.locService.Gigabytes;break;case 1:o=this.locService.Megabytes;break;case 0:o=this.locService.Kilobytes;break;case-1:o=this.locService.Bytes}return r+" "+o},e}()},PkQn:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=e(e){this.capabilitiesServiue=this.getClasses(),this.styleAttrValue=this.getStyle()},e.prototype.ngOnChanges=function(e){(e.hasOwnProperty("iconFontCssClass")||e.hasOwnProperty("iconFontType")||e.hasOwnProperty("iconFontName")||e.hasOwnProperty("cssClass"))&&(this.classAttrValue=this.getClasses()),(e.hasOwnProperty("size")||e.hasOwnProperty("color"))&&(thisprototype.handleClick=function(){this.iconClicked.emit()},e.prototype.getClasses=function(){var e=this.iconFontCssClass?this.iconFontCssClass:r.a.FluentIconCssClass,t=this.capabilitiesService.capabilities.svgAppIconsEnabled;return this.iconFontCssClass||(this.iconFontName?e+=" "+r.a.getCssClassFromGlyphName(this.iconFontName,t):void 0!==this.iconFontType&&(e+=" "+r.a.getCssClass(this.iconFontType,t))),this.cssClass&&(e+=" "+this.cssClass),this.isThirdParty&&(e+=" ms-ohp-Icon"),e},e.prototype.getStyle=function(){var e=this.style?this.style:{};return this.size&&(e["font-size"]=this.size+"px"),this.color&&(e.color=this.color),e},e}())},QOOv:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("mruConfig")||{activityEnabled:!1,activityStrings:{},addWacParams:!1,analyticsCachingEnabled:!1,analyticsEnabled:!1,clickableFolderEnabled:!1,copyLinkEnabled:!1,deferFeedWrite:!1,infiniteShowMoreEnabled:!1,isNewLifecycleEventEnabled:!1,isNewTimeWindowInHours:0,logThumbnailLoadSuccess:!1,maxInitialListItems:0,maxTotalListItems:0,mobileShareAndActivityEnabled:!1,mruActivityEnabled:!1,mruNumItemsToRequest:0,mruPinEnabled:!1,mruServiceRoot:null,newMruActions:!1,numRecommendedToRequest:0,officeFeedApiRootPath:"",officeFeedControlEnabled:!1,officeFeedFlightEnabled:!1,officeFeedFlightName:"",officeFeedFlightControlName:"",officeFeedExperimentName:"",officeFeedExperimentControlName:"",officeFeedFlight2Name:"",officeFeedFlight2ControlName:"",officeFeedExperiment2Name:"",officeFeedExperiment2ControlName:"",officeFeedFlight3Name:"",officeFeedFlight3ControlName:"",officeFeedExperiment3Name:"",officeFeedExperiment3ControlName:"",officeFeedNewSchemaEnabled:"",oneDriveDiscoverViewId:null,oneDriveRecentViewId:null,oneDriveSharedViewId:null,onlyMruActivityEnabled:!1,permissionsEnabled:!1,recommendedApiDismissedDocumentsPath:"",recommendedB2ApiRootPath:"",recommendedB2ApiFilesPath:"",recommendedB2EndpointEnabled:!1,recommendedCalloutEnabled:!1,recommendedEnabled:!1,recommendedFluidEnabled:!1,recommendedMotionEnabled:!1,recommendedNewCardsEnabled:!1,recommendedPdfEnabled:!1,recommendedRemoveItemEnabled:!1,recommendedVisioEnabled:!1,shareApiEndpoint:null,shareControlEnabled:!1,shareControlCAPPopupEnabled:!1,sharedAttachmentsEnabled:!1,sharedWithMeV2Enabled:!1,sharedWithMeViewEnabled:!1,sharingStatusEnabled:!1,showDownloadAction:!1,showZeroExperience:!1,substrateApiEndpoint:null,supportedFileTypes:[],supportedFileTypesSwM:[],swayTransformedFromWordAttributionEnabled:!1,tileViewEnabled:!1,threeSRecommendationsRootPath:"",threeSRecommendedDocumentsPath:"",threeSRecommendedDocumentsDismissPath:"",thumbnailSWEnabled:!1,trendingAroundMeEnabled:!1,webUrlMruConsumerEnabled:!1,wordIconFontClass:"",excelIconFontClass:"",visioIconFontClass:"",powerPointIconFontClass:"",oneNoteIconFontClass:"",swayIconFontClass:"",formsIconFontClass:"",powerBIIconFontClass:"",streamIconFontClass:"",outlookIconFontClass:"",silentS2SFlow:!1,upcomingMeetingAttendeeDisplayMax:0,upcomingMeetingEnabled:!1,useFeedS2SApi:!1,useThreeSRecommendationsApi:!1,myAnalyticsEnabled:!1}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},QhWD:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("QjXU"),r=n("CCRL"),o=n("casz"),a=n("cgnd"),l=n("RsrG"n Object(i.__generator)(this,(function(e){return[2]}))}))},e}(),c=function(){function e(e,t){this.scheduler=e,this.modulePriorityService=t}return e.prototype.shouldLoad=function(e){var t=this,n=this.modulePromise((function(e){return t.scheduler.scheduleWork(e,n)}))},e}(),u=n("keVe"),d=function(){function e(){}return e.ɵprov=u.kc({factory:function(){return function(e,t,n){try{switch(e.config.chunkLoadStrategy){case"idle-callback":return new c(t,n);case"noop":default:return new s}}catch(e){return new s}}(u.lc(a.b),u.lc(o.aector=t,this.downloadStrategy=n,this.ngModuleCache=new Map}return e.prototype.loadLazyViewFromModule=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,o,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t=this.ngModuleCache.get(e))?[3,3]:[4,this.downloadStrategy.shouldLoad(e)];case 1:return i.sent(),[4,this.ngModuleLoader.load(e)];case 2:n=i.sent(),t=n.create(this.injector),this.ngModuleCache.set(e,t),i.label=3;case 3:return o=t.componentFactoryResolver,a=t.injector.get(r.a),[2,actory:function(){return new e(u.lc(u.C),u.lc(u.r),u.lc(d))},token:e,providedIn:"root"}),e}()},QjXU:function(e,t,n){(function(n){var i,r,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S,y,C,w,T,k,I,_;!function(A){var P="object"==typeof !0}):e.__esModule=!0),function(n,i){return e[n]=t?t(n,i):i}}void 0===(i=function(e){!function(e){var t=Object.setPrototypeOf||{nce=null===n?Objectctop):tytie)thncObn=t<=aotncunur({Pr.hulpt to set private field on non-instance");return t.set(e,n),n},e("__extends",r),e("__assign",o),e("__rest",a),e("__decorate",l),e("__param",s),e("__metadata",c),e("__awaiter",u),e("__generator",d),e("__exportStar",p),e("__values",f),e("__read",h),e("__spread",m),e("__spreadArrays",b),e("__spreadArray",g),e("__await",v),e("__asyncGenerator",S),e("__asyncDelegator",y),e("__asyncValues",C),e("__makeTemplateObject",w),e("__importStar",T),e("__importDefault",k),e("__classPrivateFieldGet",I),e("__classPrivateFieldSet",_)}(E(P,E(e)))}.apply(t,[t]))||(e.exports=i)}()}).call(this,n("pCvA"))},Qqp8:function(e,t,n){"u{return e===i.b.Video||e===i.b.Stream||e===i.b.StreamsVideo}},QtYd:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ne})),n.d(t,"b",(function(){return Qe}));var i=n("keVe"),r=n("7IJ8"),o=n("QhWD"),a=n("hhzZ"),l=n("cgnd"),s=n("casz"),c=n("RsrG"),u=n("6Po3"),d=n("WLAd"),p=n("TOqr"),f=n("g0MB"),h=n("w1PR"),m=n("pzhl"),b=n("PkQn"),g=n("4/We"),v=n("9gjh"),S=n("7J/E"),y=n("PBJH"),C=n("/I02"),w=n("55A9"),T=n("TDzr"),k=n("7Gwk"),I=n("EYcb"),_=n("2lMP"),A=n("dx17"),P=n("qCYW"),E=n("pd4Y"),O=n("W3Zz"),F=n("hZW2"),D=n("y1jW"),M=n("Bc8L"),R=n("QOOv"),x=n("kfAr"),L=n("dOgD"),U=n("Z0U4"),N=n("Dpxn"),W=n("EqbI"),j=n("Uqr9"),H=n("1Bt+"),B=n("OPwp"),G=n("uNUv"),q=n("6u39"),V=n("TIi1"),z=n("Xc4i"),K=n("EUVs"),Z=n("BMb5"),Q=n("hoyd"),X=n("7Rc8"),J=n("DQbD"),Y=n("GmnP"),$=n("kpuN"),ee=n("U8M1"),te=n("gZ+X"),ne=n("XWg3"),ie=n("sVeK"),re=n("WJRI"),oe=n("kVgv"),ae=n("KoFE"),le=n("9c4X"),se=n("QjXU"),ce=n("zvoD"),ue=n("f0qX"),de=n("dpyN"),pe=function(e){function t(t){var n=e.call(this,217,434,868)||this;return n.eventService=t,n.eventService.events.withScope(0).pipe(Object(ce.a)((functect(ue.a)((funct(de.a)((function(e,t){return e.size===t.size&&e.num===t.num}))).subscribe((function(e){var t=e.size,i=e.num;n.updateItemAndBufferSize(t,t*(i+1),t*(i+3))})),n}return Object(se.__extends)(t,e),t}(ne.e),fe=n("Eup2"),he=n("RJiy"),me=n("lrJm"),be=n("rBEp"),ge=n("7wk3"),ve=n("AXqk"),Se=n("xoWf"),ye=n("SPVw"),Ce=n("Vwd8"),we=n("gO/A"),Te=i.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:":enter",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:"{{ opacity }}"},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"150ms",opacity:.5}}},options:{params:{fadeInDuration:"500ms",opacity:1}}},options:null}],options:{}},{type:7,name:"recommendedMotionTrigger",definitions:[{type:0,name:"moving",styles:{type:6,styles:{transform:"{{ translationParam }}"},offset:null},options:{params:{translationParam:"translateX(0)"}}},{type:1,expr:"*=>moving",animation:{type:4,styles:null,timings:"400ms ease-in-out"},options:null}],options:{}}]}});function ke(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"h3",[["class","ms-fcl-nd"],["id","recommendedHeader"]],null,null,null,null,null)),i.Gb(1,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"list-header__title list-header__title--carousel":0,"li,0,!n.fluentRefresh,n.fluentRefresh);e(t,1,0,"ms-fcl-nd",i)}),(function(e,t){e(t,3,0,t.component.recommendedTitle)}))}function Ie(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,14,"div",[["class","carousel-nav"]],null,null,null,null,null)),i.Gb(1,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"fluentvnext-background":0}),(e()(),i.Hb(3,0,[[3,0],["recommendedNavLeft",1]],null,5,"button",[["class","icon-button ms-bgc-g40-h ms-fcl-nd-h"],["data-clicklog","custom"],["id","recommended-nav-left"],["keyboardFocusTooltip",""]],[[1,"aria-label",0],[8,"title",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"focus"],[null,"click"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onScrollFocus(!0)&&i),"click"===t&&(i=!1!==r.navigateCards(-1)&&i),i}),null,null)),i.Gb(4,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(5,{"icon-button--disabled ms-fcl-nta":0,"ms-fcl-ns":1,"first-arrow":2,"icon-button--fluent":3}),i.Gb(6,4210688,null,0,f.a,[i.o,i.K,h.b],null,null),(e()(),i.Hb(7,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronLeft"],["size","16"]],null,null,null,m.b,m.a)),i.Gb(8,638976,null,0,b.a,[g.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),i.Hb(9,0,[[4,0],["recommendedNavRight",1]],null,5,"button",[["class","icon-button ms-bgc-g40-h ms-fcl-nd-h"],["data-clicklog","custom"],["id","recommended-nav-right"],["keyboardFocusTooltip",""]],[[1,"aria-label",0],[8,"title",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"focus"],[null,"click"]],(function(e,t,n){var i=!0,r=e.component;return"focus"===t&&(i=!1!==r.onScrollFocus(!1)&&i),"click"===t&&(i=!1!==r.navigateCards(1)&&i),i}),null,null)),i.Gb(10,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(11,{"icon-button--disabled ms-fcl-nta":0,"ms-fcl-ns":1,"icon-button--fluent":2}),i.Gb(12,4210688,null,0,f.a,[i.o,i.K,h.b],null,null),(e()(),i.Hb(13,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronRight"],["size","16"]],null,null,null,m.b,m.a)),i.Gb(14,638976,null,0,b.a,[g.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isVisualRefresh);e(t,1,0,"carousel-nav",i);var r=e(t,5,0,0===n.currentCarouselPage,0!==n.currentCarouselPage,!n.fluentRefresh,n.fluentRefresh);e(t,4,0,"icon-button ms-bgc-g40-h ms-fcl-nd-h",r),e(t,8,0,"carousel-nav__arrow","ChevronLeft","16",!0);var o=e(t,11,0,n.currentCarouselPage+n.cardIncrement>=n.cards.length,n.currentCarouselPage+n.cardIncrement<n.cards.length,n.fluentRefresh);e(t,10,0,"icon-button ms-bgc-g40-h ms-fcl-nd-h",o),e(t,14,0,"carousel-nav__arrow","ChevronRight","16",!0)}),(function(e,t){var n=t.component;e(t,3,0,n.previousPage,n.previousPage,0===n.currentCarouselPage,0===n.currentCarouselPage?-1:0),e(t,9,0,n.nextPage,n.nextPage,n.currentCarouselPage+n.cardIncrement>=n.cards.length,n.currentCarouselPage+n.cardIncrement>=n.cards.length?-1:0)}))}function _e(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,5,"div",[],null,null,null,null,null)),i.Gb(1,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(2,{"carousel-card--hidden":0,"carousel-card--display-none":1,"carousel-card-container carousel-card--peek":2,"carousel-card-container--fluent":3}),(e()(),i.Hb(3,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,n){var i=!0;return"deleteItem"===t&&(i=!1!==e.component.onDeleteRecommendedItem(n)&&i),i}),v.b,v.a)),i.bc(512,null,S.a,S.a,[y.a,C.a,w.a,T.a,k.a,I.a,l.b]),i.Gb(5,770048,null,0,_.a,[A.a,g.a,l.b,P.a,C.a,E.a,O.c,F.a,D.b,k.a,a.a,M.a,y.a,R.a,x.a,S.a,L.a,U.a,N.a,W.a,j.b,i.K,H.a,B.b,G.a,q.a,V.a,z.a,K.a,Z.b,Q.a,X.a,J.a,Y.a,$.b,ee.a],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem"})],(function(e,t){var n=t.component,i=e(t,2,0,"moving"!==n.motionState&&t.context.index<n.currentCarouselPage,"moving"!==n.motionState&&t.context.index>n.currentCarouselPage+n.cardIncrement+(n.visibleCardPeek?0:-1),!n.fluentRefresh,n.fluentRefresh);e(t,1,0,i),e(t,5,0,t.context.$implicit,t.context.index,t.context.index,n.recommendedDocView,n.listId,n.shent;e(t,2,0,n.recommendedMotionList,n.trackByIndex)}),null)}function Pe(e){return i.jc(0,[(e()(),i.Hb(0,0,[[5,0],["virtualCard",1]],null,3,"div",[["class","carousel-card-container carousel-card--virtual-touch"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,n){var i=!0;return"deleteItem"===t&&(i=!1!==e.component.onDeleteRecommendedItem(n)&&i),i}),v.b,v.a)),i.bc(512,null,S.a,S.a,[y.a,C.a,w.a,T.a,k.a,I.a,l.b]),i.Gb(3,770048,null,0,_.a,[A.a,g.a,l.b,P.a,C.a,E.a,O.c,F.a,D.b,k.a,a.a,M.a,y.a,R.a,x.a,S.a,L.a,U.a,N.a,W.a,j.b,i.K,H.a,B.b,G.a,q.a,V.a,z.a,K.a,Z.b,Q.a,X.a,J.a,Y.a,$.b,ee.a],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem"})],(function(e,t){var n=t.component;e(t,3,0,t.context.$implicit,t.context.index+n.currentCarouselPage,t.context.index,n.recommendedDocView,n.listId,n.showActivity,n.showSharing,n.showAnalytics,n.fileType)}),null)}function Ee(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,4,"cdk-virtual-scroll-viewport",[["class","virtual-scroll-cards cdk-virtual-scroll-viewport"],["orientation","horizontal"]],[[2,"cdk-virtual-scroll-orientation-horizontal",null],[2,"cdk-virtual-scroll-orientation-vertical",null]],null,null,te.b,te.a)),i.bc(6144,null,ne.b,null,[ne.d]),i.Gb(3,245760,null,0,ne.d,[i.o,i.h,i.F,[2,ne.h],[2,ie.b],ne.f,[2,ne.i]],{orientation:[0,"orientation"]},null),(e()(),i.qb(16777216,null,0,1,null,Pe)),i.Gb(5,409600,null,0,ne.c,[i.W,i.S,i.x,[1,ne.d],i.F],{cdkVirtualForOf:[0,"cdkVirtualForOf"],cdkVirtualForTrackBy:[1,"cdkVirtualForTrackBy"]},null)],(function(e,t){var n=t.component;e(t,3,0,"horizontal"),e(t,5,0,n.cards,n.trackByIndex)}),(function(e,t){e(t,1,0,"horizontal"===i.Wb(t,3).orientation,"horizontal"!==i.Wb(t,3).orientation)}))}function Oe(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,"div",[["class","carousel-card-container carousel-card--desktop"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,n){var i=!0;return"deleteItem"===t&&(i=!1!==e.component.onDeleteRecommendedItem(n)&&i),i}),v.b,v.a)),i.bc(512,null,S.a,S.a,[y.a,C.a,w.a,T.a,k.a,I.a,l.b]),i.Gb(3,770048,null,0,_.a,[A.a,g.a,l.b,P.a,C.a,E.a,O.c,F.a,D.b,k.a,a.a,M.a,y.a,R.a,x.a,S.a,L.a,U.a,N.a,W.a,j.b,i.K,H.a,B.b,G.a,q.a,V.a,z.a,K.a,Z.b,Q.a,X.a,J.a,Y.a,$.b,ee.a],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"],leftAlignActionsMenu:[9,"leftAlignActionsMenu"]},{deleteItem:"deleteItem"})],(function(e,t){var n=t.component;e(t,3,0,t.context.$implicit,t.context.index+n.currentCarouselPage,t.context.index,n.recommendedDocView,n.listId,n.showActivity,n.showSharing,n.showAnalytics,n.fileType,!1)}),null)}function Fe(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,2,null,Oe)),i.Gb(2,278528,null,0,p.j,[i.W,i.S,i.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),i.Yb(0,p.r,[]),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component;e(t,2,0,i.hc(t,2,0,i.Wb(t,3).transform(n.cards,n.currentCarouselPage,n.currentCarouselPage+n.cardIncrement)),n.trackByIndex)}),null)}function De(e){return i.jc(0,[i.cc(671088640,1,{carouselElement:0}),i.cc(671088640,2,{carouselContainer:0}),i.cc(671088640,3,{recommendedNavLeft:0}),i.cc(671088640,4,{recommendedNavRight:0}),i.cc(671088640,5,{virtualCards:1}),(e()(),i.Hb(5,0,null,null,1,"ohp-title-announcer",[],null,null,null,re.b,re.a)),i.Gb(6,49152,null,0,oe.a,[],{announcement:[0,"announcement"]},null),(e()(),i.Hb(7,0,[[2,0],["carouselContainer",1]],null,24,"div",[["class","carousel"]],[[8,"hidden",0],[24,"@fadeIn",0],[24,"@.disabled",0],[1,"aria-label",0]],null,null,null,null)),i.Gb(8,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(9,{"carousel--fluent":0}),(e()(),i.Hb(10,0,null,null,6,"div",[],null,null,null,null,null)),i.Gb(11,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(12,{"list-header--carousel--motion":0,"list-header list-header--carousel":1,"list-header--fluent":2}),(e()(),i.qb(16777216,null,null,1,null,ke)),i.Gb(14,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ie)),i.Gb(16,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(17,0,null,null,14,"div",[],null,null,null,null,null)),i.Gb(18,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(19,{"carousel--outer carousel--virtual-outer":0,"recommended-container__motion":1,"recommended-container__motion--fluent":2,"recommended-container__motion--hidden":3,"recommended-container__gap":4}),(e()(),i.Hb(20,0,[[1,0],["carouselElement",1]],null,11,"div",[],[[24,"@recommendedMotionTrigger",0]],[[null,"ohpResize"],[null,"@recommendedMotionTrigger.done"]],(function(e,t,n){var i=!0,r=e.component;return"ohpResize"===t&&(i=!1!==r.updateCarouselCardData()&&i),"@recommendedMotionTrigger.done"===t&&(i=!1!==r.recommendedMotionDone()&&i),i}),null,null)),i.Gb(21,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(22,{"carousel--inner":0,"generic-tile-container generic-tile-container--card card__content":1,"recommended-inner__motion":2,"recommended-inner__motion--fluent":3,"generic-tile-container--card--fluent":4}),i.Gb(23,4407296,null,0,ae.a,[le.a,i.o,u.a],null,{resize:"ohpResize"}),i.Zb(24,{translationParam:0}),i.Zb(25,{value:0,params:1}),(e()(),i.qb(16777216,null,null,1,null,Ae)),i.Gb(27,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ee)),i.Gb(29,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Fe)),i.Gb(31,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,6,0,n.statusAnnouncement);var i=e(t,9,0,n.fluentRefresh);e(t,8,0,"carousel",i);var r=e(t,12,0,n.recommendedMotion,!n.fluentRefresh,n.fluentRefresh);e(t,11,0,r),e(t,14,0,n.cards&&n.cards.length>0),e(t,16,0,n.cards&&!n.canSwipeRecommended&&!(0===n.currentCarouselPage&&n.currentCarouselPage+n.cardIncrement>=n.cards.length));var o=e(t,19,0,n.canSwipeRecommended,n.recommendedMotion,n.recommendedMotion&&n.fluentRefresh,"moving"===n.motionState,n.recommendedMotion||n.fluentRefresh);e(t,18,0,o);var a=e(t,22,0,n.canSwipeRecommended,!n.canSwipeRecommended&&!n.recommendedMotion,n.recommendedMotion,n.recommendedMotion&&n.fluentRefresh,!n.recommendedMotion&&!n.canSwipeRecommended&&n.fluentRefresh);e(t,21,0,a),e(t,23,0),e(t,27,0,n.recommendedMotion),e(t,29,0,n.canSwipeRecommended),e(t,31,0,!n.canSwipeRecommended&&!n.recommendedMotion)}),(function(e,t){var n=t.component;e(t,7,0,!n.cards||!n.cards.length,void 0,n.disableAnimation,n.recommendedTitle);var i=e(t,25,0,n.motionState,e(t,24,0,n.translateX));e(t,20,0,i)}))}i.Db("ohp-recommended",fe.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"ohp-recommended",[],null,null,null,De,Te)),i.bc(4608,null,ne.h,pe,[k.a]),i.Gb(2,8634368,null,0,fe.a,[g.a,i.h,he.a,C.a,ee.a,me.b,j.b,be.a,ge.a,R.a,O.c,y.a,F.a,a.a,ve.a,k.a,Se.a,ye.a,Ce.b,L.a,l.b,Z.b,we.a],null,null)],(function(e,t){e(t,2,0)}),null)}),{carousel:"carousel",navClickLogging:"navClickLogging",fourCardsMax:"fourCardsMax",isSuggestedActions:"isSuggestedActions",componentArea:"componentArea",fileType:"fileType",isStartPage:"isStartPage"},{stateChanged:"stateChanged"},[]);var Me=n("OOtI"),Re=n("+YV+"),xe=n("9MHL"),Le=n("JScD"),Ue=n("mNaV"),Ne=i.Fb({encapsulation:2,styles:[],data:{}});function We(e){return i.jc(0,[(e()(),i.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.Gb(1,475136,null,0,r.a,[o.a,i.W,a.a,l.b,s.a,c.a,u.a,i.F,d.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){e(t,1,0,"create-on-home-wrapper#CreateOnHomeWrapperModule")}),null)}function je(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"ohp-recommended",[],null,null,null,De,Te)),i.bc(4608,null,ne.h,pe,[k.a]),i.Gb(2,8634368,null,0,fe.a,[g.a,i.h,he.a,C.a,ee.a,me.b,j.b,be.a,ge.a,R.a,O.c,y.a,F.a,a.a,ve.a,k.a,Se.a,ye.a,Ce.b,L.a,l.b,Z.b,we.a],{isSuggestedActions:[0,"isSuggestedActions"],fileType:[1,"fileType"],isStartPage:[2,"isStartPage"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.isSuggestedActions,n.fileType,!!n.fileType)}),null)}function He(e){return i.jc(0,[(e()(),i.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.Gb(1,475136,null,0,r.a,[o.a,i.W,a.a,l.b,s.a,c.a,u.a,i.F,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Zb(2,{fileType:0}),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.fileType);e(t,1,0,"recommended-react#RecommendedReactModule",n)}),null)}function Be(e){return i.jc(0,[(e()(),i.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.Gb(1,475136,null,0,r.a,[o.a,i.W,a.a,l.b,s.a,c.a,u.a,i.F,d.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){e(t,1,0,"learning-shelf-react#LearningShelfReactModule")}),null)}function Ge(e){return i.jc(0,[(e()(),i.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.Gb(1,475136,null,0,r.a,[o.a,i.W,a.a,l.b,s.a,c.a,u.a,i.F,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"],outputs:[2,"outputs"]},null),i.Zb(2,{headless:0,recentMruStreamData:1,fileType:2,maxInitialDocs:3,maxTotalDocs:4}),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.headless,n.recentMruStream,n.fileType,n.maxInitialDocs,n.maxTotalDocs);e(t,1,0,"mru#MruModule",i,n.mruOutputs)}),null)}function qe(e){return i.jc(0,[(e()(),i.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.Gb(1,475136,null,0,r.a,[o.a,i.W,a.a,l.b,s.a,c.a,u.a,i.F,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Zb(2,{fileType:0}),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.fileType);e(t,1,0,"edgeworth#EdgeworthModule",n)}),null)}function Ve(e){return i.jc(0,[(e()(),i.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.Gb(1,475136,null,0,r.a,[o.a,i.W,a.a,l.b,s.a,c.a,u.a,i.F,d.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){e(t,1,0,"quick-access#QuickAccessReactModule")}),null)}function ze(e){return i.jc(0,[(e()(),i.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),i.Gb(1,475136,null,0,r.a,[o.a,i.W,a.a,l.b,s.a,c.a,u.a,i.F,d.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),i.qb(0,null,null,0))],(function(e,t){e(t,1,0,"learning-shelf-react#LearningShelfReactModule")}),null)}function Ke(e){return i.jc(0,[(e()(),i.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),i.Gb(1,475136,null,0,r.a,[o.a,i.W,a.a,l.b,s.a,c.a,u.a,i.F,d.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),i.Zb(2,{fileType:0}),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.fileType);e(t,1,0,"ew-react#EdgeworthReactModule",n)}),null)}function Ze(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,22,"div",[["class","mru-section section--fluent"],["id","mru-section"],["role","region"]],[[1,"aria-label",0]],null,null,null,null)),(e()(),i.Hb(1,0,[[1,0],["widthRestrictorElement",1]],null,21,"div",[],null,null,null,null,null)),i.Gb(2,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(3,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1}),(e()(),i.qb(16777216,null,null,1,null,We)),i.Gb(5,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(6,0,null,null,4,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,je)),i.Gb(8,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,He)),i.Gb(10,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Be)),i.Gb(12,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ge)),i.Gb(14,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,qe)),i.Gb(16,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ve)),i.Gb(18,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,ze)),i.Gb(20,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,Ke)),i.Gb(22,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,!n.noGutter,n.noGutter);e(t,2,0,i),e(t,5,0,n.createOnHomeEnabled),e(t,8,0,!n.recommendedReact),e(t,10,0,n.recommendedReact),e(t,12,0,n.learningShelfEnabled&&!n.homeReorderedEnabled),e(t,14,0,(n.initialDocsAvailable||n.showZeroExperience)&&!n.edgeworthEnabled),e(t,16,0,n.edgeworthEnabled&&!n.edgeworthReactEnabled&&!n.quickAccessEnabled),e(t,18,0,n.edgeworthEnabled&&n.quickAccessEnabled),e(t,20,0,n.learningShelfEnabled&&n.homeReorderedEnabled),e(t,22,0,n.edgeworthEnabled&&n.edgeworthReactEnabled&&!n.quickAccessEnabled)}),(function(e,t){e(t,0,0,t.component.sectionLandmarkAriaLabel)}))}function Qe(e){return i.jc(0,[i.cc(671088640,1,{widthRestrictorElement:0}),(e()(),i.Hb(1,0,null,null,4,"div",[["class","mru-component"]],null,null,null,null,null)),i.Gb(2,278528,null,0,p.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(3,{"section--first":0}),(e()(),i.qb(16777216,null,null,1,null,Ze)),i.Gb(5,16384,null,0,p.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,n.firstSection&&(!n.leftNavReact||n.isConsumer)&&!n.visualBackgroundEnabled);e(t,2,0,"mru-component",i),e(t,5,0,n.initialDocsAvailable||n.showZeroExperience||n.hasRecommendedDocs||n.edgeworthEnabled)}),null)}i.Db("ohp-documents-component",Me.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-documents-component",[],null,null,null,Qe,Ne)),i.Gb(1,4440064,null,0,Me.a,[g.a,k.a,R.a,y.a,X.a,L.a,Re.a,he.a,xe.a,Le.a,l.b,l.b,Ue.a,C.a,we.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{firstSection:"firstSection",fileType:"fileType",headless:"headless",maxInitialDocs:"maxInitialDocs",maxTotalDocs:"maxTotalDocs",isSuggestedActions:"isSuggestedActions"},{mruStateChanged:"mruStateChanged"},[])},R0N1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("/I02");var i=function(){fun.target=this.contextService.sharedContext.defaultLinkTarget},e}()},R7NL:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("QjXU"),r=n("9h0M"),o=n("EH+r"),a=n("ciUQ"),l=n("+2OL"),s=n("Ft/N"),c=n("JWB6"),u=n("3GGT"),d=n("wwmn"),p=n("Uqr9"),f=n("BMb5"),h=n("cgnd"),m=n("/I02"),b=n("hhzZ"),g=n("keVe"),v=n("5MEU"),S=function(){function e(e){this.promise=e}return Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"Promnstrument=functio.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.catch=function(e){return this.promise.catch(e)},e.prototype.finally=function(e){return this.promise.finally(e)},e}(),y=function(){function e(e,t,n,i,r,o,a,l,s){this.httpClient=e,this.contextService=t,this.startupConfigService=n,this.instrumentationService=i,this.windowService=r,this.serviceWorkerStateService=a,this.serviceWorkerConfigService=l,this.workloadQueryParameterValue=s,this.officeHomeApiConfig=o.config}return e.prototype.request=function(t,n,i,l,s,c,d,f){var h=this,m=p.a.now(),g=0,v="cache-only"===l,y=new Promise((function(t,n){if(v){var o=h.serviceWorkerConfigService.config.enabled;if(!o||"Controlled"!==h.serviceWorkerStateService.currentState)return void n(e.failedResponseWithCode(u.a.NotImplemented,i,v,"Cache is not available. Service Worker is in "+(o?h.serviceWorkerStateService.currentState:"disabled")+" state"))}var p={};i.headers&&i.headers.forEach((function(e,t){p[t]=e}));var m=!!s||!!c,b=m?"events":"response",g={headers:new r.i(p),params:new r.j({fromObject:i.params}),method:i.method,reportProgress:m,responseType:i.responseType,observe:b},S=new r.k(i.method,i.url,i.body,g),y=function(e){var t;return e instanceof r.l?t=e.body:e instanceof r.f&&(t=e.error),{data:t,status:e.status,headers:e.headers,config:i,ok:e.ok,statusText:e.statusText,fromCache:v}},C=h.httpClient.request(S).pipe(Object(a.a)(f||h.officeHomeApiConfig.defaultTimeoutInMs)).subscribe((function(e){e instanceof r.l?t(y(e)):e.type===r.g.UploadProgress&&s?s(e):e.type===r.g.DownloadProgress&&c&&c(e)}),(function(t){if("TimeoutError"!==t.name){var r=h.windowService.nativeWindow.navigator;n(!r||"boolean"!=typeof r.onLine||r.onLine?y(t):e.failedResponseWithCode(u.a.Offline,i,v))}else n(e.failedResponseWithCode(u.a.Timeout,i,v))}));d&&d.onCancel((function(){return C.unsubscribe()}))})),C=new S(y),w=function(i){if(!i.fromCache||i.ok||i.status!==u.a.NotImplemented){g=Math.ceil(p.a.now()-m);var r=i.status;null==r&&(r=e.unknownStatusCode);var a,l=i.statusText,s=l;null==l?(a=e.unknownError,s=e.unknownError):a="ok"===l.toLowerCase()?l:new b.d(l);var c={};C.instrumentCallback&&C.instrumentCallback(i,c),c.hasOwnProperty("HttpCode")&&(r=c.HttpCode,delete c.HttpCode),Object(o.a)({eventName:n,error:s,latency:g,fromCache:i.fromCache,httpCode:r,instrumentationParams:c}),h.instrumentationService.generateRequestEvent(t,r,g,a,i.fromCache,c).record()}},T=d?d.onCancel((function(){return Promise.resolve(e.failedResponseWithCode(u.a.Cancelled,i,v))})):new Promise((function(){}));return Promise.race([y,T]).then(w,w),C},e.prototype.get=function(e,t,n,r,o,a,l,s){var c=Object(i.__assign)({},r);return c.url=n,c.method="GET",this.request(e,t,c,o,null,a,l,s)},e.prototype.post=function(e,t,n,r,o,a,l,s,c,u){void 0===o&&(o={});var d=Object(i.__assign)({},o);return d.url=n,d.method="POST",d.body=r,this.request(e,t,d,u||"network-only",a,l,s,c)},e.prototype.put=function(e,t,n,r,o,a,l,s,c){void 0===o&&(o={});var u=Object(i.__assign)({},o);return u.url=n,u.method="PUT",u.body=r,this.request(e,t,u,"network-only",a,l,s,c)},e.prototype.delete=function(e,t,n,r,o,a,l){void 0===o&&(o={});var s=Object(i.__assign)({},o);return s.url=n,s.method="DELETE",s.body=r,this.request(e,t,s,"network-only",null,null,a,l)},e.prototype.patch=function(e,t,n,r,o,a,l,s,c){void 0===o&&(o={});var u=Object(i.__assign)({},o);return u.url=n,u.method="PATCH",u.body=r,this.request(e,t,u,"network-only",a,l,s,c)},e.failedResponseWithCode=function(e,t,n,i){return{data:null,status:e,headers:new r.i,config:t,ok:!1,statusText:i||u.a[e],fromCache:n}},e.prototype.prepareRequest=function(e,t){var n=this;if("Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled&&(e.headers?e.headers.forEach((function(t,i){if(void 0===t){e.headers.set(i,"");var r={ItemCategory:"Malformed Request"};r.Error="Undefined header passed to Service Worker: "+i,n.instrumentationService.logGenericEvent("Unhandled_Exception",r)}})):e.headers=new Map,e.headers.set(s.a,t)),0===e.url.lastIndexOf(this.contextService.sharedContext.officeHomeApiRoot+"/",0)){e.headers||(e.headers=new Map);var i=this.officeHomeApiConfig,r=this.startupConfigService.config;i.correlationIdHeader&&r.sharedClientStartupContext.correlationId&&e.headers.set(i.correlationIdHeader,r.sharedClientStartupContext.correlationId),i.userIdHeader&&r.puid&&e.headers.set(i.userIdHeader,r.puid),i.tenantIdHeader&&r.tenantId&&e.headers.set(i.tenantIdHeader,r.tenantId),i.authTypeHeader&&r.authTypeString&&e.headers.set(i.authTypeHeader,r.authTypeString),i.authVersionHeader&&r.authVersion&&e.headers.set(i.authVersionHeader,r.authVersion),e.params||(e.params={}),i.workloadQueryParameter&&(e.params[i.workloadQueryParameter]=this.workloadQueryParameterValue),r.sharedClientStartupContext.testTraffic&&i.testTrafficHeader&&e.headers.set(i.testTrafficHeader,"1"),!r.sharedClientStartupContext.corpNet&&i.externalTrafficHeader&&e.headers.set(i.externalTrafficHeader,"1"),(i.flightOverridesParamName&&i.flightOverrides||i.featureOverridesParamName&&i.featureOverrides)&&(i.flightOverridesParamName&&i.flightOverrides&&!e.params.hasOwnProperty(i.flightOverridesParamName)&&(e.params[i.flightOverridesParamName]=i.flightOverrides),i.featureOverridesParamName&&i.featureOverrides&&!e.params.hasOwnProperty(i.featureOverridesParamName)&&(e.params[i.featureOverridesParamName]=i.featureOverrides))}},e.unknownError="NotAvailable",e.unknownStatusCode=-1,e.ɵprov=g.kc({factory:function(){return new e(g.lc(r.c),g.lc(m.a),g.lc(h.b),g.lc(b.a),g.lc(f.b),g.lc(d.a),g.lc(c.a),g.lc(l.a),g.lc(v.a))},token:e,providedIn:"root"}),e}()},RJiy:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("lrJm"),r=n("hhzZ"),o=n("R7NL"),a=n("QOOv"),l=n("7ma0"),s=n("kpuN"),c=n("wwmn"),u=n("casz"),d=n("ZtId"),p=n("BMb5"),f=n("4/We"),h=n("cgnd"),m=n("/I02"),b=n("9260"),g=n("keVe"),v=n("TOqr"),S=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f){this.recommendedDataService=new b.a(e,t,n,i,r,o,a,l,s,c,u,d,p,f)}return e.prototype.getRecommendedService=function(){return this.recommendedDataService},e.ɵprov=g.kc({factory:function(){return new e(g.lc(s.b),g.lc(f.a),g.lc(m.a),g.lc(r.a),g.lc(o.a),g.lc(a.a),g.lc(c.a),g.lc(v.q),g.lc(i.b),g.lc(h.b),g.lc(d.a),g.lc(u.a),g.lc(p.b),g.lc(l.a))},token:e,providedIn:"root"}),e}(),y=function(){function e(){}return e.ɵprov=g.kc({factory:function(){return function(e){return e.getRecommendedService()}(g.lc(S))},token:e,providedIn:"root"}),e}()},"RR/o":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return p}));var i,r=n("QjXU"),o=n("kaEK"),a=n("BaAgpleTaskActivityYouCreator=35]="MultipleTaskActivityYouCreator"}(i||(i={}));var p=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g){var v=e.call(this,t,n,i,r,o,l,s,c,u,"v2/recent",l.config.supportedFileTypes,f)||this;return v.userContextService=a,v.mruConfigService=l,v.performanceService=d,v.updateContentService=p,v.windowService=h,v.capabilitiesService=m,v.urlAuthenticatorService=b,v.deviceDetector=g,v.fetchRequestIndex=0,v.mruDataStreams=new Map,v.windowService=h,v}return Object(r.__extends)(t,e),t.convertMruActivityToActivityDescription=function(e){for(var n=e.badge.message_format,i=null,r=function(){var t=i[1];n=n.replace(i[0],(function(){return"<c"+t+">"+e.badge.users[t].display_name+"</c"+t+">"}))};null!==(i=t.activityRegex.exec(n));)r();return{formatString:n,plainText:c.a.stripTags(n),people:(e.badge.users||[]).map((function(e,t){return{upn:e.upn,tag:"c"+t,name:e.display_name}})),reasonType:t.convertMruReasonTypeToActivityReason(e.badge.type),timestamp:e.badge.timestamp?new Date(e.badge.timestamp):null}},t.convertMruReasonTypeToActivityReason=function(e){switch(e){case i.FrequentlyOpen:case i.RecentlyOpen:case i.WeeklyOpen:return o.a.Open;case i.SingleEditYou:case i.MultipleEditOthers:case i.MultipleEditYouAndOthers:case i.SingleEditOthers:return o.a.Edit;case i.SingleCommentYou:case i.SingleCommentOthers:case i.MultipleCommentOthers:case i.MultipleCommentYouAndOthers:case i.CommentReplyYou:case i.CommentReplyOthers:case i.CommentReplyToYou:return o.a.Comment;case i.SharedWithMe:return o.a.Share;case i.EmailAttachment:return o.a.Attachment;case i.SingleMentionYou:case i.MultipleMentionYouAndOthers:case i.SingleMentionOthers:case i.MultipleMentionOthers:case i.SingleMentionedYou:case i.MultipleMentionedYou:return o.a.Mention;case i.SnoozeExpiry:return o.a.SnoozeExpiry;case i.Trending:case i.PeakMoment:case i.HighEngagement:return o.a.Trending;case i.Meeting:return o.a.Meeting;case i.SingleTaskActivityByYou:case i.MultipleTaskActivityByYou:case i.SingleTaskActivityByOthers:case i.MultipleTaskActivityByOthers:case i.SingleTaskActivityYouAssignee:case i.MultipleTaskActivityYouAssignee:case i.SingleTaskActivityYouCreator:case i.MultipleTaskActivityYouCreator:return o.a.Task;default:return o.a.Default}},t.prototype.getMruDocuments=function(e){var n,i=this,r=this.getUrl(e),o=!(!e||!e.size);if(this.mruDataStreams.has(r))return this.mruDataStreams.get(r);o&&this.mostRecentUnfilteredDocs&&this.mostRecentUnfilnction(t){return e.has(a.a.fileTypeNameToFileType(t.FileType))})));var l=n&&n.length?Promise.resolve({items:n,impressionId:t.mruPlusPlusV2ImpressionId,fromCache:!0}):this.fetchMru(r,"cache-only",o),s=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchMru(o,r):this.fetchMru(r,"network-first",o),c=this.updatetreamKey(r),(function(){return i.fetchMru(r,"network-first",o)})),d=u.a.createResultsWithCacheObservable(l,s,c,(function(e){return i.mruDataStreams.delete(r)}),{items:[],impressionId:t.mruPlusPlusV2ImpressionId,fromCache:!1});if(this.mruDataStreams.set(r,d),this.mruConfigService.config.silentS2SFlow){var p=this.getS2SUrl(e);this.fetchMru(p,"network-only",o,!0)}return d},t.prototype.updateMruDocuments=function(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))},t.prototype.removeDocument=function(e){var t=this;return new Promise((function(n,i){t.delete("Mru_Delete","Mru_Delete",t.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url},(function(e){e.instrument((function(e,n){n.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.updatePinnedState=function(e){var t=this;return new Promise((function(n,i){t.post("Mru_Update_Pin","Mru_Update_Pin",t.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,is_pinned:e.IsPinned},(function(e){e.instrument((function(e,n){n.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.writeMruDocument=function(e){var t=this;return new Promise((function(n,i){var r={category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,extension:a.a.getFileExtensionFromUrl(e.Url),title:e.Title,onedrive_info:{drive_id:e.DriveId,item_id:e.DocId}};t.post("Mru_Write","Mru_Write",t.serviceBaseUrl,r,(function(e){e.instrument((function(e,n){n.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.handleQueryParam=function(e,t,n){"mockmru"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.isAuthError=function(t){return e.prototype.isAuthError.call(this,t,"MruPlusPlus")||-1===t},t.isPwaProject=function(e){return e.meta_data&&"PJO"===e.meta_data.type&&e.app.toLowerCase()===a.b[a.b.Project].toLowerCase()},t.fileType=function(e){var t=a.a.fileTypeFromExtension(e.extension);return t&&t!==a.b.None||(t="Project"===e.app&&e.meta_data&&"ProjectOperations"===e.meta_data.type?a.b.ProjectOperations:a.a.fileTypeNameToFileType(e.app)),t},t.prototype.getUrl=function(e){if(this.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow)return this.getS2SUrl(e);var t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return this.serviceBaseUrl+"/docs?"+t},t.prototype.getS2SUrl=function(e){var t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return this.contextService.sharedContext.officeHomeApiRoot+"/api/mru?"+t},t.prototype.getUpdateStreamKey=function(e){return"mruplusplusv2-"+e},t.prototype.fetchMru=function(e,n,i,r){var o=this;return void 0===r&&(r=!1),new Promise((function(l,c){var u,d,p,f;o.userContextService.user.mruAvailable?(o.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow||r?(u="None",d={},p="Mru_S2S_Request",f="Mru_S2S"):(u="MruPlusPlus",d=o.getNewRequestConfig(!1),p="Mru_Request",f="Mru"),o.get(p,f,e,(function(n){n.instrument((function(n,i){i.RequestId=o.getRequestIdFromResponse(n),i.Index=(o.fetchRequestIndex++).toString(),i.ImpressionId=t.mruPlusPlusV2ImpressionId;var r=n.headers;r&&(i.PartnerGeo=r.get("X-OfficeCluster")),n.data&&n.data.diagnostics_data&&void 0!==n.data.diagnostics_data.total_duration&&(i.MruDuration=n.data.diagnostics_data.total_duration.toString());var l=o.performanceService.getResourceTimingEntries(e);if(l&&l.length){var s=l[l.length-1];s.workerStart&&s.responseStart&&(i.ServiceWorkerProcessingLatency=Math.ceil(s.responseStart-s.workerStart).toFixed())}if(n.ok&&n.data){var c=void 0,u=(c=n.data.documents&&n.data.documents.items?n.data.documents.items:[]).length;o.mruConfigService.config.mruPi Date(t.time_stamp).getTime()-new Date(e.time_stamp).getTime()})),i.ActualSize=u.toString(),i.Distribution=a.a.distributionFromFileTypes(c.map((function(e){retuaDistribution=c.map((function(e){return o.checkMetaData(e)?1:0})).toString(),o.mruConfigService.config.recommendedEnabled&&(i.ResourceIdDistribution=c.slice(0,12).map((function(e){return e.resource_id})).toString())}})).then((function(e){var t=e.data,n=e.fromCache;if(r)l();else{var a=o.processMruData(t,i,n);l(a)}})).catch((function(e){o.globalErrorHandler.handleError(e,"hJU2J")}))}),c,d,n,null,null,null,u)):c(new s.b(null,"User does not have an MRU"))}))},t.prototype.prefetchMru=function(e,t){var n=this;return this.windowService.nativeWindow.prefetchMruDataPromise?new Promise((function(t){n.windowService.nativeWindow.prefetchMruDataPromise.then((function(i){var r=n.processMruData(i,e,!1);t(r)})).catch((function(e){n.globalErrorHandler.handleError(e,"hJU2J")}))})):this.fetchMru(t,"network-first",e)},t.prototype.checkMetaData=function(e){return e.onedrive_info&&!!e.onedrive_info.drive_id&&!!e.onedrive_info.item_id&&e.creation_info&&!!e.creation_info.timestamp&&e.sharepoint_info&&!!e.sharepoint_info.site_url},t.prototype.mruItemFromMruPlusPlusV2Item=function(e){var n=this.mruConfigService.config,i=new Date(e.time_stamp),r=n.swayTransformedFromWordAttributionEnabled;e.onedrive_info=e.onedrive_info||{},e.sharepoint_info=e.sharepoint_info||{},e.creation_info=e.creation_info||{},e.meta_data=e.meta_data||{};var o={DriveId:e.onedrive_info.drive_id,ItemId:e.onedrive_info.item_id,CreatedByUserEmail:e.creation_info.user_info&&e.creation_info.user_info.upn,CreatedByUserName:e.creation_info.user_info&&e.creation_info.user_info.display_name,CreatedDate:e.creation_info.timestamp,SPListId:e.sharepoint_info.list_id,SPListItemUniqueId:e.sharepoint_info.list_item_unique_id,SPSiteId:e.sharepoint_info.site_id,SPSiteUrl:e.sharepoint_info.site_url,SPWebId:e.sharepoint_info.web_id,SwayMetaData:{ThumbnailId:e.meta_data.SwayThumbnail,IsTransformedFromWord:r&&!!e.meta_data.SwayIsTransformedFromWord&&"true"===e.meta_data.SwayIsTransformedFromWord.toString().toLowerCase()},FormsMetaData:{category:e.meta_data.category,form_type:e.meta_data.form_type,owner_id:e.meta_data.owner_id,owner_name:e.meta_data.owner_name,owner_tenant_id:e.meta_data.owner_tenant_id,owner_type:e.meta_data.owner_type,primary_color:e.meta_data.primary_color,background_image:e.meta_data.background_image},PowerBIMetaData:{breadcrumb_url:e.meta_data.breadcrumb_url}},l=n.mruActivityEnabled,s=e.service_info?e.service_info.friendly_service_name:"";s&&(e.display_path=e.display_path||[],e.display_path.unshift(s));var c=!1,u=t.fileType(e);return u!==a.b.MeetingNotes&&u!==a.b.Whiteboard||(c=!0),{DocId:o.ItemId,DriveId:o.DriveId,Extension:e.extension,FileName:e.title,Title:e.title,Url:c?e.web_url:e.url,WebUrl:e.web_url,LastAccessedTime:i,FileType:a.b[u],Provenance:a.f[a.f.OfficeMru],PathArray:e.display_path,IsPinned:e.is_pinned,Application:e.app,ResourceId:e.resource_id,Category:e.category,MruV2Type:e.type,MruId:e.mru_id,UrlAlreadyEncoded:!0,MetaData:o,Activity:e.activity_info&&l?t.convertMruActivityToActivityDescription(e.activity_info):void 0,Sharing:e.sharing_info&&l?e.sharing_info.state:void 0,LifecycleInfo:e.lifecycle_info&&l?!!e.lifecycle_info.flags:void 0,ServiceId:e.service_info?e.service_info.service_id:"",ServerDocId:e.server_doc_id}},t.prototype.convertToMruData=function(e,n){var i=this;void 0===n&&(n=!1);var r=(e.documents&&e.documents.items?e.documents.items:[]).filter((function(e){return("Sway"===e.app||"Portfolio"===e.app||"Project"===e.app||"Forms"===e.app||"Bohemia"===e.app||"Fluid"===e.app||"PowerBI"===e.app||-1===e.url.lastIndexOf("?"))&&!t.isPwaProject(e)})).map((function(e){return i.mruItemFromMruPlusPlusV2Item(e)})),o=this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice();return r.forEach((function(e){a.b[e.FileType]===a.b.Forms&&(e.Url=i.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.Url),o&&(e.Url=e.Url.replace(l.b,l.a)))})),r=r.filter((function(e){var t,n,i;return a.b[e.FileType]!==a.b.Forms||"survey"!==(null===(i=null===(n=null===(t=e.MetaData)||void 0===t?void 0:t.FormsMetaData)||void 0===n?void 0:n.form_type)||void 0===i?void 0:i.toLoweturn t.LastAccessedTime.getTime()-e.LastAccessedTime.getTime()})),{items:r,impressionId:t.mruPlusPlusV2ImpressionId,fromCache:n}},t.prototype.processMruData=function(e,t,n){void 0===n&&(n=!1);var i=this.convertToMruData(e,n);return t||(this.mostRecentUnfilteredDocs=i),i},t.mruPlusPlusV2ImpressionId="MruPlusPlusV2Impression",t.activityRegex=new RegExp("{([0-9]+)}"),t}(d.a)},RitX:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var i=n("keVe"),r=n("TOqr"),o=n("mu6k"),a=n("W3Zz"),l=n("hZW2"),s=n("PBJH"),c=n("BMb5"),u=i.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"openAndClose",definitions:[{type:1,expr:"* => openMobile",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{transform:"translate3d(0, 100%, 0)"},offset:null},{type:4,styles:{type:6,styles:{transform:"translate3d(0, 0, 0)"},offset:null},timings:"{{ slideDuration }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:{params:{slideDuration:"300ms"}}},options:null},options:null},{type:1,expr:"* => open",animation:[{type:6,styles:{height:0},offset:null},{type:4,styles:{type:6,styles:{height:"*"},offset:null},timings:"300ms cubic-bezier(.1,.9,.2,1)"}],options:null},{type:1,expr:"open => closing",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDon d(e){return i.jc(0,[(e()(),i.qb(0,null,null,0))],null,null)}function p(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,2,null,d)),i.Gb(2,540672,null,0,r.o,[i.W],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),i.Zb(3,{item:0,index:1}),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,3,0,t.parent.context.$implicit,t.parent.context.index);e(t,2,0,i,n.menuItemTemplate)}),null)}function f(e){return i.jc(0,[(e()(),i.Hb(0,0,[[2,0],["menuItem",1]],null,4,"li",[["tabindex","-1"]],[[8,"id",0],[1,"aria-label",0],[1,"aria-describedby",0],[1,"role",0],[1,"data-clicklog",0],[1,"data-area",0],[1,"aria-posinset",0],[1,"aria-setsize",0],[1,"aria-selected",0],[1,"aria-checked",0]],[[null,"click"],[null,"mouseenter"],[null,"keydown"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onSelectItem(e.context.$implicit,e.context.index,n)&&i),"mouseenter"===t&&(i=!1!==r.setActiveIndex(e.context.index)&&i),"keydown"===t&&(i=!1!==r.handleKey(n)&&i),i}),null,null)),i.Gb(1,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"menu-item--mobile":0}),(e()(),i.qb(16777216,null,null,1,null,p)),i.Gb(4,16384,null,0,r.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=i.Ob(1,"menu-item ms-bgc-g40-h ms-bgc-w ms-bgc-g40-f ms-bgc-g40-a ",t.context.$implicit.cssClass,""),o=e(t,2,0,n.mobileMenu);e(t,1,0,r,o),e(t,4,0,n.menuItemTemplate)}),(function(e,t){var n=t.component;e(t,0,0,n.getIdForItem(t.context.$implicit),t.context.$implicit.ariaLabel,t.context.$implicit.ariaDescribedBy,n.ariaRole,n.menuModel.customLogging?"custom":"",n.menuModel.customLogging?"":n.menuModel.hostComponentArea,t.context.index+1,n.menuModel.items.length,n.menuModel.announceItemIsSelected&&t.context.$implicit.ariaSelected,n.menuModel.announceItemIsSelected&&t.context.$implicit.ariaChecked)}))}function h(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,5,"div",[],[[1,"aria-le.done"===t&&(i=!1!==e.component.onAnimationCompleted(n)&&i),i}),null,null)),i.Gb(1,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(2,{"menu--right":0,"menu--center":1,"menu--bottom":2,"context-menu--mobile":3}),(e()(),i.Hb(3,0,null,null,2,"ul",[["aria-haspopup","true"],["class","officeHome-callout-main menu__content ms-bgc-w"]],[[8,"id",0],[1,"role",0],[1,"aria-label",0]],null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,f)),i.Gb(5,278528,null,0,r.j,[i.W,i.S,i.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var n=t.component,r=i.Ob(1,"menu officeHome-callout ",n.menuModel.cssClass,""),o=e(t,2,0,n.menuModel.rightAligned&&!n.leftAlignedCard,n.menuModel.centerAligned,n.menuModel.bottomAligned,n.mobileMenu);e(t,1,0,r,o),e(t,5,0,n.menuModel.items,n.trackById)}),(function(e,t){var n=t.component;e(t,0,0,n.menuAriaLabel,n.animationState),e(t,3,0,i.Ob(1,"",n.menuModel.id,"-dropdown"),"menuitemcheckbox"===n.ariaRole||"radio"===n.ariaRole?"menu":"listbox",n.menuAriaLabel)}))}function m(e){return i.jc(0,[i.cc(671088640,1,{menuWrapper:0}),i.cc(671088640,2,{dropdownItems:1}),(e()(),i.qb(16777216,null,null,1,null,h)),i.Gb(3,16384,null,0,r.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,3,0,t.component.open)}),null)}i.Db("ohp-menu",o.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"ohp-menu",[],null,null,null,m,u)),i.Gb(1,4440064,null,1,o.a,[a.c,l.a,i.null),i.cc(603979776,1,{menuItems:1})],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",animateClose:"animateClose",mobileMenu:"mobileMenu",leftAlignedCard:"leftAlignedCard",multiSelect:"multiSelect",contextAriaLabel:"contextAriaLabel",ariaRole:"ariaRole",selectedIndex:"selectedIndex"},{selectItem:"selectItem",closeMenu:"closeMenu"},[])},RsrG:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("keVe"),r=function(){function e(){}return e.prototype.getSchedulePriority=function(e){switch(e){case"appbar#AppBarModule":case"app-gallery-angular#AppGalleryModule":case"app-gallery-react#AppGalleryReactModule":case"create-on-home#CreateOnHomeModule":case"edgeworth#EdgeworthModule":case"ew-react#EdgeworthReactModule":case"fluent-theme-provider#FluentThemeProviderModule":case"learning-shelf-react#LearningShelfReactModule":case"left-nav-react#LeftNavReactModule":case"mru#MruModule":case"new-consumer-experience#NewConsumerExperienceModule":case"new-user-shelf#NewUserShelfModule":case"quick-access#QuickAccessReactModule":case"recommended-react#RecommendedReactModule":case"workspace-nav#WorkspaceNavModule":return 0;case"auto-suggest#AutoSuggestModule":case"install#InstallModule":case"install-react#InstallReactModule":case"create-center#CreateCenterModule":case"create-center-react#CreateCenterReactModule":case"create-menu#CreateMenuModule":case"first-run#FirstRunModule":case"first-run-react#FirstRunReactModule":case"first-run-wrapper#FirstRunWrapperModule":case"places#PlacesModule":case"upload-button#UploadButtonModule":case"welcome-badge#WelcomeBadgeReactModule":return 1;case"upload-dialog#UploadDialogModule":case"banner#BannerModule":case"fluid-content#FluidContentModule":case"wac-content#WacContentModule":return 2;default:return 3}},e.ɵprov=i.kc({factoryRenderIcon",e.Url="Url",e.Svg="Svg",e.Brand="Brand"}(i||(i={}))},Ry9Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));on(){function e(e,t){this.mruConfigService=e,this.swayService=t}return e.prototype.getAnalytics=function(t,n){return"cache-only"===n&&!this.mruConfigService.config.analyticsCachingEnabled||t.fileType!==i.b.Sway?Promise.resolve(void 0):this.swayService.getAnalytics(t.url,n).then((function(t){return e.convertFromSwayAnalytics(t)}))},e.prototype.prefetchAnalytics=function(e,t){if(!t||this.mruConfigService.config.analyticsCachingEnabled){var n=e.filter((function(e){return e.fileType===i.b.Sway})).map((function(e){return e.url}));this.swayService.prefetchAnalytics(n,t?"cache-only":"network-first")}},e.convertFromSwayAnalytics=function(e){if(e)return{viewCount:e.viewCount,averageTimeSpentMs:e.averageTimeSpent,averageCompletionRatio:e.AverageScrollDistance,glancedReads:e.glancedReads,quickReads:e.quickReads,deepReads:e.deepReads}},e.ɵprov=a.kc({factory:function(){return new e(a.lc(r.a),a.lc(o.a))},token:e,providedIn:"root"}),e}()},"S8t+":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("ICP0"),r=n("NLr0"),o=n("f0calStorageService=e,this.edgeworthDeltaSyncService=t,this.init()}return e.prototype.getLastUiSyncTimestamp=function(){var t=this.localStorageService.get(e.UiSyncTimestampStorageKeyPrefgeService.set(e.UiSyncTimestampStorageKeyPrefix,t.toISOString())},e.prototype.init=function(){var e=this;this.uiTimestamp=Object(i.a)(Object(r.a)(this.getLastUiSyncTimestamp()),thisyncTimestampUpdnew Date})),Object(a.a)((function(t){e.setLastUiSyncTimestamp(t)}))))},e.UiSyncTimestampStorageKeyPrefix="_Edgeworth"+window.ewWorkload+"LastUiSyncTimestamp",e.ɵprov=c.kc({factory:function(){return new e(c.lc(l.a),c.lc(s.a))},token:e,providedIn:"root"}),e}()},SPVw:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("AlWG"),r=n("uzn7"),o=n("keVe"),a=function(){function e(e){this.localStorageService=e,this._callouts=new i.a([]),this.callouts=this._callouts.asObservable()}return e.prototype.addCallout=function(e){e.isValid()&&!this.calloutDismissed(e)&&(!e.completed&&this.calloutCompleted(e)&&(e.completed=!0),this._callouts.next(this._callouts.getValue().concat(e)))},e.prototype.addCallouts=function(e){var t=this,n=e.filter((function(e){return!(!e.isValid()||t.calloutDismissed(e)||(!e.completed&&t.calloutCompleted(e)&&(e.completed=!0),0))}));this._callouts.nen))},e.prototype.clearCallouts=function(){this._callouts.next([])},e.prototype.dismissCallout=function(e){e.persistCompletion&&this.localStorageService.set(this.getCompletedKey(e.calloutType),!0),e.persistDismissal&&this.localStorageService.set(this.getDismissKey(e.calloutType),!0)},e.prototype.calloutDismissed=function(e){if(!e.persistDismissal)return!1;var t=this.getDismissKey(e.calloutType);return!!this.localStorageService.get(t)},e.prototype.calloutCompleted=function(e){if(!e.persistCompletion)return!1;var t=this.getCompletedKey(e.calloutType);return!!this.localStorageService.get(t)},e.prototype.getDismissKey=function(t){retCompletedKey=function(t){return e.calloutCompletedKeyPrefix+"_"+t},e.calloutDismissedKeyPrefix="_FeatureCalloutDismissed",e.calloutCompletedKeyPrefix="_FeatureCalloutCompleted",e.ɵprov=o.kc({factory:functio[e.SecondRun=1]="SecondRun",e[e.Disabled=2]="Disabled"}(i||(i={}))},"T/SX":function(e,t,n){"use strict";n.d(t,"a",(fa",(function(){return i}));var i=function(){return function(){}}()},TDzr:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var i=n("QjXU"),r=n("Dn7E"),o=n("3Vsh"),a=n("5ZNw"),l=n("hhzZ"),s=n("R7NL"),c=n("p6Zr"),u=n("H90i"),d=n("JT1q"),p=n("7Rc8"),f=n("fKR7"),h=n("4/We"),m=n("/I02"),objectToArrayHelper=function(e){return Array.isArray(e)?e:e?[e]:[]},e}(),v=n("uUrA"),S=n("pjz5"),y=n("BaAg"),C=n("4ach") n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},e}(),I=n("oAX+"),_=n("ZBli"),A=n("kpuN"),P=n("W3Zz"),E=n("7Gwk"),O=n("zwsB"),F=n("o2Lt"),D=n("Z0U4"),M=n("wwmn"),R=n("casz"),x=n("BJbw"),L=n("BMb5"),U=n("pOWU"),N=n("keVe"),W=n("TOqr"),j=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S){var y=e.call(this,t,i,r,"Forms",o,l,u,d)||this;y.eventService=n,y.locService=a,y.formsConfigService=s,y.officeRouteService=c,y.startupConfigService=p,y.clientStartupConfigService=f,y.urlAuthenticatorService=h,y.deviceDetector=m,y.templatesService=b,y.mruDataService=g,y.windowService=v,y.capabilitiesService=S,y.getFormsGroupsDataStreamCache=null,y.getMyFormsDataStreamCache=null,y.getSharedFormsDataStreamCache=null,y.getMyFormsResponsesCache=null,y.getFormsThemeMappingSetCache=null,y.getFormDataPromisesCache={},y.getFormsGroupMembersStreamCache={},y.getFormsInGroupDataStreamCache={};var C=y.clientStartupConfigService.config;return y.startupConfigService.config.authType===w.a.MSA?(y.tenantId=y.formsConfigService.config.formsMsaTenantId,y.guid=y.convertConsumerPuidToGuid(C.puid)):(y.tenantId=C.tenantId,y.guid=C.objectId),y}return Object(i.__extends)(t,e),t.prototype.onInitFormsStartPage=function(){var e=this;this.capabilitiesService.capabilities.formsCapLoginEnabled?this.accessTokenService.getAccessToken("Forms",!1,null).then((function(t){if(!t.success&&t.error&&"CAP_Error"===t.error.message){var n=e.windowService.nativeWindow,i=e.contextService.sharedContext.formsResourceUrl+(e.clientStartupConfigService.config.isV2Auth?"/.default":"");e.instrumentationService.logGenericEvent("Forms_Cap_Login_Redirect",{}),Object(r.a)({featureName:"AccessToken",eventName:"Forms_Cap_Login_Redirect"}),n.location.href="/login?login_hint="+e.clientStartupConfigService.config.loginHint+"&resource="+i+"&ru="+encodeURIComponent(n.location.pathname)}else e.setFormsCompromisedUserAlert()})):(this.accessTokenService.getAccessToken("Forms",!1,null,!0,{category:"CreateFile",fileType:y.b.Forms}),this.seton(){return this.formsConfigService.config.termsOfServiceLinkOrgId},t.prototype.getForm=function(e,n,r,o){var a=this;return!o&&this.getFormDataPromisesCache[e]||(this.getFormDataPromisesCache[e]=new Promise((function(o,l){a.get("Get_Form","Get_Form",a.formsConfigService.config.formsApiPath+t.GET_FORM(a.tenantId,n,r,e),(function(e){e.instrument((function(e,t){t.RequestId=a.getRequestIdFromResponse(e)})).then((function(e){if(e&&e.data&&e.data.id){var t=a.getFormUrl(e.data.id);e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e.data.url=t,e.data.ownerPrincipalType=n,e.data.otherInfo&&(e.data.otherInfo=JSON.parse(e.data.otherInfo)),o(e.data)}}))}),l,a.getRequestConfig(),"network-first")}))),this.getFormDataPromisesCache[e]},t.prototype.unpinSharedForm=function(e){var n=this;return new Promise((function(i,r){n.delete("Forms_Shared_UnpinRequest","Forms_Shared_Unpin",n.formsConfigService.config.formsApiPath+t.SHARED_FORM(e),null,(function(e){e.instrumenestIdmResponse(e)})).then((function(e){i(e.data)}))}),(function(e){r(e)}),n.getRequestConfig())}))},t.prototype.postCopyForm=function(e,n,r,o,a,l,s){var c=this,u=s===C.a.Groups;return new Promise((function(d,p){var f={newOwnerId:a,newTenantId:c.tenantId,isNewnstrument((function(e,t){t.RequestId=c.getRequestIdFromResponse(e)})).then((function(e){var t=e.data.otherInfo,n=c.getFormUrl(e.data.id),r=Object(i.__assign)(Object(i.__assign)({},e.data),{otherInfo:JSON.parse(t),url:n});c.clearCache(s,a),m.unsubscribe(),d(r)}))},m=(u?c.getFormsInGroup(a):c.getMyForms()).results.subscribe((fui&&i.value){var a=i.value.filter((function(e){return!e.softDeleted})).map((function(e){return e.title}));f.patchProperties.title=function(e,t){if(-1!==t.indexOf(e)){var n=e+" ",i=1,r=e&&e.match(/([\s\S]+)\(([1-9]\d*)\)$/);for(r&&3===r.length&&(n=r[1],i=parseInt(r[2],10));-1!==t.indexOf(e);)e=n+"("+ ++i+")"}return e}(n,a)}c.post("Forms_Copy_Request","Forms_Copy",c.formsConfigService.config.formsApiPath+t.COPY_FORMS_PATH(r,l,o,e),f,h,(function(e){p(e)}),c.getRequestConfig())}}))}))},t.prototype.createForm=function(e,t,n){var i=this;return new Promise((function(r){r(i.getCreateFormsLink(e,(t||{type:"users"}).identifier,n))}))},t.prototype.createFormFromTemplate=function(e,n,i){var r=this,a=i||this.guid;return new Promise((function(i,l){r.templatesService.getTemplateContent(y.b.Forms,e.AssetId,e.TemplateBinaryUrl).results.pipe(Object(o.a)(1)).subscribe((function(o){r.post("Form_Create_Form_From_Template","Form_Create_Form_From_Template",r.formsConfigService.config.formsApiPath+t.CREATE_FORM_FROM_TEMPLATE(r.tenantId,n,a),o.data.Content.Value,(function(t){t.instrument((function(t,n){n.Req)).then((function(e){i(r.getCreateFormFromTemplateLink(e.data.id))}))}),(function(e){l(e)}),r.getRequestConfig(),null,null,null,null,void 0,null,null,null,!0,{category:"CreateFile",fileType:y.b.Forms})}))}))},t.prototype.postMoveForms=function(e,n,i,r,o){var a=this;return new Promise((function(l,s){a.post("Recycle_Form_Request","Recycle_Form",a.formsConfigService.config.formsApiPath+t.MOVE_FORM_PATH(a.tenantId,n,i,e),{isNe((function(e,t){return t.RequestId=a.getRequestIdFromResponse(e),e})).then((function(e){a.clearCache(n,i),a.clearCache(r,o),l(e.data)}))}),(function(e){s(e)}),a.getRequestConfig())}))},t.prototype.getFormAuthenticatedCdn=function(e){var t=this.clientStartupConfigService.config.sharedClientStartupContext,n="prodprv"===t.deploymentEnvironment&&"scu"===t.geoName,i=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.formsConfigService.config.formsCdnPath+(e?F.c:this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice()?F.a:F.b));return _.a.appendAndReplaceQueryParams(i,{origin:n?u.b:u.a,lang:this.contextService.sharedContext.officeMarket,sessionId:this.startupConfigService.config.sharedClientStartupContext.sessionId},!1,!0)},t.prototype.getFormGroupThumbnailUrl=function(e){return this.getImage(this.formsConfigService.config.formsApiPath+t.MY_FORMS_GROUP_THUMBNAIL_PATH(e),"Forms_Group_Thumbnail_Fetch","Forms_Group_Thumbnail_Fetch")},t.prototype.getFormsInGroup=function(e,n){var r=this;if(n&&(this.getFormsInGroupDataStreamCache[e]=null),this.getFormsInGroupDataStreamCache[e])return this.getFormsInGroupDataStreamCache[e];var o=function(n){return new Promise((function(o,a){r.get("Forms_From_Group_Request","Forms_From_Group",r.formsConfigService.config.formsApiPath+t.FORMS_FROM_GROUP(r.tenantId,e),(function(e){e.instrument((function(e,t){t.RequestId=r.getRequestIdFromResponse(e)})).then((function(e){e&&e.data&&e.data.value&&(e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e.data.value=g.objectToArrayHelper(e.data.value),e.data.value.forEach((function(e){e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.ownerPrincipalType=C.a.Groups,e.url=r.getFormUrl(e.id)})),o(e.data))}))}),(function(e){a(e)}),r.getRequestConfig(),n)}))},a=o("cache-only"),l=ble(a,l,null,(function(t){r.getFormsInGroupDataStreamCache[e]=null}));return this.getFormsInGroupDataStreamCache[e]=s,this.getFormsInGroupDataStreamCache[e]},t.prototype.getFormsGroupMembers=function(e){var n=this;if(this.getFormsGroupMembersStreamCache[e])return this.getFormsGroupMembersStreamCache[e];var i=function(i){return new Promise((function(r,o){n.get("Forms_Group_Members_Request","Forms_Group_Members",n.formsConfigService.config.formsApiPath+t.FORMS_GROUP_MEMBERS(e),(function(e){e.instrument((function(e,t){t.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){r(e.data)}))}),(function(e){o(e)}),n.getRequestConfig(),i)}))},r=i("cache-only"),o=null,(function(t){return n.getFormsGroupMembersStreamCache[e]=null}));return this.getFormsGroupMembersStreamCache[e]=a,a},t.prototype.getFormsGroups=function(){var e=this;if(this.getFormsGroupsDataStreamCache)return this.getFormsGroupsDataStreamCache;var n=function(n){return new Promise((function(i,r){e.get("Forms_Groups_Request","Forms_Groups",e.formsConfigService.config.formsApiPath+t.MY_FORMS_GROUPS,(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(t)})).then((function(t){e.mruDataService.getMruDocuments(new Set([y.b.Forms])).results.subscribe((function(e){var n=new Map;e.items.forEach((function(e,t){"GroupForm"===e.Extension&&void 0===n[e.MetaData.FormsMetaData.owner_id]&&(n[e.MetaData.FormsMetaData.owner_id]=t)})),t.data.value.sort((function(e,t){return n[e.id]>=0&&n[t.id]>=0?n[e.id]-n[t.id]:n[e.id]>=0?-1:1})),i(t.data)})),e.mruDataService.getMruDocuments(new Set([y.b.Forms])).initialCompletion.then((function(e){e&&e.cacheError&&e.networkError&&i(t.data)}))}))}),(function(e){r(e)}),e.getRequestConfig(),n)}))},i=n("cache-only"),r=n("network-first"),o=I.a.createResultsWithCacheObservable(i,r,null,(function(t){return e.getFormsGroupsDataStreamCache=null}));return this.getFormsGroupsDataStreamCache=o,o},t.prototype.setFormsRecycleState=function(e,n,i,r){var o=this,a=r?"Recycle_Form_Request":"Restore_Form_Request",l=r?"Recycle_Form":"Restore_Form";return new Promise((function(s,c){o.patch(a,l,o.formsConfigService.config.formsApiPath+t.FORM_EDIT_OR_DELETE_PATH(o.tenantId,i,n,e),{softDeleted:r?1:0},(function(e){e.instrument((function(e,t){t.RequestId=o.getRequestIdFromResponse(e)})).then((function(){o.clearCache(i,n),s()}))}),(function(e){c(e)}),o.getRequestConfig())}))},t.prototype.hardDeleteForm=function(e,n,i){var r=this;return new Promise((function(o,a){r.delete("Forms_Delete_Request","Forms_Delete",r.formsConfigService.config.formsApiPath+t.FORM_EDIT_OR_DELETE_PATH(r.tenantId,i,n,e),{},(function(e){e.instrumenRequestIdFromResponse(e)})).then((function(){r.clearCache(i,n),o()}))}),(function(e){a(e)}))}))},t.prototype.getCreateFormsLink=function(e,t,n){var i="Create",r="CreateQuiz",o=function(e,t,n){return"Action="+t+"&Title="+e+(n?"&GroupId="+n:"")},a=this.getFormAuthenticatedCdn(!1),l={Action:null,Fragment:null};if(e===y.b.Forms)l.Fragment=o(this.locService.NewFormsSurveyFileName,i,t),l.Action=i;else{if(e!==y.b.FormsQuiz)return null;a=a.replace(F.a,F.b),l.Fragment=o(this.locService.NewFormsQuizFileName,r,t),l.Action=r}return a=_.a.appendAndReplaceQueryParams(a,l,!0),this.appendQueryInformation(a,!0,n)},t.prototype.getFormUrl=function(e){return this.getFormAuthenticatedCdn(!1)+"#FormId="+e},t.prototype.getAllMyFormsLink=function(){var e=this,t={title:this.locService.AllMyFormsRedirectLabel,tooltip:this.locService.AllMyFormsRedirectTooltip,ariaLabel:this.locService.AllMyFormsRedirectTooltip,referral:c.a.Forms,zeroTitle:this.locService.AllMyFormsRedirectLabel};return this.formsConfigService.config.neoPortalPageEnabled?Object(i.__assign)(Object(i.__assign)({},t),{url:this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.getFormAuthentic){e.officeRouteService.navigateTo({app:y.b.Forms,route:"MyForms"})}})},t.prototype.getCreateFormFromTemplateLink=function(e){var t=this.getFormAuthenticatedCdn(!1);return t=_.a.appendAndReplaceQueryParams(t,{Action:"CreateByTemplate",Fragment:"FormId="+e},!0),this.appendQueryInformation(t,!0)},t.prototype.getFormGroupMemberThumbnailUrl=function(e,n){return this.getImage(this.formsConfigService.config.formsApiPath+t.FORMS_MEMBER_THUMBNAIL_PATH(e,n),"Forms_Members_Thumbnail_Fetch","Forms_Members_Thumbnail_Fetch")},t.prototype.getMyFormsResponses=function(){var e=this;return this.getMyFormsResponsesCache||(this.getMyFormsResponsesCache=new Promise((function(n,i){e.get("Forms_Responses","Forms_Responses",e.formsConfigService.config.formsApiPath+t.FORMS_RESPONSE_COUNT_PATH,(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){e&&e.data?n(g.objectToArrayHelper(e.data.value)):i()}))}),i,e.getRequestConfig(),"network-first")}))),this.getMyFormsResponsesCache},t.prototype.getSharedForms=function(){var e=this;if(this.getSharedFormsDataStreamCache)return this.getSharedFormsDataStreamCache;var n=function(n){return new Promise((function(i,r){e.get("Shared_Forms_Request","Shared_Forms",e.formsConfigService.config.formsApiPath+t.SHARED_FORMS_PATH,(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(modifiedDate===t.modifiedDate?0:e.modifiedDate<t.modifiedDate?1:-1})),t.data.value.forEach((function(t){t.id&&(t.url=e.getFormUrl(t.id),t.ownerPrincipalType=C.b.getOwnerPrincipalTypeToFormType(t.ownerType||t.ownerPrincipalType||t.OwnerPrincipalType))})),i(t.data)):r()}))}),(function(e){r(e)}),e.getRequestConfig(),n)}))},i=n("cache-only"),r=n("network-first"),o=I.a.createResultsWithCacheObservable(i,r,null,(function(t){return e.getSharedFormsDataStreamCache=null}));return this.getSharedFormsDataStreamCache=o,o},t.prototype.setFormsCompromisedUserAlert=function(){var e=this;this.getReputationTierCache||(this.getReputationTierCan(t){t===C.c.Bad&&e.pushFormsAnnouncements("FormsCompromisedUser")}))},t.prototype.pushFormsAnnouncements=function(e,t){var n="announcement-background-color-wrapper--alert",i="announcement-section__title--black announcement-close__button--black";switch(e){case"FormsCompromisedUser":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new a.a(e,this.locService.FormsCompromisedUserAlertMessage,null,"","",!1,"announcement-background-color-wrapper--error",i,null,null,{text:this.locService.TermsOfUseLink,url:this.getFormsTermsOfServiceUrl(),shouldFocusOnInit:!1})]});break;case"FormsMoveToRecycleBin":var r=this.locService.FormsMoveToRecycleBinMessageNew;r&&this.eventService.broadcastEvent({name:"newAnnouncement",args:[new a.a(e,r,null,"","",!1,n,i,null,null,null,5)]});break;case"FormsRestored":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new a.a(e,this.locService.format(this.locService.FormsRestoredMessage,'"'+t+'"'),null,"","",!1,n,i)]});break;case"FormsPermanentlyDeleted":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new a.a(e,this.locService.format(this.locService.FormsPermanentlyDeletedMessage,'"'+t+'"'),null,"","",!1,n,i)]})}},t.prototype.setFormsCopySuccessAnnouncement=function(e,t,n,i,r){var o,l,s;switch(t){case C.a.Users:l=this.locService.FormsCopyToMyFormsMessage,s=this.locService.AllMyFormsRedirectLabel,o=this.officeRouteService.getUrlForRoute({app:y.b.Forms,route:"MyForms"});break;case C.a.Groups:l=this.locService.FormsCopyToGroupMessage,s=r,o=this.officeRouteService.getUrlForRoute({app:y.b.Forms,route:"GroupForms"},{groupId:i})}this.eventService.broadcastEvent({name:"newAnnouncement",args:[new a.a("FormsCopied",this.locService.format(l,'"'+e+'"'),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black",null,null,n?{url:o,text:s,shouldFocusOnInit:!0}:null)]})},t.prototype.setFormsMoveToGroupSuccessAnnouncement=function(e,t,n){var i=this.officeRouteService.getUrlForRoute({app:y.b.Forms,route:"GroupForms"},{groupId:t});this.eventService.broadcastEvent({name:"newAnnouncement",args:[new a.a("FormsMoveToGroup",this.locService.format(this.locService.FormsMoveToGroupMessage,'"'+e+'"'),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black",null,null,{url:i,text:n,shouldFocusOnInit:!0})]})},t.prototype.getMyForms=function(e){var n=this;if(e&&(this.getMyFormsDataStreamCache=null),this.getMyFormsDataStreamCache)return this.getMyFormsDataStreamCache;var r=function(e){return new Promise((function(r,o){n.get("My_Forms_Request","My_Forms",n.formsConfigService.config.formsApiPath+t.MY_FORMS_PATH,(function(e){e.instrument((function(e,t){t.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e&&e.data&&e.data.value&&(e.data.value=g.objectToArrayHelper(e.data.value),e.data.value.forEach((function(e){e.ownerPrincipalType=C.a.Users,e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.url=n.getFormUrl(e.id)})),e.data.value=e.data.value.sort((function(e,t){return new Date(t.modifiedDate).getTime()-new Date(e.modifiedDate).getTime()}))),r(e.data)}))}),(function(e){o(e)}),n.getRequestConfig(),e)}))},o=r("cache-only"),a=r("network-first"),l=I.a.createResultsWithCacheObservable(o,a,null,(function(e){n.getMyFormsDataStreamCache=null}));return this.getMyFormsDataStreamCache=l,this.getMyFormsDataStreamCache},t.prototype.fetchFormThumbnail=function(e){var n=this,i=function(){return n.inMockMode?""+location.origin+t.FORMS_THUMBNAIL_MOCK_PATH:""+n.formsConfigService.config.formsApiPath},r=function(t){return{defaultImage:t+"/Images/Theme/"+n.getFormsDefaultImageName(e.fileName)faultThumbnailColor}},o=function(t){e.thumbnails.backgroundColor=t},a=function(t){e.thumbnails.small=t,e.thumbnails.medium=t,e.thumbnails.large=t,e.thumbnails.recommendedThumbnail=t},l=function(){return new Promise((function(l){var s,c,u=i(),d=r(u),p=e.metaData&&e.metaData.background_image?n.inMockMode?""+u+S.a.getLocation(e.metaData.background_image).path:e.metaData.background_image:d.defaultImage,h=e.metaData&&e.metaData.primary_color?e.metaData.primary_color:d.defaultColor;if(e.format===f.a.Recent)return o(h),a(p),void l();e.thumbnailInfo&&e.thumbnailInfo.thumbnailFillColor&&(h=e.thumbnailInfo.thumbnailFillColor),"Customized Theme"===(null===(s=e.thumbnailInfo)||void 0===s?void 0:s.thumbnailId)&&(null===(c=e.thumbnailInfo)||void 0===c?void 0:c.thumbnailUrl)?(p=e.thumbnailInfo.thumbnailUrl,o(h),a(p),l()):e.thumbnailInfo&&e.thumbnailInfo.thumbnailId?n.getFormsThemingData().then((function(i){var r=i[e.thumbnailInfo.thumbnailId];r&&(r.SecondaryColor&&(h=r.SecondaryColor),r.BackgroundImage&&(p=n.inMockMode?""+location.origin+t.FORMS_THUMBNAIL_MOCK_PATH+r.BackgroundImage:""+n.formsConfigServBackgroundImage)),o(h),a(p),l()})).catch((function(){o(h),a(p),l()})):(o(h),a(p),l())}))};return e.format===f.a.SharedForm?new Promise((function(t){n.getForm(e.serverDocId,e.ownerType,e.ownerId).then((function(i){var r=Object(d.b)(i,null,null,null,n.clientStartupConfigService.config.authType,i.fromCache);e.thumbnailInfo=r.thumbnailInfo,l().then(t).catch(t)})).catch((function(){var e=r(i());o(e.defaultColor),a(e.defaultImage),t()}))})):l()},t.prototype.handleQueryParam=function(e,t){"mockformsservicemode"===e&&this.mockRequestHeader&&this.getRequestConfig().headers.set(this.mockRequestHeader,t.toString())},t.prototype.getRequestIdFromResponse=function(e){return this.getHeaderValue(e.headers,"x-correlationid")},t.prototype.getImage=function(e,t,n){var i=this;return new Promise((function(r,o){i.get(t,n,e,(function(e){e.instrument((function(e,t){t.RequestId=i.getRequestIdFromResponse(e)})).then((function(e){if(e&&e.data){var t=new FileReader;t.addEventListener("load",(function(){var e=t.result.toString();e=e.replace("data:image/pjpeg","data:image/jpeg"),r(e)}),!1),t.readAsDataURL(e.data)}}))}),(function(e){o(e)}),{responseType:"blob"},"network-only")}))},t.prototype.appendQueryInformation=function(e,t,n){var i=this.officeRouteService.getCurrentRoute();return _.a.appendAndReplaceQueryParams(e,{route:n||(i&&i.route?i.route:void 0)},t)},t.prototype.getRequestConfig=function(){return{headers:new Map([["Accept","application/json"],["x-ms-form-request-source","ms-startpage"],["x-usersessionid",this.startupConfigService.config.sharedClientStartupContext.sessionId],["x-correlationid",v.a.createGuid()],["x-anchormailbox",this.guid+"@"+this.tenantId]])}},t.prototype.clearCache=function(e,t){switch(e){case C.a.Groups:if(!t)break;this.getFormsInGroupDataStreamCache[t]=null;break;case C.a.Users:this.getMyFormsDataStreamCache=null}},t.prototype.convertConsumerPuidToGuid=function(e){return"00000000-0000-0000-".concat(e.slice(0,4),"-",e.slice(4))},t.prototype.getFormsDefaultImageName=function(e){e=e||"Untitled form";var t=this.formsConfigService.config.defaultImagesAvailable;return"default-"+(Math.abs(k.toHash(e))%t+1)+".png"},t.prototype.getFormsThemingData=function(){var e=this;return this.getFormsThemeMappingSetCache||(this.getFormsThemeMappingSetCache=new Promise((function(n,i){e.get("Forms_Theme_Request","Forms_Theme",e.formsConfigService.config.formsApiPath+""+(e.inMockMode?t.FORMS_THEMES_MOCK:t.FORMS_THEMES),(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){n(e.data)}))}),(function(t){e.getFormsThemeMappingSetCache=null,i(t)}),e.getRequestConfig(),"network-first",null,null,null,"None")}))),this.getFormsThemeMappingSetCache},t.prototype.getUserReputationTier=function(){var e=this;return new Promise((function(n,i){e.get("Get_User_Reputation_Tier","Get_User_Reputation_Tier",e.formsConfigService.config.formsApiPath+t.USER_REPUTATION_TIER_PATH,(function(t){t.instrumenuestIdFromResponse(t)})).then((function(e){e&&e.data?n(e.data):i()}))}),(function(e){i(e)}),e.getRequestConfig(),"network-only")}))},t.SHARED_FORMS_PATH=(t.BASE_URL="/formapi/api")+"/me/sharedWithMeForms",t.MY_FORMS_PATH=t.BASE_URL+"/me/light/forms?$select=id,title,modifiedDate,settings,ownerId,ownerTenantId,category,background,otherInfo,softDeleted,status,type&$filter=type+ne+%27survey%27",t.FORMS_RESPONSE_COUNT_PATH=t.BASE_URL+"/light/GetRespCounts()",t.FORMS_THUMBNAIL_MOCK_PATH="/content/mockData/shared/services/mockData/form/thumbnails",t.FORMS_THEMES_MOCK="/Themes",t.FORMS_THEMES="/Themes.json",t.MY_FORMS_GROUPS=t.BASE_URL+"/groups",t.USER_REPUTATION_TIER_PATH=t.BASE_URL+"/userReputationTier",t.GET_FORM=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')?$select=id,rowCount,background,otherInfo,settings,type,category"},t.COPY_FORMS_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')/CopyToUser"},t.MOVE_FORM_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')/MoveForm"},t.FORMS_MEMBER_THUMBNAIL_PATH=function(e,n){return t.BASE_URL+"/groups('"+e+"')/members('"+n+"')/photo/$value"},t.FORMS_GROUP_MEMBERS=function(e){return t.BASE_URL+"/groups('"+e+"')/members"},t.FORM_EDIT_OR_DELETE_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/forms('"+r+"')"},t.FORMS_FROM_GROUP=function(e,n){return t.BASE_URL+"/"+e+"/groups/"+n+"/light/forms?$select=id,title,modifiedDate,ownerId,ownerTenantId,softDeleted,category,rowCount,background,otherInfo,type&$filter=type+ne+%27survey%27"},t.MY_FORMS_GROUP_THUMBNAIL_PATH=function(=function(e){return t.BASE_URL+"/light/sharedWithMeForms('"+e+"')"},t.CREATE_FORM_FROM_TEMPLATE=function(e,n,i){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms"},t.ɵprov=N.kc({factory:function(){return new t(N.lc(A.b),N.lc(E.a),N.lc(l.a),N.lc(s.a),N.lc(m.a),N.lc(T.a),N.lc(M.a),N.lc(O.a),N.lc(D.a),N.lc(W.q),N.lc(R.a),N.lc(w.b),N.lc(w.b),N.lc(x.a),N.lc(P.c),N.lc(b.a),N.lc(p.a),N.lc(L.b),N.lc(h.a))},token:t,providedIn:"root"}),t}(U.a)},TIi1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},TJwc:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)return e;for(var i=e,r=function(e){var n=new RegExp("\\{"+e+"\\}","gi");i=i.replace(n,(function(){return t[e]}))},o=0;o<t.length;o++)r(o);return i},e.getDuplicateItemName=function(e){var t=e.match(/(.*)\(([0-9]+)\)$/i),n=function(e,t){return e.trim()+" ("+t+")"};return t?n(t[1],parseInt(t[2])+1):n(e,2)},e}()},TfV2:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Security=0]="Security",e[e.Basic=1]="Basic",e[e.Enhanced=2]="Enhanced",e[e.Full=3]="Full"}(i||(i={}))},U8M1:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("lrJm"),r=n("4/We"),o=n("cgnd"),a=n("fVt+"),l=n("1LNb"),s=n("Z0U4"),c=n("keVe"),u=function(){function e(e,t,n,i,r,a){var l=this;this.capabilitiesService=e,this.clientStartupConfigService=t,this.feedbackService=n,this.officeRouteService=i,this.userConsentConfigService=r,this.globalErrorHandler=a,this.userConsentConfigPromise=null,this.capabilitiesService.capabilities.showFloodgate&&(this.capabilitiesService.capabilities.userConsentCallEnabled&&this.clientStartupConfigService.config.authType===o.a.MSA&&!this.userConsentConfigPromise&&(this.userConsentConfigPromise=this.userConsentConfigService.getConfig()),this.floodgateInitPromise=this.feedbackService.feedbackServiceInitializePromise.then((function(){return new Promise((function(e,t){var n=function(t){var n=l.feedbackService.getOCVTelemetryData(t.toString());OfficeBrowserFeedback.initOptions.applicationGroup=n.applicationGroup,OfficeBrowserFeedback.initOptions.telemetryGroup=n.telemetryGroup,OfficeBrowserFeedback.initOptions.webGroup=n.webGroup,OfficeBrowserFeedback.initOptions.appId=l.feedbackService.getOcvAppId(),OfficeBrowserFeedback.floodgate.initOptions&&(l.capabilitiesService.capabilities.adminPolicyEnabled&&(OfficeBrowserFeedback.floodgate.initOptions.surveyEnabled=!!l.feedbackService.OCVAdminPolicy&&l.feedbackService.OCVAdminPolicy.SendSurvey.State,OfficeBrowserFeedback.floodgate.initOptions.showEmailAddress=!!l.feedbackService.OCVAdminPolicy&&l.feedbackService.OCVAdminPolicy.EmailCollection.State),OfficeBrowserFeedback.floodgate.initOptions.onSurveyActivatedCallback={onSurveyActivated:function(e){return l.activateSurvey(e)}}),OfficeBrowserFeedback.floodgate.initialize().then(e)};l.userConsentConfigPromise?l.userConsentConfigPromise.then((function(e){0!==e.us||t()})).catch((function(e){t(),l.globalErrorHandler.handleError(e)})):l.feedbackService.addOCVScriptToPage(n)||t()}))})))}return e.prototype.recordFloodgate=function(e){this.capabilitiesService.capabilities.showFloodgate&&this.floodgateInitPromise.then((function(){OfficeBrowserFeedback.floodgate.start().then((function(){var t=OfficeBrowserFeedback.floodgate.getEngine().getActivityListener();e.forEach((function(e){return t.logActivity(e)})),OfficeBrowserFeedback.floodgate.stop()}))}))},e.prototype.activateSurvey=function(e){var t=this.officeRouteService.getRouteItemForCurrentLocation().route;!t||"OfficeHome"!==t&&"Search"!==t&&"AppGallery"!==t||e.launch()},e.ɵprov=c.kc({factory:function(){return new e(c.lc(r.a),c.lc(o.b),c.lc(l.a),c.lc(s.a),c.lc(a.a),c.lc(i.b))},token:e,providedIn:"root"}),e}()},Uqr9:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return C}));var i=n("QjXU"),r=n("VV8N"),o=n("pM41"),a=n("CMIS"),l=n("zvoD"),s=n("3Vsh"),c=n("hhzZ"),u=n("BaAg"),d=n("cgnd"),p=n("MFXD"),f=n("AXqk"),h=n("7Gwk"),m=n("Z0U4"),b=n("re3B"),g=n("BMb5"),v=n("keVe"),S=n("qfyf"),y=function(){function e(){}return e.now=function(){var e=window.performance;return e&&e.now?e.now():(void 0===this.nowOffset&&(this.nowOffset=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-this.nowOffset)},e}(),C=function(){function e(t,n,i,r,o,a,c,u){var d=this;if(this.queuedMarks=t,this.dataSecurityService=n,this.instrumentationService=o,this.windowService=a,this.clientStartupConfigService=c,this.dumpedMeasures=new Set,this.dumpedBrowserMarkers=!1,this.recordedMarkers=new Map,this.recordedMeasures=new Map,this.paramsForAppMeasures=new Map,this.globalStateParamsForBrowserMeasures=null,this._marks=new p.a,this.loggingEnabled=e.performanceLoggingSupported(this.windowService.nativeWindow),this.loggingEnabled){i.events.withScope(0).pipe(Object(l.a)((function(e){mise().then((functioe3)})),r.addUnloadEvent((function(){d.mark("App_Unloaded",1),d.log()}));var f=function(e){d.currentRoute=e,d.mark("App_Navigation_Start",d.lastRecordedRouteNavigationStartMarker?0:d.windowService.nativeWi(function(e){e.currentRoute&&e.currentRoute.route&&f(e.currentRoute)})),u.subscribeToRouteChangeEnd((function(e){e.currentRoute&&e.currentRoute.route&&!d.currentRoute&&f(e.currentRoute),null===d.globalStateParamsForBrowserMeasures&&(d.globalStateParamsForBrowserMeasures={},d.instrumentationService.applyGlobalStateParams(d.globalStateParamsForBrowserMeasures,!0)),d.trackRouteChange()})),this.drainQueuedMarks()}}return e.performanceLoggingSupported=function(e){var t=e.performance;return!!(t&&t.now&&t.mark&&t.timing&&t.timing.navigationStart&&t.measure&&t.getEntriesByType)},e.getBrowserTimingMeasures=function(t,n,r,o){var a=new Array;if(!e.performanceLoggingSupported(t))return a;for(var l in t.performance.timing){var s=e.globalAllowedMarkers.get(l);if(s){var c=t.performance.timing[l],u=t.performance.timing[s];if("number"==typeof c&&"number"==typeof u)if(0!==c&&0!==u)if(c<u)n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to relative marker value being greater than marker value: <"+l+">="+c+"; diff from <"+s+">="+(c-u));else if(c<t.performance.timing.navigationStart)n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to marker value being less than <navigationStart> marker value: <"+l+">="+c+"; diff from <navigationStart}>="+(c-t.performance.timing.navigationStart));else if(u<t.performance.timing.navigationStart)n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to relative marker value being less than <navigationStart> marker value: <"+l+">="+c+"; <"+s+">="+u+"; diff from <navigationStart}>="+(u-t.performance.timing.navigationStart));else{var d=Math.ceil(c-u);a.push({name:l,duration:d,params:r?Object(i.__assign)({},r):{}});var p=l+"_ohp_measure";o&&o(l,p);try{t.performance.measure(p,s,l)}catch(e){n(l,"Failed to record measure for <"+l+"> starting from <"+s+">: exception is thrown")}}else"unloadEventStart"!==l&&"unloadEventEnd"!==l&&n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to unexpected zero values: <"+l+">="+c+"; <"+s+">="+u);else n(l,"Failed to calculate measure for <"+l+"> starting from <"+s+"> due to unexpected value type: <"+l+"> value type is "+typeof c+"; <"+s+"> value type is "+typeof u)}}return a},e.prototype.mark=function(e,t,n,i){var o;if(void 0===t&&(t=2),void 0===n&&(n=0),this.loggingEnabled&&!(n>this.dataSecurityService.securityLevel)){var a=e;if(this.currentRoute&&this.currentRoute.route){var l=""+this.currentRoute.route+(this.currentRoute.app?u.b[this.currentRoute.app]:"");Object(r.f)(l),a=e+"_"+l}var s=a;if(this.recordedMarkers.has(s)){var c=this.recordedMarkers.get(s)+1;this.recordedMarkers.set(s,c),s=a+"."+c}else this.recordedMarkers.set(s,1);this.windowService.nativeWindow.performance.mark(s);var d=this.lastRecordedRouteNavigationStartMarker||"navigationStart";"App_Navigation_Start"===e&&(Object(r.g)(s),this.lastRecordedRouteNavigationStartMarker=s);var p="navigationStart";return 2===t?p=d:0===t?p="":"string"==typeof t&&(p=null!==(o=this.getRecordedMarkerNameBySubstring(t))&&void 0!==o?o:t),this.addMeasure(a,s,p,e,i),this.drainQueuedMarks(),s}},e.prototype.getRecordedMarkerNameBySubstrihis.recordedMarkers.keys()).find((function(t){return t.indexOf(e)>=0})):null},e.prototype.getResourceTimingEntries=function(e){try{return this.windowType("resource").filter((function(t){return t.name.lastIndexOf(e)>=0}))}catch(e){return[]}},Object.defineProperty(e.prototype,"marks",{get:function(){return this._marks.asScopableObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationStart",{get:function(){return this.getPerformanceTimingMember("navigationStart")},enumerable:!0,{get:function(){return this.getPerformanceTimingMember("fetchStart")},enumerable:!0,configurable:!0}),e.prototype.trackRouteChange=function(){switch(e.numberOfRouteChanges){case 0:this.mark("firstRouteChange"),e.numberOfRouteChanges++;break;case 1:this.mark("secondRouteChange","firstRouteChange"),e.numberOfRouteChanges++}},e.prototype.getPerformanceTimingMember=function(e){var t=this.windowService.nativeWindow.performance;return t&&t.timing&&t.timing[e]?t.timing[e]:0},e.prototype.drainQueuedMarks=function(){var e=this;this.queuedMarks&&this.queuedMarks.splice(0,this.queuedMarks.length).forEach((function(t){return e.addMeasure(t.markName,t.markName,t.measureFrom||"navigationStart",t.markName,t.eventParams)}))},e.prototype.addMeasure=function(e,t,n,i,r){var o=this.windowService.nativeWindow,a=o.performance.getEntriesByType("mark").find((function(e){return e.name===t}));if(a&&this._marks.next(a),n&&!this.recordedMeasures.has(e)){this.recordedMeasures.set(e,i||e);try{o.performance.measure(e,n,t)}catch(i){return void this.logError(e,"Failed to record <"+e+"> for <"+t+"> starting from <"+n+">: exception is thrown")}this.dumpedBrowserMarkers?(r&&this.paramsForAppMeasures.set(e,r),this.log(e)):(this.instrumentationService.applyGlobalStateParams(r=r||{},!1),this.paramsForAppMeasures.set(e,r))}},e.prototype.log=function(e){var t=this;this.getPerformanceDump(e).forEach((function(e){t.instrumentationService.logPerformanceEvent(e.name,e.duration,e.params),Object(o.a)({eventName:e.name,latency:e.duration,instrumentationParams:e.params})}))},e.prototype.getPerformanceDump=function(e){var t=this,n=new Map;if(!e&&this.dumpedBrowserMarkers)return n;var i,r=this.windowService.nativeWindow;if(e){var o=r.performance.getEntriesByName(e,"measure");if(!o)return n;i=o}else i=r.performance.getEntriesByType("measure").filter((function(e){return!t.dumpedMeasures.has(e.name)&&t.recordedMeasures.has(e.name)}));return i.forEach((function(e){var i=Math.ceil(e.duration),r={};t.paramsForAppMeasures.has(e.name)&&(r=t.paramsForAppMeasures.get(e.name));var o=t.recordedMeasures.get(e.name);n.set(e.name,{name:o,duration:i,params:r}),t.dumpedMeasures.add(e.name)})),e||this.dumpBrowserMarkers(n),n},e.prototype.dumpBrowserMarkers=function(t){var n,r,o=this;if(!this.dumpedBrowserMarkers){var a=this.windowService.nativeWindow;if(this.clientStartupConfigService.config.resourceLoggingEnabled&&this.clientStartupConfigService.config.cdnDomain){var l=new RegExp("https://"+this.clientStartupConfigService.config.cdnDomain+".*","i"),s=a.performance.getEntriesByType("resource").filter((function(e){return l.test(e.name)&&("script"===e.initiatorType||"link"===e.initiatorType)})).filter((function(e){return e.hasOwnProperty("transferSize")?e.transferSize>0:e.responseEnd-e.responseStart>20})),c=void 0,u=0;try{for(var d=Object(i.__values)(s),p=d.next();!p.done;p=d.next()){var f=p.value,h=f.responseEnd;"number"==typeof h&&h>0&&h>u&&(u=h,c=f)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}if(c){var m=c.name.split("/").pop(),b="Last_CDN_Script_Downloaded",g=c.responseEnd,v=null===this.globalStateParamsForBrowserMeasures?{}:Object(i.__assign)({},this.globalStateParamsForBrowserMeasures);v.Filename=m,t.set(b,{name:b,duration:g.add(b)}}e.getBrowserTimingMeasures(a,(funcs,(function,o.recordedMeasures.set(t,e)})).forEach((function(e){t.set(e.name,e)})),this.dumpedBrowserMarkers=!0}},e.prototype.logError=function(e,t){var n,i=((n={}).Error=e,n.DebugInfo=t,n);this.instrumentationService.logGenericEvent("Performance_Mark_Failure",i),Object(a.a)({eventName:"Performance_Mark_Failure",errorType:"Other",message:e,debugInfo:t})},e.numberOfRouteChanges=0,e.globalAllowedMarkers=new Map([["fetchStart","navigationStart"],["unloadEventStart","navigationStart"],["unloadEventEnd","unloadEventStart"],["domainLookupEnd","domainLookupStart"],["connectEnd","connectStart"],["requestStart","navigationStart"],["responseStart","requestStart"],["responseEnd","responseStart"],["domLoading","responseStart"],["domInteractive","domLoading"],["domComplete","domLoading"]]),e.ɵprov=v.kc({factory:function(){return new e(v.lc(S.a,8),v.lc(f.a),v.lc(h.a),v.lc(b.a),v.lc(c.a),v.lc(g.b),v.lc(d.b),v.lc(m.a))},token:e,providedIn:"root"}),e}()},V9hE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("8/lW"),r=n("a3FV"),o=n("4CZh");function a(e,t,n,a){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===a&&(a=i.a.Security),Object(o.b)(e,r.a.GenericDebugCache,a,t,n,!0)}},VKX6:function(e,t,n){"use strict";var i;function r(){var e=window.performance;return e&&e.now?e.now():(void 0===i&&(i=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-i)}n.d(t,"a",(function(){return r}))},VV8N:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return d}));var i=void 0,r=void 0,o=new Map,a=new Map,l(){return i}function c(e){i=e}function u(){return r}function d(e){r=e}},VY7U:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));v){}return e.forRoot=function(){return{ngModule:e,providers:[i.a,r.a]}},e}()},VrZ9:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var i=n("keVe"),r=n("TOqr"),o=n("pzhl"),a=n("PkQn"),l=n("4/We"),s=n("MRNN"),c=n("/I02"),u=n("PBJH"),d=n("Z0U4"),p=i.Fb({encapsulation:2,styles:[],data:{}});function f(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,4,"div",[],null,null,null,null,null)),i.Gb(2,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Zb(3,{"back-button":0,"back-button--fluent":1,"ms-u-hiddenMdDown":2}),(e()(),i.Hb(4,0,null,null,1,"ohp-icon-font",[["ariaVisible","true"],["dataArea","Hero"],["dataNav","1"],["iconButton","true"],["iconFontName","ArrowLeft"]],null,[[null,"iconClicked"]],(function(e,t,n){var i=!0;return"iconClicked"===t&&(i=!1!==e.component.navigateBack()&&i),i}),o.b,o.a)),i.Gb(5,638976,null,0,a.a,[l.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],id:[2,"id"],title:[3,"title"],ariaVisible:[4,"ariaVisible"],ariaLabel:[5,"ariaLabel"],dataArea:[6,"dataArea"],dataNav:[7,"dataNav"],iconButton:[8,"iconButton"],focusOnLoad:[9,"focusOnLoad"]},{iconClicked:"iconClicked"})],(function(e,t){var n=t.component,i=e(t,3,0,!n.fluentRefresh,n.fluentRefresh,n.responsive&&!n.fluentRefresh);e(t,2,0,i),e(t,5,0,"back-button__icon ms-fcl-tp"+(n.fluentRefresh?" back-button__icon--fluent":""),"ArrowLeft",n.elementId,n.backButtonAriaLabel||n.defaultAriaLabel,"true",n.backButtonAriaLabel||n.defaultAriaLabel,"Hero","1","true",n.focusOnLoad)}),null)}function h(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,ction(e,t){var n=t.component;e(t,1,0,n.backRoute||n.defaultBackRoute)}),null)}i.Db("ohp-back-button",s.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-back-button",[],null,null,null,h,p)),i.Gb(1,245760,null,0,s.a,[l.a,c.a,u.a,d.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{elementId:"elementId",backButtonAriaLabel:"backButtonAriaLabel",defaultBackRoute:"defaultBackRoute",responsive:"responsive",focusOnLoad:"focusOnLoad"},{},[])},Vwd8:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return m}));var i=n("QjXU"),r=n("Dn7E"),o=n("lrJm"),a=n("W3Zz"),l=n("uzn7"),s=n("re3B"),c=n("xoWf"),u=n("cgnd"),d=n("hhzZ"),p=n("keVe"),f=function(){function e(t,n,i,r,o,a,l){var s=this;this.clientStartupConfigService=t,this.localStorageService=n,this.userDataStorageService=o,this.instrumentationService=a,this.globalErrorHandler=l,this.scheduledSavePromise=null,this.pendingFirstTimeMetrics={},this.firstTimeUser=this.userDataStorageService.isFirstUse(),this.firstVisitTimestamp=this.userDataStorageService.getFirstUseTimestamp(),this.bufferingTimeoutInSeconds=r.isMobileDevice()?e.BufferingTimespanInSecondsForMobile:e.BufferingTimespanInSecondsForDesktop,this.localStorageProfileDataKey=".Full_Metrics.v"+e.LocalStorageSchemaVersion,this.fullMetrics=this.localStorageService.get(this.localStorageProfileDataKey),this.fullMetrics&&this.fullMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.fullMetrics.created):this.fullMetrics=e.createEmptySnapshot(),this.onLoadMetrics=this.fullMetrics.metrics,this.localStorageUnsavedDataKey=".Unsaved_Metrics.v"+e.LocalStorageSchemaVersion,this.unsavedMetrics=this.localStorageService.get(this.localStorageUnsavedDataKey),this.unsavedMetrics&&this.unsavedMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.unsavedMetrics.created):this.unsavedMetrics=null,this.inMemoryProfile={metrics:this.fullMetrics.metrics},this.roamingStorageProfileDataKey="User_Profile.Metrics.v"+e.LocalStorageSchemaVersion,this.loadFromUserStorage(),this.forceImmediateSave=this.firstTimeUser||!!this.unsavedMetrics,i.addUnloadEvent((function(){return s.flush()})),this.allowlistEnabled=this.clientStartupConfigService.config.UserProfileMetricAllowlistEnabled,this.allowlist=new Set(this.clientStartupConfigService.config.UserProfileMetricAllowlist)}return e.prototype.incrementMetric=function(t,n){if(!(this.allowlistEnabled&&this.allowlist.size>0)||this.allowlist.has(t)){var i=e.createTimestamp();e.applyIncrement(t,i,this.fullMetrics.metrics);var r=this.fullMetrics.metrics[t];r&&1===r.count&&(this.loadingMetricsFromRoamingStorage?this.pendingFirstTimeMetrics[t]=r.firstOccurrence:this.logMetricRecordedForFirstTime(t)),this.unsavedMetrics||(this.unsavedMetrics=e.createEmptySnapshot()),e.applyIncrement(t,irototype.flush=function(){this.scheduledSavePromise&&this.forceSave()},e.prototype.get=function(){return this.pendingLoad},e.prototype.isFirstVie.prototype.getInitialMetric=function(e){return this.onLoadMetrics[e]},e.prototype.doesMetricExist=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.get()];case 1:for(n in i.sent().metrics)if(t?n===e:n.includes(e))return this.allowlistEnabled&&this.allowlist.size>0&&!this.allowlist.has(n)?[2,!1]:[2,!0];return[2,!1]}}))}))},e.prototype.fullDaysSinceFirstVisit=function(){if(this.firstTimeUser)return 0;if(void 0===this.firstVisitTimestamp||this.firstVisitTimestamp<0)return-1;var t=e.createTimestamp()-this.firstVisitTimestamp;return Math.floor(t/e.MillisecondsInDay)},e.createTimestamp=function(){return Date.now()},e.createEmptySnapshot=function(){return{metrics:{},created:e.createTimestamp(),saved:-1}},e.applyIncrement=function(e,t,n){if(n.hasOwnProperty(e)){var i=n[e];i.count++,i.lastOccurrence=t}},e.mergeMetrics=function(t,n){for(var i in n)e.applyMetric(t,i,n[i])},e.applyMetric=function(e,t,n){if(e.hasOwnProperty(t)){var r=e[t];r.count+=n.count,r.firstOccurrence>n.firstOccurrence&&(r.firstOccurrence=n.firstOccurrence),r.lastOccurrence<n.lastOccurrence&&(r.lastOccurrence=n.lastOccurrence)}else e[t]=Object(i.__assign)({},n)},e.sanitizeMetrics=function(t){if(!t.hasOwnProperty(e.MetricPresentInSetThatHasToBeSanitized))return t;var n={};for(var i in t)if(!(i.indexOf("_Request")>0||i.indexOf("_Impression")>0)){var r=!1;if(i.startsWith("Referral."))r=!0;else if(i.indexOf("_PageView")>0)r=!0;else if(i.indexOf("_Click")>0||i.indexOf("_Toggle")>0){var o=i.split(".");3===o.length&&d.b.hasOwnProperty(o[1])&&(r=!0)}else"Upload_Completed"===i&&(r=!0);r&&(n[i]=t[i])}return n},e.prototype.cleanMetricsWithAllowlist=function(e){var t={};for(var n in e)this.allowlist.has(n)&&(t[n]=e[n]);return t},e.prototype.resetScheduledSave=function(){this.scheduledSavePromise&&(clearTimeout(this.scheduledSaveTimeoutId),this.scheduledSaveTimeoutId=null,this.scheduledSavePromise=null,this.scheduledSaveEstimatedTime=null)},e.prototype.scheduleSave=function(e){var t=this;if(this.forceImmediateSave)return this.forceImmediateSave=!1,void this.forceSave();if(!this.scheduledSavePromise||e&&!(Date.now()+1e3*e>=this.scheduledSaveEstimatedTime)){this.resetScheduledSave();var n=1e3*(e?Math.min(e,this.bufferingTimeoutInSeconds):this.bufferingTimeoutInSeconds);this.schedule.scheduledSaveTimeoutId=setTimeout((function(){t.forceSave(),e()}),n)}))}},e.prototype.forceSave=function(){var t=this;if(this.resetScheduledSave(),this.clientStartupConfigService.config.sanitizeMetrics&&(this.unsavedMetrics&&(this.unsavedMetrics.metrics=e.sanitizeMetrics(this.unsavedMetrics.metrics)),this.fullMetrics.metrics=e.sanitizeMetrics(this.fullMetrics.metrics)),this.allowlistEnabled&&this.allowlist.size>0&&(this.unsavedMetrics&&(this.unsavedMetrics.metrics=this.cleanMetricsWithAllowlist(this.unsavedMetrics.metrics)),this.fullMetrics.metrics=this.cleanMetricsWithAllowlist(this.fullMetrics.metrics)),this.fullMetrics.saved=e.createTimestamp(),this.localStorageService.set(this.localStorageProfileDataKey,this.fullMetrics),this.unsavedMetrics&&this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics),this.loadingMetricsFromRoamingStorage)this.scheduleSave();else{var n=this.unsavedMetrics;this.unsavedMetrics=null,this.userDataStorageService.set(this.roamingStorageProfileDataKey,this.fullMetrics).then((function(){t.unsavedMetrics?t.localStorageService.set(t.localStorageUnsavedDataKey,t.unsavedMetrics):t.localStorageService.remove(t.localStorageUnsavedDataKey)})).catch((function(i){t.globalErrorHandler.handleError(i,"SxWjc"),t.unsavedMetrics&&n&&e.mergeMetrics(n.metrics,t.unsavedMetrics.metrics),t.unsavedMetrics=n,t.unsavedMetrics&&t.localStorageService.set(t.localStorageUnsavedDataKey,t.unsavedMetrics)}))}},e.prototype.loadFromUserStorage=function(){var t=this;this.pendingLoad=new Promise((function(n){t.loadingMetricsFromRoamingStorage=!0,t.userDataStorageService.get(t.roamingStorageProfileDataKey,e.LoadFromUserStorageRemoteAttempts).then((function(n){n&&n.metrics&&(t.unsavedMetrics&&n.saved<t.unsavedMetrics.created&&e.mergeMetrics(n.metrics,t.unsavedMetrics.metrics),t.fullMetrics=n,t.inMemoryProfile.metrics=t.fullMetrics.metrics)})).catch((function(e){t.globalErrorHandler.handleError(e,"QN0a5")})).then((function(){for(var e in t.loadingMetricsFromRoamingStorage=!1,t.pendingFirstTimeMetrics){var i=t.fullMetrics.metrics[e];i&&t.pendingFirstTimeMetrics[e]!==i.firstOccurrence||t.logMetricRecordedForFirstTime(e)}t.pendingFirstTimeMetrics={},n(t.inMemoryProfile)}))}))},e.prototype.logMetricRecordedForFirstTime=function(e){var t={};t.MetricName=e,this.instrumentationService.logGenericEvent("First_Time_Metric",t),Object(r.a)({featureName:"Other",eventName:"First_Time_Metric",params:t})},e.BufferingTimespanInSecondsForDesktop=30,e.BufferingTimespanInSecondsForMobile=5,e.LoadFromUserStorageRemoteAttempts=2,e.LocalStorageSchemaVersion=1,e.MillisecondsInDay=864e5,e.Metp.lc(u.b),p.lc(l.a),p.lc(s.a),p.lc(a.c),p.lc(cis.userProfileService=e,this.streamName=t,this.params=n,this.metrics=i}return e.prototype.record=function(){var e=this;if(this.metrics){var t="Generic_Click"===this.streamName&&this.params.Referral?1:void 0;this.metrics.forEach((function(n){return e.userProfileService.incrementMetric(n,t)}))}},e}(),m=function()reateEvent=function(e,t,n){return new h(this.userProfileService,e,t,n)},e.prototype.flush=function(){this.userProfileService.flush()},e.ɵprov=p.kc({factory:function(){return new e(p.lc(f))},token:e,providedIn:"root"}),e}()},W0EU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},W3Zz:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var i,r,o,a=n("BMb5"),l=n("keVe");!function(e){e[e.PC=0]="PC",e[e.Mac=1]="Mac",e[e.WindowsPhone=2]="WindowsPhone",e[e.iPad=3]="iPad",e[e.iPhone=4]="iPhone",e[e.AndroidPhone=5]="AndroidPhone",e[e.AndroidTablet=6]="AndroidTablet",e[e.Linux=7]="Linux",e[e.Chromebook=8]="Chromebook",e[e.Other=9]="Other"}(i||(i={})),function(e){e[e.IE=0]="IE",e[e.Edge=1]="Edge",e[e.EdgeLegacy=2]="EdgeLegacy",e[e.Chrome=3]="Chrome",e[e.Firefox=4]="Firefox",e[e.Safari=5]="Safari",e[e.PhantomJS=6]="PhantomJS",e[e.Opera=7]="Opera",e[e.WebView=8]="WebView",e[e.Other=9]="Other"}(r||(r={})),function(e){e.Slow2g="Slow2g",e.Standard2g="Standard2g",e.Standard3g="Standard3g",e.Standard4g="Standard4g",e.Unknown="Unknown"}(o||(o={}));var s=function(){function e(e,t,n){this.major=this.normalize(e),this.minor=this.normalize(t),this.build=this.normalize(n)}return e.prototype.compareTo=function(e){return this.major===e.major&&this.minor===e.minor&&this.build===e.build?0:this.major>e.major||this.major===e.major&&this.minor>e.minor||this.major===e.major&&this.minor===e.minor&&this.build>e.build?1:-1},e.prototype.toString=function(){return this.major+"_"+this.minor+"_"+this.build},e.prototype.normalize=function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=parseInt(e);return isNaN(t)?0:t}return 0},e}(),c=function(){function e(e,t,n){this.major=this.normalize(e),this.minor=this.normalize(t),this.build=this.normalize(n)}return e.prototype.compareTo=function(e){return this.major===e.major&&this.minor===e.minor&&this.build===e.build?0:this.major>e.major||this.major===e.major&&this.minor>e.minor||this.major===e.maype.toString=function(){return this.major+"_"+this.minor+"_"+this.build},e.prototype.normalize=function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=parseInt(e);return isNaN(t)?0:t}return 0},e}(),u=function(){function e(e){this.windowService=e,this.platforms=[{keyword:"Windows NT",platformType:i.PC},{keyword:"Windows XP",platformType:i.PC},{keyword:"Macintosh",platformType:i.Mac},{keyword:"Windows Phone",platformType:i.WindowsPhone,pageName:"windows-phone"},{keyword:"iPad",platformType:i.iPad,pageName:"ipad"},{keyword:"iPhone",platformType:i.iPhone,pageName:"iphone"},{keyword:"Android",platformType:i.AndroidPhone,pageName:"android-phone"},{keyword:"Linux",platformType:i.Linux},{keyword:"CrOS",platformType:i.Chromebook}],this.browsers=[{keyword:"PhantomJS",browserType:r.PhantomJS},{keyword:"Edge",browserType:r.EdgeLegacy},{keyword:"EdgA",browserType:r.Edge},{keyword:"EdgiOS",browserType:r.Edge},{keyword:"Edg",browserType:r.Edge},{keyword:"wv",browserType:r.WebView},{keyword:"MSIE",browserType:r.IE},{keyword:"Trident",browserType:r.IE},{keyword:"OPR",browserType:r.Opera},{keyword:"Chrome",browserType:r.Chrome},{keyword:"CriOS",browserType:r.Chrome},{keyword:"Firefox",browserType:r.Firefox},{keyword:"Safari",browserType:r.Safari}],this.networkTypes=[{keyword:"slow-2g",networkType:o.Slow2g},{keyword:"2g",networkType:o.Standard2g},{keyword:"3g",networkType:o.Standard3g},{keyword:"4g",networkType:o.Standard4g}],this.userAgent=this.windowService.nativeWindow.navigator.userAgent}return e.prototype.getDeviceInfo=function(){if(this.deviceInfo)return this.deviceInfo;var e=this.userAgent.toLowerCase(),t={keyword:"Other",platformType:i.Other};this.platforms.some((function(n){return-1!==e.indexOf(n.keyword.toLowerCase())&&(t=n,!0)})),t.platformType===i.AndroidPhone&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:i.AndroidTablet,pageName:"android-tablet"});var n=new s(0,0,0);if(t.platformType===i.Mac)(o=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(this.userAgent)).length>=6&&(n=new s(o[1],o[3],o[5]));else if(t.platformType===i.PC||t.platformType===i.WindowsPhone)-1!==e.indexOf("windows xp")?n=new s(5,1,0):(o=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(this.userAgent)).length>=5&&(n=new s(o[3],o[4],0));else if(t.platformType===i.iPad||t.platformType===i.iPhone){var o=e.match(/os (\d+)_(\d+)(_(\d+))?/);n=new s(o[1]||0,o[2]||0,o[4]||0)}var a={keyword:"Other",browserType:r.Other},l=new c(0,0,0);return this.browsers.some((function(t){if(-1!==e.indexOf(t.keyword.toLowerCase())){a=t;var n=e.split(t.keyword.toLowerCase()+"/");if(n.length<2)return!1;var i=n[1].match(/\d+|\s/);return l=new c(i[0]||0,i[1]||0,i[2]||0),!0}return!1})),this.deviceInfo={platform:t,platformVersion:n,browser:a,browserVersion:l},this.deviceInfo},e.prototype.getNetworkInfo=function(){if(this.networkType)return this.networkType;var e=this.windowService.nativeWindow.navigator.connection,t=e&&e.effectiveType?e.effectiveType:"Unknown",n={keyword:"Unknown",networkType:o.Unknown};return this.networkTypes.some((function(e){return-1!==t.toLowerCase().indexOf(e.keyword)&&(n=e,!0)})),this.networkType=n.networkType,this.networkType},e.prototype.isDesktopDevice=function(){var e=this.getDeviceInfo().platform.platformType;return e===i.PC||e===i.Mac||e===i.Linux||e===i.Chromebook},e.prototype.isMobileDevice=function(){var e=this.getDeviceInfo().platform.platformType;return e===i.iPhone||e===i.AndroidPhone||e===i.WindowsPhone},e.prototype.isTabletDevice=function(e){void 0===e&&(e=null);var t=this.getDeviceInfo().platform.platformType;return null!==e?t===e:t===i.iPad||t===i.AndroidTablet},e.prototype.isUwp=function(){return this.userAgent.toLowerCase().indexOf("msapphost/")>-1&&"undefined"!=typeof Windows},e.prototype.isWebView2=function(unction(){return this.userAgent.toLowerCase().indexOf("trident/7.0")>-1},e.ɵprov=l.kc({factory:function(){return new e(l.lc(a.b))},token:e,providedIn:"root"}),e}()},W3xQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("dFxn"),r=n("cgnd"),o=n("keVe"),a=function(){function e(e,t){this.config=e.parse("calendarConfig"),this.config&&(this.config.peopleImagesEnabled=this.config.peopleImagesEnabled&&!t.config.automatedTestRunning)}return e.ɵprov=o.kc({factory:function(){return new e(o.lc(i.a),o.lc(r.b))},token:e,providedIn:"root"}),e}()},WDeU:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("QjXU"),r=n("inRP"),o=n("HZp7"),a=n("YqCH");function l(e,t,n,l,s){return Object(i.__awaiter)(this,void 0,void 0,(function(){var c,u,d;return Object(i.__generator)(this,(function(i){switch(i.label){cas&&c.push(Object(r.a)(crypto.subtle,l,e,(function(e){return Object(o.b)(e)}))),[4,Promise.all(c)];case 1:return u=i.sent(),d=l,u.length>1&&(d=u[1]),[2,[u[0],d]]}}))}))}},WFKr:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("CVeG"),r=function(){function e(e,t){this.Finished=e,tnction(t){return nfor(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.Pipeline=e}return e.prototype.Run=function(e){if(!this.Pipeline||0===this.Pipeline.length)return e;for(var t=null,n=0;n<this.Pipeline.length;n++){if((t=this.Pipeline[n](e)).Finished)return t.Value;e=t.Value}return t?t.Value:e},e}(),a=function(){function e(){}return Object.defineProperty(e,"MetacharactersMatch",{get:function(){return/[\\^$*+?.()|[\]{}]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MetacharactersReplacemeon(t){return t.replace(e.MetacharactersMatch,e.Mt=function(t,n,i){return e.FormatWithSeparator(t,e.DefaultSeparator(n),i)},e.FormatWithSeparator=function(t,n,r){var o=[],l=e.FormatterPipeline.Run({PathArray:t,Formatted:"",Separator:n,MaxLength:r||e.DefaultMaxLength}).Formatted;o.push(l);var s=i.a.escapeHtml(n),c=""+e.PathSegmentPostfix+e.PathSegmentPrefix+s+e.PathSegmentPostfix+e.PathSegmentPrefix,u=e.GetRegExp(a.escape(s),"g");return o.push(""+e.PathSegmentPrefix+ultSeparator=function(t){return t?e.DefaultPathSepRtl:e.DefaultPathSepLtr},e.ZeroElements=function(e){return e.PathArray&&0!==e.PathArray.length?r.Unfinished(e):(e.Formatted="",r.Finished(e))},e.TopTooLong=function(t){var n=t.PathArray[0].trim();return n.length>t.MaxLength?(t.Formatted=n.substr(0,t.MaxLength-1).trim()+e.Ellipsis,r.Finished(t)):r.Unfinished(t)},e.SingleElement=function(e){return 1===e.PathArray.length?(e.Formatted=e.PathArray[0].trim(),r.Finished(e)):r.Unfinished(e)},e.TopTooLongForSingleFollower=function(t){var n=t.PathArray[0].trim();return n.length+t.Separator.length+e.Ellipsis.length>t.MaxLength?(t.Formatted=n,r.Finished(t)):r.Unfinished(t)},e.TopTooLongForMultipleFollowers=function(t){var n=t.PathArray[0].trim();return t.PathArray.length>2&&n.length+2*(t.Separator.length+e.Ellipsis.length)>t.MaxLength?(t.Formatted=n,r.Finished(t)):r.Unfinished(t)},e.TopAndBottomTooLongAndOnlyElements=function(t){if(2===t.PathArray.length){var n=t.PathArray[0].trim(),i=t.PathArray[1].trim(),o=n.length+i.length+t.Separator.length+1-t.MaxLength;if(o>1)return t.Formatted=e.Join(n,e.Ellipsis+i.substr(o).trim(),t.Separator),r.Finished(t)}return r.Unfinished(t)},e.TopAndBottomTooLongAndOtherElements=function(t){if(t.PathArray.length>2){var n=t.PathArray[0].trim(),i=t.PathArray[t.PathArray.length-1].trim(),o=n.length+i.length+2*(t.Separator.length+1)-t.MaxLength;if(o>1)return i=i.substr(o).trim(),t.Formatted=e.Join(n,e.Ellipsis,t.Separator),i.length>0&&(t.Formatted=e.Join(t.Formatted,e.Ellipsis+i,t.Separator)),r.Finished(t)}return r.Unfinishedormatted=t.PathArray.reduce((function(n,i){return e.Join(n,i,t.Separator)})),t.Formatted.length<=t.MaxLength?r.Finished(t):r.Unfinished(t)},e.CollapseFirst=function(t){var n=e.GetRegExp(t.Separator+".*?"+t.Separator);return t.Formatted=t.Formatted.replace(n,t.Separator+e.Ellipsis+t.Separator),t.Formatted.length<=t.MaxLength?r.Finished(t):r.Unfinished(t)},e.CollapseRemaining=function(t){for(var n=e.GetRegExp(t.Separator+".*?"+t.Separator+".*?"+t.Separator);t.Formatted.length>t.MaxLength;){var i=t.Formatted;if(t.Formatted=t.Formatted.replace(n,t.Separator+e.Ellipsis+t.Separator),i===t.Formatted)break}return r.Finished(t)},e.Join=function(e,t,n){return 0===t.length?e:e.trim()+n+t.trim()},e.GetRegExp=function(t,n){void 0===n&&(n="");var i=t+"/"+n;if(e.RegExpCache.has(i))return e.RegExpCache.get(i);var r=new RegExp(t,n);return e.RegExpCache.set(i,r),r},e.DefaultMaxLength=60,e.DefaultPathSepLtr=" » ",e.DefaultPathSepRtl=" « ",e.Ellipsis="…",e.PathSegmentPrefix='<span dir="auto">',e.PathSegmentPostfix="</span>",e.FormatterPipeline=new o(e.ZeroElements,e.TopTooLong,e.SingleElement,e.TopTooLongForSingleFollower,e.TopTooLongForMultipleFollowers,e.TopAndBottomTooLongAndOnlyElements,e.TopAndBottomTooLongAndOtherElements,e.MultipleElements,e.CollapseFirst,e.CollapseRemaining),e.RegExpCache=new Map,e}()},WJRI:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i=n("keVe"),r=n("TOqr"),o=n("kVgv"),a=i.Fb({encapsulation:2,styles:[],data:{}});function l(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"div",[["aria-live","assertive"],["class","title-announcement"],["role","alert"],["tabindex","-1"]],[[1,"aria-label",0]],null,null,null,null)),(e()(),i.gc(1,null,[" ","\n"]))],null,(funcf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.component.announcement)}),null)}i.Db("ohp-title-announcer",o.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-title-announcer",[],null,null,null,s,a)),i.Gb(1,49152,null,0,o.a,[],null,null)],null,null)}),{announcement:"announcement"},{},[])},WLAd:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("hZW2"),r=n("keVe"),o=function(){function e(e){this.documentService=e}return e.prototype.addOnVisibilityChanged=function(e){vat.addEventListener("visibilitychange",(function(){return e(t.visibilityState)}))},e.prototype.getVisibilityState=function(){ret,e.prototype.isVisible=function(){return"visible"===this.getVisibilityState()},e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},XQbr:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},XV2T:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(t,n){if(this.userId=t||e.unknownUserId,this.nativeStorage=n,this.nativeStorage){var i=this.getUserBasedKey("_"+Math.round(1e6*Math.random()));try{this.nativeStorage.setItem(i,i),this.nativeeturn e.prototypKey(e))},e.prototype),t)},e.prototype.remove=function(e){this.removeItem(this.getUserBasedKey(e))},{return this.getItem(e)},,t){this.setItem(e,t)},e.prototype.removeGlobal=function(e){this.removeItem(e)},e.prototype.findKeys=function(e){if(!this.nativeStorage||!e)return null;for(var t=[],n=0;n<this.nativeStorage.length;n++){var i=this.nativeStorage.key(n);i.indexOf(e)>=0&&t.push(i)}return t},e.prototype.getItem=function(e){if(!this.nativeStorage)return null;var t=this.nativeStorage.getItem(e);return"string"==typeof t?JSON.parse(t):void 0},e.prototype.setItem=function(e,t){if(this.nativeStorage)try{var n=void 0===t?void 0:JSON.pe.removeItem=function(e){this.nativeStorage&&this.nativeStorage.removeItem(e)},e.prototype.getUserBasedKey=function(t){return e.officeHomeStorageKeyPrefix+"-"+this.userId+t},e.officeHomeStorageKeyPrefix="officeHome",e.unknownUserId="Unknown",e}()},Xc4i:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("QjXU"),r=n("pM41"),o=n("2dXW"),a=n("ro+v"),l=n("3Vsh"),s=(n("hhzZ"),n("BaAg")),c=n("jCfB"),u=(n("4/We"),n("cgnd"),n("/I02"),n("idgT"),n("oAX+")),d=n("y9oG"),p=(n("hZW2"),n("Uqr9"),n("Brer")),f=n("EUVs"),h=function(){function e(e,t,n,i,r,o,a,l){this.capabilitiesService=e,this.clientStartupConfigService=t,this.contextService=n,this.documentService=i,this.instrumentationService=r,this.performanceService=o,this.templatesConfigService=a,this.vroomService=l,this.index=0,this.bootstrappersLoaded=new Map,this.bootstrapperDiagnostics=new Map,this.applicationUrls=new Map,this.performanceMarker=new Map}return e.prototype.loadBootstrapper=function(e,t,n,i){var r=this;if(void 0===i&&(i=!1),this.bootstrappersLoaded.has(e))return this.bootstrappersLoaded.get(e);var o=new Promise((function(t,i){r.bootstrapperDiagnostics.set(e,{startTime:Date.now()}),r.documentService.addScriptToPage(e,(function(){r.bootstrapperDiagnostics.get(e).endTime=Date.now(),t()}),i,!1,s.b[n]+"_bootstrapper")}));return i&&this.templatesConfigService.prefetchStaticResources(n),this.bootstrappersLoaded.set(e,o),this.applicationUrls.set(n,{bootstrapperUrl:e,applicationUrl:t}),o},e.prototype.convertMruInflationPromise=function(e,t,n){var i=this;return e.then((function(e){var r=f.a.getDocumentInfoForMruFileItem(e,t);return{fetchDiagnostics:{startTime:n,endTime:Date.now()},wopiHostData:e.wopiData,fetchedDocumentInfo:r.docId&&r.driveId?i.getDocumentInfoWithSharingLink(r):i.getWopiData(r,!1,!1,!0).then((function(e){return e.fetchedDocumentInfo}))}}))},e.prototype.getWopiData=function(e,t,n,r){var o=this;void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=Date.now(),l=Object(i.__read)(this.getDriveItemWithWacData(e,t,n),2),s=l[1];return l[0].then((function(t){var n,l,c,u;if(t){var d={startTime:a,endTime:Date.now()},f=p.a.getWopiHostDataFromItem(t),h=Object(i.__assign)(Object(i.__assign)({},e),{docUrl:null!==(n=t.webUrl)&&void 0!==n?n:e.docUrl,driveId:null!==(c=null===(l=null==t?void 0:t.parentReference)||void 0===l?void 0:l.driveId)&&void 0!==c?c:e.driveId,docId:null!==(u=null==t?void 0:t.id)&&void 0!==u?u:e.docId}),m=r?o.getDocumentInfoWithSharingLink(h):Promise.resolve(h);return Promise.resolve({wopiHostData:f,fetchDiagnostics:d,fetchedDocumentInfo:m})}return s.then((function(e){return Promise.reject(e)})).catch((function(e){return Promise.reject(e)}))})).catch((function(e){return Promise.reject(e)}))},e.prototype.logPerformanceEventFromClick=function(e,t,n){var i,r,o=null!==(r=this.performanceMarker.get(e))&&void 0!==r?r:{clickTimeMarker:1,instrumentationParams:(i={},i.WacHostEntry=this.contextService.getWdOrigin("DIRECT"),i.ResourceId=this.getCorrelationIdForBootId(e),i.FileFormat=s.a.fileTypeNameFromType(n),i)};this.performanceService.mark(t+"."+e,o.clickTimeMarker,void 0,o.instrumentationParams)},e.prototype.generateCorrelationAndBootId=function(e){var t=null!=e?e:this.index++;return[this.getCorrelationIdForBootId(t),t]},e.prototype.logPerformanceBootStart=function(e,t,n,i){var r,o=((r={}).WacHostEntry=n,r.ResourceId=t,r.FileFormat=s.a.fileTypeNameFromType[i],r),a=this.performanceService.mark("WacContentPerformanceMarker.DocumentLoadStart."+e,0,void 0,o);this.performanceMarker.set(e,{clickTimeMarker:a,instrumentationParams:o})},e.prototype.logBootPerformance=function(e,t,n,i){var o;if(n&&n.documentLoadedTime&&i){var a=((o={}).DebugInfo=JSON.stringify(n),o),l=Object(d.a)(e,t,a),s=n.documentLoadedTime-i;this.instrumentationService.logPerformanceEvent(c.b,s,l),Object(r.a)({eventName:c.b,latency:s,instrumentationParams:l})}},e.prototype.getDocumentInfoWithSharingLink=function(e){return this.capabilitiesService.capabilities.wacSharingLinkEnabled?this.vroomService.createSharingLink(e.driveId,e.docId).then((function(t){var n;try{n=decodeURIComponent(t)}catch(t){return e}return Object(i.__assign)(Object(i.__assign)({},e),{docUrl:null!=n?n:e.docUrl})})).catch((function(){return e})):Promise.resolve(e)},e.prototype.getCorrelationIdForBootId=function(e){return this.clientStartupConfigService.config.sharedClientStartupContext.correlationId+"."+e},e.prototype.getDriveItemWithWacData=function(e,t,n){var iopen",f=s&&r?function(e){return i.vroomService.getItemWithWacData(c,s,r,e,p,n)}:function(e){return i.vroomService.getSharedItemWithoutThumbnail(c,d,null,e,!0,p,n)},h=new o.a;return[(n?Object(a.a)(f("network-only")):u.a.createResultsWithCacheObservable(f("cache-only"),f("network-first"),void 0,(function(e){return h.error(e)})).results).pipe(Object(l.a)(1)).toPromise(),h.toPromise()]},e}()},Xn3c:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n("QjXU"),r=n("CMIS"),o=n("lrJm"),a=n("3GGT"),l=n("hhzZ"),s=n("R7NL"),c=n("/I02"),u=n("kpuN"),d=n("MMsA"),p=n("dFxn"),f=n("wwmn"),h=n("casz"),m=n("4d0o"),b=n("keVe"),g=function(){function e(e,t,n,i,r,o,a,l,s,c){this.accessTokenService=e,this.contextService=t,this.instrumentationService=n,this.instrumentedHttp=i,this.authStateService=r,this.officeHomeApiConfigService=o,this.userDataStorageConfigService=a,this.globalErrorHandler=s,this.scheduler=c,null!=t.sharedContext.officeHomeApiRoot&&a.config&&null!=a.config.userStorageEndpoint&&(this.serviceUrl=t.sharedContext.officeHomeApiRoot+"/"+a.config.userStorageEndpoint);var u=l.parse("userStorageCache")||{firstUse:!1,firstUseTimestamp:0,content:{}};this.firstUse=u.firstUse,this.firstUseTimestamp=u.firstUseTimestamp,this.masterCollection=u.content}return e.prototype.get=function(e,t){var n=this;return void 0===t&&(t=1),new Promise((function(r,o){if(n.masterCollection.hasOwnProperty(e)){var l=Object(i.__assign)({},n.masterCollection[e]);r(l)}else if(n.firstUse||t<1)r(void 0);else if("SignedIn"===n.authStateService.getCurrentState())if(n.serviceUrl){var s=0,c=function(i,l,u){n.instrumentedHttp.get(i,l,n.serviceUrl+"/"+e+"/",u||{},"network-only").instrument((function(t,n){n.RequestId=e})).then((function(e){return r(e.data)})).catch((function(d){n.globalErrorHandler.handleError(d,"Bn3rc"),d&&d.status===a.a.NotFound?r(void 0):d.status!==a.a.Forbidden&&s<t-1?(s++,c(i,l,u)):o("Failed to get value from user data storage for <"+e+"> key. Status code: "+d.status)}))};n.request(c,"OfficeHomeStorage_Read_Request","OfficeHomeStorage_Read",o)}else o("User storage does not support roaming");else o("User has to be signed in to access storage for <"+e+"> key.")}))},e.prototype.set=function(e,t){var n=this;return new Promise((function(o,a){"SignedIn"===n.authStateService.getCurrentState()?(n.masterCollection[e]=Object(i.__assign)({},t),n.serviceUrl?n.request((function(i,l,s){if((s=s||{}).headers||(s.headers=new Map),!n.officeHomeApiConfigService.config.jwtAuthEnabled&&!n.contextService.sharedContext.inMockMode){if(!n.contextService.getCsrfToken())return n.instrumentationService.logErrorEvent("Csrf_Token_Error"),Object(r.a)({eventName:"Csrf_Token",errorType:"User_Storage_Error"}),void a("CSRF token missing");s.headers.set("AjaxSessionKey",n.contextService.getCsrfToken())}var c=function(){return n.instrumentedHttp.put(i,l,n.serviceUrl+"/"+e+"/",t,s).instrument((function(t,n){n.RequestId=e})).then((function(){return o(null)})).catch((function(t){n.globalErrorHandler.handleError(t,"J7GBR"),a("Failed to update or create value in roaming user data storage for <"+e+"> key. Status code: "+t.status)}))};n.userDataStorageConfigService.config.deferWrite?n.scheduler.scheduleWork((function(){c()}),4):c()}),"OfficeHomeStorage_Write_Request","OfficeHomeStorage_Write",a):a("User storage does not support roaming")):a("User has to be signed in to access storage for <"+e+"> key.")}))},e.prototype.request=function(e,t,n,i){var r=this;this.officeHomeApiConfigService.config.jwtAuthEnabled?this.accessTokenService.getAccessToken("OfficeHome").then((function(o){if(!o.success)return r.instrumentationService.logRequestEvent(t,a.a.TokenUnavailable,-1,"string"==typeof o.error?o.error:""),void i("Token Unavailable");var l={headers:new Map([["Authorization","Bearer "+o.token]])};e(t,n,l)})):e(t,n)},e.prototype.isFirstUse=function(){return this.firstUse},e.prototype.getFirstUseTimestamp=function(){return this.firstUseTimestamp},e.ɵprov=b.kc({factory:function(){return new e(b.lc(u.b),b.lc(c.a),b.lc(l.a),b.lc(s.a),b.lc(d.a),b.lc(f.a),b.lc(m.a),b.lc(p.a),b.lc(o.b),b.lc(h.a))},token:e,providedIn:"root"}),e}()},YqCH:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("QjXU"),r=n("e3cR"),o=n("obr3"),a=n("H2Bi"),l=new Map;function s(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var c,u,d,p,f;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(c="".concat(e,".").concat(a.a,".").concat(t),u=l.get(c))return[2,u];i.label=1;case 1:return i.trys.push([1,3,,7]),[4,d=Object(r.b)(c,{upgrade:function(e){try{e.deleteObjectStore(a.d.then((function(e){e.close(),l.delete(c)}))},terminated:function(){l.delete(c)}},n)];case 2:return p=i.sent(),l.set(c,d),[2,p];case 3:return(f=i.sent())instanceof DOMException?[4,Object(o.a)(c)]:[3,5];case 4:return i.sent(),[2,s(e,t,n)];case 5:throw new Error("Failed to create database with exce]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)}n.d(t,"a",(function(){return i}))},Z0U4:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("QjXU"),r=n("X+PR"),o=n("GMuP"),a=n("Dn7E"),l=n("AlWG"),s=n("dpyN"),c=n("zvoD"),u=n("caHY"),d=n("hhzZ"),p=n("BaAg"),f=n("4/We"),h=n("ZBli"),m=n("uzn7"),b=n("5aVq"),g=n("BMb5"),v=n("keVe"),S=n("TOqr"),y=function(){function e(t,n,i,r,a,c,u,d,p){var f=this;this.activatedRoute=t,this.capabilitiesService=n,this.instrumentationService=i,this.localStorageService=r,this.locationStrategy=a,this.platformLocation=c,this.router=u,this.windowService=d,this.shellShimService=p;var h=this.windowService.nativeWindow.history;if(this.historyEnabled=!!h&&!!h.go,this.historyEnabled)try{this.lastPoppedState=this.ddEventListener("popstate",(function(e){f.lastPoppedState=f.parseState(e.state)}))}catch(e){this.historyEnabled=!1}this.historyEnabled||(this.instrumentationService.logGenericEvent("History_Disabled"),Object(o.a)({eventName:"History_Disabled",params:{}})),this.initialRoute=this.currentRouteFromPath(this.platformLocation.pathname),this._routes=new l.a({currentRoute:thison(t,n){return t.type===n.type&&e.areRoutesEqual(t.currentRoute,n.currentRoute)}))),this.nativeSearchEnabled=this.capabilitiesService.capabilities.nativeSearchInHeaderEnabled}return e.areRoutesEqual=function(e,t){return!(!e||!t||e.route!==t.route)&&("M365Apps"===e.route&&"M365Apps"===t.route?e.appId===t.appId&&e.entityId===t.entityId&&e.subEntityId===t.subEntityId:e.app===t.app&&e.entityId===t.entityId&&e.subEntityId===t.subEntityI.events.pipe(Object(c.a)((function(e){return e instanceof r.e||e instanceof r.d}))).subscribe((function(n){var i=n.url?n.url.split("?")[0]:null,a=t.currentRouteFromPath(i),l={currentRoute:a,type:n instanceof r.e?0:1},s=!t.ignoreNextNavigation&&(!t.currentRouteState||!e.areRoutesEqual(a,t.currentRouteState.routeItem)||t.rewriteInProgress);if(t.isRouteChangeEndEvent(l)){if("eager"===t.router.urlUpdateStrategy&&(t.router.urlUpdateStrategy="deferred"),t.ignoreNextNavigation)return void(t.ignoreNextNavigation=!1);var c={routeItem:a,index:t.historyEnabled?t.windowService.nativeWindow.history.length:-1,backRouteItem:null,backIndex:-1,version:e.officeRouteStateVersion};if(t.lastPoppedState&&e.areRoutesEqual(t.lastPoppedState.routeItem,a))c=t.lastPoppedState;else if(t.historyEnabled&&t.currentRouteState){if(c.index!==t.currentRouteState.index+1){var u={};u.Index=c.index.toString(),a&&(u.State=a.route,u.DocumentType=a.app?p.b[a.app]:""),u.Error=t.versionMismatch?"Version":"Index",u.DebugInfo="new: "+JSON.stringify(c)+", current: "+JSON.stringify(t.currentRouteState)+", previous: "+JSON.stringify(t.previousRouteState),t.instrumentationService.logGenericEvent("Unexpected_History_State",u),Object(o.a)({eventName:"Unexpected_History_State",params:u}),t.previousRouteState||t.currentRouteState.routeItem&&"OfficeHome"===t.currentRouteState.routeItem.route||(t.historyEnabled=!1,c.index=-1)}if(t.historyEnabled){c.index=t.currentRouteState.index+1;var d=e.areRoutesEqual(t.currentRouteState.routeItem,a);c.backRouteItem=d?t.currentRouteState.backRouteItem:t.currentRouteState.routeItem,c.backIndex=d?t.currentRouteState.backIndex:t.currentRouteState.index}}t.updateState(c),t.lastPoppedState=null,t.previousRouteState=t.currentRouteState,t.currentRouteState=c,t.rewriteInProgress=!1,l.previousRoute=t.previousRouteState?t.previousRouteState.routeItem:null,l.backRoute=c.backRoutees.next(l)}))},e.prototype.hasNavigated=function(){return this.router.navigated},e.prototype.back=function(e){if(void 0===e&&(e=null),this.currentRouteState){this.nativeSearchEnabled&&this.currentRouteState.routeItem&&"Search"===this.shellShimService.getShellShim().then((function(e){e.Search.SetSearchText("")}));var t=this.currentRouteState.backIndex-this.currentRouteState.index;this.historyEnabled&&this.currentRouteState.backIndex>=0&&t<0?this.windowService.nativeWindow.history.go(t):e?this.navigateTo(e):this.platformLocation.back()}else e&&this.navigateTo(e)},e.prototype.getNavigationUrl=function(e){void 0===e&&(e="/");for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[e].concat(t),o=Object(i.__assign)({},this.activatedRoute.snapshot.queryParams);return this.router.serializeUrl(this.router.createUrlTree(r,{queryParams:o}))},e.prototype.navigateTo=function(e,t,n,r,o){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===o&&(o=!1);var a=this.getCommandsAndParamsForRoute(e,n);if(a){var l=Object(i.__read)(a,2);return this.navigateToInternal(l[0],t,l[1],r,o)}},e.prototype.getUrlForRoute=function(e,t){void 0===t&&(t=null);var n=this.getCommandsAndParamsForRoute(e,t);if(n){var r=Object(i.__read)(n,2),o=r[1],a=r[0].reduce((function(e,t){return e+t.split("/").filter((function(e){return!!e})).join("/")+"/"}),this.platformLocation.protocol+"//"+this.platformLocation.hostname+"/");return h.a.appendQueryParams(a,o)}},e.prototype.updateQueryParams=function(e){var t=this;this.ignoreNextNavigation=!0,this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0}).then((function(){t.ignoreNextNavigation=!1})).catch((function(){t.ignoreNextNavigation=!1}))},e.prototype.navigateToAuxilaryRoute=function(e,t){var n={};n[e]=t?[t]:null,this.ignoreNextNavigation=!0,this.router.navigate([{outlets:n}],{queryParamsHandling:"preserve",skipLocationChange:!0})},e.prototype.redirectAndRewrite=function(e){void 0===e&&(e="/");for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0;var i=[e].concat(t);if(this.capabilitiesService.capabilities.isEmbedMode){var r=i.shift(),o=r.split("/").join("");i.unshift("/Embed/".toLowerCase(),o)}this.router.navigate(i,{queryParamsHandling:"preserve",replaceUrl:!0})},e.prototype.subscribeToRouteChangeStart=function(e){return this.routes.pipe(Object(c.a)(this.isRouteChangeStartEvent)).subscribe(e)},e.prototype.subscribeToRouteChangeEnd=function(e){return this.routes.pipe(Object(c.a)(this.isRouteChangeEndEvent)).subscribe(e)},e.prototype.getRouteChangeStartObservable=function(){return this.routes.pipe(Objble=function(){return ototype.isOnRoute=function(e=function(){return this.currentRouteStanction(){return this.activatedRoute?this.activatedRoute.snapshot.queryParams:[]},e.prototype.getCurrentPageForLogging=function(){var e=this.getCurrentRoute();return e?""+(e.app?p.b[e.app]:"")+e.route:"Unknown"},e.prototype.getInitialRoute=function(){return this.initialRoute},e.prototype.getInitialPageForLogging=function(){var e=this.initialRoute;return e?""+(e.ion=function(){return this.currentRouteFromPath(this.platformLocation.pathname)},e.prototype.isRouteChangeStartEvent=function(e){return 0===e.type},e.prototype.isRouteChangeEndEvent=function(e){return 1===e.type},e.prototype.getCommandsAndParamsForRoute=function(e,t){var n,r,o;if(void 0===t&&(t=null),e){var a=Object(i.__assign)({},this.activatedRoute.snapshot.queryParams),l=null===(r=null===(n=this.currentRouteState)||void 0===n?void 0:n.routeItem)||void 0===r?void 0:r.route;"Search"===e.route||"Search"!==l&&"SearchPersonScoped"!==l&&"SearchPersonScopedOverview"!==l&&"SearchTopicScoped"!==l&&"SearchMeetingScoped"!==l||(delete a.q,delete a.p,delete a.e,delete a.s,delete a.pp,delete a.topicId,delete a.topicName,delete a.meetingId,delete a.meetingName,delete a.refiners,delete a.wm);var s=null===(o=this.currentRouteState)||void 0===o?void 0:o.routeItem;("Content"===l||"MyContent"===l&&"drafts"===(null==s?void 0:s.entityId)&&"content"===(null==s?void 0:s.subEntityId))&&(delete a.item,delete a.drive,delete a.file,delete a.action,delete a.siteUrl,delete a.abpId,delete a.t),"AppGallery"===l&&(delete a.about,delete a.featured),"M365Apps"===l&&(delete a.itemId,delete a.driveId,delete a.actionId,delete a.siteId,delete a.groupeId),t&&(a=Object(i.__assign)(Object(i.__assign)({},a),t));var c=[];switch(e.route){case"AppGallery":c.push("apps");break;case"Search":case"SearchSiteScoped":c.push("search");break;case"SearchTopicScoped":c.push("search/topic");break;case"SearchMeetingScoped":c.push("search/meeting");break;case"SearchPersonScoped":c.push("search/content");break;case"SearchPersonScopedOverview":c.push("search/overview");break;case"Start":c.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"ModernStart":c.push(this.capabilitiesService.capabilities.modernStartPageRootPath);break;case"Templates":c.push(this.capabilitiesService.capabilities.templatePageRootPath);break;case"Pwa":c.push("pwa");break;case"Create":c.push("create");break;case"Content":case"MyForms":case"GroupForms":c.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"M365Apps":var u=e.appId;this.capabilitiesService.capabilities.mosAppHostedAtRootEnabled&&this.isMosAppHostedAtRoot(e.appId,!1)?u=this.getFriendlyAppId(e.appId):c.push(this.capabilitiesService.capabilities.m365AppsPageRootPath.toLowerCase()),u&&(c.push(u.toLocaleLowerCase()),e.entityId&&(c.push(e.entityId),e.subEntityId&&c.push(e.subEntityId)));break;case"ConsumerAllSearch":c.push("search/main");break;case"ConsumerFileSearch":c.push("search/docs");break;case"ConsumerTemplateSearch":c.push("search/templates");break;case"MyContent":c.push("mycontent");var d=e;d.entityId&&(c.push(d.entityId.toLocaleLowerCase()),d.subEntityId&&c.push(d.subEntityId));break;case"Feed":c.push("feed");break;default:c.push("home")}if(e.app&&c.push(p.b[e.app]),"MyForms"===e.route&&c.push("MyForms"),"GroupForms"===e.route&&c.push("GroupForms"),"Content"===e.route&&c.push(this.capabilitiesService.capabilities.wacHostPagePath.replace("/","")),this.capabilitiesService.capabilities.isEmbedMode){var f=c.shift().split("/").join("");c.unshift("/Embed/",f)}return"M365Apps"===e.route?[c,a]:[c.map((function(e){return e.toLowerCase()})),a]}},e.prototype.currentRouteFromPath=function(e){var t,n,i,r,o,a,l,s;if(!e)return null;var c=e.toLowerCase(),u=null,d=null;if(0===c.indexOf("/embed")&&(c=c.replace("/embed","")),"/"===c||0===c.indexOf("/home"))u=this.capabilitiesService.capabilities.pwaEnabled?"Pwa":"OfficeHome";else if(0===c.indexOf("/apps"))u="AppGallery";else if(0===c.indexOf("/search"))u=this.isSiteScopedSearchRoute(c)?"SearchSiteScoped":this.isTopicScopedSearchRoute(c)?"SearchTopicScoped":this.isMeetingScopedSearchRoute(c)?"SearchMeetingScoped":this.isPersonScopedSearchRoute(c)?"SearchPersonScoped":this.isPersonScopedOverviewSearchRoute(c)?"SearchPersonScopedOverview":"Search";else if(0===c.indexOf("/pwa"))u="Pwa";else{if(0===c.indexOf("/m365apps")||this.isMosAppHostedAtRoot(c,!0)){u="M365Apps";var f=0===c.indexOf("/m365apps"),h=(f?e:"/m365apps"+e).split("/").filter((function(e){return!!e}));return{route:u,appId:f?null!==(n=null===(t=h[1])||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:void 0:this.getGuidAppIdFromPath(c),entityId:null!==(i=h[2])&&void 0!==i?i:void 0,subEntityId:null!==(r=h[3])&&void 0!==r?r:void 0}}if(0===c.indexOf("/create"))return{route:u="Create",entityId:null!==(o=(h=e.split("/").filter((function(e){return!!e})))[1])&&void 0!==o?o:void 0,subEntityId:null!==(a=h[2])&&void 0!==a?a:void 0};if(0===c.indexOf("/mycontent"))return{route:u="MyContent",entityId:null!==(l=(h=e.split("/").filter((function(e){return!!e})))[1])&&void 0!==l?l:void 0,subEntityId:null!==(s=h[2])&&void 0!==s?s:void 0};if(0===c.indexOf("/feed"))u="Feed";else{var m=0===c.indexOf(this.capabilitiesService.capabilities.templatePageRootPath.toLowerCase()),b=0===c.indexOf(this.capabilitiesService.capabilities.startPageRootPath.toLowerCase()),g=0===c.indexOf(this.capabilitiesService.capabilities.modernStartPageRootPath.toLowerCase()),v=c.indexOf(this.capabilitiesService.capabilities.wacHostPagePath.toLowerCase())>=0&&(b||g),S=c.toLocaleLowerCase().indexOf("/myforms")>=0&&b,y=c.toLocaleLowerCase().indexOf("/groupforms")>=0&&b;if(m||b||g||v||S||y){var C=c.split("/");u=m?"Templates":v?"Content":S?"MyForms":y?"GroupForms":g?"ModernStart":"Start",d=p.a.fileTypeNameToFileType(C[v||S||y?C.length-2:C.length-1])}}}return u?{route:u,app:d}:null},e.prototype.navigateToInternal=function(e,t,n,i,r){return void 0===t&&(t=!1),void 0===n&&(n={}),void 0===r&&(r=!1),t&&(this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0),i&&e.length&&this.localStorageService.set(i,e[0]),this.router.urlUpdateStrategy=r?"eager":"deferred",this.router.navigate(e,{queryParams:n,replaceUrl:t})},e.prototype.parseState=function(t){var n=t?t.ohpState:null;return n&&n.version!==e.officeRouteStateVersion&&(this.versionMismatch=!0),this.versionMismatch?null:n},e.prototype.updateState=function(e){if(this.historyEnabled){var t=this.windowService.nativeWindow.history.state?Object(i.__assign)({},this.windowService.nativeWindow.history.state):{};t.ohpState=e,this.locationStrategy.replaceState(t,"",this.platformLocation.pathname,this.platformLocation.search+this.platformLocation.hash)}},e.prototype.isSiteScopedSearchRoute=function(e){return e.startsWith("/search/siteall")||e.startsWith("/search/sitenews")||e.startsWith("/search/sitesites")||e.startsWith("/search/sitefiles")||e.startsWith("/search/siteimages")},e.prototype.isTopicScopedSearchRoute=function(e){return e.startsWith("/search/topic")},e.prototype.isMeetingScopedSearchRoute=function(")||e.startsWith("/search/office")||e.startsWionScopedOverviewSearchRoute=function(e){return e.startsWith("/search/overview")},e.prototype.setStickyPageValue=function(e,t){this.capabilitiesService.capabilities.stickyPagesEnabled&&t.app!==p.b.Fluid&&Promise.all([n.e(0),n.e(1),n.e(60),n.e(128)]).then(n.bind(null,"bSht")).then((function(n){var i="StickyPageSet";n.setStickyPage({name:t.route,urlPath:e}).then((function(){Object(a.a)({featureName:"Other",eventName:i,params:{Success:!0}})})).catch((function(e){Object(a.a)({featureName:"Other",eventName:i,params:{Success:!1,ErrorType:"Other",ErrorMessage:"string"==typeof e?e:JSON.stringify(e,Object.getOwnPropertyNames(e))}})}))}))},e.prototype.isMosAppHostedAtRoot=function(e,t){var n=this.capabilitiesService.capabilities.mosAppsHostedAtRoot;if(!e||!n)return!1;var i=e.startsWith("/")?e.split("/")[1]:e;if(i){var r=n.split(",");if(t)return r.includes(i.toLowerCase());var o=Object.keys(u.a).find((function(e){return u.a[e]===i}));return o&&r.includes(o)}return!1},e.prototype.getGuidAppIdFromPath=function(e){var t=e.startsWith("/")?e.split("/")[1]:e;return u.aId=function(e){if(e)return Object.keys(u.a).find((function(t){return u.a[t]===e}))},e.officeRouteStateVersion=1,e.ɵprov=v.kc({factory:function(){return new e(v.lc(r.a),v.lc(f.a),v.lc(d.a),v.lc(m.a),v.lc(S.h)o",se="Latency",ce="ActualSize",ue="Distribution",de="RenderSize",pe="TotalSize"},ZBli:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("pjz5"),r=function(){function e(){}return e.appendQueryParam=function(t,n,i){if(!t||!n)return t;var r={};return r[n]=i,e.appendQueryParams(t,r)},e.appendQueryParams=function(t,n,i){return t?e.appendQuery(t,e.buildQueryPath(n,i)):t},e.appendQuery=function(e,t){if(!e||!t)return e;var n=i.a.getLocation(e),r=n.port,o=n.search;return n.protocol+"//"+n.hostname+(r?":"+r:"")+n.path+(o?o+"&":"?")+t+n.hash},e.appendAndReplaceQueryParams=function(t,n,r,o){if(!t||!n)return t;var a={},l=i.a.getLocation(t),s=l.protocol,c=l.hostname,u=l.path,d=l.search,p=l.hash;for(var f in"?"===d[0]&&d.substring(1).split("&").forEach((function(e){var t=e.split("=");r?a[decodeURIComponent(t[0])]=decodeURIComponent(t[1]):a[t[0]]=t[1]})),n)a[f]=n[f];return e.appendQueryParams(s+"//"+c+u+p,a,o)},e.appendLoginHint=function(t,n,i){return i?e.appendQueryParam(t,"login_hint",n):t},e.removeQueryParams=function(t,n,r){if(!t||!n)return t;var o={},a=i.a.getLocation(t),l=a.protocol,s=a.hostname,c=a.path,u=a.search,d=a.hash;return"?"===u[0]&&u.substring(1).split("&").omponent(t[0]):t[0];n.some((function(e){return e.toLowerCase()===i.toLowerCase()}))||(o[i]=r?decodeURIComponent(t[1]):t[1])})),e.appendQueryParams(l+"//"+s+c+d,o,!1)},e.buildQueryPath=function(e,t){if(!e)return"";var n="";for(var i in e)n=n+(n?"&":"")+i+"="+(t?e[i]?""+e[i]:"":e[i]?""+encodeURIComponent(e[i]):"");return n},e.replacePathAndAddParams=function(t,n,r){var o=r?e.appendAndReplaceQueryParams(t,r,!1):t,a=i.a.getLocation(o),l=a.port;return a.protocol+"//"+a.hostname+(l?":"+l:"")+n+a.search+a.hash},e}()},ZJrL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.parseJsonElementWithId=function(e){var t=document.getElementById(e),n=t&&t.textContent;return n?JSON.parse(n):null},e.decodeJsonString=function(e){var t=e.split('"');return t.forEach((function(e,t,n){var i=decodeURIComponent(e);n[t]=i.on(e,t,n){"use strict";var i;function r(e){var t=parseInt(e);return isNaN(t)?0:t}function o(){if(i)return i;var e=window.navigator.userAgent.toLowerCase(),t={keyword:"Other",platformType:"Other"};[{keyword:"Windows NT",platformType:"PC"},{keyword:"Windows XP",platformType:"PC"},{keyword:"Macintosh",platformType:"Mac"},{keyword:"Windows Phone",platformType:"WindowsPhone",pageName:"windows-phone"},{keyword:"iPad",platformType:"iPad",pageName:"ipad"},{keyword:"iPhone",platformType:"iPhone",pageName:"iphone"},{keyword:"Android",platformType:"AndroidPhone",pageName:"android-phone"},{keyword:"Linux",platformType:"Linux"},{keyword:"CrOS",platformType:"Chromebook"}].some((function(n){return-1!==e.indexOf(n.keyword.toLowerCase())&&(t=n,!0)})),"AndroidPhone"===t.platformType&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:"AndroidTablet",pageName:"android-tablet"});var n={major:0,minor:0,build:0};if("Mac"===t.platformType)(o=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(window.navigator.userAgent))&&o.length>=6&&(n={major:r(o[1]),minor:r(o[3]),build:r(o[5])});else if("PC"===t.platformType||"WindowsPhone"===t.platformType)-1!==e.indexOf("windows xp")?n={major:5,minor:1,build:0}:(o=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(window.navigator.userAgent))&&o.length>=5&&(n={major:r(o[3]),minor:r(o[4]),build:0});else if("iPad"===t.platformType||"iPhone"===t.platformType){var o;n={major:r((o=e.match(/os (\d+)_(\d+)(_(\d+))?/))&&o[1]),minor:r(o&&o[2]),build:r(o&&o[4])}}var a={keyword:"Other",browserType:"Other"};return[{keyword:"PhantomJS",browserType:"Headless"},{keyword:"Edge",browserType:"EdgeLegacy"},{keyword:"MSIE",browserType:"IE"},{keyword:"Edg",browserType:"Edge"},{keyword:"Chrome",browserType:"Chrome"},{keyword:"CriOS",browserType:"Chrome"},{keyword:"Firefox",browserType:"Firefox"},{keyword:"Safari",browserType:"Safari"}].some((function(t){return-1!==e.indexOf(t.keyword.toLowerCase())&&(a=t,!0)})),i={platform:t,platformVersion:n,browser:a}}n.d(t,"a",(function(){return o}))},ZtId:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Zy3K:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("BaAg"),n("4/We"),n("PBJH");var i=function(){function e(e,t){this.capabilitiesService=e,this.locService=t}return e.prototype.ngOnInit=function(){this.createLocation=this.locService.BrandOneDrive,this.createLocationPrompt=this.locService.appResource("CreateNewLocationPrompt",this.app),this.oneDriveColor="#0078D4",this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh},e}()},a3FV:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.ActionsMenuItemClick="Actions_Menu_Item_Click",e.ActionsMenuReactToggle="Actions_Menu_React_Toggle",e.ActionsMenuToggle="Actions_Menu_Toggle",e.ActivityFeedRequest="Activity_Feed_Request",e.ActivitySessionFinished="Activity_Session_Finished",e.ActivitySessionStarted="Activity_Session_Started",e.ActivityStoreRequest="Activity_Store_Request",e.AddToHomeScreenPromptImpressionMobile="Add_To_Home_Screen_Prompt_Mobile",e.AddToHomeScreenPromptImpressionDesktop="Add_To_Home_Screen_Prompt_Impression_Desktop",e.AddToToDoRequest="Add_To_To_Do_Request",e.AddToToDoClick="Add_To_To_Do_Click",e.AdminAcquiredAppsUserDataReadError="AdminAcquiredApps_UserData_Read_Error",e.AdminAcquiredAppsUserDataWriteError="AdminAcquiredApps_UserData_Write_Error",e.AdminPolicyServerRequest="Admin_Policy_Server_Request",e.AdminPolicyCacheRequest="Admin_Policy_Cache_Request",e.AllowFileSystemAccess="Allow_File_System_Access",e.AllTemplatesClick="All_Templates_Click",e.AppAddedToHomeScreen="App_Added_To_Home_Screen",e.AppAddedToHomeScreenMobile="App_Added_To_Home_Screen_Mobile",e.AppAddedToHomeScreenDesktop="App_Added_To_Home_Screen_Desktop",e.AppItemsImpression="App_Items_Impression",e.AnnouncementImpression="Announcement_Impression",e.AppError="App_Error",e.AppBarClick="AppBar_Click",e.AppBarImpression="AppBar_Impression",e.AppBarPinApp="AppBar_Pin_App",e.AppBarRenderError="AppBar_RenderError",e.AppBarUnpinApp="AppBar_Unpin_App",e.AppBarMovePinnedApp="AppBar_Move_Pinned_App",e.AppBarUserDataReadError="AppBar_UserData_Read_Error",e.AppBarUserDataWriteError="AppBar_UserData_Write_Error",e.AppBarFlyoutLinkClick="AppBar_FlyoutLinkClick",e.AppBarFlyoutOpened="AppBar_FlyoutOpened",e.AppGalleryLearnMoreClick="AppGallery_LearnMoreClick",e.AppGalleryPinClick="AppGallery_PinClick",e.AppGalleryUnpinClick="AppGallery_UnpinClick",e.AppGalleryAppsPerWorkspace="AppGallery_AppsPerWorkspace",e.AppGalleryLauncherClick="AppGallery_Launcher_Click",e.AppGalleryCardImpression="AppGallery_Card_Impression",e.AppGalleryClick="AppGallery_Click",e.AppGalleryNavClick="AppGallery_Nav_Click",e.AppGalleryPageView="AppGallery_PageView",e.AppGalleryShowAllClick="AppGallery_ShowAll_Click",e.AppGalleryUninstallClick="AppGallery_UninstallClick",e.AppGalleryAboutClick="AppGallery_AboutClick",e.AppsModuleFeaturedCardClick="AppsModule_FeaturedCard_Click",e.AppInstalledStatus="App_Installed_Status",e.AppListImpression="AppList_Impression",e.AppPinningWizardUserDataReadError="AppPinningWizardUser_UserData_Read_Error",e.AppPinningWizardUserDataWriteError="AppPinningWizardUser_UserData_Write_Error",e.AppPinningWizardBackClick="AppPinningWizard_BackClick",e.AppPinningWizardComplete="AppPinningWizard_Complete",e.AppPinningWizardDismiss="AppPinningWizard_Dismiss",e.AppPinningWizardNextClick="AppPinningWizard_NextClick",e.AppPinningWizardPinClick="AppPinningWizard_PinClick",e.AppPinningWizardUnpinClick="AppPinningWizard_UnpinClick",e.AppServiceConnection="App_Service_Connection",e.AppTileRightClick="App_Tile_Right_Click",e.AppTilesImpression="App_Tiles_Impression",e.AppTilesReady="App_Tiles_Ready",e.AuthStateChanged="Auth_State_Changed",e.BulkLicensePreview="Bulk_License_Preview",e.BulkLicensePreviewReadError="Bulk_License_Preview_Read_Error",e.BulkLicensePreviewRequest="Bulk_License_Preview_Request",e.CalendarClick="Calendar_Click",e.CalendarDayImpression="Calendar_Day_Impression",e.CalendarRequest="Calendar_Request",e.CAPPopup="CAP_Popup",e.CDNFileCheck="CDN_File_Check",e.CheckLoginRequest="Check_Login_Request",e.ClearSWCache="Clear_SW_Cache",e.ConfigRequest="Config_Request",e.ConsumerSkuLoaded="ConsumerSkuLoaded",e.ConsumerUpsellImpression="ConsumerUpsell_InstallImpression",e.ContentActionError="Content_Action_Error",e.ContentActionsMenuToggle="Content_Actions_Menu_Toggle",e.ContentActionsCommandMenuToggle="Content_Actions_Command_Menu_Toggle",e.ContentActionsMenuItemClick="Content_Actions_Menu_Item_Click",e.ContentActionsMenuItemClickLaunchDocument="Content_Actions_Menu_Item_Click_Launch_Document",e.ContentActionInitialization="Content_Action_Initialization",e.ContentActionRegistered="Content_Action_Registered",e.ContentActionSuccess="Content_Action_Success",e.ContentActionCompleted="Content_Action_Completed",e.CreateCenterCreateTilesImpression="Create_Center_Create_Tiles_Impression",e.CreateCenterEnterpriseTemplatesImpression="Create_Center_Enterprise_Templates_Impression",e.CreateCenterTemplatesCollectionsImpression="Create_Center_Templates_Collections_Impression",e.CreateFromDocumentClick="Create_From_Document_Click",e.CreateFromDocumentClickResult="Create_From_Document_Click_Result",e.CreateLinkClick="Create_Link_Click",e.CreateLinkClickResult="Create_Link_Click_Result",e.CreateMenuImpression="Create_Menu_Impression",e.CreateMenuToggle="Create_Menu_Toggle",e.CreateModalImpression="Create_Modal_Impression",e.CreateNewDocumentError="CreateNew_Document_Error",e.CreateNewRedirectFail="Create_New_Redirect_Fail",e.CreateNewRedirectSuccess="Create_New_Redirect_Success",e.CreateOnHomeCreateTilesImpression="Create_On_Home_Create_Tiles_Impression",e.CreateOnHomeSeeMoreClick="Create_On_Home_See_More_Click",e.CreatePanelImpression="Create_Panel_Impression",e.CreateSharingLinkGraphAPI="CreateSharingLink_GraphAPI",e.CreateTemplatesPremiumTemplateClick="CreateTemplatesPremiumTemplateClick",e.CreateTemplatesSeeMoreClick="CreateTemplatesSeeMoreClick",e.CsrfTokenError="Csrf_Token_Error",e.CustomStartDeprecationModalImpression="CustomStart_Deprecation_Modal_Impression",e.DimeCompleted="Dime_Completed",e.DimeTransactionCompleted="DimeTransactionCompleted",e.DimeInitialize="Dime_Initialize",e.DimeLaunch="Dime_Launch",e.DimeLoadScript="Dime_LoadScript",e.DimePreload="Dime_Preload",e.DimeWarmup="Dime_Warmup",e.DimeForceRefreshWorkloadPublicData="Dime_Force_Refresh_WorkloadPublicData",e.DocumentHover="Document_Hover",e.DocumentTitleRenameFile="Document_Title_Rename_File",e.DocumentTitleRenameFileError="Document_Title_Rename_File_Error",e.DTTShellContainerNotFound="Document_Title_Shell_Container_Not_Found",e.EdgeworthBulkCacheRead="EdgeworthBulkCacheRead",e.EdgeworthCacheDeleteError="Edgeworth_Cache_Delete_Error",e.EdgeworthCacheRead="EdgeworthCacheRead",e.EdgeworthCacheWrite="EdgeworthCacheWrite",e.EdgeworthCachedTimestampAccess="EdgeworthCachedTimestampAccess",e.EdgeworthCalloutImpression="Edgeworth_Callout_Impression",e.EdgeworthChangeLayout="Edgeworth_Change_Layout",e.EdgeworthClick="Edgeworth_Click",e.EdgeworthDebugCount="EdgeworthDebugCount",e.EdgeworthDeleteSettingRequest="EdgeworthDeleteSettingRequest",e.EdgeworthDuplicateFilesDetected="EdgeworthDuplicateFilesDetected",e.EdgeworthFilterSelect="Edgeworth_Filter_Select",e.EdgeworthFullSyncRequest="EdgeworthFullSyncRequest",e.EdgeworthHideItemRequest="EdgeworthHideItemRequest",e.EdgeworthImpression="Edgeworth_Impression",e.EdgeworthInitExperience="Edgeworth_Init_Experience",e.EdgeworthParseError="Edgeworth_Parse_Error",e.EdgeworthPinItemRequest="EdgeworthPinItemRequest",e.EdgeworthPivotClick="Edgeworth_Pivot_Click",e.EdgeworthRebuildError="EdgeworthRebuildError",e.EdgeworthRebuildRequired="EdgeworthRebuildRequired",e.EdgeworthRebuildCompleted="EdgeworthRebuildCompleted",e.EdgeworthRequest="EdgeworthRequest",e.EdgeworthSubstrateFavoritesRequest="EdgeworthSubstrateFavoritesRequest",e.EdgeworthSubstrateRecentRequest="EdgeworthSubstrateRecentRequest",e.EdgeworthSubstrateDeltaSyncPageRequest="EdgeworthSubstrateDeltaSyncPageRequest",e.EdgeworthSyncDetails="EdgeworthSyncDetails",e.EdgeworthTextFilterUsed="EdgeworthTextFilterUsed",e.EdgeworthUnhideItemRequest="EdgeworthUnhideItemRequest",e.EdgeworthUnpinItemRequest="EdgeworthUnpinItemRequest",e.EdgeworthUpsertSettingRequest="EdgeworthUpsertSettingRequest",e.EduThemesCalloutImpression="EduThemesCallout_Impression",e.ElementInViewport="Element_In_Viewport",e.EmbedBootstrapEnd="Embed_Bootstrap_End",e.EmbedSwGetTokenError="Embed_Sw_Get_Token_Error",e.ErrorDialogImpression="Error_Dialog_Impression",e.ExpandableListToggle="Expandable_List_Toggle",e.ExpandedWorkspacesRequest="Expanded_Workspaces_Request",e.ExploreAllYourAppsImpression="ExploreAllYourApps_Impression",e.FastSearchPageView="FastSearch_PageView",e.FeaturedDocumentsClick="FeaturedDocuments_Click",e.FeaturedDocumentsErrorImpression="FeaturedDocuments_Error_Impression",e.FeaturedDocumentsImpression="FeaturedDocuments_Impression",e.FeaturedDocumentsRequest="FeaturedDocuments_Request",e.FeaturedDocumentsToggle="FeaturedDocuments_Toggle",e.FeatureGatesRequest="FeatureGates_Request",e.FeatureSettingsRequest="FeatureSettings_Request",e.FeedbackOCVClick="Feedback_OCV_Click",e.FeedbackOCVDismissed="Feedback_OCV_Dismissed",e.FeedbackOCVError="Feedback_OCV_Error",e.FeedbackOCVSubmitted="Feedback_OCV_Submitted",e.FileVersionListFetch="File_Version_List_Fetch",e.FirstRunCompleted="First_Run_Completed",e.FirstRunImpression="First_Run_Impression",e.FirstRunDetermineStateError="FirstRun_DetermineState_Error",e.FirstRunResolveConfigError="FirstRun_ResolveConfig_Error",e.FirstRunSlideStats="First_Run_Slide_Stats",e.FirstRunUpsellClick="First_Run_Upsell_Click",e.FirstSiteVisit="First_Site_Visit",e.FirstTimeMetric="First_Time_Metric",e.FluidContentCreateNew="FluidContent_CreateNew",e.FluidContentError="FluidContent_Error",e.FluidContentOpen="FluidContent_Open",e.FluidContentPageView="FluidContent_PageView",e.FluidContentTimeout="FluidContent_Timeout",e.FluidFileInfoError="Fluid_FileInfo_Error",e.FluidFileLoadError="FluidFileLoad_Error",e.FluidFileLocationInfoError="FluidFile_LocationInfo_Error",e.FluidInformationProtectionError="Fluid_InformationProtection_Error",e.FluidMobileUpsellImpression="Fluid_MobileUpsell_Impression",e.FluidMobileUpsellInstallClick="Fluid_MobileUpsell_Install_Click",e.FluidShareControlError="Fluid_ShareControl_Error",e.FluidShareControlStart="Fluid_ShareControl_Start",e.FluidTokenFetch="Fluid_TokenFetch",e.FluidVersionHistoryDTTClick="Fluid_VersionHistoryDTTClick",e.FocusContextError="Focus_Context_Error",e.FreNewCalloutsEvent="Fre_New_Callouts_Event",e.FreNewCalloutsImpression="Fre_New_Callouts_Impression",e.GalleryCardImpression="Gallery_Card_Impression",e.GalleryNavClick="Gallery_Nav_Click",e.GenericDebugCache="Generic_Debug_Cache_2",e.GenericClick="Generic_Click",e.GenericEvent="Generic_Event",e.GenericImpression="Generic_Impression",e.GenericRequest="Generic_Request",e.GetClassNotebooksRequest="Get_ClassNotebooks_Request",e.GetDownloadUrlError="Get_DownloadUrl_Error",e.GetForm="Get_Form",e.GetOneNotePageRequest="Get_OneNote_Page_Request",e.GetOneNoteSectionsRequest="Get_OneNote_Sections_Request",e.GetSiteTitleRequest="Get_Site_Title_Request",e.GettingToKnowYouNextClick="GettingToKnowYou_Next_Click",e.GettingToKnowYouBackClick="GettingToKnowYou_Back_Click",e.GettingToKnowYouDismissClick="GettingToKnowYou_Dismiss_Click",e.GettingToKnowYouDoneClick="GettingToKnowYou_Done_Click",e.GettingToKnowYouBannerDismissClick="GettingToKnowYou_Banner_Dismiss_Click",e.GetUserReputationTier="Get_User_Reputation_Tier",e.GetWindowsPkid="GetWindowsPkid",e.GroupSideMenuMoveClick="Group_SideMenu_Move_Click",e.EnterpriseTemplatesErrorImpression="Enterprise_Templates_Error_Impression",e.EnterpriseTemplatesImpression="Enterprise_Templates_Impression",e.EnterFocusModeClick="Enter_Focus_Mode_Click",e.InvalidMethod="Invalid_Method",e.FormCreateFormFromTemplate="Form_Create_Form_From_Template",e.FormsFeatureCallout="Forms_Feature_Callout",e.FormsMembersThumbnailFetch="Forms_Members_Thumbnail_Fetch",e.FormsGroupThumbnailFetch="Forms_Group_Thumbnail_Fetch",e.FormsSharedUnpinRequest="Forms_Shared_UnpinRequest",e.FormsCopyRequest="Forms_Copy_Request",e.FormsGroupsRequest="Forms_Groups_Request",e.FormsFromGroupRequest="Forms_From_Group_Request",e.FormsResponses="Forms_Responses",e.FormsThemeRequest="Forms_Theme_Request",e.FormsDeleteRequest="Forms_Delete_Request",e.GroupFormsCreateRequest="Group_Forms_Create_Request",e.FormsGroupMembersRequest="Forms_Group_Members_Request",e.ImpressionsSinceFirstVisit="Impressions_Since_First_Visit",e.InitializeWopiPendingFailed="Initialize_Wopi_Pending_Failed",e.SharedFormsRequest="Shared_Forms_Request",e.MyFormsRequest="My_Forms_Request",e.MyContentLinkClick="My_Content_Link_Click",e.RestoreFormRequest="Restore_Form_Request",e.RecycleFormRequest="Recycle_Form_Request",e.GraphBatchRequest="Graph_Batch_Request",e.GroupItemClick="Group_Item_Click",e.HelpSearchSuggestionRequest="Help_Search_Suggestion_Request",e.HistoryDisabled="History_Disabled",e.HomePageView="Home_PageView",e.IdentityRequest="Identity_Request",e.InputDialogButtonClick="Input_Dialog_Button_Click",e.InstallClick="Install_Click",e.InstallCustomError="Install_Custom_Error",e.InstallGenericError="Install_Generic_Error",e.InstallableAppsRequest="Installable_Apps_Request",e.InstalledAppsFetch="Installed_Apps_Fetch",e.InstalledAppsExFetch="Installed_Apps_Ex_Fetch",e.InstalledAppsExFetchDebug="Installed_Apps_Ex_Fetch_Debug",e.InstalledOfficeDetailsFetch="Installed_Office_Details_Fetch",e.InstallerRequest="Installer_Request",e.InstallScenario="Install_Scenario",e.JoinMeetingClick="Join_Meeting_Click",e.IrisRequest="IrisRequest",e.LaunchByProtocolFailed="Launch_By_Protocol_Failed",e.LaunchFileExplorerFailed="Launch_File_Explorer_Failed",e.LaunchLocalApp="Launch_Local_App",e.LearningShelfAutoCollapsed="LearningShelfAutoCollapsed",e.LearningShelfCardClick="LearningShelfCardClick",e.LearningShelfCardClickError="LearningShelfCardClickError",e.LearningShelfCardInvalid="LearningShelfCardInvalid",e.LearningShelfToggled="LearningShelfToggled",e.LearningShelfCardIrisImpression="LearningShelfCardIrisImpression",e.LearningShelfCardIrisClick="LearningShelfCardIrisClick",e.LeftNavCalloutImpression="Left_Nav_Callout_Impression",e.LeftNavImpression="Left_Nav_Impression",e.LeftNavReady="LeftNav_Ready",e.LocalMruFetch="Local_Mru_Fetch",e.LocalStorageUnavailable="Local_Storage_Unavailable",e.M365AppsDefinitionDeleteRequest="M365_Apps_Definition_Delete_Request",e.M365AppsDefinitionDeleteError="M365_Apps_Definition_Delete_Error",e.M365AppsDefinitionError="M365_Apps_Definition_Error",e.M365AppsDefinitionLookup="M365_Apps_Definition_Lookup",e.M365AppsDefinitionLookupError="M365_Apps_Definition_Retry_Lookup_Error",e.M365AppsDefinitionLookupRequest="M365_Apps_Definition_Not_Found_In_Config_Retrying_Lookup",e.M365AppsParseDomConfigError="M365_Apps_Parse_Dom_Config_Error",e.MarkAsDoneClick="Mark_As_Done_Click",e.MOSAppHostError="MOS_App_Host_Error",e.MOSHubSDK="MOS_HUB_SDK_Request",e.MeetingObjectsNoArtifactsFoundError="Meeting_Objects_No_Artifacts_Found_Error",e.MeetNowButtonImpression="Meet_Now_Button_Impression",e.MeetingInsightsDocClick="Meeting_Insights_Doc_Click",e.MemoryUsage="Memory_Usage",e.MetaTransformCapacityRequest="MeTA_Transform_Capacity_Request",e.MobileAppBannerImpression="Mobile_App_Banner_Impression",e.MobileView="Mobile_View",e.MoveToFolderControlError="Move_To_Folder_Control_Error",e.MoveToFolderControlClick="Move_To_Folder_Control_Click",e.MoveToFolderControlAbandon="Move_To_Folder_Control_Abandon",e.MoveToFolderControlImpression="Move_To_Folder_Control_Impression",e.MoveToFolderControlAuthenticate="Move_To_Folder_Control_Authenticate",e.MoveToFolderControlNavigationStarted="Move_To_Folder_Control_Navigation_Started",e.MoveToFolderControlNavigationEnded="Move_To_Folder_Control_Navigation_Ended",e.MSCreateTemplatesCollectionsRequest="MSCreateTemplates_Collections_Request",e.MruClick="Mru_Click",e.MruDelete="Mru_Delete",e.MruFileItemError="Mru_File_Item_Error",e.MruPathClick="Mru_Path_Click",e.MruUpdatePin="Mru_Update_Pin",e.MruImpression="Mru_Impression",e.MruRequest="Mru_Request",e.MruS2SRequest="Mru_S2S_Request",e.MruWrite="Mru_Write",e.MruWriteError="Mru_Write_Error",e.MsaTokenFetch="Msa_Token_Fetch",e.MyContentChangeLayout="My_Content_Change_Layout",e.NavigateToTemplatesClick="Navigate_To_Templates_Click",e.NewConsumerNoContentImpression="New_Consumer_No_Content_Impression",e.NewPlaylistButtonClick="New_Playlist_Button_Click",e.NewUserShelfImpression="New_User_Shelf_Impression",e.NewScreenRecorderButtonClick="New_Screen_Recorder_Button_Click",e.NewVideoRecorderButtonClick="New_Video_Recorder_Button_Click",e.NewUserShelfClick="New_User_Shelf_Click",e.NotificationServiceError="Notification_Service_Error",e.OfficeConsumerLicenseFetch="Office_Consumer_License_Fetch",e.OfficeConsumerWorkloadPublicDataFetch="Office_Consumer_Workload_Public_Data_Fetch",e.OfficeFeedAction="OfficeFeedAction",e.OfficeFeedInstrumentation="OfficeFeedInstrumentation",e.OfficeFeedDelete="OfficeFeedDelete",e.OfficeFeedRequest="OfficeFeedRequest",e.OfficeFeedStreamThumbnailRequest="OfficeFeed_Stream_Thumbnail_Request",e.OfficeHomeStorageReadRequest="OfficeHomeStorage_Read_Request",e.OfficeHomeStorageWriteRequest="OfficeHomeStorage_Write_Request",e.OfficeInsightsSearchSuggestionRequest="OfficeInsights_Search_Telemetry_Request",e.OfficeLicensesFetch="Office_Licenses_Fetch",e.OneDriveGraphCancelUploadSessionRequest="OneDrive_Graph_Cancel_Upload_Session_Request",e.OneDriveGraphCreateFileRequest="OneDrive_Graph_Create_File_Request",e.OneDriveGraphCreateUploadSessionRequest="OneDrive_Graph_Create_Upload_Session_Request",e.OneDriveGraphItemContentBlobRequest="OneDrive_Graph_Item_ContentBlob_Request",e.OneDriveGraphItemContentRequest="OneDrive_Graph_Item_Content_Request",e.OneDriveGraphItemError="OneDrive_Graph_Item_Error",e.OneDriveGraphItemRequest="OneDrive_Graph_Item_Request",e.OneDriveGraphPatchItemRequest="OneDrive_Graph_Patch_Item_Request",e.OneDriveGraphItemWithWacDataAndThumbRequest="OneDrive_Graph_Item_With_Wac_Data_And_Thumb_Request",e.OneDriveGraphItemWithWacDataRequest="OneDrive_Graph_Item_With_Wac_Data_Request",e.OneDriveGraphMyDriveInfoRequest="OneDrive_Graph_MyDriveInfo_Request",e.OneDriveGraphMyDriveRootURLRequest="OneDrive_Graph_MyDriveRootURL_Request",e.OneDriveGraphRestoreRequest="OneDrive_Graph_Restore_Request",e.OneDriveGraphSharesRequest="OneDrive_Graph_Shares_Request",e.OneDriveGraphSharesWithWacDataRequest="OneDrive_Graph_Shares_With_Wac_Data_Request",e.OneDriveGraphSpecialFolderChildrenRequest="OneDrive_Graph_Special_Folder_Children_Request",e.OneDriveGraphFolderChildrenRequest="OneDrive_Graph_Folder_Children_Request",e.OneDriveGraphStorageRequest="OneDrive_Graph_Storage_Request",e.OneDriveGraphBatchSharesRequest="OneDrive_Graph_Batch_Shares_Request",e.OneDriveGraphThumbnailRequest="OneDrive_Graph_Thumbnail_Request",e.OneDriveGraphThumbnailStringRequest="OneDrive_Graph_Thumbnail_String_Request",e.OneDriveGraphPeoplePictureRequest="OneDrive_Graph_People_Picture_Request",e.OneDriveGraphBatchPeoplePicturesRequest="OneDrive_Graph_Batch_People_Pictures_Request",e.OneDriveGraphUploadFileRequest="OneDrive_Graph_Upload_File_Request",e.OneDriveGraphUploadFragmentRequest="OneDrive_Graph_Upload_Fragment_Request",e.OneDriveGraphUploadStatusRequest="OneDrive_Graph_Upload_Status_Request",e.OneDrivePlacesBadUrl="OneDrive_Places_Bad_Url",e.OneDrivePlacesClick="OneDrive_Places_Click",e.OneDrivePlacesImpression="OneDrive_Places_Impression",e.OneDriveUserRootUrl="OneDrive_User_RootUrl",e.ODSPProvisioningStatus="ODSP_Provisioning_Status",e.ODSPProvisioningFinish="ODSP_Provisioning_Finish",e.ODSPProvisioningGiveUp="ODSP_Provisioning_GiveUp",e.ODSPInstaProvisionedRedirect="ODSP_Insta_Provisioned_Redirect",e.OneNoteGraphCreateNoteBookRequest="OneNote_Graph_Create_NoteBook_Request",e.OneNoteGraphGetNotebooksRequest="OneNote_Graph_Get_NoteBooks_Request",e.OneNoteNotebookCreateLinkClick="OneNote_Notebook_Create_Link_Click",e.OneNotePageCreateLinkClick="OneNote_Page_Create_Link_Click",e.OpenCreateNewNotebookDialog="Open_Create_New_Notebook_Dialog",e.OrionChangeLayout="Orion_OrionChangeLayout",e.OtelInitializationError="OTEL_Initialization_Error",e.OtelReady="OTEL_Ready",e.GroupsImpression="Groups_Impression",e.PerformanceDump="Performance_Dump",e.PerformanceMarkFailure="Performance_Mark_Failure",e.PeopleCardImpression="People_Card_Impression",e.PeopleCardInitialization="People_Card_Initialization",e.PinToTaskbar="Pin_To_Taskbar",e.PrefetchEdgeworthConfigInternalError="PrefetchEdgeworthConfigInternal_Error",e.PrefetchNorthStarError="PrefetchNorthStar_Error",e.PrefetchNorthStarMarkPerformanceError="PrefetchNorthStar_MarkPerformance_Error",e.PrideThemesCalloutImpression="PrideThemesCallout_Impression",e.PrimaryTokenFetchRequest="Primary_Token_Fetch_Request",e.PromotedAppTileImpression="Promoted_App_Tile_Impression",e.PwaBootstrapEnd="Pwa_Bootstrap_End",e.PwaOnActivated="Pwa_On_Activated",e.PwaNavigationFailed="Pwa_Navigation_Failed",e.PwaJumpListItemClick="Pwa_Jump_List_Item_Click",e.PwaJumpList="Pwa_Jump_List",e.PwaSwHandleRegistrationError="Pwa_Sw_Handle_Registration_Error",e.PwaSwGetTokenError="Pwa_Sw_Get_Token_Error",e.QuickAccessChangeLayout="QuickAccess_Change_Layout",e.QuickAccessCreateCustomPivot="QuickAccess_Create_CustomPivot",e.QuickAccessCustomPivotsImpression="QuickAccess_CustomPivots_Impression",e.QuickAccessRemoveCustomPivot="QuickAccess_Remove_CustomPivot",e.QuickAccessShowCustomPivotsMenu="QuickAccess_Show_CustomPivotMenu",e.RecommendedCalloutImpression="Recommended_Callout_Impression",e.RecommendedClick="Recommended_Click",e.RecommendedDelete="Recommended_Delete_Request",e.RecommendedFilesActions="Recommended_Files_Actions",e.RecommendedImpression="Recommended_Impression",e.RecommendedInflationComplete="Recommended_Inflation_Complete",e.RecommendedNavClick="Recommended_Nav_Click",e.RecommendedRequest="Recommended_Request",e.RefreshAccessTokenRequest="Refresh_Access_Token_Request",e.ResourceStringsFetch="Resource_Strings_Fetch",e.ReturningUserCalloutsImpression="Returning_User_Callouts_Impression",e.ScanSessionRequest="Scan_Session_Request",e.SearchAutoSuggestionResultsFetched="Search_Auto_Suggestion_Results_Fetched",e.SearchCapability="Search_Capability",e.SearchClick="Search_Click",e.SearchPageView="Search_PageView",e.SearchPerformance="Search_Performance",e.SearchQuery="Search_Query",e.SearchRenderedResults="Search_Rendered_Results",e.SearchResultsFetched="Search_Results_Fetched",e.SearchSessionStarted="Search_Session_Started",e.SecondRunUpsellClick="Second_Run_Upsell_Click",e.SecondRunDismissClick="Second_Run_Dismiss_Click",e.SessionStorageUnavailable="Session_Storage_Unavailable",e.SettingsRequest="Settings_Request",e.ShareControlAbandon="Share_Control_Abandon",e.ShareControlClick="Share_Control_Click",e.ShareControlError="Share_Control_Error",e.ShareControlImpression="Share_Control_Impression",e.ShareControlStarted="Share_Control_Started",e.SharedWithMeRequest="Shared_With_Me_Request",e.SharePointContextRequest="SharePoint_Context_Request",e.SharePointGetListError="SharePoint_Get_List_Error",e.SharePointIdsRequest="SharePoint_Ids_Request",e.SharePointListItemRequest="SharePoint_List_Item_Request",e.SharePointListsRequest="SharePoint_Lists_Request",e.SharePointMicroserviceUrlsRequest="SharePoint_Microservice_Urls_Request",e.SharePointSiteClick="SharePoint_Site_Click",e.SharePointSitesImpression="SharePoint_Sites_Impression",e.SharePointWebsocketRequest="SharePoint_Websocket_Request",e.SharePointSitesRequest="SharePoint_Sites_Request",e.ShellBootstrapperError="Shell_Bootstrapper_Load_Error",e.ShowMoreTilesImpression="ShowMoreTiles_Impression",e.ShowStorageErrorDialog="ShowStorageErrorDialog",e.SimplePersistenceReadError="Simple_Persistence_Read_Error",e.SimplePersistenceWriteError="Simple_Persistence_Write_Error",e.SplitButtonToggle="Split_Button_Toggle",e.SuggestedActionClick="Suggested_Action_Click",e.SupportCentralError="Support_Central_Error",e.SupportCentralImpression="Support_Central_Impresion",e.SupportCentralInit="Support_Central_Init",e.SupportCentralLoaded="Support_Central_Loaded",e.SupportCentralStart="Support_Central_Start",e.SurfaceDeviceDetectionError="Surface_Device_Detection_Error",e.SwActivated="Sw_Activated",e.SwApiMissingTokenError="Sw_ApiMissingToken_Error",e.SwApiMissingUserIdError="Sw_ApiMissingUserId_Error",e.SwApiNetworkRequestError="Sw_ApiNetworkRequest_Error",e.SwApiRequestHandlingError="Sw_ApiRequestHandling_Error",e.SwApiTimeoutError="Sw_ApiTimeout_Error",e.SwAppWarmupTimeoutError="Sw_AppWarmupTimeout_Error",e.SwPrecacheAssetError="Sw_PrecacheAsset_Error",e.SwPrecacheCountMismatchError="Sw_PrecacheCountMismatch_Error",e.SwayCreateRequest="Sway_Create_Request",e.SwayCreateStoryAndPublishDocumentRequest="Sway_Create_Story_And_Publish_Document_Request",e.SwayGetAnalytics="Sway_Get_Analytics_Request",e.SwayGetThumbnailRequest="Sway_Get_Thumbnail_Request",e.TeamsAccessTokenRequest="Teams_Access_Token_Request",e.TellMeSearchSuggestionRequest="TellMe_Search_Suggestion_Request",e.TuiActionButtonClick="Tui_Action_Button_Click",e.TuiCompleted="Tui_Completed",e.TuiDismissed="Tui_Dismissed",e.TuiLinkClick="Tui_Link_Click",e.TemplateClick="Template_Click",e.TemplateClickResult="Template_Click_Result",e.TemplateLibrariesRequest="Template_Libraries_Request",e.TemplatesCollectionClick="Templates_Collection_Click",e.TemplatesCollectionsRequest="Templates_Collections_Request",e.TemplateContentRequest="Template_Content_Request",e.TemplatesRecommendedRequest="Templates_Recommended_Request",e.TemplatesGraphGetRequest="Templates_Graph_Get_Request",e.TemplatesErrorImpression="Templates_Error_Impression",e.TemplatesImpression="Templates_Impression",e.TemplatesPageView="Templates_PageView",e.TemplatesRequest="Templates_Request",e.TemplatesToggle="Templates_Toggle",e.ThumbnailLoad="Thumbnail_Load",e.ThumbnailCachePipeLoad="Thumbnail_Cache_Pipe_Load",e.TileToggleOpen="Tile_Toggle_Open",e.TileToggleSelect="Tile_Toggle_Select",e.ToastClick="Toast_Click",e.TokensConfigMissing="Tokens_Config_Missing",e.TrendingAroundMeRequest="Trending_Around_Me_Request",e.UnexpectedHistoryState="Unexpected_History_State",e.UnhandledException="Unhandled_Exception",e.UnifiedDocumentBootEnd="UnifiedDocumentBootEnd",e.UnifiedDocumentBootError="UnifiedDocumentBootError",e.UnifiedDocumentBootErrorExpected="UnifiedDocumentBootErrorExpected",e.UnifiedStorageRequest="Unified_Storage_Request",e.UnknownTheme="Unknown_Theme",e.UpgradeDialogAppDefinitionNotFound=" Upgrade_Dialog_AppDefinition_Not_Found",e.UploadButtonImpression="Upload_Button_Impression",e.UploadButtonDragAndDropCalloutImpression="Upload_Button_DragAndDrop_Callout_Impression",e.UploadClick="Upload_Click",e.UploadCompleted="Upload_Completed",e.UploadDialogImpression="Upload_Dialog_Impression",e.UploadLocalError="Upload_Local_Error",e.UpsellButtonClick="Upsell_Button_Click",e.UpsellButtonImpression="Upsell_Button_Impression",e.UpsellDialogImpression="Upsell_Dialog_Impression",e.UpsellDialogClose="Upsell_Dialog_Close",e.UserEntitlementsRequest="UserEntitlements_Request",e.ViewInToDoClick="View_In_To_Do_Click",e.VisioLicenseStatus="Visio_License_Status",e.VisioTemplatesRequest="Visio_Templates_Request",e.VisioSearchRequest="Visio_Search_Request",e.VisualBackgroundImageError="Visual_Background_Image_Error",e.VroomActivityRequest="Vroom_Activity_Request",e.VroomCreateFileRequest="Vroom_Create_File_Request",e.VroomCreateLinkRequest="Vroom_Create_Link_Request",e.VroomCreateUploadSessionRequest="Vroom_Create_Upload_Session_Request",e.VroomGetFluidEnabled="Vroom_Get_Fluid_Enabled_Request",e.VroomItemRequest="Vroom_Item_Request",e.VroomItemWithWacDataRequest="Vroom_Item_With_Wac_Data_Request",e.VroomOneDriveCheckAccessRequest="Vroom_OneDrive_Item_Check_Access_Request",e.VroomSharesRequest="Vroom_Shares_Request",e.VroomSharesWithWacDataRequest="Vroom_Shares_With_Wac_Data_Request",e.VroomThumbnailRequest="Vroom_Thumbnail_Request",e.VroomUploadFileRequest="Vroom_Upload_File_Request",e.WacBootstrapInfoRequest="Wac_Bootstrap_Info_Request",e.WacContentError="WacContent_Error",e.WacContentPageView="WacContent_PageView",e.WacDocumentAbandon="WacDocument_Abandon",e.WacDocumentLoadStart="WacDocument_Load_Start",e.WacDocumentLoaded="WacDocument_Loaded",e.WacDocumentPreboot="WacDocument_Preboot",e.WacDocumentPreload="WacDocument_Preload",e.WacDocumentJsApiError="WacDocument_JsApi_Error",e.WacDocumentJsApiTimeout="WacDocument_JsApi_Timeout",e.WacDocumentVroomError="WacDocument_Vroom_Error",e.WacDocumentBootstrapperLoadError="WacHost_Bootstrapper_Load_Error",e.WacDocumentGenericBootError="WacDocument_Generic_Boot_Error",e.WacPageAction="WacPageAction",e.WacStartPageView="WacStart_PageView",e.WamTokenRequestInitiated="WAM_Token_Request_Initiated",e.WamTokenRequest="WAM_Token_Request",e.WamTokenExpired="WAM_Token_Expired",e.WebVitalsError="WebVitals_Error",e.WopiDataFetchFailed="Wopi_Data_Fetch_Failed"}(i||(i={}))},aQ3G:function(e,t,n){"use sQjXU"),r=n("pOWU"),o=function(){function e(){this.cachedResponsePromises=new Map}return e.prototype.set=function(e,t,n,i){var r=this.key(t,n,i);this.cachedResponsePromises.set(r,e)},e.prototype.has=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.has(i)},e.prototype.get=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.get(i)},e.prototype.delete=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.delete(i)},e.prototype.key=function(e,t,n){return(t?"beta":"v1.0")+"/"+n+"/"+e},e}(),a=function(e){function t(t,n,i,r,a,l,s,c){var u=e.call(this,t,n,i,"Graph",r,a,l,c)||this;u.globalErrorHandler=s,u.cachedResponsePromises=new o;var d=r.sharedContext;return u.graphServiceHost=u.inMockMode?d.officeHomeApiRoot:d.graphApiRoot,u.requestConfig={headers:new Map},u}return Object(i.__extends)(t,e),t.prototype.getGraph=function(t,n,i,o,a,l,s,c,u,d,p,f,h){var m=this;if(void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===f&&(f=null),void 0===h&&(h=!1),!h&&this.cachedResponsePromises.has(i,d,o))return this.cachedResponsePromises.get(i,d,o);var b=new Promise((function(h,b){var g=m.getGraphServiceEndpoint(i,d);g||b(new r.b(null,"Graph service endpoint url is not defined"));var v=m.getRequestConfig();v.responseType=void 0!==p?p:"json",e.prototype.get.call(m,t,n,g,(function(e){e.instrument((function(e,t){t.RequestId=m.getRequestIdFromResponse(e),a&&a(e,t)})).then((function(e){return h(e)})).catch((function(e){m.globalErrorHandler.handleError(e,"XDHsY")}))}),(function(e){l&&m.cachedResponsePromises.delete(i,d,o),b(e)}),v,o,s,c,u,void 0,void 0,f)}));return l&&this.cachedResponsePromises.set(b,i,d,o),b},t.prototype.postGraph=function(t,n,i,r,o,a,l,s,c,u,d,p,f,h){void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===f&&(f=null),void 0===h&&(h=void 0);var m=this.getetRequestConfig();return void 0!==h&&h.forEach((function(e,t){b.headers.set(t,e)})),e.prototype.post.call(this,t,n,m,r,o,a,b,l,s,c,u,void 0,null,null,null,p,f)},t.prototype.putGraph=function(t,n,i,r,o,a,l,s,c,u,d){void 0===d&&(d=!1);var p=this.getGraphServiceEndpoint(i,d);return e.prototype.put.call(this,t,n,p,r,o,a,this.getRequestConfig(),l,s,c,u)},t.prototype.patchGraph=function(t,n,i,r,o,a,l,s,c,u,d,p,f,h){void 0===h&&(h=!1);var m=this.getGraphServiceEndpoint(i,h),b=l||this.getRequestConfig();return e.prototype.patch.call(this,t,n,m,r,o,a,b,s,c,u,d,p,f)},t.prototype.handleQueryParam=function(e,n,i){"mockgraph"===e&&(null==i||i.headers.set(t.mockGraphHeader,n))},t.prototype.getRequestConfig=function(e){return void 0===e&&(e={}),Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},this.requestConfig),{headers:new Map(this.requestConfig.headers)}),e)},t.prototype.getGraphServiceEndpoint=function(e,n){return void 0===n&&(n=!1),this.graphServiceHost?this.graphServiceHost+"/"+(n?t.graphBeta:t.graphV1)+"/"+e:""},t.graphV1="v1.0",t.graphBeta="beta",t.mockGraphHeader="ohp-mock-graph",t}(r.a)},adMn(){return i}));var i=function(){function e(e){this.action=e,this.hoverDelay=100}return e.prototype.onMouseEnter=function(){var e=this;this.enabled()&&(this.hoverTimeouon(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)},e}()},b7yv:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("7Gwk"),l=n("4/We"),s=n("keVe"),c=function(){function e(e,t,n){this.configParserService=e,this.capabilitiesService=t,this.eventService=nigPromise){var t=function(){return e.configParserService.parse("firstRunConfig")};if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=Promise.resolve(t());else{var n=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise();this.configPromise=n.then(t)}}return this.configPromise},e.ɵprov=s.kc({factory:function(){return new e(s.lc(o.a),s.lc(l.a),s.lc(a.a))},token:e,providedIn:"root"}),e}()},bN1B:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var i=n("QjXU")(){},l=funcurn n&&t.push(n),e},unregister:function(e){var n=t.indexOf(e);neFeedbackObject:function(n){Object.assign(e,n),t.forEach((function(t){return t(e)}))}}}(),s=function(e){var t;return e&&(t=document.getElementById(e)),t||(t=document.getElementById(o.a)),t||((t=document.createElement("div")).id=o.a,document.body.appendChild(t)),t},c=function(e){!function(){Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n,c,u,d;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return a(),(t=document.getElementById("fluent-default-layer-host"))&&(null===(d=t.parentNode)||void 0===d||d.removeChild(t)),n=e.hostName,c=e.language,u=e.inAppFeedbackRef,[4,Object(r.b)({centroEnvironmentBaseUrl:"https://admin.microsoft.com",preConfig:{hostName:n,locale:c,perfPrefix:"OcvFeedback".concat(n)},centroHvcData:"",forHostVersion:"v2",hvcVersion:""}).catch((function(e){console.info("Failed to initialize centro",eName:o.d,aons",l)}}}).catch((function(e){console.info("Failed to preload centro feature",e)}))];case 2:return i.sent(),[4,Object(r.a)({featureName:o.d})];case 3:return[4,i.sent().main(s(u))];case 4:return a=i.sent(),[2]}}))}))}()},u=l.updateFeedbackObject},bN7T:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l}));var i=n("QjXU");function r(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__;return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}function a(e,t,n,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){var l,s,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,a(JSON.stringify(e))];case 1:return l=i.sent(),[4,r(n)];case 2:return s=i.sent(),[4,n.subtle.encrypt({name:"AES-GCM",iv:s,tagLength:128},t,l)];case 3:return c=i.sent(),[2,o(s.buffer,c)]}}))}))}function l(e,t,n,r,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,l,s,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return a=e.slice(0,12),l=e.slice(12,e.byteLength),[4,n.subtle.decrypt({name:"AES-GCM",iv:a,tagLength:128},t,l)];case 1:return s=i.sent(),[4,r(new Uint8Array(s))];case 2:return c=i.sent(),[2,JSON.parse(c,o)]}}))}))}},cAxl:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("3bNC");var i=function(){function e(e){this.graphPictureService=e,this.fetchImage=!0,this.isUpcomingMeeting=!1,this.status="None",this.hasPadding=!1,this.personPictureCard=!1,this.iconSize=this.iconSize||30}return e.prototype.ngOnChanges=function(){var e;if(this.fetchImage){var t=this.pictureId||(null===(e=this.person)||void 0===e?void 0:e.email);this.imageBase64Promise=t?this.graphPictureService.getPeoplePicture(t,this.iconSize<=48?"48x48":void 0):Promise.resolve(null)}else this.imageBase64Promise=Promise.resolve(this.imageBase64)},e}()},cZRF:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("QjXU"),r=n("kMgc"),o=n("bN7T"),a=n("jsgn"),l=n("FHrx"),s=n("COYM"),c=n("keVe"),u=function(){function e(e,t){this.webCryptoService=e,n(){return this._keyPromise||(this._keyPromise=this.importKey()),this._keyPromise},enumerable:!0,configurable:!0}),e.prototype.importKey=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Object(a.a)(this.encryptionConfigService.config.cryptoKey,this.webCryptoService.crypto.subtle)]}))}))},e.ɵprov=c.kc({factory:function(){return new e(c.lc(s.b),c.lc(l.a))},token:e,providedIn:"root"}),e}(),d=function(){function e(e,t,n){this.encodingService=e,this.encryptionKeyService=t,this.webCryptoService=n}return e.prototype.encryptData=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.encryptionKeyService.key];case 1:return t=i.sent(),[2,Object(o.b)(e,t,this.webCryptoService.crypto,(function(e){return n.encodingService.encode(e)}))]}}))}))},e.prototype.decryptData=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.encryptionKeyService.key];case 1:return n=i.sent(),[2,Object(o.a)(e,n,this.webCryptoService.crypto,(function(e){return r.encodingService.decode(e)}),t)]}}))}))},e.ɵprov=c.kc({factory:function(){return new e(c.lc(r.a),c.lc(u),c.lc(s.b))},token:e,providedIn:"root"}),e}()},caHY:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var i=["chat","onedrive","testapp"],r={chat:"d870f6cd-4aa5-4d42-9626-ab690c041429",testapp:"07b75f22-72b5-4063-b7fc-0ed5ea8ff3ff",onedrive:"377c982d-9686-450e-9a7c-22aeaf1bc162"}},casz:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("QjXU"),r=n("UY9y"),o=n.n(r),a=n("lrJm"),l=n("x+6c"),s=n("WLAd"),c=n("Uqr9"),u=n("BMb5"),d=n("keVe"),p=function(){function e(e,t,n,i,r){var a=this;this.idleCallbackService=e,this.errorHandler=t,this.pageVisithis.performanceService=r,this.heap=new o.a([],(function(e,t){return a.compare(e,t)})),this.isProcessing=!1,this.shouldLogFirstIdle=this.pageVisibilityService.isVisible(),this.shouldLogFirstSchedule=!0,this.setOnVisibilityChange(),this.setOnGlobalWindow()}return e.prototype.scheduleWork=function(e,t){if(0===t)return e(),this.createNoopHandle();this.shouldLogFirstSchedule&&(this.shouldLogFirstSchedule=!1,this.performanceService.mark("First_Schedule"));var n={work:e,priority:t,cancelled:!1,completed:!1},i=this.cre,this.dequeueWhenIdle(),i},e.prototype.hasTasks=function(){return!!this.heap.peek()},Object.defineProperty(e.prototype,"FCI",{get:function(){return void 0!==this.firstIdle?this.firstIdle:-,e.prototype.createHandle=function(e){var t=this,n=function(){return e.cancelled=!0};return{cancel:n,cancelAndRunNow:function(){e.cancelled||(n(),e.completed||(e.work(),e.completed=!0))},adjustPriority:function(i){return n(),e.completed?t.createNoopHandle():t.scheduleWork(e.work,i)}}},e.prototype.createNoopHandle=function(){return{cancel:function(){return null},cancelAndRunNow:function(){return null},adjustPriority:function(){return null}}},e.prototype.dequeueWhenIdle=function(){var e=this;this.pageVisibilityService.isVisible()?this.idleCallbackHandle||(this.idleCallbackHandle=this.idleCallbackService.runWhenIdle((function(t){e.shouldLogFirstIdle&&(e.shouldLogFirstIdle=!1,e.firstIdle=c.a.now(),e.performanceService.mark("First_Idle")),e.idleCallbackHandle=null,e.doWork(t)}))):this.doWork()},e.prototype.doWork=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(this.isProcessing)return[2];this.isProcessing=!0,i.label=1;case 1:if(this.pageVisibilityService.isVisible()&&!(e&&e.timeRemaining()>0))return[3,6];if(!(t=this.heap.pop()))return[3,6];if(t.cancelled)return[3,1];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.work(e)];case 3:return i.sent(),t.completed=!0,[3,5];case 4:return n=i.sent(),this.errorHandler.handleError(n,"DXUlK"),[3,5];case 5:return[3,1];case 6:return this.isPrype.compare=function(e,t){retuototype.setOnGlobalWindow=function(){this.windowService.nativeWindow.scheduler=this},e.prototype.setOnVisibilityChange=function(){var e=this;this.pageVisibilityService.addOnVisibilityChanged((function(t){"hidden"===t&&(e.shouldLogFirstIdle=!1,e.idleCallbackHandle&&(e.idleCallbackService.cancelIdleCallback(e.({factory:function(){return new e(d.lc(l.a),d.lc(a.b),d.lc(s.a),d.lc(u.b),d.lc(c.b))},token:e,providedIn:"root"}),e}()},cenr:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("8/lW"),r=n("a3FV"),o=n("4CZh");function a(e,t,n,a){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===a&&(a=i.a.Security),Object(o.b)(e,r.a.GenericEvent,a,t,n,!0)}},cgnd:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p}));var i,r,o,a=n("lrJm"),l=n("dFxn"),s=n("ZJrL"),c=n("DAwf"),u=n("keVe");function d(e){if(!r){r=!0;try{o=e?e.parse("clientStartupConfiguration"):s.a.parseJsonElementWithId("clientStartupConfiguration")}catch(e){throw new a.a("Failure to parse clientStartupConfiguration from response",e)}if(!o)throw new a.a("clientStartupConfiguration is not present in response");var t=o.authTypeString;"MSA"===t?(o.authType=i.MSA,window.pwaCurrentUserId&&0===window.pwaCurrentUserId.indexOf("consumers_")&&(o.puid=window.pwaCurrentUserId.substring("consumers_".length)),window.userPrincipalName&&(o.userPrincipalName=window.userPrincipalName,o.loginHint=window.userPrincipalName)):o.authType="OrgId"===t?main),o}!function(e){e[e.MSA[e.Unknown=-1]="Unknown"}(i||(i={}));var p=function(){function e(e){this.config=d(e)}return e.ɵprov=u.kc({factory:function(){return new e(u.lc(l.a))},token:e,providedIn:"root"}),e}()},ci1G:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},cj6A:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("QjXU"),r=n("4/We"),o=n("hZW2"),a=n("casz"),l=n("keVe"),s=function(){function e(e,t,n,i){this.capabilitiesService=e,this.documentService=t,this.ngModuleLoader=n,this.scheduler=i,this.routeModuleMap=new Map([["Start","./start-page-wrapper/start-page-wrapper.module#StartPageWrapperModule"],["AppGallery","./app-gallery/app-gallery.module#AppGalleryModule"],["Templates","./templates-page-wrapper/templates-page-wrapper.module#TemplatesPageWrapperModule"]]),this.preloadedRoutes=new Set,this.prefetchedDns=new Set}return e.prototype.preload=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e?this.isOfficeRoute(e)&&this.routeModuleMap.has(e)?[4,this.preloadRoute(e)]:[3,2]:[2];case 1:return t.sent(),[3,3];case 2:e.startsWith("htt3:return[2]}}))}))},e.prototype.isOfficeRoute=function(e){return!e.startsWith("http")},e.prototype.preloadRoute=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return"Start"!==e||this.capabilitiesService.capabilities.wacStartPageeloadedRoutes.add(e),[4,new Promise((function(e){return t.scheduler.scheduleWork(e,3)}))]):[2];case 1:return n.sent(),[4,this.ngModuleLoader.load(this.routeModuleMap.get(e))];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.prefetchDns=function(e){if(!this.prefetchedDns.has(e)){this.prefetchedDns.add(e);var t=new Map([["rel",".ɵprov=l.kc({factory:function(){return new e(l.lc(r.a),l.lc(o.a),l.lc(l.C),l.lc(a.a))},token:e,providedIn:"root"}),e}()},clUe:function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var i=n("QjXU"),r=n("j7b/"),o=n("m32Q"),a=n("lkvL"),l=n("lwUs"),s=n("tyUq"),c=n("lrJm"),u=n("iX+N"),d=n("3GGT"),p=n("hhzZ"),f=n("R7NL"),h=n("Vwd8"),m=n("BaAg"),b=n("kpuN"),g=n("6nG3"),v=n("W3Zz"),S=n("Z0U4"),y=n("wwmn"),C=n("casz"),w=n("ZtId"),T=n("Brer"),k=n("pOWU"),I=n("4/We"),_=n("cgnd"),A=n("LQqy"),P=n("/I02"),E=n("PBJH"),O=n("JH4S"),F=n("Hp80"),D=n("oAX+"),M=n("idgT"),R=n("keVe"),x=n("TOqr"),L=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S,y,C,w){var T=e.call(this,t,s,c,"OfficeHome",o,u,p,y)||this;return T.capabilitesService=n,T.clientStartupConfigService=i,T.consumerInstallConfigService=r,T.deviceDetector=a,T.globalErrorHandler=l,T.officeRouteService=d,T.startupConfigService=f,T.templatesConfig=h,T.updateContentService=m,T.userContextService=b,T.userProfileService=g,T.consumerPublicDataService=v,T.locService=S,T.vroomService=C,T.wacStartConfigService=w,T.locale=o.sharedContext.officeMarket.toLowerCase(),T.numTemplates=T.templatesConfig.config.numTemplates,T.initializeTemplateCache(),T.requestConfig={headers:new Map},T.templatesStreamMap=new Map,T.enterpriseTemplatesStreamMap=new Map,T.templatesContentStreamMap=new Map,T.deviceInfo=T.deviceDetector.getDeviceInfo(),T}return Object(i.__extends)(t,e),t.prototype.getTemplateContent=function(e,n,i){var r=this;if(this.templatesContentStreamMap.has(e)&&this.templatesContentStreamMap.get(e).has(i))return this.templatesContentStreamMap.get(e).get(i);var o=this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_CONTENT_PATH)+"&"+t.templateIdArg+n+"&"+t.templateBinaryUrlArg+i,a=this.fetchTemplateContentData(e,o,n,"cache-only"),l=this.fetchTempon(t){r.templatesContentStreamMap.get(e)&&r.templatesContentStreamMap.get(e).delete(i)}));return this.templatesContentStreamMap.get(e)||this.templatesContentStreamMap.set(e,new Map),this.templatesContentStreamMap.get(e).set(i,s),s},t.prototype.getVisioLocalizationLabel=function(e){return this.locService[m.b[e]+"TemplateLabel"]},t.prototype.getTemplatesCollections=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,l,c,u,p=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e&&e.length>0))return[3,8];n=[],r=[],l={},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Promise.all(e.map((function(e){return Object(o.a)({userId:p.clientStartupConfigService.config.puid,collectionName:t.templatesCollectionPersistenceKey,collectionVersion:t.templatesCollectionPersistenceVersion,key:p.getCacheKey(e),plugins:t.templatesPersistencePlugins})})))];case 2:for(n=i.sent(),u=0;u<e.length;++u)n[u]?l[e[u]]=n[u]:r.push(e[u]);return 0===r.length?(Object(s.a)({eventName:"Templates_Collections",httpCode:d.a.OK,fromCache:!0,latency:-1}),[2,n]):[3,4];case 3:return i.sent(),r=e,[3,4];case 4:return i.trys.push([4,6,,7]),[4,this.fetchTemplatesCollections(r.join(","))];case 5:for((c=i.sent()).forEach((function(e){e&&e.Templates&&e.Templates.Template&&e.Templates.Template.length>0&&Object(a.a)({userId:p.clientStartupConfigService.config.puid,collectionName:t.templatesCollectionPersistenceKey,collectionVersion:t.templatesCollectionPersistenceVersion,key:p.getCacheKey(e.CollectionId),data:e,plugins:t.templatesPersistencePlugins})})),u=0;u<r.length;++u)l[r[u]]=c[u];return[2,e.map((function(r((function(e){return!!e}))];case 6:return i.sent(),[2,n.filter((function(e){return!!e}))];case 7:return[3,9];case 8:return[2,[]];case 9:return[2]}}))}))},t.prototype.getTemplatesRecommended=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e&&e.length>0))return[3,8];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(o.a)({userId:this.clientStartupConfigService.config.puid,collectionName:t.templatesRecommendedPersistenceKey,collectionVersion:t.templatesRecommendedPersistenceVersion,key:this.getCacheKey(e),plugins:t.templatesPersistencePlugins})];case 2:return(n=i.sent())?[2,n]:[3,4];case 3:return i.sent(),[3,4];case 4:r=this.getTemplatesRecommendedUrl(e),i.label=5;case 5:return i.trys.push([5,7,,8]),[4,this.fetchTemplatesRecommended(e,r)];case 6:return(l=i.sent())&&l.Template&&l.Template.length&&Object(a.a)({userId:this.clientStartupConfigService.config.puid,collectionName:t.templatesRecommendedPersistenceKey,collectionVersion:t.templatesRecommendedPersistenceVersion,key:this.getCacheKey(e),data:l,plugins:t.templatesPersistencePlugins}),[2,l];case 7:return i.sent(),[3,8];case 8:return[2,null]}}))}))},t.prototype.getTemplates=function(e){var t=this;if(this.templatesStreamMap.has(e))return this.templatesStreamMap.get(e);var n=this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint),i=this.fetchTemplateData(e,n,"cache-only"),r=this.fetchTemplateData(e,n,"netwothis.getUpdateStreamKey(n),(function(){return t.fetchTemplateData(e,n,"network-first")})),a=D.a.createResultsWithCacheObservable(i,r,o,(function(n){return t.templatesStreamMap.delete(e)}));return this.templatesStreamMap.set(e,a),a},t.prototype.updateTemplates=function(e){return this.templatesFromConfig.delete(e),this.templatesStreamMap.delete(e),this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint)))},t.prototype.getCreateTemplates=function(){var e=this;if(this.createTemplatesStream)return this.createTemplatesStream;var n=this.startupConfigService.config.authType===_.a.OrgId?2:1,i=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),r="&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.flightsArg+i+"&"+t.authIdArg+n+"&"+t.pageArg+"Other&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.browserNameArg+v.a[this.deviceInfo.browser.browserType]+"&"+t.osNameArg+v.e[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion+"&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment,o=this.contextService.sharedContext.officeHomeApiRoot+"/"+this.templatesConfig.config.templatesApiEndpoint+"?"+t.appArg+"Create&"+t.cultureArg+this.locale+"&"+t.limitArg+"20&"+t.isEduArg+this.userContextService.user.isEdu+r,a=this.fetchTemplateData(m.b.None,o,"cache-only"),l=this.fetchTeteResultsWithCacheObservable(a,l,null,(function(t){return e.createTemplatesStream=null}));return this.createTemplatesStream=s,s},t.prototype.getEnterpriseTemplates=function(e,n,i){var r=this;void 0===n&&(n=""),void 0===i&&(i=!1);var o=e.concat(n);if(this.enterpriseTemplatesStreamMap.has(o))return this.enterpriseTemplatesStreamMap.get(o);var a=function(e,n){var o=[];return e&&(o=e.value.filter((function(e){return t.supportedEnterpriseFileTypes.has(m.a.getFileExtension(e.name))||e.folder})).map((function(e){var t=[];if(e.thumbnails.length>0){var n=e.thumbnails[0];t.push(i?{Size:"large",Height:n.large.height,Width:n.large.width,Url:n.large.url,ImageType:"MT"}:{Size:"medium",Height:n.medium.height,Width:n.medium.width,Url:n.medium.url,ImageType:"MT"})}return{AssetId:e.id,Title:e.name,TemplateBinaryUrl:r.capabilitesService.capabilities.pwaEnabled?e.webDavUrl:e.webUrl,Thumbnails:t}}))),{Template:o,fromCache:n}},l=this.vroomService.getDriveItemChildrenWithThumbnails(e,n,"cache-only").then((function(e){return a(e,!0)})),s=this.vroomService.gnails(e,n,"network-first","BrowseOrgTemplates","AUO").then((function(e){return a(e,!1)})),c=D.a.createResultsWithCacheObservable(l,s,null,(function(e){return r.enterpriseTemplatesStreamMap.delete(o)}));returnIdFromOmexResponse=function(e){return this.getHeaderValue(e.headers,"x-ms-request-id")},t.prototype.getEnterpriseTemplatesLibraries=function(){return this.enterpriseTemplateLibraries||(this.enterpriseTemplateLibraries=this.vroomServicet=[];return e&&(t=e.value.map((function(e){return{DriveId:e.id,ItemId:"",Title:e.name}}))),t}))),this.enterpriseTemplateLibraries},t.prototype.isPaidConsumer=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.clientStartupConfigService.config.authType!==_.a.MSA?[3,3]:[4,this.consumerInstallConfigService.getCurrentSku()];case 1:return e=t.sent(),[4,this.hasBusinessLicense()];case 2:return[2,t.sent()||null!==e&&!(e===g.b.NonActive||e===g.b.NotSubscribed||e===g.b.NotDetected||e===g.b.Perpetual||e===g.b.Perpetual2019)];case 3:return[2,!1]}}))}))},t.prototype.handleQueryParam=function(e,t){"mocktemplates"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)},t.prototype.hasBusinessLicense=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return this.capabilitesService.capabilities.workloadPublicDataEnabled?[4,this.consumerPublicDataService.getConfig()]:[2,!1];case 1:return[2,e.sent().hasBusinessLicense]}}))}))},t.prototype.fetchTemplateContentData=function(e,t,n,r){var o=this;return new Promise((function(a,l){return Object(i.__awaiter)(o,void 0,void 0,(function(){var o,s=this;return Object(i.__generator)(this,(function(i){return o=m.a.fileTypeNameFromType(e),this.get("Template_Content_Request","Template_Content",t,(function(e){e.instrument((function(e,t){e.ok&&(e.data?(t.ItemCategory=o,t.ElementId=n):t.HttpCode=d.a.UnexpectedResponse.toString())})).then((function(e){e.data?a(e):l(new k.b(e,"Null template content response"))})).catch((function(e){s.globalErrorHandler.handleError(e)}))}),l,this.requestConfig,r),[2]}))}))}))},t.prototype.fetchTemplatesCollections=function(e){var t=this,n=this.getTemplatesCollectionUrl(e);return new Promise((function(r,o){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(i){return this.get("Templates_Collections_Request","Templates_Collections",n,(function(n){n.instrument((function(t,n){var i;if(t.ok)if(t.data&&t.data.Collections&&t.data.Collections.length>0){var r=null===(i=t.data.Collections[0].Templates)||void 0===i?void 0:i.RequestId;n.ActualSize=t.data.Collections.length.toString(),n.ItemCategory=e,n.RequestId=r}else n.Error="Unexpected response",n.HttpCode=d.a.UnexpectedResponse.toString();else n.Error=t.statusText})).then((function(e){if(e.data&&e.data.Collections&&0!==e.data.Collections.length){var n=e.data.Collections.map((function(e){return e&&e.Templates&&e.Templates.Value&&e.Templates.Value.length>0?{CollectionId:e.Collection,Title:e.Collection,Templates:{Template:t.setupTemplates(e.Templates.Value,m.b.None),fromCache:!1}}:null}));n&&0!==n.length||o(new k.b(e,"Null templates response")),r(n)}else o(new k.b(e,"Null templates response"))})).catch((function(e){t.globalErrorHandler.handleError(e,"KAzhF")}))}),o,this.requestConfig,"network-only"),[2]}))}))}))},t.prototype.fetchTemplatesRecommended=function(e,n){var r=this;return new Promise((function(o,a){return Object(i.__awaiter)(r,void 0,void 0,(function(){var r,l=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return r=function(t){t.instrument((function(t,n){if(t.ok)if(t.data&&t.data.Templates.Value&&t.data.Templates.Value.length>0){var i=t.data.Templates.RequestId;n.ActualSize=t.data.Templates.Value.length.toString(),n.ItemCategory=e,n.RequestId=i}else n.HttpCode=d.a.UnexpectedResponse.toString()})).then((function(e){if(e.data&&e.data.Templates&&0!==e.data.Templates.Value.length){var t={Template:l.setupTemplates(e.data.Templates.Value,m.b.None),fromCache:!1};t&&0!==t.Template.length||a(new k.b(e,"Null templates response")),o(t)}else a(new k.b(e,"Null templates response"))})).catch((function(e){l.globalErrorHandler.handleError(e,"KlVan")}))},[4,this.isPaidConsumer()];case 1:return i.sent()&&(n+=t.isPremiumString),this.get("Templates_Recommended_Request","Templates_Recommended",n,r,a,this.requestConfig,"network-only"),[2]}}))}))}))},t.prototype.fetchTemplateData=function(e,n,r){var o=this;return new Promise((function(a,l){return Object(i.__awaiter)(o,void 0,void 0,(function(){var o,s,c=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.templatesFromConfig.has(e)?(a({Template:this.templatesFromConfig.get(e),fromCache:"cache-only"===r}),[2]):(o=m.a.fileTypeNameFromType(e),s=function(t){t.instrument((function(e,t){e.ok?e.data&&e.data.Templates&&e.data.Templates.Value?(t.ActualSize=e.data.Templates.Value.length.toString(),t.ItemCategory=o,t.RequestId=e.data.Templates.RequestId):(t.HttpCode=d.a.UnexpectedResponse.toString(),t.Error="Null templates response"):t.Error=e.statusText})).then((function(t){if(t.data&&t.data.Templates&&t.data.Templates.Value){var n=c.setupTemplates(t.data.Templates.Value,e);a({Template:n,fromCache:t.fromCache})}else l(new k.b(t,"Null templates response"))})).catch((function(e){c.globalErrorHandler.handleError(e,"TFeVI")}))},[4,this.isPaidConsumer()]);case 1:return i.sent()&&(n+=t.isPremiumString),this.get("Templates_Request","Templates",n,s,l,this.requestConfig,r),[2]}}))}))}))},t.prototype.initializeTemplateCache=function(){var e=this;this.templatesFromConfig=new Map,this.templatesConfig.getTemplatesInfoPromise().then((function(t){if(t){var n=m.a.fileTypeNameToFileType(t.Application);if(n!==m.b.Unknown){var i=e.setupTemplates(t.Templates.Value,n);e.templatesFromConfig.set(n,i)}}}))},t.prototype.setupTemplates=function(e,t){var n,r;if(t===m.b.Visio)try{for(var o=Object(i.__values)(e),a=o.next();!a.done;a=o.next()){var l=a.value;l.Categories.length&&(l.Title=l.Categories[0].LocalizedTitle)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e.reduce((function(e,t){retu!1,e.push(t)),e}),[])},t.prototype.getUpdateStreamKey=function(e){return"templates-"+e},t.prototype.getTemplatesCollectionId=function(e){if(this.clientStartupConfigService.config.authType===_.a.MSA)switch(e){case m.b.Excel:return this.wacStartConfigService.config.consumerExcelStartPageTemplateCollection;case m.b.PowerPoint:return this.wacStartConfigService.config.consumerPowerPointStartPageTemplateCollection;case m.b.Word:return this.wacStartConfigService.config.consumerWordStartPageTemplateCollection;default:return}},t.prototype.getUrl=function(e,n){var i=this.numTemplates;[m.b.VisioBusinessWac,m.b.VisioFlowChartWac,m.b.VisioGeneralWac,m.b.VisioNetworkWac,m.b.VisioSoftwareWac].lastIndexOf(e)>=0&&(i=this.templatesConfig.config.numVisioTemplates);var r=this.officeRouteService.getRouteItemForCurrentLocation(),o=!r||"Start"!==r.route&&"Templates"!==r.route?"Other":r.route+"Page",a=this.startupConfigService.config.authType===_.a.OrgId?2:1,l=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),s="&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.flightsArg+l+"&"+t.authIdArg+a+"&"+t.pageArg+o+"&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.browserNameArg+v.a[this.deviceInfo.browser.browserType]+"&"+t.osNameArg+v.e[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion+"&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment,c=this.getTemplatesCollectionId(e);return void 0!==c&&""!==c&&(s+="&"+t.templateCollectionId+c),this.contextService.sharedContext.officeHomeApiRoot+"/"+n+"?"+t.appArg+m.b[e]+"&"+t.cultureArg+this.locale+"&"+t.limitArg+(i-1)+"&"+t.isEduArg+this.userContextService.user.isEdu+s},t.prototype.getTemplatesCollectionUrl=function(e){return this.contextService.sharedContext.officeHomeApiRoot+"/"+(this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_COLLECTION_PATH)+"?"+t.collectionsArg+e+"&"+t.cultureArg+this.locale},t.prototype.getTemplatesRecommendedUrl=function(e){var n=this.startupConfigService.config.authType===_.a.OrgId?2:1,i=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),r="&"+t.browserNameArg+v.a[this.deviceInfo.browser.browserType]+"&"+t.flightsArg+i+"&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.authIdArg+n+"&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.pageArg+"Create&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment+"&"+t.osNameArg+v.e[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion;return this.contextService.sharedContext.officeHomeApiRoot+"/"+(this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_RECOMMENDED_PATH)+"?"+te+"&"+t.limitArg+"200"+r},t.prototype.getCacheKey=function(e){return e+"_"+this.locale},t.TEMPLATES_COLLECTION_PATH="/collections",t.TEMPLATES_RECOMMENDED_PATH="/recommended",t.TEMPLATES_CONTENT_PATH="/content",t.collectionsArg="collections=",t.cultureArg="culture=",t.appArg="app=",t.appsArg="apps=",t.limitArg="show=",t.isEduArg="isEdu=",t.flightsArg="flights=",t.isIwArg="isIw=",t.isAdminArg="isAdmin=",t.isSmbArg="isSmb=",t.isEduFacultyArg="isEduFaculty=",t.isEduStudentArg="isEduStudent=",t.authIdArg="authId=",t.pageArg="page=",t.firstVisitAgeInWeeksArg="firstVisitAgeInWeeks=",t.browserNameArg="browserName=",t.osNameArg="osName=",t.osVersionArg="osVersion=",t.deploymentEnvironmentArg="deploymentEnvironment=",t.isPremiumString="&isPremium=1",t.templateIdArg="id=",t.templateBinaryUrlArg="templateBinaryUrl=",t.supportedEnterpriseFileTypes=new Set(["pptx","potx","dotx","xltx"]),t.templatesCollectionPersistenceKey="templates-collection-api",t.templatesCollectionPersistenceVersion=5,t.templatesPersistencePlugins=[Object(l.a)(7*r.a)],t.templatesRecommendedPersistenceKey="templates-recommended-api",t.templatesRecommendedPersistenceVersion=3,t.templateCollectionId="collectionId=",t.ɵprov=R.kc({factory:function(){return new t(R.lc(b.b),R.lc(I.a),R.lc(_.b),R.lc(A.a),R.lc(P.a),R.lc(v.c),R.lc(c.b),R.lc(p.a),R.lc(f.a),R.lc(y.a),R.lc(S.a),R.lc(x.q),R.lc(_.b),R.lc(M.a),R.lc(w.a),R.lc(O.a),R.lc(h.b),R.lc(F.a),R.lc(E.a),R.lc(C.a),R.lc(T.a),R.lc(u.a))},token:t,providedIn:"root"}),t}(k.a)},dFxn:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("laSs"),r=n("lrJm"),o=n("ZJrL"),a=n("keVe"),l=function(){function e(e){this.globalErrorHandler=e,this.shouldSample=Math.random()<=.01}return e.prototype.parse=function(e){try{return this.shouldSample&&Object(i.a)({eventName:e,area:"ConfigParserService"}),o.a.parseJsonElementWithId(e)}catch(n){var t=new r.a("Failure to parse "+e+" from response",n);this.globalErrorHandler.handleError(t)}return null},e.ɵprov=a.kc({factory:function(){return new e(a.lc(a.p))},token:e,providedIn:"root"}),e}()},dOgD:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var i=n("lrJm"),r=n("hhzZ"),o=n("R7NL"),a=n("QOOv"),l=n("kpuN"),s=n("pd4Y"),c=n("Z0U4"),u=n("wwmn"),d=n("casz"),p=n("ZtId"),f=n("BMb5"),h=n("4/We"),m=n("cgnd"),b=n("/I02"),g=n("PBJH"),v=n("QjXU"),S=n("kaEK"),y=n("9260"),C=n("BaAg"),w=n("RR/o"),T=n("pOWU"),k=n("uUrA"),I=n("CVeG"),_=n("oAX+"),A=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,f,h,m){var b=e.call(this,t,r,o,"Substrate",i,l,c,f)||this;b.capabilitiesService=n,b.locService=a,b.mruConfigService=s,b.globalErrorHandler=u,b.startupConfigService=d,b.updateContentService=p,b.dateService=h,b.windowService=m,b.fetchRequestIndex=0;var g=b.capabilitiesService.capabilities;return b.scenario=g.suggestedActionsEnabled?"OfficeSuggestedActions":g.pwaEnabled?"OfficeComApp":"OfficeComHome",b.section=g.suggestedActionsEnabled?"OfficeSuggestedActions":"OfficeComHome",b.application=g.pwaEnabled?"OfficeComApp":"OfficeComHome",b.baseUrl=b.inMockMode?b.contextService.sharedContext.officeHomeApiRoot:""+b.mruConfigService.config.substrateApiEndpoint,b.officeFeedDataStreams=new Map,b.regExp=new RegExp("{([0-9]+)}"),b.feedFlight=b.mruConfigService.config.officeFeedFlightEnabled,b.startupConfig=b.startupConfigService.config,b.tamyDataStreamMap=new Map,b}return Object(v.__extends)(t,e),t.prototype.getOfficeFeed=function(){var e=this,n="",i=this.mruConfigService.config;n=i.useFeedS2SApi?this.contextService.sharedContext.officeHomeApiRoot+"/api/officefeed?"+t.locParam+this.contextService.sharedContext.officeMarket+"&feedFlight="+this.getFeedFlight():this.baseUrl+"/PeoplePredictionsB2/MicrosoftFeed?section="+this.section+"&"+t.locParam+this.contextService.sharedContext.officeMarket+"&"+t.newSchema+this.mruConfigService.config.officeFeedNewSchemaEnabled;var r=this.startupConfig.sharedClientStartupContext.flights.toLowerCase(),o=[],a=this.capabilitiesService.capabilities;if(i.officeFeedFlightControlName&&i.officeFeedFlightName&&(r.includes(i.officeFeedFlightControlName.toLowerCase())?o.push(i.officeFeedExperimentControlName):r.includes(i.officeFeedFlightName.toLowerCase())&&o.push(i.officeFeedExperimentName)),i.officeFeedFlight2ControlName&&i.officeFeedFlight2Name&&(r.includes(i.officeFeedFlight2ControlName.toLowerCase())?o.push(i.officeFeedExperiment2ControlName):r.includes(i.officeFeedFlight2Name.toLowerCase())&&o.push(i.officeFeedExperiment2Name)),i.officeFeedFlight3ControlName&&i.officeFeedFlight3Name&&(r.includes(i.officeFeedFlight3ControlName.toLowerCase())?o.push(i.officeFeedExperiment3ControlName):r.includes(i.officeFeedFlight3Name.toLowerCase())&&o.push(i.officeFeedExperiment3Name)),a.threeSRdlFeedExperiment&&o.push(a.threeSRdlFeedExperiment),o.length>0&&(n+="&experiment="+o.join("&experiment=")),this.officeFeedDataStreams.has(n))return this.officeFee("officefeed-"+n,(function(){return e.fetchOfficeFeed("network-first",n,i.useFeedS2SApi)})),s=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchOfficeFeed(n,i.useFeedS2SApi):this.fetchOfficeFeed("network-first",n,i.useFeedS2SApi),c=_.a.createResultsWithCacheObservable(this.fetchOfficeFeed("cache-only",n,i.useFeedS2SApi),s,l,(function(t){return e.officeFeedDataStreams.delete(n)}));return this.officeFeedDataStreams.set(n,c),c},t.prototype.getTamyDocuments=functiodFileTypes,o=n&&n.size?r.filter((function(e){return n.has(C.a.fileTypeNameToFileType(e))})):r,a=o.reduce((function(e,t,n){return e+(n>0?" or ":"")+"resourceVisualization/Type eq '"+t+"'"}),""),l=t.tamyPath,s="$top="+e+"&$filter="+encodeURIComponent(a),c="?"+t.tamyQueryParams+"&"+s,u=this.inMockMode?""+this.contextService.sharedContext.officeHomeApiRoot+l+"/trending"+c:""+this.mruConfigService.config.substrateApiEndpoint+l+c;if(this.tamyDataStreamMap.has(u))return this.tamyDataStreamMap.get(u);var d=this.fetchOfficeFeed("cache-only",u,!1,0,"Trending",!0,o),p=this.fetchOfficeFeed("network-first",u,!1,0,"Trending",!0,o),f=_.a.createResultsWithCacheObservable(d,p,null,(function(e){return i.tamyDataStreamMap.delete(u)}));return this.tamyDataStreamMap.set(u,f),f},t.prototype.logInstrumentation=function(e,t,n,i){var r=this;return new Promise((function(o,a){for(var l=(r.inMockMode?r.contextService.sharedContext.officeHomeApiRoot:r.mruConfigService.config.substrateApiEndpoint)+"/peoplepredictionsb2/Feedback",s=[],c=0;c<e.length;c++)s.push({FeedbackId:e[c],Action:t[c],ItemSource:n[c],Target:i?i[c]:"",Timestamp:new Date(Date.now()).toISOString()});var u={Actions:s},d=r.createRequestConfig(r.startupConfig.sharedClientStartupContext.correlationId,"Feedback");r.post("OfficeFeedInstrumentation","OfficeFeedInstrumentation",l,u,(function(e){e.instrument((function(e,t){t.ItemCategory=s.map((function(e){return e.Action})).join(","),t.RequestId=r.getRequestIdFromResponse(e)})).then((function(){return o(null)}))}),a,d,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r.mruConfigService.config.deferFeedWrite?4:0)}))},t.prototype.performAction=function(e,t,n){var i=this;return new Promise((function(r,o){var a=(i.inMockMode?i.contextService.sharedContext.officeHomeApiRoot:i.mruConfigService.config.substrateApiEndpoint)+"/peoplepredictionsb2/v2/myanalyticsaction",l={FeedbackId:e,Action:t,ActionPayload:n},s=i.createRequestConfig(i.startupConfigService.config.sharedClientStartupContext.correlationI,"Office(e){e.instrument((function(e,t){t.ItemCategory=l.Action})).then((function(){return r(!0)}))}),o,s,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,0)}))},t.prototype.getStreamsThumbnail=function(e){var t=this;this.inMockMode&&(e=this.contextService.sharedContext.officeHomeApiRoot+"/StreamsThumbnail");var n=new FileReader;return new Promise((function(i,r){var o=t.createRequestConfig(t.startupConfig.sharedClientStartupContext.correlationId,"StreamsThumbnail","blob");t.get("OfficeFeed_Stream_Thumbnail_Request","OfficeFeed_Stream_Thumbnail",e,(function(e){e.then((function(e){e&&e.data?(n.onloadend=function(){var e=n.result&&"string"==typeof n.ngth>0?e:null)},n.onerror=function(){return i(null)},n.onabort=function(){return i(null)},n.readAsDataURL(e.data)):i(null)})).catch((function(e){t.globalErrorHandler.handleError(e,"AfEUN")}))}),r,o,"network-only")}))},t.prototype.handleQueryParam=function(e,t,n){"mockofficefeed"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.prefetchOfficeFeed=function(e,t){var n=this;return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then((function(e){reedNewSchemaEnabled?e.items:e)||[]).map((function(e){return n.convertItemToMruDataItem(e)})).filter((function(e){var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)})),impressionId:e.recommendedRequestId||"",fromCache:!1}:Promise.reject("Prefetch failed")})):this.fetchOfficeFeed("network-first",e,t)},t.prototype.fetchOfficeFeed=function(e,n,i,o,a,l,s){var c=this;return new Promise((function(u,d){var p=k.a.createGuid(),f=c.createRequestConfig(p,a||"MicrosoftFeed"),h="MicrosoftFeedSPNF"===a;c.get(l?"Trending_Around_Me_Request":"OfficeFeedRequest",l?"Trending_Around_Me":"OfficeFeedRequest",n,(function(i){i.instrument((function(i,o){if(o.RequestId=c.getRequestIdFromResponse(i),o.Index=(c.fetchRequestIndex++).toString(),o.ImpressionId=!!i.headers&&i.headers.get(y.a.clientRequestIdHeader)||p,o.ApiLatency=(!!i.headers&&i.headers.get(t.e2eLatencyHeader)||-1).toString(),i.ok&&i.data&&!h){var a=c.mruConfigService.config.officeFeedrn e.sharePointIds&&e.sharePointIds.listItemUniqueId?e.sharePointIds.listItemUniqueId:""})).toString(),o.OfficeFeedCategoryDistribution=a.map((function(e){return e.category})).toString(),o.ActualSize=l.toString()}}else"cache-only"===e&&401===i.status&&(o.OfficeFeedUrl=r.a.filterPii(n),o.OfficeFeedAuthenticateHeader=i.headers.get("WWW-Authenticate"))})).then((function(t){if(h)u(null);else{var n=t&&t.data&&(c.mruConfigServiems:t.data)||[];ludes(e.subCategorr((function(e){var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)}));u({items:r,impressionId:!!t.heahe:"cache-only"===e})}})).catch((function(e){c.globalErrorHandler.handleError(e,"AfEUN")}))}),d,f,e,null,null,null,i?"OfficeHome":"Substrate",null,o)}))},t.prototype.createRequestConfig=function(e,t,n){var i={headers:new Map([["ScenarioTag",""+this.scenario+t],["Content-Type","application/json"],["X-OfficeFeedFlight",this.getFeedFlight()],["X-AnchorMailbox","Oid:"+this.startupConfig.objectId+"@"+this.startupConfig.tenantId],["X-Application",this.application],["X-ApplicationScenario",this.scenario],["X-RoutingParameter-SessionKey",this.startupConfig.objectId],[i},t.prototype.getFeedFlight=function(){return this.feedFlight?"experiment":"evaluation"},t.prototype.convertItemToMruDataItem=function(e,t){return void 0===t&&(t=!1),"file"===e.category.toLowerCase()||"video"===e.category.toLowerCase()?this.convertFileToMruDataItem(e,t):"newsarticle"===e.category.toLowerCase()?this.convertNewsItemToMruDataItem(e):"upcomingmeeting"===e.category.toLowerCase()&&this.mruConfigService.config.upcomingMeetingEnabled?this.convertUpcomingMeetingToMruDataItem(e):"myanalyticsinsight"===e.category.toLowerCase()&&this.mruConfigService.config.myAnalyticsEnabled?this.convertMyAnalyticsToMruDataItem(e):null},t.prototype.convertMyAnalyticsToMruDataItem=function(e){var t,n,i,r=(null===(t=(e.inclusionReasons&&e.inclusionReasons[0]).actors[0])||void 0===t?void 0:t.User)||{},o=r.DisplayName,a={formatString:o,plainText:o,people:[{upn:r.email,tag:"c0",name:r.DisplayName}],reasonType:S.a.MyAnalytics,timestamp:e.createdDateTime?new Date(e.createdDateTime):null},l='"'+(null===(n=e.previewInfo)||void 0===n?void 0:n.text)+'"',s=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:e.name,Title:e.name,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:s,FileType:"MyAnalytics",PathArray:null,Provenance:C.f[C.f.Substrate],ResourceId:"",UrlAlreadyEncoded:!0,Activity:a,ThumbnailUrl:null,FeedbackId:e.feedbackId,TaskInsight:e.taskInsight,PotentialAction:e.potentialActions,Actor:r,InsightName:e.insightName,InsightDescription:l,InsightDescriptionPrefix:this.getInsightDescriptionPrefix(null===(i=e.taskInsight)||void 0===i?void 0:i.actionType)}},t.prototype.getInsightDescriptionPrefix=function(e){var t=this.locService.YouSaid;return"FollowUp"===e||"FollowUpActionRequest"===e||"FollowUpReplyRequest"===e?t=this.locService.YouAsked:"Commitment"===e?t=this.locService.YouSaid:"Request"===e&&(t=this.locService.TheyAsked),t},t.prototype.convertUpcomingMeetingToMruDataItem=function(e){var t,n,i,r,o,a,l,s=e.upcomingMeetingInfo,c=null!==(t=new Date(s.start))&&void 0!==t?t:null,u=this.dateService.timespanInSeconds(c),d="TeamsForBusiness"===(null===(n=s.onlineMeeting)||void 0===n?void 0:n.onlineMeetingProvider),p=null!==(i=new Date(e.expiresAt))&&void 0!==i?i:null,f=new Date,h=e.itemGroups&&e.itemGroups.length>0&&-1!==e.itemGroups.indexOf("MeetingOnlineAttending");if(!this.inMockMode&&p&&f>p)return null;var m=u>0,b=m?this.locService.OfficeFeedYourUpcomingMeetingStarted:this.locService.OfficeFeedYourUpcomingMeeting;!m&&u>-60&&(b=this.locService.OfficeFeedYourUpcomingMeetingHappeningNow);var g=d?this.locService.JoinTeamsMeeting:this.locService.SuggestedActionJoinMeeting,v={formatString:b,plainText:b,people:null,reasonType:S.a.Meeting,timestamp:null!==(r=new Date(s.start))&&void 0!==r?r:null};return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:null,Title:null===(o=e.previewInfo)||void 0===o?void 0:o.text,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:c,FileType:"UpcomingMeeting",PathArray:null,Provenance:C.f[C.f.Substrate],UrlAlreadyEncoded:!0,Activity:v,FeedbackId:e.feedbackId,Attendees:s.attendees,Subject:s.subject,JoinUrl:null===(a=s.onlineMeeting)||void 0===a?void 0:a.joinUrl,MeetingStart:this.locService.formatTimeFromDate(new Date(s.start)),MeetingEnd:this.locService.formatTimeFromDate(new Date(s.end)),Location:null===(l=s.location)||void 0===l?void 0:l.displayName,Organizer:s.organizer,JoinMeetingText:g,IsUpcomingMeetingAccepted:h,IsTeamsMeeting:d}},t.prototype.convertNewsItemToMruDataItem=function(e){var t,n=this.locService.format(this.locService.OfficeFeedPostedBy,e.newsArticleInfo&&e.newsArticleInfo.byLine||""),i=this.locService.format(this.locService.OfficeFeedPostedBy,"<c0>"+(e.newsArticleInfo&&e.newsArticleInfo.byLine||"")+"</c0>"),r=e.createdBy&&e.createdBy.User||{},o={formatString:i,plainText:n,people:[{upn:r.Id,tag:"c0",name:r.DisplayName}],reasonType:S.a.News,timestamp:e.newsArticleInfo.firstPublishedDateTime?new Date(e.newsArticleInfo.firstPublishedDateTime):null},a=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,FileName:e.name,Title:e.name,Url:e.uri,WebUrl:e.webUrl,LastAccessedTime:a,FileType:"NewsArticle",PathArray:e.containerInfo?[e.containerInfo.displayName]:null,Provenance:C.f[C.f.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:o,ThumbnailUrl:null===(t=e.previewInfo)||void 0===t?void 0:t.image,FeedbackId:e.feedbackId}},t.prototype.convertOfficeFeedActivityToActivityDescription=function(e){for(var t=e.reason||"",n=null,i=function(){var i=n[1];t=t.replace(n[0],(function(){return"<c"+i+">"+e.actors[i].User.DisplayName+"</c"+i+">"}))};null!==(n=this.regExp.exec(t));)i();return{formatString:t,plainText:I.a.stripTags(t),people:(e.actors||[]).map((function(e,t){return{upn:e&&e.User.email,tag:"c"+t,name:e.User.DisplayName}})),reasonType:"popularVideoInclusionReason"===e.kind?S.a.Trending:"meetingRecordingInclusionReason"===e.kind?S.a.Video:this.convertReasonTypeToActivityReason(e.inclusionKind),timesTypeToActivityReason=function(e){return w.b.convertMruReasonTypeToActivityReason(w.a[e])},t.prototype.convertFileToMruDataItem=function(e,t){var n,i,r,o,a,l;void 0===t&&(t=!1);var s=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null,c=e.sharePointIds,u=c&&{list_id:c.listId,list_item_unique_id:c.listItemUniqueId,site_id:c.siteId,site_url:null,web_id:c.webId},d=e.inclusionReasons&&e.inclusionReasons[0],p=void 0,f=void 0,h=void 0,m=!1,b=null;d&&!t&&(h=this.convertOfficeFeedActivityToActivityDescription(d),this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&(p=d.sharingWebUrl),this.capabilitiesService.capabilities.recommendedDeepLinkEnabled&&(f=d.navigationId),(m="EmailAttachment"===d.inclusionKind)&&(b={AttachmentType:1,ConversationId:"",Subject:d.conversationSubject||""}));var g=m,v=this.fileType(e);v!==C.b.MeetingNotes&&v!==C.b.Whiteboard||(g=!0);var S="video"===e.category.toLowerCase()?"StreamsVideo":"Document",y="StreamsVideo"===S?null===(n=e.video)||void 0===n?void 0:n.mediaDuration:void 0,w="StreamsVideo"===S||"Custom"===e.subCategory?e.previewInfo.image:void 0,T=g?e.webUrl:e.uri;return{Application:C.b[v],Category:S,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,Extension:(null===(i=null==e?void 0:e.file)||void 0===i?void 0:i.extension)||C.a.getFileExtensionFromUrl(T),FileName:e.name,Title:e.name,Url:T,WebUrl:e.webUrl,LastAccessedTime:s,FileType:C.b[v],PathArray:null!==(a=this.getPathArray(null===(r=e.containerInfo)||void 0===r?void 0:r.kind,null===(o=e.containerInfo)||void 0===o?void 0:o.displayName))&&void 0!==a?a:null,Provenance:C.f[C.f.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:h,SharepointInfo:u,IsEmailAttachment:m,EmailReference:b,IsCollab:e.is_collab,FeedbackId:e.feedbackId,NavigationId:f,TeamsDeepLink:p,ThumbnailUrl:w,MediaDuration:y,IconUrl:null===(l=e.appInfo)||void 0===l?void 0:l.iconUrl}},t.prototype.fileType=function(e){var t,n=C.a.fileTypeNameToFileType(e.subCategory);return n&&n!==C.b.None?n===C.b.OneNote&&"note"===(null===(t=e.file)||void 0===t?void 0:t.extension)&&(n=C.b.MeetingNotes):n=C.b.Unknown,n},t.prototype.getPathArray=function(e,t){return t?this.isOneDrive(e)&&t?[this.locService.format(this.locService.EdgeworthFilePathTitle,t)]:[t]:null},t.prototype.isOneDrive=function(e){var t=null==e?void 0:e.toLocaleLowerCase();return"onedrive"===t||"onedrivebusiness"===t},t.locParam="rs=",t.newSchema="forceNewSchema=",t.e2eLatencyHeader="x-end2endlatencyms",t.tamyPath="/PeoplePredictionsB2/MicrosoftFeed",t.tamyQueryParams="section=OfficeHomeTrending&scenario=OfficeHomeTrending",t}(T.a),P=n("keVe"),E=n("TOqr"),O=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f,h,m){var b=this;this.officefeedService=new A(e,p,i,n,t,f,r,o,a,l,s,u,d,h,m),c.subscribeToRouteChangeStart((function(e){e.currentRoute&&(o.config.officeFeedControlEnabled||o.config.officeFeedFlightEnabled)&&!p.capabilities.recommeute)}))}return e.prototype.getOfficeFeedService=function(){return this.officefeedService},e.prototype.warmDocumentCache=function(e){switch(e.route){case"OfficeHome":case"Pwa":this.officefeedService.getOfficeFeed()}},e.ɵprov=P.kc({factory:function(){return new e(P.lc(l.b),P.lc(o.a),P.lc(r.a),P.lc(b.a),P.lc(u.a),P.lc(a.a),P.lc(E.q),P.lc(i.b),P.lc(m.b),P.lc(c.a),P.lc(p.a),P.lc(d.a),P.lc(h.a),P.lc(g.a),P.lc(s.a),P.lc(f.b))},token:e,providedeturn e.ɵprov=P.kc({factory:function(){return function(e){return e.getOfficeFeedService()}(P.lc(O))},token:e,providedIn:"root"}),e}()},dQLD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("odspConfig")||{odspProvisioningCheckIntervals:null,odspProsioningStatusApiPath:null}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},dSKW:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l}));var i={accessstart:"AccessStart",appgallery:"AppGallery",clipchampstart:"ClipchampStart",chat:"Chat",content:"Content",create:"Create",calendarstart:"CalendarStart",delvastart:"DelveStart",draft:"Draft",excelstart:"ExcelStart",excelcontent:"ExcelContent",exceltemplates:"ExcelTemplates",feed:"Feed",fluidcontent:"FluidContent",fluidstart:"FluidStart",formsgroupforms:"FormsGroupForms",formsmyforms:"FormsMyForms",formsstart:"FormsStart",formstemplates:"FormsTemplates",intents:"Intents",officehome:"OfficeHome",orion:"Orion",m365apps:"M365Apps",mailstart:"MailStart",modernmycontent:"ModernMyContent",mycontent:"MyContent",myforms:"MyForms",notebookstart:"NotebookStart",onedrivestart:"OneDriveStart",onenotestart:"OneNoteStart",outlookstart:"OutlookStart",pdfstart:"PdfStart",plannerstart:"PlannerStart",powerbistart:"PowerBiStart",powerpointstart:"PowerPointStart",powerpointcontent:"PowerPointContent",powerpointtemplates:"PowerPointTemplates",projectstart:"ProjectStart",publisherstart:"PublisherStart",search:"Search",searchfilesscoped:"SearchFilesScoped",searchpersonscoped:"SearchPersonScoped",searchsitescoped:"SearchSiteScoped",searchpersonscopedoverview:"SearchPersonScopedOverview",sharepointstart:"SharePointStart",streamstart:"StreamStart",swaystart:"SwayStart",swaytemplates:"SwayTemplates",tasksstart:"TasksStart",teamsstart:"TeamsStart",unknown:"Unknown",videostart:"VideoStart",videocontent:"VideoContent",visiostart:"VisioStart",visiocontent:"VisioContent",visiotemplates:"VisioTemplates",whiteboardstart:"WhiteboardStart",wordstart:"WordStart",wordcontent:"WordContent",wordtemplates:"WordTemplates",yammerstart:"YammerStart"};function r(e){return e?"MyContent"===e?"Default":e.endsWith("Start")?"Start":e.endsWith("Templates")?"Templates":e.endsWith("Content")?"Content":"SearchPersonScoped"===e?"Person":"SearchSiteScoped"===e?"Site":"FormsGroupForms"===e?"GroupForms":"FormsMyForms"===e?"MyForms":"Default":"Other"}function o(e){return e?"MyContent"===e?e:e.endsWith("Start")||e.endsWith("Templates")||e.endsWith("Content")?e.replace("Start","").replace("Templates","").replace("Content",""):e.startsWith("Search")?"Search":e.startsWith("Forms")?"Forms":"OfficeHome"===e?"Home":e:""}function a(e){var t="Pwa"===(null==e?void 0:e.route)?"OfficeHome":null==e?void 0:e.route,n=void 0!==t?"".concat((null==e?void 0:e.app)?e.app:"").concat(t):void 0;return void 0!==n?l(n):"Unknown"}function l(e){if(e){if(e.toLowerCase().endsWith("m365apps"))return"M365Apps";if("pwa"===e.toLowerCase())return"OfficeHome";var t=i[e.toLowerCase()];return void 0!==t?t:"Unknown"}return"Unknown"}},dmOj:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("BaAg"),r=n("4/We"),o=n("dFxn"),a=n("keVe"),l=function(){function e(e,t){var n=this;this.titlesConfig=e.parse("titlesConfig"),this.capabilitiesService=t,this.appTitleInfo=new Map,this.allTitleInfo=new Map,this.titlesConfig&&this.titlesConfig.appTitleConfigs&&(this.defaultTitle=this.titlesConfig.defaultTitle,this.defaultIcon=this.titlesConfig.defaultIcon,this.galleryTitle=this.titlesConfig.galleryTitle,this.titlesConfig.appTitleConfigs.forEach((function(e){n.appTitleInfo.set(i.a.fileTypeNameToFileType(e.app),e),n.allTitleInfo.set(e.app,e.title)})))}return e.prototype.getTitle=function(e,t){return this.capabilitiesService.capabilities.m365StringLogoEnabled?e?t||("OfficeHome"===e.route?this.allTitleInfo.get("Home"):"Create"===e.route?this.allTitleInfo.get("Create"):"MyContent"===e.route?this.allTitleInfo.get("MyContent"):"Feed"===e.route?this.allTitleInfo.get("Feed"):"AppGallery"===e.route||"M365Apps"===e.route?this.allTitleInfo.get("Apps"):e.app&&this.appTitleInfo.has(e.app)?this.appTitleInfo.get(e.app).title:this.defaultTitle):this.defaultTitle:e&&e.app&&this.appTitleInfo.has(e.app)?t||this.appTitleInfo.get(e.app).title:"AppGallery"===e.route?this.galleryTitle:this.defaultTitle},e.prototype.getFavicon=function(e){return!this.capabilitiesService.capabilities.m365StringLogoEnabled&&e&&e.app&&this.appTitl.icon||this.defaultIcon},e.ɵprov=a.kc({factory:function(){return new e(a.lc(o.a),a.lc(r.a))},token:e,providedIn:"root"}),e}()},dvrM:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var i=n("keVe"),r=n("pzhl"),o=n("PkQn"),a=n("4/We"),l=n("W0EU"),s=i.Fb({encapsulation:2,styles:[],data:{}});function c(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"span",[["class","alert-message"]],null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-icon-font",[["cssClass","alert-message__icon"],["iconFontName","Alert"]],null,null,null,r.b,r.a)),i.Gb(2,638976,null,0,o.a,[a.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"]},null),(e()(),i.Hb(3,0,null,null,1,"spanl,on(e,t){e(t,2,0,"alert-message__icon","Alert")}),(function(e,t){e(t,4,0,t.component.message)}))}i.Db("ohp-alert-message",l.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-alert-message",[],null,null,null,c,s)),i.Gb(1,49152,null,0,l.a,[],null{message:"message"},{},[])},dx17:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("QjXU"),r=n("kaEK"),o=n("L/Tc"),a=n("QOOv"),l=n("pd4Y"),s=n("uH9+"),c=n("cgnd"),u=n("PBJH"),d=n("CVeG"),p=n("keVe"),f=function(){function e(e,t,n,i,r){this.timestampFormatService=t,this.locService=n,this.mruConfigService=i,this.dateService=r,this.userEmail=e.config.userPrincipalName}return e.prototype.activityDescription=function(e,t,n,i){if(void 0===i&&(i=!1),!e||0===e.length)return null;e=this.filterActivities(e,t);for(var r=new Map,a=0;a<e.length;a++){var l=e[a],s=l.action.type;r.has(s)?r.get(s).push(l):r.set(s,[l])}return r.has(o.a.Mention)?this.createMentionDescription(r.get(o.a.Mention),n,i):r.has(o.a.Comment)?this.createCommentDescription(r.get(o.a.Comment),n,i):r.has(o.a.Edit)?this.createEditDescription(r.get(o.a.Edit),n,i):null},e.prototype.displayedActivityType=function(e,t,n){if(!e||0===e.length)return o.a.None;n&&(e=this.filterActivities(e,t));for(var i=0,r=0,a=0,l=0;l<e.length;l++){var s=e[l].action.type;s===o.a.Mention?i++:s===o.a.Comment?r++:s===o.a.Edit&&a++}return i>0?o.a.Mention:r>0?o.a.Comment:a>0?o.a.Edit:o.a.None},e.prototype.filterActivities=function(e,t){var n=this;return e?e.filter((function(e){if(e&&e.action&&e.timestamp&&e.actor&&e.actor.user&&e.actor.user.email&&e.actor.user.displayName){var i=e.action;if(t&&e.timestamp<t)return!1;if(n.isCurrentUser(e.acto=i.data.mentionees;return r&&r.filter((function(e){return e&&e.user&&n.isCurrentUser(e.user)})).length>0}return i.type!==o.a.Unknown}return!1})):[]},e.prototype.isCurrentUser=function(e){return e&&(!!e.self||e.userPrincipalName===this.userEmail)},e.prototype.createMentionDescription=function(e,t,n){if(!e||!e.length)return null;var i=e[0],o=this.numDistinctActors(e),a=i.actor.user,l=i.timestamp,s=this.formatStringWithTime(l,"Mentioned",t,n,[a.displayName],o-1);return{formatString:s,plainText:d.a.stripTags(s),people:[{upn:a.email,tag:"c0",name:a.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}],reasonType:r.a.Mention,timestamp:l}},e.prototype.createCommentDescription=function(e,t,n){if(0===e.length)return null;var i=e[0],o=i.action.data,a=i.actor.user,l=i.timestamp,s="",c=null;if(e.length>1){var u=this.numDistinctActors(e);s=this.formatStringWithTime(l,"Commented",t,n,[a.displayName],u-1),c=[{upn:a.email,tag:"c0",name:a.displayName}]}else if(o&&o.isReply&&o.parentAuthor&&o.parentAuthor.user.displayName&&o.parentAuthor.user.email){var p=o.parentAuthor.user;this.isCurrentUser(p)?(s=this.formatStringWithTime(l,"RepliedYourComment",t,n,[a.displayName],0),c=[{upn:a.email,tag:"c0",name:a.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}]):(s=this.formatStringWithTime(l,"RepliedOtherComment",t,n,[a.displayName,p.displayName],0),c=[{upn:a.email,tag:"c0",name:a.displayName},{upn:p.email,tag:"c1",name:p.displayName}])}else s=this.formatStringWithTime(l,"Commented",t,n,[a.displayName],0),c=[{upn:a.email,tag:"c0",name:a.displayName}];return{formatString:s,plainText:d.a.stripTags(s),people:c,reasonType:r.a.Comment,timestamp:l}},e.prototype.createEditDescription=function(e,t,n){if(0===e.length)return null;var i=e[0],o=this.numDistinctActors(e),a=i.actor.user,l=i.timestamp,s=this.formatStringWithTime(l,"Edited",t,n,[a.displayName],o-1);return{formatString:s,plainText:d.a.stripTags(s),people:[{upn:a.email,tag:"c0",name:a.displayName}],reasonType:r.a.Edit,timestamp:l}},e.prototype.formatStringWithTime=function(e,t,n,r,o,a){var l,s=a<=0?"":1===a?"OneOther":"Others",c=t+s,u=r?"NoDate":this.getActivityTimestampType(e,n);c+="FullDateThisYear"===u?"FullDate":u;var d=this.getTimestampPlaceholders(e,u),p=this.mruConfigService.config.activityStrings[c];return"OneOther"===s||""===s||o.push(this.locService.localizedNumberString(a)),o=o.concat(d),(l=this.locService).format.apply(l,Object(i.__spread)([p],o))},e.prototype.getActivityTimestampType=function(e,t){switch(this.timestampFormatService.getTimestampType(e)){case 0:return"NoDate";case 1:return"JustNow";case 2:return"MinAgo";case 3:return"HoursAgo";case 4:return t?"Yesterday":"YesterdayAt";case 5:return t?"DayOfWeek":"DayAndTimeOfWeek";case 6:return"FullDateThisYear";case 7:return"FullDate"}},e.prototype.getTimestampPlaceholders=function(e,t){var n=this.dateService.timespanInSeconds(e);switch(t){case"NoDate":case"JustNow":case"Yesterday":return null;case"MinAgo":return[this.locService.localizedNumberString(Math.round(n/60))];case"HoursAgo":return[this.locService.localizedNumberString(Math.round(n/3600))];case"YesterdayAt":return[this.locService.formatTimeFromDate(e)];case"DayOfWeek":return[this.locService.localizedWeekday(e)];case"DayAndTimeOfWeek":return[this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e)];case"FullDateThisYear":return[this.locService.localizedMonthDate(e)];case"FullDate":return[this.locService.lope.numDistinctActors=function(e){return new Set(e.map((function(e){return e.actor.user.email}))).size},e.ɵprov=p.kc({factory:function(){return new e(p.lc(c.b),p.lc(s.a),p.lc(u.a),p.lc(a.a),p.lc(l.a))},token:e,providedIn:"root"}),e}()},dy1P:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.AADMyApps="AADMyApps",e.AboutMe="AboutMe",e.Access="Access",e.AdminPortal="AdminPortal",e.AppGallery="AppGallery",e.Audio="Audio",e.BecomeTheAdmin="BecomeTheAdmin",e.Bing="Bing",e.Bookings="Bookings",e.BusinessCentral="BusinessCentral",e.Calendar="Calendar",e.ClassNotebook="ClassNotebook",e.Clipchamp="Clipchamp",e.CloudPC="CloudPC",e.ComplianceCenter="ComplianceCenter",e.Create="Create",e.CustomerVoice="CustomerVoice",e.CRM="CRM",e.Defender="Defender",e.Designer="Designer",e.Draft="Draft",e.DocsCom="DocsCom",e.Documents="Documents",e.Dynamics365="Dynamics365",e.Dynamics365CI="Dynamics365CI",e.Dynamics365CSI="Dynamics365CSI",e.Dynamics365FraudProtection="Dynamics365FraudProtection",e.Dynamics365Invoicing="Dynamics365Invoicing",e.Dynamics365ProductInsights="Dynamics365ProductInsights",e.Dynamics365SalesInsights="Dynamics365SalesInsights",e.DynamicsApp="DynamicsApp",e.DynamicsNAV="DynamicsNAV",e.Editor="Editor",e.ERP="ERP",e.ExcelOnline="ExcelOnline",e.ExchangeAdmin="ExchangeAdmin",e.FamilySafety="FamilySafety",e.Fluid="Fluid",e.Forefront="Forefront",e.ForefrontAdmin="ForefrontAdmin",e.GraphApp="GraphApp",e.HighLander="HighLander",e.Invoicing="Invoicing",e.ISVStudio="ISVStudio",e.Kaizala="Kaizala",e.LineOfBusinessApp="LineOfBusinessApp",e.Link="Link",e.Lists="Lists",e.Loop="Loop",e.LoopComponent="LoopComponent",e.LogicFlows="LogicFlows",e.Mail="Mail",e.Marketing="Marketing",e.MeetingObject="MeetingObject",e.MeetingNotes="MeetingNotes",e.MetaOSApp="MetaOSApp",e.MicrosoftStream="MicrosoftStream",e.MOSStore="MOSStore",e.MSN="MSN",e.MyAnalytics="MyAnalytics",e.MyApps="MyApps",e.MyContent="MyContent",e.Feed="Feed",e.Netbreeze="Netbreeze",e.NewsArticle="NewsArticle",e.Newsfeed="Newsfeed",e.NonProfitPortal="NonProfitPortal",e.O365Settings="O365Settings",e.ODBAdmin="ODBAdmin",e.OfficeDotCom="OfficeDotCom",e.OfficeForms="OfficeForms",e.OfficeGraph="OfficeGraph",e.OfficeStore="OfficeStore",e.OneNoteOnline="OneNoteOnline",e.OWASettings="OWASettings",e.Park="Park",e.Parature="Parature",e.Partner="Partner",e.Paw="Paw",e.PDF="PDF",e.People="People",e.Photos="Photos",e.PlayLists="PlayLists",e.Platform="Platform",e.PowerApps="PowerApps",e.PowerAppsApp="PowerAppsApp",e.PowerBI="PowerBI",e.PowerPages="PowerPages",e.PowerPointOnline="PowerPointOnline",e.Privacy="Privacy",e.Project="Project",e.Publisher="Publisher",e.SecureScore="SecureScore",e.Rewards="Rewards",e.ScdApp="ScdApp",e.Security="Security",e.SendASmile="SendASmile",e.SharePoint="SharePoint",e.SharePointAdmin="SharePointAdmin",e.SharePointApp="SharePointApp",e.SISSyncAdmin="SISSyncAdmin",e.Skype="Skype",e.SkypeAdmin="SkypeAdmin",e.SkypeForBusiness="SkypeForBusiness",e.SkypeMeetings="SkypeMeetings",e.SkypeTeams="SkypeTeams",e.StaffHub="StaffHub",e.StaffNotebook="StaffNotebook",e.Sway="Sway",e.Tasks="Tasks",e.Text="Text",e.ThirdPartyApp="ThirdPartyApp",e.ToDo="ToDo",e.UnknownApp="UnknownApp",e.Video="Video",e.VisioOnline="VisioOnline",e.VivaEngage="VivaEngage",e.VivaGoals="VivaGoals",e.VivaLearning="VivaLearning",e.VivaPulse="VivaPulse",e.VivaTopics="VivaTopics",e.VivaAmplify="VivaAmplify",e.VivaHome="VivaHome",e.WAC="WAC",e.Whiteboard="Whiteboard",e.WindowsStore="WindowsStore",e.WordOnline="WordOnline",e.Yammer="Yammer"}(i||(i={}))},e3cR:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c}));var i=n("QjXU"),r=n("obr3");function o(e,t,n){return void 0===n&&(n=1),Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,Object(r.b)(e,n,t)]}))}))}function a(e,t,n,r,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return"replace"!==r?[3,2]:ase 2:return a=e.transaction(n,"readwrite"),l=t.map((function(e,t){return a.store.put(e,o[t])})),[4,Promise.all(l)];case 3:return i.sent(),[4,a.done];case 4:return i.sent(),[2]}}))}))}function l(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,e.get(t,n)]}))}))}function s(e,toid 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return[2,e.getAll(t)]}))}))}function c(e,t,nd 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,e.delete(t,n)]}))}))}},ej7j:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},fGsv:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("QjXU"),r=n("tyUq"),o=n("lrJm"),a=n("hhzZ"),l=n("R7NL"),s=n("4/We"),c=n("/I02"),u=n("kpuN"),d=n("dFxn"),p=n("keVe"),f=function(){function e(e){this.config=e.parse("adminPolicyConfig")}return e.ɵprov=p.kc({factory:function(){return new e(p.lc(d.a))},token:e,providedIn:"root"}),e}(),h=n("wwmn"),m=n("casz"),b=n("xoWf"),g=n("pOWU"),v=n("TOqr"),S=function(e){function t(t,n,i,r,o,a,l,s,c,u,d){var p=e.call(this,o,s,l,"OfficeHome",a,c,d,u)||this;return p.globalErrorHandler=t,p.userDataStorageService=n,p.adminPolicyConfigService=i,p.capabilitiesService=r,p.fetchPolicyPromise=null,p.fetchCachedPolicyPromise=null,p}return Object(i.__extends)(t,e),t.prototype.getAdminPolicy=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.fetchCachedPolicy()];case 1:return(e=n.sent())?[2,e]:(this.fetchPolicyPromise||(this.fetchPolicyPromise=new Promise((function(e,n){var i=t.contextService.sharedContext.officeHomeApiRoot+"/"+t.adminPolicyConfigService.config.adminPolicyApiPath,r={responseType:"json",headers:new Map};t.get("Admin_Policy_Server_Request","Admin_Policy_Server",i,(function(i){i.instrument((function(e,n){e.ok||(t.fetchPolicyPromise=null)})).then((function(t){t.data&&t.data.Value||n("Null admin policies response."),e(t.data.Value)})).catch((function(e){t.fetchPolicyPromise=null,t.globalErrorHandler.handleError(e)}))}),n,r,"network-only")}))),[2,this.fetchPolicyPromise])}}))}))},t.prototype.fetchCachedPolicy=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){return(e={}).Action="FetchCachedAdminPolicyFromUserStorage",this.fetchCachedPolicyPromise||(this.fetchCachedPolicyPromise=new Promise((function(n){var i,o;t.userDataStorageService.get(t.adminPolicyConfigService.config.cacheKey,t.capabilitiesService.capabilities.pwaEnabled?1:0).then((function(a){if(a&&a.Value){var l=new Date(a.LastUpdated).getTime()+60*a.CheckInInterval*1e3;l<Date.now()?(e.State="CacheExpired",e.DebugInfo="Cache Expired, ExpireTime:"+l,i=709,o="CacheExpired",n(null)):(e.State="CacheFound",i=200,o="CacheFound",n(a.Value))}else e.State="NotFound",e.DebugInfo="No cached policies found.",o="NotFound",i=709,n(null);t.instrumentationService.logDebugCacheEvent("Admin_Policy_Cache_Request",e),Object(r-1})})).catch((function(e){t.fetchCachedPolicyPromise=null,t.globalErrorHandler.handleError(e)}))}))),[2,this.fetchCachedPolicyPromise]}))}))},t.ɵprov=p.kc({factory:function(){return new t(p.lc(o.b),p.lc(b.a),p.lc(f),p.lc(s.a),p.lc(u.b),p.lc(c.a),p.lc(l.a),p.lc(a.a),p.lc(h.a),p.lc(m.a),p.lc(v.q))},token:t,providedIn:"root"}),t}(g.a)},fKR7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return f}));var i,r=n("QjXU"),=11]="StreamsVideo",e[e.UpcomingMeeting=12]="UpcomingMeeting",e[e.MyAnalytics=13]="MyAnalytics"}(i||(i={}));var f=function(e){function t(t,n,r,a,f,h,m,b,g,v,S,y,C,w,T,k,I,_,A,P,E,O,F,D,M,R,x,L,U,N,W,j,H,B,G,q,V,z,K,Z,Q,X,J,Y,$,ee,te,ne,ie,re,oe,ae,le,se,ce,ue,de,pe,fe,he,me,be,ge,ve,Se,ye,Ce,we,Te,ke,Ie,_e,Ae,Pe,Ee,Oe,Fe){void 0===D&&(D=!1),void 0===M&&(M=!1),void 0===R&&(R=null),void 0===x&&(x=null),void 0===L&&(L=null),void 0===U&&(U=null),void 0===N&&(N=null),void 0===W&&(W=null),void 0===j&&(j=!1),void 0===H&&(H=!1),void 0===B&&(B=null),void 0===G&&(G=null),void 0===pe&&(pe=!1);var De=e.call(this,n,r,a,f,h,m,b,g,v,S,y,C,w,k,I,_,D,R,x,j,z?z.AttachmentType:void 0,H,pe)||this;if(De.format=t,De.sharingType=T,De.fromCache=P,De.application=E,De.resourceId=O,De.storageHost=F,De.isPinned=M,De.mruV2Category=L,De.mruV2Type=U,De.mruV2Id=N,De.activity=W,De.isEmailAttachment=j,De.createdDate=B,De.sharepointIds=G,De.sharing=q,De.isNew=V,De.emailReference=z,De.sharedByUsername=K,De.sharedByEmail=Z,De.sharedById=Q,De.thumbnailInfo=X,De.spoId=Y,De.isCollab=$,De.navigationId=te,De.thumbnails=ne,De.feedbackId=ie,De.serverDocId=re,De.createdBy=oe,De.teamsDeepLink=ae,De.ownerType=le,De.ownerId=se,De.ownerTenantId=ce,De.isDeleted=ue,De.isHidden=de,De.isSafeLink=pe,De.streamsThumbnailUrl=fe,De.startTime=he,De.endTime=me,De.location=be,De.locations=ge,De.attendees=ve,De.joinUrl=Se,De.organizer=ye,De.joinMeetingText=Ce,De.mediaDuration=we,De.subType=Te,De.subTypeCategory=ke,De.taskInsight=Ie,De.potentialAction=_e,De.activityUser=Ae,De.insightName=Pe,De.insightDescription=Ee,De.insightDescriptionPrefix=Oe,De.meetingArtifacts=Fe,De.mediaDurationRegex=new RegExp(/PT(\d+H)?(\d+M)?(\d*).*S?/),G||(De.sharepointIds={listId:null,listItemId:null,listItemUniqueId:null,siteId:null,siteUrl:null,webId:null}),De.documentUrl=b,t===i.Trending){var Me=De.url.match(/file=([\S]+?)(&|$)/i);if(Me&&Me.length>=2){var Re=Me[1];De.canonicalUrl=u.a.encodeUrl(x)+"/"+Re}else De.canonicalUrl=De.url;De.sharing={shared:!0}}else De.canonicalUrl=De.url||t===i.EdgeworthDocument&&De.webUrl,t===i.Shared&&(De.sharing={shared:!0});if(De.format===i.StreamsVideo&&De.mediaDuration){var xe=De.mediaDurationRegex.exec(De.mediaDuration);if(xe){var Le=xe[1],Ue=xe[2],Ne=xe[3];Le&&Le.length<3&&(Le="0"+Le),Ue&&Ue.length<3&&(Ue="0"+Ue),Ne&&Ne.length<2&&(Ne="0"+Ne),De.mediaDuration=(Le?Le.substring(0,Le.length-1)+":":"")+(Ue?Ue.substring(0,Ue.length-1)+":":"")+(Ne||"")}}if(b){if(!De.sharepointIds.siteUrl){var We=b.match(/https?:\/\/.*?\.sharepoint(-df)?\.com\/.*?\/.*?\//);We&&We.length&&(De.sharepointIds.siteUrl=We[0])}De.isMsftDogfood=b.lastIndexOf("microsoft-my.sharepoint-df.com")>-1||b.lastIndexOf("microsoft.sharepoint-df.com")>-1}if(l.a.referralFromFileLocation(De.url)===s.a.SharePoint&&(De.sharing={shared:!0}),De.lastModifiedBy&&De.lastModifiedBy.fullName&&De.lastModifiedBy.email&&De.lastModifiedTime&&(De.lastModifiedActivity=[{action:{type:p.a.Edit,data:{}},actor:{user:{displayName:De.lastModifiedBy.fullName,email:De.lastModifiedBy.email,userPrincipalName:De.lastModifiedBy.email},id:null},timestamp:De.lastModifiedTime}]),De._initialInflationCompleted=new o.a,De.initialInflationCompleted=De._initialInflationCompleted.asObservable(),"string"==typeof J&&(De.attribution=J),A===c.a.MSA)De.isOnPremOrVanity=!1;else if(ee&&ee.lastIndexOf("ONPREM")>=0)De.isOnPremOrVanity=!0;else if(ee&&ee.lastIndexOf("O365")>=0||De.fileType===l.b.Sway||De.fileType===l.b.Forms)De.isOnPremOrVanity=!1;else{var je=d.a.getHostName(De.url);De.isOnPremOrVanity=!(!je||-1!==je.lastIndexOf("sharepoint.com")||De.isMsftDogfood)}return De}return Object(r.__extends)(t,e),t.prototype.getFormEnumType=function(){if(this.subType)if("form"===this.subType.toLowerCase()&&this.subTypeCategory)switch(this.subTypeCategory.toLowerCase()){case"poll":case"teams poll":case"pptpoll":case"wordpoll":return"poll";case"assignments":return"assignments"}else if("poll"===this.subType.toLowerCase())return"poll";return"form"},t.prototype.getClickData=function(t,n,r){var o=e.prototype.getClickData.call(this,t,n,r,this.format===i.EdgeworthDocument);return o&&o.params&&(o.params.Area="Suggested_Action_Click"===t?a.b.SuggestedActions:"Recommended_Click"===t?a.b.Recommended:a.b.Documents,"boolean"==typeof this.isPinned&&(o.params.Pinned=this.isPinned.toString()),"boolean"==typeof this.isNew&&(o.params.ItemIsNew=this.isNew.toString()),this.sharing&&"boolean"==typeof this.sharing.shared&&(o.params.ItemIsShared=this.sharing.shared.toString())),o},t.prototype.getClickDataForPath=function(t,n,i){var r=e.prototype.getClickDataForPath.call(this,t,n,i);return r&&r.params&&(r.params.Area=a.b.Documents),r},t.prototype.copyInflationData=function(e,t){void 0===t&&(t=!1),e.activities&&!t&&(this.activities=e.activities.slice()),e.driveId&&(this.driveId=e.driveId),void 0===e.isNew||t||(this.isNew=e.isNew),e.sharepointIds.siteUrl&&(this.sharepointIds.siteUrl=e.sharepointIds.siteUrl),e.sharing&&!t&&(this.sharing=Object(r.__assign)({},e.sharing)),e.thumbnails&&(this.thumbnails=Object(r.__assign)({},e.thumbnails=function(){this._initialInflationCompleted.next(!0),this._initialInflationCompleted.complete()},t.prototype.shouldAddLoginHint=function(){return!this.isLocal&&!this.isOnPremOrVanity&&("OneDriveForBusiness"===this.source||"SharePoint"===this.source||"EmailAttachment"===this.source||this.fileType!==l.b.Sway&&this.fileType!==l.b.Forms&&this.fileType!==l.b.PowerBI)},t}(l.a)},"fVt+":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("7Gwk"),l=n("uWZl"),s=n("4/We"),c=n("cgnd"),u=n("keVe"),d=function(){function e(e,t,n,i){this.capabilitiesService=e,this.configParserService=t,this.startupConfigService=n,this.eventService=i}return e.prototype.getConfig=function(){var e=this;if(!this.configPromise){if(this.startupConfigService.config.authType!==c.a.MSA)return Promise.reject();if(this.capabilitiesService.capabilities.isPwaInUwp)this.configPromise=Promise.resolve(this.configParserService.parse("consumerUserConsent"));else{var t=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise(),n=l.a.fullPageReady();this.configPromise=Promise.race([t,n]).then((function(){return e.configParserService.parse("consumerUserConsent")}))}}return this.configPromise},e.ɵprov=u.kc({factory:function(){return new e(u.lc(s.a),u.lc(o.a),u.lc(c.b),u.lc(a.a))},token:e,providedIn:"root"}),e}()},fpaX:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return b}));var i=n("31lE"),r=n("Uqr9"),o=n("re3B"),a=n("4/We"),l=n("cgnd"),s=n("JH4S"),c=n("twlh"),u=n("hhzZ"),d=n("Vwd8"),p=n("keVe"),f=n("OtXi"),h=function(){function e(t,n,i,r,o,a,l){var s=this;this.clientStartupConfigService=n,this.activitySessionService=r,this.sessionActive=!1,this.ariaLogg&(this.sessionActive=!0,a.addUnloadEvent((function(){s.endAppSession(!t.capabilities.pwaEnabled)}),!0))}return e.createAriaLogger=function(t,n,r,o,a){if(!t.sharedClientStartupContext.ariaTenant||!t.sharedClientStartupContext.ariaCollectorUrl)return null;var s=e.initializeAriaLogManager(t.sharedClientStartupContext.ariaTenant,t.sharedClientStartupContext.ariaCollectorUrl),c=t.puid,u=i.AWTUserIdType.Unknown;if(c?t.authType===l.a.OrgId?u=i.AWTUserIdType.OrgIdPUID:t.authType===l.a.MSA&&(u=i.AWTUserIdType.MSAPUID):c=e.unknownUserId,s.getSemanticContext().setUserId(c,i.AWTPiiKind.NotSet,u),s.setContext("UserInfo.OMSTenantId",t.tenantId),s.setContext("AuthType",t.authTypeString),s.setContext("AuthVer",t.authVersion),s.setContext("CorpNet",t.sharedClientStartupContext.corpNet),s.setContext("CorrelationId",t.sharedClientStartupContext.correlationId),s.setContext("DevEnvironment",t.sharedClientStartupContext.devEnvironment),s.setContext("DeploymentEnvironment",t.sharedClientStartupContext.deploymentEnvironment),s.setContext("Geo",t.sharedClientStartupContext.geoName),s.setContext("RequestOrigin",t.sharedClientStartupContext.requestOrigin),s.setContext("SessionId",t.sharedClientStartupContext.sessionId),s.setContext("TestTraffic",t.sharedClientStartupContext.testTraffic),a&&s.setContext("Workload",a.getWorkload()),s.setContext("ServerBuildDate",t.sharedClientStartupContext.buildDateUtc),s.setContext("ServerBuildId",t.sharedClientStartupContext.buildId),s.setContext("BundleBuildDate","2024-01-09 10:16:19.560"),s.setContext("BundleBuildId","53e722e1-1fae-9b16-8174-18529a8e07ce"),s.setContext("EcsRing",t.sharedClientStartupContext.ecsRing),s.setContext("DomainOrigin",t.sharedClientStartupContext.domainOrigin),s.setContext("Flights",t.sharedClientStartupContext.flights+(t.sharedClientStartupContext.flights&&t.features?",":"")+t.features),n&&(s.setContext("Admin",n.user.isAdmin),s.setContext("IsSmb",n.user.isSmb),s.setContext("IsIw",n.user.isIw),s.setContext("IsEdu",n.user.isEdu),s.setContext("IsEduStudent",n.user.isEduStudent),s.setContext("IsEduFaculty",n.user.isEduFaculty),s.setContext("IsDynamics",n.user.isDynamics),s.setContext("ThemeId",n.user.themeId),s.setContext("IsFirstRelease",n.user.isFirstRelease)),r&&(s.setContext("FirstVisit",r.isFirstVisit()),s.setContext("FirstVisitAgeInDays",r.fullDaysSinceFirstVisit())),o){s.setContext("WrapperVersion",o.major+"."+o.minor+"."+o.build+"."+o.revision);var d=void 0;if(a.capabilities.isPwaInWebView2)d="WebView2";else if(a.capabilities.isPwaInUwp){var p=new RegExp("1[0-9]{2}10");d=(null==o?void 0:o.build)&&p.test(o.build.toString())?"UWP_fallback":"UWP"}d&&s.setContext("AppWorkloadType",d)}return e.startSession(s),s},e.endSession=function(t,n,r){window.disableLogs||(r=r||new i.AWTEventProperties,e.populateSessionProperties(r),t.logSession(i.AWTSessionState.Ended,r)),n?i.AWTLogManager.flushAndTeardown():i.AWTLogManager.flush(null)},e.prototype.trackEvent=function(t,n){if(this.ariaLogger){this.sessionActive||(e.startSession(this.ariaLogger),this.sessionActive=!0);var r=this.clientStartupConfigService.config,o=new i.AWTEventProperties;for(var a in o.setName(t),n)if(n.hasOwnProperty(a)){var l=n[a];l instanceof u.d?r.logPiiAllowed&&(r.logPiiInClearText?o.setProperty(a,l.value):o.setPropertyWithPii(a,l.value,l.kind)):o.setProperty(a,l)}this.ariaLogger.logEvent(o)}},e.prototype.endAppSession=function(t){if(this.ariaLogger&&this.sessionActive){var n=new i.AWTEventProperties,o=this.activitySessionService.endSession();if(o){var a=r.a.now()-o.inactivityStartTime;n.setProperty("ActivityDuration",Math.ceil(o.cumulativeDurationOfActivitySessions/1e3).toString()),n.setProperty("InactivityDuration",Math.ceil((o.cumulativeDurationBetweenActivitySessions+a)/1e3).toString()),n.setProperty("ItemCount",o.activitySessionsCount.toString()),n.setProperty("ClickCount",o.cumulativeClickCount.toString())}e.endSession(this.ariaLogger,t,n),this.sessionActive=!1}},e.startSession=function(t){if(!window.disableLogs){var n=new i.AWTEventProperties;e.populateSessionProperties(n),t.logSession(i.AWTSessionState.Started,n)}},e.populateSessionProperties=function(e){e.setProperty("LoggerId","Angular"),window.prelaunchMode&&e.setProperty("PrelaunchMode","true")},e.initializeAriaLogManager=function(t,n){var r={collectorUri:n,enableAutoUserSession:!1,propertyStorageOverride:{setProperty:function(t,n){return e.setProperty(t,n)},getProperty:function(t){return e.getProdocument.cookie&&e.legacyAriaCookies.forEach((function(t){document.cookie=t+e.removeCookieString})),i.AWTLogManager.initialize(t,r)},e.setProperty=function(t,n){e.propertyMap.set(t,n)},e.getProperty=function(t){return e.propertyMap.has(t)?this.propertyMap.get(t):""},e.unknownUserId="Unknown",e.legacyAriaCookies=["MicrosoftApplicationsTelemetryDeviceId","MicrosoftApplicationsTelemetryFirstLaunchTime"],e.removeCookieString="=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",e.propertyMap=new Map,e.ɵprov=p.kc({factory:function(){return new e(p.lc(a.a),p.lc(l.b),p.lc(s.a),p.lc(c.a),p.lc(d.b),p.lc(o.a),p.lc(f.a,8))},token:e,providedIn:"root"}),e}(),m=function(){function e(e,t,n,i){this.ariaService=e,this.streamName=t,this.params=n,this.metrics=i}return e.prototype.record=function(){var e={};for(var t in this.params)e[t]=this.params[t];this.ariaService.trackEvent(this.streamName,e)},e}(),b=function(){function e(e){this.ariaService=e}return new m(this.ariaService,e,t,n)},e.prototype.flush=function(){this.ariaService.endAppSession(!0)},e.ɵprov=p.kc({factory:function(){return new e(p.lc(h))},token:e,providedIn:"root"}),e}()},"g/dT":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("kxm0"),r=n("W3Zz"),o=(n("hhzZ"),function(){function e(e,t){this.deviceDetector=e,this.instrumentationService=t}return e.prototype.ngOnInit=function(){var e={};e.DevicePlatform=r.e[this.deviceDetector.getDeviceInfo().platform.platformType],this.instrumentationService.logGenericEvent(this.pageName,e,[this.pageName]);var t=!0;window.prelaunchMode&&(t=!1),Object(i.d)({isIntentional:t,eventName:this.pageName})},e}ction e(e,t,n){this.elementReference=e,this.renderer=t,this.themingService=n,this.toolTipSpan=null}rmentReference.nativeElement.onfocus=function(){e.elementReference.nativeElement.title&&e.onEvent()},this.elementReference.nativeElement.onblur=function(){e.toolTipSpan&&e.renderer.removeChild(e.elementReference.nativeElement,e.toolTipSpan),e.toolTipDelayTimeout&&(clearTimeout(e.toolTipDelayTimeout),e.toolTipDelayTimeout=null)}},e.prototype.onEvent=function(){var e=this;this.toolTipDelay().then((function(){e.toolTipSpan=document.createElement("span"),e.toolTipSpan.classList.add("ohp-keyboardfocus-tooltip"),e.toolTipSpan.classList.add("ohpAppTheme"),e.toolTipSpan.classList.add("ms-fcl-nd"),e.toolTipSpan.classList.add("ms-bgc-w"),e.toolTipSpan.innerText=e.elementReference.nativeElement.title,e.renderer.appendChild(e.elementReference.nativeElement,e.toolTipSpan)}))},e.prototype.toolTipDelay=function(){var e=this;return new Promise((function(t){e.toolTipDelayTimeout=setTimeout((function(){t()}),1e3)}))},e}()},gB6C:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("8wW2"),r=n("AGMK"),o=n("z0B0"),a=n("iPRk");function l(){return{cancel:function(){return null},cancelAndRunNow:function(){return null},adjustPriority:function(){return null}}}var s,c=n("UY9y"),u=new(n.n(c).a)([],(function(e,t){return function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}(e,t)})),d=n("Zmq1"),p=n("VKX6"),f="Safari"===Object(d.a)().browser.browserType,h=f?function(e,t){return window.setTimeout((function(){var t=Object(p.a)();e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Object(p.a)()-t))}})}))}:requestIdleCallback,m=f?function(e){clearTimeout(e)}:cancelIdleCallback,b=n("pdjy"),g=!1,v=Object(r.a)(),S=!0;function y(e){for(;g||e&&e.timeRemaining()>0;){var t=u.pop();if(!t)break;if(!t.cancelled)try{t.work(e),t.completed=!0}catch(e){Object(i.a)().handleError(e,"DXUlK")}}u.peek()&&C()}function C(){g&&y(),s||(s=h((function(e){v&&(v=!1,Object(a.a)("First_Idle_React")),s=null,y(e)})))}function w(e,t){if(t===b.e)return e(),l();S&&(S=!1,Object(a.a)("First_Schedule_React"));var n={work:e,priority:t,cancelled:!1,completed:!1},i=function(e){var t=function(){return e.cancelled=!0};return{cancel:t,cancelAndRunNow:function(){e.cancelled||(t(),e.completed||(e.work(),e.completed=!0))},adjustPriority:function(n){return t(),e.completed?l():w(e.work,n)}}}(n);return u.push(n),C(),i}Object(o.a)((function(e){(g="visible"!==e)&&(v=!1,s&&(m(s),s=null),y())}))},"gO/A":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("QjXU"),r=n("CMIS"),o=n("FPnS"),a=n("hUdb"),l=n("SQAW"),s=n("ro+v"),c=n("XjVN"),u=n("f0qX"),d=n("4/We"),p=n("cgnd"),f=n("dFxn"),h=n("uzn7"),m=n("Xn3c"),b=n("Z0U4"),g=n("w1PR"),v=n("keVe"),S="HarmonyTheme",y=function(){function e(e,t,a,d,f,h,m){var b=this;if(this.capabilitiesService=e,this.clientStartupService=t,this.configParserService=a,this.localStorageService=d,this.routeService=f,this.themingService=h,this.userDataStorageService=m,e.capabilities.visualEnabled){try{this.visualModuleObservable=Object(s.a)(Promise.all([n.e(8),n.e(0),n.e(1),n.e(2),n.e(45),n.e(58),n.e(101),n.e(747)]).then(n.bind(null,"VfNa"))),this.visualDataModuleObservable=Object(s.a)(Promise.all([n.e(0),n.e(1),n.e(2),n.e(45),n.e(108),n.e(690),n.e(771)]).then(n.bind(null,"p70R")))}catch(e){Object(r.a)({eventName:"VisualServiceOfficeStartChunkLoadError"})}this.visualConfigSubscription=Object(c.b)(this.visualModuleObservable,this.visualDataModuleObservable,this.themingService.themeShades,this.themingService.darkModeSubscription,this.routeService.getRouteChangeEndObservable()).pipe(Object(u.a)((function(e){var t,n=Object(i.__read)(e,5),r=n[0],a=n[1],l=n[2],s=n[3],c=n[4],u=((null===(t=l.theme.themeId)||void 0===t?void 0:t.toLowerCase())===g.b.baseThemeId||l.theme.themeId===g.b.staticDarkTheme)&&l.theme.reactShellTheme.PreferOfficeTheme||l.theme.themeId===g.b.baseWithOfficeThemePreferredThemeId?g.b.officeThemeId:l.theme.themeId,d=null==r?void 0:r.isVisualBackgroundEnabled(b.clientStartupService.config.authType===p.a.MSA,window.matchMedia("(-ms-high-contrast: active)").matches||window.matchMedia("(forced-colors: active)").matches,null==r?void 0:r.getRouteFlight(c.currentRoute.route),u,s?o.a.dark:o.a.default,b.getVisualGates());return!b.harmonyThemeSubscription&&a&&b.capabilitiesService.capabilities.visualSettingEnabled&&(b.harmonyThemeSubscription=a.harmonyThemeObservable.subscribe((function(e){b.updateTheme(e)}))),{visualBackgroundEnabled:d,visualInitialized:void 0!==r&&void 0!==a,visualOfficeWrapperStyle:b.getVisualOfficeWrapperStyle(c.currentRoute.route)}}))),this.initializeHarmonyTheme()}else this.visualConfigSubscription=l.a.create()}return e.prototype.ngOnDestroy=function(){var e;null===(e=this.harmonyThemeSubscription)||void 0===e||e.unsubscribe()},e.prototype.getVisualGates=function(){return{visualAppsModuleEnabled:this.capabilitiesService.capabilities.visualAppsModuleEnabled,visualBackgroundEnabled:this.capabilitiesService.capabilities.visualBackgroundEnabled,visualCreateCenterModuleEnabled:this.capabilitiesService.capabilities.visualCreateCenterModuleEnabled,visualEnabled:this.capabilitiesService.capabilities.visualEnabled,visualFeedModuleEnabled:this.capabilitiesService.capabilities.visualFeedModuleEnabled,visualMyContentModuleEnabled:this.capabilitiesService.capabilities.visualMyContentModuleEnabled,visualSettingEnabled:this.capabilitiesService.capabilities.visualSettingEnabled}},e.prototype.getVisualOfficeWrapperStyle=function(e){return"OfficeHome"===e||"Pwa"===e||"Create"===e?{position:"relative"}:{}},e.prototype.initializeHarmonyTheme=function(){this.capabilitiesService.capabilities.visualSettingEnabled&&(this.capabilitiesService.capabilities.pwaEnabled||(this.capabilitiesService.capabilities.pwaEnabled&&this.capabilitiesService.capabilities.isConsumerUser?this.initializeHarmonyThemeLocalStorage():this.initializeHarmonyThemeUserStorage()))},e.prototype.initializeHarmonyThemeUserStorage=funchis;this.userDataStorageService.get(S,1).then((function(t){e.updateTheme(t)})).catch((function(e){}))},e.prototype.initializeHarmonyThemeLocalStorage=function(){var e=this.localStorageService.get(S);this.updateTheme(e)},e.prototype.updateTheme=function(e){e&&((null==e?void 0:e.preferHarmonyTheme)||this.clientStartupService.config.authType===p.a.MSA)&&(this.initializeUserPersonalizationSetting(),this.themingService.updateVisualsTheme(e.id,e.mode===a.b.Dark,this.userPersonalizationAllowed))},e.prototype.initializeUserPersonalizationSetting=function(){if(void 0===this.userPersonalizationAllowed)if(this.clientStartupService.config.authType!==p.a.MSA){try{var e=this.configParserService.parse(this.capabilitiesService.capabilities.pwaEnabled?"navBarData":"navbarData");if(null==e?void 0:e.ClientData){var t=JSON.parse(e.ClientData).UserPersonalizationAllowed;return void(this.userPersonalizationAllowed=null!=t&&t)}}catch(e){}this.userPersonalizationAllowed=!1}else this.userPersonalizationAllowed=!0},e.ɵprov=v.kc({factory:function(){return new e(v.lc(d.a),v.lc(p.b),v.lc(f.a),v.lc(h.a),v.lc(b.a),v.lc(g.b),v.lc(m.a))},token:e,providedIn:"root"}),e}()},gktR:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("QjXU"),r=n("Dn7E"),o=n("laSs"),a=n("lrJm"),l=n("R7NL"),s=n("3GGT"),c=n("hhzZ"),u=n("kpuN"),d=n("uzn7"),p=n("wwmn"),f=n("casz"),h=n("xoWf"),m=n("pOWU"),b=n("/I02"),g=n("keVe"),v=n("TOqr"),S=function(e){function t(t,n,i,r,o,a,l,s,c,u){var d=e.call(this,t,i,n,"OfficeHome",r,o,a,l)||this;return d.localStorageService=s,d.userDataStorageService=c,d.globalErrorHandler=u,d.requestConfig={headers:new Map([["Accept","application/json"]])},d.alreadyCompleted=!1,d}return Object(i.__extends)(t,e),t.prototype.fetchFirstRunData=function(e,n,i){var r=this;return void 0===n&&(n=!1),new Promise((function(o){var a="_"+i,l=r.localStorageService.get(a)||r.createInitialFirstRunData(e);if(n)o(l);else{var s=!1;l.CompletedFirstRun&&(s=!0,o(l)),r.userDataStorageService.get(i,t.LoadFromUserStorageRemoteAttempts).then((function(e){e&&e.CompletedFirstRun?l.CompletedFirstRun||(s=!0,o(e),r.localStorageService.set(a,e)):l.CompletedFirstRun&&r.storeFirstRunDataInUserStorage(l,i)})).catch((function(e){r.globalErrtOo"),l.CompletedFirstRun&&r.storeFirstRunDataInUserStorage(l,i)})).then((function(){s||(s=!0,o(l))}))}}))},t.prototype.updateFirstRunData=function(e,t,n,i){var r=this;void 0===i&&(i=!0),this.fetchFirstRunData(e.Version,!1,t).then((function(o){var a="_"+t,l=e.CompletedFirstRun;(o.CompletedFirstRun||e.StepsCompleted>=e.TotalSteps)&&(e.CompletedFirstRun=!0),e.FurthestCompleted=o.FurthestCompleted,(void 0===o.FurthestCompleted||e.StepsCompleted>o.FurthestCompleted)&&(e.FurthestCompleted=e.StepsCompleted),r.localStorageService.set(a,e),r.storeFirstRunDataInUserStorage(e,t),i&&r.instrumentFirstRunData(e,n,l)}))},t.prototype.forceRefreshAndGetLicenseStatus=function(){var e=this;return new Promise((function(n,i){e.get("Office_Consumer_License_Fetch","Office_Consumer_License_Fetch",e.contextService.sharedContext.officeHomeApiRoot+t.ConsumerLicenseStatusEndpoint+"?"+t.ConsumerLicenseStatusForceRefreshQuery,(function(e){e.instrument((function(e,t){t.HttpCode=e.ok?s.a.OK.toString():s.a.UnexpectedResponse.toString()})).then((function(e){n(e.data)}))}),(function(t){e.globalErrorHandler.handleError(t,"wCBHa"),i(t)}),e.requestConfig,"network-only")}))},t.protype.createInitialFirstRunData=function(e)n:e}},t.prototype.storeFirstRunDataInUserStorage=function(e,t){this.userDataStorageService.set(t,e)},t.prototype.instrumentFirstRunData=function(e,t,n){var i={};i.FirstRunStepsCompleted=e.StepsCompleted.toString(),i.FirstRunTotalSteps=e.TotalSteps?e.TotalSteps.toString():"0",i.FirstRunVersion=e.Version.toString(),i.FirstRunFurthestCompleted=e.FurthestCompleted.toString(),i.FirstRunUserDismissedCallout=n.toString(),e.CompletedFirstRun&&!this.alreadyCompleted&&(this.instrumentationService.logGenericEvent("First_Run_Completed",i),Object(r.a)({featureName:"FirstRun",eventName:"First_Run_Completed",params:i}),this.alreadyCompleted=!0),e.CompletedFirstRun&&void 0===t||(i.ItemCategory=t,this.instrumentationService.logImpressionEvent("First_Run_Impression",i),Object(o.a)({eventName:"First_Run_Impression",area:t}))},t.firstRunDataKey="FirstRunData",t.LoadFromUserStorageRemoteAttempts=2,t.ConsumerLicenseStatusEndpoint="/api/license/consumer",t.ConsumerLicenseStatusForceRefreshQuery="forceRefresh=true",t.ɵprov=g.kc({factory:function(){return new t(g.lc(u.b),g.lc(l.a),g.lc(c.a),g.lc(b.a),g.lc(p.a),g.lc(v.q),g.lc(f.a),g.lc(d.a),g.lc(h.a),g.lc(a.b))},token:t,providedIn:"root"}),t}(m.a)},gmml:function(e,t,n){"use strict";n.r(t);var i=n("QjXU"),r=n("keVe"),o=n("Cin9"),a=n("Dn7E"),l=n("zvoD"),s=n("3Vsh"),c=n("0XE2"),u=n("lrJm"),d=n("hZW2"),p=n("wwmn"),f=n("BMb5"),h=n("cgnd"),m=n("6cfW"),b=new r.u("SERVICE_WORKER_REGISTRATION_HANDLERS"),g=n("+2OL"),v=n("JWB6"),S=new r.u("SERVICE_WORKER_ENABLED"),y=n("511z"),C=n("5MEU"),w=new r.u("SERVICE_WORKER_GET_REGISTRATION_BY_SCOPE"),T=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d){this.serviceWorkerConfigService=e,this.serviceWorkerEnabled=t,this.hasServiceWorkerApi=n,this.windowService=i,this.startupConfigService=r,this.globalErrorHandler=o,this.workloadQueryParameterValue=a,this.officeHomeApiConfig=l,this.serviceWorkerStateService=s,this.documentService=c,this.registrationHandlers=u,this.getRegistrationByScope=d}return e.prototype.initialize=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o,a,l,s,c,u,d,p,f,h,b,g,v;return Object(i.__generator)(this,(function(S){switch(S.label){case 0:if(!this.hasServiceWorkerApi)return[2];this.serviceWorkerContainer=this.windowService.nativeWindow.navigator.serviceWorker,S.label=1;case 1:return S.trys.push([1,11,,12]),"Controlled"!==this.serviceWorkerStateService.currentState?[3,3]:[4,this.serviceWorkerContainer.getRegistration(this.getRegistrationByScope?this.serviceWorkerConfigService.config.scope:void 0)];case 2:e=S.sent(),S.label=3;case 3:if(!this.serviceWorkerEnabled)return[3,8];n=(t=this.serviceWorkerConfigService.config).scriptUrl,r=t.scope,(o=new URLSearchParams).append("cdnDomain",this.startupConfigService.config.cdnDomain),o.append(this.officeHomeApiConfig.config.workloadQueryParameter,this.workloadQueryParameterValue),a=new URLSearchParams(this.windowService.nativeWindow.location.search),l=this.getFlightsForRegistrationUrl();try{for(s=Object(i.__values)(l),c=s.next();!c.done;c=s.next())o.append("serviceWorkerFlight",c.value)}catch(e){g={error:e}}finally{try{c&&!c.done&&(v=s.return)&&v.call(s)}finally{if(g)throw g.error}}return this.startupConfigService.config.automatedTestRunning&&(u=a.get("envType"),o.append("envType",u)),d=n+"?"+o.toString(),e?(p=this.windowService.nativeWindow.location.origin,f=e.active.scriptURL.toLowerCase()!==(p+d).toLowerCase(),h=e.scope.toLowerCase()!==(p+r).toLowerCase(),f||h?[4,this.registerServiceWorker(d,r)]:[3,5]):[3,6];case 4:e=S.sent(),S.label=5;case 5:return[3,8];case 6:return[4,this.registerServiceWorker(d,r)];case 7:e=S.sent(),S.label=8;case 8:return e&&this.registrationHandlers?[4,Promise.all(this.registrationHandlers.map((function(t){return t.handleRegistration(e)})))]:[3,10];case 9:S.sent(),S.label=10;case 10:return[3,12];case 11:return b=S.sent(),Object(m.a)(b)?[2]:(this.globalErrorHandler.handleError(b,"qKgQM"),[3,12]);case 12:return[2]}}))}))},e.prototype.registerServiceWorker=function(e,t){var n=this;return new Promise((function(i){var r=function(){i(n.serviceWorkerContainer.register(e,{scope:t})),n.windowService.nativeWindow.removeEventListener("load",r)};"complete"===n.documentService.nativeDocument.readyState?r():n.windowService.nativeWindow.addEventListener("load",r)}))},e.prototype.getFlightsForRegistrationUrl=function(){var e=this.startupConfigService.config.sharedClientStartupContext.flights,t=this.serviceWorkerConfigService.config,n=t.serviceWorkerAllowedFlights,r=t.pilotFlights,o=new Set(Object(i.__spread)(e.split(","),r));return n.filter((function(e){return o.has(e)}))},e.ɵprov=r.kc({factory:function(){return new e(r.lc(g.a),r.lc(S),r.lc(y.a),r.lc(f.b),r.lc(h.b),r.lc(u.b),r.lc(C.a),r.lc(p.a),r.lc(v.a),r.lc(d.a),r.lc(b,8),r.lc(w,8))},token:e,providedIn:"root"}),e}(),k=n("31lE"),I=n("3vWs"),_=n("Zmq1"),A=n("+1lv"),P=n("CMIS"),E=n("uV9m"),O=n("fpaX"),F=n("hhzZ"),D=n("Uqr9"),M=n("DAwf");function R(e,t,n){if(void 0===n&&(n=!0),n&&console.error(e),t){var i=!1;try{Zone.assertZonePatched()}catch(e){i=!0}var r=window.queuedEvents||[],a=window.queuedMarks,l="number"==typeof window.windowsDataSecuritySetting?window.windowsDataSecuritySetting:3;if(D.b.performanceLoggingSupported(window)){var s=function(e,t,n){(n=n||{}).Latency=t.toString(),n.ItemCategory="Bootstrapper",r.push({streamName:"Performance_Dump",eventName:e,eventParams:n,metrics:[],securityThreshold:0}),Object(o.a)({eventName:e,latency:t})},c=function(e,t,n){(n=n||{}).Error=e,n.DebugInfo=t,n.ItemCategory="Bootstrapper",r.push({streamName:"Generic_Event",eventName:"Performance_Mark_Failure",eventParams:n,metrics:[],securityThreshold:0}),Object(P.a)({eventName:"Performance_Mark_Failure"})};a&&a.splice(0,a.length).forEach((function(e){var t=e.measureFrom||"navigationStart";try{window.performance.measure(e.markName,t,e.markName)}catch(n){return void c(e.markName,"Failed to record <"+e.markName+"> starting from <"+t+">: exception is thrown",e.eventParams)}var n=window.performance.getEntriesByName(e.markName,"measure");if(n&&n.length){var i=Math.ceil(n[0].duration);s(e.markName,i,e.eventParams)}else c(e.markName,"FailName+">: me.b.getBrowserTimingMeasures(window,(function(e,t){c(e,t)})).forEach((function(e){s(e.name,e.duration)}))}var u=e&&e.stack||"Browser did not provide stack trace",d=e&&e.message||"No Error Message Provided";d.lastIndexOf(".")!==d.length-1&&(d+=".");var p="Fatal error preventing Angular bootstrap: "+d+" Zone error: "+i;Object(P.a)({eventName:"Bootstrap_Unhandled_Exception",message:p,debugInfo:u}),function(e,t){try{return Object(M.a)(t.cdnDomain),Object(A.c)({appName:t.sharedClientStartupContext.oTelAppName,appPlatform:"HWA"===window.otelWorkload?"Universal":"Web",appWorkload:void 0===window.otelWorkload?"Web":window.otelWorkload,bundleBuildDate:t.sharedClientStartupContext.buildDateUtc,bundleBuildId:t.sharedClientStartupContext.buildId,correlationId:t.sharedClientStartupContext.correlationId,dataBoundary:t.dataBoundary,deploymentEnvironment:t.sharedClientStartupContext.deploymentEnvironment,deviceType:x(),ecsRing:t.sharedClientStartupContext.ecsRing,flights:t.sharedClientStartupContext.flights,identity:{authType:t.authType,isMsa:t.authType===I.a.MSA,isOrgId:t.authType===I.a.OrgId,objectId:t.objectId,puid:t.puid,tenantId:t.tenantId,encryptionConfig:void 0,userPrincipalName:void 0},isCorpNet:t.sharedClientStartupContext.corpNet,isTestTraffic:t.sharedClientStartupContext.testTraffic,IsSamplingEnabled:t.sharedClientStartupContext.oTelSamplingEnabled,oTelEnabled:t.sharedClientStartupContext.oTelEnabled,oTelAriaTenant:t.sharedClientStartupContext.oTelAriaTenant,oTelAriaNameSpace:t.sharedClientStartupContext.oTelNameSpace,sessionId:t.sharedClientStartupContext.sessionId,serverLocation:t.sharedClientStartupContext.geoName,userSegment:void 0,requestOrigin:t.sharedClientStartupContext.requestOrigin,oTelDiagnosticAriaNameSpace:t.sharedClientStartupContext.oTelDiagnosticEnabled?t.sharedClientStartupContext.oTelDiagnosticNameSpace:void 0,oTelDiagnosticAriaTenant:t.sharedClientStartupContext.oTelDiagnosticEnabled?t.sharedClientStartupContext.oTelDiagnosticAriaTenant:void 0}).then((function(){Object(E.a)([{logEvent:A.e,flush:function(){}}],{actionEnabled:t.sharedClientStartupContext.oTelClickEnabled,diagnosticEnabled:t.sharedClientStartupContext.oTelDiagnosticEnabled,errorEnabled:t.sharedClientStartupContext.oTelErrorEnabled,featureEnabled:t.sharedClientStartupContext.oTelFeatureEnabled,impressionEnabled:t.sharedClientStartupContext.oTelImpressionEnabled,pageViewEnabled:t.sharedClientStartupContext.oTelPageViewEnabled,perfEnabled:t.sharedClientStartupContext.oTelPerfEnabled,requestEnabled:t.sharedClientStartupContext.oTelRequestEnabled},{perfSamplingEnabled:t.sharedClientStartupContext.oTelSamplingPerformanceEnabled,requestSamplingEnabled:t.sharedClientStartupContext.oTelSamplingRequestEnabled},e)}))}catch(e){return console.error(e),Promise.resolve()}}(l,t).then((function(){var e=O.b.createAriaLogger(t);if(e){r.length>0&&(r.forEach((function(t){if(!((t.securityThreshold||0)>l)){var n=new k.AWTEventProperties,i=t.eventParams;if(i)for(var r in i)i.hasOwnProperty(r)&&n.setProperty(r,i[r]);n.setName(t.streamName),n.setProperty("EventName",t.eventName),n.setProperty("AppSecurityLevel",l),e.logEvent(n)}})),window.queuedEvents=[]);var n=function(e){var t=new k.AWTEventProperties;return t.setName(e),t.setProperty("EventName","Unhandled_Exception"),t.setProperty("ItemCategory","Bootstrap"),t.setProperty("Error",F.a.filterPii(p)),t.setProperty("AppSecurityLevel",l),t},i=n("Generic_Event");t.logPiiAllowed&&i.setPropertyWithPii("DebugInfo",u,t.logPiiInClearText?k.AWTPiiKind.NotSet:k.AWTPiiKind.GenericData),e.logEvent(i);var o=n("Generic_Debug_Cache_2");o.setProperty("DebugInfo",u),e.logEvent(o),O.b.endSession(e,!0)}}))}}function x(){switch(Object(_.a)().platform.platformType){case"AndroidPhone":return"AndroidPhone";case"AndroidTablet":return"AndroidTablet";case"Chromebook":return"Chromebook";case"Linux":return"Linux";case"Mac":return"Mac";case"PC":return"PC";case"WindowsPhone":return"WindowsPhone";case"iPad":return"iPad";case"iPhone":return"iPhone";default:return"Other"}}var L,U,N,W=n("twlh"),j=function(){function e(e,t,n,i){ype.record=function(){"Generic_Click"===this.streamName&&this.activitySessionService.incrementClick()},e}(),H=function(){function e(e){this.activitySessionService=e}return e.prototype.createEvent=function(e,t,n){return new j(this.activitySessionService,e,t,n)},e.prototype.flush=function(){},e.ɵprov=r.kc({factory:function(){return new e(r.lc(W.a))},token:e,providedIn:"root"}),e}(),B=n("HQCr"),G=n("rTyw"),q=function(){function e(){}return e.setup=function(t){if(document.body&&document.body.addEventListener){var n=-1!==n.indexOf("MSIE")?"click":"mousedown";document.body.addEventListener(n,(function(n){e.processClick(n,t)}))}},e.processClick=function(t,n){for(var i=t.srcElement||t.target;i&&(!i.tagName||!e.supportedClickTargets.hasOwnProperty(i.tagName.toUpperCase()));)i=i.parentElement||i.parentNode;if(i){var r=i.getAttribute("data-clicklog");if(!r||"CUSTOM"!==r.toUpperCase()){var o=i.getAttribute("data-referral");null!=o&&0!==o.length||(o=e.referralFromElement(i));var a=i.getAttribute("data-referral-platform"),l=i.getAttribute("data-area");null!=l&&0!==l.length||(l=e.areaFromElement(i));var s=!!i.getAttribute("data-nav"),c=o?Object(G.a)(o):i.id;e.logGenericClick(c,l,o,a,s,n),null!==o&&Object(B.a)(c,null!=l?l:"Other",o)}}},e.logGenericClick=function(e,t,n,i,r,o){o.logClickEvent("Generic_Click",e,t,n,i,void 0,void 0,void 0,r)},e.areaFromElement=function(e){var t=e.id||null;if(t&&t.length){var n="O365_";if(0===t.lastIndexOf(n,n.length))return F.b.Shell;var i="obf-";if(0===t.lastIndexOf(i,i.length))return F.b.Feedback}var r=e.classList||null;if(r&&r.length)for(var o="o365cs-",a=0;a<r.length;a++)if(0===r.item(a).lastIndexOf(o,o.length))return F.b.Shell;return null},e.referralFromElement=function(t){var n=t.id||null;if(n&&n.length){if(0===n.lastIndexOf(e.shellAppTileElementIdPrefix,e.shellAppTileElementIdPrefix.length)){var i=n.substring(e.shellAppTileElementIdPrefix.length),r="Shell";return 0===i.lastIndexOf(r,r.length)&&(i=i.substring(r.length)),i}var o=t.classList||null;if(o&&o.length&&o.contains("o365cs-nav-appTile"))return n}return null},e.shellAppTileElementIdPrefix="O365_AppTile_",e.supportedClickTargets={A:!0,IMG:!0,AREA:!0,INPUT:!0,BUTTON:!0},e}(),V=n("p6wn"),z=n("Vwd8"),K=n("9WrL"),Z=n("kpuN"),Q=n("MMsA"),X=n("7Gwk"),J=n("Z0U4"),Y=n("4/We"),$=n("uWZl"),ee=0,te=!1;function ne(e){var t=this,r=e.injector,p=r.get(X.a),f=function(e){try{if(0!==ee)return!1;if(ee=1,e&&!r.get(d.a).nativeDocument.getElementById("ShellInfoLoaded"))return ee=0,!1;r.get(T).initialize();var l=r.get(J.a),s=r.get(v.a);l.start();var c=r.get(F.a);q.setup(c);var f=Math.ceil(L);c.logPerformanceEvent("App_Begin_Bootstrap",f),c.logPerformanceEvent("App_Complete_Bootstrap",Math.ceil(U)-f),Object(o.a)({eventName:"App_Begin_Bootstrap",latency:f}),Object(o.a)({eventName:"App_Complete_Bootstrap",latency:Math.ceil(U)-f}),r.get(W.a).initialize(c);var m=r.get(Y.a),b=m&&m.capabilities.otherFlights||"",g=Object(h.c)(),S=g&&g.sharedClientStartupContext.flights?g.sharedClientStartupContext.flights:"";if(g.sharedClientStartupContext.flights=S+(S?",":"")+b,c instanceof V.a){c.registerOfficeRouteService(l),c.registerServiceWorkerStateService(s,!0);var y=r.get(z.a),C=r.get(H),w=r.get(O.a);c.registerEventFactories([y,C,w])}g.sharedClientStartupContext.oTelEnabled&&r.get(K.a).bootstrapOfficeStart(),te=!0;var k=r.get(Z.b);return r.get(Q.a).initialize(k),(p=r.get(X.a)).broadcastEvent({name:"appInitialized",args:[]}),function(e,o){Object(i.__awaiter)(t,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return r.get(K.a).bootstrapOfficeStart(),e&&Promise.all([n.e(0),n.e(1),n.e(2),n.e(582)]).then(n.bind(null,"hfNz")).then((function(e){e.prefetchNorthStar()})),o&&Promise.all([n.e(0),n.e(1),n.e(2),n.e(112),n.e(637)]).then(n.bind(null,"3xKL")).then((function(e){e.prefetchEdgeworthData()})),[2]}))}))}(m.capabilities.northStarEnabled,m.capabilities.edgeworthReactEnabled),m.capabilities.showSearch&&c.logGenericEvent("Search_Capability"),r.get(z.b).isFirstVisit()&&c.logGenericEvent("First_Site_Visit"),m.capabilities.stickyPagesEnabled&&(r.get(K.a).bootstrapOfficeStart(),Promise.all([n.e(0),n.e(1),n.e(60),n.e(122)]).then(n.bind(null,"ujK1")).then((function(e){return e.initializeFolders().then((function(){Object(a.a)({featureName:"Other",eventName:"MfsFoldersInitialization",params:{Success:!0}})})).catch((function(e){Object(a.a)({featureName:"Other",eventName:"MfsFoldersInitialization",params:{Success:!1,ErrorType:"Other",ErrorMessage:"string"==typeof e?e:JSON.stringify(e,Object.getOwnPropertyNames(e))}})}))}))),ee=2,!0}catch(e){ee=0;var I=!1;if(te){var _=r.get(u.b);_&&(_.handleError(e,"b0g6P"),I=!0)}return I||R(e,N),!1}};Object(c.a)()?f(!1):f(!0)||(p.events.withScope(0).pipe(Object(l.a)((function(e){return"shellInfoLoaded"===e.name})),Object(s.a)(1)).toPromise().then((function(){return f(!1)})),$.a.shellAndConfigsReady().then((function(){return f(!1)})))}var ie=n("9h0M"),re=n("ro+v"),oe=n("pIkI"),ae=n("NLr0"),le=n("f0qX"),se=n("Qj1g"),ce=n("Jcv4"),ue=n("3GGT"),de=n("Ft/N"),pe=function(){function e(e,t,n,i){this.serviceWorkerEnabled=e,this.serviceWorkerUserIdFactory=t,this.serviceWorkerStateService=n,this.globalErrorHandler=i}return e.prototype.intercept=function(e,t){var n=this;if(!this.serviceWorkerEnabled)return t.handle(e);if("Controlled"!==this.serviceWorkerStateService.currentState)return t.handle(e);var i=e.headers.get(de.a);if(!i)return t.handle(e);if("network-only"===i)return t.handle(e.clone({headers:e.headers.delete(de.a)}));if(e.reportProgress){var r="Cannot report progress for non-NetworkOnly requests";throw new ie.f({error:r,statusText:r,status:ue.a.NotImplemented,url:e.urlWithParams})}return Object(re.a)(this.serviceWorkerUserIdFactory()).pipe(Object(le.a)((function(t){return e.clone({headers:e.headers.append("X-SW-OHP-UserCacheId",t)})})),Object(se.a)((function(t){return n.globalErrorHandler.handleError(t,"j9XG4"),"cache-only"===i?Object(oe.a)(new ie.f({error:"Could not send CacheOnly request without a service worker user cache ID",status:ue.a.Cancelled,statusText:"CacheOnly request cancelled"})):Object(ae.a)(e.clone({headers:e.headers.delete(de.a)}))})),Object(ce.a)((function(e){return t.handle(e)})))},e}(),fe=n("kvyl");function he(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,r(t+n)];case 1:return o=i.sent(),[4,e.digest({name:"SHA-256"},o)];case 2:return a=i.sent(),[2,Object(fe.a)(new Uint8Array(a))]}}))}))}var me=n("Epfv");function be(e){var t=e.slice(0,1)[0];if(3!==t)throw new Error("Encryption Version Mismatch. Cannot Decrypt. Expected: 3. Received: "+t);return e.slice(1,e.byteLength)}var ge=n("bN7T"),ve=n("jsgn");function Se(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,window.navigator.serviceWorker.getRegistration()];case 1:return[4,e.sent().unregister()];case 2:return e.sent(),window.location.reload(),[2]}}))}))}function ye(e,t){var n=new URLSearchParams(window.location.search).get(t);n&&e.searchParams.set(t,n)}function Ce(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),ye(r=new URL(window.location.origin+"/api/shellandconfigdata"),"mockauth"),ye(r,"envType"),ye(r,"flight"),r.searchParams.set("workload","officehome"),[4,fetch(r.toString(),{headers:(a={},a["X-SW-OHP-UserCacheId"]=e,a[de.a]=t,a["X-OfficeHome-UserId"]=n,a)})];case 1:return[2,(o=i.sent()).ok?o:null];case 2:return i.sent(),[2,null];case 3:return[2]}}))}))}var we=n("B9sP"),Te=n("W3Zz"),ke=function(){function e(){}return e.prototype.runWhenIdle=function(e){return requestIdleCallback(e)},e.prototype.cancelIdleCallback=function(e){cancelIdleCallback(e)},e}(),Ie=function(){function e(){}return e.prototype.runWhenIdle=function(e){var t=D.a.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(D.a.now()-t))}})}),1)},e.prototype.cancelIdleCallback=function(e){clearTimeorn e.config.automatedTestRunning?new we.e:new we.f=D.a.now()}},Pe=function(){return window.queuedEvents||[]},Ee=function(){return window.queuedMarks||[]},Oe=function(e,t){return e.config.automatedTestRunning||t.deviceInfo.browser.browserType===Te.a.Safari?new Ie:new ke},Fe=function(){return function(){}}(),De=n("SRNi"),Me=n("XjVN"),Re=n("SPVw"),xe=n("uSTl"),Le=n("vcPZ"),Ue=n("6nG3"),Ne=n("5aVq"),We=n("w1PR"),je=n("LQqy"),He=n("/I02"),Be=n("PBJH"),Ge=n("fVt+"),qe=n("JH4S"),Ve=n("b7yv"),ze=n("gktR"),Ke=n("sH0/"),Ze=function(){function e(e,t,n,i,r,o,a,c,u,d,p,f,m,b,g,v,S,y,C,w){var T=this;this.capabilitiesService=e,this.consumerInstallConfigService=t,this.contextService=n,this.documentService=i,this.eventService=r,this.featureCalloutService=o,this.firstRunConfigService=a,this.firstRunDataService=c,this.globalErrorHandler=u,this.instrumentationService=d,this.locService=p,this.performanceService=f,this.shellShimService=m,this.startupConfigService=b,this.themingService=g,this.userConsentService=v,this.userContextService=S,this.userProfileService=y,this.initialized=!1,this.disabled=!C.isDesktopDevice()||!w.config||w.config.hideInTestMode||this.capabilitiesService.capabilities.teachingUiReactNewUserEnabled,this.disabled||(this.config=w.config,this.isCommercialUser=this.startupConfigService.config.authType===h.a.OrgId,this.theme="light",this.installButtonResponsePromise=this.capabilitiesService.capabilities.installButtonReactEnabled?Promise.resolve():this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"installButtonResponse"===e.name})),Object(s.a)(1)).toPromise().then((function(e){if(e.args&&e.args.length)return Promise.resolve(enstallConfigService.getConfig().then((function(e){return e&&e.currentSkuInfo&&e.currentSkuInfo.skuType})),this.userConsentPromise=this.isCommercialUser?Promise.resolve(null):this.userConsentService.getConfig(),this.modalFreClosedPromise=this.firstRunConfigService.getConfig().then((function(e){return T.showModalFre=!!e&&!!e.model&&!!e.model.slides,T.showModalFre?r.events.withScope(0).pipe(Object(l.a)((function(e){return"firstRunModalClosed"===e.name})),Object(s.a)(1)).toPromise().then((function(){return Promise.resolve()})):Promise.resolve()})),this.appBarShowingPromise=this.capabilitiesService.capabilities.appBarEnabled?this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"appBarReady"===e.name})),Object(s.a)(1)).toPromise().then((function(){return Promise.resolve()})):Promise.resolve())}return e.prototype.ngOnDestroy=function(){var e;null===(e=this.themeShadesSubscription)||void 0===e||e.unsubscribe()},e.prototype.initializeFirstRun=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.disabled||this.initialized?[2]:(this.initialized=!0,this.capabilitiesService.capabilisSubscription=this.themingService.darkModeSubscription.subscribe((function(e){n.theme=e?"dark":"light"}))),this.firstRunVersion=this.config.version,[4,this.fetchFirstRun()]);case 1:return e=i.sent(),[4,this.getCallouts(e.CompletedFirstRun)];case 2:return(t=i.sent()).length&&(this.initCalloutActions(t),this.setupFirstCallout(e,t),this.featureCalloutService.addCallouts(t)),this.performanceService.mark("FRE_Ready"),[2]}}))}))},e.prototype.fetchFirstRun=function(){return this.firstRunDataService.fetchFirstRunData(this.firstRunVersion,!1,ze.a.firstRunDataKey)},e.prototype.shouldShowCallouts=function(){if(this.disabled)return Promise.resolve(!1);var e=this.fetchFirstRun(),t=this.fetchHasSeenNewCallouts(),n=this.config.tuiFlowInTestMode;return"2"===n||"3"===n?Promise.resolve(!0):Promise.all([e,t]).then((function(e){venNewCallouts=function(){return this.userProfileService.doesMetricExist("Fre_New_Callouts_Impression")},e.prototype.getCallouts=function(e){var t=this.config.tuiFlowInTestMode;return"0"===t?e?this.getReturningUserCallouts():this.getFirstRunCallouts():"2"===t?this.getFirstRunCallouts():"3"===t?this.getReturningUserCallouts():"4"===t||"5"===t?Promise.resolve([]):void 0},e.prototype.getFirstRunCallouts=function(){var e=this,t=this.userContextService.user.isEdu;return new Promise((function(n,r){Promise.all([e.shellShimService.afterShellPlusLoaded,e.modalFreClosedPromise,e.consumerSubscriptionStatusPromise,e.userConsentPromise,e.installButtonResponsePromise,e.appBarShowingPromise]).then((function(r){var o=Object(i.__read)(r,4),l=o[0],s=o[2],c=o[3],u=new Array,d=l,p=e.isFreeConsumer(s),f=e.userCanViewUpsell(p,c);e.detectDomElements(),d&&e.appLauncherElement&&u.push(new Le.a(e.appLauncherElement,"AppLauncher",F.b.FirstRun,e.locService.FirstRunFindMoreAppsTitle,e.isCommercialUser?e.locService.FirstRunFindMoreAppsSubtitleCommercial:e.locService.FirstRunFindMoreAppsSubtitleConsumer,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.isCommercialUser?t?e.config.findMoreAppsEduSvg[e.theme]:e.config.findMoreAppsCommercialSvg[e.theme]:e.config.findMoreAppsConsumerSvg[e.theme])),e.adminCenterButtonElement&&e.userContextService.user.isAdmin&&u.push(new Le.a(e.adminCenterButtonElement,"AdminTile",F.b.FirstRun,t?e.locService.FirstRunManageSchoolTitle:e.locService.FirstRunManageOrganizationTitle,e.locService.FirstRunManageOrganizationSubtitleNext,null,null,null,null,null,!0,null,null,null,null,-240,null,240,e.config.adminCenterSvg[e.theme])),e.createNewButtonElement&&u.push(new Le.a(e.createNewButtonElement,"NewButton",F.b.FirstRun,e.locService.FirstRunCreateHereTitle,e.locService.FirstRunCreateHereSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,e.config.createSvg[e.theme])),e.myContentButtonElement&&e.isCommercialUser&&u.push(new Le.a(e.myContentButtonElement,"MyContent",F.b.FirstRun,e.locService.FirstRunManageContentTitle,e.locService.FirstRunManageContentSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,e.config.manageContentSvg[e.theme])),e.uploadButtonElement&&u.push(new Le.a(e.uploadButtonElement,"Upload",F.b.FirstRun,e.locService.FirstRunUploadExistingContentTitle,e.locService.FirstRunUploadExistingContentSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.uploadContentSvg[e.theme])),e.consumerBuyButtonElement&&f&&u.push(new Le.a(e.consumerBuyButtonElement,"BuyOffice",F.b.FirstRun,e.locService.FirstRunUpgradeAnyTimeTitle,e.locService.FirstRunUpgradeAnyTimeSubtitleTemp,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.upgradeSvg[e.theme])),e.installButtonElement&&!p&&e.config.installButtonCalloutEnabled&&u.push(new Le.a(e.installButtonElement,"Install",F.b.FirstRun,e.locService.FirstRunDownloadAppsTitle,e.locService.FirstRunDownloadAppsSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.officeMobileAppSvg[e.theme])),e.feedbackContainerElement&&u.push(new Le.a(e.feedbackContainerElement,"Feedback",F.b.FirstRun,e.locService.FirstRunYoureAllSetTitle,e.locService.FirstRunYoureAllSetSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.allSetSvg[e.theme],!0)),e.userProfileService.incrementMetric("Fre_New_Callouts_Impression"),e.capabilitiesService.capabilities.quickAccessV1Enabled&&!e.isCommercialUser&&e.userProfileService.incrementMetric("Consumer_Pinned_Favorites_Sequence");var h={};h.FirstRunTotalSteps=u.length.toString(),h.State="first-run",e.instrumentationService.logGenericEvent("Fre_New_Callouts_Event",h),Object(a.a)({featureName:"FirstRun",eventName:"Fre_New_Callouts_Event",params:h}),n(u)})).catch((function(t){e.globalErrorHandler.handleError(t,"LAtlv"),r()}))}))},e.prototype.getReturningUserCallouts=function(){var e=this,t=this.fetchHasSeenNewCallouts();return new Promise((function(n,r){Promise.all([e.shellShimService.afterShellPlusLoaded,e.modalFreClosedPromise,e.consumerSubscriptionStatusPromise,e.userConsentPromise,t,e.appBarShowingPromise]).then((function(t){var r=Object(i.__read)(t,5),o=r[0],l=r[2],s=r[3],c=r[4];e.detectDomElements();var u=new Array,d=o,p=e.isFreeConsumer(l),f=e.userCanViewUpsell(p,s);if(!c||e.contextService.sharedContext.inMockMode){if(d&&e.appLauncherElement){var h=e.isCommercialUser?e.userContextService.user.isEdu?e.config.findMoreAppsEduSvg[e.theme]:e.config.findMoreAppsCommercialSvg[e.theme]:e.config.findMoreAppsConsumerSvg[e.theme];u.push(Promise.resolve(new Le.a(e.appLauncherElement,"Welcome",e.contextService.isEdgeworth?F.b.Edgeworth:F.b.Documents,e.locService.FirstRunWelcomeBackTitle,e.locService.FirstRunWelcomeBackSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.welcomeBackSvg[e.theme],!1,!0,"Returning_User_Callouts_Impression"))),u.push(Promise.resolve(new Le.a(e.appLauncherElement,"AppLauncher",F.b.FirstRun,e.locService.FirstRunFindMoreAppsTitle,e.locService.FirstRunFindMoreAppsSubtitleReturningUser,null,null,null,null,null,!1,null,null,null,null,null,null,null,h,!1,!1,"Returning_User_Callouts_Impression"))),e.createNewButtonElement&&u.push(Promise.resolve(new Le.a(e.createNewButtonElement,"NewButton",F.b.FirstRun,e.locService.ExpandedCreateCapabilitiesTitle,e.locService.FirstRunExpandedCreateCapabilitiesSubittle,null,null,null,null,null,!0,null,null,null,null,null,null,null,e.config.createSvg[e.theme],!1,!1,"Returning_User_Callouts_Impression"))),e.myContentButtonElement&&e.isCommercialUser&&u.push(Promise.resolve(new Le.a(e.myContentButtonElement,"MyContent",F.b.FirstRun,e.locService.FirstRunManageContentTitle,e.locService.FirstRunManageContentSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,e.config.manageContentSvg[e.theme],!1,!1,"Returning_User_Callouts_Impression"))),e.consumerBuyButtonElement&&f&&u.push(Promise.resolve(new Le.a(e.consumerBuyButtonElement,"BuyOffice",F.b.FirstRun,e.locService.FirstRunUpgradeAnyTimeTitle,e.locService.FirstRunUpgradeAnyTimeSubtitleTemp,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.upgradeSvg[e.theme],!1,!1,"Returning_User_Callouts_Impression"))),e.feedbackContainerElement&&u.push(Promise.resolve(new Le.a(e.feedbackContainerElement,"Feedback",F.b.FirstRun,e.locService.FirstRunYoureAllSetTitle,e.locService.FirstRunYoureAllSetSubtitleReturningUser,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.allSetSvg[e.theme],!0,!1,"Returning_User_Callouts_Impression")))}var m={};m.FirstRunTotalSteps=u.length.toString(),m.State="after-first-run",e.instrumentationService.logGenericEvent("Fre_New_Callouts_Event",m),Object(a.a)({featureName:"FirstRun",eventName:"Fre_New_Callouts_Event",params:m}),e.userProfileSer_Callouts_Impression")}Promise.all(u).then((function(e){return n(e.filter((function(e){return null!==e})))}))})).catch((function(t){e.globalErrorHandler.handleError(t,"Cgjwv"),r()}))}))},e.prototype.isFreeConsumer=function(e){return!this.isCommercialUser&&(e===Ue.b.NonActive||e===Ue.b.NotSubscribed)},e.prototype.userCanViewUpsell=function(e,t){return e&&(!t||0===t.userConsent)},e.prototype.initCalloutActions=function(e){var t=this,n=e.length,i=function(i){var r=e[i];r&&t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!1,StepsCompleted:i+1,Version:t.firstRunVersion,TotalSteps:n},ze.a.firstRunDataKey,r.calloutType)};e.forEach((function(e,r){e.buttonIdPrefix="first-run-step-"+r+"-"+e.calloutType.toLowerCase(),e.onAction=r===n-1?function(e){0!==e&&(3===e?i(r-1):t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:n,Version:t.firstRunVersion,TotalSteps:n},ze.a.firstRunDataKey))}:function(e){0!==e&&(1===e?t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:r+1,Version:t.firstRunVersion,TotalSteps:n},ze.a.firstRunDataKey):i(2===e?r+1:r-1))}}))},e.prototype.setupFirstCallout=function(e,t){for(var n=e.Version!==this.firstRunVersion?0:void 0!==e.FurthestCompleted&&e.FurthestCompleted<t.length?e.FurthestCompleted:e.StepsCompleted<t.length?e.StepsCompleted:0,i=0;i<n;i++)t[i].completed=!0;this.firstRunDataService.updateFirstRunData({CompletedFirstRun:!1,StepsCompleted:n+1,Version:this.firstRunVersion,TotalSteps:t.length},ze.a.firstRunDataKey,t[n].calloutType)},e.prototype.detectDomElements=function(){this.appLauncherElement=this.documentService.nativeDocument.getElementById("O365_MainLink_NavMenu"),this.adminCenterButtonElement=this.documentService.nativeDocument.getElementById("A28790FE-989B-48F6-90D8-D4996159C8D1")||this.documentService.nativeDocument.getElementById("ShellAdmin_link"),this.createNewButtonElement=this.documentService.nativeDocument.getElementById("83D3F491-B586-4266-8738-89776471BF21")||this.documentService.nativeDocument.getElementById("left-nav-create-center"),this.myContentButtonElement=this.documentService.nativeDocument.getElementById("F57D5D29-4967-495C-A648-F7AB66BF8572"),this.uploadButtonElement=this.documentService.nativeDocument.getElementById("upload-button-Edgeworth")||this.documentService.nativeDocument.getElementById("upload-button-QuickAccess")||this.documentService.nativeDocument.getElementById("upload-button"),this.installButtonElement=this.documentService.nativeDocument.getElementById("install-dropdown-link")||this.documentService.nativeDocument.getElementById("installbutton-MSA-RedirectToMyAccountPage"),this.consumerBuyButtonElement=this.documentService.nativeDocument.getElementById("consumer-buy-button"),this.feedbackContainerElement=this.documentService.nativeDocument.getElementById("feedbackContainer")},e.ɵprov=r.kc({factory:function(){return new e(r.lc(Y.a),r.lc(je.a),r.lc(He.a),r.lc(d.a),r.lc(X.a),r.lc(Re.a),r.lc(Ve.a),r.lc(ze.a),r.lc(u.b),r.lc(F.a),r.lc(Be.a),r.lc(D.b),r.lc(Ne.a),r.lc(h.b),r.lc(We.b),r.lc(Ge.a),r.lc(qe.a),r.lc(z.b),r.lc(Te.c),r.lc(Ke.a))},token:e,providedIn:"root"}),e}(),Qe=n("y3b+"),Xe=n("3g20"),Je=n("vXf5"),Ye=n("BaAg"),$e=n("fGsv"),et=n("uzn7"),tt=n("Xn3c"),nt=n("dmOj"),it=n("casz"),rt=n("TIi1"),ot=n("gO/A"),at=n("Ax7d"),lt=n("ufVG"),st=n("Hp80"),ct=n("k+kJ"),ut=n("uUrA"),dt=function(){function e(e,t,n,i,r){this.documentService=e,this.uploadConfigService=t,this.uploadButtonService=n,this.accessTokenService=i,this.isConsumer=r,this.enabled=!!this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled}return e.prototype.onDragOver=function(e){var t=this;this.enabled&&this.isLocalFile(e.dataTransfer.types)?(e.dataTransfer.dropEffect="copy",this.showOutline(),clearTimeout(this.timeoutTracker),this.timeoutTracker=setTimeout((function(){t.hideOutline()}),300)):e.dataTransfer.dropEffect="none"},e.prototype.onDrop=function(e){var t=this;if(this.enabled&&this.isLocalFile(e.dataTransfer.types)&&e.dataTransfer.files.length>0){var n=e.dataTransfer.files;this.accessTokenService.getAccessToken("Graph",!1,null,this.isConsumer||this.uploadConfigService.config.capPopupEnabled,{category:"Upload"}).then((function(){t.uploadFiles(n)})),clearTimeout(this.timeoutTracker),this.hideOutline()}},e.prototype.uploadFiles=function(e){1===e.length?this.uploadButtonService.uploadFile(e[0],null,ut.a.createGuid(),"upload-drop",ct.d.DragAndDrop):this.uploadButtonService.uploadFiles(e,ut.a.createGuid(),"upload-drop",ct.d.DragAndDrop)},e.prototype.showOutline=function(){this.documentService.addCssClassToElement(this.documentService.nativeDocument.getElementById(e.ScrollContentId),e.DragAndDropStyle)},e.prototype.hideOutline=function(){this.documentService.removeCssClassFromElement(this.documentService.nativeDocument.getElementById(e.ScrollContentId),e.DragAndDropStyle)},e.prototype.isLocalFile=function(e){for(var t=0;t<e.length;t++){var n=e[t];if("Files"!==n&&"application/x-moz-file"!==n)return!1}return!0},e.ScrollContentId="officeHome__scroll-content",e.DragAndDropStyle="drag-and-drop--outline",e}(),pt=n("vHlr"),ft=n("JScD"),ht=n("vSs+"),mt=function(){function e(e,t,n,i,r,o,a){this.documentService=e,this.eventService=t,this.titleService=n,this.windowService=i,this.router=r,this.injector=o,this.changeDetectorRef=a,this.backgroundStyle={},this.feedbackEnabled=!1,this.isSearchPage=!1,this.officeHomeClass=[],this.searchUXGeneralFeedbackEnabled=!1,this.viewInitializationCompleted=!1,this.viewListenersInitialized=!1,this.visualOfficeWrapperStyle={}}return e.prototype.ngOnInit=function(){var e=this;this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"appInitialized"===e.name})),Object(s.a)(1)).toPromise().then((function(){var t=e.injector.get(Te.c),i=e.injector.get(ft.a),r=e.injector.get(pt.a),o=e.injector.get(Z.b);e.searchConfigService=e.injector.get(Xe.a),e.startupConfigService=e.injector.get(h.b),e.capabilitiesService=e.injector.get(Y.a),e.contextService=e.injector.get(He.a),e.instrumentationService=e.injector.get(F.a),e.officeRouteService=e.injector.get(J.a),e.officeTitleService=e.injector.get(nt.a),e.themingService=e.injector.get(We.b),e.userStorageService=e.injector.get(tt.a),e.visualService=e.injector.get(ot.a),e.userProfileService=e.injector.get(z.b),e.featureCalloutService=e.injector.get(Re.a),e.firstRunReactStateService=e.injector.get(xe.a),e.locService=e.injector.get(Be.a),e.localStorageService=e.injector.get(et.a),e.reactShellConfigService=e.injector.get(lt.a);var a=e.injector.get(at.a),c=e.injector.get(qe.a);e.isStandalone=a.isStandalone,e.isMobile=t.isMobileDevice();var u=e.injector.get(je.a),d=e.injector.get(st.a),p=e.injector.get(Qe.a),f=e.injector.get(ht.a),m=e.injector.get(rt.a),b=e.capabilitiesService.capabilities;e.showMobileAppBanner=e.isMobile||t.isTabletDevice(),e.showAnnouncement=!e.showMobileAppBanner&&(b.announcementEnabled||b.gettingToKnowYouEnabled||b.reactAppToggleEnabled),e.uploadEnabled=(b.oneDriveUploadEnabled||b.swayCreateNewEnabled)&&!!i.config,e.supportCentralEnabled=b.supportCentralEnabled&&!e.isMobile,e.isConsumer=e.startupConfigService.config.authType===h.a.MSA,e.bottomTrayEnabled=b.bottomTrayEnabled,e.searchEnabled=b.showSearch&&!!e.searchConfigService.config&&!b.mobileCustomSearchEnabled,e.fluidSupportEnabled=b.fluidSupportEnabled,e.nativeSearchEnabled=e.searchEnabled&&b.nativeSearchInHeaderEnabled,e.leftNavReact=e.capabilitiesService.capabilities.leftNavReact&&!e.capabilitiesService.capabilities.appBarEnabled;var g=e.capabilitiesService.capabilities.leftNavReact||e.capabilitiesService.capabilities.appBarEnabled;e.appBarEnabled=e.capabilitiesService.capabilities.appBarEnabled,e.appsModuleEnabled=e.capabilitiesService.capabilities.appsModuleEnabled,e.customPivots=g&&e.capabilitiesService.capabilities.quickAccessV1CustomPivotEnabled,e.draftEnabled=b.draftEnabled,e.themeRootCssClass=Je.b,e.toastContainer=e.capabilitiesService.capabilities.contentActionsEnabled,e.uploadV2=e.capabilitiesService.capabilities.uploadV2Enabled,e.streamUploadV2=e.capabilitiesService.capabilities.streamUploadV2Enabled,e.wacHostEnabled=e.capabilitiesService.openWithUIHost,e.isIE=t.deviceInfo.browser.browserType===Te.a.IE,e.webVitalsEnabled=e.capabilitiesService.capabilities.webVitalsEnabled,e.memoryProfilingEnabled=e.capabilitiesService.capabilities.memoryProfilingEnabled,e.fluentThemeRefreshEnabled=e.capabilitiesService.capabilities.fluentRefresh,e.fluentHeaderEnabled=e.capabilitiesService.capabilities.fluentHeader,e.actionContextMenuEnabled=b.contentActionsEnabled&&e.capabilitiesService.capabilities.contentActionsOHomeEnabled,e.portalPreloadEnabled=c.user.isAdmin&&b.portalPreloadEnabled,e.deleteDialogEnabled=e.capabilitiesService.capabilities.deleteActionEnabled;var v=b.defaultHeaderLayoutEnabled,S=e.capabilitiesService.capabilities.newUserShelfOverride,y=e.capabilitiesService.capabilities.newConsumerOverride,C=e.capabilitiesService.capabilities.newUserShelfEnabled&&e.capabilitiesService.capabilities.createCenterEnabled,w=e.capabilitiesService.capabilities.newConsumerExperienceEnabled,T=e.userStorageService.isFirstUse(),k=e.isConsumer&&(w&&C||y||S)&&!e.isMobile,I=!e.isConsumer&&(S||C)&&!e.isMobile;if((I||k)&&(e.showNewCommercialUserShelfExpanded=I&&(T||S),e.showNewConsumerExperiences=e.contextService.isNewConsumerUserExperience=k&&(T||S||y),T?e.userProfileService.incrementMetric("Impressions_Since_First_Visit"):e.userProfileService.doesMetricExist("Impressions_Since_First_Visit").then((function(t){if(t){e.userProfileService.incrementMetric("Impressions_Since_First_Visit");var n=e.userProfileService.getInitialMetric("Impressions_Since_First_Visit");n&&n.count<=5&&(e.showNewUserShelfCollapsed=I,e.showNewConsumerExperiences=e.contextService.isNewConsumerUserExperience=k||S||y)}}))),b.firstRunEnabled&&(b.firstRunReactEnabled?e.firstRunReactStateService.getRunType().then((function(t){t!==De.a.Disabled&&(e.firstRunEnabled=!0)})):e.injector.get(Ve.a).getConfig().then((function(t){e.firstRunEnabled=!c.user.hasNoLicense&&!!t&&!!t.model}))),e.capabilitiesService.capabilities.teachingUiEnabled){var _=b.teachingUiReactNewUserEnabled;e.loadTeachingUiReactModule=_,e.teachingUiReactModuleEnabled=_,_||(e.featureCalloutSubscription=e.featureCalloutService.callouts.subscribe((function(t){e.loadFeatureCalloutModule=t.length>0,e.loadTeachingUiReactModule=!e.loadFeatureCalloutModule&&e.teachingUiReactModuleEnabled})),b.teachingUiReactEnabled&&e.injector.get(Ze).shouldShowCallouts().then((function(t){e.loadTeachingUiReactModule=!t,e.teachingUiReactModuleEnabled=!t})))}var A=e.injector.get(Ne.a);e.scheduler=e.injector.get(it.a),e.isConsumer?e.capabilitiesService.capabilities.userConsentCallEnabled?e.injector.get(Ge.a).getConfig().then((function(t){e.feedbackEnabled=0===t.userConsent&&b.showFeedback&&!e.isMobile,0!==t.userConsent||v||e.prepareUpsellButton()})):(e.feedbackEnabled=b.showFeedback&&!e.isMobile,v||e.prepareUpsellButton()):e.capabilitiesService.capabilities.adminPolicyEnabled?(e.adminPolicyService=e.injector.get($e.a),e.adminPolicyService.getAdminPolicy().then((function(t){e.feedbackEnabled=!!t&&b.showFeedback&&!e.isMobile&&t.SendFeedback.State}))):e.feedbackEnabled=b.showFeedback&&!e.isMobile,e.officeHomeClass=["angular-root"],e.backgroundStyle["background-image"]="url("+e.contextService.sharedContevisualBackgroundEnabled=t.visualBackgroundEnabled,e.visualOfficeWrapperStyle=t.visualOfficeWrapperStyle})),e.setupNavigationHandler(),e.viewInitializationCompleted=!0,e.shellHeader=e.documentService.nativeDocument.getElementById("ReactShellHeader"),e.mobileMenusEnabled=e.capabilitiesService.capabilities.mobileContextMenusEnabled,e.isMobile&&e.instrumentationService.logGenericEvent("Mobile_View",{},["Mobile_View"]),e.viewMetric=e.userProfileService.getInitialMetric(e.isMobile?"Mobile_View":"Home_PageView"),!e.isIE&&(e.eventService.events.withScope(en((function(){e.officeHomeClass.push("blur-background"),e.shellHeader.classList.add("blur-background")})),e.eventService.events.withScope(1).pipe(Object(l.a)((function(e){return"firstRunModalClosed"===e.name})),Object(s.a)(1)).toPromise().then((function(){var t=e.officeHomeClass.indexOf("blur-background");t>=0&&e.officeHomeClass.splice(t,1),e.shellHeader.classList.remove("blur-background")}))),e.fluentThemeRefreshEnabled&&(e.fluentProviderClassSubscription=e.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"fluentClassNameChanged"===e.name}))).subscribe((function(t){e.themeRootCssClass=Je.b+" "+t.args[0],e.changeDetectorRef.detectChanges()}))),e.dragAndDropUtility=new dt(e.documentService,i,r,o,e.isConsumer),A.getShellShim().then((function(t){if(t.Header&&t.Header.OnShyHeaderModeChanged((function(t){if(t)e.officeHomeClass.push("angular-root--hidden-shell");else{var n=e.officeHomeClass.indexOf("angular-root--hidden-shell");n>=0&&e.officeHomeClass.splice(n,1)}e.changeDetectorRef.detectChanges()})),t.GetResourceLoader){var i=t.GetResourceLoader(),r=!1;b.nativeSearchInHeaderEnabled||v?i.registerResourceCallback((function(t){if(4!==t){var o=void 0===t||3===t?4:1;e.isConsumer&&!r&&3===t&&v&&(e.scheduler.scheduleWork((function(){n.e(125).then(n.bind(null,"r36c")).then((function(t){e.shellBootstrapService=new t.ShellBootstrapService(e.capabilitiesService,e.startupConfigService,u,d,e.contextService,e.documentService,e.eventService,e.featureCalloutService,p,e.instrumentationService,e.locService,e.localStorageService,e.officeRouteService,e.reactShellConfigService,A,f,m),e.shellBootstrapService.triggerBenefits(),e.shellBootstrapService.triggerMer.get(Ge.a).getConfig().then((function(t){0===t.userConsent&&e.shellBootstrapService.triggerGoPremium()})):e.shellBootstrapService.triggerGoPremium()}))}),4),r=!0),e.scheduler.scheduleWork((function(){i.loadNext()}),o)}})):e.scheduler.scheduleWork((function(){i.loadAll()}),4)}})),e.isConsumer&&!v&&e.scheduler.scheduleWork((function(){Promise.all([n.e(10),n.e(724)]).then(n.bind(null,"T8N+")).then((function(t){e.meetNowButtonUtility=new t.MeetNowButton(e.contextService,e.eventService,e.injector)}))}),4),e.capabilitiesService.capabilities.visualSettingEnabled&&e.scheduler.scheduleWork((function(){n.e(125).then(n.bind(null,"r36c")).then((function(t){e.shellBootstrapService||(e.shellBootstrapService=new t.ShellBootstrapService(e.capabilitiesService,e.startupConfigService,u,d,e.contextService,e.documentService,e.eventService,e.featureCalloutService,p,e.instrumentationService,e.locService,e.localStorageService,e.officeRouteService,e.reactShellConfigService,A,f,m)),e.shellBootstrapService.registerSettingsFlexPane()}))}),4),e.changeDetectorRef.detectChanges()})),this.searchUXGeneralFeedbackSubscription=this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"searchUXGeneralFeedbackEnabled"===e.name}))).subscribe((function(){e.searchUXGeneralFeedbackEnabled=!0}))},e.prototype.ngDoCheck=function(){var e,t;this.viewInitializationCompleted&&(this.viewListenersInitialized||(this.viewListenersInitialized=!0,this.setAuthStateListener()),this.router.navigated||this.router.initialNavigation()),(null===(t=null===(e=this.contextService)||void 0===e?void 0:e.sharedContext)||void 0===t?void 0:t.uploadv2Experience)&&!this.uploadv2Experience&&(this.uploadv2Experience=!0)},e.prototype.ngOnDestroy=function(){var e;this.authStateChangeSubscription&&this.authStateChangeSubscription.unsubscribe(),this.routeChangeSubscription&&this.routeChangeSubscription.unsubscribe(),this.routeChangeEndSubscription&&this.routeChangeEndSubscription.unsubscribe(),this.backgroundImageSubscription&&this.backgroundImageSubscription.unsubscribe(),this.featureCalloutSubscription&&this.featureCalloutSubscription.unsubscribe(),this.upsellButtonUtility&&this.upsellButtonUtility.unsubscribe(),this.meetNowButtonUtility&&this.meetNowButtonUtility.unsubscribe(),this.searchUXGeneralFeedbackSubscription&&this.searchUXGeneralFeedbackSubscription.unsubscribe(),null===(e=this.fluentProviderClassSubscription)||void 0===e||e.unsubscribe(),this.shellBootstrapService&&this.shellBootstrapService.unsubscribe(),this.visualConfigSubscription&&this.visualConfigSubscription.unsubscribe()},e.prototype.onWindowResiz},e.prototype.onWindowFocus=ype.onBeforeInstall=function(e){this.eventService.broadcastEvent({name:"beforeInstallPrompt",args:[e]})},e.prototype.onAppInstalled=function(){var e=this.isMobile?"App_Added_To_Home_Screen_Mobile":"App_Added_To_Home_Screen_Desktop";this.instrumentationService.logGenericEvent(e,{},[e]),Object(a.a)({featureName:"AppAddedToHomeScreen",eventName:e})},e.prototype.onResize=function(e){var t=e.width,n=e.height;this.contentWidth!==t&&(this.contentWidth=t,this.eventService.broadcastEvent({name:"contentWidthChanged",args:[t]})),this.contentHeight!==n&&(this.contentHeight=n,this.eventService.broadcastEvent({name:"contentHeightChanged",args:[n]}))},e.prototype.dragoonDragOver(e)},e.prototype.dropHandler=function(e){e.preventDefault(),this.dragAndDropUtility.onDrop(e)},e.prototype.shouldShowFeedbackButton=function(){return this.feedbackEnabled&&!this.onWacContentPage&&!this.onM365AppsPage&&!(this.isSearchPage&&this.searchUXGeneralFeedbackEnabled)},e.prototype.setAuthStateListener=function(){var e=this;this.authStateChangeSubscription=this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"authStateChanged"===e.name}))).subscribe((function(t){var n=t.args[0],i=null==n?void 0:n.LoginState,r=e.capabilitiesService.capabilities.accountSwitchingEnabled;if(r&&"AccountMismatch"===i){var o=e.windowService.nativeWindow;o.MastInteraction.UpdateAccount(n.CurrentAccountPuid,{authenticatedState:1,idp:n.CurrentAccountType,upn:n.CurrentAccountUpn},!0),o.MastInteraction.ShowPrompt("SwitchAccount")}else if(e.capabilitiesService.capabilities.redirectWhenSignedOutFromWorkloads&&"SignedOut"===i||!r&&"AccountMismatch"===i){e.flushLogs();var a=e.getSignOutLandingUrl();a?e.windowService.nativeWindow.open(a,"_self"):e.windowService.nativeWindow.location.reload(!1)}else if(e.capabilitiesService.capabilities.reloadWhenAuthExpired&&"Expired"===i||e.capabilitiesService.capabilities.reloadWhenReauthRequired&&"ReauthenticationRequired"===i||e.capabilitiesService.capabilities.reloadWhenPolicyCheckFailed&&"PolicyCheckFailed"===i)e.onWacContentPage||(e.flushLogs(),e.windowService.nativeWindow.location.reload(!1));else if(e.capabilitiesService.capabilities.activityBasedTimeoutEnabled&&"SignedOutBasedOnActivityAuto"===i){e.flushLogs();var l=e.locService.format(e.contextService.sharedContext.signOutUrlTemplate,encodeURIComponent(e.contextService.sharedContext.abtSignoutPath+"?rs="+e.contextService.sharedContext.officeMarket+"&build="+e.startupConfigService.config.sharedClientStartupContext.buildId+"&ru="+encodeURIComponent(e.windowService.nativeWindow.location.pathname+e.windowService.nativeWindow.location.search)+"&upn="+e.startupConfigService.config.userPrincipalName));e.windowService.nativeWindow.open(l,"_self")}else e.capabilitiesService.capabilities.activityBasedTimeoutEnabled&&"SignedOutBasedOnActivityUserClick"===i&&(e.flushLogs(),e.windowService.nativeWindow.open(e.reactShellConfigService.reactShellConfig.logoutUrl,"_self"))}))},e.prototype.setupNavigationHandler=function(){var e=this,t=this.capabilitiesService.capabilities,n=this.officeRouteService.getRouteChangeStartObservable(),r=this.officeRouteService.getRouteChangeEndObservable();this.routeChangeSubscription=n.subscribe((function(n){var i=n.currentRoute.route;if("Content"!==i){var r=e.officeTitleService.getTitle(n.currentRoute),o=void 0;"MyForms"===i?o=e.locService.MyFormsHeroTitle:"GroupForms"===i&&(o=e.locService.GroupFormsTitle),e.titleService.setTitle(o?r+" - "+o:r)}e.loadShareControlModuleForContentPage="Content"===i,t.wacHostMoveToFolderEnabled&&(e.loadMoveToFolderModuleForContentPage="Content"===i),"Content"===i&&n.currentRoute.app&&n.currentRoute.app===Ye.b.Fluid?(e.nativeSearchEnabled=!1,e.showAnnouncement=!1):(e.nativeSearchEnabled=e.searchEnabled&&t.nativeSearchInHeaderEnabled,e.showAnnouncement=!e.showMobileAppBanner&&(t.announcementEnabled||t.gettingToKnowYouEnabled||t.reactAppToggleEnabled)),e.documentService.updateFavicon(e.officeTitleService.getFavicon(n.currentRoute)),e.isSearchPage="Search"===i||"SearchSiteScoped"===i||"SearchPersonScoped"===i||"SearchPersonScopedOverview"===i,e.onM365AppsPage="M365Apps"===i,e.onAppGallery="AppGallery"===i,e.onHomePage="OfficeHome"===i,e.onMyContentPage="MyContent"===i,e.onFeedPage="Feed"===i,e.onReactStartPage="Start"===i&&e.capabilitiesService.capabilities.modernStartPageEnabled||"ModernStart"===i,e.newOfficeTwoExperience=t.quickAccessV1Enabled&&e.capabilitiesService.capabilities.edgeworthEnabled,e.newOfficeHomePageExperience=e.onHomePage&&e.newOfficeTwoExperience,e.sidePopUpEnabled="MyForms"===i||"GroupForms"===i||"Start"===i&&n.currentRoute.app===Ye.b.Forms,e.createOneNotePageEnabled=t.createOneNotePageEnabled&&!(e.onHomePage&&e.capabilitiesService.capabilities.createCenterEnabled),e.taskModule=t.m365AppsEnabled,e.hideCustomSearch=t.nativeSearchInHeaderEnabled,e.showFASTBreadcrumb="SearchSiteScoped"===i,e.showWorkspaceNav="AppGallery"===i&&!e.appsModuleEnabled})),this.routeChangeEndSubscription=r.subscribe((function(n){e.onContentPage="Content"===n.currentRoute.route;var i=t.modernTemplatesAppsArray&&e.capabilitiesService.capabilities.modernTemplatesAppsArray.some((function(e){return e===Ye.a.fileTypeNameFromType(n.currentRoute.app).toLowerCase()}));e.onModernVisioTemplatesPage=t.modernTemplatesPageEnabled&&i&&n.currentRoute.app===Ye.b.Visio&&"Templates"===n.currentRoute.route,e.onWacContentPage=e.onContentPage&&n.currentRoute.app!==Ye.b.Fluid,e.onFluidContentPage=e.onContentPage&&n.currentRoute.app===Ye.b.Fluid})),this.backgroundImageSubscription=Object(Me.b)(this.themingService.themeShades,n).subscribe((function(n){var r=Object(i.__read)(n,2),o=r[0],a=r[1].currentRoute;e.showBackgroundImage=o.theme.reactShellTheme&&!o.theme.reactShellTheme.IsDarkMode&&("App"===o.theme.themeType||"Default"===o.theme.themeType)&&!!e.contextService.sharedContext.fluentHeroImageUrl&&!t.leftNavReact&&!e.isConsumer&&!(a&&a.app)&&"AppGallery"!==a.route,e.isDarkMode=o.theme.reactShellTheme.IsDarkMode}))},e.prototype.flushLogs=function(){this.instrumentationService.flush()},e.prototype.getSignOutLandingUrl=function(){var e,t,n=this.contextService.sharedContext.signOutRedirectUrl;if(!n)return n;var r=this.windowService.nativeWindow.location.search;if(!r)return n;r.startsWith("?")&&(r=r.substr(1));var o=n.split("#"),a=2===o.length?o[1]:"",l=(o=o[0].split("?"))[0],s=2===o.length?o[1]:"",c=r.split("&");try{for(var u=Object(i.__values)(c),d=u.next();!d.done;d=u.next()){var p=d.value,f=p.split("=")[0].toLowerCase();"auth"!==f&&"mockauth"!==f&&(s+=(s?"&":"")+p)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return n=l,s&&(n+="?"+s),a&&(n+="#"+a),n},e.prototype.prepareUpsellButton=function(){var e=this;this.scheduler.scheduleWork((function(){n.e(755).then(n.bind(null,"r8hs")).then((function(t){e.upsellButtonUtility=new t.UpsellButton(e.injector.get(je.a),e.contextService,e.eventService,e.injector,e.officeRouteService,e.capabilitiesService,e.injector.get(st.a))}))}),4)},e}(),bt=n("fYis"),gt=n("TOqr"),vt=n("dvrM"),St=n("W0EU"),yt=n("pzhl"),Ct=n("PkQn"),wt=n("xSeq"),Tt=n("xJIt"),kt=n("cj6A"),It=n("R0N1"),_t=n("lUkk"),At=n("BJFG"),Pt=n("ExL+"),Et=n("hoyd"),Ot=n("pjz5"),Ft=n("dFxn"),Dt=function(){function e(e){this.config=e.parse("appTilesConfig")||{coreAppIds:[],mobileAppIds:[],myAccountUrl:null,resources:null,segmentSpecificAppIds:[]}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(Ft.a))},token:e,providedIn:"root"}),e}(),Mt=function(){function e(e,t,n,i,o,a,l,s,c,u,d){this.appTilesConfigService=e,this.capabilitiesService=t,this.contextService=n,this.eventService=i,this.instrumentationService=o,this.workloadsService=a,this.appLauncherService=l,this.locService=s,this.changeDetectorRef=c,this.themingService=u,this.shellService=d,this.unpinWorkload=new r.q}return Objecteturn this._forceWhiteBackground},set:function(e){this._forceWhiteBackground=e,this.setBackgroundColor()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showHover",{get:function(){return this._showHover},set:function(e){this._showHover=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this,t=this.appTilesConfigService.config;this.isProvisioned=!!this.workload.Url,this.ariaLabel=this.workload.Text,this.thirdPartyIconAriaLabel=this.locService.format(this.locService.ThirdPartyIconAriaLabel,this.workload.Text),this.preloadPath=this.workload.InAppNav?"Start":Ot.a.getOrigin(this.workload.Url),this.removeAppAriaLabel=this.locService.RemoveDocumentActionTitle,this.isProvisioned?(this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((function(t){e.appColor=t&&e.workload.ChangeColorInDarkMode?"white":""}))),this.setBackgroundColor()):this.provisioningText=t.resources&&t.resources.ProvisioningTileText},e.prototype.ngOnChanges=function(e){e.hasOwnProperty("workload")&&(this.elementId=e.workload.currentValue.Id+"_link",this.setBackgroundColor(),this.iconLoaded=this.iconLoaded&&e.workload.currentValue.ThirdPartyIcon===e.workload.previousValue.ThirdPartyIcon)},e.prototype.ngOnDestroy=function(){this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()},e.prototype.mouseOverTile=function(){this.workload.Url&&(this.showHover=!0),this.checkedODSPProvisioningStatus||this.workload.FileType!==Ye.b.SharePoint&&this.workload.FileType!==Ye.b.OneDrive||(this.shellService.initializeProvisioningStatus(),this.checkedODSPProvisioningStatus=!0)},e.prototype.onTileClick=function(e){var t=this;if(this.showHover=!1,this.workload.Url||!e){var i="_blank"===this.contextService.sharedContext.defaultLinkTarget;i||this.instrumentTileClick("Web"),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then(vent:e,appName:t.workload.Text,url:t.workload.Url}).then((function(e){i&&t.ippLauncherService.launchApp(this.workload,e,"OpenAp.instrumentTileClick(e)}))}else e.preventDefault()},e.prototype.unfocusTile=function(){this.showHover=!1},e.prototype.instrumentTileClick=function(e){var t=e?this.workload.Referral:"",n=Object(G.a)(this.workload.Referral),i=F.b.AppTiles,r={};r.State=this.inExpandedView?"expanded":"reduced",r.ReferralType=this.workloadsService.getReferralType(this.workload).toString(),this.instrumentationService.logClickEvent("Generic_Click",n,i,t,"Native"===e?"Native":"Web",r,[],0,this.workload.InAppNav),Object(_t.a)({id:n,area:i,result:t?"Refer":"Navigate",target:t?n:"Other"}),this.eventService.broadcastEvent({name:"appTileClick",args:[this.workload.AppId]})},e.prototype.instrumentRightClick=function(){var e={};e.ElementId=Object(G.a)(this.workload.Referral),this.instrumentationService.logGenericEvent("App_Tile_Right_Click",e)},e.prototype.onIconLoad=function(){var e=this;setTimeout((function(){e.iconLconError=function(){var e=this;setTimeout((function(){e.iconLoaded=!1,e.changeDetectorRef.markForCheck()}))},e.prototype.unpinApp=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return e&&e),[2]}))}))},e.prototype.setBackgroundColor=function(){this.setWhiteBackground=this.forceWhiteBackground},e}(),Rt=r.Fb({encapsulation:2,styles:[],data:{}});function xt(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-icon-font",[],null,null,null,yt.b,yt.a)),r.Gb(1,638976,null,0,Ct.a,[Y.a],{iconFontCssClass:[0,"iconFontCssClass"],iconFontName:[1,"iconFontName"],isThirdParty:[2,"isThirdParty"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.workload.IconUnicodeCodepointCssClass+" app-tile-icon--small",n.workload.IconFont,n.workload.IsThirdParty)}),null)}function Lt(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,0,"img",[["aria-hidden","true"],["class","workload-item__icon--image"]],[[8,"hidden",0],[8,"src",4],[1,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onIconLoad()&&i),"error"===t&&(i=!1!==r.onIconError()&&i),i}),null,null))],null,(funcnull,null)),(e()(),r.gc(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.component.provisioningText)}))}function Nt(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,"span",[["class","workload-item__unpin ms-fcl-nd ms-fcl-tp-h ms-fcl-tp-f ms-bgc-g40-h ms-bgc-g40-f"],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"keyup.space"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.unpinApp(n)&&i),"keyup.enter"===t&&(i=!1!==r.unpinApp(n)&&i),"keyup.space"===t&&(i=!1!==r.unpinApp(n)&&i),"focus"===t&&(i=!1!==r.mouseOverTile()&&i),"blur"===t&&(i=!1!==r.unfocusTile()&&i),i}),null,null)),(e()(),r.Hb(1,0,null,null,1,"ohp-icon-font",[["iconFontName","X"]],null,null,null,yt.b,yt.a)),r.Gb(2,638976,null,0,Ct.a,[Y.a],{iconFontName:[0,"iconFontName"]},null)],(function(e,t){e(t,2,0,"X")}),(function(e,t){var n=t.component;e(t,0,0,n.removeAppAriaLabel,n.removeAppAriaLabel)}))}function Wt(e){return r.jc(2,[(e()(),r.Hb(0,0,null,null,26,"div",[["c,"contextmenu"===t&&(i=!1!==r.instrumentRightClick()&&i),"mouseleave"===t&&(i=!1!==r.unfocusTile()&&i),i}),null,null)),(e()(),r.Hb(1,0,null,null,25,"a",[["class","o365cs-base workload-item__link ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,n){var i=!0,o=e.component;return"mouseenter"===t&&(i=!1!==r.Wb(e,5).onMouseEnter()&&i),"mouseleave"===t&&(i=!1!==r.Wb(e,5).onMouseLeave()&&i),"focus"===t&&(i=!1!==o.mouseOverTile()&&i),"blur"===t&&(i=!1!==o.unfocusTile()&&i),"click"===t&&(i=!1!==o.onTileClick(n)&&i),i}),null,null)),r.Gb(2,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(3,{"workload-item--provisioning":0,"workload-item--provisioned workload-item--fluent--provisioned":1,"ms-bgc-w":2}),r.Gb(4,4210688,null,0,wt.a,[r.o,r.h],{focusOnLoad:[0,"focusOnLoad"],detectChanges:[1,"detectChanges"]},null),r.Gb(5,16384,null,0,Tt.a,[kt.a],{preloadPath:[0,"preloadPath"]},null),r.Gb(6,81920,null,0,It.a,[He.a],null,null),(e()(),r.Hb(7,0,null,null,8,"span",[["class","workload-item__icon"]],null,null,null,null,null)),r.Gb(8,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(9,{"workload-item__icon--3rd-party-image":0}),r.Gb(10,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(11,{color:0}),(e()(),r.qb(16777216,null,null,1,null,xt)),r.Gb(13,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Lt)),r.Gb(15,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(16,0,null,null,8,"div",[["class","workload-item__name"]],[[8,"id",0]],null,null,null,null)),r.Gb(17,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(18,{color:0}),(e()(),r.Hb(19,0,null,null,5,"div",[["class","workload-item__text"]],[[8,"title",0]],null,null,null,null)),r.Gb(20,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(21,{"workload-item__text--third-party":0,"ms-fcl-nd":1}),(e()(),r.gc(22,null,[" "," "])),(e()(),r.qb(16777216,null,null,1,null,Ut)),r.Gb(24,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Nt)),r.Gb(26,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,!n.isProvisioned,n.isProvisioned,n.setWhiteBackground);e(t,2,0,"o365cs-base workload-item__link ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f",i),e(t,4,0,n.focusOnLoad,!0),e(t,5,0,n.preloadPath),e(t,6,0);var r=e(t,9,0,n.workload.IsThirdParty);e(t,8,0,"workload-item__icon",r);var o=e(t,11,0,n.isProvisioned?n.appColor||n.workload.Color:"");e(t,10,0,o),e(t,13,0,!n.workload.ThirdPartyIcon||!n.iconLoaded),e(t,15,0,n.workload.ThirdPartyIcon);var a=e(t,18,0,n.showHover&&n.isProvisioned?n.appColor||n.workload.Color:"");e(t,17,0,a);var l=e(t,21,0,n.workload.IsThirdParty,!n.showHover);e(t,20,0,"workload-item__text",l),e(t,24,0,!n.isProvisioned),e(t,26,0,n.pinnedApp)}),(function(e,t){var n=t.component;e(t,1,0,r.Ob(1,"",n.elementId,""),r.Ob(1,"",n.workload.Url,""),n.ariaLabel,r.Wb(t,6).target),e(t,16,0,r.Ob(1,"",n.elementId,"_text")),e(t,19,0,n.workload.Text),e(t,22,0,n.workload.Text)}))}r.Db("ohp-app-tile",Mt,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,Wt,Rt)),r.Gb(1,770048,null,0,Mt,[Dt,Y.a,He.a,X.a,F.a,Et.a,At.a,Be.a,r.h,We.b,Pt.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{workload:"workload",inExpandedView:"inExpandedView",focusOnLoad:"focusOnLoad",pinnedApp:"pinnedApp",forceWhiteBackground:"forceWhiteBackground"},{unpinWorkload:"unpinWorkload"},[]);var jt=n("gZ+X"),Ht=n("XWg3"),Bt=n("sVeK"),Gt=n("laSs"),qt=n("dy1P"),Vt=n("+ucO"),zt=n("+YV+"),Kt=n("7wk3"),Zt=n("6Po3"),Qt=n("U8M1"),Xt=n("9MHL"),Jt=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f,h,m){this.appGalleryConfigService=e,this.appTilesConfigService=t,this.capabilitiesService=n,this.consumerInstallConfigService=i,this.floodgateService=r,this.instrumentationService=o,this.performanceService=a,this.officeRouteService=l,this.startupConfigService=s,this.workloadsService=c,this.browserPaintMeasurementService=u,this.localStorageService=d,this.createMenuService=p,this.oneDriveUploadService=f,this.browserPaintService=h,this.changeDetector=m,this.fullBleedTheming=!1,this.fullBleedFontColor="",this.fullBleedBackplateEnabled=!1,this.fullBleedBackplateStyle={},this.rectangularMobileMaxInitialItems=4,this.appGalleryRoute="AppGallery",this.createMenuEnabled=!1}return e.prototype.ngAfterViewInit=function(){var t=this;e.loggedMarker||(this.performanceService.mark("App_Tiles_Ready"),e.loggedMarker=!0),this.previousRouteSubscription=this.officeRouteService.subscribeToRouteChangeEnd((function(e){return t.previousRoute=e.previousRoute?e.previousRoute.route:null})),this.appGalleryLinkSubscription=this.appGalleryLink.changes.subrvice.runAfterPaint((function(){e.first.nativeElement.focus(),t.appGalleryLinkSubscription.unsubscribe()}))})),this.browserPaintMeasurementService.recordWhenPainted("App_Tiles")},e.prototype.ngOnInit=function(){var e=this;this.componentArea=F.b.AppTiles;var t=this.appTilesConfigService.config.resources;this.sectionTitle=t&&t.AppTilesHeader,this.provisioningAlertText=t&&t.ProvisioningAlertText,this.showLessAppTilesText=t&&t.ShowLessAppTiles,this.exploreYourAppsAriaLabel=t&&t.ExploreYourAppsAriaLabel,this.exploreYourAppsText=t&&t.ExploreYourAppsText,this.appTilesLandmarkAriaLabel=t&&t.AppTilesListLandmarkAriaLabel,this.myAccountLinkText=t&&t.MyAccountConsumerLinkText,this.myAccountUrl=this.appTilesConfigService.config.myAccountUrl,this.isConsumer=this.startupConfigService.config.authType===h.a.MSA,this.bottomTrayEnabled=this.capabilitiesService.capabilities.bottomTrayEnabled,this.isConsumer&&this.consumerInstallConfigService.getConfig().then((function(t){var n=t&&t.currentSkuInfo?t.currentSkuInfo.skuType:Ue.b.NotDetected;e.isPaidConsumer=!(n===Ue.b.NotSubscribed||n===Ue.b.NonActive||n===Ue.b.NotDetected)})),this.createMenuService.createButtonEnabledPromise.then((functi.oneDriveUploadService.uploadEnabledPromise.thenn.unsubscribe(),this.thirdPartyWorkloadsSubscription&&this.thirdPartyWorkloadsSubscription.unsubscribe()},e.prototype.onUnpinWorkload=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,s=this.workloads.filter((function(t){return!(t.AppId===e.item.AppId&&t.CollectorId===e.item.CollectorId)})),this.changeDetector.detectChanges(),n(e,t){return t.Id},e.prototype.isShowingReducedAppTiles=function(){return"Reduced"===this.appTilesState},e.prototype.getDisplayedAppTilesCount=function(){return this.isShowingReducedAppTiles()?Math.min(this.reducedTilesCount,this.workloads.length):this.workloads.length},e.prototype.navigateToAppsPage=function(e){null==e||e.preventDefault(),Object(_t.a)({eventName:"AppGallery_Link_Click",id:"app-gallery-link",area:this.componentArea,result:"NavigateTo",target:qt.a.AppGallery}),this.officeRouteService.navigateTo({route:"AppGallery"})},e.prototype.initWorkloads=function(){var e=this;this.isConsumer?this.workloadsService.getCoreSegmentAndFrequentApps().then((function(t){return e.setupWorkloads(t)})):this.workloadsService.getWorkloads().then((function(t){return e.setupWorkloads(t)}))},e.prototype.setupWorkloads=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return Object(i.__generator)(rn t=this.appTilesConfigService.config,this.workloads=e.map((function(e){return Object(i.__assign)({},e)})),this.appGalleryConfigService.config&&(this.workloads.length>0?this.showAppGalleryLink=!0:this.thirdPartyWorkloadsSubscription=this.workloadsService.getThirdPartyWorkloads().subscribe((function(e){e.length>0&&(r.showAppGalleryLink=!0,r.thirdPartyWorkloadsSubscription.unsubscribe())}))),this.showProvisioningAlert=this.workloads.some((function(e){return!e.Url})),n=!1,this.workloads.forEach((function(e,t){e.ClickCount>0&&r.capabilitiesService.capabilities.showFloodgate&&r.capabilitiesService.capabilities.officeHomeFloodgate&&!n&&(n=!0)})),n&&this.floodgateService.recordFloodgate(["ClickedOneApp"]),[4,this.setUpReducedTiles()];case 1:return o.sent(),this.isConsumer||this.showAppGalleryLink&&(this.instrumentationService.logImpressionEvent("ExploreAllYourApps_Impression"),Object(Gt.a)({eventName:"ExploreAllYourApps_Impression",area:this.componentArea})),this.workloadsService.getAdditionalWorkloads().then((function(e){var t;e&&e.length>0&&(e=e.filter((function(e){return!e.IsNativeClientOnlyApp||r.localStorageService.get("AppClicked_"+e.Id)})),r.workloadsService.populateWorkloadFields(e),(t=r.workloads).splice.apply(t,Object(i.__spread)([r.reducedTilesCount,0],e)),r.reducedTilesCount+=e.length)})),this.sortTiles(t.mobileAppIds),[2]}}))}))},e.prototype.setUpReducedTiles=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(t){return this.workloads?[2,this.workloadsService.getCoreSegmentAndFrequentApps().then((function(t){e.appTilesState="Reduced",e.reducedTilesCount=t.length,e.workloads=t,e.logImpressionRenderedItems(e.getDisplayedAppTilesCount())}))]:[2]}))}))},e.prototype.sortTiles=function(e){if(e){var t=this.workloads.slice(0,this.workloads.length);this.workloads=this.workloads.sort((function(n,i){for(var r=0;r<e.length;r++){var o=e[r];if(n.Id===o)return-1;if(i.Id===o)return 1}for(r=0;r<t.length;r++){if(t[r]===n)return-1;if(t[r]===i)return 1}return 0}))}},e.prototype.logImpressionRenderedItems=function(e){var t=[];this.workloads&&(t=this.workloads.slice(0));var n=function(n){return t.reduce((function(t,i,r){return r<e&&(n&&i.Url||!n&&!i.Url)?t+(0===t.length?"":";")+Object(G.a)(i.Id):t}),"")},i={};i.RenderSize=e.toString();var r=n(!0);i.Distribution=r;var o=n(!1);i.Provisioning=o,i.State="Mobile",i.TotalSize=this.workloads?this.workloads.length.toString():"0",i.Action=this.appTilesState,this.instrumentationService.logImpressionEvent("App_Tiles_Impression",i),Object(Gt.a)({eventName:"App_Tiles",area:"AppTiles",distribution:r,renderSize:e,totalSize:this.workloads?this.workloads.length:0})},e.loggedMarker=!1,e}(),Yt=r.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeOut",definitions:[{type:1,expr:":leave",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"100ms"}}},options:null},options:null}],options:{}}]}});function $t(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,4,"div",[["class","tiles-section__alert--fluent ms-fcl-nd"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(2,{color:0}),(e()(),r.Hb(3,0,null,null,1,"ohp-alert-message",[],null,null,null,vt.b,vt.a)),r.Gb(4,49152,null,0,St.a,[],{message:[0,"message"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedFontColor);e(t,1,0,i),e(t,4,0,n.provisioningAlertText)}),null)}function en(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,Wt,Rt)),r.Gb(1,770048,null,0,Mt,[Dt,Y.a,He.a,X.a,F.a,Et.a,At.a,Be.a,r.h,We.b,Pt.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"],forceWhiteBackground:[2,"forceWhiteBackground"]},null)],(function(e,t){var n=t.component;e(t,1,0,t.parent.context.$implicit,t.parent.context.index>=n.reducedTilesCount,n.fullBleedTheming)}),null)}function tn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,Wt,Rt)),r.Gb(1,770048,null,0,Mt,[Dt,Y.a,He.a,X.a,F.a,Et.a,At.a,Be.a,r.h,We.b,Pt.a],{workload:[0,"workload"],[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,!n.isConsumer),e(t,4,0,n.isConsumer)}),null)}function rn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,7,"cdk-virtual-scroll-viewport",[["class","virtual-scroll-tiles cdk-virtual-scroll-viewport"],["itemSize","100"],["maxBufferPx","100"],["minBufferPx","50"],["orientation","horizontal"]],[[2,"cdk-virtual-scroll-orientation-horizontal",null],[2,"cdk-virtual-scroll-orientation-vertical",null]],null,null,jt.b,jt.a)),r.bc(6144,null,Ht.b,null,[Ht.d]),r.Gb(3,540672,null,0,Ht.a,[],{itemSize:[0,"itemSize"],minBufferPx:[1,"minBufferPx"],maxBufferPx:[2,"maxBufferPx"]},null),r.bc(1024,null,Ht.h,Ht.j,[Ht.a]),r.Gb(5,245760,null,0,Ht.d,[r.o,r.h,r.F,[2,Ht.h],[2,Bt.b],Ht.f,[2,Ht.i]],{orientation:[0,"orientation"]},null),(e()(),r.qb(16777216,null,0,2,null,nn)),r.Gb(7,409600,null,0,Ht.c,[r.W,r.S,r.x,[1,Ht.d],r.F],{cdkVirtualForOf:[0,"cdkVirtualForOf"],cdkVirtualForTrackBy:[1,"cdkVirtualForTrackBy"]},null),r.Yb(0,gt.r,[])],(function(e,t){var n=t.component;e(t,3,0,"100","50","100"),e(t,5,0,"horizontal"),e(t,7,0,r.hc(t,7,0,r.Wb(t,8).transform(n.workloads,0,n.getDisplayedAppTilesCount())),n.trackByWorkloadId)}),(function(e,t){e(t,1,0,"horizontal"===r.Wb(t,5).orientation,"horizontal"!==r.Wb(t,5).orientation)}))}function on(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,12,"div",[["class","explore-apps--fluent"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"explore-apps--backplate":0}),(e()(),r.Hb(3,0,[[1,0],["appGalleryLink",1]],null,9,"a",[["class","explore-apps__text--fluent ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["href","#"],["id","explore-your-apps"]],[[1,"aria-label",0],[1,"data-area",0],[1,"data-nav",0]],[[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,n){var i=!0,o=e.component;return"mouseenter"===t&&(i=!1!==r.Wb(e,7).onMouseEnter()&&i),"mouseleave"===t&&(i=!1!==r.Wb(e,7).onMouseLeave()&&i),"click"===t&&(i=!1!==o.navigateToAppsPage(n)&&i),i}),null,null)),r.Gb(4,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(5,{"explore-apps__text--backplate":0}),r.Gb(6,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Gb(7,16384,null,0,Tt.a,[kt.a],{preloadPath:[0,"preloadPath"]},null),(e()(),r.Hb(8,0,null,null,4,"div",[["class","centered-flex-container"]],null,null,null,null,null)),(e()(),r.Hb(9,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.gc(10,null,["",""])),(e()(),r.Hb(11,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,yt.b,yt.a)),r.Gb(12,638976,null,0,Ct.a,[Y.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedBackplateEnabled);e(t,1,0,"explore-apps--fluent",i);var r=e(t,5,0,n.fullBleedBackplateEnabled);e(t,4,0,"explore-apps__text--fluent ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a",r),e(t,6,0,n.fullBleedBackplateStyle),e(t,7,0,n.appGalleryRoute),e(t,12,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,3,0,n.exploreYourAppsAriaLabel,n.componentArea,!0),e(t,10,0,n.exploreYourAppsText)}))}function an(e){return r.jc(0,[r.cc(671088640,1,{appGalleryLink:1}),(e()(),r.Hb(1,0,null,null,9,"div",[["class","app-tiles-list-component"],["role","navigation"]],[[1,"aria-label",0],[24,"@fadeOut",0]],null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,$t)),r.Gb(3,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(4,0,null,null,6,"div",[["class","tiles-section__container mobile-tiles-section__container"]],null,null,null,null,null)),(e()(),r.Hb(5,0,null,null,3,"div",[["class","mobile-tiles--outer"]],null,null,null,null,null)),(e()(),r.Hb(6,0,null,null,2,"div",[["class","fluent-tiles mobile-tiles--inner"]],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,rn)),r.Gb(8,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,on)),r.Gb(10,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.showProvisioningAlert),e(t,8,0,n.workloads),e(t,10,0,n.showAppGalleryLink&&!n.bottomTrayEnabled)}),(function(e,t){e(t,1,0,t.component.appTilesLandmarkAriaLabel,void 0)}))}r.Db("ohp-app-tiles-list",Jt,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,an,Yt)),r.Gb(1,4440064,null,0,Jt,[Vt.a,Dt,Y.a,je.a,Qt.a,F.a,D.b,J.a,h.b,Et.a,Kt.a,et.a,zt.a,Xt.a,Zt.a,r.h],null,null)],(function(e,t){e(t,1,0)}),null)}),{fullBleedTheming:"fullBleedTheming",fullBleedFontColor:"fullBleedFontColor",fullBleedBackplateEnabled:"fullBleedBackplateEnabled",fullBleedBackplateStyle:"fullBleedBackplateStyle"},{},[]);var ln=function(){return function(){}}(),sn=r.Fb({encapsulation:2,styles:[],data:{}});function cn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,3,"div",[["class","tiles-section section--fluent consumer-tiles-section"]],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,2,"div",[["class","width-restrictor width-restrictor--responsive"]],null,null,null,null,null)),(e()(),r.Hb(2,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,an,Yt)),r.Gb(3,4440064,null,0,Jt,[Vt.a,Dt,Y.a,je.a,Qt.a,F.a,D.b,J.a,h.b,Et.a,Kt.a,et.a,zt.a,Xt.a,Zt.a,r.h],null,null)],(function(e,t){e(t,3,0)}),null)}r.Db("ohp-app-tiles-section",ln,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tiles-section",[],null,null,null,cn,sn)),r.Gb(1,49152,null,0,ln,[],null,null)],null,null)}),{},{},[]);var un=n("7IJ8"),dn=n("QhWD"),pn=n("RsrG"),fn=n("WLAd"),hn=n("g/dT"),mn=n("QtYd"),bn=n("OOtI"),gn=n("QOOv"),vn=n("7Rc8"),Sn=n("dOgD"),yn=n("RJiy"),Cn=n("mNaV"),wn=n("W3xQ"),Tn=function(){function e(e,t,n,i,r,o,a,l,s,c,u){this.calendarConfigService=e,this.capabilitiesService=t,this.consumerInstallConfigService=n,this.eventService=i,this.firstRunCalloutsService=r,this.instrumentationService=o,this.locService=a,this.mruConfigService=l,this.userContextService=s,this.workloadsService=c,this.clientStartupConfigService=u,this.coreWorkloadIds=["ShellWordOnline","ShellExcelOnline","ShellPowerPointOnline","ShellMail"]}return e.prototype.ngOnInit=function(){var e=this,t=this.capabilitiesService.capabilities,n=this.clientStartupConfigService.config.authType===h.a.MSA;this.showSuggestedActions=t.suggestedActionsEnabled,this.showTilesSection=!t.appsInHero&&!t.leftNavReact,this.showCalendar=!t.edgeworthEnabled&&t.calendarEnabled&&!!this.calendarConfigService.config,this.bottomTrayEnabled=t.bottomTrayEnabled,this.showPlaces=this.clientStartupConfigService.config.authType===h.a.OrgId&&!t.edgeworthEnabled,this.leftNavEmptyImage=t.leftNavEmptyImage,this.leftNavEmptyStateString=this.locService.LeftNavNonWXPEmptyStateString,this.leftNavEmptyStateSubtitle=this.locService.LeftNavNonWXPEmptyStateSubtitleString,this.consumerInstallConfigService.getConfig().then((function(t){var i=t&&t.currentSkuInfo?t.currentSkuInfo.skuType:Ue.b.NotDetected;if(e.userContextService.user.hasNoLicense||e.firstRunCalloutsService.initializeFirstRun(),n){var r={};r.SkuType=Ue.b[i],e.instrumentationService.logGenericEvent("ConsumerSkuLoaded",r),Object(a.a)({featureName:"Upsell",eventName:"ConsumerSkuLoaded",area:"Other",params:{SkuType:Ue.b[i]}})}}));var r,o=Promise.resolve(!1),c=this.mruConfigService.config;c.recommendedEnabled&&(o=this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"recommendedDataReady"===e.name})),Object(le.a)((function(e){return e.args[0]>0})),Object(s.a)(1)).toPromise()),r=c.showZeroExperience?Promise.resolve(!0):this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"mruDataReady"===e.name})),Object(le.a)((function(e){return e.args[0]>0})),Object(s.a)(1)).toPromise();var u=Promise.resolve(!1);this.showCalendar&&(u=this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"calendarDataReady"===e.name})),Object(le.a)((function(e){return e.args[0]>0})),Object(s.a)(1)).toPromise());var d=Promise.resolve(!1);d=this.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"announcementsReady"===e.name})),Object(le.a)((function(e){return e.args[0]>0})),.getWorkloads().then((function(t){return t.filter((function(t){return e.coreWorkloadIds.indexOf(t.Id)>=0})).length>0}));Promise.all([o,r,p,u,d]).then((function(t){var n=Object(i.__read)(t,5);n[0ull,1,"ohp-app-tiles-section",[],null,null,null,cn,sn)),r.Gb(1,49152,null,0,ln,[],null,null)],null,null)}function _n(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,4,"div",[["class","left-nav-empty-content-state__container"]],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,0,"img",[["class","left-nav-empty-content-state__image"]],[[8,"src",4]],null,null,null,null)),(e()(),r.Hb(2,0,null,null,1,"div",[["class","left-nav-empty-content-state__text"]],null,null,null,null,null)),(e()(),r.gc(3,null,["",""])),(e()(),r.Hb(4,0,null,null,0,"div",[["class","left-nav-empty-content-state__subtitle ms-fcl-tp"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,1,0,n.leftNavEmptyImage),e(t,3,0,n.leftNavEmptyStateString),e(t,4,0,n.leftNavEmptyStateSubtitle)}))}function An(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"places#PlacesModule")}),null)}function Pn(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"calendar#CalendarModule")}),null)}function En(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,12,"div",[["ohpInstrumentPageView","Home_PageView"]],null,null,null,null,null)),r.Gb(1,81920,null,0,hn.a,[Te.c,F.a],{pageName:[0,"pageName"]},null),(e()(),r.qb(16777216,null,null,1,null,In)),r.Gb(3,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(4,0,null,null,8,"div",[["role","main"]],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,_n)),r.Gb(6,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(7,0,null,null,1,"ohp-documents-component",[],null,null,null,mn.b,mn.a)),r.Gb(8,4440064,null,0,bn.a,[Y.a,X.a,gn.a,Be.a,vn.a,Sn.a,zt.a,yn.a,Xt.a,ft.a,h.b,h.b,Cn.a,He.a,ot.a],{firstSection:[0,"firstSection"],headless:[1,"headless"],isSuggestedActions:[2,"isSuggestedActions"]},null),(e()(),r.qb(16777216,null,null,1,null,An)),r.Gb(10,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Pn)),r.Gb(12,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,"Home_PageView"),e(t,3,0,n.showTilesSection),e(t,6,0,n.showEmptyNavState),e(t,8,0,!n.showTilesSection&&!n.bottomTrayEnabled,!0,n.showSuggestedActions),e(t,10,0,n.showPlaces),e(t,12,0,n.showCalendar)}),null)}var On=r.Db("ohp-home",Tn,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-home",[],null,null,null,En,kn)),r.Gb(1,114688,null,0,Tn,[wn.a,Y.a,je.a,X.a,Ze,F.a,Be.a,gn.a,qe.a,Et.a,h.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),Fn=n("VrZ9"),Dn=n("MRNN"),Mn=n("rPZ4"),Rn=n("Zy3K"),xn=n("WJRI"),Ln=n("kVgv"),Un=n("ICP0"),Nn=n("Q6ee"),Wn=n("iX+N"),jn=n("PTf4"),Hn=n("AlWG"),Bn=n("pd4Y"),Gn=function(){function e(t,n,i,r){this.capabilitiesService=t,this.dateService=n,this.locService=i,this.userContextService=r,this.currentGreetingText=this.generateGreeting(),this.greetingSubject=new Hn.a(this.currentGreeting),this.setupTimer(e.MorningStartHour),this.setupTimer(e.AfternoonStartHour),this.setupTimer(e.EveningStartHour)}return Object.defineProperty(e.prototype,"greetingObservable",{get:function(){return this.greetingSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentGreeting",{get:function(){return this.currentGreetingText},enumerable:!0,configurable:!0}),e.prototype.setupTimer=function(e){var t=this,n=new Date,i=new Date(n.getFullYear(),n.getM.getUTCDate()+1);var r=i.getTime()-n.getTime();setTimeout((function(){t.updateGreeting(),t.setupTimer(e)}),r)},e.prototype.updateGreeting=function(){var e=this.generateGreeting();e!==this.currentGreetingText&&(this.currentGreetingText=e,this.greetingSubject.next(this.currentGreetingText))},e.prototype.generateGreeting=function(){var t,n=this.userContextService.user.displayName,i=this.dateService.getCurrentDate().getHours();return this.capabilitiesService.capabilities.greetingRefreshEnabled?t=n?this.locService.format(this.locService.WelcomeGreetingWithName,n):this.locService.WelcomeGreetingNoName:(t=i>=e.MorningStartHour&&i<e.AfternoonStartHour?n?this.locService.WelcomeMorningWithName:this.locService.WelcomeMorningNoName:i>=e.AfternoonStartHour&&i<e.EveningStartHour?n?this.locService.WelcomeAfternoonWithName:this.locService.WelcomeAfternoonNoName:n?this.locService.WelcomeEveningWithName:this.locService.WelcomeEveningNoName,n&&(t=this.locService.format(t,n))),t},e.MorningStartHour=4,e.AfternoonStartHour=12,e.EveningStartHour=18,e.ɵprov=r.kc({factory:function(){return new e(r.lc(Y.a),r.lc(Bn.a),r.lc(Be.a),r.lc(qe.a))},token:e,providedIn:"root"}),e}(),qn=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S){this.activatedRoute=e,this.appGalleryConfigService=t,this.appTilesConfigService=n,this.capabilitiesService=i,this.consumerInstallConfigService=r,this.contextService=o,this.deviceDetector=a,this.eventService=l,this.installConfigService=s,this.instrumentationService=c,this.locService=u,this.officeRouteService=d,this.searchConfigService=p,this.themingService=f,this.welcomeContentService=h,this.windowService=m,this.workloadsService=b,this.startupConfigService=g,this.wacStartConfigService=v,this.visualService=S,this.backgroundStyle={},this.bleedBackgroundStyle={},this.heroImageStyle={},this.heroLeftImageStyle={},this.heroRightImageStyle={},this.heroTitleGradient={},this.fullBleedBackplateStyle={},this.isSearchSiteScoped=!1}return e.prototype.ngOnInit=function(){var e=this,t=this.capabilitiesService.capabilities,n=!!this.appGalleryConfigService.config,i=t.wacStartPageEnabled;if(this.appsModuleEnabled=this.capabilitiesService.capabilities.appsModuleEnabled,this.appsInHero=t.appsInHero,this.bottomTrayEnabled=t.bottomTrayEnabled,this.searchEnabled=t.showSearch&&!!this.searchConfigService.config,this.pwaEnabled=t.pwaEnabled,this.isConsumer=this.startupConfigService.config.authType===h.a.MSA,this.isMobile=this.deviceDetector.isMobileDevice(),this.hideConsumerBackgroundImage=this.isConsumer&&!this.onHomePageOrPwa,this.fullHeroGradient=this.isConsumer&&t.heroGradientEnabled,this.myAccountLinkText=this.appTilesConfigService.config.resources.MyAccountConsumerLinkText,this.myAccountUrl=this.appTilesConfigService.config.myAccountUrl,this.leftNavReact=t.leftNavReact,this.quickAccessEnabled=t.quickAccessV1Enabled,this.fluentRefresh=t.fluentRefresh,this.appBarEnabled=t.appBarEnabled,this.announcementListenerAdded=!1,this.suggestedActions=t.suggestedActionsEnabled,this.modernStartPageEnabled=t.modernStartPageEnabled,this.showAppTilesHeroTitle=this.appsInHero&&!this.bottomTrayEnabled&&!this.searchEnabled,this.isConsumer?this.consumerInstallConfigService.getConfig().then((function(t){var n=t&&t.currentSkuInfo?t.currentSkuInfo.skuType:Ue.b.NotDetected;e.isPaidConsumer=!(n===Ue.b.NotSubscribed||n===Ue.b.NonActive||n===Ue.b.NotDetected),n!==Ue.b.NotSubscribed&&n!==Ue.b.NonActive||e.installConfigService.config.dimeEnabled&&e.eventService.events.withScope(1).pipe(Object(l.a)((function(e){return"convertedToPaid"===e.name})),Object(s.a)(1)).toPromise().then((function(){e.isPaidConsumer=!0}))})):this.isPaidConsumer=!1,this.greetingSubscription=this.welcomeContentService.greetingObservable.subscribe((function(t){e.heroTitle&&(!e.currentRoute||"OfficeHome"===e.currentRoute||"Pwa"===e.currentRoute||"AppGallery"===e.currentRoute&&e.isConsumer)&&(e.heroTitle=t)})),this.searchEnabled||n||i){var r=void 0;r=this.officeRouteService.hasNavigated()?this.officeRouteService.getRouteChangeEndObservable():Object(Un.a)(this.officeRouteService.getRouteChangeStartObservable().pipe(Object(s.a)(1)),this.officeRouteService.getRouteChangeEndObservable()),this.routeSubscription=r.subscribe((function(t){e.setHeroFlags(t)})),this.changeTitleSubscription=this.eventService.events.withScope(1).pipe(Object(l.a)((function(e){return"changeTitle"===e.name}))).subscribe((function(t){if(t&&t.args&&t.args.length){var n=t.args;e.heroTitle=e.isConsumer&&e.onAppGalleryPage?e.welcomeContentService.currentGreeting:n[0],e.accessibilityTitle=n.length>1?n[1]:e.heroTitle}}))}else this.showApps=this.appsInHero&&!this.leftNavReact,this.showInstall=!0,this.showInstallButton=!0,this.heroTitle=this.welcomeContentService.currentGreeting,this.accessibilityTitle=this.locService.AuthPageTitle;this.fullBleedSubscription=this.themingService.fullBleedTheming.subscribe((function(t){var n=t.bleedColor,i=t.themeData,r=t.bleedFontColor;e.fullBleedThemingEnabled=t.shouldFullBleed,e.fullBleedColor=n,e.fullBleedFontColor=e.fullBleedThemingEnabled?r:"",e.activeThemeId=i.theme.themeId;var o=i.theme.reactShellTheme;e.fullBleedImages=o?o.FullBleedImages:null,e.setResizeSubscription(),e.setFullBleedBackground(e.fullBleedThemingEnabled,e.fullBleedImages,e.fullBleedColor,e.windowService.innerWidth)})),this.visualBackgroundInitialized=!this.capabilitiesService.capabilities.visualEnabled,this.visualConfigSubscription=this.visualService.visualConfigSubscription.subscribe((function(t){e.visualBackgroundEnabled=t.visualBackgroundEnabled!==e.visualBackgroundEnabled?t.visualBackgroundEnabled:e.visualBackgroundEnabled,t.visualInitialized&&!e.visualBackgroundInitializedundUrl())}))},e.prototype.ngAfterViewInit=function(){this.setBackgroundUrl(),this.setResizeSubscription()},e.prototype.ngAfterViewChecked=function(){var e,t,n,i,r=this;if(!this.announcementListenerAdded){var o=null===(t=null===(e=this.heroAnnouncement)||void 0===e?void 0:e.nativeElement)||void 0===t?void 0:t.getElementsByClassName("new-stream-announcement"),a=null===(i=null===(n=this.heroAnnouncement)||void 0===n?void 0:n.nativeElement)||void 0===i?void 0:i.getElementsByClassName("classic-stream-announcement");o&&o[0]&&o[0].addEventListener("focus",(function(){o[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"end"})})),a&&a[0]&&(a[0].addEventListener("focus",(function(){a[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"end"})})),a[0].addEventListener("click",(function(){r.instrumentationService.logClickEvent("Cross_Link_Click","Cross_Link_Click",F.b.Hero),Object(_t.a)({id:"Cross_Link_Click",arealeedSubscription.unsubscribe(ion.unsubscribe()},e.prototype.backToSearchPage=function(){this.officeRouteService.back({route:"Search"})},e.prototype.setResizeSubscription=function(){var e=thiswithScope(1).pipe(Object(l.a)((function(e){return"contentWidthChanged"===e.name||"windowResized"===e.name})),Object(Nn.a)(10)).subscribe((function(t){e.setFullBleedBackground(e.fullBleedThemingEnabled,e.fullBleedImages,e.fullBleedColor,e.windowService.innerWidth)})))},e.prototype.setBackgroundUrl=function(){if(!this.appsInHero&&this.visualBackgroundInitialized&&!this.visualBackgroundEnabled){var e=this.contextService.sharedContext;e.heroImageUrl&&(this.backgroundStyle["background-image"]="url("+e.heroImageUrl+")"),this.heroTitleGradient["background-image"]="url("+e.heroTitleGradientImageUrl+")"}},e.prototype.setHeroFlags=function(e){var t=this,n=e.currentRoute;this.currentRoute=n?n.route:null,this.onCreatePage="Create"===this.currentRoute,this.onSearchPage="Search"===this.currentRoute||"SearchSiteScoped"===this.currentRoute||"SearchTopicScoped"===this.currentRoute||"SearchMeetingScoped"===this.currentRoute||"SearchPersonScoped"===this.currentRoute||"SearchPersonScopedOverview"===this.currentRoute,this.onConsumerSearch=this.onSearchPage&&this.isConsumer,this.onAppGalleryPage="AppGallery"===this.currentRoute,this.onHomePageOrPwa=!this.currentRoute||"OfficeHome"===this.currentRoute||"Pwa"===this.currentRoute,this.showApps=this.onHomePageOrPwa&&this.appsInHero&&!this.leftNavReact,this.showFASTBreadcrumb="SearchSiteScoped"===this.currentRoute,this.appContext=n?n.app:null,this.hideConsumerBackgroundImage=this.isConsumer&&!this.onHomePageOrPwa,this.announcementMarkup=Object(jn.a)(this.locService,this.wacStartConfigService,this.appContext);var i=this.capabilitiesService.capabilities.modernStartAppsArray&&this.capabilitiesService.capabilities.modernStartApps.has(null==n?void 0:n.app);if(this.onModernStartPage=("ModernStart"===this.currentRoute||"Start"===this.currentRoute)&&this.modernStartPageEnabled&&i,this.onAppGalleryPage&&this.workloadsService.getWorkloads().then((function(e){t.store=e.find((function(e){return"ShellOfficeStore"===e.Id}))})),this.showInstall=this.onHomePageOrPwa||this.onAppGalleryPage,this.showWelcomeBadge=this.capabilitiesService.capabilities.welcomeBadgeEnabled&&this.onHomePageOrPwa,this.showInstallButton=this.capabilitiesService.capabilities.isPwaInUwp&&this.installConfigService.config.pwaInstallMoveEnabled?this.onAppGalleryPage:this.onHomePageOrPwa||this.onAppGalleryPage,this.showHeroButtons=this.onAppGalleryPage||this.onHomePageOrPwa,this.onSearchPage||!this.activatedRoute.snapshot.queryParams.q||this.isConsumer){var r=this.eventService.whenEventFired("exitSearchInSearchBox",0),o=this.eventService.whenEventFired("isContextualRailEnabled",0);this.backButtonId="back-button",this.backButtonAriaLabel="";var a=Promise.resolve(!1);switch(this.defaultBackRoute=null,this.onTemplatesPage=!1,this.currentRoute){case"Search":case"SearchTopicScoped":case"SearchMeetingScoped":case"SearchPersonScoped":case"SearchPersonScopedOverview":this.accessibilityTitle=this.locService.SearchResults,this.backButtonId="search-close-button",this.backButtonAriaLabel=this.locService.CloseSearchResultsAriaLabel,this.defaultBackRoute={route:this.pwaEnabled?"Pwa":"OfficeHome"},this.componentArea=F.b.SearchResults,a=r.then((function(e){return!e.args[0]}));break;case"SearchSiteScoped":this.backButtonId="search-site-scoped-close-button",this.backButtonAriaLabel=this.locService.CloseSearchResultsAriaLabel,this.defaultBackRoute={route:"Search"},a=r.then((function(e){return!e.args[0]}));break;case"AppGallery":this.accessibilityTitle=this.locService.AppGalleryHeroTitle,this.backButtonId="app-gallery-close-button",this.componentArea=F.b.AppGalleryHero;break;case"Templates":var l=this.capabilitiesService.capabilities.modernTemplatesAppsArray&&this.capabilitiesService.capabilities.modernTemplatesAppsArray.some((function(e){return e===Ye.a.fileTypeNameFromType(null==n?void 0:n.app).toLowerCase()})),s=this.capabilitiesService.capabilities.modernTemplatesPageEnabled&&l;a=Promise.resolve(!s),this.defaultBackRoute={route:"Start",app:n.app},this.onTemplatesPage=!s,this.componentArea=F.b.Templates;break;case"MyForms":case"GroupForms":a=Promise.resolve(!0),this.defaultBackRoute={route:"Start",app:n.app};break;case"Start":break;default:this.componentArea=F.b.Hero}this.isSearchSiteScoped="SearchSiteScoped"===this.currentRoute,this.setShowBack(a),this.setContextualRail(o.then((function(e){return e.args[0]}))),this.heroTitle=this.onHomePageOrPwa?this.welcomeContentService.currentGreeting:this.accessibilityTitle,this.showCreateLocation=this.onTemplatesPage&&this.appContext!==Ye.b.Sway&&this.appContext!==Ye.b.Forms,this.noGutter=this.fluentRefresh||this.quickAccessEnabled&&"OfficeHome"===this.currentRoute&&!this.isConsumer}else this.officeRouteService.navigateTo({route:"Search"},!0)},e.prototype.setShowBack=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,e];case 1:return t.showBackButton=n.sent(),this.showAppTilesHeroTitle=!this.bottomTrayEnabled&&(this.showBackButton||this.showFASTBreadcrumb||this.onHomePageOrPwa&&this.appsInHero),[2]}}))}))},e.prototype.setContextualRail=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,e];case 1:return t.isContextualRailEnabled=n.sent(),[2]}}))}))},e.prototype.setFullBleedBackground=function(e,t,n,i){var r=We.b.eduThemeBackplateOverrides[this.activeThemeId];this.fullBleedBackplateEnabled=r&&i<640&&this.fullBleedThemingEnabled,this.fullBleedBackplateStyle=this.fullBleedBackplateEnabled?Object.assign({color:this.fullBleedFontColor},r):{color:this.fullBleedFontColor},this.bleedBackgroundStyle=e?{"background-color":n}:{};var o=e&&t?t.Type:null;this.isPatternImage=o===We.a.Pattern,this.hasSideImages=o===We.a.Side,this.heroLeftImageStyle=this.getBackgroundImageStyle(this.hasSideImages&&t?t.Side:null),this.heroRightImageStyle=this.getBackgroundImageStyle(this.hasSideImages&&t?t.Side:null),this.heroImageStyle=this.getBackgroundImageStyle(e&&t?this.themingService.getEduHeaderImageForWidth(t,i):null)},e.prototype.getBackgroundImageStyle=function(e){return e&&e.length?{"background-image":"url("+e+")"}:{}},e}(),Vn=n("X+PR"),zn=r.Fb({encapsulation:2,styles:[],data:{}});function Kn(e){return r.jc(0,[(e()(),r.Hb(0,0,[[1,0],["heroAnnouncement",1]],null,2,"div",[["class","hero-announcementMarkup ms-fcl-ns"]],[[8,"innerHTML",1]],null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1})],(function(e,t){var n=t.component,i=e(t,2,0,!n.noGutter,n.noGutter);e(t,1,0,"hero-announcementMarkup ms-fcl-ns",i)}),(function(e,t){e(t,0,0,t.component.announcementMarkup)}))}function Zn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,3,"div",[["class","hero-title-gradient"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"auth-hero-image hero-title-gradient--full":0}),r.Gb(3,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullHeroGradient);e(t,1,0,"hero-title-gradient",i),e(t,3,0,n.fullHeroGradient?n.backgroundStyle:n.heroTitleGradient)}),null)}function Qn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"div",[["class","hero-background__image hero-background__image--left"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroLeftImageStyle)}),null)}function Xn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"div",[["class","hero-background__image hero-background__image--right"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroRightImageStyle)}),null)}function Jn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,9,"div",[["class","hero-background--full-bleed"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),(e()(),r.qb(16777216,null,null,1,null,Qn)),r.Gb(3,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(4,0,null,null,3,"div",[["class","hero-background__image"]],null,null,null,null,null)),r.Gb(5,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(6,{"hero-background__image--pattern":0,"hero-background__image--center":1}),r.Gb(7,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),(e()(),r.qb(16777216,null,null,1,null,Xn)),r.Gb(9,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.bleedBackgroundStyle),e(t,3,0,n.hasSideImages);var i=e(t,6,0,n.isPatternImage,!n.isPatternImage);e(t,5,0,"hero-background__image",i),e(t,7,0,n.heroImageStyle),e(t,9,0,n.hasSideImages)}),null)}function Yn(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,3,"h1",[["class","ms-fontWeight-light welcome__title--consumer"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"welcome__title--fluent":0,"welcome__title--visual":1,"welcome__title--dark ms-fcl-nd":2}),(e()(),r.gc(3,null,[" "," "]))],(function(e,t){var n=t.component,i=e(t,2,0,n.fluentRefresh&&!n.visualBackgroundEnabled,n.visualBackgroundEnabled||n.isConsumer,n.fullHeroGradient);e(t,1,0,"ms-fontWeight-light welcome__title--consumer",i)}),(function(e,t){e(t,3,0,t.component.heroTitle)}))}function $n(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,8,"div",[],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(2,{"welcome__badge--container":0,"welcome__badge--container-refresh":1}),(e()(),r.Hb(3,0,null,null,3,"h1",[["class","ms-fontWeight-light welcome__title--consumer welcome__title--consumer-with-badge"]],null,null,null,null,null)),r.Gb(4,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(5,{"welcome__title--fluent":0,"welcome__title--visual":1,"welcome__title--dark ms-fcl-nd":2}),(e()(),r.gc(6,null,[" "," "])),(e()(),r.Hb(7,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(8,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,!n.visualBackgroundEnabled,n.visualBackgroundEnabled||n.isConsumer);e(t,1,0,i);var r=e(t,5,0,n.fluentRefresh&&!n.visualBackgroundEnabled,n.visualBackgroundEnabled||n.isConsumer,n.fullHeroGradient);e(t,4,0,"ms-fontWeight-light welcome__title--consumer welcome__title--consumer-with-badge",r),e(t,8,0,"welcome-badge-react#WelcomeBadgeReactModule")}),(function(e,t){e(t,6,0,t.component.heroTitle)}))}function ei(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","diamond-web"],["iconFontName","Diamond"]],null,null,null,yt.b,yt.a)),r.Gb(1,638976,null,0,Ct.a,[Y.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"]},null)],(function(e,t){e(t,1,0,"diamond-web","Diamond")}),null)}function ti(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link_new my-account__link_color my-account__link_new_hover_text_decoration my-account__link_margin"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),r.Gb(1,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(2,{color:0}),r.Gb(3,81920,null,0,It.a,[He.a],null,null),(e()(),r.qb(16777216,null,null,1,null,ei)),r.Gb(5,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.gc(7,null,["",""])),(e()(),r.Hb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,yt.b,yt.a)),r.Gb(9,638976,null,0,Ct.a,[Y.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedFontColor);e(t,1,0,i),e(t,3,0),e(t,5,0,n.isPaidConsumer),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,0,0,n.myAccountUrl,n.myAccountLinkText,r.Wb(t,3).target),e(t,7,0,n.myAccountLinkText)}))}function ni(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.componentArea,n.showInstallButton,"Office");e(t,1,0,"install-wrapper#InstallWrapperModule",i)}),null)}function ii(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,6,"div",[["class","hero__buttons-container hero-button-section--consumer"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"hero-button-section--consumer--fluent":0}),(e()(),r.qb(16777216,null,null,1,null,ti)),r.Gb(4,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ni)),r.Gb(6,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fluentRefresh);e(t,1,0,"hero__buttons-container hero-button-section--consumer",i),e(t,4,0,n.isPaidConsumer&&!n.showWelcomeBadge),e(t,6,0,n.showInstall)}),null)}function ri(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,11,"div",[],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(2,{"hero-image-container__overlay":0,"hero-image-container__overlay--consumer":1}),(e()(),r.Hb(3,0,null,null,8,"div",[["class","hero-content--flex"]],null,null,null,null,null)),r.Gb(4,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(5,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1,"hero-content--end-aligned":2}),(e()(),r.qb(16777216,null,null,1,null,Yn)),r.Gb(7,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,$n)),r.Gb(9,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ii)),r.Gb(11,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,!n.visualBackgroundEnabled,n.isConsumer);e(t,1,0,i);var r=e(t,5,0,!n.noGutter,n.noGutter,n.fluentRefresh);e(t,4,0,"hero-content--flex",r),e(t,7,0,!n.showWelcomeBadge),e(t,9,0,n.showWelcomeBadge),e(t,11,0,n.isConsumer)}),null)}function oi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-back-button",[],null,null,null,Fn.b,Fn.a)),r.Gb(1,245760,null,0,Dn.a,[Y.a,He.a,Be.a,J.a],{elementId:[0,"elementId"],backButtonAriaLabel:[1,"backButtonAriaLabel"],ent;e(t,1,0,n.backButtonId,n.backButtonAriaLabel,n.defaultBackRoute,n.onTemplatesPage,n.onAppGalleryPage)}),null)}function ai(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"bread-crumb#FastBreadcrumbModule")}),null)}function li(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,7,"h1",[["class","ms-fontWeight-light welcome__title ms-fcl-nd"],["id","hero-heading"]],null,[[null,"click"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==(r.showFASTBreadcrumb&&r.backToSearchPage())&&i),i}),null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"welcome__title--centered":0,"welcome__title--small":1,"welcome__title--responsive":2,"welcome__title--fluent":3,"welcome__title--visual":4}),r.Gb(3,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(4,{color:0}),(e()(),r.gc(5,null,[" "," "])),(e()(),r.qb(16777216,null,null,1,null,ai)),r.Gb(7,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.onTemplatesPage&&!n.fluentRefresh,n.onHomePageOrPwa&&!n.fluentRefresh,!n.fluentRefresh,n.fluentRefresh&&!n.visualBackgroundEnabled,n.visualBackgroundEnabled||n.isConsumer);e(t,1,0,"ms-fontWeight-light welcome__title ms-fcl-nd",i);var r=e(t,4,0,n.fullBleedFontColor);e(t,3,0,r),e(t,7,0,n.showFASTBreadcrumb)}),(function(e,t){e(t,5,0,t.component.heroTitle)}))}function si(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"bread-crumb#FastBreadcrumbModule")}),null)}function ci(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,7,"h1",[["class","ms-fontWeight-light welcome__title ms-fcl-nd welcome__title--consumer-with-badge"],["id","hero-heading"]],null,[[null,"click"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==(r.showFASTBreadcrumb&&r.backToSearchPage())&&i),i}),null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"welcome__title--centered":0,"welcome__title--small":1,"welcome__title--responsive":2,"welcome__title--fluent":3,"welcome__title--visual":4}),r.Gb(3,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(4,{color:0}),(e()(),r.gc(5,null,[" "," "])),(e()(),r.qb(16777216,null,null,1,null,si)),r.Gb(7,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.onTemplatesPage&&!n.fluentRefresh,n.onHomePageOrPwa&&!n.fluentRefresh,!n.fluentRefresh,n.fluentRefresh&&!n.visualBackgroundEnabled,n.visualBackgroundEnabled||n.isConsumer);e(t,1,0,"ms-fontWeight-light welcome__title ms-fcl-nd welcome__title--consumer-with-badge",i);var r=e(t,4,0,n.fullBleedFontColor);e(t,3,0,r),e(t,7,0,n.showFASTBreadcrumb)}),(function(e,t){e(t,5,0,t.component.heroTitle)}))}function ui(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"welcome-badge-react#WelcomeBadgeReactModule")}),null)}function di(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,6,"div",[],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(2,{"welcome__badge--container":0,"welcome__badge--container-refresh":1}),(e()(),r.qb(16777216,null,null,1,null,ci)),r.Gb(4,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ui)),r.Gb(6,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,!n.visualBackgroundEnabled,n.visualBackgroundEnabled||n.isConsumer);e(t,1,0,i),e(t,4,0,n.heroTitle||n.showFASTBreadcrumb),e(t,6,0,n.showWelcomeBadge)}),null)}function pi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,"div",[["class","hero__create-location"]],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,1,"ohp-create-location",[],null,null,null,Mn.b,Mn.a)),r.Gb(2,114688,null,0,Rn.a,[Y.a,Be.a],{app:[0,"app"]},null)],(function(e,t){e(t,2,0,t.component.appContext)}),null)}function fi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,pi)),r.Gb(2,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,2,0,t.component.showCreateLocation)}),null)}function hi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,3,"a",[["class","generic-button generic-button--fluent generic-button--fluent--primary ms-bgc-tp ms-fcl-w ms-bgc-w-h ms-bgc-w-a ms-fcl-tp-h ms-fcl-tp-a ms-fcl-w-f"],["data-referral","OfficeStore"],["id","app-gallery-store-link"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[1,"data-area",0],[8,"href",4],[8,"target",0]],null,null,null,null)),r.Gb(2,81920,null,0,It.a,[He.a],null,null),(e()(),r.Hb(3,0,null,null,1,"b",[["class","generic-button__text"]],null,null,null,null,null)),(e()(),r.gc(4,null,["",""]))],(function(e,t){e(t,2,0)}),(function(e,t){var n=t.component;e(t,1,0,n.componentArea,n.store.Url,r.Wb(t,2).target),e(t,4,0,n.store.Text)}))}function mi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),r.Gb(1,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Zb(2,{color:0}),r.Gb(3,81920,null,0,It.a,[He.a],null,null),(e()(),r.Hb(4,0,null,null,1,"ohp-icon-font",[["class","diamond-pwa ms-fcl-tda"],["iconFontName","Diamond"]],null,null,null,yt.b,yt.a)),r.Gb(5,638976,null,0,Ct.a,[Y.a],{iconFontName:[0,"iconFontName"]},null),(e()(),r.Hb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.gc(7,null,["",""])),(e()(),r.Hb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,yt.b,yt.a)),r.Gb(9,638976,null,0,Ct.a,[Y.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=e(t,2,0,t.component.fullBleedFontColor);e(t,1,0,n),e(t,3,0),e(t,5,0,"Diamond"),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,0,0,n.myAccountUrl,n.myAccountLinkText,r.Wb(t,3).target),e(t,7,0,n.myAccountLinkText)}))}function bi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.componentArea,n.showInstallButton,"Office");e(t,1,0,"install-wrapper#InstallWrapperModule",i)}),null)}function gi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,7,"div",[["class","section__buttons-container hero__buttons-container"]],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,hi)),r.Gb(3,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,mi)),r.Gb(5,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(6,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,bi)),r.Gb(8,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.onAppGalleryPage&&n.store),e(t,5,0,n.isPaidConsumer&&!n.onAppGalleryPage&&!n.showWelcomeBadge),e(t,8,0,n.showInstall)}),null)}function vi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,12,"div",[["class","hero-content--flex"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(2,{"hero-content--centered":0,"hero-content--small":1,"hero-content--small-visual":2,"hero-content":3,"hero-content--aligned":4,"hero-content--suggested-actions":5}),(e()(),r.qb(16777216,null,null,1,null,oi)),r.Gb(4,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,li)),r.Gb(6,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,di)),r.Gb(8,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,fi)),r.Gb(10,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,gi)),r.Gb(12,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.onTemplatesPage&&!n.fluentRefresh,n.onHomePageOrPwa,n.onHomePageOrPwa&&(n.visualBackgroundEnabled||n.isConsumer),!n.isSearchSiteScoped&&!n.fluentRefresh,n.fluentRefresh,n.suggestedActions);e(t,1,0,"hero-content--flex",i),e(t,4,0,n.showBackButton),e(t,6,0,!n.showWelcomeBadge&&n.heroTitle||n.showFASTBreadcrumb),e(t,8,0,n.showWelcomeBadge),e(t,10,0,!n.onAppGalleryPage),e(t,12,0,n.showHeroButtons)}),null)}function Si(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,an,Yt)),r.Gb(1,4440064,null,0,Jt,[Vt.a,Dt,Y.a,je.a,Qt.a,F.a,D.b,J.a,h.b,Et.a,Kt.a,et.a,zt.a,Xt.a,Zt.a,r.h],{fullBleedTheming:[0,"fullBleedTheming"],fullBleedFontColor:[1,"fullBleedFontColor"],fullBleedBackplateEnabled:[2,"fullBleedBackplateEnabled"],fullBleedBackplateStyle:[3,"fullBleedBackplateStyle"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.fullBleedThemingEnabled&&!n.visualBackgroundEnabled,n.fullBleedFontColor,n.fullBleedBackplateEnabled,n.fullBleedBackplateStyle)}),null)}function yi(e){return r.jc(0,[r.cc(671088640,1,{heroAnnouncement:0}),(e()(),r.Hb(1,0,null,null,1,"ohp-title-announcer",[],null,null,null,xn.b,xn.a)),r.Gb(2,49152,null,0,Ln.a,[],{announcement:[0,"announcement"]},null),(e()(),r.Hb(3,0,null,null,21,"div",[["class","hero-section auth-hero-image"]],null,null,null,null,null)),r.Gb(4,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(5,{"hero-section--padded":0,"hero-section__2dot0--padded":1,"hero-section__homepage--padded":2,"hero-section-mobile--padded":3,"hero-section__visual--padded":4,"hero-section--search-background":5,"ms-bgc-w":6}),r.Gb(6,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),(e()(),r.qb(16777216,null,null,1,null,Kn)),r.Gb(8,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Zn)),r.Gb(10,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Jn)),r.Gb(12,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ri)),r.Gb(14,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(15,0,null,null,9,"div",[],null,null,null,null,null)),r.Gb(16,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(17,{"width-restrictor":0,"width-restrictor--responsive":1,"width-restrictor--no-gutter":2,"breadcrumb-width-restrictor":3,"breadcrumb-width-restrictor-fallback":4,"fast-search-results":5}),(e()(),r.Hb(18,0,null,null,6,"div",[["class","hero-container"]],[[1,"role",0],[1,"aria-labelledby",0]],null,null,null,null)),r.Gb(19,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(20,{"hero-image-container--fluent":0,"hero-image-container":1,"hero-container--search":2}),(e()(),r.qb(16777216,null,null,1,null,vi)),r.Gb(22,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Si)),r.Gb(24,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.accessibilityTitle);var i=e(t,5,0,(n.appsInHero||n.hideConsumerBackgroundImage)&&!(n.bottomTrayEnabled&&n.onAppGalleryPage)&&!n.onSearchPage&&!n.onCreatePage&&!(n.onAppGalleryPage&&n.appsModuleEnabled)&&!n.onModernStartPage,n.onCreatePage||n.onHomePageOrPwa&&n.appBarEnabled||n.onAppGalleryPage&&n.appsModuleEnabled,n.onHomePageOrPwa&&!n.leftNavReact,n.bottomTrayEnabled,n.onHomePageOrPwa&&(n.visualBackgroundEnabled||n.isConsumer),n.onSearchPage&&n.fluentRefresh,n.onSearchPage&&!n.fluentRefresh);e(t,4,0,"hero-section auth-hero-image",i),e(t,6,0,n.hideConsumerBackgroundImage||n.fullHeroGradient||n.visualBackgroundEnabled?"":n.backgroundStyle),e(t,8,0,void 0!==n.announcementMarkup&&!n.onModernStartPage),e(t,10,0,!(n.appsInHero||n.hideConsumerBackgroundImage||n.visualBackgroundEnabled||n.isConsumer)),e(t,12,0,n.fullBleedThemingEnabled&&!n.visualBackgroundEnabled),e(t,14,0,!n.appsInHero&&!n.hideConsumerBackgroundImage);var r=e(t,17,0,!n.noGutter||n.onConsumerSearch,!n.noGutter&&n.heroTitle&&!n.onConsumerSearch,n.noGutter&&!n.onConsumerSearch,!n.heroTitle,!n.isContextualRailEnabled&&!n.onConsumerSearch,n.onConsumerSearch);e(t,16,0,r);var o=e(t,20,0,!(n.appsInHero||n.hideConsumerBackgroundImage||n.visualBackgroundEnabled||n.isConsumer),!(n.appsInHero||n.hideConsumerBackgroundImage||n.visualBackgroundEnabled||n.isConsumer),n.onConsumerSearch);e(t,19,0,"hero-container",o),e(t,22,0,n.showAppTilesHeroTitle),e(t,24,0,n.showApps)}),(function(e,t){var n=t.component;e(t,18,0,n.showAppTilesHeroTitle?"region":void 0,n.showAppTilesHeroTitle?"hero-heading":void 0)}))}r.Db("ohp-hero",qn,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-hero",[],null,null,null,yi,zn)),r.Gb(1,12828672,null,0,qn,[Vn.a,Vt.a,Dt,Y.a,je.a,He.a,Te.c,X.a,Qe.a,F.a,Be.a,J.a,Xe.a,We.b,Gn,f.b,Et.a,h.b,Wn.a,ot.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]);var Ci="home",wi="search",Ti="apps",ki=function(){function e(e,t,n,i){var r=this;this.capabilitiesService=e,this.officeRouteService=t,this.themingService=n,this.locService=i;var o={id:Ci,title:this.locService.HomeTabTitle,ariaLabel:this.locService.HomeTabAriaLabel,routes:["OfficeHome","Start","Templates"],iconClass:"Home"},a={id:Ti,title:this.locService.AppsTabTitle,ariaLabel:this.locService.AppsTabAriaLabel,routes:["AppGallery"],iconClass:"Waffle"};this.tabs=this.capabilitiesService.capabilities.showSearch?[o,{id:wi,title:this.locService.SearchTabTitle,ariaLabel:this.locService.SearchTabAriaLabel,routes:["Search"],iconClass:"Search"},a]:[o,a],this.activeTabId=t.getRouteChangeStartObservable().pipe(Object(le.a)((function(e){var t=e.currentRoute.route,n=r.tabs.find((function(e){return r.isObject(le.a)((function(e){return!(!lTheme)&&e.theme.reactShellTheme.IsDarkMode})))}return e.prototype.trackByTabId=function(e,t){return t.id},e.prototype.navigateTo=function(t){var n="Navigate",i="Other";t.id===Ci?(n="Refer",i=qt.a.OfficeDotCom):t.id===wi?(n="NavigateTo",i="SearchResults"):t.id===Ti&&(n="NavigateTo",i=qt.a.AppGallery),Object(_t.a)({eventName:"BottomTray_Click",id:t.id,area:"BottomTray",result:n,target:i})routes[0]},!1,null,e.LastBottomTrayTab)},e.prototype.isActive=function(e,t){return e.routes.indexOf(t)>=0},e.LastBottomTrayTab="LastBottomTrayTab",e}(),Ii=r.Fb({encapsulation:2,styles:[],data:{}});function _i(e){return r.jc(0,[(e()(),r.]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.navigateTo(e.context.$implicit)&&i),i}),null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Yb(131072,gt.b,[r.h]),r.Zb(3,{"ms-fcl-tp":0}),(e()(),r.Hb(4,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,yt.b,yt.a)),r.Gb(5,638976,null,0,Ct.a,[Y.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null),(e()(),r.Hb(6,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),r.gc(7,null,["",""]))],(function(e,t){var n=t.component,i=e(t,3,0,t.context.$implicit.id===r.hc(t,1,1,r.Wb(t,2).transform(n.activeTabId)));e(t,1,0,"bottom-tray__tab-button ms-fcl-nd",i),e(t,5,0,t.context.$implicit.iconClass,"16")}),(function(e,t){e(t,0,0,"bottom-tray-tab-"+t.context.$implicit.id),e(t,7,0,t.context.$implicit.title)}))}function Ai(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,5,"div",[["class","bottom-tray-container"],["role","navigation"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Yb(131072,gt.b,[r.h]),r.Zb(3,{"ms-bgc-w":0}),(e()(),r.qb(16777216,null,null,1,null,_i)),r.Gb(5,278528,null,0,gt.j,[r.W,r.S,r.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,r.hc(t,1,1,r.Wb(t,2).transform(n.isDarkMode)));e(t,1,0,"bottom-tray-container",i),e(t,5,0,n.tabs,n.trackByTabId)}),null)}r.Db("ohp-bottom-tray",ki,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-bottom-tray",[],null,null,null,Ai,Ii)),r.Gb(1,49152,null,0,ki,[Y.a,J.a,We.b,Be.a],null,null)],null,null)}),{},{},[]);var Pi=n("qSxk"),Ei=function(){function e(e,t,n){this.elementRef=e,this.eventService=t,this.zone=n,this.eventName=this.eventName||"contentScrolled"}return e.prototype.ngDoprototype.ngOnDestroy=function(){this.scrollEventSubscription&&this.scrollEventSubscription.unsubscribe()},e.prototype.setScrollListener=function(){var e=this;this.zone.runOutsideAngular((function(){e.s").pipe(Object(Nn.a)(10)).subscribe((function(){e.eventService.broadcastEvent({name:e.eventName,args:[]})}))}))},e}(),Oi=n("KoFE"),Fi=n("9c4X"),Di=n("y1jW"),Mi=r.Fb({encapsulation:2,styles:[],data:{}});function Ri(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),r.Hb(1,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(2,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){e(t,2,0,"left-nav-react#LeftNavReactModule")}),null)}function xi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,0,"div",[["class","ms-bgc-d appbar-placeholder"],["id","appBar"]],null,null,null,null,null)),(e()(),r.Hb(2,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(3,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){e(t,3,0,"appbar#AppBarModule")}),null)}function Li(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"feature-callout#FeatureCalloutModule")}),null)}function Ui(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"workspace-nav#WorkspaceNavModule")}),null)}function Ni(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"visual-background-react#VisualBackgroundReactModule")}),null)}function Wi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"announcement#AnnouncementModule")}),null)}function ji(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"mobile-app-banner#MobileAppBannerModule")}),null)}function Hi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{viewMetric:0}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.viewMetric);e(t,1,0,"banner#BannerModule",n)}),null)}function Bi(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-hero",[],null,null,null,yi,zn)),r.Gb(1,12828672,null,0,qn,[Vn.a,Vt.a,Dt,Y.a,je.a,He.a,Te.c,X.a,Qe.a,F.a,Be.a,J.a,Xe.a,We.b,Gn,f.b,Et.a,h.b,Wn.a,ot.a],null,null)],(function(e,t){e(t,1,0)}),null)}function Gi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{collapsed:0}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.showNewUserShelfCollapsed);e(t,1,0,"new-user-shelf#NewUserShelfModule",n)}),null)}function qi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"new-consumer-experience#NewConsumerExperienceModule")}),null)}function Vi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"web-vitals#WebVitalsModule")}),null)}function zi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"feature-tooltip-container#FeatureTooltipContainerModule")}),null)}function Ki(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"context-menu#ContextMenuModule")}),null)}function Zi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"action-context-menu-react#ActionContextMenuReactModule")}),null)}function Qi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{renderFluidDocument:0}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.onFluidContentPage);e(t,1,0,"fluid-content#FluidContentModule",n)}),null)}function Xi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"feedback#FeedbackModule")}),null)}function Ji(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"support-central-react#SupportCentralReactModule")}),null)}function Yi(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"upload-dialog#UploadDialogModule")}),null)}function $i(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"delete-dialog#DeleteDialogModule")}),null)}function er(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"task-module-dialog-react#TaskModuleDialogReactModule")}),null)}function tr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"confirmation-dialog-react#ConfirmationDialogReactModule")}),null)}function nr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"create-onenote-page-dialog-react#CreateOneNotePageDialogReactModule")}),null)}function ir(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:,(function(e,t){var n=e(t,2,0,t.component.showFASTBreadcrumb);e(t,1,0,"auto-suggest#AutoSuggestModule",n)}),null)}function rr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"side-popup-menu#SidePopupMenuModule")}),null)}function or(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"toast-container-react#ToastContainerReactModule")}),null)}function ar(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"upload-react#UploadReactModule")}),null)}function lr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"floating-action-button#FloatingActionButtonModule")}),null)}function sr(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-bottom-tray",[],null,null,null,Ai,Ii)),r.Gb(1,49152,null,0,ki,[Y.a,J.a,We.b,Be.a],null,null)],null,null)}function cr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"first-run-wrapper#FirstRunWrapperModule")}),null)}function ur(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"teaching-ui-react#TeachingUiReactModule")}),null)}function dr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{bottomAligned:0,viewMetric:1,bottomTrayEnabled:2}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,!0,n.viewMetric,n.bottomTrayEnabled);e(t,1,0,"banner#BannerModule",i)}),null)}function pr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"context-menu#ContextMenuModule")}),null)}function fr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{mobileShareMenu:0,contentShareMenu:1}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.mobileMenusEnabled,n.loadShareControlModuleForContentPage);e(t,1,0,"share-control#ShareControlModule",i)}),null)}function hr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{mobileMoveToFolderMenu:0,contentMoveToFolderMenu:1}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.mobileMenusEnabled,n.loadMoveToFolderModuleForContentPage);e(t,1,0,"move-to-folder-control#MoveToFolderControlModule",i)}),null)}function mr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"search-preload#SearchPreloadModule")}),null)}function br(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"wac-content#WacContentModule")}),null)}function gr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"fluent-theme-provider#FluentThemeProviderModule")}),null)}function vr(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,un.a,[dn.a,lePath"]},null),(e()(),r.qb(0,null,null,0))],(function(e,t){e(t,1,0,"portal-preload#PortalPreloadModule")}),null)}function Sr(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,109,"div",[["id","officeHomeRoot"]],null,null,null,null,null)),r.Gb(1,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),(e()(),r.Hb(2,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(3,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.Hb(4,0,null,null,84,"div",[["class","ms-fontWeight-regular ms-bgc-nla"],["id","officeHome"]],null,null,null,null,null)),r.Gb(5,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),r.qb(16777216,null,null,1,null,Ri)),r.Gb(7,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,xi)),r.Gb(9,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(10,16777216,null,null,1,"router-outlet",[["name","install-wizard"]],null,null,null,null,null)),r.Gb(11,212992,null,0,Vn.p,[Vn.b,r.W,r.k,[8,"install-wizard"],r.h],null,null),(e()(),r.qb(16777216,null,null,1,null,Li)),r.Gb(13,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(14,0,null,null,41,"div",[["class","o365cs-base o365cst"],["id","officeHome__container"]],null,null,null,null,null)),r.Gb(15,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Zb(16,{"office-box-sizing":0,"left-nav-offset":1,"appbar-offset":2,"bottom-tray-navigation":3,"ms-bgc-nla":4,"fluent-background-color":5,"fluentvnext-background":6,"fluentvnext-background-shadow":7}),(e()(),r.qb(16777216,null,null,1,null,Ui)),r.Gb(18,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(19,0,[[1,0],["scrollElement",1]],null,36,"dmponent;return"dragover"===t&&(i=!1!==r.dragoverHandler(n)&&i),"drop"===t&&(i=!1!==r.dropHandler(n)&&i),i}),null,null)),r.Gb(20,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(21,{"scroll-content":0,"scroll-content--transform":1,"app-gallery-workspace-nav-offset":2,"scroll-content--hide":3,"scroll-content-light":4,"scroll-content-dark":5}),r.Gb(22,409600,null,0,Ei,[r.o,X.a,r.F],null,null),(e()(),r.Hb(23,0,null,null,32,"div",[["id","officeHome__wrapper"]],null,null,null,null,null)),r.Gb(24,278528,null,0,gt.i,[r.x,r.y,r.o,r.K],{ngClass:[0,"ngClass"]},null),r.Zb(25,{"fluent-background":0,"with-appbar-min-width":1}),r.Gb(26,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),(e()(),r.qb(16777216,null,null,1,null,Ni)),r.Gb(28,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(29,0,null,null,26,"div",[["id","officeHome__content"]],null,[[null,"ohpResize"]],(function(e,t,n){var i=!0;return"ohpResize"===t&&(i=!1!==e.component.onResize(n)&&i),i}),null,null)),r.Gb(30,278528,null,0,gt.n,[r.o,r.y,r.K],{ngStyle:[0,"ngStyle"]},null),r.Gb(31,4407296,null,0,Oi.a,[Fi.a,r.o,Zt.a],null,{resize:"ohpResize"}),(e()(),r.qb(16777216,null,null,1,null,Wi)),r.Gb(33,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ji)),r.Gb(35,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Hi)),r.Gb(37,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Bi)),r.Gb(39,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Gi)),r.Gb(41,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,qi)),r.Gb(43,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Vi)),r.Gb(45,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(46,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),r.Gb(47,212992,null,0,Vn.p,[Vn.b,r.W,r.k,[8,null],r.h],null,null),(e()(),r.qb(16777216,null,null,1,null,zi)),r.Gb(49,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Ki)),r.Gb(51,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Zi)),r.Gb(53,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Qi)),r.Gb(55,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,2,null,Xi)),r.Gb(57,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),r.Yb(131072,gt.b,[r.h]),(e()(),r.qb(16777216,null,null,1,null,Ji)),r.Gb(60,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,Yi)),r.Gb(62,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.Hb(63,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(64,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.Hb(65,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(66,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.Hb(67,16777216,null,null,1,null,null,null,null,null,null,null)),r.Gb(68,475136,null,0,un.a,[dn.a,r.W,F.a,h.b,it.a,pn.a,Zt.a,r.F,fn.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.qb(16777216,null,null,1,null,$i)),r.Gb(70,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,er)),r.Gb(72,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,tr)),r.Gb(74,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,nr)),r.Gb(76,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ir)),r.Gb(78,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,rr)),r.Gb(80,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,or)),r.Gb(82,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ar)),r.Gb(84,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,lr)),r.Gb(86,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,sr)),r.Gb(88,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,cr)),r.Gb(90,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,ur)),r.Gb(92,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,dr)),r.Gb(94,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,pr)),r.Gb(96,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,fr)),r.Gb(98,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,hr)),r.Gb(100,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,mr)),r.Gb(102,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,2,null,br)),r.Gb(104,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),r.Yb(131072,gt.b,[r.h]),(e()(),r.qb(16777216,null,null,1,null,gr)),r.Gb(107,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,vr)),r.Gb(109,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.themeRootCssClass),e(t,3,0,"skip-to-main#SkipToMainModule"),e(t,5,0,"ms-fontWeight-regular ms-bgc-nla",n.officeHomeClass),e(t,7,0,n.leftNavReact&&!n.onWacContentPage),e(t,9,0,n.appBarEnabled&&!n.onWacContentPage),e(t,11,0),e(t,13,0,n.loadFeatureCalloutModule);var i=e(t,16,0,!n.onFeedPage,n.leftNavReact&&!n.onWacContentPage,n.appBarEnabled&&!n.onWacContentPage,n.bottomTrayEnabled,!n.fluentThemeRefreshEnabled,!n.fluentThemeRefreshEnabled,n.fluentThemeRefreshEnabled,n.fluentHeaderEnabled);e(t,15,0,"o365cs-base o365cst",i),e(t,18,0,n.showWorkspaceNav);var o=e(t,21,0,!n.onContentPage,!n.onContentPage&&!n.onMyContentPage,n.showWorkspaceNav,n.onM365AppsPage||n.onModernVisioTemplatesPage,!n.isDarkMode,n.isDarkMode);e(t,20,0,o),e(t,22,0);var a=e(t,25,0,n.showBackgroundImage&&!n.visualBackgroundEnabled,n.onAppGallery&&n.appsModuleEnabled);e(t,24,0,a),e(t,26,0,n.showBackgroundImage&&!n.visualBackgroundEnabled?n.backgroundStyle:""),e(t,28,0,n.visualBackgroundEnabled),e(t,30,0,n.visualBackgroundEnabled?n.visualOfficeWrapperStyle:""),e(t,31,0),e(t,33,0,n.showAnnouncement),e(t,35,0,n.showMobileAppBanner),e(t,37,0,!n.onContentPage&&!n.onAppGallery),e(t,39,0,!n.onContentPage&&!n.onMyContentPage&&!n.onFeedPage),e(t,41,0,(n.showNewCommercialUserShelfExpanded||n.showNewUserShelfCollapsed)&&n.onHomePage),e(t,43,0,n.showNewConsumerExperiences&&n.onHomePage),e(t,45,0,n.webVitalsEnabled||n.memoryProfilingEnabled),e(t,47,0),e(t,49,0,!n.newOfficeHomePageExperience),e(t,51,0,!n.mobileMenusEnabled&&!n.actionContextMenuEnabled),e(t,53,0,!n.mobileMenusEnabled&&n.actionContextMenuEnabled),e(t,55,0,n.fluidSupportEnabled&&!n.isIE),e(t,57,0,n.shouldShowFeedbackButton()&&!r.hc(t,57,0,r.Wb(t,58).transform(n.isStandalone))),e(t,60,0,n.supportCentralEnabled&&!n.onContentPage),e(t,62,0,n.uploadEnabled),e(t,64,0,"error-dialog#ErrorDialogModule"),e(t,66,0,"input-dialog#InputDialogModule"),e(t,68,0,"error-dialog-react#ErrorDialogReactModule"),e(t,70,0,n.deleteDialogEnabled),e(t,72,0,n.taskModule),e(t,74,0,n.customPivots),e(t,76,0,n.createOneNotePageEnabled),e(t,78,0,n.searchEnabled&&!n.hideCustomSearch),e(t,80,0,n.sidePopUpEnabled),e(t,82,0,n.toastContainer),e(t,84,0,n.uploadv2Experience),e(t,86,0,n.draftEnabled),e(t,88,0,n.bottomTrayEnabled&&!n.onFluidContentPage),e(t,90,0,n.firstRunEnabled),e(t,92,0,n.loadTeachingUiReactModule),e(t,94,0,!n.onContentPage),e(t,96,0,n.mobileMenusEnabled),e(t,98,0,n.mobileMenusEnabled||n.loadShareControlModuleForContentPage),e(t,100,0,n.loadMoveToFolderModuleForContentPage),e(t,102,0,n.nativeSearchEnabled),e(t,104,0,r.hc(t,104,0,r.Wb(t,105).transform(n.wacHostEnabled))),e(t,107,0,n.fluentThemeRefreshEnabled),e(t,109,0,n.portalPreloadEnabled)}),null)}function yr(e){return r.jc(0,[r.cc(671088640,1,{scrollElement:0}),(e()(),r.qb(16777216,null,null,1,null,Sr)),r.Gb(2,16384,null,0,gt.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.viewInitializationCompleted)}),null)}var Cr=r.Db("ohp-app",mt,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-app",[],null,[["window","resize"],["window","focus"],["window","beforeinstallprompt"],["window","appinstalled"]],(function(e,t,n){var i=!0;return"window:resize"===t&&(i=!1!==r.Wb(e,1).onWindowResize()&&i),"window:focus"===t&&(i=!1!==r.Wb(e,1).onWindowFocus()&&i),"window:beforeinstallprompt"===t&&(i=!1!==r.Wb(e,1).onBeforeInstall(n)&&i),"window:appinstalled"===t&&(i=!1!==r.Wb(e,1).onAppInstalled()&&i),i}),yr,Mi)),r.Gb(1,507904,null,0,mt,[d.a,X.a,1,0)}),null)}),{},{},[]),wr=n("ZJrL"),Tr=function(){function e(e){this.windowService=e,this.initialize()}return e.prototype.getShellAndConfigPromise=function(){return window.queuedMarks=window.queuedMarks||[],window.performance&&window.performance.mark&&window.performance.mark("App_Initialization_Complete"),window.queuedMarks.push({markName:"App_Iin_Bootstrap"}),this.she.prototype.initialize=function(){this.initialized||(this.initialized=!0,this.setShellAndConfigPromise())},e.prototype.fetchShellAndConfig=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.windowService.nativeWindow.shellAndConfigResponse];case 1:if(e=t.sent())try{this.shellAndConfigDa)},e.prototype.setShellAndConfigPromise=function(){this.shellAndConfigResponse=this.fetchShellAndConfig()},e.ɵprov=r.kc({factory:function(){return new e(r.lc(f.b))},token:e,providedIn:"root"}),e}(),kr=function(){function e(e,t){this.apiConfigurationDataService=e,this.globalErrorHandler=t,this.configMap=new Map(Object.entries(this.apiConfigurationDataService.shellAndConfigData)),this.shouldSample=Math.random()<=.01}return e.prototype.parse=function(e,t){void 0===t&&(t=!1);try{if(this.shouldSample&&Object(Gt.a)({eventName:e,area:"ApiConfigParserService"}),this.configMap.has(e)){if(t){var n=wr.a.decodeJsonString(this.configMap.get(e));return JSON.parse(n)}return JSON.parse(this.configMap.get(e))}return wr.a.parseJsonElementWithId(e)}catch(t){var i=new u.a("Failure to parse "+e+" from ShellConfig response",t);this.globalErrorHandler.handleError(i)}},e}(),Ir=function(e){return Object(c.a)()?new Tr(e):null},_r=function(e){return Object(c.a)()?function(){return e.getShellAndConfigPromise()}:function(){return Promise.resolve()}},Ar=function(e,t){return Object(c.a)()?new kr(e,t):new Ft.a(t)},Pr=function(e,t,n){return Object(c.a)()?function(){var i=e.get(lt.a).reactShellConfig,r=e.get(Y.a).capabilities,o=document.createElement("script");o.src=i.resourceUrl,o.crossOrigin="anonymous",o.async=!0,o.type="text/javascript",o.onload=function(){if(HomePage.ShellUtil.BootstrapReactShell("IWApp",i,r),n.config.authType===h.a.OrgId){var e=t.parse("navBarData");HomePage.ShellUtil.HydrateCommercialReactShell(e,!1,i)}},document.body.appendChild(o)}:function(){}},Er=function(){return function(){}}(),Or=n("R7NL");function Fr(e,t){return t.open(e,"login_window","width=483,height=600,top="+(t.innerHeight/2-300+t.screenY)+",left="+(t.innerWidth/2-241.5+t.screenX))}function Dr(e,t,n){var i=t.setInterval((function(){e&&!e.closed&&void 0!==e.closed||(t.clearInterval(i),n())}),100);return i}var Mr=n("MFXD"),Rr=n("EYcb"),xr=n("tyUq"),Lr=function(e){function t(t,n,i){var r=this;try{r=e.call(this,n.config.puid,i.getStorage(f.a.SessionStorage))||this,i.isStorageAvailable(f.a.SessionStorage)||(t.logGenericEvent("Session_Storage_Unavailable"),Object(P.a)({eventName:"Session_Storage_Unavailable"}))}catch(e){}return r}return Object(i.__extends)(t,e),t.ɵprov=r.kc({factory:function(){return new t(r.lc(F.a),r.lc(h.b),r.lc(f.b))},token:t,providedIn:"root"}),t}(n("XV2T").a),Ur=function(){function e(e,t,n,i,r,o,a,l){this.windowService=e,this.documentService=t,this.contextService=n,this.capabilitiesService=i,this.sessionStorageService=r,this.instrumentationService=o,this.clientStartupConfigService=a,this.errorDialogService=l,this._responses=new Mr.a,t"handler_error",this.init()}return e.prototype.supportsToken=function(e){return this.supportedTokens.has(e)},e.prototype.requiresInteractiveLogin=function(e){var t;if(this.capabilitiesService.capabilities.isPwaInUwp)return!1;var n=this.getTokenFromCache(e);return!(n&&n.success&&n.token&&n.expiryMs>Date.now())&&n&&!n.success&&this.isInteractiveErrorMessage(null===(t=n.error)||void 0===t?void 0:t.message)},e.prototype.fetchTokenInteractive=function(e){var t=this;return new Promise((function(n,i){t.showLoginDialog((function(){var r=t.supportedTokens.get(e),o=t.getState("popup"),a=t.windowService.nativeWindow,l=t.getTokenFetchUrl(r,o,"login"),s=D.a.now(),c=Fr(l,a);if(!c){var u="Could not create login popup";return t.logFetchRequest(!1,!0,!1,-1,u),void i(u)}var d=Dr(c,a,(function(){var e=D.a.now(),n="Popup closed by user";t.logFetchRequest(!1,!0,!1,Math.ceil(e-s),n),i(n)}));t.waitForToken(e,o,s,!1,!0).catch().then((function(e){a.clearInterval(d),c.close(),e&&e.success?n(e):i("Failed to fetch token through popup")}))}),(function(){var e="Verify dialog closed by user";t.logFetchRequest(!1,!0,!1,-1,e),i(e)}))}))},e.prototype.getAccessTokenResponse=function(e,t,n){var i=this;if(void 0===t&&(t=!1),void 0===n&&(n=!1),!this.supportsToken(e))return Promise.reject("token not supported");if(t&&this.requiresInteractiveLogin(e))return this.fetchTokenInteractive(e);var r=D.a.now();if(!n){var o=this.getTokenFromCache(e);if(o&&o.success&&o.token&&o.expiryMs>Date.now()){var a=D.a.now();return this.logFetchRequest(!0,!1,!0,Math.ceil(a-r)),Promise.resolve(o)}}var l=this.getState("iframe"),s=this.supportedTokens.get(e),c=this.getTokenFetchUrl(s,l,"none"),u=this.getIframeId(e),d=this.documentService.nativeDocument.getElementById(u);return d?d.setAttribute("src",c):this.documentService.addIframeToPage(c,u),this.waitForToken(e,l,r,!0,!1).then((function(n){var r;return!n.success&&t&&i.isInteractiveErrorMessage(null===(r=n.error)||void 0===r?void 0:r.message)?i.fetchTokenInteractive(e):n}))},e.prototype.waitForToken=function(e,t,n,i,r){var o=this,a=null,c=[];if(i){var u=new Promise((function(e){a=setTimeout((function(){e({success:!1,token:null,format:"RPSDelegation",error:new Z.a("timeout"),source:"MSA"})}),o.cont d=this.responses.withScope(1).pipe(Object(l.a)((function(e){return e.state===t||e.state===o.handlerErrorId})),Object(s.a)(1),Object(le.a)((function(e){return e&&e.state!==o.handlerErrorId&&e.token&&e.token.TokenValue&&!e.error?{success:!0,token:e.token.TokenValue,format:"RPSDelegation",source:"MSA",expiryMs:e.token.ExpiryMs}:{success:!1,token:null,format:"RPSDelegation",error:new Z.a(F.a.filterPii(e.error)),source:"MSA"}}))).toPromise();return c.push(d),Promise.race(c).then((function(t){var i,l=D.a.now();return o.logFetchRequest(!1,r,t.success,Math.ceil(l-n),null===(i=t.error)||void 0===i?void 0:i.message),a&&clearTimeout(a),o.saveTokenToCache(e,t),t}))},e.prototype.getTokenFromCache=function(e){var t=this.sessionStorageService.get(this.getCacheKey(e));try{var n=JSON.parse(t.error),r=new Z.a(n.message,n.statusCode);return r.stack=n.stack,Object(i.__assign)(Object(i.__assign)({},t),{error:r})}catch(e){return t}},e.prototype.saveTokenToCache=function(e,t){var n,r=Object(i.__assign)(Object(i.__assign)({},t),{error:t.error?JSON.stringify({message:null===(n=t.error)||void 0===n?void 0:n.message,stack:t.error.stack,statusCode:t.error.statusCode}):void 0});this.sessionStorageService.set(this.getCacheKey(e),r)},e.prototype.getCacheKey=function(e){return"_msatoken_"+e},e.prototype.isInteractiveErrorMessage=function(e){return e&&(-1!==e.indexOf("login_required")||-1!==e.indexOf("interaction_required"))},Object.defineProperty(e.prototype,"responses",{get:function(){return this._responses.asScopableObservable()},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.capabilitiesService.capabilities.msaClientTokensEnabled&&(this.windowService.nativeWindow.addEventListener("message",(function(t){t.origin===e.windowService.nativeWindow.location.origin&&e._responses.next(t.data)})),this.clientStartupConfigService.config.isV2Auth||(this.supportedTokens.set("OneDrive","onedrive_implicit.access"),this.supportedTokens.sead")),this.supportedTokens.forEach((function(t,n){e.documentService.addIframeToPage(null,e.getIframeId(n))})))},e.prototype.getIframeId=function(e){return"ohpMSAToken_"+e},e.prototype.getInstrumentationParams=function(e,t){var n={};return n.State=e?"FromCache":"FromNetwork",n.Action=t?"interactive":"silent",n},e.prototype.logFetchRequest=function(e,t,n,i,r){var o=this.getInstrumentationParams(e,t);this.instrumentationService.logRequestEvent("Msa_Token_Fetch",n?200:500,i,r,e,o),Object(xr.a)({eventName:"Msa_Token_Fetch",httpCode:n?200:500,latency:i,error:r,fromCache:e})},e.prototype.getTokenFetchUrl=function(e,t,n){var i=this.contextService.sharedContext.msaAppId,r=this.contextService.sharedContext.msaTokenRedirectUrl;return(this.contextService.sharedContext.inMockMode?this.contextService.sharedContext.officeHomeApiRoot+"/getMsaToken?mockmode="+this.getMockMode()+"&":"https://login.live.com/oauth20_authorize.srf?")+"client_id="+i+"&response_type=token&redirect_uri="+encodeURIComponent(r)+"&response_mode=fragment&scope="+encodeURIComponent(e)+"&state="+encodeURIComponent(t)+"&prompt="+n+"&utupConfigService.config.userPrincipalName)},e.prototype.getState=function(e){return e+"|"+ut.a.createGuid()},e.prototype.showLoginDialog=function(e,t){this.errorDialogService.showErrorDialog({category:"VerifyIdentity",error:"LoginRequired",onActionClicked:e,onClose:t})},e.prototype.getMockMode=function(){return Ot.a.getQueryParams(this.windowService.nativeWindow.location.search).mockmsatoken||"default"},e.ɵprov=r.kc({factory:function(){return new e(r.lc(f.b),r.lc(d.a),r.lc(He.a),r.lc(Y.a),r.lc(Lr),r.lc(F.a),r.lc(h.b),r.lc(Rr.a))},token:e,providedIn:"root"}),e}(),Nr=function(e){function t(t,i,r,o,l,s,c,u,d,p,f,h,m,b,g){var v=e.call(this)||this;v.authStateService=t,v.contextService=i,v.capabilitiesService=r,v.instrumentedHttp=o,v.eventService=l,v.configParserService=s,v.instrumentationService=u,v.msaTokenService=d,v.windowService=p,v.reactShellConfigService=f,v.userContextService=h,v.errorDialogService=m,v.locService=b,v.clientStartupConfigService=g,v.tokensRequiringResourceUrl=new Set(["OneDrive","SharePoint","MetaOS"]),v._messageResponses=new Mr.a,v.capDialogStartTime=0,v.init(c,"JWT","OfficeHome"),v.refreshApiUrls=new Map,v.accessTokens=new Map,v.pendingRefreshRequests=new Map,v.secondaryTokensEnabled=v.capabilitiesService.capabilities.secondaryTokensEnabled,v.msaClientTokensEnabled=v.capabilitiesService.capabilities.msaClientTokensEnabled,v.defaultResourceUrls=new Map,v.defaultResourceUrls.set("OneDrive",v.contextService.sharedContext.oneDriveResourceId),v.defaultResourceUrls.set("SharePoint",v.contextService.sharedContext.sharePointResourceId),v.msaClientTokensEnabled&&(v.clientStartupConfigService.config.isV2Auth||(v.initializeAccessToken("OneDrive","",null),v.initializeAccessToken("Graph","",null))),v.capabilitiesService.capabilities.di),n.e(2),n.e(46),n.e(62),n.e(107)]).then(n.bind(null,"BOsL")).then((function(e){e.initializeMsalWithBroker()})),v.capabilitiesService.capabilities.hybridAuthEnabled?(v.initializeHybridAuthPromise=Promise.all([n.e(0),n.e(1),n.e(2),n.e(46),n.e(62),n.e(107)]).then(n.bind(null,"BOsL")),v.initializePrimaryTokensPromise=Promise.resolve(),v.initializeSecondaryTokensPromise=Promise.resolve()):v.capabilitiesService.capabilities.clientTokenFetchEnabled?(v.initializeSecondaryTokensPromise=Promise.resolve(),v.secondaryTokensEnabled&&v.initializeSecondaryTokens(null),v.initializePrimaryTokensPromise=new Promise((function(e){var t=v.contextService.sharedContext.officeHomeApiRoot+"/api/primaryTokens?pageUrl="+encodeURIComponent(v.windowService.nativeWindow.location.href),n={responseType:"json",headers:new Map};v.instrumentedHttp.get("Primary_Token_Fetch_Request","Primary_Token_Fetch",t,n,"network-only").then((function(t){var n=t.data;n&&n.ReauthRequired&&n.LoginUrl?v.windowService.nativeWindow.location.href=n.LoginUrl:(v.initializePrimaryTokens(n&&n.Tokens),e())})).catch((function(t){v.errorHandler.handleError(t,"Pno9F"),v.initializePrimaryTokens(null),e()}))}))):(v.initializePrimaryTokensPromise=v.initializeTokensPromise("primaryTokensInfo","primaryTokensLoaded",(function(e){if(!e){var t={ElementId:"primaryTokensInfo"};v.instrumentationService.logGenericEvent("Tokens_Config_Missing",t),Object(a.a)({featureName:"Auth",eventName:"Tokens_Config_Missing",params:t})}v.initializePrimaryTokens(e),v.secondaryTokensEnabled||v.msaClientTokensEnabled||v.initializeSecondaryTokens(e)})),v.initializeSecondaryTokensPromise=v.secondaryTokensEnabled?v.initializeTokensPromise("secondaryTokensInfo","secondaryTokensLoaded",(function(e){if(!e){var t={ElementId:"secondaryTokensInfo"};v.instrumentationService.logGenericEvent("Tokens_Config_Missing",t),Object(a.a)({featureName:"Auth",eventName:"Tokens_Config_Missing",params:t})}v.initializeSecondaryTokens(e)})):Promise.resolve());var S=v.windowService.nativeWindow.shellTokenRequestDictionary;return v.reactShellConfigService.reaoint]=function(){return v.getAccessTokenResponse("ConsumerShellService").then((function(e){return e.token}))}),v.windowService.nativeWindow.addEventListener("message",(function(e){e.origin===v.windowService.nativeWindow.location.origin&&v._messageResponses.next(e.data)})),v}return Object(i.__extends)(t,e),t.prototype.hasPermanentAuthError=function(){var e=this;return new Promise((function(t){e.initializePrimaryTokensPromise.then((function(){var n=e.accessTokens.size>0;e.accessTokens.forEach((function(e){n&&e.token&&!e.token.HasPermanentError&&(n=!1)})),t(n)}))}))},t.prototype.hasOneDriveToken=function(){var e=this.accessTokens.get(this.getTokenKey("OneDrive",null));return!!e&&!!e.token&&!!e.token.TokenValue},t.prototype.hasCAPError=function(e,t){var n=this.getTokenKey(e,t),i=this.accessTokens.get(n);return i&&i.token&&i.token.HasCAPError},t.prototype.getAccessTokenResponse=function(e,t,n,i,r,o,l,s,c){var u=this;if(void 0===t&&(t=!1),void 0===n&&(n=""),void 0===i&&(i=!1),void 0===r&&(r=null),this.capabilitiesService.capabilities.hybridAuthEnabled)return new Promise((function(o,c){u.initializeHybridAuthPromise.then((function(c){c.getToken({tokenConsumer:e,forceFetch:t,resourceId:n,scope:l,isBoot:void 0,claims:s,silent:!i,capDialogData:{category:null==r?void 0:r.category,fileType:Ye.a.fileTypeNameFromType(null==r?void 0:r.fileType)}}).then((function(e){o({success:e.success,token:e.token,expiryMs:e.expiryMs,format:"JWT",source:"OfficeHome"})})).catch((function(){var t={};t.ElementId="hybridAuthTokenFetch_"+e,u.instrumentationService.logGenericEvent("Hybrid_Auth_Unexpected_Error",t),Object(a.a)({featureName:"Auth",eventName:"Hybrid_Auth_Unexpected_Error",params:t}),o({success:!1,token:null,format:"JWT",source:"OfficeHome"})}))}))}));var d=this.getTokenKey(e,n,l,s),p=this.pendingRefreshRequests.get(d);if(p&&p.pending&&(!i||p.allowInteractive))return p.result;var f={pending:!1,result:null,allowInteractive:i},m=new Promise((function(o,a){u.getInitializationPromise(e,i).then((function(){var p=u.accessTokens.get(d);if(p||(p={refreshEndpoint:u.refreshApiUrls.get(e),token:{TokenValue:"",ExpiryMs:u.getDefaultExpiry()},resourceUrl:n},u.accessTokens.set(d,p)),(t=u.capabilitiesService.capabilities.claimsChallengeEnabled?t||p.forceRefresh||!!c:t||p.forceRefresh)||!u.tokenIsValid(p)){var f=function(e,t,n,i,o){u.startCAPFlow(e,t,n,r).then((function(){u.accessTokens.forEach((function(e){e.forceRefresh=!0,e.token.TokenValue="",e.token.HasCAPError=!1,e.token.HasPermanentError=!1,e.token.CAPSubErrorCode=null})),o(!0,!0),u._reauth.next()})).catch(i)},m=0,b=function(t,d){var h=function(e,n,i){var r="string"==typeof e?new Z.a(e,i):e;n&&m<u.contextService.sharedContext.accessTokenMaxRetryAttempts?(++m,b(t,d)):a(r)};if(u.useMsaTokenService(e))u.msaTokenService.getAccessTokenResponsee){!e.error&&e.token?(u.refreshToken(p,e.token,e.expiryMs),o(e)):h(e.error,!1)})).catch((function(e){h(e,!1)}));else if(n||(n=p.resourceUrl),n||!u.tokensRequiringResourceUrl.has(e)){var g={responseType:"json",headers:new Map};n&&g.headers.set("X-OfficeHome-ResourceUrl",n);var v=void 0===l?"":"&scope="+l,S=s&&0!==s.length?"&claims="+s.join("_"):"",y=null==r?void 0:r.category;u.instrumentedHttp.get("Refresh_Access_Token_Request","Refresh_Access_Token",u.contextService.sharedContext.officeHomeApiRoot+"/"+p.refreshEndpoint+(t?"?bypassCache=true":"?bypassCache=false")+v+S+(u.capabilitiesService.capabilities.claimsChallengeEnabled&&c?"&claimschallenge="+c:""),g,"network-only").instrument((function(i,r){if(r.Action=d?"CAP_Retry":"Regular",r.State=t?"Bypass_Cache":"Regular",r.Consumer=e,r.Retry=m.toString(),n){r.ResourceUrl=new F.d(n);var o=Ye.a.referralFromFileLocation(n);!o&&Ye.a.isConsumerDocument(n)&&(o="Consumer"),r.DocumentType=o}})).then((function(e){var t=e.data;t&&t.TokenValue?(u.refreshToken(p,t.TokenValue,t.ExpiryMs),d&&u.logCAPDialogEvent("token refresh succeeded",y),o({success:!0,token:t.TokenValue,expiryMs:t.ExpiryMs,format:"JWT",source:"OfficeHome"})):(d&&u.logCAPDialogEvent("token refresh empty token",y),h("Response did not contain valid token",!0))})).catch((function(e){if(u.errorHandler.handleError(e,"Srefresh failed",y),e){var t=e.data,n=e.status;if(t&&t.HasCAPError){var o=function(){return h("CAP_Error",!1)};i&&u.capabilitiesService.capabilities.capPopupEnabled&&!d&&t.CAPSubErrorCode&&t.ResourceId&&r?f(t.ResourceId,t.Scopes,t.CAPSubErrorCode,o,b):o()}else h("Request failed with error code: "+n,n>=500&&n<600||0===n||707===n||706===n,n)}else h("Request failed",!required for <"+e+">.",!1)};if(p.token&&p.token.HasCAPError){var g=function(){return a(new Z.a("CAP_Error"))};return void(i&&u.capabilitiesService.capabilities.capPopupEnabled&&p.token.CAPSubErrorCode&&p.token.ResourceId&&r?(u.clientStartupConfigService.config.authType===h.a.OrgId||u.clientStartupConfigService.config.authType===h.a.MSA&&"Graph"===e)&&f(p.token.ResourceId,p.token.Scopes,p.token.CAPSubErrorCode,g,b):g())}if(p.token&&p.token.HasPermanentError)return void a(new Z.a("Permanent auth error has been detected; refresh token for <"+e+"> is aborted."));if("SignedIn"!==u.authStateService.getCurrentState())return void a(new Z.a("User has to be signed in; refresh token for <"+e+"> is aborted."));if("OfficeHome"===e)return void a(new Z.a("Not refreshing OfficeHome token"));b(t||!!p.token.TokenValue,!1)}else o({success:!0,token:p.token.TokenValue,expiryMs:p.token.ExpiryMs,format:"JWT",source:"OfficeHome"})})).catch((function(t){u.errorw Z.a("Toialization info."))}))})).then((function(e){return f.pending=!1,e})).catch((function(e){throw f.pending=ype.useMsaTokenService=function(e){return this.msaClientTokensEnabled&&this.msaTokenService.supportsToken(e)},t.prototype.getTokenKey=function(e,t,n,i){return void 0===n&&(n=".default"),!t&&this.defaultResourceUrls.has(e)&&(t=this.defaultResourceUrls.get(e)),i&&i.length>0?e+(t?"_"+t:"")+"_"+n+"_"+i.join("_"):e+(t?"_"+t:"")+"_"+n},t.prototype.tokenIsValid=function(e){return e&&e.token&&e.token.TokenValue&&e.token.ExpiryMs>(new Date).getTime()},t.prototype.refreshToken=function(e,t,n){e.token.TokenValue=t,e.token.ExpiryMs=n||this.getDefaultExpiry(),e.forceRefresh=!1},t.prototype.startCAPFlow=function(e,t,n,i){var r=this;return this.,a){var l=function(){r.pendingInteractiveRequest=null,o()},s=function(){r.pendingInteractiveRequest=null,a()};r.errorDialogService.showErrorDialog({category:null==i?void 0:i.category,error:r.clientStartupConfigService.config.authType===h.a.MSA?"MSAGraphCapError":"ConditionalAccess",fileType:null==i?void 0:i.fileType,errorInfo:{capErrorCode:n},onActionClicked:function(){return r.openCAPPopup(e,t,null==i?void 0:i.category,l,s)},onClose:s})})),this.pendingInteractiveRequest},t.prototype.openCAPPopup=function(e,t,n,i,r){var o=this,a=this.clientStartupConfigService.config.isV2Auth?encodeURIComponent(this.createResourceWithScopes(e,t)):e,c=this.locService.format(this.contextService.sharedContext.tokenLoginUrlTemplate,a);this.capDialogStartTime=D.a.now();var u=Fr(c,this.windowService.nativeWindow);if(!u)return this.logCAPDialogEvent("Could not,n);var d=Dr(u,this.windowService.nativeWindow,(functior",n),r()}));this.messageResponses.withScope(1).pipe(Object(l.a)((function(e){return!!e&&!!e.capLoginMessage})),Object(s.a)(1)).toPromise().then((function(e){o.windowService.nativeWindow.clearInterval(d),u.close(),o.logCAPDialogEvent(e.capLoginMessage,n),"CAP_LoginComplete"===e.capLoginMessage?i():r()}))},t.prototype.logCAPDialogEvent=function(e,t){var n={};n.ItemCategory=t,n.State=e,n.Latency=Math.ceil(D.a.now()-this.capDialogStartTime).toString(),this.instrumentationService.logGenericEvent("CAP_Popup",n),Object(a.a)({featureName:"AccessToken",eventName:"CAP_Popup",params:n})},t.prototype.getInitializationPromise=function(e,t){return this.useMsaTokenService(e)?Promise.resolve():(n=!this.secondaryTokensEnabled||"OneDrive"!==e&&"SharePoint"!==e&&"Exchange"!==e?this.initializePrimaryTokensPromise:this.initializeSecondaryTokensPromise,t&&this.pendingInteractiveRequest?Promise.all([n,this.pendingInteractiveRequest]).catch().then():n);var n},t.prototype.initializeTokensPromise=function(e,t,n){var i=this;return new Promise((function(r){var o=Z.c.NotInitialized,a=function(t){if(o!==Z.c.NotInitialized)return!1;if(t&&!document.getElementById(e))return!1;o=Z.c.Initializing;var a=i.configParserService.parse(e);return n(a),r(),o=Z.c.Initialized,!0};a(!0)||(i.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return e.name===t})),Object(s.a)(1)).toPromise().then((function(){return a(!1)})),$.a.shellAndConfigsReady().then((function(){return a(!1)})))}))},t.prototype.initializePrimaryTokens=function(e){this.initializeAccessToken("BingAnswers","api/refreshBingAnswersToken/v2",e&&e.BingAnswers),this.initializeAccessToken("Graph","api/refreshGraphAccessToken/v2",e&&e.Graph),this.initializeAccessToken("Loki","api/refreshLokiToken/v2",e&&e.Loki),this.initializeAccessToken("MruPlusPlus","api/refreshMruPlusPlusToken/v2",e&&e.Mru),this.initializeAccessToken("OneNote","api/refreshOneNoteToken/v2",e&&e.OneNote),this.initializeAccessToken("Portal","api/refreshPortalToken/v2",e&&e.Portal),this.initializeAccessToken("QueryFormulation","api/refreshQueryFormulationToken/v2",e&&e.QueryFormulation),this.initializeAccessToken("Substrate","api/refreshSubstrateToken/v2",e&&e.Substrate),this.initializeAccessToken("Sway","api/refreshSwayToken/v2",e&&e.Sway),this.initializeAccessToken("Thor","api/refreshThorToken/v2",e&&e.Thor),this.initializeAccessToken("Forms","api/refreshFormsToken/v2",e&&e.Forms),this.initializeAccessToken("MyApps","api/refreshMyAppsToken/v2",e&&e.MyApps),this.initializeAccessToken("ConsumerShellService","api/refreshConsumerShellServiceToken/v2",e&&e.ConsumerShellService),this.initializeAccessToken("FluidPushChannel","api/refreshFluidPushChannelToken/v2",e&&e.FluidPushChannel),this.initializeAccessToken("AugLoop","api/refreshAugLoopToken/v2",e&&e.AugLoop),!this.userContextService.user.isGcc&&this.initializeAccessToken("Ods","api/refreshOdsToken/v2",e&&e.Ods),this.initializeAccessToken("TenantFeedback","api/refreshTenantFeedbackToken/v2",e&&e.TenantFeedback),this.initializeAccessToken("Notify","api/refreshNotifyToken/v2",e&&e.Notify),this.initializeAccessToken("Yammer","api/refreshYammerToken/v2",e&&e.Yammer),this.initializeAccessToken("MetaOS","api/refreshMetaOSToken/v2",null),this.initializeAccessToken("MfsService","api/refreshMfsServiceToken/v2",e&&e.MfsService),this.initializeAccessToken("VisioService","api/refreshVisioServiceToken/v2",e&&e.VisioService),this.capabilitiesService.capabilities.captureScanEnabled&&this.initializeAccessToken("CaptureService","api/refreshCaptureServiceToken/v2",e&&e.CaptureService),this.initializeAccessToken("OfficeHome",null,e&&e.OfficeHome)},t.prototype.initializeSecondaryTokens=function(e){this.initializeAccessToken("OneDrive","api/refreshOneDriveToken/v2",e&&e.OneDrive,this.contextService.sharedContext.oneDriveResourceId),this.initializeAccessToken("SharePoint","api/refreshSharePointToken/v2",e&&e.SharePoint,this.contextService.sharedContext.sharePointResourceId),this.initializeAccessToken("Exchange","api/refreshExchangeToken/v2",e&&e.Exchange)},t.prototype.initializeAccessToken=function(e,t,n,i){void 0===i&&(i=""),(n=n||{TokenValue:""}).TokenValue&&!n.ExpiryMs&&(n.ExpiryMs=this.getDefaultExpiry());var r={refreshEndpoint:t,token:n,resourceUrl:i};this.accessTokens.set(this.gProperty(t.prototype,"messageResponses",{get:function(){return this._messageResponses.asScopableObservable()},enu,t.prototype.createResourceWithScopes=function(e,t){return t&&0!==t.length?t.map((function(t){return e+"/"+t})).join(" "):e},t}(Z.b),Wr=n("xoWf"),jr=n("4d0o"),Hr=n("Dpxn"),Br=n("n826"),Gr=n("Brer");function qr(e,t,n){return e.capabilities.useVroomForOneDriveApis?n:t}var Vr,zr,Kr=function(){return function(){}}(),Zr=n("fuFU"),Qr=n("Aqby"),Xr=new r.u("DISK_PRELOAD_URL_PATTERNS"),Jr=n("aQ3G"),Yr=window.diskPreloadRequestMap,$r=function(e,t,n,i){var r;if(e.sharedContext.inMockMode)return[{pattern:new RegExp("/mock/v2/recent/docs","i"),markerName:"MRU"},{pattern:new RegExp("/mock/docs/recent","i"),markerName:"MRU"},{pattern:new RegExp("/mock/sites","i"),markerName:"SharePointSites"},{pattern:new RegExp("/mock/recommended/api","i"),markerName:"RecommendedDocs"},{pattern:new RegExp("/mock/(.*)/me/drive/root","i"),markerName:"OneDriveRoot"},{pattern:new RegExp("/mock/PeoplePredictionsB2/api","i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp("/mock/PeoplePredictionsB2/MicrosoftFeed","i"),markerName:"OfficeFeedV2Docs"}];var o=[],a=!!(null===(r=null==i?void 0:i.capabilities)||void 0===r?void 0:r.edgeworthEnabled);if(t&&t.config){var l=t.config,s=l.substrateApiEndpoint,c=l.officeFeedApiRootPath,u=l.recommendedB2ApiFilesPath,d=l.recommendedB2ApiRootPath;a||o.push({pattern:new RegExp("^"+l.mruServiceRoot+"/v2/recent/docs","i"),markerName:"MRU"}),o.push({pattern:new RegExp("^"+s+"/"+d+"/"+u,"i"),markerName:"RecommendedDocsV1"},{pattern:new RegExp("^"+s+"/"+c+"/(.*)/insights/query\\(context=null,scenario='(.*)',target=null,section='(.*)'\\)","i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp("^"+s+"/PeoplePredictionsB2/MicrosoftFeed\\?section=(.*)&rs=(.*)&forceNewSchema=true","i"),markerName:"OfficeFeedV2Docs"})}return a||(n&&n.config&&o.push({pattern:new RegExp("^"+n.config.sharePointServiceRoot,"i"),markerName:"SharePointSites"}),e&&e.sharedContext&&o.push({pattern:new RegExp("^"+e.sharedContext.graphApiRoot+"/("+Jr.a.graphBeta+"|"+Jr.a.graphV1+")/"+Br.a.myDriveEndpoint+"root$","i"),markerName:"OneDriveRoot"})),o},eo=window.diskPreloadUrlStorageKey,to=window.diskPreloadUserIdStorageKey,no=function(){return function(){}}(),io=n("/6za");function ro(e){return function(){return Vr||(Vr=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){return[2,(t=e.config).tenantId+"_"+t.puid]}))}))}(e)),Vr}}var oo,ao,lo=function(e,t,n){return n&&function(e,t){if(!Object(gt.t)(t))return!1;try{var n=e.nativeWindow,i=n.navigator;if(!("serviceWorker"in i))return!1;var r=i.serviceWorker;return!(!r.getRegistration||!r.getRegistrations)&&"URL"in n&&URL.prototype.hasOwnProperty("searchParams")}catch(e){return!1}}(e,t)},so=function(e,t){return function(){return zr||(zr=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,ro(e)()];case 1:))}(e,t)),zr}},co=function(){return function(){}}(),uo=n("oHg+"),po=function(e,t){return t&&e.config.enabled},fo=function(){return funcnction(){function e(e,t,n){this.webCryptoService=e,this.encryptionConfigService=t,this.textEncodingService=n}return e.prototype.saltedHash=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){return[2,he(this.webCryptoService.crypto.subtle,e,this.encryptionConfigService.config.digestSaltBase64,(function(e){return t.textEncodingService.encode(e)}))]}))}))},e.ɵprov=r.kc({factory:function(){return new e(r.lc(go.b),r.lc(bo.a),r.lc(mo.a))},token:e,providedIn:"root"}),e}(),So=function(){return function(){}}(),yo=n("cZRF"),Co=function(){function e(e){this.encryptionService=e}return e.prototype.decryptResponse=function(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,l,s,c,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if("arraybuffer"===n||"blob"===n)throw this.generateError(ue.a.NotImplemented,"Unsupported Encrypted Cached Body Type: "+n);i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.encryptionService.decryptData(t)];case 2:return r=i.sent(),[3,4];case 3:throw i.sent(),this.generateError(ue.a.DecryptionError,"Failed to decrypt response.");case 4:if(o=r.body,a=r.headers,s=r.statusText,c=r.status,!(l=r.requestUrl)||l.toLowerCase()!==e.toLowerCase())throw this.generateError(ue.a.UnexpectedResponse,"Resource read from cache does not match the resource being used");if(!o)throw this.generateError(ue.a.EmptyResponse,"Received an empty response from cache. Cannot decrypt.");try{return u="json"===n?JSON.parse(o):o,[2,new ie.l({body:u,headers:new ie.i(JSON.parse(a)),statusText:s,status:c,url:e})]}catch(e){throw this.generateError(ue.a.UnexpectedResponse,"Failed to parse response")}return[2]}}))}))},e.prototype.generateError=function(e,t){return new ie.f({error:t,status:e,statusText:t})},e}(),wo=function(){function e(e){this.serviceWorkerEnabled=e}return e.prototype.intercept=function(e,t){return this.serviceWorkerEnabled&&"cache-only"===e.headers.get(de.a)?t.handle(e).pipe(Object(se.a)((function(e){if(!(e instanceof ie.f))throw e;if(e.status!==ue.a.Unknown)throw e;throw new ie.f({error:e.error,headers:e.headers,status:ue.a.CacheMiss,statusText:ue.a[ue.a.CacheMiss],url:e.url})}))):t.handle(e)},e}(),To=n("JYvP"),ko=n("2dXW"),Io=function(){function e(e,t,n){this.errorHandler=e,this.windowService=t,this.serviceWorkerApiAvailable=n,this._messages=new ko.a,this.initialized=this.initialize()}return e.prototype.waitForTransactionalMessageAndRespond=function(e,t){var n=this;if(e&&t&&this.initialized)return this._messages.pipe(Object(l.a)(e)).subscribe((function(e){t(e).then((function(t){e.ports&&e.ports.length?e.ports[0].postMessage(t):e.source.postMessage(t)})).catch((function(e){n.errorHandler.handleError(e)}))}))},e.prototype.initialize=function(){var e=this;if(!this.serviceWorkerApiAvailable)return!1;try{this.serviceWorkerContainer=tvigator.serviceWorker,this.serviceWorkerContainer.ad)}))}catch(e){return!1}return!0},e.ɵprov=r.kc(,this.serviceWorkerUserIdFactory=n,this.serviceWorkerEnabled=i,this.decryptResponseService=r,this.initialize()}return e.prototype.intercept=function(e,t){var n=this;if(!this.decryptResponseService||"cache-only"!==e.headers.get(de.a))return t.handle(e);var i=e.clone({responseType:"arraybuffer"});return t.handle(i).pipe(Object(To.a)((function(t){if(t instanceof ie.l){var i=t,r=new Uint8Array(i.body);if(!r.length)return Object(oe.a)(n.generateError(ue.a.UnexpectedResponse,"Received an empty response from cache. Cannot decrypt."));if("application/octet-stream"!==i.headers.get("Content-Type"))return Object(oe.a)(n.generateError(ue.a.UnexpectedResponse,"Data is not binary. Cannot decrypt."));var o=void 0;try{o=be(r)}catch(e){return Object(oe.a)(n.generateError(ue.a.DecryptionError,e.message))}return Object(re.a)(n.decryptResponseService.decryptResponse(i.url,o,e.responseType))}return Object(ae.a)(t)})))},e.prototype.initialize=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return this.serviceWorkerEnabled?[4,this.serviceWorkerUserIdFactory()]:[2];case 1:return e=n.sent(),this.serviceWorkerInitiatedMessageService.waitForTransactionalMessageAndRespond((function(t){var n=t.data;if(!n||"encrypt"!==n.type||"request"!==n.meta)return!1;var i=n.payload;return i.userId===e&&3===i.encryptionVersion}),(function(e){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n=(t=e.data.payload).requestId,[4,this.encryptionService.encryptData(t.data)];case 1:return r=i.sent(),[2,{type:"encrypt",meta:"response",payload:{requestId:n,encryptedData:r,encryptionVersion:3}}]}}))}))})),[2]}}))}))},e.prototype.generateError=function(e,t){return new ie.f({error:t,status:e,statusText:t})},e}(),Ao=n("2q5z"),Po=new r.u("DISK_PRELOAD_USER_ID_STORAGE_KEY"),Eo=new r.u("DISK_PRELOAD_STORAGE_KEY"),Oo=new r.u("DISK_PRELOAD_REQUEST_MAP"),Fo=function(){function e(e,t,n,i,r,o,a,l){this.localStorageService=e,this.userIdStorageKey=t,this.urlPatternStorageKey=n,this.urlPatternEntries=i,this.serviceWorkerUserIdFactory=r,this.diskPreloadRequestMap=o,this.serviceWorkerEnabled=a,this.serviceWorkerConfigService=l,this.diskPreloadEnabled=!0,this.diskPreloadStorageEntries=[],this.initialized=this.init()}return e.prototype.tryAddToPreloadList=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.initialized];case 1:return n.sent(),this.diskPreloadEnabled?(!(t=this.getMarkerName(e))||this.hasUrl(e)||this.updateStorageEntries(Object(i.__spread)(this.diskPreloadStorageEntries,[{url:e,markerName:t}])),[2]):[2]}}))}))},e.prototype.loadPreloadResponse=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this.diskPreloadEnabled?[2,this.diskPreloadRequestMap.get(e)]:[2,null]}}))}))},e.prototype.init=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(this.initialized)throw new Error("`init()` can only be called once.");return this.serviceWorkerConfigService.config.diskPreloadEnabled&&this.serviceWorkerEnabled?(e=this.localStorageService.getGlobal(this.userIdStorageKey),[4,this.serviceWorkerUserIdFactory()]):(this.diskPreloadEnabled=!1,[2]);case 1:return t=i.sent(),e!==t?(this.diskPreloadEnabled=!1,this.localStorageService.setGlobal(this.userIdStorageKey,t),this.updateStorageEntries(al(this.urlPatternStorageKey))?(this.updateStorageEntries(n.filter((function(e){return!!r.getMarkeototype.getMarkerName=function(e){try{return this.urlPatternEntries.find((function(t){return t.pattern.tee){return}},e.prototype.hasUrl=function(e){return dStorageEntries=e,this.localStorageService.setGlobal(this.urlPatternStorageKey,this.diskPreloadStorageEntries)},e.ɵprov=r.kc({factory:function(){return new e(r.lc(et.a)(Oo),r.lc(S),r.lc(g.a))},token:e,providedIn:"root"}),e}(),Do=function(){function e(e){this.diskPreloadService=e}return e.prototype.intercept=function(e,t){var n=this;return"cache-only"===e.headers.get(de.a)?Object(re.a)(this.diskPreloadService.loadPreloadResponse(e.urlWithParams)).pipe(Object(ce.a)((function(i){return i?i.ok?Object(re.a)(n.convertToAngularHttpResponse(i,e.responseType)):Object(oe.a)(n.convertToAngularHttpErrorResponse(i)):t.handle(e)}))):t.handle(e).pipe(Object(Ao.a)((function(t){t instanceof ie.l&&t.ok&&n.diskPreloadService.tryAddToPreloadList(e.urlWithParams)})))},e.prototype.convertToAngularHttpResponse=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:switch(t){case"json":return[3,1];case"text":return[3,3];case"arraybuffer":return[3,5];case"blob":return[3,7]}return[3,9];case 1:return[4,e.json()];case 2:return n=i.sent(),[3,9];case 3:return[4,e.text()];case 4:return n=i.sent(),[3,9];case 5:return[4,e.arrayBuffer()];case 6:return n=i.sent(),[3,9];case 7:return[4,e.blob()];case 8:return n=i.sent(),[3,9];case 9:return[2,new ie.l({body:n,headers:this.convertToAngularHeaders(e.headers),status:e.status,statusText:e.statusText,url:e.url})]}}))}))},e.prototype.convertToAngularHttpErrorResponse=function(e){return new ie.f({error:e.statusText,status:e.status,statusText:e.statusText,headers:this.convertToAngular,e.prototype.t=t.append(n,e)}))n(){},e.prototype.registerRecentJumpList=function(){},e.prototype.getJumpListItemById=function(){return null},e}(),Lo=n("Bc8L"),Uo=function(){function e(){}return e.prototype.launchOfficeApp=function(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.launchOfficeAppWithTemplate=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.openPathInEaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.shouldOpenInOfer)(this,void 0,void 0,(functionect(i.__generatorn(e){return[2,Promise.resolve(!1)]}))}))},e}(),No=function(){return function(){}}(),Wo=function(){function e(){}return e.prototype.isEligibleToPin=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,new Promise((function(e){return e(!1)}))]}))}))},e.prototype.pinToTaskbar=function(){return Object(oid 0,(function(){s,(fu(){return function(){}}(),Ho=function(){function e(){}return e.prototype.isSurfaceDevice=function(){return!1},e}(),Bo=function(){function e(e,t,n){this.capabilitiesService=e,this.contextService=t,this.windowService=n}return e.prototype.openUrl=function(e,t,r,o,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return this.capabilitiesService.capabilities..e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchUrl(e,{action:t,linkTarget:r})})),[2,Promise.resolve()]):(this.windowService.nativeWindow.open(e,r||this.contextService.sharedContext.defaultLinkTarget,"number"==typeof o&&"number"==typeof a?"width="+o+",height="+a:""),[2,Promise.resolve()])}))}))},e.prototype.supportsProtocol=function(e){return Promise.reject("Method not implemented.")},e.ɵprov=r.kc({factory:function(){return new e(r.lc(Y.a),r.lc(He.a),r.lc(f.b))},token:e,providedIn:"root"}),e}(),Go=n("H90i"),qo=n("ZBli"),Vo=function(e){function t(t,n,i,r,o,a,l,s,c){var u=e.call(this)||this;return u.appTilesConfigService=t,u.capabilitiesService=n,u.configParserService=i,u.contextService=r,u.dateService=o,u.globalErrorHandler=a,u.startupConfigService=l,u.scheduler=s,u.shellShimService=c,u.nativeWorkloads=new Array,u.allWorkloads=u.configParserService.parse("workloadsData")||{nonCoreAndSegmentApps:[],coreAndSegmentApps:[],pinnedApps:[]},u.shellPinEnabled=u.capabilitiesService.capabilities.shellPinEnabled,u.allWorkloads.pinnedApps&&u.populateWorkloadFields(u.allWorkloads.pinnedApps),u.allWorkloads.coreAndSegmentApps=u.allWorkloads.coreAndSegmentApps.filter((function(e){return u.filterLocalOnlyApps(e)})),u.usedThirdPartyWorkloads=[],u.thirdPartyWorkloads=[],u.thirdPartyWorkloadsSubject=new Hn.a([]),u.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled||(u.subscribeToThirdPartyAppUpdates(),u.getWorkloads().then((function(e){u.usedThirdPartyWorkloads=e.filter((function(e){return e.IsThirdParty})),u.cleanUnusedThirdPartyWorkloads()}))),u}return Object(i.__extends)(t,e),t.prototype.getProvisionedWorkloads=function(){var e=this;return new Promise((function(t,n){e.getWorkloads().then((function(e){var n=e.filter((function(e){return!!e.Url}));n.forEach((function(e){e.IsThirdParty||(e.AppId=e.Id.slice(5),e.CollectorId="FirstParty")})),t(n)})).catch((function(t){e.globalErrorHandler.handleError(t,"Dnsgi"),n("Failed to get workloads list")}))}))},t.prototype.getCoreSegmentAndFrequentApps=function(){var e=this;return this.coreSegmentAndOtherAppsPromise||(this.coreSegmentAndOtherAppsPromise=new Promise((function(t){var n=e.allWorkloads,i=e.getFrequentAppsWithAnyClicks(n.nonCoreAndSegmentApps),r=n.coreAndSegmentApps.concat(i);e.populateWorkloadFields(r),e.startupConfigService.config.authType===h.a.MSA?e.getMsaWorkloadsData(r).then(t):t(r)}))),this.coreSegmentAndOtherAppsPromise.then((function(e){return Object(i.__spread)(e)}))},t.prototype.getPinnedWorkloads=function(){return this.allWorkloads.pinnedApps},t.prototype.unpinWorkload=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(dApps=this.allWorkloads.pinnedApps.filter((function(t){return!(t.AppId===e.AppId&&t.CollectorId===e.CollectorId)})),[4,this.shellShimService.getShellShim()];case 1:return(t=n.sent())&&t.Apps.Unpin(e.CollectorId,e.AppId),[2]}}))}))},t.prototype.getWorkloads=function(){var e=this;return this.workloadsPromise||(this.workloadsPromise=new Promise((function(t){var n,i=e.allWorkloads;n=i.coreAndSegmentApps.concat(i.nonCoreAndSegmentApps),e.populateWorkloadFields(n),e.startupConfigService.config.authType===h.a.MSA?e.getMsaWorkloadsData(n).thspread)(e)}))},t.prototype.getWorkloadId=function(e){return t.fileTypeToIdMap.has(e)?t.fileTypeToIdMap.get(e):""},t.prototype.getReferralType=function(e){var t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.ClickCount?e.LastOccurrence<t.getTime()?F.c.ResurrectedReferral:e.LastOccurrence>=t.getTime()?F.c.RepeatReferral:F.c.NotDetected:F.c.FirsttimeReferral},t.prototype.getDisplayedApps=function(e){var t,n,r,o,a,l,s=this.appTilesConfigService.config,c=s.coreAppIds&&s.segmentSpecificAppIds?s.coreAppIds.ppIds||s.segmeength){var d=e.filter((funcunction(e){return c.indexOf(e.Id)<0})),f=s.coreAppIds?e.filter((function(e){return s.coreAppIds.indexOf(e.Id)>-1})):[];if(!d.length||!p.length||f.length<3)try{for(var h=Object(i.__values)(e),m=h.next();!m.done;m=h.next())u.push(m.value.Id)}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}else{var b=this.getFrequentAppsWithAnyClicks(p);try{for(var g=Object(i.__values)(d),v=g.next();!v.done;v=g.next())u.push(v.value.Id)}catch(e){r={error:e}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}if(b.length)try{for(var S=Object(i.__values)(b),y=S.next();!y.done;y=S.next())u.push(y.value.Id)}catch(e){a={error:e}}finally{try{y&&!y.done&&(l=S.return)&&l.call(S)}finally{if(a)throw a.error}}}return u.toString()}},t.prototype.getFrequentAppsWithAnyClicks=function(e){var t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.filter((function(e){return e.ClickCount>0&&e.LastOccurrence>=t.getTime()}))},t.prototype.getThirdPartyWorkloads=function(){return this.thirdPartyWorkloadsSubject.asObservable()},t.prototype.updateUsedThirdPartyApps=function(e){if(this.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled);else{var t=this.usedThirdPartyWorkloads.findIndex((function(t){return t.Id.toLowerCase()===e.Id.toLowerCase()})),n=t>=0?this.usedThirdPartyWorkloads[t]:void 0;n?this.areThirdPartyAppsEqual(n,e)||(this.usedThirdPartyWorkloads[t]=e):this.usedThirdPartyWorkloads.push(e)}},t.prototype.populateWorkloadFields=function(e){var n=this;e.forEach((function(e){e.getId=function(){return e.Id},e.Referral=e.IsThirdParty?e.Id:t.referralFromWorkloadId(e.Id),e.FWorkloadCustomUrl(e.FileType,e.Url)}))},t.prototype.getAdditionalWorkloads=function(){return Promise.resolve([])},t.prototype.pinWorkload=function(e){this.shellPinEnabled&&this.shellShimService.getShellShim().then((function(t){var n=e.AppId,i=e.CollectorId;i&&n&&!t.Apps.IsPinned(i,n)&&t.Apps.Pin(i,n)}))},t.prototype.getInAppNav=function(e){var t=this.allWorkloads.coreAndSegmentApps.concat(this.allWorkloads.nonCoreAndSegmentApps).concat(this.allWorkloads.pinnedApps).find((function(t){return t.Id===e}));return!!t&&t.InAppNav},t.prototype.getFileType=function(e){return t.idToFileTypeMap.has(e)?t.idToFileTypeMap.get(on(e){var t=this;return this.getShellWorkloadsData().then((function(n){return t.populateMSAWorkloadFields(e,n),e}))},t.referralFromWorkloadId=function(e){return e&&e.length&&0===e.lastIndexOf(t.AppTileElementIdPrefix,t.AppTileElementIdPrefixLength)?e.substring(t.AppTileElementIdPrefixLength):null},t.prototype.filterLocalOnlyApps=function(e){return!e.IsNativeClientOnlyApp||(this.nativeWorkloads.push(e),!1)},t.prototype.populateMSAWorkloadFields=function(e,t){var n=this;e.forEach((function(e){for(var i=e.Id.toLowerCase(),r=0;r<t.length;r++){var o=t[r];if(o.Id.toLowerCase()===i){e.Color=o.BackgroundColor,e.FileType=n.getFileType(e.Id),e.Url&&(e.Url=n.getWorkloadCustomUrl(e.FileType,o.LaunchUrl));break}}}))},t.prototype.getWorkloadCustomUrl=function(e,t){switch(e){case Ye.b.Forms:t=qo.a.appendAndReplaceQueryParams(t,{origin:Go.a,lang:this.contextService.sharedContext.officeMarket,sessionId:this.startupConfigService.config.sharedClientStartupContext.sessionId},!1,!0)}return t},t.prototype.getShellWorkloadsData=function(){var e=this;return new Promise((function(t,n){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.shellShimSeunction(e){return{BackgroundColor:e.BackgroundColor,FontIconCss:e.FontIconCss,Id:e.Id,LaunchUrl:e.LaunchFullUrl}}));t(i)}else n("Shell shim apps not available.")})):n("Shell shim is not available"),[2]}}))}))}))},t.prototype.subscribeToThirdPartyAppUpdates=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return e=r.sent(),[4,this.shellShimService.afterShellPlusLoaded];case 2:return r.sent(),[4,new Promise((function(r){var o=0,a=0,l=!1;e.Apps.OnAppsUpdated((function(s){if(s&&s.Apps){var c=s.Apps.filter((function(e){return"FirstParty"!==e.CollectorId&&!n.thirdPartyWorkloads.find((function(t){return t.Id===e.Id}))}));c=c.filter((function(e){return"LineOfBusiness"!==e.CollectorId})),n.capabilitiesService.capabilities.showBusinessApps||(c=c.filter((function(e){return"Dynamics"!==e.CollectorId}))),c.forEach((function(t){var s=t.LaunchFullUrl;n.thirdPartyWorkloads.push({ChangeColorInDarkMode:"Dynamics"===t.CollectorId,Color:t.BackgroundColor,Id:t.Id,AppId:t.Id,CollectorId:t.CollectorId,Title:t.AriaLabel?t.AriaLabel:"",SubText:t.Subtitle,Text:t.Title,IsNativeClientOnlyApp:t.isNativeClientOnlyApp,Url:s?s.trim():"",IconUnicodeCodepointCssClass:"ms-fcl-tp ms-Icon ms-Icon--OfficeAddinsLogo",ThirdPartyIcon:t.IconAnonymousUrl?t.IconAnonymousUrl:null,Referral:t.Id,IsThirdParty:!0,getId:function(){return t.Id}}),t.IconAnonymousUrl||(++o,n.scheduler.schedun(e){if(++a,e){var s=n.thirdPartyWorkloads.findIndex((function(e){return e.Id.toLowerCase()===t.Id.toLowerCase()})),c=n.thirdPartyWorkloads[s];n.thirdPartyWorkloads[s]=Object(i.__assign)(Object(i.__assign)({},c),{ThirdPartyIcon:"data:"+e.MimeType+";base64,"+e.Base64EncodedImage}),n.thirdPartyWorkloadsSubject.next(n.thirdPartyWorkloads)}l&&o===a&&r()}))}),3))})),n.thirdPartyWorkloadsSubject.next(n.thirdPartyWorkloads),(l=s.DataSource===t.AppsShimDataSourceAppCollectors||s.DataSource===t.AppsShimDataSourceShellDataComplete)&&o===a&&r()}}))}))];case 3:return r.sent(),this.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled||this.invalidateThirdPartyAppCache(),[2]}}))}))},t.prototype.cleanUnusedThirdPartyWorkloads=function(){if(0!==this.usedThirdPartyWorkloads.length){var e=this.dateService.addDays(ttTime();this.usedThirdPartyWorkloads=thqual=function(e,t){return e.Text===t.Text&&e.Url===t.Url&&e.ThirdPartyIcon===t.ThirdPartyIcon&&e.Title===t.Title},t.prototype.invalidateThirdPartyAppCache=function(){var e=this;if(0!==this.usedThirdPartyWorkloads.length){var t=[],n=!1;this.usedThirdPartyWorkloads.forEach((function(i){var r=e.thirdPartyWorkloads.find((function(e){return e.Id===i.Id}));r?e.areThirdPartyAppsEqual(r,i)?t.push(r):(t.push(r),n=!0):n=!0})),n&&(this.usedThirdPartyWorkloads=t)}},t.AppTileElementIdPrefixLength=(t.AppTileElementIdPrefix="Shell").length,t.AppsShimDataSourceAppCollectors=3,t.AppsShimDataSourceShellDataComplete=4,t.idToFileTypeMap=new Map([["ShellWordOnline",Ye.b.Word],["ShellExcelOnline",Ye.b.Excel],["ShellPowerPointOnline",Ye.b.PowerPoint],["ShellOneNoteOnline",Ye.b.OneNote],["ShellClassNotebook",Ye.b.OneNoteClassNoteBook],["ShellVisioOnline",Ye.b.Visio],["ShellSway",Ye.b.Sway],["ShellOfficeForms",Ye.b.Forms],["ShellDocuments",Ye.b.OneDrive],["ShellSites",Ye.b.SharePoint],["ShellMicrosoftStream",Ye.b.Stream]]),t.fileTypeToIdMap=new Map([[Ye.b.Word,"ShellWordOnline"],[Ye.b.Excel,"ShellExcelOnline"],[Ye.b.PowerPoint,"ShellPowerPointOnline"],[Ye.b.OneNote,"ShellOneNoteOnline"],[Ye.b.Visio,"ShellVisioOnline"],[Ye.b.Sway,"ShellSway"],[Ye.b.Forms,"ShellOfficeForms"],[Ye.b.OneDrive,"ShellSway"],[Ye.b.SharePoint,"ShellOfficeForms"],[Ye.b.Stream,"ShellMicrosoftStream"]]),t}(Et.a),zo=n("Xc4i"),Ko=n("UWom"),Zo=n("SQAW");!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(oo||(oo={})),function(e){e.AccessToken="AccessToken",e.FileGetUrl="FileGetUrl"}(ao||(ao={}));var Qo=n("idgT"),Xo=n("IBRu"),Jo=n("y9oG"),Yo=function(e){function t(t,n,i,r,o,a,l,s){var c=e.call(this,t,n,i,"Graph",r,o,a,s)||this;return c.globalErrorHandler=l,c.requestConfig={headers:new Map([["content-type","application/x-www-form-urlencoded"]])},c}return Object(i.__extends)(t,e),t.prototype.postPreboot=function(t,n,i,r){var o=this;return new Promise((function(a,l){e.prototype.post.call(o,t,n,i,r,(function(e){e.instrument((function(e,t){t.RequestId=o.getRequestIdFromResponse(e)})).then((function(){return a(null)}))}),(function(e){l(e)}),o.requestConfig,void 0,void 0,void 0,void 0,"None")}))},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Z.b),r.lc(F.a),r.lc(Or.a),r.lc(He.a),r.lc(p.a),r.lc(gt.q),r.lc(u.b),r.lc(it.a))},token:t,providedIn:"root"}),t}(n("pOWU").a),$o=function(e){function t(t,n,i,r,o,a,l,s,c,u,d){var p=e.call(this,t,n,i,r,o,a,l,s)||this;return p.webPwaService=c,p.windowService=u,p.wacPrebootService=d,p.prebootedApplications=new Map,p.bootstrappedDocuments=new Map,p.prebootedDocuments=new Map,p.prebootedWopiFetchData=new Map,p.prebootedSessionId=new Map,p.webPwaService.isStandalone.subscribe((function(e){p.isStandalone=e,p.uihit=p.getUihit(e),p.uih="officecom"+p.uihit})),p}return Object(i.__extends)(t,e),t.prototype.prebootDocument=function(e){var t=this;if(e.driveId&&e.docId&&!this.prebootedDocuments.has(this.getPrebootKey(e))){var n=this.getWopiData(e,!1,!1,!0);n.then((function(i){var r=ut.a.createGuid(),o=t.index++,a=t.getPrebootKey(e);t.prebootedDocuments.set(a,o),t.prebootedWopiFetchData.set(a,n),t.prebootedSessionId.set(a,r);var l="access_token="+encodeURIComponent(i.wopiHostData.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(i.wopiHostData.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(i.wopiHostData.bundleUrl)+"&fileExtension="+encodeURIComponent(Ye.a.getFileExtension(i.wopiHostData.fileName))+"&user_id="+encodeURIComponent(i.wopiHostData.wac.userId);t.wacPrebootService.postPreboot("WacDocument_Preboot","WacDocument_Preboot",t.getPrebootUrl(i.wopiHostData.wac.applicationUrl)+"?op=preboot&usid="+encodeURI(r),l)}))}},t.prototype.bootstrapItem=function(e,t,n){var r,o,a,l=this;this.prebootedApplications.clear();var s=!1;if(this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(e.fileType)&&e.driveId&&e.docId){var c=this.getPrebootKey(e);o=this.prebootedDocuments.get(c),r=this.prebootedWopiFetchData.get(c),a=this.prebootedSessionId.get(c),(s=Number.isInteger(o))&&(this.prebootedDocuments.delete(c),this.prebootedSessionId.delete(c))}var u=Object(i.__read)(this.generateCorrelationAndBootId(o),2),d=u[0],p=u[1];this.logPerformanceBootStart(p,d,e.wdOrigin,e.fileType);var f=new Ko.a;this.logPerformanceEventFromClick(p,"WacContent_Document_Wopi_Fetch_Start",e.fileType);var h=null!=r?r:n||this.getWopiData(e,!1,!1,!0);h.then((function(n){l.logPerformanceEventFromClick(p,"WacContent_Document_Wopi_Fetch_End",e.fileType),l.bootstrapFile(f,p,e,n.wopiHostData,d,t,n.fetchDiagnostics,!0,s?a:void 0)})).catch((function(e){l.sendBootError("WacDocument_Vroom_Error",e,f)}));var m=e.fileName,b={correlationId:d,bootstrapperObservable:f.asObservable(),fileNamePromise:m?Promise.resolve(Ye.a.fileNameWithoutExtension(m)):h.then((function(e){return Ye.a.fileNameWithoutExtension(e.wopiHostData.fileName)})),documentIdentifierPromise:h.then((function(e){return e.fetchedDocumentInfo}))},g={correlationId:d,bootedDocumentInfo:{bootId:p,documentInfo:e},data:b};return this.bootstrappedDocuments.set(p,g),g},t.prototype.bootstrapZeroByteDocument=function(e,t,n,r,o){var a=this,l=this.prebootedApplications.get(e.fileType);Date.now()>(null==l?void 0:l.expirationTime)&&(l=void 0,this.prebootedApplications.clear());var s=Object(i.__read)(l?l.correlationAndBoot:this.generateCorrelationAndBootId(),2),c=s[0],u=s[1];this.logPerformanceBootStart(u,c,e.wdOrigin,e.fileType);var d=l?l.loadFunctionSubject:new Ko.a,p=n.then((function(t){return a.logPerformanceEventFromClick(u,"WacContent_Document_Wopi_Fetch_Start",e.fileType),a.getWopiData(t,!0,!1,!0)}));p.then((function(n){return Object(i.__awaiter)(a,void 0,void 0,(function(){var a,s;return Object(i.__generator)(this,(function(p){switch(p.label){case 0:return this.logPerformanceEventFromClick(u,"WacContent_Document_Wopi_Fetch_End",e.fileType),[4,n.fetchedDocumentInfo];case 1:return a=p.sent(),s=o?Object(i.__assign)(Object(i.__assign)({},a.applicationUrlParams),{templateItemId:r,templateDriveId:o}):r?Object(i.__assign)(Object(i.__assign)({},a.applicationUrlParams),{wdTpl:r}):a.applicationUrlParams,l?l.finishLoad(n.wopiHostData,a.newFileInfo):this.bootstrapFile(d,u,Object(i.__assign)(Object(i.__assign)({},a),{applicationUrlParams:s}),n.wopiHostData,c,t,Object(i.__assign)(Object(i.__assign)({},n.fetchDiagnostics),{endTime:Date.now()})),[2]}}))}))})).catch((function(e){a.sendBootError("WacDocument_Vroom_Error",e,d)}));var f=p.thrObservable:d.asObservable(),fileNamePromise:f.then((function(e){return Ye.a.fileNameWithoutExtension(e.fileName)})),documentIdentifierPromise:f},m={bootId:u,documentInfo:Object(i.__assign)(Object(i.__assign)({},e),{newFile:!0,templateId:r})},b={correlationId:c,bootedDocumentInfo:m,data:h};return this.bootstrappedDocuments.set(u,b),l&&this.prebootedApplications.clear(),b},t.prototype.bootstrapApplication=function(e,t){var n=this;if(this.capabilitiesService.capabilities.wacHostPrebootApps.has(e)&&!this.prebootedApplications.has(e)){var r=Object(i.__read)(this.getOfficeBootstrapper(e),2),o=r[0];if(o&&!r[1]){var a=Object(i.__read)(this.generateCorrelationAndBootId(),2),l=a[0],s=a[1],c=new Ko.a,u=Object(i.__read)(Object(Xo.a)(),3),d=u[0],p=u[1],f=u[2];c.next((function(r){var a=r.container,l=r.flushTime,c=r.loadCorrelationId;return new Zo.a((function(r){var u=n.getInitParams(e,c,t,a.nativeElement,l,l,(function(t){return Object(i.__awaiter)(n,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:return this.logPerformanceEventFromClick(s,"WacContent_Document_Load_End",e),[4,d];case 1:return n=i.__read.apply(void 0,[o.sent(),1]),r.next({wopiHostData:n[0],officeApplication:t}),r.complete(),[2]}}))}))}),(function(e){n.sendBootError("WacDocument_JsApi_Error",e,r)}),void 0,void 0,void 0,void 0,void 0,{wdasp:1});n.logPerformanceEventFromClick(s,"WacContent_Document_InitializeWopiPending",e);var p=o.Application.InitializeWopiPending(u);p?d.then((function(e){var t=Object(i.__read)(e,2),r=t[1],o=n.getWopiInfo(t[0].wac);p.Complete(o,r)})).catch((function(){})):n.sendBootError("Initialize_Wopi_PentstrapperObservabmise:d.then((function(e){return Object(i.__read)(e,1)[0].fileName}))},b={finishLoad:function(e,t){return p([e,t])},cancelLoad:h,loadData:{correlationId:l,bootedDocumentInfo:{bootId:s,documentInfo:{fileType:e,wdOrigin:t}},data:m},loadFunctionSubject:c,expirationTime:Date.now()+this.contextService.sharedContext.wacHostAppPrebootTimeout,correlationAndBoot:[l,s]};return this.prebootedApplications.set(e,b),b}}},t.prototype.bootstrapFile=function(e,t,n,r,o,a,l,s,c){var u=this;void 0===s&&(s=!0);var d=n.fileType,p=null==r?void 0:r.wac,f=0;try{f=(null==p?void 0:p.accessTokenExpiry)?parseInt(p.accessTokenExpiry):0}catch(e){}if(!(null==p?void 0:p.bootstrapperUrl)||f<Date.now())s?this.getWopiData(n,n.newFile,!0).then((function(i){i?u.bootstrapFile(e,t,n,i.wopiHostData,o,a,i.fetchDiagnostics,occurred while trying to fetch wopi data",e)})).catch((function(t){u.sendBootError("WacDocument_Vroom_Error",t,e)})):this.sendBootError("WacDocument_Vroom_Error","Failed to get wopi data for the item",e);else{var h=r.wac.bootstrapperUrl,m=r.wac.applicationUrl;this.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_Start",d),this.loadBootstrapper(h,m,d).then((function(){var s=Object(i.__read)(u.getOfficeBootstrapper(d),2),p=s[0],f=s[1];if(f)u.sendBootError("WacHost_Bootstrapper_Load_Error",f,e);else{u.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_End",d);var m=u.getWopiInfo(r.wac);e.nextrrelationId;return new Zo.a((function(e){var b=setTimeout((function(){u.logError(o,n,"WacDocument_JsApi_Timeout")}),15e4),g=u.getInitParams(n.fileType,f,n.wdOrigin,i.nativeElement,o!==f?s:a,s,(function(i,l){clearTimeout(b),u.logPerformanceEventFromClick(t,"WacContent_Document_Load_End",d),u.logBootPerformance(o,n,l,a),e.next({wopiHostData:r,officeApplication:i}),e.complete()}),(function(t){clearTimeout(b),u.sendBootError("WacDocument_JsApi_Error",t,e)}),n.docId,r,m,h,l,n.applicationUrlParams,n.rebootOverrideData);u.logPerformanceEventFromClick(t,"WacContent_Document_InitializeWopiPending",d);var v=p.Application.InitializeWopiPending(te()}})).catch((function(){u.sendBootError("WacHost_Bootstrapper_Load_Error","Failed to load the bootstrapper",e)}))}},t.prototype.getOfficeBootstrapper=function(e){var t=this.windowService.nativeWindow.Microsoft;if(void 0===t)return[null,"Microsoft is undefined"];var n=t.Office,i=Ye.b[e];return n&&n[i]?[n[i],null]:[null,"Failed to find bootstrapper for app: "+i]},t.prototype.getSessionContext=function(){return{pmo:this.windowService.nativeWindow.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:this.windowService.nativeWindow.location.href}},t.prototype.getSessionInformation=function(e,t,n){void 0===n&&(n={});var i=this.contextService.sharedContext.officeMarket,r=this.capabilitiesService.capabilities;return{HostName:"office.com",HostSessionId:t,UserId:e,OwnerId:void 0,UiLocale:i,DataLocale:i,DisableChat:!0,CookieCompliant:!0,WdParams:n,DisableFocusOnBoot:!1,SessionContext:JSON.stringify(this.getSessionContext()),HideHeader:this.capabilitiesService.capabilities.isEmbedMode,SupportsDocReboot:oo.AnyDoc|oo.OtherMode,SupportsCreateNewDocument:!0,SupportsAuthToken:r.wacHostGetAuthTokenEnabled,UiHostIntegrationType:this.uihit,SupportsAtMentions:!0,SupportsCustomAuthConfig:r.wacHostGetCustomAuthConfigEnabled,SupportsExcelExternalLinks:r.wacHostExternalLinkEnabled,SupportsMoveToFolder:r.wacHostMoveToFolderEnabled}},t.prototype.getOrCreateDefaultPrecheckInfo=function(e,t){var n,r;return e?Object(i.__assign)({FileName:e.fileName,FileGetUrl:e.downloadUrl||e.wac.fileGetUrl,FileSize:e.fileSize,BundleInfo:{Url:e.bundleUrl,MajorVersion:e.bundleVersion},ReadOnly:null!==(n=e.readOnly)&&void 0!==n&&n,IrmEnabled:null!==(r=e.irmEnabled)&&void 0!==r&&r,ETag:e.eTag,ClientThrottlingProtection:e.wac.clientThrottlingProtection,RequestedCallThrottling:e.wac.requestedCallThrottling,IsNewFile:e.isNewFile},t&&{DocUniqueId:t}):{FileName:""}},t.prototype.getWopiInfo=function(e){return{WopiSrc:e.wopiSrc,AccessToken:e.accessToken,AccessTokenExpiry:new Date(parseInt(e.accessTokenExpiry))}},t.prototype.getDiagnostics=function(e,t,n,i,r){void 0===i&&(i={startTime:0,endTime:0});var o=r?this.bootstrapperDiagnostics.get(r):{startTime:0,endTime:0},a=Math.max(this.performanceService.navigationStart,e),l=Math.max(i.startTime?i.startTime:0,a),s=Math.max(i.endTime?i.endTime:0,l),c=Math.max(t,s),u=Math.max(o?o.startTime:0,c);return{entryPoint:n,userClickTime:e,hostPageNavigationStartTime:a,hostPageFetchStartTime:l,hostPageFetchEndTime:s,hostPageFirstFlushTime:c,officeBootstrapperStartTime:u,officeBootstrapperEndTime:Math.max(o?o.endTime:0,u),officeInitializationTime:Date.now()}},t.prototype.getInitParams=function(e,t,n,r,o,a,l,s,c,u,d,p,f,h,m){var b=this.applicationUrls.get(e),g=b.bootstrapperUrl,v=u?u.wac.applicationUrl||u.wac.editUrl:qo.a.removeQueryParams(b.applicationUrl,["wopisrc"],!1),S=Object(i.__assign)(Object(i.__assign)({},h),{uiEmbed:1,uih:this.uih}),y=qo.a.appendQueryParams(v,S),C={},w=this.capabilitiesService.capabilities.scenarioId;return w&&(C.wdscenarioId=w),Object(i.__assign)({BootstrapperUrl:p||g,Container:r,SessionInformation:this.getSessionInformation(u?u.wac.userId:this.clientStartupConfigService.config.puid,t,C),ApplicationUrl:y,WopiPrecheckInfo:this.getOrCreateDefaultPrecheckInfo(u,c),ApplicationCustomSettings:{HostUIControls:[{id:"close",visibility:0},{id:"share",visibility:1}]},Diagnostics:this.getDiagnostics(o,a,n,f,g),FnOnInitializeSuccess:l,FnOnInitializeFailure:s,FnIsFeatureEnabled:this.createIsFeatureEnabledCallback(e),RebootOverrideData:m},d?{WopiInfo:d}:{})},t.prototype.createIsFeatureEnabledCallback=function(e){var t=this;return function(n){switch(n){case"OfficeComUiHost":return!t.isStandalone&&!t.capabilitiesService.capabilities.isPwaInUwp;case"OfficeHwaUiHost":return t.capabilitiesService.capabilities.isPwaInUwp;case"OfficeComPreboot":return!(!t.capabilitiesService.wacHostEnabledForFileType(e)||!t.capabilitiesService.wacHostHoverPrebootEnabledForFileType(e))||!t.capabilitiesService.capabilities.wacHostHoverPrebootControlFlight&&void 0;default:return}}},t.prototype.logError=function(e,t,n,i){var Event(n,Object(Jo.a)(e,t,o))},t.prototype.sendBootError=function(e,t,n){n.error({instrumentationEvent:e,error:t})},t.prototype.getUihit=function(e){return void 0===e&&(e=!1),this.capabilitiesService.capabilities.isPwaInUwp?t.uihitOfficeComHwa:e?t.uihitOfficeComPwa:""},t.prototype.getPrebootUrl=function(e){if(!e)return null;var t=Ot.a.getLocation(e),n))+"/preboot.ashx";return Ot.a.getOrigin(e)+n},t.prototype.getPrebootKey=function(e){return e.driveId+"_"+e.docId},t.uihitOfficeComPwa="pwa",t.uihitOfficeComHwa="hwa",t}(zo.a),ea=function(e){function t(t,n,i,r,o,a,l){var s=e.call(this,o)||this;return s.errorHandler=t,s.contextService=n,s.serviceWorkerEnabled=i,s.serviceWorkerUserIdFactory=r,s.officeHomeApiConfigService=a,s.clientStartupConfigService=l,s.messageSent=!1,s}return Object(i.__extends)(t,e),t.prototype.handleRegistration=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return Object(i.__generator)(this,(function(i){if(!this.serviceWorkerEnabled)return[2];try{t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,n=function(){e.addEventListener("updatefound",(function(){r.postAuthorizedInstallMessage(e.installing)}))},e.installing?(this.postAuthorizedInstallMessage(e.installing),t&&n()):n()}catch(e){this.errorHandler.handleError(e,"OGBGO")}return[2]}))}))},t.prototype.postAuthorizedInstallMessage=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.messageSent?[2]:(n={token:null},[4,this.serviceWorkerUserIdFactory()]);case 1:return n.userId=i.sent(),n.apiPath="api/shellandconfigdata",n.apiHeaders=((r={})[this.officeHomeApiConfigService.config.userIdHeader]=this.clientStartupConfigService.config.puid,r),t=n,this.contextService.sharedContext.inMockMode&&(this.addParamFromWindow(t,"mockauth"),this.addParamFromWindow(t,"envType")),this.addParamFromWindow(t,"flight"),e.postMessage({type:"OFFICECOM_AUTH_WARMUP",meta:"installation-credentials",payload:t}),this.messageSent=!0,[2]}}))}))},t}(function(){function e(e){this.windowService=e}return e.prototype.addParamFromWindow=function(e,t){var n,i=new URL(this.windowService.nativeWindow.location.href).searchParams.get(t);i&&(e.apiQsParams?e.apiQsParams[t]=i:e.apiQsParams=((n={})[t]=i,n))},e}()),ta=function(){function e(e){this.serviceWorkerEnabled=e}return e.prototype.handleRegistration=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.serviceWorkerEnabled?[3,2]:[4,e.unregister()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e}(),na=function(){function e(e,t){this.windowService=e,this.serviceWorkerApiAvailable=t}return e.prototype.sendTransactionalMessage=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.serviceWorkerApiAvailable&&"undefined"!=typeof MessageChannel?(n=t)?[3,2]:[4,this.getServiceWorker()]:[2];case 1:n=i.sent(),i.label=2;case 2:return(t=n)?[2,new Promise((function(n){var i=new MessageChannel;i.port1.onmessage=function(e){n(e),i.port1.close(),i.port2.close()},t.postMessage(e,[i.port2])}))]:[2]}}))}))},e.prototype.sendUnidirectionMessage=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.serviceWorkerApiAvailable?(n=t)?[3,2]:[4,this.getServiceWorker()]:[2];case 1:n=i.sent(),i.label=2;case 2:return(t=n)&&t.postMessage(e),[2]}}))}))},e.prototype.getServiceWorker=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.windowService.nativeWindow.navigator.serviceWorker.ready];case 1:return[2,e.sent().active];case 2:return e.sent(),[2,null];case 3:return[2]}}))}))},e.ɵprov=r.kc({factory:function(){return new e(r.lc(f.b),r.lc(y.a))},token:e,providedIn:"root"}),e}(),ia=function(){function e(e,t,n,i,r){this.errorHandler=e,this.contextService=t,this.instrumentationService=n,this.serviceWorkerEnabled=i,this.serviceWorkerMessageService=r}return e.prototype.handleRegistration=function(e){var t=this;if(this.serviceWorkerEnabled)try{var n=e.addEventListener("updatefound",(function(){t.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing)}))};e.installing?(this.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing),n&&i()):i()}catch(e){this.errorHandler.handleError(e)}},e.prototype.subscribeToInstallingServiceWorkerActivationTelemetry=function(e){var t=this;this.serviceWorkerMessageService.sendTransactionalMessage({type:"OFFICECOM_SW_TELEMETRY",meta:"activation"},e).then((function(e){var n=e.data;"OFFICECOM_SW_TELEMETRY"===n.type&&"activation"===n.meta&&t.instrumentationService.logGenericEvent(n.payload.eventName,n.payload.params)}))},e}(),ra=n("PZOQ"),oa=n("1Bt+"),aa=n("uH9+"),la=n("jidT"),sa=n("qfyf"),ca=n("x+6c"),ua=n("ZtId"),da=function(){function e(e){void 0===e&&(e=!1),this.id=ut.a.createGuid(),this.startTime=D.a.now(),e&&this.complete()}return e.prototype.complete=function(){this.endTime=D.a.now()},e.prototype.timeSinceUpdate=function(){return this.endTime?D.a.now()-this.endTime:0},e}(),pa=function(){function e(t,n,i){this.instrumentationService=n,this.officeRouteService=i,this.updates=new Map,this.defaultUpdateTimeout=t.sharedContext.dataUpdateTimeoutInSeconds*e.MsPerSecond,this.defaultUpdateCooldown=t.sharedContext.dataUpdateCooldownInSeconds*e.MsPerSecond,this.defaultUpdateFailures=t.sharedContext.dataUpdateMaxConsecutiveFailures}return e.prototype.getOrAddUpdateStream=function(e,t,n,i,r,o){void 0===o&&(o=!1);var a=this.officeRouteService.getRouteItemForCurrentLocation();return this.updates.has(e)||this.updates.set(e,{consecutiveFailures:0,cooldown:i||this.defaultUpdateCooldown,lastUpdate:o?null:new da(!0),maxFailures:n||this.defaultUpdateFailures,operation:t,route:a,subject:new ko.a,timeout:r||this.defaultUpdateTimeout}),this.updates.get(e).subject.asObservable()},e.prototype.pushUpdate=function(e){return this.updates.has(e)?this.safeUpdate(this.updates.get(e),e):Promise.resolve()},e.prototype.updateAllowed=function(e){if(!e.lastUpdate)return!0;var t=e.lastUpdate.timeSinceUpdate();return t>0?t>e.cooldown:e.timeout&&e.lastUpdate.startTime+e.timeout<=D.a.now()},e.prototype.safeUpdate=function(e,t){var n=this;if(!this.updateAllowed(e))return Promise.resolve();var i=new da;return e.lastUpdate=i,e.operation().then((function(t){i.id===e.lastUpdate.id&&(e.subject.next(t),e.consecutiveFailures=0)})).catch((function(r){var o,a=(null==r?void 0:r.error)||r,l="Error message: "+("string"==typeof a?a:(null==a?void 0:a.message)||"not available"),s="Call stack: "+((null==a?void 0:a.errorstack)||"not available");Object(P.a)({eventName:"BaseUpdateContentServiceError",debugInfo:s,message:l}),n.instrumentationService.logDebugCacheEvent("Base_Update_Content_Service_Error",((o={}).Error=l,o.DebugInfo=s,o)),i.id===e.lastUpdate.id&&(e.consecutiveFailures++,e.consecutiveFailures>=e.maxFailures&&n.updates.delete(t))})).then((function(){i.complete()}))},e.MsPerSecond=1e3,e}(),fa=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,f,h,m){var b=e.call(this,t,n,i,r,o,a,l,s,c,u,d,p,h,m)||this;return b.ngZone=f,b.init(),b}return Object(i.__extends)(t,e),t.prototype.createThemeChangeObservable=function(){var e=this;return Zo.a.create((function(t){e.eventService.events.withScope(0).pipe(Object(l.a)((function(e){return"themeChanged"===e.name&&e.args&&2===e.args.length&&e.args[0]}))).subscribe((function(n){var i=n.args,r=i[0];!r.IsDarkMode||"base"!==r.ThemeId||r.PreferOfficeTheme&&e.capabilitiesService.capabilities.fluentHeader||(r.Primary=r.Accent);var o=[r.Darker||r.Primary,r.Dark||r.Primary,r.DarkAlt||r.Primary,r.Primary||r.Primary,r.Secondary||r.Primary,r.Tertiary||r.Primary,r.Light||r.Primary,r.Lighter||r.Primary,r.LighterAlt||r.Primary],a=e.showDarkMode();e.ngZone.run((function(){return t.next({theme:{shades:o,reactShellTheme:r,themeType:r.ThemeType,themeId:r.ThemeId,grayscaleThemeShades:a?We.b.grayscaleThemeShadesDark:We.b.grayscaleThemeShades},userSelected:i[1]})}))}))}))},t.prototype.showDarkMode=function(){return this.capabilitiesService.capabilities.darkModeEnabled&&!!(this.userTheme&&this.userTheme.reactShellTheme&&this.userTheme.reactShellTheme.IsDarkMode)&&this.darkModeSupported()},t.prototype.showContrastMode=function(){return!1},t.prototype.getInitialUserTheme=function(){var e=this.themeConfig;if(this.capabilitiesService.capabilities.darkModeEnabled)if(this.capabilitiesService.capabilities.isPwaInUwp){var t=(new Windows.UI.ViewManagement.UISettings).getColorValue(Windows.UI.ViewManagement.UIColorType.background);if(255===t.a&&0===t.b&&0===t.g&&0===t.r)return this.getDefaultDarkTheme()}else if(e.isDarkMode||this.capabilitiesService.capabilities.darkModeOverride)return this.getDefaultDarkTheme();if(e.preferOfficeTheme){var n,r=this.defaultTheme;return{shades:n=this.getThemeShades(r),reactShellTheme:r,themeType:"App",themeId:this.userContext.user.themeId}}return{shades:n=(this.themeConfig&&this.themeConfig.userThemeShades||[]).map((function(e){return"#"+e})),reactShellTheme:Object(i.__assign)(Object(i.__assign)({},this.defaultTheme),this.getAppBrandTheme(n)),themeType:this.themeConfig.useTenantTheme?"Tenant":"User",themeId:this.userContext.user.themeId}},t.prototype.getStartingTheme=function(){var e=this.themeConfig.appPageTypeOnLoad;if(e){var t=Ye.a.fileTypeNameToFileType(e);if(this.supportedAppThemes.has(t)){var n=this.supportedAppThemes.get(t),r=this.showDarkMode()&&n.darkTheme||n.theme;if(r){var o=this.getThemeShades(r);return{theme:{shades:o,reactShellTheme:Object(i.__assign)(Object(i.__assign)({},this.defaultTheme),this.getAppBrandTheme(o)),themeType:"App",themeId:this.userConteed:!0}},t}(We.b),ha=function(e){function t(){var t=e.call(this)||this;return t.m365AppsPageRootPath="/m365apps/",t}return Object(i.__extends)(t,e),t.prototype.parse=function(t){var n=t.split("?"),i=n[0].toLowerCase();if(i.startsWith(this.m365AppsPageRootPath)){var r=n[0].split("/").filter((function(e){return!!e})).map((function(e,t){return t<2?e.toLocaleLowerCase():e}));n[0]="/"+r.join("arse.call(this,o)},t.prototype.serialize=function(t){return e.prototype.serialize.call(this,t).replace(/%20/g,"+")},t}(Vn.c),ma=n("tv+F"),ba="StickyPageSettingRedirect",ga="StickyPageSettingFetch",va=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.localStorageService=i,r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.capabilitiesService.capabilities.bottomTrayEnabled?[2,(t=this.getStickyTab())?this.checkEnabledAndRedirect("home"===t,t,e.queryParams):this.checkEnabledAndRedirect(!0)]:[3,1];case 1:return this.capabilitiesService.capabilities.stickyPagesEnabled?[4,this.getStickyPage()]:[3,3];case 2:return n=i.sent(),r=!n||""===n||"home"===n,null===n?Object(a.a)({featureName:"Other",eventName:ba,params:{Success:!1,ErrorType:"Other",ErrorMessage:"Sticky Page Timeout"}}):Object(a.a)({featureName:"Other",eventName:ba,params:{Success:!0,Executed:!r}}),[2,this.checkEnabledAndRedirect(r,n,e.queryParams)];case 3:return[2,this.checkEnabledAndRedirect(!0)]}}))}))},t.prototype.getStickyTab=function(){return this.router.navigated?void 0:this.localStorageService.get(ki.LastBottomTrayTab)},t.prototype.getStickyPage=function(){var e=this;return Promise.race([new Promise((function(t){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e,r,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(this.router.navigated)return[2,t(void 0)];i.label=1;case 1:return i.trys.push([1,7,,8]),[4,Promise.all([n.e(0),n.e(1),n.e(60),n.e(122)]).then(n.bind(null,"ujK1"))];case 2:return[4,(e=i.sent()).initializeFolders()];case 3:return i.sent(),e.getFoldersData()?[4,Promise.all([n.e(0),n.e(1),n.e(60),n.e(128)]).then(n.bind(null,"bSht"))]:[3,6];case 4:return[4,i.sent().getStickyPage()];case 5:if(r=i.sent(),Object(a.a)({featureName:"Other",eventName:ga,params:{Success:!0}}),null==r?void 0:r.urlPath)return[2,t(r.urlPath.slice(1))];i.label=6;case 6:return[3,8];case 7:return o=i.sent(),Object(a.a)({featureName:"Other",eventName:ga,params:{Success:!1,ErrorType:"Other",ErrorMessage:"string"==ty),[3,8];case 8:return[2,t(void 0)]}}))}))})),new Promise((function(e){setTimeout((function(){return e(null)}),6e3)}))])},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Vn.n),r.lc(Y.a),r.lc(et.a))},token:t,providedIn:"root"}),t}(ma.a),Sa=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.searchEnabled=t.capabilities.showSearch&&!!i.config,r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.searchEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.searchEnabled)},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Y.a),r.lc(Vn.n),r.lc(Xe.a))},token:t,providedIn:"root"}),t}(ma.a),ya=function(e){function t(t,n,i){var r=e.call(this,i,n)||this;return r.appGalleryConfigService=t,r.appGalleryEnabled=!!r.appGalleryConfigService.config,r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.appGalleryEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.appGalleryEnabled)},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Vt.a),r.lc(Y.a),r.lc(Vn.n))},token:t,providedIn:"root"}),t}(ma.a),Ca=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.unsupportedBrowsers=new Map,r.setupUnsupportedBrowsers(),r.minimumBrowserVersions=new Map,r.setupMinimumBrowserVersions(),r.fluidSupportEnabled=t.capabilities.fluidSupportEnabled,r.isSupportedBrowser=r.supportedBrowserCheck(i.getDeviceInfo()),r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.isSupportedBrowser?this.checkEnabledAndRedirect(this.fluidSupportEnabled):this.checkEnabledAndRedirect(!1,"launch/fluid/unsupported",void 0,!0)},t.prototype.canLoad=function(){return this.isSupportedBrowser?this.checkEnabledAndRedirect(this.fluidSupportEnabled):this.checkEnabledAndRedirect(!1,"launch/fluid/unsupported",void 0,!0)},t.prototype.supportedBrowserCheck=function(e){var t=this.unsupportedBrowsers.get(e.browser.browserType),n=this.minimumBrowserVersions.get(e.browser.browserType);return!(null==t?void 0:t.includes(e.platform.platformType))&&-1!==e.browserVersion.compareTo(n)},t.prototype.setupUnsupportedBrowsers=function(){this.unsupportedBrowsers.set(Te.a.Edge,[Te.e.Chromebook]),this.unsupportedBrowsers.set(Te.a.EdgeLegacy,[Te.e.PC,Te.e.Mac,Te.e.Chromebook,Te.e.iPhone,Te.e.iPad,Te.e.AndroidPhone,Te.e.AndroidTablet,Te.e.Linux]),this.unsupportedBrowsers.set(Te.a.Firefox,[Te.e.Chromebook]),this.unsupportedBrowsers.set(Te.a.Safari,[Te.e.PC,Te.e.Chromebook,Te.e.AndroidTablet,Te.e.AndroidPhone,Te.e.Linux]),this.unsupportedBrowsers.set(Te.a.IE,[Te.e.PC,Te.e.Mac,Te.e.Chromebook,Te.e.iPhone,Te.e.iPad,Te.e.AndroidPhone,Te.e.AndroidTablet,Te.e.Linux]),this.unsupportedBrowsers.set(Te.a.Opera,[Te.e.Chromebook]),this.unsupportedBrowsers.set(Te.a.WebView,[Te.e.PC,Te.e.Mac,Te.e.Chromebook,Te.e.iPhone,Te.e.iPad,Te.e.AndroidPhone,Te.e.AndroidTablet,Te.e.Linux])},t.prototype.setupMinimumBrowserVersions=function(){this.minimumBrowserVersions.set(Te.a.Edge,new Te.b(80,0,0)),this.minimumBrowserVersions.set(Te.a.Chrome,new Te.b(80,0,0)),this.minimumBrowserVersions.set(Te.a.Safari,new Te.b(13,4,0)),this.minimumBrowserVersions.set(Te.a.Firefox,new Te.b(78,0,0))},t.ɵprov=r.kc({factory:fun"}),t}(ma.a),wa=n("EUVs"),Ta=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.wacContentService=i,r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.wacContentService.bootstrapDocumentFromLoader(this.wacContentService.getDocumentInfoFromParams(e.queryParams,Ye.a.fileTypeNameToFileType(e.params.app)),Date.now(),!0)];case 1:}}))}))},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.capabilitiesService.wacHostEnabled())},t.ɵprov=r.k=e.call(this,i,t)||this;return l.shellService=n,l.urlLauncherService=r,l.workloadService=o,l.instrumentationService=a,l}return Object(i.__extoningCheckHelper(e.data.fileType)},t.prototype.canLoad=function(e){return this.provisioningCheckHelper(e.data.fileType)},t.prototype.provisioningCheckHelper=function(e){var t=this,n=this.router.navigated?"_blank":"_self";return!!this.checkEnabledAndRedirect(this.capabilitiesService.capabilities.startPageApps.has(e))&&new Promise((function(i){t.shellService.checkInAppNavEnabled(e).then((function(r){r?t.shellService.getOdspProvisioningStatus(0,1e3).then((function(r){var o=e===Ye.b.OneDrive?r.OneDriveUrl:r.SharepointUrl;o?(i(!1),t.instrumentationService.logGenericEvent("ODSP_Insta_Provisioned_Redirect"),Object(a.a)({featureName"ODSP_Insta_Provisioned_Redirect"}),t.urlLauncherService.openUrl(o,"ODSP_Redirect",n)):i(!0)})).catch((function(){i(!0)})):t.workloadService.getWorkloads().then((function(r){var o=r.find((function(t){return t.FileType===e}));o?t)}))}))},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Y.a),r.lc(Pt.a),r.lc(Vn.n),r.lc(rt.a),r.lc(Et.a),r.lc(F.a))},token:t,providedIn:"root"}),t}(ma.a),Ia=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.createCenterEnabled=i.capabilitiesService.capabilities.createCenterEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.createCenterEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.createCenterEnabled)},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Y.a),r.lc(Vn.n))},token:t,providedIn:"root"}),t}(ma.a),_a=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.myContentPageEnabled=i.capabilitiesService.capabilities.myContentEnabled,i.draftEnabled=i.capabilitiesService.capabilities.draftEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.myContentPageEnabled&&this.draftEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.myContentPageEnabled&&this.draftEnabled)},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Y.a),r.lc(Vn.n))},token:t,providedIn:"root"}),t}(ma.a),Aa=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.feedEnabled=i.capabilitiesService.capabilities.feedEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.feedEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.feedEnabled)},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Y.a),r.lc(Vn.n))},token:t,providedIn:"root"}),t}(ma.a),Pa=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.m365AppsNavigationEnabled=i.capabilitiesService.capabilities.leftNavReact&&i.capabilitiesService.capabilities.m365AppsEnabled,i.mosAppAtRootEnabled=i.capabilitiesService.capabilities.mosAppHostedAtRootEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){return this.isMosAppAtRoot(e.url)?this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled&&this.mosAppAtRootEnabled):this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled)},t.prototype.isMosAppAtRoot=function(e){return e.length&&"m365apps"!==e[0].path},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Y.a),r.lc(Vn.n))},token:t,providedIn:"root"}),t}(ma.a),Ea=n("OWzB"),Oa=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o.createDocumentService=i,o.instrumentationService=r,o.modernStartEnabled=n.capabilities.modernStartPageEnabled,o}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){var t=e.queryParams["ms.url"];return t?this.checkAndNavigateToCreateNew(t,e.queryParams.templateId):this.checkEnabledAndRedirect(this.modernStartEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.modernStartEnabled)},t.prototype.checkAndNavigateToCreateNew=function(e,n){var i=this;return e=e.toLowerCase(),new Promise((function(r){var o=t.CREATE_NEW_REDIRECTS[e];if(o){var a=void 0;0===e.lastIndexOf("templates.")&&n&&(a={AssetId:n}),i.createDocumentService.createItem(o,null,a,(function(t){var n,o=((n={}).MsNewParam=e,n.Action=t&&t.type||"",n);t&&"Error"!==t.type&&"CreatePending"!==t.type?(i.instrumentationService.logGenericEvent("Create_New_Redirect_Success",o),r(!1)):(i.instrumentationService.logGenericEvent("Create_New_Redirect_Fail",o),r(!0))}),null,null,"_self")}}))},t.CREATE_NEW_REDIRECTS={"word.new":Ye.b.Word,"templates.word.new":Ye.b.Word,"powerpoint.new":Ye.b.PowerPoint,"templates.powerpoint.new":Ye.b.PowerPoint,"excel.new":Ye.b.Excel,"templates.excel.new":Ye.b.Excel,"sway.new":Ye.b.Sway,"templates.visio.new":Ye.b.Visio},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Vn.n),r.lc(Y.a),r.lc(Ea.a),r.lc(F.a))},token:t,providedIn:"root"}),t}(ma.a),Fa=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.myContentPageEnabled=i.capabilitiesService.capabilities.myContentEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.myContentPageEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.myContentPageEnabled)},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Y.a),r.lc(Vn.n))},token:t,providedIn:"root"}),t}(ma.a),Da=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.templatesEnabled=t.capabilities.templatesEnabled&&t.capabilities.wacStartPageEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.templatesEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.templatesEnabled)},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Y.a),r.lc(Vn.n))},token:t,providedIn:"root"}),t}(ma.a),Ma=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o.createDocumentService=i,o.instrumentationService=r,o.startEnabled=n.capabilities.wacStartPageEnabled,o}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){var t=e.queryParams["ms.url"];return t?teckEnabledAndRedirect(this.startEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.startEnabled)},t.prototype.checkAndNavigateToCreateNew=function(e,n){var i=this;return e=e.toLowerCase(),new Promise((function(r){var o=t.CREATE_NEW_REDIRECTS[e];if(o){var a=void 0;0===e.lastIndexOf("templates.")&&n&&(a={AssetId:n}),i.createDocumentService.createItem(o,null,a,(function(t){var n,o=((n={}).MsNewParam=e,n.Action=t&&t.type||"",n);t&&"Error"!==t.type&&"CreatePending"!==t.type?(i.instrumentationService.logGenericEvent("Create_New_Redirect_Success",o),r(!1)):(i.instrumentationService.logGenericEvent("Create_New_Redirect_Fail",o),r(!0))}),null,null,"_self")}}))},t.CREATE_NEW_REDIRECTS={"word.new":Ye.b.Word,"templates.word.new":Ye.b.Word,"powerpoint.new":Ye.b.PowerPoint,"templates.powerpoint.new":Ye.b.PowerPoint,"excel.new":Ye.b.Excel,"templates.excel.new":Ye.b.Excel,"sway.new":Ye.b.Sway,"templates.visio.new":Ye.b.Visio},t.ɵprov=r.kc({factory:function(){return new t(r.lc(Vn.n),r.lc(Y.a),r.lc(Ea.a),r.lc(F.a))},token:t,providedIn:"root"}),t}(ma.a),Ra=n("caHY");function xa(e){var t=e.length;if(t>=1&&Ra.b.includes(e[0].path)){var n=Ra.a[e[0].path];if(n){var i={appId:new Vn.s(n,{})};return t>=2&&(i.entityId=new Vn.s(e[1].path,{})),t>=3&&(i.subEntityId=new Vn.s(e[2].path,{})),{consumed:e,posParams:i}}}return null}var La={fileType:Ye.b.SharePoint},Ua={fileType:Ye.b.OneDrive},Na=function(){return function(){}}(),Wa=function(){function e(){}return e.prototype.shouldReuseRoute=function(e,t){return e.routeConfig===t.routeConfig&&e.paramMap.get("app")===t.paramMap.get("app")&&e.paramMap.get("spaceId")===t.paramMap.get("spaceId")&&e.paramMap.get("appId")===t.paramMap.get("appId")&&e.paramMap.get("entityId")===t.paramMap.get("entityId")("subEntityId")===t.paramMap.get("subEntityId")},e.prototype.shouldD1},e.prototype.store=function(e,t){},e.prototype.shouldAttach=function(e){return!1},e.prototype.retrieve=function(e){return null},e}(),ja=n("xIlw"),Ha=n("+a0u"),Ba=n("lQwO"),Ga=n("sCgQ"),qa=n("izKO"),Va=n("D6F8"),za=n("+5ti"),Ka=n("+P5Z"),Za=n("CfLe"),Qa=n("ej7j"),Xa=n("VY7U"),Ja=n("GPFm"),Ya=new r.u("INSTRUMENTATION_QUEUE"),$a=n("AXqk"),el=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"securityLevel",{get:function(){return 3},enumerable:!0,configurable:!0}),t}($a.a),tl=function(){return function(){}}(),nl=n("EuUe"),il=function(){return function(){}}(),rl=n("+I3G"),ol=n("Bmgn"),al=n("32VK"),ll=n("L9A/"),sl=n("T6pR"),cl=n("T/SX"),ul=n("up2P"),dl=n("D8EG"),pl=n("9InZ"),fl=n("upmJ"),hl=n("ci1G"),ml=n("M3TP"),bl=n("XQbr"),gl=function(){return function(){}}(),vl=n("vW6f"),Sl=r.Eb(Fe,[mt],(function(e){return r.Tb([r.Ub(512,r.k,r.hb,[[8,[bt.a,On,Cr]],[3,r.k],r.D]),r.Ub(5120,Vn.a,Vn.A,[Vn.n]),r.Ub(4608,Vn.f,Vn.f,[]),r.Ub(6144,Vn.i,null,[Vn.f]),r.Ub(135680,Vn.q,Vn.q,[Vn.n,r.C,r.i,r.v,Vn.i]),r.Ub(4608,Vn.h,Vn.h,[]),r.Ub(5120,Vn.F,Vn.w,[Vn.n,gt.s,Vn.j]),r.Ub(5120,Vn.k,Vn.D,[Vn.B]),r.Ub(5120,Ft.a,Ar,[Tr,r.p]),r.Ub(5120,r.b,(function(e,t,n,i){return[e,Pr(t,n,i),Ae()]}),[Vn.k,r.v,Ft.a,h.b]),r.Ub(5120,r.z,r.ub,[[3,r.z]]),r.Ub(4608,gt.m,gt.l,[r.z]),r.Ub(4608,Z.b,Nr,[Q.a,He.a,Y.a,Or.a,X.a,Ft.a,u.b,F.a,Ur,f.b,lt.a,qe.a,Rr.a,Be.a,h.b]),r.Ub(4608,Wr.a,tt.a,[Z.b,He.a,F.a,Or.a,Q.a,p.a,jr.a,Ft.a,u.b,it.a]),r.Ub(5120,Hr.a,qr,[Y.a,Br.a,Gr.a]),r.Ub(5120,r.xb,r.vb,[r.F]),r.Ub(5120,r.c,r.rb,[]),r.Ub(5120,r,[Di.b]),r.Ub(4608,Di.e,Di.g,[]),r.Ub(5120,Di.c,(function(e,t,n,i,r,o,a,l){return[new Di.j(e,t,n),new Di.o(i),new Di.n(r,o,a,l)]}),[gt.d,r.F,r.I,gt.d,gt.d,Di.e,r.ib,[2,Di.f]]),r.Ub(4608,Di.d,Di.d,[Di.c,r.F]),r.Ub(135680,Di.m,Di.m,[gt.d]),r.Ub(4608,Di.k,Di.k,[Di.d,Di.m,r.c]),r.Ub(5120,we.a,_e,[h.b]),r.Ub(5120,we.c,Zr.e,[]),r.Ub(4608,we.b,Zr.d,[gt.d,we.a,we.c]),r.Ub(5120,r.L,Zr.f,[Di.k,we.b,r.F]),r.Ub(6144,Di.p,null,[Di.m]),r.Ub(4608,r.T,r.T,[r.F]),r.Ub(4608,Qr.b,Zr.c,[r.L,gt.d]),r.Ub(5120,Xr,$r,[He.a,gn.a,io.a,Y.a]),r.Ub(4608,ie.n,ie.t,[gt.d,r.I,ie.r]),r.Ub(4608,ie.u,ie.u,[ie.n,ie.s]),r.Ub(5120,y.a,lo,[f.b,r.I,uo.a]),r.Ub(5120,S,po,[g.a,y.a]),r.Ub(5120,ho,so,[h.b,vo]),r.Ub(4608,So,Co,[yo.a]),r.Ub(5120,ie.a,(function(e,t,n,i,r,o,a,l,s,c,u,d){return[e,new wo(t),new pe(n,i,r,o),new _o(a,l,s,c,u),new Do(d)]}),[ie.u,S,S,ho,v.a,u.b,yo.a,Io,ho,S,[2,So],Fo]),r.Ub(4608,ie.q,ie.q,[]),r.Ub(6144,ie.o,null,[ie.q]),r.Ub(4608,ie.m,ie.m,[ie.o]),r.Ub(6144,ie.b,null,[ie.m]),r.Ub(4608,ie.h,ie.p,[ie.b,r.v]),r.Ub(4608,ie.c,ie.c,[ie.h]),r.Ub(4608,Ue.a,Mo,[]),r.Ub(4608,Ro.a,xo,[]),r.Ub(4608,Lo.a,Uo,[]),r.Ub(4608,No,Wo,[]),r.Ub(4608,jo,Ho,[]),r.Ub(6144,rt.a,null,[Bo]),r.Ub(4608,Et.a,Vo,[Dt,Y.a,Ft.a,He.a,Bn.a,u.b,h.b,it.a,Ne.a]),r.Ub(4608,zo.a,$o,[Y.a,h.b,He.a,d.a,F.a,D.b,Qo.a,Gr.a,at.a,f.b,Yo]),r.Ub(5120,b,(function(e,t,n,i,r,o,a,l,s,c,u,d,p){return[new ea(e,t,n,i,r,o,a),new ta(l),new ia(s,c,u,d,p)]}),[u.b,He.a,S,ho,f.b,p.a,h.b,S,r.p,He.a,F.a,S,na]),r.Ub(4608,ra.a,ra.a,[Be.a]),r.Ub(4608,oa.a,oa.a,[Bn.a,Be.a,aa.a]),r.Ub(4608,la.a,la.a,[gt.d,r.I]),r.Ub(5120,sa.a,Ee,[]),r.Ub(5120,ca.a,Oe,[h.b,Te.c,r.F]),r.Ub(4608,ua.a,pa,[He.a,F.a,J.a]),r.Ub(4608,We.b,fa,[d.a,X.a,Y.a,Ft.a,h.b,He.a,F.a,qe.a,J.a,it.a,Be.a,f.b,r.F,Ne.a,at.a]),r.Ub(1024,Vn.u,Vn.y,[[3,Vn.n]]),r.Ub(512,Vn.t,ha,[]),r.Ub(512,Vn.b,Vn.b,[]),r.Ub(256,gt.a,"/",[]),r.Ub(256,Vn.j,{enableTracing:!1,initialNavigation:!1,useHash:!1},[]),r.Ub(1024,gt.h,Vn.x,[gt.q,[2,gt.a],Vn.j]),r.Ub(512,gt.g,gt.g,[gt.h,gt.q]),r.Ub(512,r.i,r.i,[]),r.Ub(512,r.C,r.Q,[r.i,[2,r.R]]),r.Ub(1024,Vn.l,(function(){return[[{path:"",component:Tn,canActivate:[va]},{path:"home",redirectTo:""},{path:"search",loadChildren:"./search-results/search-results.module#SearchResultsModule",canActivate:[Sa],canLoad:[Sa]},{outlet:"install-wizard",path:"",children:[{path:"open",loadChildren:"./install/install-wizard/install-wizard.module#InstallWizardModule"}]},{path:"apps",loadChildren:"./app-gallery-wrapper/app-gallery-wrapper.module#AppGalleryWrapperModule",canActivate:[ya],canLoad:[ya]},{path:"launch/fluid/content",children:[],canActivate:[Ca],canLoad:[Ca]},{path:"launch/fluid/unsupported",loadChildren:"./fluid-unsupported-page/fluid-unsupported-page.module#FluidUnsupportedPageModule"},{path:"launch/:app/content",loadChildren:"./wac-content/wac-content.module#WacContentModule",canActivate:[Ta],canLoad:[Ta]},{path:"launch/sharepoint",loadChildren:"./odsp-start/sharepoint-start/sharepoint-start.module#SharePointStartModule",canActivate:[ka],canLoad:[ka],data:La},{path:"launch/onedrive",loadChildren:"./odsp-start/onedrive-start/onedrive-start.module#OnedriveStartModule",canActivate:[ka],canLoad:[ka],data:Ua},{path:"launch/:app",loadChildren:"./start-page-wrapper/start-page-wrapper.module#StartPageWrapperModule",canActivate:[Ma],canLoad:[Ma]},{path:"modernlaunch/:app",loadChildren:"./modern-start/modern-start.module#ModernStartModule",canActivate:[Oa],canLoad:[Oa]},{path:"template/:app",loadChildren:"./templates-page-wrapper/templates-page-wrapper.module#TemplatesPageWrapperModule",canActivate:[Da],canLoad:[Da]},{path:"m365apps",loadChildren:"./m365-apps/m365-apps.module#M365AppsModule",canActivate:[Pa],canLoad:[Pa]},{path:"feed",loadChildren:"./feed/feed.module#FeedModule",canActivate:[Aa],canLoad:[Aa]},{path:"create",loadChildren:"./create-center/create-center-wrapper/create-center-wrapper.module#CreateCenterWrapperModule",canActivate:[Ia],canLoad:[Ia]},{path:"mycontent/drafts/content",loadChildren:"./draft-content/draft-content.module#DraftContentModule",canActivate:[_a],canLoad:[_a]},{path:"mycontent",loadChildren:"./my-content/my-content.module#MyContentModule",canActivate:[Fa],canLoad:[Fa]},{matcher:xa,loadChildren:"./m365-apps/m365-apps.module#M365AppsModule",canActivate:[Pa],canLoad:[Pa]}]]}),[]),r.Ub(512,Vn.m,Wa,[]),r.Ub(1024,Vn.n,Vn.z,[Vn.t,Vn.b,gt.g,r.v,r.C,r.i,Vn.l,Vn.j,[2,Vn.r],[2,Vn.m]]),r.Ub(1073742336,Vn.o,Vn.o,[[2,Vn.u],[2,Vn.n]]),r.Ub(1073742336,Na,Na,[]),r.Ub(1073742336,gt.c,gt.c,[]),r.Ub(1073742336,ja.a,ja.a,[]),r.Ub(1073742336,Ha.a,Ha.a,[]),r.Ub(1073742336,Ba.a,Ba.a,[]),r.Ub(1073742336,Ga.a,Ga.a,[]),r.Ub(1073742336,qa.a,qa.a,[]),r.Ub(1073742336,Va.a,Va.a,[]),r.Ub(1073742336,Bt.a,Bt.a,[]),r.Ub(1073742336,za.b,za.b,[]),r.Ub(1073742336,Ht.g,Ht.g,[]),r.Ub(1073742336,Ka.a,Ka.a,[]),r.Ub(1073742336,Za.a,Za.a,[]),r.Ub(1073742336,Qa.a,Qa.a,[]),r.Ub(1073742336,Xa.a,Xa.a,[]),r.Ub(1073742336,Ja.a,Ja.a,[]),r.Ub(1073742336,Kr,Kr,[]),r.Ub(1024,Ya,Pe,[b(512,F.a,V.a,[[2,Ya],$a.a,Te.c]),r.Ub(512,r.p,u.b,[F.a,f.b]),r.Ub(512,Vn.B,Vn.B,[r.v]),r.Ub(1024,r.E,(function(){return[Vn.v()]}),[]),r.Ub(1024,Tr,Ir,[f.b]),r.Ub(1024,r.d,(function(e,t,n){return[Vn.C(e),Di.q(t),_r(n)]}),[Vn.B,[2,r.E],Tr]),r.Ub(512,r.e,r.e,[[2,r.d]]),r.Ub(131584,r.g,r.g,[r.F,r.ib,r.v,r.p,r.k,r.e]),r.Ub(1073742336,r.f,r.f,[r.g]),r.Ub(1073742336,Di.a,Di.a,[[3,Di.a]]),r.Ub(1073742336,Zr.b,Zr.b,[]),r.Ub(1073742336,tl,tl,[]),r.Ub(1073742336,no,no,[]),r.Ub(1073742336,nl.a,nl.a,[]),r.Ub(1073742336,il,il,[]),r.Ub(1073742336,rl.b,rl.b,[]),r.Ub(1073742336,ol.a,ol.a,[]),r.Ub(1073742336,al.a,al.a,[]),r.Ub(1073742336,ll.a,ll.a,[]),r.Ub(1073742336,sl.a,sl.a,[]),r.Ub(1073742336,cl.a,cl.a,[]),r.Ub(1073742336,ul.a,ul.a,[]),r.Ub(1073742336,dl.a,dl.a,[]),r.Ub(1073742336,pl.a,pl.a,[]),r.Ub(1073742336,fl.a,fl.a,[]),r.Ub(1073742336,hl.a,hl.a,[]),r.Ub(1073742336,ml.a,ml.a,[]),r.Ub(1073742336,bl.a,bl.a,[]),r.Ub(1073742336,ie.e,ie.e,[]),r.Ub(1073742336,ie.d,ie.d,[]),r.Ub(1073742336,gl,gl,[]),r.Ub(1073742336,fo,fo,[]),r.Ub(1073742336,co,co,[]),r.Ub(1073742336,Er,Er,[]),r.Ub(1073742336,Fe,Fe,[]),r.Ub(256,r.m,r.wb,[]),r.Ub(256,r.kb,"root",[]),r.Ub(256,Zr.a,"BrowserAnimations",[]),r.Ub(256,Oo,Yr,[]),r.Ub(256,Eo,eo,[]),r.Ub(256,Po,to,[]),r.Ub(256,ie.r,"XSRF-TOKEN",[]),r.Ub(256,ie.s,"X-XSRF-TOKEN",[]),r.Ub(256,vl.a,50,[]),r.Ub(256,C.a,"officehome",[])])}));try{window.ohpAppBundleParsingSuccessFlag=!0,window.isBootstrap=!1;var yl=function(){return Di.i().bootstrapModuleFactory(Sl,{preserveWhitespaces:!1})};Object(c.a)()?function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o,a,l,s,c,u,d,p,f,h;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,20,,22]),function(e,t){void 0===t&&(t=[]),new URLSearchParams(window.location.search).forEach((function(n,i){t.includes(i)||e.searchParams.set(i,n)}))}(e=new URL(window.location.origin+"/api/identity")),[4,fetch(e.toString())];case 1:return(t=i.sent()).ok?[3,3]:[4,Se()];case 2:return i.sent(),[2];case 3:return[4,t.json()];case 4:return n=i.sent(),r=n.puid,o=n.encryptionConfig,[4,he(window.crypto.subtle,n.tenantId+"_"+r,o.digestSaltBase64,(function(e){return Object(me.b)(e,window)}))];case 5:return[4,Ce(a=i.sent(),"cache-only",r)];case 6:if(!(l=i.sent()))return[3,14];i.label=7;case 7:return i.trys.push([7,13,,14]),[4,l.arrayBuffer()];case 8:return s=i.sent(),(c=be(new Uintdow.crypto.subtle)]:[3,12];case 9:return u=i.sent(),[4,Object(ge.a)(c,u,window.crypto,(function(e){return Object(me.a)(e,window)}))];case 10:return d=i.sent(),[4,new Response(d.body,{headers:new Headers(JSON.parse(d.headers)),status:d.status,statusText:d.statusText}).json()];case 11:h=i.sent(),window.shellAndConfigResponse=Promise.resolve(h),i.label=12;case 12:return[3,14];case 13:return i.sent(),l=null,[3,14];case 14:return p=Ce(a,"network-first",r),l?[3,19]:[4,p];case 15:return(f=i.sent())?[3,17]:[4,Se()];case 16:return i.sent(),[3,19];case 17:return[4,f.json()];case 18:h=i.sent(),window.shellAndConfigResponse=Promise.resolve(h),i.label=19;case 19:return document.getElementById("splash-screen").remove(),[3,22];case 20:return i.sent(),[4,Se()];case 21:return i.sent(),[3,22];case 22:return[2]}}))}))}().then(yl).then(ne).catch(Se):(function(){(N=Object(h.c)()).angularDebugInfoEnabled||Object(r.bb)(),L=eturn o})),n.d(t,"d",(function(){return a}));var i="harmony-inapp-feedback-element-id",r=2131,o="Harmony",a="ocv-inapp-feedback"},hUdb:function(e,t,n){"use strict";var i,r;n.d(t,"b",(function(){return i})r})),function(e){e.Contrast="contrast",e.Dark="dark",e.Light="light",e.System="system"}(i||(i={})),function(e){e.Office="Office"}(r||(r={}))},hZW2:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("keVe"),r=n("dFxn"),o=function(){function e(e){this.configParserService=e}return e.prototype.getConfig=function(){return this.config||(this.config=this.configParserService.parse("documentConfig")),this.config||{mockUploadFile:null}},e.ɵprov=i.kc({factory:function(){return new e(i.lc(r.a))},token:e,providedIn:"root"}),e}(),a=function(){function e(e){this.documentConfigService=e}return e.prototype.addScriptToPage=function(e,t,n,i,r,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var a=this.getDocument();if(a)if(this.findScript(r))t&&t();else{var l=a.createElement("script");if(l.src=e,l.id=r,t&&(l.onload=t),n&&(l.onerror=n),i){var s=a.getElementsByTagName("script")[0];if(s&&s.parentNode)return void s.parentNode.insertBefore(l,s)}o&&(l.crossOrigin="anonymous"),a.body.appendChild(l)}},e.prototype.addIframeToPage=function(e,t){if(e||t){var n=this.getDocument();if(!(!n||t&&n.getElementById(t)||n.querySelector('iframe[src="'+e+'"]'))){var i=n.createElement("iframe");e&&i.setAttribute("src",e),t&&(i.id=t),i.style.display="none",n.body.appendChild(i)}}},e.prototype.selectFile=function(t){var n=this;this.selectFilePromiseRejector&&this.selectFilePromiseRejector();var i=this.getDocument();this.fileInputElement&&i.body.removeChild(this.fileInputElement);var r=this.documentConfigService.getConfig().mockUploadFile;if(r){var o=this.createMockFileList(r.name,r.size);return Promise.resolve(o)}return this.fileInputElement=i.createElement("input"),this.fileInputElement.type="file",this.fileInputElement.id=e.fileInputId,this.fileInputElement.accept=t.join(","),i.body.appendChild(this.fileInputElement),new Promise((function(e,t){n.selectFilePromiseRejector=t;var r=function(o){var a=o.target.files;a&&a.length?e(a):t(),n.selectFilePromiseRejector=null,n.fileInputElement&&(n.fileInputElement.removeEventListener("change",r),i.body.removeChild(n.fileInputElement),ck()}))},e.prototype.updateFavicon=function(e){this.addOrUpdateLink(e,"shortcut icon","image/x-icon",'link[rel="shortcut icon"]')},e.prototype.addOrUpdateStylesheet=function(e,t){this.addOrUpdateLink(e,"stylesheetsClassToElement=function(e,t){e&&e.classList.add(t)},e.prototype.removeCssClassFromElement=function(e,t){e&&e.classList.remove(t)},e.prototype.addOrUpdateStyleTag=function(e,t){var n=this.getDocument();if(n){var i=n.getElementById(e);i&&i.parentNode&&i.parentNode.removeChild(i),(i=n.createElement("style")).id=e,i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(n.createTextNode(t)),n.head.appendChild(i)}},e.prototype.addLinkTag=function(e){var t=this.getDocument();if(t){var n=t.crAttribute(t,e)})),t.head.appendChild(n)}},e.prototype.appendHTMLToElement=function(e,t){e&&t&&e.insertAdjacentHTML("beforeend",t)},e.prototype.getOffset=function(e){var t=(e instanceof i.o?e.nativeElement:e).getBoundingClientRect();return{top:t.top+this.nativeDocument.body.scrollTop,left:t.left+this.nativeDocument.body.scrollLeft}},e.prototype.disableTult,{passive:!1})},e.prototype.enableTouchMove=function(){this.getDocument().removeEventListener("touchmove",this.preventDefault)},e.prototype.updateThemeColor=function(e){var t=this.getDocument();if(t){var n=t.querySelector('meta[name="theme-color"]');if(n)n.content!==e&&(n.content=e);else{var i=t.createElement("meta");i.name="theme-color",i.content=e,t.head.apault=function(e){e.preventDefault()},Object.defineProperty(e.prototype,"nativeDocument",{get:function(){return this.getDocument()},enumerable:!0,configurable:!0}),e.prototype.getDocument=function(){return document},e.prototype.findScript=function(e){if(!e)return!1;var t=this.getDocument();return!!t&&!!t.getElementById(e)},e.prototype.addOrUpdateLink=function(e,t,n,i,r){if(e){var o=this.getDocument();if(o){var a=o.querySelector(i);a?a.href!==e&&(a.href=e):((a=o.createElement("link")).rel=t,a.type=n,a.href=e,r&&(a.id=r),o.head.appendChild(a))}}},e.prototype.createMockFileList=Uint8Array(t)],{type:""});return n.name=e,[n]},e.fileInputId="select-file",e.ɵprov=i.kc({factory:function(){return new e(i.lc(o))},token:e,providedIn:"root"}),e}()},hhzZ:function(e,t,n){"use strict";n.d(t,"c",(function(){eturn e.FirsttimeReferral="First time",e.ResurrectedReferral="Resurrected",e.RepeatReferral="Repeat",e.NotDetected="NotDetected",e}(),o=function(){function e(){}return e.AllMyDocuments="AllMyDocuments",e.AppCategory="AppCategory",e.AppGalleryHero="AppGalleryHero",e.AppList="AppList",e.AppTiles="AppTiles",e.BackstageMru="BackstageMru",e.Banner="Banner",e.Calendar="Calendar",e.CreateCenter="CreateCenter",e.CreateFlyOut="CreateFlyOut",e.CreateGallery="CreateGallery",e.CreateModal="CreateModal",e.CreateOnHome="CreateOnHome",e.Documents="Documents",e.DocumentTitleComponent="DocumentTitleComponent",e.Edgeworth="Edgeworth",e.EnterpriseTemplates="EnterpriseTemplates",e.ErrorDialog="ErrorDialog",e.FeaturedDocs="FeaturedDocs",e.Feedback="Feedback",e.FirstRun="FirstRun",e.FluidContent="FluidContent",e.Folders="Folders",e.FormsGroups="FormsGroups",e.Hero="Hero",e.InputDialog="InputDialog",e.InstallWizard="InstallWizard",e.LeftNav="LeftNav",e.LeftNavCallout="LeftNavCallout",e.MobileAppBanner="MobileAppBanner",e.NewConsumerExperience="NewConsumerExperience",e.PeopleCard="PeopleCard",e.PwaDialog="PwaDialog",e.Recommended="Recommended",e.SearchResults="SearchResults",e.SearchSuggestions="SearchSuggestions",e.Shell="Shell",e.SideMenu="SideMenu",e.Sites="Sites",e.SuggestedActions="SuggestedActions",e.Templates="Templates",e.UploadDialog="UploadDialog",e.Upsell="Upsell",e}(),a=function(){return function(e,t){void 0===t&&(t=i.AWTPiiKind.GenericData),this.value=e,this.kind=t}}(),l=function(){function e(){}return e.filterPii=function(e){return e?(e.replace(/\n/g,"").replace(/\r/g,"").replace(/\t/g,"").replace(/\b/g,""),e.replace(this.emailRegex,"email_removed").replace(this.localFileRegex,"file_removed").replace(this.searchQueryRegex,"$1query_removed")):e},e.emailRegex=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),e.localFileRegex=new RegExp("file(:|%3A|%253A).*","gim"),e.searchQueryRegex=new RegExp("([&?]q=)(.+?)(?=[&].*| |, |$)","gmi"),e}()},hoyd:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},iPRk:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g}));var i,r=n("8/lW"),o=n("AGMK"),a=n("z0B0"),l=n("Ihso"),s=n("cenr"),c=n("a3FV"),u=n("CMIS"),d=n("1rn/"),p=n("pM41"),f=n("VV8N"),h=new Set,m=!1;function b(e,t,n,i){if(void 0===t&&(t=2),void 0===n&&(n=r.a.Security),function(){var e=window.performance;return!!(e&&e.timing&&e.timing.navigationStart&&e.getEntriesByType)}()){var o=e,a=Object(f.b)();a&&(o="".concat(e,"_").concat(a));var l=o,h=f.d.get(l);if(h){var m=h+1;f.d.set(l,m),l="".concat(o,".").concat(m)}else f.d.set(l,1);window.performance.mark(l);var b=Object(f.c)()||"navigationStart";"App_Navigation_Start"===e&&Object(f.g)(l);var g="navigationStart";return 2===t?g=b:0===t?g="":"string"==typeof t&&(g=t),function(e,t,n,i,o,a){if(n&&!f.e.has(e)){f.e.add(e);try{window.performance.measure(e,n,t)}catch(i){return void function(e,t){var n,i=((n={}).Error=e,n.DebugInfo=t,n);Object(s.a)(c.a.PerformanceMarkFailure,i),Object(u.a)({eventName:"Performance_Mark_Failure",errorType:"Other",message:e,debugInfo:t})}(e,"Failed to record <".concat(e,"> for <").concat(t,"> starting from <").concat(n,">: exception is thrown"))}!function(e,t,n,i){var o=window.performance.getEntriesByName(e,"measure");o&&0!==o.length&&function(e,t,n,i){void 0===i&&(i=r.a.Security),Object(d.a)(e,t,n,i),Object(p.a)({eventName:e,latency:t,instrumentationParams:n},i)}(t,Math.ceil(o[0].duration),i,n)}(e,o||e,i,a)}}(o,l,g,n,e,i),l}}function g(e){m||(function(){Object(a.a)((function(e){"hidden"===e&&function(),m=!0),h.add(e),i||(i=Object(l.b)((function(){Object(o.a)()&&h.forEach((function(e){b(e)})),v()})))}function v(){h.clear(),i=null}},"iX+N":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("wacStartPageConfig")||{featuredDocumentsEnabled:!1,maxInitialDocuments:0,maxTotalDocuments:0,startPageNumTemplatesToShow:0,visioMoreTemplatesUrl:null,moreTemplatesRedirectionEnabled:!1,streamCrossLinkUrl:null,streamDocumentationUrl:null,resources:null,streamPreviewString:"StreamCrossLinkText",visioLibraryTileEnabled:!1,visioMoreTemplatesEnabled:!1,consumerExcelStartPageTemplateCollection:"",consumerWordStartPageTemplateCollection:"",consumerPowerPointStartPageTemplateCollection:""}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},idgT:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("QjXU"),r=n("zvoD"),o=n("3Vsh"),a=n("BaAg"),l=n("dFxn"),s=n("hZW2"),c=n("7Gwk"),u=n("/I02"),d=n("uWZl"),p=n("ZBli"),f=n("keVe"),h=function(){function e(t,n,i,r){var o=this;this.configParserService=t,this.contextService=n,this.documentService=i,this.eventService=r;var l=this.configParserService.parse(e.configElementId);this.config=l||{createLcidEnabled:!1,enterpriseTemplatesEnabled:!1,exploreTemplatesUrlFormat:null,exploreTemplatesUrlLocale:null,msCreateSupportedLocale:"",numTemplates:0,numVisioTemplates:0,premiumTemplatesDiamondCorner:null,premiumTemplatesUpsellEnabled:!1,sharePointAuthFrameUrl:null,templatesApiEndpoint:null,excelOrgTemplatesEnabled:!1,templatesFormsEnabled:!1,createTemplatesEnabled:!1,wordOrgTemplatesEnabled:!1,templatesRecommendedApps:[],templatesCollectionsCommercial:[],templatesCollectionsConsumer:[],templatesCollectionsEdu:[],templatesRecommendedApiEnabled:!1,visioUnsupportedTemplatesLocales:[]},this.commonResources=l&&l.appResources?l.appResources.common:{},this.resourceVariants=new Map,l&&l.appResources&&l.appResources.variants&&l.appResources.variants.forEach((function(e){var t=a.a.fileTypeNameToFileType(e.app);t&&o.resourceVariants.set(t,e.resources)})),this.resourceMap=new Map}return e.prototype.resources=function(e){void 0===e&&(e=a.b.Word);var t=a.a.fileTypeToApp(e);if(this.resourceMap.has(t))return this.resourceMap.get(t);if(!this.resourceVariants.has(t))return this.commonResources;var n=this.resourceVariants.get(t),r=Object(i.__assign)(Object(i.__assign)({},this.commonResources),n);return this.resourceMap.set(t,r),r},e.prototype.getTemplatesInfoPromise=function(){var e=this;if(!this.templatesInfoPromise){var t=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(o.a)(1)).toPromise(),n=d.a.fullPageReady();this.templatesInfoPromise=Promise.race([t,n]).then((function(){return e.configParserService.parse("templatesInfo")}))}return this.templatesInfoPromise},e.prototype.prefetchStaticResources=function(e){var t=this.resources(e);(null==t?void 0:t.PrefetchUrl)&&this.documentService.addIframeToPage(p.a.appendQueryParam(t.PrefetchUrl,"ui",this.contextService.sharedContext.officeMarket))},e.configElementId="templatesPageConfig",e.ɵprov=f.kc({factory:function(){return new e(f.lc(l.a),f.lc(u.a),f.lc(s.a),f.lc(c.a))},token:e,providedIn:"root"}),e}()},inRP:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU");function r(e){for(var t=[],n=0;n<e.length;++n){var i=("00"+e[n].toString(16)).slice(-2);t.push(i)}return t.join("")}function o(e,t,n,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,o(t+n)];case 1:return a=i.sent(),[4,e.digest({name:"SHA-256"},a)];case 2:return l=i.sent(),[2,r(new Uint8Array(l))]}}))}))}},izKO:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"j7b/":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a}));var i=ion(e){e.ItemId="item",e.DriveId="drive",e.DocUrl="file",e.ContentUri="contenturi",e.NewFile="newfile",e.BootId="bootid",e.Nav="nav"}(i||(i={}));var r="WacContent_Document_Boot_Diagnostics"},jrGV:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("2dXW"),r=n("zvoD"),o=n("f0qX"),a=n("keVe"),l=function(){function e(){this.actionContextMenu=new i.a}return e.prototype.closeMenu=function(e){this.updateNext(e,0)},e.prototype.openMenu=function(e){this.updateNext(e,1)},e.prototype.subscribeToCloseEvents=function(e){return this.actionContextMenu.asObservable().pipe(Object(r.a)((function(e){return e&&0===e.type})),Object(o.a)((function(e){return{id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement}}))).subscribe(e)},e.prototype.subscribeToO{return{id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement}}))).subscribe(e)},e.prototype.updateNext=function(e,t){e&&this.actionContextMenu.next({type:t,id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement})},e.ɵprov=a.kc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},jsgn:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("QjXU");function r(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return[2,t.importKey("jwk",e,"AES-GCM",!1,["encrypt","decrypt"])]}))}))}},"k+kJ":function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){retur),s=n("Uqr9"),c=n("IAGz"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(function(){function e(e,t,n,r,o,a,u,d,p){void 0===r&&(r=null),void 0===o&&(o=0),void 0===a&&(a=i.Started),void 0===u&&(u=null),void 0===d&&(d=null),void 0===p&&(p=null),this.sessionId=e,this.file=t,this.uploadSource=n,this.cancellationToken=r,this.bytesUploaded=o,this.state=a,this.error=u,this.sessionUrl=d,this.markCompletedAndOpenedInOfficeHome=p,this.startTime=s.a.now(),this.fileSnished=function(){return this.state===i.Completed||this.state===i.Cancelled||this.state===i.Failed||this.state===i.CompletedAndOpened},e.prototype.updateProgress=function(e){void 0!==e&&(this.lastLoaded=Math.min(Math.max(this.lastLoaded,e),this.fileSize),this.progress.next(this.progren(){return this.progress.asObservable()},Object.defineProperty(e.prototype,"duration",{get:function(){return s.a.now()-this.startTime},enumerable:!0,configurable:!0}),e.prototype.progrerted",e[e.CnvalidFileType",e[e.BadConnection=4]="BadConnection",e[e.Timeout=5]="Timeout",e[e.Auth=6]="Auth",e[e.MultipleFiles=7]="MultipleFiles"}(r||(r={})),function(e){e[e.Button=0]="Button",e[e.DragAndDrop=1]="DragAndDrop",e[e.CreateMenu=2]="CreateMenu"}(o||(o={}))},kJkW:function(e,t,n){var i={"../app-gallery-wrapper/app-gallery-wrapper.module.ngfactory":["xPmN",138],"../create-center/create-center-wrapper/create-center-wrapper.module.ngfactory":["8EFO",154],"../draft-content/draft-content.module.ngfactory":["YwqT",8,6,7,10,9,11,12,13,16,17,18,20,19,21,23,26,22,25,27,24,28,30,29,31,34,32,35,40,47,50,52,63,85,84,283,168],"../feed/feed.module.ngfactory":["BVus",8,7,9,14,641,179],"../fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",14,185],"../home/home.module.ngfactory":["tGFC",302],"../install/install-wizard/install-wizard.module.ngfactory":["MPfF",566],"../m365-apps/m365-apps.module.ngfactory":["S91J",8,7,9,14,655,574],"../modern-start/modern-start.module.ngfactory":["JOfQ",8,7,10,9,12,0,1,2,67,579],"../my-content/my-content.module.ngfactory":["+ilh",8,6,7,10,9,11,12,13,14,16,17,18,20,19,21,23,26,22,25,27,24,28,30,29,31,34,32,37,36,39,41,40,43,49,55,64,119,292,575],"../odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",14,583],"../odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",14,584],"../search-results/search-results.module.ngfactory":["+OTV",10,57,96,53,599],"../start-page-wrapper/start-page-wrapper.module.ngfactory":["08GV",608],"../templates-page-wrapper/templates-page-wrapper.module.ngfactory":["X8dK",617],"../wac-content/wac-content.module.ngfactory":["005W",14,98],"./app-gallery-wrapper/app-gallery-wrapper.module.ngfactory":["xPmN",138],"./create-center/create-center-wrapper/create-center-wrapper.module.ngfactory":["8EFO",154],"./draft-content/draft-content.module.ngfactory":["YwqT",8,6,7,10,9,11,12,13,16,17,18,20,19,21,23,26,22,25,27,24,28,30,29,31,34,32,35,40,47,50,52,63,85,84,283,168],"./feed/feed.module.ngfactory":["BVus",8,7,9,14,641,179],"./fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",14,185],"./install/install-wizard/install-wizard.module.ngfactory":["MPfF",566],"./m365-apps/m365-apps.module.ngfactory":["S91J",8,7,9,14,655,574],"./modern-start/modern-start.module.ngfactory":["JOfQ",8,7,10,9,12,0,1,2,67,579],"./my-content/my-content.module.ngfactory":["+ilh",8,6,7,10,9,11,12,13,14,16,17,18,20,19,21,23,26,22,25,27,24,28,30,29,31,34,32,37,36,39,41,40,43,49,55,64,119,292,575],"./odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",14,583],"./odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",14,584],"./officeforms/group-forms.module.ngfactory":["/o7E",48,587],"./officeforms/my-forms.module.ngfactory":["lJPE",14,48,588],"./search-results/search-results.module.ngfactory":["+OTV",10,57,96,53,599],"./start-page-wrapper/start-page-wrapper.module.ngfactory":["08GV",608],"./templates-page-wrapper/templates-page-wrapper.module.ngfactory":["X8dK",617],"./wac-content/wac-content.module.ngfactory":["005W",14,98],"action-context-menu-react.ngfactory":["JJsp",8,6,7,9,11,12,13,16,17,18,20,19,21,23,26,22,25,27,24,30,29,32,40,275,15,625,133],"announcement.ngfactory":["OyNO",8,6,7,10,9,12,16,28,276,0,1,2,15,626,134],"app-gallery-angular.ngfactory":["6nNX",136],"app-gallery-react.ngfactory":["Z6FN",8,6,7,10,9,11,12,13,16,17,18,20,19,21,23,26,22,25,27,24,30,29,32,39,79,277,0,1,2,137],"appbar.ngfactory":["fdWd",8,6,7,9,11,12,13,16,17,18,20,19,23,26,22,25,27,24,30,79,279,0,1,2,15,3,65,91,92,141],"auto-suggest.ngfactory":["tDVW",10,57,53,148],"banner.ngfactory":["QOI9",14,149],"bread-crumb.ngfactory":["PaRP",10,14,57,53,150],"calendar.ngfactory":["q48a",48,151],"confirmation-dialog-react.ngfactory":["uaMB",8,7,10,9,28,31,34,37,281,0,1,2,633,160],"context-menu.ngfactory":["aBzG",162],"create-center-react.ngfactory":["PA+F",8,6,7,10,9,11,12,13,16,17,18,20,19,21,26,22,25,27,24,28,30,29,31,34,37,36,43,54,82,153],"create-center.ngfactory":["htPP",8,6,7,10,9,11,12,13,16,17,18,20,19,21,26,22,25,27,24,28,30,29,31,34,37,36,43,54,82,152],"create-menu.ngfactory":["EA+W",14,165],"create-on-home-react.ngfactory":["p56C",8,6,7,10,9,11,12,13,16,36,54,0,1,2,15,3,4,38,42,45,56,59,58,93,631,157],"create-on-home-wrapper.ngfactory":["6x3I",158],"create-on-home.ngfactory":["awIr",8,6,7,10,9,11,12,13,16,36,54,0,1,2,15,3,38,42,59,93,156],"create-onenote-page-dialog-react.ngfactory":["uENI",6,7,10,16,17,20,19,26,22,25,27,24,30,29,282,0,1,2,15,635,163],"edgeworth.ngfactory":["MZ9O",14,66,638,169],"error-dialog-react.ngfactory":["Lpnb",8,6,7,10,9,11,12,13,17,18,35,284,0,15,640,173],"error-dialog.ngfactory":["oDVq",14,172],"ew-react.ngfactory":["cjNM",8,6,7,10,9,11,12,13,16,17,18,20,19,21,23,26,22,25,27,24,28,30,29,31,34,32,37,36,39,41,40,49,55,64,175],"feature-callout.ngfactory":["6lH3",177],"feature-tooltip-container.ngfactory":["Vbec",178],"feedback.ngfactory":["UHVx",14,180],"first-run-react.ngfactory":["nDWB",8,6,7,10,9,11,12,13,17,20,21,28,31,47,50,52,85,86,0,1,2,15,3,38,644,182],"first-run-wrapper.ngfactory":["SpUw",183],"first-run.ngfactory":["AzcM",181],"floating-action-button.ngfactory":["S+Ap",8,6,7,10,9,12,23,288,0,1,2,15,648,273],"fluent-theme-provider.ngfactory":["wMw5",8,7,9,274],"fluid-content.ngfactory":["4Tvn",6,7,10,14,28,31,34,37,41,87,286,15,44,73,645,78,184],"forms-group.ngfactory":["oA+b",48,301],"input-dialog.ngfactory":["4csf",14,66,563],"install-react.ngfactory":["dqLy",8,7,9,14,1,650,565],"install-wrapper.ngfactory":["hLvm",567],"install.ngfactory":["T4V2",14,564],"learning-shelf-react.ngfactory":["AIbW",8,6,7,9,11,12,13,18,20,21,43,290,0,1,2,15,3,45,59,58,117,653,571],"left-nav-react.ngfactory":["46Tl",10,291,654,573],"mobile-app-banner.ngfactory":["1jme",14,576],"move-to-folder-control.ngfactory":["PsH8",577],"mru.ngfactory":["GHXR",48,578],"new-consumer-experience.ngfactory":["VHqc",14,580],"new-user-shelf.ngfactory":["hPLh",14,581],"places.ngfactory":["wK/J",14,48,590],"portal-preload.ngfactory":["v2r5",592],"quick-access.ngfactory":["leWi",8,6,7,10,9,11,12,13,16,17,18,20,19,21,23,26,22,25,27,24,28,30,29,31,34,32,37,36,39,41,40,49,55,594],"recommended-react.ngfactory":["+luH",8,6,7,10,9,11,12,13,14,16,17,18,20,19,21,23,26,22,25,27,24,28,30,29,31,34,32,36,39,41,40,43,47,49,63,89,596],"search-preload.ngfactory":["01Cu",10,14,57,662,53,598],"share-control.ngfactory":["Uv8L",78,601],"side-popup-menu.ngfactory":["8KAq",14,604],"skip-to-main.ngfactory":["lxgd",8,7,10,9,0,1,2,664,605],"start-page-react.ngfactory":["VbK9",8,7,10,9,12,0,1,2,67,606],"support-central-react.ngfactory":["tbFl",10,0,1,666,610],"task-module-dialog-react.ngfactory":["C0gm",8,6,7,10,9,11,12,13,81,295,0,1,2,15,3,46,75,65,68,667,611],"teaching-ui-react.ngfactory":["BSh6",8,7,10,9,0,1,2,3,45,61,75,65,668,612],"template-page-react.ngfactory":["9Ppf",8,7,10,9,12,0,1,2,67,614],"templates.ngfactory":["+eAU",90,616],"toast-container-react.ngfactory":["G/jE",8,6,7,10,9,11,12,13,20,27,298,0,1,2,15,92,670,619],"upload-button.ngfactory":["WbHY",14,620],"upload-dialog.ngfactory":["ynE4",14,621],"upload-react.ngfactory":["9kEu",8,6,7,9,11,12,13,16,17,18,20,19,26,22,25,27,24,30,29,35,36,41,299,0,1,2,15,3,4,622],"visual-background-react.ngfactory":["gB77",8,6,7,9,12,0,1,2,15,45,58,101,671,674],"wac-content.ngfactory":["005W",14,98],"wac-start.ngfactory":["DLYR",66,90,675],"web-vitals.ngfactory":["/Fzb",1,677],"welcome-badge-react.ne+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(r)}))}r.keys=function(){return Object.keys(i)},r.id="kJkW",e.exports=r},kMgc:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("QjXU"),r=n("Epfv"),o=n("BMb5"),a=n("keVe"),l=function(){function e(e){this.windowService=e}return e.prototype.decode=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,Object(r.a)(e,this.windowService.nativeWindow)]}))}))},e.prototype.encode=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,Object(r.b)(e,this.windowService.nativeWindow)]}))}))},e.ɵprov=a.kc({factory:function(){return new e(a.lc(o.b))},token:e,providedIn:"root"}),e}()},kVgv:function(e,t,n){"use strict";n.d(t,"a",(fu]="Trending",e[e.News=10]="News",e[e.Meeting=11]="Meeting",e[e.Video=12]="Video",e[e.MyAnalytics=13]="MyAnalytics",e[e.Task=14]="Task"}(i||(i={}))},kfAr:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("QjXU"),r=n("lrJm"),o=n("Ry9Z"),a=n("BaAg"),l=n("QOOv"),s=n("fKR7"),c=n("pd4Y"),u=n("TDzr"),d=n("n826"),p=n("Dpxn"),f=n("m+UP"),h=n("BJbw"),m=n("Brer"),b=n("4/We"),g=n("/I02"),v=n("cgnd"),S=n("keVe"),y=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p){this.capabilitiesService=e,this.dateService=n,this.formsService=i,this.oneDriveGraphService=o,this.oneDriveService=a,this.vroomService=l,this.swayService=s,this.analyticsService=c,this.urlAuthenticatorService=u,this.globalErrorHandler=d,this.clientStartupConfigService=p,this.config=r.config,this.lifecycleEventsEnabled=this.config.isNewLifecycleEventEnabled,this.inflationsInProgress=new Array,this.inMockMode=t.sharedContext.inMockMode,this.thumbnailApiEnabled=this.capabilitiesService.capabilities.thumbnailEndpointEnabled}return e.prototype.inflateItem=function(t,n,i,r){var o=this;if(t.isLocal||e.disableInflation.has(t.fileType))return Promise.resolve(t);var a=this.fetchItemInflationData(t,t.fromCache?"cache-only":"network-first",n,i,r);return this.inflationsInProgress.push(a.then((function(e){return e}),(function(){return null}))),this.waitOnInflations().then((function(){return o.inflationsInProgress.splice(0)})),a},e.prototype.inflateThumbnails=function(t){var n=this;if(!e.thumbnailFileTypes.has(t.fileType)||t.thumbnails)return Promise.resolve(t);var i=t.fromCache?"cache-only":"network-first";return new Promise((function(e){if(t.fileType!==a.b.Sway)return t.fileType===a.b.Forms?(t.thumbnails={},void n.formsService.fetchFormThumbnail(t).then((function(){return e(t)}))):void(t.driveId&&t.docId?n.thumbnailApiEnabled&&t.format!==s.a.News&&t.format!==s.a.StreamsVideo?(n.populateThumbnailWithUrl(t,n.getThumbnailUrlForItem(t.driveId,t.docId)),e(t)):n.oneDriveGraphService.getThumbnailsForItem(t.driveId,t.docId,i,2).then((function(e){e&&e.value&&e.value.length&&n.populateThumbnails(t,e.value[0])})).catch((function(e){n.globalErrorHandler.handleError(e,"ZYaIo")})).then((function(){return e(t)})):n.chooseSharesCall(t,i,!0).then((function(e){e&&e.thumbnails&&e.thumbnails.length&&n.populateThumbnails(t,e.thumbnails[0]ion(e){n.globalErrorHandler.handleError(e,"hKd6C")})).then((function(){return e(t)})));n.fetchSwayThumbnail(t,i).then((function(){e(t)}))}))},e.prototype.waitOnInflations=function(){var e=this,t=this.inflationsInProgress.length;return Promise.all(this.inflationsInProgress).then((function(){if(!(e.inflationsInProgress.length<=t))return e.waitOnInflations()}))},e.prototype.fetchItemInflationData=function(e,t,n,r,o){var l=this;return e.format===s.a.Recommended||e.format===s.a.OfficeFeedDocument||e.format===s.a.News?this.fetchRecommendedItemInflationData(e,t):new Promise((function(c){var u=[],d=l.config.shareControlEnabled&&e.fileType!==a.b.Sway,p=l.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!l.capabilitiesService.capabilities.isEmbedMode;if(e.format===s.a.Trending&&e.driveId&&e.docId)l.tileViewEnabledForItem(e)&&n&&u.push(p?l.oneDriveService.getItemWithWacDataAndThumbnails(e,t,!1,2).then((function(t){l.populateMruItemFromDriveItem(e,t),l.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&l.populateThumbnailWithUrl(e,l.getThumbnailUrlForItem(e.driveId,e.docId))})).catch((function(e){l.globalErrorHandler.handleError(e,"WF9ix")})):l.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((function(t){t&&t.value&&t.value.length&&l.populateThumbnails(e,t.value[0])})).catch((function(e){l.globalErrorHandler.handleError(e,"iZlQF")}))),e.fileType!==a.b.OneNote&&u.push(l.setupActivity(e,t))temWithIds(e.driveId,e.docId,"sharepointIds,createdDateTime",t).then((function(t){l.setupShareControl(e,t),l.setupLifecycleEvents(e,t)})).catch((function(e){l.globalErrorHandler.handleError(e,"wUAkv")})));else if((l.tileViewEnabledForItem(e)||l.config.activityEnabled||l.config.permissionsEnabled||d||p)&&m.a.sharesFileTypes.has(e.fileType)&&(1===e.sharingType||4===e.sharingType||0===e.sharingType)){var f=l.checkAllDataIsPresentForInflation(e);if(f){l.setupLifecycleEvents(e,null);var h=(e.fileType!==a.b.OneNote?l.setupActivity(e,t):Promise.resolve()).then((function(){return Promise.resolve()}));u.push(h),n&&e.driveId&&e.docId&&u.push(l.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((function(t){t&&t.value&&t.value.length&&l.populateThumbnails(e,t.value[0])})).catch((function(e){l.globalErrorHandler.handleError(e,"iZlQF")})))}f||u.push(l.chooseSharesCall(e,t,n).then((function(n){return n?(l.populateMruItemFromDriveItem(e,n),l.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&l.populateThumbnailWithUrl(e,l.getThumbnailUrlForItem(e.driveId,e.docId)),l.setupShareControl(e,n),l.setupLifecycleEvents(e,n),e.docId=n.id,n.parentReference&&(e.driveId=n.parentReference.driveId),e.fileType!==a.b.OneNote?l.setupActivity(e,t):Promise.resolve()):Promise.resolve()})).catch((function(e){l.globalErrorHandler.handleError(e,"EgyA3")})))}if(l.config.analyticsEnabled&&r){var b=l.analyticsService.getAnalytics(e,t).then((function(t){e.analytics=t})).catch((function(e){l.globalErrorHandler.handleError(e,"gBfeR")}));u.push(b)}u.push.apply(u,Object(i.__spread)(l.setupSwayspread)(l.setupFormData(e,n,o))),Promise.all(u).then((function(){e.inflationCompleted(),c(e)}),(function(){e.inflationCompleted(),c(e)}))}))},e.prototype.fetchRecommendedItemInflationData=function(e,t){var n=this;return new Promise((function(i){e.driveId&&e.docId?n.fetchAndPopulateWacDataAndThumbnails(e,t).catch((function(e){n.globalErrorHandler.handleError(e,"rm3f5")})).then((function(){return i(e)})):i(e)}))},e.prototype.getThumbnailUrlForItem=function(e,t){if(e&&t){var n="drives/"+encodeURIComponent(e)+"/items/"+encodeURIComponent(t)+"/thumbnails/0/c400x99999/content?prefer=noredirect,closestavailablesize,extendCacheMaxAge";return this.inMockMode?"thumbnails?itemUrl="+encodeURIComponent(n):n}},e.prototype.fetchAndPopulateWacDataAndThumbnails=function(e,t){var n=this;return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!this.inMockMode?this.oneDriveService.getItemWithWacDataAndThumbnails(e,t).then((function(t){n.populateMruItemFromDriveItem(e,t),n.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo&&n.populateThumbnailWithUrl(e,n.getThumbnailUrlForItem(e.driveId,e.docId))})):this.thumbnailApiEnabled&&e.format!==s.a.News&&e.format!==s.a.StreamsVideo?(this.populateThumbnailWithUrl(e,this.getThumbnailUrlForItem(e.driveId,e.docId)),Promise.resolve()):(e.driveId&&e.docId?this.oneDriveGraphS.then((function(e){return null==e?void 0:e.value})):this.chooseSharesCall(e,t,!0).then((function(e){return null==e?void 0:e.thumbnails}))).then((function(t){(null==t?void 0:t.length)&&n.populateThumbnails(e,t[0])}))},e.prototype.populateMruItemFromDriveItem=function(e,t){!this.thumbnailApiEnabled&&t&&t.thumbnails&&t.thumbnails.length&&this.populateThumbnails(e,t.thumbnails[0]),t&&t.openWith&&t.openWith.wac&&this.populateWopiHostData(e,t)},e.prototype.populateThumbnails=function(e,t){e.thumbnails={small:t.small?t.small.url:null,medium:t.medium?t.medium.url:null,large:t.large?t.large.url:null,recommendedThumbnail:e.format!==s.a.Recommended&&e.format!==s.a.News&&e.format!==s.a.OfficeFeedDocument||!t.large?null:this.getRecommendedThumbnail(t.large.url)}},thumbnails={large:t,recommendedThumbm(t)},e.prototype.getRecommendedThumbnail=function(e){return e.replace(/&width=\d+/,"&width=350").replace(/&height=\d+/,"&height=400")},e.prototype.setupActivity=function(e,t){var n=this;return!this.config.activityEnabled||e.format===s.a.Recent&&this.config.mruActivityEnabled&&this.config.onlyMruActivityEnabled?Promise.resolve():this.vroomService.getDocumentActivity(e,t,2).then((function(t){return e.activities=t})).catch((function(e){n.globalErrorHandler.handleError(e,"SluwI")}))},e.prototype.chooseSharesCall=function(e,t,n){var i=e.canonicalUrl;if(!i.match(a.e)&&!i.match(a.d))return Promise.resolve(void 0);var r=this.capabilitiesService.wacHostEnabledForFileType(e.fileType);return n?this.oneDriveService.getSharedItemWithThumbnail(i,e.fileType,s.a[e.format],t,r,!1,2):this.oneDriveService.getSharedItemWithoutThumbnail(i,e.fileType,s.a[e.format],t,r,void 0,!1,2)},e.prototype.setupShareControl=function(e,t){t&&t.sharepointIds&&t.sharepointIds.siteUrl&&(e.sharepointIds.siteUrl=t.sharepointIds.siteUrl)},e.prototype.setupLifecycleEvents=function(e,t){if(this.lifecycleEventsEnabled&&!this.config.mruActivityEnabled){var n=e.createdDate;!n&&t&&t.createdDateTime&&(n=new Date(t.createdDateTime)),n&&(e.isNew=this.dateService.addHours(this.dateService.getCurrentDate(),-1*this.config.isNewTimeWindowInHours).getTime()<=n.getTime())}},e.prototype.setupFormData=function(e,t,n){var i=this,r=[];return e.fileType!==a.b.Forms||(n===a.b.Forms&&r.push(new Promise((function(t,n){var r=function(t){void 0===t&&(t=0),e.metaData||(e.metaData={}),e.metaData.formsResponseCount=t};e.ownerId===i.clientStartupConfigService.config.objectId||i.clientStartupConfigService.config.authType===v.a.MSA?i.formsService.getMyFormsResponses().then((function(n){var i=n.find((function(t){return t.id===e.serverDocId}));r(null==i?void 0:i.responseCount),t()})).catch(n):i.formsService.getForm(e.serverDocId,e.ownerType,e.ownerId).then((function(e){r(e?e.rowCount:null),t()})).catch(n)}))),this.tileViewEnabledForItem(e)&&t&&r.push(this.inflateThumbnails(e).then((function(){})))),r},e.prototype.setupSwayData=function(e,t,n){var i=[];return e.fileType!==a.b.Sway||(this.tileViewEnabledForItem(e)&&this.swayService.swayConfig.thumbnailsEnabled&&n&&i.push(this.fetchSwayThumbnail(e,t)),e.url=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.url)),i},e.prototype.fetchSwayThumbnail=function(e,t){var n=this;return this.swayService.getThumbnail(e.url,e.thumbnailInfo?e.thumbnailInfo.thumbnailId:null,t).then((function(t){t&&(e.thumbnails={small:t,medium:t,large:t,recom(e,"cm5b1")}))},e.prototype.checkAllDataIsPresentForInflation=function(e){return!!(e.sharepointIds&&e.createdDate&&e.driveId&&e.docId)},e.prototype.tileViewEnabledForItem=function(e){return this.config.tileViewEnabled||e.fileType===a.b.Forms},e.thumbnailFileTypes=new Set([a.b.PowerPoint,a.b.Visio,a.b.Word,a.b.Sway,a.b.Pdf,a.b.Forms,a.b.Stream]),e.disableInflation=new Set([a.b.Project,a.b.ProjectOperations,a.b.Portfolio]),e.ɵprov=S.kc({factory:function(){return new e(S.lc(b.a),S.lc(g.a),S.lc(c.a),S.lc(u.a),S.lc(l.a),S.lc(d.a),S.lc(p.a),S.lc(m.a),S.lc(f.a),S.lc(o.a),S.lc(h.a),S.lc(r.b),S.lc(v.b))},token:e,providedIn:"root"}),e}()},kpuN:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));var i,r=n("QjXU"),o=n("2dXW");!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(i||(i={}));var a=function(e){function t(t,n,i){void 0===i&&(i=!0);var r=e.call(this,t)||thierrorHandler=e,this.defaultToreauth=new o.a,this.reauthComplete=this._reauth.asObservable()},e.prototype.getDefaultExpiry=function(){return(new Date).getTime()+36e5},e.prototype.getAccessToken=function(e,t,n,i,o,a,l,s,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u=this;return Object(r.__generator)(this,(function(r){return e?[2,this.getAccessTokenResponse(e,t,n,i,o,a,l,s,c).then((function(e){return e&&e.token?e:{success:!1,token:"",format:u.defaultTokenFormat,source:u.defaultTokenSource,error:new Error("Empty token returned")}})).catch((function(e){return u.errorHandler.handleError(e,"SuNwZ"),{success:!1,token:"",format:u.defaultTokenFormat,source:u.defaultTokenSource,error:e}}))]:[2,Promise.resolve({success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:new Error("invalid tokenConsumer")})]}))}))},e}()},kq70:function(e,ton(e){function t(t,n){var i=e.call(this,(function(){return i.wacContentService.prebootDocument(i.itemInfo.item,i.itemInfo.wdOriginType)}))||this;return i.capabilitiesService=t,i.wacContentService=n,i}return Object(i.__extends)(t,e),t.prototype.enabled=function(){return this.capabilitiesService.wacHostEnabledForFileType(this.itemInfo.item.fileType)&&this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(this.itemInfo.item.fileType)},t}(n("adME").a))},ksTh:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a}));var i="client-request-id",r="x-correlationid",o="_Edgeworth"+window.ewWorkload+"LastSyncTimestamp",a="rs="},kvyl:function(e,t,n){"use strict";function i(e){for(var t=[],n=0;n<e.length;++n){var i=("00"+e[n].toString(16)).slice(-2);t.push(i)}return t.join("")}function r(e){void 0===e&&(e="");for(var t=[],n=0;n<e.length;)t.push(parseInt(e.substring(n,n+2),16)),n+=2;return new Uint8Array(t)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}))},kxm0:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var i=n("TfV2"),r=n("ZBSS"),o=n("zGJG"),a=n("uqr+"),l=n("dSKW"),s=n("uV9m");function c(e,t){var n;void 0===t&&(t=i.a.Security);var o,l={};l[r.A]="PageView",l[r.B]=null!==(n=e.eventName)&&void 0!==n?n:"",(Object(s.e)()||e.pageName)&&(o=p(f(l=d(l,e.pageName)))),l[Object(a.a)([r.ab,r.S])]=e.isIntentional,Object(s.g)(o,l,t)}function u(e){return"PageView"===e[r.A]}function d(e,t){if(e[Object(a.a)([r.ab,r.Y])])return e;var n=t?function(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)||""}(t):Object(l.b)(Object(s.b)());return e[Object(a.a)([r.ab,r.Y])]=n,e[Object(a.a)([r.ab,r.Z])]=Object(l.d)(n),e[Object(a.a)([r.ab,r.X])]=Object(l.c)(n),e}function p(e){return["PageView",e].join(o.b)}function f(e){return e[Object(a.a)([r.ab,r.Y])]}},lQwO:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},lUkk:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("TfV2"),r=n("ZBSS"),o=n("zGJG"),a=n("uqr+"),l=n("dSKW"),s=n("uV9m");function c(e,t){void 0===t&&(t=i.a.Security);var n=function(e){return["Action",e.result,e.target].join(o.b)}(e);Object(s.g)(n,function(e){var t,n,i,o,c={};if(c[r.A]="Action",c[Object(a.a)([r.a,r.e])]=null!==(t=e.type)&&void 0!==t?t:"Click",c[Object(a.a)([r.a,r.J])]=e.id,c[Object(a.a)([r.a,r.j])]=e.area,c[Object(a.a)([r.a,r.jb])]=null!==(n=e.subArea)&&void 0!==n?n:"Other",c[Object(a.a)([r.a,r.b])]=e.result,c[Object(a.a)([r.a,r.c])]=e.target,c[Object(a.a)([r.a,r.d])]=null!==(i=e.targetId)&&void 0!==i?i:"",c[r.B]=null!==(o=e.eventName)&&void 0!==o?o:"",Object(s.e)()||e.pageName){var u=e.pageName?e.pageName:Object(l.b)(Object(s.b)());c[Object(a.a)([r.a,r.Y])]=u,c[Object(a.a)([r.a,r.Z])]=Object(l.d)(u),c[Object(a.a)([r.a,r.X])]=Object(l.c)(u)}return c}(e),t)}},laSs:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("TfV2"),r=n("ZBSS"),o=n("uqr+"),a=n("dSKW"),l=n("uV9m");function s(e,t){void 0===t&&(t=i.a.Security),Object(l.g)("Impression",function(e){var t,n,i,s,c={};if(c[r.A]="Impression",c[r.B]=e.eventName,c[Object(o.a)([r.K,r.j])]=e.area,c[Object(o.a)([r.K,r.jb])]=null!==(t=e.subArea)&&void 0!==t?t:"Other",c[Object(o.a)([r.K,r.H])]=null!==(n=e.fromCache)&&void 0!==n&&n,c[Object(o.a)([r.K,r.db])]=e.renderSize?e.renderSize.toString():"",c[Object(o.a)([r.K,r.kb])]=e.totalSize?e.totalSize.toString():"",c[Object(o.a)([r.K,r.f])]=e.actualSize?e.actualSize.toString():"",c[Object(o.a)([r.K,r.s])]=null!==(i=e.distribution)&&void 0!==i?i:"",c[Object(o.a)([r.K,r.J])]=null!==(s=e.id)&&void 0!==s?s:"",Object(l.e)()){var u=Object(a.b)(Object(l.b)());c[Object(o.a)([r.K,r.Y])]=u,c[Object(o.a)([r.K,r.Z])]=Object(a.d)(u),c[Object(o.a)([r.K,r.X])]=Object(a.c)(u)}return c}(e),t)}},lkvL:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("QjXU"),r=n("e3cR"),o=n("muUJ"),a=n("a3FV"),l=n("CMIS"),s=n("H2Bi"),c=n("WDeU");function u(e){var t,n,u=e.userId,d=e.collectionName,p=e.collectionVersion,f=e.key,h=e.data,m=e.hashKey,b=e.plugins,g=void 0===b?[]:b,v=e.writeBehavior,S=void 0===v?"replace":v;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,b,v,y,C,w,T,k,I,_,A;return Object(i.__generator)(this,(function(P){switch(P.label){case 0:return P.trys.push([0,10,,11]),[4,Object(c.a)(u,d,p,f,m)];case 1:e=i.__read.apply(void 0,[P.sent(),2]),b=e[0],v=e[1],P.label=2;case 2:P.trys.push([2,7,8,9]),y=Object(i.__values)(g),C=y.next(),P.label=3;case 3:return C.done?[3,6]:(w=C.value).onBeforeWriteValue?[4,w.onBeforeWriteValue(h,v,{userId:u,collectionName:d,collectionVersion:p})]:[3,5];case 4:h=P.sent(),P.label=5;case 5:return C=y.next(),[3,3];case 6:return[3,9];case 7:return T=P.sent(),I={error:T},[3,9];case 8:try{C&&!C.done&&(_=y.return)&&_.call(y)}finally{if(I)throw I.error}return[7];case 9:return h?[2,Object(r.e)(b,[h],s.b,S,[v])]:[2];case 10:throw k=P.sent(),Object(o.a)(a.a.SimplePersistenceWriteError,((A={}).Error="Error writing to ".concat(d,": ").concat(null===(t=null==k?void 0:k.toString)||void 0===t?void 0:t.call(k)),A)),Object(l.a)({eventName:"Simple_Persistence_Write_Error",errorType:"SimplePersistence_Error",message:"Error writing to ".concat(d,": ").concat(null===(n=null==k?void 0:k.toString)||void 0===n?void 0:n.call(k))}),k;case 11:return[2]}}))}))}},lrJm:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var i=n("QjXU"),r=n("keVe"),o=n("CMIS"),a=n("hhzZ"),l=n("BMb5"),s=function(e){function t(n,i){var r=e.call(this,n)||this;return r.message=n,r.originalError=i,r.name="ApplicationError",Object.setPrototypeOf&&Object.setPrototypeOf(r,t.prototype),r}return Object(i.__extends)(t,e),t}(Error),c=function(e){function t(t,n){var i=e.call(this)||this;return i.instrumentationService=t,i.windowService=n,i.loggedErrors=new Map,i.unknownError="UnknownError",i.ignoredErrorSubstrings=["__gCrWeb"],i.mutateGlobalWindowErrorHandler(),i}return Object(i.__extends)(t,e),t.prototype.handleError=function(e,t){this.shouldSwallow(e)||(this.setErrorId(e,t),this.logError(e,"Angular2"))},t.prototype.handleCacheObservableError=function(e,t,n){e&&(e.networkError&&this.handleError(e.networkError,n),e.cacheError&&this.handleError(e.cacheError,t))},t.prototype.setErrorId=function(e,t){e&&"object"==typeof e&&t&&(e.id=t)},t.prototype.mutateGlobalWindowErrorHandler=function(){var e=this.windowService.nativeWindow,t=e.onerror,n=this;e.onerror=function(i,r,o,a,l){var s=null;if("object"==typeof i&&i.type&&"error"===i.type.toLowerCase()?s=i:l?((s=l).message=l.message||i,Object.assign&&Object.assign(s,{filename:r,lineno:o,colno:a})):"string"==typeof i?(s=new Error(i||n.unknownError),Object.assign&&Object.assign(s,{filename:r,lineno:o,colno:a})):(s=new Error(n.unknownError),Object.assign&&Object.assign(s,{filename:r,lineno:o,colno:a})),n.logError(s,"Global"),t)try{t.apply(e,arguments)}catch(e){n.handleError(e)}}},t.prototype.logError=function(t,n){var i="",r="";t=t||new Error(this.unknownError);try{var o=t.filename;i=o?"Error location: "+(o=o.replace(/^.*[\\\/]/,""))+", line: "+t.lineno+", col: "+t.colno:t.id?"Error id: "+t.id:"Error location: unknown";var a=t.error||t;a.originalError?(i+="\nHandled error is a wrapper with message: "+a.message,r="Wrapper call stack: "+(a.stack||"Call stack trace is not available"),r+="\nOriginal call stack: "+((a=a.originalError).stack||"Call stack trace is not available")):r="Call stack: "+(a.stack||"Call stack trace is not available"),a.message&&(i+="\nError message: "+a.message).indexOf("Invalid calling object")>0&&(i+="\nShellver: "+window.O365ShellVerStr)}catch(t){i="Error caught inside error logger: "+(t&&t.message||this.unknownError),r="Call stack: "+(t&&t.stack||"Call stack trace is not available"),n="Angular2",e.prototype.handleError.call(this,t)}finally{this.safeLogErrorData(i,r,n),e.prototype.handleError.call(this,t)}},t.prototype.safeLogErrorData=function(t,n,i){var r;try{var a=this.determineOccurrence(t);if(this.loggedErrors.set(t,a),this.shouldLogBasedOnOccurrence(a)){var l=((r={}).ItemCategory=i,r.ItemCount=a.toString(),r);this.instrumentationService.logGenericEvent("Unhandled_Exception",l),l.Error=t,l.DebugInfo=n,this.instrumentationService.logDebugCacheEvent("Unhandled_Exception",l),Object(o.a)({eventName:"Unhandled_Exception",errorType:"Unhandled_Exception",message:t,debugInfo:n})}}catch(t){e.prototype.handleError.call(this,t)}},t.prototype.shouldSwallow=function(e){var t;if(null==e?void 0:e.shouldSwallow)return!0;var n=null===(t=(null==e?void 0:e.error)||e)||void 0===t?void 0:t.message;if(n)for(var i in this.ignoredErrorSubstrings)if(n.indexOf(i)>=0)return!0;if(e&&e.stack&&!e.promise)return!1;if(e&&e.promise&&e.rejection){var r=e.rejection;if(r.stack&&"Error"!==r.name)return!1}return!0},t.prototype.determineOccurrence=function(e){var t=1;return this.loggedErrors.has(e)&&(t=this.loggedErrors.get(e)+1),t},t.prototype.shouldLogBasedOnOccurrence=function(e){var t=e.toString().length,n=Math.pow(10,t-1);return n<2||e%n==0},t.ɵprov=r.kc({factory:function(){return new t(r.lc(a.a),r.lc(l.b))},token:t,providedIn:"root"}),t}(r.p)},lwM0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("pjz5"),r=function(){function e(){}return e.encodeUrl=function(e,t){if(!e)return"";if(t){var n=i.a.getLocation(e),r=function(e){if(!e)return"";var t=e.substring(1).split("&"),n=0,i=t.reduce((function(e,t){var i=t.split("="),r=n>0?"&":"";return n++,e+r+(i[0]&&i[1]?i[0]+"="+encodeURIComponent(i[1]):i[0]+(""===i[1]?"=":""))}),"");return e[0]ash)}return encodeURI(e).replace(/#/g,"%23")},e.decodeUrl=function(e){if(!e)return"";try{return decodeURIComponent(e)}catch(e){return""}},e}()},lwUs:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("QjXU"),r=n("e3cR"),o=n("H2Bi"),a=n("YqCH");function l(e){var t=this;return{onBeforeWriteValue:function(e){return Object(i.__awaiter)(t,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return e?[2,{item:e,persistedAtTimeMs:(new Date).getTime()}]:[2,e]}))}))},onAfterReadValue:function(n,l,s){return Object(i.__awaiter)(t,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return n?e+n.persistedAtTimeMs<n.persistedAtTimeMs?(function(e,t,n,l){Object(i.__awaiter)(this,void 0,void 0,(function(){var s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(a.a)(e,t,n)];case 1:return s=i.sent(),[4,Object(r.a)(s,o.b,l)];case 2:return i.sent(),[2]}}))}))}(s.userId,s.collectionName,s.collectionVersion,l),[2,null]):[2,n.item]:[2,n]}))}))}}}},"m+UP":function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var i=n("QjXU"),r=n("AlWG"),o=n("lrJm"),a=n("k+kJ"),l=n("JScD"),s=n("3GGT"),c=n("PZOQ"),u=n("hhzZ"),d=n("R7NL"),p=n("BaAg"),f=n("H90i"),h=n("cgnd"),m=n("/I02"),b=n("PBJH"),g=n("pjz5"),v=n("kpuN"),S=n("wwmn"),y=n("casz"),C=n("6G e(){this.cachedResponsePromises=new Map}return e.prototype.set=function(e,t,n){var i=this.key(t,n);this.cachedResponsePromises.set(i,e)},e.prototype.has=function(e,t){var n=this.key(e,t);return this.cachern this.cachedRee.delete=function(e,t){var n=this.key(e,t);return this.cachedResponsePromises.delete(n)},e.prototype.key=function(e,t){return"/"+t+"/"+e},e}(),A=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p,f,h){var m=e.call(this,n,i,r,"Sway",o,a,l,h)||this;m.globalErrorHandler=s,m.urlAuthenticatorService=c,m.uploadConfigService=d,m.locService=p,m.localDataSizePipe=f,m.cachedResponsePromises=new _,m.swayConfig=t.config;var b=u.config;return m.requestConfig={headers:new Map([["X-UserSessionId",b.sharedClientStartupContext.correlationId],["X-OHP-CorrelationId",b.sharedClientStartupContext.correlationId]])},m}return Object(i.__extends)(t,e),t.prototype.createNew=function(){var e=this,t=this.swayConfig.apiUrl+"/json/createStory";return new Promise((function(n,i){e.post("Sway_Create_Request","Sway_Create",t,void 0,(function(t){t.instrument((function(t,n){!t.ok||t.data&&t.data.url||(n.HttpCode=s.a.UnexpectedResponse.toString()),e.instrumentResponse(t.headers,n)})).then((function(t){t&&t.data?n(e.urlAuthenticatorService.appendPvrAndUpnAuthParams(t.data.url)):i(new T.b(t,"Could not parse Sway creation response"))})).catch((function(t){e.globalErrorHandle.requestConfig)}))},t.prototype.upload=function(e,n){var i=this,o=new a.b(n,e,a.d.Button),l=new r.a(o),s=function(e){o.state=e,l.next(o)};return o.cancellationToken.onCancel((function(){return s(a.c.Cancelled)})),this.verifyFileForUpload(e).then((function(){return s(a.c.Started)})).then((function(){return t.readBase64(e)})).then((function(e){return i.uploadFile({docBase64:e,documentName:o.file.name,world:"VerticalWorld",enhancementId:"",otsClient:f.a},o)})).then((function(e){o.result=e,s(a.c.Completed)})).catch((function(e){o.error=i.createUploadError(e),s(a.c.Failed)})),l.asObservable()},t.prototype.getThumbnail=function(e,n,i){var r=this;if(!this.swayConfig.thumbnailsEnabled||!n)return Promise.resolve("");var o=this.swayConfig.apiUrl+"/sway/v1.0/"+t.extractLookupId(e)+"/croppedThumbnailImage?imageId="+n+"&width=198&height=111";return new Promise((function(e,n){r.swayGet("Sway_Get_Thumbnail_Request","Sway_Get_Thumbnail",o,i,"blob",!0).then((function(i){i&&i.data?t.readAsDataUrl(i.data).thecs=function(e,n){var i=t.extractLookupId(e);return this.fetchAnalyticsForBatch([i],n).then((function(e){return t.findAnalytics(e.data,i)}))},t.prototype.prefetchAnalytics=function(e,n){var i=this;if(e&&0!==e.length)for(var r=e.map(t.extractLookupId).sort(),o=t.splitToBatches(r,this.swayConfig.analyticsBatchSize),a=0;a<o.length;a++)for(var var t=u.buildUrlForAnalytics([l[e]]);u.cachedResponsePromises.set(s,t,n),s.catch((function(){return i.cachedResponsePromises.delete(t,n)}))},u=this,d=0;d<l.length;d++)c(d)},t.prototype.handleQueryParam=function(t,n){e.prototype.handleQueryParam.call(this,t,n),"mocksway"===t&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,n)},t.findAnalytics=function(e,t){if(e)for(var n=0;n<e.length;n++)if(e[n]&&e[n].id===t)return e[n].analytics},t.extractLookupId=function(e){return g.a.getLocation(e).path.split("/").filter((function(e){return e}))[0]},t.splitToBatches=function(e,t){for(var n=[],i=e.slice();i&&i.length&&t;)n.push(,t.readAsDataUrl=function(e){return new Promise((function(t,n){var i=new FileReader;i.addEventListener("loadend",(function(){t(i.result)})),i.addEventListener("abort",(function(){n()})),i.addEventListener("error",(function(){n()})),i.readAsDataURL(e)}))},t.readBase64=function(e){retuadAsDataUrl(e).then((function(e){var t=e.indexOf(",");t>=0?n(e.substring(t+1)):i(a.a.Unknown)})).catch((function(){return i(a.a.Unknown)}))}))},t.prototype.createUploadError=function(e){var t=this.uploadConfigService.config.swayResources;switch(e){case a.a.FileTooLarge:return{title:t.errorTitle,type:e,message:this.locService.format(t.largeFile,this.localDataSizePipe.transform(this.swayConfig.uploadMaxFileSize))};case a.a.InvalidFileType:return{title:t.errorTitle,type:e,message:t.unsupportedFile};default:return{title:t.errorTitle,type:e,message:""}}},t.prototype.verifyFileForUpload=function(e){var t=p.a.getFileExtension(e.name.toLowerCase());return-1===this.swayConfig.uploadSupportedExtensions.indexOf(t)?Promise.reject(a.a.InvalidFileType):e.size>this.swayConfig.uploadMaxFileSize?Promise.reject(a.a.FileTooLarge):Promise.resolve()},t.prototype.uploadFile=function(e,t){var n=this,i=this.swayConfig.apiUrl+"/publishtosway/createstoryandpublishdocument";return new Promise((function(r,o){n.post("Sway_Create_Story_And_Publish_Document_Request","Sway_Create_Story_And_Publish_Document",i,e,(function(e){e.instrument((function(e,t){!e.ok||e.data&&e.data.pollingUrl||(t.HttpCode=s.a.UnexpectedResponse.toString()),n.instrumentResponse(e.headers,t)})).then((function(e){e&&e.data?r(e.data):o(a.a.Unknown)}))}),o,n.requestConfig,(function(e){return t.updateProgress(e.loaded)}),null,t.cancellationToken)}))},t.prototype.fetchAnalyticsForBatch=function(e,t){return this.swayGet("Sway_Get_Analytics_Request","Sway_Get_Analytics",this.buildUrlForAnalytics(e),t,"json",!0)},t.prototype.swayGet=function(t,n,r,o,a,l){var s=this;if(void 0===l&&(l=!1),l&&this.cachedResponsePromises.has(r,o))return this.cachedResponsePromises.get(r,o);var c=new Pro.requestConfig);d.responseType=a,e.prototype.get.call(s,t,n,r,(function(e){e.instrument((function(e,t){s.instrumentResponse(e.headers,t)})).then(c).catch((function(e){s.globalErrorHandler.handleError(e,"cwHpN")}))}),(function(e){l&&s.cachedResponsePromises.delete(r,o),u(e)}),d,o)}));return l&&this.cachedResponsePromises.set(c,r,o),c},t.prototype.buildUrlForAnalytics=function(e){var t=encodeURIComponent(e.join(","));return this.swayConfig.apiUrl+"/api/v1.0/batchanalytics?ids="+t},t.prototype.instrumentResponse=function(e,t){e&&(t.RequestId=e.get("X-CorrelationId"),t.PartnerGeo=e.get("X-OfficeCluster"))},t.ɵprov=k.kc({factory:function(){return new t(k.lc(C.a),k.lc(v.b),k.lc(u.a),k.lc(d.a),k.lc(m.a),k.lc(S.a),k.lc(I.q),k.lc(o.b),k.lc(w.a),k.lc(h.b),k.lc(l.a),k.lc(b.a),k.lc(c.a),k.lc(y.a))},token:t,providedIn:"root"}),t}(T.a)},m32Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("QjXU"),r=n("e3cR"),o=n("muUJ"),a=n("a3FV"),l=n("CMIS"),s=n("H2Bi"),c=n("WDeU");function u(e){var t,n,u=e.userId,d=e.collectionName,p=e.collectionVersion,f=e.key,h=e.hashKey,m=e.plugins,b=void 0===m?[]:m;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,m,g,v,S,y,C,w,T,k,I,_;return Object(i.__generator)(this,(function(A){switch(A.label){case 0:return A.trys.push([0,11,,12]),[4,Object(c.a)(u,d,p,f,h)];case 1:return m=i.__read.apply(void 0,[A.sent(),2]),g=m[0],v=m[1],[4,Object(r.c)(g,s.b,v)];case 2:if(!(e=A.sent()))return[2,null];A.label=3;case 3:A.trys.push([3,8,9,10]),S=Object(i.__values)(b),y=S.next(),A.label=4;case 4:return y.done?[3,7]:(C=y.value).onAfterReadValue?[4,C.onAfterReadValue(e,v,{userId:u,collectionName:d,collectionVersion:p})]:[3,6];case 5:e=A.sent(),A.label=6;case 6:return y=S.next(),[3,4];case 7:return[3,10];case 8:return w=A.sent(),k={error:w},[3,10];case 9:try{y&&!y.done&&(I=S.return)&&I.call(S)}finally{if(k)throw k.error}return[7];case 10:return[3,12];case 11:throw T=A.sent(),Object(o.a)(a.a.SimplePersistenceReadError,((_={}).Error="Error reading from ".concat(d,": ").concat(null===(t=null==T?void 0:T.toString)||void 0===t?void 0:t.call(T)),_)),Object(l.a)({eventName:"Simple_Persistence_Read_Error",errorType:"SimplePersistence_Error",message:"Error reading from ".concat(d,": ").concat(null===(n=null==T?void 0:T.toString)||void 0===n?void 0:n.call(T))}),T;case 12:return[2,e]}}))}))}},mNaV:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var i=n("QjXU"),r=n("Dn7E"),o=n("CMIS"),a=n("AlWG"),l=n("2dXW"),s=n("1zhX"),c=n("3Vsh"),u=n("cZRF"),d=n("hhzZ"),p=n("1Hgo"),f=n("7Gwk"),h=n("uzn7"),m=n("casz"),b=n("BMb5"),g=n("4/We"),v=n("cgnd"),S=n("3iMk"),y=n("IA5y"),C=function(){return function(){}}(),w=n("3XMr"),T=n("lrJm"),k=n("R7NL"),I=n("BaAg"),_=n("7ma0"),A=n("kpuN"),P=n("wwmn"),E=n("pOWU"),O=n("/I02"),F=n("uUrA"),D=n("ksTh"),M=n("keVe"),R=n("TOqr"),x=function(e){function t(t,n,i,r,o,a,l,s,c,u,d){var p=e.call(this,t,i,r,"Substrate",n,o,a,c)||this;p.globalErrorHandler=l,p.aadAppId=u,p.edgeworthConfigService=d,p.fetchRequestIndex=0,p.startupConfig=s.config;var f=p.edgeworthConfigService.config;if(f){var h="top="+f.recentItemsCount+"&"+D.c+p.contextService.sharedContext.officeMarket;p.endpoint=f.edgeworthS2SRecentEnabled?n.sharedContext.officeHomeApiRoot+"/api/ew/recent?"+h:""+f.substrateApiEndpoint+f.edgeworthApiRootPath+f.recentApiPath+"?"+h,f.userActionSortOrderEnabled&&(p.endpoint+="&order=UserActions")}return p}return Object(i.__extends)(t,e),t.prototype.fetchEdgeworthSubstrateRecent=function(e){var t=this;return this.cachedResponse||(this.cachedResponse=new Promise((function(n,i){var r=F.a.createGuid(),o=t.edgeworthConfigService.config.edgeworthS2SRecentEnabled?Object(y.b)(r):Object(y.a)(t.startupConfig.objectId+"@"+t.startupConfig.tenantId,t.contextService.sharedContext.recommendedIceApplicationId.toStrirvice.getCurrentPageForLogging()),a=e?Array.from(e.values()):[],l=new Set;a.forEach((function(e){var n=t.getRecentAppParam(e);e&&l.add(n)}));var s=l.size?Array.from(l.values()).join(","):"";t.get("EdgeworthSubstrateRecentRequest","EdgeworthSubstrateRecent",s?t.endpoint+"&apps="+s:t.endpoint,(function(e){e.instrument((function(e,n){var i;n.ActualSize=((null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.files)?e.data.files.length:-1).toString(),n.RequestId=t.getRequestIdFromResponse(e),n.DebugInfo=Object(y.f)(e),n.Index=(t.fetchRequestIndex++).toString(),n.ImpressionId=!!e.headers&&e.headers.get(D.a)||r})).then((function(e){n({data:t.parse(e.data),impressionId:!!e.headers&&e.headers.get(D.a)||r})})).catch((function(e){t.globalErrorHandler.handleError(e)}))}),i,o,"network-only",null,null,null,t.edgeworthConfigService.config.edgeworthS2SRecentEnabled?"OfficeHome":"Substrate")}))),this.cachedResponse},t.prototype.handleQueryParam=function(e,t,n){"mockmru"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.parse=function(e){var t=e.files?e.files.map((function(e){var t=e.user_relationship,n=e.activity_badge?Object(i.__assign)(Object(i.__assign)({},e.activity_badge),{timestamp:Object(y.j)(e.activity_badge.timestamp)}):void 0;return Object(i.__assign)(Object(i.__assign)({},e),{last_recommended_modified_datetime:e.last_recommended_modified_datetime,last_store_modified_datetime:e.last_store_modified_datetime,user_relationship:Object(y.i)(t),created_datetime:Object(y.j)(e.created_datetime),creation_info:e.creation_info?Object(i.__assign)(Object(i.__assign)({},e.creation_info),{timestamp:Object(y.j)(e.creation_info.timestamp)}):null,activity_badge:n,indexed:!1,server_last_recommended_modified_datetime:e.last_recommended_modified_datetime,server_last_store_modified_datetime:e.last_recommended_modified_datetime})})):[];return{diagnostics_data:e.diagnostics_data,files:t,is_complete:e.is_complete}},t.prototype.getRecentAppParam=function(e){switch(e){case I.b.Word:return"Word";case I.b.PowerPoint:return"PowerPoint";case I.b.Excel:return"Excel";case I.b.Video:case I.b.Stream:case I.b.StreamsVideo:return"Video";case I.b.Visio:case I.b.VisioSoftwareWac:case I.b.VisioBusinessWac:case I.b.VisioFlowChartWac:case I.b.VisioGeneralWac:case I.b.VisioNetworkWac:case I.b.VisioStartWac:return"Visio";default:return null}},t.ɵprov=M.kc({factory:function(){return new t(M.lc(A.b),M.lc(O.a),M.lc(d.a),M.lc(k.a),M.lc(P.a),M.lc(R.q),M.lc(T.b),M.lc(v.b),M.lc(m.a),M.lc(_.a),M.lc(p.a))},token:t,providedIn:"root"}),t}(E.a),L=n("S8t+"),U=.001,N=function(){function e(e,t,n,i,r,o,u,d,p,f,h,m,b,g){this.capabilitiesService=e,this.clientStartupConfigService=t,this.edgeworthDeltaSyncService=n,this.edgeworthRecentService=i,this.instrumentationService=r,this.windowService=o,this.localStorageService=u,this.edgeworthConfigService=d,this.scheduler=p,this.edgeworthUiTimestampService=f,this.eventService=h,this.ngZone=m,this.encryptionService=b,this.edgeworthLocalFilesService=g,this._allFilesMap=new Map,this._dataSource=new a.a(void 0),this._dataSourceObservable=this._dataSource.asObservable().pipe(Object(s.a)(1)),this._hasFailures=new l.a,this._hasFailuresObservable=this._hasFailures.asObservable().pipe(Object(c.a)(1)),this._isInitialStable=new l.a,this._isInitialStableObservable=this._isInitialStable.asObservable(),this.uiFeatureEnabled=this.capabilitiesService.capabilities.edgeworthEnabled,this.writeInProgress=null,this.writeScheduled=null,this.hasDoneBulkRead=!1,this.isTopCacheReadStable=!1,this.isBulkCacheReadStable=!1,this.isRecentFetchStable=!1,this.isSyncStable=!1,this.isInitialized=!1,this.dateProperties=new Set(["t","useractions_datetime","last_access_datetime","last_modified_datetime","last_shared_datetime","save_for_later_datetime","created_datetime","timestamp","last_action_datetime"]),this.secondaryFilesBuffer=[]}return Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSourceObservable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasFailures",{get:function(){return this._hasFailuresObservable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInitialStable",{get:function(){return this._isInitialStableObservable},enumerable:!0,configurable:!0}),e.prototype.doBulkRead=function(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,o,a,l,s,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(this.hasDoneBulkRead)return[2];this.loadLocalDocuments(),this.hasDoneBulkRead=!0,t={},n=!1,i.label=1;case 1:return i.trys.push([1,4,,5]),o=this.windowService.nativeWindow.performance.now(),[4,this.windowService.nativeWindow.ewIdb.readCache()];case 2:return a=i.sent(),l=Math.ceil(this.windowService.nativeWindow.performance.now()-o),[4,this.convertCacheEntriesToFiles(a)];case 3:return s=i.sent(),this.updateAllFiles(s,"Cached"),(n=s.length>0)&&(t.State="Succeeded",t.ActualSize=s.length.toString(),t.Latency=l.toString()),this.isBulkCacheReadStable=!0,this.updateIsStable(),[3,5];case 4:return c=i.sent(),t.State="Failed",t.Error=(null===(e=null==c?void 0:c.toString)||void 0===e?void 0:e.call(c))||"",n=!0,this.hasDoneBulkRead=!1,this.isBulkCacheReadStable=!0,this.updateIsStable(),[3,5];case 5:return n&&Math.random()<U&&(this.instrumentationService.logGenericEvent("EdgeworthBulkCacheRead",t),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthBulkCacheRead",params:t})),[2]}}))}))},e.prototype.startPeriodicSync=function(){var e=this;this.syncIntervalHandle&&this.clearPeriodicSync(),this.syncIntervalHandle=setInter,e.prototype.clearPeriodicSync=function(){this.syncIntervalHandle&&(clearInterval(this.syncIntervalHandle),this.syncIntervalHandle=void 0)},e.prototype.syncDocuments=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){return e=!1,this.isSyncStable=!1,this.shouldRebuildClientCache&&this.edgeworthDeltaSyncService.resetTimestamp(),[2,new Promise((function(n,r){t.edgeworthDeltaSyncService.syncDocuments().subscribe((function(n){var r;t.updateAllFiles(n.items,"Network"),e=e||n.hasPluginFailures,t.shouldRebuildClientCache&&(r=t.secondaryFilesBuffer).push.apply(r,Object(i.__spread)(n.items))}),(function(n){e=!0,t._hasFailures.next(!0),t.isSyncStable=!0,t.updateIsStable(),r()}),(function(){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this._hasFailures.next(e),this.isSyncStable=!0,this.updateIsStable(),this.shouldRebuildClientCache?[4,this.rebuildCache()]:[3,2];case 1:i.sent(),i.label=2;case 2:return[4,this.writeIntoCache()];case 3:return t=i.sent(),!e&&t&&this.edgeworthDeltaSyncService.markSyncCompleted(),this.scheduler.scheduleWork((function(){r.detectDuplicateFiles()}),4),n(),[2]}}))}))}))}))]}))}))},e.prototype.init=function(e){var t,n=this;if(!this.isInitialized){if(this.shouldRebuildClientCache=!this.isVisitWithinValidTimeWindow(),this.uiFeatureEnabled){var i={},o=!1;this.localStorageService.getGlobal(this.windowService.nativeWindow.ewPreloadUserIdStorageKey)===this.clientStartupConfigService.config.puid?this.windowService.nativeWindow.ewUserActionsPreloadData.then((function(e){return n.convertCacheEntriesToFiles(e)})).then((function(e){var t;if((null==e?void 0:e.length)>0){n.updateAllFiles(e,"Cached");var r=n.windowService.nativeWindow.ewUserActionsPreloadDuration;i.State="Succeeded",i.ActualSize=e.length.toString(),i.Latency=(null===(t=null==r?void 0:r.toString)||void 0===t?void 0:t.call(r))||"",o=!0}n.isTopCacheReadStable=!0,n.updateIsStable()})).catch((function(e){var t;i.State="Failed",i.Error=(null===(t=null==e?void 0:e.toString)||void 0===t?void 0:t.call(e))||"",o=!0,n.isTopCacheReadStable=!0,n.updateIsStable()})).then((function(){o&&Math.random()<U&&n.scheduler.scheduleWork((function(){n.instrumentationService.logGenericEvent("EdgeworthCacheRead",i),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthCacheRead",params:i})}),4)})):null===(t=this.windowService.nativeWindow.ewIdb)||void 0===t||t.initDb(this.clientStartupConfigService.config.puid)}var a=this.edgeworthRecentService.fetchEdgeworthSubstrateRecent(e).then((function(e){n.updateAllFiles(e.data.files,"Network"),n.writeIntoCache(!0),n.isRecentFetchStable=!0,n.updateIsStable()}),(function(e){n._hasFailures.next(!0),n.isRecentFetchStable=!0,n.updateIsStable()}));e?a.then((function(){return n.syncDocuments()})):this.syncDocuments(),this.isInitialized=!0}},e.prototype.updateIsStable=function(){this.isTopCacheReadStable&&this.isBulkCacheReadStable&&this.isRecentFetchStable&&this.isSyncStable&&(this._isInitialStable.next(),this._isInitialStable.complete())},e.prototype.updateAllFiles=function(e,t){var n,r,o,a,l,s,c,u=this,d=function(e){if(e.is_deleted)return p._allFilesMap.has(e.id)&&p._allFilesMap.delete(e.id),"continue";if(p.shouldIgnore(e))return"continue";var t=p._allFilesMap.get(e.id),n=Object(y.g)(e),r=null==n?void 0:n.getTime(),d=r?-r:0;if(t){var f=e.activities&&!t.activities||e.subject&&!t.subject||(null===(o=e.user_relationship)||void 0===o?void 0:o.last_shared_by_history)&&!(null===(a=t.user_relationship)||void 0===a?void 0:a.last_shared_by_history),h=e.last_store_modified_datetime>t.last_store_modified_datetime||e.last_recommended_modified_datetime>t.last_recommended_modified_datetime||(e.last_recommended_modified_datetime===t.last_recommended_modified_datetime||e.last_store_modified_datetime===t.last_store_modified_datetime)&&f,m=t,b=null===(l=e.data_source)||voi===t.type&&(null===(s=e.meeting_artifacts)||void 0===s||s.forEach((function(e){g.find((function(t){return e.id===t.id}))||(g.push(e),h=!0)}))),h){(m=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},t),e),{useractions_datetime:n,indexed:!1,useractions_datetime_inverse_time_in_ms:d,meeting_artifacts:g})).user_relationship.save_for_later_datetime=e.user_relationshvar v=null===(c=t.meetings)||void 0===c?void 0:c.filter((function(t){var n;return!(null===(n=e.meetings)||void 0===n?void 0:n.includes(t))}));v&&v.forEach((function(e){u._allFilesMap.delete(e)}))}b&&(m.mru_id=m.mru_id||e.mru_id,m.mru_type=m.mru_type||e.mru_type,m.mru_url=m.mru_url||e.mru_url,void 0!==e.is_pinned&&(m.is_pinned=e.is_pinned))}else"Mail"!==e.reference_type&&p._allFilesMap.set(e.id,Object(i.__assign)(Object(i.__assign)({},e),{indexed:!1,useractions_datetime:n,useractions_datetime_inverse_time_in_ms:d}))},p=this;try{for(var f=Object(i.__values)(e),h=f.next();!h.done;h=f.next())d(h.value)}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}this._dataSource.next({files:Array.from(this._allFilesMap.values()),source:t}),this.eventService.broadcastEvent({name:"edgeworthFilesUpdated",args:[this._allFilesMap.values()]})},e.prototype.writeIntoCache=function(e){return void 0===e&&(e=!1),Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){return this.uiFeatureEnabled?this.writeInProgress?(this.writeScheduled||(this.writeScheduled=this.writeInProgress.then((function(){return t.writeIntoCache(e)}))),[2,this.writeScheduled]):(this.writeScheduled=null,this.writeInProgress=new Promise((function(n){t.scheduler.scheduleWork((function(){!function(){Object(i.__awaiter)(t,void 0,void 0,(function(){var t,os,(function(d){switch(d.label){case 0:t={},o=Array.from(this._allFilesMap.values()).filter((function(e){return"LocalBridgeFile"!==e.source})),a=!1,d.label=1;case 1:return d.trys.push([1,7,,8]),this.encryptionService?[4,Promise.all(o.map((function(e){return new Promise((function(t,n){u.scheduler.scheduleWork((function(){var r=Object(i.__assign)(Object(i.__assign)({},e),{indexed:!1});u.ngZone.runOutsideAngular((function(){u.encryptionService.encryptData(r).then((function(e){return t({id:r.id,useractions_datetime:r.useractions_datetime,useractions_datetime_inverse_time_in_ms:r.useractions_datetime_inverse_time_in_ms,item:e})})).catch(n)}))}),4)}))})))]:[3,4];case 2:return l=d.sent(),[4,this.doWriteScheduled(l)];case 3:return d.sent(),[3,6];case 4:return[4,this.doWriteScheduled(o.map((function(e){return{id:e.id,item:Object(i.__assign)(Object(i.__assign)({},e),{indexed:!1}),useractions_datetime:e.useractions_datetime,useractions_datetime_inverse_time_in_ms:e.useractions_datetime_inverse_time_in_ms}})))];case 5:d.sent(),d.label=6;case 6:return this.localStorageService.setGlobal(this.windowService.nativeWindow.ewPreloadUserIdStorageKey,this.clientStartupConfigService.config.puid),t.State="Succeeded",[3,8];case 7:return s=d.sent(),t.State="Failed",t.Error=(null===(c=null==s?void 0:s.toString)||void 0===c?void 0:c.call(s))||"",t.DebugInfo="fromDeltaSync:"+e+", itemCount:"+o.length,a=!0,[3,8];case 8:return Math.random()<U&&(this.instrumentationService.logGenericEvent("EdgeworthCacheWrite",t),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthCacheWrite",params:t})),this.writeInProgress=null,n(!a),[2]}}))}))}()}),4)})),[2,this.writeInProgress]):[2]}))}))},e.prototype.shouldIgnore=function(e){var t;return!!("Image"===e.type&&Object(y.h)(e)||"ics"===e.extension||"spsite"===e.type||"WebLink"===e.type||"Link"===e.type||"LocalFile"===e.source&&(!Object(y.e)(Object(y.d)(e))||this.capabilitiesService.capabilities.isPwaInUwp)||"Video"===e.type&&0===(null===(t=e.id)||void 0===t?void 0:t.indexOf("STREAMS")))},e.prototype.doWriteScheduled=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=[],Object(S.a)(e,10,(function(e){t.push(new Promise((function(t,i){n.scheduler.scheduleWork((function(){n.ngZone.runOutsideAngular((function(){n.windowService.nativeWindow.ewIdb?n.windowService.nativeWindow.ewIdb.writeIntoCache(e).then(t).catch(i):i("Missing ewIdb, db version: "+n.windowService.nativeWindow.ewDbVersion)}))}),4)})))})),[4,Promise.all(t)];case 1:return i.sent(),[2]}}))}))},e.prototype.convertCacheEntriesToFiles=function(e){return Object(i.s,(function(n){return[2,this.ngZone.runOutsideAngular((function(){return Promise.all(e.map((function(e){return t.convertCachedEntry(e)})))}))]}))}))},e.prototype.convertCachedEntry=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e.item instanceof ArrayBuffer?(t=function(e,t){return n.dateProperties.has(e)?Object(y.j)(t):t},[4,this.encryptionService.decryptData(new Uint8Array(e.item),t)]):[3,2];case 1:return[2,i.sent()];case 2:return[2,e.item]}}))}))},e.prototype.isVisitWithinValidTimeWindow=function(){var e=this.edgeworthUiTimestampService.getLastUiSyncTimestamp();if(!e)return!0;var t=((new Date).getTime()-e.getTime())/864e5<=this.edgeworthConfigService.config.reindexThresholdInDays;return t||(this.instrumentationService.logGenericEvent("EdgeworthRebuildRequired"),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthRebuildRequired",params:{},area:"Edgeworth"})),t},e.prototype.rebuildCache=function(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(e){t.eventService.broadcastEvent({name:"edgeworthRebuildNeeded",args:[e]})}))];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,null===(e=window.ewIdb)||void 0===e?void 0:e.eraseStore()];case 3:return n.sent(),this._allFilesMap.clear(),this.updateAllFiles(this.secondaryFilesBuffer,"Network"),this.secondaryFilesBuffer.length=0,this.shouldRebuildClientCache=!1,this.instrumentationService.logGenericEvent("EdgeworthRebuildCompleted"),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthRebuildCompleted",params:{},area:"Edgeworth"}),[3,5];case 4:return n.sent(),this.instrumentationService.logErrorEvent("EdgeworthRebuildError"),Object(o.a)({eventName:"EdgeworthRebuildError",errorType:"Other"}),[3,5];case 5:return[2]}}))}))},e.prototype.detectDuplicateFiles=function(){var e,t=Array.from(this._allFilesMap.values()),n=0,i=new Set;if(t.forEach((function(e){var t=e.mru_id;t&&(i.has(t)?n++:i.add(t))})),n>0){var o=((e={}).ItemCount=n.toString(),e);this.instrumentationService.logGenericEvent("EdgeworthDuplicateFilesDetected",o),Object(r.a)({featureName:"Edgeworth",eventName:"EdgeworthDuplicateFilesDetected",params:o,area:"Edgeworth"})}},e.pthis.edgeworthLocalFilesService&&this.edgeworthLocalFilesService.getLocalMru().subscribe((function(t){e.updateAllFiles(t,"HwaLocalBridge")}))},e.ɵprov=M.kc({factory:function(){return new e(M.lc(g.a),M.lc(v.b),M.lc(w.a),M.lc(x),M.lc(d.a),M.lc(b.b),M.lc(h.a),M.lc(p.a),M.lc(m.a),M.lc(L.a),M.lc(f.a),M.lc(M.F),M.lc(u.a,8),M.lc(C,8))},token:e,providedIn:"root"}),e}()},mu6k:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l}));var i=n("keVe"),r=n("lrJm"),o=(n("W3Zz"),n("hZW2"),n("BMb5"),n("PBJH"),n("24t9")),a=function(){return function(e){this.templateRef=e}}(),l=function(){function e(e,t,n,r,o,a,l){this.deviceDetector=e,this.documentService=t,this.changeDetectorRef=n,this.locService=r,this.renderer=o,this.elementRef=a,this.windowService=l,this.leftAlignedCard=!1,this.multiSelect=!1,this.contextAriaLabel="",this.ariaRole="listitem",this.selectItem=new i.q,this.closeMenu=new i.q}return e.prototype.ngOnInit=function(){var e=this;this.focusActive=!1,this.closeByKey=!1,this.activeIndex=-1,this.menuItemClickHandler=function(t){e.elementRef.nativeElement.contains(t.target)||(e.mobileMenu&&t.preventDefault(),e.close())},this.animationState=this.mobileMenu?"openMobile":"open",this.open=!0,this.destroyed=!1,this.menuAriaLabel=this.locService.format(this.locService.MenuAriaLabel,this.contextAriaLabel),this.selectedIndex>=0&&(this.menuModel.items[this.selectedIndex].ariaChecked=!0),this.mobileMenu&&this.documentService.disableTouchMove()},e.prototype.ngAfterViewInit=function(){var e=this;if(1!==this.menuItems.length)throw new r.a("Must have exactly 1 *ohpMenuItemContent in a Menu as a child");this.menuItemTemplate=this.menuItems.first.templateRef,this.changeDetectorRef.detectChanges(),setTimeout((function(){if(e.deviceDetector.isDesktopDevice()){e.setActiveIndex(0,!0);var t=e.documentService.nativeDocument.activeElement;setTimeout((function(){var n=t.getBoundingClientRect();n.top+n.height>e.windowService.nativeWindow.innerHeight&&t.scrollIntoView()}),100)}e.destroyed||(e.menuItemClickListener=e.renderer.listen(e.documentService.nativeDocument,"click",e.menuItemClickHandler),e.menuItemTouchListener=e.renderer.listen(e.documentService.nativeDocument,"touchend",e.menuItemClickHandler),e.menuItemContextListener=e.renderer.listen(e.documentService.nativeDocument,"contextmenu",e.menuItemClickHandler),e.menuItemKeyListener=e.renderer.listen(e.documentService.nativeDocument,"keydown",(function(t){3===o.a.getKey(t)&&e.close(!0)})))}),0)},e.prototype.ngOnDestroy=function(){this.destroyed=!0,this.menuItemClickListener&&this.menuItemClickListener(),this.menuItemTouchListener&&this.menuItemTouchListener(),this.menuItemContextListener&&this.menuItemConListener(),this.documentService.enableTouchMove()},e.prototype.onAnimationCompleted=function(e){"closing"===e.toState&&this.completeClose()},e.prototype.onSelectItem=function(e,t,n){if(this.menuModel.announceItemIsSelected)if("radio"===this.ariaRole||"menuitemcheckbox"===this.ariaRole)if(this.multiSelect){var i=this.menuModel.items.find((function(t){return e.getId()===t.getId()}));i.ariaChecked=!i.ariaChecked}else this.menuModel.items.forEach((function(t){return t.ariaChecked=e.getId()===t.getId()}));else this.menuModel.items.forEach((function(t){return t.ariaSelected=e.getId()===t.getId()}));this.selectItem.emit({item:e,index:t,nativeDomEvent:n}),n.preventDefault(),this.multiSelect||this.close()},e.prototype.close=function(e){if(void 0===e&&(e=!1),!this.closed){if(this.closed=!0,this.closeByKey=e,this.animateClose)return void(this.animationState="closing");this.completeClose()}},e.prototype.handleKey=function(t){var n=o.a.getKey(t);if(-1!==e.expectedKeys.indexOf(n))if(t.preventDefault(),2===n&&this.activeIndex>=0)this.onSelectItem(this.menuModel.items[this.activeIndex],this.activeIndex,t);else{var i=this.menuModel.items.length-1;switch(n){case 1:case 3:this.close(!0);break;case 4:this.focusActive=!0,this.setActiveIndex(this.activeIndex>0?this.activeIndex-1:i);break;case 5:this.focusActive=!0,this.setActiveIndex((this.activeIndex+1)%(i+1))}}},e.prototype.setActiveIndex=function(e,t){var n=this;if(t&&(this.focusActive=!0),this.activeIndex=e,this.focusActive){var i=this.dropdownItemstem(n.menuModel.items[)}},e.prototype.getIdForItem=function(e){return this.menuModel.id+"-item--"+e.getId()},e.prototype.trackById=function(e,t){return t.getId()},e.prototype.completeClose=function(){this.open=!1,this.documentService.enableTouchMove(),this.closeMenu.emit(this.closeByKey),this.closeByKey=!1},e.expectedKeys=[1,2,3,4,5],e}()},muUJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("8/lW"),r=n("a3FV"),o=n("4CZh");function a(e,t,n,a){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===a&&(a=i.a.Security),Object(o.b)(e,r.a.AppError,a,t,n,!0)}},n826:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var i=n("QjXU"),r=n("3Vsh"),o=n("lrJm"),a=n("3GGT"),l=n("hhzZ"),s=n("R7NL"),c=n("BaAg"),u=n("4/We"),d=n("/I02"),p=n("ZBli"),f=n("pjz5"),h=n("kpuN"),m=n("oAX+"),b=n("uzn7"),g=n("keVe"),v=function(){function e(e,t){this.storageService=e,this.capabilitiesService=t}return e.prototype.makeRequest=function(e,t,n,i,r,o){var a=this;if(this.capabilit){var l=this.getKey(e),c=!0;s&&s+1e3*t>=Date.now()&&(c=!1);var u=function(){a.storageService.set(l,Date.now())};if(c){var d=i().then((function(e){return e&&u(),e}));return m.a.createResultsWithCacheObservable(n(),d,r,o)}return m.a.createResultsCacheFirstObservable(n,i,u,r,o)}return m.a.createResultsWithCacheObservable(n(),i(),r,o)},e.prototype.getKey=function(e){return"network_ts_"+e},e.ɵprov=g.kc({factory:function(){return new e(g.lc(b.a),g.lc(u.a))},token:e,providedIn:"root"}),e}(),S=n("pd4Y"),y=n("aQ3G"),C=n("wwmn"),w=(n("Dpxn"),n("casz")),T=n("Brer"),k=n("pOWU"),I=n("TOqr"),_=function(e){function t(t,n,i,r,o,a,l,s,c,u,d,p){var f=e.call(this,n,i,r,o,a,l,s,d)||this;return f.capabilitiesService=t,f.dateService=c,f.vroomService=u,f.cachedRequestService=p,n.reauthComplete.subscribe((function(){f.myDriveRootAuthErrorCached&&(f.myDriveRootUrlStream=null,f.myDriveRootUrlPromise=null)})),f}return Object(i.__extends)(t,e),t.prototype.getItemWithIds=function(e,t,n,i,r,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1);var l=this.getItemLocation(e,t),s=n?"?$select="+n:"",c=this.inMockMode?l+"?currentDate="+this.dateService.getCurrentDateMinuteGranularity().toISOString():""+l+s;return this.getOneDriveItem("OneDrive_Graph_Item_Request","OneDrive_Graph_Item",c,i,r,o,null,a)},t.prototype.getMyDrive=function(){return this.getGraph("OneDrive_Graph_Drive_Request","OneDrive_Graph_Drive",""+t.myDriveEndpoint,"network-only").then((function(e){return e.data}))},t.prototype.getMyDriveRootUrl=function(e){var t=this;if(void 0===e&&(e=0),!this.capabilitiesService.capabilities.oneDriveApisEnabled)return Promise.resolve(null);if(!this.myDriveRootUrlPromise){var n=new Promise((function(n,i){var o=t.getMyDriveRootUrlStream(e);o.results.pipe(Object(r.a)(1)).toPromise().then((function(e){e&&e.userRoot?n(e):i("No/Incomplete data returned.")})),o.initialCompletion.then((function(e){e&&(t.globalErrorHandler.handleCacheObservableError(e,"Evsnp","SiCWx"),e.cacheError&&e.networkError&&i(e))}))}));this.myDriveRootAuthErrorCached=!1,this.myDriveRootUrlPromise=n}return this.myDriveRootUrlPromise},t.prototype.getMyDriveRootUrlStream=function(e){var t=this;if(void 0===e&&(e=0),this.myDriveRootUrlStream)return this.myDriveRootUrlStream;var n=this.cachedRequestService.makeRequest("my-drive-rInSeconds,(function(){return t.getMyDriveRootUrlInternal("cache-only",e)}),(function(){return t.getMyDriveRootUrlInternal("network-first",e)}),null,(function(e){e&&e.httpResponse&&(401===e.httpResponse.status||e.httpResponse.status===a.a.TokenUnavailable&&"CAP_Error"===e.httpResponse.data)?t.myDriveRootAuthErrorCached=!0:(t.myDriveRootUrlStream=null,t.myDriveRootUrlPromise=null)}));return this.myDriveRootAuthErrorCached=!1,this.myDriveRootUrlStream=n,this.myDriveRootUrlStream},t.prototype.getSiteTitle=function(e){var n=this,i=""+t.sitesEndpoint+e;return this.getGraph("Get_Site_Title_Request","Get_Site_Title",i,"cache-only",null,!0,null,null,null,!1,"json",0).then((function(e){var t;return null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.displayName-first",null,!0,null,null,null,!1,"json",0).then((function(e){var t;return null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.displayName}))}))},t.function(e){return this.getGraph("File_Version_List_Fetch","File_Version_List_Fetch",e,"network-only").then((function(e){return e.data.value}))},t.prototype.getSharedItemWithThumbnail=function(e,t,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.getSharedItemWithParams(e,t,n,T.a.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!0),i,o,a)},t.prototype.getSharedItemWithoutThumbnail=function(e,t,n,i,r,o,a,l){return void 0===o&&(o="open"),void 0===a&&(a=!1),void 0===l&&(l=0),this.getSharedItemWithParams(e,t,n,T.a.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!1,"",o),i,a,l)},t.prototype.getSharedItemWithThumbnailAndIds=function(e,t,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.getSharedItemWithParams(e,t,n,T.a.getItemParams(["sharepointIds"],r,!0),i,o,a)},t.prototype.getItemWithWacDataAndThumbnails=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=0);var r=this.getItemLocation(e.driveId,e.docId),o=T.a.getItemParams([],!0,!0);return this.getOneDriveItem("OneDrive_Graph_Item_With_Wac_Data_And_Thumb_Request","OneDrive_Graph_Item_With_Wac_Data_And_Thumb",r+"?"+o,t,null,null,i,n)},t.prototype.getItemWithWacData=function(e,t,n,i,r,o,a){void 0===r&&(r="open"),void 0===o&&(o=!1),void 0===a&&(a=0);var l=this.getItemLocation(t,n),s=T.a.getItemParams([],!0,!1,"",r);return this.getOneDriveItem("OneDrive_Graph_Item_With_Wac_Data_Request","OneDrive_Graph_Item_With_Wac_Data",l+"?"+s,i,null,null,a,o)},t.prototype.getThumbnailsForItem=function(e,t,n,i){var r=this;void 0===i&&(i=0);var o=this.getItemLocation(e,t)+"/thumbnails";return"network-first"===n?this.getThumbnails("OneDrive_Graph_Thumbnail_Request","OneDrive_Graph_Thumbnail",o,"cache-only",i).catch((function(){return r.getThumbnails("OneDrive_Graph_Thumbnail_Request","OneDrive_Graph_Thumbnail",o,"network-first",i)})):this.getThumbnails("OneDrive_Graph_Thumbnail_Request","OneDrive_Graph_Thumbnail",o,n,i)},t.prototype.getThumbnailString=function(e){var t=this,n=new FileReader;return new Promise((function(i,r){t.getGraph("OneDrive_Graph_Thumbnail_String_Request","OneDrive_Graph_Thumbnail_String",e,"network-only",(function(e,n){n.RequestId=t.getRequestIdFromResponse(e)}),!0,null,null,null,!1,"blob",0).then((function(e){if(e&&e.status&&406===e.status){var o={};o.RequestId=t.getRequestIdFromResponse(e),o.HttpCode=e.status.toString(),o.DebugInfo=null==e.statusText?"":e.statusText,t.instrumentationService.logDebugCacheEvent("OneDrive_Graph_Thumbnail_String_Request",o)}e&&e.data?(n.onloadend=function(){var e=n.result&&"string"==typeof n.result&&n.result||"";e.length>0?i(e):r()},n.onerror=r,n.onabort=r,n.readAsDataURL(e.data)):r()})).catch((function(e){t.globalErrorHandler.handleError(e,"AfEUN"),r()}))}))},t.prototype.createNewFile=function(e,n,i){var r=this;void 0===i&&(i=!1);var o=t.myDriveEndpoint+"root/children?select=webDavUrl,"+(i?"openwith,":"")+"*",l={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},s=new Map([["accept","application/json"],["Prefer","allow-zerobyte"],["application","officehome"]]);return new Promise((function(e,t){r.postGraph("OneDrive_Graph_Create_File_Request","OneDrive_Graph_Create_File",o,l,(function(n){n.instrument((function(e,t){if(t.RequestId=r.getRequestIdFromResponse(e),e.ok){var n=e.data;n&&n.id&&n.webUrl||(t.HttpCode=a.a.UnexpectedResponse.toString())}})).then((function(n){var i=n.data;i&&i.id&&i.webUrl?e(i):t(new k.b(n,"Could not parse drive item from Graph response"))})).catch((function(e){r.globalErrorHandler.handleError(e,"MCFQq")}))}),(function(e){e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()}),null,null,null,null,!1,!0,{category:"CreateFile",fileType:n},s)}))},t.prototype.renameFile=function(e,n,i){var r,o=this;r=i?this.getItemLocation(i,n):t.myDriveEndpoint+"items/"+n;var l={name:e},s=this.getRequestConfig();return s.headers.set("Content-Type","application/json"),new Promise((function(e,t){o.patchGraph("Document_Title_Rename_File","Document_Title_Rename_File",r,JSON.stringify(l),(function(n){n.instrument((function(e,t){if(t.RequestId=o.getRequestIdFromResponse(e),e.ok){var n=e.data;n&&n.id&&n.webUrl||(t.HttpCode=a.a.UnexpectedResponse.toString())}})).then((function(n){var i=n.data;i&&i.id&&i.webUrl?e(i):t(new k.b(n,"Could not parse drive item from Graph response"))}))}),(function(e){e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()}),s,null,null,null,null,void 0,null)}))},t.prototype.getDownloadUrl=function(e){return e&&e.itemId&&e.driveId?this.getItemWithIds(e.driveId,e.itemId,"id,content.downloadUrl","network-only").then((function(e){return e["@microsoft.graph.downloadUrl"]?p.a.removeQueryParams(e["@microsoft.graph.downloadUrl"],["tempAuth","ApiVersion"],!1):Promise.reject("Missing downloadUrl")})):Promise.reject("Invalid params")},t.prototype.uploadFile=function(e,n,i,r,o,a,l){var s=this;return new Promise((function(c,u){e&&e.name||u(new k.b(null,"Invalid file"));var d=s.vroomService.getUploadLocation(t.myDriveEndpoint,e,i,r)+"content?@microsoft.graph.conflictBee_Request","OneDrive_Graph_Upload_File",d,e,(function(t){t.instrument((function(t,i){return s.vroomService.instrumentUploadResponse(t,i,e,n)})).then((function(e){var t=e.data;t&&t.id?c(t):u(new k.b(e,"Could not parse drive item from Graph response"))})).catch((function(e){s.globalErrorHandler.handleError(e,"NWgrO")}))}),u,o,null,a,l)}))},t.prototype.createUploadSession=function(e,n,i,r,o){var a=this;return new Promise((function(l,s){e&&e.name||s(new k.b(null,"Invalid file"));var c=a.vroomService.getUploadLocation(t.myDriveEndpoint,e,i,r)+"createUploadSession";a.postGraph("OneDrive_Graph_Create_Upload_Session_Request","OneDrive_Graph_Create_Upload_Session",c,{item:{"@microsoft.graph.conflictBehavior":"rename"}},(function(t){t.instrument((function(t,i){if(a.vroomService.instrumentUploadResponse(t,i,e,n),t.ok){var r=t.data;i.Length=r&&r.uploadUrl?r.uploadUrl.length.toString():"0"}})).then((function(e){var t=e.data;t&&t.uploadUrl?l(t):s(new k.b(e,"Could not parse upload session from Graph response"))})).catch((function(e){a.globalErrorHandler.handleError(e,"Nt3wB")}))}),s,null,null,o)}))},t.onInternal(e,t,n,"Graph")},t.prototype.uploadFragment=function(e,t,n,i,r,o,a,l,s){return this.vroomService.uploadFragment(e,t,n,i,r,o,a,l,s)},t.prototype.getUploadSessionStatus=function(e,t,n){return this.vroomService.getUploadSessionStatusInternal(e,ot=function(e,t){return void 0===t&&(t=0),this.getMyDriveItem("root",e,t)},t.prototype.isRetriableError=function(e){return e===a.a.Throttled},t.prototype.handleQueryParam=function(t,n,i){e.prototype.handleQueryParam.call(this,t,n,i),"mockonedrive"===t&&this.mockRequestHeader&&(null==i||i.headers.set(this.mockRequestHeader,n))},t.prototype.getSharedItemWithParams=function(e,t,n,i,r,o,a){var s=this;return void 0===o&&(o=!1),void 0===a&&(a=0),new Promise((function(u,d){var p=s.vroomService.getSharesUrl(e);if(p){var h=s.inMockMode?"shares?itemUrl="+encodeURIComponent(p)+"&currentDate="+s.dateService.getCurrentDateMinuteGranularity().toISOString():p+(i?"?"+i:""),m=i.includes("openwith");s.getOneDriveItem(m?"OneDrive_Graph_Shares_With_Wac_Data_Request":"OneDrive_Graph_Shares_Request",m?"OneDrive_Graph_Shares_With_Wac_Data":"OneDrive_Graph_Shares",h,r,(function(i,r){if(i.ok){var o=i.data,a=o?o.thumbnails:null;r.ItemCount=(a?a.length:0).toString()}var u=f.a.getLocation(e);if(u&&u.protocol&&u.host){var d=u.protocol+"//"+u.host;r.ResourceUrl=new l.d(d),r.ItemIsShared=(!(d===s.contextService.sharedContext.sharePointResourceId||d===s.contextService.sharedContext.oneDriveResourceId)).toString()}r.ItemCategory=c.a.referralFromFileLocation(e),r.DocumentType=c.b[t],n&&(r.FileFormat=n)}),!1,a,o).then(u,d)}else d(new k.b(null,"Unable to parse share id"))}))},t.prototype.getItemLocation=function(e,n){return""+t.drivesEndpoint+encodeURIComponent(e)+"/items/"+encodeURIComponent(n)},t.prototype.getMyDriveItem=function(e,n,i){return this.getOneDriveItem("OneDrive_Graph_Item_Request","OneDrive_Graph_Item",""+t.myDriveEndpoint+e,n,null,!1,i)Item=function(e,t,n,i,r,o,a,l){return void 0===o&&(o=!1),void 0===a&&(a=0),void 0===l&&(l=!1),this.getGraph(e,t,n,i,(function(e,t){r&&r(e,t)}),!0,null,null,null,o,"json",a,l).then((function(e){return e.data}))},t.prototype.getThumbnails=function(e,t,n,i,r){void 0===r&&(r=0);var o=this.inMockMode?"thumbnails?itemUrl="+encodeURIComponent(n):n;return this.getGraph(e,t,o,i,(function(e,t){if(e.ok){var n=e.data,i=(n&&n.value?n.value.length:0).toString();t.ItemCount=i}}),!0,null,null,null,!1,"json",r).then((function(e){return e.data}))},t.prototype.getMyDriveRootUrlInternal=function(e,t){var n=this;return this.getMyDriveRoot(e,t).then((function(t){return n.vroomService.getRootUrlsFromRootItem(t,e)}))},t.myDriveEndpoint="me/drive/",t.drivesEndpoint="drives/",t.sitesEndpoint="sites/",t.itemsEndpoint="items/",t.ɵprov=g.kc({factory:function(){return new t(g.lc(u.a),g.lc(h.b)(){return r})),n.d(t,"c",(function(){return o}));var i="/Pages/MobileDesignPage.aspx",r="/Pages/DesignPage.aspx",o="/Pages/DesignPageV2.aspx"},"oAX+":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("SQAW"),r=n("Tc/Q"),o=n("1zhX"),a=function(){function e(){}return e.createResultsWithCacheObservable=function(e,t,n,a,l){var s,c=new Promise((function(n){s=i.a.create((function(i){var r=null,o=!1,s=null,c=!1,u=!1,d=function(){l&&s&&r&&i.next(l),n(s||r?{cacheError:s,networkError:r}:null),i.complete()};e&&e.then((function(e){u=!0,e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!0),i.next(e),o&&d()})).catch((function(e){s=e,c=!0,o&&d()})),t&&t.then((function(e){e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!1),i.next(e),d()})).catch((function(e){r=e,o=!0,a&&a(e),(u||c)&&d()}))}))}));return n&&(s=s.pipe(Object(r.a)(n))),{results:s=s.pipe(Object(o.a)(1)),initialCompletion:c}},e.createResultsCacheFirstObservable=function(e,t,n,a,l){var s,c=new Promise((function(r){s=i.a.create((function(i){var o=null,a=null,s=function(){r(a||o?{cacheError:a,networkError:o}:null),i.complete()};e&&e().then((function(e){e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!0),i.next(e),s()})).catch((function(e){a=e,t().then((function(e){e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!1),n(),i.next(e),s()})).catch((function(e){o=e,l&&l(e),s()}))}))}))}));return a&&(s=s.pipe(Object(r.a)(a))),{results:s=s.pipe(Object(o.a)(1)),initialCompletion:c}},e}()},"oHg+":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("keVe"),r=n("BMb5"),o=n("QjXU"),a=n("TOqr"),l=new i.u("CRYPTO_API_AVAILABLE",{providedIn:"root",factory:function(){return function(e,t){var n,i;if(!Object(a.t)(t))return!1;var r=e.nativeWindow.crypto;if(!r)return!1;if(!r.getRandomValues)return!1;var l=r.subtle;if(!l)return!1;try{for(var s=Object(o.__values)(["encrypt","decrypt","importKey","digest"]),c=s.next();!c.done;c=s.next())if(!(c.value in l))return!1}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{ifine",e.Project="Project",e.SharePoint="Sites",e.Skype="Skype",e.Sway="Sway",e.Visio="VisioOnline",e.Word="WordOnline",e.PowerBI="PowerBIv2",e}()},p6gk:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("QjXU"),r=n("SQAW"),o=n("lrJm"),a=n("hhzZ"),l=nn("wwmn"),h=n("casz"),m=n("pOWU"),b=n("keVe"),g=n("TOqr"),v=function(e){function t(t,n,i,r,o,a,l,s){return e.call(this,t,n,i,r,o,a,l,s)||this}return Object(i.__extends)(t,e),t.prototype.createNewNotebook=function(e){var n=this,i=t.myOneNoteEndpoint+"notebooks",r={displayName:e};return new Promise((function(e,t){n.postGraph("OneNote_Graph_Create_NoteBook_Request","OneNote_Graph_Create_NoteBook",i,r,(function(i){i.instrument((function(e,t){t.RequestId=n.getRequestIdFromResponse(e)})).then((function(n){var i=n.data;i&&i.links&&i.links.oneNoteWebUrl?e(i):t(new m.b(n,"Could not parse notebook item from Graph response"))})).catch((function(e){n.globalErrorHandler.handleError(e,"vFlcr")}))}),(function(e){e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()}),null,null,null,null,null,!0,{category:"CreateFile",fileType:s.b.OneNote})}))},t.prototype.getNoteBooks=function(e){var t=this;if("stale-while-revalidate"===e){var n=this.fetchNoteBooks("cache-only"),i=this.fetchNoteBooks("network-first");return u.a.createResultsWithCacheObservable(n,i)}return"cache-first-network-onmiss"===e?{results:r.a.create((function(e){t.fetchNoteBooks("cache-only").then((function(t){e.next(t),e.complete()})).catch((function(){t.fetchNoteBooks("networ),e.complete()}))}))})),initialCompletion:null}:{results:r.a.create((function(n){t.fetchNoteBooks(e).then((function(e){n.next(e),n.complete()}))})),initialCompletion:null}},t.prototype.fetchNoteBooks=function(e){var n=this;return this.getGraph("OneNote_Graph_Get_NoteBooks_Request","OneNote_Graph_Get_%20desc",e,(function(e,t){t.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){return Object.assign(e.data,{fromCache:e.fromCache})}))},t.prototype.handleQueryParam=function(e,t){"mockgetnotebooks"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)},t.myOneNoteEndpoint="me/onenote/",t.ɵprov=b.kc({factory:function(){return new t(b.lc(d.b),b.lc(a.a),b.lc(l.a),b.lc(c.a),b.lc(f.a),b.lc(g.q),b.lc(o.b),b.lc(h.a))},token:t,providedIn:"root"}),t}(p.a)},p6wn:function(e,t,n){"usehzZ"),c=function(){functiame=t,this.params=n,this.metrics=i,this.securityThreshold=r}return e.prototype.record=function(){this.instrumentationService.recordEvent(this)},e}(),u=function(){function e(e,t,n){this.queuedEvents=e,this.dataSecurityService=t,this.deviceDetector=n,this.registeredEventFactories=[],this.initialPage="Unknown",this.serviceWorkerStateService=null,this.lastPageNav={time:0,from:void 0,to:void 0}}return e.prototype.registerServiceWorkerStateService=function(e,t){var n=this;if(this.serviceWorkerStateService)throw new r.a("DispatcherInstrumentationService.registerServiceWorkerStateService is not allowed to be called more than once");if(!e)throw new r.a("Must specify valid ServiceWorkerStateService workerStateService=e,t&&this.queuedEvents.forEach((function(e){return e.eventParams.ServiceWorkerState=n.serviceWorkerStateService.currentState}))},e.prototype.registerOfficeRouteService=function(e){var t=this;if(this.routeSubscriptionInitialized)throw new r.a("DispatcherInstrumentationService.registerOfficeRouteService is not allowed to be called more than once");if(!e)throw new r.a("Must specify valid OfficeRouteService when calling DispatcherInstrumentationService.registerOfficeRouteService");this.routeSubscriptionInitialized=!0,e.subscribeToRouteChangeStart((function(e){var n=!!e.currentRoute&&!!e.currentRoute.route,i=n?""+(e.currentRoute.app?o.b[e.currentRoute.app]:"")+e.currentRoute.route:"Unknown";t.lastPageNav={time:l.a.now(),from:t.lPage&&"Unknown"!==i&&(t.idEvents.forEach((function(e){return e.eventParams.Page=i})),t.queuedEvents.forEach((function(e){return e.eventParams.InitialPage=t.initialPage})),t.queuedEventsPopulatedWithRoute=!0)}))},e.prototype.registerEventFactories=function(e){if(this.registeredEventFactories.length>0)throw new r.a("DispatcherInstrumentationService.registerEventFactories is not allowed to be called more than once");if(!e||0===e.length)throw new r.a("Must specify at least one event factory when calling DispatcherInstrumentationService.registerEventFactories");this.registeredEventFactories=e.slice(),this.drainQueuedEvents()},e.prototype.logGenericEvent=function(e,t,n,i){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=0),this.generateEvent(e,"Generic_Event",i,t,n,!0)},e.prototype.logImpressionEvent=function(e,t,n,i){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=0),this.generateEvent(e,"Generic_Impression",i,t,n,!0)},e.prototype.logRequestEvent=function(e,t,n,i,r,o,a,l){void 0===r&&(r=!1),void 0===o&&(o={}),void 0===a&&(a=[]),void 0===l&&(l=0),this.generateRequestEvent(e,t,n,i,r,o,a,l).record()},e.prototype.logClickEvent=function(t,n,r,o,a,s,c,u,d){if(void 0===s&&(s={}),void 0===c&&(c=[]),void 0===u&&(u=0),void 0===d&&(d=!1),c=c||[],r&&n&&"Unknown"!==n&&c.push(t+"."+r+"."+n),s.ElementId=n,o){var p=Object(i.a)(o);s.Referral=p,c.push("Referral."+p),s.ReferralPlatform=a&&this.dataSecurityService.securityLevel>=2?a:"Web"}r&&(s.Area=r),d&&this.lastPageNav&&this.lastPageNav.from&&l.a.now()-this.lastPageNav.time<e.lastPageNavTimeout&&(s.Page=this.lastPageNav.from),this.generateEvent(t,"Generic_Click",u,s,c,!0)},e.prototype.logErrorEvent=function(e,t,n,i){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=0),this.generateEvent(e,"App_Error",i,t,n,!0)},e.prototype.logPerformanceEvent=function(e,t,n,i){return void 0===n&&(n={}),void 0===i&&(i=0),n.Latency=t.toString(),this.generateEvent(e,"Performance_Dump",i,n,[],!0)},e.prototype.logDebugCacheEvent=function(e,t,n,i){return void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=0),this.generateEvent(e,"Generic_Debug_Cache_2",i,t,n,!0)},e.prototype.applyGlobalStateParams=function(e,t){window.prelaunchMode&&(e.PrelaunchMode="true"),!t&&e.hasOwnProperty("Page")||(e.Page=this.lastPageNav.to||"Unknown"),!t&&e.hasOwnProperty("InitialPage")||(e.InitialPage=this.initialPage),!t&&e.hasOwnProperty("ServiceWorkerState")||(e.ServiceWorkerState=this.serviceWorkerStateService?this.serviceWorkerStateService.currentState:"Unknown"),!t&&e.hasOwnProperty("AppSecurityLevel")||(e.AppSecurityLevel=this.dataSecurityService.securityLevel.toString()),!t&&e.hasOwnProperty("NetworkType")||(e.NetworkType=a.d[this.deviceDeg=window.ringId)},e.prototype.flush=function(){this.drainQueuedEvents(),this.registeredEventFactories.forEach((function(e){return e.flush()}))},e.prototype.recordEvent=function(e){var t=e&&e.params&&(e.params.EventName&&e.params.EventName.indexOf("Error")>-1||e.params.Error&&"OK"!==e.params.Error);this.dataSecurityService.securityLevel<e.securityThreshold||window.disableLogs&&!t||(this.registeredEventFactories.length>0?this.registeredEventFactories.forEach((function(t){return t.createEvent(e.streamName,e.params,e.metrics).record()})):this.queuedEvents.push({streamName:e.streamName,eventName:e.params.EventName,eventParams:e.params,metrics:e.metrics,securityThreshold:e.securityThreshold}))},e.prototype.generateEvent=function(e,t,n,i,r,o){void 0===r&&(r=[]),void 0===o&&(o=!1),i.EventName=e,this.applyGlobalStateParams(i,!1);var a=i&&i.Error;a&&"string"==typeof a&&(i.Error=s.a.filterPii(a));var l=i&&i.DebugInfo;l&&"string"==typeof l&&(i.DebugInfo=s.a.filterPii(l)),"Performance_Dump"===t&&void 0!==window.startedFromServiceWorker&&(i.CachedPage=window.startedFromServiceWorker.toString()),"Generic_Click"===t&&(i.ReportingEnabled=window.isMetricsReportingEnabled?window.isMetricsReportingEnabled.toString():"false");var u=new c(this,t,i,r,n);return o&&u.record(),u},e.prototype.generateRequestEvent=function(e,t,n,i,r,o,a,l){return void 0===r&&(r=!1),void 0===o&&(o={}),void 0===a&&(a=[]),void 0===l&&(l=0),o.HttpCode=t.toString(),o.Latency=n.toString(),o.FromServiceWorkerCache=r.toString(),i&&(o.Error=i),this.generateEvent(e,"Generic_Request",l,o,a)},e.prototype.drainQueuedEvents=function(){var e=this;this.queuedEvents&&this.queuedEvents.splice(0,this.queuedEvents.length).forEach((function(t){e.generateEvent(t.eventName,t.streamName,t.securityThreshold,t.eventParams||{},t.metrics,!0)}))},e.lastPageNavTimeout=1e3,e}()},pM41:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("TfV2"),r=n("ZBSS"),o=n("GMuP"),a=n("Cin9");function l(e,t){void 0===t&&(t=i.a.Security),Object(a.a)({eventName:e.eventName,latency:e.latency},t),e.instrumentationParams&&Object.keys(e.instrumentationParams).length>0&&(e.instrumentationParams[r.V]=e.latency,Object(o.a)({eventName:e.eventName,params:e.instrumentationParams,area:e.area,subArea:e.subArea},t))}},,"a",(function(){return l}));var i=n("tyUq"),r=n("3GGT"),o=n("pjz5"),a=function(){return function(e,t){this.httpResponse=e,this.clientError=t}}(),l=function(){function e(e,t,n,i,r,a,l,s,c){void 0===c&&(c=""),this.accessTokenService=e,this.instrumentationService=t,this.instrumentedHttp=n,this.tokenConsumer=i,this.contextService=r,this.officeHomeApiConfigService=a,this.scheduler=s,this.rpsCompactAuthHeaderPrefix=c,this.retryIntervalsInMs=[0,11,22,33],this.inMockMode=r.sharedContext.inMockMode,this.mockRequestHeader=a.config.mockRequestHeader,this.queryParams=o.a.getQueryParams(l.search)}return e.getErrorTypeFromServiceError=function(e){switch(e&&e.httpResponse&&e.httpResponse.status){case r.a.OK:case r.a.Created:case r.a.NoContent:return"None";case r.a.Unauthorized:case r.a.Forbidden:case r.a.TokenRefreshFailed:case r.a.TokenUnavailable:return"Unauthorized";case r.a.NotFound:return"NotFound";case r.a.RequestatewayTimeout:case r.a.Timeout:return"Timeout";case r.a.Offline:return"Offline"}return"Generic"},e.prototype.handleQueryParam=function(e,t,n){},e.prototype.get=functionche-only"===a&&(u="None"),this.scheduler.scheduleWork((function(){return f.request((function(i){return f.instrumentedHttp.get(e,t,n,i,a,l,s,c)}),e,t,i,r,o,u,d,null,"cache-only"===a,void 0,void 0,n)}),p)},e.prototype.getFromCache=function(e,t,n,i,r,o){void 0===o&&(o={}),this.get(e,t,n,i,r,o,"cache-only",null,null,null,"None")},e.prototype.post=function(e,t,n,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g){var v=this;void 0===a&&(a={}),void 0===m&&(m=!1),void 0===b&&(b=null),void 0===g&&(g=0),"cache-only"===h&&(d="None"),this.scheduler.scheduleWork((function(){return v.request((function(r){return v.instrumentedHttp.post(e,t,n,i,r,l,s,c,u,h)}),e,t,r,o,a,d,p,f,!1,m,b,n)}),g)},e.prototype.put=function(e,t,n,i,r,o,a,l,s,c,u,d,p){var f=this;void 0===a&&(a={}),this.request((function(r){return f.instrumentedHttp.put(e,t,n,i,r,l,s,c,u)delete=function(e,t,n,i,r,o,a,l,s,c,u){var d=this;void 0===a&&(a={}),this.request((function(r){return d.instrumentedHttp.delete(e,t,n,i,r,l,s)}),e,t,r,o,a,c,u,void 0,void 0,void 0,void 0,n)},e.prototype.patch=function(e,t,n,i,r,o,a,l,s,c,u,d,p){var f=this;void 0===a&&(a={}),this.request((function(r){return f.instrumentedHttp.patch(e,t,n,i,r,l,s,c,u)}),e,t,r,o,a,d,p,void 0,void 0,void 0,void 0,n)},e.prototype.isAuthErrn 401===e||403===e&&"OfficeHome"===t&&this.officeHomeApiConfigService.config.jwtAuthEnabled},e.prototype.isRetriableError=function(e){return!1},e.prototype.getRetryInterval=function(){var e=Math.floor(1e3*Math.random())%this.retryIntervalsInMs.length;return this.retryIntervalsInMs[e]},e.prototype.getRequestIdFromResponse=function(e,t){return void 0===t&&(t="request-id"),this.getHeaderValue(e.headers,t)},e.prototype.getHeaderValue=function(e,t){return e&&t&&e.get(t)},e.prototype.updateRequestConfig=function(e,t,n){t&&t.success&&e&&(this.setAuthHeader(e.headers,t),n&&n(e,t))},e.prototype.setAuthHeader=function(e,t){t&&e.set("Authorization",(""+("RPSCompact"===t.format?this.rpsCompactAuthHeaderPrefix:"Bearer ")+t.token).trim())},e.prototype.request=function(e,t,n,i,o,l,s,c,u,d,p,f,h){var m=this;void 0===l&&(l={}),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===f&&(f=null);var b=-1!==h.toLowerCase().indexOf(this.contextService.sharedContext.officeHomeApiRoot.toLowerCase())&&this.contextService.getHybridAuth(),g=b?"OfficeHome":void 0===s?this.tokenConsumer:s,v="OfficeHome"===g,S=this.officeHomeApiConfigService.config,y="None"===g||v&&!S.jwtAuthEnabled,C=function(e){var i=e.status,l=Number.NaN;!y&&m.isAuthError(i,g)?l=r.a.TokenRefreshFailed:m.isRetriableError(i)&&(l=r.a.RetryFailed),l!==Number.NaN&&m.logCustomError(t,n,l,d),o(new a(e))};for(var w in this.queryParams)if(w&&this.queryParams.hasOwnProperty(w)){var T=this.queryParams[w];this.handleQueryParam(w.toLowerCase(),T,l)}l.headers||(l.headers=new Map),(y&&!b?Promise.resolve(null):this.accessTokenService.getAccessToken(g,!1,c,p,f)).then((function(s){var h,w,T;if(!y||b){if(!(s&&s.success||v&&S.jwtAuthEnabled&&S.jwtAuthOnOfficeHome)){var k=null!==(w=null===(h=null==s?void 0:s.error)||void 0===h?void 0:h.message)&&void 0!==w?w:"";return m.logCustomError(t,n,r.a.TokenUnavailable,d,k),void o(new a({data:"CAP_Error"===k?k:null,status:r.a.TokenUnavailable,subStatus:null===(T=null==s?void 0:s.error)||void 0===T?void 0:T.statusCode,headers:null,config:null,ok:!1,statusText:"Failed to fetch access token",fromCache:!1}))}m.updateRequestConfig(l,s,u)}var I=e(l);i(I),I.catch((function(r){if(!y&&m.isAuthError(r.status,g)){var s=m.getClaimsChallenge(r.headers,t,n);m.accessTokenService.getAccessToken(g,!0,c,p,f,void 0,void 0,void 0,s).then((function(t){if(t.success){m.updateRequestConfig(l,t,u);var n=e(l);i(n),n.catch(C)}else C(r)}))}else if(m.isRetriableError(r.status)){var d=m.getHeaderValue(r.headers,"Retry-After"),h=parseFloat(d||"0");!function(t,n){void 0===n&&(n=0),setTimeout((function(){var n=e(t);i(n),n.catch(C)}),n||m.getRetryInterval())}(l,Math.ceil(1e3*h))}else o(new a(r))}))}))},e.prototype.getClaimsChallenge=function(e,t,n){try{var i=e.getAll("WWW-Authenticate")[0];if(i.includes("insufficient_claims")){var r=i.match(/[\s|,]*claims=\"(\S+?)\"/);if(r&&2===r.length)return this.logCustomError(t,n,200,!1,"Found insufficient_claims"),r[1]}}catch(e){this.logCustomError(t,n,0,!1,e)}return""},e.prototype.logCustomError=function(e,t,n,r,o){void 0===o&&(o=""),this.instrumentationService.logRequestEvent(e,n,-1,o,r),Object(i.a)({eventName:t,fromCache:r,httpCode:n,latency:-1,error:o})},e}()},pd4Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("/I02"),r=n("keVe"),o=function(){function e(e){this.contextService=e,this.startDate=new Date;var t=this.contextService.sharedContext.dateOverride;t&&(this.mockDate=new Date(t))}return e.prototype.getCurrentDate=function(){if(this.mockDate){var e=(new Date).getTime()-this.startDate.getTime();return new Date(this.mockDate.getTime()+e)}return new Da.getCurrentDate();return e.setSeconds(0,0),e},e.prototype.getLocalMidnight=function(){var e=this.getCurrentDate();return e.setHours(0,0,0,0),e},e.prototype.timespanInSeconds=function(e){return(this.getCurrentDate().getTime()-e.getTime())/1e3},e.prototype.getStartOfYear=function(){var e=this.getCurrentDate();return new Date(e.getFullYear(),0,0,0,0,0,0)},e.prototype.addDays=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},e.prototype.addHours=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+t,e.getMinutes(),e.getSeconds(),e.getMilliseconds())},e.prototype.addSeconds=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.geion(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return l}));var i=0,r=1,ction(){return r}));var i=n("QjXU"),r=function(){function e(){}return e.getHostName=function(t){var n=e.getLocation(t);return n&&n.hostname||""},e.getLocation=function(t){if(t&&t.length){var n=t.match(e.UrlParserRegex);return n&&{href:t,protocol:n[1],host:n[2],hostname:n[3],port:n[4],path:n[5],search:n[6],hash:n[7]}}return null},e.getQueryParams=function(e){var t,n,r={};if(e){var o=e.split("&");try{for(var a=Object(i.__values)(o),l=a.next();!l.done;l=a.next()){var s=l.value,c=Object(i.__read)(s.split("="),2);r[c[0]]=c[1]}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}return r},e.getOrigin=function(t){var n=e.getLocation(t);return n&&n.protocol&&n.hostname?n.protocol+"//"+n.hostname:""},e.removeFileNameFromDocUrl=function(e){if(e)return e.substring(0,e.lastIndexOf("/"))},e.addMissingProtocol=function(e){return!(e=e.toLowerCase())||e.startsWith("http:")||e.startsWith("https:")||e.startsWith("mailto:")||e.startsWith("sip:")||e.startsWith("tel:")||e.startsWith("im:")?e:"https://"+e},e.UrlParserRegex=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join("")),e}()},pzhl:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f}));var i=n("keVe"),r=n("TOqr"),o=n("xSeq"),a=n("g0MB"),l=n("w1PR"),s=n("PkQn"),c=n("4/We"),u=i.Fb({encapsulation:2,styles:[],data:{}});function d(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"span",[],[[8,"id",0],[1,"title",0],[1,"aria-hidden",0]],null,null,null,null)),i.Gb(1,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Gb(2,278528,null,0,r.n,[i.o,i.y,i.K],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.classAttrValue),e(t,2,0,n.styleAttrValue)}),(function(e,t){var n=t.component;e(t,0,0,n.id||"",n.title,!n.ariaVisible)}))}function p(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"button",[["keyboardFocusTooltip",""]],[[8,"id",0],[8,"title",0],[1,"aria-label",0],[1,"aria-hidden",0],[1,"data-area",0],[1,"data-nav",0]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.handleClick()&&i),i}),null,null)),i.Gb(1,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Gb(2,278528,null,0,r.n,[i.o,i.y,i.K],{ngStyle:[0,ull,0,a.a,[i.o,i.K,l.b],null,null)],(function(e,t){var n=t.component;e(t,1,0,n.classAttrValue),e(t,2,0,n.styleAttrValue),e(t,3,0,n.focusOnLoad)}),(function(e,t){var n=t.component;e(t,0,0,n.id||"",n.title,n.ariaLabel,!n.ariaVisible,n.dataArea,n.dataNav)}))}function f(e){return i.jc(2,[(e()(),i.qb(16777216,null,null,1,null,d)),i.Gb(1,16384,null,p)),i.Gb(3,16384,null,0,r.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,!n.iconButton),e(t,3,0,n.iconButton)}),null)}i.Db("ohp-icon-font",s.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-icon-font",[],null,null,null,f,u)),i.Gb(1,638976,null,0,s.a,[c.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{color:"color",cssClass:"cssClass",iconFontCssClass:"iconFontCssClass",iconFontName:"iconFontName",iconFontType:"iconFontType",id:"id",size:"size",style:"style",title:"title",ariaVisible:"ariaVisible",ariaLabel:"ariaLabel",dataArea:"dataArea",dataNav:"dataNav",iconButton:"iconButton",isThirdParty:"isThirdParty",focusOnLoad:"focusOnLoad"},{iconClicked:"iconClicked"},[])},qCYW:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("9WrL"),r=n("casz"),o=n("keVe"),a=function(){function e(e,t){var n=this;this.officeStartBootstrapperService=e,this.schedulerService=t,this.runUnregisteredAction=function(e,t,i,r,o,a){n.maybeGetContentActionsHelper().then((function(n){null==ototype.createToDoErrorNotification=function(e){this.maybeGetContentActionsHelper().then((function(t)createToDoSuccessNotification=function(e,t){this.maybeGetContentActionsHelper().then((function(n){null==n||n.createToDoSuccessNotification(e,t)}))},e.prototype.createDocumt,n,i){return this.maybeGetContentActionsHelper().then((function(r){return r?r.createDocumentActions(e,t,n,i):[]})).catch((function(e){return[]}))},e.prototype.destroy=function(){this.contentActionntActionsGroupInfo=function(){return this.maybeGetContentActionsHelper().then((function(e){return null==e?void 0:e.getContentActionsGroupInfo()}))},e.prototype.ngOnDestroy=function(){this.destroy()},e.prototype.maybeGetContentActionsHelper=function(){var e=this;return new Promise((function(t){e.contentActionsHelper&&t(e.contentActionsHelper),e.contentActionsHelperPromise||(e.contentActionsHelperPromise=new Promise((function(t){e.schedulerService.scheduleWork((function(){Promise.all([n.e(8),n.e(0),n.e(1),n.e(2),nn((function(n){n.getContentActionsHelper(e.officeStartBootstrapperService).then((function(n){e.contentActionsHelper=n,t(e.contentActionsHelper)}))})).catch((function(n){e.contentActionsHelper=void 0,t(e.contentActionsHelper)}))}),4)}))),e.contentActionsHelperPromise.then((function(n){e.contentActionsHelper=n,e.contentActionsHelper||(e.contentActionsHelperPromise=voioken:e,providedIn:"root"}),e}()},qfyf:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").u)("PERFORMANCE_QUEUE")},rBEp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},rPZ4:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var i=n("keVe"),r=n("TOqr"),o=n("pzhl"),a=n("PkQn"),l=n("4/We"),s=n("Zy3K"),c=n("PBJH"),u=i.Fb({encapsulation:2,styles:[],data:{}});function d(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,13,"div",[["class","create-location-wrapper"]],null,null,null,null,null)),i.Gb(1,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),i.Hb(2,0,null,null,11,"div",[["class","create-location"]],null,null,null,null,null)),i.Gb(3,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(4,{"create-location--margin":0,"create-location--fluent":1}),(e()(),i.Hb(5,0,null,null,3,"span",[["class","create-location__prompt"]],null,null,null,null,null)),i.Gb(6,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(7,{"ms-fcl-ns":0,"ms-fcl-np":1}),(e()(),i.gc(8,null,["",""])),(e()(),i.Hb(9,0,null,null,1,"ohp-icon-font",[["cssClass","ms-ohp-svg-Icon ms-ohp-Icon--oneDriveLogo create-location__icon"],["size","16"]],null,null,null,o.b,o.a)),i.Gb(10,638976,null,0,a.a,[l.a],{color:[0,"color"],cssClass:[1,"cssClass"],size:[2,"size"]},null),(e()(),i.Hb(11,0,null,null,2,"span",[["class","create-location__path"]],[[8,"innerHTML",1]],null,null,null,null)),i.Gb(12,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(13,{"ms-fcl-ns":0,"ms-fcl-np":1})],(function(e,t){var n=t.component;e(t,1,0,"create-location-wrapper",n.cssClass);var i=e(t,4,0,n.showMargin,n.fluentRefresh);e(t,3,0,"create-location",i);var r=e(t,7,0,!n.fluentRefresh,n.fluentRefresh);e(t,6,0,"create-location__prompt",r),e(t,10,0,n.oneDriveColor,"ms-ohp-svg-IcfluentRefresh);e(t,12,0,"create-location__path",o)}),(function(e,t){var n=t.component;e(t,8,0,n.createLocationPrompt),e(t,11,0,n.createLocation)}))}i.Db("ohp-create-location",s.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-create-location",[],null,null,null,d,u)),i.Gb(1,114688,null,0,s.a,[l.a,c.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{app:"app",showMargin:"showMargin",cssClass:"cssClass"},{},[])},rTyw:function(e,t,n){"use str{return r}));var i=n("dy1P");function r(e,t){void 0===t&&(t=!1);var n=e.replace(/Shell/,"");if(Object.values(i.a).fi").test(e)}(n))return i.a.DynamicsApp;if(function(e){return/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/.test(e)}(n))return function(e){return new RegExp("GraphApp").test(e)}(n)?i.a.GraphApp:function(e){return new RegExp("LineOfBusinessApp").test(e)}(n)?i.a.LineOfBusinessApp:function(e){return new RegExp("SharePointApp").test(e)||/^[0-9a-f]{8{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}(n)?i.a.SharePointApp:function(e){return new RegExp("providers/Microsoft.PowerApps").test(e)}(n)?i.a.PowerAppsApp:i.a.ThirdPartyApp;switch(n){case"Admin":return i.a.AdminPortal;case"UpcomingMeeting":return i.a.Calendar;case"Document":case"Documents":case"OneDrive":return i.a.Documents;case"Forms":case"OfficeForms":return i.a.OfficeForms;case"Lists":case"List":return i.a.Lists;case"Loop component":case"Loop components":case"Loop":return i.a.Loop;case"Meeting Object":case"MeetingObject":return i.a.MeetingObject;case"M365app":return i.a.MetaOSApp;case"Office":return i.a.OfficeDotCom;case"PowerBI":case"PowerBIv2":return i.a.PowerBI;case"SharePoint":case"Sites":return i.a.SharePoint;case"Streams":case"Stream":return i.a.MicrosoftStream;case"Teams":return i.a.SkypeTeams;default:return t?i.a.ScdApp:i.a.UnknownApp}}},rbdM:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("QjXU"),r=(n("EUVs"),n("4/We"),function(e){function t(t,n){var i=e.call(this,(function(){return i.wacContentService.loadMruItem(i.itemInfo.item,i.itemInfo.wdOriginType,!0)}))||this;return i.capabilitiesService=t,i.wacContentService=n,i}return Object(i.__extends)(t,e),t.prototype.enabled=function(){return this.capabilitiesService.wacHostEnabledForFileType(this.itemInfo.item.fileType)&&this.capabilitiesService.capabilities.wacHostHoverPreloadEnabled},t}(n("adME").a))},re3B:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("W3Zz"),r=n("BMb5"),o=n("keVe"),a=function(){function e(e,t){this.windowService=e;var n=t.getDeviceInfo(),r=n.platform.platformType;this.handlePageHide=(r===i.e.iPhone||r===i.e.iPad)&&n.browser.browserType===i.a.Safari}return e.prototype.addUnloadEvent=function(e,t){void 0===t&&(t=!1);var n=!1,i=this.windowService.nativeWindow,r=function(i,r){var o=void 0;return t&&r&&(o=r(i)),n||(n=!0,e()),!t&&r&&(o=r(i)),o},o=i.onbeforeunload;if(i.onbeforeunload=function(e){return r(e,o&&o.bind(i))},this.handlePageHide){var a=i.onpagehide;i.onpagehide=function(e){return r(e,a&&a.bind(i))}}},e.ɵprov=o.kc({factory:function(){return new e(o.lc(r.b),o.lc(i.c))},token:e,providedIn:"root"}),e}()},"s+Eq":function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){rn("keVe"),r=n("lrJm"),o=(n("5FMq"),n("24t9")),a=(n("mu6k"),function(){return function(){}}()),l=function(){return function(e){this.templateRef=e}}(),s=function(){function e(e,t){this.changeDetectorRef=e,this.contextMenuService=t,this.leftAlignedCard=!1,this.fullWidth=!1,this.toggleDisabled=!1,this.hideContent=!1,this.multiSelect=!1,this.ariaRole="option",this.selectedIndex=-1,this.toggleMenu=new i.q,this.selectItem=new i.q,this.focusLink=new i.q}return e.prototype.ngOnInit=function(){var e=this;this.opened=!1,this.focusActive=!1,this.mobileContextMenu&&this.contextMenuService.subscrib.menu&&e.menuModel&&t.menu.Enabled&&this.themeEnabled.subscribe((function(t){e.isThemeEnabled=t}))},e.prototype.ngOnDestroy=function(){this.opened&&this.toggleMenu.emit(!1)},e.prototype.ngAfterViewInit=function(){if(1!==this.menuItems.length)throw new r.a("Must have exactly 1 *ohpDropdownMenuItemContent in a DropdownMenu as a child");this.menuItemTemplate=this.menuItems.first.templateRef,this.changeDetectorRef.detectChanges()},e.prototype.onToggleMenu=function(e,t){if(null==t||t.preventDefault(),this.toggleDisabled&&!this.fullWidth)return this.opened=!0,void this.toggleMenu.emit(!0);this.opened!==e&&(e||!this.menu?(e&&!this.hideContent&&this.mobileContextMenu&&this.contextMenuService.showMenu({menu:this.menuModel,position:{left:0,top:0},focusFirstItem:this.focusActive}),this.opened=e,this.toggleMenu.emit(e)):this.menu.close())},e.prototype.onSelectItem=function(e){this.selectItem.emit(e)},e.prototype.onCloseMenu=function(e){this.opened=!1,(this.focusActive||e)&&this.dropdownLink.nativeElement.focus(),this.focusActive=!1,this.toggleMenu.emit(!1)},e.prototype.handleKey=function(t){var n=o.a.getKey(t);if(this.opened){if(-1!==e.expectedKeys.indexOf(n)){t.preventDefault();var i=this.menuModel.items.length-1;switch(n){case 1:case 2:case 3:this.onToggleMenu(!1,t);break;case 4:this.focusActive=!0,this.menu.setActiveIndex(i,!0);break;case 5:this.focusActive=!0,this.menu.setActiveIndex(0,!0)}}}else 2===n&&(this.focusActive=!0)},e.prototype.handleFocus=function(e){this.focusLink.emit(e)},e.expectedKeys=[1,2,3,4,5],e}()},sCgQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"sH0/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("firstRunCalloutsConfig")||{hideInTestMode:!0,tuiFlowInTestMode:"0",version:0,findMoreAppsCommercialSvg:{light:"",dark:""},findMoreAppsConsumerSvg:{light:"",dark:""},findMoreAppsEduSvg:{light:"",dark:""},manageContentSvg:{light:"",dark:""},createSvg:{light:"",dark:""},uploadContentSvg:{light:"",dark:""},allSetSvg:{light:"",dark:""},upgradeSvg:{light:"",dark:""},welcomeBackSvg:{light:"",dark:""},adminCenterSvg:{light:"",dark:""},officeMobileAppSvg:{light:"",dark:""},installButtonCalloutEnabled:!0}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},tjsK:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("QjXU"),r=function(e){function t(t,n){var i=e.call(this,t)||this;return i.message=t,i.originalError=n,i.name="ApplicationError",i}return Object(i.__extends)(t,e),t}(Error)},ttrr:function(e,t,n){"use strict";n.d(t,"a",(funcn e(e,t){this.contextMenuService=e,this.deviceDetector=t}return e.prototype.ngOnInit=function(){this.desktop=this.deviceDetector.isDesktopDevice()},e.prototype.onContextMenu=function(e){var t=this;this.desktop&&this.model&&e&&!this.disabled&&(e.preventDefault(),setTimeout((function(){t.contextMenuService.showMenu({menu:t.model,position:{left:e.clientX,top:e.clientY}})}),0))},e}()},tuJr:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return S}));var i=n("keVe"),r=n("TOqr"),o=n("RitX"),a=n("mu6k"),l=n("W3Zz"),s=n("hZW2"),c=n("PBJH"),u=n("BMb5"),d=n("g0MB"),p=n("w1PR"),f=n("s+Eq"),h=n("5FMq"),m=i.Fb({encapsulation:2,styles:[],data:{}});function b(e){return i.jc(0,[(e()(),i.qb(0,null,null,0))],null,null)}function g(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),i.qb(16777216,null,null,2,null,b)),i.Gb(2,540672,null,0,r.o,[i.W],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),i.Zb(3,{item:0,index:1}),(e()(),i.qb(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,3,0,t.context.item,t.context.index);e(t,2,0,i,n.menuItemTemplate)}),null)}function v(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"ohp-menu",[],null,[[null,"selectItem"],[null,"closeMenu"]],(function(e,t,n){var i=!0,r=e.component;return"selectItem"===t&&(i=!1!==r.onSelectItem(n)&&i),"closeMenu"===t&&(i=!1!==r.onCloseMenu(n)&&i),i}),o.b,o.a)),i.Gb(1,4440064,[[2,4]],1,a.a,[l.c,s.a,i.h,c.a,i.K,i.o,u.b],{menuModel:[0,"menuModel"],animateClose:[1,"animateClose"],leftAlignedCard:[2,"leftAlignedCard"],multiSelect:[3,"multiSelect"],contextAriaLabel:[4,"contextAriaLabel"],ariaRole:[5,"ariaRole"],selectedIndex:[6,"selectedIndex"]},{selectItem:"selectItem",closeMenu:"closeMenu"}),i.cc(603979776,3,{menuItems:1}),(e()(),i.qb(0,null,null,1,null,g)),i.Gb(4,16384,[[3,4]],0,a.b,[i.S],null,null)],(function(e,t){var n=t.component;e(t,1,0,n.menuModel,!0,n.leftAlignedCard,n.multiSelect,n.menuModel.linkAriaLabel,n.ariaRole,n.selectedIndex)}),null)}function S(e){return i.jc(0,[i.cc(671088640,1,{dropdownLink:0}),i.cc(671088640,2,{menu:0}),(e()(),i.Hb(2,0,null,null,11,"div",[["class","dropdown-menu-wrapper"]],[[8,"id",0]],null,null,null,null)),i.Gb(3,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Zb(4,{"dropdown-menu-wrapper--relative":0,"dropdown-menu-wrapper--max-width":1}),(e()(),i.Hb(5,0,[[1,0],["dropdownLink",1]],null,4,"button",[["data-clicklog","custom"],["keyboardFocusTooltip",""]],[[8,"id",0],[1,"aria-label",0],[1,"aria-expanded",0],[1,"aria-describedby",0],[8,"title",0]],[[null,"click"],[null,"keydown"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onToggleMenu(!r.opened,n)&&i),"keydown"===t&&(i=!1!==r.handleKey(n)&&i),"focus"===t&&(i=!1!==r.handleFocus(!0)&&i),"blur"===t&&(i=!1!==r.handleFocus(!1)&&i),i}),null,null)),i.Gb(6,278528,null,0,r.i,[i.x,i.y,i.o,i.K],{ngClass:[0,"ngClass"]},null),i.Xb(7,3),i.Gb(8,4210688,null,0,d.a,[i.o,i.K,p.b],null,null),i.Vb(null,0),(e()(),i.Hb(10,0,null,null,1,"p",[["class","aria-description"]],[[8,"id",0]],null,null,null,null)),(e()(),i.gc(11,null,["",""])),(e()(),i.qb(16777216,null,null,1,null,v)),i.Gb(13,16384,null,0,r.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,4,0,!n.overridePositioning,n.fullWidth);e(t,3,0,"dropdown-menu-wrapper",i);var r=e(t,7,0,n.menuModel.linkCssClass,n.isThemeEnabled&&n.menuModel.themeCssClass&&!n.opened?n.menuModel.themeCssClass:"",n.opened&&n.menuModel.openCssClass?n.menuModel.openCssClass:"");e(t,6,0,r),e(t,13,0,n.opened&&!n.mobileContextMenu&&!n.hideContent)}),(function(e,t){var n=t.component;e(t,2,0,i.Ob(1,"",n.menuModel.id,"-dropdown-wrapper")),e(t,5,0,i.Ob(1,"",n.menuModel.id+"-dropdown-link",""),n.menuModel.linkAriaLabel,n.opened?"true":"false",n.menuModel.id+"-button-description",n.menuModel.linkTooltip||""),e(t,10,0,i.Ob(1,"",n.menuModel.id+"-button-description","")),e(t,11,0,n.menuModel.linkAriaDescription)}))}i.Db("ohp-dropdown-menu",f.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,"ohp-dropdown-menu",[],null,null,null,S,m)),i.Gb(1,4440064,null,1,f.a,[i.h,h.a],null,null),i.cc(603979776,1,{menuItems:1})],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",overridePositioning:"overridePositioning",mobileContextMenu:"mobileContextMenu",leftAlignedCard:"leftAlignedCard",fullWidth:"fullWidth",toggleDisabled:"toggleDisabled",themeEnabled:"themeEnabled",hideContent:"hideContent",multiSelect:"multiSelect",ariaRole:"ariaRole",selectedIndex:"selectedIndex"},{toggleMenu:"toggleMenu",selectItem:"selectItem",focusLink:"focusLink"},["[ohpMenuLinkContent]"])},"tv+F":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t){this.router=e,this.capabilitiesService=t}return e.prototype.checkEnabledAndRedirect=function(e,t,n,i){return e||(null!=i?!i:this.router.navigated)||this.router.navigate([null!=t?t:this.getDefaultRedirect()],n?{queryParams:n}:{}),e},e.prototype.getDefaultRedirect=function(){switch(this.capabilitiesService.getWorkload()){case"embed":return"embed/home";default:return"home"}},e}()},twlh:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("Dn7E"),r=n("lrJm"),o=n("Uqr9"),a=n("re3B"),l=n("/I02"),s=n("uUrA"),c=n("keVe"),u=n("y1jW"),d=function(){function e(e,t,n){this.contextService=e,this.unloadEventService=t,this.eventManager=n,this.currentSessionIndex=0,this.currentSessionId=null,this.currentSessionStartTime=0,this.currentSessionClickCount=0,this.inactivityStartTime=0,this.inactivityTrackerStartTime=0,this.cumulativeDurationOfActivitySessions=0,this.cumulativeDurationBetweenActivitySessions=0,this.cumulativeClickCount=0}ret;if(this.contextService.sharedContext.activityTrackingEnabled){this.instrumentationService=e;var n=function(){t.startSession(),t.trackInactivity()};n(),this.mousedownListener=this.eventManager.addGlobalEventListener("document","mousedown",n),this.mousemoveListener=this.eventManager.addGlobalEventListener("document","mousemove",n),this.keypressListener=this.eventManager.addGlobalEventListener("document","keypress",n),this.unloadEventService.addUnloadEvent((function(){t.mousedownListener&&t.mousedownListener(),t.mousemoveListener&&t.mousemoveListener(),t.keypressListener&&t.keypressListener(),clearTimeout(t.inactivityTrackerTimeout),t.endSession(t.inactivityTrackerStartTime?o.a.now()-t.inactivityTrackerStartTime:0)}))}},e.prototype.startSession=function(){if(!this.contextService.sharedContext.activityTrackingEnabled)return null;if(this.currentSessionId)return this.currentSessionId;this.currentSessionStartTime=o.a.now(),this.currentSessionId=s.a.createGuid(),this.currentSessionIndex++,this.currentSessionClickCount=0;var e={};if(e.ActivitySessionId=this.currentSessionId,e.Index=this.currentSessionIndex.toString(),this.currentSessionIndex>1){if(this.inactivityStartTime<=0)throw new r.a("Logical error in ActivitySessionService: inactivityStartTime must be set to valid value when startSession() is called");var t=this.currentSessionStartTime-this.inactivityStartTime;this.cumulativeDurationBetweenActivitySessions+=t,e.Latency=Math.ceil(t).toString()}return this.instrumentationService.logGenericEvent("Activity_Session_Started",e),Object(i.a)({featureName:"ActivitySession",eventName:"Activity_Session_Started",params:e}),this.currentSessionId},e.prototype.endSession=function(e){if(void 0===e&&(e=0),!this.contextService.sharedContext.activityTrackingEnabled)return null;if(!this.currentSessionId)return this.getCurrentStats();this.inactivityStartTime=o.a.now()-e;var t={};t.ActivitySessionId=this.currentSessionId,t.Index=this.currentSessionIndex.toString(),t.ClickCount=this.currentSessionClickCount.toString();var n=this.inactivityStartTime-this.currentSessionStartTime;return this.cumulativeDurationOfActivitySessions+=n,t.Latency=Math.ceil(n).toString(),this.instrumentationService.logGenericEvent("Activity_Session_Finished",t),Object(i.a)({featureName:"ActivitySession",eventName:"Activity_Session_Finished",params:t}),this.currentSessionId=null,this.getCurrentStats()}itySessions,cumulativeDurationBetweenActivitySessions:this.cumulativeDurationBetweenActivitySessions,inactivityStartTime:this.inactivityStartTime}},e.prototype.trackInactivity=function(){var e=this;clearTimeout(this.inactivityTrackerTimeout),this.inactivityTrackerStartTime=o.a.now(),this.inactivityTrackerTimeout=setTimeout((function(){return e.endSession(o.a.now()-e.inactivityTrackerStartTime)}),1e3*this.contextService.sharedContext.inactivityTimeoutInSeconds)},e.ɵprov=c.kc({factory:function(){return new e(c.lc(l.a),c.lc(a.a),c.lc(u.d))},token:e,providedIn:"root"}),e}()},tyUq:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("TfV2"),r=n("ZBSS"),o=n("uqr+"),a=n("dSKW"),l=n("uV9m");function s(e,t,n){void 0===t&&(t=i.a.Security),void 0===n&&(n=!1),Object(l.g)(n?"RequestSampled":"Request",function(e,t){var n,i,s;void 0===t&&(t=!1);var c={};if(c[r.A]=t?"RequestSampled":"Request",c[r.B]=e.eventName,c[Object(o.a)([r.eb,r.I])]=e.httpCode.toString(),c[Object(o.a)([r.eb,r.v])]=e.error?e.error:"",c[Object(o.a)([r.eb,r.H])]=!!e.fromCache&&e.fromCache,c[Object(o.a)([r.eb,r.V])]=e.latency?e.latency.toString():"",c[Object(o.a)([r.eb,r.j])]=null!==(n=e.area)&&void 0!==n?n:"",c[Object(o.a)([r.eb,r.jb])]=null!==(i=e.subArea)&&void 0!==i?i:"",c[Object(o.a)([r.eb,r.J])]=null!==(s=e.id)&&void 0!==s?s:"",Object(l.e)()){var u=Object(a.b)(Object(l.b)());c[Object(o.a)([r.eb,r.Y])]=u,c[Object(o.a)([r.eb,r.Z])]=Object(a.d)(u),c[Object(o.a)([r.eb,r.X])]=Object(a.c)(u)}return c}(e,n),t)}},u51t:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("Uqr9"),r=(n("hhzZ"),n("4/We"),function(){function e(e,t){this.instrumentationService=t,this.enabled=e.capabilities.hoverPreloadTelemetryEnabled}return e.prototype.onMstartTime=i.a.now(ction(){this.startTime&&this.log(!1)},e.prototype.onClick=function(){this.startTime&&this.log(!0)},e.prototype.reset=function(){this.startTime=null},e.prototype.log=function(e){var t=this.getTimeElapsed().toString(),n={};n.TimeElapsed=t,n.Area=this.area,n.DocumentHoverClick=e.toString(),this.instrumentationService.logGenericEvent("Document_Hover",n),this.reset()},e.prototype.getTimeElapsed=function(){return i.a.now()-this.startTime},e}())},uG5N:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("AlWG"),r=n("k+kJ"),o=n("keVe"),a=function(){function e(){this._uploadResources=new i.a(null),this.uploadResources=this._uploadResources.asObservable(),this._uploadSession=new i.a(null),this.uploadSession=this._uploadSession.asObservable()}return e.prototype.upload=function(e,t,n,i,r){var o=this;if(this.uploadInProgress&&!this.uploadInProgress.finished())return null;this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=null,this.uploadInProgress=null);var a=t.upload(e,n,r);return a&&(this.currentSubscription=a.subscribe((function(e){o._uploadResources.next(i),o.uploadInProgress=e,o._uploadSession.next(e)}))),a},e.prototype.uploadFiles=function(e,t,n,o){var a=this;if(this.uploadInProgress&&!this.uploadInProgress.finished())return null;this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=null,this.uploadInProgress=null);var l=new r.b(t,e[0],o),s=new i.a(l);return l.cancellationToken.onCancel((function(){l.state=r.c.Cancelled,s.next(l)})),l.error={title:n.multipleFilesErrorTitle,type:r.a.MultipleFiles,message:n.multipleFiles},l.state=r.c.Failed,s.next(l),this.currentSubscripoadSession.next(e)})),s.asObservable()},e.prototype.cancelUpload=function(){this.uploadInProgress&&this.uploadInProgress.cancellationToken.cancel()},e.ɵprov=o.kc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"uH9+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("pd4Y"),r=n("keVe"),o=function(){function e(e){this.dateService=e}return e.prototype.getTimestampType=function(e){var t=this.dateService.timespanInSeconds(e),n=this.dateService.getLocalMidnight(),i=this.dateService.addDays(n,-1),r=this.dateService.addDays(n,-6),o=this.dateService.getStartOfYear();return t>=-3300&&t<-60?9:t<0?0:t<120?1:t<3600?2:e>=n?3:e>=i?4:e>=r?5:e>=o?6:7},e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),=n("kfAr"),a=n("QOOv"),l=n("keVe"),s=function(){function e(e,t){this.instrumentationService=e,this.mruConfigService=t,this.recordedThumbnails=new Set}return e.prototype.instrumentThumbnailLoad=function(e,t,n,i,r){if(this.mruConfigService.config.logThumbnailLoadSuccess&&!this.recordedThumbnails.has(t)&&o.a.thumbnailFileTypes.has(r)){var a=this.getInstrumentationParams(e?"Success":"Failed",n,i,r);this.instrumentationService.logGenericEvent("Thumbnail_Load",a),this.recordedThumbnails.add(t)}},e.prototype.getInstrumentationParams=function(e,t,n,i){var o={};return o.State=e,o.ItemCategory=t,o.Index=n.toString(),o.DocumentType=r.b[i],o},e.ɵprov=l.kc({factory:function(){return new e(l.lc(i.a),l.lc(a.a))},token:e,providedIn:"root"}),e}()},uSTl:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("QjXU"),r=n("SRNi"),o=n("4/We"),a=n("keVe"),l=function(){function e(e){var t=this;this.capabilitiesService=e,this.completedFirstRun=!0,this.completedSecondRun=!0,this.runType=r.a.Disabled,this.secondRunEnabled=this.capabilitiesService.capabilities.secondRunSREConsumerEnabled,this.statePromise=this.fetchState(),this.statePromise.then((function(e){var n=Object(i.__read)(e,2),r=n[1];t.completedFirstRun=n[0],t.completedSecondRun=r,t.determineRunType()}))}return e.prototype.getRunType=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.statePromise];case 1:return e.sent(),[2,this.runType]}}))}))},e.prototype.determineRunType=function(){this.runType=this.completedFirstRun?this.completedFirstRun&&this.secondRunEnabled&&!this.completedSecondRun?r.a.SecondRun:r.a.Disabled:r.a.FirstRun},e.prototype.fetchState=function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(684)]).then(n.bind(null,"Hnto")).then((function(e){var t=e.fetchFirstRunState().then((function(e){return e.CompletedFirstRun})),n=e.fetchSecondRunState().then((function(e){return e.CompletedFirstRun}));return Promise.all([t,n])}))},e.ɵprov=a.kc({factory:function(){return new e(a.lc(o.a))},token:e,providedIn:"root"}),e}()},uUrA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}))xxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},e}()},uV9m:function(e,t,n){"use strict";n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return T})),n.d(t,"c",(function(){return k}));var i,r=n("tjsK"),o=n("TfV2"),a=n("ZBSS"),l=n("dSKW"),s=n("uqr+"),c=n("kxm0"),u=window.queuedOtelEvents||[],d=!1;window.appSecurityLevel=o.a.Full;var p=!1,f="",h=!1;function m(e,t,n){if(void 0===t&&(t={}),!(window.appSecurityLevel<n))if(h||(h=!0,function(e,t){void 0===t&&(t=o.a.Security),m("Session",function(e){var t={};return t[a.A]="Session",t[a.B]=e.eventName,T()&&(t[a.F]=k()),t}({eventName:"Session_Started"}),t)}()),window.registeredEventSinks&&window.registeredEventSinks.length>0)window.registeredEventSinks.forEach((function(n){e&&y(t)&&n.logEvent(e,t,C(t),w(t))}));else if(e||void 0===e&&Object(c.c)(t)){var i={eventName:e,params:t,securityThreshold:n};window.isBootstrap?(window.queuedOtelEvents||(window.queuedOtelEvents=[]),window.queuedOtelEvents.push(i)):u.push(i)}}function b(e,t,n,o,h,b){if(void 0===b&&(b=""),window.registeredEventSinks&&window.registeredEventSinks.length>0)throw new r.a("initializeInstrumentationService is not allowed to be called more than once");if(!e||0===e.length)throw new r.a("Must specify at least one event factory when calling initializeInstrumentation");i=t,d=!0,window.eventCategoryConfig=n,window.eventSamplingConfig=o,f=b,window.registeredEventSinks=e.slice(),"number"==typeof h&&(window.appSecurityLevel=h),function(){var e=u.splice(0,u.function(e){Object(c.c)(e.params)?(e.params=Object(c.e)(e.params),e.eventName=Object(c.a)(Object(c.b)(e.params))):(function(e){return"Session"===e[a.A]}(e.params)&&(e.params=function(e){return e[a.F]||(e[Object(s.a)([a.ib,a.F])]=k()),e}(e.params)),e.params=function(e,t){switch(e[a.A]){case"Action":return I(e,a.a,t);case"Diagnostic":return I(e,a.r,t);case"Error":return I(e,a.y,t);case"Feature":return I(e,a.D,t);case"Impression":return I(e,a.K,t);case"Performance":return I(e,a.bb,t);case"Request":return I(e,a.eb,t);default:return e}}(e.params,t)),m(e.eventName,e.params,e.securityThreshold)}))}(),p=!0}function g(e,t,n,i){var r;e&&0!==e.length&&!p&&("number"==typeof i&&(window.appSecurityLevel=i),window.eventCategoryConfig=t,window.eventSamplingConfig=n,(null==u?void 0:u.length)?u.splice(0,u.length).forEach((function(t){window.appSecurityLevel>=t.securityThreshold&&t.eventName&&y(t.params)&&e.forEach((function(e){e.logEvent(t.eventName,t.params,C(t.params),w(t.params))}))})):(null===(r=window.queuedOtelEvents)||void 0===r?void 0:r.length)&&window.queuedOtelEvents.splice(0,window.queuedOtelEvents.length).forEach((function(t){window.appSecurityLevel>=t.sName&&y(t.params)&&e.forEach((function(e){e.logEvent(t.eventName,t.params,C(t.params),w(t.params))}))})))}function v(){return d}function S(){return i()}function y(e){switch(e[a.A]){case"Action":return window.eventCategoryConfig.actionEnabled;case"Diagnostic":return window.eventCategoryConfig.diagnosticEnabled;case"Error":return window.eventCategoryConfig.errorEnabled;case"Feature":return window.eventCategoryConfig.featureEnabled;case"Impression":return window.eventCategoryConfig.impressionEnabled;case"PageView":return window.eventCategoryConfig.pageViewEnabled;case"Performance":return window.eventCategoryConfig.perfEnabled;case"Session":return!0;case"RequestSampled":case"Request":return window.eventCategoryConfig.requestEnabled;default:return!1}}function C(e){switch(e[a.A]){case"Performance":return window.eventSest":return window.eventSamplingConfig.requestSamplingEnabled;case"RequestSampled":return!0;default:return!1}}function w(e){return"Diagnostic"===e[a.A]}function T(){return p}function k(){return f}function I(e,t,n){return e[Object(s.a)([t,a.Y])]||(e[Object(s.a)([t,a.Y])]=n,e[Object(s.a)([t,a.Z])]=Object(l.d)(n),e[Object(s.a)([t,a.X])]=Object(l.c)(n)),e}},uWZl:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.fullPageReady=function(){return e.readyPromise?e.readyPromise:e.readyPromise=e.createListener("FullAuthPageRendered")},e.shellAndConfigsReady=function(){return e.shellAndConfigsReadyPromise?e.shellAndConfigsReadyPromise:e.shellAndConfigsReadyPromise=e.createListener("ShellInfoLoaded")},e.createListener=function(e){var t="readystatechange";return new Promise((function(n){var i=function(){/^(?:interactive|complete)$/.test(document.readyState)&&(document.removeEventListener(t,i),document.getElementById(e)&&n())};document.addEventListener(t,i),i()}))},e}()},ufVG:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.reactShellConfig=e.parse("reactShellConfiguration")||{activityTimeout:0,correlationId:null,culture:null,feedbackLinkText:null,homePageTitle:null,isConsumer:!1,logoutText:null,logoutUrl:null,mePhotoSource:null,puid:null,responsiveShellEnabled:!1,searchInHeader:!1,shellBootHost:null,shellDelayResourcesEnabled:!1,showOCVFeedbackLink:!1,signinState:[],controlsClaim:[],stickyNotesEnabled:!1,switchAccountLinkText:null,testTraffic:!1,thirdPartyNoticeLinkText:null,thirdPartyNoticeUrl:null,upn:null,userDisplayName:null,version:null,workloadSettingsSubLinksTitle:null,darkModeEnabled:!1,resourceUrl:null,environment:null,consumerShellServiceEnabled:!1,languageCode:null,acctSwitchingConfig:null,meetNowLinkUrl:"",meetNowEnabled:!1,disableAppLauncher:!1}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},up2P:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},upmJ:function(e,t,n){"use strict";n.d(t,"unction(){return function(){}}()},"uqr+":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("zGJG");function r(e){return e.join(i.b)}},uzn7:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("QjXU"),r=n("CMIS"),o=n("hhzZ"),a=n("cgnd"),l=n("XV2T"),s=n("BMb5"),c=n("keVe"),u=function(e){function t(t,n,i){var o=this;try{o=e.call(this,n.config.puid,i.getStorage(s.a.LocalStorage))||this,i.isStorageAvailable(s.a.LocalStorage)||(t.logGenericEvent("Local_Storage_Unavailable"),Object(r.a)({eventName:"Local_Storage_Unavailable"}))}catch(e){}return o}return Object(i.__extends)(t,e),t.ɵprov=c.kc({factory:function(){return new t(c.lc(o.a),c.lc(a.b),c.lc(s.b))},token:t,providedIn:"root"}),t}(l.a)},v3sZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("oneNoteConfig")||{oneNoteApiPath:null,enableOneNoteApis:!1}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},vHlr:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var i=n("FZB6"),r=n("Dn7E"),o=n("lUkk"),a=n("dy1P"),l=n("hhzZ"),s=n("BaAg"),c=n("p6Zr"),u=n("kpuN"),d=n("hZW2"),prtupConfigService=a,this.uploadManagerService=l,this.uploadConfigService=s,this.oneDriveUploadService=c,this.urlLauncherService=u,this.wacContentService=d}return e.prototype.getClickDataForId=function(e,t,n,i,r){var o={};o.UploadSessionId=t,o.ElementId=e=i?e+"-"+i:e,o.Area=this.contextService.isEdgeworth?l.b.Edgeworth:l.b.Documents,o.ItemCount=(r||0).toString(),o.ItemCategory=S.d[n];var a=this.getPartnerCorrelationId();return void 0!==a&&(o.PartnerCorrelationId=a),{eventName:"Upload_Click",params:o,metrics:[]}},e.prototype.uploadFile=function(e,t,i,o,a){var l=this,c=s.a.fileTypeFromFileName(e.name),u=!1,d=function(e,t){u||(u=!0,l.logClick(o,i,a,c,e,t))},p=this.uploadManagerService.upload(e,this.oneDriveUploadService,i,this.uploadConfigService.config.oneDriveResources,a);if(p){var f=(new Date).getTime(),h=f.toString(),m=!1;this.uploadSubscription=p.subscribe((function(o){if(o.state===S.c.Completed){m=!0;var u={};u.UploadSessionId=i,u.Latency=Math.ceil(o.duration).toString(),u.ItemCategory=S.d[a];var p=l.getPartnerCorrelationId();void 0!==p&&(u.PartnerCorrelationId=p),l.instrumentationService.logGenericEvent("Upload_Completed",u,["Upload_Completed"]),Object(r.a)({featureName:"Upload",eventName:"Upload_Completed",params:u});var b=l.capabilitiesService.capabilities.outgoingLoginHintEnabled,g=v.a.appendLoginHint(o.result.canonicalUrl,l.startupConfigService.config.loginHint,b),y={wdNewAndOpenCt:h,ct:h,wdPreviousSession:l.startupConfigService.config.sharedClientStartupContext.correlationId,wdOrigin:l.contextService.getWdOrigin("UPLOAD")};b&&(y.login_hint=l.startupConfigService.config.loginHint);var C=v.a.appendQueryParams(o.result.webUrl,y),w=function(){if("cloudtest"!==l.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment){var t=function(e){if(d(!0,"Web"),l.capabilitiesService.wacHostEnabledForFileType(c)){var t=o.result;l.wacContentService.bootstrapAndRoute({docId:t.docId,driveId:t.driveId,docUrl:C,fileType:c,wdOrigin:y.wdOrigin},void 0,f),o.markCompletedAndOpenedInOfficeHomEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(t){t.launchUrl(C,{action:"Upload",linkTarget:e})})):l.urlLauncherService.openUrl(C,"Upload",e)};l.capabilitiesService.capabilities.isEmbedMode&&l.capabilitiesService.capabilities.embedModeEnabled?t("_blank"):g?l.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchContent({action:"Upload",document:{canonicalUrl:g,webUrl:C,app:s.b[c],attribution:"",url:g,extension:"",title:e.name,id:o.result.docId||""},useWebUrl:!0,wdOriginType:"UPLOAD"}).then((function(e){e.success?d(!0,"Native"):t("_blank")})).catch((function(){return t("_top")}))})):l.localAppLauncherService.launchOfficeApp(s.b[c],g).then((function(e){e?d(!0,"Native"):t("_blank")})).catch((function(){return t("_top")})):t(l.capabilitiesService.capabilities.pwaEnabled?"_blank":"_top")}},T=l.uploauration;T<=0?w():setTimeout(w,T)}else o.state===S.c.Cancelled?(l.uploadSubscription.unsubscribe(),t&&setTimeout((function(){return t.nativeElement.focus()}),0),m||d(!1)):o.state===S.c.Failed&&d(!1)}))}},e.prototype.uploadFiles=function(e,t,n,r){var l=this,u=s.a.fileTypeFromFileName(e[0].name),d=!1,p=function(e,p){if(!d){d=!0;var f=l.getClickDataForId(n,t,r);l.instrumentationService.logClickEvent(f.eventName,n,f.params.Area,e?l.uploadConfigService.config.uploadFileTypes.has(u)?s.a.referralFromFileType(u):c.a.OneDrive:"",p,f.params,f.metrics),Object(o.a)({eventName:f.eventName,id:n,area:f.params.Area,result:e?"Refer":"Navigate",target:e?l.uploadConfigService.config.uploadFileTypes.has(u)?Object(i.a)(u):a.a.Documents:"Other"})}},f=this.uploadManagerService.uploadFiles(e,t,this.uploadConfigService.config.oneDriveResources,r);f&&(this.uploadSubscription=f.subscribe((function(e){e.state===S.c.Cancelled?(l.uploadSubscription.unsubscribe(),p(!1)):e.state===S.c.Failed&&p(!1)})))},e.prototype.startUploadFlow=function(e,t,n,i,r){var o=this;this.documentService.selectFile(e).then((function(e){var a=e[0],l=s.a.fileTypeFromFileName(a.name);o.accessTokenService.getAccesigService.config.authType===b.a.MSA||o.uploadConfigService.config.capPopupEnabled,{category:"Upload",fileType:l}).then((function(){o.uploadFile(a,n,t,i,r)}))}))},e.prototype.logClick=function(e,t,n,r,l,u){var d=this.getClickDataForId(e,t,n);this.instrumentationService.logClickEvent(d.eventName,e,d.params.Area,l?this.uploadConfigService.config.uploadFileTypes.has(r)?s.a.referralFromFileType(r):c.a.OneDrive:"",u,d.params,d.metrics),Object(o.a)({eventName:d.eventName,id:e,area:d.params.Area,result:l?"Refer":"Navigate",target:l?this.uploadConfigService.config.uploadFileTypes.has(r)?Object(i.a)(r):a.a.Documents:"Other"})},e.prototype.getPartnerCorrelationId=function(){var e;return null!==(e=new URLSearchParams(window.location.search).get("partnerCid"))&&void 0!==e?e:void 0},e.ɵprov=T.kc({factory:function(){return new e(T.lc(u.b),T.lc(d.a),T.lc(m.a),T.lc(g.a),T.lc(l.a),T.lc(p.a),T.lc(b.b),T.lc(C.a),T.lc(y.a),T.lc(w.a),T.lc(f.a),T.lc(h.a))},token:e,providedIn:"root"}),e}()},"vSs+":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("Dn7E"),r=n("zvoD"),o=n("3Vsh"),a=n("y3b+"),l=n("hhzZ"),s=n("hZW2"),c=n("7Gwk"),u=n("Z0U4"),d=n("Uqr9"),p=n("casz"),f=n("TIi1"),h=n("4/We"),m=n("cgnd"),b=n("/I02"),g=n("Hp80"),v=n("pjz5"),S=n("keVe"),y=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d){var p=this;this.eventService=e,this.capabilitiesService=t,this.clientStartupConfigService=n,this.contextService=i,this.documentService=r,this.installConfigService=o,this.instrumentationService=a,this.performanceService=l,this.schedulerService=s,this.urlLauncherService=c,this.Disabled=!1,this.preloadedExperiences=[],this.getAdditionalConfig=function(){return{navigateToRoute:function(e){return p.officeRouteService.navigateTo(e)}}}}return e.prototype.getUpsellTrackingParam=function(){var e=this;return""!==this.upsellTrackingParam||(this.capabilitiesService.capabilities.isPwaInUwp?(this.upsellTrackingParam="PWA",["WordPad","CovidLockscreen","CovidStartMenu","CovidAMC","CovidActionCenter","HVAStartMenu","CGEAwareness"].forEach((function(t){e.checkOrigin(t)&&(e.upsellTrackingParam+="-"+t)}))):(this.upsellTrackingParam="HomePage",["RFMGraceToOnline","RFMGraceToOnline2","CovidLockscreen","CovidStartMenu","CovidAMC","CovidActionCenter","RFMSubExpB","RFMSubExpC","EduExp1","EduExp2","HVAStartMenu","MacWXPOO","GetGenuine","FreeOfframpFromDialog","FreeOfframpFromTBA","5DayPassEndedBizbar","GenericRFMBizbar","CommExp1","CommExp2"].forEach((function(t){e.checkOrigin(t)&&(e.upsellTrackingParam+="-"+(t.startsWith("RFM")?"RFM":t))})))),this.upsellTrackingParam},e.prototype.warmupDime=function(e){this.clientStartupConfigService.config.authType!==m.a.MSA||this.capabilitiesService.capabilities.isPwaInUwp&&window.prelaunchMode||-1===this.preloadedExperiences.indexOf(e)&&(this.preloadedExperiences.push(e),this.logDimeEvent("Dime_Warmup",e),this.scheduleWarmupTask({experiences:[e]}))},e.prototype.launchDime=function(e,t,i){var r=this;if(this.dimeDisabled)return this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"Upsell"})})):this.urlLauncherService.openUrl(t,"Upsell"),void this.logDimeEvent("Dime_Launch",e,"Failed","RedirectToPOC;DimeDisabled");var o=null,a=this.loadDime(),l=new Promise((function(e){o=setTimeout((function(){e(0)}),r.installConfigService.config.dimeTimeoutMs)}));return Promise.race([a,l]).then((function(a){if(o&&clearTimeout(o),1!==a)return r.dimeDisabled=!0,void r.logDimeEvent("Dime_Launch",e,"Failed","TimeOut");try{var l=r.getCampainIdFromTargetUrl(t),s={experience:e,campaignId:l,additionalConfig:r.getAdditionalConfig()};i&&(s.parentElementId=i),r.logDimeEvent("Dime_Launch",e,"Start"),r.eventService.broadcastEvent({name:"dimeUpsellDialogOpened",args:[]}),r.dime.launch(s,(function(){r.logDimeEvent("DimeTransactionCompleted",e),r.eventService.broadcastEvent({name:"convertedToPaid",args:[]}),r.consumerPublicDataService.forceRefreshAkloadPublicData",e,"",{hasBusinessLicense:t.hasBusinessLicense})})).catch((function(t){r.logDimeEvent("Dime_Force_Refresh_WorkloadPublicData",e,"Failed",t)}))})).then((function(t){r.logDimeEvent("Dime_Completed",e,t.status,t.metaData),r.eventService.broadcastEvent({name:"dimeUpsellDialogClosed",args:[]})}))}catch(i){r.dimeDisabled=!0,r.logDimeEvent("Dime_Launch",e,"Failed",i,"RedirectToPOC;LaunchException"),r.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(t,{action:"Upsell"})})):r.urlLauncherService.openUrl(t,"Upsell")}}))},e.prototype.scheduleWarmupTask=function(e){var t=this;return this.capabilitiesService.capabilities.quickAccessV1Enabled?(this.scheduleWarmupExperience(e),Promise.resolve()):this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"mruFailed"===e.name||"mruReady"===e.name})),Object(o.a)(1)).toPromise().then((function(){t.sduleWarmupExperience=function(e){var t=this;this.schedulerService.scheduleWork((function(){t.loadDime().then((function(n){1===n&&t.preloadDimeExperience(e)}))}),4)},e.prototype.loadDime=function(){var e=this;return this.loadDimePromise||(this.performanceService.mark("LoadDimeScript_Started"),this.loadDimePromise=new Promise((function(t){e.documentService.addScriptToPage(e.installConfigService.config.dimeJSUrl,(function(){e.logDimeEvent("Dime_LoadScript","","Succeeded"),e.performanceService.mark("LoadDimeScript_Completed"),e.initializeDime().then((function(){t(1)})).catch((function(){t(2)}))}),(function(){e.logDimeEvent("Dime_LoadScript","","Failed"),t(2)}),!1,"dimeScript")}))),this.loadDimePromise},e.prototype.checkOrigin=function(e){return this.clientStartupConfigService.config.sharedClientStartupContext.requestOrigin.toLowerCase()===e.toLowerCase()},e.prototype.getCampainIdFromTargetUrl=function(e){if(e&&e.indexOf("ocid=")>0){var t=v.a.getLocation(e),n=v.a.getQueryParams(t.search);return""!==n.ocid?n.ocid:"PROD_OfficeCom"}return"PROD_OfficeCom"},e.prototype.initializeDime=function(){var e=this;return new Promise((function(t,n){if(e.dime&&t(1),e.dimeDisabled&&t(2),"undefined"!=typeof Dime){e.performanceService.mark("DimeInitialize_Start");var i={partnerId:e.capabilitiesService.capabilities.pwaEnabled?"officepwa":"officedotcom",language:e.contextService.sharedContext.officeMarket,sessionId:e.clientStartupConfigService.config.sharedClientStartupContext.sessionId,authHint:e.capabilitiesService.capabilities.pwaEnabled?e.clientStartupConfigService.config.puid:e.clientStartupConfigService.config.userPrincipalName,userInfo:{puid:e.clientStartupConfigService.config.puid}};try{e.dime=new Dime(i),e.performanceService.mark("DimeInitialize_Complete"),e.logDimeEvent("Dime_Initialize","","Succeeded"),t(1)}catch(t){e.dimeDisabled=!0,e.logDimeEvent("Dime_Initialize","","Failed",t),n()}}else e.dimeDisabled=!0,e.logDimeEvent("Dime_Initialize","","Failed","Dime_Undefined"),n()}))},e.prototype.preloadDimeExperience=function(e){var t=this;this.dime&&(this.performanceService.mark("DimePreload_Start"),this.logDimeEvent("Dime_Preload",e.experiences.toString(),"Start"),this.dime.preload(e).catch((function(n){return t.logDimeEvent("Dime_Preload",e.experiences.toString(),"Failed",n)})))},e.prototype.logDimeEvent=function(e,t,n,r,o){void 0===t&&(t=""),void 0===n&&(n="");var a={},l=this.clientStartupConfigService.config.userCountryCode;a.DimeExperience=t,a.State=n,a.UserCountryCode=l;var s=o?o+";":"";a.DebugInfo="string"==typeof r?s+r:r?s+JSON.stringify(r):s,this.instrumentationService.logGenericEvent(e,a),Object(i.a)({featureName:"Upsell",eventName:e,area:"Other",params:{DimeExperience:t,State:n,DebugInfo:"string"==typeof r?s+r:r?s+JSON.stringify(r):s,UserCountryCode:l}})},e.ɵprov=S.kc({factory:function(){return new e(S.lc(c.a),S.lc(h.a),S.lc(m.b),S.lc(b.a),S.lc(s.a),S.lc(a.a),S.lc(l.a),S.lc(d.b),S.lc(p.a),S.lc(f.a),S.lc(u.a),S.lc(g.a))},token:e,providedIn:"root"}),e}()},vW6f:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("keVe").u)("S[e.Primary=ressed=19]="NeutralLighterPressed",e[e.WhiteSelected=20]="WhiteSelected",e[e.NeutralLighterSelected=21]="NeutralLighterSelected",e[e.Disabled=22]="Disabled"}(r||(r={}));var o="ohpAppTheme"},vcPZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f,h,m,b,g,v,S,y,C){void 0===o&&(o=[]),void 0===a&&(a=[]),void 0===l&&(l="callout"),void 0===s&&(s=!1),void 0===c&&(c=!1),void 0===u&&(u=!1),void 0===d&&(d=""),void 0===p&&(p=!1),void 0===f&&(f=null),void 0===y&&(y=!1),this.calloutElement=e,this.calloutType=t,this.area=n,this.title=i,this.subTitle=r,this.activationClasses=o,this.initialClasses=a,this.buttonIdPrefix=l,this.persistDismissal=s,this.persistCompletion=c,this.inline=u,this.imageClass=d,this.teachingCallout=p,this.dismissCalloutObservable=f,this.horizontalOffsetOverride=h,this.verticalOffsetOverride=m,this.footer=b,this.arrowDisplacementOffset=g,this.svgImage=v,this.calloutOnTop=S,this.centered=y,this.instrumentImpressionEvent=C,this.completed=!1,this.shouldScroll=this.checkScroll()}return e.prototype.isValid=function(){return(this.calloutElement||this.centered)&&(!!this.subTitle||!!this.title)},e.prototype.checkScroll=function(){switch(this.calloutType){case"BuyOffice":case"DiscoverTab":case"DragAndDrop":case"Edgeworth":case"Feedback":case"FormsFeatureCallout":case"Install":case"MyAccount":case"Recommended":case"SharedTab":case"Upload":return!0;default:return!1}},e}()},w1PR:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return y}));var i,r=n("QjXU"),o=n("CMIS"),a=n("FPnS"),l=n("NLr0"),s=n("XjVN"),c=n("beop"),u=n("1zhX"),d=n("f0qX"),p=n("dpyN"),f=n("6/Wk"),h=n("Q3dK"),m=n("zvoD"),b=n("vXf5"),g=(n("hhzZ"),nn("MFXD"));n("dFxn"),n("hZW2"),n("7Gwk"),n("Z0U4"),n("casz"),n("5aVq"),n("Ax7d"),n("BMb5"),function(e){e.Side="Side",e.Pattern="Pattern",e.Default="Default"}(i||(i={}));var y=function(){function e(e,t,n,i,r,o,a,l,s,c,u,d,p,f){this.documentService=e,this.eventService=t,this.capabilitiesService=n,this.configParserService=i,this.clientStartupService=r,this.contextService=o,this.instrumentationService=a,this.userContext=l,this.routeService=s,this.schedulerService=c,this.locService=u,this.windowService=d,this.shellShimService=p,this.webPwaService=f,this.fluentThemeSubject=new S.a,this.fluentThemeSubscription=this.fluentThemeSubject.asScopableObservable(),this.isSearchDarkModeEcsConfigEnable=!1}return Object.defineProperty(e.prototype,"fullBleedTheming",{get:function(){return this._fullBleedTheming},enumerable:!0,configurable:!0}),e.prototype.getEduHeaderImageForWidth=function(e,t){return t>=1366?e[1920]:t>=1024?e[1366]:t>=640?e[1024]:e[640]},e.prototype.updateVisualsTheme=function(t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return t!==e.officeThemeId?[2]:(o=n?this.getDefaultDarkTheme():{shades:this.getThemeShades(this.defaultTheme),reactShellTheme:this.defaultTheme,themeType:"App",themeId:e.baseThemeId},[4,this.shellShimService.getShellShim()]);case 1:return a.sent().Theme.SetThemeOverrideData({IsDarkTheme:n,PreferOfficeTheme:this.preferOfficeTheme(),UserPersonalizationAllowed:i,UserThemeId:e.baseThemeId,UserThemePalette:o.reactShellTheme,isMicaEnabled:!1}),this.eventService.broadcastEvent({name:"themeChanged",args:[Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o),o.reactShellTheme),{ThemeId:e.officeThemeId,IsDarkMode:n}),!0]}),[2]}}))}))},e.prototype.init=function(){var e=this,t=this.capabilitiesService.capabilities;this.defaultTheme=t.m365DefaultThemeEnabled?this.windowService.nativeWindow.m365DefaultThemeFluent:t.fluentHeader?this.windowService.nativeWindow.commercialDefaultThemeFluent:this.windowService.nativrvice.scheduleWork((function(){Promise.all([n.e(8),n.e(562)]).then(n.bind(null,"fFwu")).then((function(t){t.initializeFluentTheme(e.fluentThemeSubscription)}))}),0),this.isPWA=t.pwaEnabled,this.isPWAInWebView2=t.isPwaInWebView2,this.themeShadeClassPostfixes=new Map,this.grayscaleThemeShadeClassPostfixes=new Map,this.supportedAppThemes=new Map,this.currentRouteApp=g.b.Unknown;var i=this.createThemeChangeObservable();this.themeConfig=this.configParserService.parse("themeConfig"),this.initializeUserTheme();var o=this.getStartingTheme();this.themeShades=Object(l.a)(o).pipe(Object(c.a)(i),Object(u.a)(1)),this.darkModeSubscription=Object(s.b)(this.themeShades,this.routeService.getRouteChangeEndObservable()).pipe(Object(d.a)((function(t){var n=Object(r.__read)(t,2),i=n[1];return!("OfficeHome"!==i.currentRoute.route&&"Pwa"!==i.currentRoute.route&&"AppGallery"!==i.currentRoute.route&&"Start"!==i.currentRoute.route&&"ModernStart"!==i.currentRoute.route&&"Templates"!==i.currentRoute.route&&"Create"!==i.currentRoute.route&&"MyContent"!==i.currentRoute.route&&"M365Apps"!==i.currentRoute.route&&(!e.isSearchDarkModeEcsConfigEnable||"SearchPersonScoped"!==i.currentRoute.route&&"SearchPersonScopedOverview"!==i.currentRoute.route&&"SearchTopicScoped"!==i.currentRoute.route&&"SearchMeetingScoped"!==i.currentRoute.route&&"Search"!==i.currentRoute.route))&&n[0].theme.reactShellTheme.IsDarkMode})));var a=this.eventService.whenEventFired("darkModeAvailable",1).then((function(e){return e.args[0]}));this.setShowSearchDarkMode(a),this.processedInitialPageLoad=!1,this.displayedAppTheme=g.b.Unknown,this.initializeThemeUtilities(),o.userSelected||this.changeAppTheme(o.theme.shades,o.appPage),(t.wacStartPageEnabled||t.fluidSupportEnabled)&&(this.initializeAppThemeChangeHandler(),this.shellShimService.afterShellRendered.then((function(){var t=e.themeConfig.appPageTypeOnLoad&&g.a.fileTypeNameToFileType(e.themeConfig.appPageTypeOnLoad)||e.currentRouteApp;t!==g.b.Unknown&&e.changeShell(t),e.processedInitialPageLoad=!0})));var b=this.routeService.getRouteChangeEndObservable().pipe(Object(d.a)((function(t){return!(!t.currentRoute||e.capabilitiesService.capabilities.leftNavReact||"OfficeHome"!==t.currentRoute.route&&"Pwa"!==t.currentRoute.route)})),Object(p.a)());b.pipe(Object(f.a)(1)).subscribe((function(t){return Object(r.__awaiter)(e,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return(e=n.sent())&&e.Theme&&e.Theme.SetFullBleedEnabled&&e.Theme.SetFullBleedEnabled(t),[2]}}))}))}));var v=this.themeShades.pipe(Object(p.a)());this._fullBleedTheming=Object(s.b)(v,b).pipe(Object(d.a)((function(t){var n=Object(r.__read)(t,2),i=n[0],o=n[1];return{shouldFullBleed:e.determineFullBleedTheming(i)&&o,bleedColor:e.getNavBarColor(i),bleedFontColor:e.getBleedFontColor(i),themeData:i}}))).pipe(Object(u.a)()).pipe(Object(h.a)({shouldFullBleed:tColor:this.getBleedFontColor(o),themeData:o})),Object(s.b)(v,this.webPwaService.isStandalone).pipe(Object(m.a)((function(e){return Object(r.__read)(e,2)[1]}))).subscribe((function(t){var n=Object(r.__read)(t,1)[0];e.webPwaService.isOfficeApp()&&e.documentService.updateThemeColor(e.getNavBarColor(n))}))},e.prototype.getAppBrandTheme=functio],LighterAlt:e[8]}},e.prototype.getThemeShades=function(e){return[e.Darker,e.Dark,e.DarkAlt,e.Primary,e.Secondary,e.Tertiary,e.Light,e.Lighter,e.LighterAlt]},e.prototype.darkModeSupported=function(){var e="Search"===this.currentPage||"SearchPersonScoped"===this.currentPage||"SearchTopicScoped"===this.currentPage||"SearchMeetingScoped"===this.currentPage||"SearchSiteScoped"===this.currentPage||"SearchPersonScopedOverview"===this.currentPage;return this.isSearchDarkModeEcsConfigEnable&&e||!e&currentPage)||!(this.currentRouteApp===g.b.Fluid||this.currentRouteApp===g.b.FluidActivityBlueprint))},e.prototype.contrastModeSupported=function(){return!1},e.prototype.getDefaultDarkTheme=function(t){var n=e.darkTheme;return this.capabilitiesService.capabilities.fluentHeader&&(n=Object(r.__assign)(Object(r.__assign)({},n),this.defaultTheme.DarkTheme)),t&&(n.ThemeId=t),n.IsDarkMode=!0,{shades:this.getThemeShades(n),reactShellTheme:n,themeType:"App",themeId:n.ThemeId}},e.prototype.updateShellHeader=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return(n=i.sent())&&n.Header.UpdateHeaderLink(e,null,null,t),[2]}}))}))},e.prototype.getNavBarColor=function(e){var t=e.theme.reactShellTheme;return t?t.NavBar||t.Primary:e.theme.shades[b.c.Primary]},e.prototype.getBleedFontColor=function(e){var t=e.theme.reactShellTheme;return t&&t.DefaultText?t.DefaultText:"#FFFFFF"},e.prototype.determineFullBleedTheming=function(me.reactShellTheme.FullBleedImages},e.prototype.changeShell=function(e){this.changeShellAppTheme(e),this.changeShellAppHeader(e),this.changeShellHelpPane(e)},e.prototype.changeShellAppTheme=function(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,l,s,c;return Object(r.__generator)(this,(function(u){switch(u.label){case 0:return!this.supportedAppThemes.has(e)||e===this.displayedAppTheme&&!t?[2]:(n=this.supportedAppThemes.get(e),(i=this.showDarkMode()&&n.darkTheme||n.theme)?(o=this.userTheme,a=Object(r.__assign)(Object(r.__assign)({},i),{IsDarkMode:this.showDarkMode(),ThemeId:o.themeId,ThemeType:o.themeType}),l=this.getThemeShades(i),e!==this.displayedAppTheme&&this.changeAppTheme(l,e),[4,this.shellShimService.getShellShim()]):[2]);case 1:return s=u.sent(),c=this.capabilitiesService.capabilities.fluentRefresh?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},this.defaultTheme),n.theme),{AppName:n.theme.Primary,Accent:n.theme.Dark}):n.theme,n.darkTheme&&(c.DarkTheme=this.capabilitiesService.capabilities.fluentRefresh?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},this.defaultTheme.DarkTheme),n.darkTheme),{AppName:n.darkTheme.Primary,Accent:n.darkTheme.Primary}):n.darkTheme),s.Theme.SetAppBrandTheme(c),this.eventService.broadcastEvent({name:"themeChanged",args:[a,!1]}),this.displayedAppTheme=e,[2]}}))}))},e.prototype.changeShellAppHeader=function(e){if(this.supportedAppThemes.has(e)){var t=this.supportedAppThemes.get(e);this.updateShellHeader(t.headerText)}},e.prototype.changeShellHelpPane=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return this.supportedAppThemes.has(e)&&(t=this.supportedAppThemes.get(e)).helpPaneNamespace?[4,this.shellShimService.getShellShim()]:[2];case 1:return n.sent().NFD.UpdateHelpNamespace(t.helpPaneNamespace),[2]}}))}))},e.prototype.resetShellHelpPane=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e="",e=this.isPWA?this.clientStartupService.config.authType===v.a.OrgId?"IWPWA":"MSAPWA":this.clientStartupService.config.authType===v.a.OrgId?"IWAPP":"IWAPPC",[4,this.shellShimService.getShellShim()];case 1:return t.sent().NFD.UpdateHelpNamespace(e),[2]}}))}))},e.prototype.resetShellTheme=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return this.displayedAppTheme===g.b.Unknown?[2]:(this.clientStartupService.config.authType===v.a.MSA&&this.changeAppTheme(this.userTheme.shades),[4,this.shellShimService.getShellShim()]);case 1:return e.sent().Theme.SetAppBrandTheme(this.defaultTheme),this.eventService.broadcastEvent({name:"themeChanged",args:[Object(r.__assign)({IsDarkMode:this.showDarkMode(),ThemeId:this.userTheme.themeId,ThemeType:this.userTheme.themeType},this.userTheme.reactShellTheme),!1]}),this.displayedAppTheme=g.b.Unknown,[2]}}))}))},e.prototype.resetShellHeader=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return this.updateShellHeader(!this.isPWA||this.isPWAInWebView2&&this.windowService.nativeWindow.hwaTitleBarEnabled?this.themeConfig.homePageTitle:""),[2]}))}))},e.prototype.resetShell=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return this.resetShellTheme(),this.resetShellHeader(),this.resetShellHelpPane(),[2]}))}))},e.prototype.initializeThemeUtilities=function(){var e=this;this.themeShadeClassPostfixes.set(b.c.Darker,"tdr"),this.themeShadeClassPostfixes.set(b.c.Dark,"td"),this.themeShadeClassPostfixes.set(b.c.DarkAlt,"tda"),this.themeShadeClassPostfixes.set(b.c.Primary,"tp"),this.themeShadeClassPostfixes.set(b.c.Secondary,"ts"),this.themeShadeClassPostfixes.set(b.c.Tertiary,"tt"),this.themeShadeClassPostfixes.set(b.c.Light,"tl"),this.themeShadeClassPostfixes.set(b.c.Lighter,"tlr"),this.themeShadeClassPostfixes.set(b.c.LighterAlt,"tlra"),this.grayscaleThemeShadeClassPostfixes.set(b.a.White,"w"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterAlt,"nla"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighter,"nlr"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLight,"nl"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralQuaternaryAlt,"g50"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralQuaternary,"g40"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralTertiaryAlt,"nta"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralTertiary,"nt"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralSecondaryAlt,"nsa"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralSecondary,"ns"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralPrimaryAlt,"npa"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralPrimary,"np"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralDark,"nd"),this.grayscaleThemeShadeClassPostfixes.set(b.a.Black,"bl"),this.grayscaleThemeShadeClassPostfixes.set(b.a.WhiteHover,"wh"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterAltHover,"nlah"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterHover,"nlh"),this.grayscaleThemeShadeClassPostfixes.set(b.a.WhitePressed,"wp"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterAltPressed,"nlap"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterPressed,"nlp"),this.grayscaleThemeShadeClassPostfixes.set(b.a.WhiteSelected,"ws"),this.grayscaleThemeShadeClassPostfixes.set(b.a.NeutralLighterSelected,"nls"),this.grayscaleThemeShadeClassPostfixes.set(b.a.Disabled,"d"),this.themeShades.subscribe((function(t){if(t.userSelected)if(e.userTheme=t.theme,e.currentRouteApp===g.b.Unknown||e.currentRouteApp!==g.b.FluidActivityBlueprint&&e.currentRouteApp!==g.b.Fluid)if(e.currentRouteApp===g.b.Unknown)e.isPWA&&(e.isPWAInWebView2&&e.windowService.nativeWindow.hwaTitleBarEnabled?(e.documentService.addOrUpdateStyleTag("titleBarTitleStyles",".o365sx-appName { padding-left: 24px !important; padding-right: 24px !important; margin-right: -24px !important; }"),e.updateShellHeader(e.themeConfig.homePageTitle)):e.updateShellHeader("")),e.changeAppTheme(e.userTheme.shades);else{var n=e.supportedAppThemes.get(e.currentRouteApp),i=e.showDarkMode()&&(null==n?void 0:n.darkTheme)||(null==n?void 0:n.theme),r=i?e.getThemeShades(i):e.userTheme.shades;e.changeAppTheme(r,i?e.currentRouteApp:null)}else e.changeAppTheme(e.userTheme.shades)}))},e.prototype.setShowSearchDarkMode=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,e];case 1:return t.isSearchDarkModeEcsConfigEnable=n.sent(),[2]}}))}))},e.prototype.initializeAppThemeChangeHandler=function(){var e=this;this.routeService.getRouteChangeStartObservable().pipe(Object(m.a)((function(e){var t;return e.currentRoute&&"Content"!==e.currentRoute.route||"Content"===(null===(t=e.currentRoute)||void 0===t?void 0:t.route)&&(e.currentRoute.app===g.b.Fluid||e.currentRoute.app===g.b.FluidActivityBlueprint)}))).subscribe((function(t){e.currentRouteApp=t.currentRoute&&t.currentRoute.app?t.currentRoute.app:g.b.Unknown,e.currentPage=t.currentRoute.route,e.processedInitialPageLoad&&(e.currentRouteApp===g.b.Fluid||e.currentRouteApp===g.b.FluidActivityBlueprint?(e.resetShellTheme(),e.resetShellHeader(),e.changeShellHelpPane(e.currentRouteApp),e.changeAppTheme(e.userTheme.shades)):e.currentRouteApp?e.changeShell(e.currentRouteApp):(e.resetShell(),!e.capabilitiesService.capabilities.darkModeEnabled&&e.preferOfficeTheme()||e.changeAppTheme(e.userTheme.shades)))}))},e.prototype.initializeUserTheme=function(){var e=this.themeConfig;this.supportedAppThemes.set(g.b.Word,{theme:this.configThemeShadesToTheme(e.wordThemeShades),darkTheme:this.configThemeShadesToTheme(e.wordThemeShadesDark),headerText:this.locService.WordName,helpPaneNamespace:"WDWAENDUSER"}),this.supportedAppThemes.set(g.b.Excel,{theme:this.configThemeShadesToTheme(e.excelThemeShades),darkTheme:this.configThemeShadesToTheme(e.excelThemeShadesDark),headerText:this.locService.ExcelName,helpPaneNamespace:"XLWAENDUSER"}),this.supportedAppThemes.set(g.b.PowerPoint,{theme:this.configThemeShadesToTheme(e.powerpointThemeShades),darkTheme:this.configThemeShadesToTheme(e.powerpointThemeShadesDark),headerText:this.locService.PowerPointName,helpPaneNamespace:"PPWAENDUSER"}),this.supportedAppThemes.set(g.b.Sway,{theme:this.configThemeShadesToTheme(e.swayThemeShades),darkTheme:this.configThemeShadesToTheme(e.swayThemeShadesDark),headerText:this.locService.SwayName,helpPaneNamespace:"STORYIM"}),this.supportedAppThemes.set(g.b.OneNote,{theme:this.configThemeShadesToTheme(e.onenoteThemeShades),darkTheme:this.configThemeShadesToTheme(e.onenoteThemeShadesDark),headerText:this.locService.OneNoteName,helpPaneNamespace:"ONWAENDUSER"}),this.supportedAppThemes.set(g.b.Forms,{theme:this.configThemeShadesToTheme(e.formsThemeShades),darkTheme:this.configThemeShadesToTheme(e.formsThemeShadesDark),headerText:"Forms",helpPaneNamespace:"MICROSOFTFORMS"}),this.supportedAppThemes.set(g.b.Visio,{theme:this.configThemeShadesToTheme(e.visioThemeShades),darkTheme:this.configThemeShadesToTheme(e.visioThemeShadesDark),headerText:this.locService.VisioName,helpPaneNamespace:"VIWAENDUSER"}),this.supportedAppThemes.set(g.b.Stream,{theme:this.configThemeShadesToTheme(e.streamThemeShades),darkTheme:this.configThemeShadesToTheme(e.streamThemeShadesDark),headerText:this.locService.StreamName,helpPaneNamespace:"STREAM"}),this.supportedAppThemes.set(g.b.Clipchamp,{theme:this.defaultTheme,darkTheme:this.defaultTheme.DarkTheme,headerText:this.locService.ClipchampName}),this.supportedAppThemes.set(g.b.Fluid,{theme:null,headerText:e.homePageTitle,helpPaneNamespace:"FLUID365"}),this.supportedAppThemes.set(g.b.FluidActivityBlueprint,{theme:null,headerText:e.homePageTitle,helpPaneNamespace:"FLUID365"}),this.userTheme=this.getInitialUserTheme()},e.prototype.configThemeShadesToTheme=function(e){return this.getAppBrandTheme(e.map((function(e){return"#"+e})))},e.prototype.getGreyShades=function(){return this.capabilitiesService.capabilities.fluentRefresh?this.showDarkMode()?e.grayscaleThemeShadesFluentDark:e.grayscaleThemeShadesFluent:this.showDarkMode()?e.grayscaleThemeShadesDark:e.grayscaleThemeShades},e.prototype.changeAppTheme=function(t,n){var i=this;if(t&&9===t.length){var r=this.showDarkMode(),o=this.showContrastMode(),aerties.length;o++){var a=e.themeProperties[o],l=a.propName;i.contextService.isRtl&&(l=l.replace(/(left|right)/g,(function(e){return"left"===e?"right":"left"}))),r+="."+b.b+" .ms-"+a.className+"-"+t+"{"+l+":"+n+"}";for(var s=0;s<e.themeSelectorPostfixes.length;s++)r+="."+b.b+" .ms-"+a.className+"-"+t+"-"+e.themeSelectorPostfixes[s]+"{"+l+":"+n+"}"}return r},l=this.getGreyShades().reduce((function(e,t,n){var r=i.grayscaleThemeShadeClassPostfixes.get(n);return""+e+a(r,t)}),""),s=t.reduce((function(e,t,n){var r=i.themeShadeClassPostfixes.get(n);return""+e+a(r,t)}),l);if(this.isPWA&&(this.documentService.addOrUpdateStyleTag("scrollBarStyles","#officeHome__scroll-content.scroll-content { color-scheme: "+(r?"dark":"light")+"; }"),this.isPWAInWebView2&&this.windowService.nativeWindow.hwaTitleBarEnabled))try{MyOffice.TitleBar.ControlsOverlay.handleThemeChange(JSON.stringify(this.usee.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}},e.prototype.hasRequiredDarkShades=function(e){var t=null==e?void 0:e.DarkTheme;return!!((null==t?void 0:t.Darker)&&(null==t?void 0:t.Dark)&&(null==t?void 0:t.DarkAlt)&&(null==t?void 0:t.Primary)&&(null==t?void 0:t.Secondary)&&(null==t?void 0:t.Tertiary)&&(null==t?void 0:t.Light)&&(null==t?void 0:t.Lighter))},e.prototype.preferOfficeTheme=function(){return this.clientStartupService.config.authType===v.a.MSA?this.themeConfig.preferOfficeTheme:this.userTheme.reactShellTheme.PreferOfficeTheme},e.prototype.changeFluentTheme=function(t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,s,c,u,d,p,f=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return this.lastFluentTheme=s=""+(l=this.userTheme.themeId)+t+n+i,c=function(i,r,o,l,s){var c={mode:t?a.a.dark:n?a.a.highContrast:a.a.default,lightBrandColors:f.brandThemeFromBase(i),darkBrandColors:r&&f.brandThemeFromBase(r),themeId:null!=s?s:e.baseThemeId};f.capabilitiesService.capabilities.themeOverridesEnabled&&(c.overridePaletteMapping=l,c.overrideTokenMapping=o),f.fluentThemeSubject.next(c)},i&&this.supportedAppThemes.has(i)&&(u=this.supportedAppThemes.get(i)).theme?(c(u.theme,u.darkTheme,!0,i===g.b.Forms||i===g.b.Sway,g.b[i]),[2]):(d=this.clientStartupService.config.authType===v.a.MSA||(null==l?void 0:l.toLowerCase())===e.baseThemeId||l===e.staticDarkTheme,p=this.preferOfficeTheme(),d&&(p||t)?this.capabilitiesService.capabilities.m365DefaultThemeEnabled?(c(this.windowService.nativeWindow.m365DefaultThemeFluent,this.windowService.nativeWindow.m365DefaultThemeFluent.DarkTheme,!0,!1,p?e.m365ThemeId:l),[2]):(c(this.windowService.nativeWindow.commercialDefaultThemeFluent,this.windowService.nativeWindow.commercialDefaultThemeFluent.DarkTheme,!0,!1,p?e.officeThemeId:l),[2]):this.clientStartupService.config.authType===v.a.MSA?(c(this.windowService.nativeWindow.defaultLegacyBlueThemeFluent,this.windowService.nativeWindow.defaultLegacyBlueThemeFluent.DarkTheme,!1,!1,e.officeThemeId),[2]):[4,this.shellShimService.getShellShim()]);case 1:return r.sent().Theme.GetUserThemeJsonByID(l,(function(n){var i;if(s===f.lastFluentTheme){var r=f.hasRequiredDarkShades(n);if(!n||t&&!r){if(!n){var a=((i={}).DebugInfo=l,i);f.instrumentationService.logGenericEvent("Unknown_Theme",a),Object(o.a)({eventName:"Unknown_Theme",errorType:"Other"})}if(f.capabilitiesService.capabilities.m365DefaultThemeEnabled)return void c(f.windowService.nativeWindow.m365DefaultThemeFluent,f.windowService.nativeWindow.m365DefaultThemeFluent.DarkTheme,!0,!1,e.m365ThemeId);var u=f.windowService.nativeWindow.commercialDefaultThemeFluent;c(u,u.DarkTheme,!0,!1,e.baseThemeId)}else c(n,r?n.DarkTheme:void 0,r,!1,l===e.baseWithOfficeThemePreferredThemeId?e.officeThemeId:l)}})),[2]}}))}))},e.staticDarkTheme="dark-mode",e.baseThemeId="base",e.officeThemeId="Office",e.m365ThemeId="harmony",e.baseWithOfficeThemePreferredThemeId="BaseWithOfficeThemePreferred",e.darkTheme={IsDarkMode:!0,ThemeType:"User",ThemeId:e.staticDarkTheme,NavBar:"#1B1A19",Accent:"#F7894A",Dark:"#F7894A",Darker:"#F7894A",DarkAlt:"#F7894A",Primary:"#F7894A",Secondary:"#F7894A",Tertiary:"#F7894A",Light:"#F7894A",Lighter:"#F7894A",LighterAlt:"#F7894A"},e.eduThemeBackplateOverrides={backpack:{"background-color":"rgba(255, 179, 221, 0.9)"},unicorn:{"background-color":"rgba(72, 117, 46, 0.9)",color:"#FFFFFF"}},e.themeProperties=[{className:"fcl",propName:"color"},{className:"bgc",propName:"background-color"},{className:"bcl",propName:"border-color"},{className:"bclt",propName:"border-top-color"},{className:"bclb",propName:"border-bottom-color"},{className:"bclr",propName:"border-right-color"}],e.themeSelectorPostfixes=["f:focus","h:hover","a:active","af:after"],e.grayscaleThemeShades=["#FFFFFF","#FAF9F8","#F3F2F1","#EDEBE9","#E1DFDD","#D2D0CE","#C8C6C4","#A19F9D","#8A8886","#605E5C","#3B3A39","#323130","#252423","#000000","#F3F2F1","#EDEBE9","#E1DFDD","#C8C6C4","#C8C6C4","#C8C6C4","#E1DFDD","#C8C6C4","#EDEBE9"],e.grayscaleThemeShadesDark=["#252423","#1B1A19","#F3F2F1","#323130","#323130","#3B3A39","#484644","#A19F9D","#8A8886","#B3B0AD","#3B3A39","#D2D0CE","#E9E8E8","#FFFFFF","#323130","#323130","#252423","#1B1A19","#1B1A19","#1B1A19","#323130","#252423","#1B1A19"],e.grayscaleThemeShadesFluent=["#FFFFFF","#FAFAFA","#F5F5F5","#F0F0F0","#EBEBEB","#E5E5E5","#E0E0E0","#D1D1D1","#BDBDBD","#707070","#616161","#424242","#242424","#000000","#F5F5F5","#F0F0F0","#EBEBEB","#E0E0E0","#DBDBDB","#D6D6D6","#EBEBEB","#E0E0E0","#F0F0F0"],e.grayscaleThemeShadesFluentDark=["#292929","#1F1F1F","#141414","#3D3D3D","#333333","#2E2E2E","#525252","#525252","#5C5C5C","#999999","#ADADAD","#D6D6D6","#FFFFFF","#FFFFFF","#3D3D3D","#333333","#292929","#1F1F1F","#141414","#0A0A0A","#383838","#242424","#141414"],e}()},wwmn:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("officeHomeApiConfig")||{authTypeHeader:null,authVersionHeader:null,correlationIdHeader:null,defaultTimeoutInMs:3e5,externalTrafficHeader:null,featureOverrides:null,featureOverridesParamName:null,flightOverrides:null,flightOverridesParamName:null,jwtAuthEnabled:!1,jwtAuthOnOfficeHome:!1,mockRequestHeader:null,tenantIdHeader:null,testTrafficHeader:null,userIdHeader:null,workloadQueryParameter:null}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},"x+6c":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},xIlw:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return ",(function(){return r}));var i=n("QjXU"),r=(n("cj6A"),function(e){function t(t){var n=eadService.preload(n.preloadPath)}))||this;return n.preloadService=t,n}return Object(i.__extends)(t,e),t.prototype.enabled=function(){return!!this.preloadPath},t}(n("adME").a))},xSeq:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e,t){this.elementRef=e,this.changeDetectorRef=t}return e.prototype.ngAfterViewInit=function(){this.focusOnLoad&&(this.elementRef.nativeElement.focus(),this.detectChanges&&this.changeDetectorRef.detectChanges())},e}()},xoWf:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"y3b+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("installConfig")||{consumerDirectInstallUrl:"",consumerInstallLink:"",consumerSSUInstallLink:"",commercialMySoftwarePageUrl:"",dimeEnabled:!1,dimeJSUrl:"",dimeTimeoutMs:5e3,goPremiumUrl:"",goPremiumUrlPremiumTemplates:"",welcomeBadgeOneDriveUrl:"",installApiRoot:"",installApiSWEnabled:!1,pwaInstallMoveEnabled:!1,resources:null,sendRequestId:!1,shellGoPremiumUrl:"",wizardImageAssets:"",wizardSupportLink:"",learnAboutM365Link:"",needHelpLink:"",buyOffice365Url:"",haveOfficeProductKeyUrl:"",needHelpInstallingOfficeUrl:"",ecsInstallNoLicenseOptionsEnabled:!1,installMessagePopupEnabled:!1,paidConsumerSubscriptionBenefitsUrl:""}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()},y9oG:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),r=n("BaAg");function o(e,t,n){var o;return void 0===n&&(n={}),Object(i.__assign)(((o={}).ResourceId=e,o.WacHostEntry=t.wdOrigin,o.t.fileType),o),n)}},z0B0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("AGMK");function r(e){var t=function(){return e(Object(i.b)())};return document.addEventListener("visibilitychange",t),t}},zGJG:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})"C(e,t,n){"use strict";var i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=new Promise((function(e){return i=e}));function o(e){i(e)}},zwsB:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("formsConfig")||{defaultImagesAvailable:null,defaultThumbnailColor:null,formsApiPath:null,formsCdnPath:null,formsMsaTenantId:null,formsThemingConfigUrl:null,formsThumbnailImagesUrl:null,neoPortalPageEnabled:!1,groupPhotoRequestInBatch:!1,termsOfServiceLinkOrgId:null}}return e.ɵprov=r.kc({factory:function(){return new e(r.lc(i.a))},token:e,providedIn:"root"}),e}()}});
//# sourceMappingURL=app-bundle-7b7c9f72694be0c1fe3f.js.map