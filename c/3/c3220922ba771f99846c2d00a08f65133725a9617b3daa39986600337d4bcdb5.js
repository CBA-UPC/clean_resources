g367CB268B1094004A3689751E7AC568F.Modules.OnClickVideo=function(n){function f(n,t){this._context=n;this._func=t;this._isOneTime=!1;this._called=!1;this._timeout=null;this._timeoutCallback=null;this._canceledByTimeout=!1;this._disabled=!1;this._callInterval=null;this._callGateOpen=!0;var i=this;this._value=function(){return(i._timeout&&(clearTimeout(i._timeout),i._timeout=null,i._timeoutCallback=null),i._canceledByTimeout||i._disabled)?undefined:i._isOneTime&&i._called?undefined:(i._called=!0,i._callInterval!=null)?i._callGateOpen?(i._callGateOpen=!1,setTimeout(function(){i._callGateOpen=!0},i._callInterval),i._func.apply(i._context,arguments)):undefined:i._func.apply(i._context,arguments)}}function a(n){if(!n.getElementById("g367CB268B1094004A3689751E7AC568F_videoButtons_style")){var t=n.createElement("style");t.id="g367CB268B1094004A3689751E7AC568F_videoButtons_style";t.innerHTML=".$inf-hover { display: none } .$inf-videoButtons-container { position: relative;  } .$inf-videoButtons-container:hover .$inf-hover { display: block } .$inf-playerButton { position: absolute; background-color: rgba(24,35,53,0.8); border-radius: 4px; font-size: 22px; line-height: 30px; padding: 3px !important; cursor: pointer; opacity: 0.8; z-index: 100;  transform: translateZ(0); -webkit-transform: translateZ(0);} .$inf-volumeButton { right: 15px; bottom: 15px } .$inf-volumeButton-top { right: 15px; top: 15px } .$inf-closeButton { right: 15px; top: 15px } .$inf-skipButton { color: rgba(255,255,255,0.8); font-size: 16px; font-family: Tahoma; padding: 3px; padding-left: 12px !important; padding-right: 12px !important; line-height: 28px; border-radius: 2px; opacity: 0.8; border-style: solid; border-width: 1px; min-width: 61px; border-color: #4d4d4d } .$inf-playButton { margin: auto !important; width: 50px; height: 50px; top: 0; left: 0; right: 0; bottom: 0 } .$inf-volumeButton-icon-on, .$inf-volumeButton-icon-off { width: 28px; height: 28px; background-size: contain; opacity: 0.5; background-position: center; } .$inf-closeButton-icon { width: 24px; height: 24px; background-size: contain; margin: 2px; opacity: 0.5; background-position: center; } .$inf-playButton-icon, .$inf-replayButton-icon { width: 50px; height: 50px; background-size: contain; opacity: 0.5; background-position: center; } .$inf-skipButton-active { color: rgba(222,222,222,1); opacity: 1; } .$inf-skipButton-active:hover { background-color: rgba(24,35,53,1); border-color: #c7c7c7 } .$inf-volumeButton-icon-on:hover, .$inf-closeButton-icon:hover, .$inf-playButton-icon:hover, .$inf-replayButton-icon:hover, .$inf-volumeButton-icon-off:hover { opacity: 1; } .$inf-volumeButton-icon-on { background-image: url('data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMjHxIGmVAAACH0lEQVRYR8XXz4sPcRzH8bV+nBTKjwPlZ65uDk7yJyAHKRdXNhFOSv6DlQMnJ+Xkb+CAcpGUIlIOImVzWoWv53N23prv7Hu+OzszffdVjzKv/cx3Pvb7mc/MzoxGozWVltOUli1sxiUcr3SdpOUKduAFzE9kY8IB7K91Y9JyAi/+GtVk43QQv/AH97AVy8YtKybILm6ysfJ/7gQiH3EEY+PGDibYieziJhsfvOBTRBZwFP/HVAc32YP3aEp9/HW4Rs6Vx7O4jcg37EUxvnpiZqWLm/o5XxB5gE2wv2pRxt+KE5s4gTYXN/XzzuA7Io+wDv7MCUXOo3ECh+CiaZPs/N2orhn3DPst+GpB3mHW8iF+1CyibfyMO3iCCyh+tXDhfoZxv9gO+2sWZU5Y9I274t+lfxZ5jI3ws09alLmBmNhvCzI/xAT8jMuoLr6bsPe7/2BBnsFOsZO+HGoC2oa3FsRFuB72dy2Im9IG2N23IAtDTkAXLcocht2V4mgpu2B3qzgiHvRNXFxrOoE2X0F0g38FbRbhc9hp0EXobVhN9TY8ZVGm8TYcYiOaR+eNKLMPbZ4DJjt/VVtxk64Po9Po/TAKXR7HnxDp9TgOTuINmlIfPwdX+dnyuNcLSWh6HzTZ+DDIK1lY7Uupr+SDvZQGJ/EK1WTjFG/Fg72WB2+l2Mm8pbIxwdvZvw+ynxXSsgV3PxfbsUrXSVpOU1pOz2jmH8zQlWJH4tZcAAAAAElFTkSuQmCC') } .$inf-volumeButton-icon-off { background-image: url('data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4yMfEgaZUAAAI7SURBVFhHxZfLSsNAFIa9C0Wq4kqqgigoilt9E3Eh+AAu3elb+BC6c+nKleBCENS4EAQveKHQ0lJ7oRfajv9fMjGdTJppTeriI50zp+d8MzFjOiCE+Fe0wX6iBhK5XO6gXq8vK/FA0un0cLFY3KnVaqu6eT/aBtVq9SSVSolyuZxsNpvr7rkAYvjORTabFZVK5Q7jQWXel7YBBPYKhYIgphLYsQnkXubzeVEqlQRqfCE+pub54QlgC/exlUYSyI0j54q5WLkUeMNc7wLEUGIKTa9l81AFSCcJNJtB7MbdPHQBokpgvGTf81u1eSQCxC3B4uCeY7V5ZAJEShA20TUnoQhYljWEIsdY8QOKnqL5COOUsG+FtjkJRQCrTLAJV8tnG4XPTSVCEcAxvIBiFdmkG4lQBFBgHsVQ/7eBqURkAsREIlIBEiQRuQDpJGELvKg1O+EJBAkQPwkK4HvfGG+odf3wBCggV8OrmyAJeVgh1/h9QhcchcQZiqRxdUCzOqVMJOxbYiShDRIUi6PApAQSmyzKBmFKaIN+NBqNNezCZ5gS2mAn0GgFRd/9JJDTegRNJTwBE/jWjKKvLK5K8O8HOa2XUhOJtkE3oOAieHZL2OdACvPjMi9IwvnQC/zHhaJPUsIW8JyEqgRwJJykPzCH5o8sbj+mH4h5jmK3BHKSuLZ+/LQl9Qp2YhbNrUwmwx2wdDmEEhTAryjuxC5j2sQemUbxQwhsaeYcILGNHTjC5xjH2qR+og32DzHwA/mS7LQFix2YAAAAAElFTkSuQmCC') } .$inf-playButton-icon { background-image: url('data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4yMfEgaZUAAAHtSURBVGhD3dZLahRRHEbxaKIxW4iKiUhExKEDdyEIIkiIDwSRQIZxHyKC+EBExIW4AEVQRFQ0E1eQh5HyXPCO+rTVVV23yr8XfpNDd936Jk3PVFX1X9AYkcaINEakMSKNEWmMSGNEGiPSOMZBXMB5HPjT/hkaxQJeI583uIQ0zj7fO43iBuy8xWUMPkijuIu/nXe4gsEGaRR1Q/J5j6uYhT2nGI1i0iH5fMAq5mDP65xG0XRIPh+xhuKDNIq2Q/L5hOsoNkijmHZIPp9xE4dg97SmUXQ1JJ8vuIXDsPsa0yi6HpLPV9zG1IM0ilJD8vmGO5iH3V9Loyg9JJ/vWMcR2HuMpVH0NSSfLVyDvYvSKPoeks9F2PuM0CiGGvIA9j4jNIqhhqQfAHufERpF30N+4Qkm/iegUfQ1JA14hXOw9xhLoyg9JA14ibOw+2tpFKWGpAEvcAZ278Q0iq6H7OM5TsPua0yj6GrITzzDCuye1jSKaYekAU9xCvb8qWkUbYekAY9xEvbczmgUTYfs4RGWYc/rnEYx6ZBdPMQS7DnFaBR1Q9KA9L/oBOz7xWkUG7Czg/s4DvtebzSKRfxAPtu4h2Owz/dO4xhHsYn0jzQNs88MRmNEGiPSGJHGiDRGpDEijRFpjEhjRBrjqWZ+A44vQYizqKsgAAAAAElFTkSuQmCC') } .$inf-replayButton-icon { background-size: 44px 44px; background-repeat: no-repeat; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfiCwIREhg8/chxAAADxUlEQVRo3sVZS0hUURj+7tVKLYtemg69o1J7LFxEZBC1aVEWFRQRPS1IWmQvN0GrIAoiWrQKItpEEEX02lSboAiKSrRMDdIatRKjolHUvhY6ZjP/ed25Tt8wMPzn///vu2f+c84953hwBEdhOcpQiDzkIw/5AKJoHfg24IH30zVjPLHHCQaPIh7kPf6iDl28zwOcEUTAGL7kJEWbz018QRfUsJo5bgIiJGuYl2QfwV1860QeR5T7mGkvoJgkWccp/1i3sDkQeRz13GgrYOlgSGTAksvLKZHH8YTTbQSsHgxo5FSAS9gYCj1JtrPMLGDzkID3PMme0OhJspu7TAL2hkoo4Swzknn9wV/jrOs1KKpwPVlCOgUA63Am0fR3nNoLIGrxCI/Rgs9oB1CICCIoQjkWmHuBNd4lOavdkGvmUU5WKpvFKr42lqM8InjDSP6Om80zG31u5wdtnnZxXuBDbVAvzzDb+j/KYjW7NdmeSEHPtQIqrSsknm85P2vybUgO0M97P7jSWcIMTT28SRqQ/GKogC5BtUlCLmuU+SoSnbtpQi/3OEuYya+KbB+Z9W/Z2OGYs4QVylXl8FC3fEsB5GlnCccVmV4BgDfgNBf1SZExdIif916fk4BsNCAiNk33muMTSy+uDKH4ig50eDHXZ5XhxXgCF8WmNbgQDoepDzJYK/4Jd9NCDwA8IgqIcXS6BMxRFOJaP/XkNvAaUSc2zE2TAAC3RGth+gTUitaC9AmI/u8e+CT3gMdx8dlwKLxvYfMzF98F889MtCFLcB/t/UpPx/joFO0TQ2cqFK1RHy1iw/zQBcjLUauPN2LDwvT1wFuxYVHoAkrceqA0dAHlcg+A8xTLRIkjgRa6xagJPWLMjlCff71o7cJDAHwkaotKu/mAz695IfEBXBGjCrA1tOffiWLRfrtf31jGRH1tDOXMgNn8qKiAaXGXqwqH86EI0L6W97usUbj0clnK9DYbE2ayTeHUwaKU6K23ZhVU4QMjgentN6f0+FTpWsdZgegdt+el7FO6d7Lcmd71gALgBU3Ab57iKGvyIEc0AMdrNZMtrORII3nQQyoAYJliSvqLZh7ibCV5gGO6hBdSbsI16SU1AfW4jWdoRRta4XZQCexWHFQOSqjicOKsTQmdGzb6m1YrLH2eH56nd1jguc1wPecK84VFkoTFbAqN3ubKRpAwnndCobe7tFKIWGcc13rYX9tpSnIrGwKRu11cakVkci9fOZG7X91ayJjK/bxjmKydL6/N026ijBysQgmmoGDg66d2ff8H8zD8ZUGJxN4AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMTEtMDJUMTc6MTg6MjQrMDE6MDDK7NujAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTExLTAyVDE3OjE4OjI0KzAxOjAwu7FjHwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=') } .$inf-closeButton-icon { background-image: url('data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMjHxIGmVAAABmklEQVRIS42W0UoDMRBF+w2LlD70C0oRkVKKFH9aREREfBAR6YMPRXwSERHxI+o92UnJ2kySAxc2yZ1JOruz3VFkt9t10qW0kWY23Yxi5tKzdCF1Nt2jiYl0L0U+JALM4YPHvMRE7qRxNHDyNHnkXToOpgJ4pDR5hE06DNdhmOdLOrVcB2htYR6PK0yv/bULCTilpd2X5cTWSmzjKb7D0IcS7Mula5LnypJCzkUMWEq104RySbWyAOt9ctAAraRfqQSBteQ/Ege27AmaXEu1TUqQ/MzS5ZGBX1K7JzmIWVoaH5lay5Xil8VD5nOpZRM8awtrR0EtTwvgcZvxAJlRSxOl4B00o4tMLU2UY9CMWWRoLYtHvlyabC0LN7R24z+lYblsolaW8LRILU8Xr/p5TP7/zyIHTbQKAYJrmytBzhnmlzD04bQktPT7krY04wbjbX+dhQ51m4g1qbTJDaax9BSGQ7jh1XeLPF65HqWjaJpKfBFECOCRDesl8Ei8h9JNOPDULD2a4MviQXqT2lvfUAwHIpYck352NPoDAGMXuY+giWkAAAAASUVORK5CYII=') } ".replace(/\.\$/g,".g367CB268B1094004A3689751E7AC568F-");n.body.appendChild(t)}}var r,wt,t,i,s,v,bt,d,h,y,w,nt,tt,it,c,rt,ut,ft,et,ot,st,ii,ht,ct,lt,ri,l,b,at,oi,vt,yt,pt,u;!this,function(){"use strict";function e(){}function n(t){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];f(t,this)}=setTimeout;return n.prototype["catch"]=n.prototype.then=n.prototype["finally"]=n.all=function(t){return new n(function(n,i){ar r,e,u;if(!t||"undefined"==typeof t.length)throw new TypeError("Promise.all accepts an array");if(r=Array.prototype.slice.call(t),0===r.length)return n([]);for(e=r.length,u=0;r.length>u;u++)f(u,r[u])})},n.resolve=n.reject=n.race=n._immediateFn="function"==typeof setImmediate&&function(n){setImmediate(n)}||n._unhandledRejectionFn=n});r=typeof r=="undefined"?this.Promise:r,function(n){if(typeof exports=="object"&&typeof module!="undefined")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var t;t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;t.DMVAST||(t.DMVAST=n())}}(function(){return function(){function n(t,i,r){or(var e="function"==typeof require&&require,f=0;f<r.length;f++)u(r[f]);return u}return n}()({1:[function(n,t){unction r(n){return typeof n=="function"}xports=i;i.EventEmitter=i;i.prototype._events=undefined;i.prototype._maxListeners=undefined;i.defaultMaxListeners=10;i.prototype.setMaxListeners=function(n){if(!e(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this};i.prototype.emit=function(n){var i,t,c,e,o,s,h;if(this._events||(this._events={}),n==="error"&&(!this._events.error||u(this._events.error)&&!this._events.error.length))if(i=arguments[1],i instanceof Error)throw i;else{h=new Error('Uncaught, unspecified "error" event. ('+i+")");h.context=i;throw h;}if(t=this._events[n],f(t))return!1;if(r(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:e=Array.prototype.slice.call(arguments,1);t.apply(this,e)}else if(u(t))for(e=Array.prototype.slice.call(arguments,1),s=t.slice(),c=s.length,o=0;o<c;o++)s[o].apply(this,e);return!0};i.prototype.addListener=function(n,t){var e;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",n,r(t.listener)?t.listener:t),this._events[n]?u(this._events[n])?this._events[n].push(t):this._events[n]=[this._events[n],t]:this._events[n]=t,u(this._events[n])&&!this._events[n].warned&&(e=f(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[n].length>e&&(this._events[n].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[n].length),typeof console.trace=="function"&&console.trace())),this};i.prototype.on=i.prototype.addListener;i.prototype.once=i.prototype.removeListener=function(n,t){var i,e,o,f;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[n])return this;if(i=this._events[n],o=i.length,e=-1,i===t||r(i.listener)&&i.listener===t)delete this._events[n],this._events.removeListener&&this.emit("removeListener",n,t);else if(u(i)){for(f=o;f-->0;)if(i[f]===t||i[f].listener&&i[f].listener===t){e=f;break}if(e<0)return this;i.length===1?(i.length=0,delete this._events[n]):i.splice(e,1);this._events.removeListener&&this.emit("removeListener",n,t)}return this};i.prototype.removeAllListeners=function(n){var i,t;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[n]&&delete this._events[n],this;if(arguments.length===0){for(i in this._events)i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events={},this}if(t=this._events[n],r(t))this.removeListener(n,t);else if(t)while(t.length)this.removeListener(n,t[t.length-1]);return delete this._events[n],this};i.prototype.listeners=function(n){return this._events&&this._events[n]?r(this._events[n])?[this._events[n]]:this._events[n].slice():[]};i.prototype.listenerCount=function(n){if(this._events){var t=this._events[n];if(r(t))return 1;if(t)return t.length}return 0};i.listenerCount=function(n,t){return n.listenerCount(t)}},{}],2:[function(n,t){var i;i=function(){function n(){this.id=null;this.sequence=null;this.system=null;this.title=null;this.description=null;this.advertiser=null;this.pricing=null;this.survey=null;this.errorURLTemplates=[];this.impressionURLTemplates=[];this.creatives=[];this.extensions=[]}return n}();t.exports=i},{}],3:[function(n,t,i){var r,u,f;u=n("./parser");f=n("./util");r=function(){function n(){}return n.cappingFreeLunch=0,n.cappingMinimumTimeInterval=0,n.options={withCredentials:!1,timeout:0},n.get=function(n,t,r){var s,f,e,o;if(f=+new Date,s=i.extend=r||(typeof t=="function"&&(r=t),e={}),e=s(this.options,t),this.totalCallsTimeout<f?(this.totalCalls=1,this.totalCallsTimeout=f+36e5):this.totalCalls++,this.cappingFreeLunch>=this.totalCalls){r(null,new Error("VAST call canceled – FreeLunch capping not reached yet "+this.totalCalls+"/"+this.cappingFreeLunch));return}if(o=f-this.lastSuccessfullAd,o<0)this.lastSuccessfullAd=0;else if(o<this.cappingMinimumTimeInterval){r(null,new Error("VAST call canceled – ("+this.cappingMinimumTimeInterval+")ms minimum interval reached"));return}return u.parse()}}(this))},function(){var i,t;t=f.storage;i=Object.defineProperty;["lastSuccessfullAd","totalCalls","totalCallsTimeout"].forE})});n.lastSuccessfullAd==null&&(n.lastSuccessfullAd=0);n.totalCalls==null&&(n.totalCalls=0);n.totalCallsTimeout==null&&(n.totalCallsTimeout=0)}(),n}();t.exports=r},{"./parser":12,"./util":18}],4:[function(n,t){var i;i=function(){function n(){this.id=null;this.width=0;this.height=0;this.type=null;this.staticResource=null;this.htmlResource=null;this.iframeResource=null;this.altText=null;this.companionClickThroughURLTemplate=null;this.companionClickTrackingURLTemplates=[];this.trackingEvents={}}return n}();t.exports=i},{}],5:[function(n,t){var i,u,f,,n},o={}.hasOwnProperty;i=function(){function n(n){n==null&&(n={});this.id=n.id||null;this.adId=n.adId||null;this.sequence=n.sequence||null;this.apiFramework=n.apiFramework||null;this.trackingEvents={}}return n}();f=function(n){function t(){t.__super__.constructor.apply(this,arguments);this.type="linear";this.duration=0;this.skipDelay=null;this.mediaFiles=[];this.videoClickThroughURLTemplate=null;this.videoClickTrackingURLTemplates=[];this.videoCustomClickURLTemplates=[];this.adParameters=null;this.icons=[]}return r(t,n),t}(i);e=function(n){function t(){t.__super__.constructor.apply(this,arguments);this.type="nonlinear";this.variations=[]}return r(t,n),t}(i);u=function[]}return r(t,n),t}(i);t.exports={VASTCreativeLinear:f,VASTCreativeNonLinear:e,VASTCreativeCompanion:u}},{}],6:[function(n,t){var i;i=functio[]}return n}();t.exports=i},{}],7:[function(n,t){var i;i=functio{}}return n}();t.exports=i},{}],8:[function(n,t){var i;i=function(){function n(){this.program=null;this.height=0;this.width=0;this.xPosition=0;this.yPosition=0;this.apiFramework=null;this.offset=null;this.duration=0;this.type=null;this.staticResource=null;this.htmlResource=null;this.iframeResource=null;this.iconClickThroughURLTemplate=null;this.iconClickTrackingURLTemplates=[];this.iconViewTrackingURLTemplate=null}return n}();t.exports=i},{}])}},{"./client":3,"./parser":12,"./tracker":14,"./util":18}],10:[function(n,t){var i;i=functioll}return n}();t.exports=i},{}],11:[function(n,t){var i;i=function(){function n(){this.id=null;this.width=0;this.height=0;this.expandedWidth=0;this.expandedHeight=0;this.scalable=!0;this.maintainAspectRatio=!0;this.minSuggestedDuration=0;this.apiFramework="static";this.type=null;this.staticResource=null;this.htmlResource=null;this.iframeResource=null;this.nonlinearClickThroughURLTemplate=null;this.nonlinearClickTrackingURLTemplates=[];this.adParameters=null}return n}();t.exports=i},{}],12:[function(n,t){var r,u,f,e,o,s,h,c,l,a,v,y,p,w,i,b=[].index-1};u=n("./urlhandler");w=n("./response");f=n("./ad");e=n("./extension");o=n("./extensionchild");i=n("./util");c=n("./creative").VASTCreativeLinear;h=n("./creative").VASTCreativeCompanion;l=n("./creative").VASTCreativeNonLinear;v=n("./mediafile");a=n("./icon");s=n("./companionad");y=n("./nonlinear");r=n("events").EventEmitter;p=function(){function n(){}var t;return t=[],n.addURLTemplateFiln)},n.removeURLTemplateFilter=function(){return t.pop()},n.countURLTemplateFilters=function(){return t.length},n.clearUrlTemplateFilt[]},n.parse=function(n,t,i){return i||(typeof t=="function"&&(i=t),t={}),this._parse(n,null,t,function(n,t){return i(t,n)})},n.load=function(n,t,i){return i||(typeof t=="function"&&(i=t),t={}),this.parseXmlDocument(null,[],t,n,i)},n.vent=new r,n.track=function(n,t){return this.vent.emit("VAST-error",t),i.track(n,t)},n.on=function(n,t){return this.vent.on(n,t)},n.once=function(n,t){return this.vent.once(n,t)},n.t)},n._parse=function(n,i,r,f){var o,e,s;for(f||(typeof r=="function"&&(f=r),r={}),e=0,s=t.length;e<s;e++)o=t[e],n=o(n);return i==null&&(i=[]),i.push(n),u.get(n,r,function(t){return function(u,e){return u!=null?f(u):t.parseXmlDocument(n,i,r,e,f)}}(this))},n.parseXmlDocument=function(t,i,r,u,f){var o,h,c,l,p,k,a,s,v,y,e;if(e=new w,!((u!=null?u.documentElement:void 0)!=null&&u.documentElement.nodeName==="VAST"))return f(new Error("Invalid VAST XMLDocument"));for(v=u.documentElement.childNodes,c=0,p=v.length;c<p;c++)s=v[c],s.nodeName==="Error"&&e.errorURLTemplates.push(n.parseNodeText(s));for(y=u.documentElement.childNodes,l=0,k=y.length;l<k;l++)s=y[l],s.nodeName==="Ad"&&(o=n.parseAdElement(s),o!=null?e.ads.push(o):n.track(e.errorURLTemplates,{ERRORCODE:101}));for(h=function(t,i){var r,h,u,s;if(t==null&&(t=null),i==null&&(i=!1),e){for(u=!0,s=e.ads,r=0,h=s.length;r<h;r++){if(o=s[r],o.nextWrapperURL!=null)return;o.creatives.length>0&&(u=!1)}return u&&(i||n.track(e.errorURLTemplates,{ERRORCODE:303})),e.ads.length===0&&(e=null,t=new Error("No ads: no valid <inline> has been found")),f(t,e)}},a=e.ads.length;a--;)(o=e.ads[a],o.nextWrapperURL!=null)&&function(u){var f;if(i.length>(r.wrapperLimit!==null?r.wrapperLimit:9)||(f=u.nextWrapperURL,b.call(i,f)>=0)){n.track(u.errorURLTemplates,{ERRORCODE:302});e.ads.splice(e.ads.indexOf(u),1);h(new Error("Wrapper limit reached, as defined by the video player"));return}return t!=null&&(u.nextWrapperURL=n.resolveVastAdTagURI(u.nextWrapperURL,t)),n._parse(u.nextWrapperURL,i,r,function(t,i){var r,o,f,l,s,c;if(r=!1,t!=null)n.track(u.errorURLTemplates,{ERRORCODE:301}),e.ads.splice(e.ads.indexOf(u),1),r=!0;else if(i==null)n.track(u.errorURLTemplates,{ERRORCODE:303}),e.ads.splice(e.ads.indexOf(u),1),r=!0;else for(e.errorURLTemplates=e.errorURLTemplates.concat(i.errorURLTemplates),o=e.ads.indexOf(u),e.ads.splice(o,1),s=i.ads,f=0,l=s.length;f<l;f++)c=s[f],n.mergeWrapperAdData(c,u),e.ads.splice(++o,0,c);return delete u.nextWrapperURL,h(t,r)})}(o);return h()},n.resolveVastAdTagURI=function(n,t){var i,r;return n.indexOf("//")===0?(r=location.protocol,""+r+n):n.indexOf("://")===-1?(i=t.slice(0,t.lastIndexOf("/")),i+"/"+n):n},n.mergeWrapperAdData=function(n,t){var y,i,r,u,f,e,o,p,w,b,k,h,d,c,g,l,nt,a,v,s,tt;for(n.errorURLTemplates=t.errorURLTemplates.concat(n.errorURLTemplates),n.impressionURLTemplates=t.impressionURLTemplates.concat(n.impressionURLTemplates),n.extensions=t.extensions.concat(n.extensions),h=n.creatives,u=0,p=h.length;u<p;u++)if(i=h[u],((d=t.trackingEvents)!=null?d[i.type]:void 0)!=null){c=t.trackingEvents[i.type];for(r in c)tt=c[r],(y=i.trackingEvents)[r]||(y[r]=[]),i.trackingEvents[r]=i.trackingEvents[r].concat(tt)}if((g=t.videoClickTrackingURLTemplates)!=null?g.length:void 0)for(l=n.creatives,f=0,w=l.length;f<w;f++)i=l[f],i.type==="linear"&&(i.videoClickTrackingURLTemplates=i.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates));if((nt=t.videoCustomClickURLTemplates)!=null?nt.length:void 0)for(a=n.creatives,e=0,b=a.length;e<b;e++)i=a[e],i.type==="linear"&&(i.videoCustomClickURLTemplates=i.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates));if(t.videoClickThroughURLTemplate!=null){for(v=n.creatives,s=[],o=0,k=v.length;o<k;o++)i=v[o],i.type==="linear"&&i.videoClickThroughURLTemplate==null?s.push(i.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate):s.push(void 0);return s}},n.childByName=function(n,t){var r,i,f,u;for(u=n.childNodes,i=0,f=u.length;i<f;i++)if(r=u[i],r.nodeName===t)return r},n.childsByName=function(n,t){var r,u,i,e,f;for(u=[],f=n.childNodes,i=0,e=f.length;i<e;i++)r=f[i],r.nodeName===t&&u.push(r);return u},n.parseAdElement=function(n){var t,i,u,r,f;for(r=n.childNodes,i=0,u=r.length;i<u;i++)if(t=r[i],(f=t.nodeName)==="Wrapper"||f==="InLine"){if(this.copyNodeAttribute("id",n,t),this.copyNodeAttribute("sequence",n,t),t.nodeName==="Wrapper")return this.parseWrapperElement(t);if(t.nodeName==="InLine")return this.parseInLineElement(t)}},n.parseWrapperElement=function(n){var t,p,w,u,f,e,o,s,h,b,k,d,g,nt,c,tt,l,a,v,it,y,i,r;for(t=this.parseInLineElement(n),r=this.childByName(n,"VASTAdTagURI"),r!=null?t.nextWrapperURL=this.parseNodeText(r):(r=this.childByName(n,"VASTAdTagURL"),r!=null&&(t.nextWrapperURL=this.parseNodeText(this.childByName(r,"URL")))),c=t.creatives,f=0,b=c.length;f<b;f++)if(i=c[f],(tt=i.type)==="linear"||tt==="nonlinear"){if(i.trackingEvents!=null){t.trackingEvents||(t.trackingEvents={});(p=t.trackingEvents)[nt=i.type]||(p[nt]={});l=i.trackingEvents;for(u in l)for(y=l[u],(w=t.trackingEvents[i.type])[u]||(w[u]=[]),o=0,k=y.length;o<k;o++)it=y[o],t.trackingEvents[i.type][u].push(it)}if(i.videoClickTrackingURLTemplates!=null)for(t.videoClickTrackingURLTemplates||(t.videoClickTrackingURLTemplates=[]),a=i.videoClickTrackingURLTemplates,s=0,d=a.length;s<d;s++)e=a[s],t.videoClickTrackingURLTemplates.push(e);if(i.videoClickThroughURLTemplate!=null&&(t.videoClickThroughURLTemplate=i.videoClickThroughURLTemplate),i.videoCustomClickURLTemplates!=null)for(t.videoCustomClickURLTemplates||(t.videoCustomClickURLTemplates=[]),v=i.videoCustomClickURLTemplates,h=0,g=v.length;h<g;h++)e=v[h],t.videoCustomClickURLTemplates.push(e)}if(t.nextWrapperURL!=null)return t},n.parseInLineElement=function(n){var t,r,o,u,e,s,h,c,y,p,w,i,l,a,v;for(t=new f,t.id=n.getAttribute("id")||null,t.sequence=n.getAttribute("sequence")||null,l=n.childNodes,s=0,y=l.length;s<y;s++){i=l[s];switch(i.nodeName){case"Error":t.errorURLTemplates.push(this.parseNodeText(i));break;case"Impression":t.impressionURLTemplates.push(this.parseNodeText(i));break;case"Creatives":for(a=this.childsByName(i,"Creative"),h=0,p=a.length;h<p;h++)for(u=a[h],o={id:u.getAttribute("id")||null,adId:this.parseCreativeAdIdAttribute(u),sequence:u.getAttribute("sequence")||null,apiFramework:u.getAttribute("apiFramework")||null},v=u.childNodes,c=0,w=v.length;c<w;c++){e=v[c];switch(e.nodeName){case"Linear":r=this.parseCreativeLinearElement(e,o);r&&t.creatives.push(r);break;case"NonLinearAds":r=this.parseNonLinear(e,o);r&&t.creatives.push(r);break;case"CompanionAds":r=this.parseCompanionAd(e,o);r&&t.creatives.push(r)}}break;case"Extensions":this.parseExtension(t.extensions,this.childsByName(i,"Extension"));break;case"AdSystem":t.system={value:this.parseNodeText(i),version:i.getAttribute("version")||null};break;case"AdTitle":t.title=this.parseNodeText(i);break;case"Description":t.description=this.parseNodeText(i);break;case"Advertiser":t.advertiser=this.parseNodeText(i);break;case"Pricing":t.pricing={value:this.parseNodeText(i),model:i.getAttribute("model")||null,currency:i.getAttribute("currency")||null};break;case"Survey":t.survey=this.parseNodeText(i)}}return t},n.parseExtension=function(n,t){var i,u,r,a,f,v,s,h,c,l,d,g,nt,tt,y,p,w,b,k;for(b=[],s=0,d=t.length;s<d;s++){if(f=t[s],u=new e,f.attributes)for(y=f.attributes,h=0,g=y.length;h<g;h++)v=y[h],u.attributes[v.nodeName]=v.nodeValue;for(p=f.childNodes,c=0,nt=p.length;c<nt;c++)if(i=p[c],k=this.parseNodeText(i),i.nodeName!=="#comment"&&k!==""){if(r=new o,r.name=i.nodeName,r.value=k,i.attributes)for(w=i.attributes,l=0,tt=w.length;l<tt;l++)a=w[l],r.attributes[a.nodeName]=a.nodeValue;u.children.push(r)}b.push(n.push(u))}return b},n.parseCreativeLinearElement=function(n,t){var st,ui,fi,u,ei,o,ht,w,i,oi,b,f,ct,lt,k,d,g,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,nt,s,r,e,di,tt,it,l,rt,gi,ut,ft,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,et,h,y,ii,ot,nr,ri,p;if(u=new c(t),u.duration=this.parseDuration(this.parseNodeText(this.childByName(n,"Duration"))),u.duration===-1&&n.parentNode.parentNode.parentNode.nodeName!=="Wrapper")return null;if(y=n.getAttribute("skipoffset"),y==null?u.skipDelay=null:y.charAt(y.length-1)==="%"?(gi=parseInt(y,10),u.skipDelay=u.duration*(gi/100)):u.skipDelay=this.parseDuration(y),p=this.childByName(n,"VideoClicks"),p!=null){for(u.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(p,"ClickThrough")),at=this.childsByName(p,"ClickTracking"),w=0,si=at.length;w<si;w++)fi=at[w],u.videoClickTrackingURLTemplates.push(this.parseNodeText(fi));for(vt=this.childsByName(p,"CustomClick"),k=0,hi=vt.length;k<hi;k++)ei=vt[k],u.videoCustomClickURLTemplates.push(this.parseNodeText(ei))}for(st=this.childByName(n,"AdParameters"),st!=null&&(u.adParameters=this.parseNodeText(st)),pt=this.childsByName(n,"TrackingEvents"),d=0,li=pt.length;d<li;d++)for(nr=pt[d],wt=this.childsByName(nr,"Tracking"),g=0,ai=wt.length;g<ai;g++)if(ot=wt[g],o=ot.getAttribute("event"),ri=this.parseNodeText(ot),o!=null&&ri!=null){if(o==="progress"){if(l=ot.getAttribute("offset"),!l)continue;o=l.charAt(l.length-1)==="%"?"progress-"+l:"progress-"+Math.round(this.parseDuration(l))}(ui=u.trackingEvents)[o]==null&&(ui[o]=[]);u.trackingEvents[o].push(ri)}for(bt=this.childsByName(n,"MediaFiles"),nt=0,vi=bt.length;nt<vi;nt++)for(di=bt[nt],kt=this.childsByName(di,"MediaFile"),tt=0,yi=kt.length;tt<yi;tt++)e=kt[tt],r=new v,r.id=e.getAttribute("id"),r.fileURL=this.parseNodeText(e),r.deliveryType=e.getAttribute("delivery"),r.codec=e.getAttribute("codec"),r.mimeType=e.getAttribute("type"),r.apiFramework=e.getAttribute("apiFramework"),r.bitrate=parseInt(e.getAttribute("bitrate")||0),r.minBitrate=parseInt(e.getAttribute("minBitrate")||0),r.maxBitrate=parseInt(e.getAttribute("maxBitrate")||0),r.width=parseInt(e.getAttribute("width")||0),r.height=parseInt(e.getAttribute("height")||0),h=e.getAttribute("scalable"),h&&typeof h=="string"&&(h=h.toLowerCase(),h==="true"?r.scalable=!0:h==="false"&&(r.scalable=!1)),s=e.getAttribute("maintainAspectRatio"),s&&typeof s=="string"&&(s=s.toLowerCase(),s==="true"?r.maintainAspectRatio=!0:s==="false"&&(r.maintainAspectRatio=!1)),u.mediaFiles.push(r);if(ct=this.childByName(n,"Icons"),ct!=null)for(dt=this.childsByName(ct,"Icon"),it=0,pi=dt.length;it<pi;it++){for(f=dt[it],i=new a,i.program=f.getAttribute("program"),i.height=parseInt(f.getAttribute("height")||0),i.width=parseInt(f.getAttribute("width")||0),i.xPosition=this.parseXPosition(f.getAttribute("xPosition")),i.yPosition=this.parseYPosition(f.getAttribute("yPosition")),i.apiFramework=f.getAttribute("apiFramework"),i.offset=this.parseDuration(f.getAttribute("offset")),i.duration=this.parseDuration(f.getAttribute("duration")),gt=this.childsByName(f,"HTMLResource"),rt=0,wi=gt.length;rt<wi;rt++)ht=gt[rt],i.type=ht.getAttribute("creativeType")||"text/html",i.htmlResource=this.parseNodeText(ht);for(ni=this.childsByName(f,"IFrameResource"),ut=0,bi=ni.length;ut<bi;ut++)lt=ni[ut],i.type=lt.getAttribute("creativeType")||0,i.iframeResource=this.parseNodeText(lt);for(ti=this.childsByName(f,"StaticResource"),ft=0,ki=ti.length;ft<ki;ft++)ii=ti[ft],i.type=ii.getAttribute("creativeType")||0,i.staticResource=this.parseNodeText(ii);if(b=this.childByName(f,"IconClicks"),b!=null)for(i.iconClickThroughURLTemplate=this.parseNodeText(this.childByName(b,"IconClickThrough")),yt=this.childsByName(b,"IconClickTracking"),et=0,ci=yt.length;et<ci;et++)oi=yt[et],i.iconClickTrackingURLTemplates.push(this.parseNodeText(oi));i.iconViewTrackingURLTemplate=this.parseNodeText(this.childByName(f,"IconViewTracking"));u.icons.push(i)}return u},n.parseNonLinear=function(n,t){var p,ot,st,u,f,w,e,b,o,s,h,ht,ct,lt,at,vt,yt,pt,c,a,i,r,v,k,d,g,nt,tt,it,rt,ut,ft,wt,et;for(u=new l(t),k=this.childsByName(n,"TrackingEvents"),e=0,ht=k.length;e<ht;e++)for(wt=k[e],d=this.childsByName(wt,"Tracking"),o=0,ct=d.length;o<ct;o++)ft=d[o],f=ft.getAttribute("event"),et=this.parseNodeText(ft),f!=null&&et!=null&&((ot=u.trackingEvents)[f]==null&&(ot[f]=[]),u.trackingEvents[f].push(et));for(g=this.childsByName(n,"NonLinear"),s=0,lt=g.length;s<lt;s++){for(r=g[s],i=new y,i.id=r.getAttribute("id")||null,i.width=r.getAttribute("width"),i.height=r.getAttribute("height"),i.expandedWidth=r.getAttribute("expandedWidth"),i.expandedHeight=r.getAttribute("expandedHeight"),i.scalable=this.parseBoolean(r.getAttribute("scalable")),i.maintainAspectRatio=this.parseBoolean(r.getAttribute("maintainAspectRatio")),i.minSuggestedDuration=this.parseDuration(r.getAttribute("minSuggestedDuration")),i.apiFramework=r.getAttribute("apiFramework"),nt=this.childsByName(r,"HTMLResource"),h=0,at=nt.length;h<at;h++)w=nt[h],i.type=w.getAttribute("creativeType")||"text/html",i.htmlResource=this.parseNodeText(w);for(tt=this.childsByName(r,"IFrameResource"),c=0,vt=tt.length;c<vt;c++)b=tt[c],i.type=b.getAttribute("creativeType")||0,i.iframeResource=this.parseNodeText(b);for(it=this.childsByName(r,"StaticResource"),a=0,yt=it.length;a<yt;a++)ut=it[a],i.type=ut.getAttribute("creativeType")||0,i.staticResource=this.parseNodeText(ut);for(p=this.childByName(r,"AdParameters"),p!=null&&(i.adParameters=this.parseNodeText(p)),i.nonlinearClickThroughURLTemplate=this.parseNodeText(this.childByName(r,"NonLinearClickThrough")),rt=this.childsByName(r,"NonLinearClickTracking"),v=0,pt=rt.length;v<pt;v++)st=rt[v],i.nonlinearClickTrackingURLTemplates.push(this.parseNodeText(st));u.variations.push(i)}return u},n.parseCompanionAd=function(n,t){var st,ht,ct,i,r,p,u,w,f,b,e,o,c,lt,at,vt,yt,pt,wt,bt,kt,l,a,v,y,k,d,g,nt,tt,it,rt,ut,ft,et,dt,ot;for(p=new h(t),k=this.childsByName(n,"Companion"),f=0,lt=k.length;f<lt;f++){for(r=k[f],i=new s,i.id=r.getAttribute("id")||null,i.width=r.getAttribute("width"),i.height=r.getAttribute("height"),i.companionClickTrackingURLTemplates=[],d=this.childsByName(r,"HTMLResource"),e=0,at=d.length;e<at;e++)w=d[e],i.type=w.getAttribute("creativeType")||"text/html",i.htmlResource=this.parseNodeText(w);for(g=this.childsByName(r,"IFrameResource"),o=0,vt=g.length;o<vt;o++)b=g[o],i.type=b.getAttribute("creativeType")||0,i.iframeResource=this.parseNodeText(b);for(nt=this.childsByName(r,"StaticResource"),c=0,yt=nt.length;c<yt;c++){for(ft=nt[c],i.type=ft.getAttribute("creativeType")||0,tt=this.childsByName(r,"AltText"),l=0,pt=tt.length;l<pt;l++)ht=tt[l],i.altText=this.parseNodeText(ht);i.staticResource=this.parseNodeText(ft)}for(it=this.childsByName(r,"TrackingEvents"),a=0,wt=it.length;a<wt;a++)for(dt=it[a],rt=this.childsByName(dt,"Tracking"),v=0,bt=rt.length;v<bt;v++)et=rt[v],u=et.getAttribute("event"),ot=this.parseNodeText(et),u!=null&&ot!=null&&((st=i.trackingEvents)[u]==null&&(st[u]=[]),i.trackingEvents[u].push(ot));for(ut=this.childsByName(r,"CompanionClickTracking"),y=0,kt=ut.length;y<kt;y++)ct=ut[y],i.companionClickTrackingURLTemplates.push(this.parseNodeText(ct));i.companionClickThroughURLTemplate=this.parseNodeText(this.childByName(r,"CompanionClickThrough"));i.companionClickTrackingURLTemplate=this.parseNodeText(this.childByName(r,"CompanionClickTracking"));p.variations.push(i)}return p},n.parseDuration=function(n){var t,e,u,r,f;return(n!=null)?i.isNumeric(n)?parseInt(n):(t=n.split(":"),t.length!==3)?-1:(f=t[2].split("."),r=parseInt(f[0]),f.length===2&&(r+=parseFloat("0."+f[1])),u=parseInt(t[1]*60),e=parseInt(t[0]*3600),isNaN(e)||isNaN(u)||isNaN(r)||u>3600||r>60)?-1:e+u+r:-1},n.parseXPosition=function(n){return n==="left"||n==="right"?n:parseInt(n||0)},n.parseYPosition=function(n){return n==="top"||n==="bottom"?n:parseInt(n||0)},n.parseBool1"},n.parseNodeT()},n.copyNodeAttribute=function(n,t,i){var r;return r=t.getAttribute(n),r?i.setAttribute(n,r):void 0},n.parseCreativeAdIdAttribll},n}();t.exports=p},{"./ad":2,"./companionad":4,"./creative":5,"./extension":6,"./extensionchild":7,"./icon":8,"./mediafile":10,"./nonlinear":11,"./response":13,"./urlhandler":15,"./util":18,events:1}],13:[function(n,t){var i;i=functio[]}return n}();t.exports=i},{}],14:[function(n,t){var r,u,f,e,o,s,i,h=function(n,t){function r(){this.constructor=n}for(var i in t)c.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n},c={}.hasOwnProperty;u=n("./client");i=n("./util");e=n("./creative").VASTCreativeLinear;o=n("./nonlinear");f=n("./companionad");r=n("events").EventEmitter;s=function(n){function t(n,t,i){var r,h,s;this.ad=n;this.creative=t;this.variation=i!=null?i:null;this.muted=!1;this.impressed=!1;this.skipable=!1;this.skipDelayDefault=-1;this.trackingEvents={};this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"];this._alreadyTriggeredQuartiles={};s=this.creative.trackingEvents;for(r in s)h=s[r],this.trackingEvents[r]=h.slice(0);this.creative instanceof e?(this.setDuration(this.creative.duration),this.skipDelay=this.creative.skipDelay,this.linear=!0,this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates):(this.skipDelay=-1,this.linear=!1,this.variation&&(this.variation instanceof o?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates):this.variation instanceof f&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)));this.on("state})}return h(t,n),t.t)},t.prototype.setDuration=function(n){return this.assetDuration=n,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}},t.prototype.setProgress=function(n){var e,t,r,o,s,i,f,u,h;if(u=this.skipDelay===null?this.skipDelayDefault:this.skipDelay,u===-1||this.skipable||(u>n?this.emit("skip-countdown",u-n):(this.skipable=!0,this.emit("skip-countdown",0))),this.linear&&this.assetDuration>0){if(t=[],n>0){t.push("start");s=Math.round(n/this.assetDuration*100);t.push("progress-"+s+"%");t.push("progress-"+Math.round(n));f=this.quartiles;for(i in f)h=f[i],this.isQuartileReached(i,h,n)&&(t.push(i),this._alreadyTriggeredQuartiles[i]=!0)}for(r=0,o=t.length;r<o;r++)e=t[r],this.track(e,!0);n<this.progress&&this.track("rewind")}return this.progress=n},t.prototype.isQuartileReached=function(n,t,i){var r;return r=!1,t<=i&&!this._alreadyTriggeredQuartiles[n]&&(r=!0),r},t.prototype.setMuted=function(n){return this.muted!==n&&this.track(n?"mute":"unmute"),this.muted=n},t.prototype.setPaused=function(n){return this.paused!==n&&this.track(n?"pause":"resume"),this.paused=n},t.prototype.setFullscreen=function(n){return this.fullscreen!==n&&this.track(n?"fullscreen":"exitFullscreen"),this.fullscreen=n},t.prototype.setExp=n},t.prototype.setSkipDelay=function(n){if(typeof n=="number")return this.skipDelay=n},t.prototype.load=function(){if(!this.impressed)return this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView")},t.prototype.errorWithC})},t.prototype.complete=function(){return this.track("complete")},t.prototype.cl")},t.prototype.stop=function(){},t.prototype.s[]},t.prototype.click=function(){var n,t,r;return((t=this.clickTrackingURLTemplates)!=null?t.length:void 0)&&this.trackURLs(this.clickTrackingURLTemplates),this.clickThroughURLTemplate!=null?(this.linear&&(r={CONTENTPLAYHEAD:this.progressFormated()}),n=i.resolveURLTemplates([this.clickThroughURLTemplate],r)[0],this.emit("clickthrough",n)):void 0},t.prototype.track=function(n,t){var i,r;t==null&&(t=!1);n==="closeLinear"&&this.trackingEvents[n]==null&&this.trackingEvents.close!=null&&(n="close");r=this.trackingEvents[n];i=this.emitAlwaysEvents.indexOf(n);r!=null?(this.emit(n,""),this.trackURLs(r)):i!==-1&&this.emit(n,"");t===!0&&(delete this.trackingEvents[n],i>-1&&this.emitAlwaysEvents.splice(i,1))},t.prototype.trackURLs=function(n,t){var r;return t==null&&(t={}),this.linear&&(((r=this.creative.mediaFiles[0])!=null?r.fileURL:void 0)!=null&&(t.ASSETURI=this.creative.mediaFiles[0].fileURL),t.CONTENTPLAYHEAD=this.progressFormated()),i.track(n,t)},t.prototype.progressFormated=function(){var t,n,u,r,i;return i=parseInt(this.progress),t=i/3600,t.length<2&&(t="0"+t),n=i/60%60,n.length<2&&(n="0"+n),r=i%60,r.length<2&&(r="0"+n),u=parseInt((this.progress-i)*100),t+":"+n+":"+r+"."+u},t}(r);t.exports=s},{"./client":3,"./companionad":4,"./creative":5,"./nonlinear":11,"./util":18,events:1}],15:[function(n,t){var u,i,r;r=n("./urlhandlers/xmlhttprequest");i=n("./urlhandlers/flash");u=function(){function t(){}return t.get=function(t,u,f){var e,o;return f||(typeof u=="function"&&(f=u),u={}),u.response!=null?(o=u.response,delete u.response,f(null,o)):((e=u.urlhandler)!=null?e.supported():void 0)?u.urlhandler.get(t,u,f):typeof window=="undefined"||window===null?n("./urlhandlers/node").get(t,u,f):r.supported()?r.get(t,u,f):i.supported()?i.get(t,u,f):f(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))},t}();t.exports=u},{"./urlhandlers/flash":16,"./urlhandlers/xmlhttprequest":17}],16:[function(n,t){var i;i=function(){function n(){}return n.,n},n.supported=function(){return!!this.xdr()},n.get=function(n,t,i){var r,u;if(u=typeof ActiveXObject=="function"?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)u.async=!1;else return i(new Error("FlashURLHandler: Microsoft.XMLDOM format not supported"));return r=this.xdr(),r.open("GET",n),r.timeout=t.timeout||0,r.withCredentials=t.withCredentials||!1,r.send(),r.onprogress=function(){},r.onlu)}},n}();t.exports=i},{}],17:[function(n,t){var i;i=function(){function n(){}return n. 0},n.suppor()},n.get=function(n,t,i){var r;if(window.location.protocol==="https:"&&n.indexOf("http://")===0)return i(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{return r=this.xhr(),r.open("GET",n),r.timeout=t.timeout||0,r.withCredentials=t.withCredentials||!1,r.overrideMimeType&&r.overrideMimeType("text/xml"),r.onreadystatechange=function(){if(r.readyState===4)return r.status===200?i(null,r.responseXML):i(new Error("XHRURLHandler: "+r.statusText))},r.send()}catch(u){return i(new Error("XHRURLHandler: Unexpected error"))}},n}();t.exports=i},{}],18:[function(n,t){var i;i=function(){function n(){}return n.track=function(n,t){var f,r,e,i,o,u;for(r=this.resolveURLTemplates(n,t),u=[],i=0,o=r.length;i<o;i++)f=r[i],typeof window!="undefined"&&window!==null&&(e=new Image,u.push(e.src=f));return u},n.resolveURLTemplates=function(n,t){var o,f,r,u,s,h,c,i,e;for(t==null&&(t={}),f=[],t.ASSETURI!=null&&(t.ASSETURI=this.encodeURIComponentRFC3986(t.ASSETURI)),t.CONTENTPLAYHEAD!=null&&(t.CONTENTPLAYHEAD=this.encodeURIComponentRFC3986(t.CONTENTPLAYHEAD)),t.ERRORCODE==null||/^[0-9]{3}$/.test(t.ERRORCODE)||(t.ERRORCODE=900),t.CACHEBUSTING=this.leftpad(Math.round(Math.random()*1e8).toString()),t.TIMESTAMP=this.encodeURIComponentRFC3986((new Date).toISOString()),t.RANDOM=t.random=t.CACHEBUSTING,r=0,s=n.length;r<s;r++)if(o=n[r],i=o,i){for(u in t)e=t[u],h="["+u+"]",c="%%"+u+"%%",i=i.replace(h,e),i=i.replace(c,e);f.push(i)}return f},n.encodeURIComponentRFC3})},n.leftpad=function(n){return n.length<8?function(){var t,i,r;for(r=[],t=0,i=8-n.length;0<=i?t<i:t>i;0<=i?t++:t--)r.push("0");return r}().join("")+n:n},n.storage=function(){var n,i,t,r;try{t=typeof window!="undefined"&&window!==null?window.localStorage||window.sessionStorage:null}catch(u){r=u;t=null}retur!1},(t==null||i(t))&&(n={},t={length:0,getItem:function(t){return n[t]},setIth},removeIth},cl=0}}),t}(),n.isNumen)},n}();t.exports=i},{}]},{},[9])(9)});
/*!
* screenfull
* v3.3.3 - 2018-09-04
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},r="undefined"!=typeof module&&module.exports,f="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Elemen!1}(),u={change:n.fullscreenchange,error:n.fullscreenerror},i={request:function(i){var r=n.requestFullscreen;i=i||t.documentElement;/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?i[r]():i[r](f?Element.ALLOW_KEYBOARD_INPUT:{})},e()},togn)},onchange:function(n){this.on("change",n)},onern)},on:function(n,i){var r=u[n];r&&t.addEventListener(r,i,!1)},1)},raw:n};if(!n)return void(r?module.exports=!1:window.screenfull=!1);Object.defineProperties(i,{isFullscreen:{get:function(){return Boolean(t[n.fullscreenElement])}},element:{enumerable:!0,t]}},enabled:{enumerable:!0,])}}});r?module.exports=i:window.screenfull=i}();try{"undefined"!=typeof wind()}(this,function(){ret9)}([function(n,t,i){"use strict";function r+t}function s(n){var t=e.console[n];return t?function(){for(var u=arguments.length,i=Array(u),r=0;r<u;r++)i[r]=arguments[r];i[0]&&(i[0]=o(n,i[0]));t.apply(e.console,i)})}i.d(t,"a",function(){return a});i.d(t,"b",function(){return v});var c=i(5),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},f={trace:r,debug:r,log:r,warn:r,info:r,error:r},u=f,e=Object(c.a)(=f},v=u},function(n,t){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(n,t,i){"use strict";i.d(t,"b",function(){return r});i.d(t,"a",function(){return u});var r={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},u={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException)}},function(n,t,i){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var f=i(0),r=i(2),e=i(1),o="function"==typeof Symbol&&"symbol"==typeof Symbol.itera n},s=new Set(["hlsEventGeneric","hlsHandlerDestroying","hlsHandlerDestroyed"]),h=function(){function n(t){u(this,n);this.hls=t;this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,f=Array(r>1?r-1:0),i=1;i<r;i++)f[i-1]=arguments[i];this.handledEvents=f;this.useGenericHandler=!0;this.registerListeners()}return n.prototype.dest()},n.prototype.onHandlerDestroying=function(){},n.prototype.onHandlerDestroyed=function(){},n.prototype.isEventHandnt},n.prototype.registerListens)},n.prototype.unregisterListens)},n.prototype.onEvt)},n.prototype.onEventGeneric=function(n,t){vat)};try{i.call(this,n,t).call()}catch(t){f.b.error("An internal error happened while handling event "+n+'. Error message: "'+t.message+'". Here is a stacktrace:',t);this.hls.trigger(e.a.ERROR,{type:r.b.OTHER_ERROR,details:r.a.INTERNAL_EXCEPTION,fatal:!1,event:n,err:t})}},n}();t.a=h},function(n,t){"use striow}t.a=i},function(n){!function(){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,r=/^([^\/;?#]*)(.*)$/,u=/(?:\/|^)\.(?=\/)/g,f=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,t={buildAbsoluteURL:function(n,i,u){var s,f,e,h,o,c,l;if(u=u||{},n=n.trim(),!(i=i.trim())){if(!u.alwaysNormalize)return n;if(s=this.parseURL(n),!e)throw new Error("Error trying to parse base URL.");return s.path=t.normalizePath(s.path),t.buildURLFromParts(s)}if(f=this.parseURL(i),!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=t.normalizePath(f.path),t.buildURLFromParts(f)):i;if(e=this.parseURL(n),!e)throw new Error("Error trying to parse base URL.");return!e.netLoc&&e.path&&"/"!==e.path[0]&&(h=r.exec(e.path),e.netLoc=h[1],e.path=h[2]),e.netLoc&&!e.path&&(e.path="/"),o={scheme:e.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment},f.netLoc||(o.netLoc=e.netLoc,"/"===f.path[0])||(f.path?(c=e.path,l=c.substring(0,c.lastIndexOf("/")+1)+f.path,o.path=t.normalizePath(l)):(o.path=e.path,f.params||(o.params=e.params,f.query||(o.query=e.query)))),null===o.path&&(o.path=u.alwaysNormalize?t.normalizePath(f.path):f.path),t.buildURLFromParts(o)},parsell},normalizeP")},buildURLFromPant}};n.exports=t}()},function(n,t){"use strict";var i={search:function(n,t){for(var e,r=0,u=n.length-1,i=null,f=null;r<=u;)if(i=(r+u)/2|0,f=n[i],e=t(f),e>0)r=i+1;else{if(!(e<0))return f;u=i-1}return null}};t.a=i},function(n,t,i){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}i.d(t,"a",function(){return u});var u=function(){function n(){r(this,n)}return n.isBuffe!1},n.bufferInfo=function(n,t,i){try{if(n){for(var u=n.buffered,f=[],r=void 0,r=0;r<u.length;r++)f.push({start:u.start(r),end:u.end(r)});return this.bufferedInfo(f,t,i)}}catch(n){}return{len:0,start:t,end:t,nextStart:void 0}},n.bufferedInfo=function(n,t,i){var u=[],s=void 0,h=void 0,e=void 0,a=void 0,r=void 0,o,c,f,l;for(n.snd}),r=0;r<n.length;r++)o=u.length,o?(c=u[o-1].end,n[r].start-c<i?n[r].end>c&&(u[o-1].end=n[r].end):u.push(n[r])):u.push(n[r]);for(r=0,s=0,h=e=t;r<u.length;r++)if(f=u[r].start,l=u[r].end,t+i>=f&&t<l)h=f,e=l,s=e-t;else if(t+i<f){a=f;break}return{len:s,start:h,end:e,nextStart:a}},n}()},function(n,t,i){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}i.d(t,"b",function(){return f});var r=function(){function n(){u(this,n)}return n.isHeader=function(n,t){return t+10<=n.length&&73===n[t]&&68===n[t+1]&&51===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128},n.isFoo28},n.getID3Dr)},n._readSize=function(n,t){var i=0;return i=(127&n[t])<<21,i|=(127&n[t+1])<<14,i|=(127&n[t+2])<<7,i|127&n[t+3]},n.getTimeStamp=function(t){for(var u,r=n.getID3Frames(t),i=0;i<r.length;i++)if(u=r[i],n.isTimeStampFrame(u))return n._readTimeStamp(u)},n.isTimeStampFrfo},n._getFrameD)}},n.getID3Frames=function(t){for(var e,o,u,f,i=0,r=[];n.isHeader(t,i);){for(e=n._readSize(t,i+6),i+=10,o=i+e;i+8<o;)u=n._getFrameData(t.subarray(i)),f=n._decodeFrame(u),f&&r.push(f),i+=u.size+10;n.isFooter(t,i)&&(i+=10)}return r},n._decodeFr 0},n._readTimeSt)}},n._decodePrivFr}}},n._decodeTextFrame=function(t){var i,r,u,f;if(!(t.size<2))return"TXXX"===t.type?(i=1,r=n._utf8ArrayToStr(t.data.subarray(i)),i+=r.length+1,u=n._utf8ArrayToStr(t.data.subarray(i)),{key:t.type,info:r,data:u}):(f=n._utf8ArrayToStr(t.data.subarray(1)),{key:t.type,data:f})},n._decodeURLFrame=function(t){var i,r,u,f;return"WXXX"===t.type?t.size<2?void 0:(i=1,r=n._utf8ArrayToStr(t.data.subarray(i)),i+=r.length+1,u=n._utf8ArrayToStr(t.data.subarray(i)),{key:t.type,info:r,data:u}):(f=n._utf8ArrayToStr(t.data),{key:t.type,data:f})},n._utf8ArrayToStr=function(n){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=n.length,t=void 0,u=void 0,f=void 0,i="",r=0;r<o;){if(0===(t=n[r++])&&e)return i;if(0!==t&&3!==t)switch(t>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=String.fromCharCode(t);break;case 12:case 13:u=n[r++];i+=String.fromCharCode((31&t)<<6|63&u);break;case 14:u=n[r++];f=n[r++];i+=String.fromCharCode((15&t)<<12|(63&u)<<6|(63&f)<<0)}}return i},n}(),f=r._utf8ArrayToStr;t.a=r},function(n,t,i){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function u(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function f(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var e=i(4),o=function(n){function t(i){var f;r(this,t);for(var o=arguments.length,s=Array(o>1?o-1:0),e=1;e<o;e++)s[e-1]=arguments[e];return f=u(this,n.call.apply(n,[this,i].concat(s))),f._tickInterval=null,f._tickTimer=null,f._tickCallCount=0,f._boundTick=f.tick.bind(f),f}return f(t,n),t.prototype.onHandlerDestroy()},t.prototype.hasInterval=function(){return!!this._tickInterval},t.prototype.hasNextTer},t.prototype.setInterval=function(n){function t(){return n.apply(this,arguments)}return t.toString=function(){return n.toString()}0)}),t.prototype.clearInter,t}(function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)}),t.prototype.clearNextT0)},t.prototype.tick=function(){1==++this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},t.prototype.doTick=function(){},t}(e.a);t.a=o},function(n,t,i){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=i(3),f=i(6),e=i.n(f),o=i(19),s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=function(){function n(){var t;u(this,n);this._url=null;this._byteRange=null;this._decryptdata=null;this.tagList=[];this.programDateTime=null;this.rawProgramDateTime=null;this._elementaryStreams=(t={},t[n.ElementaryStreamTypes.AUDIO]=!1,t[n.ElementaryStreamTypes.VIDEO]=!1,t)}return n.prototype.addElementaryStr!0},n.prototype.hasElementaryStrn]},n.prototype.createInitializationVec i},n.prototype.fragmentDecryptdataFromLevelkey=function(n,t){var i=n;return n&&n.method&&n.uri&&!n.iv&&(i=new o.a,i.method=n.method,i.baseuri=n.baseuri,i.reluri=n.reluri,i.iv=this.createInitializationVector(t)),i},s(n,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=e.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(n){this._url=n}},{key:"byteRange",get:function(){var n,t,i;return!this._byteRange&&!this.rawByteRange?[]:this._byteRange?this._byteRange:(n=[],this.rawByteRange&&(t=this.rawByteRange.split("@",2),1===t.length?(i=this.lastByteRangeEndOffset,n[0]=i||0):n[0]=parseInt(t[1]),n[1]=parseInt(t[0])+n[0],this._byteRange=n),n)}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",1]}},{key:"decryptdata",ta}},{key:"endProgramDateTime",*n}},{key:"encrypted",y)}}],[{key:"ElementaryStreamTypes","}}}]),n}();t.a=h},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function o(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function s(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}i.d(t,"a",function(){return r});i.d(t,"b",function(){return c});var h=i(3),f=i(4),u=i(1),r={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},c=function,r}return s(t,n),t.prototype.destroy=function(){this.fragments=null;this.timeRanges=null;this.config=null;f.a.prototype.destroy.call(this);n.prototype.destroy.call(this)},t.prototype.getBufferedFrag=function(n,t){var i=this.fragments,r=Object.keys(i).filter(function(r){var u=i[r],f;return u.body.type!==t?!1:u.buffered?(f=u.body,f.startPTS<=n&&n<=f.endPTS):!1}),u;return 0===r.length?null:(u=r.pop(),i[u].body)},t.prototype.detectEvictedFragments=function(n,t){var i=this,r=void 0,u=void 0;Object.keys(this.fragments).forEach(function(f){var o=i.fragments[f],s,e;if(!0===o.buffered&&(s=o.range[n],s))for(r=s.time,e=0;e<r.length;e++)if(u=r[e],!1===i.isTimeBuffered(u.startPTS,u.endPTS,t)){i.removeFragment(o.body);break}})},t.prototype.detectPartialFragme))},t.prototype.getBufferedTio}},t.prototype.getFragmentsn},t.prototype.getPartialFragm,f},t.prototype.getSt,i},t.prototype.isPartl)},t.prototype.isTimeBuffe!1},t.prototype.onFragLoa})},t.prototype.onBufferAppended=function(n){var t=this;this.timeRanges=n.timeRanges;Object.keys(this.timeRanges).forEi)})},t.prototype.onFragBuffeg)},t.prototype.hasFragmt]},t.prototype.removeFragmt]},t.prototype.removeAllFragmel)},t}(f.a)},function 0}function i(n){return"function"==typeo}n.exports=t;t.EventEmitter=t;t.prototype._events=void 0;t.prototype._maxListeners=void 0;t.defaultMaxListeners=10;t.prototype.setMaxListenis};t.prototype.emit=function(n){var f,t,c,e,o,s,h;if(this._events||(this._events={}),"error"===n&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((f=arguments[1])instanceof Error)throw f;h=new Error('Uncaught, unspecified "error" event. ('+f+")");throw h.context=f,h;}if(t=this._events[n],u(t))return!1;if(i(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:e=Array.prototype.slice.call(arguments,1);t.apply(this,e)}else if(r(t))for(e=Array.prototype.slice.call(arguments,1),s=t.slice(),c=s.length,o=0;o<c;o++)s[o].apply(this,e);return!0};t.prototype.addListeis};t.prototype.on=t.prototype.addListener;t.prototype.once=function(n))}if(!i(t))throw TypeError("listener must be a function");var u=!1;return r.listener=t,this.on(n,r),this};t.prototype.removeListener=function(n,t){var u,e,o,f;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[n])return this;if(u=this._events[n],o=u.length,e=-1,u===t||i(u.listener)&&u.listener===t)delete this._events[n],this._events.removeListener&&this.emit("removeListener",n,t);else if(r(u)){for(f=o;f-->0;)if(u[f]===t||u[f].listener&&u[f].listener===t){e=f;break}if(e<0)return this;1===u.length?(u.length=0,delete this._events[n]):u.splice(e,1);this._events.removeListener&&this.emit("removeListener",n,t)}return this};t.prototype.removeAllListenis};t.prototype.listen[]};t.prototype.listenerCo 0};t.listenerCot)}},function(n,t,i){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e=i(37),o=i(38),s=i(39),u=i(2),r=i(0),h=i(1),c=i(5),l=Object(c.a)(),a=function(){function n(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=o.removePKCS7Padding,e=void 0===u||u,r;if(f(this,n),this.logEnabled=!0,this.observer=t,this.config=i,this.removePKCS7Padding=e,e)try{r=l.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(n){}this.disableWebCrypto=!this.subtle}return n.prototype.isSES},n.prototype.decrypt=function(n,t,i,u){var c=this,f,h;this.disableWebCrypto&&this.config.enableSoftwareAES?(this.logEnabled&&(r.b.log("JS AES decrypt"),this.logEnabled=!1),f=this.decryptor,f||(this.decryptor=f=new s.a),f.expandKey(t),u(f.decrypt(n,0,i,this.removePKCS7Padding))):(this.logEnabled&&(r.b.log("WebCrypto AES decrypt"),this.logEnabled=!1),h=this.subtle,this.key!==t&&(this.key=t,this.fastAesKey=new o.a(h,t)),this.fastAesKey.expandKey().t})}).cau)}))},n.prototype.onWebCryptoEr))},n.prototype.dest0)},n}();t.a=a},function(n,t){"use strice}t.a=i},function(n,t,i){"use stri)}function e(n,t,i,u,e,o){var v=i,a,y,c;if(Object(r.a)(t.startPTS)&&(a=Math.abs(t.startPTS-i),t.deltaPTS=Object(r.a)(t.deltaPTS)?Math.max(a,t.deltaPTS):a,v=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),u=Math.max(u,t.endPTS),e=Math.min(e,t.startDTS),o=Math.max(o,t.endDTS)),y=i-t.start,t.start=t.startPTS=i,t.maxStartPTS=v,t.endPTS=u,t.startDTS=e,t.endDTS=o,t.duration=u-i,c=t.sn,!n||c<n.startSN||c>n.endSN)return 0;var l=void 0,h=void 0,s=void 0;for(l=c-n.startSN,h=n.fragments,h[l]=t,s=l;s>0;s--)f(h,s,s-1);for(s=l;s<h.length-1;s++)f(h,s,s+1);return n.PTSKnown=!0,y}function s(n,t){var v=Math.max(n.startSN,t.startSN)-t.startSN,y=Math.min(n.endSN,t.endSN)-t.startSN,c=t.startSN-n.startSN,l=n.fragments,h=t.fragments,a=0,s=void 0,i,o,f,p;if(t.initSegment&&n.initSegment&&(t.initSegment=n.initSegment),y<v)return void(t.PTSKnown=!1);for(i=v;i<=y;i++)o=l[c+i],f=h[i],f&&o&&(a=o.cc-f.cc,Object(r.a)(o.startPTS)&&(f.start=f.startPTS=o.startPTS,f.endPTS=o.endPTS,f.duration=o.duration,f.backtracked=o.backtracked,f.dropped=o.dropped,s=f));if(a)for(u.b.log("discontinuity sliding from playlist, take drift into account"),i=0;i<h.length;i++)h[i].cc+=a;if(s)e(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS);else if(c>=0&&c<l.length)for(p=l[c].start,i=0;i<h.length;i++)h[i].start+=p;t.PTSKnown=n.PTSKnown}t.a=o;t.c=e;t.b=s;var r=i(3),u=i(0)},function(n,t,i){"use strict";function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function v(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var h=i(3),u=i(1),y=i(4),f=i(2),e=i(0),p=i(18),o=i(30),w=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),b=window,c=b.performance,r={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},s={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},k=function,r}return v(t,n),t.canHaveQualityLevCK},t.mapContextToLevelTN}},t.getResponse,i},t.prototype.createInternalLoa,i},t.prototype.getInternalLoae]},t.prototype.resetInternalLoan]},t.prototype.destroyInternalLoaders=function(){var n,t;for(n in this.loaders)t=this.loaders[n],t&&t.destroy(),this.resetInternalLoader(n)},t.prototype.destroy=function(){this.destroyInternalLoaders();n.prototype.destroy.call(this)},t.prototype.onManifestLoad})},t.prototype.onLevelLoad})},t.prototype.onAudioTrackLoading=function(n){this.load(n.url,{type:r.AUDIO_TRACK,level:null,id:n.id})},t.prototype.onSubtitleTrackLoad})},t.prototype.load=function(n,t){var i=this.hls.config,u,s,l,a;if(e.b.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id),u=this.getInternalLoader(t),u){if(s=u.context,s&&s.url===n)return e.b.trace("playlist request ongoing"),!1;e.b.warn("aborting previous loader for type: "+t.type);u.abort()}var f=void 0,o=void 0,h=void 0,c=void 0;switch(t.type){case r.MANIFEST:f=i.manifestLoadingMaxRetry;o=i.manifestLoadingTimeOut;h=i.manifestLoadingRetryDelay;c=i.manifestLoadingMaxRetryTimeout;break;case r.LEVEL:f=0;o=i.levelLoadingTimeOut;break;default:f=i.levelLoadingMaxRetry;o=i.levelLoadingTimeOut;h=i.levelLoadingRetryDelay;c=i.levelLoadingMaxRetryTimeout}return u=this.createInternalLoader(t),t.url=n,t.responseType=t.responseType||"",l={timeout:o,maxRetry:f,retryDelay:h,maxRetryDelay:c},a={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},e.b.debug("Calling internal loader delegate for URL: "+n),u.load(t,l,a),!0},t.prototype.loadsuccess=function(n,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u;if(i.isSidxRequest)return this._handleSidxRequest(n,i),void this._handlePlaylistLoaded(n,t,i,r);if(this.resetInternalLoader(i.type),u=n.data,t.tload=c.now(),0!==u.indexOf("#EXTM3U"))return void this._handleManifestParsingError(n,i,"no EXTM3U delimiter",r);u.indexOf("#EXTINF:")>0||u.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(n,t,i,r):this._handleMasterPlaylist(n,t,i,r)},t.prototype.loaderi)},t.prototype.loadtime0)},t.prototype._handleMasterPlaylist=function(n,i,r,f){var v=this.hls,l=n.data,h=t.getResponseUrl(n,r),s=o.a.parseMasterPlaylist(l,h),a;if(!s.length)return void this._handleManifestParsingError(n,r,"no level found in manifest",f);var y=s.c}}),c=o.a.parseMasterPlaylistMedia(l,h,"AUDIO",y),p=o.a.parseMasterPlaylistMedia(l,h,"SUBTITLES");c.length&&(a=!1,c.forE0)}),!1===a&&s[0].audioCodec&&!s[0].attrs.AUDIO&&(e.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),c.unshift({type:"main",name:"main"})));v.trigger(u.a.MANIFEST_LOADED,{levels:s,audioTracks:c,subtitles:p,url:h,stats:i,networkDetails:f})},t.prototype._handleTrackOrLevelPlaylist=function(n,i,f,e){var k=this.hls,l=f.id,a=f.level,y=f.type,v=t.getResponseUrl(n,f),p=Object(h.a)(l)?l:0,d=Object(h.a)(a)?a:p,g=t.mapContextToLevelType(f),s=o.a.parseLevelPlaylist(n.data,v,d,g,p),w,b;if((s.tload=i.tload,y===r.MANIFEST)&&(w={url:v,details:s},k.trigger(u.a.MANIFEST_LOADED,{levels:[w],audioTracks:[],url:v,stats:i,networkDetails:e})),i.tparsed=c.now(),s.needSidxRanges)return b=s.initSegment.url,void this.load(b,{isSidxRequest:!0,type:y,level:a,levelDetails:s,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});f.levelDetails=s;this._handlePlaylistLoaded(n,i,f,e)},t.prototype._handleSidxRequest=function(n,t){var i=p.a.parseSegmentIndex(new Uint8Array(n.data));i.references.forE))});t.levelDetails.initSegment.rawByteRange=String(i.moovEndOffset)+"@0"},t.prototype._handleManifestParsingEr})},t.prototype._handleNetworkError=function(n,t){var h=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.b.info("A network error occured while loading a "+n.type+"-type playlist");var o=void 0,i=void 0,s=this.getInternalLoader(n);switch(n.type){case r.MANIFEST:o=h?f.a.MANIFEST_LOAD_TIMEOUT:f.a.MANIFEST_LOAD_ERROR;i=!0;break;case r.LEVEL:o=h?f.a.LEVEL_LOAD_TIMEOUT:f.a.LEVEL_LOAD_ERROR;i=!1;break;case r.AUDIO_TRACK:o=h?f.a.AUDIO_TRACK_LOAD_TIMEOUT:f.a.AUDIO_TRACK_LOAD_ERROR;i=!1;break;default:i=!1}s&&(s.abort(),this.resetInternalLoader(n.type));this.hls.trigger(u.a.ERROR,{type:f.b.NETWORK_ERROR,details:o,fatal:i,url:s.url,loader:s,context:n,networkDetails:t})},t.prototype._handlePlaylistLoa)}},w(t,null,[{key:"ContextType",get:function(){return r}},{key:"LevelType",get:function(){return s}}]),t}(y.a);t.a=k},function(n,t,i){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e=i(0),r=i(1),u=Math.pow(2,32)-1,o=function(){function n(t,i){f(this,n);this.observer=t;this.remuxer=i}return n.prototype.resetTimeStamp=function(n){this.initPTS=n},n.prototype.resetInitSegment=function(t,i,u,f){var e,o;t&&t.byteLength?(e=this.initData=n.parseInitSegment(t),null==i&&(i="mp4a.40.5"),null==u&&(u="avc1.42e01e"),o={},e.audio&&e.video?o.audiovideo={container:"video/mp4",codec:i+","+u,initSegment:f?t:null}:(e.audio&&(o.audio={container:"audio/mp4",codec:i,initSegment:f?t:null}),e.video&&(o.video={container:"video/mp4",codec:u,initSegment:f?t:null})),this.observer.trigger(r.a.FRAG_PARSING_INIT_SEGMENT,{tracks:o})):(i&&(this.audioCodec=i),u&&(this.videoCodec=u))},n.pr>0},n.bin2n)},n.readUin:i},n.readUin:i},n.writeUint32=function(n,t,i){n.data&&(t+=n.start,n=n.data);n[t]=i>>24;n[t+1]=i>>16&255;n[t+2]=i>>8&255;n[t+3]=255&i},n.find u},n.parseSegmentIndex=function(t){var y=n.findBox(t,["moov"])[0],p=y?y.end:null,r=0,i=n.findBox(t,["sidx"]),s=void 0,f,h,e,c,l,u,a,o,v;if(!i||!i[0])return null;for(s=[],i=i[0],f=i.data[0],r=0===f?8:16,h=n.readUint32(i,r),r+=4,r+=0===f?8:16,r+=2,e=i.end+0,c=n.readUint16(i,r),r+=2,l=0;l<c;l++){if(u=r,a=n.readUint32(i,u),u+=4,o=2147483647&a,1==(2147483648&a)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");v=n.readUint32(i,u);u+=4;s.push({referenceSize:o,subsegmentDuration:v,info:{duration:v/h,start:e,end:e+o-1}});e+=o;u+=4;r=u}return{earliestPresentationTime:0,timescale:h,version:f,referencesCount:c,references:s,moovEndOffset:p}},n.parseInitSegment=function(t){var i=[];return n.findBox(t,["moov","trak"]).forEach(function(t){var o=n.findBox(t,["tkhd"])[0],l,u,v,f,r,y;if(o){var h=o.data[o.start],c=0===h?12:20,a=n.readUint32(o,c),s=n.findBox(t,["mdia","mdhd"])[0];s&&(h=s.data[s.start],c=0===h?12:20,l=n.readUint32(s,c),u=n.findBox(t,["mdia","hdlr"])[0],u&&(v=n.bin2str(u.data.subarray(u.start+8,u.start+12)),f={soun:"audio",vide:"video"}[v],f&&(r=n.findBox(t,["mdia","minf","stbl","stsd"]),r.length&&(r=r[0],y=n.bin2str(r.data.subarray(r.start+12,r.start+16)),e.b.log("MP4Demuxer:"+f+":"+y+" found")),i[a]={timescale:l,type:f},i[f]={timescale:l,id:a})))}}),i},n.getStart:0},n.offsetStartDTS=function(t,i,r){n.findBox(i,["moof","traf"]).map(function(i){return n.findBox(i,["tfhd"]).map(function(f){var o=n.readUint32(f,4),e=t[o].timescale||9e4;n.findBox(i,["tfdt"]).map(function(t){var s=t.data[t.start],i=n.readUint32(t,4),f,o;0===s?n.writeUint32(t,4,i-r*e):(i*=Math.pow(2,32),i+=n.readUint32(t,8),i-=r*e,i=Math.max(i,0),f=Math.floor(i/(u+1)),o=Math.floor(i%(u+1)),n.writeUint32(t,4,f),n.writeUint32(t,8,o))})})})},n.prototype.append=function(t,i,u,f){var e=this.initData,s,o,h;e||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),e=this.initData);s=void 0;o=this.initPTS;void 0===o&&(h=n.getStartDTS(e,t),this.initPTS=o=h-i,this.observer.trigger(r.a.INIT_PTS_FOUND,{initPTS:o}));n.offsetStartDTS(e,t,o);s=n.getStartDTS(e,t);this.remuxer.remux(e.audio,e.video,null,null,s,u,f,t)},n.prototype.destroy=function(){},n}();t.a=o},function(n,t,i){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u=i(6),f=i.n(u),e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=function(){function n(){r(this,n);this.method=null;this.key=null;this.iv=null;this._uri=null}return e(n,[{key:"uri",ri}}]),n}();t.a=o},function(n,t,i){"use stri)}i.d(t,"b",function(){return r});i.d(t,"a",function(){return u});var f={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}}},function(n,t,i){"use strict";function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var c=i(3),l=i(13),a=i.n(l),v=i(36),y=i.n(v),r=i(1),e=i(22),u=i(0),o=i(2),p=i(15),w=i(5),s=Object(w.a)(),f=Object(p.a)(),b=function(){function n(t,i){var c,p,l,w,b,v;if(h(this,n),this.hls=t,this.id=i,c=this.observer=new a.a,p=t.config,c.trigger=function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];c.emit.apply(c,[n,n].concat(r))},c.off=function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];c.removeListener.apply(c,[n].concat(r))},l=function(n,i){i=i||{};i.frag=this.frag;i.id=this.id;t.trigger(n,i)}.bind(this),c.on(r.a.FRAG_DECRYPTED,l),c.on(r.a.FRAG_PARSING_INIT_SEGMENT,l),c.on(r.a.FRAG_PARSING_DATA,l),c.on(r.a.FRAG_PARSED,l),c.on(r.a.ERROR,l),c.on(r.a.FRAG_PARSING_METADATA,l),c.on(r.a.FRAG_PARSING_USERDATA,l),c.on(r.a.INIT_PTS_FOUND,l),w={mp4:f.isTypeSupported("video/mp4"),mpeg:f.isTypeSupported("audio/mpeg"),mp3:f.isTypeSupported('audio/mp4; codecs="mp3"')},b=navigator.vendor,p.enableWorker&&"undefined"!=typeof Worker){u.b.log("demuxing in webworker");v=void 0;try{v=this.w=y()(49);this.onwmsg=this.onWorkerMessage.bind(this);v.addEventListener("message",this.onwmsg);v.oner})};v.postMessage({cmd:"init",typeSupported:w,vendor:b,id:i,config:JSON.stringify(p)})}catch(n){u.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline");v&&s.URL.revokeObjectURL(v.objectURL);this.demuxer=new e.a(c,w,p,b);this.w=void 0}}else this.demuxer=new e.a(c,w,p,b)}return n.prototype.destroy=function(){var n=this.w,t,i;n?(n.removeEventListener("message",this.onwmsg),n.terminate(),this.w=null):(t=this.demuxer,t&&(t.destroy(),this.demuxer=null));i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},n.prototype.push=function(n,t,i,r,f,e,o,s){var y=this.w,p=Object(c.a)(f.startDTS)?f.startDTS:f.start,w=f.decryptdata,h=this.frag,a=!(h&&f.cc===h.cc),l=!(h&&f.level===h.level),k=h&&f.sn===h.sn+1,b=!l&&k,v;(a&&u.b.log(this.id+":discontinuity detected"),l&&u.b.log(this.id+":switch detected"),this.frag=f,y)?y.postMessage({cmd:"demux",data:n,decryptdata:w,initSegment:t,audioCodec:i,videoCodec:r,timeOffset:p,discontinuity:a,trackSwitch:l,contiguous:b,duration:e,accurateTimeOffset:o,defaultInitPTS:s},n instanceof ArrayBuffer?[n]:[]):(v=this.demuxer,v&&v.push(n,w,t,i,r,p,a,l,b,e,o,s))},n.prototype.onWorkerMessage=function(n){var t=n.data,i=this.hls;switch(t.event){case"init":s.URL.revokeObjectURL(this.w.objectURL);break;case r.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1);t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{};t.data.frag=this.frag;t.data.id=this.id;i.trigger(t.event,t.data)}},n}();t.a=b},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u=i(1),f=i(2),s=i(14),h=i(40),c=i(18),l=i(41),a=i(44),r=i(45),v=i(48),y=i(5),p=Object(y.a)(),e=p.performance,w=functio=u}return n.prototype.dest()},n.prototype.push=function(n,t,i,r,f,o,h,c,l,a,v,y){var p,b,w;if(n.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){p=this.decrypter;null==p&&(p=this.decrypter=new s.a(this.observer,this.config));b=this;w=void 0;try{w=e.now()}catch(n){w=Date.now()}p.decrypt(n,t.key.buffer,t.iv.buffer,function(n){var s=void 0;try{s=e.now()}catch(n){s=Date.now()}b.observer.trigger(u.a.FRAG_DECRYPTED,{stats:{tstart:w,tdecrypt:s}});b.pushDecrypted(new Uint8Array(n),t,new Uint8Array(i),r,f,o,h,c,l,a,v,y)})}else this.pushDecrypted(new Uint8Array(n),t,new Uint8Array(i),r,f,o,h,c,l,a,v,y)},n.prototype.pushDecrypted=function(n,t,i,e,o,s,y,p,w,b,k,d){var g=this.demuxer,nt,rt,st,ut;if(!g||(y||p)&&!this.probe(n)){for(var tt=this.observer,ft=this.typeSupported,et=this.config,ot=[{demux:l.a,remux:r.a},{demux:c.a,remux:v.a},{demux:h.a,remux:r.a},{demux:a.a,remux:r.a}],it=0,ht=ot.length;it<ht;it++)if(nt=ot[it],rt=nt.demux.probe,rt(n)){st=this.remuxer=new nt.remux(tt,et,ft,this.vendor);g=new nt.demux(tt,st,et,ft);this.probe=rt;break}if(!g)return void tt.trigger(u.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=g}ut=this.remuxer;(y||p)&&(g.resetInitSegment(i,e,o,b),ut.resetInitSegment());y&&(g.resetTimeStamp(d),ut.resetTimeStamp(d));"function"==typeof g.setDecryptData&&g.setDecryptData(t);g.append(n,s,w,k)},n}();t.a=w},function(n,t,i){"use strict";function h(n,t,i,r){var e=void 0,u=void 0,h=void 0,c=void 0,f=void 0,l=navigator.userAgent.toLowerCase(),v=r,a=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return e=1+((192&t[i+2])>>>6),(u=(60&t[i+2])>>>2)>a.length-1?void n.trigger(p.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+u}):(c=(1&t[i+2])<<2,c|=(192&t[i+3])>>>6,o.b.log("manifest codec:"+r+",ADTS data:type:"+e+",sampleingIndex:"+u+"["+a[u]+"Hz],channelConfig:"+c),/firefox/i.test(l)?u>=6?(e=5,f=new Array(4),h=u-3):(e=2,f=new Array(2),h=u):-1!==l.indexOf("android")?(e=2,f=new Array(2),h=u):(e=5,f=new Array(4),r&&(-1!==r.indexOf("mp4a.40.29")||-1!==r.indexOf("mp4a.40.5"))||!r&&u>=6?h=u-3:((r&&-1!==r.indexOf("mp4a.40.2")&&(u>=6&&1===c||/vivaldi/i.test(l))||!r&&1===c)&&(e=2,f=new Array(2)),h=u)),f[0]=e<<3,f[0]|=(14&u)>>1,f[1]|=(1&u)<<7,f[1]|=c<<3,5===e&&(f[1]|=(14&h)>>1,f[2]=(1&h)<<7,f[2]|=8,f[3]=0),{config:f,samplerate:a[u],channelCount:c,codec:"mp4a.40."+e,manifestCodec:function l(n,t){var o,e,i;return t+1<n.length&&r(n,t)&&(o=u(n,t),e=o,t+5<n.length&&(e=f(n,t)),i=t+e,i===n.length||i+1<n.length&&r(n,i))?!0:!1}function a(n,t,i,r,u){if(!n.samplerate){var f=h(t,i,r,u);n.config=f.config;n.samplerate=f.samplerate;n.channelCount=f.channelCount;n.codec=f.codec;n.manifestCodec=f.manifestCodec;o.b.log("parsed codec:"+n.codec+",rate:"+f.samplerate+",nb channel:"+f.channelCoun}t.d=c;t.e=l;t.c=a;t.b=e;t.a=y;var o=i(0),s=i(2),p=i(1);i(5)},function(n,t){"use strict";var i={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(n,t,i,r,u){var f;if(!(i+24>t.length)&&(f=this.parseHeader(t,i),f&&i+f.frameLength<=t.length)){var s=9e4*f.samplesPerFrame/f.sampleRate,e=r+u*s,o={unit:t.subarray(i,i+f.frameLength),pts:e,dts:e};return n.config=[],n.channelCount=f.channelCount,n.samplerate=f.sampleRate,n.samples.push(o),n.len+=f.frameLength,{sample:o,length:f.frameLength}}},parseHea}}},isHeaderPatt])},isHea))},probe:function(n,t){var i,u,r;return t+1<n.length&&this.isHeaderPattern(n,t)&&(i=this.parseHeader(n,t),u=4,i&&i.frameLength&&(u=i.frameLength),r=t+u,r===n.length||r+1<n.length&&this.isHeaderPattern(n,r))?!0:!1}};t.a=i},function(n,t){"use strict";var i={toStr i}};t.a=i},function(n,t,i){"use strict";function f(n,t){for(var r,u=null,i=0;i<n.length;i+=1)if(r=n[i],r&&r.cc===t){u=r;break}returr}function s(n,t){var u=n.fragments,e=t.fragments,i;return!e.length||!u.length?void r.b.log("No fragments to align"):(i=f(u,e[0].cc),!i||i&&!i.startPTS?void r.b.log("No frag in previous level to align on"):i)}function u(n,t){t.fragments.forEn}});t.PTSKnown=!0}function h(n,t,i){c(n,i,t);!i.PTSKnown&&t&&l(i,t.detai)}}function l(n,t){if(t&&t.fragments.length){if(!n.hasProgramDateTime||!t.hasProgramDateTime)return;var f=t.fragments[0].programDateTime,e=n.fragments[0].programDateTime,i=(e-f)/1e3+t.fragments[0].start;Object(a.a)(i)&&(r.b.log("adjusting PTS using programDateTime delta, sliding:"+i.toFixed(3)),u(i,n))}}t.b=e;t.a=h;var a=i(3),v=i(7),r=i(0)},function(n,t){"use strict";function i(n,t){var i=null;try{i=new window.Event("addtrack")}catch(n){i=document.createEvent("Event");i.initEvent("addtrack",!1,!1)}i.track=n;t.dispatchEvent])}t.b=i;t.a=r},function(n,t,i){"use stri}function s(n,t,i,r){var f=r?n.split(r):[n],e,u,o,s;for(e in f)"string"==typeof f[e]&&(u=f[e].split(i),2===u.length&&(o=u[0],s=u[1],t(o,s)))}function a(n,t)}var h=n;if(f(),t.startTime=e(),f(),"-->"!==n.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+h);n=n.substr(3);f();t.endTime=e();f(),function(n,t){var f=new o,e,h;s(n,function(n,t){var e,u,o;switch(n){case"region":for(e=i.length-1;e>=0;e--)if(i[e].id===t){f.set(n,i[e].region);break}break;case"vertical":f.alt(n,t,["rl","lr"]);break;case"line":u=t.split(",");o=u[0];f.integer(n,o);f.percent(n,o)&&f.set("snapToLines",!1);f.alt(n,o,["auto"]);2===u.length&&f.alt("lineAlign",u[1],["start",r,"end"]);break;case"position":u=t.split(",");f.percent(n,u[0]);2===u.length&&f.alt("positionAlign",u[1],["start",r,"end","line-left","line-right","auto"]);break;case"size":f.percent(n,t);break;case"align":f.alt(n,t,["start",r,"end","left","right"])}},/:/,/\s/);t.region=f.get("region",null);t.vertical=f.get("vertical","");e=f.get("line","auto");"auto"===e&&-1===u.line&&(e=-1);t.line=e;t.lineAlign=f.get("lineAlign","start");t.snapToLines=f.get("snapToLines",!0);t.size=f.get("size",100);t.align=f.get("align",r);h=f.get("position","auto");"auto"===h&&50===u.position&&(h="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50);t.position=h}(n")}var f,c,u,r;i.d(t,"b",function(){return h});f=i(66}}};o.prototype={t)},:t},es},k}},inte))},perc0)}};u=new f.a(0,0,0);r="middle"===u.align?"middle":"center";e.prototype={parse:function(n){function e(){for(var i=t.buffer,n=0,r,i=h(i);n<i.length&&"\r"!==i[n]&&"\n"!==i[n];)++n;return r=i.substr(0,n),"\r"===i[n]&&++n,"\n"===i[n]&&++n,t.buffer=i.substr(n),r}var t=this,i,u,r,o;n&&(t.buffer+=t.decoder.decode(n,{stream:!0}));try{if(i=void 0,"INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;if(i=e(),u=i.match(/^(ï»¿)?WEBVTT([ \t].*)?$/),!u||!u[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(r=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:i=e(),t.state){case"HEADER":/:/.test(i)?function(n){s(n,function(){},/:/)}(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new f.a(0,0,""),t.state="CUE",-1===i.indexOf("-->")){t.cue.id=i;continue}case"CUE":try{a(i,t.cue,t.regionList)}catch(n){t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":if(o=-1!==i.indexOf("-->"),!i||o&&(r=!0)){t.oncue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}t.cue.text&&(t.cue.text+="\n");t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID");continue}}}catch(n){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue);t.cue=null;t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},this}};t.a=e},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var o;Object.defineProperty(t,"__esModule",{value:!0});var h=i(6),c=i.n(h),f=i(2),l=i(17),a=i(33),v=i(34),y=i(12),p=i(35),w=i(52),b=i(53),k=i(54),r=i(0),d=i(55),u=i(1),g=i(13),nt=i.n(g),e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();i(75);o=function(){function n(){var tt=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o,e,i,f,c,k,d;if(s(this,n),o=n.DefaultConfig,(t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(e in o)e in t||(t[e]=o[e]);if(void 0!==t.liveMaxLatencyDurationCount&&t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(t.liveMaxLatencyDuration<=t.liveSyncDuration||void 0===t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(r.a)(t.debug);this.config=t;this._autoLevelCapping=-1;i=this.observer=new nt.a;i.tt(u))}t(u))};this.on=i.on.bind(i);this.off=i.off.bind(i);this.once=i.once.bind(i);this.trigger=i.trigger.bind(i);var it=this.abrController=new t.abrController(this),rt=new t.bufferController(this),ut=new t.capLevelController(this),ft=new t.fpsController(this),et=new l.a(this),ot=new a.a(this),st=new v.a(this),ht=new b.a(this),ct=this.levelController=new w.a(this),h=new y.b(this),lt=this.streamController=new p.a(this,h),g=[ct,lt],u=t.audioStreamController;u&&g.push(new u(this,h));this.networkControllers=g;f=[et,ot,st,it,rt,ut,ft,ht,h];(u=t.audioTrackController)&&(c=new u(this),this.audioTrackController=c,f.push(c));(u=t.subtitleTrackController)&&(k=new u(this),this.subtitleTrackController=k,f.push(k));(u=t.emeController)&&(d=new u(this),this.emeController=d,f.push(d));[t.subtitleStreamController,t.timelineController].f(tt))});this.coreComponents=f}return n.isSup.a)()},e(n,null,[{key:"versio11.0"}},{key:"Events",get:function(){return u.a}},{key:"ErrorTypes",get:function(){return f.b}},{key:"ErrorDetails",get:function(){return f.a}},{key:"DefaultConfig:d.fig=t}}]),n.prototype.destroy=function(){r.b.log("destroy");this.trigger(u.a.DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach(function(n){n.destroy()});this.url=null;this.observer.removeAllListeners();this._autoLevelCapping=-1},n.prototype.attaca:n})},n.prototype.detachMedia=function(){r.b.log("detachMedia");this.trigger(u.a.MEDIA_DETACHING);this.media=null},n.prototype.loadSource=function(n){n=c.a.buildAbsoluteURL(window.location.href,n,{alwaysNormalize:!0});r.b.log("loadSource:"+n);this.url=n;this.trigger(u.a.MANIFEST_LOADING,{url:n})},n.prototype.startLoad=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;r.b.log("startLoad("+n+")");this.networkControllers.forEach(function(t){t.startLoad(n)})},n.prototype.std()})},n.prototype.swapAudidec()},n.prototype.recoverMediaError=function(){r.b.log("recoverMediaError");var n=this.media;this.detachMedia();this.attachMedia(n)},e(n,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(n){r.b.log("set currentLevel:"+n);this.loadLevel=n;this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevetch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(n){r.b.log("set loadLevel:"+n);this.levelController.manualLevel=n}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevevel=n}},{key:"firstLeveevelvel=n}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(n){r.b.log("set startLevel:"+n);var t=this;-1!==n&&(n=Math.max(n,t.minAutoLevel));t.levelController.startLevel=n}},{key:"autoLevelCapping",get:function(){return this._autoLevelCappining=n}},{key:"autoLevelEnableLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var i=this,t=i.levels,r=i.config.minAutoBitrate,u=t?t.length:0,n=0;n<u;n++)if((t[n].realBitrate?Math.max(t[n].realBitrate,t[n].bitrate):t[n].bitrate)>r)return n;return 0}},{key:"maxAutoLeveh-1:i}},{key:"nextAutoLeveevelel,n)}},{key:"audioTracks",get:function(){var n=this.audioTrackController;return n?n.audioTracks:[]}},{key:"audioTrack",get:function(){var n=this.audioTrackController;return n?n.audioTrack:-1},set:function(n){var t=this.audioTrackController;t&&(t.audioTrack=n)}},{key:"liveSyncPositioition}},{key:"subtitleTrackks:[]}},{key:"subtitleTrack",get:function(){var n=this.subtitleTrackController;return n?n.subtitleTrack:-1},set:function(n){var t=this.subtitleTrackController;t&&(t.subtitleTrack=n)}},{key:"subtitleDisplasplaay=n)}}]),n}();t.default=o},function(n,t,i){"use strict";function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){for(var r,u=n[t],i=t-1;i>=0;i--)r=n[i],r.programDateTime=u.programDateTime-1e3*r.duration,u=r}function v(n,t){n.rawProgramDateTime?n.programDateTime=Date.parse(n.rawProgramDateTime):t&&t.programDateTime&&(n.programDateTime=t.endProgramDateTime);Object(f.a)(n.programDateTime)||(n.programDateTime=null,n.rawProgramDateTime=null)}var f=i(3),y=i(6),p=i.n(y),u=i(11),w=i(31),e=i(19),r=i(32),o=i(0),b=i(20),s=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,h=/#EXT-X-MEDIA:(.*)/g,c=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),k=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,d=/\.(mp4|m4s|m4v|m4a)$/i,g=funcis,n)}return n.findGroup=function(n,t){var r,i,u;if(!n)return null;for(r=null,i=0;i<n.length;i++)u=n[i],u.id===t&&(r=u);return r},n.convertAVC1Tot=n,t},n.r:!0})},n.parseMasterPlaylist=function(t,i){var h=[],o=void 0,u,f,e;for(s.lastIndex=0;null!=(o=s.exec(t));)u={},f=u.attrs=new r.a(o[1]),u.url=n.resolve(o[2],i),e=f.decimalResolution("RESOLUTION"),e&&(u.width=e.width,u.height=e.height),u.bitrate=f.decimalInteger("AVERAGE-BANDWIDTH")||f.decimalInteger("BANDWIDTH"),u.name=f.NAME,function(n,t){["video","audio"].forEach(function(i){var r=n.(n,i)}),u;r.length&&(u=r.a",0)}),t[i+"Codec"]=u.length>0?u[0]:r[0],n=n.Of(n)}))});t.unknownCodecs=n}([].concat((f.CODECS||"").split(/[ ,]+/)),u),u.videoCodec&&-1!==u.videoCodec.indexOf("avc1")&&(u.videoCodec=n.convertAVC1ToAVCOTI(u.videoCodec)),h.push(u);return h},n.parseMasterPlaylistMedia=function(t,i,u){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],c=void 0,l=[],a=0,f,e,s;for(h.lastIndex=0;null!==(c=h.exec(t));)f={},e=new r.a(c[1]),e.TYPE===u&&((f.groupId=e["GROUP-ID"],f.name=e.NAME,f.type=u,f.default="YES"===e.DEFAULT,f.autoselect="YES"===e.AUTOSELECT,f.forced="YES"===e.FORCED,e.URI&&(f.url=n.resolve(e.URI,i)),f.lang=e.LANGUAGE,f.name||(f.name=f.lang),o.length)&&(s=n.findGroup(o,f.groupId),f.audioCodec=s?s.codec:o[0].codec),f.id=a++,l.push(f));return l},n.parseLevelPlaylist=function(n,t,i,s,h){var ot=0,tt=0,y=new w.a(t),g=new e.a,ut=0,it=null,l=new u.a,p=void 0,nt=void 0,ft=null,rt,et,vt,st,b,ht,at;for(c.lastIndex=0;null!==(p=c.exec(n));)if(rt=p[1],rt)l.duration=parseFloat(rt),et=(" "+p[2]).slice(1),l.title=et||null,l.tagList.push(et?["INF",rt,et]:["INF",rt]);else if(p[3])Object(f.a)(l.duration)&&(vt=ot++,l.type=s,l.start=tt,l.levelkey=g,l.sn=vt,l.level=i,l.cc=ut,l.urlId=h,l.baseurl=t,l.relurl=(" "+p[3]).slice(1),v(l,it),y.fragments.push(l),it=l,tt+=l.duration,l=new u.a);else if(p[4])(l.rawByteRange=(" "+p[4]).slice(1),it)&&(st=it.byteRangeEndOffset,st&&(l.lastByteRangeEndOffset=st));else if(p[5])l.rawProgramDateTime=(" "+p[5]).slice(1),l.tagList.push(["PROGRAM-DATE-TIME",l.rawProgramDateTime]),null===ft&&(ft=y.fragments.length);else{for(p=p[0].match(k),nt=1;nt<p.length&&void 0===p[nt];nt++);b=(" "+p[nt+1]).slice(1);ht=(" "+p[nt+2]).slice(1);switch(p[nt]){case"#":l.tagList.push(ht?[b,ht]:[b]);break;case"PLAYLIST-TYPE":y.type=b.toUpperCase();break;case"MEDIA-SEQUENCE":ot=y.startSN=parseInt(b);break;case"TARGETDURATION":y.targetduration=parseFloat(b);break;case"VERSION":y.version=parseInt(b);break;case"EXTM3U":break;case"ENDLIST":y.live=!1;break;case"DIS":ut++;l.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":ut=parseInt(b);break;case"KEY":var wt=b,ct=new r.a(wt),lt=ct.enumeratedString("METHOD"),yt=ct.URI,bt=ct.hexadecimalInteger("IV");lt&&(g=new e.a,yt&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(lt)>=0&&(g.method=lt,g.baseuri=t,g.reluri=yt,g.key=null,g.iv=bt));break;case"START":var kt=b,dt=new r.a(kt),pt=dt.decimalFloatingPoint("TIME-OFFSET");Object(f.a)(pt)&&(y.startTimeOffset=pt);break;case"MAP":at=new r.a(b);l.relurl=at.URI;l.rawByteRange=at.BYTERANGE;l.baseurl=t;l.level=i;l.type=s;l.sn="initSegment";y.initSegment=l;l=new u.a;l.rawProgramDateTime=y.initSegment.rawProgramDateTime;break;default:o.b.warn("line parsed but not handled: "+p)}}return l=it,l&&!l.relurl&&(y.fragments.pop(),tt-=l.duration),y.totalduration=tt,y.averagetargetduration=tt/y.fragments.length,y.endSN=ot-1,y.startCC=y.fragments[0]?y.fragments[0].cc:0,y.endCC=ut,!y.initSegment&&y.fragments.length&&y.fragmentslurl)})&&(o.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),l=new u.a,l.relurl=y.fragments[0].relurl,l.baseurl=t,l.level=i,l.type=s,l.sn="initSegment",y.initSegment=l,y.needSidxRanges=!0),ft&&a(y.fragments,ft),y},n}();t.a=g},function(n,t,i){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u=i(3),f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=function(){function n(t){r(this,n);this.endCC=0;this.endSN=0;this.fragments=[];this.initSegment=null;this.live=!0;this.needSidxRanges=!1;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=t;this.version=null}return f(n,[{key:"hasProgramDateTimime))}}]),n}();t.a=e},function(n,t){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,f=function(){function n(t){r(this,n);"string"==typeof t&&(t=n.parseAttrList(t));for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])}return n.prototype.decimalInteger=function(n){var t=parseInt(this[n],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},n.prototype.hexadecimalInteger=function(n){var t,r,i;if(this[n]){for(t=(this[n]||"0x").slice(2),t=(1&t.length?"0":"")+t,r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},n.prototype.hexadecimalIntegerAs1/0:t},n.prototype.decimalFloatins[n])},n.prototype.enumeratedis[n]},n.prototype.decimalReso,10)}},n.parseAttrList=function(n){var r=void 0,u={},t;for(i.lastIndex=0;null!==(r=i.exec(n));)t=r[2],0===t.indexOf('"')&&t.lastIndexOf('"')===t.length-1&&(t=t.slice(1,-1)),u[r[1]]=t;return u},n}();t.a=f},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function o(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function s(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f=i(3),r=i(1),h=i(4),u=i(2),c=i(0),l=funct={},u}return s(t,n),t.prototype.destroy=function(){var i=this.loaders,r,t;for(r in i)t=i[r],t&&t.destroy();this.loaders={};n.prototype.destroy.call(this)},t.prototype.onFragLoading=function(n){var t=n.frag,e=t.type,h=this.loaders,i=this.hls.config,v=i.fLoader,y=i.loader,r,o,s;t.loaded=0;r=h[e];r&&(c.b.warn("abort previous fragment loader for type: "+e),r.abort());r=h[e]=t.loader=i.fLoader?new v(i):new y(i);var u=void 0,l=void 0,a=void 0;u={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};o=t.byteRangeStartOffset;s=t.byteRangeEndOffset;Object(f.a)(o)&&Object(f.a)(s)&&(u.rangeStart=o,u.rangeEnd=s);l={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout};a={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};r.load(u,l,a)},t.prototype.loadsuccess=function(n,t,i){var f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=n.data,u=i.frag;u.loader=void 0;this.loaders[u.type]=void 0;this.hls.trigger(r.a.FRAG_LOADED,{payload:e,frag:u,stats:t,networkDetails:f})},t.prototype.loaderror=function(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.frag,f=i.loader;f&&f.abort();this.loaders[i.type]=void 0;this.hls.trigger(r.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:n,networkDetails:e})},t.prototype.loadtimeout=function(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.frag,f=i.loader;f&&f.abort();this.loaders[i.type]=void 0;this.hls.trigger(r.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:e})},t.prototype.loadprogress=function(n,t){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.frag;i.loaded=n.loaded;this.hls.trigger(r.a.FRAG_LOAD_PROGRESS,{frag:i,stats:n,networkDetails:u})},t}(h.a);t.a=l},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function o(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function s(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r=i(1),f=i(4),u=i(2),h=i(0),c=functull,u}return s(t,n),t.prototype.destroy=function(){var t,n;for(t in this.loaders)n=this.loaders[t],n&&n.destroy();this.loaders={};f.a.prototype.destroy.call(this)},t.prototype.onKeyLoading=function(n){var i=n.frag,u=i.type,e=this.loaders[u],o=i.decryptdata,f=o.uri,t;if(f!==this.decrypturl||null===this.decryptkey){t=this.hls.config;e&&(h.b.warn("abort previous key loader for type:"+u),e.abort());i.loader=this.loaders[u]=new t.loader(t);this.decrypturl=f;this.decryptkey=null;var s=void 0,c=void 0,l=void 0;s={url:f,frag:i,responseType:"arraybuffer"};c={timeout:t.fragLoadingTimeOut,maxRetry:t.fragLoadingMaxRetry,retryDelay:t.fragLoadingRetryDelay,maxRetryDelay:t.fragLoadingMaxRetryTimeout};l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};i.loader.load(s,c,l)}else this.decryptkey&&(o.key=this.decryptkey,this.hls.trigger(r.a.KEY_LOADED,{frag:i}))},t.prototype.loadsuccess=function(n,t,i){var u=i.frag;this.decryptkey=u.decryptdata.key=new Uint8Array(n.data);u.loader=void 0;this.loaders[u.type]=void 0;this.hls.trigger(r.a.KEY_LOADED,{frag:u})},t.prototype.loaderror=function(n,t){var i=t.frag,f=i.loader;f&&f.abort();this.loaders[t.type]=void 0;this.hls.trigger(r.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:n})},t.prototype.loadtimeout=function(n,t){var i=t.frag,f=i.loader;f&&f.abort();this.loaders[t.type]=void 0;this.hls.trigger(r.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},t}(f.a);t.a=c},function(n,t,i){"use strict";function p(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a funct_=t)}var s=i(3),k=i(7),e=i(8),l=i(21),f=i(1),h=i(12),c=i(11),d=i(17),a=i(16),g=i(25),o=i(2),u=i(0),v=i(26),nt=i(10),y=i(50),tt=i(r),t}}(),r={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},rt=function(n){function t(i,u){p(this,t);var e=w(this,n.call(this,i,f.a.MEDIA_ATTACHED,f.a.MEDIA_DETACHING,f.a.MANIFEST_LOADING,f.a.MANIFEST_PARSED,f.a.LEVEL_LOADED,f.a.KEY_LOADED,f.a.FRAG_LOADED,f.a.FRAG_LOAD_EMERGENCY_ABORTED,f.a.FRAG_PARSING_INIT_SEGMENT,f.a.FRAG_PARSING_DATA,f.a.FRAG_PARSED,f.a.ERROR,f.a.AUDIO_TRACK_SWITCHING,f.a.AUDIO_TRACK_SWITCHED,f.a.BUFFER_CREATED,f.a.BUFFER_APPENDED,f.a.BUFFER_FLUSHED));return e.fragmentTracker=u,e.config=i.config,e.audioCodecSwap=!1,e._state=r.STOPPED,e.stallReported=!1,e.gapController=null,e}return b(t,n),t.prototype.onHandlerDestthis)},t.prototype.onHandlerDestroyed=function(){this.state=r.STOPPED;this.fragmentTracker=null;n.prototype.onHandlerDestroyed.call(this)},t.prototype.startLoad=function(n){var t,f,i;this.levels?(t=this.lastCurrentTime,f=this.hls,(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,this.startFragRequested)||(i=f.startLevel,-1===i&&(i=0,this.bitrateTest=!0),this.level=f.nextLoadLevel=i,this.loadedmetadata=!1),t>0&&-1===n&&(u.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),n=t),this.state=r.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()):(this.forceStartLoad=!0,this.state=r.STOPPED)},t.prototype.stopLoad=function(){var n=this.fragCurrent;n&&(n.loader&&n.loader.abort(),this.fragmentTracker.removeFragment(n),this.fragCurrent=null);this.fragPrevious=null;this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);this.clearInterval();this.state=r.STOPPED;this.forceStartLoad=!1},t.prototype.doTick=function(){var n,i,t;switch(this.state){case r.BUFFER_FLUSHING:this.fragLoadError=0;break;case r.IDLE:this._doTickIdle();break;case r.WAITING_LEVEL:n=this.levels[this.level];n&&n.details&&(this.state=r.IDLE);break;case r.FRAG_LOADING_WAITING_RETRY:i=window.performance.now();t=this.retryDate;(!t||i>=t||this.media&&this.media.seeking)&&(u.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=r.IDLE)}this._checkBuffer();this._checkFragmentChanged()},t.prototype._doTickIdle=function(){var v=this.hls,t=v.config,h=this.media,c,l,a,y,i,s,p,o,n,w;if(void 0!==this.levelLastLoaded&&(h||!this.startFragRequested&&t.startFragPrefetch)&&(c=void 0,c=this.loadedmetadata?h.currentTime:this.nextLoadPosition,l=v.nextLoadLevel,a=this.levels[l],a&&(y=a.bitrate,i=void 0,i=y?Math.max(8*t.maxBufferSize/y,t.maxBufferLength):t.maxBufferLength,i=Math.min(i,t.maxMaxBufferLength),s=e.a.bufferInfo(this.mediaBuffer?this.mediaBuffer:h,c,t.maxBufferHole),p=s.len,!(p>=i)))){if(u.b.trace("buffer length of "+p.toFixed(3)+" is below max of "+i.toFixed(3)+". checking for more payload ..."),this.level=v.nextLoadLevel=l,o=a.details,!o||o.live&&this.levelLastLoaded!==l)return void(this.state=r.WAITING_LEVEL);if(n=this.fragPrevious,!o.live&&n&&!n.backtracked&&n.sn===o.endSN&&!s.nextStart&&Math.min(h.duration,n.start+n.duration)-Math.max(s.end,n.start)<=Math.max(.2,n.duration))return w={},this.altAudio&&(w.type="video"),this.hls.trigger(f.a.BUFFER_EOS,w),void(this.state=r.ENDED);this._fetchPayloadOrEos(c,s,o)}},t.prototype._fetchPayloadOrEos=function(n,t,i){var c=this.fragPrevious,l=this.level,f=i.fragments,e=f.length,h;if(0!==e){var s=f[0].start,a=f[e-1].start+f[e-1].duration,o=t.end,r=void 0;if(i.initSegment&&!i.initSegment.data)r=i.initSegment;else if(i.live){if(h=this.config.initialLiveManifestSize,e<h)return void u.b.warn("Can not start playback of a level, reason: not enough fragments "+e+" < "+h);if(null===(r=this._ensureFragmentAtLivePoint(i,o,s,a,c,f,e)))return}else o<s&&(r=f[0]);r||(r=this._findFragment(s,c,e,f,o,a,i));r&&(r.encrypted?(u.b.log("Loading key for "+r.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+l),this._loadKey(r)):(u.b.log("Loading "+r.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+l+", currentTime:"+n.toFixed(3)+",bufferEnd:"+o.toFixed(3)),this._loadFragment(r)))}},t.prototype._ensureFragmentAtLivePoint=function(n,t,i,r,f,e,o){var l=this.hls.config,h=this.media,s=void 0,p=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*n.targetduration,c,a,v;return(t<Math.max(i-l.maxFragLookUpTolerance,r-p)&&(c=this.liveSyncPosition=this.computeLivePosition(i,n),u.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),t=c,h&&h.readyState&&h.duration>c&&(h.currentTime=c),this.nextLoadPosition=c),n.PTSKnown&&t>r&&h&&h.readyState)?null:(this.startFragRequested&&!n.PTSKnown&&(f&&(n.hasProgramDateTime?(u.b.log("live playlist, switching playlist, load frag with same PDT: "+f.programDateTime),s=Object(y.a)(e,f.endProgramDateTime,l.maxFragLookUpTolerance)):(a=f.sn+1,a>=n.startSN&&a<=n.endSN&&(v=e[a-n.startSN],f.cc===v.cc&&(s=v,u.b.log("live playlist, switching playlist, load frag with next SN: "+s.sn))),s||(s=k.a.se-n.cc}))&&u.b.log("live playlist, switching playlist, load frag with same CC: "+s.sn))),s||(s=e[Math.min(o-1,Math.round(o/2))],u.b.log("live playlist, switching playlist, unknown, load middle frag : "+s.sn))),s)},t.prototype._findFragment=function(n,t,i,r,f,e,o){var l=this.hls.config,s=void 0,p,v;if(f<e?(p=f>e-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance,s=Object(y.b)(t,r,f,p)):s=r[i-1],s){var c=s.sn-o.startSN,w=t&&s.level===t.level,a=r[c-1],h=r[c+1];t&&s.sn===t.sn&&(w&&!s.backtracked?s.sn<o.endSN?(v=t.deltaPTS,v&&v>l.maxBufferHole&&t.dropped&&c?(s=a,u.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(s=h,u.b.log("SN just loaded, load next one: "+s.sn,s))):s=null:s.backtracked&&(h&&h.backtracked?(u.b.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+h.sn),s=h):(u.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),s.dropped=0,a?(s=a,s.backtracked=!0):c&&(s=null))))}return s},t.prototype._loadKey=function(n){this.state=r.KEY_LOADING;this.hls.trigger(f.a.KEY_LOADING,{frag:n})},t.prototype._loadFragment=function(n){var t=this.fragmentTracker.getState(n);this.fragCurrent=n;this.startFragRequested=!0;Object(s.a)(n.sn)&&!n.bitrateTest&&(this.nextLoadPosition=n.start+n.duration);n.backtracked||t===h.a.NOT_LOADED||t===h.a.PARTIAL?(n.autoLevel=this.hls.autoLevelEnabled,n.bitrateTest=this.bitrateTest,this.hls.trigger(f.a.FRAG_LOADING,{frag:n}),this.demuxer||(this.demuxer=new l.a(this.hls,"main")),this.state=r.FRAG_LOADING):t===h.a.APPENDING&&this._reduceMaxBufferLength(n.duration)&&this.fragmentTracker.removeFragment(n)},t.prototype.getBufferMAIN)},t.prototype.followingBuffer:null},t.prototype._checkFragmentChanged=function(){var r=void 0,n=void 0,t=this.media,i,u;t&&t.readyState&&!1===t.seeking&&(n=t.currentTime,n>this.lastCurrentTime&&(this.lastCurrentTime=n),e.a.isBuffered(t,n)?r=this.getBufferedFrag(n):e.a.isBuffered(t,n+.1)&&(r=this.getBufferedFrag(n+.1)),r)&&(i=r,i!==this.fragPlaying&&(this.hls.trigger(f.a.FRAG_CHANGED,{frag:i}),u=i.level,this.fragPlaying&&this.fragPlaying.level===u||this.hls.trigger(f.a.LEVEL_SWITCHED,{level:u}),this.fragPlaying=i))},t.prototype.immediateLevelSwitch=function(){var n,t,i;(u.b.log("immediateLevelSwitch"),this.immediateSwitch)||(this.immediateSwitch=!0,n=this.media,t=void 0,n?(t=n.paused,n.pause()):t=!0,this.previouslyPaused=t);i=this.fragCurrent;i&&i.loader&&i.loader.abort();this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},t.prototype.immediateLevelSwiay())},t.prototype.nextLevelSwitch=function(){var n=this.media,r;if(n&&n.readyState){var u=void 0,t=void 0,i=void 0;if(t=this.getBufferedFrag(n.currentTime),t&&t.startPTS>1&&this.flushMainBuffer(0,t.startPTS-1),n.paused)u=0;else{var e=this.hls.nextLoadLevel,o=this.levels[e],f=this.fragLastKbps;u=f&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*f)+1:0}(i=this.getBufferedFrag(n.currentTime+u))&&(i=this.followingBufferedFrag(i))&&(r=this.fragCurrent,r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,Number.POSITIVE_INFINITY))}},t.prototype.flushMainBuffer=function(n,t){this.state=r.BUFFER_FLUSHING;var i={startOffset:n,endOffset:t};this.altAudio&&(i.type="video");this.hls.trigger(f.a.BUFFER_FLUSHING,i)},t.prototype.onMediaAttached=function(n){var t=this.media=this.mediaBuffer=n.media,i;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);t.addEventListener("seeking",this.onvseeking);t.addEventListener("seeked",this.onvseeked);t.addEventListener("ended",this.onvended);i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition);this.gapController=new tt.a(i,t,this.fragmentTracker,this.hls)},t.prototype.onMediaDetaching=function(){var n=this.media,t;n&&n.ended&&(u.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);t=this.levels;t&&t.fd 0})});n&&(n.removeEventListener("seeking",this.onvseeking),n.removeEventListener("seeked",this.onvseeked),n.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null);this.media=this.mediaBuffer=null;this.loadedmetadata=!1;this.stopLoad()},t.prototype.onMediaSeeking=function(){var i=this.media,n=i?i.currentTime:void 0,c=this.config,o,f,t;if(Object(s.a)(n)&&u.b.log("media seeking to "+n.toFixed(3)),o=this.mediaBuffer?this.mediaBuffer:i,f=e.a.bufferInfo(o,n,this.config.maxBufferHole),this.state===r.FRAG_LOADING){if(t=this.fragCurrent,0===f.len&&t){var h=c.maxFragLookUpTolerance,l=t.start-h,a=t.start+t.duration+h;n<l||n>a?(t.loader&&(u.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=r.IDLE):u.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===r.ENDED&&(0===f.len&&(this.fragPrevious=0),this.state=r.IDLE);i&&(this.lastCurrentTime=n);this.loadedmetadata||(this.nextLoadPosition=this.startPosition=n);this.tick()},t.prototype.onMediaSeeked=function(){var n=this.media,t=n?n.currentTime:void 0;Object(s.a)(t)&&u.b.log("media seeked to "+t.toFixed(3));this.tick()},t.prototype.onMediaEnded=function(){u.b.log("media ended");this.startPosition=this.lastCurrentTime=0},t.prototype.onManifestLoading=function(){u.b.log("trigger BUFFER_RESET");this.hls.trigger(f.a.BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=!1;this.startPosition=this.lastCurrentTime=0},t.prototype.onManifestParsed=function(n){var r=!1,f=!1,t=void 0,i;n.levels.f=!0))});this.audioCodecSwitch=r&&f;this.audioCodecSwitch&&u.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");this.levels=n.levels;this.startFragRequested=!1;i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},t.prototype.onLevelLoaded=function(n){var t=n.details,o=n.level,c=this.levels[this.levelLastLoaded],l=this.levels[o],y=t.totalduration,e=0,h,i;(u.b.log("level "+o+" loaded ["+t.startSN+","+t.endSN+"],duration:"+y),t.live)?(h=l.details,h&&t.fragments.length>0?(a.b(h,t),e=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(e,h),t.PTSKnown&&Object(s.a)(e)?u.b.log("live playlist sliding:"+e.toFixed(3)):(u.b.log("live playlist - outdated PTS, unknown sliding"),Object(v.a)(this.fragPrevious,c,t))):(u.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,Object(v.a)(this.fragPrevious,c,t))):t.PTSKnown=!1;(l.details=t,this.levelLastLoaded=o,this.hls.trigger(f.a.LEVEL_UPDATED,{details:t,level:o}),!1===this.startFragRequested)&&((-1===this.startPosition||-1===this.lastCurrentTime)&&(i=t.startTimeOffset,Object(s.a)(i)?(i<0&&(u.b.log("negative start time offset "+i+", count from end of last fragment"),i=e+y+i),u.b.log("start time offset found in playlist, adjust startPosition to "+i),this.startPosition=i):t.live?(this.startPosition=this.computeLivePosition(e,t),u.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition),this.nextLoadPosition=this.startPosition);this.state===r.WAITING_LEVEL&&(this.state=r.IDLE);this.tick()},t.prototype.onKeyck())},t.prototype.onFragLoaded=function(n){var t=this.fragCurrent,s=this.hls,a=this.levels,c=this.media,e=n.frag;if(this.state===r.FRAG_LOADING&&t&&"main"===e.type&&e.level===t.level&&e.sn===t.sn){var o=n.stats,h=a[t.level],i=h.details;if(this.bitrateTest=!1,this.stats=o,u.b.log("Loaded "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t.level),e.bitrateTest&&s.nextLoadLevel)this.state=r.IDLE,this.startFragRequested=!1,o.tparsed=o.tbuffered=window.performance.now(),s.trigger(f.a.FRAG_BUFFERED,{stats:o,frag:t,id:"main"}),this.tick();else if("initSegment"===e.sn)this.state=r.IDLE,o.tparsed=o.tbuffered=window.performance.now(),i.initSegment.data=n.payload,s.trigger(f.a.FRAG_BUFFERED,{stats:o,frag:t,id:"main"}),this.tick();else{u.b.log("Parsing "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t.level+", cc "+t.cc);this.state=r.PARSING;this.pendingBuffering=!0;this.appended=!1;e.bitrateTest&&(e.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:e}));var v=!(c&&c.seeking)&&(i.PTSKnown||!i.live),y=i.initSegment?i.initSegment.data:[],p=this._getAudioCodec(h),w=this.demuxer=this.demuxer||new l.a(this.hls,"main");w.push(n.payload,y,p,h.videoCodec,t,i.totalduration,v)}}this.fragLoadError=0},t.prototype.onFragParsingInitSegment=function(n){var s=this.fragCurrent,l=n.frag,i,h,c;if(s&&"main"===n.id&&l.sn===s.sn&&l.level===s.level&&this.state===r.PARSING){var e=n.tracks,o=void 0,t=void 0;(e.audio&&this.altAudio&&delete e.audio,t=e.audio)&&(i=this.levels[this.level].audioCodec,h=navigator.userAgent.toLowerCase(),i&&this.audioCodecSwap&&(u.b.log("swapping playlist audio codec"),i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==t.metadata.channelCount&&-1===h.indexOf("firefox")&&(i="mp4a.40.5"),-1!==h.indexOf("android")&&"audio/mpeg"!==t.container&&(i="mp4a.40.2",u.b.log("Android: force audio codec to "+i)),t.levelCodec=i,t.id=n.id);t=e.video;t&&(t.levelCodec=this.levels[this.level].videoCodec,t.id=n.id);this.hls.trigger(f.a.BUFFER_CODECS,e);for(o in e)t=e[o],u.b.log("main track:"+o+",container:"+t.container+",codecs[level/parsed]=["+t.levelCodec+"/"+t.codec+"]"),c=t.initSegment,c&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(f.a.BUFFER_APPENDING,{type:o,data:c,parent:"main",content:"initSegment"}));this.tick()}},t.prototype.onFragParsingData=function(n){var o=this,i=this.fragCurrent,v=n.frag,e,t,h,y,l;if(i&&"main"===n.id&&v.sn===i.sn&&v.level===i.level&&("audio"!==n.type||!this.altAudio)&&this.state===r.PARSING){if(e=this.levels[this.level],t=i,Object(s.a)(n.endPTS)||(n.endPTS=n.startPTS+i.duration,n.endDTS=n.startDTS+i.duration),!0===n.hasAudio&&t.addElementaryStream(c.a.ElementaryStreamTypes.AUDIO),!0===n.hasVideo&&t.addElementaryStream(c.a.ElementaryStreamTypes.VIDEO),u.b.log("Parsed "+n.type+",PTS:["+n.startPTS.toFixed(3)+","+n.endPTS.toFixed(3)+"],DTS:["+n.startDTS.toFixed(3)+"/"+n.endDTS.toFixed(3)+"],nb:"+n.nb+",dropped:"+(n.dropped||0)),"video"===n.type)if(t.dropped=n.dropped,t.dropped)if(t.backtracked)u.b.warn("Already backtracked on this fragment, appending with the gap",t.sn);else{if(h=e.details,!h||t.sn!==h.startSN)return u.b.warn("missing video frame(s), backtracking fragment",t.sn),this.fragmentTracker.removeFragment(t),t.backtracked=!0,this.nextLoadPosition=n.startPTS,this.state=r.IDLE,this.fragPrevious=t,void this.tick();u.b.warn("missing video frame(s) on first frag, appending with gap",t.sn)}else t.backtracked=!1;y=a.c(e.details,t,n.startPTS,n.endPTS,n.startDTS,n.endDTS);l=this.hls;l.trigger(f.a.LEVEL_PTS_UPDATED,{details:e.details,level:this.level,drift:y,type:n.type,start:n.startPTS,end:n.endPTS});[n.data1,n.data2].fa"}))});this.tick()}},t.prototype.onFraged())},t.prototype.onAudioTrackSwitching=function(n){var e=!!n.url,o=n.id,t,i;e||(this.mediaBuffer!==this.media&&(u.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media,t=this.fragCurrent,t.loader&&(u.b.log("switching to main audio track, cancel main fragment load"),t.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=r.IDLE),i=this.hls,i.trigger(f.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(f.a.AUDIO_TRACK_SWITCHED,{id:o}),this.altAudio=!1)},t.prototype.onAudioTrackSwitched=function(n){var r=n.id,i=!!this.hls.audioTracks[r].url,t;i&&(t=this.videoBuffer,t&&this.mediaBuffer!==t&&(u.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t));this.altAudio=i;this.tick()},t.prototype.onBufferCreated=function(n){var i=n.tracks,r=void 0,e=void 0,o=!1,t,f;for(t in i)f=i[t],"main"===f.id?(e=t,r=f,"video"===t&&(this.videoBuffer=i[t].buffer)):o=!0;o&&r?(u.b.log("alternate track found, use "+e+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},t.prototype.onBufferApd())}},t.prototype._checkAppendedParsed=function(){var t,i,n;this.state!==r.PARSED||this.appended&&this.pendingBuffering||(t=this.fragCurrent,t&&(i=this.mediaBuffer?this.mediaBuffer:this.media,u.b.log("main buffered : "+g.a.toString(i.buffered)),this.fragPrevious=t,n=this.stats,n.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(f.a.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.state=r.IDLE),this.tick())},t.prototype.onError=function(n){var i=n.frag||this.fragCurrent,f,t;if(!i||"main"===i.type){f=!!this.media&&e.a.isBuffered(this.media,this.media.currentTime)&&e.a.isBuffered(this.media,this.media.currentTime+.5);switch(n.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:n.fatal||(this.fragLoadError+1<=this.config.fragLoadingMaxRetry?(t=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout),u.b.warn("mediaController: frag loading failed, retry in "+t+" ms"),this.retryDate=window.performance.now()+t,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=r.FRAG_LOADING_WAITING_RETRY):(u.b.error("mediaController: "+n.details+" reaches max retry, redispatch as fatal ..."),n.fatal=!0,this.state=r.ERROR));break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:this.state!==r.ERROR&&(n.fatal?(this.state=r.ERROR,u.b.warn("streamController: "+n.details+",switch to "+this.state+" state ...")):n.levelRetry||this.state!==r.WAITING_LEVEL||(this.state=r.IDLE));break;case o.a.BUFFER_FULL_ERROR:"main"!==n.parent||this.state!==r.PARSING&&this.state!==r.PARSED||(f?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=r.IDLE):(u.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},t.prototype._reduceMaxBuffer),!0)},t.prototype._checkBuffer=function(){var n=this.media,i,t;n&&0!==n.readyState&&(i=this.mediaBuffer?this.mediaBuffer:n,t=i.buffered,!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t))},t.prototype.onFragLoadEmergencyAborted=function(){this.state=r.IDLE;this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);this.tick()},t.prototype.onBufferFlushed=function(){var n=this.mediaBuffer?this.mediaBuffer:this.media;n&&this.fragmentTracker.detectEvictedFragments(c.a.ElementaryStreamTypes.VIDEO,n.buffered);this.state=r.IDLE;this.fragPrevious=null},t.prototype.swapAudicSwap},t.prototype.computeLivePoon-i)},t.prototype._seekToStme=i)},t.prototype._getAudi")),t},it(t,[{key:"state",set:function(n){if(this.state!==n){var t=this.state;this._state=n;u.b.log("main stream:"+t+"->"+n);this.hls.trigger(f.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:n})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media,n;return t&&(n=this.getBufferedFrag(t.currentTime),n)?n.level:-1}},{key:"nextBufferedFra:null}},{key:"nextLeveel:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(n){this._liveSyncPosition=n}}]),t}(nt.a);t.a=rt},function(n,t,i){functioports}var i={},r;return t.m=n,t.curn t:r},i),(n,t)},t.p="/n),n;},r=t(t.s=ENTRY_MODULE),r.defa\$&")}function o(n,t,r){var s={},h,l,o,a,c;if(s[r]=[],h=t.toString(),l=h.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/),!l)return s;for(a=l[1],c=new RegExp("(\\\\n|\\W)"+u(a)+e,"g");o=c.exec(h);)"dll-reference"!==o[3]&&s[r].push(o[3]);for(c=new RegExp("\\("+u(a)+'\\("(dll-reference\\s('+f+'))"\\)\\)'+e,"g");o=c.exec(h);)n[o[2]]||(s[r].push(o[1]),n[o[2]]=i(o[1]).m),s[o[2]]=s[o[2]]||[],s[o[2]].push(o[4]);re},!1)}function h(n,t){for(var a,l,r={main:[t]},h={main:[]},c={main:{}};s(r);)for(a=Object.keys(r),l=0;l<a.length;l++){var i=a[l],y=r[i],e=y.pop();if(c[i]=c[i]||{},!c[i][e]&&n[i][e]){c[i][e]=!0;h[i]=h[i]||[];h[i].push(e);for(var v=o(n,n[i][e],i),f=Object.keys(v),u=0;u<f.length;u++)r[f[u]]=r[f[u]]||[],r[f[u]]=r[f[u]].concat(v[f[u]])}}return h}var f="[\\.|\\-|\\+|\\w|/|@]+",e="\\((/\\*.*?\\*/)?s?.*?("+f+").*?\\)";n.exports=function(n,t){var o;t=t||{};var u={main:i.m},f=t.all?{main:Object.keys(u)}:h(u,n),e="";if(Object.keys(f)."!==n}).f);\n"}),e=e+"("+r.toString().replace("ENTRY_MODULE",JSON.stringify(n))+")({"+f.maing()}).join(",")+"})(self);",o=new window.Blob([e],{type:"text/javascript"}),t.bare)return o;var l=window.URL||window.webkitURL||window.mozURL||window.msURL,s=l.createObjectURL(o),c=new window.Worker(s);return c.objectURL=s,c}},function(n,t){"use strict";function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=function(){function n(t,r){i(this,n);this.subtle=t;this.aesIV=r}return n.prototype.d,t,n)},n}();t.a=r},function(n,t){"use strict";function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=funckey=r}return n.prototype.exppt"])},n}();t.a=r},function(n,t){"use strict";function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a funct-i):n}var u=function(){function n(){i(this,n);this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}return n.prototype.uint8ArrayToUint32urn i},n.prototype.initTable=function(){for(var l=this.sBox,a=this.invSBox,e=this.subMix,v=e[0],y=e[1],p=e[2],w=e[3],o=this.invSubMix,b=o[0],k=o[1],d=o[2],g=o[3],r=new Uint32Array(256),i=0,f=0,u=0,t,u=0;u<256;u++)r[u]=u<128?u<<1:u<<1^283;for(u=0;u<256;u++){t=f^f<<1^f<<2^f<<3^f<<4;t=t>>>8^255&t^99;l[i]=t;a[t]=i;var s=r[i],h=r[s],c=r[h],n=257*r[t]^16843008*t;v[i]=n<<24|n>>>8;y[i]=n<<16|n>>>16;p[i]=n<<8|n>>>24;w[i]=n;n=16843009*c^65537*h^257*s^16843008*i;b[t]=n<<24|n>>>8;k[t]=n<<16|n>>>16;d[t]=n<<8|n>>>24;g[t]=n;i?(i=s^r[r[r[c^s]]],f^=r[r[f]]):i=f=1}},n.prototype.expandKey=function(n){for(var r,e=this.uint8ArrayToUint32Array_(n),l=!0,h=0;h<e.length&&l;)l=e[h]===this.key[h],h++;if(!l){if(this.key=e,r=this.keySize=e.length,4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);for(var o=this.ksRows=4*(r+6+1),i=void 0,f=void 0,s=this.keySchedule=new Uint32Array(o),a=this.invKeySchedule=new Uint32Array(o),u=this.sBox,y=this.rcon,c=this.invSubMix,p=c[0],w=c[1],b=c[2],k=c[3],v=void 0,t=void 0,i=0;i<o;i++)i<r?v=s[i]=e[i]:(t=v,i%r==0?(t=t<<8|t>>>24,t=u[t>>>24]<<24|u[t>>>16&255]<<16|u[t>>>8&255]<<8|u[255&t],t^=y[i/r|0]<<24):r>6&&i%r==4&&(t=u[t>>>24]<<24|u[t>>>16&255]<<16|u[t>>>8&255]<<8|u[255&t]),s[i]=v=(s[i-r]^t)>>>0);for(f=0;f<o;f++)i=o-f,t=3&f?s[i]:s[i-4],a[f]=f<4||i<=4?t:p[u[t>>>24]]^w[u[t>>>16&255]]^b[u[t>>>8&255]]^k[u[255&t]],a[f]=a[f]>>>0}},n.prototype.networkToHostOrd>>>24},n.prototype.decrypt=function(n,t,i,u){for(var vt=this.keySize+6,e=this.invKeySchedule,f=this.invSBox,p=this.invSubMix,w=p[0],b=p[1],k=p[2],d=p[3],g=this.uint8ArrayToUint32Array_(i),ht=g[0],ct=g[1],lt=g[2],at=g[3],v=new Int32Array(n),y=new Int32Array(v.length),nt=void 0,tt=void 0,it=void 0,rt=void 0,s=void 0,h=void 0,c=void 0,l=void 0,ut=void 0,ft=void 0,et=void 0,ot=void 0,o=void 0,st=void 0,a=this.networkToHostOrderSwap;t<v.length;){for(ut=a(v[t]),ft=a(v[t+1]),et=a(v[t+2]),ot=a(v[t+3]),s=ut^e[0],h=ot^e[1],c=et^e[2],l=ft^e[3],o=4,st=1;st<vt;st++)nt=w[s>>>24]^b[h>>16&255]^k[c>>8&255]^d[255&l]^e[o],tt=w[h>>>24]^b[c>>16&255]^k[l>>8&255]^d[255&s]^e[o+1],it=w[c>>>24]^b[l>>16&255]^k[s>>8&255]^d[255&h]^e[o+2],rt=w[l>>>24]^b[s>>16&255]^k[h>>8&255]^d[255&c]^e[o+3],s=nt,h=tt,c=it,l=rt,o+=4;nt=f[s>>>24]<<24^f[h>>16&255]<<16^f[c>>8&255]<<8^f[255&l]^e[o];tt=f[h>>>24]<<24^f[c>>16&255]<<16^f[l>>8&255]<<8^f[255&s]^e[o+1];it=f[c>>>24]<<24^f[l>>16&255]<<16^f[s>>8&255]<<8^f[255&h]^e[o+2];rt=f[l>>>24]<<24^f[s>>16&255]<<16^f[h>>8&255]<<8^f[255&c]^e[o+3];o+=3;y[t]=a(nt^ht);y[t+1]=a(rt^ct);y[t+2]=a(it^lt);y[t+3]=a(tt^at);ht=ut;ct=ft;lt=et;at=ot;t+=4}return u?r(y.buffer):y.buffer},n.prototype.destroy=function(){this.key=void 0;this.keySize=void 0;this.ksRows=void 0;this.sBox=void 0;this.invSBox=void 0;this.subMix=void 0;this.invSubMix=void 0;this.keySchedule=void 0;this.invKeySchedule=void 0;this.rcon=void 0},n}();t.a=u},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var o=i(3),u=i(23),f=i(0),r=i(9),s=funcxer=i}return n.prototype.resetInitS:9e4}},n.prototype.resetTimeStamp=function(){},n.probe=function(n){if(!n)return!1;for(var i=r.a.getID3Data(n,0)||[],t=i.length,e=n.length;t<e;t++)if(u.e(n,t))return f.b.log("ADTS sync word found !"),!0;return!1},n.prototype.append=function(n,t,i,e){for(var a,l=this._audioTrack,h=r.a.getID3Data(n,0)||[],v=r.a.getTimeStamp(h),y=Object(o.a)(v)?90*v:9e4*t,p=0,c=y,w=n.length,s=h.length,b=[{pts:c,dts:c,data:h}];s<w-1;)if(u.d(n,s)&&s+5<w){if(u.c(l,this.observer,n,s,l.manifestCodec),a=u.a(l,n,s,y,p),!a){f.b.log("Unable to parse AAC frame");break}s+=a.length;c=a.sample.pts;p++}else r.a.isHeader(n,s)?(h=r.a.getID3Data(n,s),b.push({pts:c,dts:c,data:h}),s+=h.length):s++;this.remuxer.remux(l,{samples:[]},{samples:b,inputTimeScale:9e4},{samples:[]},t,i,e)},n.prototype.destroy=function(){},n}();t.a=s},function(n,t,i){"use strict";function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u=i(23),o=i(24),s=i(1),e=i(42),c=i(43),r=i(0),f=i(2),l={video:1,audio:2,id3:3,text:4},a=function(){function n(t,i,r,u){h(this,n);this.observer=t;this.config=r;this.typeSupported=u;this.remuxer=i;this.sampleAes=null}return n.prototype.setDecryptData=function(n){this.sampleAes=null!=n&&null!=n.key&&"SAMPLE-AES"===n.method?new c.a(this.observer,this.config,n,this.discardEPB):null},n),!0)},n._syncurn-1},n.creatid 0}},n.prototype.resetInitSegment=function(t,i,r,u){this.pmtParsed=!1;this._pmtId=-1;this._avcTrack=n.createTrack("video",u);this._audioTrack=n.createTrack("audio",u);this._id3Track=n.createTrack("id3",u);this._txtTrack=n.createTrack("text",u);this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=i;this.videoCodec=r;this._duration=u},n.prototype.resetTimeStamp=function(){},n.prototype.append=function(t,i,u,e){var h=void 0,it=t.length,b=void 0,ft=void 0,c=void 0,o=void 0,rt=!1,d;this.contiguous=u;var et=this.pmtParsed,p=this._avcTrack,a=this._audioTrack,w=this._id3Track,g=p.pid,nt=a.pid,tt=w.pid,ot=this._pmtId,v=p.pesData,l=a.pesData,y=w.pesData,at=this._parsePAT,vt=this._parsePMT,k=this._parsePES,st=this._parseAVCPES.bind(this),ht=this._parseAACPES.bind(this),ct=this._parseMPEGPES.bind(this),lt=this._parseID3PES.bind(this),ut=n._syncOffset(t);for(it-=(it+ut)%188,h=ut;h<it;h+=188)if(71===t[h]){if(b=!!(64&t[h+1]),ft=((31&t[h+1])<<8)+t[h+2],(48&t[h+3])>>4>1){if((c=h+5+t[h+4])===h+188)continue}else c=h+4;switch(ft){case g:b&&(v&&(o=k(v))&&void 0!==o.pts&&st(o,!1),v={data:[],size:0});v&&(v.data.push(t.subarray(c,h+188)),v.size+=h+188-c);break;case nt:b&&(l&&(o=k(l))&&void 0!==o.pts&&(a.isAAC?ht(o):ct(o)),l={data:[],size:0});l&&(l.data.push(t.subarray(c,h+188)),l.size+=h+188-c);break;case tt:b&&(y&&(o=k(y))&&void 0!==o.pts&&lt(o),y={data:[],size:0});y&&(y.data.push(t.subarray(c,h+188)),y.size+=h+188-c);break;case 0:b&&(c+=t[c]+1);ot=this._pmtId=at(t,c);break;case ot:b&&(c+=t[c]+1);d=vt(t,c,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);g=d.avc;g>0&&(p.pid=g);nt=d.audio;nt>0&&(a.pid=nt,a.isAAC=d.isAAC);tt=d.id3;tt>0&&(w.pid=tt);rt&&!et&&(r.b.log("reparse from beginning"),rt=!1,h=ut-188);et=this.pmtParsed=!0;break;case 17:case 8191:break;default:rt=!0}}else this.observer.trigger(s.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});v&&(o=k(v))&&void 0!==o.pts?(st(o,!0),p.pesData=null):p.pesData=v;l&&(o=k(l))&&void 0!==o.pts?(a.isAAC?ht(o):ct(o),a.pesData=null):(l&&l.size&&r.b.log("last AAC PES packet truncated,might overlap between fragments"),a.pesData=l);y&&(o=k(y))&&void 0!==o.pts?(lt(o),w.pesData=null):w.pesData=y;null==this.sampleAes?this.remuxer.remux(a,p,w,this._txtTrack,i,u,e):this.decryptAndRemux(a,p,w,this._txtTrack,i,u,e)},n.prototype.decryptAn,f,e)},n.prototype.decryptAndRe,f,e)},n.prototype.dion=0},n.prototype._pat+11]},n.prototype._paurn f},n.prototype._parsePES=function(n){var y=0,t=void 0,l=void 0,o=void 0,a=void 0,v=void 0,u=void 0,f=void 0,e=void 0,i=n.data,h,c,p,s;if(!n||0===n.size)return null;for(;i[0].length<19&&i.length>1;)h=new Uint8Array(i[0].length+i[1].length),h.set(i[0]),h.set(i[1],i[0].length),i[0]=h,i.splice(1,1);if(t=i[0],1===(t[0]<<16)+(t[1]<<8)+t[2]){if((o=(t[4]<<8)+t[5])&&o>n.size-6)return null;for(l=t[7],192&l&&(u=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,u>4294967295&&(u-=8589934592),64&l?(f=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,f>4294967295&&(f-=8589934592),u-f>54e5&&(r.b.warn(Math.round((u-f)/9e4)+"s delta between PTS and DTS, align them"),u=f)):f=u),a=t[8],e=a+9,n.size-=e,v=new Uint8Array(n.size),c=0,p=i.length;c<p;c++){if(t=i[c],s=t.byteLength,e){if(e>s){e-=s;continue}t=t.subarray(e);s-=e;e=0}v.set(t,y);y+=s}return o&&(o-=a+3),{data:v,pts:u,dts:f,len:o}}return null},n.prototype.pushAccebug)},n.prototype._parseAVCPES=function(n,t){var s=this,u=this._avcTrack,l=this._parseAVCNALu(n.data),r=void 0,i=this.avcSample,o=void 0,a=!1,f=void 0,c=this.pushAccesUnit.bind(tug:r}};n.data=null;i&&l.length&&!u.audFound&&(c(i,u),i=this.avcSample=h(!1,n.pts,n.dts,""));l.forEach(function(t){var k,v,b,it,g,y;switch(t.type){case 1:o=!0;i||(i=s.avcSample=h(!0,n.pts,n.dts,""));i.frame=!0;k=t.data;a&&k.length>4&&(v=new e.a(k).readSliceType(),2!==v&&4!==v&&7!==v&&9!==v||(i.key=!0));break;case 5:o=!0;i||(i=s.avcSample=h(!0,n.pts,n.dts,""));i.key=!0;i.frame=!0;break;case 6:o=!0;r=new e.a(s.discardEPB(t.data));r.readUByte();for(var d=0,p=0,nt=!1,l=0;!nt&&r.bytesAvailable>1;){d=0;do l=r.readUByte(),d+=l;while(255===l);p=0;do l=r.readUByte(),p+=l;while(255===l);if(4===d&&0!==r.bytesAvailable){if(nt=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var tt=r.readUByte(),rt=r.readUByte(),ut=31&tt,w=[tt,rt];for(f=0;f<ut;f++)w.push(r.readUByte()),w.push(r.readUByte()),w.push(r.readUByte());s._insertSampleInOrder(s._txtTrack.samples,{type:3,pts:n.pts,bytes:w})}}else if(p<r.bytesAvailable)for(f=0;f<p;f++)r.readUByte()}break;case 7:if(o=!0,a=!0,!u.sps){for(r=new e.a(t.data),b=r.readSPS(),u.width=b.width,u.height=b.height,u.pixelRatio=b.pixelRatio,u.sps=[t.data],u.duration=s._duration,it=t.data.subarray(1,4),g="avc1.",f=0;f<3;f++)y=it[f].toString(16),y.length<2&&(y="0"+y),g+=y;u.codec=g}break;case 8:o=!0;u.pps||(u.pps=[t.data]);break;case 9:o=!1;u.audFound=!0;i&&c(i,u);i=s.avcSample=h(!1,n.pts,n.dts,"");break;case 12:o=!1;break;default:o=!1;i&&(i.debug+="unknown NAL "+t.type+" ")}i&&o&&i.units.push(t)});t&&i&&(c(i,u),this.avcSample=null)},n.prototype._insertSampleInOrder=function(n,t){var r=n.length,i;if(r>0){if(t.pts>=n[r-1].pts)n.push(t);else for(i=r-1;i>=0;i--)if(t.pts<n[i].pts){n.splice(i,0,t);break}}else n.push(t)},n.prototype._getLastNalUnit=function(){var n=this.avcSample,r=void 0,u,t,i;return n&&0!==n.units.length||(u=this._avcTrack,t=u.samples,n=t[t.length-1]),n&&(i=n.units,r=i[i.length-1]),r},n.prototype._parseAVCNALu=function(n){var r=0,a=n.byteLength,e=void 0,v=void 0,p=this._avcTrack,t=p.naluState||0,y=t,o=[],s=void 0,w=void 0,u=-1,h=void 0,i,c,f,l;for(-1===t&&(u=0,h=31&n[0],t=0,r=1);r<a;)(e=n[r++],t)?1!==t?e?1===e?(u>=0?(s={data:n.subarray(u,r-t-1),type:h},o.push(s)):(i=this._getLastNalUnit(),i&&(y&&r<=4-y&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-y)),(v=r-t-1)>0)&&(c=new Uint8Array(i.data.byteLength+v),c.set(i.data,0),c.set(n.subarray(0,v),i.data.byteLength),i.data=c)),r<a?(w=31&n[r],u=r,h=w,t=0):t=-1):t=0:t=3:t=e?0:2:t=e?0:1;return(u>=0&&t>=0&&(s={data:n.subarray(u,a),type:h,state:t},o.push(s)),0===o.length)&&(f=this._getLastNalUnit(),f&&(l=new Uint8Array(f.data.byteLength+n.byteLength),l.set(f.data,0),l.set(n,f.data.byteLength),f.data=l)),p.naluState=t,o},n.prototype.discardEPB=function(n){for(var r,e=n.byteLength,i=[],t=1,u=void 0,f=void 0;t<e-2;)0===n[t]&&0===n[t+1]&&3===n[t+2]?(i.push(t+2),t+=2):t++;if(0===i.length)return n;for(u=e-i.length,f=new Uint8Array(u),r=0,t=0;t<u;r++,t++)r===i[0]&&(r++,i.shift()),f[t]=n[r];return f},n.prototype._parseAACPES=function(n){var p=this._audioTrack,i=n.data,l=n.pts,e=this.aacOverFlow,b=this.aacLastPTS,k=void 0,w=void 0,t=void 0,d=void 0,o=void 0,a,h,c,v,y;for(e&&(a=new Uint8Array(e.byteLength+i.byteLength),a.set(e,0),a.set(i,e.byteLength),i=a),t=0,o=i.length;t<o-1&&!u.d(i,t);t++);if(!t||(h=void 0,c=void 0,t<o-1?(h="AAC PES did not start with ADTS header,offset:"+t,c=!1):(h="no ADTS header found in AAC PES",c=!0),r.b.warn("parsing error:"+h),this.observer.trigger(s.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_PARSING_ERROR,fatal:c,reason:h}),!c)){for((u.c(p,this.observer,i,t,this.audioCodec),w=0,k=u.b(p.samplerate),e&&b)&&(v=b+k,Math.abs(v-l)>1&&(r.b.log("AAC: align PTS for overlapping frames by "+Math.round((v-l)/90)),l=v));t<o;)if(u.d(i,t)&&t+5<o){if(y=u.a(p,i,t,l,w),!y)break;t+=y.length;d=y.sample.pts;w++}else t++;e=t<o?i.subarray(t,o):null;this.aacOverFlow=e;this.aacLastPTS=d}},n.prototype._parseMPEGPES=function(n){for(var r,i=n.data,f=i.length,u=0,t=0,e=n.pts;t<f;)if(o.a.isHeader(i,t)){if(r=o.a.appendFrame(this._audioTrack,i,t,e,u),!r)break;t+=r.length;u++}else t++},n.prototype._parsesh(n)},n}();t.a=a},function(n,t,i){"use son");}var u=i(0),f=function(){function n(t){r(this,n);this.data=t;this.bytesAvailable=t.byteLength;this.word=0;this.bitsAvailable=0}return n.prototype.lole-=n},n.prototype.ske-=n)},n.prototype.re(t):i},n.prototype.skipLZ=function(){for(var n=void 0,n=0;n<this.bitsAvailable;++n)if(0!=(this.word&2147483648>>>n))return this.word<<=n,this.bitsAvailable-=n,n;return this.loadWord(),n+this.skipLZ()},n.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},n.prototype.LZ())},n.prototype.r+1)-1},n.prototype.>>>1)},n.prototype.readBts(1)},n.prototype.readUByte=function(){return this.readBits(8)},n.prototype.readUShort=function(){return this.readBits(16)},n.prototype.res(32)},n.prototype.skipScalingList=function(n){for(var i=8,t=8,r=void 0,u=void 0,r=0;r<n;r++)0!==t&&(u=this.readEG(),t=(i+u+256)%256),i=0===t?i:t},n.prototype.readSPS=function(){var a=0,v=0,y=0,p=0,t=void 0,w=void 0,b=void 0,k=void 0,s=void 0,d=void 0,u=void 0,r=this.readUByte.bind(this),g=this.readBits.bind(this),i=this.readUEG.bind(this),e=this.readBoolean.bind(this),f=this.skipBits.bind(this),h=this.skipEG.bind(this),o=this.skipUEG.bind(this),nt=this.skipScalingList.bind(this),c,l,n;if((r(),t=r(),g(5),f(3),r(),o(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t)&&(c=i(),3===c&&f(1),o(),o(),f(1),e()))for(d=3!==c?8:12,u=0;u<d;u++)e()&&nt(u<6?16:64);if(o(),l=i(),0===l)i();else if(1===l)for(f(1),h(),h(),w=i(),u=0;u<w;u++)h();if(o(),f(1),b=i(),k=i(),s=g(1),0===s&&f(1),f(1),e()&&(a=i(),v=i(),y=i(),p=i()),n=[1,1],e()&&e())switch(r()){case 1:n=[1,1];break;case 2:n=[12,11];break;case 3:n=[10,11];break;case 4:n=[16,11];break;case 5:n=[40,33];break;case 6:n=[24,11];break;case 7:n=[20,11];break;case 8:n=[32,11];break;case 9:n=[80,33];break;case 10:n=[18,11];break;case 11:n=[15,11];break;case 12:n=[64,33];break;case 13:n=[160,99];break;case 14:n=[4,3];break;case 15:n=[3,2];break;case 16:n=[2,1];break;case 255:n=[r()<<8|r(),r()<<8|r()]}return{width:Math.ceil(16*(b+1)-2*a-2*v),height:(2-s)*(k+1)*16-(s?2:4)*(y+p),pixelRatio:n}},n.prototype.readSliUEG()},n}();t.a=f},function(n,t,i){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var u=i(14),f=function(){function n(t,i,f,e){r(this,n);this.decryptdata=f;this.discardEPB=e;this.decrypter=new u.a(t,i,{removePKCS7Padding:!1})}return n.prototype.decrypter,t)},n.prototype.decryptAacSample=function(n,t,i,r){var u=n[t].unit,f=u.subarray(16,u.length-u.length%16),e=f.buffer.slice(f.byteOffset,f.byteOffset+f.length),o=this;this.decryptBuffer(e,function(f){f=new Uint8Array(f);u.set(f,16);r||o.decryptAacSamples(n,t+1,i)})},n.prototype.decryptAacSurn}}},n.prototype.getAvcEncrypturn i},n.prototype.getAvcDecrypturn n},n.prototype.decryptAvcSample=function(n,t,i,r,u,f){var e=this.discardEPB(u.data),s=this.getAvcEncryptedData(e),o=this;this.decryptBuffer(s.+1,r)})},n.prototype.decryptAvcSamples=function(n,t,i,r){for(var f,u,e;;t++,i=0){if(t>=n.length)return void r();for(f=n[t].units;!(i>=f.length);i++)if(u=f[i],!(u.length<=48||1!==u.type&&5!==u.type)&&(e=this.decrypter.isSync(),this.decryptAvcSample(n,t,i,r,u,e),!e))return}},n}();t.a=f},function(n,t,i){"use strict";function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=i(9),e=i(0),u=i(24),o=function(){function n(t,i,r){f(this,n);this.observer=t;this.config=r;this.remuxer=i}return n.prototype.resetInitS:9e4}},n.prototype.resetTimeStamp=function(){},nurn!1},n.prototype.append=function(n,t,i,f){for(var s,o=r.a.getID3Data(n,0),l=r.a.getTimeStamp(o),h=l?90*l:9e4*t,e=o.length,p=n.length,a=0,c=0,v=this._audioTrack,y=[{pts:h,dts:h,data:o}];e<p;)if(u.a.isHeader(n,e)){if(s=u.a.appendFrame(v,n,e,h,a),!s)break;e+=s.length;c=s.sample.pts;a++}else r.a.isHeader(n,e)?(o=r.a.getID3Data(n,e),y.push({pts:c,dts:c,data:o}),e+=o.length):e++;this.remuxer.remux(v,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,i,f)},n.prototype.destroy=function(){},n}();t.a=o},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var o=i(46),f=i(47),u=i(1),e=i(2),r=i(0),h=function(){function n(t,i,r,u){s(this,n);this.observer=t;this.config=i;this.typeSupported=r;var f=navigator.userAgent;this.isSafari=u&&u.indexOf("Apple")>-1&&f&&!f.match("CriOS");this.ISGenerated=!1}return n.prototype.destroy=function(){},n.prototype.resetTimDTS=n},n.prototype.resetInitSegment=function(){this.ISGenerated=!1},n.prototype.remux=function(n,t,i,f,e,o,s){var v,h,y,p;if(this.ISGenerated||this.generateIS(n,t,e),this.ISGenerated){var w=n.samples.length,c=t.samples.length,l=e,a=e;w&&c&&(v=(n.samples[0].dts-t.samples[0].dts)/t.inputTimeScale,l+=Math.max(0,v),a+=Math.max(0,-v));w?(n.timescale||(r.b.warn("regenerate InitSegment as audio detected"),this.generateIS(n,t,e)),h=this.remuxAudio(n,l,o,s),c&&(y=void 0,h&&(y=h.endPTS-h.startPTS),t.timescale||(r.b.warn("regenerate InitSegment as video detected"),this.generateIS(n,t,e)),this.remuxVideo(t,a,o,y,s))):c&&(p=this.remuxVideo(t,a,o,0,s),p&&n.codec&&this.remuxEmptyAudio(n,l,o,p))}i.samples.length&&this.remuxID3(i,e);f.samples.length&&this.remuxText(f,e);this.observer.trigger(u.a.FRAG_PARSED)},n.prototype.generateIS=function(n,t,i){var y=this.observer,p=n.samples,a=t.samples,v=this.typeSupported,w="audio/mp4",h={},b={tracks:h},c=void 0===this._initPTS,o=void 0,s=void 0,l;(c&&(o=s=1/0),n.config&&p.length&&(n.timescale=n.samplerate,r.b.log("audio sampling rate : "+n.samplerate),n.isAAC||(v.mpeg?(w="audio/mpeg",n.codec=""):v.mp3&&(n.codec="mp3")),h.audio={container:w,codec:n.codec,initSegment:!n.isAAC&&v.mpeg?new Uint8Array:f.a.initSegment([n]),metadata:{channelCount:n.channelCount}},c&&(o=s=p[0].pts-n.inputTimeScale*i)),t.sps&&t.pps&&a.length)&&(l=t.inputTimeScale,t.timescale=l,h.video={container:"video/mp4",codec:t.codec,initSegment:f.a.initSegment([t]),metadata:{width:t.width,height:t.height}},c&&(o=Math.min(o,a[0].pts-l*i),s=Math.min(s,a[0].dts-l*i),this.observer.trigger(u.a.INIT_PTS_FOUND,{initPTS:o})));Object.keys(h).length?(y.trigger(u.a.FRAG_PARSING_INIT_SEGMENT,b),this.ISGenerated=!0,c&&(this._initPTS=o,this._initDTS=s)):y.trigger(u.a.ERROR,{type:e.b.MEDIA_ERROR,details:e.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},n.prototype.remuxVideo=function(n,t,i,o,s){var rt=8,v=n.timescale,c=void 0,g=void 0,ni=void 0,b=void 0,l=void 0,ti=void 0,ut=void 0,h=n.samples,nt=[],ft=h.length,ii=this._PTSNormalize,ct=this._initDTS,y=this.nextAvcDts,et=this.isSafari,ot,st,d,w,tt,vt,p,bt,it,ci,dt,gt;if(0!==ft){if(et&&(i|=h.length&&y&&(s&&Math.abs(t-y/v)<.1||Math.abs(h[0].pts-y-ct)<v/5)),i||(y=t*v),h.forEach(function(n){n.pts=ii(n.pts-ct,y);n.dts=ii(n.dts-ct,y)}),-t.id}),ot=h.18e3)},0),ot<0)for(r.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(ot/90)+" ms to overcome this issue"),st=0;st<h.length;st++)h[st].dts+=ot;d=h[0];l=Math.max(d.dts,0);b=Math.max(d.pts,0);w=Math.round((l-y)/90);i&&w&&(w>1?r.b.log("AVC:"+w+" ms hole between fragments detected,filling it"):w<-1&&r.b.log("AVC:"+-w+" ms overlapping between fragments detected"),l=y,h[0].dts=l,b=Math.max(b-w,y),h[0].pts=b,r.b.log("Video/PTS/DTS adjusted: "+Math.round(b/90)+"/"+Math.round(l/90)+",delta:"+w+" ms"));l;d=h[h.length-1];ut=Math.max(d.dts,0);ti=Math.max(d.pts,0,ut);et&&(c=Math.round((ut-l)/(h.length-1)));for(var ri=0,ui=0,ht=0;ht<ft;ht++){for(var k=h[ht],fi=k.units,ei=fi.length,lt=0,at=0;at<ei;at++)lt+=fi[at].data.length;ui+=lt;ri+=ei;k.length=lt;k.dts=et?l+ht*c:Math.max(k.dts,l);k.pts=Math.max(k.pts,k.dts)}tt=ui+4*ri+8;try{g=new Uint8Array(tt)}catch(n){return void this.observer.trigger(u.a.ERROR,{type:e.b.MUX_ERROR,details:e.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:tt,reason:"fail allocating video mdat "+tt})}for(vt=new DataView(g.buffer),vt.setUint32(0,tt),g.set(f.a.types.mdat,4),p=0;p<ft;p++){for(var a=h[p],oi=a.units,si=0,yt=void 0,pt=0,li=oi.length;pt<li;pt++){var hi=oi[pt],ai=hi.data,wt=hi.data.byteLength;vt.setUint32(rt,wt);rt+=4;g.set(ai,rt);rt+=wt;si+=4+wt}if(et)yt=Math.max(0,c*Math.round((a.pts-a.dts)/c));else{if(p<ft-1)c=h[p+1].dts-a.dts;else if(bt=this.config,it=a.dts-h[p>0?p-1:p].dts,bt.stretchShortVideoTrack){var vi=bt.maxBufferHole,yi=Math.floor(vi*v),kt=(o?b+o*v:this.nextAudioPts)-a.pts;kt>yi?(c=kt-it,c<0&&(c=it),r.b.log("It is approximately "+kt/90+" ms to the next segment; using duration "+c/90+" ms for the last video frame.")):c=it}else c=it;yt=Math.round(a.pts-a.dts)}nt.push({size:si,duration:c,cts:yt,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:a.key?2:1,isNonSync:a.key?0:1}})}return this.nextAvcDts=ut+c,ci=n.dropped,(n.len=0,n.nbNalu=0,n.dropped=0,nt.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1)&&(dt=nt[0].flags,dt.dependsOn=2,dt.isNonSync=0),n.samples=nt,ni=f.a.moof(n.sequenceNumber++,l,n),n.samples=[],gt={data1:ni,data2:g,startPTS:b/v,endPTS:(ti+c)/v,startDTS:l/v,endDTS:this.nextAvcDts/v,type:"video",hasAudio:!1,hasVideo:!0,nb:nt.length,dropped:ci},this.observer.trigger(u.a.FRAG_PARSING_DATA,gt),gt}},n.prototype.remuxAudio=function(n,t,i,s){var c=n.inputTimeScale,oi=n.timescale,ot=c/oi,si=n.isAAC?1024:1152,y=si*ot,hi=this._PTSNormalize,dt=this._initDTS,st=!n.isAAC&&this.typeSupported.mpeg,tt=void 0,g=void 0,h=void 0,nt=void 0,gt=void 0,at=void 0,ht=void 0,l=n.samples,it=[],a=this.nextAudioPts,b,p,ti,vt,yt,pt,wt,ct,ii,d,ut,ft,bt,kt,lt,et;if(i|=l.length&&a&&(s&&Math.abs(t-a/c)<.1||Math.abs(l[0].pts-a-dt)<20*y),l.f,t*c)}),l=l.ts>=0}),0!==l.length){if(i||(a=s?t*c:l[0].pts),n.isAAC)for(var ni=this.config.maxAudioFramesDrift,w=0,v=a;w<l.length;)if(p=l[w],ti=p.pts,b=ti-v,vt=Math.abs(1e3*b/c),b<=-ni*y)r.b.warn("Dropping 1 audio frame @ "+(v/c).toFixed(3)+"s due to "+Math.round(vt)+" ms overlap."),l.splice(w,1),n.len-=p.unit.length;else if(b>=ni*y&&vt<1e4&&v){for(yt=Math.round(b/y),r.b.warn("Injecting "+yt+" audio frame @ "+(v/c).toFixed(3)+"s due to "+Math.round(1e3*b/c)+" ms gap."),pt=0;pt<yt;pt++)wt=Math.max(v,0),h=o.a.getSilentFrame(n.manifestCodec||n.codec,n.channelCount),h||(r.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),h=p.unit.subarray()),l.splice(w,0,{unit:h,pts:wt,dts:wt}),n.len+=h.length,v+=y,w++;p.pts=p.dts=v;v+=y;w++}else Math.abs(b),p.pts=p.dts=v,v+=y,w++;for(ct=0,ii=l.length;ct<ii;ct++){var ri=l[ct],rt=ri.unit,k=ri.pts;if(void 0!==ht)g.duration=Math.round((k-ht)/ot);else{if(d=Math.round(1e3*(k-a)/c),ut=0,i&&n.isAAC&&d){if(d>0&&d<1e4)ut=Math.round((k-a)/y),r.b.log(d+" ms hole between AAC samples detected,filling it"),ut>0&&(h=o.a.getSilentFrame(n.manifestCodec||n.codec,n.channelCount),h||(h=rt.subarray()),n.len+=ut*h.length);else if(d<-12){r.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(a/c).toFixed(3)+"s/"+(k/c).toFixed(3)+"s/"+-d+"ms");n.len-=rt.byteLength;continue}k=a}if(at=k,!(n.len>0))return;ft=st?n.len:n.len+8;tt=st?0:8;try{nt=new Uint8Array(ft)}catch(n){return void this.observer.trigger(u.a.ERROR,{type:e.b.MUX_ERROR,details:e.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:ft,reason:"fail allocating audio mdat "+ft})}for(st||(new DataView(nt.buffer).setUint32(0,ft),nt.set(f.a.types.mdat,4)),bt=0;bt<ut;bt++)h=o.a.getSilentFrame(n.manifestCodec||n.codec,n.channelCount),h||(r.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),h=rt.subarray()),nt.set(h,tt),tt+=h.byteLength,g={size:h.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},it.push(g)}nt.set(rt,tt);kt=rt.byteLength;tt+=kt;g={size:kt,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};it.push(g);ht=k}if(lt=0,et=it.length,et>=2&&(lt=it[et-2].duration,g.duration=lt),et){this.nextAudioPts=a=ht+ot*lt;n.len=0;n.samples=it;gt=st?new Uint8Array:f.a.moof(n.sequenceNumber++,at/ot,n);n.samples=[];var ui=at/c,fi=a/c,ei={data1:gt,data2:nt,startPTS:ui,endPTS:fi,startDTS:ui,endDTS:fi,type:"audio",hasAudio:!0,hasVideo:!1,nb:et};return this.observer.trigger(u.a.FRAG_PARSING_DATA,ei),ei}return null}},n.prototype.remuxEmptyAudio=function(n,t,i,u){var f=n.inputTimeScale,y=n.samplerate?n.samplerate:f,p=f/y,l=this.nextAudioPts,a=(void 0!==l?l:u.startDTS*f)+this._initDTS,w=u.endDTS*f+this._initDTS,v=1024*p,b=Math.ceil((w-a)/v),s=o.a.getSilentFrame(n.manifestCodec||n.codec,n.channelCount),h,e,c;if(r.b.warn("remux empty Audio"),!s)return void r.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(h=[],e=0;e<b;e++)c=a+e*v,h.push({unit:s,pts:c,dts:c}),n.len+=s.length;n.samples=h;this.remuxAudio(n,t,i)},n.prototype.remuxID3=function(n,t){var f=n.samples.length,i=void 0,e=n.inputTimeScale,o=this._initPTS,s=this._initDTS,r;if(f){for(r=0;r<f;r++)i=n.samples[r],i.pts=(i.pts-o)/e,i.dts=(i.dts-s)/e;this.observer.trigger(u.a.FRAG_PARSING_METADATA,{samples:n.samples})}n.samples=[];t=t},n.prototype.remuxText=function(n,t){var i;n.samples.sort(function(n,t){return n.pts-t.pts});var f=n.samples.length,r=void 0,e=n.inputTimeScale,o=this._initPTS;if(f){for(i=0;i<f;i++)r=n.samples[i],r.pts=(r.pts-o)/e;this.observer.trigger(u.a.FRAG_PARSING_USERDATA,{samples:n.samples})}n.samples=[];t=t},n.prototype._PTSNorurn n},n}();t.a=h},function(n,t){"use strict";function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");ll},n}();t.a=r},function(n,t){"use strict";function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i=Math.pow(2,32)-1,u=function(){function n(){r(this,n)}return n.init=function(){var t,i,r,u,f;n.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};t=void 0;for(t in n.types)n.types.hasOwnProperty(t)&&(n.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);n.HDLR_TYPES={video:i,audio:r};u=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);f=new Uint8Array([0,0,0,0,0,0,0,0]);n.STTS=n.STSC=n.STCO=f;n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);n.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var e=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);n.FTYP=n.box(n.types.ftyp,e,s,e,o);n.DINF=n.box(n.types.dinf,n.box(n.types.dref,u))}urn r},S[t])},at,t)},,0]))},f(t))},&t]))},l(t))},r,i))},(t)))},t(r))},hd,e)},n.sdtp=function(t){for(var u=t.samples||[],f=new Uint8Array(4+u.length),r=void 0,i=void 0,i=0;i<u.length;i++)r=u[i].flags,f[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return n.box(n.types.sdtp,f)},TCO))},n.avc1=function(t){for(var i=[],e=[],r=void 0,u=void 0,f=void 0,r=0;r<t.sps.length;r++)u=t.sps[r],f=u.byteLength,i.push(f>>>8&255),i.push(255&f),i=i.concat(Array.prototype.slice.call(u));for(r=0;r<t.pps.length;r++)u=t.pps[r],f=u.byteLength,e.push(f>>>8&255),e.push(255&f),e=e.concat(Array.prototype.slice.call(u));var l=n.box(n.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(e))),h=t.width,c=t.height,o=t.pixelRatio[0],s=t.pixelRatio[1];return n.box(n.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,255&h,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),n.box(n.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])))},,2]))},(t)))},0]))},1(t))},,0]))},8),o)},a(t))},,1]))},un,c)},n.initSth),i},n}();t.a=u},function(n,t,i){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=i(1),f=funcver=t}return n.prototype.destroy=function(){},n.prototype.resetTimeStamp=function(){},n.prototype.resetInitSegment=function(){},n.prototype.remux=function(n,t,i,u,f,e,o,s){var c=this.observer,h="";n&&(h+="audio");t&&(h+="video");c.trigger(r.a.FRAG_PARSING_DATA,{data1:s,startPTS:f,startDTS:f,type:h,hasAudio:!!n,hasVideo:!!t,nb:1,dropped:0});c.trigger(r.a.FRAG_PARSED)},n}();t.a=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(22),r=i(1),f=i(0),e=i(13),o=i.n(e),s=function(n){var t=new o.a,i;t.trigger=function(n){for(var r=arguments.length,u=Array(r>1?r-1:0),i=1;i<r;i++)u[i-1]=arguments[i];t.emit.apply(t,[n,n].concat(u))};t.off=function(n){for(var r=arguments.length,u=Array(r>1?r-1:0),i=1;i<r;i++)u[i-1]=arguments[i];t.removeListener.apply(t,[n].concat(a:i})};n.addEventListener("message",function(r){var e=r.data,o;switch(e.cmd){case"init":o=JSON.parse(e.config);n.demuxer=new u.a(t,e.typeSupported,o,e.vendor);try{Object(f.a)(!0===o.debug)}catch(n){console.warn("demuxerWorker: unable to enable logs")}i("init",null);break;case"demux":n.demuxer.push(e.data,e.decryptdata,e.initSegment,e.audioCodec,e.videoCodec,e.timeOffset,e.discontinuity,e.trackSwitch,e.contiguous,e.duration,e.accurateTimeOffset,e.defaultInitPTS)}});t.on(r.a.FRAG_DECRYPTED,i);t.on(r.a.FRAG_PARSING_INIT_SEGMENT,i);t.on(r.a.FRAG_PARSED,i);t.on(r.a.ERROR,i);t.on(r.a.FRAG_PARSING_METADATA,i);t.on(r.a.FRAG_PARSING_USERDATA,i);t.on(r.a.INIT_PTS_FOUND,i);t.on(r.a.FRAG_PARSING_DATA,function(t,i){var r=[],u={event:t,data:i};i.data1&&(u.data1=i.data1.buffer,r.push(i.data1.buffer),delete i.data1);i.data2&&(u.data2=i.data2.buffer,r.push(i.data2.buffer),delete i.data2);n.postMessage(u,r)})};t.default=s},function(n,t,i){"use strict";function u(n,t,i){var r,u;if(!Array.isArray(n)||!n.length||!Object(o.a)(t)||t<n[0].programDateTime||t>=n[n.length-1].endProgramDateTime)return null;for(i=i||0,r=0;r<n.length;++r)if(u=n[r],e(t,i,u))return u;return null}function f(n,t){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=n?t[n.sn-t[0].sn+1]:null;return i&&!r(u,f,i)?i:s.a.search(t,r.bind(null-r>n}t.a=u;t.b=f;var o=i(3),s=i(7)},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var e=i(8),r=i(2),f=i(1),u=i(0),s=function(){function n(t,i,r,u){o(this,n);this.config=t;this.media=i;this.fragmentTracker=r;this.hls=u;this.stallReported=!1}return n.prototype.poll=function(n){var s=this.config,t=this.media,i=t.currentTime,r=window.performance.now(),f,o;if(i!==n)return this.stallReported&&(u.b.warn("playback not stuck anymore @"+i+", after "+Math.round(r-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);if(!(t.ended||!t.buffered.length||t.readyState>2||t.seeking&&e.a.isBuffered(t,i))){if(f=r-this.stalled,o=e.a.bufferInfo(t,i,s.maxBufferHole),!this.stalled)return void(this.stalled=r);f>=1e3&&this._reportStall(o.len);this._tryFixBufferStall(o,f)}},n.prototype._tryFixBufferStall=function(n,t){var r=this.config,u=this.fragmentTracker,f=this.media,e=f.currentTime,i=u.getPartialFragment(e);i&&this._trySkipBufferHole(i);n.len>.5&&t>1e3*r.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},n.prototype._repor:n}))},n.prototype._trySkipBufferHole=function(n){for(var o,h=this.hls,t=this.media,i=t.currentTime,s=0,e=0;e<t.buffered.length;e++){if(o=t.buffered.start(e),i>=s&&i<o)return t.currentTime=Math.max(o,t.currentTime+.1),u.b.warn("skipping hole, adjusting currentTime from "+i+" to "+t.currentTime),this.stalled=null,void h.trigger(f.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+t.currentTime,frag:n});s=t.buffered.end(e)}},n.prototype._tryNudgeBuffer=function(){var n=this.config,o=this.hls,s=this.media,t=s.currentTime,i=(this.nudgeRetry||0)+1,e;(this.nudgeRetry=i,i<n.nudgeMaxRetry)?(e=t+i*n.nudgeOffset,u.b.log("adjust currentTime from "+t+" to "+e),s.currentTime=e,o.trigger(f.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.BUFFER_NUDGE_ON_STALL,fatal:!1})):(u.b.error("still stuck in high buffer @"+t+" after "+n.nudgeMaxRetry+", raise fatal error"),o.trigger(f.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.BUFFER_STALLED_ERROR,fatal:!0}))},n}();t.a=s},function(n,t,i){"use strict";function s(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function h(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function c(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u=i(1),l=i(4),f=i(0),r=i(2),e=i(20),o=i(16),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),y=window,p=y.performance,w=functull,r}return c(t,n),t.prototype.onHandlerDestex=-1},t.prototype.cleanull)},t.prototype.startLoad=function(){var n=this._levels;this.canload=!0;this.levelRetryCount=0;n&&n.fid 0)});null!==this.timer&&this.loadLevel()},t.prototype.stad=!1},t.prototype.onManifestLoaded=function(n){var t=[],a=void 0,v={},i=null,s=!1,c=!1,y=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),l=[],h;if(n.levels.forEach(function(n){n.loadError=0;n.fragmentError=!1;s=s||!!n.videoCodec;c=c||!!n.audioCodec||!(!n.attrs||!n.attrs.AUDIO);y&&n.audioCodec&&-1!==n.audioCodec.indexOf("mp4a.40.34")&&(n.audioCodec=void 0);i=v[n.bitrate];i?i.url.push(n.url):(n.url=[n.url],n.urlId=0,v[n.bitrate]=n,t.push(n));n.attrs&&n.attrs.AUDIO&&Object(o.a)(i||n,"audio",n.attrs.AUDIO);n.attrs&&n.attrs.SUBTITLES&&Object(o.a)(i||n,"text",n.attrs.SUBTITLES)}),s&&c&&(t=t.Codec})),t=t.)(i))}),n.audioTracks&&(l=n.audioTracks.dio")}),l.f.id=t})),t.length>0){for(a=t[0].bitrate,trate}),this._levels=t,h=0;h<t.length;h++)if(t[h].bitrate===a){this._firstLevel=h;f.b.log("manifest loaded,"+t.length+" level(s) found, first bitrate:"+a);break}this.hls.trigger(u.a.MANIFEST_PARSED,{levels:t,audioTracks:l,firstLevel:this._firstLevel,stats:n.stats,audio:c,video:s,altAudio:l.length>0&&s})}else this.hls.trigger(u.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},t.prototype.setLevelInternal=function(n){var i=this._levels,e=this.hls,o,t,s,h;n>=0&&n<i.length?((this.clearTimer(),this.currentLevelIndex!==n)&&(f.b.log("switching to level "+n),this.currentLevelIndex=n,o=i[n],o.level=n,e.trigger(u.a.LEVEL_SWITCHING,o)),t=i[n],s=t.details,(!s||s.live)&&(h=t.urlId,e.trigger(u.a.LEVEL_LOADING,{url:t.url[h],level:n,id:h}))):e.trigger(u.a.ERROR,{type:r.b.OTHER_ERROR,details:r.a.LEVEL_SWITCH_ERROR,level:n,fatal:!1,reason:"invalid level idx"})},t.prototype.onError=function(n){if(n.fatal)return void(n.type===r.b.NETWORK_ERROR&&this.clearTimer());var i=!1,u=!1,t=void 0;switch(n.details){case r.a.FRAG_LOAD_ERROR:case r.a.FRAG_LOAD_TIMEOUT:case r.a.KEY_LOAD_ERROR:case r.a.KEY_LOAD_TIMEOUT:t=n.frag.level;u=!0;break;case r.a.LEVEL_LOAD_ERROR:case r.a.LEVEL_LOAD_TIMEOUT:t=n.context.level;i=!0;break;case r.a.REMUX_ALLOC_ERROR:t=n.level;i=!0}void 0!==t&&this.recoverLevel(n,t,i,u)},t.prototype.recoverLevel=function(n,t,i,r){var l=this,s=this.hls.config,e=n.details,u=this._levels[t],o=void 0,h=void 0,c=void 0;if(u.loadError++,u.fragmentError=r,i){if(!(this.levelRetryCount+1<=s.levelLoadingMaxRetry))return f.b.error("level controller, cannot recover from "+e+" error"),this.currentLevelIndex=null,this.clearTimer(),void(n.fatal=!0);h=Math.min(Math.pow(2,this.levelRetryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout);this.timer=setTimeout(function(){return l.loadLevel()},h);n.levelRetry=!0;this.levelRetryCount++;f.b.warn("level controller, "+e+", retry in "+h+" ms, current retry count is "+this.levelRetryCount)}(i||r)&&(o=u.url.length,o>1&&u.loadError<o?(u.urlId=(u.urlId+1)%o,u.details=void 0,f.b.warn("level controller, "+e+" for level "+t+": switching to redundant URL-id "+u.urlId)):-1===this.manualLevelIndex?(c=0===t?this._levels.length-1:t-1,f.b.warn("level controller, "+e+": switch to "+c),this.hls.nextAutoLevel=this.currentLevelIndex=c):r&&(f.b.warn("level controller, "+e+": reload a fragment"),this.currentLevelIndex=null))},t.prototype.onFragLoaded=function(n){var i=n.frag,t;void 0!==i&&"main"===i.type&&(t=this._levels[i.level],void 0!==t&&(t.fragmentError=!1,t.loadError=0,this.levelRetryCount=0))},t.prototype.onLevelLoaded=function(n){var s=this,u=n.level,r,t;if(u===this.currentLevelIndex)if(r=this._levels[u],r.fragmentError||(r.loadError=0,this.levelRetryCount=0),t=n.details,t.live){var e=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),i=e,o=r.details;o&&t.endSN===o.endSN&&(i/=2,f.b.log("same live playlist, reload twice faster"));i-=p.now()-n.stats.trequest;i=Math.max(e/2,Math.round(i));f.b.log("live playlist, reload in "+Math.round(i)+" ms");this.timer=setTimeout(function(){return s.loadLevel()},i)}else this.clearTimer()},t.prototype.onAudioTrackSwitched=function(n){var r=this.hls.audioTracks[n.id].groupId,t=this.hls.levels[this.currentLevelIndex],i;t&&t.audioGroupIds&&(i=t.audioGroupIds.finn===r}),i!==t.urlId&&(t.urlId=i,this.startLoad()))},t.prototype.loadLevel=function(){var n;if((f.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload)&&(n=this._levels[this.currentLevelIndex],"object"===(void 0===n?"undefined":a(n))&&n.url.length>0)){var i=this.currentLevelIndex,t=n.urlId,r=n.url[t];f.b.log("Attempt loading level index "+i+" with URL-id "+t);this.hls.trigger(u.a.LEVEL_LOADING,{url:r,level:i,id:t})}},v(t,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndel(n))}},{key:"manualLevel",get:function(){return this.manualLevelIndeel=n)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(n){this._firstLevel=n}},{key:"startLeveLevel},set:function(n){this._startLevel=n}},{key:"nextLoadLeveLeveel=n)}}]),t}(l.a);t.a=w},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function h(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r=i(1),u=i(4),f=i(9),e=i(27),c=functd 0,u}return h(t,n),t.prototype.destroy=function(){u.a.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(n){this.media=n.media;this.media},t.prototype.onMediaDetaching=function(){Object(e.a)(this.id3Track);this.id3Track=void 0;this.media=void 0},t.prototype.getID3Track=function(n){for(var t,i=0;i<n.length;i++)if(t=n[i],"metadata"===t.kind&&"id3"===t.label)return Object(e.b)(t,this.media),t;return this.media.addTextTrack("metadata","id3")},t.prototype.onFragParsingMetadata=function(n){var l=n.frag,i=n.samples,c,t,r,o,u,e,s,h;for(this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden"),c=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,t=0;t<i.length;t++)if(r=f.a.getID3Frames(i[t].data),r)for(o=i[t].pts,u=t<i.length-1?i[t+1].pts:l.endPTS,o===u&&(u+=.0001),e=0;e<r.length;e++)s=r[e],f.a.isTimeStampFrame(s)||(h=new c(o,u,""),h.value=s,this.id3Track.addCue(h))},t}(u.a);i(15)},function(n,t,i){"use strict";i.d(t,"a",function(){return r});var u=i(56),f=i(59),e=i(60),o=i(61),s=i(62),h=i(63),c=i(64),l=i(65),a=i(67),v=i(71),y=i(72),p=i(73),w=i(74),r={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:s.a,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:u.a,bufferController:f.a,capLevelController:e.a,fpsController:o.a,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:w.a};r.subtitleStreamController=y.a;r.subtitleTrackController=v.a;r.timelineController=a.a;r.cueHandler=l;r.enableCEA708Captions=!0;r.enableWebVTT=!0;r.captionsTextTrack1Label="English";r.captionsTextTrack1LanguageCode="en";r.captionsTextTrack2Label="Spanish";r.captionsTextTrack2LanguageCode="es";r.audioStreamController=c.a;r.audioTrackController=h.a;r.emeController=p.a},function(n,t,i){"use strict";function h(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function c(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function l(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var f=i(3),u=i(1),e=i(4),o=i(8),s=i(2),r=i(0),a=i(57),v=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),y=window,p=y.performance,w=funct(r),r}return l(t,n),t.prototype.dthis)},t.prototype.onFragLoading=function(n){var i=n.frag;if("main"===i.type&&(this.timer||(this.fragCurrent=i,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r=this.hls,t=r.config,e=i.level,o=r.levels[e].details.live,u=void 0,f=void 0;o?(u=t.abrEwmaFastLive,f=t.abrEwmaSlowLive):(u=t.abrEwmaFastVoD,f=t.abrEwmaSlowVoD);this._bwEstimator=new a.a(r,f,u,t.abrEwmaDefaultEstimate)}},t.prototype._abandonRulesCheck=function(){var e=this.hls,f=e.media,n=this.fragCurrent,s,b,t,c,l,y,i,g;if(n){if(s=n.loader,b=e.minAutoLevel,!s||s.stats&&s.stats.aborted)return r.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(t=s.stats,f&&t&&(!f.paused&&0!==f.playbackRate||!f.readyState)&&n.autoLevel&&n.level&&(c=p.now()-t.trequest,l=Math.abs(f.playbackRate),c>500*n.duration/l)){var h=e.levels,k=Math.max(1,t.bw?t.bw/8:1e3*t.loaded/c),a=h[n.level],nt=a.realBitrate?Math.max(a.realBitrate,a.bitrate):a.bitrate,tt=t.total?t.total:Math.max(t.loaded,Math.round(n.duration*nt/8)),d=f.currentTime,w=(tt-t.loaded)/k,v=(o.a.bufferInfo(f,d,e.config.maxBufferHole).end-d)/l;if(v<2*n.duration/l&&w>v){for(y=void 0,i=void 0,i=n.level-1;i>b;i--)if(g=h[i].realBitrate?Math.max(h[i].realBitrate,h[i].bitrate):h[i].bitrate,(y=n.duration*g/(6.4*k))<v)break;y<w&&(r.b.warn("loading too slow, abort fragment loading and switch to level "+i+":fragLoadedDelay["+i+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+y.toFixed(1)+"<"+w.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=i,this._bwEstimator.sample(c,t.loaded),s.abort(),this.clearTimer(),e.trigger(u.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:t}))}}}},t.prototype.onFragLoaded=function(n){var i=n.frag,r;if("main"===i.type&&Object(f.a)(i.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=i.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var t=this.hls.levels[i.level],u=(t.loaded?t.loaded.bytes:0)+n.stats.loaded,e=(t.loaded?t.loaded.duration:0)+n.frag.duration;t.loaded={bytes:u,duration:e};t.realBitrate=Math.round(8*u/e)}n.frag.bitrateTest&&(r=n.stats,r.tparsed=r.tbuffered=r.tload,this.onFragBuffered(n))}},t.prototype.onFragBuffered=function(n){var t=n.stats,i=n.frag,u;!0!==t.aborted&&"main"===i.type&&Object(f.a)(i.sn)&&(!i.bitrateTest||t.tload===t.tbuffered)&&(u=t.tparsed-t.trequest,r.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(u,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),this.bitrateTestDelay=i.bitrateTest?u/1e3:0)},t.prototype.oer()}},t.prototype.clea=null},t.prototype._findBestLevel=function(n,t,i,u,f,e,o,s,h){for(var p,v,y,c=f;c>=u;c--)if(p=h[c],p){var l=p.details,w=l?l.totalduration/l.fragments.length:t,b=!!l&&l.live,a=void 0;if(a=c<=n?o*i:s*i,v=h[c].realBitrate?Math.max(h[c].realBitrate,h[c].bitrate):h[c].bitrate,y=v*w/a,r.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+c+"/"+Math.round(a)+"/"+v+"/"+w+"/"+e+"/"+y),a>v&&(!y||b&&!this.bitrateTestDelay||y<e))return c}return-1},v(t,[{key:"nextAutoLevel",get:function(){var n=this._nextAutoLevel,i=this._bwEstimator,t;return(-1===n||i&&i.canEstimate())?(t=this._nextABRAutoLevel,-1!==n&&(t=Math.min(n,t)),t):n},set:function(n){this._nextAutoLevel=n}},{key:"_nextABRAutoLevel",get:function(){var u=this.hls,c=u.maxAutoLevel,l=u.levels,n=u.config,a=u.minAutoLevel,t=u.media,v=this.lastLoadedFragLevel,i=this.fragCurrent?this.fragCurrent.duration:0,y=t?t.currentTime:0,k=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,p=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,s=(o.a.bufferInfo(t,y,n.maxBufferHole).end-y)/k,f=this._findBestLevel(v,i,p,a,c,s,n.abrBandWidthFactor,n.abrBandWidthUpFactor,l),e;if(f>=0)return f;r.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var h=i?Math.min(i,n.maxStarvationDelay):n.maxStarvationDelay,w=n.abrBandWidthFactor,b=n.abrBandWidthUpFactor;return 0===s&&(e=this.bitrateTestDelay,e&&(h=(i?Math.min(i,n.maxLoadingDelay):n.maxLoadingDelay)-e,r.b.trace("bitrate test took "+Math.round(1e3*e)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*h)+" ms"),w=b=1)),f=this._findBestLevel(v,i,p,a,c,s+h,w,b,l),Math.max(f,0)}}]),t}(e.a);t.a=w},function(n,t,i){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=i(58),f=function(){function n(t,i,f,e){u(this,n);this.hls=t;this.defaultEstimate_=e;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new r.a(i);this.fast_=new r.a(f)}return n.prototype.sample=function(n,t){n=Math.max(n,this.minDelayMs_);var i=8e3*t/n,r=n/1e3;this.fast_.sample(r,i);this.slow_.sample(r,i)},n.prototype.canEsight_},n.prototype.getEsmate_},n.prototype.destroy=function(){},n}();t.a=f},function(n,t){"use strict";function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=function(){function n(t){i(this,n);this.alpha_=t?Math.exp(Math.log(.5)/t):0;this.estimate_=0;this.totalWeight_=0}return n.prototype.t_+=n},n.prototype.getTotalWeight=function(){return this.totalWeight_},n.prototype.getEsmate_},n}();t.a=r},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function h(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var c=i(3),u=i(1),e=i(4),r=i(0),f=i(2),l=i(15),a=Object(l.a)(),v=funct={},r}return h(t,n),t.prototype.destroy=function(){e.a.prototype.destroy.call(this)},t.prototype.onLevelPtsUpdated=function(n){var f=n.type,u=this.tracks.audio,t,i;if("audio"===f&&u&&"audio/mpeg"===u.container&&(t=this.sourceBuffer.audio,Math.abs(t.timestampOffset-n.start)>.1)){i=t.updating;try{t.abort()}catch(n){i=!0;r.b.warn("can not abort audio buffer: "+n)}i?this.audioTimestampOffset=n.start:(r.b.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+n.start),t.timestampOffset=n.start)}},t.prototype.onManifestParsed=function(n){var i=n.audio,u=n.video||n.levels.length&&n.altAudio,t=0;n.altAudio&&(i||u)&&(t=(i?1:0)+(u?1:0),r.b.log(t+" sourceBuffer(s) expected"));this.sourceBufferNb=t},t.prototype.onMediaAttaching=function(n){var i=this.media=n.media,t;i&&(t=this.mediaSource=new a,this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),t.addEventListener("sourceopen",this.onmso),t.addEventListener("sourceended",this.onmse),t.addEventListener("sourceclose",this.onmsc),i.src=window.URL.createObjectURL(t),this._objectUrl=i.src)},t.prototype.onMediaDetaching=function(){r.b.log("media source detaching");var n=this.mediaSource;if(n){if("open"===n.readyState)try{n.endOfStream()}catch(n){r.b.warn("onMediaDetaching:"+n.message+" while calling endOfStream")}n.removeEventListener("sourceopen",this.onmso);n.removeEventListener("sourceended",this.onmse);n.removeEventListener("sourceclose",this.onmsc);this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):r.b.warn("media.src was changed by a third party - skip cleanup"));this.mediaSource=null;this.media=null;this._objectUrl=null;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.onmso=this.onmse=this.onmsc=null;this.hls.trigger(u.a.MEDIA_DETACHED)},t.prototype.onMediaSourceOpen=function(){r.b.log("media source opened");this.hls.trigger(u.a.MEDIA_ATTACHED,{media:this.media});var n=this.mediaSource;n&&n.removeEventListener("sourceopen",this.onmso);this.checkPendingTracks()},t.prototype.checkPendingng())},t.prototype.onMediaSourceClose=function(){r.b.log("media source closed")},t.prototype.onMediaSourceEnded=function(){r.b.log("media source ended")},t.prototype.onSBUpdateEnd=function(){var n,t;this.audioTimestampOffset&&(n=this.sourceBuffer.audio,r.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+this.audioTimestampOffset),n.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset);this._needsFlush&&this.doFlush();this._needsEos&&this.checkEos();this.appending=!1;var i=this.parent,o=this.segments.n+1:n},0),f={},e=this.sourceBuffer;for(t in e)f[t]=e[t].buffered;this.hls.trigger(u.a.BUFFER_APPENDED,{parent:i,pending:o,timeRanges:f});this._needsFlush||this.doAppending();this.updateMediaElementDuration()},t.prototype.onSBUpdateError=function(n){r.b.error("sourceBuffer error:",n);this.hls.trigger(u.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_APPENDING_ERROR,fatal:!1})},t.prototype.onBufferReset=function(){var t=this.sourceBuffer,i,n;for(i in t){n=t[i];try{this.mediaSource.removeSourceBuffer(n);n.removeEventListener("updateend",this.onsbue);n.removeEventListener("error",this.onsbe)}catch(t){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0},t.prototype.onBufferCodecs=function(n){var t,i;if(0===Object.keys(this.sourceBuffer).length){for(t in n)this.pendingTracks[t]=n[t];i=this.mediaSource;i&&"open"===i.readyState&&this.checkPendingTracks()}},t.prototype.createSourceBuffers=function(n){var s=this.sourceBuffer,c=this.mediaSource,t,e;for(t in n)if(!s[t]){var i=n[t],h=i.levelCodec||i.codec,o=i.container+";codecs="+h;r.b.log("creating sourceBuffer("+o+")");try{e=s[t]=c.addSourceBuffer(o);e.addEventListener("updateend",this.onsbue);e.addEventListener("error",this.onsbe);this.tracks[t]={codec:h,container:i.container};i.buffer=e}catch(n){r.b.error("error while trying to add sourceBuffer:"+n.message);this.hls.trigger(u.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:n,mimeType:o})}}this.hls.trigger(u.a.BUFFER_CREATED,{tracks:n})},t.prototype.onBufferAppng())},t.prototype.onBufferAppendFail=function(n){r.b.error("sourceBuffer error:",n.event);this.hls.trigger(u.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_APPENDING_ERROR,fatal:!1})},t.prototype.onBufEos()},t.prototype.checkEos=function(){var i=this.sourceBuffer,n=this.mediaSource,u,t;if(!n||"open"!==n.readyState)return void(this._needsEos=!1);for(u in i){if(t=i[u],!t.ended)return;if(t.updating)return void(this._needsEos=!0)}r.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{n.endOfStream()}catch(i){r.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},t.prototype.onBufferFlushing=function(n){this.flushRange.push({start:n.startOffset,end:n.endOffset,type:n.type});this.flushBufferCounter=0;this.doFlush()},t.prototype.onLevelUon())},t.prototype.updateMediaElementDuration=function(){var i=this.hls.config,n=void 0,t;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(t in this.sourceBuffer)if(!0===this.sourceBuffer[t].updating)return;n=this.media.duration;null===this._msDuration&&(this._msDuration=this.mediaSource.duration);!0===this._live&&!0===i.liveDurationInfinity?(r.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>n||!Object(c.a)(n))&&(r.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},t.prototype.doFlush=function(){for(var n,t,i,f;this.flushRange.length;){if(n=this.flushRange[0],!this.flushBuffer(n.start,n.end,n.type))return void(this._needsFlush=!0);this.flushRange.shift();this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;t=0;i=this.sourceBuffer;try{for(f in i)t+=i[f].buffered.length}catch(n){r.b.error("error while accessing sourceBuffer.buffered")}this.appended=t;this.hls.trigger(u.a.BUFFER_FLUSHED)}},t.prototype.doAppending=function(){var e=this.hls,s=this.sourceBuffer,i=this.segments,t,h,o,n;if(Object.keys(s).length){if(this.media.error)return this.segments=[],void r.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(i&&i.length){t=i.shift();try{h=t.type;o=s[h];o?o.updating?i.unshift(t):(o.ended=!1,this.parent=t.parent,o.appendBuffer(t.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(s){r.b.error("error while trying to append buffer:"+s.message);i.unshift(t);n={type:f.b.MEDIA_ERROR,parent:t.parent};22!==s.code?(this.appendError?this.appendError++:this.appendError=1,n.details=f.a.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry?(r.b.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),i=[],n.fatal=!0,e.trigger(u.a.ERROR,n)):(n.fatal=!1,e.trigger(u.a.ERROR,n))):(this.segments=[],n.details=f.a.BUFFER_FULL_ERROR,n.fatal=!1,e.trigger(u.a.ERROR,n))}}}},t.prototype.flushBuffer=function(n,t,i){var u=void 0,f=void 0,c=void 0,s=void 0,e=void 0,o=void 0,l=this.sourceBuffer,h;if(Object.keys(l).length){if(r.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+n+"/"+t),this.flushBufferCounter<this.appended){for(h in l)if(!i||h===i){if(u=l[h],u.ended=!1,u.updating)return r.b.warn("cannot flush, sb updating in progress"),!1;try{for(f=0;f<u.buffered.length;f++)if(c=u.buffered.start(f),s=u.buffered.end(f),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(e=n,o=t):(e=Math.max(c,n),o=Math.min(s,t)),Math.min(o,s)-e>.5)return this.flushBufferCounter++,r.b.log("flush "+h+" ["+e+","+o+"], of ["+c+","+s+"], pos:"+this.media.currentTime),u.remove(e,o),!1}catch(n){r.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else r.b.warn("abort flushing too many retries");r.b.log("buffer flushed")}return!0},t}(e.a);t.a=v},function(n,t,i){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function f(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function e(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r=i(1),o=i(4),s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=function(n){function t(i){u(this,t);var e=f(this,n.call(this,i,r.a.FPS_DROP_LEVEL_CAPPING,r.a.MEDIA_ATTACHING,r.a.MANIFEST_PARSED,r.a.BUFFER_CODECS,r.a.MEDIA_DETACHING));return e.autoLevelCapping=Number.POSITIVE_INFINITY,e.firstLevel=null,e.levels=[],e.media=null,e.restrictedLevels=[],e.timer=null,e}return e(t,n),t.prototype.dng())},t.prototype.onFpsDropLevelCevel)},t.prototype.onMediaAtt:null},t.prototype.onManifestParsed=function(n){var t=this.hls;this.restrictedLevels=[];this.levels=n.levels;this.firstLevel=n.firstLevel;t.config.capLevelToPlayerSize&&(n.video||n.levels.length&&n.altAudio)&&this._startCapping()},t.prototype.onBuffering()},t.prototype.onLevelsUevels},t.prototype.onMediaDetaching=function(){this._stopCapping()},t.prototype.detectPlayerSize=function(){var t,n;this.media&&(t=this.levels?this.levels.length:0,t&&(n=this.hls,n.autoLevelCapping=this.getMaxLevel(t-1),n.autoLevelCapping>this.autoLevelCapping&&n.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping))},t.prototype.getMaxLevel=function(n){var r=this,i;return this.levels?(i=this.levels.&u<=n}),t.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)):-1},t.prototype._startCze())},t.prototype._stopCapping=function(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},t.isLevelAOf(n)},t.getMaxLevelByMediaSize=function(n,t,i){var f,r,u;if(!n||n&&!n.length)return-1;for(f=n.length-1,r=0;r<n.length;r+=1)if(u=n[r],(u.width>=t||u.heigheight}(u,n[r+1])){f=r;break}return f},s(t,[{key:"mediaWidth",get:function(){var i=void 0,n=this.media;return n&&(i=n.width||n.clientWidth||n.offsetWidth,i*=t.contentScaleFactor),i}},{key:"mediaHeighor),i}}],[{key:"contentScaleFactoio||1}}]),t}(o.a);t.a=h},function(n,t,i){"use strict";function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function f(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function e(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r=i(1),o=i(4),s=i(0),h=window,c=h.performance,l=functING))}return e(t,n),t.prototype.destroy=function(){this.timer&&clearInterval(this.timer);this.isVideoPlaybackQualityAvailable=!1},t.prototype.onMediaAttiod))},t.prototype.checkFPS=function(n,t,i){var o=c.now(),f;if(t){if(this.lastTime){var l=o-this.lastTime,e=i-this.lastDroppedFrames,h=t-this.lastDecodedFrames,a=1e3*e/l,u=this.hls;(u.trigger(r.a.FPS_DROP,{currentDropped:e,currentDecoded:h,totalDroppedFrames:i}),a>0&&e>u.config.fpsDroppedMonitoringThreshold*h)&&(f=u.currentLevel,s.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(-1===u.autoLevelCapping||u.autoLevelCapping>=f)&&(f-=1,u.trigger(r.a.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:u.currentLevel}),u.autoLevelCapping=f,u.streamController.nextLevelSwitch()))}this.lastTime=o;this.lastDroppedFrames=i;this.lastDecodedFrames=t}},t.prototype.checkFPSInterval=function(){var n=this.video,t;n&&(this.isVideoPlaybackQualityAvailable?(t=n.getVideoPlaybackQuality(),this.checkFPS(n,t.totalVideoFrames,t.droppedVideoFrames)):this.checkFPS(n,n.webkitDecodedFrameCount,n.webkitDroppedFrameCount))},t}(o.a);t.a=l},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=i(0),f=window,u=f.performance,o=f.XMLHttpRequest,s=function(){function n(t){e(this,n);t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return n.prototype.d=null},n.prototype.abort=function(){var n=this.loader;n&&4!==n.readyState&&(this.stats.aborted=!0,n.abort());window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null},n.prototype.load=function(n,t,i){this.context=n;this.config=t;this.callbacks=i;this.stats={trequest:u.now(),retry:0};this.retryDelay=t.retryDelay;this.loadInternal()},n.prototype.loadInternal=function(){var n=void 0,t=this.context,i,r;n=this.loader=new o;i=this.stats;i.tfirst=0;i.loaded=0;r=this.xhrSetup;try{if(r)try{r(n,t.url)}catch(i){n.open("GET",t.url,!0);r(n,t.url)}n.readyState||n.open("GET",t.url,!0)}catch(i){return void this.callbacks.onError({code:n.status,text:i.message},t,n)}t.rangeEnd&&n.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1));n.onreadystatechange=this.readystatechange.bind(this);n.onprogress=this.loadprogress.bind(this);n.responseType=t.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);n.send()},n.prototype.readystatechange=function(n){var i=n.currentTarget,c=i.readyState,t=this.stats,o=this.context,h=this.config,f,e,s,l;if(!t.aborted&&c>=2)if(window.clearTimeout(this.requestTimeout),0===t.tfirst&&(t.tfirst=Math.max(u.now(),t.trequest)),4===c)if(f=i.status,f>=200&&f<300){t.tload=Math.max(t.tfirst,u.now());e=void 0;s=void 0;"arraybuffer"===o.responseType?(e=i.response,s=e.byteLength):(e=i.responseText,s=e.length);t.loaded=t.total=s;l={url:i.responseURL,data:e};this.callbacks.onSuccess(l,t,o,i)}else t.retry>=h.maxRetry||f>=400&&f<499?(r.b.error(f+" while loading "+o.url),this.callbacks.onError({code:f,text:i.statusText},o,i)):(r.b.warn(f+" while loading "+o.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,h.maxRetryDelay),t.retry++);else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),h.timeout)},n.prototype.loadtimeout=function(){r.b.warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)},n.prototype.loadprogress=function(n){var r=n.currentTarget,t=this.stats,i;t.loaded=n.loaded;n.lengthComputable&&(t.total=n.total);i=this.callbacks.onProgress;i&&i(t,this.context,null,r)},n}();t.a=s},function(n,t,i){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function o(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function s(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var u=i(1),h=i(10),r=i(0),f=i(2),c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=function(n){function t(i){e(this,t);var r=o(this,n.call(this,i,u.a.MANIFEST_LOADING,u.a.MANIFEST_PARSED,u.a.AUDIO_TRACK_LOADED,u.a.AUDIO_TRACK_SWITCHED,u.a.LEVEL_LOADED,u.a.ERROR));return r._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}return s(t,n),t.prototype.onManifestLck=!0},t.prototype.onManifests:t})},t.prototype.onAudioTrackval()},t.prototype.onAudioTrackSwId=t)},t.prototype.onLevelLoaded=function(n){var t=this.hls.levels[n.level],i;t.audioGroupIds&&(i=t.audioGroupIds[t.urlId],this.audioGroupId!==i&&(this.audioGroupId=i,this._selectInitialAudioTrack()))},t.prototype.or()))},t.prototype._setAudioTrack=function(n){var t;if(this._trackId===n&&this.tracks[this._trackId].details)return void r.b.debug("Same id as current audio-track passed, and track details available -> no-op");if(n<0||n>=this.tracks.length)return void r.b.warn("Invalid id passed to audio-track controller");t=this.tracks[n];r.b.log("Now switching to audio-track index "+n);this.clearInterval();this._trackId=n;var i=t.url,f=t.type,e=t.id;this.hls.trigger(u.a.AUDIO_TRACK_SWITCHING,{id:e,type:f,url:i});this._loadTrackDetailsIfNeeded(t)},t.prototype.doTick=function(){this._updateTrack(this._trackId)},t.prototype._selectInitialAudioTrack=function(){var e=this,i=this.tracks,o,n,s,t,h;i.length&&(o=this.tracks[this._trackId],n=null,(o&&(n=o.name),this._selectDefaultTrack)&&(s=i.filter(function(n){return n.default}),s.length?i=s:r.b.warn("No default audio tracks defined")),!0)})},h(),t||(n=null,h()),t||(r.b.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(u.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0})))},t.prototype._needsTrackLoading=function(n){var t=n.details;return!t||!!t.live||void 0},t.prototype._loadTrackDetailsIfNeeded=function(n){if(this._needsTrackLoading(n)){var i=n.url,t=n.id;r.b.log("loading audio-track playlist for id: "+t);this.hls.trigger(u.a.AUDIO_TRACK_LOADING,{url:i,id:t})}},t.prototype._updateTrack=function(n){if(!(n<0||n>=this.tracks.length)){this.clearInterval();this._trackId=n;r.b.log("trying to update audio-track "+n);var t=this.tracks[n];this._loadTrackDetailsIfNeeded(t)}},t.prototype._handleLoadError=function(){var n,t,o;this.trackIdBlacklist[this._trackId]=!0;var i=this._trackId,u=this.tracks[i],f=u.name,e=u.language,s=u.groupId;for(r.b.warn("Loading failed on audio track id: "+i+", group-id: "+s+', name/language: "'+f+'" / "'+e+'"'),n=i,t=0;t<this.tracks.length;t++)if(!this.trackIdBlacklist[t]&&(o=this.tracks[t],o.name===f)){n=t;break}if(n===i)return void r.b.warn('No fallback audio-track found for name/language: "'+f+'" / "'+e+'"');r.b.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId);this._setAudioTrack(n)},c(t,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackIck=!1}}]),t}(h.a);t.a=l},function(n,t,i){"use strict";function l(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function a(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function v(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var h=i(3),y=i(7),s=i(8),p=i(21),f=i(1),c=i(16),w=i(25),e=i(2),u=i(0),b=i(26),k=i(10),d=i(12),g=i(11),nt=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),tt=window,o=tt.performance,r={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},it=functull,e}return v(t,n),t.prototype.onHandlerDestroying=function(){this.stopLoad();n.prototype.onHandlerDestroying.call(this)},t.prototype.onHandlerDestroyed=function(){this.state=r.STOPPED;this.fragmentTracker=null;n.prototype.onHandlerDestroyed.call(this)},t.prototype.onInitPtck())},t.prototype.startLoad=function(n){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad();this.setInterval(100);this.fragLoadError=0;t>0&&-1===n?(u.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=r.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:n,this.state=r.STARTING);this.nextLoadPosition=this.startPosition=this.lastCurrentTime;this.tick()}else this.startPosition=n,this.state=r.STOPPED},t.prototype.stopLoad=function(){var n=this.fragCurrent;n&&(n.loader&&n.loader.abort(),this.fragmentTracker.removeFragment(n),this.fragCurrent=null);this.fragPrevious=null;this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);this.state=r.STOPPED},t.prototype.doTick=function(){var l=void 0,v=void 0,t=void 0,ut=this.hls,p=ut.config,g,et,yt,ht,pt,rt,ct,lt;switch(this.state){case r.STARTING:this.state=r.WAITING_TRACK;this.loadedmetadata=!1;break;case r.IDLE:if(g=this.tracks,!g)break;if(!this.media&&(this.startFragRequested||!p.startFragPrefetch))break;if(this.loadedmetadata)l=this.media.currentTime;else if(void 0===(l=this.nextLoadPosition))break;var nt=this.mediaBuffer?this.mediaBuffer:this.media,wt=this.videoBuffer?this.videoBuffer:this.media,a=s.a.bufferInfo(nt,l,p.maxBufferHole),bt=s.a.bufferInfo(wt,l,p.maxBufferHole),kt=a.len,e=a.end,c=this.fragPrevious,dt=Math.min(p.maxBufferLength,p.maxMaxBufferLength),gt=Math.max(dt,bt.len),tt=this.audioSwitch,it=this.trackId;if((kt<gt||tt)&&it<g.length){if(void 0===(t=g[it].details)){this.state=r.WAITING_TRACK;break}if(!tt&&!t.live&&c&&c.sn===t.endSN&&!a.nextStart&&(!this.media.seeking||this.media.duration-e<c.duration/2)){this.hls.trigger(f.a.BUFFER_EOS,{type:"audio"});this.state=r.ENDED;break}var i=t.fragments,ft=i.length,w=i[0].start,at=i[ft-1].start+i[ft-1].duration,n=void 0;if(tt)if(t.live&&!t.PTSKnown)u.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),e=0;else if(e=l,t.PTSKnown&&l<w){if(!(a.end>w||a.nextStart))return;u.b.log("alt audio track ahead of main track, seek to start of alt audio track");this.media.currentTime=w+.05}if(t.initSegment&&!t.initSegment.data)n=t.initSegment;else if(e<=w){if(n=i[0],null!==this.videoTrackCC&&n.cc!==this.videoTrackCC&&(n=Object(b.b)(i,this.videoTrackCC)),t.live&&n.loadIdx&&n.loadIdx===this.fragLoadIdx)return et=a.nextStart?a.nextStart:w,u.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(et+.05)),void(this.media.currentTime=et+.05)}else{var k=void 0,ot=p.maxFragLookUpTolerance,st=c?i[c.sn-i[0].sn+1]:voi?-1:0};e<at?(e>at-ot&&(ot=0),k=st&&!vt(st)?st:y.a.search(i,vt)):k=i[ft-1];k&&(n=k,w=k.start,c&&n.level===c.level&&n.sn===c.sn&&(n.sn<t.endSN?(n=i[n.sn+1-t.startSN],u.b.log("SN just loaded, load next one: "+n.sn)):n=null))}n&&(n.encrypted?(u.b.log("Loading key for "+n.sn+" of ["+t.startSN+" ,"+t.endSN+"],track "+it),this.state=r.KEY_LOADING,ut.trigger(f.a.KEY_LOADING,{frag:n})):(u.b.log("Loading "+n.sn+", cc: "+n.cc+" of ["+t.startSN+" ,"+t.endSN+"],track "+it+", currentTime:"+l+",bufferEnd:"+e.toFixed(3)),(tt||this.fragmentTracker.getState(n)===d.a.NOT_LOADED)&&(this.fragCurrent=n,this.startFragRequested=!0,Object(h.a)(n.sn)&&(this.nextLoadPosition=n.start+n.duration),ut.trigger(f.a.FRAG_LOADING,{frag:n}),this.state=r.FRAG_LOADING)))}break;case r.WAITING_TRACK:v=this.tracks[this.trackId];v&&v.details&&(this.state=r.IDLE);break;case r.FRAG_LOADING_WAITING_RETRY:yt=o.now();ht=this.retryDate;nt=this.media;pt=nt&&nt.seeking;(!ht||yt>=ht||pt)&&(u.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=r.IDLE);break;case r.WAITING_INIT_PTS:if(rt=this.videoTrackCC,void 0===this.initPTS[rt])break;ct=this.waitingFragment;ct?(lt=ct.frag.cc,rt!==lt?(v=this.tracks[this.trackId],v.details&&v.details.live&&(u.b.warn("Waiting fragment CC ("+lt+") does not match video track CC ("+rt+")"),this.waitingFragment=null,this.state=r.IDLE)):(this.state=r.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)):this.state=r.IDLE}},t.prototype.onMediaAttached=function(n){var i=this.media=this.mediaBuffer=n.media,t;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);i.addEventListener("seeking",this.onvseeking);i.addEventListener("ended",this.onvended);t=this.config;this.tracks&&t.autoStartLoad&&this.startLoad(t.startPosition)},t.prototype.onMediaDetaching=function(){var n=this.media;n&&n.ended&&(u.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);n&&(n.removeEventListener("seeking",this.onvseeking),n.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null);this.media=this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1;this.stopLoad()},t.prototype.onMediaSeeking=function(){this.state===r.ENDED&&(this.state=r.IDLE);this.media&&(this.lastCurrentTime=this.media.currentTime);this.tick()},t.prototype.onMediime=0},t.prototype.onAudioTracksUpdated=function(n){u.b.log("audio tracks updated");this.tracks=n.audioTracks},t.prototype.onAudioTrackSwitching=function(n){var t=!!n.url;this.trackId=n.id;this.fragCurrent=null;this.state=r.PAUSED;this.waitingFragment=null;t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);t&&(this.audioSwitch=!0,this.state=r.IDLE);this.tick()},t.prototype.onAudioTrackLoaded=function(n){var t=n.details,e=n.id,o=this.tracks[e],l=t.totalduration,s=0,f,i;(u.b.log("track "+e+" loaded ["+t.startSN+","+t.endSN+"],duration:"+l),t.live)?(f=o.details,f&&t.fragments.length>0?(c.b(f,t),s=t.fragments[0].start,t.PTSKnown?u.b.log("live audio playlist sliding:"+s.toFixed(3)):u.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,u.b.log("live audio playlist - first load, unknown sliding"))):t.PTSKnown=!1;(o.details=t,this.startFragRequested)||(-1===this.startPosition&&(i=t.startTimeOffset,Object(h.a)(i)?(u.b.log("start time offset found in playlist, adjust startPosition to "+i),this.startPosition=i):this.startPosition=0),this.nextLoadPosition=this.startPosition);this.state===r.WAITING_TRACK&&(this.state=r.IDLE);this.tick()},t.prototype.onKeyLoaded=function(){this.state===r.KEY_LOADING&&(this.state=r.IDLE,this.tick())},t.prototype.onFragLoaded=function(n){var i=this.fragCurrent,e=n.frag,c,y;if(this.state===r.FRAG_LOADING&&i&&"audio"===e.type&&e.level===i.level&&e.sn===i.sn){var l=this.tracks[this.trackId],t=l.details,w=t.totalduration,a=i.level,s=i.sn,v=i.cc,b=this.config.defaultAudioCodec||l.audioCodec||"mp4a.40.2",h=this.stats=n.stats;"initSegment"===s?(this.state=r.IDLE,h.tparsed=h.tbuffered=o.now(),t.initSegment.data=n.payload,this.hls.trigger(f.a.FRAG_BUFFERED,{stats:h,frag:i,id:"audio"}),this.tick()):(this.state=r.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new p.a(this.hls,"audio")),c=this.initPTS[v],y=t.initSegment?t.initSegment.data:[],t.initSegment||void 0!==c?(this.pendingBuffering=!0,u.b.log("Demuxing "+s+" of ["+t.startSN+" ,"+t.endSN+"],track "+a),this.demuxer.push(n.payload,y,b,null,i,w,!1,c)):(u.b.log("unknown video PTS for continuity counter "+v+", waiting for video PTS before demuxing audio frag "+s+" of ["+t.startSN+" ,"+t.endSN+"],track "+a),this.waitingFragment=n,this.state=r.WAITING_INIT_PTS))}this.fragLoadError=0},t.prototype.onFragParsingInitSegment=function(n){var e=this.fragCurrent,h=n.frag,i,t,o,s;e&&"audio"===n.id&&h.sn===e.sn&&h.level===e.level&&this.state===r.PARSING&&(i=n.tracks,t=void 0,(i.video&&delete i.video,t=i.audio)&&(t.levelCodec=t.codec,t.id=n.id,this.hls.trigger(f.a.BUFFER_CODECS,i),u.b.log("audio track:audio,container:"+t.container+",codecs[level/parsed]=["+t.levelCodec+"/"+t.codec+"]"),o=t.initSegment,o&&(s={type:"audio",data:o,parent:"audio",content:"initSegment"},this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(f.a.BUFFER_APPENDING,s))),this.tick()))},t.prototype.onFragParsingData=function(n){var s=this,t=this.fragCurrent,y=n.frag,v,i;if(t&&"audio"===n.id&&"audio"===n.type&&y.sn===t.sn&&y.level===t.level&&this.state===r.PARSING){var l=this.trackId,w=this.tracks[l],o=this.hls;Object(h.a)(n.endPTS)||(n.endPTS=n.startPTS+t.duration,n.endDTS=n.startDTS+t.duration);t.addElementaryStream(g.a.ElementaryStreamTypes.AUDIO);u.b.log("parsed "+n.type+",PTS:["+n.startPTS.toFixed(3)+","+n.endPTS.toFixed(3)+"],DTS:["+n.startDTS.toFixed(3)+"/"+n.endDTS.toFixed(3)+"],nb:"+n.nb);c.c(w.details,t,n.startPTS,n.endPTS);var b=this.audioSwitch,a=this.media,p=!1;if(b&&a&&(a.readyState?(v=a.currentTime,u.b.log("switching audio track : currentTime:"+v),v>=n.startPTS&&(u.b.log("switching audio track : flushing all audio"),this.state=r.BUFFER_FLUSHING,o.trigger(f.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),p=!0,this.audioSwitch=!1,o.trigger(f.a.AUDIO_TRACK_SWITCHED,{id:l}))):(this.audioSwitch=!1,o.trigger(f.a.AUDIO_TRACK_SWITCHED,{id:l}))),i=this.pendingData,!i)return u.b.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void o.trigger(f.a.ERROR,{type:e.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([n.data1,n.data2].fta"})}),!p&&i.length&&(i.fG,n))}),this.pendingData=[],this.appended=!0));this.tick()}},t.prototype.onFraged())},t.prototype.onBuffeta=!1},t.prototype.onBufferCreated=function(n){var t=n.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0);n.tracks.video&&(this.videoBuffer=n.tracks.video.buffer)},t.prototype.onBufferAppended=function(n){if("audio"===n.parent){var t=this.state;t!==r.PARSING&&t!==r.PARSED||(this.pendingBuffering=n.pending>0,this._checkAppendedParsed())}},t.prototype._checkAppendedParsed=function(){var e;if(!(this.state!==r.PARSED||this.appended&&this.pendingBuffering)){var n=this.fragCurrent,t=this.stats,i=this.hls;n&&(this.fragPrevious=n,t.tbuffered=o.now(),i.trigger(f.a.FRAG_BUFFERED,{stats:t,frag:n,id:"audio"}),e=this.mediaBuffer?this.mediaBuffer:this.media,u.b.log("audio buffered : "+w.a.toString(e.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(f.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=r.IDLE);this.tick()}},t.prototype.onError=function(n){var y=n.frag,l,t,h,a,c,v,i;if(!y||"audio"===y.type)switch(n.details){case e.a.FRAG_LOAD_ERROR:case e.a.FRAG_LOAD_TIMEOUT:if(l=n.frag,l&&"audio"!==l.type)break;n.fatal||(t=this.fragLoadError,t?t++:t=1,h=this.config,t<=h.fragLoadingMaxRetry?(this.fragLoadError=t,a=Math.min(Math.pow(2,t-1)*h.fragLoadingRetryDelay,h.fragLoadingMaxRetryTimeout),u.b.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=o.now()+a,this.state=r.FRAG_LOADING_WAITING_RETRY):(u.b.error("AudioStreamController: "+n.details+" reaches max retry, redispatch as fatal ..."),n.fatal=!0,this.state=r.ERROR));break;case e.a.AUDIO_TRACK_LOAD_ERROR:case e.a.AUDIO_TRACK_LOAD_TIMEOUT:case e.a.KEY_LOAD_ERROR:case e.a.KEY_LOAD_TIMEOUT:this.state!==r.ERROR&&(this.state=n.fatal?r.ERROR:r.IDLE,u.b.warn("AudioStreamController: "+n.details+" while loading frag, now switching to "+this.state+" state ..."));break;case e.a.BUFFER_FULL_ERROR:"audio"===n.parent&&(this.state===r.PARSING||this.state===r.PARSED)&&(c=this.mediaBuffer,v=this.media.currentTime,c&&s.a.isBuffered(c,v)&&s.a.isBuffered(c,v+.5)?(i=this.config,i.maxMaxBufferLength>=i.maxBufferLength&&(i.maxMaxBufferLength/=2,u.b.warn("AudioStreamController: reduce max buffer length to "+i.maxMaxBufferLength+"s")),this.state=r.IDLE):(u.b.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=r.BUFFER_FLUSHING,this.hls.trigger(f.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})))}},t.prototype.onBufferFck())},nt(t,[{key:"state",set:function(n){if(this.state!==n){var t=this.state;this._state=n;u.b.log("audio stream:"+t+"->"+n)}},get:function(){return this._state}}]),t}(k.a);t.a=it},function(n,t,i){"use strict";function r(n,t,i,r){for(var h,e=void 0,s=void 0,c=void 0,o=void 0,l=void 0,a=window.VTTCue||window.TextTrackCue,f=0;f<r.rows.length;f++)if(e=r.rows[f],c=!0,o=0,l="",!e.isEmpty()){for(h=0;h<e.chars.length;h++)e.chars[h].uchar.match(/\s/)&&c?o++:(l+=e.chars[h].uchar,c=!1);e.cueStartTime=t;t===i&&(i+=.0001);s=new a(t,i,Object(u.b)(l.trim()));o>=16?o--:o++;s.line=navigator.userAgent.match(/Firefox\//)?f+1:f>7?f-2:f+1;s.align="left";s.position=Math.max(0,Math.min(100,o/32*100+(navigator.userAgent.match(/Firefox\//)?50:0)));n.addCue(s)}}Object.defineProperty(t,"__esModule",{value:!0});t.newCue=r;var u=i(28)},function(n,t){"use strict";t.a=function(){function r(n){return"string"==typeof n&&!!f[n.toLowerCase()]&&n.toLowerrn n}function i(i,f,e){var o=gent)}(),s={};h?o=document.createElement("custom"):s.enumerable=!0;o.hasBeenReset=!1;var c="",l=!1,a=i,v=f,y=e,p=null,w="",b=!0,k="auto",d="start",g=50,nt="middle",tt=50,it="middle";if(Object.defineProperty(o,"id",n({},s,{get:function(){return =""+n}})),Object.defineProperty(o,"pauseOnExit",n({},s,{get:function(){return l=!!n}})),Object.defineProperty(o,"startTime",n({},s,{get:function(){return a},set:function(n){if("number"!=typeof n)throw new TypeError("Start time must be set to a number.");a=n;this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",n({},s,{get:function(){return et=!0}})),Object.defineProperty(o,"text",n({},s,{get:function(){return et=!0}})),Object.defineProperty(o,"region",n({},s,{get:function(){return et=!0}})),Object.defineProperty(o,"vertical",n({},s,{get:function(){return et=!0}})),Object.defineProperty(o,"snapToLines",n({},s,{get:function(){return et=!0}})),Object.defineProperty(o,"line",n({},s,{get:function(){return et=!0}})),Object.defineProperty(o,"lineAlign",n({},s,{get:function(){return d},set:function(n){var i=t(n);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");d=i;this.hasBeenReset=!0}})),Object.defineProperty(o,"position",n({},s,{get:function(){return g},set:function(n){if(n<0||n>100)throw new Error("Position must be between 0 and 100.");g=n;this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",n({},s,{get:function(){return nt},set:function(n){var i=t(n);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");nt=i;this.hasBeenReset=!0}})),Object.defineProperty(o,"size",n({},s,{get:function(){return tet=!0}})),Object.defineProperty(o,"align",n({},s,{get:function(){return iet=!0}})),o.displayState=void 0,h)return o}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var u="auto",f={"":!0,lr:!0,rl:!0},e={start:!0,middle:!0,end:!0,left:!0,right:!0};return i.prototype.getCuetext)},i}()},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function h(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__protn,i)}var r=i(1),f=i(4),a=i(68),e=i(69),v=i(70),y=i(0),u=i(27),p=function(n){function t(i){var u,f,h;return o(this,t),u=s(this,n.call(this,i,r.a.MEDIA_ATTACHING,r.a.MEDIA_DETACHING,r.a.FRAG_PARSING_USERDATA,r.a.FRAG_DECRYPTED,r.a.MANIFEST_LOADING,r.a.MANIFEST_LOADED,r.a.FRAG_LOADED,r.a.LEVEL_SWITCHING,r.a.INIT_PTS_FOUND)),(u.hls=i,u.config=i.config,u.enabled=!0,u.Cues=i.config.cueHandler,u.textTracks=[],u.tracks=[],u.unparsedVttFrags=[],u.initPTS=void 0,u.cueRanges=[],u.captionsTracks={},u.captionsProperties={textTrack1:{label:u.config.captionsTextTrack1Label,languageCode:u.config.captionsTextTrack1LanguageCode},textTrack2:{label:u.config.captionsTextTrack2Label,languageCode:u.config.captionsTextTrack2LanguageCode}},u.config.enableCEA708Captions)&&(f=new e.a(u,"textTrack1"),h=new e.a(u,"textTrack2"),u.cea608Parser=new a.a(0,f,h)),u}return h(t,n),t.prototype.addCues=function(n,t,i,r){for(var u,e,f=this.cueRanges,o=!1,s=f.length;s--;)if(u=f[s],e=l(u[0],u[1],t,i),e>=0&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],i),o=!0,e/(i-t)>.5))return;o||f.push([t,i]);this.Cues.newCue(this.captionsTracks[n],t,i,r)},t.prototype.onInitPtsFound=function(n){var t=this;void 0===this.initPTS&&(this.initPTS=n.initPTS);this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(n){t.onFragLoaded(n)}),this.unparsedVttFrags=[])},t.prototype.getExistingTrack=function(n){var i=this.media,t,r;if(i)for(t=0;t<i.textTracks.length;t++)if(r=i.textTracks[t],r[n])return r;return null},t.prototype.createCaptionsTrack=function(n){var f=this.captionsProperties[n],e=f.label,o=f.languageCode,t=this.captionsTracks,r,i;t[n]||(r=this.getExistingTrack(n),r?(t[n]=r,Object(u.a)(t[n]),Object(u.b)(t[n],this.media)):(i=this.createTextTrack("captions",e,o),i&&(i[n]=!0,t[n]=i)))},t.prototype.createTex,t,i)},t.prototype.destroy=function(){f.a.prototype.destroy.call(this)},t.prototype.onMediaAttcks()},t.prototype.onMediaDetaching=function(){var n=this.captionsTracks;Object.keys(n).f n[t]})},t.prototype.onManifestLoading=function(){this.lastSn=-1;this.prevCC=-1;this.vttCCs={ccOffset:0,presentationOffset:0};this._cleanTracks()},t.prototype._cleanTracks=function(){var i=this.media,n,t;if(i&&(n=i.textTracks,n))for(t=0;t<n.length;t++)Object(u.a)(n[t])},t.prototype.onManifestLoaded=function(n){var t=this,i;(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT)&&(this.tracks=n.subtitles||[],i=this.media?this.media.textTracks:[],this.tracks.forEach(function(n,r){var u=void 0,f;r<i.length&&(f=i[r],c(f,n)&&(u=f));u||(u=t.createTextTrack("subtitles",n.name,n.lang));u.mode=n.default?t.hls.subtitleDisplay?"showing":"hidden":"disabled";t.textTracks.push(u)}))},t.prototype.onLevelSwitions},t.prototype.onFragLoaded=function(n){var t=n.frag,e=n.payload,u,f,i;if("main"===t.type)u=t.sn,u!==this.lastSn+1&&(f=this.cea608Parser,f&&f.reset()),this.lastSn=u;else if("subtitle"===t.type)if(e.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(n);i=t.decryptdata;null!=i&&null!=i.key&&"AES-128"===i.method||this._parseVTTs(t,e)}else this.hls.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},t.prototype._parseVTTs=function(n,t){var u=this.vttCCs,f,i;u[n.cc]||(u[n.cc]={start:n.start,prevCC:this.prevCC,"new":!0},this.prevCC=n.cc);f=this.textTracks;i=this.hls;v.a.parse(t,this.initPTS,u,n.cc,function(t){var u=f[n.trackId];if("disabled"===u.mode)return void i.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n});t.forEach(function(n){if(!u.cues.getCueById(n.id))try{u.addCue(n)}catch(i){var t=new window.TextTrackCue(n.startTime,n.endTime,n.text);t.id=n.id;u.addCue(t)}});i.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},function(t){y.b.log("Failed to parse VTT cue: "+t);i.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n})})},t.prototype.onFragDect,i)}},t.prototype.onFragParsingUserdata=function(n){var t,i;if(this.enabled&&this.config.enableCEA708Captions)for(t=0;t<n.samples.length;t++)i=this.extractCea608Data(n.samples[t].bytes),this.cea608Parser.addData(n.samples[t].pts,i)},t.prototype.extractCea6urn f},t}(f.a);t.a=p},function(n,t){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var s={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9de(t)},r=15,u=100,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},v={17:2,18:4,21:6,22:8,23:10,19:13,20:15},y={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},p={25:2,26:4,29:6,30:8,31:10,27:13,28:15},w=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],i={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(n){this.time=n},log:function(n){this.verboseFilter[n];this.verboseLevurn i},c=function(){function n(t,i,r,u,f){e(this,n);this.foreground=t||"white";this.underline=i||!1;this.italics=r||!1;this.background=u||"black";this.flash=f||!1}return n.prototypesh=!1},n.prototype.setStyles=function(n){for(var i,r=["foreground","underline","italics","background","flash"],t=0;t<r.length;t++)i=r[t],n.hasOwnProperty(i)&&(this[i]=n[i])},n.prototype.isDflash},n.prototype.flash},n.prototypflash},n.prototype.toflash},n}(),b=function(){function n(t,i,r,u,f,o){e(this,n);this.uchar=t||" ";this.penState=new c(i,r,u,f,o)}return n.prototypeset()},n.prototype.spy(t)},n.prototype.setPenState=function(n){this.penState.copy(n)},n.prototype.tate)},n.prototyptate)},n.prototype.iult()},n}(),k=function(){function n(){e(this,n);this.chars=[];for(var t=0;t<u;t++)this.chars.push(new b);this.pos=0;this.currPenState=new c}return n.prototype.equals=function(n){for(var i=!0,t=0;t<u;t++)if(!this.chars[t].equals(n.chars[t])){i=!1;break}return i},n.prototype.copy=function(n){for(var t=0;t<u;t++)this.chars[t].copy(n.chars[t])},n.prototype.isEmpty=function(){for(var t=!0,n=0;n<u;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t},n.prototype.setCursor=function(n){this.pos!==n&&(this.pos=n);this.pos<0?(i.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>u&&(i.log("ERROR","Too large cursor position "+this.pos),this.pos=u)},n.prototype.moveCursor=function(n){var i=this.pos+n,t;if(n>1)for(t=this.pos+1;t<i+1;t++)this.chars[t].setPenState(this.currPenState);this.setCursor(i)},n.prototype.bactate)},n.prototype.insertChar=function(n){n>=144&&this.backSpace();var t=h(n);if(this.pos>=u)return void i.log("ERROR","Cannot insert "+n.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");this.chars[this.pos].setChar(t,this.currPenState);this.moveCursor(1)},n.prototype.clearFromPos=function(n){for(var t=void 0,t=n;t<u;t++)this.chars[t].reset()},n.prototypeset()},n.prototype.clearToEn.pos)},n.prototype.getTextString=function(){for(var t,i=[],r=!0,n=0;n<u;n++)t=this.chars[n].uchar," "!==t&&(r=!1),i.push(t);return r?"":i.join("")},n.prototype.setPentate)},n}(),o=function(){function n(){e(this,n);this.rows=[];for(var t=0;t<r;t++)this.rows.push(new k);this.currRow=r-1;this.nrRollUpRows=null;this.reset()}return n.prototypew=r-1},n.prototype.urn i},n.prototyps[t])},n.prototype.iurn t},n.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},n.prototype.clearToEnRow()},n.prototype.insertChar=function(n){this.rows[this.currRow].insertChar(n)},n.prototype.setPen=function(n){this.rows[this.currRow].setPenStyles(n)},n.prototype.moveor(n)},n.prototype.setCursor=function(n){i.log("INFO","setCursor: "+n);this.rows[this.currRow].setCursor(n)},n.prototype.setPAC=function(n){var t,f,o,e,s,u,h,c,l,a;if(i.log("INFO","pacData = "+JSON.stringify(n)),t=n.row-1,this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(f=0;f<r;f++)this.rows[f].clear();if(o=this.currRow+1-this.nrRollUpRows,e=this.lastOutputScreen,e&&(s=e.rows[o].cueStartTime,s&&s<i.time))for(u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(e.rows[o+u])}this.currRow=t;h=this.rows[this.currRow];null!==n.indent&&(c=n.indent,l=Math.max(c-1,0),h.setCursor(n.indent),n.color=h.chars[l].penState.foreground);a={foreground:n.color,underline:n.underline,italics:n.italics,background:"black",flash:!1};this.setPen(a)},n.prototype.setBkgData=function(n){i.log("INFO","bkgData = "+JSON.stringify(n));this.backSpace();this.setPen(n);this.insertChar(32)},n.prototype.setRollUpRows=function(n){this.nrRollUpRows=n},n.prototype.rollUp=function(){if(null===this.nrRollUpRows)return void i.log("DEBUG","roll_up but nrRollUpRows not set yet");i.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,n=this.rows.splice(t,1)[0];n.clear();this.rows.splice(this.currRow,0,n);i.log("INFO","Rolling up")},n.prototype.getDisplayText=function(n){var u;n=n||!1;for(var t=[],f="",e=-1,i=0;i<r;i++)u=this.rows[i].getTextString(),u&&(e=i+1,n?t.push("Row "+e+": '"+u+"'"):t.push(u.trim()));return t.length>0&&(f=n?"["+t.join(" | ")+"]":t.join("\n")),f},n.prototype.getTextAndFormat=function(){return this.rows},n}(),l=function(){function n(t,i){e(this,n);this.chNr=t;this.outputFilter=i;this.mode=null;this.verbose=0;this.displayedMemory=new o;this.nonDisplayedMemory=new o;this.lastOutputScreen=new o;this.currRollUpRow=this.displayedMemory.rows[r-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null}return n.prototype.reset=function(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.currRollUpRow=this.displayedMemory.rows[r-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null;this.lastCueEndTime=null},n.prototype.getHandler=function(){return this.outputFilter},n.prototype.setHandler=function(n){this.outputFilter=n},n.prototype.setPAC=function(n){this.writeScreen.setPAC(n)},n.prototype.setBkgData=function(n){this.writeScreen.setBkgData(n)},n.prototype.sde=n)},n.prototype.insertChars=function(n){for(var r,t=0;t<n.length;t++)this.writeScreen.insertChar(n[t]);r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";i.log("INFO",r+": "+this.writeScreen.getDisplayText(!0));"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(i.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},n.prototype.ccRCL=function(){i.log("INFO","RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")},n.prototype.ccBS=function(){i.log("INFO","BS - BackSpace");"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},n.prototype.ccAOF=function(){},n.prototype.ccAON=function(){},n.prototype.ccDER=function(){i.log("INFO","DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()},n.prototype.ccRU=function(n){i.log("INFO","RU("+n+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(n)},n.prototype.ccFON=function(){i.log("INFO","FON - Flash On");this.writeScreen.setPen({flash:!0})},n.prototype.ccRDC=function(){i.log("INFO","RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")},n.prototype.ccTR=function(){i.log("INFO","TR");this.setMode("MODE_TEXT")},n.prototype.ccRTD=function(){i.log("INFO","RTD");this.setMode("MODE_TEXT")},n.prototype.ccEDM=function(){i.log("INFO","EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(!0)},n.prototype.ccCR=function(){i.log("CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(!0)},n.prototype.ccENM=function(){i.log("INFO","ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()},n.prototype.ccEOC=function(){if(i.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var n=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.nonDisplayedMemory=n;this.writeScreen=this.nonDisplayedMemory;i.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},n.prototype.ccTO=function(n){i.log("INFO","TO("+n+") - Tab Offset");this.writeScreen.moveCursor(n)},n.prototype.ccMIDROW=function(n){var t={flash:!1},r,u;(t.underline=n%2==1,t.italics=n>=46,t.italics)?t.foreground="white":(r=Math.floor(n/2)-16,u=["white","green","blue","cyan","red","yellow","magenta"],t.foreground=u[r]);i.log("INFO","MIDROW: "+JSON.stringify(t));this.writeScreen.setPen(t)},n.prototype.outputDataory))},n.prototype.cueSplite=n))},n}(),d=function(){function n(t,i,r){e(this,n);this.field=t||1;this.outputs=[i,r];this.channels=[new l(1,i),new l(2,r)];this.currChNr=-1;this.lastCmdA=null;this.lastCmdB=null;this.bufferedData=[];this.startTime=null;this.lastTime=null;this.dataCounters={padding:0,char:0,cmd:0,other:0}}return n.prototype.getHler()},n.prototype.setHer(t)},n.prototype.addData=function(n,t){var r=void 0,u=void 0,e=void 0,s=!1,o,h;for(this.lastTime=n,i.setTime(n),o=0;o<t.length;o+=2)(u=127&t[o],e=127&t[o+1],0!==u||0!==e)?((i.log("DATA","["+f([t[o],t[o+1]])+"] -> ("+f([u,e])+")"),r=this.parseCmd(u,e),r||(r=this.parseMidrow(u,e)),r||(r=this.parsePAC(u,e)),r||(r=this.parseBackgroundAttributes(u,e)),!r&&(s=this.parseChars(u,e)))&&(this.currChNr&&this.currChNr>=0?(h=this.channels[this.currChNr-1],h.insertChars(s)):i.log("WARNING","No channel found yet. TEXT-MODE?")),r?this.dataCounters.cmd+=2:s?this.dataCounters.char+=2:(this.dataCounters.other+=2,i.log("WARNING","Couldn't parse cleaned data "+f([u,e])+" orig: "+f([t[o],t[o+1]])))):this.dataCounters.padding+=2},n.prototype.parseCmd=function(n,t){var u=null,e=(20===n||28===n)&&t>=32&&t<=47,o=(23===n||31===n)&&t>=33&&t<=35,r;return!e&&!o?!1:n===this.lastCmdA&&t===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,i.log("DEBUG","Repeated command ("+f([n,t])+") is dropped"),!0):(u=20===n||23===n?1:2,r=this.channels[u-1],20===n||28===n?32===t?r.ccRCL():33===t?r.ccBS():34===t?r.ccAOF():35===t?r.ccAON():36===t?r.ccDER():37===t?r.ccRU(2):38===t?r.ccRU(3):39===t?r.ccRU(4):40===t?r.ccFON():41===t?r.ccRDC():42===t?r.ccTR():43===t?r.ccRTD():44===t?r.ccEDM():45===t?r.ccCR():46===t?r.ccENM():47===t&&r.ccEOC():r.ccTO(t-32),this.lastCmdA=n,this.lastCmdB=t,this.currChNr=u,!0)},n.prototype.parseMidrow=function(n,t){var r=null;return(17===n||25===n)&&t>=32&&t<=47?(r=17===n?1:2)!==this.currChNr?(i.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[r-1].ccMIDROW(t),i.log("DEBUG","MIDROW ("+f([n,t])+")"),!0):!1},n.prototype.parsePAC=function(n,t){var i=null,r=null,f=(n>=17&&n<=23||n>=25&&n<=31)&&t>=64&&t<=127,e=(16===n||24===n)&&t>=64&&t<=95,u;return!f&&!e?!1:n===this.lastCmdA&&t===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,!0):(i=n<=23?1:2,r=t>=64&&t<=95?1===i?a[n]:y[n]:1===i?v[n]:p[n],u=this.interpretPAC(r,t),this.channels[i-1].setPAC(u),this.lastCmdA=n,this.lastCmdB=t,this.currChNr=i,!0)},n.prototype.interp/2),r},n.prototype.parseChars=function(n,t){var o=null,u=null,r=null,e,s;return(n>=25?(o=2,r=n-8):(o=1,r=n),r>=17&&r<=19)?(e=t,e=17===r?t+80:18===r?t+112:t+144,i.log("INFO","Special char '"+h(e)+"' in channel "+o),u=[e]):n>=32&&n<=127&&(u=0===t?[n]:[n,t]),u&&(s=f(u),i.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null),u},n.prototype.parseBackgroundAttrl,!0)},n.prototype.reset=function(){for(var n=0;n<this.channels.length;n++)this.channels[n]&&this.channels[n].reset();this.lastCmdA=null;this.lastCmdB=null},n.prototype.cueSplitme(n)},n}();t.a=d},function(n,t){"use strict";function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r=function(){function n(t,r){i(this,n);this.timelineController=t;this.trackName=r;this.startTime=null;this.endTime=null;this.screen=null}return n.prototype.dispanull)},n.prototype.Name)},n}();t.a=r},function(n,t,i){"use strict";var r=i(3),e=i(28),o=)=f)inset=i},c={parse:function(n,t,i,r,c,l){var g=Object(o.b)(new Uint8Array(n)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),k="00:00.000",w=0,a=0,p=0,d=[],v=void 0,b=!0,y=new e.a;y.oncue=function(n){var u=i[r],t=i.ccOffset;u&&u.new&&(void 0!==a?t=i.ccOffset=u.start:h(i,r,p));p&&(t=p+i.ccOffset-i.presentationOffset);n.startTime+=t-a;n.endTime+=t-a;n.id=f(n.startTime.toString())+f(n.endTime.toString())+f(n.text);n.text=decodeURIComponent(encodeURIComponent(n.text));n.endTime>0&&d.push(n)};y.onparsin){v=n};y.o;c(d)};g.forEach(function(n){if(b){if(u(n,"X-TIMESTAMP-MAP=")){b=!1;n.substr(16).split(",").f(7)))});try{t=t<0?t+8589934592:t;w-=t;a=s(k)/1e3;p=w/9e4;-1===a&&(v=new Error("Malformed X-TIMESTAMP-MAP: "+n))}catch(t){v=new Error("Malformed X-TIMESTAMP-MAP: "+n)}return}""===n&&(b=!1)}y.parse(n+"\n")});y.flush()}};t.a=c},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function h(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proturn i}var r=i(1),e=i(4),u=i(0),c=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=funct=!0,u}return h(t,n),t.prototype._onTextTracksCck=t}},t.prototype.dthis)},t.prototype.onMediaAttached=function(n){var t=this;this.media=n.media;this.media&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},t.prototype.onMediaDetnull)},t.prototype.onManifestLId=-1},t.prototype.onManifestLoaded=function(n){var t=this,i=n.subtitles||[];this.tracks=i;this.trackId=-1;this.hls.trigger(r.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i});i.fn.id)})},t.prototype.onTick=function(){var n=this.trackId,t=this.tracks[n],i;t&&(i=t.details,i&&!i.live||(u.b.log("(re)loading playlist for subtitle track "+n),this.hls.trigger(r.a.SUBTITLE_TRACK_LOADING,{url:t.url,id:n})))},t.prototype.onSubtitleTracker())},t.prototype.setSubtitleTrackInternal=function(n){var f=this.hls,e=this.tracks,t,i;"number"!=typeof n||n<-1||n>=e.length||(this._stopTimer(),this.trackId=n,u.b.log("switching to subtitle track "+n),f.trigger(r.a.SUBTITLE_TRACK_SWITCH,{id:n}),-1===n)||(t=e[n],i=t.details,i&&!i.live||(u.b.log("(re)loading playlist for subtitle track "+n),f.trigger(r.a.SUBTITLE_TRACK_LOADING,{url:t.url,id:n})))},t.prototype._stonull)},t.prototype._toggleTrackModes=function(n){var u=this.media,e=this.subtitleDisplay,o=this.trackId,t,i,r;u&&(t=f(u.textTracks),-1===n?[].slice.call(t).fbled"}):(i=t[o],i&&(i.mode="disabled")),r=t[n],r&&(r.mode=e?"showing":"hidden"))},c(t,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackIl(n))}}]),t}(e.a);t.a=l},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function h(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var r=i(1),f=i(0),c=i(14),l=i(10),a=window,e=a.performance,u={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING"},v=functig),f}return h(t,n),t.prototype.onHandlerDestroyed=function(){this.state=u.STOPPED},t.prototype.clearVttFragQueues=function(){var n=this;this.vttFragQueues={};this.tracks.forEach(function(t){n.vttFragQueues[t.id]=[]})},t.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var n=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=n;this.hls.trigger(r.a.FRAG_LOADING,{frag:n});this.state=u.FRAG_LOADING}},t.prototype.onSubtitleFragProcessed=function(n){n.success&&this.vttFragSNsProcessed[n.frag.trackId].push(n.frag.sn);this.currentlyProcessing=null;this.state=u.IDLE;this.nextFrag()},t.prototype.onMediaAt.IDLE},t.prototype.oag())},t.prototype.doTick=function(){var t=this,e;switch(this.state){case u.IDLE:var i=this.tracks,n=this.currentTrackId,s=this.vttFragSNsProcessed[n],o=this.vttFragQueues[n],h=this.currentlyProcessing?this.currentlyProcessing.sn).sn})};if(!i)break;if(n<i.length&&(e=i[n].details),void 0===e)break;e.fragments.fg()))})}},t.prototype.onSubtitleTracksUpdated=function(n){var t=this;f.b.log("subtitle tracks updated");this.tracks=n.subtitleTracks;this.clearVttFragQueues();this.vttFragSNsProcessed={};this.tracks.fd]=[]})},t.prototype.onSubtitleTrackck()}},t.prototype.onSubtitleTrackick()},t.prototype.onKeyLoaded=function(){this.state===u.KEY_LOADING&&(this.state=u.IDLE,this.tick())},t.prototype.onFragLoaded=function(n){var f=this.fragCurrent,t=n.frag.decryptdata,o=n.frag,s=this.hls,i;if(this.state===u.FRAG_LOADING&&f&&"subtitle"===n.frag.type&&f.sn===n.frag.sn&&n.payload.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){i=void 0;try{i=e.now()}catch(n){i=Date.now()}this.decrypter.decrypt(n.payload,t.key.buffer,t.iv.:t}})})}},t}(l.a);t.a=v},function(n,t,i){"use strict";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function s(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function h(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var c=i(4),f=i(1),u=i(2),r=i(0),l=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),a=window,v=a.XMLHttpRequest,e={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playrea),+n);}},w=functt=0,r}return h(t,n),t.prototype.getLicenseSer})),t},t.prototype._attemptKeySystemAccess=function(n,t,i){var f=this,u=p(n,0,i);if(!u)return void r.b.warn("Can not create config for key-system (maybe because platform is not supported):",n);r.b.log("Requesting encrypted media key-system access");this.requestMediaKeySystemAccess(n,u(n,t)}):',t)})},t.prototype._onMediaKeySystemAccessObtained=function(n,t){var u=this,i;r.b.log('Access for key-system "'+n+'" obtained');i={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:n};this._mediaKeysList.push(i);t.createMediaKeys().then(function(t){i.mediaKeys=t;r.b.log('Media-keys created for key-system "'+n+'"');u._onMediaKeysCreated()}):",n)})},t.prototype._onMediaKeysCn))})},t.prototype._onNewMediaKeyS},!1)},t.prototype._onKeySessionMessage=function(n,t){r.b.log("Got EME message event, creating license request");this._requestLicte(t)})},t.prototype._onMediaEncrypted=function(n,t){r.b.log('Media is encrypted using "'+n+'" init data type');this._isMediaEncrypted=!0;this._mediaEncryptionInitDataType=n;this._mediaEncryptionInitData=t;this._attemptSetMediaKeys();this._generateRequestWithPreferredKeySession()},t.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var n=this._mediaKeysList[0];if(!n||!n.mediaKeys)return r.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(f.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_KEYS,fatal:!0});r.b.log("Setting keys for encrypted media");this._media.setMediaKeys(n.mediaKeys);this._hasSetMediaKeys=!0}},t.prototype._generateRequestWithPreferredKeySession=function(){var o=this,n=this._mediaKeysList[0],t,i,e;if(!n)return r.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(f.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(n.mediaKeysSessionInitialized)return void r.b.warn("Key-Session already initialized but requested again");t=n.mediaKeysSession;t||(r.b.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(f.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_SESSION,fatal:!0}));i=this._mediaEncryptionInitDataType;e=this._mediaEncryptionInitData;r.b.log('Generating key-session request for "'+i+'" init data type');n.mediaKeysSessionInitialized=!0;t.generateRequest(i,eded")}):!1})})},t.prototype._createLicenseXhr=function(n,t,i){var e=new v,o=this._licenseXhrSetup;try{if(o)try{o(e,n)}catch(t){e.open("POST",n,!0);o(e,n)}e.readyState||e.open("POST",n,!0)}catch(n){return r.b.error("Error setting up key-system license XHR",n),void this.hls.trigger(f.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return e.responseType="arraybuffer",e.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,e,n,t,i),e},t.prototype._onLicenseRequestReadyStageChange=function(n,t,i,e){switch(n.readyState){case 4:if(200===n.status)this._requestLicenseFailureCount=0,r.b.log("License request succeeded"),e(n.response);else{if(r.b.error("License Request XHR failed ("+t+"). Status: "+n.status+" ("+n.statusText+")"),++this._requestLicenseFailureCount<=3){var o=4-this._requestLicenseFailureCount;return r.b.warn("Retrying license request, "+o+" attempts left"),void this._requestLicense(i,e)}this.hls.trigger(f.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},t.prototype._generateLicenseRequestChain),i},t.prototype._requestLicense=function(n,t){var i,e,o;if(r.b.log("Requesting content license for key-system"),i=this._mediaKeysList[0],!i)return r.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(f.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});e=this.getLicenseServerUrl(i.mediaKeySystemDomain);o=this._createLicenseXhr(e,n,t);r.b.log("Sending license request to URL: "+e);o.send(this._generateLicenseRequestChallenge(i,n))},t.prototype.onMediaAttached=function(n){var i=this,t;this._emeEnabled&&(t=n.media,this._media=t,t.addEventListener("encrData)}))},t.prototype.onManifestt,i)}},l(t,[{key:"requestMediaKeySystemAccesccess}}]),t}(c.a);t.a=w},function(n,t,i){"use strict";i.d(t,"a",function(){return r}):null}()},function(){
/*! http://mths.be/endswith v0.2.0 by @mathias */
String.prototype.endsWith||function(){"use strict"urn i}(),i={}.toString,t=function(n){var f,r,c,e,u;if(null==this)throw TypeError();if(f=String(this),n&&"[object RegExp]"==i.call(n))throw TypeError();var o=f.length,s=String(n),h=s.length,t=o;if(arguments.length>1&&(r=arguments[1],void 0!==r&&(t=r?Number(r):0)!=t&&(t=0)),c=Math.min(Math.max(t,0),o),e=c-h,e<0)return!1;for(u=-1;++u<h;)if(f.charCodeAt(e+u)!=s.charCodeAt(u))return!1;return!0};n?n(String.prototype,"endsWith",{value:t,configurable:!0,writable:!0}):String.prototype.endsWith=t}()}]).default});wt=this.Hls}catch(pi){}(function(n,t){"use strict";var rt="",nt="?",tt="function",b="undefined",d="object",ut="string",r="model",i="name",e="type",u="vendor",f="version",l="architecture",p="console",o="mobile",s="tablet",k="smarttv",g="wearable",a={extend:function(n,t){for(var i in t)"browser cpu device engine os".indexOf(i)!==-1&&t[i].length%2==0&&(n[i]=t[i].concat(n[i]));return -1:!1},lowerize:function(n){return n.toLowerCase()}[0]:t}},c={rgx:function(){for(var r,o=0,s,l,u,n,e,i,h=arguments,c,f;o<h.length&&!e;){if(c=h[o],f=h[o+1],typeof r===b){r={};for(u in f)f.hasOwnProperty(u)&&(n=f[u],typeof n===d?r[n[0]]=t:r[n]=t)}for(s=l=0;s<c.length&&!e;)if(e=c[s++].exec(this.getUA()),!!e)for(u=0;u<f.length;u++)i=e[++l],n=f[u],typeof n===d&&n.length>0?n.length==2?r[n[0]]=typeof n[1]==tt?n[1].call(this,i):n[1]:n.length==3?r[n[0]]=typeof n[1]===tt&&(!n[1].exec||!n[1].test)?i?n[1].call(this,i,n[2]):t:i?i.replace(n[1],n[2]):t:n.length==4&&(r[n[0]]=i?n[3].call(this,i.replace(n[1],n[2])):t):r[n]=i?i:t;o+=2}return r},str:function(n,i){var r,u;for(r in i)if(typeof i[r]===d&&i[r].length>0){for(u=0;u<i[r].length;u++)if(a.has(i[r][u],n))return r===nt?t:r}else if(a.has(i[r],n))return r===nt?t:r;return n}},v={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},it={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[i,f],[/\s(opr)\/([\w\.]+)/i],[[i,"Opera"],f],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[i,f],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[i,"IE"],f],[/(edge)\/((\d+)?[\w\.]+)/i],[i,f],[/(yabrowser)\/([\w\.]+)/i],[[i,"Yandex"],f],[/(comodo_dragon)\/([\w\.]+)/i],[[i,/_/g," "],f],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[i,f],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/JUC.+(ucweb)[\/\s]?([\w\.]+)/i],[[i,"UCBrowser"],f],[/(dolfin)\/([\w\.]+)/i],[[i,"Dolphin"],f],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[i,"Chrome"],f],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[f,[i,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[f,[i,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[f,[i,"Facebook"]],[/fxios\/([\w\.-]+)/i],[f,[i,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[f,[i,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[f,i],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[i,[f,c.str,v.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[i,f],[/(navigator|netscape)\/([\w\.-]+)/i],[[i,"Netscape"],f],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[i,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[l,"amd64"]],[/(ia32(?=;))/i],[[l,a.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[l,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[l,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[l,/ower/,"",a.lowerize]],[/(sun4\w)[;\)]/i],[[l,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[l,a.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[r,u,[e,s]],[/applecoremedia\/[\w\.]+ \((ipad)/],[r,[u,"Apple"],[e,s]],[/(apple\s{0,1}tv)/i],[[r,"Apple TV"],[u,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,r,[e,s]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[r,[u,"Amazon"],[e,s]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[r,c.str,v.device.amazon.model],[u,"Amazon"],[e,o]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[r,u,[e,o]],[/\((ip[honed|\s\w*]+);/i],[r,[u,"Apple"],[e,o]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,r,[e,o]],[/\(bb10;\s(\w+)/i],[r,[u,"BlackBerry"],[e,o]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],[r,[u,"Asus"],[e,s]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[r,"Xperia Tablet"],[e,s]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[u,"Sony"],[r,"Xperia Phone"],[e,o]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[u,r,[e,p]],[/android.+;\s(shield)\sbuild/i],[r,[u,"Nvidia"],[e,p]],[/(playstation\s[34portablevi]+)/i],[r,[u,"Sony"],[e,p]],[/(sprint\s(\w+))/i],[[u,c.str,v.device.sprint.vendor],[r,c.str,v.device.sprint.model],[e,o]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,r,[e,s]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[r,/_/g," "],[e,o]],[/(nexus\s9)/i],[r,[u,"HTC"],[e,s]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[r,[u,"Microsoft"],[e,p]],[/(kin\.[onetw]{3})/i],[[r,/\./g," "],[u,"Microsoft"],[e,o]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s[6])/i],[r,[u,"Motorola"],[e,o]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[r,[u,"Motorola"],[e,s]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],r,[e,s]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],r,[e,o]],[/(samsung);smarttv/i],[u,r,[e,k]],[/\(dtv[\);].+(aquos)/i],[r,[u,"Sharp"],[e,k]],[/sie-(\w+)*/i],[r,[u,"Siemens"],[e,o]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],r,[e,o]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[r,[u,"Acer"],[e,s]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],r,[e,s]],[/(lg) netcast\.tv/i],[u,r,[e,k]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[r,[u,"LG"],[e,o]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[r,[u,"Lenovo"],[e,s]],[/linux;.+((jolla));/i],[u,r,[e,o]],[/((pebble))app\/[\d\.]+\s/i],[u,r,[e,g]],[/android.+;\s(glass)\s\d/i],[r,[u,"Google"],[e,g]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[[r,/_/g," "],[u,"Xiaomi"],[e,o]],[/\s(tablet)[;\/\s]/i,/\s(mobile)[;\/\s]/i],[[e,a.lowerize],u,r]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[f,[i,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[i,f],[/rv\:([\w\.]+).*(gecko)/i],[f,i]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[i,f],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[i,[f,c.str,v.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[i,"Windows"],[f,c.str,v.os.windows.version]],[/\((bb)(10);/i],[[i,"BlackBerry"],f],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[i,f],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[i,"Symbian"],f],[/\((series40);/i],[i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[i,"Firefox OS"],f],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[i,f],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[i,"Chromium OS"],f],[/(sunos)\s?([\w\.]+\d)*/i],[[i,"Solaris"],f],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[i,f],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[i,"iOS"],[f,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[i,"Mac OS"],[f,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[i,f]]},h=function(t,i){if(this instanceof h){var u=t||(n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:rt),r=i?a.extend(it,i):it;return this.getBon),n},this.getCPU=function(){return c.rgx.apply(this,r.cpu)},this.getDevice=function(){return c.rgx.apply(this,r.device)},this.getEngine=function(){return c.rgx.apply(this,r.engine)},thisr.os)},this.getPU()}},this.getUA=function(){return u},this,this},this.setUA(u),this}return new h(t,i).getResult()},y,w;h.VERSION="0.7.10";h.BROWSER={NAME:i,MAJOR:"major",VERSION:f};h.CPU={ARCHITECTURE:l};h.DEVICE={MODEL:r,VENDOR:u,TYPE:e,CONSOLE:p,MOBILE:o,SMARTTV:k,TABLET:s,WEARABLE:g,EMBEDDED:"embedded"};h.ENGINE={NAME:i,VERSION:f};h.OS={NAME:i,VERSION:f};typeof exports!==b?(typeof module!==b&&module.exports&&(exports=module.exports=h),exports.UAParser=h):n.UAParser=h;y=n.jQuery||n.Zepto;typeof y!==b&&(w=new h,y.ua=w.getResult(),y.tUA()},y.ua.set=function(n){var t,i;w.setUA(n);t=w.getResult();for(i in t)y.ua[i]=t[i]})})(typeof window=="object"?window:this);Array.prototype.findIndexOfNth||Object.defineProperty(Array.prototype,"findIndexOfNth",{value:function(n,t){var i,r;if(t<1)throw"N must be greater than 0";for(i=0;i<this.length;){if(r=this[i],n.call(window,r,i,this)&&(t--,t===0))return i;i++}return-1}});Array.prototype.forEach||(Array.prototype.forEach=function(n){var r,t,i,u,f;if(this==null)throw new TypeError("this is null or not defined");if(i=Object(this),u=i.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(r=arguments[1]),t=0;t<u;)t in i&&(f=i[t],n.call(r,f,t,i)),t++});Array.prototype.filter||(Array.prototype.filter=function(n){"use strict";var i,f,r,e,t,u;if(this===void 0||this===null)throw new TypeError;if(i=Object(this),f=i.length>>>0,typeof n!="function")throw new TypeError;for(r=[],e=arguments.length>=2?arguments[1]:void 0,t=0;t<f;t++)t in i&&(u=i[t],n.call(e,u,t,i)&&r.push(u));return r});Array.prototype.find||Object.defineProperty(Array.prototype,"find",fined}});Array.prototype.map||(Array.prototype.map=function(n){var f,r,t,i,u,e,o;if(this==null)throw new TypeError("this is null or not defined");if(i=Object(this),u=i.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(f=arguments[1]),r=new Array(u),t=0;t<u;)t in i&&(e=i[t],o=n.call(f,e,t,i),r[t]=o),t++;return r});Array.prototype.findIndex||(Array.prototype.findIndex=function(n){var t;if(this==null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof n!="function")throw new TypeError("predicate must be a function");var i=Object(this),u=i.length>>>0,f=arguments[1],r;for(t=0;t<u;t++)if(r=i[t],n.call(f,r,t,i))return t;return-1});Array.prototype.reduce||(Array.prototype.reduce=function(n){"use strict";if(this==null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof n!="function")throw new TypeError(n+" is not a function");var i=Object(this),u=i.length>>>0,t=0,r;if(arguments.length>=2)r=arguments[1];else{while(t<u&&!(t in i))t++;if(t>=u)throw new TypeError("Reduce of empty array with no initial value");r=i[t++]}for(;t<u;t++)t in i&&(r=n(r,i[t],t,i));return r});Function.prototype.bind||(Function.prototype.bind=function(n){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=Array.prototype.slice.call(arguments,1),u=this,t=functionts)))};return this.prototype&&(t.prototype=this.prototype),i.prototype=new t,i});Array.from||(Arra=f,s}}());t=function(){function n(){}return n.VideoAudioMode={audio:0,audioOnMouseOver:1,muted:2},n.OnClickVideoAdUnitMode={ReadMore:0,Scroll:1},n.ViewProgress={firstQuartile:1,midpoint:2,thirdQuartile:3,complete:4},n.MediaSourceType={Url:1,Image:2,Script:3,Html:4,Video:5,VideoTag:6,OnClickIFrame:7,HeaderBidding:8,Native:9},n.MediaSourceTypesFlags={None:0,Url:1,Image:2,Script:4,Html:8,Video:16,VideoTag:32,OnClickIFrame:64,HeaderBidding:128,Native:256},n.TrackingEventType={adFill:1,adView:2,infinityVolume:3,partnerVolume:4,headerBiddingVolume:5,videoAdPlayError:6},n.AdFillCheckStatus={skipped:1,failed:2,success:3},n.chromePopApproach={notification:0,notificationEx:1,tabUnder:2,tabOver:3,doublePop:4,hidden:5,mixed:6},n.RelativePlacementType={Inside:0,Before:1,After:2},n.CssTransitionTimingFunction={Linear:0,Ease:1,EaseIn:2,EaseOut:3,EaseInOut:4},n.VideoButtonDisplayMode={always:0,onHover:1,never:2},n.RelativeAlignment={Left:0,Right:1,Over:2},n}();i=funced=!1}return n.prototype.addHt:t})},n.prototype.removeHandler=function(n){if(n===undefined){this.removeAllHandlers();return}var t=this._handlers.finr===n});t!==-1&&this._handlers.splice(t,1)},n.prototype.getTriggered=function(){return this._triggered},n.prototype.removeAllHars=[]},n.prototype.trigger=function(n){for(var i,t=0;t<this._handlers.length;t++)i=this._handlers[t].callContext||this,this._handlers[t].handler.call(i,n);this._triggered=!0},n.prototype.triggerOnce=function(n){this._triggered||this.trigger(n)},n}();f.prototype={setOneTime:function(n){this._isOneTime=n},setThrottle:function(n){this._callInterval=n},setTimeout:function(n,t){if(this._timeout!=null)throw"Timeout cannot be changed";this._timeoutCallback=n;var i=this;this._timeout=setTimeout(function(){i._timeout=null;i._timeoutCallback&&i._disabled===!1&&(i._canceledByTimeout=!0,i._timeoutCallback.apply(i._context),i._timeoutCallback=null)},t)},setDisabled:function(n){this._disabled=n},getValue:function(){return this._value}};s=function(){function n(n,t){this._name=n;this._enableSendToServer=t.enableSendToServer?!0:!1;this._level=t.level||"Info"}return n.prototype.getName=function(){return this._name},n.prototype.getLevel=function(){return this._level},n.prototype.info=function(n){this._level==="Info"&&this._writeLog(this._name+" [INFO]: "+n)},n.prototype.dump=function(n,t){function r(n,t){return t&&typeof t=="string"&&t.length>100?t.substr(0,100)+"...":t}var i=this;this._level==="Info"&&(this.info(n),this._groupOutput(function(){i._writeLog(JSON.stringify(t,r,4))}))},n.prototype.error=function(n){(this._level==="Info"||this._level==="Error")&&this._writeError(this._name+" [ERROR]: "+n)},n.prototype._groupOutput=function(n){console.group?(console.group(),n(),console.groupEnd()):n()},n.prototype._writeError=function(n){console.error?console.error(n):(console.log(n),console.trace&&console.trace());this._enableSendToServer&&this._sendToServer(n)},n.prototype._writeLog=function(n){console.log(n);this._enableSendToServer&&this._sendToServer(n)},n.prototype._sendToServer=function(n){var t=new XMLHttpRequest;t.open("POST","//infinity.pub.com/log.aspx?msg="+encodeURIComponent(n));t.send("")},n}();v=function(){this._actions=[];this._onActionFailedEvent=new i;this._disposed=!1;this._activePromiseReject=null};v.prototype={addAction:function(n){this._actions.push(n)},onActionFailed:function(n){this._onActionFailedEvent.addHandler(n)},run:function(){function t(t){return function(i){return n._disposed?r.resolve():(n._onActionFailedEvent.trigger(i),n._actions[t]())}}if(this._disposed)return r.reject("Aborted");if(this._actions.length===0)return r.reject();var n=this;return new r(function(i,r){var u,f,e;for(n._activePromiseReject=r,u=null,f=0;f<n._actions.length;f++)u==null?u=n._actions[f]():(e=t(f),u=u.catch(e));u.then(function(t){n._activePromiseReject=null;n._disposed||i(t)},function(t){n._activePromiseReject=null;n._disposed||(n._onActionFailedEvent.trigger(t),r())})})},dispose:function(){this._disposed=!0;this._activePromiseReject&&(this._activePromiseReject("Aborted"),this._activePromiseReject=null);this._onActionFailedEvent.removeAllHandlers()}};bt=function(n){this._source=n};bt.prototype={toSchemaless:function(){if(this._source[0]==="/")return this._source;var n=this._source.indexOf("/");return n===0||n===-1?this._source:this._source.substring(n)}};d=funcn[t])}for(var i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=this;t.forEach(r)};h=function(n){this._element=n;this.raw=this._element};h.prototype={setAnimation:function(n){this._element.style["-webkit-transition"]=n;this._element.style["-moz-transition"]=n;this._element.style["-o-transition"]=n;this._element.style.transition=n},_getTransitionEndEventName:function(){var n={transition:"transitionend","-webkit-transition":"webkitTransitionEnd","-moz-transition":"transitionend","-o-transition":"otransitionend"},i=document.createElement("iframe");for(var t in n)if(typeof i.style[t]!="undefined")return n[t];return null},onceAnimationEnd:function(n,t,i){var r=this._getTransitionEndEventName(),u,f;if(r==null)setTimeout(i,t);else{u=this;f=function(t){t.propertyName===n&&t.target==u._element&&(i(),u.off(r,f))};this.on(r,f)}},triggerClick:function(){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,1,0,0,0,0,!1,!1,!1,!1,0,null);this._element.dispatchEvent(n)},setLeftPx:function(n){this._element.style.left=n+"px"},setTopPx:function(n){this._element.style.top=n+"px"},setWidth:function(n){this.isNumber(n)?this.setWidthPx(Math.round(n)):this._element.style.width=n},setWidthPx:function(n){this._element.style.width=n+"px"},getLeftPx:function(){return typeof this._element.style.left=="undefined"||this._element.style.left==null?null:this._element.style.left.replace("px","")},getTopPx:function(){return typeof this._element.style.top=="undefined"||this._element.style.top==null?null:this._element.style.top.replace("px","")},getWidthPx:function(){return typeof this._element.style.width=="undefined"||this._element.style.width==null?null:this._element.style.width.replace("px","")},getHeightPx:function(){return typeof this._element.style.height=="undefined"||this._element.style.height==null?null:this._element.style.height.replace("px","")},setHeight:function(n){this.isNumber(n)?this.setHeightPx(Math.round(n)):this._element.style.height=n},setHe+"px"},hide:function(){this._element.style.display="none"},on:function(n,t,i){if(this._element.addEventListener)this._element.addEventListener(n,t,i);else if(this._element.attachEvent)this._element.attachEvent("on"+n,t);else throw"Cannot add event. Browser is not supported";},off:function(n,t){if(this._element.removeEventListener)this._element.removeEventListener(n,t);else if(this._element.detachEvent)this._element.detachEvent("on"+n,t);else throw"Cannot remove event. Browser is not supported";},iste(n)}};y=function(n){this._document=n};y.prototype={insertStyle:function(n){var t=this._document.createElement("style"),i;t.type="text/css";t.innerHTML=n;i=this._document.querySelector("head");i.appendChild(t)}};var p=function(){function n(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];this._value=n;this._fallbackValues=[];i!=null&&(this._fallbackValues=i)}return n.prototype.addFallback=function(n){this._fallbackValues.push(n)},n.prototype.resolve=function(){return this._value==null?this._fallbackValue=null}):this._value},n}(),wi=function(){function n(){}return n.isPended},n}(),bi=func n(){}return n.isChildOf=function(n,t){for(var i=n;i!=null;){if(i===t)return!0;i=i.parentElement}return!1},n}(),kt=function(){function n(n){this._device=n.getDevice();this._os=n.getOS();this._browser=n.getBrowser()}return n.prototype.getScreenWidth=function(){return window.screen.width},n.prototype.getScreeneight},n.prototype.getWindowHeight=function(){var n=0;return typeof innerHeight=="number"?n=window.innerHeight:document.documentElement&&document.documentElement.clientHeight?n=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(n=document.body.clientHeight),n},n.prototype.getWindowWidth=function(){var n=0;return typeof innerWidth=="number"?n=window.innerWidth:document.documentElement&&document.documentElement.clientWidth?n=document.documentElement.clientWidth:document.body&&document.body.clientWidth&&(n=document.body.clientWidth),n},n.prototype.getVithis)},n.prototype.getBoundingClientRect=function(n){var i=this,t;return this._getBoundingClientRect||(t=parseInt(this._browser.major),this._getBoundingClientRect=this._os.name==="Android"&&(this._browser.name==="Chrome"||this._browser.name==="Chromium")&&t>=44&&t!==48?function(n){return i._getBoundingClientRectVisualViewpoect()}),this._getBoundingClientRect(n)},n.prototype._getBoundingClientRectVisualViewport=function(n){var r=window.top.pageYOffset,u=window.top.pageXOffset;window.visualViewport&&(r=window.visualViewport.pageTop,u=window.visualViewport.pageLeft);var o=window.top.document,t=o.documentElement.getBoundingClientRect(),f=t.top<0?t.top*-1:0,e=t.left<0?t.left*-1:0,i=n.getBoundingClientRect(),s=f+i.top,h=f+i.bottom,c=s-r,l=h-r,a=e+i.left,v=e+i.right,y=a-u,p=v-u;return Object.freeze({top:c,left:y,bottom:l,right:p})},n.prototype.getVideoForcedToPlayFullscreen=function(){var n=this._device.model==="iPhone";return n&&this.getOSVersion()<10},n.prototype.getTimeset()},n.prototype.getStdTimeOffset=function(){for(var r,i,u=(new Date).getFullYear(),n=null,t=0;t<12;t++)r=new Date(u,t,1),i=r.getTimezoneOffset(),n=n==null?i:Math.max(n,i);return n*-1},n.prototype.getIsDesktop=function(){return typeof this._device.type=="undefined"||this._device.type==="tablet"&&this._browser.name==="IE"&&/Tablet PC/.test(navigator.userAgent)},n.prototype.getIsMobileOrTabletSafari=function(){return!this.getIsDesktop()&&(this._browser.name==="Mobile Safari"||this._browser.name==="Safari")},n.prototype.getIsiOS=function(){return!this.getIsDesktop()&&this._os.name==="iOS"},n.prototype.getOSVersion=function(){return parseInt(this._os.version.split(".")[0])},n.prototype.getBrowserVajor)},n.prototype.getIsIE=function(){return this._browser.name==="IE"},n.prototype.getEdge"},n}(),si=funcnfo=n}return n.prototype.getOverflow=funct?t:n}var t=n.bottom-n.top,i=n.right-n.left,o=this.getSize(),s=u(r(n.top*-1),t),h=u(r(n.bottom-o.height),t),c=u(r(n.left*-1),i),l=u(r(n.right-o.width),i),f=s+h,e=c+l,a=f*i+e*t-f*e;return{offTop:s,offBottom:h,offLeft:c,offRight:l,offVertical:f,offHorizontal:e,totalHeight:t,totalWidth:i,totalAreaOff:a,totalArea:t*i}},n.prototype.getSize=function(){if(!this._clientInfo.getIsDesktop())return{width:window.visualViewport?window.visualViewport.width:window.top.innerWidth,height:window.visualViewport?window.visualViewport.height:window.top.innerHeight};var n=window.top.document;return n.compatMode==="BackCompat"?{width:n.body.clientWidth,height:n.body.clientHeight}:{width:n.documentElement.clientWidth,height:n.documentElement.clientHeight}},n}(),g=function(){function n(t,i,r,u){var e=this,f;this._getRect=t;this._offscreenCondition=r;this._viewPort=u;this._disposed=!1;f=this.isOffscreen();this._interval=setInterval(function(){if(!e._disposed){var n=e.isOffscreen();f!==n&&(f=n,i(n))}},n.Interval)}return n.prototype.drval)},n.prototype.isOffscreen=function(){var n=this._getRect(),t;return n==null?!1:(t=this._viewPort.getOverflow(n),this._offscreenCondition(t))},n.Interval=250,n}(),dt=function(){function n(n,t,i){this._vastTagAd=n;this._clientInfo=t;this._getRect=i;this._tracker=null;this._playPausePromise=null;this._hasQueuedOffscreenChange=!1;this._activate()}return n.prototype._activate=function(){var i=this,n,t;this._tracker===null&&(n=this._geect()},t=new f(this,this._onOffscreenChange).getValue(),this._tracker=new g(n,t,function(n){return n.totalAreaOff/n.totalArea>.5},this._clientInfo.getViewPort()),this._onOffscreenChange(this._tracker.isOffscreen()))},n.prototype._onOffscreenChange=function(n){function i(){t._playPausePromise=null;t._hasQueuedOffscreenChange&&(t._hasQueuedOffscreenChange=!1,t._onOffscreenChange(t._tracker.isOffscreen()))}if(this._vastTagAd.getLoaded()&&!this._vastTagAd.getPlayEnded()&&!this._vastTagAd.getDisposed()){if(this._playPausePromise){this._hasQueuedOffscreenChange=!0;return}this._playPausePromise=n?this._vastTagAd.pause():this._vastTagAd.play();var t=this;this._playPausePromise.then(i,i)}},n.prototype.dispose=function(){this._tracker&&(this._tracker.dispose(),this._tracker=null)},n}(),gt=function(){function n(n,t,i,r,u,e){var o,s;if(u===void 0&&(u=null),e===void 0&&(e=!1),o=this,this._element=n,this._clientInfo=t,this._position=i,this._ignoreBottomOffscreen=r,this._state="normal",this._syncPoisitionActive=!1,this._vastTagAdLastKnownClientRect=null,this._pauseOnOffscreenBehavior=null,this._activeAnimationBox=null,!this._element.parentNode)throw"Element must be attached to DOM";this._container=this._element.parentNode;this._originalPosition=this._element.style.position;this._originalLeft=this._element.style.left;this._originalTop=this._element.style.top;this._originalWidth=this._element.style.width;this._originalHeight=this._element.style.height;this._originalZIndex=this._element.style.zIndex;this._animationBoxPositionMarker=document.createElement("div");this._animationBoxPositionMarker.style.position="absolute";this._animationBoxPositionMarker.style.margin="0";this._animationBoxPositionMarker.style.left="0";this._animationBoxPositionMarker.style.top="0";this._animationBoxPositionMarker.style.visibility="hidden";document.body.insertBefore(this._animationBoxPositionMarker,document.body.firstChild);this._onResizeCallback=new f(this,this._onWindowResize);this._onResizeCallback.setThrottle(100);this._winElement=new h(window);this._winElement.on("resize",this._onResizeCallback.getValue());this._viewPort=this._clientInfo.getViewPort();s=new f(this,this._onOffscreenChange).getValue();this._tracker=new g(function(){var n=o._clientInfo.getBoundingClientRect(o._container);return u!=null&&(o._vastTagAdLastKnownClientRect=u.getClientRect()),o._syncPoisitionActive&&o._syncStickToSidePosition(),n},s,this._ignoreBottomOffscreen?function(n){return n.offTop*n.totalWidth/n.totalArea>.5}:function(n){return n.offVertical*n.totalWidth/n.totalArea>.5},this._viewPort);u!=null&&e&&(this._pauseOnOffscreenBehavior=new dt(u,this._clientInfo,function(){return o._vastTagAdLastKnownClientRect==null&&(o._vastTagAdLastKnownClientRect=u.getClientRect()),o._vastTagAdLastKnownClientRect}));this._onOffscreenChange(this._tracker.isOffscreen())}return n.prototype._onWindowion()},n.prototype._onOffscreenion()},n.prototype._setElementToOriginalPosition=function(){this._element.style.position=this._originalPosition;this._element.style.left=this._originalLeft;this._element.style.top=this._originalTop;this._element.style.width=this._originalWidth;this._element.style.height=this._originalHeight;this._element.style.zIndex=this._originalZIndex},n.prototype._restorePosition=function(n){var r,u;if(n===void 0&&(n=!1),this._state!=="normal"){if(this._cancelActiveAnimation(),this._syncPoisitionActive=!1,r=Number(this._element.style.left.replace("px","")),u=Number(this._element.style.top.replace("px","")),this._setElementToOriginalPosition(),n){this._state="normal";return}this._element.style.visibility="hidden";var t=this._clientInfo.getBoundingClientRect(this._element),i=this._clientInfo.getBoundingClientRect(this._animationBoxPositionMarker),e=r-i.left,o=u-i.top,s=t.left-i.left,h=t.top-i.top,f=new k({closedLocation:{top:o,left:e},openedLocation:{top:h,left:s},position:"absolute",openedWidth:t.right-t.left,openedHeight:t.bottom-t.top,closedWidth:this._position.width,closedHeight:this._position.height,widthCssTransition:"linear",widthCssTransitionDuration:250,heightCssTransition:"linear",heightCssTransitionDuration:250,leftCssTransition:"ease-in",leftCssTransitionDuration:250,topCssTransition:"ease-in",topCssTransitionDuration:250});f.rootElement.style.zIndex="999999999";this._showAnimation(f);this._state="normal"}},n.prototype._cancelActiveAnimation=function(){this._activeAnimationBox&&(this._activeAnimationBox.rootElement.parentNode.removeChild(this._activeAnimationBox.rootElement),this._activeAnimationBox=null,this._element.style.visibility="visible")},n.prototype._showAnimation=function(n,t){t===void 0&&(t=null);document.body.insertBefore(n.rootElement,this._animationBoxPositionMarker);this._activeAnimationBox=n;var i=this;setTimeout(function(){i._activeAnimationBox===n&&n.showOpenAnimation(function(){i._activeAnimationBox===n&&(i._element.style.visibility="visible",n.rootElement.parentNode.removeChild(n.rootElement),i._activeAnimationBox=null,t&&t())})},50)},n.prototype._moveToSide=function(){var n,r,t,i,u;(this._cancelActiveAnimation(),n=this._calculateStickToSidePosition(),r=this._viewPort.getOverflow({left:n.left,top:n.top,right:n.left+this._position.width,bottom:n.top+this._position.height,width:this._position.width,height:this._position.height}),r.totalAreaOff>0)||(t=this._clientInfo.getBoundingClientRect(this._element),i=new k({closedLocation:{top:t.top,left:t.left},openedLocation:{top:n.top,left:n.left},position:"fixed",closedWidth:t.right-t.left,closedHeight:t.bottom-t.top,openedWidth:this._position.width,openedHeight:this._position.height,widthCssTransition:"linear",widthCssTransitionDuration:250,heightCssTransition:"linear",heightCssTransitionDuration:250,leftCssTransition:"ease",leftCssTransitionDuration:250,topCssTransition:"ease",topCssTransitionDuration:250}),i.rootElement.style.zIndex=String(999999999),this._element.style.position="fixed",this._element.style.zIndex=String(999999999),this._element.style.left=n.left+"px",this._element.style.top=n.top+"px",this._element.style.width=this._position.width+"px",this._element.style.height=this._position.height+"px",this._element.style.visibility="hidden",u=this,this._showAnimation(i,function(){u._syncPoisitionActive=!0}),this._state="stickedToSide")},n.prototype._syncStickToSidePosition=function(){var n=this._calculateStickToSidePosition(),t;this._element.style.left=n.left+"px";this._element.style.top=n.top+"px";t=this._viewPort.getOverflow({left:n.left,top:n.top,right:n.left+this._position.width,bottom:n.top+this._position.height,width:this._position.width,height:this._position.height});t.totalAreaOff>0&&this._restorePosition(!0)},n.prototype._calculateStickToSidePosition=function(){var n=this._clientInfo.getBoundingClientRect(this._position.relativeElement||this._container),i=this._position.align===t.RelativeAlignment.Left?n.left-this._position.alignOffset-this._position.width:this._position.align===t.RelativeAlignment.Right?n.right+this._position.alignOffset:n.left+this._position.alignOffset;return{left:i,top:this._position.topOffset}},n.prototype.dispose=function(){this._tracker.dispose();this._restorePosition(!0);this._cancelActiveAnimation();this._syncPoisitionActive=!1;this._winElement.off("resize",this._onResizeCallback.getValue());this._animationBoxPositionMarker.parentNode.removeChild(this._animationBoxPositionMarker)},nurn n}(),ti=function(n,t,r){this._adContainer=n;this._video=null;this._clientInfo=t;this._log=r;this._mediaFile=null;this._onPlayStartedEvent=new i;this._onPlayEndedEvent=new i;this._skippedEvent=new i;this._onVolumeChangedEvent=new i;this._pauseEvent=new i;this._resumeEvent=new i;this._enterFullscreenEvent=new i;this._exitFullscreenEvent=new i;this._clickEvent=new i;this._waitingForDataChangedEvent=new i;this._isFullscreen=null;this._hls=null;this._hlsVideoStreamEnded=!1;this.Hls=wt;this._playStarted=!1;this._videoReadyState={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4}};ti.prototype={canPlay:function(n){var t=document.createElement("video");return n.deliveryType==="streaming"&&n.mimeType==="application/vnd.apple.mpegurl"?this.Hls&&this.Hls.isSupported()?"probably":t.canPlayType?t.canPlayType(n.mimeType):"":t.canPlayType?t.canPlayType(n.mimeType):""},getMediaFile:function(){return this._mediaFile},loadMediaFile:function(n){if(this._log.info("Loading media file: "+this._mediaFileToString(n)),this._video=this._createVideo(n),n.deliveryType==="streaming"&&n.mimeType==="application/vnd.apple.mpegurl"){this._adContainer.insert(this._video);var t=this;return this._loadStreamingPlaylist(t._video,n).then(function(){return t._loadVideoSrc(n)},function(n){return t._adContainer.remove(t._video),t._mediaFile=null,r.reject(n)})}return this._video.src=n.fileURL,this._adContainer.insert(this._video),this._loadVideoSrc(n)},_mediaFileToght})},_loadVideoSrc:function(n){var t=this;return new r(function(i,r){function u(n){t._log.info("Play attempt to preload video was rejected. Reason:"+n);t._adContainer.remove(t._video);t._mediaFile=null;r(n)}function f(){if(t._video.error){u(t._video.error);return}if(t._video.readyState<t._videoReadyState.HAVE_METADATA){t._log.info("Play attempt to preload video was accepted. Waiting for metadata to load");var r="loadedmetadata",f=function(){t._video.removeEventListener(r,f);t._video.removeEventListener("error",e);t._log.info("Video preloaded and paused");t._video.pause();t._mediaFile=n;i()},e=function(){t._video.removeEventListener(r,f);t._video.removeEventListener("error",e);u(t._video.error)};t._video.addEventListener(r,f);t._video.addEventListener("error",e)}else t._log.info("Video preloaded and paused"),t._video.pause(),t._mediaFile=n,i()}t._log.info("Initiating play to pre-load video");t._video.playEx().then(f).catch(u)})},_capDevicePixelRatio:function(){var n=window.devicePixelRatio||1,t,i;n>1?(t=this._adContainer.getHeight(),i=this._clientInfo.getIsDesktop()?720:360,window.__devicePixelRatio=t>=i?1:Math.min(n,Math.floor(i/t*100)/100)):window.__devicePixelRatio=n;this._log.info("HLS will use device to pixel ratio of: "+window.__devicePixelRatio+". Real ratio was: "+n)},_loadStreamingPlaylist:function(n,t){var i=this;return new r(function(r,u){if(i.Hls.isSupported()){i._capDevicePixelRatio();var f=new i.Hls({capLevelToPlayerSize:!0,maxBufferLength:3,maxMaxBufferLength:3,maxBufferSize:3145728,startLevel:-1});f.attachMedia(n);f.once(i.Hls.Events.MEDIA_ATTACHED,function(){f.loadSource(t.fileURL);f.once(i.Hls.Events.MANIFEST_PARSED,function(){f.off(i.Hls.Events.ERROR,e);r()})});function e(n,t){t.fatal&&(i._log.info("Fatal HLS error. Type: "+t.type+" Details: "+t.details),f.destroy(),u())}f.on(Hls.Events.BUFFER_EOS,function(n,t){i._hlsVideoStreamEnded=t.type==="video"});f.once(i.Hls.Events.ERROR,e);i._hls=f}else n.canPlayType("application/vnd.apple.mpegurl")?(n.src=t.fileURL,r()):u()})},enterFullscreen:function(){var n=this._video;if(!n)return!1;if(this._isFullscreen)return!0;if(screenfull.enabled){try{screenfull.request(n)}catch(t){return!1}return!0}if(this._clientInfo.getIsiOS()&&this._video.webkitSupportsFullscreen)try{if(n.webkitRequestFullscreen)return n.webkitRequestFullscreen(),!0;if(n.webkitEnterFullscreen)return n.webkitEnterFullscreen(),!0}catch(t){return!1}return!1},_setupEvents:function(){var n=this;this._activatePauseResumeNotification();this._activateFullscreenNotification();this._video.addEventListener("waiting",function(){n._waitingForDataChangedEvent.trigger();n._mediaFile.mimeType==="application/vnd.apple.mpegurl"&&n._hlsVideoStreamEnded&&n._video.duration-n._video.currentTime<1&&n._onPlayEndedEvent.triggerOnce()});this._video.addEventListener("ended",function(){n._waitingForDataChangedEvent.trigger()});this._video.addEventListener("pause",function(){n._waitingForDataChangedEvent.trigger()});this._video.addEventListener("canplay",function(){n._waitingForDataChangedEvent.trigger()});this._video.addEventListener("canplaythrough",function(){n._waitingForDataChangedEvent.trigger()});this._video.addEventListener("ended",function(){n._onPlayEndedEvent.triggerOnce()});this._video.addEventListener("volumechange",function(){n._onVolumeChangedEvent.trigger()})},getCurrentTime:function(){return this._mediaFile===null||this._video===null?0:this._video.currentTime},getDuration:function(){return this._mediaFile===null||this._video===null?0:this._video.duration},getVolume:function(){return this._mediaFile===null||this._video===null?null:this._video.muted?0:this._video.volume},getPaused:function(){return this._mediaFile===null||this._video===null?null:this._video.paused},getWaitingForData:function(){return this._video?!this._video.paused&&!this._video.ended&&this._video.readyState<=this._videoReadyState.HAVE_CURRENT_DATA:!1},onWaitingForDataChanged:function(n){this._waitingForDataChangedEvent.addHandler(n)},setVolume:funct "+n)}var i,t;return this._mediaFile===null||this._video===null?null:n===0?(this._video.muted=!0,!0):(i=this._video.paused,this._video.muted=!1,this._video.volume=n,t=this,i===!1&&this._video.paused)?(t._log.info("Browser blocked video after it was unmuted. Muted video and attempting to resume"),this._video.muted=!0,this._clientInfo.getIsiOS()?setTimeout(function(){t._video.playEx().catch(r)},10):this._video.playEx().catch(r),!1):!0lve()},play:function(){var n=this,t=!1,i=0;return new r(function u(r,f){function o(){t||(t=!0,n._log.info("Video triggered playing event. Resolving play promise"),n._video.removeEventListener("playing",o),n._video.removeEventListener("error",e),n._playStarted||(n._playStarted=!0,n._onPlayStartedEvent.triggerOnce(),n._setupEvents(n._video)),r())}function e(s){if(!t){if(t=!0,n._video.removeEventListener("playing",o),n._video.removeEventListener("error",e),!n._video.muted&&i<5){n._log.info("Video triggered error event. Previous play attempt was on unmuted video. Attempting to play muted");n._video.muted=!0;i++;t=!1;u(r,f);return}n._log.info("Video triggered error event on muted video. Rejecting play promise");f(s)}}if(n._mediaFile==null){f("No MediaFile Loaded");return}if(n._playStarted&&!n._video.paused){r();return}n._video.addEventListener("playing",o);n._video.addEventListener("error",e);n._log.info(n._playStarted?"Resuming video":"Starting video");n._clientInfo.getIsiOS()?n._startPlayOnIOS(e):n._clientInfo.getIsIE()&&n._clientInfo.getBrowserVersion()<=10?setTch(e)},10):n._video.playEx().catch(e)})},_startPlayOnIOS:function(n){var t=this;setTimeout(function(){t._video.currentTime=t._video.currentTime===0?.01:t._video.currentTime;t._video.playEx().then(function(){t._clientInfo.getOSVersion()<10&&setTked")},50)}).catch(n)},10)},pause:function(){return this._mediaFile==null||this._video===null?r.reject("No MediaFile Loaded"):(this._video.pause(),r.resolve())},dispose:function(){(this._hls!=null&&(this._hls.destroy(),this._hls=null),this._mediaFile!==null&&this._video!==null)&&(this._adContainer.remove(this._video),this._mediaFile=null,this._onPlayStartedEvent.removeAllHandlers(),this._onPlayEndedEvent.removeAllHandlers(),this._onVolumeChangedEvent.removeAllHandlers(),this._clickEvent.removeAllHandlers(),this._pauseEvent.removeAllHandlers(),this._resumeEvent.removeAllHandlers(),this._enterFullscreenEvent.removeAllHandlers(),this._exitFullscreenEvent.removeAllHandlers(),this._waitingForDataChangedEvent.removeAllHandlers(),this._skippedEvent.removeAllHandlers())},onPlayStarted:function(n){this._onPlayStartedEvent.addHandler(n)},offPlayStarted:function(n){this._onPlayStartedEvent.removeHandler(n)},onPlayEnded:function(n){this._onPlayEndedEvent.addHandler(n)},onClick:function(n){this._clickEvent.addHandler(n)},onVolumeChanged:function(n){this._onVolumeChangedEvent.addHandler(n)},onPause:function(n){this._pauseEvent.addHandler(n)},offPause:function(n){this._pauseEvent.removeHandler(n)},onResume:function(n){this._resumeEvent.addHandler(n)},offResume:function(n){this._resumeEvent.removeHandler(n)},onSkipped:function(n){this._skippedEvent.addHandler(n)},onEnterFullscreen:function(n){this._enterFullscreenEvent.addHandler(n)},onExitFullscreen:function(n){this._exitFullscreenEvent.addHandler(n)},_activateFullscreenNotification:function(){var n=this;if(screenfull.enabled){this._isFullscreen=this._checkIsFullscreen();screenfull.onchange(function(){var t=n._checkIsFullscreen();t!==n._isFullscreen&&(n._isFullscreen=t,t?n._enterFullscreenEvent.trigger():n._exitFullscreenEvent.trigger())})}else this._clientInfo.getIsiOS()&&this._video.webkitSupportsFullscreen&&(this._isFullscreen=this._video.webkitDisplayingFullscreen,this._video.addEventListener("webkitbeginfullscreen",function(){n._isFullscreen=!0;n._enterFullscreenEvent.trigger()}),this._video.addEventListener("webkitendfullscreen",function(){n._isFullscreen=!1;n._exitFullscreenEvent.trigger()}))},_checkIsFullscreen:function(){return screenfull.enabled?screenfull.element?screenfull.element===this._video||screenfull.element.contains(this._video):!1:undefined},_activatePauseResumeNotification:function(){var n=this;this._video.addEventListener("play",function(){n._resumeEvent.trigger()});this._video.addEventListener("ger()})},_createVideo:function(n){var t=document.createElement("video"),i,u;return t.controls=!1,t.muted=!0,t.setAttribute("muted",""),t.setAttribute("preload","auto"),t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline",""),t.style="object-fit: "+(n.scalable===!1?"none":n.maintainAspectRatio===!1?"fill":"contain"),t.style.backgroundColor="black",t.style.width="100%",t.style.height="100%",i=["loadstart","progress","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","play","pause","ratechange","volumechange",],i.f(){})}),u=this,t.addEventListener(":!0})}),t.playEx=function(){return new r(function(n,i){try{var r=t.play();r!==undefined?r.then(n,i):n()}catch(u){i(u)}})},t}};w=function(n,t,r){this._adContainer=n;this._clientInfo=t;this._onPlayStartedEvent=new i;this._onPlayEndedEvent=new i;this._onMuteChangedEvent=new i;this._enterFullscreenEvent=new i;this._exitFullscreenEvent=new i;this._onVolumeChangedEvent=new i;this._skippedEvent=new i;this._clickEvent=new i;this._pauseEvent=new i;this._resumeEvent=new i;this._events=[this._onPlayStartedEvent,this._onPlayEndedEvent,this._onMuteChangedEvent,this._enterFullscreenEvent,this._exitFullscreenEvent,this._onVolumeChangedEvent,this._skippedEvent,this._clickEvent,this._pauseEvent,this._resumeEvent];this._pendingVolumeUpdate=null;this._loadVPAIDScriptTimeout=15e3;this._videoSlot=null;this._wrapper=null;this._slot=null;this._adLoadTimeout=3e4;this._adStartTimeout=5e3;this._adPauseResumeTimeout=1e3;this._adSkipTimeout=500;this._playResumingPromise=null;this._playStartingPromise=null;this._testVpaidAd=null;this._mediaFile=null;this._log=r};w.prototype={canPlay:function(n){return(n.mimeType.toLowerCase()==="application/x-javascript"||n.mimeType.toLowerCase()==="application/javascript")&&n.apiFramework==="VPAID"?"probably":""},getMediaFile:function(){return this._mediaFile},loadMediaFile:function(n){var t=this;return new r(function(i,r){var u=function(n){t._removeVPaidElements();t._mediaFile=null;t._deactivateStopOnStartBehavior();t._vpaidAd=null;r(n)};t._loadVPAIDAd(n.fileURL).then(function(r){t._vpaidAd=r;var f=t._checkVPAIDInterface(r)||t._checkVersion(r);if(f){u(f);return}t._applyAsyncExtensions(r);t._enableVPAIDEventsLogging(r);t._enableVPAIDCallsLogging(r);t._activateStopOnStartBehavior();r.__async.initAd(t._adContainer.getWidth(),t._adContainer.getHeight(),"normal",1e4,{AdParameters:n.creative.adParameters},{slot:t._slot,videoSlot:t._videoSlot,videoSlotCanAutoPlay:!1}).then(function(){t._mediaFile=n;t.setVolume(0);i()},u)},u)})},_activateStopOnStartBehavior:function(){this._stopOnStartBehaviorCallback=new f(this,this._onPrematureStart);this._vpaidAd.subscribe(this._stopOnStartBehaviorCallback.getValue(),"AdStarted")},_onPrematurlay()},_deactivateStopOnStartBehavior:function(){this._stopOnStartBehaviorCallback&&(this._stopOnStartBehaviorCallback.setDisabled(!0),this._vpaidAd.unsubscribe(this._stopOnStartBehaviorCallback.getValue(),"AdStarted"),this._stopOnStartBehaviorCallback=null)},_enableVPAIDEventsLogging:function(n){for(var i=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdLinearChange","AdSizeChange","AdExpandedChange","AdSkippableStateChange","AdRemainingTimeChange","AdDurationChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"],r=this,t=0;t<i.length;t++)n.subscribe(function(n){return function(){var t=arguments.length>0?" Args: "+JSON.stringify(arguments):"";r._log.info("Recieved "+n+" event from VPAID."+t)}}(i[t]),i[t])},_enableVPAIDCallsLogging:function(n){for(var i=["initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","setAdVolume"],r=this,t=0;t<i.length;t++)(function(t){var i=n[t];i&&(n[t]=function(){var u=arguments.length>0?" Args: "+JSON.stringify(arguments):"";return r._log.info("Calling "+t+u),i.apply(n,arguments)})})(i[t])},setLoadTimeout:function(n){this._adLoadTimeout=n},setStartTimeout:function(n){this._adStartTimeout=n},_checkVPAIDInterface:function(n){var t=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"tion"});return t?"VPAID object is missing function named "+t:null},_checkVersion:function(n){var t=n.handshakeVersion("2.0"),i;return typeof t!="string"||(i=t.split(".")).length===0||isNaN(parseInt(i[0]))||parseInt(i[0])>2?"Unsupported VPAID API version. Version is: "+t:null},_createVideoSlot:function(){var n=document.createElement("video");return n.controls=!1,n.muted=!0,n.setAttribute("muted",""),n.setAttribute("preload","auto"),n.setAttribute("playsinline",""),n.setAttribute("webkit-playsinline",""),n.style.objectFit="contain",n.style.backgroundColor="transparent",n.style.margin="auto",n.style.width="100%",n.style.height="100%",n},_createVideoSlotWrapper:function(){var n=document.createElement("div");return n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.bottom=0,n.style.right=0,n.style.margin="auto",n.style.width="100%",n.style.height="100%",n.style.overflow="hidden",n},_createFrame:function(){var n=document.createElement("iframe");return n.style.width="100%",n.style.height="100%",n.style.border=0,n.style.position="relative",n.style.overflow="hidden",n.style.padding=0,n.style.margin=0,n.style.float="none",n.setAttribute("scrolling","no"),n},_createWrapper:function(){var n=document.createElement("div");return n.style.position="relative",n.style.backgroundColor="black",n.style.padding=0,n.style.margin=0,n.style.float="none",n.style.width="100%",n.style.height="100%",n},_loadVPAIDAd:function(n){var i=!1,t=this;return new r(function(r,u){var e,f,o,s;try{t._wrapper=t._createWrapper();t._videoSlot=t._createVideoSlot();e=t._createVideoSlotWrapper();e.appendChild(t._videoSlot);t._wrapper.appendChild(e);f=t._createFrame();t._wrapper.appendChild(f);t._adContainer.insert(t._wrapper);o=setTipt")},t._loadVPAIDScriptTimeout);f.onload=function(){var e,s;if(!i)if(clearTimeout(o),f.contentWindow.getVPAIDAd){e=null;try{e=f.contentWindow.getVPAIDAd();t._slot=f.contentWindow.document.getElementById("inf-vpaid-slot")}catch(n){s=n&&n.message?n.message:JSON.stringify(n);u("Error calling getVPAIDAd. Details: "+s)}if(t._testVpaidAd){r(t._testVpaidAd);return}r(e)}else u("Unable to locate getVPAIDAd function in VPAID frame")};s="<head><\/head><body style='margin:0;padding:0'><script src='"+n+"' type='text/javascript'><\/script><div id='inf-vpaid-slot' style='height: 100%'><\/div><\/body>";f.contentWindow.document.open();f.contentWindow.document.write(s);f.contentWindow.document.close()}catch(h){u(h)}})},enterFullscreen:function(){if(!this._vpaidAd)return!1;if(this._isDisplayingFullscreen())return!0;if(screenfull.enabled){try{screenfull.request(this._wrapper);this._vpaidAd.resizeAd(this._wrapper.offsetWidth,this._wrapper.offsetHeight,"fullscreen")}catch(n){return!1}return!0}if(this._clientInfo.getIsiOS()&&this._videoSlot.webkitSupportsFullscreen)try{if(this._videoSlot.webkitRequestFullscreen)return this._videoSlot.webkitRequestFullscreen(),this._vpaidAd.resizeAd(this._wrapper.offsetWidth,this._wrapper.offsetHeight,"fullscreen"),!0;if(this._videoSlot.webkitEnterFullscreen)return this._videoSlot.webkitEnterFullscreen(),this._vpaidAd.resizeAd(this._wrapper.offsetWidth,this._wrapper.offsetHeight,"fullscreen"),!0}catch(n){return!1}return!1},_activateFullscreenNotification:function(){var n,t;if(!this._fullscreenNotificationActivated)if(this._fullscreenNotificationActivated=!0,n=this,screenfull.enabled){t=this._isDisplayingFullscreen();screenfull.onchange(function(){var i=n._isDisplayingFullscreen();i!==t&&(t=i,i?n._enterFullscreenEvent.trigger():n._exitFullscreenEvent.trigger())})}else this._clientInfo.getIsiOS()&&(this._videoSlot.addEventListener("webkitbeginfullscreen",function(){n._enterFullscreenEvent.trigger()},!1),this._videoSlot.addEventListener("webkitendfullscreen",function(){n._exitFullscreenEvent.trigger()},!1))},_isDisplayingFullscreen:function(){return screenfull.enabled?screenfull.element?screenfull.element===this._wrapper||screenfull.element.contains(this._wrapper):!1:this._clientInfo.getIsiOS()&&this._videoSlot.webkitSupportsFullscreen?this._videoSlot.webkitDisplayingFullscreen:undefined},getCurrentTime:function(){var n,t;return this._vpaidAd?(n=this.getDuration(),n===NaN)?0:(t=this._vpaidAd.getAdRemainingTime(),t<0||t>n)?0:n-t:0},getDuration:function(){return this._vpaidAd&&this._vpaidAd.getAdDuration?this._vpaidAd.getAdDuration():NaN},getVolume:function(){if(!this._vpaidAd)return null;var n=this._vpaidAd.getAdVolume();return n===-1?0:n},setVolume:function(n){return this._vpaidAd?(this._pendingVolumeUpdate&&this._pendingVolumeUpdate.stop(),this._adPlaying&&n>0?(this._pendingVolumeUpdate=new nt(this._vpaidAd,this._videoSlot,n,this._log),this._pendingVolumeUpdate.run()):(this._vpaidAd.setAdVolume(n),!0)):null},skip:function(){if(!this._vpaidAd)return this._skippedEvent.trigger(),this.dispose(),r.resolve();var n=this;return new r(function(t){function i(){n._skippedEvent.trigger();n.dispose();t()}n._vpaidAd.__async.skipAd().then(t,i)})},onVolumeChanged:function(n){this._onVolumeChangedEvent.addHandler(n)},getPaused:function(){return this._vpaidAd?this._adStarted&&!this._adPlaying:null},getWaitingFurn!1},onWaitingForDataCon(){},play:function(){return this._vpaidAd?this._adStarted?this._adPlaying?r.resolve():this._resumePlay():this._startPlay():r.reject("No MediaFile Loaded")},pause:function(){return this._vpaidAd==null?r.reject("No MediaFile Loaded"):!this._adStarted||!this._adPlaying?r.resolve():(this._pendingVolumeUpdate&&this._pendingVolumeUpdate.stop(),this._pausePlay())},_startPlay:function(){var n=this;return new r(function(t,i){function u(){n._playStartingPromise=null;n._fixVideoSizeAdjustments();n._vpaidAd=n._fixVPAIDDuration(n._vpaidAd);n._setupPlayRelatedEvents(n._vpaidAd);n._adStarted=!0;n._adPlaying=!0;n._onPlayStartedEvent.triggerOnce;i(t)}if(n._playStartingPromise){n._playStartingPromise.then(t,i);return}var f=n._isDisplayingFullscreen();f&&n._vpaidAd.resizeAd(this._wrapper.offsetWidth,this._wrapper.offsetHeight,"fullscreen");n._adContainer.onResize(function(t){n._vpaidAd.resizeAd(t.width,t.height,n._isDisplayingFullscreen()?"fullscreen":"normal")});n._deactivateStopOnStartBehavior();n._activateFullscreenNotification();n._setupEvents(n._vpaidAd);n._playStartingPromise=n._prematureStartDetected?n._pausePlay().then(function(){n._vpaidAd.__async.resumeAd().then(u,r)},r):n._vpaidAd.__async.startAd().then(u,r)})},_fixVideoSizeAdjustments:function(){(this._videoSlot.style.width!=="100%"||this._videoSlot.style.height!=="100%")&&(this._log.info("Video slot dimensions were modified by VPAID. Reverting them back to percentage values"),this._videoSlot.style.width="100%",this._videoSlot.style.height="100%");(this._slot.style.width!=="100%"||this._slot.style.height!=="100%")&&(this._log.info("Slot dimensions were modified by VPAID. Reverting them back to percentage values"),this._slot.style.width="100%",this._slot.style.height="100%")},setTestVpaidAd:function(n){this._testVpaidAd=n},_setupEvents:function(n){if(!this._eventsSet){this._eventsSet=!0;var t=this;n.subme())},"AdVolumeChange");n.subscribe(function(n){t._clickEvent.trigger(n&&n.data?n.data:{playerHandles:!1})},"AdClickThru");n.subose()},"AdSkipped")}},_pausePlay:function(){var n=this;return new r(function(t,i){if(n._playPausingPromise){n._playPausingPromise.then(t,i);return}n._playPausingPromise=n._vpaidAd.__async.pauseAd().then(function(){n._playPausingPromise=null;t()},function(){n._playPausingPromise=null;i()})})},_resumePlay:function(){var n=this;return new r(function(t,i){if(n._playResumingPromise){n._playResumingPromise.then(t,i);return}n._playResumingPromise=n._vpaidAd.__async.resumeAd().then(function(){n._playResumingPromise=null;i()})})},_setupPlayRelatedEvents:function(n){var t=this;n.subscribe(function(){t._adPlaying=!1;t._onPlayEndedEvent.triggerOnce()},"AdVideoComplete");n.subscribe(function(){t._adPlaying=!1;t._onPlayEndedEvent.triggerOnce()},"AdError");n.subscribe(function(){t._adPlaying=!1;t._pauseEvent.trigger()},"AdPaused");n.subger()},"AdPlaying")},_fixVPAIDDuration:function(n){this._log.info("Updated AdDuration to match RemainingTime. AdDuration changed from "+(n.getAdDuration?n.getAdDuration():"unknown")+" to "+n.getAdRemainingTime()+" seconds");var t=n.getAdRemainingTime();return n.getAdDuurn t},n},_applyAsyncExtensions:function(n){function i(t,i,u){return new r(function(r,e){function h(){try{o.setDisabled(!0);s.setDisabled(!0);n.unsubscribe(o.getValue(),i);n.unsubscribe(s.getValue(),"AdError")}catc;e(n)}function l(){h();e("Timeout waiting for "+i+" event")}var o=new );r()}),s;o.setTimeout(l,u);s=new f(this,c);n.subscribe(o.getValue(),i);n.subscribe(s.getValue(),"AdError");t()})}var t=this;n.__async={initAd:function(){var r=arguments;return i(function(){n.initAd.apply(n,r)},"AdLoaded",t._adLoadTimeout)},startAd:function(){var r=arguments,u=t._clientInfo.getIsiOS()&&t._clientInfo.getOSVersion()<10?36e5:t._adStartTimeout;return i(function(){n.startAd.apply(n,r)},"AdImpression",u)},resumeAd:function(){var r=arguments;return i(function(){n.resumeAd.apply(n,r)},"AdPlaying",t._adPauseResumeTimeout)},pauseAd:function(){var r=arguments;return i(function(){n.pauseAd.apply(n,r)},"AdPaused",t._adPauseResumeTimeout)},skipAd:function(){var r=arguments;return i(function(){n.skipAd.apply(n,r)},"AdSkipped",t._adSkipTimeout)},stopAd:function(){var r=arguments;re(n,r)},"AdStopped",t._adSkipTimeout)}}},_removeVPaidElements:function(){this._wrapper!=null&&(this._adContainer.remove(this._wrapper),this._wrapper=null)},dispose:function(){if(this._vpaidAd){try{this._pendingVolumeUpdate&&this._pendingVolumeUpdate.stop();this._adContainer.offResize();this._wrapper.style.display="none";this._events.forEach(function(n){n.removeAllHandlers()});var n=this;this._vpaidAd.__async.stopAd().then(function(){n._removeVPaidElements()},function(){n._removeVPaidElements()})}catch(t){}this._vpaidAd=null}},onPlayStarted:function(n){this._onPlayStartedEvent.addHandler(n)},offPlayStarted:function(n){this._onPlayStartedEvent.removeHandler(n)},onPlayEnded:function(n){this._onPlayEndedEvent.addHandler(n)},onClick:function(n){this._clickEvent.addHandler(n)},onPause:function(n){this._pauseEvent.addHandler(n)},offPause:function(n){this._pauseEvent.removeHandler(n)},onResume:function(n){this._resumeEvent.addHandler(n)},offResume:function(n){this._resumeEvent.removeHandler(n)},onSkipped:function(n){this._skippedEvent.addHandler(n)},onEnterFullscreen:function(n){this._enterFullscreenEvent.addHandler(n)},onExitFullscreen:function(n){this._exitFullscreenEvent.addHandler(n)}};nt=function(n,t,i,r){this._vpaidAd=n;this._videoSlot=t;this._isActive=!0;this._activeWaitHandle=null;this._newValue=i;this._log=r};nt.prototype={run:function(){var t,n;return this.stop(),this._isActive=!0,this._videoSlot.src&&this._videoSlot.src.length>0&&!this._videoSlot.paused?(this._vpaidAd.setAdVolume(this._newValue),t=!1,this._videoSlot.paused&&(this._log.info("VPAID ad video slot was paused after volume change. Muted video slot and attempting to resume"),this._vpaidAd.setAdVolume(0),this._vpaidAd.pauseAd(),this._vpaidAd.resumeAd(),t=!0),this._isActive=!1,!t):(this._vpaidAd.setAdVolume(this._newValue),n=this,this._activeWaitHandle=setTimeout(function(){if(n._isActive){var t=n._vpaidAd.getAdRemainingTime();n._activeWaitHandle=setTimeout(function(){n._isActive&&(n._isActive=!1,n._activeWaitHandle=null,t===n._vpaidAd.getAdRemainingTime()&&(n._log.info("VPAID ad stopped updating remaining time after volume change. Muted VPAID and attempting to resume"),n._vpaidAd.setAdVolume(0),n._vpaidAd.pauseAd(),n._vpaidAd.resumeAd()))},50)}},50),null)},stop:function(){this._isActive=!1;this._activeWaitHandle!=null&&clearTimeout(this._activeWaitHandle)}};tt=funcnew i}return n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n.prototype.getCliement)},n.prototype.removeFment)},n.prototype.getDoument},n.prototype.hasClass=function(n){return(" "+this._element.className+" ").indexOf(" "+n+" ")>=0},n.prototype.addClass=function(n){this.hasClass(n)||(this._element.className=this._element.className+" "+n)},n.prototype.onMouseEnter=function(n){this._element.addEventListener("mouseenter",n)},n.prototype.offMouseEnter=function(n){this._element.removeEventListener("mouseenter",n)},n.prototype.onMouseLeave=function(n){this._element.addEventListener("mouseleave",n)},n.prototype.offMouse",n)},n.prototype.setOffscreen=function(n){n?(this._element.style.position="absolute",this._element.style.left="-5000px"):(this._element.style.removeProperty("position"),this._element.style.removeProperty("left"))},n.prototype.insert=function(n){this._element.appendChild(n)},n.prototype.syncSize=function(){var n=this._element.offsetWidth,t=this._element.offsetHeight;(this._width!==n||this._height!==t)&&(this._width=n,this._height=t,this._resizeEvent.trigger({width:n,height:t}))},n.prototype.onResize=function(n){this._resizeEvent.addHandler(n)},n.prototype.offResize=function(n){if(!n){this._resizeEvent.removeAllHandlers();return}this._resizeEvent.removeHandler(n)},n.prototype.remove=function(n){this._element.removeChild(n)},n.prototype.clear=function(){while(this._element.firstChild)this._element.removeChild(this._element.firstChild)},ners=t};it.prototype={apply:function(n){if(n.length<2)return n;var t=this;return n.sort(function(n,i){var r=t._compareMediaFilesByDeliveryType(n,i);return r!==0?r:(r=t._compareMediaFilesByPlayability(n,i),r!==0)?r:t._compareMediaFilesByAdContainerFit(n,i)})},_compareMediaFilesByDeliveryType:function(n,t){return n.deliveryType===t.deliveryType?0:n.deliveryType==="streaming"?-1:1},_compareMediaFilesByPlayability:function(n,t){var r=this._players.map(function(t){return t.canPlay(n)}).sort(this._comparePlayability),i=this._playeay(t)}).sort(this._comparePlayability);return r.length===0?i.length===0?0:1:i.length===0?-1:this._comparePlayability(r[0],i[0])},_compareMediaFilesByAdContainerFit:function(n,t){var i=Math.abs(n.width-this._adContainer.getWidth())+Math.abs(n.height-this._adContainer.getHeight()),r=Math.abs(t.width-this._adContainer.getWidth())+Math.abs(t.height-this._adContainer.getHeight());return i<r?-1:i>r?1:0},_comparePlayability:function(n,t){var i=n==="probably"?2:n==="maybe"?1:0,r=t==="probably"?2:t==="maybe"?1:0;returnplay"}(c||(c={}));rt=function(){function n(t){this._clickEvent=new i;t.hasClass(n._getUniqueClassName("inf-videoButtons-container"))||t.addClass(n._getUniqueClassName("inf-videoButtons-container"));a(t.getDocument());var r=document.createElement("div");r.className=n._getUniqueClassName("inf-playerButton")+" "+n._getUniqueClassName("inf-playButton");this._buttonIconElement=document.createElement("div");r.appendChild(this._buttonIconElement);t.insert(r);this._clickCallback=new f(this,this._onClick).getValue();r.addEventListener("click",this._clickCallback,!0);r.addEventListener("touchend",this._clickCallback,!0);this._buttonElement=r;this._adContainer=t;this.iconType=c.Play}return n.existsIn=function(t){return t.querySelectorAll("."+n._getUniqueClassName("inf-playButton")+" ."+n._getUniqueClassName("inf-playButton-icon")).length>0},Object.defineProperty(n.prototype,"iconType",{set:function(t){this._buttonIconElement.className=t===c.Play?n._getUniqueClassName("inf-playButton-icon"):n._getUniqueClassName("inf-replayButton-icon")},enumerable:!0,configurable:!0}),n.prototype.onClick=function(n){this._clickEvent.addHandler(n)},n._getUniqueClaF-"+n},n.prototype._onClick=function(n){return n.stopPropagation(),n.stopImmediatePropagation(),n.preventDefault(),this._clickEvent.trigger(),!1},n.prototype.dispose=function(){this._clickEvent.removeAllHandlers();this._buttonElement.removeEventListener("click",this._clickCallback);this._adContainer.remove(this._buttonElement)},n}();ut=function(n,t){function u(n){return"g367CB268B1094004A3689751E7AC568F-"+n}var i,r;if(t.hasClass(u("inf-videoButtons-container"))||t.addClass(u("inf-videoButtons-container")),a(t.getDocument()),i=document.createElement("div"),i.setAttribute("style","left: 0; right: 0; top: 0; margin-left: auto; margin-right: auto; position: absolute;"),i.style.zIndex="100",i.style.width=t.getWidth()+"px",i.style.height=t.getHeight()+"px",i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="center",i.style.backgroundImage="url('data:image/gif;base64,R0lGODlhIAAgAKUAAAQCBISChERCRMTCxCQiJGRiZKyqrOTi5BQSFFRSVDQyNHRydJSSlNTW1AwKDIyKjExKTMzKzCwqLGxqbBwaHFxaXDw6PHx6fLy+vPz+/JyanAQGBISGhERGRMTGxCQmJGRmZLSytOTm5BQWFFRWVDQ2NHR2dJSWlNza3AwODIyOjExOTMzOzCwuLGxubBweHFxeXDw+PHx+fAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQAzACwAAAAAIAAgAAAG/sCZcEgkphiqVHHJbAotoZDCSRUqGDAiNFQiBjCW6rCi0bSGpWhXGIuwTGLh66QJAJ5q4cbAihDiQmQnHXhcQjAsLAuAQikqGgxKaYYIAywYSk4fECNEHWUVMwoqKmcyfQlEEhwCRBcyMhAOQgAyJyRFAAseBnczCBwiIg1ECQEBMiYldwSdTAQSMxsFDcIiKkUfLscyEy9iChjWA61LABYmARfOVB8HIigTvk0pK4RxHA8IjIDzRQ4vAgqkwE/ACggHD6ZIAGJCw4Yr+LHIQLFiBBIgQBTQCCIVowgVLQIk8ILkC4KMDK5YeXAfv5dENrSIFqdFiw1UAGyCIEtMjAqeEAj4G0JBAM8VMVxSSWH0YAx2Qlok7PDn1ywmKZQAINBhJYQzQ4DepBUDAk0im2IM2SDh4D0hI1pcFULg4BkEMZ6KOli1UQuoSzZ07YCTAsJODgbjZNQCYVXDK5zV/cqoHgQBvkYcdAbAIIRMYqRyInqYNOU4hsHC3UxEQQfA/CDDhhkzhoXFYoIAACH5BAkJADEALAAAAAAgACAAhQQCBISChERCRMTCxCQiJGRiZKSmpOTm5BQSFFRWVDQyNHRydLS2tMzOzAwKDJSSlExKTCwqLKyurPz6/BwaHHx6fMzKzGxubFxeXDw6PLy+vJyanAQGBERGRMTGxCQmJGRmZKyqrOzu7BQWFFxaXHR2dLy6vNTW1AwODJSWlExOTCwuLLSytPz+/BweHHx+fDw+PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+wJhwSCSiKhVHcclsChWb1MpJFUZKKiJ0Mx0uDIrqUBV4fYaKFBfNYIHEwtErcAE8N+sYZ8OSuOBCEHNhMVBSQgksboBCDhUvSTEreFMIBiwGSk4uGQhaZVkRL2YxF4odRB8lGUQFICAZHEIAFy+oRAAgIQ92MUcWDRpEMK8gGBF2FJ5MLmccJBoNwBVFBCTFCSNiKyHSDSGsSwAKrgXLVAQeDQMkvU0OMOFiJRUojPdMHCP7/OdwMAI6BBQgAAUMFRAQIoRxz8SBhxBNCEhIUYU8OA4hPmSgj8IIj8ruZRAIgaAAf/hmAeKwIgIgNSiLAPgAoaYmKhEmtBCxQNaJEgoTE8KIuSTDiRZIT0AoskJhBwJCENwsgsIeLRFIW2wgUhPCCp8AYEBwWYQmwzgbdIogMmLFVAIIK8GAoU0BQqhDVqRY6oRDBxUdZFFIqM3B38D3ViTEO1iFthhwvTJCgVBArxEIHwMQgNAenKYQHsdoLHqwZDiDu8TJrKWD6JSkU1LhEM+nmCAAIfkECQkANQAsAAAAACAAIACFBAIEhIKEREJExMLEJCIk5OLknJ6cZGJkFBIUNDI09PL0lJKUVFZUdHZ01NLUrK6sDAoMjIqMTEpMLCos7OrsbGpsHBocPDo8/Pr8pKaknJqc3NrcBAYEhIaEREZEzM7MJCYk5ObkpKKkZGZkFBYUNDY09Pb0lJaUXFpcfH581NbUtLK0DA4MjI6MTE5MLC4s7O7sbG5sHB4cPD48/P78AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv7AmnBIJEJGI0hxyWwKJ4EUyEkVElAz4iQVmA4PrVd1OEPKhlDpMKHRMMZCxKjCADy5Xk5Ac7LAhRdIE3ddQhInbn9CECgjBxw1W4UsCxotSk4WEyxEL0hZIBUjBDUoBhpZQwQjCUQeLhIvkDUAKAclRQAMJyl2NSwVDysZRAkSsB6kNQicTBakAC4ZK9QxRSQCsC4zCGMgJ9QrJ7hLACCvEphUBMIZLrNNHAmDcHPNivhFHCT8/d2KJWYIHAhhhrZjElL9EfGhoUMRAhBqu4Avg8MPAxyI2GeBREcL//6UuCCA5IUL9/IN8TWGwwt6YzpECMnEnISb6pyAKBBiw5QIeEQsRDzGbUyCASGSDhBQ5IW2ZHFyEgGBi8MBFUlDRCByM9YsADMkwBQCoIUJB74QROCpggiJFzkJwBKDQCCJGgZo0KigpQNTJxxeeYBk4dhdCwpoUKA55sUxZYVd3K3RQO8CRSxgCfBFAtZkCBtoYBhLxamEyTUio3Zh+U9hMUM6nyYiAoYElUNU4wY84wJQKkEAACH5BAkJAC4ALAAAAAAgACAAhQQCBISChERCRMTCxCQiJGRmZOTi5BQSFKyurDQyNFRSVNTW1HR2dJSSlAwKDExKTMzKzCwqLBwaHDw6PGxubPz+/Ly+vFxaXHx+fJyanAQGBIyOjERGRMTGxCQmJGxqbOTm5BQWFLSytDQ2NNza3Hx6fJSWlAwODExOTMzOzCwuLBweHDw+PFxeXAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJdwSCQ6FChNcclsCleFz8pJFUo4KiKhUJgOFSVCdahCPULDbXcYwWAeY+HJLAA8P2sXgBLAoOMuKg8oYi5QHxJCLH1wgC4aDw8cSmpTDiUYJUpOEhEnWigoES4SCgqJKH0JRCsXWUMcZiqbACwPo0QAHBgfdi4nFyYZG0QJg5KFBw5NIYkAAhsZ0i1FIQJmKCwHYwQY0iYBr0UAHrEPy1USwhuTVBoJuGMKLZ+O9ksaIfr7244qIwADOmCB7RgLew1EKFy4QcAxbBMQLmSYT0KzZv0A/QsIEN29j49UxKvCoERGJuQinRuzAgIECxc2FZHgcJC2MSoQQEiRAkF9RCJlBnFI5rGIhywALlhwmaIEEZWzhNS6NQ6DAQu+TpRwaYFICBVFCchywYHnwQ0gQFAb4oHBQScaYrVTUKECnBAkQCw4iXNQIbp2hVBIG8DRnAd1hABupAGCAQMeNJr542IxLMKAJDwQV7luIyENSAgAqdgzaWYpINQbEwQAIfkECQkANQAsAAAAACAAIACFBAIEhIKEREJExMLEJCIkZGJkpKak5ObkFBIUNDI0dHJ0VFZUtLa0lJaUzM7M9Pb0DAoMTEpMLCosbGpsrK6sHBocPDo8fHp8zMrM7O7sXF5cvL68nJ6cBAYEjIqMREZExMbEJCYkZGZkrKqsFBYUNDY0dHZ0XFpcvLq8nJqc1NbU/P78DA4MTE5MLC4sbG5stLK0HB4cPD48fH589PL0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv7AmnBIJHZkMkBxyWwKK5EWyUl9flxEqJQo0MSqQ1crMhWSxuUaQSSygIWssUBZO29rgMWkgHgLXVEET1FlCSIFbn41HRERHx01WlMQGhMakE4VEixEBC0tEnVIUwKHoUNQIUQfYy6YADIRp0QWBQt0EBEzMyZECVGOgjUIEE0sUwAlJgEzAS1FJAJjLTJ9VTEvzAEvwkUAIawRxVUkFwEmFnRNHQmzVY3jivJFHST299Z+Ei78/RAy04DJkHchhcGDFwQAm5bIz4yDBhtcqFeBRMUK+d6E6OdvnschHVy4ozJhAicn3xqJAxODAgwDLTAVqaAwSjUwIRrA2NmgRI0RMVE+CLOgikkMLABaGNgJ4wURla6EAFDxwIM3BSBG0GExwaUBIiRcxKvxYsWKBjUEoEDhZoYDDAuIxJjg0wmJDCto9Ilw4MCHYQMcoDjpp4FZBUI+9P1bQ8PbXn5cmFWBia9fIRAoYMDQrUoKsxGGWGacdjNkMC1opHi6mEiADQ09Whbw0QmCtYSrBAEAIfkECQkANgAsAAAAACAAIACFBAIEhIKEREJExMLEJCIkZGJknJ6c5ObkFBIUNDI0VFZUdHJ0lJKU1NLUrKqs9Pb0DAoMTEpMLCosbGpsHBocPDo83NrcjIqMpKak7O7sXF5cfH58nJqctLK0/P78BAYEREZEzM7MJCYkZGZkpKKkFBYUNDY0XFpcdHZ0lJaU1NbUrK6s/Pr8DA4MTE5MLC4sbG5sHB4cPD483N7cjI6M9PL0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv5Am3BIJH5kMkBxyWwKKRFXyUl9gl5EqJSYAE2rwpcr8rWVxmWtBCxsjQVKs2trAwgikRY7HCU8o18EY1h7Nh94IB82WlMQIC6JVBQSekOCLmslSFMJeH5DCDIxRI8RL4p1MhFrRRIRMkMQFQUjGlxRESCfCBBNLXoALxojxLBEJQJjLjIIYCUKIxMjCp9FACKlvVUIxAUvcU0fCaxgFRWohelFHyXt7s2FBCLz9BAyyrjGexMbAf4BG0bcweeiQjp+APsFGMGOQgmHFODtkUdPBAFtS8Cpc0KBA409J05UCocig4cH1ZyUSOEx0hIXFjzIbGACjIgAHHIGIDSEhJFMDxkmKEqQkkgMEXUE0MjJwdaQGh5YMID3YcCMDdYKrGAQp8UJlh+HuEhBzkaBAwcu2DCBgUQCGzA6dIhgVAFPJghUHLDQTECIEAYRYOiAASObC2gLCPELWIiCDitGFJKAdgAqxgbrcIA8ik0AtAKG+B2gr4JcyWwiWAi7+G9mIQsw1NwoRIZr2k4QkCAxskoQACH5BAkJADIALAAAAAAgACAAhQQCBISChERCRMTCxCQiJGRiZOTi5KyurBQSFNTS1DQyNFRSVHR2dJSSlAwKDExKTMzKzCwqLGxqbBwaHNza3Dw6PIyOjPz+/Ly+vFxaXHx+fJyanAQGBISGhERGRMTGxCQmJGRmZOTm5LSytBQWFNTW1DQ2NFRWVHx6fJSWlAwODExOTMzOzCwuLGxubBweHNze3Dw+PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJlwSCRyYjFAcclsCiePFclJfXpaRKiUqPBMq8LW6vGVkcZlbQQsVI0FSvNqKwMIHg8VOxwlPKNfBGNYezIceB4cMlpTDh4riVQTEXpDgitrJEhTCnh+QyotZTKPDy2KdTEPa0URDzFDHBFjHlxRDx6fCA5NKnoABHiDRSQCYysxCGAIMccxE0wAIKW8VSpRuXFNHAqsYBGnheJMCLfHAuITL+vsHAkX8PEf4gshEvb2C+/x8POF9SEKBAyxoNycg+gKqSPwguELVEu0jXNCwkKAPVGqbZNAQQSMT1QQoNCAwoTEIR4+iFiJQQGYFy40BNDgAkSRBitFJCigpMWJiybq6lRgEGDmCiIwRBgIoKzOgQEuigA4kUJDHAcPZDIg4qGDNxkZILBAIUOBhQZYCmzYAGsIFJtOVGCAgEGZiREjTMhQ0WCDBY1sUIjNIKTCiAN6Sa09UQiE2ANxDOcVwiHAhhTQAkOAUGHI3clhFu+JMUADEcmJhRSwQGiijLuIXcdtYKESmCAAIfkECQkANwAsAAAAACAAIACFBAIEhIKEREJExMLEJCIkZGJkpKKk5ObkFBIUNDI0dHJ0VFJUlJKU1NLUtLK09Pb0DAoMTEpMzMrMLCosbGpsrKqsHBocPDo8fHp8nJqc7O7sXF5c/P78BAYEjI6MREZExMbEJCYkZGZkpKakFBYUNDY0dHZ0VFZUlJaU3NrcvL68/Pr8DA4MTE5MzM7MLC4sbG5srK6sHB4cPD48fH58nJ6c9PL0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv7Am3BIJHZmM0BxyWwKLZEWyUl9fl5EqJSY+Eyrwlcr8r2RxmXtBCxkjQVKc2t7AwgiERY7HCU8o18EY1h7Nx14Hx03WlMQHy2JVC0Ma0OCLWskSFMJeH5DLC9lNzYcKwwIQgAzEZVEExEzQx0TYx9EBhy6GhRKCBBNLHoABHiDRS0puhwNJWAIM2MtMxZMHRilD65OLFEfBHFNJDUeexMvwGzhhUUIAh/v7xfsJPX2JB0qB/v8Duys0qJc0Mdvn79C0aIonOEOXoQ78wohsECCIsV1RDCya4KAhoI9My6ka9JhwwAJIKpVYSFCRIEJGm/MiCHBhYQRhKhYONFSxJoJGUUC2HSh4oSSCSqXVKwzoYAICiJkDRlgU4GeOihiFCgC4AONXkI6XHC6gcgME5+EtHDggMKNCTQwhLixgAYNZ0MQXADKbYSDEXoSZMiABQKGACZGsqHAtoWQBCgIC7lAI8CtPQRiOECh6IZgyYZgBKAxigpjB3g9o6jhKsToCHtKjIDBZXBOuibmbhzyIgOK27uXsIirmEoQACH5BAkJADUALAAAAAAgACAAhQQCBISChDw+PMTGxCQiJFxaXKSmpOTm5BQSFJSSlExOTDQyNGxqbNTW1Ly+vPT29AwKDIyKjERGRCwqLGRiZKyurBwaHJyanNze3Ozu7FRWVDw6PHRydAQGBISGhERCRMzOzCQmJFxeXKyqrBQWFJSWlFRSVDQ2NGxubNza3Pz+/AwODIyOjExKTCwuLGRmZLSytBweHJyenOTi5PTy9AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+wJpwSCR2BAJAcclsCi0tBclJFSpoFyJJ0ZoOFxJvtVZSqVpDqDQdnYyFLnOjI9x2hYBPq7V6Cy9mHE9RXgRcLn5CCBkqGVMkhDUQEgoSdE4SHiFEHGYlNSQfG1MLewREKy5iNRgHMx4IeA0PEUsTLQJDHRNcEkQJB8ENFEobm0wQsQAElFGIRBIDwQcOz1QIAgpcH6tDEAwprqdVK3stBEpOJAkBfhMul2PpiUsrSPcCJ/QIJP3+HSNACBwog54eLgg3GBA4YGCWRAKiSFSwYcUGUaI26EuEwAIJCx1JzKNHUhGKF+7gUelgwgCMChbGQJCIjsmJCzByJjh2LVuUFAHdOLyEYcBSDQLdhvCrsayZAms1RlSA8aIP0wAlTCzZQEFDug4uovgacoJBDCIfSlwoUCMEgxenBLx44WbIiglJUSW4wKLPhAABNkGg8EJEvDcFSsgY+zfAOBcvGGxIFENtgHQhAI8DoOEFhVhvRFy4YO0vB54E5k5+s4CFCCKNedb4QOFsSSGZA992AqEwBD9BAAAh+QQJCQAyACwAAAAAIAAgAIUEAgSEgoREQkTEwsQkIiRkYmSsqqzk5uQUEhRUUlQ0MjSUkpTU1tR0cnQMCgyMioxMSkzMyswsKiwcGhxcWlw8Ojx8enxsbmy8vrycmpzc3twEBgSEhoRERkTExsQkJiRkZmS0srT8/vwUFhRUVlQ0NjSUlpTc2tx0dnQMDgyMjoxMTkzMzswsLiwcHhxcXlw8Pjx8fnwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/kCZcEgkjlgRRHHJbAoTIhHESRV2Tg8iVEpUdEbV4eNwEAy3U+FoBWmFhRLyYPOMpgECduotHB9AdVwyHxArEnxCCAwHDEpoMhsQEB10TjAoBEQFZFkdLCxmLWyZQyktYEMDSA17kAMaMUsSEDBDGy2FHUQBEUgYCQAyCqRLKUoABB1sK25EMCG9EQaHVSkwK2wCqEUbLxgsAy5hCIUQBMFOCDENfC0tlWHoiMUKJfb2zXwII/z9GwshAgrMguhaOTYwAAoMSJCPwWW0UtS7VyLfm30TRkxAMEHevI9CUrwg0e4dlQ0dFmQwsc2Jg3LnmLQIkKFmDGLpYEhaAaOlgowCNTOogBHMhRImKfYgU8bG4gITGUg4EALgggVdRWbVEnIrF5EWLyYQKREjwAoZExIkECtqBc4UEnwWcYAiAIqpLkCAEOegwyR4b1YEiFFBCAG94gY1RTSi7AV0eUGQwiOpVRjBN4ccljxkTRs+ElCc1Yy4yxeQQyLjRD1XLWAqQQAAIfkECQkAOQAsAAAAACAAIACFBAIEhIKEREJExMLEJCIkZGJkpKKk5ObkFBIUNDI0dHJ0tLK0VFJU9Pb01NLUlJKUDAoMTEpMzMrMLCosbGpsrKqs7O7sHBocPDo8fHp8vLq8XFpc/P78nJqcBAYEjI6MREZExMbEJCYkZGZkpKak7OrsFBYUNDY0dHZ0tLa0VFZU/Pr83NrcDA4MTE5MzM7MLC4sbG5srK6s9PL0HB4cPD48fH58vL68nJ6cAAAAAAAAAAAAAAAAAAAAAAAAAAAABv7AnHBIJCI0qVZxyWwKI4eDwEkV1gYZIvQAIhoskeow85JghtDSVOjicB5ioUjyqnie0bWHxVlN4kIoZRt4XIFucIA5CDcvNwg5IAdqORczHCWQTicjNEQbdFkCSGc4bhRELTAmRBULCyNKOQAyAzFFAB8rLwBCHhMuEV1DCgsyCyQRvTCeTBMnswQgwS4wRScdrzIPImIINS7BAqxLHgwkKTIXYi0R7gS9TggxBYAwMHeK+ksQ9/4w3RSZGEjQhAcbHRIqzKKoRgRqDzEgVJgQhT5wDzPW6PcPoD4TF0CKjLevZI4WwQBNwEfFA4YMNmxoogIhIzwmImIEsBGAwoa6Kt+o1SA3hMHOAChO9DIha0kLJR6kUbM2JmaEfABUFDhTZEKEGkM8wHg4TE4EojlgjBgB9tvQtMEIpJqAll+BEQXuXHjIqqawfIAwrP1Tia8QAsGoxkGwdkM8E8HIARAQrGmVGmt/FnZBdG8ExVUIbFgjBPJZImPr6tvL2aQTDzUwAK4SBAAh+QQJCQAyACwAAAAAIAAgAIUEAgSEgoREQkTExsQkIiRkYmSkoqTk5uQUEhQ0MjRUVlSUkpR0cnS0srTU1tQMCgxMSkwsKixsamysqqz8+vwcGhw8OjyMjoxcXlycmpzk4uQEBgSEhoRERkTMzswkJiRkZmSkpqTs7uwUFhQ0NjRcWlyUlpR8fny8vrzc2twMDgxMTkwsLixsbmysrqz8/vwcHhw8PjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/kCZcEgkIgwGVXHJbApjHo/FSRWSJhKiIDodLhyC6lDSaJCGW+mwczgExEKYq2HaCNPdzeCg+cCFZA0rdx4DMYBtb38yKiENIUp4MhUpBylKTiwlFUQrZVkkBhMJMhdtBUQRJhBECxkmJQ9CGyYuqEQAJxooAEIIJhQvIkQFGa8XAr0fnEwELDIbLSIv1BlFLBzGGScwYhYO1C8prEsbHQsmJsxUEcEiDHZOKgUKf64ji3+9TA8f/v8E8iEYQbDgBgknAigMcAJEvhgrIESMGEMCwxMJG+YTAEGixxj9PkTwF6HbooEVRlRAUGFfvpdDHsToIiYCi3hNALAoAKIAkiYqKjwScEkERgkQSBXgq4IgRscVMZaiQdozQi8EspioQCADAIEOKyI+G8KzgIV4AJxGWPIBwqFZESJ2KBqD6xACYmU0jSojQcSAQ1SwkMrE3IoOdipIxPcALOJ8LCQCVrxiKV4IY+GoiJhMyIiISwEIiPizCgvQQyhLVYz5j+LMMj5DIJygA+GXqmFS2TATZ5UgADs=')",i.style.display="none",this._adContainer=t,this._vastTagAd=n,this._element=i,this._adContainer.insert(i),n.getLoaded())this._setupToShowOnLackOfData();else{this._show();r=this;n.onLoadFiata()})}};ut.prototype={_setupToShowOnLackOfData:function(){var n=this;this._vastTagAd.onWaitingForDataCide()})},_hide:function(){this._element.style.display="none"},_show:function(){this._element.style.display=""},dispose:function(){this._adContainer.remove(this._element)}};ft=function(n,t,i){var r,u;this._skipButton=new et(t,i);this._vastTagAd=n;this._disposed=!1;r=new f(this,this._onSkipButtonActivated);this._skipButton.onActivated(r.getValue());u=new f(this,this._onSkip);this._skipButton.onSkip(u.getValue());this._playStartedCallback=new f(this,this._onPlayStarted);n.onPlayStarted(this._playStartedCallback.getValue());this._timeChangedCallback=new f(this,this._onTimeChanged);n.onTimeChanged(this._timeChangedCallback.getValue());this._onTimeChanged()};ft.prototype={_onPlayShow()},_onTimeChanged:function(){this._disposed||this._skipButton.updateTime(this._vastTagAd.getCurrentTime())},_onSkipButtonActnull)},_kip()},dispose:function(){this._timeChangedCallback&&(this._vastTagAd.offTimeChanged(this._timeChangedCallback.getValue()),this._timeChangedCallback=null);this._vastTagAd.offPlayStarted(this._playStartedCallback.getValue());this._skipButton.dispose();this._disposed=!0}};et=function(n,t){function r(n){return"g367CB268B1094004A3689751E7AC568F-"+n}function u(n){t[n]&&(f._buttonElement.style[n]=t[n])}n.hasClass(r("inf-videoButtons-container"))||n.addClass(r("inf-videoButtons-container"));a(n.getDocument());this._waitingClassName=r("inf-playerButton")+" "+r("inf-skipButton");this._activeClassName=this._waitingClassName+" "+r("inf-skipButton-active");var f=this;this._buttonElement=document.createElement("div");this._buttonElement.innerText=t.skipOffset===0?"Skip >>":"Skip in "+t.skipOffset;this._buttonElement.className=this._waitingClassName;this._buttonElement.style.display="none";u("top");u("left");u("bottom");u("right");this._buttonElement.style.cursor="default";n.insert(this._buttonElement);this._adContainer=n;this._disposed=!1;this._options=t;this._activated=!1;this._activatedEvent=new i;this._skipEvent=new i};et.prototype={_activate:function(){function t(){n._disposed||n._skipEvent.trigger()}this._activated=!0;this._buttonElement.innerText="Skip >>";this._buttonElement.style.cursor="pointer";this._buttonElement.className=this._activeClassName;var n=this;this._buttonElement.addEventListener("click",t);this._buttonElement.addEventListener("touchstart",t);this._activatedEvent.trigger()},onSkip:function(n){this._skipEvent.addHandler(n)},onActivated:function(n){this._activatedEvent.addHandler(n)ay=""},updaed(n)},_onTimeChanged:function(n){var t,i;if(n>0&&this.show(),t=Math.round(this._options.skipOffset-n),t<=0){this._activate();return}i="Skip in "+t;this._buttonElement.innerText!==i&&(this._buttonElement.innerText=i)},dispose:function(){this._activatedEvent.removeAllHandlers();this._skipEvent.removeAllHandlers();this._adContainer.remove(this._buttonElement);this._disposed=!0}};ot=function(){function n(n,t,i,r){function f(n){return"g367CB268B1094004A3689751E7AC568F-"+n}var u,e;if(t.hasClass(f("inf-videoButtons-container"))||t.addClass(f("inf-videoButtons-container")),a(t.getDocument()),u=document.createElement("div"),u.className=f("inf-playerButton")+" "+f("inf-closeButton")+(i.showOnHover?" "+f("inf-hover"):""),e=document.createElement("div"),e.className=f("inf-closeButton-icon"),u.appendChild(e),t.insert(u),u.addEventListener("click",function(){n.skip()}),u.addEventListener("touchstart",function(){n.skip()}),i.showOnHover&&(r.getIsIE()||r.getIsEdge())){this._mouseEnterCallback=function(){u.style.display="block"};this._mouseLeaveCallback=function(){u.style.display="none"};t.onMouseEnter(this._mouseEnterCallback);t.onMouseLeave(this._mouseLeaveCallback)}this._buttonElement=u;this._adContainer=t}return n.prototype.dispose=function(){this._mouseEnterCallback&&(this._adContainer.offMouseEnter(this._mouseEnterCallback),this._adContainer.offMouseLeave(this._mouseLeaveCallback));this._adContainer.remove(this._buttonElement)},n}();st=function(n,F-"+n}function s(){var t=n.getVolume();n.getVolume()===null||n.getVolume()===0?h():(o=t,c())}function h(){e.className=u("inf-volumeButton-icon-on")}function l(){var t=n.getVolume();t!==null&&(t===0?n.setVolume(o):n.setVolume(0))}var f,e,o;if(t.hasClass(u("inf-videoButtons-container"))||t.addClass(u("inf-videoButtons-container")),a(t.getDocument()),f=document.createElement("div"),f.className=u("inf-playerButton")+" "+(i.position==="top"?u("inf-volumeButton-top"):u("inf-volumeButton"))+(i.showOnHover?" "+u("inf-hover"):""),e=document.createElement("div"),f.appendChild(e),t.insert(f),i.showOnHover&&(r.getIsIE()||r.getIsEdge())){this._mouseEnterCallback=function(){f.style.display="block"};this._mouseLeaveCanone"};t.onMouseEnter(this._mouseEnterCallback);t.onMouseLeave(this._mouseLeaveCallback)}o=1;s();n.onVolumeChanged(s);f.addEventListener("click",l);this._buttonElement=f;this._adContainer=t};st.prototype={dment)}};ii=function(){function n(n){this._frequencyMultiple=n;this._changeEvent=new i;this._intervalHandle=null;this._lastReportedValue=null;this._paused=!1;this._notifiedAfterPause=!1}return n.prototype.activate=function(n){var t=this,i;if(isNaN(n.getDuration()))throw"Media element source is not loaded. Duration is unknown";if(!(n.getCurrentTime()>=n.getDuration())){this._paused=n.getPaused()===!0;n.ose=!1});n.oned=!1});i=n.getDuration()*1e3/this._frequencyMultiple;this._intervalHandle!=null&&clearInterval(this._intervalHandle);this._lastReportedValue=null;this._intervalHandle=setInterval(function(){if(t._paused){if(t._notifiedAfterPause)return;t._notifiedAfterPause=!0}(n.getCurrentTime()>=n.getDuration()&&t._intervalHandle!=null&&(clearInterval(t._intervalHandle),t._intervalHandle=null),t._lastReportedValue!==n.getCurrentTime())&&(t._lastReportedValue=n.getCurrentTime(),t._changeEvent.trigger(t._lastReportedValue))},i<1?1:i)}},n.prototype.dispose=function(){this._intervalHandle!=null&&(clearInterval(this._intervalHandle),this._changeEvent.removeAllHandlers())},n.prototype.setNotificationFrequency=function(n){this._frequencyMultiple=n},n.prototype.onChange=function(n){this._changeEvent.addHandler(n)},n}();ht=function(){function n(n,r,u){this._tag=n;this._volumeButton=null;this._started=!1;this._volumeButtonMode=t.VideoButtonDisplayMode.never;this._playStartButtonIconType=c.Play;this._volumeButtonPosition="bottom";this._loadWithCredentials=!0;this._audioMode=t.VideoAudioMode.muted;this._closeButton=null;this._closeButtonMode=t.VideoButtonDisplayMode.never;this._player=null;this._log=null;this._failedToStartUnmuted=null;this._clientInfo=new kt(new UAParser);this._disposed=!1;this._skipped=!1;this._playEnded=!1;this._loadError=null;this._loadingIndicator=null;this._disposeActions=[];this._loaded=!1;this._timeUpdateTracker=new ii(10);this._playEndedEvent=new i;this._playStartedEvent=new i;this._pauseEvent=new i;this._resumeEvent=new i;this._firstQuartileEvent=new i;this._midpointEvent=new i;this._thirdQuartileEvent=new i;this._enterFullscreenEvent=new i;this._exitFullscreenEvent=new i;this._clickThroughEvent=new i;this._clickEvent=new i;this._timeChangedEvent=new i;this._volumeChangedEvent=new i;this._skippedEvent=new i;this._loadFinishedEvent=new i;this._waitingForDataChangedEvent=new i;this._showPlayButtonOnPause=!0;this._activeWaterfalls=[];this._isMuted=null;this._shouldShowPlayStartButton=!1;this._log=u;this._adContainer=r;this._vpaidPlayer=new w(r,this._clientInfo,new s(u.getName()+" > VPAIDPlayer",{level:u.getLevel()}));this._players=[new ti(r,this._clientInfo,new s(u.getName()+" > PlainVideoPlayer",{level:u.getLevel()})),this._vpaidPlayer];this._mediaFileSelectionOrder=new it(r,this._players);this._vastErrorCode={noSupportedMedia:403,errorDisplayingMedia:405,vpaidError:901}}return n.prototype.load=function(){this._loadingIndicator=new ut(this,this._adContainer);var n=this;return new r(function(t,i){var r=function(t){n._loaded=!0;n._loadError=t||"Unknown Error";n._loadFinishedEvent.trigger();i(n._loadError)};if(n._tag==null||n._tag.length===0){r("Url is empty");return}if(n._disposed){r("Aborted");return}n._log.info("Start loading vast tag");n._downloadTag(function(i,u){if(n._log.info("Vast tag load finished"),i==null){r(u.message);return}if(!i.ads||i.ads.length===0){r("No Ads were found in a tag");return}if(n._disposed){r("Aborted");return}n._extendObjects(i);var f=new v;n._activeWaterfalls.push(f);i.ad(t)}}).forEach(function(n){f.addAction(n)});f.onAction "+t)});n._log.info("Attempting to find ad in vast tag");f.run().then(function(i){n._log.info("Successfully found ad in vast tag");var r=n._setupVastTagCreativeTracking(i);n._setupEvents(i,r);n._shouldShowPlayStartButton&&n._showPlayStartButton(i);n._player=i;n._loaded=!0;n.setCloseButtonMode(n._closeButtonMode);n.setSkipButton(n._skipButtonOptions);n._loadFinishedEvent.trigger();t()},function(n){var t=n==="Aborted"?n:n?"Failed to find playable MediaFile. Reason: "+JSON.stringify(n):"Failed to find playable MediaFile.";r(t)})})})},n.prototype.setPlayer=function(n){this._vpaidPlayer=null;this._players=[n]},n.prototype.getLoadWithCredentials=function(){return this._loadWithCredentials},n.prototype.setLoadWithCredentials=function(n){this._loadWithCredentials=n},n.prototype._downloadTag=function(n){if(this._tag&&this._tag.indexOf("<?xml ")===0){var t;try{window.DOMParser?t=(new DOMParser).parseFromString(this._tag,"text/xml"):(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(this._tag))}catch(i){this._log.error("Failed to parse xml content");n(null,{message:"Invalid XML Document. Details: "+i});return}DMVAST.client.get("",{response:t,withCredentials:this._loadWithCredentials},n)}else{if(this._clientInfo.getIsIE()&&this._clientInfo.getBrowserVersion()<=9){n(null,{message:"Unsupported browser. IE9 or lower are not supported"});return}DMVAST.client.get(this._tag,{withCredentials:this._loadWithCredentials},n)}},n.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._players.forEach(function(n){n.dispose()}),this._activeWaterfalls.fose()}),this._disposeActions.f){n()}),this._disposeActions=[],this._volumeButton&&this._volumeButton.dispose(),this._closeButton&&this._closeButton.dispose(),this._skipButton&&this._skipButton.dispose(),this._loadingIndicator&&this._loadingIndicator.dispose(),this._timeUpdateTracker&&this._timeUpdateTracker.dispose(),this._player=null)},n.prototype.awaitAdLoaded=function(n,t){if(this.getLoaded())this.getLoadError()!=null?t(this.getLoadError()):n();else{var i=this;this.onLoadFinished(function(){i.getLoadError()!=null?t(i.getLoadError()):n()})}},n.prototype.getLoaded=function(){return this._loaded},n.prototype.getPlayEnded=function(){return this._playEnded},n.prototype.getClieect()},n.prototype.getWaitingForData=function(){return this._player?this._player.getWaitingForData():!1},n.prototype.setVPAIDAdLoadTimeout=function(n){this._vpaidPlayer.setLoadTimeout(n)},n.prototype.setVPAIDAdStartTimeout=function(n){this._vpaidPlayer.setStartTimeout(n)},n.prototype.onWaitingForDataChanged=function(n){return this._waitingForDataChangedEvent.addHandler(n)},n.prototype.offWaitingForDataCer(n)},n.prototype.getLoadError=function(){return this._loadError},n.prototype.getDisposed=function(){return this._disposed},n.prototype.hide=function(){this._adContainer.setOffscreen(!0)},n.prototypn(!1)},n.prototype.skip=function(){if(!this._loaded)throw"Cannot skip ad that is not loaded";return this._skipped||this._disposed?r.resolve():(this._skipped=!0,this._player.skip())},n.prototype.setShowPlayButtonOnPause=function(n){this._showPlayButtonOnPause=n;this._player&&this._started&&this._setupPlayButton(this._player)},n.prototype.setShowPlayStartButton=function(n){this._shouldShowPlayStartButton=n;n||this._player==null||this._started||this._hidePlayButton()},n.prototype.setPlayStartButtonIconType=function(n){this._playStartButtonIconType=n},n.prototype.setSkipButton=function(n){(this._skipButtonOptions=n,this._player!=null)&&(this._skipButton&&(this._skipButton.dispose(),this._skipButton=null),this._skipButtonOptions!=null&&(this._skipButton=new ft(this,this._adContainer,this._skipButtonOptions)))},n.prototype.setCloseButtonMode=function(n){(this._closeButtonMode=n,this._player!=null)&&(this._closeButton&&(this._closeButton.dispose(),this._closeButton=null),n!==t.VideoButtonDisplayMode.never&&(this._closeButton=new ot(this,this._adContainer,{showOnHover:n===t.VideoButtonDisplayMode.onHover},this._clientInfo)))},n.prototype.getCloseButtonMode=function(){return this._closeButtonMode},n.prototype.setVolumeButtonMode=function(n,i){(this._volumeButtonMode=n,this._volumeButtonPosition=i||"bottom",this._player!=null&&this._started)&&(this._volumeButton&&(this._volumeButton.dispose(),this._volumeButton=null),n!==t.VideoButtonDisplayMode.never&&(this._volumeButton=new st(this,this._adContainer,{showOnHover:n===t.VideoButtonDisplayMode.onHover,position:this._volumeButtonPosition},this._clientInfo)))},n.prototype.getVolumeButtonMode=function(){return this._volumeButtonMode},n.prototype.setAudode=n},n.prototype.getAudioMode=function(){return this._audioMode},n.prototype.getVolume=function(){return this._player?this._player.getVolume():null},n.prototype.getFailedToStartU:null},n.prototype.getCurrentTime=function(){return this._player?this._player.getCurrentTime():null},n.prototype.getDu:null},n.prototype.setVolume=function(n){if(n<0||n>1)throw"Invalid volume value. Must be between 0 and 1";return this._player?this._player.getVolume()===n?!0:this._player.setVolume(n):null},n.prototype.getAdConainer},n.prototype.enterFull():!1},n.prototype.onEnterFullscreen=function(n){this._enterFullscreenEvent.addHandler(n)},n.prototype.offEnterFullscreen=function(n){this._enterFullscreenEvent.removeHandler(n)},n.prototype.onExitFullscreen=function(n){this._exitFullscreenEvent.addHandler(n)},n.prototype.offExitFullscreen=function(n){this._exitFullscreenEvent.removeHandler(n)},n.prototype.onVolumeChanged=function(n){this._volumeChangedEvent.addHandler(n)},n.prototype.onClickThrough=function(n){this._clickThroughEvent.addHandler(n)},n.prototype.onClick=function(n){this._clickEvent.addHandler(n)},n.prototype.createReplay=function(t,i){var r,u;if(this._player==null||(r=this._player.getMediaFile(),r.getIsVPAID()))return null;var f=new ui,e=this._player.getMediaFile().creative.videoClickThroughURLTemplate,o=this._player.getMediaFile().creative.videoClickTrackingURLTemplates;return f.setMediaFiles([{delivery:r.deliveryType,type:r.mimeType,width:r.width,height:r.height,maintainAspectRatio:r.maintainAspectRatio,scalable:r.scalable,apiFramework:r.apiFramework,url:r.fileURL}],e,null,o),u=new n(f.getValue(),t,i),u.setVolumeButtonMode(this._volumeButtonMode,this._volumeButtonPosition),u.setCloseButtonMode(this.getCloseButtonMode()),u.setAudioMode(this.getAudioMode()),u.setShowPlayStartButton(!0),u.setPlayStartButtonIconType(c.Replay),u},n.prototype._setupVastTagCreativeTracking=function(n){var r=n.getMediaFile(),u=r.creative.ad,f=r.creative,t=new DMVAST.tracker(u,f),i;this._vastTracker=t;i=this;n.onPlayStarted(function(){var r=n.getDuration(),i;t.setDuration(r);t.load();i=n.getCurrentTime();t.setProgress(i===0?1e-6:i)});this._isMuted=n.getVolume()===0;t.setMuted(this._isMuted);n.onVolumeChanged(function(){var r=n.getVolume()===0;i._isMuted!==r&&(i._isMuted=r,t.setMuted(r))});n.onPause(function(){t.setPaused(!0)});n.ond(!1)});n.onClick(function(n){if(n.playerHandles)t.on("clickthrough",function r(u){t.removeListener("clickthrough",r);try{window.open(n.url||u)}catch(f){}setTimeout(function(){i._clickThroughEvent.trigger()},0)});else setTimeout(function(){i._clickThroughEvent.trigger()},0);t.click()});n.onPlayStarted(function(){var u=Object.getOwnPropertyNames(t.trackingEvents)===0})!==undefined,r;r=u?100:Math.max(10,Math.ceil(n.getDuration()));i._timeUpdateTracker.setNotificationFrequency(r);i._timeUpdateTracker.onss(n)});i._timeUpdateTracker.activate(n)});n.onPlayEnded(function(){t.complete()});n.onEnterFullscreen(function(){t.setFullscreen(!0);t.setExpand(!0);i._enterFullscreenEvent.trigger()});n.onExitFullscreen(function(){t.setFullscreen(!1);t.setExpand(!1);i._exitFullscreenEvent.trigger()});return t},n.prototype._showPlayStartButton=function(n){this._showPlayButton();var t=this;n.onPlaySed(i)})},n.prototype._setupPlayButton=function(n){if(this._hidePlayButton(),!this._showPlayButtonOnPause){this._showPlayButtonCallback&&(n.offPause(this._showPlayButtonCallback),this._showPlayButtonCallback=null);this._hidePlayButtonCallback&&(n.offResume(this._hidePlayButtonCallback),this._hidePlayButtonCallback=null);return}this._showPlayButtonCallback=new f(this,this._showPlayButton).getValue();this._hidePlayButtonCallback=new f(this,this._hidePlayButton).getValue();n.onPause(this._showPlayButtonCallback);n.onResume(this._hidePlayButtonCallback)},n.prototype._showPlayButton=function(){this._playButton&&this._playButton.dispose();var n=this;this._playButton=new rt(this._adContainer);this._started||(this._playButton.iconType=this._playStartButtonIconType);this._playButton.olay()})},n.prototype._hidePlaynull)},n.prototype._setupEvents=function,0)}}var i=this;n.onPlayEnded(function(){i._log.info("Ad completed");i._playEnded=!0;setTimeout(function(){i._playEndedEvent.trigger()},1)});n.onPause(function(){i._log.info("Ad paused");i._pauseEvent.trigger()});n.onResume(function(){i._log.info("Ad resumed");i._resumeEvent.trigger()});this._timeUpdateTracker.onChange(function(){i._timeChangedEvent.trigger()});n.onClick(function(){i._clickEvent.trigger()});n.onVolumeCger()});n.onWaitingForDataChanged(function(){i._waitingForDataChangedEvent.trigger()});n.onSkipped(function(){i._log.info("Ad skipped");i._skipped=!0;i._vastTracker.skip();i._skippedEvent.trigger();i.dispose()});t.on("firstQuartile",r(function(){i._firstQuartileEvent.trigger()}));t.on("midpoint",r(function(){i._midpointEvent.trigger()}));t.on("thirdQuartger()}))},n.prototype._applyAudioMode=function(){function i(){n.setVolme(0)}if(this._audioMode===t.VideoAudioMode.muted)return this.setVolume(0);var n=this;if(this._audioMode===t.VideoAudioMode.audioOnMouseOver){this._adContainer.onMouseEnter(i);this._adContainer.onMouseLeave(r);return this._disposeActionve(r)}),!0}return this.setVolume(1)},n.prototype._extendObjects=function(n){n.ads.forEach(function(n){n.creatives&&n.creatives.forEach(function(t){t.ad=n;t.mediaFiles&&t.mediaFiles.forEach(function(n){n.creative=t;n.getIsVPAID=function(){var t=n.mimeType==null?"":n.mimeType.toLowerCase();return(t==="application/x-javascript"||t==="application/javascript")&&n.apiFramework==="VPAID"}})})})},n.prototype.getMedile()},n.prototype.onPlayEnded=function(n){this._playEndedEvent.addHandler(n)},n.prototype.onPlayStarted=function(n){this._playStartedEvent.addHandler(n)},n.prototype.offPlayStarted=function(n){this._playStartedEvent.removeHandler(n)},n.prototype.onPause=function(n){this._pauseEvent.addHandler(n)},n.prototype.onResume=function(n){this._resumeEvent.addHandler(n)},n.prototype.onFirstQuartile=function(n){this._firstQuartileEvent.addHandler(n)},n.prototype.onMidpoint=function(n){this._midpointEvent.addHandler(n)},n.prototype.onThirdQuartile=function(n){this._thirdQuartileEvent.addHandler(n)},n.prototype.onSkipped=function(n){this._skippedEvent.addHandler(n)},n.prototype.onLoadFinished=function(n){this._loadFinishedEvent.addHandler(n)},n.prototype.offLoadFinished=function(n){this._loadFinishedEvent.removeHandler(n)},n.prototype.onTimeChanged=function(n){this._timeChangedEvent.addHandler(n)},n.prototype.offTimeCer(n)},n.prototype._loadAd=function(n){var t=this;return new r(function(i,r){var u,o,e,s,h,f;if(!n.creatives||n.creatives.length===0){r("Ad contains no creatives");return}if(u=n.creatives.gth>0}),u.length===0){r("Ad contains no creatives with media files");return}if(o=u.iles)},[]),e=t._filterNonPlayableMediaFiles(o),e.length===0){s=new DMVAST.tracker(n,u[0]);s.errorWithCode(t._vastErrorCode.noSupportedMedia);r("No supported media files are found");return}h=t._mediaFileSelectionOrder.apply(e);f=new v;t._activeWaterfalls.push(f);h.f(n)})});f.run({i(n)})oad")})})},n.prototype._loadMediaFile=function(n){var t=this;return new r(function(i,r){var u=t._players.find(function(t){return t.canPlay(n)==="probably"})||t._playeraybe"});if(u===undefined||u==null){r("Unexpected. No player can play specified media file");return}u.loadMediaFile(n{i(u)}).catch(function(i){var f=new DMVAST.tracker(n.creative.ad,n.creative),e=u instanceof w?t._vastErrorCode.vpaidError:t._vastErrorCode.errorDisplayingMedia;f.errorWithCode(e);r(i)})})},n.prototype._filterNonPlayableMediaFiles=function(n){var t=this;return n.filter(function(n){return t._player!==""})!==undefined})},n.prototype.play=function(){var n=this;return new r(function(i,r){if(!n.getLoaded()){r("There is no media file loaded to play");return}n._log.info("Attempting to "+(n._started?"resume":"start")+" ad");n._player.play().then(function(){if(!n._started){n._started=!0;n._setupPlayButton(n._player);n.setVolumeButtonMode(n._volumeButtonMode,n._volumeButtonPosition);var r=n._applyAudioMode();n._audioMode===t.VideoAudioMode.audio&&(r===!1&&n._log.info("Attempt to play unmuted was blocked. Video was muted"),n._failedToStartUnmuted=r===!1);n._log.info("Ad started successfully");n._playStartedEvent.triggerOnce()}i()}).catch(function(t){if(typeof t=="string"&&t.indexOf("NotAllowedError")===0){n._log.info("Since muted video play attempt was blocked awaiting for user to manually start the ad.");n._awaitManualStart().then(i,r);return}n._log.error("Failed to start/resume ad. Reason: "+t);r(t)})})},n.prototype._awaitManualStart=function(){var n=this;return new r(function(t,i){var r=new rt(n._adContainer);r.onClick(function(){r.dispose();n.play().then(t,i)})})},n.prototype.pause=function(){return this._player==null?r.reject("There is no media file loaded"):this._player.pause()},n}();typeof g367CB268B1094004A3689751E7AC568F=="undefined"&&(g367CB268B1094004A3689751E7AC568F={});g367CB268B1094004A3689751E7AC568F.AuctionParticipant=function(n,i,r,u,f){if(this.rank=r.Rank,this.adItem=r,this.type=r.MediaSourceType==t.MediaSourceType.VideoTag?"tag":r.MediaSourceType==t.MediaSourceType.Video?"video":null,this.clickUrl=i,this.type==null)throw"Unsupported type";this._adContainer=u;this._vastTagAd=new ht(n,u,f);this._vastTagAd.hide();this._loadStarted=!1};g367CB268B1094004A3689751E7AC568F.AuctionParticipant.prototypeoad()},dDOM()},getLoadedVastTagAd:function(){return this.getHasFill()===!0&&!this.getDisposed()?this._vastTagAd:null},getHasFill:function(){return this._vastTagAd.getLoadError()!=null?!1:this._vastTagAd.getLoaded()?!0:null},getDisposed:function(){return this._vastTagAd.getDisposed()},getLoading:function(){return this._loadStarted&&!this._vastTagAd.getLoaded()&&!this._vastTagAd.getDisposed()},getLoadStats:function(){return{loaded:this._vastTagAd.getLoadError()!=="Aborted",success:!0,empty:this._vastTagAd.getLoadError()!=null}}};g367CB268B1094004A3689751E7AC568F.VastTagAuction=function(n,t,r){this._currentWinner=null;this._currentWinnerPlayer=null;this._secondBestTag=null;this._state="Initial";this._processedTags=0;this._options=t;this._onFinishedCallback=null;this._ocvFrame=null;this._reporting=r;this._auctionTracked=!1;this._auctionCompleteEvent=new i;this._participantLoadedEvent=new i;this._timeout=null;this._timeoutHandle=null;this._log=new s("VastTagAuction",{enableSendToServer:!1});var u=function(n,t){return t.rank-n.rank};this._participants=n.slice(0).sort(u)},function(){g367CB268B1094004A3689751E7AC568F.VastTagAuction.prototype={currentWinner:function(){return this._currentWinner},currentSecondBid:function(){return this._secondBestTag},setTimeout:function(n){if(this._state!=="Initial")throw"Attempt to set timeout on auction that was already started";this._timeout=n},stop:function(){if(this._deactivateTimeoutCounter(),this._state!="Finished"){if(this._state=="Initial"){this._state="Finished";return}this._state="Finished";this._participants.filter(function(n){return n.getLoading()}).forEach(function(n){n.dispose()})}},dispose:function(){this.stop();this._participants.filter(function(n){return!n.getDisposed()}).forEach(function(n){n.dispose()})},onAuctionComplete:function(n){this._auctionCompleteEvent.addHandler(n)},offAuctionComplete:function(n){this._auctionCompleteEvent.removeHandler(n)},onParticipantLoaded:function(n){this._participantLoadedEvent.addHandler(n)},offParticipantLoaded:function(n){this._participantLoadedEvent.removeHandler(n)},state:function(){return this._state},_handleVastTagProcessed:function(n){this._processedTags++;this._stopLoadingNotRelevantTags();this._updateWinnerAndSecondBestBid(n);this._participantLoadedEvent.trigger(n);this._checkFinished()},_checkFinished:function(){this._participants.length===this._processedTags&&this._onAuctionComplete()},_stopLoadingNotRelevantTags:function(){var n,t;this._participants.filter(function(n){return n.getHasFill()===!1&&!n.getDisposed()}).forEach(function(n){n.dispose()});this._options.maxTags&&(n=this._participants.findIndexOfNth(function(n){return n.getHasFill()===!0},this._options.maxTags),n>=0&&n+1<this._participants.length&&this._participants.slice(n+1).sed()}).forEach(function(n){n.dispose()}));t=this._participants.fin===!0});t>=0&&t+1<this._participants.length&&this._participants.slice(t+1).filter(function(n){return n.getHasFill()===!0&&!n.getDisposed()}).forEach(function(n){n.dispose()})},start:function(){if(this._state=="Initial"){if(this._participants.length===0){this._state="Finished";return}this._activateTimeoutCounter();this._state="Running";var n=this;this._participants.forEach(function(t){t.load().then(function(){n._handleVastTagProcessed(t)}).catch(function(){n._handleVastTagProcessed(t)})})}},_activateTimeoutCounter:function(){if(this._timeout!=null){var n=this;this._timeoutHandle=setTimeout(function(){n.stop()},this._timeout)}},_deactivateTimeoutCounter:function(){this._timeout!=null&&this._timeoutHandle!=null&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null)},_findFirstVideoParticipant:function(){var n=this._participantideo"});return n?n:null}nts)}},_onAuctionComplete:function(){if(this._deactivateTimeoutCounter(),this._state==="Finished"){this._auctionCompleteEvent.trigger();return}this._trackAuctionResult();this._state="Finished";this._currentWinner==null&&(this._currentWinner=this._findFirstVideoParticipant());this._auctionCompleteEvent.trigger()},_trackAuctionResult:function(){if(!this._auctionTracked){this._auctionTracked=!0;var n=this._participants.ideo"ts()}});this._reporting.trackAuctionResult(n)}},_updateWinnerAndSecondBestBid:function(n){this._state!="Finished"&&n.getHasFill()===!0&&(this._currentWinner==null||this._currentWinner.rank<n.rank?(this._secondBestTag=this._currentWinner?this._currentWinner:null,this._currentWinner=n):(this._secondBestTag==null||this._secondBestTag.rank<n.rank)&&(this._secondBestTag=n))}}}();ct=function(){function n(n){this._url=n}return n.prototype.apge())},n.prototype.appendToCurrentDocument=function(){var n=document.body;if(n)n.insertBefore(this._createImage(),n.firstChild);else try{document.body=document.createElement("body");document.body.appendChild(this._createImage())}catch(t){console&&console.log&&console.log("TrackingPixel: No body is found on document and attempt to create document body failed")}},n.prototype._createImage=function(){var n=document.createElement("img");return n.setAttribute("width","1"),n.setAttribute("height","1"),n.setAttribute("position","absolute"),n.setAttribute("style","display: none;"),n.setAttribute("src",this._url),n},n}();lt=function(n,t,i,r){this._origin=n;this._browser=t;this._useAdblockEndpoint=i;this._dfpImpressionUrl=r};lt.prototype={create:function(n,i){var r=n===t.TrackingEventType.infinityVolume||n===t.TrackingEventType.partnerVolume?this._dfpImpressionUrl:"";return new ri(this._origin,n,i,this._browser,this._useAdblockEndpoint,r)}};ri=function(n,t,i,r,u,f){function c(n){var t=Math.floor(89999999*Math.random()+1e7);return n.indexOf("?")==-1?n+"?_="+t:n+"&_="+t}function o(n){s(c(h(n)))}function s(n){new ct(n).appendToCurrentDocument()}function l(n){var t=new XMLHttpRequest;t.open("POST",a());t.setRequestHeader("Content-Type","application/json");t.withCredentials=!0;t.onreadystatechange=function(){t.readyState===4&&console.log("Tracking request "+(t.status===200?"succeded":"failed"))};t.send(JSON.stringify(n));f&&f.length>0&&s(f)}function h(r){var u=encodeURIComponent(JSON.stringify(r));return f+n+"/track.eng?evt="+t+"&dcid="+i+"&evtData="+u}function a(){return u?n+"/"+t+"/"+i+"/track.a2b":n+"/track.eng?evt="+t+"&dcid="+i}var e=[];this.addTrackingEvents=function(n){if(n==null)throw"Tracking events cannot be null";for(var t=0;t<n.length;t++)this.addTrackingEvent(n[t])};this.addTrackingEvent=function(n){if(n==null)throw"Tracking event cannot be null";e.push(n)};this.send=function(){var i,n;if(e.length!==0)if(i=(r.msie||r.name==="IE")&&parseInt(r.major)<10,i||typeof XMLHttpRequest=="undefined")for(n=0;n<e.length;n++)console&&console.log&&console.log("INF > Sending GET tracking request. Event type: "+t),o(e[n]);else e.length==1&&!u&&h(e[0]).length<2048?(console&&console.log&&console.log("INF > Sending GET tracking request. Event type: "+t),o(e[0])):(console&&console.log&&console.log("INF > Sending POST tracking request. Event type: "+t),l(e))}};l=null,function().am=r},r=function(n,t,i){this.v=n;this.v2=t;this.as.f=i},f=function(n,t){this.v=n;this.vp=t},e=function(n){this.v=n};l=function(n,t,r){this._browser=n.getBrowser();this._dataContext=t;this._requestFactory=r;this._auctionWinnerVolumeTrackedEvent=new i};l.prototype={trackAuctionResult:function(n){if(n!=null&&n.length!==0){var r=this,utats)}),i=this._createTrackingResponseBuilderRequest(t.TrackingEventType.adFill);i.addTrackingEvents(u);i.send()}},trackVideoAdPlayError:function(n){if(n==null)throw"adItem should not be null";var r=new e(n.VolumeMetric),i=this._createTrackingResponseBuilderRequest(t.TrackingEventType.videoAdPlayError);i.addTrackingEvent(r);i.send()},trackViewProgress:function(n,i){if(n==null)throw"adItem should not be null";var u=new f(n.VolumeMetric,i),r=this._createTrackingResponseBuilderRequest(t.TrackingEventType.adView);r.addTrackingEvent(u);r.send()},trackAuctionWinnerVolume:function(i,u,f){var h,s,o,e,c;if(i==null||!i.VolumeMetric)throw"Winner should not be null";h=(this._browser.msie||this._browser.name==="IE")&&parseInt(this._browser.major)<10;s=u&&u.VolumeMetric&&!h?u.VolumeMetric:null;i.MediaId===0?(c=typeof i.PartnerAuctionType=="undefined"?null:i.PartnerAuctionType,o=new r(i.VolumeMetric,s,c),e=this._createTrackingResponseBuilderRequest(t.TrackingEventType.partnerVolume),e.addTrackingEvent(o),e.send()):(o=new n(i.VolumeMetric,s,i.MediaSegmentId,f),e=this._createTrackingResponseBuilderRequest(t.TrackingEventType.infinityVolume),e.addTrackingEvent(o),e.send());this._auctionWinnerVolumeTrackedEvent.trigger(i)},onAuctionWinnerVolumeTracked:function(n){this._auctionWinnerVolumeTrackedEvent.addHandler(n)},_createTrackingResponseBuilderRtext)},_adItemToAdFillTrackingEvent:function(n,i){if(n==null||i==null)return null;var r=i.loaded?i.success?t.AdFillCheckStatus.success:t.AdFillCheckStatus.failed:t.AdFillCheckStatus.skipped,f=r==t.AdFillCheckStatus.success?!i.empty:null;return new u(n.VolumeMetric,r,f)}}}();b=function(){};b.prototype={};for(at in l.prototype)typeof l.prototype[at]=="function"&&(b.prototype[at]=function(){});var hi=function(){function n(){}return n.(t)})},n._track=function(n){n.MediaId===0&&n.ExtraTrackingUrls!=null&&n.ExtraTrackingUrls.length>0&&n.ExtraTrackingUrls.fent()})},n}(),ui=funcAST>'}return n.prototype.setMedia=function(n,t,i,r){var u={delivery:"progressive",height:i,width:t,type:"video/mp4",url:n};this.setMediaFiles([u],r)},n.prototype._encodeCdata=function(n){return n&&n.indexOf("]\]>")>=0?n.replace("]\]>","]]]\]><![CDATA[>"):n},n.prototype.setMediaFiles=function(n,t,i,r){var e=this,o=this,s=n.map(function(n){return o._serializeMediaFile(n)}).join(""),u,f;t=this._encodeCdata(t);u=t?"<ClickThrough><![CDATA["+t+"]\]><\/ClickThrough>":"";r!=null&&(u+ing>"}).join(""));i=this._encodeCdata(i);f=i?"<AdParameters><![CDATA["+i+"]\]><\/AdParameters>":"";this._value=this._plainVideoVastTagXmlTemplate.replace("{MEDIAFILE}",s).replace("{CLICK_URL}",u).replace("{PARAMS}",f)},n.prototype._serializeMediaFile=function(n){var i="<MediaFile";for(var t in n)n.hasOwnProperty(t)&&t!=="url"&&n[t]!=null&&(i+=" "+t+'="'+n[t]+'"');return i+("><![CDATA["+this._encodeCdata(n.url)+"]\]><\/MediaFile>")},n.prototype.setVpaid=function(n,t,i,r){var u={height:i,width:t,type:"application/javascript",apiFramework:"VPAID",url:n};this.setMediaFiles([u],"",r)},n.prototype.getValue=function(){return this._value},n}(),ci={createFromVideoAdItem:function(n,i){var r,u,f;if(n.MediaSourceType!==t.MediaSourceType.Video)throw new Error("Unexpected source type");return r=new ui,u=n.getAdUrl(),n.VideoUrls&&n.VideoUrls.length>0?(f=n.VideoUrls.map(function(n){return{delivery:n.MimeType==="video/mp4"?"progressive":"streaming",width:n.Width,height:n.Height,bitrate:n.Bitrate,minBitrate:n.MinBitrate,maxBitrate:n.MaxBitrate,type:n.MimeType,url:n.Url}}),f.push({delivery:"progressive",width:n.MediaSettings.Width,height:n.MediaSettings.Height,type:"video/mp4",url:u}),r.setMediaFiles(f,i)):r.setMedia(u,n.MediaSettings.Width,n.MediaSettings.Height,i),r}},k=function(){function n(n){function r(t){n[t+"CssTransition"]!=null&&n[t+"CssTransitionDuration"]&&i.push(t+" "+n[t+"CssTransitionDuration"]+"ms "+n[t+"CssTransition"])}var t=new h(window.top.document.createElement("div")),i;t.raw.className=n.boxCSSClass;t.raw.setAttribute("style","background-color: black; left: 0; right: 0; top: 0; margin-left: auto; margin-right: auto");t.raw.style.position=n.position?n.position:"absolute";t.setWidthPx(Math.round(n.closedWidth));t.setHeightPx(Math.round(n.closedHeight));n.closedLocation&&(t.raw.style.margin="0",t.setLeftPx(Math.round(n.closedLocation.left)),t.setTopPx(Math.round(n.closedLocation.top)));i=[];["width","height","top","left"].forEach(r);i.length>0&&t.setAnimation(i.join(","));this._box=t;this._options=n;this.rootElement=t.raw}return n.prototype._getLongestAnimatedPropertyName=function(n){var t=this,i=n||["width","height","top","left"];return i.reduce(function(n,i){return t._options[i+"CssTransition"]!=null&&t._options[i+"CssTransitionDuration"]?n==null||n.duration<t._options[i+"CssTransitionDuration"]?{name:i,duration:t._options[i+"CssTransitionDuration"]}:n:n},null)},n.prototype._getPropertiesAffectedByAnimation=function(n){var t=n==="open"?"opened":"closed",i=[];return this._box.getWidthPx()!=Math.round(this._options[t+"Width"])&&i.push("width"),this._box.getHeightPx()!=Math.round(this._options[t+"Height"])&&i.push("height"),this._options[t+"Location"]&&(this._box.getLeftPx()!=Math.round(this._options[t+"Location"].left)&&i.push("left"),this._box.getTopPx()!=Math.round(this._options[t+"Location"].top)&&i.push("top")),i},n.prototype.showOpenAnimation=function(n){var i=this._getPropertiesAffectedByAnimation("open"),t,r;if(i.length===0){setTimeout(n,1);return}t=this._getLongestAnimatedPropertyName(i);r=t.duration;this._box.onceAnimationEnd(t.name,r,n);this._box.setWidth(this._options.openedWidth);this._box.setHeight(this._options.openedHeight);this._options.openedLocation&&(this._box.setLeftPx(Math.round(this._options.openedLocation.left)),this._box.setTopPx(Math.round(this._options.openedLocation.top)))},n.prototype.showCloseAnimation=function(n){var i=this._getPropertiesAffectedByAnimation("close"),t,r;if(i.length===0){setTimeout(n,1);return}t=this._getLongestAnimatedPropertyName(i);r=t.duration;this._box.onceAnimationEnd(t.name,r,n);this._box.setWidthPx(Math.round(this._options.closedWidth));this._box.setHeightPx(Math.round(this._options.closedHeight));this._options.closedLocation&&(this._box.setLeftPx(Math.round(this._options.closedLocation.left)),this._box.setTopPx(Math.round(this._options.closedLocation.top)))},n.prototype.hide=function(){this._box.hide()},n}(),li=function(){function n(n,r,u,f,e,o,s,h,c,l){l===void 0&&(l=!1);this._adItem=n;this._placeholder=r;this._clientInfo=u;this._contentHost=f;this._maxWidth=e;this._maxHeight=o;this._moveToSideOnOffscreen=s;this._moveToSidePositionRect=h;this._ignoreBottomOffscreen=c;this._isResponsive=l;this._showEvent=new i;this._closeBtnMode=t.VideoButtonDisplayMode.never;this._animation=null;this._cssPrefix="inf-iframe-ad";this._root=null}return n.prototype.getExpectedAdRect=function(){var n=this._placeholder.getInsertionPoint();return Object.freeze({top:n.top,left:n.left,bottom:n.top+this._adItem.MediaSettings.Height,right:n.left+this._adItem.MediaSettings.Width})},n.prototype.onDisplayFailed=function(){},n.prototype.getHasFill=function(){return!0},n.prototype._getAdWidthPx=function(){return this._getAdWidth()+"px"},n.prototype._getAdWidth=function(){var n=parseInt(this._adItem.MediaSettings.Width);return isNaN(n)?this._maxWidth:n},n.prototype._getAdHeight=function(){var n=parseInt(this._adItem.MediaSettings.Height);return isNaN(n)?this._maxHeight:n},n.prototype._getAdHe+"px"},n.prototype._createAdElement=function(){var n={url:this._adItem.getAdUrl(),cssPrefix:this._cssPrefix};return this._isResponsive?(n.position="absolute",n.width="100%",n.height="100%",n.top="0",n.left="0"):(n.width=this._getAdWidthPx(),n.height=this._getAdHeightPx()),new ai(n)},n.prototype._createAdContainer=function(){var n=document.createElement("div");return n.className=this._cssPrefix+"-container",n.style.textAlign="center",n.style.position="relative",this._isResponsive?(n.style.maxWidth=this._getAdWidthPx(),n.style.margin="auto"):(n.style.minWidth=this._getAdWidthPx(),n.style.minHeight=this._getAdHeightPx(),n.style.lineHeight="0"),n},n.prototype.hide=function(){this._root!=null&&(this._root.style.display="none")},n.prototype.load=function(){},n.prototype.setCloseButtonMode=function(n){this._closeBtnMode=n},n.prototype.setCSSPrefix=function(n){this._cssPrefix=n},n.prototype.setAnimation=function(n){this._animation=n},n.prototype.show=function(){function s(){var r,u;f.hide();i.show();n._showEvent.trigger();n._closeBtnMode!=t.VideoButtonDisplayMode.never&&(r=new ot({skip:function(){r.dispose();n.hide();n._moveToSideBehavior&&n._moveToSideBehavior.dispose()}},new tt(i.root,n._adItem.MediaSettings.Width,n._adItem.MediaSettings.Height,n._clientInfo),{showOnHover:n._closeBtnMode==t.VideoButtonDisplayMode.onHover},n._clientInfo));n._moveToSideOnOffscreen&&n._clientInfo.getIsDesktop()&&n._getAdHeight()<=n._moveToSidePositionRect.height&&n._getAdWidth()<=n._moveToSidePositionRect.width&&(u=new ni(n._moveToSidePositionRect.relativeElement,n._moveToSidePositionRect.align,n._moveToSidePositionRect.alignOffset,n._moveToSidePositionRect.topOffset,n._getAdWidth(),n._getAdHeight()),n._moveToSideBehavior=new gt(i.root,n._clientInfo,u,n._ignoreBottomOffscreen))}var i,u,r,o,e,f,n;if(this._root!=null){this._root.style.display="";return}i=this._createAdElement();u=this._createAdContainer();this._root=u;r=null;this._animation&&(o={heightCssTransition:this._animation.heightCssTransition,heightCssTransitionDuration:this._animation.heightCssTransitionDuration,widthCssTransition:this._animation.widthCssTransition,widthCssTransitionDuration:this._animation.widthCssTransitionDuration,openedWidth:this._isResponsive?"100%":this._adItem.MediaSettings.Width,openedHeight:this._isResponsive?"100%":this._adItem.MediaSettings.Height,closedWidth:0,closedHeight:0,boxCSSClass:"inf-onclickvideo-animationbox "+this._cssPrefix+"-animationbox-pageAd"},r=new k(o),u.appendChild(r.rootElement));e=this._createAdWrapper();i.appendTo(e);u.appendChild(e);this._placeholder.insert(u);f=new fi({width:this._isResponsive?"100%":this._adItem.MediaSettings.Width+"px",height:this._isResponsive?"100%":this._adItem.MediaSettings.Height+"px",position:"absolute"},this._contentHost,this._cssPrefix);n=this;r==null?(i.insertBefore(f.rootElement),i.loadAd(s)):window.setTimeout(function(){r.showOpenAnimation(function(){r.hide();i.insertBefore(f.rootElement);i.loadAd(s)})},20)},n.prototype._createAdWrapper=function(){var n=document.createElement("div");return this._isResponsive?(n.style.height="0",n.style.paddingTop=this._getAdHeight()/this._getAdWidth()*100+"%",n.style.maxHeight=this._getAdHeightPx(),n.style.position="relative"):(n.style.width=this._getAdWidthPx(),n.style.height=this._getAdHeightPx(),n.style.margin="auto",n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0"),n},n.prototype.onShow=function(n){this._showEvent.addHandler(n)},n.prototype.dispose=function(){},n}(),ai=function(){function n(n){var t,i;this._adElementLoaded=!1;this._loadAdOnLoad=!1;this._loadAdCallback=null;this._url=n.url;t=document.createElement("div");t.style.position=n.position;t.style.top=n.top;t.style.left=n.left;t.style.width=n.width;t.style.height=n.height;t.style.display="none";t.className=n.cssPrefix+"-adbox";i=document.createElement("iframe");i.style.width="100%";i.style.height="100%";i.scrolling="no";i.frameBorder="0";i.style.border="none";i.style.display="block";t.appendChild(i);this._adBox=t;this._adElement=i;this._loadHandler=this._adFrameLoaded.bind(this);i.addEventListener("load",this._loadHandler)}return Object.defineProperty(n.prototype,"root",{get:function(){return this._adBox},enumerable:!0,configurable:!0}),n.prototype.show=function(){this._adBox.style.display=""},n.prototype.apdBox)},n.prototype.insertdBox)},n.prototype.loadAd=function(n){if(!this._adElementLoaded){this._loadAdOnLoad=!0;this._loadAdCallback=n;return}n&&this._adElement.addEventListener("load",n);var t=this._adElement.contentWindow;t.location.replace(this._url)},n.prototype._adFrameLoaded=function(){this._adElement.removeEventListener("load",this._loadHandler);this._adElementLoaded=!0;this._loadAdOnLoad&&this.loadAd(this._loadAdCallback)},n}(),fi=function(n,t,i){var r=document.createElement("div");r.className=i+"-loader";r.setAttribute("style","left: 0; right: 0; top: 0; bottom: 0; margin: auto;");r.style.position=n.position;r.style.width=n.width;r.style.height=n.height;r.style.backgroundRepeat="no-repeat";r.style.backgroundPosition="center";r.style.backgroundImage='url("'+t+'/img/loader_32_dark.gif")';this.rootElement=r};fi.prototype={hide:function(){this.rootElement.style.display="none"}};var vi=function(){function n(n,t,i,r,u){this._width=t;this._height=i;this._clientInfo=r;this._placeholder=u;this._slot=this._createContainer();n!=null&&(this._animationBox=new k(n),this._slot.appendChild(this._animationBox.rootElement));this._videoSlot=document.createElement("div");this._videoSlot.style.backgroundColor="black";this._videoSlot.className="inf-onclickvideo-videoslot";this._videoSlotContainer=this._createVideoSlotContainer();this._videoSlotContainer.appendChild(this._videoSlot);this._slot.appendChild(this._videoSlotContainer);this._placeholder.insert(this._slot)}return n.prototype.dispose=function(){this._placeholder.remove(this._slot)},n.prototype.getExpectedight)},n.prototype.getAdWidth=function(){return this._width},n.prototype.getAdHeight=function(){return this._height},n.prototype.open=function(){var n=this;return new r(function(t){n._slot.style.position="relative";n._slot.style.minHeight=n._height+"px";n._slot.style.minWidth=n._width+"px";var i=function(){n._videoSlotContainer.style.width=n._width+"px";n._videoSlotContainer.style.height=n._height+"px";n._videoSlot.style.width=n._width+"px";n._videoSlot.style.height=n._height+"px";t()};n._animationBox==null?i():n._animationBox.showOpenAnimation(i)})},n.prototype.close=function(){var n=this;return new r(function(t){n._animationBox==null?(n._slot.style.display="none",t()):(n._videoSlotContainer.style.display="none",n._animationBox.showCloseAnimation(function(){n._slot.style.display="none";t()}))})},n.prototype.displayFinishBox=function(){while(this._videoSlot.firstChild)this._videoSlot.removeChild(this._videoSlot.firstChild);var n=this._createFinishBox();this._videoSlot.appendChild(n)},Object.defineProperty(n.prototype,"root",{get:function(){return this._slot},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"movablePart",{get:function(){return this._videoSlot},enumerable:!0,configurable:!0}),n.prototype.createAdContainer=function(){var n=document.createElement("div");return n.style.width="100%",n.style.height="100%",this._videoSlot.appendChild(n),new tt(n,this._width,this._height,this._clientInfo)},n.prototype._createFinishBox=function(){var n=window.top.document.createElement("div");return n.className="inf-onclickvideo-finishbox",n.setAttribute("style","background-color: black; width: "+this._width+"px; height: "+this._height+"px; margin-left: auto; margin-right: auto;"),n},n.prototype._createContainer=function(){var n=window.top.document.createElement("div");return n.className="inf-onclickvideo-container",n.style.textAlign="center",n.style.position="absolute",n.style.lineHeight="0px",n},n.prototype._createVideoSlotConed",n},n}(),yi=function(){function n(n,t,r,u,f,e){this._videoAdContainer=n;this._tags=t;this._video=r;this._log=u;this._clientInfo=f;this._reporting=e;this._finishedEvent=new i;this._startedEvent=new i;this._displayFailedEvent=new i;this._beforeShowEvent=new i;this._viewProgressEvent=new i;this._disposed=!1;this._loading=!1;this._auctionFinishedEvent=new i;this._pauseOnOffscreenBehavior=null;this._moveToSideBehavior=null;this._pauseOnOffscreen=!1;this._moveToSideOptions=null;this._hideOnCompletion=!0}return n.prototype.load=function(){var n=this;if(this._tags.length>0){this._participants=this._tags.map(function(t){var i=t.getAdUrl().replace(/__player-width__/g,n._videoAdContainer.getAdWidth(t).toString()).replace(/__player-height__/g,n._videoAdContainer.getAdHeight(t).toString()),r=new s(n._log.getName()+(" > VastTagAd p"+t.PlacementId+" m"+t.MediaId),{enableSendToServer:!1});return new g367CB268B1094004A3689751E7AC568F.AuctionParticipant(i,null,t,n._createAdContainer(t),r)});this._auction=new g367CB268B1094004A3689751E7AC568F.VastTagAuction(this._participants,{},this._reporting);this._loading=!0;this._auction.onAuctionComplete(function(){n._pickWinnerAd();n._loading=!1;n._auctionFinishedEvent.trigger()});this._auction.start()}this._video!=null&&this._preloadPlainVideo();this._loading||this._pickWinnerAd()},Object.defineProperty(n.prototype,"loading",{get:function(){return this._loading},enumerable:!0,configurable:!0}),n.prototype.stopLoad=function(){var n=this;return this._loading?new r(function(t){var i=n;n._auctionFinishedEvent.addH);t()});n._auction.state()!=="Finished"&&(n._log.info("Auction is forced to stop by call to stopLoad"),n._auction.stop())}):r.resolve()},Object.defineProperty(n.prototype,"selectedAdItem",{get:function(){return this._winnerAdItem},enumerable:!0,configurable:!0}),n.prototype.onViewProgress=function(n){this._viewProgressEvent.addHandler(n)},n.prototype.onBeforeShow=function(n){this._beforeShowEvent.addHandler(n)},n.prototype.show=function(){var n=this;this.stopLoad().then(function(){n._vastTagAd!=null&&n._videoAdContainer.open().then(function(){return n._playVideo()})})},n.prototype._pickWinnerAd=function(){if(this._auction==null||this._auction.currentWinner()==null){if(this._plainVideoAd&&!(this._plainVideoAd.getLoaded()&&this._plainVideoAd.getLoadError()!=null)){this._vastTagAd=this._plainVideoAd;this._winnerAdItem=this._video;this._secondBidAdItem=null;return}this._log.info("No video ad found in tags or available for fallback. Video will not show");this._displayFailedEvent.trigger({reason:"noFill"});return}this._vastTagAd=this._auction.currentWinner().getLoadedVastTagAd();this._winnerAdItem=this._auction.currentWinner().adItem;this._secondBidAdItem=this._auction.currentSecondBid()?this._auction.currentSecondBid().adItem:null},Object.defineProperty(n.prototype,"volumeButtonMode",{get:function(){return this._volumeBtnMode},set:function(n){this._volumeBtnMode=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"audioMode",{get:function(){return this._audioMode},set:function(n){this._audioMode=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"closeBtnMode",{get:function(){return this._closeBtnMode},set:function(n){this._closeBtnMode=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"replayEnabled",{get:function(){return this._replayEnabled},set:function(n){this._replayEnabled=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pauseOnOffscreen",{get:function(){return this._pauseOnOffscreen},set:function(n){this._pauseOnOffscreen=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"moveToSideOptions",{get:function(){return this._moveToSideOptions},set:function(n){this._moveToSideOptions=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hideOnCompletion",{get:function(){return this._hideOnCompletion},set:function(n){this._hideOnCompletion=n},enumerable:!0,configurable:!0}),n.prototype._playVideo=function(){function u(){try{i.setVolumeButtonMode(n._volumeBtnMode);i.setCloseButtonMode(n._closeBtnMode);i.setAudioMode(n._audioMode);n._setupViewTracking(i);i.onPlayEnded(function(){return n._onPlayFinished(!1)});i.onSd(!0)});i.play().then(function(){return n._onPlayStarted()}).catch(function(r){n._log.info("ERROR. Ad indicated fill but failed to play. Reason: "+r);n._winnerAdItem.MediaSourceType==t.MediaSourceType.VideoTag&&n._reporting.trackVideoAdPlayError(n._winnerAdItem);!n._plainVideoAd||n._plainVideoAd===i||n._plainVideoAd.getLoaded()&&n._plainVideoAd.getLoadError()!=null?n._displayFailedEvent.trigger({reason:"error"}):(n._log.info("Performing fallback to hosted video ad"),i.dispose(),i.getAdContainer().removeFromDOM(),n._vastTagAd=n._plainVideoAd,n._winnerAdItem=n._video,n._secondBidAdItem=null,n._playVideo())})}catch(u){r(u)}}function r(t){n._log.info("ERROR. Failed to load video ad. Reason: "+t);n._onPlayFinished(!0)}this._beforeShowEvent.trigger({winner:this._winnerAdItem,secondBid:this._secondBidAdItem});var i=this._vastTagAd,n=this;i.show();this._vastTagAd.awaitAdLoaded(u,r)},n.prototype._onPlayFinished=function(n){var t=this;if(this._replayEnabled&&!n){this._initReplay(this._vastTagAd,this._winnerAdItem);return}this._cleanUpAfterAdDisplay(this._vastTagAd);this._hideOnCompletion?this._videoAdContainer.close().then(function(){return t._finishedEvent.trigger()}):(this._videoAdContainer.displayFinishBox(this._winnerAdItem),this._finishedEvent.trigger())},n.prototype._initReplay=function(n,t){var r=this,u=new s(this._log.getName()+(" > VastTagAd p"+t.PlacementId+" m"+t.MediaId),{enableSendToServer:!1}),f=this._createAdContainer(t),i=n.createReplay(f,u);if(i!=null){this._cleanUpAfterAdDisplay(n);i.onPlayEnded(function(){return r._initReplay(i,t)});i.onSkipped(function(){r._onPlayFinished(!0)});i.onPlayS(i,t)});i.show();i.load().catch(function(){r._onPlayFinished(!0)});return}this._onPlayFinished(!0)},n.prototype._cleanUpAfterAdDisplay=function(n){var t=n.getAdContainer();n.dispose();t.removeFromDOM();this._auction!=null&&(this._auction.dispose(),this._auction=null);this._deactivateBehaviors()},n.prototype._onPlayStarted=function(){this._activateBehaviors(this._vastTagAd,this._winnerAdItem);var n={winner:this._winnerAdItem,secondBid:this._secondBidAdItem,failedToStartUnmuted:this._vastTagAd.getFailedToStartUnmuted()};this._startedEvent.trigger(n)},n.prototype._setupViewTracking=function(n){var i=this;n.onFirstQuartile(function(){i._viewProgressEvent.trigger({winner:i._winnerAdItem,viewProgress:t.ViewProgress.firstQuartile})});n.onMidpoint(function(){i._viewProgressEvent.trigger({winner:i._winnerAdItem,viewProgress:t.ViewProgress.midpoint})});n.onThirdQuartile(function(){i._viewProgressEvent.trigger({winner:i._winnerAdItem,viewProgress:t.ViewProgress.thirdQuartile})});n.onPlayEnded(function(){i._viewProgressEvent.trigger({winner:i._winnerAdItem,viewProgress:t.ViewProgress.complete})})},n.prototype.onFinished=function(n){this._finishedEvent.addHandler(n)},n.prototype.onStarted=function(n){this._startedEvent.addHandler(n)},n.prototype.onDisplayFailed=function(n){this._displayFailedEvent.addHandler(n)},n.prototype.getExpectedAdRect=function(){return this._videoAdContainer.getExpectedAdRect(this._winnerAdItem)},n.prototype.getHasFill=function(){return this._video!=null?!0:this._auction==null?!1:this._auction.currentWinner()!=null?!0:this._auction.state()==="Finished"?!1:null},n.prototype.dispose=function(){this._disposed||(this._auction!=null?this._auction.dispose():this._participants.forEach(function(n){n.dispose()}),this._plainVideoAd!=null&&this._plainVideoAd.dispose(),this._videoAdContainer.dispose(),this._startedEvent.removeAllHandlers(),this._finishedEvent.removeAllHandlers(),this._displayFailedEvent.removeAllHandlers(),this._auctionFinishedEvent.removeAllHandlers(),this._viewProgressEvent.removeAllHandlers(),this._beforeShowEvent.removeAllHandlers(),this._disposed=!0)},n.prototype._createAdContainer=function(n){return this._videoAdContainer.createAdContainer(n)},n.prototype._preloadPlainVideo=function(){var n=this,t=new s(this._log.getName()+(" > HostedVideo VastTagAd p"+this._video.PlacementId+" m"+this._video.MediaId),{enableSendToServer:!1});this._plainVideoAd=new ht(this._createPlainVideoVastTagXml(),this._createAdContainer(this._video),t);this._plainVideoAd.hide();this._plainVideoAd.load().catch(function(t){n._log.error("Failed to preload plain video ad "+t)})},n.prototype._createPlainVideoVastTagXml=function(){return ci.createFromVideoAdItem(this._video,this._video.getClickTrackingUrl()).getValue()},n.prototype._activateBehaviors=function(n,t){this._clientInfo.getIsDesktop()&&this._moveToSideOptions!=null&&this._moveToSideOptions.isEnabled(t)?this._moveToSideBehavior=new gt(this._videoAdContainer.movablePart,this._clientInfo,this._moveToSideOptions.getSidePositionRect(t),this._moveToSideOptions.ignoreOffscreenOnBottom,n,this._pauseOnOffscreen):this._pauseOnOffscreen&&!this._clientInfo.getVideoForcedToPlayFullscreen()&&(this._pauseOnOffscreenBehavior=new dt(n,this._clientInfo))},n.prototype._deactivateBehnull)},n}(),ki=function(){function n(){}return nurn n}(),ei=function(n,t){this._options=n;this._clientInfo=t};ei.prototype={insert:function(n){if(!this._tryInsert(n))if(this._options.fallbackElement)this._options.fallbackElement.parentNode.insertBefore(n,this._options.fallbackElement);else throw"Placeholder for Ad is not found. The ad will not show";},getExpectedAdRect:function(n,t){var i=this.getInsertionPoint();return Object.freeze({top:i.top,left:i.left,bottom:i.top+t,right:i.left+n})},getInsertionPoint:function(){var i=this._options.baseElement,r=this._options.placement,n=this._clientInfo.getBoundingClientRect(i),u=r===t.RelativePlacementType.After?n.bottom:n.top;return{top:u,left:n.left}},ld(n)},_tryInsert:function(n){var i=this._options.baseElement;if(i)this._options.placement===t.RelativePlacementType.Before?i.parentNode.insertBefore(n,i):this._options.placement===t.RelativePlacementType.After?i.parentNode.insertBefore(n,i.nextSibling):this._insertFirst(i,n);else return!1;return!0},_insertFirst:function(n,t){n.firstChild==null?n.appendChild(t):n.insertBefore(t,n.firstChild)}};oi=function(n,t,i,r){function l(){if(o){var n="height "+i.animationDuration+"ms "+i.animationType;u.style.transition!==n&&(e.setAnimation(n),eight}function a(){o&&u.style.transition!=="none"&&(e.setAnimation("none"),c(u))}function v(n){var f=n.getBoundingClientRect(),u=t.getComputedStyle(n,null),r=parseFloat(u.getPropertyValue("padding-top")),i;return r=isNaN(r)?0:r,i=parseFloat(u.getPropertyValue("border-top-width")),i=isNaN(i)?0:i,f.top+r+i}function y(){var c=t.getComputedStyle(u,null),s=parseFloat(c.getPropertyValue("height")),n=i.collapsedMaxHeight!=null&&i.collapsedMaxHeight>0&&i.collapsedMaxHeight<s?i.collapsedMaxHeight:null,e,h,f;if(i.lastVisibleElementSelector==null||i.lastVisibleElementSelector.length===0)return n;try{e=u.querySelector(i.lastVisibleElementSelector)}catch(y){return r.log("Selector for LastVisibleElementSelector is not valid"),n}if(e==null)return r.log("No element found for LastVisibleElementSelector"),n;var l=v(u),a=e.getBoundingClientRect(),o=a.bottom-l;return n!=null&&n<o?n:(h=t.getComputedStyle(e,null),f=parseFloat(h.getPropertyValue("margin-bottom")),f=isNaN(f)?0:f,o+f<s?o:null)}function p(n){var i=t.getComputedStyle(n,null),r=parseFloat(i.getPropertyValue("padding-top")),f=parseFloat(i.getPropertyValue("padding-bottom")),e=(isNaN(r)?0:r)+(isNaN(f)?0:f);return u.scrollHeight-e}function w(){if(o){l();u.style.height=p(u)+"px";e.onceAnimationEnd("height",i.animationDuauto"})}else u.style.height="auto"}var u=t.document.querySelector(n),e,s,o,f;if(u==null)throw"Content element not found";if(e=new h(u),u.style.fontSize=t.getComputedStyle(u,null).getPropertyValue("font-size"),u.style.overflow="hidden",s=y(),s==null){this.link=null;return}u.style.height=s+"px";o=i.animationType!=null&&i.animationDuration;f=t.document.createElement("a");f.setAttribute("href","#");f.className="inf-onclickvideo-link";f.textContent=i.linkText;u.nextSibling==null?u.parentNode.appendChild(f):u.parentNode.insertBefore(f,u.nextSibling);new h(f).on("click",function(n){return f.style.display="none",w(),n=n||window.event,n.preventDefault()});this.link=f};vt=function(n,t,r){var u=this,e,o;this._activatedEvent=new i;this._logger=t;this._lastScrollTime=null;e=new h(window.top);e.on("scroll",function(){u._logScrollTime()});if(o=new f(this,function(){u._activatedEvent.trigger()}),o.setThrottle(100),this._scrollHandler=o.getValue(),this._offscreenTracker=new g(n,function(n){if(n)e.off("scroll",u._scrollHandler);else{e.on("scroll",u._scrollHandler);Date.now()-u._lastScrollTime<300&&u._scrollHandler()}},function(n){return n.offTop>0||n.totalAreaOff/n.totalArea>.5},r.getViewPort()),!this._offscreenTracker.isOffscreen())e.on("scroll",u._scrollHandler)};vt.prototype={_disposed:!1,onActer(n)},dispose:function(){if(!this._disposed){this._disposed=!0;this._activatedEvent.removeAllHandlers();this._offscreenTracker.dispose();var n=new h(window.top);n.off("scroll",this._scrollHandler);n.off("scroll",this._logScrollTime)}},_logScronow()}};yt=function(n,t){var u,r,f;if(this._activatedEvent=new i,u=window.top.document.querySelector(n.ContentContainerSelector),u==null)throw"Unable to find element by ContentContainerSelector";if(r=new oi(n.ContentContainerSelector,window.top,{collapsedMaxHeight:n.CollapsedContentMaxHeight,lastVisibleElementSelector:n.LastVisibleElementSelector,linkText:n.ReadMoreText,animationType:n.getContentHeightTransitionFunction(),animationDuration:n.ContentHeightCssTransitionDuration},t),r.link==null)throw"Content height is less than configured collapsed height";f=this;r.link.addEventListener("click",function(){f._activatedEvent.triggerOnce()})};yt.prototype={onActivated:function(n){this._activatedEvent.addHandler(n)},dispose:function(){this._activatedEvent.removeAllHandlers()}};var e=g367CB268B1094004A3689751E7AC568F,o=new kt(e.UaParser),gi=new e.AdItemExtensions(n,new e.UrlTransforms(e,e.Lotame),e.InfinityHost,o,e.IsMediaTest?e.BuildMediaClickThroughUrl:null);n.getSettings=function(){var i=e.IsTagTest()?new d(this.Settings,{ContentContainerSelector:"#onClickVideo_content",VideoPlaceholderSelector:"#onClickVideo_content",VideoPlacement:t.RelativePlacementType.Before,CollapsedContentMaxHeight:60,LastVisibleElementSelector:null,SidePositionElementSelector:null,SidePositionAlignment:2,SidePositionAlignmentOffset:0,SidePositionTopOffset:0,SidePositionVideoWidth:null,SidePositionVideoHeight:null,SidePositionOtherWidth:null,SidePositionOtherHeight:null}):this.Settings,r,f,n;i.hasVideoAnimation=function(){return this.VideoHeightCssTransition!=null&&this.VideoHeightCssTransitionDuration||this.VideoWidthCssTransition!=null&&this.VideoWidthCssTransitionDuration};r={};for(f in t.MediaSourceType)typeof t.MediaSourceType[f]=="number"&&(r[t.MediaSourceType[f]]=t.MediaSourceTypesFlags[f]);return i.getMoveToSideEnabled=function(n){return this.MoveToSideOnOffscreen?this.SidePositionMediaSourceTypes?(this.SidePositionMediaSourceTypes&r[n])===r[n]:!1:!1},i.getMoveToSidePositionRect=function(n){var i=null;try{this.SidePositionElementSelector&&this.SidePositionElementSelector.length>0&&(i=document.querySelector(this.SidePositionElementSelector),i==null&&u.Logger.log("Unable to find element by SidePositionElementSelector"))}catch(f){u.Logger.log("Error querrying element by SidePositionElementSelector. Details: "+JSON.stringify(f))}var r=n===t.MediaSourceType.Video||n===t.MediaSourceType.VideoTag,e=r?new p(this.SidePositionVideoWidth,this.VideoWidth):new p(this.SidePositionOtherWidth,this.SidePositionVideoWidth,this.VideoWidth),o=r?new p(this.SidePositionVideoHeight,this.VideoHeight):new p(this.SidePositionOtherHeight,this.SidePositionVideoHeight,this.VideoHeight);return new ni(i,this.SidePositionAlignment,this.SidePositionAlignmentOffset,this.SidePositionTopOffset,e.resolve(),o.resolve())},n={},n[t.CssTransitionTimingFunction.Linear]="linear",n[t.CssTransitionTimingFunction.Ease]="ease",n[t.CssTransitionTimingFunction.EaseIn]="ease-in",n[t.CssTransitionTimingFunction.EaseOut]="ease-out",n[t.CssTransitionTimingFunction.EaseInOut]="ease-in-out",i.getVideoHeightTransitionFunction=function(){return this.VideoHeightCssTransition in n?n[this.VideoHeightCssTransition]:null},i.getVideoWidthTransitionFunction=function(){return this.VideoWidthCssTransition in n?n[this.VideoWidthCssTransition]:null},i.getContentHeightTransitionFu:null},i};pt=function(t,i){this._counterName="InfNumOCV"+n.ZoneId;this._expirationName="InfNumOCVExpire"+n.ZoneId;this._enabled=typeof i.cap!="undefined"&&typeof i.capLength!="undefined";this._cap=i.cap;this._capLength=i.capLength};pt.prototype={test:function(){return this._enabled&&e.IsCapped(this._counterName,this._expirationName,this._cap)},increment:function(){this._enabled&&e.IncrementCap(this._counterName,this._expirationName,this._capLength)}};u={Media:n,Loader:e,InitFallbackCalled:!1,ZoneSettings:null,ZoneFrequencyCap:new pt(n.ZoneId,n.Settings),Logge "+n)}},_reporting:null,Init:function(){var e,i,r,f;try{e=window.top.document}catch(o){u.Logger.log("Operating from iframe in different origin is not supported");return}if(i=n.getSettings(),new y(window.top.document).insertStyle(this.GetStyles(i.IsResponsive)),this.ZoneFrequencyCap.test()){u.Logger.log("Capped by client side Zone Frequency cap");return}if(this.ZoneSettings=i,i.StartupMode===t.OnClickVideoAdUnitMode.ReadMore)r=[i.ContentContainerSelector,i.VideoPlaceholderSelector,i.LastVisibleElementSelector];else if(i.StartupMode===t.OnClickVideoAdUnitMode.Scroll)r=[i.VideoPlaceholderSelector];else{u.Logger.log("Unknown mode for on click video ad unit.");return}f=this;this.OnElementsRAd(n)},function(){u.Logger.log("Not all required elements found on page. OnClick Video will not show")})},InitAd:function(n){var h,r=n.getSettings(),s,e,i,f,c;try{s=null;e=r.VideoPlaceholderSelector;e&&e.length>0&&(s=window.top.document.querySelector(e),s==null&&u.Logger.log("Ad placeholder for selector "+e+" is not found."));h=new ei({baseElement:s,placement:r.VideoPlacement,fallbackElement:r.StartupMode===t.OnClickVideoAdUnitMode.ReadMore?window.top.document.querySelector(r.ContentContainerSelector):null},o)}catch(l){u.Logger.log(l);return}if(i=this.CreatePrimaryAd(n,h),f=this.CreateFallbackAd(n,h),i==null){if(f==null){u.Logger.log("No ads available. Nothing will show");return}i=f;f=null}i.onDisplayFailed(function(){i.dispose();u.Logger.log("Unable to display video ad");f&&(u.Logger.log("Performing fallback to hosted ad."),f.show())});i.load();this.AddCustomStyle(r);try{c=r.StartupMode===t.OnClickVideoAdUnitMode.ReadMore?new yt(r,u.Logger):new vt(function(){return i.getExpectedAdRect()},u.Logger,o);c.onActivated(function(){if(r.StartupMode===t.OnClickVideoAdUnitMode.Scroll&&!f&&i.getHasFill()===null){u.Logger.log("Skipped on scroll trigger because no tag with ad is found yet and there is no fallback available");return}c.dispose();i.show()})}catch(a){u.Logger.log("Failed to init. Trigger creation failed. Details: "+a)}},CreatePrimaryAd:function(n,i){var h=this.GetTags(n),c=this.GetVideo(n),a,f,e;if(h.length===0&&c==null)return null;a=new lt(this.Loader.InfinityHost,this.Loader.UaParser.getBrowser(),this.Loader.IsAdblockRequest,this.Loader.DFPImpressionUrl);f=this.Loader.IsMediaTest?new b:new l(this.Loader.UaParser,n.DataContextId,a);hi.attach(f);var r=n.getSettings(),v=r.hasVideoAnimation()?this._getAnimationOptions(r):null,y=new vi(v,r.VideoWidth,r.VideoHeight,o,i),p=new s("INF > OCV z"+n.ZoneId,{enableSendToServer:!1}),u=new yi(y,h,c,p,o,f);u.moveToSideOptions={isEnabled:function(n){return r.getMoveToSideEnabled(n.MediaSourceType)},ignoreOffscreenOnBottom:r.SidePositionIgnoreOffscreenOnBottom===!0,getSidePositionRect:function(n){return r.getMoveToSidePositionRect(n.MediaSourceType)}};u.hideOnCompletion=r.HideVideoOnCompletion;u.pauseOnOffscreen=r.PauseWhenOffscreen;u.replayEnabled=r.EnableReplay;u.audioMode=r.AudioMode;u.volumeButtonMode=r.VolumeButtonAlwaysVisible===!0?t.VideoButtonDisplayMode.always:o.getIsDesktop()?t.VideoButtonDisplayMode.onHover:t.VideoButtonDisplayMode.never;u.closeBtnMode=r.ShowCloseButton?r.CloseButtonAlwaysVisible||!o.getIsDesktop()?t.VideoButtonDisplayMode.always:t.VideoButtonDisplayMode.onHover:t.VideoButtonDisplayMode.never;e=this;u.onStarted(function(i){var r=null,u,o;i.winner.MediaSourceType==t.MediaSourceType.VideoTag&&(u=e.GetHostedAd(n),r=i.secondBid?i.secondBid:u);f.trackAuctionWinnerVolume(i.winner,r,i.failedToStartUnmuted);o=new d(n,i.winner);e.Loader.Lotame.PlaceImpressionPixel(o);e.ZoneFrequencyCap.increment()});u.onViewProgress(function(n){f.trackViewProgress(n.winner,n.viewProgress)});return u},_getAnimationOptions:function(n){return{heightCssTransition:n.getVideoHeightTransitionFunction(),heightCssTransitionDuration:n.VideoHeightCssTransitionDuration,widthCssTransition:n.getVideoWidthTransitionFunction(),widthCssTransitionDuration:n.VideoWidthCssTransitionDuration,openedWidth:n.VideoWidth,openedHeight:n.VideoHeight,boxCSSClass:"inf-onclickvideo-animationbox",closedWidth:0,closedHeight:0}},CreateFallbackAd:function(n,i){var u=this.GetHostedAd(n),e,r,f,s,h,c;if(u==null)return null;e=this;typeof u.getAdUrl=="undefined"&&(u.getAdUrl=function(){return e.Loader.CreateAdUrl(n,!1,u)});r=n.getSettings();f=new li(u,i,o,this.Loader.CDNHost,r.VideoWidth,r.VideoHeight,r.getMoveToSideEnabled(u.MediaSourceType),r.getMoveToSidePositionRect(u.MediaSourceType),r.SidePositionIgnoreOffscreenOnBottom===!0,r.IsResponsive);f.setCSSPrefix("inf-onclickvideo");r.hasVideoAnimation()&&(s={heightCssTransition:r.getVideoHeightTransitionFunction(),heightCssTransitionDuration:r.VideoHeightCssTransitionDuration,widthCssTransition:r.getVideoWidthTransitionFunction(),widthCssTransitionDuration:r.VideoWidthCssTransitionDuration},f.setAnimation(s));r.ShowCloseButton&&(h=!o.getIsDesktop(),c=h||r.CloseButtonAlwaysVisible?t.VideoButtonDisplayMode.always:t.VideoButtonDisplayMode.onHover,f.setCloseButtonMode(c));f.onShow(function(){e.ZoneFrequencyCap.increment()});return f},OnElementsReady:function(n,t,i){function r(){for(var t=0;t<n.length;t++)if(n[t]!=null&&n[t].length>0&&window.top.document.querySelector(n[t])==null)return!1;return!0}if(r())t();else if(this.InitFallbackCalled)i();else{this.InitFallbackCalled=!0;var f=this;u.Loader.BindOnDO,t,i)});u.Logger.log("Not all required elements found on page. Will re-attempt init on DOM ready");return}},AddCustomStyle:function(n){if(n.CustomStyle&&n.CustomStyle.length>0)try{new y(window.top.document).insertStyle(n.CustomStyle)}catch(t){u.Logger.log("Failed to inject style. Details: "+t)}},CreateClickTrackingUrl:function(n,t){if(!t.VolumeMetric)return null;var i=["rand="+Math.floor(89999999*Math.random()+1e7),"res="+this.Loader.GetScreenWidth()+"x"+this.Loader.GetScreenHeight(),"dcid="+(n?n:""),"v="+t.VolumeMetric];return this.Loader.InfinityHost+"/clicktag.engine?"+i.join("&")},GetTags:function(n){return n.AdItems.filter(function(n){return n.MediaSourceType==t.MediaSourceType.VideoTag})},GetHostedAd:function(n){var i=n.AdItems.filter(function(n){return n.MediaSourceType==t.MediaSourceType.Url||n.MediaSourceType===t.MediaSourceType.Image||n.MediaSourceType===t.MediaSourceType.Native||n.MediaSourceType===t.MediaSourceType.Script||n.MediaSourceType===t.MediaSourceType.Html});return i.length>0?i[0]:null},GetVideo:function(n){var i=n.AdItems.Video});return i.length>0?i[0]:null},GetStyles:function(n){var t='.inf-onclickvideo-close-btn { width: 30px; height: 30px; font-family: verdana; position: absolute; top: 10px; right: 10px; border-radius: 4px; cursor: pointer; opacity: 0.8; background: url("'+e.CDNHost+'/img/close.png"); background-size: contain; } .inf-onclickvideo-close-btn:hover { background: url("'+e.CDNHost+'/img/close_active.png"); background-size: contain; opacity: 1 } .inf-onclickvideo-close-btn-hover { display: none } ';return n||(t+=".inf-onclickvideo-adbox { position: absolute; left: 0; right: 0 } "),t+".inf-onclickvideo-adbox:hover .inf-onclickvideo-close-btn-hover, .inf-onclickvideo-adbox.inf-hover .inf-onclickvideo-close-btn-hover { display: block }"}};u.Init();u.Logger.log("Initialized. Flash supported: "+u.Loader.IsFlashPluginEnabled()+". HTML5 Video supported: "+u.Loader.IsHtml5VideoSupported())}