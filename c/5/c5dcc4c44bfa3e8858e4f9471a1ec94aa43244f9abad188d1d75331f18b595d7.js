(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[686],{"1CVX":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=)},"2GJt":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("GeVZ"),o=n("qAi5");function a(e,t){var n;void 0===t&&(t=!1);var a=e?e.lastIndexOf(t?"\\":"/"):-1,r=-1===a?e:e.substring(0,a+1);if(r.match(o.b)){var s=null===(n=Object(i.a)(r))||void 0===n?void 0:n.path;if(!s)return r;if(s.lastIndexOf("/",s.length-2)<=0)return"".concat(r,"?id=root")}return r}},"4Ump":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m}));var i=n("QjXU"),o=n("j7b/"),a=n("wRjz"),r=n("lwUs"),s=n("m32Q"),c=n("lkvL"),u=n("MQWb"),d=n("P7p1");function l(e,t){return JSON.stringify([t,e.join(",")])}function f(e){var t=[],n=e.key;return n&&t.push(Object(a.a)(n)),t.push(Object(r.a)(60*o.a)),t}var m=function(e){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,a,r,m,p,v;return Object(i.__generator)(this,(function(b){switch(b.label){case 0:return t=Object(d.a)(e.isOfficeFeed?void 0:e.docProps.docFileType,e.pdfEnabled,e.upcomingMeetingEnabled,e.visioEnabled),n=f(e.encryptionKeyResult),o=Object(i.__spreadArray)([],Object(i.__read)(n),!1).reverse(),[4,Object(s.a)({userId:e.identity.puid,collectionName:e.persistenceKey,collectionVersion:u.d,key:l(t,e.persistenceKey),plugins:o})];case 1:return a=b.sent(),r=e.isOfficeFeed?null===(m=a.data)||void 0===m?void 0:m.items.filter((function(t){return t&&t.itemId!==e.docProps.docId})):(null===(v=null===(p=a.data)||void 0===p?void 0:p.documents_group.documents)||void 0===v?void 0:v.filter(())||[],Object(c.a)({userId:e.identity.puid,collectionName:e.persistenceKey,collectionVersion:u.d,key:l(t,e.persistenceKey),data:r,plugins:n}),[2]}}))}))}},"6Vlo":"7EhF":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),o=n("MQWb"),a=function(e){var t,n=e.aadClientId,a=e.objectId,r=e.requestId,s=e.substrateAppId,c=e.tenantId,u=e.contentType,d=((t={"X-AnchorMailbox":"".concat(a,"@").concat(c),"X-Office-Application":s.toString(),"X-RoutingParameter-SessionKey":a,"X-Ms-ClientAppId":n})[o.a]=r,t);return u&&(d=Object(i.__assign)(Object(i.__assign)({},d),{"Content-Type":u})),{headers:d}}},"7fMX":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}));var i,o=n("5ANk"),a=n("a3FV"),r=n("jwpY"),s=n("7EhF"),c=n("8eS9");!i||(i={}));var u=function(e,t,n){var u,d=t.aadClientId,l=t.correlationId,f=t.filesActionsPath,m=t.getAccessToken,p=t.jwtAuthEnabled,v=t.objectId,b=t.officeApiRoot,g=t.rootPath,h=t.substrateAppId,y=t.tenantId,O=t.substrateApi;t.inMockMode&&(O=b,u={mockParam:"mockrecommendedfilesactions"});var k="".concat(Object(c.a)({apiRoot:O,rootPath:g}),"/").concat(f),A={id:e.id,action_type:e.type,source_file_id:e.type===i.PdfCreated?e.sourceFileId:void 0};return Object(r.a)(n?a.a.OfficeFeedAction:a.a.RecommendedFilesActions,n?"OfficeFeedAction":"Recommended_Files_Actions",k,JSON.stringify(A),Object(s.a)({aadClientId:d,objectId:v,requestId:Object(o.a)(),substrateAppId:h,tenantId:y}),p,m,b,l,"Substrate",u)}},"8eS9":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.apiRoot+"/".concat(e.rootPath)}},"9/9y":Aj9g:function(e,t,n){"use strict";.d(t,"a",(function(){return i}))},"Eac/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i=n("QjXU");function o(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,window.crypto.getRandomValues(new Uint8Array(12))]}))}))}function a(e){return[e.slice(0,12),e.slice(12,e.byteLength)]}},MQWb:NehQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i=n("cfxV"),o=n("k8cM");function a(e){switch(e){case i.a.FrequentlyOpen:case i.a.RecentlyOpen:case i.a.WeeklyOpen:return o.a.Open;case i.a.SingleEditYou:case i.a.MultipleEditOthers:case i.a.MultipleEditYouAndOthers:case i.a.SingleEditOthers:return o.a.Edit;case i.a.SingleCommentYou:case i.a.SingleCommentOthers:case i.a.MultipleCommentOthers:case i.a.MultipleCommentYouAndOthers:return o.a.Comment;case i.a.CommentReplyToYou:case i.a.CommentReplyYou:case i.a.CommentReplyOthers:return o.a.CommentReply;case i.a.SharedWithMe:return o.a.Share;case i.a.EmailAttachment:return o.a.Attachment;case i.a.SingleMentionYou:case i.a.MultipleMentionYouAndOthers:case i.a.SingleMentionOthers:case i.a.MultipleMentionOthers:case i.a.SingleMentionedYou:case i.a.MultipleMentionedYou:return o.a.Mention;case i.a.SnoozeExpiry:return o.a.SnoozeExpiry;case i.a.Trending:case i.a.PeakMoment:case i.a.HighEngagement:return o.a.Trending;case i.a.Meeting:return o.a.Meeting;case i.a.SingleTaskActivityByYou:case i.a.MultipleTaskActivityByYou:case i.a.SingleTaskActivityByOthers:case i.a.MultipleTaskActivityByOthers:case i.a.SingleTaskActivityYouAssignee:case i.a.MultipleTaskActivityYouAssignee:case i.a.SingleTaskActivityYouCreator:case i.a.MultipleTaskActivityYouCreator:case i.a.AddToToDo:return o.a.Task;case i.a.ConvertToPdf:case i.a.PdfCreated:return o.a.Pdf;default:return o.a.Default}}function r(e){var t=[];return e&&e.forEach((),t}function s(e){var t=[];return e.forEach((function(e){var n,i=e.a,a=null!==(n=function(e){return e.edit?o.a.Edit:e.comment?o.a.Comment:e.mention?o.a.Mention:e.taskCreated||e.taskReopened||e.taskReassigned||e.taskCompleted?o.a.Task:null}(i))&&void 0!==n?n:o.a.None,s=[];a===o.a.Mention&&i.mention?s=r(i.mention.mentionees):a===o.a.Task&&(i.taskCreated?s=r(i.taskCreated.assignees):i.taskReopened?s=r(i.taskReopened.assignees):i.taskReassigned?s=r(i.taskReassigned.assignees):i.taskCompleted&&(s=r(i.taskCompleted.assignees))),t.push({id:e.r,actor:{name:e.da.n,id:e.da.i,upn:e.da.e},timestamp:e.t,reasonType:a,formatString:"",people:s,plainText:""})})),t}},P7p1:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("6ib3");function o(e,t,n,o){var a;return null!==(a=e&&(e===i.a.Stream?[i.a.Video,i.a.PlayList]:[e]))&&void 0!==a?a:function(e,t,n){var o=[i.a.Word,i.a.Excel,i.a.PowerPoint,i.a.OneNote];return e&&o.push(i.a.Pdf),n&&o.push(i.a.Visio),t&&o.push(i.a.UpcomingMeeting),o}(t,n,o)}},PZ4A:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var i,o,a=n("6ib3");function r(){return(i={})[a.a[a.a.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],i[a.a[a.a.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],i[a.a[a.a.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],i[a.a[a.a.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],i[a.a[a.a.Photos]]=["jpg","png","jpeg","gif","svg","bmp","tif","tiff","heic"],i[a.a[a.a.Outlook]]=["msg","eml"],i[a.a[a.a.OneNote]]=["one"],i[a.a[a.a.Pdf]]=["pdf"],i[a.a[a.a.Audio]]=["mp3","m4a","wav","wma"],i[a.a[a.a.Text]]=["txt"],i[a.a[a.a.Fluid]]=["fluid","loop"],i[a.a[a.a.Stream]]=["mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg"],i[a.a[a.a.Whiteboard]]=["whiteboard"],i[a.a[a.a.MeetingNotes]]=["note"],i[a.a[a.a.Clipchamp]]=["clipchamp"],i[a.a[a.a.Link]]=["url"],i[a.a[a.a.Draft]]=["draft"],i[a.a[a.a.Planner]]=["plan"],i}function s(e){return o||(o=function(){i||(i=r()),o={};var e=function(e){if(!i.hasOwnProperty(e))return"continue";var t=i[e];if(!t)return"continue";t.forEach(()};for(var t in i)e(t);return o}()),e&&o[e.toLowerCase()]||a.a.None}function c(e){return i||(i=r()),i[e]}},UeCX:function(e,t,n){"use strict";n.r(t),n.d(t,"getDataManager",(function(){return G}));var i=n("QjXU"),o=n("B5kz"),a=n("P1B7"),r=n("htMJ"),s=n("m32Q"),c=n("lkvL"),u=n("ZSEI"),d=n("7fMX"),l=n("MQWb"),f=n("P7p1"),m=n("pXA3"),p=n("Aj9g"),v=n("4Ump"),b=n("MJsD"),g=n("8wW2"),h=n("gCKw"),y=n("mJgL"),O=n("5ANk"),k=n("a3FV"),A=n("/Oio"),T=n("CMIS"),I=n("Wa5Y"),M=function(e,t,n,o,a,r,s){var c,u=((c={"Content-Type":"application/json","X-AnchorMailbox":"Oid:".concat(t,"@").concat(n),"X-Application":a,"X-ApplicationScenario":a,"X-RoutingParameter-SessionKey":t})[l.a]=e,c);return s&&(u=Object(i.__assign)(Object(i.__assign)({},u),{"X-Clientsessioncorrelationid":s})),r&&(u=Object(i.__assign)(Object(i.__assign)({},u),{ScenarioTag:"OfficeComHomeFeedback","X-Ms-ClientAppId":o})),{headers:u}},w=n("zPk6"),j=0,C=n("NehQ"),S=n("cfxV"),_=n("k8cM"),U=n("6Vlo"),D=n("6ib3"),R=n("ywfh"),E=n("2GJt");function P(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1).split("?")[0]}var x=n("PZ4A"),F=n("jf13"),N=n("qyk8"),Y=n("cHft");function q(e){var t=S.a[e];return Object(C.a)(t)}function W(e){var t=void 0,n=new RegExp(/PT(?:(\d+)H)?(?:(\d+)M)?(\d*).*S?/).exec(e||"");if(n){var i=n[1],o=n[2],a=n[3];t="".concat(i?i.padStart(2,"0")+":":"").concat(o?o.padStart(2,"0")+":":"").concat(a.padStart(2,"0")||"")}return t&&t.length<=2?"00:"+t:t}function B(e){var t="You said";return e===r.a.FollowUp||e===r.a.FollowUpActionRequest||e===r.a.FollowUpReplyRequest?t="You asked":e===r.a.Commitment?t="You said to":e===r.a.Request?t="They asked":e!==r.a.ActionRequest&&e!==r.a.ReplyRequest||(t=" asked You"),t}function L(e,t){var n,i,o,a,r,s,c=e.upcomingMeetingInfo,u="TeamsForBusiness"===(null===(n=null==c?void 0:c.onlineMeeting)||void 0===n?void 0:n.onlineMeetingProvider),d=e.itemGroups&&e.itemGroups.length>0&&-1!==e.itemGroups.indexOf("MeetingOnlineAttending"),l={id:"0",formatString:"",plainText:"",people:[],reasonType:_.a.Meeting,timestamp:c&&new Date(c.start)},f=e.expiresAt&&new Date(e.expiresAt)||null,m=new Date;if(!(f&&m>f))return{app:null===(i=e.appInfo)||void 0===i?void 0:i.name,attribution:e.uri,docId:void 0,driveId:void 0,extension:null===(o=e.file)||void 0===o?void 0:o.extension,id:e.itemId,title:(null===(a=e.previewInfo)||void 0===a?void 0:a.text)||"",url:e.webUrl,webUrl:e.webUrl,lastAccessedTime:c&&new Date(c.start)||void 0,fileType:D.a.UpcomingMeeting,pathArray:void 0,resourceId:e.resource_id,isCollab:e.is_collab,canonicalUrl:e.uri||e.webUrl,feedbackId:e.feedbackId,attributionUrl:Object(E.a)(e.uri),activity:l,attendees:c&&c.attendees,subject:null==c?void 0:c.subject,joinUrl:null===(r=null==c?void 0:c.onlineMeeting)||void 0===r?void 0:r.joinUrl,meetingStart:c&&Object(F.a)(new Date(null==c?void 0:c.start),t),meetingEnd:c&&Object(F.a)(new Date(null==c?void 0:c.end),t),location:null===(s=null==c?void 0:c.location)||void 0===s?void 0:s.displayName,organizer:null==c?void 0:c.organizer,isUpcomingMeetingAccepted:d,isTeamsMeeting:u,documents:V(null==c?void 0:c.documents)}}function V(e){return null==e?void 0:e.map((function(e){var t=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):void 0,n=e.sharePointIds,i=n&&{listId:n.listId,listItemId:"",listItemUniqueId:n.listItemUniqueId,siteId:n.siteId,siteUrl:"",webId:n.webId};return{app:Object(x.b)(e.extension),attribution:e.webUrl,contentSource:e.contentSource,fileName:e.name,extension:e.extension,title:e.title,mediaType:e.mediaType,sharepointIds:i,size:e.size,id:e.id,inclusionReason:e.inclusionReason,url:e.webUrl,webUrl:e.webUrl,downloadUrl:e.downloadUrl,lastAccessedTime:t,fileType:Object(x.b)(e.extension),sharedBy:e.sharedBy,sharingEntityType:e.sharingEntityType,previewImageUrl:e.previewImageUrl}}))}function H(e){var t,n,i,o,a,r,s,c,u,d=e.inclusionReasons&&e.inclusionReasons[0],l=(null===(t=d.actors[0])||void 0===t?void 0:t.User)||{},f={id:"0",formatString:l.DisplayName,plainText:l.DisplayName,people:[{upn:l.email,tag:"c0",name:l.DisplayName}],reasonType:_.a.MyAnalytics,timestamp:d.dateTime?new Date(d.dateTime):void 0},m='"'+(null===(n=e.previewInfo)||void 0===n?void 0:n.text)+'"',p=e.itemGroups&&e.itemGroups.length>0&&-1!==e.itemGroups.indexOf("TeamsTasks");return{app:null===(i=e.appInfo)||void 0===i?void 0:i.name,attribution:e.uri,docId:void 0,driveId:void 0,extension:null===(o=e.file)||void 0===o?void 0:o.extension,id:e.itemId,title:e.name,url:p?null!==(r=null===(a=e.taskInsight)||void 0===a?void 0:a.teamsChatUrl)&&void 0!==r?r:"":e.webUrl,webUrl:p?null!==(c=null===(s=e.taskInsight)||void 0===s?void 0:s.teamsChatUrl)&&void 0!==c?c:"":e.webUrl,fileType:D.a.MyAnalytics,pathArray:void 0,resourceId:e.resource_id,isCollab:e.is_collab,canonicalUrl:e.uri||e.webUrl,feedbackId:e.feedbackId,attributionUrl:Object(E.a)(e.uri),activity:f,potentialActions:e.potentialActions,insightName:e.insightName,insightDescription:m,insightDescriptionPrefix:e.taskInsight?B(e.taskInsight.actionType):"",actionType:null===(u=e.taskInsight)||void 0===u?void 0:u.actionType,isTeamsTask:p}}var X=n("jwpY");function Q(e){switch(e){case"click":return{click:{loggableTargetName:"OPEN_ITEM"}};case"neverShowAgain":return{explicitFeedback:{feedbackType:"NEVER_SHOW_AGAIN"}};default:return{view:{}}}}function z(e,t,n){var o,a;return void 0===n&&(n=!1),Object(i.__awaiter)(this,void 0,void 0,(function(){var r,s,c,u,d,l,f,m,p,v,g,y,T,I,w,j,C;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return r=e.objectId,s=e.tenantId,c=e.substrateApi,u=e.inMockMode,d=e.officeApiRoot,l=e.aadClientId,f=e.correlationId,[4,Object(b.a)()];case 1:return m=i.sent(),[4,Object(h.a)()];case 2:return p=i.sent(),v=(null===(a=null===(o=null==p?void 0:p.result)||void 0===o?void 0:o.userActionsAPIGates)||void 0===a?void 0:a.userActionsAPIEnabled)||!1,g=m.workload===A.a.Hwa?"OfficeComApp":"OfficeComHome",y=Object(O.a)(),T=M(y,r,s,l,g,!0,v?f:void 0),I=c,u&&(I=d,w={mockParam:"mockrecommendeddelete"}),j="".concat(I,v?"/PeoplePredictionsB2/graphql?operationName=sendUserAction":"/peoplepredictionsb2/Feedback"),C=v?function(e,t,n){for(var i=[],o=0;o<e.length;o++)i.push({feedbackId:e[o],action:Q(t[o]),timestamp:n});return{operationName:"sendUserAction",query:"mutation sendUserAction($currentDateTime:DateTimeOffset!$userActions:[UserActionLogInputType!]!){userActions{log(currentDateTime:$currentDateTime userActions:$userActions){errors{errorType __typename}__typename}__typename}}",variables:{userActions:i,currentDateTime:n}}}(t.feedbackIds,t.actions,t.timeStamp):function(e,t,n,i){for(var o=[],a=0;a<e.length;a++)o.push({FeedbackId:e[a],Action:t[a],Timestamp:n,Target:i});return{Actions:o}}(t.feedbackIds,t.actions,t.timeStamp,t.target),u?[2,Promise.resolve()]:[2,Object(X.a)(n?k.a.OfficeFeedDelete:k.a.OfficeFeedInstrumentation,n?"OfficeFeedDelete":"OfficeFeedInstrumentation",j,C,T,e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"Substrate",w).catch(()]}}))}))}function G(e){var t=this,n=e.identity,C=e.officeComponentContext,S=e.recommendedConfig,B=e.encryptionKeyResult,V={correlationId:C.correlationId,jwtAuthEnabled:C.jwtAuthEnabled,filesPath:S.filesPath,getAccessToken:C.getAccessToken,numItemsToRequest:S.numItemsToRequest,substrateApi:S.substrateApi,rootPath:S.officeFeedApiRootPath,inMockMode:!!C.inMockMode,officeApiRoot:C.officeHomeApiRoot,officeMarket:C.preferredCulture,substrateAppId:S.substrateAppId,aadClientId:C.aadAppId,objectId:n.objectId,tenantId:n.tenantId};return{addFilesActions:function(e){return Object(d.b)(e,Object(i.__assign)(Object(i.__assign)({},V),{filesActionsPath:S.filesActionsPath}),!0)},getRecommendedData:function(e,r){var u=Object(f.a)(e,S.pdfEnabled,S.upcomingMeetingEnabled,S.visioEnabled),d=Object(i.__assign)(Object(i.__assign)({},V),{fileTypes:u,sources:Object(p.a)()});return Object(a.b)((function(){return function(e){var t,n,o,a,r,s,c,u,d,f;return Object(i.__awaiter)(this,void 0,void 0,(function(){var m,p,v,C,S,_,U,D,R,E,P,x;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(b.a)()];case 1:return m=i.sent(),[4,Object(h.a)()];case 2:return p=i.sent(),[4,Object(y.a)()];case 3:return v=i.sent(),C=(null===(n=null===(t=null==p?void 0:p.result)||void 0===t?void 0:t.suggestedTasksFromTeamsGates)||void 0===n?void 0:n.suggestedTasksFromTeamsEnabled)||!1,S=(null===(a=null===(o=null==p?void 0:p.result)||void 0===o?void 0:o.stackedUpcomingMeetingsGates)||void 0===a?void 0:a.stackedUpcomingMeetingsEnabled)||!1,_=(null===(s=null===(r=null==p?void 0:p.result)||void 0===r?void 0:r.stackedTasksGates)||void 0===s?void 0:s.stackedTasksEnabled)||!1,U=(null===(u=null===(c=null==p?void 0:p.result)||void 0===c?void 0:c.vivaFocusModeGates)||void 0===u?void 0:u.vivaFocusModeEnabled)||!1,D=(null===(f=null===(d=null==v?void 0:v.result)||void 0===d?void 0:d.threeSRDLFeedExperiment)||void 0===f?void 0:f.value)||"",R=Object(O.a)(),E=M(R,e.objectId,e.tenantId,e.aadClientId,m.workload===A.a.Hwa?"OfficeComApp":"OfficeComHome",!1),P=function(e,t,n,i,o,a){var r=e.officeMarket,s=(e.inMockMode?e.officeApiRoot:e.substrateApi)+"/".concat("PeoplePredictionsB2/MicrosoftFeed"),c="".concat(s,"?").concat("section=").concat("OfficeComHome","&").concat("rs=").concat(r,"&").concat("forceNewSchema=true");return c+="&".concat(t?"experiment=OfficeComHomeWithTeamsTasks":"experiment=OfficeComHomeWithTeamsTasks_Control"),c+="&".concat(n?"experiment=OfficeComHomeWithStackedMeetings":"experiment=OfficeComHomeWithStackedMeetings_Control"),c+="&".concat(i?"experiment=OfficeComHomeWithStackedTasks":"experiment=OfficeComHomeWithStackedTasks_Control"),c+="&".concat(o?"experiment=OfficeComHomeWithRecommendedVivaInsights":"experiment=OfficeComHomeWithRecommendedVivaInsights_Control"),a&&(c+="&experiment=".concat(a)),c}(e,C,S,_,U,D),x=function(e,t){var n;return e.inMockMode&&(n="mockrecommended"),{populateRequestEvent:function(e,t){return function(n,i){if(i.RequestId=Object(w.a)(n)||"",i.DebugInfo=function(e){if(!e||!e.headers)return"";var t=e.headers,n=t["X-FEServer"]||"";return"BE: ".concat(t["X-CalculatedBETarget"]||"",". FE: ").concat(n,".")}(n),i.Index=e.toString(),i.ImpressionId=!!n.headers&&n.headers[l.a]||t,n.ok&&n.data){var o=0;n.data.items&&(o=n.data.items.length,i.ResourceIdDistribution=n.data.items.map(().toString()),i.ActualSize=o.toString()}}}(j++,t),mockParam:n}}(e,R),[2,Object(I.a)(k.a.OfficeFeedRequest,"OfficeFeedRequest",P,E,e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"Substrate",x).then((function(e){var t;return e.data?{data:e.data,headers:e.headers}:(Object(T.a)({eventName:"Office_Feed_Service_Error",message:"No data returned in office feed recommended call"}),{headers:null!==(t=null==e?void 0:e.headers)&&void 0!==t?t:{},data:void 0})})).catch((function(e){throw Object(g.a)().handleError(e,"FUfu0"),e}))]}}))}))}(d)}),(function(){var e=Object(v.b)(B),t=Object(i.__spreadArray)([],Object(i.__read)(e),!1).reverse();return Object(s.a)({userId:n.puid,collectionName:l.b,collectionVersion:l.d,key:Object(v.a)(u,l.b),plugins:t})}),(function(e){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=Object(v.b)(B),[4,Object(c.a)({userId:n.puid,collectionName:l.b,collectionVersion:l.d,key:Object(v.a)(u,l.b),data:e,plugins:t})];case 1:return i.sent(),[2]}}))}))}),(,(function(e){return function(e,t){var n;return e&&e.data&&e.data.items?{documents:e.data.items.map((function(e){switch(e.category.toLowerCase()){case"file":case"video":return function(e){var t,n,o,a,r,s,c,u=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):void 0,d=e.sharePointIds,l=d&&{listId:d.listId,listItemId:"",listItemUniqueId:d.listItemUniqueId,siteId:d.siteId,siteUrl:e.sharePointDetails&&e.sharePointDetails.sitePath,webId:d.webId},f=e.inclusionReasons&&e.inclusionReasons[0],m=void 0,p=!1,v=void 0;f&&(m=function(e){var t=e.reason||"",n=[],o=[];return e.actors&&e.actors.length>0?(n=e.actors.map((),o=(e.actors||[]).map((function(e,t){return{upn:e&&e.User.email,name:e.User.DisplayName,tag:t.toString()}}))):e.sharedBy&&(o.push({upn:e.sharedBy.User.email,name:e.sharedBy.User.DisplayName,tag:e.sharedBy.User.email}),n.push(e.sharedBy.User.DisplayName)),{formatString:t,plainText:N.a.apply(void 0,Object(i.__spreadArray)([e.reason],Object(i.__read)(n),!1)),people:o,reasonType:"popularVideoInclusionReason"===e.kind?_.a.Trending:"meetingRecordingInclusionReason"===e.kind?_.a.Video:q(e.inclusionKind),timestamp:e.dateTime?new Date(e.dateTime):void 0,id:"0"}}(f),(p="EmailAttachment"===f.inclusionKind)&&(c={AttachmentType:U.a.Classic,ConversationId:"",Subject:f.conversationSubject||""}),v=f.navigationId);var b=Object(R.a)(e.uri),g="Documents"===b,h="Sites"===b,y=p&&e.webUrl?e.webUrl:e.uri,O=e.webUrl,k=function(e,t){if(e&&t){var n=new URL(e);return n.searchParams.append("nav",t),n.toString()}return""}(O,v);return{activity:m,app:null===(t=e.appInfo)||void 0===t?void 0:t.name,attribution:e.uri,attributionUrl:Object(E.a)(e.uri),canonicalUrl:e.uri||e.webUrl,docId:null===(n=e.oneDriveItemInfo)||void 0===n?void 0:n.itemId,downloadUrl:e.uri,driveId:null===(o=e.oneDriveItemInfo)||void 0===o?void 0:o.driveId,emailReference:c,extension:(null===(a=e.file)||void 0===a?void 0:a.extension)||P(e.uri),feedbackId:e.feedbackId,fileName:e.name,fileType:Object(x.b)((null===(r=e.file)||void 0===r?void 0:r.extension)||P(e.webUrl)),id:e.itemId,isCollab:e.is_collab,isEmailAttachment:p,isOneDriveForBusinessFile:g,isSharePointFile:h,lastAccessedTime:u,mediaDuration:W(null===(s=e.video)||void 0===s?void 0:s.mediaDuration),actionInfo:{odspShareInfo:Object(Y.a)({isOneDriveForBusinessFile:g,isSharePointFile:h,itemId:e.itemId,sharepointInfo:l,url:y,webUrl:O})},resourceId:e.resource_id,sharepointIds:l,title:e.name,url:y,webUrl:O,deepLinkUrl:k,navId:v}}(e);case"upcomingmeeting":return L(e,t);case"myanalyticsinsight":return H(e);case"composite":return function(e,t){var n;return{items:e.composition.map((function(e){switch(e.category.toLowerCase()){case"upcomingmeeting":return L(e,t);case"myanalyticsinsight":return H(e)}})).filter((function(e){return void 0!==e})),id:e.itemId,title:e.name,app:null===(n=e.appInfo)||void 0===n?void 0:n.name,attribution:e.uri,url:"",extension:"",feedbackId:e.feedbackId}}(e,t);case"feeditem":return function(e,t){var n,i,o,a,r,s={id:"0",formatString:"",plainText:"",people:[],reasonType:_.a.Focus,timestamp:e.focusMode&&new Date(e.focusMode.startTimeInUtc)};return{id:e.itemId,url:(null===(n=e.commonElements)||void 0===n?void 0:n.RedirectUri)||"",webUrl:null===(i=e.commonElements)||void 0===i?void 0:i.RedirectUri,subject:null===(o=e.focusMode)||void 0===o?void 0:o.subject,meetingStart:Object(F.a)(new Date(e.focusMode.startTimeInUtc),t),meetingEnd:Object(F.a)(new Date(e.focusMode.endTimeInUtc),t),activity:s,fileType:D.a.Focus,vivaCardUser:null===(a=e.commonElements)||void 0===a?void 0:a.Actors[0].User,app:"",attribution:"",extension:"",title:(null===(r=e.commonElements)||void 0===r?void 0:r.Title)||"",feedbackId:e.feedbackId}}(e.cardItem.vivaCard,t)}})).filter((function(e){return void 0!==e})),diagnosticData:{serverRequestId:e.headers[l.e]}}:{documents:[],diagnosticData:{serverRequestId:null!==(n=null==e?void 0:e.headers[l.e])&&void 0!==n?n:""}}}(e,C.preferredCulture)}))},removeDocument:function(e){return function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){return n={feedbackIds:[t||""],actions:["neverShowAgain"],timeStamp:(new Date).toISOString(),target:""},z(e,n,!0),[2]}))}))}(Object(i.__assign)(Object(i.__assign)({},V),{dismissedDocumentsPath:"peoplepredictionsb2/Feedback"}),e.feedbackId)},onRemoveSuccessCallback:function(e,t){var i=[],a=Object(m.a)("MicrosoftFeedApi");if(i.push(a),e.docFileType){var r=Object(m.a)("MicrosoftFeedApi",e.docFileType);i.push(r)}i.forEach((function(t){o.a.cancelQueries(t);var n=o.a.getQueryData(t);if(null==n?void 0:n.result){var i={result:{documents:n.result.documents.map((function(t){return function(e,t){if(!e||e.id!==t){if(e.items){var n=e;return n.items=n.items&&n.items.filter((),n.items&&0!==n.items.length?n:void 0}return e}}(t,e.docId)})).filter((),diagnosticData:n.result.diagnosticData},fromPersistence:n.fromPersistence};o.a.setQueryData(t,i)}})),Object(v.c)({docProps:e,isOfficeFeed:!0,pdfEnabled:S.pdfEnabled,upcomingMeetingEnabled:S.upcomingMeetingEnabled,visioEnabled:S.visioEnabled,encryptionKeyResult:B,identity:n,persistenceKey:l.b})},onRemoveErrorCallback:performActions:function(e){return function(e,t,n,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,r,s,c,u,d,l,f,m,p,v,g,h,y;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return a=e.objectId,r=e.tenantId,s=e.substrateApi,c=e.inMockMode,u=e.officeApiRoot,d=e.aadClientId,[4,Object(b.a)()];case 1:return l=i.sent(),f=l.workload===A.a.Hwa?"OfficeComApp":"OfficeComHome",m=Object(O.a)(),p=M(m,a,r,d,f,!0),v=s,c&&(v=u,g={mockParam:"mockrecommendeddelete"}),h="".concat(v,"/peoplepredictionsb2/v2/myanalyticsaction"),y={FeedbackId:t,Action:n,ActionPayload:o},c?[2,Promise.resolve()]:[2,Object(X.a)(k.a.OfficeFeedAction,"OfficeFeedAction",h,y,p,e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"Substrate",g).catch((function(e){throw console.log("Failed to perform action "+y.Action),e}))]}}))}))}(V,e.feedbackId,e.actionType,e.payload)},onPerformActionsSuccessCallback:function(e,t){e.setPrimaryAction&&e.setPrimaryAction(),e.actionType===r.b.PromoteTask?e.onViewToDoClick&&u.a.createSuccessNotification("Added to ToDo",{onClick:e.onViewToDoClick,label:"Open"}):e.actionType===r.b.MarkTaskAsDone&&u.a.createSuccessNotification("Marked task as done")},onPerformActionsErrorCallback:function(e){e.actionType===r.b.PromoteTask?u.a.createErrorNotification("Unable to add To Do"):e.actionType===r.b.MarkTaskAsDone&&u.a.createErrorNotification("Unable to mark task as done")},postFeedbackInstrumentation:}},VOWq:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),o=n("Eac/");function a(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(a){switch(a.label){case 0:return n=Object(i.__read)(Object(o.b)(e),2),[4,window.crypto.subtle.decrypt({name:"AES-GCM",iv:n[0],tagLength:128},t,n[1])];case 1:return[2,a.sent()]}}))}))}},cHft:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("Dn7E"),o=function(e,t){var n;Object(i.a)({featureName:"Recommended",eventName:"Recommended_Parse_Error",params:(n={},n.DocumentId=e,n.Error=t,n)})},a=function(e){var t=e.itemId,n=e.sharepointInfo,i=e.url,a=e.webUrl;if(!e.isOneDriveForBusinessFile&&!e.isSharePointFile)return{enabled:!1};if(void 0===n)return o(t,"item is missing sharePoint Ids"),{enabled:!1};var r=!(!n.siteUrl||!i&&!a);return r||o(t,"Sharing disabled for item. siteUrl or URLs are missing"),{enabled:r,type:"Commercial",sharePointIds:n,url:null!=i?i:a}}},cfxV:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),i||(i={}))},htMJ:function(e,t,n){"use strict";var i,o,a,r;n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),i||(i={})),function(e){e.SuggestedTask="SuggestedTask",e.UpcomingMeeting="UpcomingMeeting",e.CompositeCard="CompositeCard",e.FocusTime="FocusTime",e.File="File"}(o||(o={})),a||(a={})),r||(r={}))},jf13:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return v})),n.d(t,"a",(function(){return b}));var i=n("9/9y"),o=function(){var e=new Map;return e.set(i.a.Medium,{year:"numeric",month:"short",day:"numeric"}),e.set(i.a.Long,{year:"numeric",month:"long",day:"numeric",weekday:"long"}),e.set(i.a.WeekdayDate,{day:"numeric",weekday:"short"}),e.set(i.a.WeekdayDateLong,{day:"numeric",weekday:"long"}),e.set(i.a.MonthDate,{month:"short",day:"numeric"}),e.set(i.a.Weekday,{weekday:"short"}),e.set(i.a.Time,{hour:"numeric",minute:"numeric"}),e}(),a=new Map,r=function(e,t){if(t&&a.has(t))return a;if(t)try{"Intl"in window&&a.set(t,new Intl.DateTimeFormat(e,o.get(t))),o.delete(t)}catch(e){}else{if(a.has(i.a.Default))return a;a.set(i.a.Default,new Intl.DateTimeFormat(e))}return a},s=n("1CVX");function c(e,t,n){var a;try{var c=r(n,t);if(!e)return;if(c.has(t))return null===(a=c.get(t))||void 0===a?void 0:a.format(e);if(s.a){if(t===i.a.Default)return e.toLocaleDateString(n);if(o){var u=o.get(t);return e.toLocaleDateString(n,u)}}return e.toDateString()}catch(e){return}}function u(e,t){return c(e,i.a.Default,t)}function d(e,t){return c(e,i.a.Medium,t)}function l(e,t){return c(e,i.a.Long,t)}function f(e,t){return c(e,i.a.WeekdayDate,t)}function m(e,t){return c(e,i.a.WeekdayDateLong,t)}function p(e,t){return c(e,i.a.MonthDate,t)}unction b(e,t){var n,a;try{var c=i.a.Time,u=r(t,c);return u.has(c)?null!==(a=null===(n=u.get(c))||void 0===n?void 0:n.format(e))&&void 0!==a?a:void 0:s.a&&o?e.toLocaleTimeString(t,o.get(i.a.Time)):e.toTimeString()}catch(e){return}}},jwpY:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("QjXU"),o=n("kb6k"),a=n("lAHu");function r(e,t,n,r,s,c,u,d,l,f,m,p,v){void 0===m&&(m={});var b="cache-only"===p;b&&(f="None");var g=Object(i.__assign)(Object(i.__assign)({},s),{url:n,method:"POST",body:r});return Object(o.a)((function(n){return Object(a.a)(e,t,n,d,l,p,m.populateRequestEvent,m.onUploadProgress,m.onDownloadProgress,m.cancellationToken,m.timeoutInMs)}),e,t,g,c,u,f,m.mockParam,m.resourceUrl,m.rpsHeaderPrefix,m.additionalAuthErrors,m.isRetriableError,m.updateRequestWithAuth,b,void 0,void 0,v)}},k8cM:pXA3:function(e,t,n){"use strict";function i(e,t){var n=["RecommendedData",e];return t&&n.push(t),n}n.d(t,"a",(function(){return i}))},tUM7:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("QjXU"),o=n("Eac/");unction r(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(o.a)()];case 1:return n=i.sent(),[4,window.crypto.subtle.encrypt({name:"AES-GCM",iv:n,tagLength:128},t,e)];case 2:return r=i.sent(),[2,a(n.buffer,r)]}}))}))}},wRjz:function(e,t,n){"use strict";n.d(t,"a",();var i=n("QjXU"),o=n("tUM7"),a=n("VOWq"),r=n("HZp7");function s(e){var t=this;return{onBeforeWriteValue:function(n){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,a,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n?n instanceof ArrayBuffer?(t=n,a="rawbytes",[3,3]):[3,1]:[2,n];case 1:return[4,Object(r.b)(JSON.stringify(n))];case 2:s=i.sent(),t=s.buffer,a="utf8-encoded-string",i.label=3;case 3:return[4,Object(o.a)(t,e)];case 4:return[2,{buffer:i.sent(),payloadType:a}]}}))}))},onAfterReadValue:function(n){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n?[4,Object(a.a)(new Uint8Array(n.buffer),e)]:[2,n];case 1:return t=i.sent(),"rawbytes"!==n.payloadType?[3,2]:[2,t];case 2:return[4,Object(r.a)(new Uint8Array(t))];case 3:return o=i.sent(),[2,JSON.parse(o)]}}))}))}}}}}]);
//# sourceMappingURL=686.e26037047a91ae918565.chunk.v7.js.map