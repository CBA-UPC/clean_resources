"use strict";(self.webpackChunkphotobucket_web=self.webpackChunkphotobucket_web||[]).push([[3492],{63492:function(e,r,t){t.r(r),t.d(r,{default:function(){return A}});var n=t(4942),s=t(15861),a=t(1413),o=t(29439),i=t(64687),d=t.n(i),u=t(24193),c=t(66149),l=t(4117),p=t(96467),h=t(33604),f=t(19655),w=t(47313),x=t(2135),m=t(58467),b=t(20004),Z=t(47371),v=t(45328),g=t(79894),P=t(28297),k=t(94223),j=t(6007),C=t(36504),y=t(69616),S=t(14640),E=t(42659),T=t(83021),U=t(7676),D=t(28337),I=t(46417);function z(e){return(0,I.jsxs)(c.Z,{onClose:e.handleClose,open:e.open,children:[(0,I.jsx)(h.Z,{children:"Success!!"}),(0,I.jsx)(p.Z,{children:"Your password has been reset. Please sign in."}),(0,I.jsx)(l.Z,{children:(0,I.jsx)(u.Z,{color:"primary",component:x.rU,"data-test":"confirm-reset-password",size:"small",to:"/login",variant:"outlined",children:"Close"})})]})}function A(){var e=(0,w.useState)({}),r=(0,o.Z)(e,2),t=r[0],i=r[1],u=(0,w.useState)({}),c=(0,o.Z)(u,2),l=c[0],p=c[1],h=(0,w.useState)(!1),x=(0,o.Z)(h,2),A=x[0],B=x[1],F=(0,w.useState)(!1),R=(0,o.Z)(F,2),W=R[0],_=R[1],q=(0,w.useState)(!1),G=(0,o.Z)(q,2),L=G[0],H=G[1],N=(0,D.Z)().mutation,O=(0,m.s0)(),X=(0,m.TH)(),Y=new URLSearchParams(X.search),J=Y.get("mode"),K=Y.get("oobCode"),M=(0,f.v0)(),Q=(0,w.useEffect)((function(){J&&K||(B(!0),p({general:"Password reset link expired or invalid. Try sending another one."}))}),[J,K]);var V=function(e){var r=(0,a.Z)({},t),n=e.target.name;r[n]=e.target.value,i(r);var s=(0,a.Z)({},l);delete s[n],delete s.general,p(s)},$=function(){var e=(0,s.Z)(d().mark((function e(r){var s,o,u,c,l,h,w,x;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r.preventDefault(),K){e.next=4;break}throw new Error("Password reset link expired or invalid. Try sending another one.");case 4:return s=(0,k.Z)(t.password,t.confirmPassword,t.username),B(!0),e.next=8,(0,f.TX)(M,K);case 8:return o=e.sent,e.next=11,(0,f.LG)(M,K,s);case 11:return e.next=13,(0,f.e5)(M,o,s);case 13:return u={password:s},e.next=16,N({variables:u});case 16:return e.next=18,(0,f.w7)(M);case 18:(c=new b.Z).remove("app_auth",P.ZP.cookieOptions),P.O1.forEach((),_(!0),e.next=52;break;case 24:e.prev=24,e.t0=e.catch(0),B(!1),l=e.t0,h=t,w=l.code,x=l.message,e.t1=w,e.next="UserNotFoundException"===e.t1?33:"InvalidParameterException"===e.t1||"InvalidPasswordException"===e.t1?35:"ConfirmPasswordException"===e.t1?39:"RequiredParameterException"===e.t1?41:"auth/invalid-action-code"===e.t1?43:"auth/expired-action-code"===e.t1?45:"auth/user-disabled"===e.t1?47:"auth/user-not-found"===e.t1?49:51;break;case 33:return p({username:"This username address does not exist in our records"}),e.abrupt("break",52);case 35:return h.confirmPassword=void 0,i((0,a.Z)({},h)),p({password:x}),e.abrupt("break",52);case 39:return p({confirmPassword:x,password:x}),e.abrupt("break",52);case 41:return p((0,n.Z)({},l.parameterName,x)),e.abrupt("break",52);case 43:return p({general:"The reset code is either invalid or has already been used"}),e.abrupt("break",52);case 45:return p({general:"The reset link has expired, please restart the process of resetting your password."}),e.abrupt("break",52);case 47:return p({general:"This user account has been disabled, please contact support for assistance."}),e.abrupt("break",52);case 49:return p({general:"User not found.  Please contact support for assistance."}),e.abrupt("break",52);case 51:p({general:x});case 52:case"end":return e.stop()}}),e,null,[[0,24]])})));return ();return(0,I.jsxs)(j.Z,{onSubmit:$,children:[(0,I.jsx)(z,{open:W,handleClose:),(0,I.jsx)(T.Z,{}),(0,I.jsx)(S.Z,{sx:{mt:1},children:"Reset password"}),(0,I.jsx)(U.Z,{sx:{mt:1},children:"Create a new password for your account."}),(0,I.jsx)(C.uI,{title:"Failed to reset password",body:l.general}),(0,I.jsx)(v.Z,{htmlFor:"password",sx:{mt:2},children:"Password"}),(0,I.jsx)(g.Z,{"data-test":"password",disabled:A,error:Boolean(l.password),fullWidth:!0,helperText:l.password,margin:"dense",name:"password","data-sr-redact":!0,onChange:V,required:!0,type:L?"text":"password",InputProps:{endAdornment:(0,I.jsx)(Z.Z,{showPassword:L,handleClickShowPassword:Q})},placeholder:"",value:t.password}),(0,I.jsx)(v.Z,{htmlFor:"confirmPassword",children:"Confirm password"}),(0,I.jsx)(g.Z,{"data-test":"confirmPassword",disabled:A,error:Boolean(l.confirmPassword),fullWidth:!0,helperText:l.confirmPassword,margin:"dense",name:"confirmPassword",onChange:V,required:!0,type:L?"text":"password",placeholder:"",InputProps:{endAdornment:(0,I.jsx)(Z.Z,{showPassword:L,handleClickShowPassword:Q})},value:t.confirmPassword}),(0,I.jsx)(y.Z,{"data-test":"submit",disabled:A,fullWidth:!0,type:"submit",variant:"contained",children:"Reset password"}),(0,I.jsx)(E.D,{"data-test":"return-to-login",to:"/login",children:"Back to sign in"})]})}},42659:function(e,r,t){t.d(r,{A:function(){return o},D:);var n=t(4906),s=t(2135),a=(0,n.Z)(s.rU)((),o=(0,n.Z)(s.rU)((function(e){return{color:e.theme.palette.customGrey[500],fontSize:"14px",pointerEvents:"none",textDecoration:"none"}}))},7676:function(e,r,t){var n=t(61113),s=t(4906);r.Z=(0,s.Z)(n.Z)((function(e){return{color:e.theme.palette.customGrey[500],fontSize:"14px",lineHeight:"20px",fontWeight:"400px",mb:"16px"}}))},28337:function(e,r,t){var n=t(29439),s=t(60790),a=t(18248),o=t(28422),i=t(91345),d=t(25258);r.Z=function(){var e=(0,s.D)(o.gsL,{onError:function(e){d.Z.error(e),(0,i.sh)([{id:(0,a.Z)(),message:"An error occurred while updating your password",severity:"error"}])}}),r=(0,n.Z)(e,2),t=r[0];return{results:r[1],mutation:t}}}}]);