(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[167],{"7qt8":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("QjXU"),o=n("MJsD"),r=n("B5kz"),c=n("W7wX"),i=n("CDFH");function s(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(o.a)()];case 1:return e=n.sent(),[4,Object(c.a)()];case 2:return t=n.sent(),[2,r.a.fetchQuery(["WorkloadPublicDataConfig"],(function(){return Object(i.a)(e,t)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}},WJ2C:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("QjXU"),o=n("MJsD"),r=n("B5kz"),c=n("W7wX"),i=n("/5so");function s(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(o.a)()];case 1:return e=n.sent(),[4,Object(c.a)()];case 2:return t=n.sent(),[2,r.a.fetchQuery(["ConsumerInstallInfoConfig"],(,{staleTime:1/0,cacheTime:1/0})]}}))}))}},"k+5q":function(e,t,n){"use strict";.d(t,"a",(function(){return a}))},tDEE:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("j7b/"),o=n("lwUs");function r(){return[Object(o.a)(7*a.a)]}},vS1s:function(e,t,n){"use strict";n.r(t),n.d(t,"getDataManager",(function(){return T}));var a=n("QjXU"),o=n("Zmq1"),r=n("lbnC"),c=n("6ib3"),i=n("P1B7"),s=n("m32Q"),u=n("lkvL"),l=n("WJ2C"),d=n("7qt8"),f=n("vz6o");function m(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(l.a)()];case 1:return e=n.sent(),[4,Object(d.a)()];case 2:return t=n.sent(),[2,Object(f.a)({consumerInstallConfig:e,workloadPublicDataConfig:t})]}}))}))}var p=n("s1V1"),b=n("wYzw"),v=n("8wW2"),h=n("a3FV"),j=n("0TX8"),g=n("Wa5Y"),w=n("wiq1"),I=n("k+5q"),O=n("tDEE"),_="templates-api-react";function C(e){var t,n=e.app,l=e.identity,d=e.officeComponentContext,f=e.TemplatesConfig,C=e.handleRevalidation;return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,T,E,k,A,y,P=this;return Object(a.__generator)(this,(function(D){switch(D.label){case 0:return[4,Object(p.a)()];case 1:return e=D.sent().result,[4,m()];case 2:return T=D.sent(),E=Object(o.a)(),k=n===c.a.Visio?f.numVisioTemplates:f.numTemplates,A=function(e,t,n){var a,o,r;if(t)switch(e){case c.a.Excel:return null===(a=n.startPagesConsumerTemplatesCollectionIds)||void 0===a?void 0:a.excel;case c.a.PowerPoint:return null===(o=n.startPagesConsumerTemplatesCollectionIds)||void 0===o?void 0:o.powerpoint;case c.a.Word:return null===(r=n.startPagesConsumerTemplatesCollectionIds)||void 0===r?void 0:r.word;default:return}}(n,l.isMsa,f),y={correlationId:d.correlationId,getAccessToken:d.getAccessToken,getIdentity:inMockMode:d.inMockMode,jwtAuthEnabled:d.jwtAuthEnabled,workload:d.workload,officeHomeApiRoot:d.officeHomeApiRoot,app:n,templatesApiEndpoint:f.templatesApiEndpoint,officeMarket:d.preferredCulture,show:k-1,browserName:E.browser.browserType,flights:(null===(t=d.flights)||void 0===t?void 0:t.replace(/,\s*$/,""))||"",isPremium:l.isMsa&&T,isIw:(null==e?void 0:e.IsIw)||!1,isAdmin:(null==e?void 0:e.IsAdmin)||!1,isSmb:(null==e?void 0:e.IsSmb)||!1,isEdu:(null==e?void 0:e.IsEdu)||!1,isEduFaculty:(null==e?void 0:e.IsEduFaculty)||!1,isEduStudent:(null==e?void 0:e.IsEduStudent)||!1,authId:l.isMsa?1:2,firstVisitAgeInWeeks:Math.floor(Object(b.a)()/7),page:"StartPage",deploymentEnvironment:d.deploymentEnvironment||"",osName:E.platform.platformType,osVersion:Object(r.a)(E.platformVersion),templateCollectionId:A},[2,Object(i.a)((function(){return function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=function(e){var t="&".concat("browserName=").concat(e.browserName,"&").concat("flights=").concat(e.flights,"&").concat("isIw=").concat(e.isIw,"&").concat("isAdmin=").concat(e.isAdmin,"&").concat("isSmb=").concat(e.isSmb,"&").concat("isEduFaculty=").concat(e.isEduFaculty,"&").concat("isEduStudent=").concat(e.isEduStudent,"&").concat("authId=").concat(e.authId,"&").concat("firstVisitAgeInWeeks=").concat(e.firstVisitAgeInWeeks,"&").concat("page=").concat(e.page,"&").concat("deploymentEnvironment=").concat(e.deploymentEnvironment,"&").concat("osName=").concat(e.osName,"&").concat("osVersion=").concat(e.osVersion),n="".concat(e.officeHomeApiRoot,"/").concat(e.templatesApiEndpoint,"?").concat("culture=").concat(e.officeMarket,"&").concat("app=").concat(e.app,"&").concat("isEdu=").concat(e.isEdu,"&").concat("show=").concat(e.show).concat(e.isPremium?"&isPremium=1":"").concat(t);return void 0!==e.templateCollectionId&&""!==e.templateCollectionId&&(n+="&collectionId=".concat(e.templateCollectionId)),n}(e),[4,Object(j.a)({},e.inMockMode,e.workload,e.getIdentity)];case 1:return n=a.sent(),[2,Object(g.a)(h.a.TemplatesRequest,"Templates",t,n,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome",{}).then((function(t){if(!t.data||!t.data.Templates||!t.data.Templates.Value||0===t.data.Templates.Value.length)return Promise.reject({clientError:"Invalid response"});var n={Template:Object(w.a)(t.data.Templates.Value,e.app),fromCache:!1};return n&&n.Template&&0!==n.Template.length?Promise.resolve(n):Promise.reject({clientError:"Null templates response"})})).catch((function(e){return Object(v.a)().handleError(e,"D5zZb"),Promise.reject({clientError:"Invalid response"})}))]}}))}))}(y)}),(function(){var e=Object(O.a)(),t=Object(a.__spreadArray)([],Object(a.__read)(e),!1).reverse();return Object(s.a)({userId:l.puid,collectionName:_,collectionVersion:1,key:Object(I.a)(n,y.officeMarket),plugins:t})}),(function(e){return Object(a.__awaiter)(P,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=Object(O.a)(),[4,Object(u.a)({userId:l.puid,collectionName:_,collectionVersion:1,key:Object(I.a)(n,y.officeMarket),data:e,plugins:t})];case 1:return a.sent(),[2]}}))}))}),C)]}}))}))}function T(e){var t=this,n=e.identity,o=e.officeComponentContext,r=e.templatesConfig;return{getTemplatesData:function(e,c){return Object(a.__awaiter)(t,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,C({app:e,identity:n,officeComponentContext:o,TemplatesConfig:r,handleRevalidation:c})];case 1:return[2,a.sent()];case 2:return t=a.sent(),[2,Promise.reject(t)];case 3:return[2]}}))}))},getTemplatesPageData:function(r,c){return Object(a.__awaiter)(t,void 0,void 0,(function(){var t,i,s,u;return Object(a.__generator)(this,(function(l){switch(l.label){case 0:t=function(t){var n,o,r=e.locStrings.authPageResources.m365_authPageHeader,c={Id:"Default",LocalizedTitle:r,DisplayName:r},i={LicenceInfo:"",TemplatesData:{},TemplateCategories:{},TemplateCollections:(n={},n[c.Id]={Id:c.Id,Name:c.DisplayName,TemplateCategories:[c.Id]},n)},s=[];return t.Template.forEach((function(e){e.Categories&&0!==e.Categories.length||(e.Categories=[c]),i.TemplatesData[e.AssetId]=e,s.push(e.AssetId)})),i.TemplateCategories=((o={})[c.Id]=Object(a.__assign)(Object(a.__assign)({},c),{BlankTemplateAssetID:"",SamplesAssetID:s,Name:c.DisplayName}),o),i},i=l.label=1;case 1:return l.trys.push([1,3,,4]),[4,C({app:r,identity:n,officeComponentContext:o,TemplatesConfig:e.templatesConfig,handleRevalidation:)];case 2:return s=l.sent(),[2,i(s)];case 3:return u=l.sent(),[2,Promise.reject(u)];case 4:return[2]}}))}))}}}},wiq1:function(e,t,n){"use strict";n.d(t,"a",();var a=n("Tqea");function o(e,t){return e.reduce((function(e,n){return void 0!==n.AssetId&&(n.IsBlank=!1,t&&(n.Application=Object(a.a)(t)),e.push(n)),e}),[])}}}]);
//# sourceMappingURL=default-tdp.7cf4ceff459aa63c259f.chunk.v7.js.map