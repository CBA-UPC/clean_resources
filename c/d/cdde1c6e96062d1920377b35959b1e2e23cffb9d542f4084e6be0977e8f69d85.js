(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[653],{"/5so":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("QjXU"),i=r("mgFK");function o(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return t.isMsa?[4,Object(i.a)("consumerInstallInfo",e)]:[2,null];case 1:return[2,r.sent()||null]}}))}))}},"5PdT":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("QjXU");function i(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){return[2,window.crypto.subtle.importKey("jwk",e,"AES-GCM",!1,["encrypt","decrypt"])]}))}))}function o(e){var t;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return(r=null===(t=e.encryptionConfig)||void 0===t?void 0:t.cryptoKey)?[4,i(r)]:[2,{key:null}];case 1:return[2,{key:n.sent()}]}}))}))}},"6y6H":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("QjXU"),i=r("B5kz"),o=r("5PdT"),a=r("W7wX");function c(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(a.a)()];case 1:return e=t.sent(),[2,i.a.fetchQuery(["EncryptionKey",e.puid],(,{staleTime:1/0,cacheTime:1/0})]}}))}))}},"7qt8":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("QjXU"),i=r("MJsD"),o=r("B5kz"),a=r("W7wX"),c=r("CDFH");function u(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(i.a)()];case 1:return e=r.sent(),[4,Object(a.a)()];case 2:return t=r.sent(),[2,o.a.fetchQuery(["WorkloadPublicDataConfig"],(function(){return Object(c.a)(e,t)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}},"8YRa":function(e,t,r){"use strict";var n,i,o,a;r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return a})),n||(n={})),function(e){e.Onboarding="Onboarding"}(i||(i={})),o||(o={})),a||(a={}))},CDFH:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("QjXU"),i=r("mgFK");function o(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return t.isMsa?[4,Object(i.a)("workloadPublicData",e)]:[2,null];case 1:return[2,r.sent()||null]}}))}))}},Cqxz:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("QjXU");function i(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t()];case 1:return(i=n.sent())?[2,{result:i,fromPersistence:!0}]:[3,3];case 2:return n.sent(),[3,3];case 3:return[4,e()];case 4:return o=n.sent(),r(o),[2,{result:o,fromPersistence:!1}]}}))}))}},"D/tM":"Eac/":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("QjXU");function i(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){return[2,window.crypto.getRandomValues(new Uint8Array(12))]}))}))}function o(e){return[e.slice(0,12),e.slice(12,e.byteLength)]}},RH0x:function(e,t,r){"use strict";r.r(t),r.d(t,"getIrisDataProvider",(function(){return z})),r.d(t,"getDataManager",(function(){return z}));var n,i,o=r("QjXU"),a=r("MJsD"),c=r("W7wX"),u=r("mJgL"),s=r("2y7E"),l=r("V9hE"),d=r("CMIS");function f(e,t){return{irisErr:{code:e,msg:t},statusText:t||""}}function b(e){return e&&!!e.errors&&"object"==typeof e.errors&&e.errors.length>0}function v(e,t,r,n){var o;void 0===n&&(n="");var a="Failed with ".concat(i[e]," and Error code : ").concat(t," with custom Message: ").concat(n),c=(null==r?void 0:r.queryParams)?JSON.stringify(Object.values(r.queryParams)):"",u=(null==r?void 0:r.queryParams)?"message: ".concat(a," and request params: ").concat(c):"message: ".concat(a);Object(d.a)({eventName:"Iris_Error",errorType:"Iris_Arc_Error",message:a,debugInfo:u}),Object(l.a)("Iris_Error",((o={}).DebugInfo=u,o),[])}!n||(n={})),i||(i={}));var p=r("8YRa"),h=r("zJwF"),_=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(h.a)(e)];case 1:return[2,t.sent()?p.b.Surface:p.b.Standard]}}))}))},m=r("WJ2C"),y=r("D/tM"),j=r("7qt8"),O=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,r,n,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Object(j.a)()];case 1:return(null==(e=o.sent())?void 0:e.hasBusinessLicense)?[2,p.c.Subscribed]:[4,Object(m.a)()];case 2:return t=o.sent(),void 0===(r=null===(i=null==t?void 0:t.currentSkuInfo)||void 0===i?void 0:i.skuType)?[2,p.c.Free]:(n=!(r===y.a.NonActive||r===y.a.NotSubscribed||r===y.a.NotDetected),r===y.a.O365Home||r===y.a.O365HomeTrial?[2,p.c.Family]:n?[2,p.c.Subscribed]:[2,p.c.Free])}}))}))};function w(e,t){var r,a;return Object(o.__awaiter)(this,void 0,void 0,(function(){var l,d,f,b,p,h,m,y,j,w;return Object(o.__generator)(this,(function(g){switch(g.label){case 0:return[4,Promise.all([Object(u.a)(),Object(c.a)()]).then()];case 1:return l=o.__read.apply(void 0,[g.sent(),2]),d=l[0],f=l[1],[4,Promise.all([_(t),O()])];case 2:if(b=o.__read.apply(void 0,[g.sent(),2]),p=b[0],h=b[1],!(m=null===(r=null==d?void 0:d.result)||void 0===r?void 0:r.irisConfig))throw v(i.ClientErrorIrisErrorFound,n.IrisConfigSettingFailure,void 0,"Unable to Fetch Iris Settings"),new Error("Unable to Fetch Iris Settings");if(!f)throw v(i.ClientErrorIrisErrorFound,n.ClientIdentityFailure,void 0,"Unable to Load Identity"),new Error("Unable to Load Identity");return y=(null===(a=null==m?void 0:m.localeOverrides)||void 0===a?void 0:a.split(","))||[],j=y.map((),w=y&&-1!=j.indexOf(e.toLowerCase())?"en-US":Object(s.a)(e.toLowerCase())||"en-US",[2,{queryParams:{placement:(null==m?void 0:m.placement)||"",bcnt:(null==m?void 0:m.bcnt)||"",country:f.userCountryCode||"US",locale:w,nct:"1","ofc-uType":f.isMsa?"Consumer":"Commercial","ofc-deviceType":p,"ofc-planType":h,puid:f.puid},irisURL:"",headerIncluded:!1}]}}))}))}var g,C=function(){function e(){this._infoMap=new Map,this._unknown=[],this._errors=[]}return e.createSurfaceInfo=function(e,t,r){return{placement:e,creatives:t||[],errors:r||[]}},e.infoHasId=e.infoHasCreatives=e.infoHasErrors=e.prototype.get=function(e){if(e&&this._infoMap.has(e))return this._infoMap.get(e)},e.prototype.add=function(e,t){e&&(t?this._infoMap.set(t,e):this._unknown.push(e))},e.prototype.addCreative=function(t,r){r&&"object"==typeof r?t?this.addData(t,r,!1):this._unknown.push(e.createSurfaceInfo("",[r],null)):t&&this._infoMap.set(t,e.createSurfaceInfo(t,null,null))},e.prototype.addError=function(e,t){t&&"object"==typeof t&&t.code&&(e?this.addData(e,t,!0):this._errors.push(t))},e.prototype.hasUnknowns=function(){return this._unknown.length>0},e.prototype.getUnknowns=function(){return this._unknown},e.prototype.hasUnclaimedErrors=e.prototype.getUnclaimedErrors=e.prototype.addData=function(t,r,n){if(t)if(this._infoMap.has(t)){var i=this._infoMap.get(t);i&&i[n?"errors":"creatives"].push(r)}else this._infoMap.set(t,e.createSurfaceInfo(t,n?null:[r],n?[r]:null));else this._unknown.push(e.createSurfaceInfo("",[r],[]))},e}(),I=r("j7b/"),E=r("6y6H"),U=r("Cqxz"),F=r("wRjz"),S=r("lwUs"),k=r("m32Q"),P=r("lkvL"),q=r("Ot9e"),M=r("8wW2"),T=r("a3FV"),A=r("Wa5Y");!g||(g={}));var x="iris-arc-api";function R(e){var t=e.identity,r=e.requestContext,c=e.inMockMode;return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,u,s,l,d,p=this;return Object(o.__generator)(this,(function(h){switch(h.label){case 0:return[4,Object(E.a)()];case 1:return e=h.sent(),u=[],s=Object(q.a)(location.search),l="1"===s.mockauth,d=JSON.stringify(Object.values(r.queryParams)),(null==e?void 0:e.key)&&u.push(Object(F.a)(e.key)),u.push(Object(S.a)(l||c?-1:24*I.b)),[2,Object(U.a)((function(){return function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,r,c,u,s,l,d;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Object(a.a)()];case 1:if(t=o.sent(),!e)throw f(n.MissingContext);if(function(e){if(!e)return"untargetable; no query params";if(!e.placement)return"untargetable; no placement";if(!e.country)return"untargetable; no country";if(!e.locale)return"untargetable; no locale";if(!e["ofc-uType"])return"untargetable; no ofc-uType";if(!e["ofc-deviceType"])return"untargetable; no ofc-deviceType";if(!e["ofc-planType"])return"untargetable; no ofc-planType";if(/\|/.test(e.placement)){if(!e.bcnt)return"untargetable; no bcnt for batch request";var t=e.placement.split("|").length,r=e.bcnt.split("|").length;if(t!==r)return"untargetable; batch size mismatch p="+t+" b="+r}return""}(e.queryParams))throw v(i.ClientErrorIrisErrorFound,n.QueryParametersInvalid,e),f(n.QueryParametersInvalid);return e.queryParams.asid=t.correlationId,r=function(e){if(!e)return null;var t=);return Object.assign({},t,e)}(e.queryParams),c=function(e){if(!e)return null;var t=/[^=]/,r=[];for(var n in e)e[n]&&t.test(e[n])&&r.push("".concat(n,"=").concat(e[n]));return r.length>0?r.join("&"):null}(r),u=t.inMockMode?"".concat(t.officeHomeApiRoot,"/v4/api/selection"):null!==(d=e.irisURL)&&void 0!==d?d:"https://arc.msn.com/v4/api/selection",s=new URL(u+"?"+c),l={method:"GET",url:s.toString()},[2,Object(A.a)(T.a.IrisRequest,"IrisRequest",l.url,l,t.jwtAuthEnabled,t.getAccessToken,t.officeHomeApiRoot,t.correlationId,"None",{}).then((function(t){return t&&t.ok&&void 0!==t.data?b(t.data.batchrsp)?(v(i.DSourceIrisErrorFound,n.ResponseFailure,e),{parsedResponse:null,reqContext:e}):{parsedResponse:t.data,reqContext:e}:{parsedResponse:null,reqContext:e}})).catch((function(t){return Object(M.a)().handleError(t,"Byblx"),v(i.ClientErrorIrisErrorFound,n.ResponseFailure,e),{parsedResponse:null,reqContext:e}}))]}}))}))}(r)}),(function(){var e=Object(o.__spreadArray)([],Object(o.__read)(u),!1).reverse();return Object(k.a)({userId:t.puid,collectionName:x,collectionVersion:1,key:d,plugins:e})}),(function(e){return Object(o.__awaiter)(p,void 0,void 0,(function(){return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return e.parsedResponse?[4,Object(P.a)({userId:t.puid,collectionName:x,collectionVersion:1,key:d,data:e,plugins:u,writeBehavior:"sync"})]:[2];case 1:return r.sent(),[2]}}))}))}))]}}))}))}function D(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,r,u,s,l,d;return Object(o.__generator)(this,(function(f){switch(f.label){case 0:return[4,Promise.all([Object(a.a)(),Object(c.a)()])];case 1:return e=o.__read.apply(void 0,[f.sent(),2]),r=e[1],[4,w((t=e[0]).preferredCulture,t.workload).catch(()];case 2:return u=f.sent().queryParams,l=function(e){var t=e.queryParams,r=e.irisURL,n=e.includedHeaders;return Object(o.__assign)(Object(o.__assign)({queryParams:t},n?{includedHeaders:n}:{}),r?{irisURL:r}:{})}({inMockMode:s=t.inMockMode,queryParams:u}),[4,R({identity:r,requestContext:l,inMockMode:s})];case 3:return(d=f.sent().result)?[4,Q(d).then(X).catch((function(e){return e&&function(e){return e&&"object"==typeof e&&(null==e?void 0:e.hasOwnProperty("irisErr"))}(e)||v(i.UnknownIrisErrorFound,n.UnCaughtErrorDetected,l),Promise.reject(e)}))]:[2,null];case 4:return[2,f.sent()]}}))}))}unction Q(e){var t,r,a,c;return Object(o.__awaiter)(this,void 0,void 0,(function(){var u,s,l,d,f,p,h,_;return Object(o.__generator)(this,(function(m){return e&&e.parsedResponse?(u=e.parsedResponse,s=(null===(t=null==e?void 0:e.reqContext)||void 0===t?void 0:t.queryParams)&&/^[^\|]*$/.test(null===(r=e.reqContext.queryParams)||void 0===r?void 0:r.placement)?e.reqContext.queryParams.placement:null,l=new C,d={collection:l,reqContext:e.reqContext},function(e){return!!e&&"object"==typeof e&&!!e.error||!!(null==e?void 0:e.code)}(u)&&s?(l.addError(s,u),[2,Promise.resolve(d)]):(function(e){return!!e&&"object"==typeof e&&!!e.batchrsp}(u)?(function(e){return e&&!!e.items&&"object"==typeof e.items&&e.items.length>0}(u.batchrsp)&&(f=u.batchrsp.items)&&f.forEach((function(t){!function(e,t){t&&e&&(e.items&&e.items.length>0&&e.items.forEach((function(r){e.placement||e.placement&&L(e.placement,r,t)})),e.item&&e.placement&&L(e.placement,e.item,t))}(t.placement?t:Object(o.__assign)(Object(o.__assign)({},t),{placement:N(e)}),l)})),b(u.batchrsp)&&(p=u.batchrsp.errors)&&p.forEach(()):(h=H(u),s&&h&&l.addCreative(s,h),h||(_=null===(c=null===(a=null==e?void 0:e.reqContext)||void 0===a?void 0:a.queryParams)||void 0===c?void 0:c.asid,v(i.ClientErrorIrisErrorFound,n.UnconvertableCreative,e.reqContext,"Asid : ".concat(_)))),[2,Promise.resolve(d)])):[2,Promise.resolve(null)]}))}))}function H(e){var t=e&&"string"==typeof e?function(e){if(!e)return null;var t=e.replace(/\\\"/g,'"'),r=null;try{r=JSON.parse(t)}catch(e){}return r||(v(i.ClientErrorIrisErrorFound,n.Unparsable,void 0,t),null)}(e):e;return t&&function(e){return!!(e&&"object"==typeof e&&e.prm&&e.prm._id&&e.prm._imp&&e.tracking&&e.tracking.baseUri&&e.ad&&e.f&&e.v)}(t)?{content:t.ad,creativeId:t.prm._id,telemetry:{impressionUrl:t.prm._imp,actionUrl:t.tracking.baseUri}}:(v(i.ClientErrorIrisErrorFound,n.InvalidResponseFormat,void 0,"Creative id : ".concat(t&&t.prm&&t.prm._id)),null)}function L(e,t,r){if(t&&r){var n=H(t);n&&r.addCreative(e,n)}}function X(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(r){return(null===(t=null==e?void 0:e.collection)||void 0===t?void 0:t.hasUnclaimedErrors())&&e.collection.getUnclaimedErrors().forEach((function(t){!function(e,t){if(e&&"number"==typeof e.code)if(e.code>=1e3&&e.code<=1999)v(i.ClientErrorIrisErrorFound,e.code,t);else if(e.code>=3e3&&e.code<=3999)v(i.TemplateIrisErrorFound,e.code,t);else switch(e.code){case 0:case 2e3:break;case 2010:v(i.TimeoutIrisErrorFound,e.code,t);break;case 2020:v(i.DSourceIrisErrorFound,e.code,t);break;case 2040:break;default:v(i.UnknownIrisErrorFound,e.code,t)}}(t,e.reqContext)})),[2,e]}))}))}var J=r("h9iM"),W=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,r,n,i,a,c,u,s,l,d,f,b,v,h,_;return Object(o.__generator)(this,(function(m){t=new Map;try{for(r=Object(o.__values)(e),n=r.next();!n.done;n=r.next())d={type:J.a.inAppNavigationUrl,url:c=(a=(i=n.value).content).CTAUrl},(u=a.CTALaunchType)===p.a.Article?d={type:J.a.flexPaneArticle,guid:c}:u!==p.a.Inline&&(d={type:J.a.externalUrl,url:c,target:"_blank"}),f={cardAction:d,id:s=a.CardName,metadata:{description:a.Body,images:(h={},h[J.b.Normal]=(_={},_[J.c.Default]={alt:l=a.Title,src:a.Thumbnail,theme:J.c.Default},_),h),title:l},telemetry:i.telemetry,type:J.d.onboarding},t.set(s,f)}catch(e){b={error:e}}finally{try{n&&!n.done&&(v=r.return)&&v.call(r)}finally{if(b)throw b.error}}return 0===t.size?[2,[]]:[2,Object(o.__spreadArray)([],Object(o.__read)(t.values()),!1)]}))}))};function z(e){return{getApiCards:function(){return function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,r,n,i,a;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,D()];case 1:if(e=o.sent(),t=null===(i=null===(n=null==e?void 0:e.reqContext)||void 0===n?void 0:n.queryParams)||void 0===i?void 0:i.placement,!(r=t?null===(a=null==e?void 0:e.collection.get(t))||void 0===a?void 0:a.creatives:void 0)||0===r.length)throw new Error("No creatives found");return[2,W(r)]}}))}))}()}}}},VOWq:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("QjXU"),i=r("Eac/");function o(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r;return Object(n.__generator)(this,(function(o){switch(o.label){case 0:return r=Object(n.__read)(Object(i.b)(e),2),[4,window.crypto.subtle.decrypt({name:"AES-GCM",iv:r[0],tagLength:128},t,r[1])];case 1:return[2,o.sent()]}}))}))}},WJ2C:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("QjXU"),i=r("MJsD"),o=r("B5kz"),a=r("W7wX"),c=r("/5so");function u(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(i.a)()];case 1:return e=r.sent(),[4,Object(a.a)()];case 2:return t=r.sent(),[2,o.a.fetchQuery(["ConsumerInstallInfoConfig"],(,{staleTime:1/0,cacheTime:1/0})]}}))}))}},tUM7:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("QjXU"),i=r("Eac/");unction a(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(i.a)()];case 1:return r=n.sent(),[4,window.crypto.subtle.encrypt({name:"AES-GCM",iv:r,tagLength:128},t,e)];case 2:return a=n.sent(),[2,o(r.buffer,a)]}}))}))}},wRjz:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("QjXU"),i=r("tUM7"),o=r("VOWq"),a=r("HZp7");function c(e){var t=this;return{onBeforeWriteValue:function(r){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,o,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r?r instanceof ArrayBuffer?(t=r,o="rawbytes",[3,3]):[3,1]:[2,r];case 1:return[4,Object(a.b)(JSON.stringify(r))];case 2:c=n.sent(),t=c.buffer,o="utf8-encoded-string",n.label=3;case 3:return[4,Object(i.a)(t,e)];case 4:return[2,{buffer:n.sent(),payloadType:o}]}}))}))},onAfterReadValue:function(r){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r?[4,Object(o.a)(new Uint8Array(r.buffer),e)]:[2,r];case 1:return t=n.sent(),"rawbytes"!==r.payloadType?[3,2]:[2,t];case 2:return[4,Object(a.a)(new Uint8Array(t))];case 3:return i=n.sent(),[2,JSON.parse(i)]}}))}))}}}},zJwF:function(e,t,r){"use strict";r.d(t,"a",();var n=r("QjXU"),i=r("yQST"),o=r("gCKw"),a=r("/Oio");function c(e){var t,c;return Object(n.__awaiter)(this,void 0,void 0,(function(){var u,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(o.a)()];case 1:return u=n.sent(),s=(null===(c=null===(t=null==u?void 0:u.result)||void 0===t?void 0:t.surfaceExpGates)||void 0===c?void 0:c.surfaceExpEnabled)||!1,(e===a.a.Hwa||Object(i.a)())&&s?[4,Promise.all([r.e(50),r.e(734)]).then(r.bind(null,"fTj/"))]:[3,3];case 2:return[2,n.sent().isSurfaceDevice()];case 3:return[2,!1]}}))}))}}}]);
//# sourceMappingURL=vendors~learning-iris-dataprovider.0a4c964ede38cfda554c.chunk.v7.js.map