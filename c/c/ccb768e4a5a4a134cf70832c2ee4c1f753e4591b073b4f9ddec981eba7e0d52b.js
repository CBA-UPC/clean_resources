livetexChunkLoader([0],{"./src/app/app-types.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),function(t){t.EMBEDDED="embedded",t.MOBILE="mobile",t.CUSTOM="custom"}(i||(i={}))},"./src/app/app.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/util/browser/browser.ts"),r=n("./src/util/util.ts"),a=n("./src/settings/props.ts"),o=n("./src/store/local-storage.ts"),c=n("./src/store/cross-local-storage.ts"),u=n("./src/app/page/page.ts"),l=n("./src/tabs/tabs.ts"),_=n("./src/logger/logger.ts"),d=n("./modules/oldmodules.js"),p=(n.n(d),n("./src/util/location/location.ts")),f=n("./src/app/app-types.ts"),g=n("./src/data/dialog.ts");!function(t){var e=null,n=null,i=0;t.createSubject=function(e){var n=t.getSite().getGroups().find(function(t){return t.getId()===e}),i=void 0!==n?n.getFirstName():"",s=p.a.getHost()||"",a=r.a.getTranslation("offlineSubject");if(a)return a.replace("WEBSITE",s).replace("GROUPNAME",i);var o=r.a.SUBJECT_SITE+" "+s;return i&&(o+=" "+r.a.SUBJECT_GROUP+" "+i),o},t.populateData=function(t,i){if(t){if(t.chat instanceof Object){var s=d.sm.reconstructEntity(t.chat,i);s instanceof g.a&&(n.populateData(t.chat),n=s)}t.dialog instanceof g.a&&(n&&n.getGroup()&&t.dialog.populateData({group:n.getGroup()}),n=t.dialog),t.site&&e.populateData(t.site)}},t.getSite=function(){return e},t.setSite=function(t){e=t},t.getDialog=function(){return n},t.setDialog=function(t){n=t},t.resetSite=t.addPage=function(t){return new Promise(},t.getAppType=function(){var t=f.a.EMBEDDED;if(s.a.isMobile()){if(!a.a.isMobileWidget())return;t=f.a.MOBILE}return t},t.isMobileType=t._createLocalStorage=function(t){return new o.a(t,v())},t._createCrossLocalStorage=function(t){return new c.a(t,v())};var v=function(){return 0===u.a.visitCount()&&_.a.error("Storage created without valid visit count"),u.a.visitCount()};t.createStorage=t._createLocalStorage,t.createCrossStorage=t._createLocalStorage,t.startQuark=function(){d.q.setStorage(function(){return t.createCrossStorage("quark")}),l.a.addEventListener("_u_",,d.q.watchAll(},t.setServerTime=function(t){if(0===i){var e=(new Date).getTime()-t;_.a.debug("clientTime-serverTime="+e+"ms"),i=e}},t.convertToClientTime=(i||(i={}))},"./src/app/embedded/embedded.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/app/states/states.ts"),r=n("./src/e.js"),a=(n.n(r),n("./src/service/event-turbine/event-turbine.ts")),o=n("./src/service/wrapper/wrapper.ts"),c=n("./src/service/site.ts"),u=n("./src/service/invite/invite.ts"),l=n("./src/service/dialog/dialog.ts"),_=n("./src/service/offline.ts"),d=n("./src/service/api/api.ts"),p=n("./src/service/buttons/buttons.ts"),f=n("./src/service/client-log/client-log.ts"),g=n("./src/service/scripts/index.ts"),v=n("./src/app/pipe.ts"),h=n("./src/app/helpers/index.ts"),E=n("./src/event-emitter/index.ts");!function(t){t.INIT_STATE=s.b.LABEL,t.startWidgets=function(){var t=[r.w.type.LABEL,r.w.type.BUTTONS,r.w.type.INVITE,r.w.type.CHAT,r.w.type.OFFLINE,r.w.type.XBUTTON,r.w.type.XWIDGET],e=Object(v.b)(t),n=e.type,i=e.payload;E.a.publishEvent(n,i)},t.startServices=function(t,e,n,i){Object(h.a)([a.a.start,o.a.start,f.a.start,c.b.start,u.a.start,l.b.start,_.a.start,p.a.start,d.a.start,g.f],t,e,n,i)}}(i||(i={}))},"./src/app/env-settings.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"d",function(){return r}),e.b=e.c=function(){return i.LTX_URL};n("./node_modules/tslib/tslib.es6.js");var i=null;var s=function(){return i},r=function(t){(i=t).account_id&&(i.ACCOUNT.ID=i.account_id)}},"./src/app/helpers/index.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(t,e,n,i,s){t.forEach(}},"./src/app/index.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("./src/polyfill.ts");var i=n("./src/app/start.ts"),s=n("./src/event-emitter/index.ts"),r=n("./src/event-emitter/actions/init.ts"),a=n("./src/event-emitter/actions/index.ts"),o=n("./src/event-emitter/logger.ts"),c=n("./src/app/patch-old-modules.ts"),u=n("./src/app/patch-discovery-lib.ts"),l=n("./src/util/serviceMemory.ts"),_=n("./src/tabs/tabs.ts"),d=n("./src/util/originProvider.ts"),p=Object(o.b)(o.a.CHILD,"services");s.a.init({link:d.a.getOrigin(),window:window},{link:d.a.getHostPageOrigin(),window:window.parent},p),s.a.listenEvent(r.a,function(t){window.isDirect=t.isDirect,window.need_lk_css=t.needLkCss,window.ltLang=t.ltLang,window.parentReferrer=t.parentReferrer,window.parentTitle=t.parentTitle,window.parentHref=t.parentHref,window.parentHost=t.parentHost,window.isDebug=t.isDebug,window.LiveTex._i18n=t.i18n,Object(u.a)(t.servicesData,t.envSettings),Object(i.a)(t.livetexId,t.envSettings,t.servicesData,{skipBrowserCheck:t.skipBrowserCheck},s.a),Object(c.a)()}),l.a&&l.a.isPrivateMode?(l.a.setSetItemHandler(_.a.handleStorageUpdate),window.parent!==window&&l.a.requestInitialData(1e3).then(.catch(.finally():s.a.publishEvent(a.a)},"./src/app/mobile/mobile.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/app/app.ts"),r=n("./src/app/states/states.ts"),a=n("./src/service/wrapper/wrapper.ts"),o=n("./src/service/site.ts"),c=n("./src/service/invite/invite.ts"),u=n("./src/service/offline.ts"),l=n("./src/service/api/api.ts"),_=n("./src/service/dialog/dialog.ts"),d=n("./src/service/buttons/buttons.ts"),p=n("./src/service/client-log/client-log.ts"),f=n("./src/service/scripts/index.ts"),g=n("./src/e.js"),v=(n.n(g),n("./src/app/pipe.ts")),h=n("./src/app/helpers/index.ts"),E=n("./src/event-emitter/index.ts"),b=n("./src/service/event-turbine/event-turbine.ts");!function(t){t.INIT_STATE=r.b.LABEL,t.prevStart=t.startWidgets=function(t,e,n){var i=[g.w.type.LABEL,g.w.type.BUTTONS,g.w.type.CHAT,g.w.type.OFFLINE],s=Object(v.b)(i),r=s.type,a=s.payload;E.a.publishEvent(r,a)},t.startServices=function(t,e,n,i){Object(h.a)([b.a.start,a.a.start,p.a.start,o.b.start,c.a.start,u.a.start,d.a.start,_.b.start,l.a.start,f.g],t,e,n,i)}}(i||(i={}))},"./src/app/page/page.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/store/local-storage.ts"),r=n("./src/util/util.ts"),a=n("./src/util/date/date.ts"),o=n("./src/app/app.ts"),c=n("./src/data/page.ts"),u=n("./src/logger/logger.ts"),l=n("./src/io/response/types.ts"),_=n("./src/io/index.ts"),d=n("./src/redux-store/index.ts"),p=n("./src/redux-store/reducers/visitor/selectors.ts");!function(t){t.VISIT_TIME="visit-time",t.VISIT_COUNT="visit-count",t.SEO_QUERY="seo-query",t.PAGE_COUNT="page-count",t.PAGE_TIME="page-time";var e=0,n="app-page",f=null,g=null,v=t.start=function(e,s,h){function E(r){e.removeListener(l.a.PAGE,E),r instanceof _.b.Page?(window.userGeoData=r.getPage().getGeoData(),1!==(g=r.getPage()).getPageCount()&&0!==i.visitCount()||(v().setPermanently(t.VISIT_TIME,(new a.a).current()),v().incrPermanently(i.VISIT_COUNT)),f=o.a.createStorage(n),v().set(i.SEO_QUERY,c.a.getSeoQuery()),v().incr(i.PAGE_COUNT),v().set(i.PAGE_TIME,(new a.a).current()),s(g)):h("Can`t get a valid page.")}var b=o.a.getSite();b?function(t){e.addListener(l.a.PAGE,E),e.send(new _.a.livetex.AddPage(t,"account:"+Object(p.a)(d.a.getState())+":site:"+Object(p.c)(d.a.getState())),r.a.nop,u.a.error)}(b.getPage()):u.a.error("Unable to add page")},t.get=function(){return g},t.getCounter=t.visitCount=function(){return Number(v().get(i.VISIT_COUNT))},t.visitTime=function(){return Number(v().get(i.VISIT_TIME))},t.pageCount=function(){return Number(v().get(i.PAGE_COUNT))},t.pageTime=function(){return Number(v().get(i.PAGE_TIME))},t.seoQuery=function(){return String(v().get(i.SEO_QUERY))}}(i||(i={}))},"./src/app/patch-discovery-lib.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/@livetex/browser-service-discovery/bin/index.js"),s=(n.n(i),n("./node_modules/@livetex/widgets-api-service-client/bin/index.js")),r=(n.n(s),n("./node_modules/@livetex/browser-thrift-io/bin/index.js")),a=function(t,e){var n=t.find(function(t){return t.ServiceName===e.WIDGETS_API.KEY});i.BalancerDiscovery.prototype.getService=function(t,e,a){if(t.__id===n.ServiceName){var o="//"+n.ServiceAddress+"/"+n.ServiceID;i.TioClientFactory.prototype.createClient=function(){return new r.Client(new r.HttpTransport(o,this.__timeout),this.__protocol)};var c=s.client.__client,u=c.__clientFactory.createClient(o);return c.__client=u,c.__process(u),void(c.__is_requesting=!1)}i.TioClientFactory.prototype.createClient=function(t){return new r.Client(new r.HttpTransport(t,this.__timeout),this.__protocol)};var l=this;(new i.XhrTransport).request(this.__buildUrl(t),function(n){try{var s=i.randomService(l.__parseResponse(n));null!==s?e(s):a("Can't find service: id = "+t.getId())}catch(t){a(t.message)}},a)}}},"./src/app/pipe.ts":function(t,e,n){"use strict";e.b=function(t){return{type:i.e.s.system.START_WIDGET,payload:{widgetNames:t}}},e.a=function(t,e,n){return{type:i.e.s.system.SETTINGS,payload:{envSettings:t,props:{getVoteType:e.getVoteType(),isBotEnabled:e.isBotEnabled(),quickCall:e.isQuickCallFeatureEnabled(),getOnlineLabelText:e.getOnlineLabelText(),getOfflineLabelText:e.getOfflineLabelText(),getStartPayload:e.getStartPayload(),isEmbedded:e.isEmbedded(),getBannerImage:e.getBannerImage(),getBannerLink:e.getBannerLink(),isTypingEnabled:e.isTypingEnabled(),getLabelPosition:e.getLabelPosition(),getDirectPhone:e.getDirectPhone(),isHiddenOffline:e.isHiddenOffline(),isMobileWidget:e.isMobileWidget(),isEulaEnable:e.isEulaEnable(),getEulaLink:"https://eula.livetex.ru/"+n.getSite().getId(),offlineContacts:e.getOfflineContacts(),onlineWelcome:e.getOnlineWelcome(),offlineWelcome:e.getOfflineWelcome(),getOfflineConfirmMessage:e.getOfflineConfirmMessage(),prechatsets:e.getPreChatSets(),isThriftOnline:e.isThriftOnline(),isFileEnabled:e.isFileEnabled(),isOfflineServiceEnabled:e.isOfflineServiceEnabled(),isOmnibuttonEnabled:e.isOmnibuttonEnabled(),isChatEnabled:e.isChatEnabled(),isLeadEnabled:e.isLeadEnabled(),isCallbackEnabled:e.isCallbackEnabled(),isXWidgetEnabled:e.isXWidgetEnabled(),isTelegramEnabled:e.isTelegramEnabled(),isVkEnabled:e.isVkEnabled(),isFbEnabled:e.isFbEnabled(),isInstagramEnabled:e.isInstagramEnabled(),isWhatsAppEnabled:e.isWhatsAppEnabled(),isOdnoklassnikiAppEnabled:e.isOdnoklassnikiAppEnabled(),isViberEnabled:e.isViberEnabled(),getTelegramLink:e.getTelegramLink(),getVkLink:e.getVkLink(),getFbLink:e.getFbLink(),getInstagramLink:e.getInstagramLink(),getWhatsAppLink:e.getWhatsAppLink(),getOdnoklassnikiAppLink:e.getOdnoklassnikiAppLink(),getViberLink:e.getViberLink(),getXWidgetBanner:e.getXWidgetBanner(),VKAuthSrv:e.getVkAuthSrv(),getFileServiceURL:e.getFileServiceURL(),getMaxUploadSize:e.getMaxUploadSize(),getContentServer:e.getContentServer(),isNewBillingEnabled:e.isNewBillingEnabled(),getClassNamesForButtonBot:e.getClassNamesForButtonBot(),liveSearchURL:e.getLiveSearchURL(),botAPIToken:e.getBotAPIToken(),fileTransferringIsEnabled:e.getFileTransferringIsEnabled(),allowedFileExtensions:e.getAllowedFileExtensions()},app:{isChatAvailable:Object(r.b)(s.a.getState()),visitorSettings:Object(r.a)(s.a.getState()),isMobileType:n.isMobileType(),getAppType:n.getAppType(),leadTypes:a.a}}}};var i=n("./src/e.js"),s=(n.n(i),n("./src/redux-store/index.ts")),r=n("./src/redux-store/reducers/availability/selectors.ts"),a=n("./src/io/request/types.ts")},"./src/app/start.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return A});var i,s=n("./node_modules/tslib/tslib.es6.js"),r=n("./src/util/util.ts"),a=n("./src/app/app.ts"),o=n("./src/util/browser/browser.ts"),c=n("./src/app/env-settings.ts"),u=n("./src/app/version/version.ts"),l=n("./src/data/entity-factory.ts"),_=n("./src/redux-store/index.ts"),d=n("./src/redux-store/actions/init-transport.ts"),p=n("./src/redux-store/actions/start-app.ts"),f=n("./modules/oldmodules.js"),g=(n.n(f),n("./src/logger/logger.ts")),v=n("./src/settings/props.ts"),h=n("./src/util/serviceMemory.ts"),E=n("./src/app/app-types.ts"),b=n("./src/event-emitter/actions/set-widget-styles.ts"),m=this,S=function(){var t=new f.sm.EntityStorage;f.sm.setEntityFactory(new l.a),f.sm.setEntitySerializer(new f.sm.EntitySerializer(t)),f.sm.setEntityStorage(t)};!function(t){t[t.OFFLINE=0]="OFFLINE",t[t.ONLINE=1]="ONLINE"}(i||(i={}));var I=function(t,e,n){var i=e.additional,r=e.buttons;return{lang:t,position:i.position,mobilePosition:i.mobilePosition,expandStyle:i.expand_style,animationPeriod:i.animation_period,siteId:n,buttons:r.map(function(t){return function(t){switch(t.type){case"viber":var e=t.chat_uri,n=s.e(t,["chat_uri"]);return s.a({},n,{chatURI:e});case"custom":var i=t.event_id,r=t.image_url;return n=s.e(t,["event_id","image_url"]),s.a({},n,{eventId:i,imageURL:r?"https://"+v.a.getLTXUrl()+"/"+r:r});default:return t}}(t)})}};ar A=function(t,e,n,i,l){return void 0===i&&(i={skipBrowserCheck:!1}),s.b(m,void 0,void 0,function(){var f,m,A,T,O,L,w,C,N,D;return s.d(this,function(R){switch(R.label){case 0:if(!i.skipBrowserCheck&&(o.a.isMobile()&&!o.a.NEED_MOBILE_WIDGETS||r.a.isMobileIe()))return[3,6];f=e.LTX_URL+"js/settings/v3/"+t+".js",m=void 0,R.label=1;case 1:return R.trys.push([1,4,,5]),[4,(M=f,fetch(M).then(function(t){return t.json()}))];case 2:return A=R.sent(),m=A.results,[4,function(t,e,n){switch(t){case E.a.MOBILE:return y(function(t,e){return t+"css/mobileWidgets/"+e+".css"}(e,n));default:return y(e,n))}}(function(t){var e=E.a.EMBEDDED;if(o.a.isMobile()){if(!t)return;e=E.a.MOBILE}return e}(m.features.common.is_mobile_widget),e.LTX_URL,t).then(function(t){var n,i=t.replace(/..\/..\/fonts/g,(n=e.LTX_URL,n+"fonts")).replace(/..\/..\/images/g,e.LTX_URL)),s=Object(b.a)(i),r=s.type,a=s.payload;l.publishEvent(r,a)})];case 3:return R.sent(),[3,5];case 4:return T=R.sent(),console.error("Can not get settings or styles",T),[2];case 5:return O=s.a({},e,m,{servicesData:n}),L=m.localization,r.a.setCustomLocale(L),Object(c.d)(O),w=O.SITE.ID,C="lt-"+w+"-app-omnibutton",v.a.isOmnibuttonEnabled()?(O.label={indent_pos:"right",offset:"3",position:"bottom"},N=O.features.common.multibutton,D=I(window.ltLang,N,t),(v.a.isChatEnabled()||v.a.isLeadEnabled()&&!v.a.isHiddenOffline())&&(D.buttons=D.buttons.concat([{type:"chatsite",color:N.label_color,status:v.a.isBotEnabled()?1:0}])),v.a.isCallbackEnabled()&&(D.buttons=D.buttons.concat([{type:"callbacksite",color:N.label_color}])),h.a.setItem(C,JSON.stringify(D))):h.a.removeItem(C),function(t){g.a.init(t.LOG.LOG_LEVEL,t.LOG.MAX_COUNT,a.a.getAppType()),S(),u.a.update(t),_.a.dispatch(Object(d.b)(t)),_.a.dispatch(Object(p.b)())}(O),[3,7];case 6:console.warn("Widget can't load"),R.label=7;case 7:return[2]}var M})})}},"./src/app/states/common-enums.ts":function(t,e,n){"use strict";var i,s;n.d(e,"b",function(){return i}),n.d(e,"a",function(){return s}),i||(i={})),s||(s={}))},"./src/app/states/states.ts":function(t,e,n){"use strict";n.d(e,"c",function(){return i});var i,s=n("./src/core/state.ts"),r=n("./src/app/states/common-enums.ts");n.d(e,"a",function(){return r.a}),n.d(e,"b",function(){return r.b}),function(t){t.label=function(){var t=new s.a(r.b.LABEL);return t.add(r.a.OFFLINE,r.b.OFFLINE),t.add(r.a.DIALOG,r.b.WELCOME),t.add(r.a.BUTTON_DIALOG,r.b.DIALOG),t.add(r.a.INVITE,r.b.INVITE),t.add(r.a.X_WIDGET,r.b.X_WIDGET),t.add(r.a.CALL_REQUEST,r.b.CALL_REQUEST),t.add(r.a.BOT,r.b.LABEL),t},t.welcome=function(){var t=new s.a(r.b.WELCOME);return t.add(r.a.DIALOG,r.b.DIALOG),t.add(r.a.CLOSE,r.b.LABEL),t.add(r.a.OFFLINE,r.b.OFFLINE),t.add(r.a.BUTTON_DIALOG,r.b.DIALOG),t.add(r.a.CALL_REQUEST,r.b.CALL_REQUEST),t},t.dialog=function(){var t=new s.a(r.b.DIALOG);return t.add(r.a.OFFLINE,r.b.OFFLINE),t.add(r.a.HIDE,r.b.DIALOG_HIDDEN),t.add(r.a.BUTTON_DIALOG,r.b.DIALOG),t.add(r.a.CALL_REQUEST,r.b.CALL_REQUEST),t.add(r.a.CLOSE,r.b.LABEL),t},t.hiddenDialog=function(){var t=new s.a(r.b.DIALOG_HIDDEN);return t.add(r.a.OFFLINE,r.b.OFFLINE),t.add(r.a.SHOW,r.b.DIALOG),t.add(r.a.BUTTON_DIALOG,r.b.DIALOG),t.add(r.a.CLOSE,r.b.LABEL),t.add(r.a.CALL_REQUEST,r.b.CALL_REQUEST),t},t.invite=function(){var t=new s.a(r.b.INVITE);return t.add(r.a.DIALOG,r.b.DIALOG),t.add(r.a.OFFLINE,r.b.OFFLINE),t.add(r.a.CLOSE,r.b.LABEL),t.add(r.a.CALL_REQUEST,r.b.CALL_REQUEST),t.add(r.a.BUTTON_DIALOG,r.b.DIALOG),t.add(r.a.INVITE,r.b.INVITE),t},t.xwidget=function(){var t=new s.a(r.b.X_WIDGET);return t.add(r.a.CLOSE,r.b.LABEL),t},t.offline=function(){var t=new s.a(r.b.OFFLINE);return t.add(r.a.CLOSE,r.b.LABEL),t.add(r.a.BUTTON_DIALOG,r.b.DIALOG),t.add(r.a.CALL_REQUEST,r.b.CALL_REQUEST),t.add(r.a.HIDE,r.b.DIALOG_HIDDEN),t},t.callRequest=function(){var t=new s.a(r.b.CALL_REQUEST);return t.add(r.a.CLOSE,r.b.LABEL),t.add(r.a.CLOSE_FROM_CHAT,r.b.DIALOG_HIDDEN),t.add(r.a.BUTTON_DIALOG,r.b.DIALOG),t.add(r.a.OFFLINE,r.b.OFFLINE),t.add(r.a.CALL_INVITE,r.b.INVITE),t.add(r.a.HIDE,r.b.CALL_REQUEST_HIDDEN),t.add(r.a.BACK_TO_WELCOME,r.b.WELCOME),t},t.callRequestHidden=function(){var t=new s.a(r.b.CALL_REQUEST_HIDDEN);return t.add(r.a.SHOW,r.b.CALL_REQUEST),t.add(r.a.CALL_REQUEST,r.b.CALL_REQUEST),t.add(r.a.DIALOG,r.b.DIALOG_HIDDEN),t.add(r.a.CLOSE,r.b.LABEL),t.add(r.a.CONTINUE_DIALOG,r.b.DIALOG),t.add(r.a.OFFLINE,r.b.OFFLINE),t},t._label=t.label(),t._welcome=t.welcome(),t._invite=t.invite(),t._dialog=t.dialog(),t._hiddenDialog=t.hiddenDialog(),t._callRequest=t.callRequest(),t._callRequestHidden=t.callRequestHidden(),t._offline=t.offline(),t._xwidget=t.xwidget()}(i||(i={}))},"./src/app/transport/transport.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/tabs/tabs.ts");!function(t){t.init=var e=(i||(i={}))},"./src/app/version/version.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/util/serviceMemory.ts"),r=n("./src/util/util.ts");!function(t){t.update=function(s){n!==t.__current&&e.indexOf(n)>=0&&i()};var e=["3.0.4","3.0.14","3.0.15","3.2.4","3.2.5-lh"];t.__current="24.5.3015-496641c";var n="no-version",i=function(){for(var t=s.a&&s.a.isPrivateMode?s.a.getKeys():Object.keys(window.localStorage),e=0,n=t.length;e<n;e+=1)a(t[e])&&r.a.removeFromStorage(t[e])},a=function(t){return"lt-"===t.substr(0,3)&&"lt-api-visitor-key"!==t}}(i||(i={}))},"./src/core/app-state.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./src/store/storage.ts"),s=n("./src/app/app.ts"),r=n("./src/app/states/states.ts"),a=n("./src/logger/logger.ts"),o=function(){function t(e,n,i){this.__name=e,this.__storage=s.a.createCrossStorage(e),this.__startState=i,this.__data=t.NO_DATA,this.__stateMap=n,this.__listeners=[],this.__listenTransports()}return t.addTransports=function(e){for(var n=0,i=e.length;n<i;n+=1)t.__transports.push(e[n])},t.prototype.getName=function(){return this.__name},t.prototype.getData=function(){return this.__loadData()},t.prototype.getState=function(){return this.__loadState()},t.prototype.transit=function(e,n){var i=this.__stateMap.getTransition(this.__loadState(),e);return i!==t.ERROR_STATE?this.__changeTo(i,n):a.a.info("Invalid state transition: "+this.__loadState()+" by event: "+e,this),i},t.prototype.restore=function(){var t=this;return this.__storage.onInit(function(){t.__restoreState(),t.__onState(t.__loadState(),t.__loadData()),a.a.info("State restored: "+t.__loadState(),t)}),this.__loadState()},t.prototype.subscribe=t.prototype._clear=t.prototype.__saveState=t.prototype.__saveData=function(e){var n=Object.assign({},e,{message:e.message?"":void 0,initial_message:e.initial_message?"":void 0});this.__storage.setPermanently(t.DATA_KEY,n)},t.prototype.__loadState=function(){return this.__storage.get(t.STATE_KEY)===i.b.NO_DATA?this.__startState:this.__storage.get(t.STATE_KEY).toString()},t.prototype.__loadData=t.prototype.__restoreState=function(){var e=this.__storage.get(t.STATE_KEY).toString();switch(e){case r.b.CALL_REQUEST_HIDDEN:this.__saveState(r.b.DIALOG_HIDDEN);break;case r.b.X_WIDGET:case r.b.INVITE:this.__saveState(this.__startState),this.__data=t.NO_DATA,this.__storage.set(t.DATA_KEY,t.NO_DATA);break;default:this.__saveState(e),this.__data=this.__storage.get(t.DATA_KEY)}},t.prototype.__onState=function(t,e){this.__listeners.forEach(},t.prototype.__onStateLeave=function(t){var e=this;this.__listeners.forEach(function(n){n.onStateLeave(t||e.__loadState())})},t.prototype.__changeTo=function(e,n){var i=this.__loadState();a.a.info("Changing from "+this.__loadState()+" \u2192 "+e,this),this.__saveState(e),this.__saveData(n||""),this.__onStateLeave(i),this.__dispatch(i),this.__data=void 0!==n?n:t.NO_DATA,this.__onState(e,this.__data)},t.prototype.__dispatch=function(e){var n=this;t.__transports.forEach(function(i){i.dispatch(t.EVENT+"-"+n.__name,e)})},t.prototype.__listenTransports=function(){var e=this;t.__transports.forEach(function(n){n.addEventListener(t.EVENT+"-"+e.__name,function(t,n){e.__onStateLeave(n),e.__onState(e.__loadState(),e.__loadData())})})},t.__transports=[],t.ERROR_STATE="error-state",t.NO_DATA=i.b.NO_DATA,t.STATE_KEY="state",t.DATA_KEY="data",t.EVENT="transit-from",t}()},"./src/core/component.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i=n("./src/core/listener.ts"),s=n("./src/core/publisher.ts"),r=n("./src/core/state-component.ts"),a=n("./src/core/util/util.ts"),o=n("./src/util/util.ts"),c=n("./src/logger/logger.ts"),u=n("./src/core/app-state.ts"),l=n("./src/redux-store/index.ts"),_=n("./node_modules/redux/es/redux.js"),d=function(){function t(t,e,n){var i=this;this.__name=t,this.__publisher=null,this.__componentApi=null,this.__componentState=null,this.__listeners={},this.mapStateToProps=e,this.actions=n,this.mapStateToProps&&(this.props=this.mapStateToProps(l.a.getState()),l.a.subscribe(function(){var t=l.a.getState(),e=i.mapStateToProps(t);i.shouldUpdate(e)&&(i.props=e,i.updateReduxState(e))})),this.actions&&(this.actionCreators=Object(_.bindActionCreators)(this.actions,l.a.dispatch))}return t.prototype.getName=function(){return this.__name},t.prototype.listenEvents=function(t,e){new i.a(this,t,e)},t.prototype.publishEvents=function(t,e){this.__publisher=new s.a(this.__name,e,t)},t.prototype.publishEvent=function(t,e){null!==this.__publisher&&this.__publisher.publishEvent(t,e)},t.prototype.onEvent=function(t,e){if(null===this.__componentState||this.__componentState.isStateAllowed()){var n="_"+o.a.toCamelCase(t);void 0!==this[n]&&this[n](e)}},t.prototype.registerApi=function(t){this.__componentApi=t},t.prototype.storeEventLog=t.prototype.asyncRequest=function(t,e,n,i,s){var r=this,a=s||1e4,o=null;function u(t){r.removeApiListener(e,u),clearTimeout(o),n(t)}this.addApiListener(e,u),this.sendRequest(t),o=setTimeout(function(){r.removeApiListener(e,u);var t="Not respond "+e+" after "+a+".ms";c.a.debug(t,r),i&&i(t)},a)},t.prototype.addApiListener=function(t,e){if(null!==this.__componentApi){var n=this,i=new a.a(t,e,function(t){(null===n.__componentState||n.__componentState.isStateAllowed())&&e(t)});void 0===this.__listeners[i.getType()]&&(this.__listeners[i.getType()]=[]),this.__listeners[i.getType()].push(i),this.__componentApi.addListener(i.getType(),i.getRealListener())}},t.prototype.sendRequest=function(t,e,n){null!==this.__componentApi&&this.__componentApi.send(t,e,n)},t.prototype.removeApiListener=function(t,e){var n=this.__listeners[t];if(void 0!==n){var i=this.__getListener(e,n);null!==this.__componentApi&&null!==i&&(this.__componentApi.removeListener(i.getType(),i.getRealListener()),delete n[n.indexOf(i)])}},t.prototype.__getListener=function(t,e){for(var n=0,i=e.length;n<i;n+=1)if(e[n]&&e[n].getListener()===t)return e[n];return null},t.prototype.registerState=function(t,e){this.__componentState=new r.a(this,t,e)},t.prototype.getState=function(){return null!==this.__componentState?this.__componentState.getState():u.a.ERROR_STATE},t.prototype.transitState=function(t,e){return null!==this.__componentState?this.__componentState.transitState(t,e):u.a.ERROR_STATE},t.prototype.updateReduxState=function(t){},t.prototype.shouldUpdate=t}()},"./src/core/listener.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(t,e,n){this.__name=t.getName(),this.__component=t;for(var i=0,s=n.length;i<s;i+=1)e.registerListener(this,n[i])}return t.prototype.getName=function(){return this.__name},t.prototype.onEvent=function(t,e){void 0!==this.__component.onEvent&&this.__component.onEvent(t,e)},t}()},"./src/core/macros.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./src/util/index.ts"),s=function(t,e,n){e.prototype["_"+i.a.toCamelCase(t)]=n}},"./src/core/publisher.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(t,e,n){this.__name=t,this.__publishRegistry=n;for(var i=0,s=e.length;i<s;i+=1)n.registerPublisher(this,e[i])}return t.prototype.getName=function(){return this.__name},t.prototype.publishEvent=t}()},"./src/core/registry.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./src/logger/logger.ts"),s=function(){eturn t.prototype.publishEvent=function(t,e,n){if(this._hasPublisher(t,e)){var s=this.__listeners[e];i.a.debug("publish event type="+e+" registry="+this.__name,t,n);for(var r=0,a=s.length;r<a;r+=1)s[r].onEvent(e,n)}else i.a.warn("publish event, but not registered type="+e+" registry="+this.__name+" data="+n,t)},t.prototype.registerPublisher=function(t,e){i.a.debug("register publisher type="+e+" registry="+this.__name,t),this._hasPublisher(t,e)||this._addPublisher(t,e)},t.prototype.registerListener=function(t,e){i.a.debug("register listener type="+e+" registry="+this.__name,t),this._hasListener(t,e)||this._addListener(t,e)},t.prototype.getName=function(){return this.__name},t.prototype._hasPublisher=function(t,e){return void 0!==this.__publishers[t.getName()]&&-1!==this.__publishers[t.getName()].indexOf(e)},t.prototype._addPublisher=function(t,e){this.__initListeners(e),void 0===this.__publishers[t.getName()]&&(this.__publishers[t.getName()]=[]),this.__publishers[t.getName()].push(e)},t.prototype._hasListener=function(t,e){return void 0!==this.__listeners[e]&&-1!==this.__listeners[e].indexOf(t)},t.prototype._addListener=function(t,e){this.__initListeners(e),this.__listeners[e].push(t)},t.prototype.__initListeners=function(t){void 0===this.__listeners[t]&&(this.__listeners[t]=[])},t}()},"./src/core/state-component.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./src/redux-store/actions/set-view-state.ts"),s=n("./src/redux-store/index.ts"),r=function(){function t(t,e,n){this.__component=t,this.__appState=e,this.__allowedStates=n||[],e.subscribe(this)}return t.prototype.getName=function(){return this.__component.getName()},t.prototype.onState=function(t,e){this.__isStateAllowed(t)&&(s.a.dispatch(Object(i.b)(t)),this.__component.onState(t,e))},t.prototype.onStateLeave=t.prototype.getState=t.prototype.transitState=t.prototype.isStateAllowed=t.prototype.__isStateAllowed=function(t){return 0===this.__allowedStates.length||this.__allowedStates.indexOf(t)>=0},t}()},"./src/core/state-map.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./src/core/app-state.ts"),s=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.__states=Array.prototype.slice.call(t)}return t.prototype.getTransition=function(t,e){for(var n=i.a.ERROR_STATE,s=0,r=this.__states.length;s<r;s+=1)if(this.__states[s].equals(t))return this.__states[s].getTransition(e);return n},t}()},"./src/core/state.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./src/core/app-state.ts"),s=function(){eturn t.prototype.add=function(t,e){this.__transitions[t]=e},t.prototype.toString=function(){return this.__state},t.prototype.equals=function(e){return e instanceof t&&this.toString()===e.toString()||"string"==typeof e&&this.toString()===e},t.prototype.getTransition=function(t){return this.__transitions[t]||i.a.ERROR_STATE},t}()},"./src/core/util/util.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=)},"./src/data/availability-level.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./src/settings/props.ts"),s=n("./src/data/member-status.ts"),r=n("./src/io/request/vnds/request.ts"),a=function(){function t(t){this.__availabilityLevel=t}return t.prototype.isOnline=function(){return this.__availabilityLevel>r.a.OFFLINE},t.prototype.toMemberStatus=function(){switch(this.__availabilityLevel){case r.a.OFFLINE:case r.a.PAUSE:return s.a.OFFLINE;case r.a.BUSY:return s.a.BUSY;default:return s.a.ONLINE}},t.prototype.isAvailable=function(){return this.__availabilityLevel>=i.a.getMinAvailabilityLevel()},t.prototype.getValue=function(){return this.__availabilityLevel},t}()},"./src/data/contact-type.ts":"./src/data/conversation-attribute-type.ts":"./src/data/data.ts":function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"b",function(){return a}),n.d(e,"a",function(){return o}),n.d(e,"d",function(){return i}),n.d(e,"j",function(){return c}),n.d(e,"i",function(){return u}),n.d(e,"k",function(){return _}),n.d(e,"h",function(){return d}),n.d(e,"g",function(){return p}),n.d(e,"f",function(){return f}),n.d(e,"l",function(){return g}),n.d(e,"e",function(){return v});var i,s=n("./src/data/contact-type.ts"),r="",a=0,o="\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435, \u0447\u0435\u043c \u043c\u043e\u0433\u0443 \u043f\u043e\u043c\u043e\u0447\u044c?";!i||(i={}));var c=function(t){return"number"==typeof t.from&&"number"==typeof t.to&&t.to>t.from&&t.from>=0&&t.to<=86400&&Array.isArray(t.days)&&t.days.length>0&&t.days.every(function(t){return"number"==typeof t&&t in[0,1,2,3,4,5,6]})},u=function(t){return"object"==typeof t&&(void 0===t.status||Array.isArray(t.status))&&(void 0===t.is_available||"boolean"==typeof t.is_available)&&(void 0===t.departmentId||"string"==typeof t.departmentId)},l=function(t){return"object"==typeof t&&"string"==typeof t.value&&(t.type===s.a.EMAIL||t.type===s.a.PHONE)},_=function(t){var e=t.contacts,n=t.name;if(!n&&!e||n&&("object"!=typeof n||"string"!=typeof n.name||"boolean"!=typeof n.is_editable)||e&&("object"!=typeof e||!Array.isArray(e)))return!1;if(e)for(var i=0,s=e;i<s.length;i++){var r=s[i];if(!l(r))return!1}return!0},d=function(t,e){return"string"==typeof t[e]?t[e]:r},p=function(t,e){return"number"==typeof t[e]?t[e]:a},f=g=function(t){var e={};return e[t.getFullName()]=t.serializeData(),e},v=function(t,e){var n=e.status,i=e.is_available;return(void 0===n||Array.isArray(n)&&-1!==n.indexOf(Number(t.toMemberStatus())))&&(void 0===i||t.isAvailable()===i)}},"./src/data/dialog.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/app/app.ts"),r=n("./src/data/entity-name.ts"),a=n("./src/data/data.ts"),o=n("./src/data/member.ts"),c=n("./src/data/group.ts"),u=n("./src/data/messages-list.ts"),l=n("./src/data/legacy-parent/index.ts"),_=n("./modules/oldmodules.js"),d=(n.n(_),function(t){function e(e,n){var i=t.call(this,r.a.DIALOG,e,[])||this;return i.__visitorFirstMessage="",i.__memberFirstMessage="",i.__group=null,i.__member=null,i.__conversationId=e,i.__messagesList=new u.a,i}return i.c(e,t),e.prototype.getMember=function(){return this.__member},e.prototype.getConversationId=function(){return this.__conversationId},e.prototype.getMessagesList=function(){return this.__messagesList},e.prototype.setMember=function(t){this.__member=t},e.prototype.getGroup=function(){return this.__group},e.prototype.setGroup=function(t){this.__group=t},e.prototype.getMemberFirstMessage=function(){return this.__memberFirstMessage},e.prototype.getVisitorFirstMessage=function(){return this.__visitorFirstMessage},e.prototype.serializeData=function(t){var e={};switch(t){case"storage":return this.__member&&(e.member=_.sm.serializeEntity(this.__member,t)),this.__group&&(e.group_id=this.__group.getId()),e;default:return e}},e.prototype.populateData=function(t){if("string"==typeof t.target_member_id&&(this.__member=new o.a(Object(a.h)(t,"target_member_id")),this.__member.populateData(t)),t.member instanceof Object){var e=_.sm.reconstructEntity(t.member);e instanceof o.a&&(this.__member=e)}"string"==typeof t.message&&(this.__memberFirstMessage=t.message),t.group instanceof c.a&&(this.__group=t.group);var n=s.a.getSite();if("string"==typeof t.group_id&&n){var i=_.sm.createEntity(r.a.GROUP,t.group_id,[n]);i instanceof c.a&&(i.populateData({name:t.group_id}),"1"!==i.getId()&&(this.__group=i))}},e}(l.a))},"./src/data/employee-status.ts":"./src/data/entity-factory.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return _});var i=n("./src/data/entity-name.ts"),s=n("./src/data/site.ts"),r=n("./src/data/group.ts"),a=n("./src/data/dialog.ts"),o=n("./src/data/member.ts"),c=n("./src/data/page.ts"),u=n("./src/data/feature.ts"),l=n("./src/data/invite.ts"),_=function(){function t(){}return t.prototype.createEntity=function(t,e,n){var _=null,d=null;void 0!==n&&(void 0!==n[0]&&(_=n[0]),void 0!==n[1]&&(d=n[1]));var p=null;switch(t){case i.a.ACCOUNT:p=e;break;case i.a.MEMBER:p=new o.a(e);break;case i.a.SITE:p=new s.a(e);break;case i.a.VISITOR:p=_;break;case i.a.GROUP:p=new r.a(e,_);break;case i.a.DIALOG:p=new a.a(e,_);break;case i.a.PAGE:p=new c.a(e,_);break;case i.a.FEATURE:p=new u.a(e,_,d);break;case i.a.INVITE:p=new l.a(e,_)}return p},t}()},"./src/data/entity-name.ts":"./src/data/factory/factory.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/util/util.ts"),r=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),a=(n.n(r),n("./src/app/app.ts")),o=n("./src/data/message.ts"),c=n("./src/data/message-type.ts"),u=n("./src/data/group.ts"),l=n("./src/data/member.ts"),_=n("./src/data/feature.ts"),d=n("./src/settings/props.ts"),p=n("./src/redux-store/index.ts"),f=n("./src/redux-store/reducers/visitor/selectors.ts");!function(t){t.createFeature=function(t,e,n,i){var s=new l.a(e),r=new u.a(n,i);return new _.a(t,s,r)},t.createMessage=function(t,e,n,i){return new o.a(s.a.generateGuid(),e,n,i,t)},t.createRatingMessage=function(t,e,n,i){return new o.a(s.a.generateGuid(),e,JSON.stringify(n),i,t)},t.createHoldingMessage=function(e,n){return t.createMessage(e,c.a.HOLDING_MESSAGE,n)},t.createAssignMessage=function(e,n){return t.createMessage(e,c.a.ASSIGN_TO_OPERATOR,n)},t.createSystemMessage=function(e,n){return t.createMessage(e,c.a.FROM_SYSTEM,n)},t.createHoldingMessageFromHistory=function(e,n,i){return t.createMessageFromServer(i.messageId,c.a.HOLDING_MESSAGE,i.text,n.createDatetime,e)},t.createOfferCallbackMessageFromHistory=function(e,n,i){return t.createMessageFromServer(i.messageId,c.a.CALLBACK,"ConversationRoutingNotification"===i.text?s.a.getTranslation("queue_message_2"):i.text||"",n.createDatetime,e,null,{isHoldingMessage:!("ConversationRoutingNotification"===i.text)})},t.createInviteMessage=function(t){return new o.a(s.a.generateGuid(),c.a.FROM_MEMBER,t,null,null,{showQuote:!1})},t.createTextMessageFromHistory=function(n,i,s){return t.createMessageFromServer(s.messageId,e(i.recordType),s.text,i.createDatetime,n,i.employeeId||Object(f.b)(p.a.getState()),{showQuote:e(i.recordType)===c.a.FROM_MEMBER})},t.createRouteChatMessageFromHistory=function(n,i,r){return t.createMessageFromServer(r.messageId,e(i.recordType),s.a.getTranslation("queue_message_1"),i.createDatetime,n)},t.createRatingChatMessageFromHistory=function(e,n,i){return t.createMessageFromServer(i.messageId,c.a.CHAT_VOTE,JSON.stringify(i.rate),n.createDatetime,e)},t.createChatDroppedMessageFromHistory=function(e,n,i){return t.createMessageFromServer(i.messageId,c.a.CHAT_DROPPED,s.a.getTranslation("chat_dropped_message"),n.createDatetime,e)};var e=function(t){if(t===r.model.ChatMessageHistoryRecordType.VISITOR_MESSAGE.value)return c.a.FROM_VISITOR;if(t===r.model.ChatMessageHistoryRecordType.EMPLOYEE_MESSAGE.value)return c.a.FROM_MEMBER;if(t===r.model.ChatMessageHistoryRecordType.SYSTEM_MESSAGE.value)return c.a.FROM_SYSTEM;throw new Error("Undefined recordType")};t.createTextMessageFromNotification=function(e){return t.createMessageFromServer(e.message.eventId,c.a.FROM_MEMBER,e.text,e.message.timestamp,e.message.cid,e.message.senderId,{showQuote:!0})},t.createFileMessageFromHistory=function(n,i,r,a){return t.createMessageFromServer(s.a.generateGuid(),e(i.recordType),a.url,i.createDatetime,n,i.employeeId||Object(f.b)(p.a.getState()))},t.createStickerMessageFromHistory=function(n,i,s){return t.createMessageFromServer(s.messageId,e(i.recordType),t.createStickerText(s.stickerId),i.createDatetime,n,i.employeeId||Object(f.b)(p.a.getState()))},t.createCloseMessageFromHistory=function(e,n,i){return t.createMessageFromServer(i.messageId,c.a.CHAT_CLOSED,"",n.createDatetime,e,n.employeeId||Object(f.b)(p.a.getState()))},t.createStickerMessageFromNotification=function(e){return t.createMessageFromServer(e.message.eventId,c.a.FROM_MEMBER,t.createStickerText(e.stickerId),e.message.timestamp,e.message.cid,e.message.senderId,{showQuote:!0})},t.createHoldingMessageFromNotification=function(e){return t.createMessageFromServer(e.message.eventId,c.a.HOLDING_MESSAGE,e.text,e.message.timestamp,e.message.cid,e.message.senderId)},t.createOfferCallbackMessageFromNotification=function(e){return t.createMessageFromServer(e.message.eventId,c.a.CALLBACK,"ConversationRoutingNotification"===e.text?s.a.getTranslation("queue_message_2"):e.text||"",e.message.timestamp,e.message.cid,e.message.senderId,{isHoldingMessage:!("ConversationRoutingNotification"===e.text)})},t.createStickerText=t.createMessageFromServer=function(t,e,n,i,s,r,c){var u=new o.a(t,e,n,a.a.convertToClientTime(i),s,c);return"string"==typeof r&&u.setSenderId(r),u},t.createVisitorMessage=(i||(i={}))},"./src/data/feature-type.ts":"./src/data/feature.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/data/group.ts"),r=n("./src/data/member.ts"),a=n("./src/data/entity-name.ts"),o=n("./modules/oldmodules.js"),c=(n.n(o),function(t){function e(e,n,i){var s=t.call(this,a.a.FEATURE,e,[n,i])||this;return s.__member=n,s.__group=i,s}return i.c(e,t),e.prototype.getMember=function(){return this.__member},e.prototype.getGroup=function(){return this.__group},e.prototype.equal=e.prototype.populateData=function(t,e){if(t.member instanceof Object){var n=o.sm.reconstructEntity(t.member,e);n instanceof r.a&&(this.__member=n)}if(t.group instanceof Object){var i=o.sm.reconstructEntity(t.group,e);i instanceof s.a&&(this.__group=i)}},e}(n("./src/data/legacy-parent/index.ts").a))},"./src/data/group.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/data/data.ts"),r=n("./src/data/entity-name.ts"),a=function(t){function e(e,n){var i=t.call(this,r.a.GROUP,e,[n])||this;return i.__displayName=s.c,i.__site=n,i.__displayName=s.c,i}return i.c(e,t),e.prototype.populate=function(t,e){this.__displayName=t,this.__sortOrder=e},e.prototype.getSite=function(){return this.__site},e.prototype.getSortOrder=function(){return this.__sortOrder},e.prototype.getFirstName=function(){return this.__displayName},e.prototype.populateData=function(t,e){this.__displayName=Object(s.h)(t,"name"),this.__sortOrder=Object(s.g)(t,"sorting")},e.prototype.encodeData=e.ANY_GROUP_ID="*",e}(n("./src/data/legacy-parent/index.ts").a)},"./src/data/invite.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return f});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/data/group.ts"),r=n("./src/data/entity-name.ts"),a=n("./src/data/factory/factory.ts"),o=n("./src/data/member.ts"),c=n("./src/data/data.ts"),u=n("./src/data/feature.ts"),l=n("./modules/oldmodules.js"),_=(n.n(l),n("./src/data/legacy-parent/index.ts")),d=n("./src/data/feature-type.ts"),p=n("./src/app/app.ts"),f=function(t){function e(e,n,i,u){var l=t.call(this,r.a.INVITE,e,[])||this;return l.__feature=a.a.createFeature(d.a.CHAT,o.a.ANY_MEMBER_ID,s.a.ANY_GROUP_ID,p.a.getSite()),l.__memberFirstMessage=i||c.c,l.__invitingMember=null,l}return i.c(e,t),e.prototype.populateData=function(t,e){if(t.member instanceof o.a)this.__invitingMember=t.member;else if(t.member instanceof Object){var n=l.sm.reconstructEntity(t.member,e);n instanceof o.a&&(n.populateData(t.member),this.__invitingMember=n)}else this.__invitingMember=null;if(t.feature instanceof u.a)this.__feature=t.feature;else if(t.feature instanceof Object){var i=l.sm.reconstructEntity(t.feature,e);i instanceof u.a&&(i.populateData(t.feature),this.__feature=i)}this.__memberFirstMessage=Object(c.h)(t,"invite_text")},e.prototype.serializeData=function(){return{member:null!==this.__invitingMember?l.sm.serializeEntity(this.__invitingMember):""}},e.prototype.getFeature=function(){return this.__feature},e.prototype.getMemberFirstMessage=function(){return this.__memberFirstMessage},e}(_.a)},"./src/data/legacy-parent/index.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./modules/oldmodules.js"),s=(n.n(i),i.sm.Entity)},"./src/data/member-status.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),function(t){t.ONLINE="1",t.OFFLINE="",t.BUSY="2"}(i||(i={}))},"./src/data/member.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return _});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/settings/props.ts"),r=n("./src/data/entity-name.ts"),a=n("./src/data/data.ts"),o=n("./src/data/member-status.ts"),c=n("./src/e.js"),u=(n.n(c),n("./src/data/legacy-parent/index.ts")),l=n("./src/io/request/vnds/request.ts"),_=function(t){function e(e){var n=t.call(this,r.a.MEMBER,e)||this;return n.__nickName=a.c,n.__avatarUrl=a.c,n.__lastName=a.c,n.__firstName=a.c,n.__id=e,n.__status=l.a.OFFLINE,n.__label=s.a.getMemberLabel(n.getId()),n.__isBlocked=s.a.isBlockedMember(n.getId()),n}return i.c(e,t),e.prototype.populate=e.create=e.prototype.getFirstName=function(){return this.__firstName},e.prototype.getLastName=function(){return this.__lastName},e.prototype.getLabel=function(){return this.__label},e.prototype.isBlocked=function(){return this.__isBlocked},e.prototype.getAvatarUrl=function(){return this.__avatarUrl},e.prototype.getStatus=function(){return this.__status},e.prototype.toMemberStatus=function(){switch(this.__status){case l.a.FREE:return o.a.ONLINE;case l.a.BUSY:return o.a.BUSY;default:return o.a.OFFLINE}},e.prototype.getNickName=function(){return this.__nickName},e.prototype.setStatus=e.prototype.isAvailable=function(){return this.__status>=s.a.getMinAvailabilityLevel()},e.prototype.isAvailableForChat=function(t){return t?this.__status>l.a.OFFLINE:this.isAvailable()},e.prototype.serializeData=function(t){switch(t){case"storage":return{firstname:this.__firstName,lastname:this.__lastName,status:this.__status,avatar:this.__avatarUrl,nickname:this.__nickName};case c.e.s.api.INVITATION_WINDOW_SHOWN:case c.e.s.api.SHOW_CONVERSATION_WINDOW:case c.e.s.api.SHOW_INVITE:case c.e.s.api.GET_EMPLOYEES:return{id:this.__id,name:[this.__firstName,this.__lastName].join(" ").trim(),avatar_url:this.__avatarUrl,status:Number(this.__status),is_available:this.isAvailable()};default:return{}}},e.prototype.encodeData=e.prototype.populateData=function(t){""===Object(a.h)(t,"first_name")&&""===Object(a.h)(t,"firstname")||(this.__firstName=""===Object(a.h)(t,"first_name")?Object(a.h)(t,"firstname"):Object(a.h)(t,"first_name")),""===Object(a.h)(t,"last_name")&&""===Object(a.h)(t,"lastname")||(this.__lastName=""===Object(a.h)(t,"last_name")?Object(a.h)(t,"lastname"):Object(a.h)(t,"last_name")),""!==Object(a.h)(t,"label")&&(this.__label=Object(a.h)(t,"label")),""!==Object(a.h)(t,"avatar")?this.__avatarUrl=Object(a.h)(t,"avatar"):""!==Object(a.h)(t,"avatar_url")&&(this.__avatarUrl=Object(a.h)(t,"avatar_url")),""===Object(a.h)(t,"nick_name")&&""===Object(a.h)(t,"nickname")||(this.__nickName=""===Object(a.h)(t,"nick_name")?Object(a.h)(t,"nickname"):Object(a.h)(t,"nick_name"))},e.ANY_MEMBER_ID="*",e.DUMMY_MEMBER_ID="0",e}(u.a)},"./src/data/message-type.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),i||(i={}))},"./src/data/message.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/settings/props.ts"),r=n("./src/data/entity-name.ts"),a=n("./src/data/data.ts"),o=n("./src/e.js"),c=(n.n(o),n("./src/data/message-type.ts")),u=n("./src/data/legacy-parent/index.ts"),l=n("./src/redux-store/index.ts"),_=n("./src/redux-store/reducers/visitor/selectors.ts"),d=function(t){function e(e,n,i,s,o,u){var l=t.call(this,r.a.MESSAGE,e)||this;return l.__text=i||a.c,l.__type=c.a.DEFAULT,l.__senderId=a.c,l.__localId=e,l.__conversationId=o||"",l.__timestamp=a.b,l.__sendTime=s||(new Date).getTime(),l.__opt_meta=u,l.__setType(n||c.a.DEFAULT),l}return i.c(e,t),e.fromSerialized=function(t){if(t instanceof Object){var n=t.message_id,i=t.type,s=t.text,r=t.timestamp;if(void 0!==n&&void 0!==i)return new e(n,i,s,r)}return null},e.prototype.getConversationId=function(){return this.__conversationId},e.prototype.getType=function(){return this.__type},e.prototype.getText=function(){return this.__text},e.prototype.getTime=e.prototype.getLocalId=function(){return this.__localId},e.prototype.serializeData=function(t){return t===o.e.s.api.EMPLOYEE_MESSAGE_SENT||t===o.e.s.api.OFFLINE_MESSAGE_SENT?{message_id:this.getFullName(),sender_id:this.__senderId,text:this.__text,meta:this.__opt_meta?this.__opt_meta:null}:this.encodeData()},e.prototype.encodeData=function(){return{message_id:this.getLocalId(),type:this.getType(),text:this.getText(),timestamp:this.getTime(),meta:this.__opt_meta?this.__opt_meta:null}},e.prototype.setMetaData=function(t){return this.__opt_meta?this.__opt_meta=i.a({},this.__opt_meta,t):this.__opt_meta=t,this},e.prototype.__setType=function(t){this.__type=t;var e=Object(_.b)(l.a.getState());this.__type===c.a.FROM_VISITOR&&e&&this.setSenderId(e)},e.prototype.setSenderId=function(t){this.__senderId=t},e.prototype.getSenderId=function(){return this.__senderId},e.prototype.isFileMessage=function(){var t=s.a.getFileServiceURL(),e=this.getText()||"",n=!!s.a.isOfflineServiceEnabled(),i=-1!==e.indexOf(t);return n&&i},e}(u.a)},"./src/data/messages-list.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./src/data/message-type.ts"),s=function(){function t(){this.__messages={}}return t.prototype.addMessage=function(t){t&&!this.hasMessage(t)&&(this.__messages[t.getId()]=t)},t.prototype.addMessages=t.prototype.hasMessage=function(t){return null!==t&&t.getId()in this.__messages},t.prototype.removeMessage=t.prototype.getMessages=function(){var t=[];for(var e in this.__messages)t.push(this.__messages[e]);return t.sort(function(t,e){return t.getTime()-e.getTime()})},t.prototype.count=t.prototype.clearList=function(){this.__messages={}},t.prototype.isChatClosed=function(){var t=this.getMessages();return t.length>0&&t[t.length-1].getType()===i.a.CHAT_CLOSED},t}()},"./src/data/page.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return u});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./src/util/date/date.ts"),a=n("./src/data/entity-name.ts"),o=n("./src/data/data.ts"),c=n("./src/logger/logger.ts"),u=function(t){function e(e,n){var i=t.call(this,a.a.PAGE,e,[n])||this;return i.__countryCode=o.c,i.__countryName=o.c,i.__cityName=o.c,i.__region=o.c,i}return i.c(e,t),e.__extractSeoData=function(t){var n={},i="";try{i=String(decodeURIComponent(t))}catch(t){c.a.error("Troubles with decoding referrer url")}n.seo_engine=Object(o.f)(e.__extractSeoEngine(i));var r=e.__extractSeoQuery(n.seo_engine,i);return n.seo_query=Object(o.f)(s.a.encodeBase64(r)),n.seo_referrer=Object(o.f)(s.a.encodeBase64(e.__extractSeoReferrer(i,n.seo_engine,r))),n},e.__extractSeoEngine=function(t){for(var n in e.__ENGINES)if(new RegExp(e.__ENGINES[n].prefix).test(t))return n;return""},e.__extractSeoQuery=function(t,n){if(e.__ENGINES[t]instanceof Object){var i=e.__ENGINES[t].key,s=n.match(new RegExp("[&|\\?]"+i+"=([^&]*)&?"));return null!==s&&2===s.length?s[1]:""}return""},e.__extractSeoReferrer=function(t,n,i){switch(n){case"yandex":return e.__recoverYandexReferrer(i);default:return t}},e.__recoverYandexReferrer=e.prototype.getGeoData=e.prototype.getPageCount=function(){return this.__pageCount},e.getSeoQuery=function(){var t="";try{t=String(decodeURIComponent(window.parentReferrer))}catch(t){c.a.error("Troubles with decoding referrer url")}var n=Object(o.f)(e.__extractSeoEngine(t));return void 0!==n?e.__extractSeoQuery(n,t):""},e.prototype.populateData=function(t){var e=new Date;this.__countryCode=Object(o.h)(t,"country_code"),this.__countryName=Object(o.h)(t,"country_name"),this.__cityName=Object(o.h)(t,"city_name"),this.__region=Object(o.h)(t,"region"),this.__pageCount=Object(o.g)(t,"page_count"),r.b.setDelta(Object(o.g)(t,"creation_time")-e.getTime())},e.prototype.serializeData=function(){var t=e.__extractSeoData(window.parentReferrer);return t.referrer=Object(o.f)(s.a.encodeBase64(window.parentReferrer)),t.page_title=Object(o.f)(s.a.encodeBase64(window.parentTitle)),t.page_url=Object(o.f)(s.a.encodeBase64(window.parentHref.toString())),t},e.__ENGINES={google:{prefix:"https?://www\\.google\\.",key:"q"},yandex:{prefix:"https?://yandex\\.",key:"text"},rambler:{prefix:"rambler\\.ru/search",key:"query"},mailru:{prefix:"https?://go\\.mail\\.ru/",key:"q"},bing:{prefix:"https?://www\\.bing\\.com/",key:"q"},yahoo:{prefix:"https?://.*\\.yahoo\\.com/",key:"p"},ask:{prefix:"https?://.*\\.ask\\.com/",key:"q"},qip:{prefix:"https?://search\\.qip\\.ru/search",key:"query"}},e}(n("./src/data/legacy-parent/index.ts").a)},"./src/data/site.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return u});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./src/data/entity-name.ts"),a=n("./src/data/page.ts"),o=n("./src/data/legacy-parent/index.ts"),c=n("./src/io/request/vnds/request.ts"),u=function(t){function e(e){var n=t.call(this,r.a.SITE,e)||this;return n.__groups=[],n.__chatAvailabilityLevel=c.a.OFFLINE,n.__page=new a.a(s.a.generateId(),n),n}return i.c(e,t),e.prototype.getPage=function(){return this.__page},e.prototype.setChatAvailabilityLevel=function(t){this.__chatAvailabilityLevel=t},e.prototype.getChatAvailabilityLevel=function(){return this.__chatAvailabilityLevel},e.prototype.getGroups=function(){return this.__groups},e.prototype.addGroup=function(t){this.__groups=this.__groups.concat(t).filter(function(t,e,n){return n.map(function(t){return t.getId()}).indexOf(t.getId())===e})},e}(o.a)},"./src/data/source-type.ts":"./src/data/status.ts":"./src/e.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.w=e.e=void 0;var i=n("./node_modules/@livetex/piper/lib/index.js"));var s={},r=i.w;s.s=i.e.s,s.w=i.e.w,s.Event,s.Events,e.e=s,e.w=r},"./src/event-emitter/actions/index.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i="onload-services"},"./src/event-emitter/actions/init.ts":"./src/event-emitter/actions/notifications.ts":"./src/event-emitter/actions/set-widget-styles.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=,"./src/event-emitter/actions/view-init.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i="view-run",s="view-onload",r=function(t,e,n,r){return{type:i,responseType:s,payload:{livetexId:t,ltxUrl:e,appType:n,customCssUrl:r}}}},"./src/event-emitter/index.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),function(t){var e,n,i=new Map;t.init=function(t,s,r){e=s,n=r,t.window.addEventListener("message",function(t){var s=t.origin,r=t.data;if(s===e.link){var a=r.type,o=r.payload,c=i.get(a);c&&(n("listen",a,o),c.forEach(function(t){t(o)}))}})},t.listenEvent=function(t,e){return new Promise(function(n){var s=i.get(t)||new Set;s.add(e||n),i.set(t,s)})},t.removeListener=function(t,e){var n=i.get(t);n.delete(e),i.set(t,n)},t.publishEvent=function(t,i){if(e){var s=e.window,r=e.link;s.postMessage({type:t,payload:i},r),n("publish",t,i)}},t.publishPendingEvent=function(e,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];return new Promise(function(s){t.publishEvent.apply(void 0,[e].concat(i)),t.listenEvent(n).then(s)}).catch(function(t){console.error(t)})}}(i||(i={}))},"./src/event-emitter/logger.ts":function(t,e,n){"use strict";var i,s;n.d(e,"a",function(){return s}),n.d(e,"b",function(){return r}),function(t){t[t.PARENT=0]="PARENT",t[t.CHILD=1]="CHILD"}(s||(s={}));(i={}).listen="#019c2b",i.publish="#0372c1";var r=function(t,e){return },"./src/io/api.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return M}),n.d(e,"b",function(){return x});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/date/date.ts"),r=n("./src/app/app.ts"),a=n("./src/util/util.ts"),o=n("./src/logger/logger.ts"),c=n("./src/data/message.ts"),u=n("./src/data/message-type.ts"),l=n("./src/data/availability-level.ts"),_=n("./src/data/member.ts"),d=n("./src/data/factory/factory.ts"),p=n("./src/data/page.ts"),f=n("./src/data/invite.ts"),g=n("./src/data/dialog.ts"),v=n("./modules/oldmodules.js"),h=(n.n(v),n("./src/io/livetex.ts")),E=n("./src/io/file-server.ts"),b=n("./src/io/notification.ts"),m=n("./src/io/response/types.ts"),S=n("./src/io/index.ts"),I=n("./src/io/services/widgets-api-app.ts"),y=n("./src/io/services/event-service.ts"),A=n("./src/io/services/widgets-api.ts"),T=n("./src/io/request/widgets-api/request.ts"),O=n("./src/io/request/livetex/types.ts"),L=n("./src/redux-store/index.ts"),w=n("./src/redux-store/actions/set-visitor-info.ts"),C=n("./src/redux-store/reducers/visitor/selectors.ts"),N=n("./src/redux-store/actions/set-availability.ts"),D=n("./src/util/file-broker.ts"),R=s.b.ONE_HOUR,M=function(){function t(){var t=this;this.__dataSite=null,this.__isGracefulDestroy=!1,this.__gracefulDestroyTimer=null,this.__listeners={},this.services={},this.initEventService=this.initWapiService=this.initWapiApiAppService=this.destroyApiServices=function(){return Object.keys(t.services).forEach(function(e){t.services[e]&&t.services[e].destroy&&t.services[e].destroy(),t.services[e]=null})},this.__handlerWapi=function(e,n){switch(e){case T.a.INVITE_TO_SITE_CHAT:case T.a.CREATE_SITE_CHAT:"string"==typeof n?t.__publishDialog(n):t.__handleMessage(new S.b.DialogUnavailable("Can't create dialog"));break;case T.a.GET_DIALOG_STATE:n.conversationId&&t.__publishDialog(n.conversationId);break;case T.a.MESSAGE_HISTORY:n instanceof S.b.MessageHistory&&t.__handleMessage(n);break;case T.a.GET_CHAT_AVAILABLE_GROUPS:n instanceof Array&&t.__handleMessage(new S.b.ChatAvailableGroups(n));break;case T.a.GET_EMPLOYEES:n instanceof Array&&t.__handleMessage(new S.b.MembersList(n));break;case T.a.IS_EMPLOYEES_AVAILABLE:n instanceof Object&&t.__handleMessage(new S.b.EmployeesAvailability(n));break;case T.a.GET_OFFLINE_AVAILABLE_GROUPS:n instanceof Array&&t.__handleMessage(new S.b.OfflineAvailableGroups(n));break;case T.a.SEND_TEXT_MESSAGE:case T.a.SEND_FILE_MESSAGE:n instanceof c.a&&n.getType()===u.a.FROM_VISITOR&&t.__handleMessage(new S.b.Message(n));break;case T.a.GET_CHAT_AVAILABILITY:break;case T.a.GET_INVITATION_EMPLOYEE:n instanceof _.a&&t.__handleMessage(new S.b.InvitationEmployee(n));break;case T.a.POPULATE_MEMBER:n instanceof _.a&&(t.__handleMessage(new S.b.Member(n)),t.__handleMessage(new S.b.PopulatedMember(n)));break;case T.a.SET_ATTRIBUTES:n instanceof S.b.SetAttributes&&t.__handleMessage(n)}},this.__handleLivetex=function(e,n,i){var s,r=null,o=a.a.decodeJsonData(e);if(o instanceof Object)switch(n){case O.a.AUTH:var c=v.sm.reconstructEntity(o);t.__dataSite=c,r=new S.b.Visitor(o),t.__handleMessage(r,o);break;case O.a.ADD_PAGE:(s=v.sm.reconstructEntity(o))instanceof p.a&&(r=new S.b.Page(s),t.__handleMessage(r));break;case O.a.DEFAULT:t.__handleLivetexNotification(o)}i&&i(r)}}return t.prototype.init=function(t,e,n,s){var o=this;this.visitorSettings=t,this.settings=e,this.servicesData=n;this.services.livetex=new h.a(t,e,this.__handleLivetex,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.__errorHandler.apply(o,t)},s||void 0),this.eventServiceData=this.servicesData.find(function(t){return t.ServiceName===e.eventService}),this.widgetsApiApiAppServiceData=this.servicesData.find(,this.services.eventService=this.initEventService(this.eventServiceData),this.services.widgetsApi=this.initWapiService(),this.services.widgetsApiApp=this.initWapiApiAppService(this.widgetsApiApiAppServiceData),this.services.vnds=this.__initVNDS(),this.__sendFileServer=new E.a(e.fileServer,{accountId:t.accountId,touchPointId:t.siteId,feedbackServiceAddress:this.widgetsApiApiAppServiceData&&this.widgetsApiApiAppServiceData.ServiceAddress}),Object(D.a)(this.__sendFileServer),this.__disconnectHandler=a.a.nop,this.__hasConnection=!0,this.__scheduleGracefulDestroy(),window.addEventListener("online",function(){o.__hasConnection&&null===o.services.notification&&o.reConnect(function(){return i.b(o,void 0,void 0,function(){var t,e;return i.d(this,function(n){switch(n.label){case 0:return(t=r.a.getDialog())&&this.send(new S.a.wapi.MessageHistory(t.getConversationId()),a.a.nop),[4,x.send(new S.a.wapi.GetChatAvailability).catch(function(t){return console.error(t)})];case 1:return e=n.sent(),L.a.dispatch(Object(N.b)(e)),[2]}})})},function(){})}),window.addEventListener("offline",},t.prototype.initServices=function(t,e){var n=this;this.visitorSettings=t||this.visitorSettings,Object.keys(this.services).forEach(function(t){n.services[t]&&n.services[t].init&&n.services[t].init(n.visitorSettings,e)})},t.prototype.setDisconnectHandler=function(t){this.__disconnectHandler=t},t.prototype.addListener=t.prototype.removeListener=function(t,e){var n=this.__listeners[t];void 0!==n&&-1!==n.indexOf(e)&&delete n[n.indexOf(e)]},t.prototype.eventLogPush=function(t){this.services.eventService&&t instanceof S.a.event.EventRequest&&this.services.eventService.pushLogData(t)},t.prototype.__initVNDS=function(){this.services.notification=new b.a(this.settings,this.__dataSite,this.__handleNotification.bind(this),this.__errorHandler.bind(this))},t.prototype.send=function(t,e,n){var i=this,s=e||a.a.nop,r=n||a.a.nop,o=if(this.__hasConnection)return new Promise(;var c=Object(C.b)(L.a.getState());this.reInit(c,o,r)},t.prototype.getName=function(){return"api"},t.prototype.auth=function(){var t=this;return this.services.livetex.auth(),new Promise(function(e){var n=function(i,s){t.removeListener(m.a.VISITOR,n),e([t.__dataSite,s])};t.addListener(m.a.VISITOR,n)})},t.prototype.reConnect=function(t,e){this.__destroy();var n=Object(C.b)(L.a.getState());this.reInit(n,t,e)},t.prototype.reInit=function(t,e,n){var i=this;this.__hasConnection?n():(this.services.livetex=new h.a(this.visitorSettings,this.settings,this.__handleLivetex,t,function(){i.__sendAddPage(),i.services.eventService=i.initEventService(i.eventServiceData),i.services.widgetsApi=i.initWapiService(),i.__initVNDS(),i.services.notification.init(i.visitorSettings),e()}),this.services.livetex.auth(),this.__hasConnection=!0,this.__isGracefulDestroy=!1,this.__scheduleGracefulDestroy())},t.prototype.reset=function(t,e){this.__sendLivetex(new S.a.livetex.Reject,function(){},e),this.__destroy(),this.__resetVisitor(),this.reInit(void 0,function(){t()},e)},t.prototype.serviceReInit=function(){var t=this,e=null===this.services.livetex.__connection&&null===this.services.notification;(!this.__isGracefulDestroy||!this.__hasConnection)&&e&&a.a.async(},t.prototype.__destroy=t.prototype.__resetVisitor=function(){},t.prototype.__gracefulDestroy=function(){this.__hasConnection=!1,this.__isGracefulDestroy=!0,this.services.livetex&&this.services.livetex.gracefulDestroy(),this.services.notification&&this.services.notification.destroy&&(this.services.notification.destroy(),this.services.notification=null)},t.prototype.__scheduleGracefulDestroy=function(){var t=this;null!==this.__gracefulDestroyTimer&&clearTimeout(this.__gracefulDestroyTimer),this.__gracefulDestroyTimer=setTimeout(R)},t.prototype.__send=function(t,e,n){if(t instanceof S.a.livetex.LivetexRequest)this.__sendLivetex(t,e,n);else{if(t instanceof S.a.wapi.WidgetsApiRequest)return this.__sendWidgetsService(t,e,n);t instanceof S.a.fileServer.FileServerRequest?this.__sendFile(t,e,n):t instanceof S.a.vnds.VndsRequest?this.__sendVNDS(t,e,n):this.__sendSystem(t)}},t.prototype.__sendLivetex=t.prototype.__sendWidgetsService=function(t,e,n){if(this.services.widgetsApi)return this.services.widgetsApi.send(t,e,n)},t.prototype.__sendVNDS=function(t,e,n){null!==this.services.notification?t instanceof S.a.vnds.WatchEmployee?this.services.notification.sendWatchEmployee(t,e,n):t instanceof S.a.vnds.WatchGroup&&(this.services.notification.sendWatchGroup(t,e,n),o.a.warn("Unknown request type "+t)):o.a.error("Can't send message to vnds, because it's not ready")},t.prototype.__sendFile=t.prototype.__sendSystem=function(t){t instanceof S.a.LocalPing&&this.__handleMessage(new S.b.LocalPing)},t.prototype.__errorHandler=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.a.error.apply(this,t),null!==this.__disconnectHandler&&this.__disconnectHandler(this.__isGracefulDestroy)},t.prototype.__readMessage=function(t){this.send(new S.a.wapi.ReadMessage(r.a.getDialog().getId(),t))},t.prototype.__handleNotification=function(t){switch(t.getName()){case S.a.NOTIFICATION_TYPES.TEXT_MESSAGE:var e=t.getValue()[0],n=d.a.createTextMessageFromNotification(e);this.__readMessage(e.message.eventId),this.__handleMessage(new S.b.Message(n));break;case S.a.NOTIFICATION_TYPES.CHAT_ROUTING:var i=t.getValue()[1];o.a.debug("routingDestination "+i,this),this.__handleMessage(new S.b.ChatRouting(i));break;case S.a.NOTIFICATION_TYPES.FILE_MESSAGE:var s=t.getValue()[0];if(this.__readMessage(s.message.eventId),s.comment){var c=a.a.decodeJsonData(JSON.stringify(s));c.text=s.comment;n=d.a.createTextMessageFromNotification(c);this.__handleMessage(new S.b.Message(n))}for(var u=0;u<s.fileInfoList.length;u++)this.__handleMessage(new S.b.IncomingFile(s.fileInfoList[u].name,s.fileInfoList[u].sizeInBytes,s.fileInfoList[u].url));break;case S.a.NOTIFICATION_TYPES.STICKER_MESSAGE:var p=t.getValue()[0],f=d.a.createStickerMessageFromNotification(p);this.__readMessage(p.message.eventId),this.__handleMessage(new S.b.Message(f));break;case S.a.NOTIFICATION_TYPES.HOLDING_MESSAGE:var g=t.getValue()[0],v=d.a.createHoldingMessageFromNotification(g);this.__readMessage(g.message.eventId),this.__handleMessage(new S.b.Message(v));break;case S.a.NOTIFICATION_TYPES.OFFER_CALLBACK:var h=t.getValue()[0],E=d.a.createOfferCallbackMessageFromNotification(h);this.__readMessage(h.message.eventId),this.__handleMessage(new S.b.Message(E));break;case S.a.NOTIFICATION_TYPES.CHAT_AVAILABILITY_CHANGE:var b=t.getValue()[0];o.a.debug("chatAvailabilityChange "+b,this),this.__handleMessage(new S.b.ChatAvailability(b),b);break;case S.a.NOTIFICATION_TYPES.EMPLOYEE_CHANGE:var m=(O=r.a.getDialog())?O.getConversationId():"",I=t.getValue()[0];if(m===(C=t.getValue()[1])){var y=new _.a(I),A=new S.b.MemberChanged(y,C);this.__handleMessage(A)}break;case S.a.NOTIFICATION_TYPES.EMPLOYEE_AVAILABILITY_CHANGE:I=t.getValue()[0],b=t.getValue()[1];(y=new _.a(I)).setStatus(b),this.__handleMessage(new S.b.MemberStatusChanged(y));break;case S.a.NOTIFICATION_TYPES.GROUP_AVAILABILITY_CHANGE:var T=t.getValue()[0];b=t.getValue()[1];this.__handleMessage(new S.b.GroupAvailabilityChange(T,new l.a(b)));break;case S.a.NOTIFICATION_TYPES.TYPING:this.__handleMessage(new S.b.TypingNotify);break;case S.a.NOTIFICATION_TYPES.RESET_STATE:this.__handleMessage(new S.b.ResetState);case S.a.NOTIFICATION_TYPES.CHAT_CLOSE:var O,C;(m=(O=r.a.getDialog())?O.getConversationId():"")===(C=t.getValue()[0])&&this.__handleMessage(new S.b.ChatClosed(C));break;case S.a.NOTIFICATION_TYPES.VISITOR_BANNED:L.a.dispatch(Object(w.b)({isBanned:!0})),this.__handleMessage(new S.b.VisitorBan(!0));default:o.a.error("Unrecognized notification message "+t.getName())}},t.prototype.__handleLivetexNotification=function(t){var e=t.payload,n=a.a.decodeJsonData(e);switch(t.notification){case m.a.CALL_ACCEPTED_BY_MEMBER:this.__handleMessage(new S.b.CallAcceptedByMember);break;case m.a.CALL_ACCEPTED_BY_VISITOR:this.__handleMessage(new S.b.CallAcceptedByVisitor);break;case m.a.STATE:if(n instanceof Object)for(var i in n){var s=v.sm.createEntityByName(i);null!==s&&this.__handleMessage(new S.b.State(s,n[i]))}break;case m.a.ECHO:"string"==typeof e&&this.__handleMessage(new S.b.Echo(e));break;case m.a.SEND_INVITE:if(n instanceof Object){var r=v.sm.reconstructEntity(n);r instanceof f.a&&this.__handleMessage(new S.b.Invite(r))}}},t.prototype.__handleMessage=function(t,e){var n=t.getType();if(o.a.debug("receiving a message type="+n,this),void 0!==this.__listeners[n])for(var i=0,s=this.__listeners[n].length;i<s;i+=1)void 0!==this.__listeners[n][i]&&this.__listeners[n][i](t,e)},t.prototype.__publishDialog=function(t){var e=this.__dataSite;if(null!==e){var n=new g.a(t,e);r.a.setDialog(n),this.__handleMessage(new S.b.Dialog(n))}},t.prototype.__sendAddPage=function(){var t=r.a.getSite()?r.a.getSite():null,e=this.visitorSettings,n=e.siteId,i=e.accountId;t?this.send(new S.a.livetex.AddPage(t.getPage(),"account:"+i+":site:"+n),a.a.nop,o.a.error):o.a.error("Unable to add page")},t}(),x=new M},"./src/io/file-server.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./src/io/request/file-server/request.ts"),s=n("./src/util/util.ts"),r=n("./src/redux-store/reducers/visitor/selectors.ts"),a=n("./src/redux-store/index.ts"),o=function(){function t(t,e){this.serviceAddress=t,this.feedbackServiceAddress=e.feedbackServiceAddress,this.accountId=e.accountId,this.touchPointId=e.touchPointId}return t.prototype.getName=function(){return"file-server-api"},t.prototype.getBaseURL=function(){return this.serviceAddress},t.prototype.__sendFile=function(t,e,n){var i=this,s=t.getData(),o=t.getErrorCallback(),c=Object(r.b)(a.a.getState()),u=this.serviceAddress+"/upload?visitorId="+c+"&accountId="+this.accountId+"&touchPointId="+this.touchPointId;if(null!==s){var l=new XMLHttpRequest;l.onload=function(e){200!==l.status?(o&&o(e),i.sendLog({data:s,statusCode:l.status,statusText:l.statusText})):t.getCallback()(e)},l.onerror=function(t){o&&o(t),i.sendLog({data:s,response:t,statusCode:l.status,statusText:l.statusText})},l.open("POST",u,!0),l.send(s)}else n("Bad file!")},t.prototype.__getFileSize=function(t,e,n){var i=t.getUrl(),s=new XMLHttpRequest;s.open("HEAD",i,!0),s.onload=function(){return t.getCallback()(+s.getResponseHeader("Content-Length"))},s.onerror=function(t){return n(t)},s.send()},t.prototype.sendLog=function(t){if(void 0!==this.feedbackServiceAddress)return fetch("https://"+this.feedbackServiceAddress+"/store",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({data:t,correlationId:""})})},t.prototype.send=function(t,e,n){var r=e||s.a.nop,a=n||s.a.nop;switch(t.getType()){case i.a.SEND_FILE:this.__sendFile(t,r,a);break;case i.a.GET_FILE_SIZE:this.__getFileSize(t,r,a)}},t}()},"./src/io/index.ts":function(t,e,n){"use strict";var i=n("./src/io/response/index.ts"),s=n("./src/io/request/index.ts");n.d(e,"a",function(){return s}),n.d(e,"b",function(){return i})},"./src/io/livetex.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n("./src/util/util.ts"),s=n("./modules/oldmodules.js"),r=(n.n(s),n("./src/logger/logger.ts")),a=n("./src/io/request/livetex/types.ts"),o=n("./src/io/index.ts"),c=function(){function t(t,e,n,i,s,a){this.__onAuth=function(){},this.settings=e,this.visitorSettings=t,this.__connectionFactory=null,this.__requestFactory=null,this.__connection=null,this.__destroyHandler=i,this.__dataHandler=n,this.__host="",this.__authRequest=new o.a.livetex.Auth(s),this.__onAuth=a||function(){},r.a.debug("creating a connection to livetex-server",this)}return t.prototype.auth=t.prototype.getName=function(){return"livetex-api"},t.prototype.destroy=function(){this.__destroyHandler=i.a.nop,this.__dataHandler=i.a.nop,this.__destroy()},t.prototype.gracefulDestroy=function(){this.__destroy(),this.__destroyHandler=i.a.nop,this.__dataHandler=i.a.nop},t.prototype.send=function(t,e){var n=e||i.a.nop;this.__host.trim()&&(r.a.debug("sending a request to livetex-server, type="+t.getType(),this),this.__send(t.getType(),n,t.serialize()))},t.prototype.__destroy=t.prototype.__connect=function(t,e){var n=this;this.__requestBalancer(function(){n.__auth(t,e)},e)},t.prototype.__headers=function(){return{"lt-origin":"account:"+this.visitorSettings.accountId+":site:"+this.visitorSettings.siteId}},t.prototype.__getConnectionFactory=function(t){var e=i.a.isSecure(),n=e?443:80;return null===this.__connectionFactory&&(this.__connectionFactory=new s.io.PollingConnectionFactory(t,e,n),this.__connectionFactory.setHeaders(this.__headers())),this.__connectionFactory},t.prototype.__getRequestFactory=function(t,e){var n=e||s.net.RequestMethod.POST;return null===this.__requestFactory&&(this.__requestFactory=new s.net.factory.RequestFactory(t,i.a.isSecure(),i.a.isSecure()?443:80),this.__requestFactory.setMethod(n),this.__requestFactory.setHeaders(this.__headers())),this.__requestFactory},t.prototype.__requestBalancer=function(t,e){var n=this;i.a.retry(3,3,1e3,t,e)},t.prototype.__send=function(t,e,n){var r=this,a=this.__getRequestFactory(this.__host).createRequest(),o=n||"{}",c=e||i.a.nop;a.addEventListener(s.net.RequestEvent.COMPLETE,function(e){if(a.removeAllEventListeners(),e instanceof s.net.RequestEvent&&!e.isRequestFailed()){var n=e.getResponseData();r.__dataHandler(n,t,c)}}),a.send(o,t)},t.prototype.__requestBalancerStep=function(t,e){var n=this;var r=new s.net.factory.RequestFactory(this.settings.balancer+"/get-server/?site_id="+this.visitorSettings.siteId,i.a.isSecure(),80);r.setMethod(s.net.RequestMethod.GET),r.setHeaders(this.__headers());var a=r.createRequest(!0);a.addEventListener(s.net.RequestEvent.COMPLETE,function i(r){if(a.removeEventListener(s.net.RequestEvent.COMPLETE,i),r instanceof s.net.RequestEvent&&!r.isRequestFailed()){var o=r.getResponseData();"string"==typeof o?(n.__host=o,t()):e("Incorrect data from balancer: "+o)}else e("Can't get a config from balancer: "+r.getResponseStatus())}),a.send("","")},t.prototype.__auth=function(t,e){var n=this;this.send(this.__authRequest,function(e){n.__initPolling(),n.__dataHandler(e,n.__authRequest.getType()),t()})},t.prototype.__initPolling=function(){var t=this;this.__connection=this.__getConnectionFactory(this.__host).createConnection(s.io.HOLD_TIMEOUT,s.io.POLL_TIMEOUT),this.__connection.addEventListener("close",,this.__connection.addEventListener("data",function(e,n){var i=n;"string"==typeof i&&t.__dataHandler(i,a.a.DEFAULT)})},t}()},"./src/io/notification.ts":function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return u});var i=n("./src/app/app.ts"),s=n("./node_modules/@livetex/visitor-notification-delivery-service-client/bin/index.js"),r=(n.n(s),n("./node_modules/@livetex/visitor-notification-receiver-service-client/bin/index.js")),a=(n.n(r),n("./node_modules/@livetex/node-thrift/bin/index.js")),o=(n.n(a),n("./src/logger/logger.ts")),c=n("./node_modules/@livetex/browser-service-discovery/bin/index.js"),u=(n.n(c),function(){function e(t,e,n,i){this.__pollTimer=null,this.__connectTimer=null,this.settings=t,this.__holdTimeout=15,this.__disconnectTimeout=15,this.__uiDisconectTimeout=1e3*(this.__holdTimeout+this.__disconnectTimeout),this.__uiReconnectTimeout=5e3,this.__dataHandler=n}return e.prototype.init=function(t,e){this.visitorSettings=t;var n=t.allIds,i=t.accountId,r=t.siteId;this.__destroyed=!1,this.__connectionId=null,this.__connectionDoneListeners=[],this.__visitor=new s.model.VisitorId(n,i,r),this.__discovery=this.getBalancer();var a=this.__discovery;s.client.init(a,!0),this.__runPolling(e)},e.prototype.getName=function(){return"notification-api"},e.prototype.getBalancer=function(){return new c.BalancerDiscovery(this.settings.balancer,this.visitorSettings.accountId,"widget","24.5.3015-496641c")},e.prototype.__runPolling=function(t){var e=this,n=function(){return e.__reConnect(s)},i=s=this.__connect(n)},e.prototype.__reConnect=function(t){var e=this;clearTimeout(this.__connectTimer),o.a.warn("connect cancel handler"),this.__connectTimer=setTimeout(function(){o.a.warn("Try reconnect to vnds..."),e.__connectionId=null,e.__connect(t,function(){return e.__reConnect(t)})},this.__uiReconnectTimeout)},e.prototype.__connect=function(t,e){var n=this;this.__connectionId?t({}):(s.client.init(this.__discovery,!0),s.client.connect(function(e){i.a.setServerTime(e.currentDatetime),n.__connectionId=e.connectionId;var s=n.__connectionId;null!=s&&n.__connectionDoneListeners.forEach(function(t){return t(s)}),n.__connectionDoneListeners=[],t({})},this.__visitor,this.__holdTimeout,this.__disconnectTimeout))},e.prototype.__poll=function(t,e){var n=this;clearTimeout(this.__pollTimer),this.__pollTimer=setTimeout(function(){o.a.warn('Dont\'t "receive" pong from vnds, conectionId: '+n.__connectionId),n.__connectionId=null,n.__runPolling()},this.__uiDisconectTimeout);this.__connectionId?s.client.poll(function(e){t(),e.forEach(},e,this.__visitor,this.__connectionId):e("Can't poll without connection")},e.prototype.__thriftDecoder=function(e,n){var i=new a.protocol.Json(new r.Schema);new a.Parser(i).process(new t(e),function(t){if(t instanceof a.Message){var e=t.getException();null!==e?o.a.error("Thrift Error: "+e.getMessage()):n(t)}else o.a.error("Thrift message decode Error: "+t)})},e.prototype.sendWatchEmployee=function(t,e,n){var i=this;this.__waitConnection(function(r){s.client.watchEmployee(e,n,i.__visitor,r,t.getEmployeeId())})},e.prototype.sendWatchGroup=function(t,e,n){var i=this;this.__waitConnection(function(r){s.client.watchGroup(e,n,i.__visitor,r,t.getGroupId())})},e.prototype.destroy=function(){clearTimeout(this.__pollTimer),clearTimeout(this.__connectTimer),clearTimeout(this.__uiReconnectTimeout),clearTimeout(this.__uiDisconectTimeout),this.__destroyed=!0},e.prototype.__waitConnection=function(t){var e=this.__connectionId;null!=e?t(e):this.__connectionDoneListeners.push(t)},e}())}).call(e,n("./node_modules/buffer/index.js").Buffer)},"./src/io/request/event/click-call-request-close.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickCallRequestClose=new r.interaction.types.CallRequestCloseClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickCallRequestClose},e.prototype.getRequest=function(t){var e=this;return function(){t.clickCallRequestClose(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-call-to-button.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickCallTo=new r.interaction.types.CallToClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickCallTo},e.prototype.getRequest=function(t){var e=this;return function(){t.clickCallTo(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-chat-button.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickChatButton=new r.interaction.types.ChatButtonClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickChatButton},e.prototype.getRequest=function(t){var e=this;return function(){t.clickChatButton(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-chat-call-request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickChatCallRequest=new r.interaction.types.ChatCallRequestClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickChatCallRequest},e.prototype.getRequest=function(t){var e=this;return function(){t.clickChatCallRequestClick(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-chat-close.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickChatClose=new r.interaction.types.ChatCloseClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickChatClose},e.prototype.getRequest=function(t){var e=this;return function(){t.clickChatClose(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-complaint-back.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickComplaintBack=new r.interaction.types.ComplaintBackClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickComplaintBack},e.prototype.getRequest=function(t){var e=this;return function(){t.clickComplaintBack(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-complaint.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickComplaint=new r.interaction.types.ComplaintClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickComplaint},e.prototype.getRequest=function(t){var e=this;return function(){t.clickComplaint(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-email-send-back.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickEmailSendBack=new r.interaction.types.EmailSendBackClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickEmailSendBack},e.prototype.getRequest=function(t){var e=this;return function(){t.clickEmailSendBack(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-invitation-call-request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickInvitationCallRequest=new r.interaction.types.InvitationCallRequestClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickInvitationCallRequest},e.prototype.getRequest=function(t){var e=this;return function(){t.clickInvitationCallRequest(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-invitation-close.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickInvitationClose=new r.interaction.types.InvitationCloseClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickInvitationClose},e.prototype.getRequest=function(t){var e=this;return function(){t.clickInvitationClose(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-invitation-send.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e,n){var i=t.call(this,n)||this,s={baseEvent:i.getBaseEvent(),invitationId:e};return i.__clickInvitationSend=new r.interaction.types.InvitationSendClickEvent(s),i}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickInvitationSend},e.prototype.getRequest=function(t){var e=this;return function(){t.clickInvitationSend(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-label.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickLabel=new r.interaction.types.LabelClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickLabel},e.prototype.getRequest=function(t){var e=this;return function(){t.clickLabel(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-offline-close.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickOfflineClose=new r.interaction.types.OfflineCloseClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickOfflineClose},e.prototype.getRequest=function(t){var e=this;return function(){t.clickOfflineClose(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-offline-send.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickOfflineSend=new r.interaction.types.OfflineSendClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickOfflineSend},e.prototype.getRequest=function(t){var e=this;return function(){t.clickOfflineSend(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-welcome-close.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickWelcomeClose=new r.interaction.types.WelcomeCloseClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickWelcomeClose},e.prototype.getRequest=function(t){var e=this;return function(){t.clickWelcomeClose(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-welcome-send.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickWelcomeSend=new r.interaction.types.WelcomeSendClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickWelcomeSend},e.prototype.getRequest=function(t){var e=this;return function(){t.clickWelcomeSend(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-xwidget-button-close.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickXWidgetButtonClose=new r.interaction.types.XWidgetButtonCloseClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickXWidgetButtonClose},e.prototype.getRequest=function(t){var e=this;return function(){t.clickXWidgetButtonClose(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-xwidget-button-send.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e,n){var i=t.call(this,n)||this,s={baseEvent:i.getBaseEvent(),invitationId:e};return i.__clickXWidgetButtonSend=new r.interaction.types.XWidgetButtonSendClickEvent(s),i}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickXWidgetButtonSend},e.prototype.getRequest=function(t){var e=this;return function(){t.clickXWidgetButtonSend(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-xwidget-button.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickXWidgetButton=new r.interaction.types.XWidgetButtonClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickXWidgetButton},e.prototype.getRequest=function(t){var e=this;return function(){t.clickXWidgetButton(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-xwidget-window-close.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__clickXWidgetWindowClose=new r.interaction.types.XWidgetWindowCloseClickEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickXWidgetWindowClose},e.prototype.getRequest=function(t){var e=this;return function(){t.clickXWidgetWindowClose(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/click-xwidget-window-send.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e,n){var i=t.call(this,n)||this,s={baseEvent:i.getBaseEvent(),invitationId:e};return i.__clickXWidgetWindowSend=new r.interaction.types.XWidgetWindowSendClickEvent(s),i}return i.c(e,t),e.prototype.getStructure=function(){return this.__clickXWidgetWindowSend},e.prototype.getRequest=function(t){var e=this;return function(){t.clickXWidgetWindowSend(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/index.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("./src/io/request/event/request.ts");n.d(e,"EventRequest",function(){return i.a});var s=n("./src/io/request/event/click-call-request-close.ts");n.d(e,"ClickCallRequestClose",function(){return s.a});var r=n("./src/io/request/event/click-call-to-button.ts");n.d(e,"ClickCallTo",function(){return r.a});var a=n("./src/io/request/event/click-chat-button.ts");n.d(e,"ClickChatButton",function(){return a.a});var o=n("./src/io/request/event/click-chat-call-request.ts");n.d(e,"ClickChatCallRequest",function(){return o.a});var c=n("./src/io/request/event/click-chat-close.ts");n.d(e,"ClickChatClose",function(){return c.a});var u=n("./src/io/request/event/click-complaint-back.ts");n.d(e,"ClickComplaintBack",function(){return u.a});var l=n("./src/io/request/event/click-complaint.ts");n.d(e,"ClickComplaint",function(){return l.a});var _=n("./src/io/request/event/click-email-send-back.ts");n.d(e,"ClickEmailSendBack",function(){return _.a});var d=n("./src/io/request/event/click-invitation-call-request.ts");n.d(e,"ClickInvitationCallRequest",function(){return d.a});var p=n("./src/io/request/event/click-invitation-close.ts");n.d(e,"ClickInvitationClose",function(){return p.a});var f=n("./src/io/request/event/click-invitation-send.ts");n.d(e,"ClickInvitationSend",function(){return f.a});var g=n("./src/io/request/event/click-label.ts");n.d(e,"ClickLabel",function(){return g.a});var v=n("./src/io/request/event/click-offline-close.ts");n.d(e,"ClickOfflineClose",function(){return v.a});var h=n("./src/io/request/event/click-offline-send.ts");n.d(e,"ClickOfflineSend",function(){return h.a});var E=n("./src/io/request/event/click-welcome-close.ts");n.d(e,"ClickWelcomeClose",function(){return E.a});var b=n("./src/io/request/event/click-welcome-send.ts");n.d(e,"ClickWelcomeSend",function(){return b.a});var m=n("./src/io/request/event/click-xwidget-button-close.ts");n.d(e,"ClickXWidgetButtonClose",function(){return m.a});var S=n("./src/io/request/event/click-xwidget-button-send.ts");n.d(e,"ClickXWidgetButtonSend",function(){return S.a});var I=n("./src/io/request/event/click-xwidget-button.ts");n.d(e,"ClickXWidgetButton",function(){return I.a});var y=n("./src/io/request/event/click-xwidget-window-close.ts");n.d(e,"ClickXWidgetWindowClose",function(){return y.a});var A=n("./src/io/request/event/click-xwidget-window-send.ts");n.d(e,"ClickXWidgetWindowSend",function(){return A.a});var T=n("./src/io/request/event/show-call-request.ts");n.d(e,"ShowCallRequest",function(){return T.a});var O=n("./src/io/request/event/show-call-to.ts");n.d(e,"ShowCallTo",function(){return O.a});var L=n("./src/io/request/event/show-chat-button.ts");n.d(e,"ShowChatButton",function(){return L.a});var w=n("./src/io/request/event/show-chat.ts");n.d(e,"ShowChat",function(){return w.a});var C=n("./src/io/request/event/show-complaint.ts");n.d(e,"ShowComplaint",function(){return C.a});var N=n("./src/io/request/event/show-email-send.ts");n.d(e,"ShowEmailSend",function(){return N.a});var D=n("./src/io/request/event/show-invitation.ts");n.d(e,"ShowInvitation",function(){return D.a});var R=n("./src/io/request/event/show-label.ts");n.d(e,"ShowLabel",function(){return R.a});var M=n("./src/io/request/event/show-offline.ts");n.d(e,"ShowOffline",function(){return M.a});var x=n("./src/io/request/event/show-welcome.ts");n.d(e,"ShowWelcome",function(){return x.a});var B=n("./src/io/request/event/show-xwidget-button.ts");n.d(e,"ShowXWidgetButton",function(){return B.a});var j=n("./src/io/request/event/show-xwidget-window.ts");n.d(e,"ShowXWidgetWindow",function(){return j.a})},"./src/io/request/event/request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i=n("./src/util/util.ts"),s=n("./src/app/app.ts"),r=n("./src/app/page/page.ts"),a=n("./src/util/date/date.ts"),o=n("./src/util/browser/browser.ts"),c=n("./modules/external_libs.js"),u=(n.n(c),n("./src/redux-store/index.ts")),l=n("./src/redux-store/reducers/availability/selectors.ts"),_=n("./src/redux-store/reducers/visitor/selectors.ts"),d=function(){function t(t){var e=t||Object(l.b)(u.a.getState()),n={pageId:s.a.getSite().getPage().getFullName(),sequenceCounter:r.a.getCounter()},i={timestamp:String((new a.a).current()),siteId:s.a.getSite().getFullName(),visitorId:Object(_.b)(u.a.getState()),appType:o.a.isMobile()?c.interaction.types.AppType.MOBILE:c.interaction.types.AppType.DESKTOP,sequence:new c.interaction.types.Sequence(n),status:e?0:1};this.__baseEvent=new c.interaction.types.SimpleEvent(i)}return t.prototype.getBaseEvent=function(){return this.__baseEvent},t.prototype.getRequest=function(t){return i.a.nop},t}()},"./src/io/request/event/show-call-request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showCallRequest=new r.interaction.types.CallRequestViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showCallRequest},e.prototype.getRequest=function(t){var e=this;return function(){t.showCallRequest(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-call-to.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showCallTo=new r.interaction.types.CallToViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showCallTo},e.prototype.getRequest=function(t){var e=this;return function(){t.showCallTo(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-chat-button.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showChatButton=new r.interaction.types.ChatButtonViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showChatButton},e.prototype.getRequest=function(t){var e=this;return function(){t.showChatButton(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-chat.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showChat=new r.interaction.types.ChatViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showChat},e.prototype.getRequest=function(t){var e=this;return function(){t.showChat(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-complaint.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showComplaint=new r.interaction.types.ComplaintViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showComplaint},e.prototype.getRequest=function(t){var e=this;return function(){t.showComplaint(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-email-send.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showEmailSend=new r.interaction.types.EmailToChatViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showEmailSend},e.prototype.getRequest=function(t){var e=this;return function(){t.showChatToEmail(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-invitation.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e,n){var i=t.call(this,n)||this,s={baseEvent:i.getBaseEvent(),invitationId:e};return i.__showInvitation=new r.interaction.types.InvitationEvent(s),i}return i.c(e,t),e.prototype.getStructure=function(){return this.__showInvitation},e.prototype.getRequest=function(t){var e=this;return function(){t.showInvitation(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-label.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showLabel=new r.interaction.types.LabelViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showLabel},e.prototype.getRequest=function(t){var e=this;return function(){t.showLabel(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-offline.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showOffline=new r.interaction.types.OfflineViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showOffline},e.prototype.getRequest=function(t){var e=this;return function(){t.showOffline(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-welcome.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e){var n=t.call(this,e)||this,i={baseEvent:n.getBaseEvent()};return n.__showWelcome=new r.interaction.types.WelcomeViewEvent(i),n}return i.c(e,t),e.prototype.getStructure=function(){return this.__showWelcome},e.prototype.getRequest=function(t){var e=this;return function(){t.showWelcome(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-xwidget-button.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e,n){var i=t.call(this,n)||this,s={baseEvent:i.getBaseEvent(),invitationId:e};return i.__showXWidgetButton=new r.interaction.types.XWidgetButtonViewEvent(s),i}return i.c(e,t),e.prototype.getStructure=function(){return this.__showXWidgetButton},e.prototype.getRequest=function(t){var e=this;return function(){t.showXWidgetButton(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/event/show-xwidget-window.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./modules/external_libs.js"),a=(n.n(r),function(t){function e(e,n){var i=t.call(this,n)||this,s={baseEvent:i.getBaseEvent(),invitationId:e};return i.__showXWidgetWindow=new r.interaction.types.XWidgetWindowViewEvent(s),i}return i.c(e,t),e.prototype.getStructure=function(){return this.__showXWidgetWindow},e.prototype.getRequest=function(t){var e=this;return function(){t.showXWidgetWindow(e.getStructure(),s.a.nop)}},e}(n("./src/io/request/event/request.ts").a))},"./src/io/request/file-server/get-file-size.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./src/io/request/file-server/request.ts"),a=function(t){function e(e,n,i){return t.call(this,r.a.GET_FILE_SIZE,e,n||s.a.nop,i||s.a.nop)||this}return i.c(e,t),e}(r.b)},"./src/io/request/file-server/index.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("./src/io/request/file-server/request.ts");n.d(e,"FILE_SERVER_TYPES",function(){return i.a}),n.d(e,"FileServerRequest",function(){return i.b});var s=n("./src/io/request/file-server/get-file-size.ts");n.d(e,"GetFileSize",function(){return s.a});var r=n("./src/io/request/file-server/send-file.ts");n.d(e,"SendFile",function(){return r.a})},"./src/io/request/file-server/request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s={SEND_FILE:"send-file",GET_FILE_SIZE:"get-file-size"},r=function(t){eturn i.c(e,t),e.prototype.getType=function(){return this.__type},e.prototype.getData=function(){if(this.__data instanceof File){var t=new FormData;return t.append("fileUpload",this.__data,encodeURIComponent(this.__data.name)),t}return null},e.prototype.getUrl=e.prototype.getCallback=function(){return this.__callback},e.prototype.getErrorCallback=function(){return this.__errorCallback},e}(n("./src/io/request/request.ts").a)},"./src/io/request/file-server/send-file.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./src/io/request/file-server/request.ts"),a=function(t){function e(e,n,i){return t.call(this,r.a.SEND_FILE,e,n||s.a.nop,i||s.a.nop)||this}return i.c(e,t),e}(r.b)},"./src/io/request/index.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("./src/io/request/request.ts");n.d(e,"Request",function(){return i.a});var s=n("./src/io/request/local-ping.ts");n.d(e,"LocalPing",function(){return s.a});var r=n("./src/io/request/notification-type.ts");n.d(e,"NOTIFICATION_TYPES",function(){return r.a});var a=n("./src/io/request/types.ts");n.d(e,"REQUEST_TYPES",function(){return a.b});var o=n("./src/io/request/livetex/index.ts"),c=n("./src/io/request/widgets-api/index.ts"),u=n("./src/io/request/vnds/index.ts"),l=n("./src/io/request/event/index.ts"),_=n("./src/io/request/file-server/index.ts");n.d(e,"livetex",function(){return o}),n.d(e,"wapi",function(){return c}),n.d(e,"vnds",function(){return u}),n.d(e,"event",function(){return l}),n.d(e,"fileServer",function(){return _})},"./src/io/request/livetex/add-page.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/request/livetex/request.ts"),r=n("./src/io/request/livetex/types.ts"),a=n("./src/data/data.ts");ar c=function(t){function e(e,n){var i,s=Object(a.l)(e),c=n+":page:"+e.getId(),u=o(window.parentReferrer),l={page:((i={})[c]=Object.assign({},Object.values(s)[0],{page_title:o(window.parentTitle),page_url:o(window.parentHref),referrer:u,seo_referrer:u}),i)};return t.call(this,r.a.ADD_PAGE,l)||this}return i.c(e,t),e}(s.a)},"./src/io/request/livetex/auth.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/util.ts"),r=n("./src/io/request/livetex/request.ts"),a=n("./src/io/request/livetex/types.ts"),o=function(t){function e(e){var n;return t.call(this,a.a.AUTH,{is_mobile:s.a.IS_MOBILE_CLIENT,visitor:e?(n={},n[e]={},n):void 0})||this}return i.c(e,t),e}(r.a)},"./src/io/request/livetex/index.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("./src/io/request/livetex/request.ts");n.d(e,"LivetexRequest",function(){return i.a});var s=n("./src/io/request/livetex/add-page.ts");n.d(e,"AddPage",function(){return s.a});var r=n("./src/io/request/livetex/auth.ts");n.d(e,"Auth",function(){return r.a});var a=n("./src/io/request/livetex/initiate-call.ts");n.d(e,"InitiateCall",function(){return a.a});var o=n("./src/io/request/livetex/reject.ts");n.d(e,"Reject",function(){return o.a});var c=n("./src/io/request/livetex/set-invite.ts");n.d(e,"SetInvite",function(){return c.a});var u=n("./src/io/request/livetex/set-name.ts");n.d(e,"SetName",function(){return u.a})},"./src/io/request/livetex/initiate-call.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/request/livetex/request.ts"),r=n("./src/io/request/livetex/types.ts"),a=function(t){function e(e,n){var i=n||{};return t.call(this,r.a.INITIATE_CALL,{phone_number:e,log_sign:i})||this}return i.c(e,t),e}(s.a)},"./src/io/request/livetex/reject.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/request/livetex/types.ts"),r=function(t){function e(){return t.call(this,s.a.REJECT)||this}return i.c(e,t),e}(n("./src/io/request/livetex/request.ts").a)},"./src/io/request/livetex/request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./node_modules/tslib/tslib.es6.js"),s=function(t){function e(e,n){return t.call(this,e,n||{})||this}return i.c(e,t),e.prototype.serialize=e.prototype.getType=function(){return this.__name},e}(n("./src/io/request/request.ts").a)},"./src/io/request/livetex/set-invite.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/data/data.ts"),r=n("./src/io/request/livetex/types.ts"),a=function(t){function e(e){var n={};return n.invite=Object(s.l)(e),t.call(this,r.a.SET_INVITE,n)||this}return i.c(e,t),e}(n("./src/io/request/livetex/request.ts").a)},"./src/io/request/livetex/set-name.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/request/livetex/types.ts"),r=function(t){function e(e){return t.call(this,s.a.SET_NAME,{name:e})||this}return i.c(e,t),e}(n("./src/io/request/livetex/request.ts").a)},"./src/io/request/livetex/types.ts":"./src/io/request/local-ping.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=)},"./src/io/request/notification-type.ts":"./src/io/request/request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=)},"./src/io/request/types.ts":"./src/io/request/vnds/index.ts":"./src/io/request/vnds/request.ts":function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"b",function(){return i}),n.d(e,"a",function(){return s}),n.d(e,"d",function(){return c});var i,s,r=n("./node_modules/tslib/tslib.es6.js"),a=n("./src/io/request/request.ts"),o={WATCH_EMPLOYEE:"WATCH_EMPLOYEE",WATCH_GROUP:"WATCH_GROUP"};!i||(i={})),s||(s={}));var c=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.__type=e,i}return r.c(e,t),e.prototype.getType=function(){return this.__type},e.prototype.doRequest=function(){},e}(a.a)},"./src/io/request/vnds/watch-employee.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/request/vnds/request.ts"),r=function(t){function e(e){var n=t.call(this,s.c.WATCH_EMPLOYEE,{})||this;return n.__employeeId=e.getId(),n}return i.c(e,t),e.prototype.getEmployeeId=function(){return this.__employeeId},e}(s.d)},"./src/io/request/vnds/watch-group.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/request/vnds/request.ts"),r=function(t){function e(e){var n=t.call(this,s.c.WATCH_GROUP,{})||this;return n.__groupId=e,n}return i.c(e,t),e.prototype.getGroupId=function(){return this.__groupId},e}(s.d)},"./src/io/request/widgets-api/create-callback-request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e,n,i){var s=t.call(this,r.a.CREATE_CALLBACK_REQUEST,{})||this;return s.__communicationAttrs=e,s.__callbackRequest=n,s.__siteChatRequest=i,s}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.createCallbackRequest(t,e,this.createVisitor(),this.__communicationAttrs,this.__callbackRequest,this.__siteChatRequest)},e}(r.b)},"./src/io/request/widgets-api/create-feedback-form.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e,n,i){var s=t.call(this,r.a.CREATE_FEEDBACK_FORM,{})||this;return s.__communicationAttrs=e,s.__feedbackForm=n,s.__siteChatRequest=i,s}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.createFeedbackForm(t,e,this.createVisitor(),this.__communicationAttrs,this.__feedbackForm,this.__siteChatRequest)},e}(r.b)},"./src/io/request/widgets-api/create-site-chat.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e,n){var i=t.call(this,r.a.CREATE_SITE_CHAT,{})||this;return i.__communicationAttrs=e,i.__siteChatRequest=n,i}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.createSiteChat(t,e,this.createVisitor(),this.__communicationAttrs,this.__siteChatRequest)},e}(r.b)},"./src/io/request/widgets-api/file-message.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=n("./src/util/util.ts"),o=n("./src/util/location/location.ts"),c=function(t){function e(e,n){var i=t.call(this,r.a.SEND_FILE_MESSAGE,{})||this;return i.__message=e,i.__fileSize=n,i.__currentUrl=o.a.getLocation(),i}return i.c(e,t),e.prototype.doRequest=function(t,e){var n=this;var i=this.__message.getText(),r=i.split("/").pop();s.client.sendFileMessage(function(){t(n.__message)},e,this.createVisitor(),this.createConversationEventAttrs(this.__message.getConversationId()),this.__currentUrl,[new s.model.FileChatMessage(a.a.generateGuid(),[new s.model.FileInfo(decodeURIComponent(r),i,this.__fileSize)])])},e}(r.b)},"./src/io/request/widgets-api/get-chat-availability.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=n("./src/io/response/index.ts"),o=function(t){function e(){return t.call(this,r.a.GET_CHAT_AVAILABILITY,{})||this}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.getChatAvailability(function(e){t(new a.ChatAvailability(e),e)},e,this.createVisitor())},e}(r.b)},"./src/io/request/widgets-api/get-chat-available-groups.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/settings/props.ts"),r=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),a=(n.n(r),n("./src/io/request/widgets-api/request.ts")),o=n("./src/io/request/widgets-api/util.ts"),c=function(t){function e(e){var n=t.call(this,a.a.GET_CHAT_AVAILABLE_GROUPS,{})||this;return n.availabilityLevel=e||s.a.getMinAvailabilityLevel(),n}return i.c(e,t),e.prototype.doRequest=function(t,e){r.client.getChatAvailableGroups(function(e){t(e.map(o.a.convertGroup))},e,this.createVisitor(),this.availabilityLevel)},e}(a.b)},"./src/io/request/widgets-api/get-dialog-state.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=n("./src/io/response/index.ts"),o=function(t){function e(){return t.call(this,r.a.GET_DIALOG_STATE,{})||this}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.getDialogState(function(e){t(new a.DialogState(e),e)},e,this.createVisitor())},e}(r.b)},"./src/io/request/widgets-api/get-employees.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=n("./src/io/request/widgets-api/util.ts"),o=function(t){function e(e){var n=t.call(this,r.a.GET_EMPLOYEES,{})||this;return n.__groupId=e||null,n}return i.c(e,t),e.prototype.doRequest=function(t,e){var n=this,i=[];function r(e){t(i.map(function(t){return t.setStatus(e[t.getId()]),t}))}s.client.getEmployees(function(t){i=t.map(a.a.convertEmployee),s.client.getEmployeesAvailability(r,e,n.createVisitor(),i.map(function(t){return t.getId()}))},e,this.createVisitor(),this.__groupId)},e}(r.b)},"./src/io/request/widgets-api/get-invitation-employee.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/settings/props.ts")),a=n("./src/io/request/widgets-api/request.ts"),o=n("./src/io/request/widgets-api/util.ts"),c=function(t){function e(e){var n=t.call(this,a.a.GET_INVITATION_EMPLOYEE,{})||this;return n.__groupId=e,n}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.getInvitationEmployee(function(e){if(e instanceof s.model.InvitationEmployee){var n=e.employee;null!=n&&n instanceof s.model.Employee?t(o.a.convertEmployee(n)):t(null)}},e,this.createVisitor(),this.__groupId,r.a.getMinAvailabilityLevel())},e}(a.b)},"./src/io/request/widgets-api/get-offline-available-groups.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=n("./src/io/request/widgets-api/util.ts"),o=function(t){function e(){return t.call(this,r.a.GET_OFFLINE_AVAILABLE_GROUPS,{})||this}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.getOfflineAvailableGroups(e,this.createVisitor())},e}(r.b)},"./src/io/request/widgets-api/index.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("./src/io/request/widgets-api/request.ts");n.d(e,"WidgetsApiRequest",function(){return i.b});var s=n("./src/io/request/widgets-api/create-callback-request.ts");n.d(e,"CreateCallbackRequest",function(){return s.a});var r=n("./src/io/request/widgets-api/create-feedback-form.ts");n.d(e,"CreateFeedbackForm",function(){return r.a});var a=n("./src/io/request/widgets-api/create-site-chat.ts");n.d(e,"CreateSiteChat",function(){return a.a});var o=n("./src/io/request/widgets-api/file-message.ts");n.d(e,"FileMessage",function(){return o.a});var c=n("./src/io/request/widgets-api/get-chat-availability.ts");n.d(e,"GetChatAvailability",function(){return c.a});var u=n("./src/io/request/widgets-api/get-chat-available-groups.ts");n.d(e,"GetChatAvailableGroups",function(){return u.a});var l=n("./src/io/request/widgets-api/get-employees.ts");n.d(e,"GetEmployees",function(){return l.a});var _=n("./src/io/request/widgets-api/get-invitation-employee.ts");n.d(e,"GetInvitationEmployee",function(){return _.a});var d=n("./src/io/request/widgets-api/get-offline-available-groups.ts");n.d(e,"GetOfflineAvailableGroups",function(){return d.a});var p=n("./src/io/request/widgets-api/invite-to-site-chat.ts");n.d(e,"InviteToSiteChat",function(){return p.a});var f=n("./src/io/request/widgets-api/is-employees-available.ts");n.d(e,"IsEmployeesAvailable",function(){return f.a});var g=n("./src/io/request/widgets-api/message-history.ts");n.d(e,"MessageHistory",function(){return g.a});var v=n("./src/io/request/widgets-api/rating-event.ts");n.d(e,"RatingEvent",function(){return v.a});var h=n("./src/io/request/widgets-api/read-message.ts");n.d(e,"ReadMessage",function(){return h.a});var E=n("./src/io/request/widgets-api/send-typing.ts");n.d(e,"SendTyping",function(){return E.a});var b=n("./src/io/request/widgets-api/set-attributes.ts");n.d(e,"SetAttributes",function(){return b.a});var m=n("./src/io/request/widgets-api/text-message.ts");n.d(e,"TextMessage",function(){return m.a});var S=n("./src/io/request/widgets-api/transfer-chat.ts");n.d(e,"TransferChat",function(){return S.a});var I=n("./src/io/request/widgets-api/populate-member.ts");n.d(e,"PopulateMember",function(){return I.a});var y=n("./src/io/request/widgets-api/transfer-chat-to-AIBot.ts");n.d(e,"TransferChatToAIBot",function(){return y.a});var A=n("./src/io/request/widgets-api/update-attributes.ts");n.d(e,"UpdateAttributes",function(){return A.a});var T=n("./src/io/request/widgets-api/get-dialog-state.ts");n.d(e,"GetDialogState",function(){return T.a})},"./src/io/request/widgets-api/invite-to-site-chat.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e,n,i){var s=t.call(this,r.a.CREATE_SITE_CHAT,{})||this;return s.__communicationAttrs=e,s.__siteChatRequest=n,s.__invitationAttrs=i,s}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.inviteToSiteChat(t,e,this.createVisitor(),this.__communicationAttrs,this.__siteChatRequest,this.__invitationAttrs)},e}(r.b)},"./src/io/request/widgets-api/is-employees-available.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e){var n=t.call(this,r.a.IS_EMPLOYEES_AVAILABLE,{})||this;return n.__employeeIds=e,n}return i.c(e,t),e.prototype.doRequest=function(t,e){0!==this.__employeeIds.length?s.client.getEmployeesAvailability(e,this.createVisitor(),this.__employeeIds):t({})},e}(r.b)},"./src/io/request/widgets-api/message-history.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/app/app.ts")),a=n("./src/io/request/widgets-api/request.ts"),o=n("./src/io/request/widgets-api/util.ts"),c=function(t){function e(e){var n=t.call(this,a.a.MESSAGE_HISTORY,{})||this;return n.__conversationId=e,n}return i.c(e,t),e.prototype.doRequest=function(t,e){var n=this;var i=(new Date).getTimezoneOffset();s.client.getDialog(function(e){var i=e;r.a.setServerTime(i.currentDatetime);var s=o.a.convertHistory(n.__conversationId,i);t(s)},e,this.createVisitor(),this.__conversationId,new s.model.ClientAttrs(i))},e}(a.b)},"./src/io/request/widgets-api/populate-member.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=n("./src/io/request/widgets-api/util.ts"),o=function(t){function e(e){var n=t.call(this,r.a.POPULATE_MEMBER,{})||this;return n.__employeeId=e.getId(),n}return i.c(e,t),e.prototype.doRequest=function(t,e){var n=this;s.client.populateEmployees(function(e){var i=e[n.__employeeId];t(a.a.convertEmployee(i))},e,this.createVisitor(),[this.__employeeId])},e}(r.b)},"./src/io/request/widgets-api/rating-event.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i,s=n("./node_modules/tslib/tslib.es6.js"),r=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),a=(n.n(r),n("./src/io/request/widgets-api/request.ts"));!i||(i={}));var o=function(t){function e(e,n,i,s){var r=t.call(this,a.a.SEND_RATING,{})||this;return r.__conversationId=e,r.__comment=s||null,r.__rating=i||null,r.__rate=n,r}return s.c(e,t),e.prototype.doRequest=function(t,e){r.client.sendRatingEvent(function(){t()},e,this.createVisitor(),this.createConversationEventAttrs(this.__conversationId),new r.model.RatingAttrs(this.__rating,this.__comment,this.__rate))},e}(a.b)},"./src/io/request/widgets-api/read-message.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e,n){var i=t.call(this,r.a.READ_MESSAGE,{})||this;return i.__conversationId=e,i.__messageIds=[n],i}return i.c(e,t),e.prototype.doRequest=function(t,e){var n=this;s.client.readChatMessages(function(){t(n.__messageIds)},e,this.createVisitor(),this.createConversationEventAttrs(this.__conversationId),this.__messageIds)},e}(r.b)},"./src/io/request/widgets-api/request.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"b",function(){return u});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/request.ts")),a=n("./src/redux-store/index.ts"),o=n("./src/redux-store/reducers/visitor/selectors.ts"),c={TRANSFER_CHAT:"transfer-chat",SEND_TEXT_MESSAGE:"send-text-message",SEND_RATING:"send-rating",SEND_FILE_MESSAGE:"send-file-message",READ_MESSAGE:"read-message",CREATE_SITE_CHAT:"create-site-chat",INVITE_TO_SITE_CHAT:"invite-to-site-chat",GET_CHAT_AVAILABLE_GROUPS:"get-chat-available-groups",GET_EMPLOYEES:"get-employees",IS_EMPLOYEES_AVAILABLE:"is-employees-available",GET_OFFLINE_AVAILABLE_GROUPS:"get-offline-available-groups",MESSAGE_HISTORY:"message-history",CREATE_FEEDBACK_FORM:"create-feedback-form",CREATE_CALLBACK_REQUEST:"create-callback-request",GET_CHAT_AVAILABILITY:"get-chat-availability",POPULATE_MEMBER:"populate-member",GET_INVITATION_EMPLOYEE:"get-invitation-employee",SET_ATTRIBUTES:"set-attributes",TRANSFER_CHAT_TO_AIBOT:"transfer-chat-to-AIBot",UPDATE_ATTRIBUTES:"update-attributes",GET_DIALOG_STATE:"get-dialog-state"},u=function(t){eturn i.c(e,t),e.prototype.getType=function(){return this.__type},e.prototype.doRequest=e.prototype.createVisitor=function(){var t=Object(o.b)(a.a.getState()),e=Object(o.a)(a.a.getState()),n=Object(o.c)(a.a.getState());return new s.model.Visitor(t,e,n)},e.prototype.createAttribute=e.prototype.createConversationEventAttrs=function(t){var e=(new Date).getTimezoneOffset();return new s.model.ConversationEventAttrs(new s.model.ClientAttrs(e),t)},e}(r.a)},"./src/io/request/widgets-api/send-typing.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e,n){var i=t.call(this,r.a.SEND_TEXT_MESSAGE,{})||this;return i.__message=n,i.__conversationId=e,i}return i.c(e,t),e.prototype.doRequest=function(t,e){var n=this;s.client.sendChatMessageTyping(function(){t(n.__message)},e,this.createVisitor(),this.createConversationEventAttrs(this.__conversationId),this.__message)},e}(r.b)},"./src/io/request/widgets-api/set-attributes.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/response/index.ts")),a=n("./src/io/request/widgets-api/request.ts"),o=function(t){function e(e,n,i){var s=t.call(this,a.a.SET_ATTRIBUTES,{})||this;return s.__attributes=e,s.__hash=n,s.__externalId=i,s}return i.c(e,t),e.prototype.doRequest=function(t,e){var n=this;s.client.setAttributes(e,this.createVisitor(),this.__attributes.map(,this.__hash,this.__externalId)},e}(a.b)},"./src/io/request/widgets-api/text-message.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/util/location/location.ts")),a=n("./src/io/request/widgets-api/request.ts"),o=function(t){function e(e){var n=t.call(this,a.a.SEND_TEXT_MESSAGE,{})||this;return n.__message=e,n.__currentUrl=r.a.getLocation(),n}return i.c(e,t),e.prototype.doRequest=function(t,e){var n=this;s.client.sendTextChatMessages(e,this.createVisitor(),this.createConversationEventAttrs(this.__message.getConversationId()),this.__currentUrl,[new s.model.TextChatMessage(this.__message.getId(),this.__message.getText())])},e}(a.b)},"./src/io/request/widgets-api/transfer-chat-to-AIBot.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e){var n=t.call(this,r.a.TRANSFER_CHAT_TO_AIBOT,{})||this;return n.__conversationId=e,n}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.transferChatToAIBot(function(){t()},e,this.createVisitor(),this.__conversationId)},e}(r.b)},"./src/io/request/widgets-api/transfer-chat.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e,n){var i=t.call(this,r.a.TRANSFER_CHAT,{})||this;return i.__groupId=e,i.__conversationId=n,i}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.transferChat(function(){t()},e,this.createVisitor(),this.__groupId,this.__conversationId)},e}(r.b)},"./src/io/request/widgets-api/update-attributes.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./src/io/request/widgets-api/request.ts")),a=function(t){function e(e,n,i,s){var a=t.call(this,r.a.UPDATE_ATTRIBUTES,{})||this;return a.__conversationId=e,a.__visitorName=n,a.__visiblePrechats=i&&0!==Object.keys(i).length?i:null,a.__hiddenPrechats=s&&0!==Object.keys(s).length?s:null,a}return i.c(e,t),e.prototype.doRequest=function(t,e){s.client.updateAttributes(e,this.createVisitor(),this.createConversationEventAttrs(this.__conversationId),this.__visitorName,this.__visiblePrechats,this.__hiddenPrechats)},e}(r.b)},"./src/io/request/widgets-api/util.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/app/app.ts"),r=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),a=(n.n(r),n("./src/util/location/location.ts")),o=n("./src/settings/props.ts"),c=n("./src/data/group.ts"),u=n("./src/data/factory/factory.ts"),l=n("./src/data/member.ts"),_=n("./src/io/response/index.ts"),d=n("./src/util/util.ts"),p=n("./src/io/request/vnds/request.ts");!function(t){t.parseTime=function(t){return e(+t.split(":")[0])+":"+e(+t.split(":")[1])+":00.001"},t.time=function(t){return e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+(t.getMilliseconds()<100?"0"+e(t.getMilliseconds()):e(t.getMilliseconds()))};var e=function(t){return String(t<10?"0"+t:t)};t.createCommunicationAttrs=function(t,e,n,i){var s=a.a.getLocation(),c=o.a.getSiteName(),u=(new Date).getTimezoneOffset();return new r.model.StartCommunicationAttrs(new r.model.ClientAttrs(u),s,n||"",c,e,t,i||null)},t.convertGroup=function(t){var e=s.a.getSite(),n=new c.a(t.id,e);return n.populate(t.name,t.sorting),e.addGroup(n),n},t.convertEmployee=function(t){var e=new l.a(t.id);return e.populate(t.firstName,t.lastName,t.avatarUrl,t.nickName),e},t.convertHistory=function(e,n){for(var i=[],s=0;s<n.records.length;s++){var r=n.records[s],a=t.convertHistoryMessage(e,r);i=i.concat(a)}var o=null!=n.assignedEmployee?t.convertMember(n.assignedEmployee):null;return new _.MessageHistory(i,o)},t.convertMember=function(t){var e=t.employee,n=new l.a(e.id);n.populate(e.firstName,e.lastName,e.avatarUrl,e.nickName);var i=t.isOnline;return n.setStatus(i?p.a.FREE:p.a.OFFLINE),n},t.convertHistoryMessage=function(t,e){var n=e.chatMessage;if(n.text instanceof r.model.TextChatMessage)return[u.a.createTextMessageFromHistory(t,e,n.text)];if(n.route instanceof r.model.RouteChatMessage&&n.route.routingDestination===p.b.QUEUE)return[u.a.createRouteChatMessageFromHistory(t,e,n.route)];if(n.rating instanceof r.model.RatingMessage)return[u.a.createRatingChatMessageFromHistory(t,e,n.rating)];if(n.chatDropped instanceof r.model.ChatDroppedMessage)return[u.a.createChatDroppedMessageFromHistory(t,e,n.chatDropped)];if(n.sticker instanceof r.model.StickerChatMessage)return[u.a.createStickerMessageFromHistory(t,e,n.sticker)];if(n.file instanceof r.model.FileChatMessage){var i=[],s=n.file.fileInfoList.map(function(i){return u.a.createFileMessageFromHistory(t,e,n.file,i)});if(n.file.comment){var a=n.file;a.text=n.file.comment,a.messageId=d.a.generateGuid(),i=i.concat([u.a.createTextMessageFromHistory(t,e,a)])}return i.concat(s)}return n.close instanceof r.model.CloseChatMessage?[u.a.createCloseMessageFromHistory(t,e,n.close)]:n.holding instanceof r.model.HoldingChatMessage?[u.a.createHoldingMessageFromHistory(t,e,n.holding)]:n.offerCallback instanceof r.model.OfferCallbackChatMessage?[u.a.createOfferCallbackMessageFromHistory(t,e,n.offerCallback)]:[]}}(i||(i={}))},"./src/io/response/call-accepted-by-member.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(){return t.call(this,s.a.CALL_ACCEPTED_BY_MEMBER)||this}return i.c(e,t),e}(n("./src/io/response/response.ts").a)},"./src/io/response/call-accepted-by-visitor.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(){return t.call(this,s.a.CALL_ACCEPTED_BY_VISITOR)||this}return i.c(e,t),e}(n("./src/io/response/response.ts").a)},"./src/io/response/chat-availability.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.CHAT_AVAILABILITY)||this;return n.__availabilityLevel=e,n}return i.c(e,t),e.prototype.getAvailabilityLevel=function(){return this.__availabilityLevel},e}(n("./src/io/response/response.ts").a)},"./src/io/response/chat-available-groups.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.CHAT_AVAILABLE_GROUPS)||this;return n.__groups=e,n.__groups.sort(function(t,e){return t.getSortOrder()-e.getSortOrder()}),n}return i.c(e,t),e.prototype.getGroups=function(){return this.__groups},e}(n("./src/io/response/response.ts").a)},"./src/io/response/chat-closed.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.CHAT_CLOSED)||this;return n.__conversationId=e,n}return i.c(e,t),e.prototype.getConversationId=function(){return this.__conversationId},e}(n("./src/io/response/response.ts").a)},"./src/io/response/chat-routing.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.CHAT_ROUTING)||this;return n.__routingDestination=e,n}return i.c(e,t),e.prototype.getRoutingDestination=function(){return this.__routingDestination},e}(n("./src/io/response/response.ts").a)},"./src/io/response/dialog-state.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.DIALOG_STATE)||this;return n.__conversationId=e.conversationId?e.conversationId:null,n}return i.c(e,t),e}(n("./src/io/response/response.ts").a)},"./src/io/response/dialog-unavailable-types.ts":"./src/io/response/dialog-unavailable.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=n("./src/io/response/dialog-unavailable-types.ts"),a=function(t){function e(e){var n=t.call(this,s.a.DIALOG_UNAVAILABLE)||this;return n.__errorMessage=e,n.__error=r.a.DEFAULT,n.__errorMessage===r.a.NO_MEMBER?n.__error=r.a.NO_MEMBER:n.__errorMessage===r.a.VISITOR_IS_BANNED?n.__error=r.a.VISITOR_IS_BANNED:n.__errorMessage===r.a.NULL_ENTITY&&(n.__error=r.a.NULL_ENTITY),n}return i.c(e,t),e.prototype.getError=function(){return this.__error},e}(n("./src/io/response/response.ts").a)},"./src/io/response/dialog.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.DIALOG)||this;return n.__dialog=e,n}return i.c(e,t),e.prototype.getDialog=function(){return this.__dialog},e}(n("./src/io/response/response.ts").a)},"./src/io/response/echo.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.ECHO)||this;return n.__message=e,n}return i.c(e,t),e.prototype.getMessage=function(){return this.__message},e}(n("./src/io/response/response.ts").a)},"./src/io/response/employees-availability.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/settings/props.ts"),r=n("./src/io/response/types.ts"),a=function(t){function e(e){var n=t.call(this,r.a.EMPLOYEES_AVAILABILITY)||this;return n.__availabilityById=e,n}return i.c(e,t),e.prototype.getAvailability=function(){for(var t={},e=Object.keys(this.__availabilityById),n=0;n<e.length;n++){var i=e[n],r=this.__availabilityById[i];t[i]=r>=s.a.getMinAvailabilityLevel()}return t},e.prototype.isEmployeeAvailable=function(t){return this.getAvailability()[t]||!1},e}(n("./src/io/response/response.ts").a)},"./src/io/response/group-availability-change.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e,n){var i=t.call(this,s.a.GROUP_AVAILABILITY_CHANGE)||this;return i.__groupId=e,i.__availabilityLevel=n,i}return i.c(e,t),e.prototype.getGroupId=function(){return this.__groupId},e.prototype.getAvailabilityLevel=function(){return this.__availabilityLevel},e}(n("./src/io/response/response.ts").a)},"./src/io/response/holding-message.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.HOLDING_MESSAGE)||this;return n.__text=e,n}return i.c(e,t),e.prototype.getText=function(){return this.__text},e}(n("./src/io/response/response.ts").a)},"./src/io/response/incoming-file.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e,n,i){var r=t.call(this,s.a.INCOMING_FILE)||this;return r.__name=e,r.__size=Number((+n/1024/1024).toFixed(2)),r.__url=i,r}return i.c(e,t),e.prototype.getData=e}(n("./src/io/response/response.ts").a)},"./src/io/response/index.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("./src/io/response/holding-message.ts");n.d(e,"HoldingMessage",function(){return i.a});var s=n("./src/io/response/call-accepted-by-member.ts");n.d(e,"CallAcceptedByMember",function(){return s.a});var r=n("./src/io/response/call-accepted-by-visitor.ts");n.d(e,"CallAcceptedByVisitor",function(){return r.a});var a=n("./src/io/response/chat-closed.ts");n.d(e,"ChatClosed",function(){return a.a});var o=n("./src/io/response/dialog-unavailable.ts");n.d(e,"DialogUnavailable",function(){return o.a});var c=n("./src/io/response/dialog.ts");n.d(e,"Dialog",function(){return c.a});var u=n("./src/io/response/echo.ts");n.d(e,"Echo",function(){return u.a});var l=n("./src/io/response/employees-availability.ts");n.d(e,"EmployeesAvailability",function(){return l.a});var _=n("./src/io/response/group-availability-change.ts");n.d(e,"GroupAvailabilityChange",function(){return _.a});var d=n("./src/io/response/incoming-file.ts");n.d(e,"IncomingFile",function(){return d.a});var p=n("./src/io/response/invitation-employee.ts");n.d(e,"InvitationEmployee",function(){return p.a});var f=n("./src/io/response/invite.ts");n.d(e,"Invite",function(){return f.a});var g=n("./src/io/response/local-ping.ts");n.d(e,"LocalPing",function(){return g.a});var v=n("./src/io/response/member-change.ts");n.d(e,"MemberChanged",function(){return v.a});var h=n("./src/io/response/member-list.ts");n.d(e,"MembersList",function(){return h.a});var E=n("./src/io/response/member-status-change.ts");n.d(e,"MemberStatusChanged",function(){return E.a});var b=n("./src/io/response/member.ts");n.d(e,"Member",function(){return b.a});var m=n("./src/io/response/message-history.ts");n.d(e,"MessageHistory",function(){return m.a});var S=n("./src/io/response/message.ts");n.d(e,"Message",function(){return S.a});var I=n("./src/io/response/page.ts");n.d(e,"Page",function(){return I.a});var y=n("./src/io/response/offline-available-groups.ts");n.d(e,"OfflineAvailableGroups",function(){return y.a});var A=n("./src/io/response/populated-member.ts");n.d(e,"PopulatedMember",function(){return A.a});var T=n("./src/io/response/set-attributes.ts");n.d(e,"SetAttributes",function(){return T.a});var O=n("./src/io/response/state.ts");n.d(e,"State",function(){return O.a});var L=n("./src/io/response/typing-notify.ts");n.d(e,"TypingNotify",function(){return L.a});var w=n("./src/io/response/visitor-ban.ts");n.d(e,"VisitorBan",function(){return w.a});var C=n("./src/io/response/visitor.ts");n.d(e,"Visitor",function(){return C.a});var N=n("./src/io/response/chat-available-groups.ts");n.d(e,"ChatAvailableGroups",function(){return N.a});var D=n("./src/io/response/chat-availability.ts");n.d(e,"ChatAvailability",function(){return D.a});var R=n("./src/io/response/reset-state.ts");n.d(e,"ResetState",function(){return R.a});var M=n("./src/io/response/response.ts");n.d(e,"Response",function(){return M.a});var x=n("./src/io/response/chat-routing.ts");n.d(e,"ChatRouting",function(){return x.a});var B=n("./src/io/response/dialog-state.ts");n.d(e,"DialogState",},"./src/io/response/invitation-employee.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.INVITATION_EMPLOYEE)||this;return n.__member=e,n}return i.c(e,t),e.prototype.getMember=function(){return this.__member},e}(n("./src/io/response/response.ts").a)},"./src/io/response/invite.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.SEND_INVITE)||this;return n.__invite=e,n}return i.c(e,t),e.prototype.getInvite=function(){return this.__invite},e}(n("./src/io/response/response.ts").a)},"./src/io/response/local-ping.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(){return t.call(this,s.a.LOCAL_PING)||this}return i.c(e,t),e}(n("./src/io/response/response.ts").a)},"./src/io/response/member-change.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e,n){var i=t.call(this,s.a.MEMBER_CHANGE)||this;return i.__member=e,i.__conversationId=n,i}return i.c(e,t),e.prototype.getMember=function(){return this.__member},e.prototype.getConversationId=function(){return this.__conversationId},e}(n("./src/io/response/response.ts").a)},"./src/io/response/member-list.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.MEMBER_LIST)||this;return n.__members=e,n}return i.c(e,t),e.prototype.getMembers=function(){return this.__members},e}(n("./src/io/response/response.ts").a)},"./src/io/response/member-status-change.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.MEMBER_STATUS_CHANGE)||this;return n.__member=e,n}return i.c(e,t),e.prototype.getMember=function(){return this.__member},e}(n("./src/io/response/response.ts").a)},"./src/io/response/member.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.MEMBER)||this;return n.__member=e,n}return i.c(e,t),e.prototype.getMember=function(){return this.__member},e}(n("./src/io/response/response.ts").a)},"./src/io/response/message-history.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e,n){var i=t.call(this,s.a.MESSAGE_HISTORY)||this;return i.__messages=e,i.__member=n,i}return i.c(e,t),e.prototype.getMessages=function(){return this.__messages},e.prototype.getMember=function(){return this.__member},e}(n("./src/io/response/response.ts").a)},"./src/io/response/message.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.MESSAGE)||this;return n.__message=e,n}return i.c(e,t),e.prototype.getMessage=function(){return this.__message},e}(n("./src/io/response/response.ts").a)},"./src/io/response/offline-available-groups.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.OFFLINE_AVAILABLE_GROUPS)||this;return n.getGroups=function(){return this.__groups},n.__groups=e,n.__groups.sort(,n}return i.c(e,t),e}(n("./src/io/response/response.ts").a)},"./src/io/response/page.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.PAGE)||this;return n.__page=e,n}return i.c(e,t),e.prototype.getPage=function(){return this.__page},e}(n("./src/io/response/response.ts").a)},"./src/io/response/populated-member.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.POPULATE_MEMBER)||this;return n.__member=e,n}return i.c(e,t),e.prototype.getMember=function(){return this.__member},e}(n("./src/io/response/response.ts").a)},"./src/io/response/reset-state.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(){return t.call(this,s.a.RESET_STATE)||this}return i.c(e,t),e}(n("./src/io/response/response.ts").a)},"./src/io/response/response.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=)},"./src/io/response/set-attributes.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(){return t.call(this,s.a.SET_ATTRIBUTES)||this}return i.c(e,t),e}(n("./src/io/response/response.ts").a)},"./src/io/response/state.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){eturn i.c(e,t),e.prototype.getEntity=function(){return this.__entity},e.prototype.getStatus=function(){return this.__status},e}(n("./src/io/response/response.ts").a)},"./src/io/response/types.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={VISITOR:"visitor",PAGE:"page",MEMBER:"member",MEMBER_STATUS_CHANGE:"member-status-change",MEMBER_CHANGE:"member-change",POPULATE_MEMBER:"populate-member",INVITATION_EMPLOYEE:"invitation-member",EMPLOYEES_AVAILABILITY:"employees-availability",MEMBER_LIST:"member-list",GROUP_LIST:"group-list",DIALOG:"dialog",DIALOG_UNAVAILABLE:"dialog-unavailable",HAS_CHAT:"has-chat",FEATURES:"features",AVAILABLE_OPERATORS:"available-operators",CHAT_AVAILABLE_GROUPS:"available-groups",OFFLINE_AVAILABLE_GROUPS:"offline-groups",STATE:"state",SEND_INVITE:"send-invite",GROUP_AVAILABILITY_CHANGE:"group_availability-change",MESSAGE_HISTORY:"message-history",MESSAGE:"message",TYPING:"typing",MESSAGE_READ:"message-read",MESSAGE_UPDATE:"message-update",CHAT_AVAILABILITY:"chat-availability",CHAT_MOVE:"chat-transfer",STOP_CHAT_MOVE:"hide-transfer",CHAT_CLOSED:"chat-closed",HOLDING_MESSAGE:"holding-message",INCOMING_FILE:"file",UPLOAD_URL:"upload-url",UPLOAD_COMPLETE:"upload-complete",LOCAL_PING:"local-ping",ECHO:"echo",CALL_ACCEPTED_BY_MEMBER:"call-accepted-by-member",CALL_ACCEPTED_BY_VISITOR:"call-accepted-by-visitor",VISITOR_BAN:"visitor-ban",SET_ATTRIBUTES:"set-attributes",RESET_STATE:"reset-state",CHAT_ROUTING:"chat-routing",DIALOG_STATE:"dialog-state"}},"./src/io/response/typing-notify.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){eturn i.c(e,t),e}(n("./src/io/response/response.ts").a)},"./src/io/response/upload-status-type.ts":"./src/io/response/visitor-ban.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.VISITOR_BAN)||this;return n.__isBanned=e,n}return i.c(e,t),e.prototype.isBanned=function(){return this.__isBanned},e}(n("./src/io/response/response.ts").a)},"./src/io/response/visitor.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/response/types.ts"),r=function(t){function e(e){var n=t.call(this,s.a.VISITOR)||this;return n.__visitor=e,n}return i.c(e,t),e.prototype.getVisitor=function(){return this.__visitor},e}(n("./src/io/response/response.ts").a)},"./src/io/services/connection.ts":function(t,e,n){"use strict";n.d(e,"b",function(){return s}),n.d(e,"a",function(){return r});var i=n("./modules/external_libs.js"),s=(n.n(i),{EVENT_SERVICE:"event-service-api"}),r=function(){eturn t.prototype.getName=function(){return this.__name},t.prototype._getClient=function(){return this.__client},t.prototype.__setClient=t.prototype._initClient=function(t,e){var n=this;n.__setClient(n.__createTTransport(t)),e()},t.prototype.__createTTransport=function(t){var e=null,n=new i.Thrift.Transport(t),r=new i.Thrift.TJSONProtocol(n);return this.__name===s.EVENT_SERVICE&&(e=new i.interaction.services.EventClient(r)),e},t}()},"./src/io/services/event-service.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./modules/external_libs.js"),r=(n.n(s),n("./src/logger/logger.ts")),a=n("./src/io/services/connection.ts"),o=function(t){function e(e){var n=this;if((n=t.call(this,a.b.EVENT_SERVICE)||this).__queue=[],e){var i=e.ServiceAddress,s=e.ServiceID;n.endpoint="//"+i+"/"+s}else n.endpoint=null;return n}return i.c(e,t),e.prototype.init=function(){this.endpoint&&this._initClient(this.endpoint,this.__startSendLoop())},e.prototype.__startSendLoop=function(){var t=this;return function(){setInterval(function(){t.__queue.length>0&&t.__send(t.__queue),t.__startSendLoop()},3e3)}},e.prototype.__send=function(t){r.a.debug("sending a request to event-service : "+t);var e=this._getClient();if(e instanceof s.interaction.services.EventClient)for(;t.length>0;){t.shift().getRequest(e)()}},e.prototype.pushLogData=e}(a.a)},"./src/io/services/widgets-api-app.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./src/redux-store/actions/debug.ts"),s=n("./src/redux-store/index.ts"),r=function(){eturn t.prototype.init=function(){s.a.dispatch(Object(i.d)(this.data))},t}()},"./src/io/services/widgets-api.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return _});var i,s=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),r=(n.n(s),n("./node_modules/@livetex/browser-service-discovery/bin/index.js")),a=(n.n(r),n("./src/event-emitter/index.ts")),o=n("./node_modules/@livetex/piper/lib/index.js"),c=(n.n(o),n("./src/redux-store/index.ts")),u=n("./src/redux-store/actions/debug.ts"),l=n("./src/util/util.ts");!function(t){t.VISITOR_IS_INVALID="visitor is invalid",t.TOO_MANY_REQUESTS="too many requests"}(i||(i={}));var _=function(){eturn t.prototype.init=function(){var t=this.getBalancer();s.client.init(t,!0)},t.prototype.errorHandler=function(t,e){var n;try{n=JSON.parse(t)}catch(t){return void console.log("error in wapi message parsing")}if(500===e)switch(n.errorMessage){case i.VISITOR_IS_INVALID:a.a.publishEvent(o.e.s.api.EMPTY_VISITOR_ID_ERROR),c.a.dispatch(Object(u.c)(n));break;case i.TOO_MANY_REQUESTS:a.a.publishEvent(o.e.s.api.TOO_MANY_REQUESTS_ERROR)}},t.prototype.send=function(t,e,n){var i=this,s=e||l.a.nop,r=n||l.a.nop;return new Promise(function(e,n){var a=i;t.doRequest(function(n,i){a.__dataHandler(t.getType(),n),s(i),e(i)},})},t.prototype.getBalancer=function(){return new r.BalancerDiscovery(this.settings.balancer,this.visitorSettings.accountId,"widget","24.5.3015-496641c")},t}()},"./src/logger/levels.ts":"./src/logger/logger-record.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./src/logger/levels.ts"),s=function(){return function(t,e,n,s,r){this.getLevel=function(){var t={};return t[i.a.ERROR]="[ERROR] ",t[i.a.WARN]="[WARN] ",t[i.a.INFO]="[INFO] ",t[i.a.DEBUG]="[DEBUG] ",t[this.level]||""},this.getTime=this.getData=this.level=t,this.message=e,this.name=n,this.appType=s,this.time=new Date,this.data=r}}()},"./src/logger/logger.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/logger/logger-record.ts"),r=n("./src/logger/levels.ts");!function(t){var e=[],n=r.a.ERROR,i=10,a="starting";t.init=t.error=function(t,e){l(r.a.ERROR,t,e)},t.warn=function(t,e,n){l(r.a.WARN,t,e,n)},t.info=t.debug=t.get=function(){return e},t.print=function(){console&&e.map(},t._clear=var o=function(t,e){t.getData()?(console.group(c(t),e,"color: gray; font-weight: lighter;","font-weight: normal;"),console.group("%cdata","font-weight:bold;"),console.log(t.getData()),console.groupEnd(),console.groupEnd()):console.log(c(t),e,"color: gray; font-weight: lighter;","font-weight: normal;")},c=function(t){return"%c"+t.getLevel()+"%c"+t.getTime()+"%c["+t.name+"] appType: "+t.appType+", message: "+t.message},u=l=function(t,r,c,l){var _="app";"string"==typeof c?_=c:c instanceof Object&&(_=c.getName());var d=new s.a(t,r,_,a,l);e.length>=i&&(e=e.splice(i/10)),e.push(d),window.console&&n>=t&&o(d,u(t))}}(i||(i={}))},"./src/polyfill.ts":function(t,e,n){"use strict";n("./node_modules/promise-polyfill/src/polyfill.js");var i=n("./node_modules/unfetch/polyfill/index.js"),s=(n.n(i),n("./node_modules/core-js/features/object/index.js")),r=(n.n(s),n("./node_modules/core-js/features/array/find.js")),a=(n.n(r),n("./node_modules/core-js/features/array/includes.js")),o=(n.n(a),n("./node_modules/core-js/features/string/includes.js")),c=(n.n(o),n("./node_modules/core-js/features/string/starts-with.js")),u=(n.n(c),n("./node_modules/core-js/features/url/index.js")),l=(n.n(u),n("./node_modules/core-js/features/url-search-params/index.js")),_=(n.n(l),n("./node_modules/core-js/features/object/entries.js")),d=(n.n(_),n("./node_modules/core-js/features/object/values.js")),p=(n.n(d),n("./node_modules/core-js/features/object/keys.js")),f=(n.n(p),n("./node_modules/custom-event-polyfill/polyfill.js"));n.n(f)},"./src/redux-store/actions/debug.ts":function(t,e,n){"use strict";n.d(e,"b",function(){return s}),n.d(e,"a",function(){return r}),n.d(e,"d",function(){return a}),n.d(e,"c",function(){return o});var i=n("./node_modules/@livetex/piper/lib/index.js"),s=(n.n(i),"send-enpoint"),r=i.e.s.api.EMPTY_VISITOR_ID_ERROR,a=function(t){return{type:s,payload:t}},o=function(t){return{type:r,payload:t}}},"./src/redux-store/actions/init-transport.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return r});var i,s="init-transport",r=a=function(t){var e=t.servicesData.find(;if(void 0===e)throw new Error("No service data with key "+t.WIDGETS_API.KEY);return{accountId:t.account_id||(t.ACCOUNT?t.ACCOUNT.ID:null),siteId:t.SITE.ID,services:{balancer:t.BALANCER,billingUrl:t.BILLING_URL,contentServer:t.CONTENT_SERVER,discoveryService:t.DISCOVERY_SERVICE?t.DISCOVERY_SERVICE.HOST:null,eventService:t.EVENT_SERVICE?t.EVENT_SERVICE.KEY:null,fileServer:"https://"+e.ServiceAddress,mediaServer:t.CALLS?t.CALLS.MEDIA_SERVER:null,offlineService:t.OFFLINE_SERVICE?t.OFFLINE_SERVICE.KEY:null,offlineServiceUrl:t.OFFLINE_SERVICE_URL,livetexUrl:t.LTX_URL,widgetsApi:t.WIDGETS_API?t.WIDGETS_API.KEY:null,widgetsApiApp:t.WIDGETS_API_APP?t.WIDGETS_API_APP.KEY:null},callButtons:t.call_buttons,chatButtons:t.chat_buttons,environment:t.environment,features:t.features,hasGroup:t.has_groups,invitationRules:t.invitation_rules,label:t.label,members:t.members,servicesOffline:t.services?t.services.offline:null,siteName:t.site_name,servicesData:t.servicesData}};!function(t){t.DoublePoint="DoublePoint",t.FivePoint="FivePoint"}(i||(i={}))},"./src/redux-store/actions/set-account-settings.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s});var i="set-account-settings",s=function(t){return{type:i,payload:t}}},"./src/redux-store/actions/set-availability.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s});var i="set-availability",s=function(t){return{type:i,payload:t}}},"./src/redux-store/actions/set-view-state.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s});var i="set-view-state",s=function(t){return{type:i,payload:t}}},"./src/redux-store/actions/set-visitor-info.ts":"./src/redux-store/actions/start-app.ts":"./src/redux-store/index.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return _});var i=n("./node_modules/redux/es/redux.js"),s=n("./src/redux-store/reducers/index.ts"),r=n("./node_modules/redux-devtools-extension/index.js"),a=(n.n(r),n("./src/redux-store/middlewares/start-app-middleware.ts")),o=n("./src/redux-store/middlewares/availablity-middleware.ts"),c=n("./src/redux-store/middlewares/init-transport-middleware.ts"),u=n("./src/redux-store/middlewares/storeActionsDebugMiddleware.ts"),l=Object(i.applyMiddleware)(a.a,c.a,o.a,Object(u.a)()),_=Object(i.createStore)(s.a,Object(i.compose)(l))},"./src/redux-store/middlewares/availablity-middleware.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return f});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/redux-store/actions/set-availability.ts"),r=n("./src/io/response/types.ts"),a=n("./src/io/api.ts"),o=n("./src/redux-store/actions/start-app.ts"),c=n("./src/redux-store/reducers/account-settings/selectors.ts"),u=n("./src/event-emitter/index.ts"),l=n("./src/redux-store/reducers/availability/selectors.ts"),_=n("./src/service/site.ts"),d=n("./src/app/app.ts"),p=this,f=function(t){return function(e){return function(n){return i.b(p,void 0,void 0,function(){return i.d(this,function(i){switch(n.type){case o.a:return a.b.addListener(r.a.CHAT_AVAILABILITY,function(e,n){if(!Object(c.e)(t.getState())){t.dispatch(Object(s.b)(n));var i=Object(l.b)(t.getState());Object(c.h)(t.getState())&&u.a.publishEvent(_.a,{chat_available:i,conversation_id:d.a.getDialog()?d.a.getDialog().getConversationId():null,availability_changed:!0})}}),[2,e(n)];default:return[2,e(n)]}return[2]})})}}}},"./src/redux-store/middlewares/init-transport-middleware.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return l});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/api.ts"),r=n("./src/redux-store/reducers/visitor/selectors.ts"),a=n("./src/redux-store/reducers/env-settings/selectors.ts"),o=n("./src/redux-store/actions/init-transport.ts"),c=n("./src/util/serviceMemory.ts"),u=this,l=function(t){return function(e){return function(n){return i.b(u,void 0,void 0,function(){var l,_,d,p;return i.d(this,function(f){switch(f.label){case 0:switch(n.type){case o.a:return[3,1]}return[3,3];case 1:return l=e(n),_=t.getState(),d=Object(r.e)(_),p=Object(a.a)(_),[4,function(t,e,n){return i.b(u,void 0,void 0,function(){var r,a,o;return i.d(this,function(i){return r=t.siteId,a="lt-"+r+"-all-ids",o=c.a.isPrivateMode?c.a.getItem(a):localStorage.getItem(a),s.b.init(t,e,n,o),[2]})})}(d,p,n.payload.servicesData)];case 2:return f.sent(),[2,l];case 3:return[2,e(n)]}})})}}}},"./src/redux-store/middlewares/start-app-middleware.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return P});var i,s=n("./node_modules/tslib/tslib.es6.js"),r=n("./src/redux-store/actions/set-availability.ts"),a=n("./src/io/index.ts"),o=n("./src/io/api.ts"),c=n("./src/app/app.ts"),u=n("./src/app/pipe.ts"),l=n("./src/event-emitter/index.ts"),_=n("./src/app/embedded/embedded.ts"),d=n("./src/app/mobile/mobile.ts"),p=n("./src/settings/props.ts"),f=n("./src/core/registry.ts"),g=n("./src/app/app-types.ts"),v=n("./src/app/env-settings.ts"),h=n("./src/redux-store/actions/start-app.ts"),E=n("./src/service/api/events.ts"),b=n("./src/core/app-state.ts"),m=n("./src/app/transport/transport.ts"),S=n("./src/core/state-map.ts"),I=n("./src/app/states/states.ts"),y=n("./src/redux-store/reducers/visitor/selectors.ts"),A=n("./src/redux-store/actions/set-account-settings.ts"),T=n("./src/redux-store/reducers/account-settings/selectors.ts"),O=n("./src/io/response/types.ts"),L=n("./src/redux-store/actions/debug.ts"),w=n("./src/util/debugPerfomance.ts"),C=n("./src/event-emitter/actions/view-init.ts"),N=n("./src/redux-store/reducers/env-settings/selectors.ts"),D=n("./src/redux-store/actions/set-visitor-info.ts"),R=n("./src/util/util.ts"),M=n("./src/data/dialog.ts"),x=n("./src/tabs/tabs.ts"),B=this,j=new f.a("up"),G=new f.a("down"),W=function(t){return function(){var e=new S.a(I.c._label,I.c._welcome,I.c._invite,I.c._dialog,I.c._hiddenDialog,I.c._offline,I.c._callRequest,I.c._callRequestHidden,I.c._xwidget);return new b.a("app-state",e,t)}},q=function(t,e,n){return s.b(B,void 0,void 0,function(){var i,r,a,_;return s.d(this,function(s){switch(s.label){case 0:return[4,c.a.addPage(o.b)];case 1:return s.sent(),c.a.startQuark(),i=Object(u.a)(Object(v.a)(),p.a,c.a),r=i.type,a=i.payload,l.a.publishEvent(r,a),b.a.addTransports(m.a.init()),t(),_=n(),e(j,G,o.b,_),x.a.init(),[2,_]}})})},F=function(){return s.b(B,void 0,void 0,function(){var t;return s.d(this,function(e){switch(e.label){case 0:switch(t=c.a.getAppType(),t){case g.a.EMBEDDED:return[3,1];case g.a.MOBILE:return[3,3]}return[3,5];case 1:return[4,q(_.a.startWidgets,_.a.startServices,W(_.a.INIT_STATE))];case 2:return[2,e.sent()];case 3:return d.a.prevStart(),[4,q(d.a.startWidgets,d.a.startServices,W(d.a.INIT_STATE))];case 4:return[2,e.sent()];case 5:return[3,6];case 6:return[2]}})})};var k=function(){return s.b(B,void 0,void 0,function(){var t;return s.d(this,function(e){switch(e.label){case 0:return[4,o.b.send(new a.a.wapi.GetChatAvailability).catch(function(t){return console.error(t)})];case 1:return t=e.sent(),[2,Promise.resolve(t)]}})})},P=function(t){return function(e){return function(n){return s.b(B,void 0,void 0,function(){var u,_,d,p,f,g,v,m,S,x=this;return s.d(this,function(B){switch(B.label){case 0:switch(n.type){case L.b:return[3,1];case h.a:return[3,2]}return[3,4];case 1:return i=n.payload&&n.payload.ServiceAddress,[2,e(n)];case 2:return u=e(n),_=t.getState(),t.dispatch(Object(D.b)({name:R.a.getTranslation("guest"),email:"",phone:"",nameIsEditable:!0,isBanned:!1})),Object(T.d)(_)?(d=Object(y.e)(_),[4,o.b.auth().catch(function(t){return console.error(t)})]):(console.warn("\u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0442\u0430\u0440\u0438\u0444\u0430"),[2]);case 3:return p=B.sent(),f=p[0],g=p[1],o.b.addListener(O.a.VISITOR,function(e,n){t.dispatch(Object(A.b)(n));var i=t.getState();d=Object(y.e)(i),o.b.initServices(d,function(){})}),c.a.setSite(f),t.dispatch(Object(A.b)(g)),Object(y.f)(t.getState())?[2]:(v=c.a.createCrossStorage("app-state"),m=function(t){return s.b(x,void 0,void 0,function(){var e,n,i,u,l=this;return s.d(this,function(_){switch(_.label){case 0:return e=t.getState(),d=Object(y.e)(e),[4,function(){return new Promise(function(t){o.b.initServices(d,})}()];case 1:return _.sent(),[4,o.b.send(new a.a.wapi.GetDialogState,function(t){var e=t.conversationId;return s.b(l,void 0,void 0,function(){return s.d(this,function(t){return null===e?(c.a.setDialog(null),[2]):(c.a.setDialog(new M.a(e,null)),[2])})})}).catch(];case 2:return n=_.sent(),Object(T.e)(t.getState())?(u=3,[3,5]):[3,3];case 3:return[4,k()];case 4:u=_.sent(),_.label=5;case 5:return i=u,t.dispatch(Object(r.b)(i)),[4,S()];case 6:return _.sent(),n.conversationId||v.setPermanently(b.a.STATE_KEY,I.b.LABEL),[2]}})})},S=function(){return s.b(x,void 0,void 0,function(){var t,e,n,r,a,o;return s.d(this,function(u){switch(u.label){case 0:return t=Object(N.a)(_),e=Object(C.a)(d.siteId,t.livetexUrl,c.a.getAppType()),n=e.type,r=e.responseType,a=e.payload,[4,l.a.publishPendingEvent(n,r,a)];case 1:return u.sent(),[4,F()];case 2:return(o=u.sent())?(o.restore(),function(t,e){var n=null,r="account:"+e.accountId+":site:"+e.siteId+":visitor:"+e.visitorId;if(t&&performance&&"function"==typeof performance.getEntries){var a=Object(w.a)("iframe",performance.getEntries()),o=navigator.language,c=navigator.userAgent;n=[s.a({debugEndpoint:i,id:r,userLang:o,userAgent:c},window.userGeoData)].concat(a)}else n=[{debugEndpoint:i,id:r}];l.a.publishEvent(E.s,n)}(window.isDebug,d),[2]):[2]}})})},Object(T.h)(t.getState())?(l.a.listenEvent("ltOmniButtonReady",function(){return s.b(x,void 0,void 0,function(){return s.d(this,})}),l.a.listenEvent("fallbackToLtWidget",,l.a.publishEvent("init-omnibutton")):m(t),[2,u]);case 4:return[2,e(n)]}})})}}}},"./src/redux-store/middlewares/storeActionsDebugMiddleware.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/io/request/widgets-api/util.ts"),r=n("./src/redux-store/actions/debug.ts"),a=function(){var t,e={correlationId:null,data:[]};return function(){return function(n){return function(a){var o=a.type,c=a.payload;if(o===r.b)t=c&&c.ServiceAddress;else if(o===r.a){if(!t)return n(a);var u=c.correlationId;e.correlationId=u;var l=JSON.stringify({correlationId:e.correlationId,data:JSON.stringify(e.data)});fetch("https://"+t+"/store",{method:"POST",body:l,headers:{Accept:"application/json","Content-Type":"application/json"}}).catch(function(t){return console.error("can't get access to debug endpoint",t)})}else{var _=i.a({timestamp:s.a.time(new Date)},a);e.data.push(_)}return n(a)}}}}},"./src/redux-store/reducers/account-settings/index.ts":function(t,e,n){"use strict";e.a=function(t,e){void 0===t&&(t=a);switch(e.type){case r.a:var n=e.payload[Object.keys(e.payload)[0]],o=n.site,c=n.phone_mask;return i.a({},t,{site:o,phoneMask:c});case s.a:var u=e.payload,l=u.callButtons,_=u.chatButtons,d=u.environment,p=u.features,f=u.hasGroup,g=u.invitationRules,v=u.label,h=u.members,E=u.servicesOffline,b=u.siteName;return i.a({},t,{callButtons:l,chatButtons:_,environment:d,features:p,hasGroup:f,invitationRules:g,label:v,members:h,servicesOffline:E,siteName:b});default:return t}};var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/redux-store/actions/init-transport.ts"),r=n("./src/redux-store/actions/set-account-settings.ts"),a={phoneMask:{holder:"",mask:""},site:{account:{can_use_voice:!1,sip_host:""},callback_available:!1,chat_available:!1,flag_enable_lid:!1,name:"",sound_group:0},callButtons:{},chatButtons:{},environment:"",features:{},hasGroup:!1,invitationRules:{},label:{},members:{},servicesOffline:!1,siteName:""}},"./src/redux-store/reducers/account-settings/selectors.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return a}),n.d(e,"g",function(){return o}),n.d(e,"f",function(){return c}),n.d(e,"e",function(){return u}),n.d(e,"h",function(){return _}),n.d(e,"c",function(){return d}),n.d(e,"d",function(){return p});var i=n("./src/settings/props.ts"),s=n("./src/util/browser/browser.ts"),r=function(t){return t.accountSettings.chatButtons},a=function(t){return t.accountSettings.invitationRules},o=function(t){var e=t.accountSettings.features;return e.lead.is_active&&!e.common.is_hidden_offline},c=function(t){return t.accountSettings.features.callback.is_active},u=function(t){var e=t.accountSettings.features.common.ai_bot_settings;return!(!e||!e.is_active)&&(Object.keys(e).length>1&&!!l(t))},l=function(t){var e=t.accountSettings.features.common.ai_bot_settings,n=e&&e.greeting_message;return n||null},_=function(t){var e=t.accountSettings.features.common.multibutton;return!!e&&(void 0===e.mobile_is_enabled&&void 0===e.desktop_is_enabled?e.is_active:s.a.isMobile()?!!i.a.isMobileWidget()&&e.mobile_is_enabled:e.desktop_is_enabled)},d=p=function(t){var e=t.accountSettings.features,n=e.chat,i=e.lead,s=e.callback,r=e.xwidget,a=e.quickCall,o=e.vk,c=e.telegram,u=e.viber;return n.is_active||i.is_active||s.is_active||r.is_active||a.is_active||o.is_active||c.is_active||u.is_active}},"./src/redux-store/reducers/application/index.ts":function(t,e,n){"use strict";e.a=function(t,e){void 0===t&&(t=r);switch(e.type){case s.a:return i.a({},t,{started:!0});default:return t}};var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/redux-store/actions/start-app.ts"),r={started:!1}},"./src/redux-store/reducers/availability/index.ts":function(t,e,n){"use strict";e.a=function(t,e){void 0===t&&(t=s);switch(e.type){case i.a:return e.payload;default:return t}};var i=n("./src/redux-store/actions/set-availability.ts"),s=0},"./src/redux-store/reducers/availability/selectors.ts":function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return c});var i=n("./src/settings/props.ts"),s=n("./src/app/states/states.ts"),r=n("./src/redux-store/reducers/visitor/selectors.ts"),a=n("./src/io/request/vnds/request.ts"),o=function(t){var e=i.a.getOnlineWidgetAvailabilityLevel(),n=t.availability,o=t.viewState;o!==s.b.DIALOG&&o!==s.b.DIALOG_HIDDEN||(e=[a.a.BUSY,a.a.FREE]);var c=Object(r.f)(t);return e.some(&&i.a.isChatEnabled()&&!c},c=function(t){return t.visitor.settings}},"./src/redux-store/reducers/env-settings/index.ts":function(t,e,n){"use strict";e.a=function(t,e){void 0===t&&(t=s);switch(e.type){case i.a:return e.payload.services;default:return t}};var i=n("./src/redux-store/actions/init-transport.ts"),s={}},"./src/redux-store/reducers/env-settings/selectors.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});n("./src/redux-store/reducers/visitor/selectors.ts");var i=,"./src/redux-store/reducers/index.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return _});var i=n("./node_modules/redux/es/redux.js"),s=n("./src/redux-store/reducers/availability/index.ts"),r=n("./src/redux-store/reducers/env-settings/index.ts"),a=n("./src/redux-store/reducers/view-state/index.ts"),o=n("./src/redux-store/reducers/application/index.ts"),c=n("./src/redux-store/reducers/account-settings/index.ts"),u=n("./src/redux-store/reducers/visitor/index.ts"),l=Object(i.combineReducers)({application:o.a,availability:s.a,envSettings:r.a,viewState:a.a,accountSettings:c.a,visitor:u.a}),_=,"./src/redux-store/reducers/view-state/index.ts":function(t,e,n){"use strict";e.a=function(t,e){void 0===t&&(t=s);switch(e.type){case i.a:return e.payload;default:return t}};var i=n("./src/redux-store/actions/set-view-state.ts"),s="Label"},"./src/redux-store/reducers/visitor/index.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/redux/es/redux.js"),s=n("./src/redux-store/reducers/visitor/settings/index.ts"),r=n("./src/redux-store/reducers/visitor/info/index.ts"),a=Object(i.combineReducers)({settings:s.a,info:r.a})},"./src/redux-store/reducers/visitor/info/index.ts":function(t,e,n){"use strict";e.a=function(t,e){void 0===t&&(t=a);switch(e.type){case s.a:var n=Object.entries(e.payload).filter(function(t){t[0];var e=t[1];return e}).reduce({});return i.a({},t,n);case r.a:var o=Object.values(e.payload)[0].is_banned,c=o||!1;return i.a({},t,{isBanned:c});default:return t}};var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/redux-store/actions/set-visitor-info.ts"),r=n("./src/redux-store/actions/set-account-settings.ts"),a={name:"",email:"",phone:"",nameIsEditable:!0,isBanned:!1}},"./src/redux-store/reducers/visitor/selectors.ts":function(t,e,n){"use strict";n.d(e,"d",function(){return i}),n.d(e,"e",function(){return s}),n.d(e,"f",function(){return r}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return o}),n.d(e,"a",function(){return c});var i=function(t){return t.visitor.info.name},s=r=function(t){return t.visitor.info.isBanned},a=function(t){return t.visitor.settings.allIds},o=function(t){return t.visitor.settings.siteId},c=,"./src/redux-store/reducers/visitor/settings/index.ts":function(t,e,n){"use strict";e.a=function(t,e){void 0===t&&(t=o);switch(e.type){case r.a:var n=e.payload,c=n.accountId,u=n.siteId;return i.a({},t,{accountId:String(c),siteId:String(u)});case a.a:var l=Object.keys(e.payload)[0],_=l.split(":"),d=_.slice(-1)[0],u=String(_[3]),c=String(_[1]);return s.a.isPrivateMode?(s.a.setItem("lt-"+u+"-visitor-id",d),s.a.setItem("lt-"+u+"-all-ids",l)):(localStorage.setItem("lt-"+u+"-visitor-id",d),localStorage.setItem("lt-"+u+"-all-ids",l)),i.a({},t,{visitorId:d,siteId:u,accountId:c,allIds:l});default:return t}};var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/serviceMemory.ts"),r=n("./src/redux-store/actions/init-transport.ts"),a=n("./src/redux-store/actions/set-account-settings.ts"),o={accountId:"",siteId:"",visitorId:"",allIds:""}},"./src/service/api/api.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./src/service/api/client-api.ts"),s=n("./src/service/api/external-analytics.ts"),r={start:function(t,e,n,r){new s.a(e);var a=new i.a(t,e,n,r);r.subscribe(a)}}},"./src/service/api/client-api.ts":function(t,e,n){"use strict";n.d(e,"b",function(){return D}),n.d(e,"a",;var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/app/states/states.ts"),o=n("./src/util/util.ts"),c=n("./src/util/date/date.ts"),u=n("./src/app/app.ts"),l=n("./src/data/data.ts"),_=n("./src/data/conversation-attribute-type.ts"),d=n("./src/data/contact-type.ts"),p=n("./src/data/member.ts"),f=n("./src/data/group.ts"),g=n("./src/data/invite.ts"),v=n("./src/data/feature.ts"),h=n("./src/e.js"),E=(n.n(h),n("./src/data/employee-status.ts")),b=n("./src/data/source-type.ts"),m=n("./src/settings/props.ts"),S=n("./src/io/response/types.ts"),I=n("./src/io/index.ts"),y=n("./src/io/api.ts"),A=n("./src/event-emitter/index.ts"),T=n("./src/service/api/events.ts"),O=n("./src/redux-store/reducers/visitor/selectors.ts"),L=n("./src/io/request/vnds/request.ts"),w=n("./src/app/app-types.ts"),C=n("./src/service/client-log/events.ts"),N="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b \u0437\u0430\u043f\u0440\u043e\u0441\u0430",D={EMPLOYEE_MESSAGE:"employee-message-sent",OFFLINE_MESSAGE:"offline-message-sent",EMPLOYEE_MESSAGE_SENT:"employee-message-sent",OFFLINE_MESSAGE_SENT:"offline-message-sent",CALLBACK_SENT:"callback-sent",CONVERSATION_STARTED:"conversation-started",CONVERSATION_CLOSED:"conversation-closed",CALL_STARTED:"call-started",CALL_ESTABLISHED:"call-established",X_WINDOW_SHOWN:"x-window-shown",INVITATION_WINDOW_SHOWN:"invitation-window-shown",INVITATION_WINDOW_CLOSE:"invitation-window-close",WELCOME_WINDOW_SHOWN:"welcome-window-shown",QUICK_CALL_CLICKED:"quick-call-clicked"},R=[h.e.s.api.SHOW_LABEL,h.e.s.api.HIDE_LABEL,h.e.s.api.SHOW_WELCOME_WINDOW,h.e.s.api.SHOW_CONVERSATION_WINDOW,h.e.s.api.SET_WELCOME_DEPARTMENTS,h.e.s.api.SET_CONVERSATION_ATTRIBUTES,h.e.s.api.SET_VISITOR_ATTRIBUTES,h.e.s.api.RESET_VIEW,h.e.w.chat.GO_OFFLINE,h.e.s.api.SHOW_X_WIDGET,h.e.s.api.SHOW_INVITE,h.e.s.api.HIDE_ACTIVE_WINDOW,h.e.s.api.SHOW_OFFLINE_DEPARTMENTS,h.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,h.e.s.api.SHOW_VK_LOGIN,h.e.s.x_widget.REMOVE_BUTTON,h.e.w.label.CHAT_CLICK,h.e.w.label.MOB_START_CHAT_CLICK],M=[h.e.s.api.CONVERSATION_STARTED,h.e.s.api.CONVERSATION_CLOSED,h.e.s.api.CALLBACK_SENT,h.e.s.api.EMPLOYEE_MESSAGE_SENT,h.e.s.api.OFFLINE_MESSAGE_SENT,h.e.s.api.CALL_STARTED,h.e.s.x_widget.SHOW_CALL_BY_VISITOR,h.e.s.api.X_WINDOW_SHOWN,h.e.s.api.INVITATION_WINDOW_SHOWN,h.e.s.api.INVITATION_WINDOW_CLOSED,h.e.s.dialog.WELCOME_DRAW];window.LiveTex=window.LiveTex?window.LiveTex:{};var x=B={},j=function(t){function e(e,n,i,s){var r=t.call(this,"client-api",x,B)||this;return r.listenEvents(n,M),r.publishEvents(e,R),r.registerApi(i),r.registerState(s),r.__mapToWindow(),r.onListeners(),r}return i.c(e,t),e.prototype.listenEvent=e.prototype.onListeners=function(){Object(r.a)(h.e.s.api.CONVERSATION_STARTED,e,this.listenEvent(D.CONVERSATION_STARTED)),Object(r.a)(h.e.s.api.CONVERSATION_CLOSED,e,this.listenEvent(D.CONVERSATION_CLOSED)),Object(r.a)(h.e.s.api.EMPLOYEE_MESSAGE_SENT,e,this.listenEvent(D.EMPLOYEE_MESSAGE_SENT)),Object(r.a)(h.e.s.api.OFFLINE_MESSAGE_SENT,e,this.listenEvent(D.OFFLINE_MESSAGE_SENT)),Object(r.a)(h.e.s.api.CALLBACK_SENT,e,this.listenEvent(D.CALLBACK_SENT)),Object(r.a)(h.e.s.api.CALL_STARTED,e,this.listenEvent(D.CALL_STARTED)),Object(r.a)(h.e.s.x_widget.SHOW_CALL_BY_VISITOR,e,this.listenEvent(D.CALL_ESTABLISHED)),Object(r.a)(h.e.s.api.X_WINDOW_SHOWN,e,this.listenEvent(D.X_WINDOW_SHOWN)),Object(r.a)(h.e.s.api.INVITATION_WINDOW_SHOWN,e,this.listenEvent(D.INVITATION_WINDOW_SHOWN)),Object(r.a)(h.e.s.api.INVITATION_WINDOW_CLOSED,e,this.listenEvent(D.INVITATION_WINDOW_CLOSE)),Object(r.a)(h.e.s.dialog.WELCOME_DRAW,e,function(t){this.listenEvent(D.WELCOME_WINDOW_SHOWN)({})})},e.prototype.onState=function(){A.a.publishEvent(T.a,this.getState())},e.prototype.onStateLeave=e.prototype.__mapToWindow=function(){var t=this;A.a.listenEvent(C.b.EVENTS.CALL_TO_CLICK,,A.a.publishEvent(T.D,D),A.a.publishEvent(T.L,l.d),A.a.publishEvent(T.C,E.a),A.a.publishEvent(T.E,b.a),A.a.publishEvent(T.F,b.a),A.a.publishEvent(T.B,_.a),A.a.publishEvent(T.z,d.a),A.a.listenEvent(T.u.SEND,function(){t.__reinit(function(){A.a.publishEvent(T.u.ONLOAD,!0)},}),A.a.listenEvent(T.M,function(){t.__showActiveWindow()}),A.a.listenEvent(T.h,function(){t.__hideActiveWindow()}),A.a.listenEvent(T.i,function(){t.__hideLabel()}),A.a.listenEvent(T.k,function(){t.__hideLabel()}),A.a.listenEvent(T.O,function(){t.__showLabel()}),A.a.listenEvent(T.T,function(){t.__showLabel()}),A.a.listenEvent(T.t,function(){t.__showWelcomeWindow()}),A.a.listenEvent(T.X,,A.a.listenEvent(T.P,function(e){var n=e.employeeId,i=e.departmentId,s=e.message;t.__showConversationWindow(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.Q,[!0].concat(t))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.Q,[!1].concat(t))},n,i,s)}),A.a.listenEvent(T.V,,A.a.listenEvent(T.l,,A.a.listenEvent(T.f,function(e){var n=e.filter;t.__getEmployees(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.g,[!0].concat(t))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.g,[!1].concat(t))},n)}),A.a.listenEvent(T.U,function(e){var n=e.groups;t.__showOfflineDepartments(n)}),A.a.listenEvent(T.N,function(e){var n=e.groups;t.__showCallRequestDepartments(n)}),A.a.listenEvent(T.Y,function(e){var n=e.schedule,i=e.employeeIds,s=e.message,r=e.phone;t.__showXWindow(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.Z,[!0].concat(t))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.Z,[!1].concat(t))},n,i,s,r)}),A.a.listenEvent(T.W,function(){t.publishEvent(h.e.s.api.SHOW_VK_LOGIN)}),A.a.listenEvent(T.m,function(e){var n=e.phone,i=e.employeeId,s=e.departmentId;t.__initiateCall(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.n,[!0].concat(t))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.n,[!1].concat(t))},n,i,s)}),A.a.listenEvent(T.R,function(e){var n=e.employeeId,i=e.departmentId,s=e.message;t.__showInvitationWindow(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.S,[!0].concat(t))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.S,[!1].concat(t))},n,i,s)}),A.a.listenEvent(T.j,function(){return t.__hideInvitationWindow()}),A.a.listenEvent(T.b,function(){return t.__getDepartments(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return A.a.publishEvent(T.c,t)})}),A.a.listenEvent(T.d,function(e){var n=e.departmentId;t.__isDepartmentOnline(String(n),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A.a.publishEvent(T.e,t)})}),A.a.listenEvent(T.o,function(e){var n=e.departmentId;return t.__isDepartmentAvailable(String(n),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return A.a.publishEvent(T.p,t)})}),A.a.listenEvent(T.q,function(e){var n=e.departmentId;return t.__isDepartmentOnline(String(n),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return A.a.publishEvent(T.r,t)})}),A.a.listenEvent(T.J,function(e){var n=e.departmentIds;return t.__setWelcomeDepartments(n,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return A.a.publishEvent(T.K,t)})}),A.a.listenEvent(T.A,,A.a.listenEvent(T.G,function(e){var n=e.attributes;return t.__setVisitorAttributes(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return A.a.publishEvent(T.H,[!0].concat(t))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return A.a.publishEvent(T.H,[!1].concat(t))},n)}),A.a.publishEvent(T.I,this.props.visitorId),A.a.listenEvent(T.x,function(e){var n=e.personId,i=e.attributes,s=e.hash;return t.__setAttributes(n,i,s,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return A.a.publishEvent(T.y,[!0].concat(t))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return A.a.publishEvent(T.y,[!1].concat(t))})})},e.prototype.__reinit=function(t,e){var n=this;this.__componentApi instanceof y.a?(o.a.clearStorage(o.a.isNonStateKey),this.__componentApi.reset(function(){n.publishEvent(h.e.s.api.RESET_VIEW),t()},e)):e()},e.prototype.__getEmployees=function(t,e,n){var i=this,s=n||{};if("function"!=typeof e)throw new Error(N);if("function"==typeof t&&Object(l.i)(s)){i.addApiListener(S.a.MEMBER_LIST,function e(n){i.removeApiListener(S.a.MEMBER_LIST,e);var r=[];if(n instanceof I.b.MembersList)for(var a=0,o=n.getMembers();a<o.length;a++){var c=o[a];Object(l.e)(c,s)&&r.push(c.serializeData(h.e.s.api.GET_EMPLOYEES))}t(r)});var r=new I.a.wapi.GetEmployees(s.departmentId);this.sendRequest(r)}else e(N)},e.prototype.__showOfflineDepartments=function(t){var e=this,n=t;Array.isArray(n)&&n.length?e.publishEvent(h.e.s.api.SHOW_OFFLINE_DEPARTMENTS,n):e.__getDepartments(function(t){e.publishEvent(h.e.s.api.SHOW_OFFLINE_DEPARTMENTS,t)})},e.prototype.__showCallRequestDepartments=function(t){var e=this,n=t;Array.isArray(n)&&n.length?e.publishEvent(h.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,n):e.__getDepartments(function(t){e.publishEvent(h.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,t)})},e.prototype.__showXWindow=function(t,e,n,i,s,r){var a={complete:t,cancel:e,phone:r?r.replace(/[\s()+-]/g,""):"",members:i,schedule:n,message:s};if("function"!=typeof e)throw new Error(N);"function"!=typeof t||"object"!=typeof n||!Object(l.j)(n)||i&&!(Array.isArray(i)&&i.length>0)||s&&"string"!=typeof s?e(N):r&&("string"!=typeof r||/[^\d]/.test(a.phone)||11!==a.phone.length)?e("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d"):this.publishEvent(h.e.s.api.SHOW_X_WIDGET,a)},e.prototype.__initiateCall=function(t,e,n,i,s){var r,a,o=this,u={};if(n="string"==typeof n?n.replace(/[\s()+-]/g,""):"","function"!=typeof e)throw new Error(N);if("function"!=typeof t||"string"!=typeof i||"string"!=typeof s||11!==n.length||/[^\d]/.test(n))e(N);else{var l=(a=m.a.getXWidgetMembers(),,_=function(){0===u.employee_ids.length?e("\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u0432"):(o.sendRequest(new I.a.livetex.InitiateCall(n,u)),o.publishEvent(h.e.s.api.CALL_STARTED),t())};u.widget_type="api",u.date=(new c.a).current(),u.schedule_time=0,u.employee_ids=(r=i)===p.a.ANY_MEMBER_ID?m.a.getXWidgetMembers():r.split(",").map(function(t){return parseInt(t,10)}).filter(l),s!==f.a.ANY_GROUP_ID?(u.group_id=s,o.__getEmployees(function(t){u.employee_ids=t.map(.filter(l).filter(,_()},e,{departmentId:s})):_()}},e.prototype.__showInvitationWindow=function(t,e,n,i,s){var r={complete:t,cancel:e};if("function"!=typeof e)throw new Error(N);if("function"==typeof t&&"string"==typeof s&&"string"==typeof n&&"string"==typeof i){var a=u.a.getSite(),o=new g.a("",!1),c={invite_text:s};c.feature=new v.a("",new p.a(n),new f.a(i,a)),o.populateData(c),r.invite=o,this.publishEvent(h.e.s.api.SHOW_INVITE,r)}else e(N)},e.prototype.__hideInvitationWindow=function(){this.getState()===a.b.INVITE&&this.transitState(a.a.CLOSE)},e.prototype.__getDepartments=function(t){this.asyncRequest(new I.a.wapi.GetOfflineAvailableGroups,S.a.OFFLINE_AVAILABLE_GROUPS,function(e){e instanceof I.b.OfflineAvailableGroups&&t(e.getGroups().map(function(t){return t.encodeData()}))})},e.prototype.__isDepartmentAvailable=function(t,e){this.asyncRequest(new I.a.wapi.GetChatAvailableGroups(L.a.FREE),S.a.CHAT_AVAILABLE_GROUPS,function(n){return n instanceof I.b.ChatAvailableGroups&&e(!!n.getGroups().filter(function(e){return e.getId()===t}).length),null})},e.prototype.__isDepartmentOnline=function(t,e){this.asyncRequest(new I.a.wapi.GetChatAvailableGroups(L.a.BUSY),S.a.CHAT_AVAILABLE_GROUPS,function(n){return n instanceof I.b.ChatAvailableGroups&&e(!!n.getGroups().filter(function(e){return e.getId()===t}).length),null})},e.prototype.__setWelcomeDepartments=function(t,e){t instanceof Array&&this.publishEvent(h.e.s.api.SET_WELCOME_DEPARTMENTS,t),e()},e.prototype.__setConversationAttributes=function(t,e){function n(t){return Object.keys(t||{}).reduce(function(e,n){var s;return i.a({},e,((s={})[n]=""+t[n],s))},{})}this.publishEvent(h.e.s.api.SET_CONVERSATION_ATTRIBUTES,{visible:n(t),hidden:n(e)})},e.prototype.__setVisitorAttributes=function(t,e,n){if("object"==typeof n&&Object(l.k)(n)){var i={complete:t,cancel:e,name:n.name,contacts:n.contacts};this.publishEvent(h.e.s.api.SET_VISITOR_ATTRIBUTES,i)}else e("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b \u0437\u0430\u043f\u0440\u043e\u0441\u0430")},e.prototype.__setAttributes=function(t,e,n,i,s){n=n||"",this.asyncRequest(new I.a.wapi.SetAttributes(e,n,t),S.a.SET_ATTRIBUTES,function(t){t instanceof I.b.SetAttributes&&i()},s)},e.prototype.__onEvent=e.prototype.__showActiveWindow=function(){if(this.getState()===a.b.LABEL||this.getState()===a.b.DIALOG_HIDDEN||this.getState()===a.b.CALL_REQUEST_HIDDEN||this.getState()===a.b.INVITE){if(u.a.getAppType()===w.a.MOBILE)return void this.publishEvent(h.e.w.label.MOB_START_CHAT_CLICK);this.publishEvent(h.e.w.label.CHAT_CLICK)}},e.prototype.__hideActiveWindow=function(){this.getState()===a.b.CALL_REQUEST||this.getState()===a.b.DIALOG?(this.transitState(a.a.HIDE),this.publishEvent(h.e.s.api.HIDE_ACTIVE_WINDOW)):this.getState()!==a.b.WELCOME&&this.getState()!==a.b.OFFLINE||(this.transitState(a.a.CLOSE),this.publishEvent(h.e.s.api.HIDE_ACTIVE_WINDOW))},e.prototype.__hideLabel=function(){this.publishEvent(h.e.s.api.HIDE_LABEL)},e.prototype.__showLabel=function(){this.publishEvent(h.e.s.api.SHOW_LABEL)},e.prototype.__showWelcomeWindow=function(){this.publishEvent(h.e.s.api.SHOW_WELCOME_WINDOW)},e.prototype.__showConversationWindow=function(t,e,n,i,s){var r=this,a=function(t){r.asyncRequest(new I.a.wapi.GetChatAvailableGroups(L.a.FREE),S.a.CHAT_AVAILABLE_GROUPS,function(e){e instanceof I.b.ChatAvailableGroups?t(e.getGroups()):t([])})},o=c=function(n,i){r.publishEvent(h.e.s.api.SHOW_CONVERSATION_WINDOW,{complete:t,cancel:e,employeeId:n,departmentId:i,initial_message:s,source_type:b.a.API,initial_member_message:s?"":l.a})};if("function"!=typeof e||"function"!=typeof t||"string"!=typeof n||"string"!=typeof i||"string"!=typeof s||!s.trim())throw new Error(N);n!==p.a.ANY_MEMBER_ID?a(function(t){var e=function(t,n){if(0!==t.length){var i=t[0],s=t.slice(1);r.__getEmployees(function(t){-1!==t.map(function(t){return t.id}).indexOf(n)?c(n,i):e(s,n)},function(){e(s,n)},{is_available:!0,departmentId:i})}else o()},i=t.map(function(t){return t.getId()});i.forEach(function(t,e,n){var i=Math.floor(Math.random()*n.length);n[e]=n[i],n[i]=t}),e(i,n)}):i!==f.a.ANY_GROUP_ID?this.__isDepartmentAvailable(i,function(t){t||o(),c(n,i)}):a(function(t){if(0!==t.length){var e=t[Math.floor(Math.random()*t.length)];c(n,e.getId())}else o()})},e.prototype.__showOfflineWindow=function(t){if(!("object"!=typeof t||"string"==typeof t.departmentId&&t.departmentId.length>0&&("string"==typeof t.employeeId&&t.employeeId.length>0||void 0===t.employeeId)))throw new Error(N);this.publishEvent(h.e.w.chat.GO_OFFLINE,t||{})},e}(s.a)},"./src/service/api/events.ts":function(t,e,n){"use strict";n.d(e,"D",function(){return i}),n.d(e,"L",function(){return s}),n.d(e,"C",function(){return r}),n.d(e,"E",function(){return a}),n.d(e,"F",function(){return o}),n.d(e,"B",function(){return c}),n.d(e,"z",function(){return u}),n.d(e,"R",function(){return l}),n.d(e,"S",function(){return _}),n.d(e,"u",function(){return d}),n.d(e,"M",function(){return p}),n.d(e,"h",function(){return f}),n.d(e,"i",function(){return g}),n.d(e,"k",function(){return v}),n.d(e,"O",function(){return h}),n.d(e,"T",function(){return E}),n.d(e,"t",function(){return b}),n.d(e,"X",function(){return m}),n.d(e,"P",function(){return S}),n.d(e,"Q",function(){return I}),n.d(e,"V",function(){return y}),n.d(e,"l",function(){return A}),n.d(e,"f",function(){return T}),n.d(e,"g",function(){return O}),n.d(e,"U",function(){return L}),n.d(e,"N",function(){return w}),n.d(e,"Y",function(){return C}),n.d(e,"Z",function(){return N}),n.d(e,"W",function(){return D}),n.d(e,"m",function(){return R}),n.d(e,"n",function(){return M}),n.d(e,"j",function(){return x}),n.d(e,"b",function(){return B}),n.d(e,"c",function(){return j}),n.d(e,"d",function(){return G}),n.d(e,"e",function(){return W}),n.d(e,"o",function(){return q}),n.d(e,"p",function(){return F}),n.d(e,"q",function(){return k}),n.d(e,"r",function(){return P}),n.d(e,"J",function(){return H}),n.d(e,"K",function(){return V}),n.d(e,"A",function(){return U}),n.d(e,"G",function(){return X}),n.d(e,"H",function(){return Y}),n.d(e,"s",function(){return K}),n.d(e,"a",function(){return Q}),n.d(e,"x",function(){return z}),n.d(e,"y",function(){return J}),n.d(e,"I",function(){return Z}),n.d(e,"v",function(){return $}),n.d(e,"w",function(){return tt});var i="client-api-set-events",s="client-api-set-widget-type",r="client-api-set-employee-status",a="client-api-set-source",o="client-api-set-source-type",c="client-api-set-conversation-attribute-type",u="client-api-set-contact-type",l="client-api-show-invitation-window",_="client-api-show-invitation-window-onload",d={SEND:"reinit-send",ONLOAD:"reinit-onload"},p="client-api-show-active-window",f="client-api-hide-active-window",g="client-api-hide-chat-label",v="client-api-hide-label",h="client-api-show-chat-label",E="client-api-show-label",b="client-api-open-welcome-window",m="client-api-show-welcome-window",S="client-api-show-conversation-window",I="client-api-show-conversation-window-onload",y="client-api-show-offline-window",A="client-api-show-x-button",T="client-api-get-employees",O="client-api-get-employees-complete",L="client-api-show-offline-departments",w="client-api-show-call-request-departments",C="client-api-show-x-window",N="client-api-show-x-window-onload",D="client-api-show-vk-button",R="client-api-initiate-call",M="client-api-initiate-call-onload",x="client-api-hide-invitation-window",B="client-api-get-departments",j="client-api-get-departments-onload",G="client-api-get-department-status",W="client-api-get-department-status-onload",q="client-api-is-department-available",F="client-api-is-department-available-onload",k="client-api-is-department-online",P="client-api-is-department-online-onload",H="client-api-set-welcome-departments",V="client-api-set-welcome-departments-onload",U="client-api-set-conversation-attributes",X="client-api-set-visitor-attributes",Y="client-api-set-visitor-attributes-onload",K="client-api-on-livetex-ready",Q="client-api-change-state",z="client-api-set-attributes",J="client-api-set-attributes-onload",Z="client-api-set-visitor-id",$="client-api-send-analytics-ga",tt="client-api-send-analytics-ya"},"./src/service/api/external-analytics.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return p});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/settings/props.ts"),o=n("./src/e.js"),c=(n.n(o),n("./src/service/api/client-api.ts")),u=n("./src/event-emitter/index.ts"),l=n("./src/service/api/events.ts"),_=n("./src/service/client-log/events.ts"),d=[o.e.s.api.CONVERSATION_STARTED,o.e.s.api.CONVERSATION_CLOSED,o.e.s.api.EMPLOYEE_MESSAGE_SENT,o.e.s.api.OFFLINE_MESSAGE_SENT,o.e.s.api.CALLBACK_SENT,o.e.s.api.CALL_STARTED,o.e.s.x_widget.SHOW_CALL_BY_VISITOR,o.e.s.api.X_WINDOW_SHOWN,o.e.s.api.INVITATION_WINDOW_SHOWN,o.e.s.api.INVITATION_WINDOW_CLOSED,o.e.s.dialog.WELCOME_DRAW],p=function(t){function e(e){var n=t.call(this,"external-analytics")||this;return n.listenEvents(e,d),u.a.listenEvent(_.b.EVENTS.CALL_TO_CLICK,,n}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e.prototype.__send=function(t){a.a.isYandexMetrikaEnabled()&&u.a.publishEvent(l.w,t),a.a.isGoogleAnalyticsEnabled()&&u.a.publishEvent(l.v,t)},e.handleEvent=e}(s.a);Object(r.a)(o.e.s.api.CONVERSATION_STARTED,p,p.handleEvent(c.b.CONVERSATION_STARTED)),Object(r.a)(o.e.s.api.CONVERSATION_CLOSED,p,p.handleEvent(c.b.CONVERSATION_CLOSED)),Object(r.a)(o.e.s.api.EMPLOYEE_MESSAGE_SENT,p,p.handleEvent(c.b.EMPLOYEE_MESSAGE_SENT)),Object(r.a)(o.e.s.api.OFFLINE_MESSAGE_SENT,p,p.handleEvent(c.b.OFFLINE_MESSAGE_SENT)),Object(r.a)(o.e.s.api.CALLBACK_SENT,p,p.handleEvent(c.b.CALLBACK_SENT)),Object(r.a)(o.e.s.api.CALL_STARTED,p,p.handleEvent(c.b.CALL_STARTED)),Object(r.a)(o.e.s.x_widget.SHOW_CALL_BY_VISITOR,p,p.handleEvent(c.b.CALL_ESTABLISHED)),Object(r.a)(o.e.s.api.X_WINDOW_SHOWN,p,p.handleEvent(c.b.X_WINDOW_SHOWN)),Object(r.a)(o.e.s.api.INVITATION_WINDOW_SHOWN,p,p.handleEvent(c.b.INVITATION_WINDOW_SHOWN)),Object(r.a)(o.e.s.api.INVITATION_WINDOW_CLOSED,p,p.handleEvent(c.b.INVITATION_WINDOW_CLOSE)),Object(r.a)(o.e.s.dialog.WELCOME_DRAW,p,p.handleEvent(c.b.WELCOME_WINDOW_SHOWN))},"./src/service/buttons/buttons.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return h});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/e.js"),o=(n.n(a),n("./src/service/buttons/util.ts")),c=n("./src/service/buttons/condition.ts"),u=n("./src/app/states/states.ts"),l=n("./src/io/response/types.ts"),_=n("./src/io/index.ts"),d=n("./src/redux-store/reducers/availability/selectors.ts"),p=n("./src/redux-store/reducers/account-settings/selectors.ts"),f=[a.e.s.buttons.DRAW_BUTTON],g=[a.e.w.buttons.BUTTON_CHAT_CLICK,a.e.w.buttons.BUTTON_DRAW],v=function(t){return{isAvailableChat:Object(d.b)(t),isFeedbackFromSiteActive:Object(p.g)(t),isCallbackActive:Object(p.f)(t),chatButtons:Object(p.a)(t)}},h=function(t){function e(e,n,i,s){var r=t.call(this,"buttons",v)||this;return r.listenEvents(e,g),r.publishEvents(n,f),r.registerApi(i),r.registerState(s),r.__settings=r.props.chatButtons,r.__buttons=r.__createButtons(r.__settings),r.__prevProps=r.props,r.__buttons.length>0&&r.draw(),r}return i.c(e,t),e.prototype.updateReduxState=function(t){this.__buttons.length>0&&(this.__shouldUpdateButtonView(t,this.__prevProps)&&this.draw(),this.__prevProps=t)},e.prototype.__shouldUpdateButtonView=function(t,e){return Object.keys(t).map(function(n){return t[n]===e[n]}).includes(!1)},e.prototype.draw=function(){var t=this.__sortButtons(this.__buttons),e=t.length>0?t[0]:[],n=t.length>1?t[1]:[];this.__drawButtons(n),this.__drawRoutedButtons(e)},e.start=function(t,n,i,s){new e(t,n,i,s)},e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e.prototype.__sortButtons=function(t){return t.reduce(function(t,e){return e.hasRoute()?(t[0]||(t[0]=[]),t[0].push(e)):(t[1]||(t[1]=[]),t[1].push(e)),t},[])},e.prototype.__createButtons=function(t){var e=[];for(var n in t)e.push(new c.a("chat",t[n]));return e},e.prototype.__drawButtons=function(t){var e=this,n=this;void 0!==t&&t.forEach(function(t){t.setStatus(e.props.isAvailableChat),n.publishEvent(a.e.s.buttons.DRAW_BUTTON,Object(o.a)(t))})},e.prototype.__drawRoutedButtons=function(t){if(t){for(var e=this,n={},i=0,s=t.length;i<s;i+=1){var r=t[i].getFeature().getGroup().getId();n[r]||(n[r]=[]),n[r].push(t[i])}this.asyncRequest(new _.a.wapi.GetChatAvailableGroups,l.a.CHAT_AVAILABLE_GROUPS,function(t){var i=t.getGroups().map(function(t){return t.getId()}),s=function(t){n[t].forEach(function(n){var s=-1!==i.indexOf(t);e.__updateButton(n,s)})};for(var r in n)s(r)})}},e.prototype.__updateButton=function(t,e){var n=this.props.isAvailableChat;t.setStatus(n&&e),this.publishEvent(a.e.s.buttons.DRAW_BUTTON,Object(o.a)(t))},e}(s.a);Object(r.a)(a.e.w.buttons.BUTTON_DRAW,h,function(){this.storeEventLog(new _.a.event.ShowChatButton)}),Object(r.a)(a.e.w.buttons.BUTTON_CHAT_CLICK,h,function(t){this.storeEventLog(new _.a.event.ClickChatButton);var e=this;"true"===t.status?(this.getState()===u.b.CALL_REQUEST_HIDDEN&&this.transitState(u.a.DIALOG),t.group?this.transitState(u.a.BUTTON_DIALOG,t):this.asyncRequest(new _.a.wapi.GetChatAvailableGroups,l.a.CHAT_AVAILABLE_GROUPS,function(n){var i=n.getGroups();if(i.length>0){var s=i[Math.floor(Math.random()*i.length)];t.group=s.getId(),e.transitState(u.a.BUTTON_DIALOG,t)}})):this.props.isFeedbackFromSiteActive?this.transitState(u.a.OFFLINE):this.props.isCallbackActive?this.transitState(u.a.CALL_REQUEST):console.warn("No active offline form available")})},"./src/service/buttons/condition.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./src/data/group.ts"),s=n("./src/data/member.ts"),r=n("./src/data/factory/factory.ts"),a=n("./src/app/app.ts"),o=function(){function t(t,e){this.__id=e.id,this.__type=t,this.__size=e.size,this.__status=!1,this.__text=e.text,this.__routing=this.__buildRoutes(e.routing)}return t.prototype.__buildRoutes=function(t){var e={};return e.group_id=t.department_id||"",e.member_id=t.operator_id||"",""===e.group_id&&""===e.member_id?null:(e.group_id=""===e.group_id?i.a.ANY_GROUP_ID:e.group_id,e.member_id=""===e.member_id?s.a.ANY_MEMBER_ID:e.member_id,e)},t.prototype.getId=function(){return this.__id},t.prototype.getSize=function(){return this.__size},t.prototype.getMember=function(){return this.__routing.member_id},t.prototype.getGroup=function(){return this.__routing.group_id},t.prototype.hasRoute=t.prototype.getFeature=function(){return r.a.createFeature(this.__type,this.__routing.member_id,this.__routing.group_id,a.a.getSite())},t.prototype.getStatus=function(){return this.__status},t.prototype.setStatus=function(t){this.__status=t},t.prototype.getText=function(){return this.__text},t}()},"./src/service/buttons/util.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./src/service/buttons/condition.ts"),s=function(t){var e={};return t instanceof i.a&&(e.online=t.getStatus(),e.offline=!t.getStatus(),e.button_id=t.getId(),e.button_size=t.getSize(),""!==t.getText()&&(e.text=t.getText()),t.hasRoute()&&(e.group_id=t.getGroup(),e.member_id=t.getMember())),e}},"./src/service/client-log/client-log.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return u});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/service/client-log/events.ts"),o=n("./src/io/index.ts"),c=[a.b.EVENTS.CALL_REQUEST_SEND,a.b.EVENTS.COMPLAINT_CLICK,a.b.EVENTS.CALL_INVITE_CLICK,a.b.EVENTS.CHAT_INVITE_CLICK,a.b.EVENTS.CLOSE_INVITE_CLICK,a.b.EVENTS.X_BUTTON_CLOSE_CLICK,a.b.EVENTS.X_BUTTON_CALL_CLICK,a.b.EVENTS.X_WIDGET_CLOSE_CLICK,a.b.EVENTS.X_WIDGET_CALL_CLICK,a.b.EVENTS.X_BUTTON_CLICK,a.b.EVENTS.CALL_TO_CLICK,a.b.EVENTS.MOB_INVITATION_CLICK,a.b.EVENTS.MOB_CALL_TO_SHOW,a.b.EVENTS.MOB_CALL_REQUEST_SHOW,a.b.EVENTS.MOB_LABEL_CALL_REQUEST_CLICK,a.b.EVENTS.OFFLINE_SEND],u=function(t){function e(e,n,i,s){var r=t.call(this,"client-log")||this;return r.listenEvents(e,c),r.registerApi(i),r}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e.start=function(t,n,i,s){new e(t,n,i,s)},e}(s.a);Object(r.a)(a.b.EVENTS.COMPLAINT_CLICK,u,function(){this.storeEventLog(new o.a.event.ClickComplaint)}),Object(r.a)(a.b.EVENTS.CALL_INVITE_CLICK,u,function(){this.storeEventLog(new o.a.event.ClickInvitationCallRequest)}),Object(r.a)(a.b.EVENTS.CHAT_INVITE_CLICK,u,function(t){this.storeEventLog(new o.a.event.ClickInvitationSend(t.id||""))}),Object(r.a)(a.b.EVENTS.CLOSE_INVITE_CLICK,u,function(){this.storeEventLog(new o.a.event.ClickInvitationClose)}),Object(r.a)(a.b.EVENTS.X_BUTTON_CLOSE_CLICK,u,function(){this.storeEventLog(new o.a.event.ClickXWidgetButtonClose)}),Object(r.a)(a.b.EVENTS.X_BUTTON_CALL_CLICK,u,function(t){this.storeEventLog(new o.a.event.ClickXWidgetButtonSend(t.id||""))}),Object(r.a)(a.b.EVENTS.X_WIDGET_CLOSE_CLICK,u,function(){this.storeEventLog(new o.a.event.ClickXWidgetWindowClose)}),Object(r.a)(a.b.EVENTS.X_WIDGET_CALL_CLICK,u,function(t){this.storeEventLog(new o.a.event.ClickXWidgetWindowSend(t.id||""))}),Object(r.a)(a.b.EVENTS.X_BUTTON_CLICK,u,function(){this.storeEventLog(new o.a.event.ClickXWidgetButton)}),Object(r.a)(a.b.EVENTS.CALL_TO_CLICK,u,function(){this.storeEventLog(new o.a.event.ClickCallTo)}),Object(r.a)(a.b.EVENTS.MOB_INVITATION_CLICK,u,function(t){this.storeEventLog(new o.a.event.ClickInvitationSend(t.id||""))}),Object(r.a)(a.b.EVENTS.MOB_CALL_TO_SHOW,u,function(){this.storeEventLog(new o.a.event.ShowCallTo)}),Object(r.a)(a.b.EVENTS.OFFLINE_SEND,u,function(){this.storeEventLog(new o.a.event.ClickOfflineSend)})},"./src/service/client-log/events.ts":function(t,e,n){"use strict";n.d(e,"b",function(){return s}),n.d(e,"a",function(){return r});var i=n("./node_modules/@livetex/piper/lib/index.js"),s=(n.n(i),{}),r={};s.EVENTS=i.s.clientLog.EVENTS,s.HELPER_EVENTS=i.s.clientLog.HELPER_EVENTS,r.EVENTS={VK_LOGIN_STATUS:"capi-vk-login-status",START_CHAT_VK:"capi-start-chat-vk"}},"./src/service/dialog/behavior.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return k}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return V});var i,s=n("./node_modules/tslib/tslib.es6.js"),r=n("./src/core/component.ts"),a=n("./src/core/macros.ts"),o=n("./src/tabs/tabs.ts"),c=n("./src/tabs/event-type.ts"),u=n("./src/util/util.ts"),l=n("./src/app/states/states.ts"),_=n("./src/store/storage.ts"),d=n("./src/app/app.ts"),p=n("./src/settings/props.ts"),f=n("./src/data/message-type.ts"),g=n("./src/data/dialog.ts"),v=n("./src/data/member.ts"),h=n("./src/data/group.ts"),E=n("./src/data/factory/factory.ts"),b=n("./src/data/data.ts"),m=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),S=(n.n(m),n("./src/e.js")),I=(n.n(S),n("./modules/oldmodules.js")),y=(n.n(I),n("./src/logger/logger.ts")),A=n("./src/service/dialog/shared-behavior.ts"),T=n("./src/service/dialog/dialog.ts"),O=n("./src/data/source-type.ts"),L=n("./src/io/response/types.ts"),w=n("./src/io/response/dialog-unavailable-types.ts"),C=n("./src/io/response/dialog-unavailable.ts"),N=n("./src/io/response/dialog.ts"),D=n("./src/io/request/widgets-api/util.ts"),R=n("./src/io/index.ts"),M=n("./src/redux-store/reducers/availability/selectors.ts"),x=n("./src/redux-store/actions/set-visitor-info.ts"),B=n("./src/redux-store/reducers/visitor/selectors.ts"),j=n("./src/service/prechats.ts"),G=n("./src/io/response/index.ts"),W=n("./src/redux-store/reducers/account-settings/selectors.ts"),q=[S.e.w.label.CHAT_CLICK,S.e.w.chat.REOPEN_CHAT,S.e.w.chat.GO_TO_CHAT,S.e.w.chat.GO_OFFLINE,S.e.w.chat.CHAT_CLOSE,S.e.w.chat.COMPLAINT_VIEW,S.e.w.chat.RESELECT_MEMBER,S.e.w.chat.RECONNECT_API,S.e.w.offline.CHAT_CLOSE,S.e.w.chat.STORE_SYSTEM_MESSAGE,S.e.s.api.SHOW_WELCOME_WINDOW,S.e.s.api.SHOW_CONVERSATION_WINDOW,S.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,S.e.w.invite.CALL_BACK_CLICK,S.e.w.chat.TRANSFER_CHAT_TO_AIBOT],F=[S.e.s.dialog.WELCOME_DRAW,S.e.s.dialog.S_COMPLAINT_VIEW,S.e.s.dialog.CHAT_DRAW,S.e.s.dialog.OPEN_CHAT,S.e.s.dialog.MESSAGE,S.e.s.dialog.TOGGLE_INPUT,S.e.s.dialog.CLEAR_FALLBACK,S.e.s.dialog.CHAT_DRAW_LOG,S.e.s.dialog.CLICK_CHAT_ASK_QUESTION_LOG,S.e.s.dialog.CLICK_CHAT_RESELECT_MEMBER_LOG,S.e.s.dialog.CLICK_REOPEN_CHAT_LOG,S.e.s.dialog.SHOW_RATE,S.e.s.site.LABEL_DRAW,S.e.s.offline.HIDE_INVITE,S.e.s.api.CONVERSATION_STARTED,S.e.s.api.CONVERSATION_CLOSED,S.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,S.e.s.api.HIDE_ACTIVE_WINDOW],k="dialog-status";!function(t){t.NOT_OPENED="not-opened",t.OPENED="opened",t.CLOSED="closed",t.FORCE_REOPEN="force-reopen",t.REOPEN="reopen"}(i||(i={}));var P=function(t){return{isAvailableChat:Object(M.b)(t),visitorName:Object(B.d)(t),isBanned:Object(B.f)(t),visitorId:Object(B.b)(t),isBotEnabled:Object(W.e)(t)}},H={setVisitorInfo:x.b},V=function(t){function e(e,n,s,r,a){var p=t.call(this,T.c,P,H)||this;p.listenEvents(e,q),p.publishEvents(n,F),p.registerApi(s),p.__api=s,p.__dialog=d.a.getDialog(),p.__storage=a,p.__hasHistory=!1,p.__mobileInit=r.getState()===l.b.DIALOG,p.__firstMessage=null,p.__alreadySendFM=!1,p.__reconnectTry=0,p.__fromState="";var f=p;return p.__storage.onInit(function(){f.__getDialogStatus()===_.b.NO_DATA&&f.__setDialogStatus(i.NOT_OPENED)}),p.__api.setDisconnectHandler(p.__disconnect.bind(p)),p.addApiListener(L.a.CHAT_CLOSED,function(t){t instanceof G.ChatClosed&&f.publishEvent(S.e.s.api.CONVERSATION_CLOSED,{conversation_id:t.getConversationId()})}),p.addApiListener(L.a.DIALOG_UNAVAILABLE,function(t){if(t instanceof C.a){var e=t.getError();e!==w.a.NO_MEMBER&&e!==w.a.VISITOR_IS_BANNED&&e!==w.a.NULL_ENTITY||f.__dialogUnavailable()}}),p.addApiListener(L.a.DIALOG,function(t){t instanceof N.a&&(f.__dialog=t.getDialog(),f.publishEvent(S.e.s.dialog.CLEAR_FALLBACK),!f.__alreadySendFM&&f.__firstMessage&&(f.sendRequest(new R.a.wapi.TextMessage(f.__firstMessage)),f.__alreadySendFM=!0),f.__getDialogStatus()===i.NOT_OPENED&&f.__onConversationStarted(t.getDialog()))}),p.addApiListener(L.a.CHAT_AVAILABLE_GROUPS,function(t){if(t instanceof R.b.ChatAvailableGroups&&f.getState()===l.b.WELCOME){var e=f.__storage.get(A.a);e instanceof Array&&e.length>0?f.__openWelcomeWithAssignedGroups(t.getGroups(),e):f.__showWelcome(t.getGroups())}}),p.addApiListener(L.a.HAS_CHAT,,p.addApiListener(L.a.VISITOR_BAN,,p.addApiListener(L.a.RESET_STATE,,o.a.addEventListener(c.a.RECONNECT,p.__tryToReconnect.bind(p)),o.a.addEventListener(c.a.SYNC_TABS,function(){o.a.dispatch(c.a.RECONNECT)}),document.addEventListener("visibilitychange",function(){var t=d.a.getDialog();"visible"===document.visibilityState&&d.a.isMobileType()&&t&&p.sendRequest(new R.a.wapi.MessageHistory(t.getConversationId()))}),p}return s.c(e,t),e.prototype.__tryToReconnect=function(){var t=this;t.__api.reConnect(function(){t.__reconnectTry=0,t.__setDialogStatus(i.OPENED);var e=t.__loadDialog();if(null!==e){var n=e.getConversationId();d.a.setDialog(e),t.sendRequest(new R.a.wapi.MessageHistory(n))}},u.a.nop)},e.prototype.onState=function(t,e){t===l.b.WELCOME?(this.__fromState=e.fromState,this.publishEvent(S.e.s.site.LABEL_HIDE),this.__openWelcome()):t===l.b.DIALOG_HIDDEN?this.publishEvent(S.e.s.site.LABEL_DRAW,{chat_available:this.props.isAvailableChat}):t===l.b.DIALOG&&(d.a.isMobileType()&&this.__mobileInit&&(this.transitState(l.a.HIDE),this.__mobileInit=!1),this.__setDialogRequest(e||null),this.__startDialog())},e.prototype.onStateLeave=function(){},e.prototype.__openWelcomeWithAssignedGroups=function(t,e){var n=this.__filterGroups(t,e);n.length>0?this.__showWelcome(n):this.__dialogUnavailable()},e.prototype.__showWelcome=function(t){this.storeEventLog(new R.a.event.ShowWelcome);var e=t.map(function(t){return t.encodeData()});this.publishEvent(S.e.s.dialog.WELCOME_DRAW,{fromState:this.__fromState,groups:e})},e.prototype.__filterGroups=function(t,e){var n=[];function i(t){return function(e){return e.getId()===t}}for(var s=0,r=e.length;s<r;s+=1){var a=t.filter(i(e[s]));a.length&&n.push(a.shift())}return n},e.prototype.__openComplaint=function(){this.storeEventLog(new R.a.event.ShowComplaint),this.publishEvent(S.e.s.dialog.S_COMPLAINT_VIEW,!0)},e.prototype.__openWelcome=function(){this.props.isAvailableChat?this.sendRequest(new R.a.wapi.GetChatAvailableGroups):(this.__dialogUnavailable(),y.a.info("Offline member in dialog.Behavior",this))},e.prototype.__dialogUnavailable=function(){if(p.a.isNewBillingEnabled()&&p.a.isLeadEnabled()&&!p.a.isHiddenOffline()||!p.a.isNewBillingEnabled()&&!p.a.isHiddenOffline())this.transitState(l.a.OFFLINE),this.publishEvent(S.e.s.dialog.OPEN_CHAT,S.e.w.chat.GO_OFFLINE);else if(p.a.isCallbackEnabled())this.transitState(l.a.CALL_REQUEST);else if(this.getState()===l.b.DIALOG){var t=f.a.ALL_OP_OFFLINE,e=E.a.createMessage(u.a.generateId(),t),n=this;this.__requestHistory(function(){n.__chatDraw(),n.publishEvent(S.e.s.dialog.MESSAGE,e.encodeData()),n.publishEvent(S.e.s.dialog.TOGGLE_INPUT,!1)})}else this.publishEvent(S.e.s.api.HIDE_ACTIVE_WINDOW)},e.prototype.__chatDraw=function(){p.a.isOneClickInviteEnabled()||this.publishEvent(S.e.s.offline.HIDE_INVITE),this.publishEvent(S.e.s.dialog.CHAT_DRAW),this.storeEventLog(new R.a.event.ShowChat),this.publishEvent(S.e.s.site.LABEL_HIDE)},e.prototype.__transferDialog=function(){var t=this.__dialog.getGroup().getId(),e=this.__dialog.getConversationId();this.publishEvent(S.e.s.dialog.TOGGLE_INPUT,!0),this.sendRequest(new R.a.wapi.TransferChat(t,e))},e.prototype.__transferChatToBot=function(){var t=this.__dialog.getConversationId();this.sendRequest(new R.a.wapi.TransferChatToAIBot(t))},e.prototype.__startDialog=function(){var t=this,e=this.__getDialogRequestData();function n(e){void 0===e&&(e=function(){});var n=e||u.a.nop;t.__requestHistory(function(){t.getState()===l.b.DIALOG&&(t.publishEvent(S.e.s.dialog.OPEN_CHAT),p.a.isVoteEnabled()&&t.publishEvent(S.e.s.dialog.SHOW_RATE),t.__chatDraw()),n()})}function s(){n(),t.__setDialogStatus(i.OPENED)}if(e instanceof Object)switch(this.__getDialogStatus()){case i.NOT_OPENED:this.__hasHistory=!1,this.__requestDialog(e,s);break;case i.OPENED:this.__dialog=this.__loadDialog(),n();break;case i.CLOSED:n();break;case i.FORCE_REOPEN:e.force=!0,this.__requestDialog(e,s);break;case i.REOPEN:e.invite="",this.__requestDialog(e,s)}else y.a.error("Incorrect dialog request: "+e,this)},e.prototype.__getInitialMessage=function(t){var e=t.started_by&&"button"===t.started_by,n=t.source_type===O.a.API&&void 0===t.initial_message;return p.a.needToDefaultInitialMessage()&&(e||n)?b.a:""},e.prototype.__requestDialog=function(t,e){var n=this;this.__sendSetName();var i=this.__extractInvitationMessage(t);this.addApiListener(L.a.DIALOG,function r(a){if(a instanceof N.a){n.__dialog=a.getDialog(),n.__dialog.getMessagesList().addMessage(i),n.__initFirstMessage(n.__getInitialMessage(t),a.getDialog().getConversationId()),n.removeApiListener(L.a.DIALOG,r);var o=s.group;n.__dialog.setGroup(new h.a(o,d.a.getSite())),n.__storage.set(T.a,I.sm.serializeEntity(n.__dialog,"storage")),n.sendRequest(new R.a.vnds.WatchGroup(o)),e()}});var s=this.__buildCommunicationAttrs(t),r=Object(j.a)(t.prechats);if(this.__isInvitationRequest(t)&&i){var a=this.__buildInvitationAttrs(t,i);this.sendRequest(new R.a.wapi.InviteToSiteChat(s,r,a))}else if("button"===t.started_by){var o=E.a.createInviteMessage(this.__getInitialMessage(t));a=this.__buildInvitationAttrs(t,o);this.sendRequest(new R.a.wapi.InviteToSiteChat(s,r,a))}else this.sendRequest(new R.a.wapi.CreateSiteChat(s,r))},e.prototype.__buildCommunicationAttrs=function(t){var e=this.props.isBotEnabled?t.group:t.group||null,n=t.member;if(n=n&&n!==v.a.ANY_MEMBER_ID?n:null,null!=e){var i=d.a.createSubject(e);return D.a.createCommunicationAttrs(this.props.visitorName,e,i,n)}throw new Error("Can't create dialog when group is null")},e.prototype.__extractInvitationMessage=function(t){var e=t.invite;return e?E.a.createInviteMessage(u.a.decodeBase64(e)):null},e.prototype.__buildInvitationAttrs=function(t,e){var n=t.id,i=new m.model.TextChatMessage(e.getId(),e.getText());return new m.model.InvitationAttrs(n,i)},e.prototype.__isInvitationRequest=function(t){return t.invite&&t.id},e.prototype.__initFirstMessage=function(t,e){},e.prototype.__requestHistory=function(t){var e=this;!this.__hasHistory&&e.__dialog?(this.addApiListener(L.a.MESSAGE_HISTORY,function n(){e.removeApiListener(L.a.MESSAGE_HISTORY,n);t()}),this.sendRequest(new R.a.wapi.MessageHistory(e.__dialog.getId())),this.__hasHistory=!0):t()},e.prototype.__sendSetName=function(){this.props.visitorName!==u.a.getTranslation("guest")&&this.sendRequest(new R.a.livetex.SetName(this.props.visitorName))},e.prototype.__disconnect=function(t){if(this.getState()===l.b.DIALOG||this.getState()===l.b.DIALOG_HIDDEN){if(this.__reconnectTry<1&&!t)return this.__reconnectTry+=1,this.__tryToReconnect();this.publishEvent(S.e.s.dialog.MESSAGE,E.a.createMessage(u.a.generateId(),f.a.DISCONNECT).encodeData()),this.publishEvent(S.e.s.dialog.TOGGLE_INPUT,!1)}},e.prototype.__onConversationStarted=function(t){var e=this,n=this.__getDialogRequestData();var i={source:n.invite?{type:O.a.SYSTEM,id:u.a.generateId()}:n.source_type===O.a.API?{type:O.a.API,id:u.a.generateId()}:{type:O.a.VISITOR,id:e.props.visitorId},widget_type:n.invite?b.d.INVITATION_WINDOW:n.source_type===O.a.API?b.d.CONVERSATION_WINDOW:"button"===n.started_by?b.d.BUTTON:b.d.WELCOME_WINDOW,conversation_attributes:n.prechats||[]};this.publishEvent(S.e.s.api.CONVERSATION_STARTED,i)},e.prototype.__getDialogRequestData=function(){var t=this.__getDialogRequest();return t&&t instanceof Object&&(t.prechats=Object(j.b)(t.prechats||[])),t},e.prototype.__getDialogRequest=e.prototype.__loadDialog=function(){var t=this.__storage.get(T.a);if(t instanceof Object){var e=I.sm.reconstructEntity(t,"storage");if(e instanceof g.a)return e}return null},e.prototype.__setDialogRequest=function(t){if(t&&t instanceof Object){var e=Object.assign({},t,{message:t.message?"":void 0,initial_message:t.initial_message?"":void 0});this.__storage.set("dialog-request",e)}},e.prototype.__getDialogStatus=e.prototype.__setDialogStatus=function(t){this.__storage.set(k,t)},e.prototype.updateReduxState=function(){},e}(r.a);Object(a.a)(S.e.w.chat.GO_TO_CHAT,V,function(t){this.storeEventLog(new R.a.event.ClickWelcomeSend),this.props.isAvailableChat?(this.__setDialogStatus(i.NOT_OPENED),this.actionCreators.setVisitorInfo({name:t.name,nameIsEditable:t.name_editable,email:t.email,phone:t.phone_number,isBanned:t.is_banned}),this.transitState(l.a.DIALOG,t),this.publishEvent(S.e.s.dialog.OPEN_CHAT,l.a.DIALOG)):p.a.isLeadEnabled()&&!p.a.isHiddenOffline()?(this.transitState(l.a.OFFLINE),this.publishEvent(S.e.s.dialog.OPEN_CHAT,l.a.OFFLINE)):(this.transitState(l.a.CLOSE),this.publishEvent(S.e.s.api.HIDE_ACTIVE_WINDOW))}),Object(a.a)(S.e.w.chat.CHAT_CLOSE,V,function(){var t=this;!function(e){switch(e){case l.b.WELCOME:t.storeEventLog(new R.a.event.ClickWelcomeClose);break;case l.b.DIALOG:t.storeEventLog(new R.a.event.ClickChatClose);break;case l.b.OFFLINE:t.storeEventLog(new R.a.event.ClickOfflineClose)}}(this.getState()),this.getState()===l.b.DIALOG?this.transitState(l.a.HIDE):this.getState()===l.b.WELCOME&&this.transitState(l.a.CLOSE)}),Object(a.a)(S.e.w.offline.CHAT_CLOSE,V,function(){this.transitState(l.a.CLOSE_FROM_CHAT)}),Object(a.a)(S.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,V,function(t){this.publishEvent(S.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,t)}),Object(a.a)(S.e.w.label.CHAT_CLICK,V,function(){if(this.getState()===l.b.CALL_REQUEST_HIDDEN)return p.a.isOmnibuttonEnabled()?void this.transitState(l.a.CONTINUE_DIALOG):void this.transitState(l.a.SHOW,!0);this.transitState(l.a.SHOW)}),Object(a.a)(S.e.w.chat.REOPEN_CHAT,V,,Object(a.a)(S.e.w.chat.GO_OFFLINE,V,function(t){p.a.isLeadEnabled()&&!p.a.isHiddenOffline()?this.transitState(l.a.OFFLINE,t):p.a.isCallbackEnabled()&&this.transitState(l.a.CALL_REQUEST,t)}),Object(a.a)(S.e.w.chat.COMPLAINT_VIEW,V,,Object(a.a)(S.e.s.api.SHOW_WELCOME_WINDOW,V,function(){switch(this.getState()){case l.b.LABEL:this.transitState(l.a.DIALOG);break;case l.b.DIALOG_HIDDEN:this.transitState(l.a.SHOW);break;case l.b.INVITE:this.transitState(l.a.CLOSE),this.transitState(l.a.DIALOG)}}),Object(a.a)(S.e.w.chat.RESELECT_MEMBER,V,function(){this.publishEvent(S.e.s.dialog.CLICK_CHAT_RESELECT_MEMBER_LOG),this.__transferDialog()}),Object(a.a)(S.e.w.chat.TRANSFER_CHAT_TO_AIBOT,V,function(){this.__transferChatToBot()}),Object(a.a)(S.e.w.chat.RECONNECT_API,V,function(){this.__tryToReconnect(),o.a.dispatch(c.a.RECONNECT)}),Object(a.a)(S.e.s.api.SHOW_CONVERSATION_WINDOW,V,function(t){var e=this,n=d.a.getDialog();function i(n){e.removeApiListener(L.a.DIALOG,i),e.removeApiListener(L.a.DIALOG_UNAVAILABLE,i);if(n instanceof N.a)r();else if(n instanceof C.a){var s=n.getError();s===w.a.NO_MEMBER||s===w.a.VISITOR_IS_BANNED||s===w.a.NULL_ENTITY?r():t.cancel("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0438 \u0434\u0438\u0430\u043b\u043e\u0433\u0430")}else t.cancel("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0438 \u0434\u0438\u0430\u043b\u043e\u0433\u0430")}function s(){var t=e.getState();t===l.b.DIALOG_HIDDEN?e.transitState(l.a.SHOW):t!==l.b.DIALOG&&(e.transitState(l.a.DIALOG),e.getState()!==l.b.DIALOG&&e.transitState(l.a.DIALOG))}function r(){var e=n instanceof g.a?n.getMember():null;e instanceof v.a?t.complete(e.serializeData(S.e.s.api.SHOW_CONVERSATION_WINDOW)):t.complete(null)}this.props.isAvailableChat?n instanceof g.a?(s(),r()):(e.__setDialogRequest({member:t.employeeId,group:t.departmentId,source_type:O.a.API}),e.addApiListener(L.a.DIALOG,i),e.addApiListener(L.a.DIALOG_UNAVAILABLE,i),s()):(e.__dialogUnavailable(),r())}),Object(a.a)(S.e.w.invite.CALL_BACK_CLICK,V,function(t){p.a.isCallbackEnabled()&&this.transitState(l.a.CALL_REQUEST,t)})},"./src/service/dialog/complaint.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return h});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/app/app.ts"),o=n("./src/e.js"),c=(n.n(o),n("./src/logger/logger.ts")),u=n("./src/service/dialog/dialog.ts"),l=n("./src/io/index.ts"),_=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),d=(n.n(_),n("./modules/oldmodules.js")),p=(n.n(d),n("./src/tabs/tabs.ts")),f=n("./src/settings/props.ts"),g=[o.e.w.chat.SEND_COMPLAINT,o.e.w.chat.RATE,o.e.w.chat.CHAT_DRAW_LOG],v=[o.e.s.dialog.HIDE_RATE,o.e.s.dialog.CHAT_DRAW_LOG,o.e.s.dialog.CLICK_COMPLAINT_BACK,o.e.s.dialog.CLICK_SEND_EMAIL_BACK],h=function(t){function e(e,n,i){var s=t.call(this,u.c)||this;return s.publishEvents(n,v),s.listenEvents(e,g),s.registerApi(i),a.a.createStorage(s),f.a.isVoteEnabled()||s.publishEvent(o.e.s.dialog.HIDE_RATE),p.a.addEventListener(o.e.w.chat.RATE,function(t,e){var n=d.util.decodeBase64(e),i=d.util.decodeJsonData(n);i.timestamp=new Date(i.timestamp),s.publishEvent(o.e.s.dialog.MESSAGE,i)}),s}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e}(s.a);Object(r.a)(o.e.w.chat.CHAT_DRAW_LOG,h,function(t){"complaint"===t.widget?(this.storeEventLog(new l.a.event.ClickComplaintBack),this.publishEvent(o.e.s.dialog.CLICK_COMPLAINT_BACK)):(this.publishEvent(o.e.s.dialog.CLICK_SEND_EMAIL_BACK),this.storeEventLog(new l.a.event.ClickEmailSendBack)),this.storeEventLog(new l.a.event.ShowChat)}),Object(r.a)(o.e.w.chat.RATE,h,function(t){var e=t.rateType,n=t.rateValue,i=a.a.getDialog().getConversationId();if(i){var s=new l.a.wapi.RatingEvent(i,new _.model.Rate(e,n));this.sendRequest(s)}else c.a.error("Attempt to send complaint without conversation.")})},"./src/service/dialog/dialog.ts":function(t,e,n){"use strict";n.d(e,"c",function(){return M}),n.d(e,"a",function(){return j}),n.d(e,"b",function(){return q});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/app/app.ts"),o=n("./src/util/util.ts"),c=n("./src/app/states/states.ts"),u=n("./src/data/dialog.ts"),l=n("./src/data/factory/factory.ts"),_=n("./src/data/message-type.ts"),d=n("./src/e.js"),p=(n.n(d),n("./src/logger/logger.ts")),f=n("./src/service/client-log/events.ts"),g=n("./src/service/dialog/behavior.ts"),v=n("./src/service/dialog/shared-behavior.ts"),h=n("./src/service/dialog/file-transfer.ts"),E=n("./src/service/dialog/plusone.ts"),b=n("./src/service/dialog/complaint.ts"),m=n("./src/service/dialog/messaging.ts"),S=n("./modules/oldmodules.js"),I=(n.n(S),n("./src/settings/props.ts")),y=n("./src/util/browser/browser.ts"),A=n("./src/io/response/types.ts"),T=n("./src/io/index.ts"),O=n("./src/redux-store/reducers/availability/selectors.ts"),L=n("./src/data/member.ts"),w=n("./src/redux-store/reducers/visitor/selectors.ts"),C=n("./src/service/dialog/send-email.ts"),N=n("./src/service/prechats.ts"),D=n("./src/io/request/vnds/request.ts"),R=n("./src/util/originProvider.ts"),M="dialog",x=[d.e.w.chat.CALL_REQUEST,d.e.w.offline.CALL_IN_CHAT,d.e.s.api.RESET_VIEW,d.e.s.api.SHOW_VK_LOGIN,d.e.w.chat.AUTH_VK,d.e.w.chat.GO_TO_CHAT,d.e.w.offline.CALL_IN_WELCOME],B=[d.e.s.dialog.MESSAGE,d.e.s.dialog.HIDE_TRANSFER,d.e.s.dialog.UPDATE_STATE,d.e.s.dialog.TOGGLE_INPUT,d.e.s.dialog.SHOW_VK_LOGIN,f.b.EVENTS.CHAT_CALL_REQUEST_CLICK,f.a.EVENTS.VK_LOGIN_STATUS,f.a.EVENTS.START_CHAT_VK],j="dialog",G="vk_id",W=function(t){return{isAvailableChat:Object(O.b)(t),isBanned:Object(w.f)(t)}},q=function(t){function e(e,n,i,s,r){var o=t.call(this,M,W)||this;o.__member=null,o.__timerId=0,o.queue=[],o.listenEvents(e,x),o.publishEvents(n,B),o.registerApi(i),o.registerState(s),o.initListeners();var u=o;return o.__storage=r,o.__storage.onInit(function(){var t=a.a.getDialog();if(o.__storage.set(j,t?S.sm.serializeEntity(t,"storage"):null),t)return u.__loadDialog();o.__storage.set(g.a,g.b.NOT_OPENED),u.transitState(c.a.CLOSE)}),o.addApiListener(A.a.DIALOG,function(t){var e=t.getDialog();u.__handleDialog(e)}),o.addApiListener(A.a.CHAT_CLOSED,,o.addApiListener(A.a.MEMBER_STATUS_CHANGE,function(t){if(!o.props.isBanned){var e=t.getMember();u.__member&&u.__member.getId()===e.getId()&&u.__onMemberStatusChanged(e)}}),o.addApiListener(A.a.GROUP_AVAILABILITY_CHANGE,function(t){if(!o.props.isBanned){var e=t.getGroupId(),n=t.getAvailabilityLevel();u.__onGroupAvailabilityLevelChange(e,n)}}),o.addApiListener(A.a.MEMBER_CHANGE,function(t){if(!o.props.isBanned){var e=t.getMember();e.setStatus(D.a.FREE),u.sendRequest(new T.a.vnds.WatchEmployee(e)),u.__setMember(e),u.__turnOnWidget(),u.asyncRequest(new T.a.wapi.PopulateMember(e),A.a.MEMBER,function(t){var e=t.getMember();e.setStatus(D.a.FREE),u.__setMember(e)})}}),o.addApiListener(A.a.CHAT_ROUTING,function(t){u.__storage.set("routingDestination",t.__routingDestination),t.__routingDestination===D.b.BOT&&(o.setBotMember(),u.__turnOnWidget()),parent.postMessage({type:"lt-routingDestinationChanged",value:t.__routingDestination},R.a.getHostPageOrigin())}),o.addApiListener(A.a.MESSAGE_HISTORY,function(t){var e=t.getMember();if(o.props.isBanned)u.__turnOffWidget();else if(null!=e)u.sendRequest(new T.a.vnds.WatchEmployee(e)),u.__setMember(e),e.isAvailableForChat(!0)?u.__turnOnWidget():(u.__checkFatality(),u.publishEvent(d.e.s.dialog.TOGGLE_INPUT,!1));else if(o.props.isAvailableChat){var n=o.__storage.get("routingDestination");""!==n&&n===D.b.BOT&&o.setBotMember(),u.__turnOnWidget()}else u.__checkFatality(),u.publishEvent(d.e.s.dialog.TOGGLE_INPUT,!1);o.__timerId=setTimeout(250)}),o.addApiListener(A.a.VISITOR_BAN,,o}return i.c(e,t),e.start=function(t,n,i,s){var r=a.a.createCrossStorage(M);a.a.createStorage("plusone"),new h.a(t,n,i,r),new E.a(t,n,i,s,r),new b.a(t,n,i),new C.a(t,n,i),new e(t,n,i,s,r),new m.b(t,n,i,r);var o=new g.c(t,n,i,s,r);new v.b(t,n,i,s,r),o.registerState(s)},e.prototype.onState=function(t){var e=a.a.getDialog();t===c.b.DIALOG&&null===e&&this.__loadDialog()},e.prototype.onStateLeave=function(){},e.prototype.loginVK=function(){var t=this,e=t.__storage.get(G);e?o.a.cors("https://api.vk.com/method/users.get",{user_ids:e,fields:"photo_50,city,contacts",v:"5.45",name_case:"nom"},function(e){var n=e.response[0];n.vk_id=n.id,n.vk_link="https://vk.com/id"+n.id,delete n.id,Object(N.c)({visible:n,hidden:{}}),t.publishEvent(d.e.s.dialog.SHOW_VK_LOGIN,n)},function(){t.publishEvent(d.e.s.dialog.SHOW_VK_LOGIN)}):t.publishEvent(d.e.s.dialog.SHOW_VK_LOGIN)},e.prototype.setBotMember=function(){var t=new L.a("bot"),e={avatar:I.a.getBotAvatar(),nickname:I.a.getBotName(),label:I.a.getBotHeadText()};t.populateData(e),this.__setMember(t)},e.prototype.__fuckingQueue=function(t,e){this.__unlocked?this.publishEvent(t,e):(this.queue||(this.queue=[]),this.queue.push({event:t,message:e}))},e.prototype.__flushFuckingQueue=function(){if(this.queue)for(var t=0,e=this.queue;t<e.length;t++){var n=e[t];this.__fuckingQueue(n.event,n.message)}},e.prototype.__handleDialog=function(t){var e=t.getMember();this.__storage.set(j,S.sm.serializeEntity(t,"storage")),a.a.setDialog(t),this.__setMember(e),this.__watchCurrentGroup(),null!==e&&this.publishEvent(d.e.s.dialog.TOGGLE_INPUT,e.isAvailableForChat(!0))},e.prototype.__onMemberStatusChanged=function(t){if(this.__isMemberStatusChanged(t)&&null!=this.__member){this.__member.setStatus(t.getStatus());var e=this.__member.isAvailableForChat(!0);if(e){this.__fuckingQueue(d.e.s.dialog.MESSAGE,l.a.createMessage(this.__getMessageIncrementalId(),_.a.OP_ONLINE).encodeData());var n=this.__timerId;clearTimeout(n)}else this.__checkFatality();this.publishEvent(d.e.s.dialog.UPDATE_STATE,this.__member.encodeData()),this.publishEvent(d.e.s.dialog.TOGGLE_INPUT,e)}},e.prototype.__onGroupAvailabilityLevelChange=function(t,e){var n=a.a.getDialog().getGroup();if((n?n.getId():"")===t){var i=this.__member;e.isAvailable()?i&&!i.isAvailableForChat(!0)?this.__sendChatTransferMessage():this.__turnOnWidget():(i&&i.isAvailableForChat(!0)||this.__turnOffWidget(),this.publishEvent(d.e.s.dialog.HIDE_TRANSFER))}},e.prototype.__getMessageIncrementalId=function(){return String(this.__storage.incr(m.a))},e.prototype.__isMemberStatusChanged=function(t){if(null!==this.__member&&this.__member.isAvailableForChat(!0)===t.isAvailableForChat(!0))return!1;return!0},e.prototype.__chatClosed=function(){this.getState()===c.b.DIALOG&&o.a.removeFromStorage("lt-complaint-voted")},e.prototype.__setMember=function(t){var e=null;t&&(e=t.encodeData()),this.publishEvent(d.e.s.dialog.UPDATE_STATE,e),this.__member=t,a.a.getDialog().setMember(t)},e.prototype.__checkFatality=function(){var t=this,e=a.a.getDialog().getGroup(),n=e?e.getId():"";this.asyncRequest(new T.a.wapi.GetChatAvailableGroups,A.a.CHAT_AVAILABLE_GROUPS,function(e){e instanceof T.b.ChatAvailableGroups?-1!==e.getGroups().map(function(t){return t.getId()}).indexOf(n)?t.__sendChatTransferMessage():t.__sendChangeChannelMessage():p.a.error("Wrong response type at member-list handler",t)})},e.prototype.__watchCurrentGroup=function(){var t=a.a.getDialog().getGroup();t&&this.sendRequest(new T.a.vnds.WatchGroup(t.getId()))},e.prototype.__turnOnWidget=function(){this.publishEvent(d.e.s.dialog.TOGGLE_INPUT,!0),this.publishEvent(d.e.s.dialog.CLEAR_FALLBACK)},e.prototype.__turnOffWidget=function(){this.publishEvent(d.e.s.dialog.TOGGLE_INPUT,!1),this.publishEvent(d.e.s.dialog.MESSAGE,l.a.createMessage(o.a.generateId(),_.a.ALL_OP_OFFLINE).encodeData())},e.prototype.__sendChangeChannelMessage=function(){this.__fuckingQueue(d.e.s.dialog.MESSAGE,l.a.createMessage(o.a.generateId(),_.a.ALL_OP_OFFLINE).encodeData())},e.prototype.__sendChatTransferMessage=function(){this.__fuckingQueue(d.e.s.dialog.MESSAGE,l.a.createMessage(o.a.generateId(),_.a.OP_OFFLINE).encodeData())},e.prototype.__loadDialog=function(){var t=this.__storage.get(j);if(t instanceof Object){var e=S.sm.reconstructEntity(t,"storage");e instanceof u.a?this.__handleDialog(e):p.a.error("Incorrect data in saved dialog",this)}},e.prototype.initListeners=function(){Object(r.a)(d.e.w.chat.CALL_REQUEST,e,function(t){I.a.isCallbackEnabled()&&(this.transitState(c.a.CALL_REQUEST,t),this.storeEventLog(new T.a.event.ClickChatCallRequest))}),Object(r.a)(d.e.s.api.SHOW_VK_LOGIN,e,function(){if(!y.a.isMobile()){var t=this;t.loginVK(),Object(r.a)(d.e.s.api.RESET_VIEW,e,,Object(r.a)(d.e.w.chat.GO_TO_CHAT,e,function(t){this.__storage.get(G)?this.publishEvent(f.a.EVENTS.START_CHAT_VK,{signon:!0}):this.publishEvent(f.a.EVENTS.START_CHAT_VK,{signon:!1})})}}),Object(r.a)(d.e.w.chat.AUTH_VK,e,function(t){var e=this;if(t.signon){var n=I.a.getVkAuthSrv();o.a.cors(n,{},function(t){var n="fail";t&&(e.__storage.set(G,t),e.loginVK(),n="success"),e.publishEvent(f.a.EVENTS.VK_LOGIN_STATUS,{status:n})},o.a.nop)}else e.__storage.remove(G)}),Object(r.a)(d.e.w.offline.CALL_IN_CHAT,e,,Object(r.a)(d.e.w.offline.CALL_IN_WELCOME,e,function(t){this.transitState(c.a.BACK_TO_WELCOME,i.a({},t,{fromState:c.b.CALL_REQUEST}))})},e}(s.a)},"./src/service/dialog/file-transfer.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return b});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/settings/props.ts"),o=n("./src/data/message-type.ts"),c=n("./src/data/factory/factory.ts"),u=n("./src/e.js"),l=(n.n(u),n("./src/service/dialog/dialog.ts")),_=n("./src/service/dialog/messaging.ts"),d=n("./src/util/util.ts"),p=n("./src/io/response/types.ts"),f=n("./src/io/response/upload-status-type.ts"),g=n("./src/io/request/file-server/index.ts"),v=[u.e.w.chat.GET_UPLOAD_URL,u.e.w.chat.UPLOAD_START,u.e.w.chat.UPLOAD_FILE,u.e.w.chat.GET_FILE_SIZE],h=[u.e.s.dialog.SHOW_UPLOAD_START,u.e.s.dialog.SET_UPLOAD_URL,u.e.s.dialog.UPLOAD_COMPLETE,u.e.s.dialog.SHOW_FILE,u.e.s.dialog.MESSAGE,u.e.s.dialog.SHOW_FILE_SIZE],E=[],b=function(t){function e(e,n,i,s){var r=t.call(this,l.c)||this;r.listenEvents(e,v),r.publishEvents(n,h),r.registerApi(i),r.__storage=s;var a=r;return r.addApiListener(p.a.INCOMING_FILE,function(t){a.__incomingFile(t)}),r.addApiListener(p.a.UPLOAD_URL,function(t){a.__uploadFile(t)}),r.addApiListener(p.a.UPLOAD_COMPLETE,function(t){var e=t.getStatus();e===f.a.COMPLETE?a.__uploadComplete():e===f.a.OP_DOWNLOAD&&a.__opDownload(t.getName())}),r}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e.prototype.__getMessageIncrementalId=e.prototype.__incomingFile=function(t){var e=t.getData();e.message_id=this.__getMessageIncrementalId(),e.type=o.a.FROM_MEMBER,this.publishEvent(u.e.s.dialog.SHOW_FILE,e)},e.prototype.__uploadFile=function(t){this.publishEvent(u.e.s.dialog.SET_UPLOAD_URL,{getUrl:t.getUrl(),getId:t.getId()})},e.prototype.__uploadComplete=function(t,e){void 0===e&&(e=!0),this.publishEvent(u.e.s.dialog.UPLOAD_COMPLETE,{message:t,isUploaded:e})},e.prototype.__opDownload=function(t){this.publishEvent(u.e.s.dialog.MESSAGE,c.a.createMessage(this.__getMessageIncrementalId(),o.a.OP_GET_FILE,t).encodeData())},e}(s.a);Object(r.a)(u.e.w.chat.GET_FILE_SIZE,b,function(t){var e=this.publishEvent.bind(this);this.sendRequest(new g.GetFileSize(t,function(n){e(u.e.s.dialog.SHOW_FILE_SIZE,{size:n,url:t.url})}))}),Object(r.a)(u.e.w.chat.UPLOAD_FILE,b,function(t){var e=this,n=a.a.getMaxUploadSize(),i=this,s=E.pop();if(t instanceof File&&t.size<=n){var r=function(t){try{var e=d.a.decodeJsonData(t.target.responseText);if("uploadSuccess"!==e.type)throw new Error("unexpected response");s.file_url=e.url,i.__uploadComplete(s,!0)}catch(t){console.error(t),o()}},o=!function(t,e){try{var n=new File([],"test"),i=new FileReader;i.onload=function(){n=new File([i.result],t.name,{type:t.type}),e(n)},i.readAsArrayBuffer(t)}catch(n){e(t)}}(t,}else{var c=document.querySelector(".lt-chat-list__i-img.file-upload");c&&(c.classList.remove("file-upload"),c.classList.add("file-upload-error"))}}),Object(r.a)(u.e.w.chat.UPLOAD_START,b,function(t){var e=this.__getMessageIncrementalId();E.push({id:e,file_name:t.file_name,file_size:(t.file_size/1024/1024).toFixed(2),type:"visitor"}),t.message_id=e,this.publishEvent(u.e.s.dialog.SHOW_UPLOAD_START,t)})},"./src/service/dialog/messaging.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return L}),n.d(e,"b",function(){return C});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/tabs/event-type.ts"),o=n("./src/tabs/tabs.ts"),c=n("./src/util/util.ts"),u=n("./src/app/app.ts"),l=n("./src/data/message.ts"),_=n("./src/data/message-type.ts"),d=n("./src/data/factory/factory.ts"),p=n("./src/data/dialog.ts"),f=n("./src/e.js"),g=(n.n(f),n("./modules/oldmodules.js")),v=(n.n(g),n("./src/logger/logger.ts")),h=n("./src/service/dialog/sys-messages-list.ts"),E=n("./src/service/dialog/dialog.ts"),b=n("./src/io/response/types.ts"),m=n("./src/io/index.ts"),S=n("./src/redux-store/reducers/visitor/selectors.ts"),I=n("./src/io/request/vnds/request.ts"),y=n("./src/redux-store/reducers/account-settings/selectors.ts"),A=n("./src/redux-store/index.ts"),T=[f.e.w.invite.CHAT_CLICK,f.e.w.chat.MESSAGE,f.e.w.chat.GO_TO_CHAT,f.e.w.chat.TOGGLE_MUTE,f.e.w.chat.TYPING,f.e.w.chat.SHOW_PRINT,f.e.w.chat.RATE,f.e.w.chat.STORE_SYSTEM_MESSAGE,f.e.w.chat.REMOVE_SYSTEM_MESSAGE,f.e.s.dialog.SHOW_UPLOAD_START,f.e.s.api.SHOW_CONVERSATION_WINDOW,f.e.w.chat.SHOW_RATING_FORM,f.e.w.chat.SYNC_RATING_FORM],O=[f.e.s.dialog.LABEL_HIDE,f.e.s.dialog.CHAT_DRAW,f.e.s.dialog.WELCOME_DRAW,f.e.s.dialog.WELCOME_HIDE,f.e.s.dialog.MESSAGE,f.e.s.dialog.HISTORY,f.e.s.dialog.SHOW_FILE,f.e.s.dialog.HIDE_TRANSFER,f.e.s.dialog.UPDATE_STATE,f.e.s.dialog.CLEAR_CHAT,f.e.s.dialog.CLEAR_HOLDING_MESSAGE,f.e.s.api.EMPLOYEE_MESSAGE_SENT,f.e.s.dialog.SHOW_UPLOAD_START,f.e.s.dialog.UPLOAD_COMPLETE,f.e.s.dialog.RESTORE_FILE_UPLOAD_MESSAGE,f.e.s.dialog.DRAW_PRINT,f.e.s.dialog.SYNC_RATING_FORM],L="msg-id",w=function(t){return{visitorName:Object(S.d)(t),isBanned:Object(S.f)(t),isBotEnabled:Object(y.e)(t)}},C=function(t){function e(e,n,i,s){var r=t.call(this,E.c,w)||this;r.__holdingMessageHandler=function(t){if(t instanceof m.b.HoldingMessage){var e=u.a.getDialog().getMessagesList(),n=this.__getConversationId(),i=d.a.createHoldingMessage(n,t.getText());e.hasMessage(i)||(e.addMessage(i),this.publishEvent(f.e.s.dialog.MESSAGE,i.encodeData()))}else v.a.error("Wrong response type at holding-message handler",this)},r.listenEvents(e,T),r.publishEvents(n,O),r.registerApi(i),r.__firstMessage="",r.__member=null,r.__storage=s,r.__sysMessage=new h.a(r.__storage);var _=r;return r.__storage.onInit(function(){var t=_.__storage.get(E.a);if(t instanceof Object){var e=g.sm.reconstructEntity(t,"storage");e instanceof p.a&&_.__dialogHandler(e)}}),r.addApiListener(b.a.MESSAGE,,r.addApiListener(b.a.MESSAGE_HISTORY,function(t){_.publishEvent(f.e.s.dialog.CLEAR_CHAT),_.publishEvent(f.e.s.dialog.CLEAR_HOLDING_MESSAGE),_.__chatHistory(t)}),r.addApiListener(b.a.CHAT_ROUTING,function(t){if(t.__routingDestination===I.b.QUEUE){var e=c.a.getTranslation("queue_message_1"),n=u.a.getDialog().getConversationId(),i=d.a.createSystemMessage(n,e);_.__incomingMessage(i)}}),r.addApiListener(b.a.TYPING,function(){_.__typingHandler()}),r.addApiListener(b.a.CHAT_MOVE,function(){_.__showTransferHandler()}),r.addApiListener(b.a.STOP_CHAT_MOVE,function(){_.__hideTransferHandler()}),r.addApiListener(b.a.HOLDING_MESSAGE,function(t){_.__holdingMessageHandler(t)}),r.addApiListener(b.a.DIALOG,,r.addApiListener(b.a.MEMBER,function(t){if(null!==u.a.getDialog()){var e=t.getMember();_.__member&&_.__member.getId()===e.getId()||(_.__member=t.getMember(),_.__sendRoutedMessage(t.getMember()))}}),r.addApiListener(b.a.CHAT_CLOSED,,o.a.addEventListener(a.a.U20,function(t,e){var n=c.a.decodeBase64(e),i=c.a.decodeJsonData(n),s=l.a.fromSerialized(i);s&&_.__incomingMessage(s)}),o.a.addEventListener(a.a.SYNC_RATING_FORM,function(t,e){var n=c.a.decodeBase64(e),i=c.a.decodeJsonData(n);_.publishEvent(f.e.s.dialog.SYNC_RATING_FORM,i)}),r}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e.prototype.__sendMessage=e.prototype.__sendTextMessage=function(t){var e=this;this.sendRequest(new m.a.wapi.TextMessage(t),function(){e.publishEvent(f.e.s.dialog.MESSAGE,t.encodeData());var n=c.a.encodeBase64(JSON.stringify(t.serializeData()));o.a.dispatch(a.a.U20,n)})},e.prototype.__sendFileMessage=function(t){var e={url:t.getText()},n=this;this.sendRequest(new m.a.fileServer.GetFileSize(e,function(e){n.sendRequest(new m.a.wapi.FileMessage(t,e),function(){var e=c.a.encodeBase64(JSON.stringify(t.serializeData()));o.a.dispatch(a.a.U20,e)})}))},e.prototype.__dialogHandler=function(t){var e=t.getMember();this.__storage.set(E.a,g.sm.serializeEntity(t,"storage")),this.__member=e,this.__reinitFirstMessage()},e.prototype.__incomingMessage=function(t){var e=u.a.getDialog().getMessagesList(),n=t;if(!e.hasMessage(n)&&(n.__type===_.a.ASSIGN_TO_OPERATOR&&e.addMessage(n),n.__type===_.a.CALLBACK&&n.setMetaData({showReturnToBotBtn:this.props.isBotEnabled}).encodeData(),this.publishEvent(f.e.s.dialog.MESSAGE,n.encodeData()),n.getType()===_.a.FROM_MEMBER)){e.addMessage(n);var i=n.serializeData(f.e.s.api.EMPLOYEE_MESSAGE_SENT);this.publishEvent(f.e.s.api.EMPLOYEE_MESSAGE_SENT,i)}},e.prototype.__chatHistory=function(t){if(t instanceof m.b.MessageHistory){var e=u.a.getDialog(),n=e.getMessagesList();n.addMessages(t.getMessages());for(var i=e.getConversationId(),s=[],r=n.getMessages().reverse().filter(,a=e.__member&&e.__member.__id,o=0;o<r.length;o++)r[o].__type===_.a.CALLBACK?(r[o].setMetaData({showReturnToBotBtn:!a&&this.props.isBotEnabled}),!a&&s.push(r[o].encodeData())):s.push(r[o].encodeData());this.publishEvent(f.e.s.dialog.HISTORY,s)}},e.prototype.__typingHandler=function(){this.publishEvent(f.e.s.dialog.MESSAGE,d.a.createMessage(this.__getConversationId(),_.a.TYPING).encodeData())},e.prototype.__showTransferHandler=function(){this.publishEvent(f.e.s.dialog.MESSAGE,d.a.createMessage(this.__getConversationId(),_.a.CHAT_TRANSFER).encodeData())},e.prototype.__hideTransferHandler=function(){this.publishEvent(f.e.s.dialog.HIDE_TRANSFER)},e.prototype.__getConversationId=function(){var t=u.a.getDialog();if(t)return t.getId();throw new Error("Can't get conversation Id")},e.prototype.__handleGoToChat=function(t){this.__initFirstMessage(t)},e.prototype.__initFirstMessage=function(t){var e=t?String(t.initial_message||t.message||""):null;e&&(this.__firstMessage=e)},e.prototype.__reinitFirstMessage=function(){if(""!==this.__firstMessage){var t=this.__firstMessage,e=this.__getConversationId(),n=d.a.createVisitorMessage(e,t);this.__handleMessage(n),this.__firstMessage=""}},e.prototype.__handleMessage=function(t){var e=u.a.getDialog().getMessagesList();e.hasMessage(t)||(e.addMessage(t),this.__sendMessage(t))},e.prototype.__sendRoutedMessage=function(t){var e=u.a.getDialog().getConversationId(),n=d.a.createAssignMessage(e,c.a.getTranslation("change_member").replace("NICKNAME",t.getNickName()));this.__incomingMessage(n)},e.prototype.__sendChatClosed=function(){var t=c.a.generateId(),e=u.a.getDialog().getConversationId(),n=c.a.getTranslation("op_close_chat2"),i=this.__member.getNickName(),s=this.__member.getLastName(),r=s?"_"+s:"",a=""+this.__member.getFirstName()+r,o=this.__member.__id,l=n.replace("NICKNAME",i).replace("OPERATOR_FULLNAME",a).replace("CONVERSATION_ID",e).replace("OPERATOR_ID",o),p=d.a.createMessage(t,_.a.CHAT_CLOSED,l);this.__incomingMessage(p)},e}(s.a);Object(r.a)(f.e.w.chat.STORE_SYSTEM_MESSAGE,C,function(t){this.__sysMessage.matchMessage(t)?this.__sysMessage.store(d.a.createMessage(t.message_id,t.type,t.text)):!t.opt_data||t.opt_data.type!==_.a.UPLOAD_START&&t.opt_data.type!==_.a.FILE_TRANSFER||this.__sysMessage.store(d.a.createMessage(t.opt_data.message_id,t.opt_data.type),t.opt_data)}),Object(r.a)(f.e.w.chat.MESSAGE,C,function(t){var e=this.__getConversationId(),n=d.a.createVisitorMessage(e,t);this.__handleMessage(n);var i=c.a.encodeBase64(JSON.stringify(n.serializeData()));o.a.dispatch(a.a.U20,i)}),Object(r.a)(f.e.w.chat.RATE,C,function(t){var e=t.rateType,n=t.rateValue,i=d.a.createRatingMessage(this.__getConversationId(),_.a.CHAT_VOTE,{rateType:e,rateValue:n});this.publishEvent(f.e.s.dialog.MESSAGE,i.encodeData()),o.a.dispatch(f.e.w.chat.RATE,c.a.encodeBase64(JSON.stringify(i.serializeData())))}),Object(r.a)(f.e.w.invite.CHAT_CLICK,C,function(t){this.__handleGoToChat(t)}),Object(r.a)(f.e.w.chat.GO_TO_CHAT,C,function(t){this.__handleGoToChat(t)}),Object(r.a)(f.e.s.api.SHOW_CONVERSATION_WINDOW,C,,Object(r.a)(f.e.w.chat.TYPING,C,function(t){this.sendRequest(new m.a.wapi.SendTyping(this.__getConversationId(),t.text))}),Object(r.a)(f.e.w.chat.SHOW_RATING_FORM,C,function(){var t=Object(y.c)(A.a.getState());if(u.a.getDialog()){var e={rateType:"DoublePoint"===t?1:2,rateValue:null},n=d.a.createRatingMessage(this.__getConversationId(),_.a.RATING_FORM,e),i=n.encodeData();this.publishEvent(f.e.s.dialog.MESSAGE,i);var s=c.a.encodeBase64(JSON.stringify(n.serializeData()));o.a.dispatch(a.a.U20,s)}}),Object(r.a)(f.e.w.chat.SYNC_RATING_FORM,C,function(t){var e=t.messageId,n=t.value,i=t.action,s=c.a.encodeBase64(JSON.stringify({messageId:e,value:n,action:i}));o.a.dispatch(a.a.SYNC_RATING_FORM,s)}),Object(r.a)(f.e.w.chat.SHOW_PRINT,C,function(){var t=this,e=u.a.getDialog(),n=e.getMessagesList().getMessages(),i=c.a.getTranslation("default_operator_name"),s=n.map(function(n){var s,r=n.getTime();switch(n.getType()){case _.a.FROM_MEMBER:var a=e.getMember();s=a?a.getNickName():i;break;case _.a.FROM_VISITOR:s=t.props.visitorName;break;default:s=""}return{name:s,text:n.getText(),time:(r.getHours()<10?"0":"")+r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes()}});this.publishEvent(f.e.s.dialog.DRAW_PRINT,s)})},"./src/service/dialog/plusone.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return y});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/tabs/event-type.ts"),o=n("./src/tabs/tabs.ts"),c=n("./src/app/app.ts"),u=n("./src/store/storage.ts"),l=n("./src/app/states/states.ts"),_=n("./src/data/message-type.ts"),d=n("./src/e.js"),p=(n.n(d),n("./src/io/response/types.ts")),f=n("./src/io/response/index.ts"),g=n("./src/app/app-types.ts"),v=n("./src/event-emitter/index.ts"),h=n("./src/event-emitter/actions/notifications.ts"),E=[d.e.w.chat.MESSAGE_READ,d.e.w.chat.TOGGLE_MUTE,d.e.w.label.LABEL_INIT],b=[d.e.s.dialog.NOTIFICATION,d.e.s.dialog.S_MESSAGE_READ,d.e.s.dialog.MUTE_STATE],m="unread-msg",S="first-msg",I="mute-sound",y=function(t){function e(e,n,i,s,r){var y=t.call(this,"plusone")||this;y.__dummyInit=!0,y.listenEvents(e,E),y.publishEvents(n,b),y.registerApi(i),y.registerState(s),y.__storage=r,y.__appType=c.a.getAppType(),y.__isNotificationEnabled=!Boolean(y.__storage.get(I)),y.publishEvent(d.e.s.dialog.MUTE_STATE,y.__isNotificationEnabled);var A=y;function T(t){var e=A.__storage.get(S);e===u.b.NO_DATA&&A.__storage.set(S,!0),t instanceof f.Message&&e?t.getMessage().getType()===_.a.FROM_MEMBER&&(A.getState()===l.b.CALL_REQUEST_HIDDEN&&A.transitState(l.a.DIALOG),A.transitState(l.a.SHOW),A.removeApiListener(p.a.MESSAGE,T),A.removeApiListener(p.a.INCOMING_FILE,T),A.__storage.set(S,!1)):e&&(A.getState()===l.b.CALL_REQUEST_HIDDEN&&A.transitState(l.a.DIALOG),A.transitState(l.a.SHOW),A.removeApiListener(p.a.MESSAGE,T),A.removeApiListener(p.a.INCOMING_FILE,T),A.__storage.set(S,!1))}return o.a.addEventListener(a.a.NOTIFICATION,function(){A.__checkIncomingMsg()}),y.addApiListener(p.a.MESSAGE,function(t){if(t.getMessage().getType()===_.a.FROM_MEMBER)switch(A.__isNotificationEnabled&&v.a.publishEvent(h.a.PLAY_SOUND),A.__appType){case g.a.MOBILE:case g.a.EMBEDDED:A.__storage.set(m,!0),A.__checkIncomingMsg()}}),y.addApiListener(p.a.INCOMING_FILE,function(){A.__isNotificationEnabled&&v.a.publishEvent(h.a.PLAY_SOUND),A.__storage.set(m,!0),A.__checkIncomingMsg()}),y.__appType===g.a.EMBEDDED&&(y.addApiListener(p.a.MESSAGE,T),y.addApiListener(p.a.INCOMING_FILE,T)),y}return i.c(e,t),e.prototype.onState=e.prototype.onStateLeave=function(){},e.prototype.__checkIncomingMsg=function(){this.__storage.get(m)?this.publishEvent(d.e.s.dialog.NOTIFICATION):this.publishEvent(d.e.s.dialog.S_MESSAGE_READ)},e}(s.a);Object(r.a)(d.e.w.chat.MESSAGE_READ,y,function(){this.__storage.set(m,!1),this.__checkIncomingMsg()}),Object(r.a)(d.e.w.chat.TOGGLE_MUTE,y,function(){this.__isNotificationEnabled=!this.__isNotificationEnabled,this.__storage.set(I,!this.__isNotificationEnabled)}),Object(r.a)(d.e.w.label.LABEL_INIT,y,function(){this.__checkIncomingMsg()})},"./src/service/dialog/send-email.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return g});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/e.js"),o=(n.n(a),n("./src/service/dialog/dialog.ts")),c=n("./src/io/index.ts"),u=n("./src/redux-store/actions/set-visitor-info.ts"),l=n("./src/redux-store/reducers/visitor/selectors.ts"),_=[a.e.w.chat.EMAIL_VIEW,a.e.w.chat.EMAIL],d=[a.e.s.dialog.S_EMAIL_VIEW,a.e.s.dialog.SEND_VIA_EMAIL_STATUS],p=function(t){return{allIds:Object(l.b)(t)}},f={setVisitorInfo:u.b},g=function(t){function e(e,n,i){var s=t.call(this,o.c,p,f)||this;return s.listenEvents(e,_),s.publishEvents(n,d),s.registerApi(i),s}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e}(s.a);Object(r.a)(a.e.w.chat.EMAIL_VIEW,g,function(){this.storeEventLog(new c.a.event.ShowEmailSend),this.publishEvent(a.e.s.dialog.S_EMAIL_VIEW,!0)}),Object(r.a)(a.e.w.chat.EMAIL,g,},"./src/service/dialog/shared-behavior.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return h}),n.d(e,"b",function(){return b});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/app/app.ts"),o=n("./src/app/states/states.ts"),c=n("./src/e.js"),u=(n.n(c),n("./src/service/dialog/behavior.ts")),l=n("./src/service/dialog/dialog.ts"),_=n("./src/redux-store/reducers/availability/selectors.ts"),d=n("./src/app/app-types.ts"),p=n("./src/service/prechats.ts"),f=n("./src/io/index.ts"),g=[c.e.s.api.HIDE_LABEL,c.e.s.api.SHOW_LABEL,c.e.s.api.SET_WELCOME_DEPARTMENTS,c.e.s.api.SET_CONVERSATION_ATTRIBUTES,c.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,c.e.s.api.RESET_VIEW],v=[c.e.s.dialog.LABEL_HIDE,c.e.s.site.LABEL_DRAW,c.e.s.dialog.CLEAR_VIEW],h="set-groups",E=function(t){return{isAvailableChat:Object(_.b)(t)}},b=function(t){function e(e,n,i,s,r){var o=t.call(this,l.c,E)||this;return o.listenEvents(e,g),o.publishEvents(n,v),o.registerApi(i),o.registerState(s),o.__storage=r,a.a.getAppType()===d.a.MOBILE&&o.__storage.set("page",window.parentHref.toString()),o}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e}(s.a);Object(r.a)(c.e.s.api.RESET_VIEW,b,function(){this.transitState(o.a.CLOSE),this.__storage.set(u.a,u.b.NOT_OPENED),this.publishEvent(c.e.s.dialog.CLEAR_VIEW)}),Object(r.a)(c.e.s.api.SET_WELCOME_DEPARTMENTS,b,,Object(r.a)(c.e.s.api.HIDE_LABEL,b,function(){this.publishEvent(c.e.s.dialog.LABEL_HIDE,{api_hide:!0})}),Object(r.a)(c.e.s.api.SHOW_LABEL,b,function(){var t={api_hide:!1,chat_available:this.props.isAvailableChat};this.getState()===o.b.INVITE?(this.transitState(o.a.CLOSE),this.publishEvent(c.e.s.site.LABEL_DRAW,t)):this.getState()!==o.b.LABEL&&this.getState()!==o.b.DIALOG_HIDDEN||this.publishEvent(c.e.s.site.LABEL_DRAW,t)}),Object(r.a)(c.e.s.api.SET_CONVERSATION_ATTRIBUTES,b,function(t){var e=a.a.getDialog();if(e){var n=e.getConversationId(),i=t.visible,s=t.hidden;this.sendRequest(new f.a.wapi.UpdateAttributes(n,null,i,s))}else Object(p.c)(t)})},"./src/service/dialog/sys-messages-list.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./src/data/factory/factory.ts"),s=function(){function t(t){this.__storage=t}return t.prototype.__buildList=function(){var t=this,e=[];return this.__getStoreMessages().forEach(function(n){t.matchMessage(n)&&e.push(i.a.createMessage(n.message_id,n.type,n.text))}),e},t.prototype.matchMessage=t.prototype.__getStoreMessages=function(){var t=this.__storage.get("sys-msg");return t instanceof Array?t:[]},t.prototype.__updateStorage=function(t){var e=this;this.__storage.set("sys-msg",t.filter(function(t){return e.matchMessage(t)}))},t.prototype.get=t.prototype.getById=function(t){return this.__buildList().filter(function(e){return e.getId()===t})[0]},t.prototype.getLastPosition=function(){return this.__getStoreMessages().reduce(function(t,e){return t>+e.message_id?t:+e.message_id},0)},t.prototype.store=function(t,e){var n=this.__getStoreMessages();0===n.filter(.length&&(n.push({message_id:t.getId(),type:t.getType(),text:t.getText(),opt_data:e||{}}),this.__updateStorage(n))},t.prototype.getOptions=function(t){var e=this.__getStoreMessages().filter(function(e){return e.message_id===t});return e.length&&e[0].opt_data?e[0].opt_data:null},t.prototype.remove=function(t){this.__updateStorage(this.__getStoreMessages().filter()},t}()},"./src/service/event-turbine/event-turbine.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/e.js"),o=(n.n(a),n("./src/service/client-log/events.ts")),c=n("./src/event-emitter/index.ts");ar l=[].concat(u(a.e.s.site),u(a.e.s.dialog),u(a.e.s.invite),u(a.e.s.buttons),u(a.e.s.site),u(a.e.s.offline),u(a.e.s.x_widget),u(a.e.s.api),u(a.e.s.forgotten),u(a.e.s.wrapper),u(a.e.s.system)),_=[].concat(u(a.e.w.buttons),u(a.e.w.chat),u(a.e.w.invite),u(a.e.w.label),u(a.e.w.offline),u(a.e.w.x_widget),u(a.e.w.storage),u(o.b.EVENTS),u(o.b.HELPER_EVENTS)),d=function(t){function e(e,n){var i=t.call(this,"eventTurbine")||this;return i.listenEvents(n,l),i.publishEvents(e,_),i}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e.prototype.transmitMessage=e.start=function(t,n,i,s){var r=new e(t,n),a=new Set;_.concat(l).forEach(function(t){a.add(t)}),a.forEach(},e}(s.a),p=new Set;_.concat(l).forEach(function(t){p.add(t)}),p.forEach(function(t){Object(r.a)(t,d,})},"./src/service/invite/invite.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return T});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/app/states/states.ts"),o=n("./src/tabs/tabs.ts"),c=n("./src/tabs/event-type.ts"),u=n("./src/app/app.ts"),l=n("./src/settings/props.ts"),_=n("./src/e.js"),d=(n.n(_),n("./src/store/storage.ts")),p=n("./src/io/response/types.ts"),f=n("./src/io/index.ts"),g=n("./src/redux-store/reducers/availability/selectors.ts"),v=n("./src/app/app-types.ts"),h=n("./src/redux-store/reducers/account-settings/selectors.ts"),E=n("./src/redux-store/reducers/visitor/selectors.ts"),b=n("./src/service/scripts/index.ts"),m=n("./src/service/scripts/invitation/util.ts"),S=n("./src/service/scripts/conditions/condition.ts"),I=[_.e.s.dialog.LABEL_DISABLE,_.e.s.dialog.LABEL_HIDE,_.e.s.invite.SHOW_INVITE,_.e.s.dialog.HIDE_RATE,_.e.s.invite.MOB_INVITE,_.e.s.invite.CHAT_LIKE_INVITE,_.e.s.invite.OFFLINE_LIKE_INVITE,_.e.s.offline.HIDE_INVITE,_.e.s.site.LABEL_DRAW,_.e.s.dialog.LABEL_ENABLE,_.e.s.x_widget.CHANGE_POS_X_BUTTON,_.e.s.x_widget.RESET_POS_X_BUTTON,_.e.s.api.INVITATION_WINDOW_SHOWN,_.e.s.api.INVITATION_WINDOW_CLOSED],y=[_.e.w.invite.INVITE_CLOSE,_.e.w.label.CHAT_CLICK,_.e.w.invite.CALL_IN_INVITE,_.e.w.invite.INVITATION_WINDOW_SHOWN,_.e.w.invite.INVITATION_DENIED,_.e.w.label.MOB_START_CHAT_CLICK],A=function(t){return{isAvailableChat:Object(g.b)(t),isBotEnabled:Object(h.e)(t),isOmniButtonEnabled:Object(h.h)(t),isBannedVisitor:Object(E.f)(t)}},T=function(t){function e(e,n,i,s){var r=t.call(this,"invite",A)||this;r.listenEvents(e,y),r.publishEvents(n,I),r.registerApi(i),r.registerState(s),r.__storage=u.a.createStorage(r);var d=r;return o.a.addEventListener(c.a.HIDE_INVITE,function(){d.getState()===a.b.LABEL&&(d.publishEvent(_.e.s.x_widget.RESET_POS_X_BUTTON),d.publishEvent(_.e.s.offline.HIDE_INVITE),l.a.isOneClickInviteEnabled()?d.publishEvent(_.e.s.site.LABEL_DRAW,{chat_available:d.props.isAvailableChat}):d.publishEvent(_.e.s.dialog.LABEL_ENABLE))}),r.getState()!==a.b.INVITE&&o.a.dispatch(c.a.HIDE_INVITE),r}return i.c(e,t),e.start=function(t,n,i,s){new e(t,n,i,s)},e.prototype.onState=function(t,e){this.__permanentInviteData=this.__storage.get("last-invite")?this.__storage.get("last-invite"):this.__permanentInviteData;var n=e&&void 0!==e.id?e:this.__permanentInviteData;t===a.b.LABEL&&(this.publishEvent(_.e.s.offline.HIDE_INVITE),this.publishEvent(_.e.s.x_widget.RESET_POS_X_BUTTON),n&&this.__storage.set("last-invite",n)),this.getState(),t===a.b.INVITE&&n&&(this.__storage.set("last-invite",n),this.__showInvite(n),u.a.getAppType()!==v.a.MOBILE&&(l.a.isOneClickInviteEnabled()?this.publishEvent(_.e.s.dialog.LABEL_HIDE):this.publishEvent(_.e.s.dialog.LABEL_DISABLE)))},e.prototype.onStateLeave=function(t){var e=this.getState(),n=e!==a.b.CALL_REQUEST&&e!==a.b.DIALOG;t!==a.b.INVITE||this.props.isBotEnabled||(!l.a.isOneClickInviteEnabled()||l.a.isOneClickInviteEnabled()&&n)&&(this.publishEvent(_.e.s.offline.HIDE_INVITE),this.publishEvent(_.e.s.x_widget.RESET_POS_X_BUTTON))},e.prototype.__showInvite=function(t){this.publishEvent(_.e.s.dialog.HIDE_RATE),u.a.getAppType()===v.a.MOBILE?this.publishEvent(_.e.s.invite.MOB_INVITE,t):l.a.isOneClickInviteEnabled()||l.a.isBotEnabled()?this.__showOneClickInvite(t||{}):(this.publishEvent(_.e.s.invite.SHOW_INVITE,t),this.publishEvent(_.e.s.site.LABEL_DRAW,{chat_available:this.props.isAvailableChat}),this.publishEvent(_.e.s.x_widget.CHANGE_POS_X_BUTTON)),t&&t.id&&this.storeEventLog(new f.a.event.ShowInvitation(String(t.id)))},e.prototype.__showOneClickInvite=function(t){var e=this;!0===t.online?this.publishEvent(_.e.s.invite.CHAT_LIKE_INVITE,t):this.props.isBotEnabled||e.asyncRequest(new f.a.wapi.GetOfflineAvailableGroups,p.a.OFFLINE_AVAILABLE_GROUPS,function n(i){if(i instanceof f.b.OfflineAvailableGroups){var s=i.getGroups().map(function(t){return t.encodeData()});!function(n){t.groups=n,e.publishEvent(_.e.s.invite.OFFLINE_LIKE_INVITE,t)}(s)}e.removeApiListener(p.a.MEMBER_LIST,n)})},e}(s.a);Object(r.a)(_.e.w.invite.INVITE_CLOSE,T,function(){this.transitState(a.a.CLOSE)}),Object(r.a)(_.e.w.invite.CALL_IN_INVITE,T,function(){var t=this.__storage.get("last-invite");t!==d.b.NO_DATA&&this.props.isAvailableChat===t.online?(this.publishEvent(_.e.s.dialog.LABEL_DISABLE),this.publishEvent(_.e.s.site.LABEL_DRAW,{chat_available:this.props.isAvailableChat}),this.transitState(a.a.CALL_INVITE,t)):this.transitState(a.a.CLOSE)});var O=function(){var t={action:b.a.CHAT_BOT,avatar:l.a.getBotAvatar(),name:l.a.getBotName(),greeting_message:l.a.getGreetingBotMessage(),id:"bot",label:"",member_id:"*",welcome_chat:null,welcome_lead:null},e=new S.a(t);return m.a.getMappedCondition(e,null,null)};Object(r.a)(_.e.w.label.MOB_START_CHAT_CLICK,T,function(t){switch(this.getState()){case a.b.DIALOG_HIDDEN:this.props.isOmniButtonEnabled&&u.a.getDialog()||this.props.isAvailableChat?this.transitState(a.a.SHOW,t):this.transitState(a.a.OFFLINE,t);break;case a.b.INVITE:var e=this.__storage.get("last-invite");this.publishEvent(_.e.s.invite.CHAT_LIKE_INVITE,e);break;case a.b.LABEL:if(this.props.isBotEnabled&&l.a.isChatEnabled()&&!this.props.isBannedVisitor){var n=O();this.transitState(a.a.INVITE),this.publishEvent(_.e.s.invite.CHAT_LIKE_INVITE,n);break}this.transitState(a.a.DIALOG);break;case a.b.CALL_REQUEST_HIDDEN:this.props.isAvailableChat?this.transitState(a.a.CONTINUE_DIALOG):this.transitState(a.a.OFFLINE);break;default:this.transitState(a.a.OFFLINE,t)}}),Object(r.a)(_.e.w.label.CHAT_CLICK,T,function(t){if(this.getState()===a.b.INVITE){if(this.props.isBotEnabled&&l.a.isChatEnabled()&&!this.props.isBannedVisitor){var e=O();return void(t&&t.initial_message?this.transitState(a.a.DIALOG,t):this.transitState(a.a.INVITE,e))}this.props.isAvailableChat?this.transitState(a.a.DIALOG,t):this.transitState(a.a.OFFLINE)}}),Object(r.a)(_.e.w.invite.INVITATION_WINDOW_SHOWN,T,function(t){this.publishEvent(_.e.s.api.INVITATION_WINDOW_SHOWN,t)}),Object(r.a)(_.e.w.invite.INVITATION_DENIED,T,},"./src/service/offline.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return T});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/app/app.ts"),o=n("./src/app/states/states.ts"),c=n("./src/settings/props.ts"),u=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),l=(n.n(u),n("./src/e.js")),_=(n.n(l),n("./src/io/response/types.ts")),d=n("./src/io/index.ts"),p=n("./src/io/request/widgets-api/util.ts"),f=n("./src/redux-store/reducers/availability/selectors.ts"),g=n("./src/redux-store/reducers/visitor/selectors.ts"),v=n("./src/redux-store/actions/set-visitor-info.ts"),h=n("./src/redux-store/reducers/account-settings/selectors.ts"),E=n("./src/service/prechats.ts"),b=n("./src/io/request/types.ts"),m=n("./src/util/util.ts"),S=[l.e.w.offline.CREATE_LEAD,l.e.w.offline.OFFLINE_CLOSE,l.e.w.invite.CALL_BACK_CLICK,l.e.w.offline.HIDE_CALL_REQUEST,l.e.w.offline.CHAT_CLOSE,l.e.w.offline.OFFLINE_DRAW_LOG,l.e.w.offline.CREATE_OFFLINE_CONVERSATION,l.e.s.api.SHOW_OFFLINE_DEPARTMENTS,l.e.w.offline.CALL_IN_OFFLINE],I=[l.e.s.offline.OFFLINE_DRAW,l.e.s.offline.CALL_REQUEST_DRAW,l.e.s.dialog.LABEL_HIDE,l.e.s.site.LABEL_DRAW,l.e.s.offline.HIDE_INVITE,l.e.s.dialog.OFFLINE_DRAW_LOG,l.e.s.api.OFFLINE_MESSAGE_SENT,l.e.s.api.CALLBACK_SENT,l.e.s.api.SHOW_OFFLINE_DEPARTMENTS],y=A={setVisitorInfo:v.b},T=function(t){function e(e,n,i,s,r){var a=t.call(this,"offline",y,A)||this;return a.__api=i,a.__storage=r,a.publishEvents(n,I),a.listenEvents(e,S),a.registerApi(i),a.registerState(s,[o.b.OFFLINE,o.b.CALL_REQUEST,o.b.INVITE,o.b.CALL_REQUEST_HIDDEN,l.e.w.offline.CHAT_CLOSE,o.b.LABEL,o.b.DIALOG_HIDDEN]),a}return i.c(e,t),e.prototype.updateReduxState=e.prototype.onState=function(t,e){var n=e||{},i=this;function s(t){t instanceof d.b.OfflineAvailableGroups&&i.__openWindow(t.getGroups(),n)}function r(){i.asyncRequest(new d.a.wapi.GetOfflineAvailableGroups,_.a.OFFLINE_AVAILABLE_GROUPS,s),i.publishEvent(l.e.s.site.LABEL_HIDE),c.a.isOneClickInviteEnabled()||i.publishEvent(l.e.s.offline.HIDE_INVITE)}t===o.b.OFFLINE?r():t===o.b.CALL_REQUEST?r():t!==o.b.CALL_REQUEST_HIDDEN&&t!==l.e.w.offline.CHAT_CLOSE||this.publishEvent(l.e.s.site.LABEL_DRAW,{chat_available:this.props.isAvailableChat})},e.prototype.onStateLeave=function(){},e.prototype.__openWindow=function(t,e){var n=this,i=e instanceof Object?e:{},s=this,r=function(t,e,i){var r=t.departmentId;return t.chat_available=n.props.isAvailableChat,t.isChatExist=null!==a.a.getDialog(),t.groups=function(t,e,n){var i=s.__storage.get(e);if("string"==typeof n){var r=t;return t.some(function(t){return t.getId()===n})&&(r=t.filter(function(t){return t.getId()===n})),r.map(function(t){return t.encodeData()})}return i&&i.length?i:c.a.isOfflineServiceEnabled()?t.map(:[]}(e,i,r),t.isCallbackActive=n.props.isCallbackActive,t};switch(this.getState()){case o.b.OFFLINE:this.publishEvent(l.e.s.offline.OFFLINE_DRAW,r(i,t,"set-offline-groups"));break;case o.b.CALL_REQUEST:this.publishEvent(l.e.s.offline.CALL_REQUEST_DRAW,r(i,t,"set-call-request-groups")),this.storeEventLog(new d.a.event.ShowCallRequest)}},e.start=function(t,n,i,s){new e(t,n,i,s,a.a.createCrossStorage("offline"))},e.__getOfflineMessageText=function(t){var e={CALLBACK_ME:m.a.getTranslation("call_me_back"),FROM:m.a.getTranslation("from"),TILL:m.a.getTranslation("till"),RECOMMENDED_DATE:m.a.getTranslation("recommended_date"),ANY_DAY:m.a.getTranslation("on_any_day"),MONTH_NAMES:m.a.getTranslation("months")},n=t.message;if(t["time-start"]&&t["time-end"]&&(n+=["",e.CALLBACK_ME,e.FROM,String(t["time-start"]),e.TILL,String(t["time-end"])].join(" ")),a.a.isMobileType())if(t.datepicker){var i=t.datepicker.split("-")[1]-1,s=t.datepicker.split("-")[2];t.datepicker=e.MONTH_NAMES[i]+", "+s}else t.datepicker=e.ANY_DAY;return t.datepicker&&(n+=["",e.RECOMMENDED_DATE,String(t.datepicker)].join(" ")),n},e}(s.a);Object(r.a)(l.e.w.offline.OFFLINE_DRAW_LOG,T,function(){this.storeEventLog(new d.a.event.ShowOffline)}),Object(r.a)(l.e.w.offline.CALL_IN_OFFLINE,T,function(){this.transitState(o.a.OFFLINE)}),Object(r.a)(l.e.s.api.SHOW_OFFLINE_DEPARTMENTS,T,function(t){this.__storage.set("set-offline-groups",t)}),Object(r.a)(l.e.s.api.SHOW_CALL_REQUEST_DEPARTMENTS,T,,Object(r.a)(l.e.w.offline.CREATE_OFFLINE_CONVERSATION,T,function(t){var e=t.group,n=t.name||this.props.visitorName,i=t.email,s=t.message,r=t.employeeId,o=t.phone,c=a.a.createSubject(e);this.actionCreators.setVisitorInfo({name:n,email:i});var _=p.a.createCommunicationAttrs(n,e,c,r),f=new u.model.FeedbackForm(i,s),g=Object(E.b)(o?[{key:"phone",value:o}]:[]),v=Object(E.a)(g);this.__api.send(new d.a.wapi.CreateFeedbackForm(_,f,v)),this.publishEvent(l.e.s.api.OFFLINE_MESSAGE_SENT,t)}),Object(r.a)(l.e.w.offline.CREATE_LEAD,T,function(t){var e,n=t.name||this.props.visitorName,i=t.phone,s=t.message,r=t.group,o=(e=t.datepicker,isNaN(new Date(e).valueOf())?null:e),_=p.a.parseTime(t["time-start"]),f=p.a.parseTime(t["time-end"]),g=a.a.createSubject(r);if(this.actionCreators.setVisitorInfo({name:n,phone:i}),c.a.isOfflineServiceEnabled()&&t.type_id===b.a.CALL_REQUEST){var v=p.a.createCommunicationAttrs(n,r,g),h=new u.model.CallbackRequest(i,s,o,_,f),m=Object(E.b)([]),S=Object(E.a)(m);this.__api.send(new d.a.wapi.CreateCallbackRequest(v,h,S)),this.publishEvent(l.e.s.api.CALLBACK_SENT,t)}}),Object(r.a)(l.e.w.offline.OFFLINE_CLOSE,T,function(){var t=this.getState(),e=null!==a.a.getDialog();switch(t){case o.b.CALL_REQUEST:this.storeEventLog(new d.a.event.ClickCallRequestClose);break;case o.b.OFFLINE:this.storeEventLog(new d.a.event.ClickOfflineClose)}e?this.transitState(o.a.HIDE):this.transitState(o.a.CLOSE)}),Object(r.a)(l.e.w.offline.HIDE_CALL_REQUEST,T,function(){this.transitState(o.a.HIDE)}),Object(r.a)(l.e.w.invite.CALL_BACK_CLICK,T,function(t){c.a.isCallbackEnabled()&&this.transitState(o.a.CALL_REQUEST,t)})},"./src/service/prechats.ts":function(t,e,n){"use strict";n.d(e,"c",function(){return c}),n.d(e,"b",function(){return u}),n.d(e,"a",function(){return l});var i=n("./node_modules/@livetex/widgets-api-service-client/bin/index.js"),s=(n.n(i),n("./src/data/conversation-attribute-type.ts")),r=n("./src/app/app.ts"),a=null,o=function(){return null===a&&(a=r.a.createCrossStorage("prechat-storage")),a},c=u=function(t){var e=o().get("set-prechat"),n=e.visible||{},i=t;function r(t,e,n){for(var i=Object.keys(t),r=0,a=i.length;r<a;r+=1){var o=!1;if(!n)for(var c=0,u=e.length;c<u;c+=1)e[c].key===i[r]&&""!==e[c].key&&(o=!0);o||e.push({key:i[r],value:t[i[r]],is_hidden:n,type:s.a.STRING})}return e}return i=r(e.hidden||{},i=r(n,i,!1),!0)},l=function(t){var e=_(t),n=e.visiblePrechats,s=e.hiddenPrechats;return new i.model.SiteChatRequest(n,s)},_=function(t){var e={},n={};return t.forEach(function(t){var i=t.key,s=t.value;t.is_hidden?n[i]=s:e[i]=s}),{visiblePrechats:e,hiddenPrechats:n}}},"./src/service/scripts/condition-store.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=new())},"./src/service/scripts/conditions/condition.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return l});var i=n("./src/service/scripts/index.ts"),s=n("./src/data/factory/factory.ts"),r=n("./src/data/data.ts"),a=n("./src/data/group.ts"),o=n("./src/data/member.ts"),c=n("./src/util/uri/uri.ts"),u=n("./src/app/app.ts"),l=function(){function t(t){this.__id=t.id||r.c,this.__action=t.action,this.__welcomeChat=t.welcome_chat,this.__welcomeLead=t.welcome_lead,this.__greeting_message=t.greeting_message,this.__confirmationLead=t.confirmation_lead,this.__xsetting=t.xwidget?t.xwidget:{},this.__days=this.__xsetting.days instanceof Array?this.__xsetting.days:null,this.__intervalBegin=isNaN(parseInt(this.__xsetting.interval_begin,10))?null:parseInt(this.__xsetting.interval_begin,10),this.__intervalEnd=isNaN(parseInt(this.__xsetting.interval_end,10))?null:parseInt(this.__xsetting.interval_end,10),this.__departmentRequired=Boolean(this.__xsetting.department_required),this.__showDepartments=Boolean(this.__xsetting.show_departments),this.__showAlways="true"===this.__xsetting.show_always,this.__groupCache=t.routing&&t.routing.departments?t.routing.departments:[],this.__group=a.a.ANY_GROUP_ID,t.routing instanceof Object&&t.routing.department_id&&(this.__group=t.routing.department_id),this.__member=o.a.ANY_MEMBER_ID,t.routing instanceof Object&&("number"==typeof t.routing.employee_id||"string"==typeof t.routing.employee_id?this.__member=t.routing.employee_id:t.routing.employee_id instanceof Array&&(this.__member=t.routing.employee_id.toString())),this.__geoLocation=t.locations&&"[]"!==t.locations?t.locations:[],this.__geoExcludeLocation=t.exclude_locations&&"[]"!==t.exclude_locations?t.exclude_locations:[],this.__condition=t.conditions||{},this.__isLocationExclude="boolean"==typeof t.is_locations_exclude&&t.is_locations_exclude,this.__isPageUrlExclude="excluded"===this.__condition.page_type,this.__oncePerDay="true"===this.__condition.is_once_per_day,this.__dayTriggerLimit=null,this.__sessionTriggerLimit=null;var e="number"==typeof this.__condition.max_count?this.__condition.max_count:null;this.isSessionLimit()?this.__sessionTriggerLimit=this.isXAction()?1:e:this.__dayTriggerLimit=this.isXAction()?1:e,this.__xbuttonOpener="boolean"==typeof t.open_popup?t.open_popup:"string"==typeof t.open_popup&&"true"===t.open_popup,this.__xPhoneValue=t.x_phone_value||""}return t.prototype.getDays=function(){return this.__days},t.prototype.isXShowAlways=function(){return this.__showAlways},t.prototype.isXAction=function(){return-1!==[i.a.X_BUTTON,i.a.X_WINDOW].indexOf(this.getAction())},t.prototype.getGreetingBotMessage=function(){return this.__greeting_message},t.prototype.isSessionLimit=t.prototype.isDepartmentRequired=function(){return this.__departmentRequired},t.prototype.isDepartmentsShow=function(){return this.__showDepartments},t.prototype.getDepartments=function(){return this.__groupCache},t.prototype.getIntervalBegin=function(){return this.__intervalBegin},t.prototype.getIntervalEnd=function(){return this.__intervalEnd},t.prototype.getWelcomeChat=function(){return this.__welcomeChat},t.prototype.getWelcomeLead=function(){return this.__welcomeLead},t.prototype.getConfirmationLead=function(){return this.__confirmationLead},t.prototype.getAction=function(){return this.__action},t.prototype.geoLocation=function(){return this.__geoLocation},t.prototype.geoExcludeLocation=function(){return this.__geoExcludeLocation},t.prototype.getId=function(){return this.__id},t.prototype.getGroup=t.prototype.getMember=function(){return this.__member},t.prototype.isLocationExclude=function(){return this.__isLocationExclude},t.prototype.isPageUrlExclude=function(){return this.__isPageUrlExclude},t.prototype.limitPerSession=function(){return this.__sessionTriggerLimit?this.__sessionTriggerLimit:null},t.prototype.limitPerDay=t.prototype.pageCount=function(){return"number"==typeof this.__condition.page_count?this.__condition.page_count:null},t.prototype.urlMatch=function(){return"string"==typeof this.__condition.page_url?this.__condition.page_url:null},t.prototype.urlExclude=function(){return"string"==typeof this.__condition.exclude_page_url?new c.a(this.__condition.exclude_page_url):null},t.prototype.mainPage=function(){return"home"===this.__condition.page_type||null},t.prototype.internalPage=function(){return"internal"===this.__condition.page_type||null},t.prototype.anyPage=function(){return"any"===this.__condition.page_type||null},t.prototype.pageTimeout=function(){return"number"==typeof this.__condition.page_time?this.__condition.page_time:null},t.prototype.siteTimeout=t.prototype.newUser=function(){var t=this.__condition.is_new_visitor;return"boolean"==typeof t?!0===t||null:"true"===t||null},t.prototype.titleMatch=function(){return"string"==typeof this.__condition.page_title&&this.__condition.page_title.length>0?this.__condition.page_title:null},t.prototype.onceADay=t.prototype.limitPerVisit=function(){return"number"==typeof this.__condition.max_count&&this.__condition.max_count>0?this.__condition.max_count:null},t.prototype.goOutMan=function(){return"true"===this.__condition.is_leave_site||null},t.prototype.getCurrentChatFeature=function(){return s.a.createFeature(i.a.CHAT,this.getMember(),this.getGroup(),u.a.getSite())},t.prototype.getXbuttonOpener=function(){return this.__xbuttonOpener},t.prototype.getXPhoneValue=function(){return this.__xPhoneValue},t}()},"./src/service/scripts/conditions/conditions.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return g});var i=n("./src/util/location/location.ts"),s=n("./src/tabs/tabs.ts"),r=n("./src/app/page/page.ts"),a=n("./src/logger/logger.ts"),o=n("./src/service/scripts/x-widget/util.ts"),c=n("./src/service/scripts/scripts.ts"),u=n("./src/service/scripts/index.ts"),l=n("./src/service/scripts/x-widget/call-helper.ts"),_=n("./src/service/scripts/util.ts"),d=n("./src/data/page.ts"),p=n("./src/redux-store/index.ts"),f=n("./src/redux-store/reducers/availability/selectors.ts"),g=function(t){return[function(e){return v(e,t)},function(e){return h(e,t)},function(e){return E(e,t)},function(e){return b(e,t)},function(e){return m(e,t)},function(e){return y(e,t)},function(e){return S(e,t)},function(e){return I(e,t)},function(e){return A(e,t)},function(e){return T(e,t)},function(e){return O(e,t)},function(e){return L(e,t)},function(e){return w(e,t)},function(e){return C(e,t)},function(e){return D(e,t)},},v=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing isWorkDay"),null===t.getDays()||(o.a.isDayAvailable(t.getDays())||t.isXShowAlways())},h=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing isWorktime"),null===t.getIntervalBegin()||null===t.getIntervalEnd()||(o.a.isTimeAvailable(t.getIntervalBegin(),t.getIntervalEnd())||t.isXShowAlways())},E=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing pageCount"),null===t.pageCount()||s.a.isActiveTab()&&r.a.pageCount()>=t.pageCount()},b=function(t,e){a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing limitPerSession");var n=t.limitPerSession(),i=e.get(c.b+t.getId());return t.isSessionLimit()&&n?(t.isXAction()&&(i=t.getAction()===u.a.X_WINDOW?e.get(l.c)||i:e.get(l.b)||i),i<n):!t.isXAction()||(i=t.getAction()===u.a.X_WINDOW?e.get(l.c)||i:e.get(l.b)||i)<(n=n||1)},m=function(t,e){if(a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing limitPerDay"),!t.isSessionLimit()&&t.limitPerDay()){var n=t.limitPerDay();return e.get(c.a+t.getId())<n}return!0},S=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing mainPage"),null===t.mainPage()||0===i.a.getLocation().split("/")[3].length},I=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing internalPage"),null===t.internalPage()||0!==i.a.getLocation().split("/")[3].length},y=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing anyPage"),!0},A=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing newUser"),null===t.newUser()||1===r.a.visitCount()},T=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing titleMatched"),!(null!==t.titleMatch()&&!t.isPageUrlExclude())||-1!==window.parentTitle.toLowerCase().indexOf(t.titleMatch().toLowerCase().trim())},O=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing urlMatched"),null===t.urlMatch()||-1!==String(i.a.getLocation()).toUpperCase().indexOf(encodeURI(t.urlMatch()||"").toUpperCase())},L=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing urlExcluded"),null===t.urlExclude()||!t.urlExclude().isEqual(i.a.getLocation())},w=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing geoMatched"),N(t.geoLocation())},C=function(t,e){a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing geoExclude");var n=t.geoExcludeLocation();return!(n.length>0)||!N(n)},N=function(t){if(t.length>0){var e=!1,n=r.a.get();return n instanceof d.a&&(e=_.a.isVisitorRegionLocated(t,n.getGeoData().region)&&_.a.isVisitorCountryLocated(t,n.getGeoData().country_name)&&_.a.isVisitorCityLocated(t,n.getGeoData().city_name)),e}return!0},D=function(t,e){return a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing onceADay"),null===t.onceADay()||!Boolean(e.get(c.b+t.getId()))},R=function(t,e){if(a.a.debug("condition: "+t.getId()+", with action: "+t.getAction()+", passing compareAction"),-1!==[u.a.CHAT,u.a.CHAT].indexOf(t.getAction())){var n=Object(f.b)(p.a.getState());if(t.getAction()===u.a.CHAT)return n;if(t.getAction()===u.a.LEAD)return!n}return!0}},"./src/service/scripts/index.ts":function(t,e,n){"use strict";n.d(e,"f",function(){return g}),n.d(e,"g",function(){return v}),n.d(e,"a",function(){return s}),n.d(e,"c",function(){return i}),n.d(e,"e",function(){return f}),n.d(e,"b",function(){return d}),n.d(e,"d",function(){return p});var i,s,r=n("./src/service/scripts/x-widget/button.ts"),a=n("./src/service/scripts/x-widget/window.ts"),o=n("./src/service/scripts/invitation/chat.ts"),c=n("./src/service/scripts/invitation/lead.ts"),u=n("./src/service/scripts/invitation/manual.ts"),l=n("./src/service/scripts/x-widget/call-helper.ts"),_=n("./src/service/scripts/x-widget/tabs-resolver.ts");!i||(i={})),s||(s={}));var d="no-avatar.png",p="014221390ec5766879b378f1594c8c7c.png",f={__onStart:!0,__isXwidgetOpen:!1},g=function(t,e,n,i){new r.a(t,e,n,i),new o.a(t,e,n,i),new c.a(t,e,n,i),new u.a(t,e,n,i),new a.a(t,e,n,i),new l.a(t,e,n),new _.a(t,e)},v=function(t,e,n,i){new o.a(t,e,n,i),new c.a(t,e,n,i)}},"./src/service/scripts/invitation/chat.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return E});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/app/states/states.ts"),r=n("./src/app/app.ts"),a=n("./src/settings/props.ts"),o=n("./src/data/group.ts"),c=n("./src/data/member.ts"),u=n("./src/service/scripts/scripts.ts"),l=n("./src/service/scripts/index.ts"),_=n("./src/service/scripts/invitation/util.ts"),d=n("./src/io/response/types.ts"),p=n("./src/redux-store/reducers/availability/selectors.ts"),f=n("./src/redux-store/reducers/account-settings/selectors.ts"),g=[],v=[],h=function(t){return{isAvailableChat:Object(p.b)(t),invitationRules:Object(f.b)(t),isBotEnabled:Object(f.e)(t)}},E=function(t){function e(e,n,r,o){var c=t.call(this,l.c.CHAT,e,n,g,v,r,o,h)||this;c.__chatInvitationRules=Object.keys(c.props.invitationRules).reduce(function(t,e){var n;return c.props.invitationRules[e].action===l.a.CHAT?i.a({},t,((n={})[e]=c.props.invitationRules[e],n)):t},{});var u=c.__chatInvitationRules,d={bot:{action:l.a.CHAT_BOT,avatar:a.a.getBotAvatar(),name:a.a.getBotName(),greeting_message:a.a.getGreetingBotMessage(),id:"bot",label:"",member_id:"*",welcome_chat:null,welcome_lead:null}};c.props.isBotEnabled&&(u=Object.keys(u).length?Object.keys(u).reduce(function(t,e){var n;return i.a({},t,((n={})[e]=i.a({},d.bot,c.props.invitationRules[e],{action:l.a.CHAT_BOT}),n))},{}):{},c.__chatInvitationRules=u);var p=c.props.isBotEnabled?l.a.CHAT_BOT:l.a.CHAT;c.__settings=Object.keys(u).length?c._parseSettings(u,[p]):[];c.props.isBotEnabled&&function(t){if(t.__action===l.a.CHAT_BOT){var e=_.a.getMappedCondition(t,null,null);c.transitState(s.a.BOT,e)}}(c._parseSettings(d,[l.a.CHAT_BOT])[0]);return c.__stateNotRestored=!0,c}return i.c(e,t),e.prototype.onState=function(t,e){this.__stateNotRestored&&(this._registerRules(this.__settings),this.__stateNotRestored=!1),t===s.b.INVITE&&e&&e.id&&(e.action===l.a.CHAT||e.action===l.a.CHAT_BOT)&&this._saveCountById(e.id)},e.prototype.onStateLeave=function(){},e.prototype._action=function(t,e){var n=this,i=null!==r.a.getDialog();if(a.a.isChatEnabled()&&!l.e.__isXwidgetOpen&&!i){if(t.getAction()===l.a.CHAT_BOT){if(Object.keys(this.__chatInvitationRules).length&&l.e.__onStart){var u=_.a.getMappedCondition(t,null,null);l.e.__onStart=!1,n.transitState(s.a.INVITE,u)}return}if(Object.keys(n.__chatInvitationRules).length)if(t.getGroup()===o.a.ANY_GROUP_ID&&t.getMember()===c.a.ANY_MEMBER_ID)n._getAvailableGroups(function(e){if(e.length>0){var i=e[Math.floor(Math.random()*e.length)].getId();n._performInviteTransition(n.__transitToInvite(i),t)}});else if(t.getMember()===c.a.ANY_MEMBER_ID){var d=t.getGroup();n.__isGroupAvailable(d,function(e){e&&n._performInviteTransition(n.__transitToInvite(),t)})}else n._isMemberAvailable(t.getMember(),function(e){e&&n._performInviteTransition(n.__transitToInvite(),t)})}},e.prototype.__isGroupAvailable=function(t,e){this._getAvailableGroups(function(n){var i=n.some(function(e){return e.getId()===t});e(i)})},e.prototype.__monitorOnlineState=function(t,e){var n=this;this.addApiListener(d.a.GROUP_AVAILABILITY_CHANGE,function(t){var i=t.getGroupId(),r=t.getAvailabilityLevel();String(e)===String(i)&&(r.isAvailable()||n.getState()!==s.b.INVITE||n.transitState(s.a.CLOSE))})},e.prototype.__transitToInvite=function(t){var e,n=this;return function(i){var r=this,a=t||i.getGroup();n._getAvailableMember(function(t){e=_.a.getMappedCondition(i,t,a),n.__monitorOnlineState(i,a),(n.getState()===s.b.INVITE&&l.e.__onStart||n.getState()!==s.b.INVITE)&&r.props.isAvailableChat&&(n.transitState(s.a.INVITE,e),l.e.__onStart=!1)},a,i.getMember())}},e}(u.c)},"./src/service/scripts/invitation/lead.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return E});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/settings/props.ts"),r=n("./src/app/app.ts"),a=n("./src/app/states/states.ts"),o=n("./src/service/scripts/scripts.ts"),c=n("./src/service/scripts/index.ts"),u=n("./src/data/status.ts"),l=n("./src/service/scripts/index.ts"),_=n("./src/service/scripts/invitation/util.ts"),d=n("./src/io/response/types.ts"),p=n("./src/redux-store/reducers/availability/selectors.ts"),f=n("./src/redux-store/reducers/account-settings/selectors.ts"),g=[],v=[],h=E=function(t){function e(e,n,i,s){var r=t.call(this,l.c.LEAD,e,n,g,v,i,s,h)||this;return r.__settings=r._parseSettings(r.props.invitationRules,[l.a.LEAD]),r.__stateNotRestored=!0,r}return i.c(e,t),e.prototype.onState=function(t,e){this.__stateNotRestored&&s.a.isLeadEnabled()&&!this.props.isAvailableChat&&!this.props.isBotEnabled&&(s.a.isHiddenOffline()||(this._registerRules(this.__settings),this.__stateNotRestored=!1)),t===a.b.INVITE&&e&&e.id&&e.action===l.a.LEAD&&this._saveCountById(e.id)},e.prototype.onStateLeave=function(){},e.prototype._action=function(t){s.a.isHiddenOffline()||this.props.isAvailableChat||c.e.__isXwidgetOpen||this._performInviteTransition(this.__transitToInvite,t)},e.prototype.__monitorOfflineState=function(){var t=this;this.addApiListener(d.a.STATE,function e(n){n.getEntity().getFullName()===r.a.getSite().getFullName()&&n.getStatus()===u.a.ONLINE&&t.getState()===a.b.INVITE&&(t.removeApiListener(d.a.STATE,e),t.transitState(a.a.CLOSE))})},e.prototype.__transitToInvite=function(t){var e=this;e._getAvailableMember(function(n){var i=_.a.getMappedCondition(t,n);(e.getState()===a.b.INVITE&&c.e.__onStart||e.getState()!==a.b.INVITE)&&(e.__monitorOfflineState(),e.transitState(a.a.INVITE,i),c.e.__onStart=!1)},t.getGroup(),t.getMember())},e}(o.c)},"./src/service/scripts/invitation/manual.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return E});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/macros.ts"),r=n("./src/app/states/states.ts"),a=n("./src/settings/props.ts"),o=n("./src/data/member.ts"),c=n("./src/data/group.ts"),u=n("./src/e.js"),l=(n.n(u),n("./src/service/scripts/scripts.ts")),_=n("./src/service/scripts/index.ts"),d=n("./src/service/scripts/invitation/util.ts"),p=n("./src/io/response/types.ts"),f=n("./src/io/response/invite.ts"),g=n("./src/io/index.ts"),v=[],h=[u.e.s.api.SHOW_INVITE],E=function(t){function e(e,n,i,s){var r=t.call(this,_.c.CHAT,e,n,v,h,i,s)||this,a=r;return r.__apiCallbacks={},r.addApiListener(p.a.SEND_INVITE,function(t){t instanceof f.a&&a.__processInvite(t.getInvite())}),r.listenEvents(e,h),r}return i.c(e,t),e.prototype.__setCallback=function(t,e){var n=this;this.__apiCallbacks[t]=,e.prototype.__removeApiCallbacks=e.prototype.__cancelCb=function(t){this.__apiCallbacks.cancel&&this.__apiCallbacks.cancel(t||"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0433\u043e \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430")},e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e.prototype.__processInvite=function(t){this.sendRequest(new g.a.livetex.SetInvite(t));var e=d.a.toCondition(t);e&&this._action(e)},e.prototype._action=function(t){var e=this,n=t.getMember()!==o.a.ANY_MEMBER_ID?t.getMember():void 0;if(a.a.isChatEnabled()&&!_.e.__isXwidgetOpen)if(t.getGroup()===c.a.ANY_GROUP_ID)e._getAvailableGroups(function(i){if(i.length>0){var s=i[Math.floor(Math.random()*i.length)].getId();e._performInviteTransition(e.__transitToInvite(s,n),t)}else e.__cancelCb()});else{var i=t.getGroup();e.__isGroupAvailable(i,function(s){s?e._performInviteTransition(e.__transitToInvite(i,n),t):e.__cancelCb()})}},e.prototype.__isGroupAvailable=function(t,e){this._getAvailableGroups(function(n){var i=n.some(;e(i)})},e.prototype.__transitToInvite=function(t,e){var n=this;return function(i){var s=function(e){if(e){var s=d.a.getMappedCondition(i,e,t);s.manual=!0;var a=function(){n.transitState(r.a.INVITE,s),n.__apiCallbacks.complete(e.serializeData(u.e.s.api.SHOW_INVITE))};n.getState()===r.b.INVITE?(n.transitState(r.a.CLOSE),setTimeout(a,1e3)):n.getState()===r.b.LABEL&&a()}else n.__cancelCb()};e?n._getGroupAvailableMember(function(t){var n=t.filter(function(t){return t.getId()===e&&t.isAvailable()})[0];s(n)},t):n._getAvailableMember(s,t,i.getMember())}},e}(l.c);Object(s.a)(u.e.s.api.SHOW_INVITE,E,function(t){if(_.e.__isXwidgetOpen)t.cancel("\u041e\u043a\u043d\u043e \u0432\u043e\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f \u0443\u0436\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u043e");else if(this.getState()!==r.b.LABEL)t.cancel("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0441\u0435\u0439\u0447\u0430\u0441");else{var e=t.invite;this.__setCallback("cancel",t.cancel),this.__setCallback("complete",t.complete),this.__processInvite(e)}})},"./src/service/scripts/invitation/util.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/settings/props.ts"),r=n("./src/util/util.ts"),a=n("./src/data/group.ts"),o=n("./src/data/member.ts"),c=n("./src/e.js"),u=(n.n(c),n("./src/service/scripts/conditions/condition.ts")),l=n("./src/service/scripts/index.ts"),_=n("./src/redux-store/index.ts"),d=n("./src/redux-store/reducers/availability/selectors.ts");!function(t){t.truncate=function(t,e){var n=e||300;return t.length>n?t.substr(0,n-3)+"...":t},t.toCondition=function(e){var n={};return n.id=e.getId(),n.action="chat",n.confirmation_lead="",n.welcome_lead=t.truncate(e.getMemberFirstMessage()),n.welcome_chat=t.truncate(e.getMemberFirstMessage()),n.routing={},n.routing.department_id=e.getFeature().getGroup().getId()||a.a.ANY_GROUP_ID,n.routing.employee_id=e.getFeature().getMember().getId()||o.a.ANY_MEMBER_ID,n.conditions={},n.is_new_visitor="false",n.is_once_per_day="false",n.max_count=0,n.page_count=0,n.page_time=0,n.page_title="",n.page_type="any",n.page_url="",n.site_time=0,new u.a(n)},t.getMappedCondition=function(e,n,i){var o={};return(o=t.mapMemberData(o,n)).id=e.getId(),o.action=e.getAction(),o.greeting_message=s.a.isBotEnabled()?e.getGreetingBotMessage():null,o.welcome_chat=s.a.isBotEnabled()?null:e.getWelcomeChat(),o.welcome_lead=s.a.isBotEnabled()?null:e.getWelcomeLead(),o.start_dialog_with_bot=s.a.isBotEnabled(),o.member_id=e.getMember(),String(e.getGroup())===a.a.ANY_GROUP_ID&&null!=i?o.group_id=i:o.group_id=e.getGroup(),s.a.isBotEnabled()&&(o.group_id=""),e.getAction()===l.a.CHAT&&(o.invite_id=r.a.encodeBase64(e.getWelcomeChat())),o.online=Object(d.b)(_.a.getState()),e.getAction()===l.a.CHAT_BOT&&(o.invite_id=r.a.encodeBase64(s.a.getGreetingBotMessage()?e.getGreetingBotMessage():e.getWelcomeChat()),o.online=!0),o.offline=!o.online,o.callback=s.a.isCallbackEnabled(),o},t.mapMemberData=function(t,e){var n=s.a.getAvatarUrl();if(s.a.isBotEnabled())return t.avatar=s.a.getBotAvatar(),t.op_nickName=s.a.getBotName(),t.label=s.a.getBotHeadText(),t;if(""===n&&e){var i=e.getAvatarUrl();t.avatar=""!==i&&i!==l.b&&i!==l.d&&i,t.name=e.getNickName(),t.op_nickName=e.getNickName(),t.label=e.getLabel(),t.employee=e.serializeData(c.e.s.api.INVITATION_WINDOW_SHOWN)}else t.avatar=""!==n&&n,t.name="",t.label="";return t}}(i||(i={}))},"./src/service/scripts/scripts.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return b}),n.d(e,"b",function(){return m}),n.d(e,"c",function(){return S});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/app/app.ts"),a=n("./src/tabs/tabs.ts"),o=n("./src/util/date/date.ts"),c=n("./src/logger/logger.ts"),u=n("./src/service/scripts/conditions/conditions.ts"),l=n("./src/service/scripts/condition-store.ts"),_=n("./src/service/scripts/index.ts"),d=n("./src/data/member.ts"),p=n("./src/data/group.ts"),f=n("./src/service/scripts/conditions/condition.ts"),g=n("./src/service/scripts/triggers/go-out.ts"),v=n("./src/service/scripts/triggers/timer.ts"),h=n("./src/io/response/types.ts"),E=n("./src/io/index.ts"),b="trig_count",m="trig_count_sess",S=function(t){function e(n,i,s,a,o,c,u,d,p){var f=t.call(this,n,d,p)||this;return f.listenEvents(i,a),f.publishEvents(s,o),f.registerApi(c),f.registerState(u),e._storage?f._storage=e._storage:(f._storage=r.a.createCrossStorage(_.c.SCRIPTS),e._storage=f._storage),f._conditionStore=l.a,f}return i.c(e,t),e.prototype._registerRules=e.prototype.__registerRule=function(t){var e=this;new v.a(t,function(t){new g.a(t,function(t){return e.__condition(t)})})},e.prototype.__condition=function(t){Object(u.a)(this._storage).every(function(e){return e(t)})&&a.a.isActiveTab()&&this._action(t)},e.prototype._parseSettings=function(t,e){var n=[];for(var i in t){var s=new f.a(t[i]);-1!==e.indexOf(s.getAction())&&(n.push(s),this._conditionStore.addRule(t[i].id,s))}return n},e.prototype._getAvailableMember=function(t,e,n){e===p.a.ANY_GROUP_ID?(c.a.warn("Can't get invitation member: invitation should be bound to group",this),t(null)):n===d.a.ANY_MEMBER_ID?this.asyncRequest(new E.a.wapi.GetInvitationEmployee(e),h.a.INVITATION_EMPLOYEE,function(e){return t(e.getMember())}):this.asyncRequest(new E.a.wapi.PopulateMember(d.a.create(n)),h.a.POPULATE_MEMBER,},e.prototype._isMemberAvailable=function(t,e){this.asyncRequest(new E.a.wapi.IsEmployeesAvailable([t]),h.a.EMPLOYEES_AVAILABILITY,},e.prototype._getAvailableGroups=function(t){this.asyncRequest(new E.a.wapi.GetChatAvailableGroups,h.a.CHAT_AVAILABLE_GROUPS,function(e){e instanceof E.b.ChatAvailableGroups&&t(e.getGroups())})},e.prototype._getGroupAvailableMember=function(t,e){this.asyncRequest(new E.a.wapi.GetEmployees(e),h.a.MEMBER_LIST,function(e){e instanceof E.b.MembersList&&t(e.getMembers())})},e.prototype._performInviteTransition=function(t,e){var n=this;setTimeout(0)},e.prototype._saveCountById=e.prototype._saveCount=function(t){var e=m+t,n=this._storage.get(e);"number"==typeof n?n+=1:n=1,this._storage.set(e,n)},e.prototype._saveDailyCount=function(t){var e=b+t,n=this._storage.get(e);"number"==typeof n?n+=1:n=1,this._storage.setPermanently(e,n,(new o.a).getTimeTillMidnight())},e}(s.a)},"./src/service/scripts/triggers/go-out.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/service/scripts/triggers/trigger.ts"),r=n("./src/service/scripts/triggers/helpers/mouse-state.ts"),a=n("./src/event-emitter/index.ts"),o=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.__mouseState=new r.a,i.__mouseHandler=i.__storeMouseMove(),i.__GO_OUT_DEAL=[i.__deathArea,i.__quickMouseMove],i.DEATH_AREA_Y=80,i.EXTENDED_DEATH_AREA_Y=150,i.__condition.goOutMan()?i.__setMouseHandler():i._handlerWrapper(),i}return i.c(e,t),e.prototype.__setMouseHandler=function(){var t=this;a.a.listenEvent("on-mousemove-event-"+this.getId(),,a.a.publishEvent("add-mousemove-event",this.getId())},e.prototype.__removeMouseHandler=e.prototype.__storeMouseMove=function(){var t=this;return function(e){null!==e&&(t.__mouseState.aggregate(e),t.__checkGod())}},e.prototype.__checkGod=function(){for(var t=0,e=this.__GO_OUT_DEAL.length;t<e;t+=1){!1!==this.__GO_OUT_DEAL[t].call(this)&&(this.__removeMouseHandler(),this._handlerWrapper())}},e.prototype.__deathArea=function(){return this.__mouseState.getY()<=this.DEATH_AREA_Y},e.prototype.__quickMouseMove=function(){return-this.__mouseState.getVector()[1]>1.5*this.__mouseState.getAvgAbsVector()[1]&&this.__mouseState.getY()<=this.EXTENDED_DEATH_AREA_Y},e}(s.a)},"./src/service/scripts/triggers/helpers/math.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),function(t){t.modulo=t.vectorDiff=t.vectorMultiply=t.absVector=t.average=function(t,e,n){return(t+e*(n-1))/n},t.averageVector=function(e,n,i){return[t.average(e[0],n[0],i),t.average(e[1],n[1],i)]}}(i||(i={}))},"./src/service/scripts/triggers/helpers/mouse-state.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("./src/util/date/date.ts"),s=n("./src/service/scripts/triggers/helpers/math.ts"),r=function(){function t(){this.__position=[0,0],this.__prevPosition=[0,0],this.__count=0,this.__vector=[0,0],this.__vectorModulo=0,this.__avgVectorModulo=0,this.__absVector=[0,0],this.__avgAbsVector=[0,0],this.__prevTime=(new i.a).current(),this.__time=(new i.a).current()}return t.prototype.aggregate=function(t){var e=t.x,n=t.y;if(this.__prevTime=this.__time,this.__time=(new i.a).current(),e>=0&&n>=0){this.__prevPosition=this.__position,this.__position=[e,n],this.__count+=1;var r=(this.__time-this.__prevTime)/1e3;this.__count>1&&0!==r&&(this.__vector=s.a.vectorMultiply(s.a.vectorDiff(this.__position,this.__prevPosition),1e3/(this.__time-this.__prevTime)),this.__vectorModulo=s.a.modulo(this.__vector),this.__avgVectorModulo=s.a.average(this.__vectorModulo,this.__avgVectorModulo,this.__count-1),this.__absVector=s.a.absVector(this.__vector),this.__avgAbsVector=s.a.averageVector(this.__absVector,this.__avgAbsVector,this.__count-1))}},t.prototype.getY=t.prototype.getVector=function(){return this.__vector},t.prototype.getAvgAbsVector=function(){return this.__avgAbsVector},t}()},"./src/service/scripts/triggers/timer.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/util/date/date.ts"),r=n("./src/app/page/page.ts"),a=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.__condition.pageTimeout()?i.__initPageTimer():i.__condition.siteTimeout()?i.__initVisitTimer():i._handlerWrapper(),i}return i.c(e,t),e.prototype.__initPageTimer=function(){var t=1e3*this.__condition.pageTimeout()-this.__pageTime();this.__initTimer(t)},e.prototype.__initVisitTimer=function(){var t=1e3*this.__condition.siteTimeout()-this.__visitTime();this.__initTimer(t)},e.prototype.__initTimer=function(t){var e=this;t>0?setTimeout(function(){e._handlerWrapper()},t):this._handlerWrapper()},e.prototype.__pageTime=function(){return Math.floor((new s.a).current()-r.a.pageTime())},e.prototype.__visitTime=function(){return Math.floor((new s.a).current()-r.a.visitTime())},e}(n("./src/service/scripts/triggers/trigger.ts").a)},"./src/service/scripts/triggers/trigger.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){eturn t.prototype.getId=function(){return this.__id},t.prototype._handlerWrapper=t}()},"./src/service/scripts/util.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),function(t){t.timeout=function(t,e,n){return t>0?{timeout:1e3*t}:{}},t.isVisitorCountryLocated=function(e,n){return t.locator("country",!0)(e,n)},t.isVisitorRegionLocated=function(e,n){return t.locator("region")(e,n)},t.isVisitorCityLocated=t.locator=function(t,e){return function(n,i){for(var s=0,r=n.length,a=!1;s<r;){if("string"==typeof n[s][t]||"object"==typeof n[s][t]){if(""===n[s][t]||-1!==n[s][t].indexOf(i.toLowerCase())&&""!==i){a=!0;break}}else void 0!==n[s].city||e||(a=!0);s+=1}return a}}}(i||(i={}))},"./src/service/scripts/x-widget/button.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return E});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/macros.ts"),r=n("./src/store/storage.ts"),a=n("./src/e.js"),o=(n.n(a),n("./src/service/scripts/scripts.ts")),c=n("./src/service/scripts/index.ts"),u=n("./src/util/browser/browser.ts"),l=n("./src/service/scripts/x-widget/call-helper.ts"),_=n("./src/service/scripts/x-widget/util.ts"),d=n("./src/app/page/page.ts"),p=n("./src/io/index.ts"),f=n("./src/redux-store/reducers/account-settings/selectors.ts"),g=[a.e.s.x_widget.SHOW_X_BUTTON,a.e.s.x_widget.SHOW_X_BUTTON_INVITE,a.e.s.x_widget.REDRAW_X_BUTTON,a.e.s.x_widget.REMOVE_BUTTON],v=[a.e.w.x_widget.X_WIDGET_SEND_LEAD,a.e.w.x_widget.CLOSE_X_WIDGET,a.e.s.x_widget.REMOVE_BUTTON],h=function(t){return{invitationRules:Object(f.b)(t)}},E=function(t){function e(e,n,i,s){var r=t.call(this,c.c.X_BUTTON,e,n,v,g,i,s,h)||this;return r.__lastRule=null,r.__stateNotRestored=!0,r.__initStorage(),r.__settings=r._parseSettings(r.props.invitationRules,[c.a.X_BUTTON]),r}return i.c(e,t),e.prototype.onState=function(t){this.__stateNotRestored&&(this._registerRules(this.__settings),this.__stateNotRestored=!1)},e.prototype.onStateLeave=function(){},e.prototype._action=function(t){this.__isAvailable(t)&&(this.__lastRule=t,this.publishEvent(a.e.s.x_widget.SHOW_X_BUTTON,_.a.getMappedCondition(t)),this.storeEventLog(new p.a.event.ShowXWidgetButton(String(t.getId()))),this._storage.get("invite-shown")===d.a.visitCount()||t.getXbuttonOpener()||(this.publishEvent(a.e.s.x_widget.SHOW_X_BUTTON_INVITE),this._storage.set("invite-shown",d.a.visitCount())))},e.prototype.__isAvailable=e.prototype.__saveCount=function(t){if(t&&t.id){var e=t.id;this._saveCountById(e)}},e.prototype.__initStorage=function(){this._storage.get(l.b)===r.b.NO_DATA&&this._storage.set(l.b,0),this._storage.get("invite-shown")===r.b.NO_DATA&&this._storage.set("invite-shown",0)},e}(o.c);Object(s.a)(a.e.w.x_widget.CLOSE_X_WIDGET,E,function(){this.__lastRule&&this.__isAvailable(this.__lastRule)&&this.publishEvent(a.e.s.x_widget.REDRAW_X_BUTTON)}),Object(s.a)(a.e.w.x_widget.X_WIDGET_SEND_LEAD,E,,Object(s.a)(a.e.s.x_widget.REMOVE_BUTTON,E,function(){this.publishEvent(a.e.s.x_widget.REMOVE_BUTTON)})},"./src/service/scripts/x-widget/call-helper.ts":function(t,e,n){"use strict";n.d(e,"c",function(){return m}),n.d(e,"b",function(){return S}),n.d(e,"a",function(){return T});var i,s=n("./node_modules/tslib/tslib.es6.js"),r=n("./src/core/component.ts"),a=n("./src/core/macros.ts"),o=n("./src/tabs/event-type.ts"),c=n("./src/tabs/tabs.ts"),u=n("./src/e.js"),l=(n.n(u),n("./src/service/scripts/x-widget/util.ts")),_=n("./src/util/location/location.ts"),d=n("./src/util/date/date.ts"),p=n("./src/settings/props.ts"),f=n("./src/io/response/types.ts"),g=n("./src/io/index.ts"),v=n("./src/service/scripts/scripts.ts"),h=n("./src/redux-store/reducers/visitor/selectors.ts"),E=n("./src/event-emitter/index.ts"),b="x-call-helper",m="prsh-window",S="prsh-button",I=[u.e.s.x_widget.SHOW_CALL_BY_MEMBER,u.e.s.x_widget.SHOW_CALL_BY_VISITOR,u.e.s.api.CALL_STARTED,u.e.s.api.X_WINDOW_SHOWN],y=[u.e.w.offline.CREATE_LEAD,u.e.w.x_widget.X_WIDGET_SEND_LEAD,u.e.w.x_widget.X_WINDOW_SHOWN],A=function(t){return{visitorName:Object(h.d)(t)}},T=function(t){function e(e,n,i){var s=t.call(this,b,A)||this;s.__storage=v.c._storage,s.listenEvents(e,y),s.publishEvents(n,I),s.registerApi(i);var r=s;return s.addApiListener(f.a.CALL_ACCEPTED_BY_MEMBER,function(){r.publishEvent(u.e.s.x_widget.SHOW_CALL_BY_MEMBER),c.a.dispatch(o.a.X_MEMBER)}),s.addApiListener(f.a.CALL_ACCEPTED_BY_VISITOR,function(){r.publishEvent(u.e.s.x_widget.SHOW_CALL_BY_VISITOR),c.a.dispatch(o.a.X_VISITOR)}),s}return s.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e}(r.a);Object(a.a)(u.e.w.offline.CREATE_LEAD,T,,Object(a.a)(u.e.w.x_widget.X_WINDOW_SHOWN,T,function(){this.publishEvent(u.e.s.api.X_WINDOW_SHOWN)}),Object(a.a)(u.e.w.x_widget.X_WIDGET_SEND_LEAD,T,function(t){var e=this,n={};n.widget_type=t.type,n.date=(new d.a).current();var i="string"==typeof t.days?t.days.split(",").map(function(t){return parseInt(t,10)}):[t.days];n.schedule_time=l.a.xCallScheduleTime(i,t.interval_begin,t.interval_end),t.department_id?(n.group_id=t.department_id,n.employee_ids=p.a.getDepartmentMembers(t.id,parseInt(t.department_id,10))):"string"==typeof t.member?n.employee_ids=t.member.split(",").map(:t.member||t.department_id?n.employee_ids=[t.member]:n.employee_ids=p.a.getAllDepartmentsMembers(t.id),n.visitor_name=this.props.visitorName,n.message="\u041f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u0442\u0435 \u043c\u043d\u0435. \u042f \u0443\u0448\u0435\u043b \u0441 \u0441\u0430\u0439\u0442\u0430.",n.location=_.a.getLocation(),n.flag_feature_offline=p.a.isOfflineServiceEnabled(),this.sendRequest(new g.a.livetex.InitiateCall(t.phone,n));var s=function(){e.__storage.incr(S),e.__storage.incr(m),E.a.publishEvent("successfullyInitiatedCall",{id:t.id||""}),e.publishEvent(u.e.s.api.CALL_STARTED)};window.removeEventListener("successfullyLoaded",s),window.addEventListener("successfullyLoaded",s)});var O=function(t){var e=t.type,n=t.detail,s=i.debugEndpoint,r=i.id,a={domain:"X-widget",errorType:e,path:n.path,data:n.data};fetch("https://"+s+"/store",{method:"POST",body:JSON.stringify({correlationId:r,data:JSON.stringify(a)}),headers:{Accept:"application/json","Content-Type":"application/json"}}).catch(function(t){return console.error("can't get access to debug endpoint",t)})};E.a.listenEvent("DEBUG_X-WIDGET",},"./src/service/scripts/x-widget/tabs-resolver.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/tabs/tabs.ts"),o=n("./src/tabs/event-type.ts"),c=n("./src/e.js"),u=(n.n(c),"tab-resolver"),l=[c.e.s.x_widget.X_START,c.e.s.x_widget.X_MEMBER,c.e.s.x_widget.X_VISITOR,c.e.s.x_widget.X_CLOSE,c.e.s.x_widget.X_REMOVE,c.e.s.x_widget.LEAD_SENT],_=[c.e.w.x_widget.X_START,c.e.w.x_widget.X_CLOSE,c.e.w.x_widget.LEAD_SENT],d=function(t){function e(e,n){var i=t.call(this,u)||this;i.listenEvents(e,_),i.publishEvents(n,l);var s=i;return a.a.addEventListener(o.a.X_START,function(){s.publishEvent(c.e.s.x_widget.X_START)}),a.a.addEventListener(o.a.X_MEMBER,function(){s.publishEvent(c.e.s.x_widget.X_MEMBER)}),a.a.addEventListener(o.a.X_VISITOR,function(){s.publishEvent(c.e.s.x_widget.X_VISITOR)}),a.a.addEventListener(o.a.X_CLOSE,function(){s.publishEvent(c.e.s.x_widget.X_CLOSE)}),a.a.addEventListener(o.a.X_REMOVE,function(){s.publishEvent(c.e.s.x_widget.X_REMOVE)}),a.a.addEventListener(o.a.LEAD_SENT,function(){s.publishEvent(c.e.s.x_widget.LEAD_SENT)}),i}return i.c(e,t),e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e}(s.a);Object(r.a)(c.e.w.x_widget.X_START,d,function(){a.a.dispatch(o.a.X_START)}),Object(r.a)(c.e.w.x_widget.X_CLOSE,d,function(){a.a.dispatch(o.a.X_CLOSE)}),Object(r.a)(c.e.w.x_widget.LEAD_SENT,d,},"./src/service/scripts/x-widget/util.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/service/scripts/conditions/condition.ts"),r=n("./src/service/scripts/index.ts"),a=n("./src/util/date/date.ts"),o=n("./src/util/util.ts");!function(t){t.isTimeAvailable=function(t,e){var n=t||0,i=e||0,s=new a.a,r=3600*s.getMoscowTime()+60*s.value.getMinutes()+s.value.getSeconds();return n<=r&&i>r},t.isDayAvailable=function(t){var e=t||[],n=(new a.a).getNormalizeDay();return e.some(function(t){return n===t})},t.createXWindowCondition=function(t,e,n,i){return new s.a({action:r.a.X_WINDOW_API,welcome_chat:e||o.a.getTranslation("x_dont_find")+" "+o.a.getTranslation("x_btn_we_will_call"),welcome_lead:e||o.a.getTranslation("x_dont_find")+" "+o.a.getTranslation("x_in_a_work_time"),conditions:{is_new_visitor:!1,site_time:0,page_count:0,page_type:"any",page_time:0,max_count:0,count_type:"session",is_once_per_day:!1,is_leave_site:!1},routing:{employee_id:n},xwidget:{days:t.days,interval_begin:t.from,interval_end:t.to,show_always:"true"},x_phone_value:i})},t.getMappedCondition=function(e,n){var i={};return i.id=e.getId(),i.confirmation_lead=e.getConfirmationLead(),i.welcome_chat=e.getWelcomeChat(),i.welcome_lead=e.getWelcomeLead(),i.days=e.getDays(),i.show_always=e.isXShowAlways(),i.is_time_available=t.isTimeAvailable(e.getIntervalBegin(),e.getIntervalEnd())&&t.isDayAvailable(e.getDays()),i.member=e.getMember(),i.days=e.getDays(),i.interval_begin=e.getIntervalBegin(),i.interval_end=e.getIntervalEnd(),i.show_departments=e.isDepartmentsShow(),i.department_required=e.isDepartmentRequired(),i.departments=e.getDepartments(),i.is_xbutton_opener=e.getXbuttonOpener(),i.widget_type=n||"",i.x_phone_value=e.getXPhoneValue(),i.visitor_phone="",i},t.xCallScheduleTime=function(t,e,n){var i=e||60,s=n||60,r=t[t.length-1],o=new a.a,c=o.getFullTime(),u=(new Date).getDay(),l=0===u?6:u-1;function _(t){return t*a.b.ONE_DAY/1e3}return t.map(function(t){return[i+_(t),s+_(t)]}).map(function(e,n){var s=e[0],u=e[1];if(c>=s&&c<=u)return 0;if(c<s)return s-c;if(c>u){var d=6;return t[n]===r&&(d=6-l,s=i+_(t[0])),a.b.ONE_DAY*d/1e3+o.getTimeTillMidnight()/1e3+s-a.b.ONE_HOUR/1e3}return a.b.WEEK/1e3}).map(function(t){return Math.round(t)}).reduce(a.b.WEEK/1e3)}}(i||(i={}))},"./src/service/scripts/x-widget/window.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return I});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/macros.ts"),r=n("./src/tabs/event-type.ts"),a=n("./src/tabs/tabs.ts"),o=n("./src/store/storage.ts"),c=n("./src/app/states/states.ts"),u=n("./src/e.js"),l=(n.n(u),n("./src/service/scripts/scripts.ts")),_=n("./src/settings/props.ts"),d=n("./src/service/client-log/events.ts"),p=n("./src/service/scripts/index.ts"),f=n("./src/service/scripts/x-widget/call-helper.ts"),g=n("./src/service/scripts/x-widget/util.ts"),v=n("./src/io/index.ts"),h=n("./src/redux-store/reducers/availability/selectors.ts"),E=n("./src/redux-store/reducers/account-settings/selectors.ts"),b=[u.e.s.x_widget.SHOW_X_WIDGET,u.e.s.x_widget.REMOVE_BUTTON,u.e.s.site.LABEL_DRAW,u.e.s.invite.HIDE_INVITE_FROM_XBUTTON,d.b.EVENTS.SHOW_XWIDGET],m=[u.e.w.x_widget.CLOSE_X_WIDGET,u.e.w.x_widget.SHOW_X_WIDGET_FROM_BUTTON,u.e.w.x_widget.X_WIDGET_SEND_LEAD,u.e.s.api.SHOW_X_WIDGET],S=I=function(t){function e(e,n,i,s){var r=t.call(this,p.c.X_WINDOW,e,n,m,b,i,s,S)||this;return r.__alreadyInThisTab=!1,r.__stateNotRestored=!0,r.__initStorage(),r.__settings=r._parseSettings(r.props.invitationRules,[p.a.X_WINDOW]),r}return i.c(e,t),e.prototype._action=function(t,e){p.e.__isXwidgetOpen||this.transitState(c.a.X_WIDGET,g.a.getMappedCondition(t,e||""))},e.prototype.onState=function(t,e){this.__stateNotRestored&&(this._registerRules(this.__settings),this.__stateNotRestored=!1),t===c.b.X_WIDGET&&!this.__alreadyInThisTab&&e&&(this.publishEvent(u.e.s.x_widget.SHOW_X_WIDGET,e),e&&e.id&&this.storeEventLog(new v.a.event.ShowXWidgetWindow(String(e.id))),this.__alreadyInThisTab=!0)},e.prototype.onStateLeave=function(){},e.prototype.__saveCount=function(t){if(t&&t.id){var e=t.id;this._saveCount(e)}},e.prototype.__initStorage=function(){this._storage.get(f.c)===o.b.NO_DATA&&this._storage.set(f.c,0)},e}(l.c);Object(s.a)(u.e.s.api.SHOW_X_WIDGET,I,function(t){if(_.a.isFeatureActive("xwidget")){var e=_.a.getXWidgetMembers(),n=[];t.members?t.members.forEach(function(t){~e.indexOf(t)&&n.push(t)}):n=e,0===n.length?t.cancel("\u041d\u0435\u0442 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u0432"):this.getState()===c.b.X_WIDGET?t.complete():this.getState()!==c.b.LABEL?t.cancel("\u041d\u0435\u043b\u044c\u0437\u044f \u043e\u0442\u043a\u0440\u044b\u0442\u044c X-Window \u0441\u0435\u0439\u0447\u0430\u0441"):(this.__registerRule(g.a.createXWindowCondition(t.schedule,t.message,n,t.phone)),t.complete())}else t.cancel("X-Window \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d")}),Object(s.a)(u.e.w.x_widget.CLOSE_X_WIDGET,I,function(t){this.getState()!==c.b.LABEL&&this.getState()!==c.b.DIALOG_HIDDEN&&this.getState()!==c.b.CALL_REQUEST_HIDDEN||this.publishEvent(u.e.s.site.LABEL_DRAW,{chat_available:this.props.isAvailableChat}),this.getState()===c.b.X_WIDGET&&(this.transitState(c.a.CLOSE),this.__alreadyInThisTab=!1,a.a.dispatch(r.a.X_CLOSE)),p.e.__isXwidgetOpen||"xbutton"===t.type||this.__saveCount(t),p.e.__isXwidgetOpen=!1}),Object(s.a)(u.e.w.x_widget.X_WIDGET_SEND_LEAD,I,function(t){if("widget-popup"===t.type){if(t&&t.id){var e=t.id;this._saveCountById(e)}this.publishEvent(u.e.s.x_widget.REMOVE_BUTTON),a.a.dispatch(r.a.X_REMOVE)}}),Object(s.a)(u.e.w.x_widget.SHOW_X_WIDGET_FROM_BUTTON,I,function(t){this.getState()===c.b.INVITE&&this.publishEvent(u.e.s.invite.HIDE_INVITE_FROM_XBUTTON),p.e.__isXwidgetOpen||(this.publishEvent(u.e.s.x_widget.SHOW_X_WIDGET,g.a.getMappedCondition(this._conditionStore.getRule(t),"xbutton")),p.e.__isXwidgetOpen=!0)})},"./src/service/site.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return I}),n.d(e,"b",function(){return O});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/app/app.ts"),o=n("./src/app/page/page.ts"),c=n("./src/app/states/states.ts"),u=n("./src/settings/props.ts"),l=n("./src/util/util.ts"),_=n("./src/data/contact-type.ts"),d=n("./src/e.js"),p=(n.n(d),n("./src/io/response/types.ts")),f=n("./src/io/index.ts"),g=n("./src/redux-store/actions/set-availability.ts"),v=n("./src/redux-store/actions/set-visitor-info.ts"),h=n("./src/redux-store/reducers/availability/selectors.ts"),E=n("./src/app/app-types.ts"),b=n("./src/redux-store/reducers/account-settings/selectors.ts"),m=n("./src/event-emitter/index.ts"),S=n("./src/redux-store/reducers/visitor/selectors.ts"),I="draw-omnibutton",y=[d.e.s.site.LABEL_INIT,d.e.s.site.LABEL_DRAW,d.e.s.site.LABEL_HIDE,d.e.s.site.VISITOR_UPDATE,d.e.s.site.PAGE,d.e.s.api.HIDE_ACTIVE_WINDOW],A=[d.e.w.label.CHAT_CLICK,d.e.s.api.SET_VISITOR_ATTRIBUTES,d.e.w.label.WINDOW_ON_FOCUS,d.e.s.api.HIDE_ACTIVE_WINDOW,d.e.w.offline.CALL_IN_LABEL],T=O=function(t){function e(e,n,i,s){var r=this,c={setAvailability:g.b,setVisitorInfo:v.b};(r=t.call(this,"site",T,c)||this).listenEvents(e,A),r.publishEvents(n,y),r.registerApi(i),r.registerState(s);var u=r;return r.addApiListener(p.a.VISITOR_BAN,function(){u.__refreshLabel()}),r.publishEvent(d.e.s.site.LABEL_INIT),r.publishEvent(d.e.s.site.PAGE,o.a.get().getGeoData().country_code),a.a.getAppType()!==E.a.EMBEDDED&&a.a.getAppType()!==E.a.MOBILE&&r.__drawLabel(),r}return i.c(e,t),e.start=e.prototype.__drawLabel=function(){u.a.isMembersExist()&&this.publishEvent(d.e.s.site.LABEL_DRAW,{chat_available:this.props.isAvailableChat})},e.prototype.onState=function(t){a.a.getAppType()!==E.a.EMBEDDED&&a.a.getAppType()!==E.a.MOBILE||this.__resolveLabelEvents(t)},e.prototype.__drawOmnibutton=function(){this.props.isOmnibuttonEnabled&&m.a.publishEvent(I,{chat_available:this.props.isAvailableChat,conversation_id:a.a.getDialog()?a.a.getDialog().__conversationId:null})},e.prototype.__resolveLabelEvents=function(t){switch(t){case c.b.LABEL:this.__drawLabel(),this.publishEvent(d.e.s.api.HIDE_ACTIVE_WINDOW),this.storeEventLog(new f.a.event.ShowLabel);break;case c.b.DIALOG_HIDDEN:this.storeEventLog(new f.a.event.ShowLabel);break;case c.b.CALL_REQUEST_HIDDEN:!this.props.isAvailableChat&&this.storeEventLog(new f.a.event.ShowLabel)}this.__drawOmnibutton()},e.prototype.onStateLeave=function(){},e.prototype.__refreshLabel=function(){if(this.getState()===c.b.LABEL||this.getState()===c.b.DIALOG_HIDDEN){this.__drawLabel();var t=document.querySelector(".lt-flipper-last"),e=document.querySelector(".lt-flipper-new");t&&t.classList.remove("lt-flipper-last"),e&&e.classList.remove("lt-flipper-new")}var n=u.a.isNewBillingEnabled(),i=u.a.isHiddenOffline(),s=!n&&!i,r=u.a.isLeadEnabled()&&!i,o=this.props.isAvailableChat,l=!o&&(s||r),_=n&&!l&&u.a.isCallbackEnabled();o||l||_||(this.getState()===c.b.INVITE&&this.transitState(c.a.CLOSE),this.publishEvent(d.e.s.site.LABEL_HIDE)),a.a.getAppType()===E.a.MOBILE&&this.getState()===c.b.INVITE&&this.transitState(c.a.CLOSE)},e.prototype.shouldUpdate=function(t){if(this.props.isAvailableChat!==t.isAvailableChat)return!0},e.prototype.updateReduxState=e}(s.a);Object(r.a)(d.e.w.label.WINDOW_ON_FOCUS,O,,Object(r.a)(d.e.s.api.HIDE_ACTIVE_WINDOW,O,,Object(r.a)(d.e.w.offline.CALL_IN_LABEL,O,,Object(r.a)(d.e.w.label.CHAT_CLICK,O,function(t){var e=this.props,n=e.isAvailableChat,i=e.isBotEnabled,s=e.isBannedVisitor;if(this.getState()===c.b.LABEL){if(this.storeEventLog(new f.a.event.ClickLabel),i&&u.a.isChatEnabled()&&!s)return void this.transitState(c.a.INVITE);if(n)this.transitState(c.a.DIALOG,t);else{var r=u.a.isLeadEnabled()&&!u.a.isHiddenOffline();!u.a.isNewBillingEnabled()||r?this.transitState(c.a.OFFLINE):u.a.isNewBillingEnabled()&&u.a.isCallbackEnabled()&&this.transitState(c.a.CALL_REQUEST)}}}),Object(r.a)(d.e.s.api.SET_VISITOR_ATTRIBUTES,O,function(t){var e=t.name,n=t.contacts;if(e){this.sendRequest(new f.a.livetex.SetName(e.name));var i=a.a.getDialog(),s=i&&i.getId();s&&this.sendRequest(new f.a.wapi.UpdateAttributes(s,e.name,null,null))}this.actionCreators.setVisitorInfo({name:e.name,nameIsEditable:e.is_editable});var r={};if(n){for(var o=void 0,c=0;c<n.length;c++){var u=(o=n[c]).value;switch(o.type){case _.a.EMAIL:l.a.validateEmail(u)&&(r.email=u);break;case _.a.PHONE:var p=u.replace(/[\s()+-]/g,"");/[^\d]/.test(p)||11!==p.length||(r.phone_number=p)}}r.name=e.name,r.name_is_editable=!!e.is_editable,this.publishEvent(d.e.s.site.VISITOR_UPDATE,r),this.actionCreators.setVisitorInfo({email:r.email,phone:r.phone_number}),t.complete()}else t.cancel("\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e")})},"./src/service/wrapper/wrapper.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return p});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/core/component.ts"),r=n("./src/core/macros.ts"),a=n("./src/tabs/tabs.ts"),o=n("./src/tabs/event-type.ts"),c=n("./src/app/app.ts"),u=n("./src/store/storage.ts"),l=n("./src/e.js"),_=(n.n(l),[l.e.w.chat.MUTATE_WRAPPER]),d=[l.e.s.wrapper.FLIPPER_DRAW,l.e.s.wrapper.MUTATE_WRAPPER],p=function(t){function e(e,n){var i=t.call(this,"wrapper")||this;i.__WRAPPER_PARAMS=["coords","invisible","size"],i.listenEvents(e,_),i.publishEvents(n,d);var s=i;return i.__storage=c.a.createStorage(i),i.publishEvent(l.e.s.wrapper.FLIPPER_DRAW,i.__getParams()),a.a.addEventListener(o.a.MUTATE_WRAPPER,function(){s.publishEvent(l.e.s.wrapper.MUTATE_WRAPPER,s.__getParams())}),i}return i.c(e,t),e.start=function(t,n,i,s){new e(t,n)},e.prototype.onState=function(){},e.prototype.onStateLeave=function(){},e.prototype.__getParams=function(){var t={},e=this;return this.__WRAPPER_PARAMS.forEach(function(n){e.__storage.get(n)!==u.b.NO_DATA&&(t[n]=e.__storage.get(n))}),t},e}(s.a);Object(r.a)(l.e.w.chat.MUTATE_WRAPPER,p,function(t){void 0===t&&(t={});var e=this;Object.keys(t).forEach(function(n){n===e.__WRAPPER_PARAMS.invisible?e.__storage.set(n,t[n]):e.__storage.setPermanently(n,t[n])}),a.a.dispatch(o.a.MUTATE_WRAPPER)})},"./src/settings/props.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i,s,r=n("./node_modules/tslib/tslib.es6.js"),a=n("./src/util/safeObject.ts"),o=n("./src/app/env-settings.ts"),c=n("./src/app/app.ts"),u=n("./src/io/request/vnds/request.ts"),l=n("./src/util/browser/browser.ts");!i||(i={})),function(t){var e;t.getSettings=function(){return e||(e=new a.a(Object(o.a)())),e},t.getMemberLabel=function(e){return String(t.getSettings().getByPath(["members",e,"label"])||"")},t.isBlockedMember=function(e){return Boolean(t.getSettings().getByPath(["members",e,"is_blocked"])||!1)},t.isMembersExist=function(){var e=t.getSettings().getByPath(["members"]);return!(!e||"object"!=typeof e)&&!!Object.keys(e).length},t.getXWidgetMembers=function(){var e=t.getSettings().getByPath(["members"]);return e&&"object"==typeof e?Object.keys(e).map(.filter(:[]},t.isFeatureActive=function(e,n){var i=n?new a.a(n):t.getSettings();return Boolean(i.getByPath(["features",e,"is_active"]))},t.getCommonProperty=function(e,n){return(n?new a.a(n):t.getSettings()).getByPath(["features","common",e])},t.getFeatureProperty=function(e,n,i){return(i?new a.a(i):t.getSettings()).getByPath(["features",e,n])},t.getLabelProperty=function(e,n){return(n?new a.a(n):t.getSettings()).getByPath(["label",e])},t.getServicesProperty=function(e,n){return(n?new a.a(n):t.getSettings()).getByPath(["services",e])},t.getCommonBooleanProperty=t.getCommonStringProperty=function(e,n){return t.getCommonProperty(e,n)?String(t.getCommonProperty(e,n)):""},t.getCommonArrayProperty=function(e,n){var i=t.getCommonProperty(e,n);return i instanceof Array?i:[]},t.getLabelStringProperty=function(e,n){return t.getLabelProperty(e,n)?String(t.getLabelProperty(e,n)):""},t.isChatEnabled=function(e){return t.isFeatureActive("chat",e)},t.isLeadEnabled=function(e){return t.isFeatureActive("lead",e)},t.isVoteEnabled=function(e){return t.isFeatureActive("vote",e)},t.getVoteType=function(){var e=t.isVoteEnabled()?i.DoublePoint:null,n=t.getSettings().getByPath(["features","vote","vote_type"]);return n||e},t.isFileEnabled=function(e){return t.isFeatureActive("file",e)},t.isCallbackEnabled=function(e){return t.isFeatureActive("callback",e)},t.isTypingEnabled=function(e){return t.isFeatureActive("typing",e)},t.isEmbedded=function(e){return t.getCommonBooleanProperty("is_embedded",e)},t.isMobileWidget=function(e){return t.getCommonBooleanProperty("is_mobile_widget",e)},t.isHiddenOffline=function(e){return t.getCommonBooleanProperty("is_hidden_offline",e)},t.getSiteName=function(e){var n=e?new a.a(e):t.getSettings();return String(n.getByPath(["site_name"]))},t.getOnlineLabelText=function(e){return t.getCommonStringProperty("label_text_online",e)},t.getOfflineLabelText=function(e){return t.getCommonStringProperty("label_text_offline",e)},t.getOnlineWelcome=function(e){return t.getCommonStringProperty("online_welcome",e)},t.getOfflineWelcome=function(e){return t.getCommonStringProperty("offline_welcome",e)},t.getOfflineContacts=function(e){return t.getCommonArrayProperty("offline_contacts",e)},t.getOfflineConfirmMessage=function(e){return t.getCommonStringProperty("offline_confirmation",e)},t.getPreChatSets=function(e){return t.getCommonArrayProperty("prechatsets",e)},t.getBannerImage=function(e){return t.getCommonStringProperty("banner_image",e)},t.getBannerLink=function(e){return"default_banner.jpg"===t.getBannerImage(e)?"http://livetex.ru":t.getCommonStringProperty("banner_link",e)},t.isThriftOnline=t.getAvatarUrl=function(e){return t.getCommonStringProperty("invitation_photo_url",e)},t.getStartPayload=function(){var e={};return t.getOnlineLabelText()&&(e.start_chat_label=t.getOnlineLabelText()),t.getOfflineLabelText()&&(e.start_offline=t.getOfflineLabelText()),e},t.getDirectPhone=function(e){return t.getCommonStringProperty("direct_phone",e)},t.isEulaEnable=function(e){return t.getCommonBooleanProperty("is_eula_enabled",e)},t.getDepartmentMembers=function(e,n){return t.getSettings().getByPath(["invitation_rules",e,"routing","departments"]).filter([0].employee},t.getAllDepartmentsMembers=function(e){return t.getSettings().getByPath(["invitation_rules",e,"routing","departments"]).map(function(t){return t.employee}).reduce(.filter(},t.getLabelPosition=t.isOfflineServiceEnabled=function(e){return!!t.getServicesProperty("offline",e)&&Boolean(t.getServicesProperty("offline",e))};var n=t.isTelegramEnabled=n("telegram"),t.isVkEnabled=n("vk"),t.isFbEnabled=n("fb"),t.isInstagramEnabled=n("instagram"),t.isWhatsAppEnabled=n("whatsApp"),t.isViberEnabled=n("viber"),t.isOdnoklassnikiAppEnabled=n("odnoklassniki");var s=function(e){return function(n){return String(t.getFeatureProperty(e,"url",n)||"")}};t.getTelegramLink=s("telegram"),t.getVkLink=s("vk"),t.getFbLink=s("fb"),t.getInstagramLink=s("instagram"),t.getWhatsAppLink=s("whatsApp"),t.getViberLink=s("viber"),t.getOdnoklassnikiAppLink=s("odnoklassniki"),t.getVkAuthSrv=function(){return Object(o.a)().VK_OAUTH_SRV},t.getXWidgetBanner=function(e){return String(t.getFeatureProperty("xwidget","url",e)||"")},t.getFileServiceURL=function(){return Object(o.a)().FILE_SERVER},t.getLTXUrl=t.getContentServer=function(){return Object(o.a)().CONTENT_SERVER||""},t.getMaxUploadSize=t.isOneClickInviteEnabled=function(){var e=Object(o.a)().services||{},n=Boolean(t.isEmbedded()),i=Boolean(c.a.isMobileType());return Boolean(e.offline)&&n&&!i},t.needToDefaultInitialMessage=function(){return!!(Object(o.a)().services||{}).offline},t.isNewBillingEnabled=function(){return!!(Object(o.a)().services||{}).offline},t.isQueueEnabled=function(){return t.isFeatureActive("queue")},t.getMinAvailabilityLevel=t.getOnlineWidgetAvailabilityLevel=function(){return t.isQueueEnabled()?[u.a.FREE,u.a.BUSY]:[u.a.FREE]},t.isYandexMetrikaEnabled=function(){return t.isFeatureActive("yandex_metrika")},t.isGoogleAnalyticsEnabled=function(){return t.isFeatureActive("google_analytics")},t.isQuickCallFeatureEnabled=function(){return t.isFeatureActive("quickCall")},t.isXWidgetEnabled=t.isBotEnabled=function(){var e=t.getFeatureProperty("common","ai_bot_settings");return!(!e||!e.is_active)&&(Object.keys(e).length>1&&!!t.getGreetingBotMessage())},t.isOmnibuttonEnabled=function(){var e=t.getFeatureProperty("common","multibutton");return!(!e||"object"!=typeof e)&&(!(!e.additional||"object"!=typeof e.additional||!e.buttons||"object"!=typeof e.buttons)&&(void 0===e.mobile_is_enabled&&void 0===e.desktop_is_enabled?e.is_active:l.a.isMobile()?!!t.isMobileWidget()&&e.mobile_is_enabled:e.desktop_is_enabled))},t.getGreetingBotMessage=function(){var e=t.getFeatureProperty("common","ai_bot_settings").greeting_message;return void 0===e?null:e},t.getFileTransferringIsEnabled=function(){return!!t.getFeatureProperty("common","file_transferring")},t.getAllowedFileExtensions=function(){var e=t.getFeatureProperty("common","allowed_extensions");return Array.isArray(e)?e:[]},t.getBotName=function(){var e=t.getFeatureProperty("common","ai_bot_settings").bot_name;return void 0===e?"Bot":e},t.getBotHeadText=function(){var e=t.getFeatureProperty("common","ai_bot_settings").head_text;return void 0===e?"":e},t.getBotAvatar=function(){var e=t.getFeatureProperty("common","ai_bot_settings").bot_avatar;return void 0===e?null:e},t.getClassNamesForButtonBot=function(){if(t.getFeatureProperty("common","ai_bot_settings").css_classes){var e=t.getFeatureProperty("common","ai_bot_settings").css_classes.buttons;return Object.keys(e).reduce(function(t,n){var i,s=Object.keys(e[n]).reduce(function(t,i){return""+t+i+":"+e[n][i]+"!important;"},"");return r.a({},t,((i={})[n]=s,i))},{})}return null},t.getLiveSearchURL=function(){var e=t.getFeatureProperty("common","ai_bot_settings");return"object"!=typeof e?"":e.livesearch_url||""},t.getBotAPIToken=function(){var e=t.getFeatureProperty("common","ai_bot_settings");return"object"!=typeof e?"":e.token||""}}(s||(s={}))},"./src/store/cross-local-storage.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/store/cross-window-storage.ts"),r=n("./src/util/util.ts"),a=n("./src/util/serviceMemory.ts"),o=function(t){function e(e,n){var i=t.call(this,r.a.saveToStorage,r.a.loadFromStorage,r.a.removeFromStorage,e,n)||this;return i.__initted=!0,i}return i.c(e,t),e.prototype._getAllData=function(){return a.a&&a.a.isPrivateMode?a.a.getStorage():window.localStorage},e.prototype._loadInitialData=function(t){for(var e in t)r.a.saveToStorage(e,t[e])},e}(s.a)},"./src/store/cross-window-storage.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n("./node_modules/tslib/tslib.es6.js"),s=function(t){function e(e,n,i,s,r){var a=t.call(this,function(t,e){return function(n,i,s){e(n)!==i&&t(n,i,s)}}(e,n),n,i),s,r)||this;return a.MAX_WAIT_TIMEOUT=1e3,a.__onInit=[],a.__initted=!1,a}return i.c(e,t),e.prototype.onInit=function(t){var e=this;this.__onInit.push(t),this.__initted&&this.__callInitCallbacks(),setTimeout(this.MAX_WAIT_TIMEOUT)},e.prototype._loadInitialData=function(t){},e.prototype._getAllData=e.prototype._getInitialData=function(){var t=this._getAllData(),e={};for(var n in t)this._isMyKey(n)&&(e[n]=t[n]);return e},e.prototype._isMyKey=e.prototype.__callInitCallbacks=e}(n("./src/store/storage.ts").a)},"./src/store/local-storage.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("./node_modules/tslib/tslib.es6.js"),s=n("./src/store/storage.ts"),r=n("./src/util/util.ts"),a=function(t){function e(e,n){return t.call(this,r.a.saveToStorage,r.a.loadFromStorage,r.a.removeFromStorage,e,n)||this}return i.c(e,t),e}(s.a)},"./src/store/storage.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return r});var i=n("./src/util/util.ts"),s=n("./src/app/env-settings.ts"),r={};r.Data,r.NO_DATA="",r.SaveFunction,r.LoadFunction,r.RemoveFunction;var a=function(){function t(e,n,i,r,a){var o="lt-"+Object(s.b)();this.__name=o+"-",this.__name+="string"==typeof r?r:r.getName(),this.__session=a||t.PERMANENT_SESSION,this.__save=e,this.__load=n,this.__remove=i}return t.prototype.set=function(t,e,n){this.__set(t,e,this.__session,n)},t.prototype.setPermanently=t.prototype.get=function(e){var n=this.__load(this.__storageKey(e)),s=r.NO_DATA,a=n.indexOf(t.DIVIDER);if(a>0){var o=a+1;if(n.indexOf("object")===o){var c=i.a.decodeJsonData(n.substr(o+6));c instanceof Object&&(s=c)}else n.indexOf("number")===o?s=Number(n.substr(o+6)):n.indexOf("boolean")===o?s="true"===n.substr(o+7):n.indexOf("string")===o&&(s=n.substr(o+6))}return s},t.prototype.extend=function(t,e){var n=this.get(t);n instanceof Object||(n={}),this.set(t,function t(e,n){for(var i in n)n.hasOwnProperty(i)&&(n[i]instanceof Object?e[i]=t(e[i]instanceof Object?e[i]:{},n[i]):e[i]=n[i]);return e}(n,e))},t.prototype.incr=function(t){var e=this.get(t);return"number"==typeof e?e+=1:e=1,this.__set(t,e,this.__session),e},t.prototype.incrPermanently=function(e,n){var i=this.get(e);return"number"==typeof i?i+=1:i=1,this.__set(e,i,t.PERMANENT_SESSION,n?String(n):""),i},t.prototype.remove=t.prototype.getName=t.prototype.onInit=t.prototype.__storageKey=t.prototype.__set=function(e,n,s,r){var a=n;n instanceof Object&&(a=i.a.encodeJsonData(n)),a=s+t.DIVIDER+typeof n+a,this.__save(this.__storageKey(e),a,r)},t.DIVIDER="|",t.PERMANENT_SESSION=0,t}()},"./src/tabs/event-type.ts":"./src/tabs/tabs.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./src/logger/logger.ts"),r=n("./modules/oldmodules.js"),a=(n.n(r),n("./src/app/env-settings.ts")),o=n("./src/tabs/event-type.ts"),c=n("./src/util/serviceMemory.ts");!function(t){t.isVisible=t.isActiveTab=function(){return t.isVisible()},t.init=function(){i()},t.dispatch=function(t,e){s.a.debug("tabs.dispatch, event: "+t),setTimeout(function(){n(t,e)},1e3)},t.dispatchTo=function(e){if(c.a&&c.a.isPrivateMode)c.a.setItem(t.getTabId(),e);else try{localStorage&&localStorage.setItem(t.getTabId(),e)}catch(t){}},t.addEventListener=function(n,i){void 0===e[n]?e[n]=[i]:t.hasEventListener(n,i)||e[n].push(i)},t.hasEventListener=function(t,n){return void 0!==e[t]&&-1!==r.util.indexOf(n,e[t])};var e={},n=function(e,n){var i=e;void 0!==n&&(i+=":"+n),t.dispatchTo(i)},i=function(){window.addEventListener("storage",function(t){if("lt-10033212-tab"===t.key&&t.newValue){var e=t.newValue.split(":"),n=e[0],i=e[1];u(n,i)}})};t.handleStorageUpdate=function(e,n){if(e===t.getTabId()&&n){var i=n.split(":"),s=i[0],r=i[1];u(s,r),"Welcome"===r&&(t.dispatch(o.a.SYNC_TABS),u(s,r))}};var u=function(t,n){if(void 0!==e[t])for(var i=e[t].length-1;i>=0;i-=1)s.a.debug("tabs.__eventHandler, event: "+t+" data: "+n),e[t][i](t,n)};t.getTabId=(i||(i={}))},"./src/util lazy recursive":"./src/util/browser/browser.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),function(t){t.MOBILE_OS_REGEXP="(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|wpdesktop|xda|xiino|android|ipad|playbook|silk",t.MOBILE_DEVICE_REGEX="1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-",t.isMobile=function(){var e=new RegExp(t.MOBILE_OS_REGEXP,"i"),n=new RegExp(t.MOBILE_DEVICE_REGEX,"i"),i=navigator.userAgent||navigator.vendor||window.opera||"";return Boolean(e.test(i)||n.test(i.substr(0,4)))},t.isIOS=function(){return Boolean(/(ipod|iphone|ipad)/i.test(navigator.userAgent))},t.isIOSChrome=function(){return Boolean(/CriOS|OPiOS/i.test(navigator.userAgent))},t.isOpera=function(){return Boolean(/(oprera|opr\/)/i.test(navigator.userAgent))},t.isSafari=function(){return Boolean(/safari/i.test(navigator.userAgent)&&!/(coast)/i.test(navigator.userAgent))},t.isAndroid=t.isAndroidUnsupported=t.isOldAndroid=function(){var t=navigator.userAgent.match(/Android (\d+(?:\.\d+)+)/);if(null!==t){var e=t[1].split(".");if(e.length>1)return Boolean(Number(e[0])<=4&&Number(e[1])<=1)}return!1},t.isNewAndroid=function(){var t=navigator.userAgent.match(/Android (\d+(?:\.\d+)+)/);if(null!==t){var e=t[1].split(".");if(e.length>1)return Number(e[0])>=5}return!1},t.NEED_MOBILE_WIDGETS=t.isIOS()&&t.isSafari()||t.isAndroid()&&!t.isAndroidUnsupported()&&!t.isOldAndroid(),t.isStandardAndroidBrowser=function(){var t=navigator.userAgent;return!/chrome|crios|crmo/i.test(t)&&Boolean(/(Android.*)(?=Version)/.test(t))},t.__ua=window.navigator.userAgent;var e=function(e){var n=t.__ua.match(e);return n&&n.length>1&&n[1]||""};t.getIEVersion=function(){var n=new RegExp("(?:msie |rv:)(\\d+(\\.\\d+)?)","i");return/msie|trident/i.test(t.__ua)?Number(e(n)):null},t.getIOSVersion=function(){return e(/(ipod|iphone|ipad)/i).toLowerCase()?Number(e(/version\/(\d+(\.\d+)?)/i)):null},t.isIE9=function(){return Boolean(9===t.getIEVersion())},t.isIE=function(){return Boolean(null!==t.getIEVersion())},t.isXButtonAvailable=function(){var t=function(t){var n=e.match(t);return n&&n.length>1&&n[1]||""},e=window.navigator.userAgent,n=t(/version\/(\d+(\.\d+)?)/i);if(/chrome|crios|crmo/i.test(e))return!0;if(/firefox|iceweasel/i.test(e)){if(Number(t(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i))>=5)return!0}else if(/msie|trident/i.test(e)){if(Number(t(/(?:msie |rv:)(\d+(\.\d+)?)/i))>=10)return!0}else if(/opera|opr/i.test(e)){var i=n||t(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i);if(Number(i)>=12)return!0}else if(/safari/i.test(e)&&Number(n)>=4)return!0;return!1},t.isOld=function(){var t=window.navigator.userAgent,e=new RegExp("version/(\\d+(\\.\\d+)?)","i"),n=new RegExp("(?:msie |rv:)(\\d+(\\.\\d+)?)","i"),i=new RegExp("(?:opera|opr)[\\s/](\\d+(\\.\\d+)?)","i"),s=r=s(e);return/msie|trident/i.test(t)?Boolean(Number(s(n))<8||"CSS1Compat"!==document.compatMode):!!/opera|opr/i.test(t)&&-1!==(r||s(i)).indexOf("12")}}(i||(i={}))},"./src/util/date/date.ts":function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return r});var i,s=n("./src/data/data.ts");!function(t){t.ONE_HOUR=36e5,t.ONE_DAY=24*t.ONE_HOUR,t.WEEK=7*t.ONE_DAY,t.TWO_WEEKS=2*t.WEEK,t.delta=s.b,t.setDelta=t.getDelta=function(){return t.delta},t.remap=function(t){for(var e=["getUTCHours","getDay","getMinutes","getSeconds"],n=function(n){var i=e[n].toString();t.prototype[i]=function(){return this.value[i]()}},i=0;i<e.length;i++)n(i)}}(i||(i={}));var r=function(){return function(){this.current=function(){return this.value.getTime()},this.getMoscowTime=function(){var t=this.value.getUTCHours();return t+3>23?t+3-24:t+3},this.getNormalizeDay=function(){var t=this.value.getDay();return 0===t?6:t-1},this.getFullTime=function(){return 24*this.getNormalizeDay()*60*60+3600*this.getMoscowTime()+60*this.value.getMinutes()+this.value.getSeconds()},this.getTimeTillMidnight=function(){return 1e3*(3600*(24-this.getMoscowTime())+60*(60-this.value.getMinutes())+(60-this.value.getSeconds()))},this.value=new Date((new Date).getTime()+i.delta)}}();i.remap(r)},"./src/util/debugPerfomance.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(t,e){return e.filter(.map(function(e){if(e.initiatorType){var n=e.name,i=e.initiatorType,s=e.duration,r=e.connectStart,a=e.connectEnd,o=e.domainLookupStart,c=e.domainLookupEnd,u=e.redirectStart,l=e.redirectEnd,_=e.startTime,d=e.fetchStart,p=e.requestStart,f=e.responseStart,g=e.responseEnd,v=n.substring(0,-1===n.indexOf("?")?n.length:n.indexOf("?"));return{process:t,name:v,initiatorType:i,duration:s,connectStart:r,connectEnd:a,domainLookupStart:o,domainLookupEnd:c,redirectStart:u,redirectEnd:l,startTime:_,fetchStart:d,requestStart:p,responseStart:f,responseEnd:g}}if("paint"===e.entryType){var h=e.name,E=e.entryType;s=e.duration,_=e.startTime;return{process:t,name:h,entryType:E,duration:s,startTime:_}}})}},"./src/util/file-broker.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i,s=n("./node_modules/tslib/tslib.es6.js"),r=n("./src/io/request/file-server/index.ts"),a=n("./src/util/originProvider.ts"),o=this;!function(t){t.ServiceUploadedFile="lt/service/uploaded-file",t.WidgetSentFile="lt/widget/sent-file"}(i||(i={}));var c=function(t){var e=function(e){return s.b(o,void 0,void 0,function(){var n,c,u,l,_;return s.d(this,function(d){switch(d.label){case 0:return e.origin!==a.a.getHostPageOrigin()?[2]:e)?[4,function(t){return s.b(o,void 0,void 0,function(){return s.d(this,function(e){return[2,new Promise(function(e){var n=new FileReader;n.onload=function(){var i=new File([n.result],t.name,{type:t.type});e(i)},n.onerror=function(){e(t)},n.readAsArrayBuffer(t)})]})})}(e.data.file)]:[2];case 1:n=d.sent(),c="",d.label=2;case 2:return d.trys.push([2,4,,5]),[4,function(e){return s.b(o,void 0,void 0,function(){return s.d(this,function(n){return[2,new Promise(function(n,i){try{t.send(new r.SendFile(e,n,i),function(t){return t},i)}catch(t){i(t)}})]})})}(n)];case 3:if(u=d.sent().target.responseText,"uploadSuccess"!==(l=JSON.parse(u)).type)throw new Error("failed to upload");return c=l.url,[3,5];case 4:return _=d.sent(),console.log(_),[3,5];case 5:return window.parent.postMessage({type:i.ServiceUploadedFile,fileURL:c},a.a.getHostPageOrigin()),[2]}})})};return window.addEventListener("message",e),},"./src/util/index.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),function(t){t.loadAsyncModule=function(t,e){return n("./src/util lazy recursive")(e)},t.toCamelCase=function(e){if(void 0===e)return console.log("phrase is undefined"),"";var n=e.split("-");return n[0]+n.splice(1).map(t.__capitalise).join("")},t.__capitalise=function(t){return void 0===t?(console.log("phrase is undefined"),""):t[0].toUpperCase()+t.substring(1)},t.generateId=function(){return Math.random().toString(36).substr(2)}}(i||(i={}))},"./src/util/location/location.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return i}),function(t){t.getHost=function(){return window.parentHost||""},t.getTitle=function(){return document.title||""},t.getLocation=(i||(i={}))},"./src/util/originProvider.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i,s,r,a=(i=null,s=null,r=null,{URL_PARAM_KEY:"host-page-origin",getOrigin:function(){return null===i&&(i=window.location.origin),i},getIframeOrigin:function(t){if(null===s){if(void 0===t)throw new Error("initial call of getIframeOrigin() should have $iframe argument");var e=new URL(t.src);s=e.origin}return s},getHostPageOrigin:function(){if(null===r){if(!window.parent)throw new Error("window is not iframe");var t=new URLSearchParams(window.location.search);r=t.get("host-page-origin")}return r}})},"./src/util/safeObject.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(t){this.__core=t}return t.prototype.getCore=function(){return this.__core},t.prototype.get=function(){return this.getByPath(Array.prototype.slice.call(arguments))},t.prototype.set=function(){var t=Array.prototype.slice.call(arguments);this.setByPath(t.shift(),t)},t.prototype.getByPath=function(t){for(var e=this.__core,n=0,i=t.length,s=null;n<i&&null!==e&&""!==t[n];)e=void 0!==(s=e[t[n]])?s:null,n++;return e},t.prototype.setByPath=function(t,e){for(var n=this.__core,i=0,s=e.length,r=null;i<s;){if(r=e[i],i+=1,""===r)for(r=0;void 0!==n[r];)r++;i===s?n[r]=t:void 0===n[r]&&(n[r]=isNaN(e[i])?{}:[]),n=n[r]}},t}()},"./src/util/serviceMemory.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i,s=n("./node_modules/tslib/tslib.es6.js"),r=n("./src/util/originProvider.ts"),a=this;!function(t){t.ServiceRequestsInitialData="lt-service-requests-initial-data",t.ServiceUpdatesMemoryStorage="lt-service-updates-memory-storage",t.ServiceSendsStorage="lt-service-sends-storage",t.WidgetSendsInitialData="lt-widget-sends-initial-data",t.WidgetUpdatesLocalStorage="lt-widget-updates-local-storage",t.WidgetRequestsStorage="lt-widget-requests-storage"}(i||(i={}));var o=function(t){return t&&[i.ServiceRequestsInitialData,i.ServiceUpdatesMemoryStorage,i.WidgetSendsInitialData,i.WidgetUpdatesLocalStorage,i.WidgetRequestsStorage].includes(t.type)},c=function(){if(window.parent===window){var t=document.querySelector("#livetex-services"),e=t&&t.contentWindow;return window.addEventListener("message",function(t){if(t.origin===r.a.getIframeOrigin()&&o(t.data))if(t.data.type!==i.ServiceRequestsInitialData){if(t.data.type===i.ServiceUpdatesMemoryStorage){var n=t.data.payload,a=n.key,c=n.value;return null===c?void window.localStorage.removeItem(a):void window.localStorage.setItem(a,c)}}else{var u=Object.keys(window.localStorage).reduce(function(t,e){var n;return!1===e.startsWith("lt-")?t:s.a({},t,((n={})[e]=window.localStorage.getItem(e),n))},{});e.postMessage({type:i.WidgetSendsInitialData,payload:{initialData:u}},r.a.getIframeOrigin())}},!1),window.addEventListener("storage",function(t){!1!==t.key.startsWith("lt-")&&t.oldValue!==t.newValue&&e.postMessage({type:i.WidgetUpdatesLocalStorage,payload:{key:t.key,value:t.newValue}},r.a.getIframeOrigin())},!1),null}var n=null;window.addEventListener("message",function(t){if(t.origin===r.a.getHostPageOrigin()&&o(t.data)&&(t.data.type===i.WidgetRequestsStorage&&parent.postMessage({type:i.ServiceSendsStorage,payload:{storage:!1===l?JSON.parse(JSON.stringify(window.localStorage)):c}},r.a.getHostPageOrigin()),t.data.type===i.WidgetUpdatesLocalStorage)){var e=t.data.payload,s=e.key,a=e.value;u(s,a,!0),n&&n(s,a)}},!1);var c={},u=function(t,e,n){c[t]=e,!0!==n&&parent.postMessage({type:i.ServiceUpdatesMemoryStorage,payload:{key:t,value:e}},r.a.getHostPageOrigin())},l=function(){var t="nasi-goreng";try{window.localStorage.getItem(t)}catch(e){try{if(document.cookie=t,""===document.cookie)throw new Error("cookies are blocked")}catch(t){return!0}}return!1}();return{isPrivateMode:l,setSetItemHandler:requestInitialData:function(t){return s.b(a,void 0,void 0,function(){return s.d(this,function(e){return[2,new Promise(function(e,n){var s=r.a.getHostPageOrigin();parent.postMessage({type:i.ServiceRequestsInitialData},s);var a=function(t){if(t.origin===s&&o(t.data))if(t.data.type!==i.WidgetSendsInitialData);else{var n=t.data.payload.initialData;e(n)}};setTimeout(t),window.addEventListener("message",a,!1)})]})})},setInitialData:function(t){Object.entries(t).forEach(},getStorage:getKeys:function(){return Object.keys(c)},getItem:setItem:u,removeItem:function(t){delete c[t],parent.postMessage({type:i.ServiceUpdatesMemoryStorage,payload:{key:t,value:null}},r.a.getHostPageOrigin())}}}()},"./src/util/uri/uri.ts":function(t,e,n){"use strict";var i;n.d(e,"a",function(){return s}),function(t){t.getParts=t.parse=function(e){var n,i=e,s=t.getParts();return(n=i.indexOf("?"))>-1&&(s.query=i.substring(n),i=i.substring(0,n)),0===(n=i.indexOf("//"))||-1===n?s.protocol=document.location.protocol:n>-1&&(s.protocol=i.substring(0,n),i=i.substring(n+2)),(n=i.indexOf("/"))>-1?(s.path=i.substring(n),s.urn=i.substring(0,n)):(s.path="/",s.urn=i),s}}(i||(i={}));var s=function(){function t(t){this.__url=encodeURI(t),this.__parsedUrl=i.parse(this.__url)}return t.prototype.isEqual=function(e){var n=this.__normalize().__stringify(),i="";if("string"==typeof e)i=new t(e).__normalize().__stringify();else{if(!(e instanceof t))return!1;i=e.__normalize().__stringify()}return n===i},t.prototype.__stringify=function(){var t=this.__parsedUrl;return t.protocol+"//"+t.urn+(t.path||"")+(t.query||"")},t.prototype.__normalize=function(){return this.__url=this.__url.toLowerCase(),this.__parsedUrl=i.parse(this.__url),this},t}()},"./src/util/util.ts":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i,s=n("./node_modules/tslib/tslib.es6.js"),r=n("./src/util/browser/browser.ts"),a=n("./src/app/env-settings.ts"),o=n("./modules/oldmodules.js"),c=(n.n(o),n("./src/util/serviceMemory.ts"));!function(t){t.IS_MOBILE_CLIENT=-1!==navigator.userAgent.toLowerCase().indexOf("android")||-1!==navigator.userAgent.toLowerCase().indexOf("blackberry")||-1!==navigator.userAgent.toLowerCase().indexOf("iphone")||-1!==navigator.userAgent.toLowerCase().indexOf("ipad")||-1!==navigator.userAgent.toLowerCase().indexOf("ipod")||-1!==navigator.userAgent.toLowerCase().indexOf("opera mini")||-1!==navigator.userAgent.toLowerCase().indexOf("iemobile"),t.isLivetexKey=t.isAppStateKey=t.isNonStateKey=t.retry=function(t,e,n,i,s,r){var a=0;t(s,function o(c){a===e?r.call(window,c):(setTimeout(i*Math.pow(n,a)),a++)})},t.playSound=function(){if(-1===navigator.userAgent.toLowerCase().indexOf("msie 8")){var t=Object(a.c)(),e=document.createElement("audio");""!==e.canPlayType("audio/ogg")?e.src=t+"snd/incomingmessage.ogg":""!==e.canPlayType("audio/vnd.wave")?e.src=t+"snd/incomingmessage.wav":""!==e.canPlayType("audio/mpeg")&&(e.src=t+"snd/incomingmessage.mp3"),e.load(),e.play()}},t.toCamelCase=function(e){var n=e.split("-");return n[0]+n.splice(1).map(t.__capitalise).join("")},t.__capitalise=t.generateId=t.random=function(t,e){var n=t+Math.random()*(e+1-t);return n=Math.floor(n)},t.validateEmail=t.getQuery=function(){var e=window.parentHref.indexOf("?");if(-1===e)return{};var n=o.util.decodeFormData(t.decodeBase64(window.parentHref.substr(e+1)));return n instanceof Object?n:{}},t.generateGuid=t.cors=function(t,e,n,i){function s(){return""+(1e3*Math.random()<<0)}LiveTex.__callbacks||(LiveTex.__callbacks={});for(var r=s();LiveTex.__callbacks[r];)r=s();LiveTex.__callbacks[r]=e.callback="LiveTex.__callbacks["+r+"]";var a,o=[];for(a in e)e.hasOwnProperty(a)&&o.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));var c=document.createElement("script");function u(){delete LiveTex.__callbacks[r],0===Object.keys(LiveTex.__callbacks).length&&delete LiveTex.__callbacks,document.body.removeChild(c)}c.src=t+"?"+o.join("&"),c.type="text/javascript",c.onerror=document.body.appendChild(c)},t.SUBJECT_SITE="\u041e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u0441 \u0441\u0430\u0439\u0442\u0430",t.SUBJECT_GROUP="\u0432 \u043e\u0442\u0434\u0435\u043b",t.isMobileIe=var e=function(){};t.inherits=function(t,n){e.prototype=n.prototype,t.prototype=new e,t.prototype.constructor=t},t.saveToStorage=function(e,n,s){var r=i(n,s);if(c.a&&c.a.isPrivateMode)c.a.setItem(e,r);else try{window.localStorage.setItem(e,r)}catch(i){t.setCookie(e,n,s)}},t.removeFromStorage=function(e){if(c.a&&c.a.isPrivateMode)c.a.removeItem(e);else try{window.localStorage.removeItem(e)}catch(n){""!==t.getCookie(e)&&o.util.removeCookie(e)}},t.clearStorage=function(e){for(var n=c.a&&c.a.isPrivateMode?c.a.getKeys():Object.keys(window.localStorage),i=0,s=n.length;i<s;i+=1){var r=n[i];e(r)&&t.removeFromStorage(r)}},t.loadFromStorage=function(e){try{var i=c.a&&c.a.isPrivateMode?c.a.getItem(e):window.localStorage.getItem(e),s=n(i);if(null!==s){if(void 0===s.time||(new Date).getTime()<s.time)return s.data;t.removeFromStorage(e)}return t.getCookie(e)}catch(t){}return t.getCookie(e)},t.getCookie=function(t){var e=document.cookie,n=t+"=",i=e.indexOf(n);if(-1!==i){var s=e.indexOf(";",i);return-1===s?e.substring(i+n.length):e.substring(i+n.length,s)}return""},t.merge=t.clone=function(e){try{return t.decodeJsonData(JSON.stringify(e))}catch(t){console.error(t)}return null},t.setCookie=function(t,e,n){var i="";if(void 0!==n){var s=new Date;s.setTime(n+s.getTime()),i="; expires="+s.toGMTString()}document.cookie=t+"="+e+i+"; path=/"},t.isSecure=t.nop=function(){},t.encodeJsonData=function(t){try{return JSON.stringify(t)}catch(t){}return""},t.decodeJsonData=t.async=t.dom={addEventListener:function(t,e,n){if(void 0!==t.addEventListener)t.addEventListener(e,n,!1);else if(void 0!==t.attachEvent){var i="on"+e;if(void 0===t[i])o.util.dom.__addCustomIEListener(t,e,n);else{void 0===t.__ieTargetId&&(t.__ieTargetId="element_"+o.util.dom.__lastElementId++);var s=t.__ieTargetId+"_"+e;n[s]=function(e){n.call(t,e)},t.attachEvent(i,n[s])}}}};var n=function(e){return t.decodeJsonData(e)},i=function(e,n){return t.encodeJsonData({data:e,time:n?(new Date).getTime()+n:void 0})};t.encodeBase64=function(t,e){var n=t),i=btoa(n);return e&&(i=i.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+\s*$/g,"")),i},t.decodeBase64=function(t,e){return e&&(t=t.replace(/-/g,"+").replace(/_/g,"/")+"====".slice(0,-t.length%4)),atob(t))},t.tokenizeUrlData=function(e,n){var i=[];if(void 0===n&&(n=[]),"object"==typeof e)for(var s in e){var r=0===n.length?[encodeURIComponent(String(s))]:(n.join(",")+","+encodeURIComponent(String(s))).split(",");i=i.concat(t.tokenizeUrlData(e[s],r))}else void 0!==e&&(i=[n.shift()+(n.length>0?"["+n.join("][")+"]=":"=")+encodeURIComponent(String(e))]);return i},t.encodeFormData=function(e,n){return t.tokenizeUrlData(e).join(n||"&")},t.getTranslation=function(t){return LiveTex._i18n[t]},t.setCustomLocale=function(t){if(t){var e=t[window.ltLang?window.ltLang:"ru"]||{};Object.keys(e).forEach(,LiveTex._i18n=s.a({},LiveTex._i18n,e)}}}(i||(i={}))}},["./src/app/index.ts"]);