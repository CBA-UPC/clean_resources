$smcT5.TrackerV2.plugin=[function(t,e,n){"use strict";n.r(e),function(t){var r=n(9),i=setTimeout;unction a(){}otype.catch=c.prototype.then=c.prototype.finally=r.a,c.all=c.resolve=c.reject=c.race=c._immediateFn="function"==typeof t&&function(e){t(e)}||c._unhandledRejectionFn=e.default=c}.call(this,n(13).setImmediate)},function(t,e,n){"use strict";e.__esModule=!0;var r=Date.now(),i=(new Date).getTime(),o=!0,a=0;e.currentOffset=a;e.ModDateNow=function(){return o?Date.now()-a:(new Date).getTime()-a};e.ModDate=function(){return new Date((new Date).getTime()-a)},("number"!=typeof r||Math.abs(i-r)<10)&&(o=!1);e.updateCurrentDate=function(t){e.currentOffset=a=(new Date).getTime()-new Date(t).getTime()}},function(t,e,n){t.exports=function(){var t=t||function(t,e){var n=Object.create||),r={},i=r.lib={},o=i.Base={extend:create:init:function(){},mixIn:clone:,a=i.WordArray=o.extend({init:toString:concat:clamp:clone:random:),c=r.enc={},s=c.Hex={stringify:parse:,u=c.Latin1={stringify:parse:,f=c.Utf8={stringify:parse:,l=i.BufferedBlockAlgorithm=o.extend({reset:_append:_process:clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),d=(i.Hasher=l.extend({cfg:o.extend(),init:reset:update:finalize:blockSize:16,_createHelper:_createHmacHelper:),r.algo={});return r}(Math);return t}()},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var o=i(n(15)),a=i(n(8)),c=i(n(0)),s=n(1),u=n(6),f=n(4),l={AccessKeyId:null,SecretKey:null,SessionToken:null,region:null};e.RequesterSetup=function(t){var e=t.AccessKeyId,n=t.SecretKey,r=t.SessionToken,i=t.region,o=t.IdentityId;l={AccessKeyId:e,SecretKey:n,SessionToken:r,region:i},d({IdentityId:o,region:i})};var d=function(t){var e=t.region,n=t.IdentityId;setTimeout(function(){u.getCredentials({IdentityId:n,refresh:!0}).then(function(t){var n=t.Credentials,i=t.IdentityId;l=r({},n,{region:e}),d({IdentityId:i,region:e})}).catch(},18e5)},h=function(t,e){void 0===e&&(e=!1);var n=s.ModDate(),i=[n.getUTCFullYear(),("0"+(n.getUTCMonth()+1)).slice(-2),("0"+n.getUTCDate()).slice(-2),"T",("0"+n.getUTCHours()).slice(-2),("0"+n.getUTCMinutes()).slice(-2),("0"+n.getUTCSeconds()).slice(-2),"Z"].join(""),c=i.substr(0,8),u=t.region||l.region||"eu-west-1",f=t.service||"firehose",d="string"==typeof t.path?t.path:"/";d="/"===d.charAt(0)?d:"/"+d;var h="string"==typeof t.method?t.method.toUpperCase():"POST",v="object"==typeof t.query?t.query:{},y=Object.keys(v).map(function(t){return t+"="+v[t]}).join("&");y=""!==y?"?"+y:"";var m=f+"."+u+".amazonaws.com",g=t.target,_="https://"+m+d+y,w=JSON.stringify("object"==typeof t.body?t.body:{}),I=a.default(w).toString(),b=c+"/"+u+"/"+f+"/aws4_request",T={host:m,"x-amz-date":i,"x-amz-security-token":l.SessionToken,"x-amz-target":g},S=Object.keys(T).join(";"),O=h+"\n"+d+"\n"+y+"\n"+Object.keys(T).map(.join("\n")+"\n\n"+S+"\n"+I,M="AWS4-HMAC-SHA256\n"+i+"\n"+b+"\n"+a.default(O).toString(),k=o.default(c,"AWS4"+l.SecretKey),A=o.default(u,k),E=o.default(f,A),C=o.default("aws4_request",E),j=o.default(M,C).toString(),D={Authorization:"AWS4-HMAC-SHA256 Credential="+l.AccessKeyId+"/"+b+", SignedHeaders="+S+", Signature="+j,"content-type":"application/x-amz-json-1.1"},x=r({},T,D);return p({detailsInput:t,isRetry:e,url:_,body:w,method:h,headers:Object.keys(x).map(})};e.makeSignedRequest=h;var p=function(t){var e=t.body,n=t.method,r=void 0===n?"POST":n,i=t.url,o=t.headers,a=t.isRetry,u=void 0!==a&&a,f=t.detailsInput;return new c.default(function(t,n){var a=new XMLHttpRequest;a.open(r,i),o.filter(function(t){var e=t.name;return-1===["host"].indexOf(e)}).forEach(,a.timeout=4e3,a.onload=function(){try{if(s.updateCurrentDate(a.getResponseHeader("date")),a.status>=100&&a.status<400)t(JSON.parse(a.responseText||"{}"));else{if(u||400!==a.status||!JSON.parse(a.responseText).message.substr(0,"Signature expired".length))throw"HTTP request failed";h(f,!0).then(t)}}catch(t){n(t)}},a.ontimeout=function(t){n(t)},a.onerror=function(t){n(t)},a.send(e)})};e.makeRequest=p},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var i,o,a=n(1),c=n(3),s=r(n(10)),u=[],f=[],l=[],d=[],h=[],p=!1,v=!1;e.DeliveryStreamName=o;var y=50,m=!1,g=!1,_="",w={};e.setFingerprintProps=function(t){return w=t};e.setUIdentityId=function(t){return _=t};e.setReady=function(){return v=!0};e.setDeliveryStreamName=function(t){return e.DeliveryStreamName=o=t};e.setFallbackEventHandler=e.setUseFallbackEventHandler=var I=function(){if(v){if(u.length){for(var t=0;t<u.length;t++){var e=u[t].payload;if(e.iid=_,e.bto=a.currentOffset,navigator&&(e.ua=navigator.userAgent||""),w)for(var n in w)w.hasOwnProperty(n)&&(e[n]=w[n])}if(p){for(t=0;t<u.length;t++)i(u[t]);u=[],b()}else{var r=[];for(t=0;t<u.length;t++){var f=JSON.stringify(u[t].payload),l=s.default.encode(f),d=btoa(l);r.push({Data:d})}c.makeSignedRequest({target:"Firehose_20150804.PutRecordBatch",body:{DeliveryStreamName:o,Records:r}}).then(function(t){u=[],b()}).catch(function(t){p=!0,m||(m=!0,I())})}}}else--y>0&&setTimeout(100)},b=function(){for(var t=0;t<h.length;t++)h[t]();h=[]},T=e.addOverlayEvent=function(t){"object"!=typeof t.payload&&(t.payload={}),t.payload.etm=a.ModDateNow(),t.payload.mtd="D",t.payload.odc=JSON.stringify([]),u.push(t),t.callback&&"function"==typeof t.callback&&h.push(t.callback),I()};var S=function(t){if(v){if(f.length)if(p){for(var e=0;e<f.length;e++)i(f[e]);f=[],b()}else{var n=[];for(e=0;e<f.length;e++){var r=JSON.stringify(f[e].payload),o=s.default.encode(r),a=btoa(o);n.push({Data:a})}c.makeSignedRequest({target:"Firehose_20150804.PutRecordBatch",body:{DeliveryStreamName:t,Records:n}}).then(function(t){f=[],b()}).catch(function(t){p=!0,m||(m=!0,I())})}}else--y>0&&setTimeout(function(){S(t)},100)};e.addPushsiteEvent=function(t,e){"object"!=typeof t.payload&&(t.payload={}),t.payload.etm=a.ModDateNow(),t.payload.mtd="D",t.payload.odc=JSON.stringify([]),f.push(t),S(e)};var O=function(t){if(v){if(l.length)if(p){for(var e=0;e<l.length;e++)i(l[e]);l=[],T()}else{var n=[];for(e=0;e<l.length;e++){var r=JSON.stringify(l[e].payload),o=s.default.encode(r),a=btoa(o);n.push({Data:a})}c.makeSignedRequest({target:"Firehose_20150804.PutRecordBatch",body:{DeliveryStreamName:t,Records:n}}).then(function(t){l=[],T()}).catch(function(e){p=!0,g||(g=!0,O(t))})}}else--y>0&&setTimeout(function(){O(t)},100)};e.addMachineLearningEvent=function(t,e){"object"!=typeof t.payload&&(t.payload={}),t.payload.etm=a.ModDateNow(),t.payload.mtd="D",l.push(t),t.callback&&"function"==typeof t.callback&&d.push(t.callback),O(e)}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var i,o,a=n(1),c=r(n(0)),s="smc_lse_iframe";!i||(i={}));var u={},f={};e.setter=function(t,e){return new c.default(function(n,r){d().then(function(r){var o={action:"set",name:t,string:btoa(JSON.stringify(e))};switch(r){case i.XDOMAIN:l(o);break;case i.LOCALSTORAGE:localStorage.setItem(o.name,o.string);break;case i.MEMORY:f[o.name]=o.string}n()}).catch(r)})};var l=function(t){var e=window.frames[s];return!!e&&(e.postMessage(t,"*"),!0)};e.getter=function(t){return new c.default(function(e,n){d().then(function(r){switch(r){case i.XDOMAIN:var o=a.ModDateNow();u[o]={resolver:e,rejectId:setTimeout(function(){n({error:"No response from iFrame within 0.5s: "+t})},500)},l({action:"get",name:t,id:o});break;case i.LOCALSTORAGE:e(localStorage.getItem(t));break;case i.MEMORY:e(f[t]),delete f[t]}}).catch(n)})};e.deleter=function(t){var e={action:"remove",name:t};l(e)||localStorage.removeItem(e.name)};var d=function(){return new c.default(function(t,e){o?t(o):h().then(})},h=function(){return new c.default(function(t){try{var e=void 0;(e=document.createElement("iframe")).setAttribute("src","https://d2d7do8qaecbru.cloudfront.net/live/lse1.1.html"),e.setAttribute("id",s),e.setAttribute("name",s),e.setAttribute("style","visibility:hidden;width:0;height:0;position:fixed;bottom:-10px;right:-10px;"),document.getElementsByTagName("body")[0].appendChild(e),e.onload=e.onerror=window.addEventListener("message",function(t){if(void 0!==t.data&&"callback"===t.data.action&&"object"==typeof u[t.data.id]){var e={};try{e=t.data.data?JSON.parse(atob(t.data.data)):{}}catch(t){}u[t.data.id].resolver(e),clearTimeout(u[t.data.id].rejectId)}void 0!==t.data&&t.data.action})}catch(e){!)?t(i.MEMORY):t(i.LOCALSTORAGE)}})};setTimeout(function(){new c.default(function(t){d().then(function(t){if(t!==i.XDOMAIN)throw t;l({action:"all"})}).catch(t)}).then(},2e3);e.getMode=,function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var i,o=n(5),a=r(n(0)),c=n(3);e.region=i;var s=u={content:{name:"Content-Type",value:"application/x-amz-json-1.1"},targetGetId:{name:"X-AMZ-TARGET",value:"AWSCognitoIdentityService.GetId"},targetGetCreds:{name:"X-AMZ-TARGET",value:"AWSCognitoIdentityService.GetCredentialsForIdentity"}},f=function(t){var e=t.IdentityId,n=t.refresh,r=void 0!==n&&n;if(!e)throw"No identity";return r?l({IdentityId:e}):o.getter("smc_credential").then(function(t){var n=t.Credentials;if(n&&n.Expiration&&Date.now()<1e3*n.Expiration&&Date.now()>1e3*n.Expiration-366e4)return{IdentityId:e,Credentials:n};throw"No local credentials"}).catch(};e.getCredentials=f;var l=function(t){var e=t.IdentityId;return c.makeRequest({url:s(),body:JSON.stringify({IdentityId:e}),headers:[u.content,u.targetGetCreds]}).then(function(t){var n=t.Credentials;if(!n)throw"No credentials";return o.setter("smc_credential",{Credentials:n}),{IdentityId:e,Credentials:n}})},d=function(t){var e=t.setupIdentityPoolId,n=t.resolver,r=t.rejecter;(function(t){return c.makeRequest({url:s(),body:JSON.stringify({IdentityPoolId:t}),headers:[u.content,u.targetGetId]}).then(function(e){var n=e.IdentityId;return o.setter("smc_identity",{IdentityId:n,IdentityPoolId:t}),{IdentityId:n}})})(e).then(function(t){var e=t.IdentityId;f({IdentityId:e}).then(n)}).catch(r)};e.initialise=function(t,n){return new a.default(function(r,a){e.region=i=n,o.getter("smc_identity").then(function(e){var n=e.IdentityId,i=e.IdentityPoolId;"string"==typeof n&&i===t?f({IdentityId:n}).then(r).catch(:d({resolver:r,setupIdentityPoolId:t,rejecter:a})}).catch(a)})}},function(t,e,n){t.exports=n(2))},function(t,e,n){t.exports=function(t){!)}(n(2))},function(t,e,n){t.exports=n(2),n(8),n(14))},function(t,e,n){"use strict";var r=this&&this.__assign||i=this&&this.__importDefault||e.__esModule=!0;var o=n(3),a=i(n(0)),c=n(6),s=n(4),u=n(5);e.start=function(t){var e=t.IdentityPoolId,n=t.callback,i=t.fallbackEvent;t.doFingerprint;try{s.setFallbackEventHandler(i);var a=e.split(":")[0];s.setDeliveryStreamName(e.split(":")[1]),c.initialise(e,a).then(function(t){var e=t.Credentials,i=t.IdentityId;return s.setUIdentityId(i.split(":")[1]),o.RequesterSetup(r({},e,{region:a,IdentityId:i})),s.setReady(),n(),u.getter("smc-fp")}).then(function(t){var e=t.fp;return e&&e.fph?{fp:e}:f()}).then(function(t){var e=t.fp;return u.setter("smc-fp",{fp:e}),{fp:e}}).then(.catch(}catch(t){l(t)}};var f=function(){return new a.default(function(t){var e={};try{if(!(function(){try{for(var t=decodeURIComponent(document.cookie).split(";"),e=0;e<t.length;e++){var n=t[e].trim();if(0==n.indexOf("smc_tpv="))return parseInt(n.substring("smc_tpv=".length,n.length))||0}}catch(t){}return 0}()>1))return void t({fp:e});for(var n=document.createElement("script"),r=document.getElementsByTagName("script"),i=0;i<r.length;i++)r[i].src.match(/events-[0-9]*.[0-9]*.[0-9]*.min.js/)&&(n.src=r[i].src.replace("events","fp"));document.getElementsByTagName("head")[0].appendChild(n);var o=setTimeout(500);n.onload=function(){clearTimeout(o),$smcT5&&$smcT5.TrackerV2&&$smcT5.TrackerV2.fingerprint&&"function"==typeof $smcT5.TrackerV2.fingerprint.make&&$smcT5.TrackerV2.fingerprint.make().then(t)},n.onerror=function(){clearTimeout(o),t({fp:e})}}catch(n){t({fp:e})}})},l=e.event=function(t){switch(t.type){case"overlay":s.addOverlayEvent(t);break;case"pushsite":s.addPushsiteEvent(t,"pushsite-sessions");break;case"machineLearning":s.addMachineLearningEvent(t,"ml-delivery-stream")}}}]);
//# sourceMappingURL=events-1.6.0.min.js.map