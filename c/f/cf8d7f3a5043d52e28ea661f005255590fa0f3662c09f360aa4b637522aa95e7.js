(()=>{var e={2852:e=>{e.exports=(e,t=0)=>{let n=3735928559^t,i=1103547991^t;for(let t,o=0;o<e.length;o++)t=e.charCodeAt(o),n=Math.imul(n^t,2654435761),i=Math.imul(i^t,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),4294967296*(2097151&i)+(n>>>0)}},9996:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)};var n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return i(e,n)}))}function r(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function a(e,t){try{return t in e}catch(e){return!1}}function s(e,t,n){var o={};return n.isMergeableObject(e)&&r(e).forEach((function(t){o[t]=i(e[t],n)})),r(t).forEach((function(r){(function(e,t){return a(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,r)||(a(e,r)&&n.isMergeableObject(t[r])?o[r]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"==typeof n?n:c}(r,n)(e[r],t[r],n):o[r]=i(t[r],n))})),o}function c(e,n,r){(r=r||{}).arrayMerge=r.arrayMerge||o,r.isMergeableObject=r.isMergeableObject||t,r.cloneUnlessOtherwiseSpecified=i;var a=Array.isArray(n);return a===Array.isArray(e)?a?r.arrayMerge(e,n,r):s(e,n,r):i(n,r)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return c(e,n,t)}),{})};var l=c;e.exports=l}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="//cdn.sophi.io/latest/",(()=>{"use strict";const e="warning",t=!1,i=!0,o=void 0,r="(not provided)",a=["ampproject.org","google.com/amp"],s=[],c={},l="",d="length",p="includes",u="type",g="csUserId",m=setTimeout,f="00000000-0000-4000-8000-000000000000",h=e=>document.querySelector(e),b="sophi";[c,s].forEach((e=>Object.freeze(e)));const w=e=>"string"==typeof e,{isArray:y}=Array,v=e=>"function"==typeof e,k=e=>!!e,I=e=>({elementMaxSize:e}),S=e=>"boolean"==typeof e,$=e=>"number"==typeof e,T=(e,{elementMaxSize:t=2048}=c)=>e&&w(e)&&e.trim()[d]?e.trim().substring(0,t):o,C=(e,{elementMaxSize:t=2048}=c)=>(T(e,{elementMaxSize:t})||l).toLowerCase()||o,N=(e,t=128)=>e?C(e,I(t)):o,D=(e,t=128)=>T(e,I(t)),O=e=>{const t=e=>e?new Date(e):new Date,n=e=>(null!==e.match(/^\d{4}-\d\d-\d\d\s\d\d:\d\d:\d\d$/)?`${e}.000Z`:e).replace(/^(\d{4}-\d\d-\d\d)(\s)(\d\d:\d\d:\d\d(\.\d{3}(Z)|(-\d\d:\d\d))?)$/,"$1T$3"),i="number"==typeof e?10===(r=e).toString()[d]&&1e3*t(r).getFullYear()>=t().getFullYear()?new Date(1e3*r):t(r):"string"==typeof e&&!Number.isNaN(t(n(e)).getTime())&&t(n(e));var r;return"[object Date]"!==Object.prototype.toString.call(i)||Number.isNaN(i.getTime())?o:i.toISOString()},x=(e,n=o)=>{let r=y(e)?[...new Set(e)].filter(Boolean):o;if(y(r)&&r[0])if(n&&"string"==typeof n){const e=[];r=r.filter((o=>-1===e.indexOf(o[n])?(e.push(o[n]),i):t))}else"object"==typeof r[0]&&(r=r.filter(((e,t)=>{const n=JSON.stringify(e);return t===r.findIndex((e=>JSON.stringify(e)===n))})));return(r||s)[d]?r:o},P=(t=[],n=1/0,i=1/0)=>{let r=y(t)&&t[d]?x(t):o;try{r&&(r=r.map((e=>C(e,{elementMaxSize:i}))).filter((e=>e&&e[d]<=i)),r[d]>n&&(r[d]=n))}catch(o){window[b].log("normalizeStringArray() failed",e,"arrayHelpers",o,{array:t,arrayMaxLength:n,elementMaxSize:i})}return r&&r[d]>0?r:o},E=(e,t=100,n=128)=>y(e)&&e[d]?P(e,t,n):o,j=(e,t=",")=>{let n=e;return n=n&&w(n)?e.split(t).map((e=>(e||l).trim())):o,e&&y(e)?e:n},A=/^((?:(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}:\d{2}(?:\.\d+)?))(Z|[+-]\d{2}:\d{2})?)$/,M=e=>e&&Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length>0?e:o,U=e=>{if(y(e)&&e.length>0){const t=e.filter((e=>"object"==typeof e));return t[d]>0?t:o}return o},L={isTrackerOn:!0,configEndpoint:"collector.sophi.io",throttlePercentage:10,enablePagePing:!1,enableClickTracking:!0,pagePing:{start:10,interval:20}},_={...L,enablePagePing:!0,enableClickTracking:!0,throttlePercentage:0,pagePing:{start:5,interval:20}},V={...L};V.throttlePercentage=0,V.pagePing.start=0,V.pagePing.interval=0,V.enableClickTracking=!1,V.enableLinkImpression=!1;const R=V,F={...L},z={...L},B={...L,enablePagePing:!1,throttlePercentage:0};var q=n(2852),Z=n.n(q);const{sophi:J={}}=window,{appId:W=""}=J.settings||{},H=W.split(":")[0],G=Z()(H),Q=[6902980927815546,0x9659c58516a2b,6197559479299937][p](G)?{corriere:R,cbsnews:_,theglobeandmail:F,reuters:z,ajc:B}[H]:o,{enableClickTracking:Y,pagePing:X}=Q||{},K={baseUrl:"https://cdn.sophi.io/",scriptDir:"latest",optOutCookieName:"sophiOptOut",scripts:{timeout:5e3,timeSpent:0,lastTs:Date.now(),interval:2e3,isWaiting4LR:t},trackerName:"sophiTag",duplicateT:"sophi_2",cookieLifeTime:15552e3,sessionDuration:1800,consentExpiry:63072e6,stateStorageStrategy:"cookieAndLocalStorage",cookieSecure:i,cookieSameSite:"None",enablePagePing:t,pagePing:X||{start:5,interval:20},enableClickTracking:S(Y)?Y:i,clickFilter:o,enablePost:i,forceSecureTracker:i,encodeBase64:t,cookieDomain:t,bufferSize:1,plugin:{video:i},isSPA:"thewest.com.au"===window.location.host},ee={page:{},environment:{location:document.location.hostname.split("."),get host(){return this.location.slice(-2).join(".")},get site(){return this.host.split(".")[0]},get subDomain(){return this.location.slice(0,-2).join(".")},trackerVersion:"2.3.52",isAdBlocked:o,isPrivate:o}},{cookieLifeTime:te,sessionDuration:ne,trackerName:ie}=K,oe="storeAndLog",re=(e,n,o,r=c,a=c,...s)=>{const l={message:e,type:n,origin:o,errorObject:r,contextData:a,isTrackable:s[0]||t,isFatal:s[1]||t,useWindowLog:s[2]||t,inQ:s[3]||i},d=!!se("debug")||!!se("sendLogData")&&"send";d&&(window[b].logs[l.type].push(l),"send"===d&&window[b].sendEvent({type:"error",data:l}))},ae=(n,o,r)=>{try{if(navigator.cookieEnabled){const e=new Date;e.setTime(e.getTime()+1e3*(r?24*r*60*60:te));const t=window.location.hostname.split(".").slice(-2).join(".");return document.cookie=`${n}=${o}; expires=${e.toGMTString()}; path=/; domain=${t}; SameSite=None; secure`,i}}catch(t){window.sophi.log("createCookie() failed",e,oe,t,{name:n,value:o,days:r})}return t},se=(n,r,a=te)=>{try{const s=a<=ne?"sessionStorage":"localStorage";let c;const d=`${ie}.${n}`;let p=r;const u=window[s],g=((e="localStorage")=>{try{const t=window[e],n="!@#$%^";t.setItem(n,n);const i=!!t.getItem(n);return t.removeItem(n),i}catch(e){return t}})(s);if(p||p===t)return"object"==typeof p&&(p=JSON.stringify(p)),g?u.setItem(d,p):ae(d,p.substring(0,256),a===te?a/24/60/60:a),i;if(p===o){c=g?localStorage.getItem(d)||sessionStorage.getItem(d):(n=>{try{return navigator.cookieEnabled?document.cookie.split("; ").map((e=>e.split("="))).filter((([e])=>e===n))[0][1]:t}catch(t){return re("readCookie() failed",e,oe,t,{name:n}),null}})(d);try{c=JSON.parse(c)}catch(e){}return c}if(null===p)return g?(localStorage[d]?localStorage:sessionStorage).removeItem(d):ae(d,l,-1),i}catch(t){re("store() failed",e,oe,t,{key:n,value:r,storagePeriod:a})}return t};var ce=n(9996),le=n.n(ce);const de=(e,t=[],n=[])=>{const i=[];t.forEach((t=>{t===e||(-1!==e.indexOf(t)?i.push(`(\\/\\/|\\.)${t}`):-1!==t.indexOf(`.${e}`)||i.push(t))}));return i.concat(n)},pe=(e,...t)=>m(e,0,...t),ue=(e,t)=>{const{addedNodes:n}=e;n[d]&&n.forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&pe(t,e)}))},ge=(e,t)=>{e.forEach((e=>{pe(ue,e,t)}))};const me=(e,t=document.location.href)=>new URL(e).hostname===new URL(t).hostname,fe=(e,t,n=Date.now())=>{let i;const o=`${t}.${n}`;return i="&"===e.slice(-1)?`${e}_sp=${o}`:e.includes("?")?`${e}&_sp=${o}`:`${e}?_sp=${o}`,i},he=(n,i=((n=He)=>{try{const e=new RegExp(`${n}id\\.[a-f0-9]+=([^;]+);?`),i=document.cookie.match(e);return i&&i[1]?i[1].split(".")[0]:t}catch(t){window[b].log("could not get domainUserID",e,"userIdHelpers",t)}return o})())=>{y(n)&&!!n[d]&&n.forEach((({attribute:e,cssSelector:t})=>{if(t&&e){[...(n=`${t}[${e}]`,document.querySelectorAll(n))].forEach((t=>{const n=(r=e.slice(5),w(r)?r.toLowerCase().replace(/-([a-z])/g,(e=>e[1].toUpperCase())):o);var r;const a=document.location.href;if(e.startsWith("data-")&&!me(t.dataset[n],a)){if(!t.dataset[n][p]("_sp=")){const e=t.dataset[n],o=fe(e,i);t.dataset[n]=o}}else if(!me(t.getAttribute(e),a)&&!t.getAttribute(e)[p]("_sp")){const n=t.getAttribute(e),o=fe(n,i);t.setAttribute(e,o)}}))}var n}))},be=()=>window.sophi?.settings?.listOfButtonsToDecorate,we=e=>{const t=be();"BUTTON"===e.nodeName&&he(t)};new function(e){this.observe=()=>{new MutationObserver((t=>{pe(ge,t,e)})).observe(document.body,{childList:i,subtree:i})}}((e=>{pe(we,e)})).observe();const ye=(e=be())=>{y(e)&&e[d]&&he(e)},ve="sophi/init.js",ke={data:ee,settings:K,contexts:{extract:{itemImpressions:{settings:{shouldTrackLink:n=>{try{if(!n.href)throw n;return!!n.protocol.match(/https?|mailto:/i)}catch(t){window[b].log("Can't determine href of an anchor",e,ve,t,{element:n})}return t}}},linkProperties:{}},settings:{includeMetaData:i}},itemImpression:{linkData:[],linkProcessed:[]},functions:c,logs:{error:[],warning:[],other:[]},log:re};ke.settings.scripts.url=`${ke.settings.baseUrl+ke.settings.scriptDir}/`,window[b]=window.sophi?le()(ke,window.sophi):ke;const Ie=window[b],{settings:Se}=window[b];window[b].data.environment.client=Se.client,"corriere:corriere_it:website"===window.sophi.settings.appId&&!1===window.sophi.data.visitor?.isLoggedIn&&se("uid",null);Ie.data.environment.environment=(()=>{const{subDomain:e,environment:t}=Ie.data.environment;return"dev"===t||/dev|development/.test(e)||/localhost|(127\.0\.0\.1)/.test(document.location.hostname)?"dev":"stg"===t||/stg|qa|staging/.test(e)?"stg":"prod"})();const{environment:$e,site:Te}=Ie.data.environment,{stagingEndpoint:Ce,collectorEndpoint:Ne}=Ie.settings,{configEndpoint:De}=Q||{};let Oe=(({environment:e,stagingEndpoint:t,configEndpoint:n,collectorEndpoint:i})=>["dev","stg"][p](e)&&t?t:n||(i||"ecollector.sophi.io"))({environment:$e,stagingEndpoint:Ce,configEndpoint:De,collectorEndpoint:Ne});const{appId:xe=l,client:Pe}=Se,Ee=((e=l)=>{if(e){const t=3===e.split(":")[d],n="website"===e.split("-").pop();if(t||n)return e}return`${e||"no_client_id"}-website`})(xe||Te||Pe)||l,je=Ee.split(/:|-/)[0];if(["tribune","reuters","ajc","wan"][p](je)&&(Oe=`ecollector-${je}.sophi.io`),"theglobeandmail"===je&&(Oe="ecollector-tgam.sophi.io"),window[b].settings.discoverRootDomain="string"!=typeof Se.cookieDomain,window[b].settings.trackerSettings={appId:Ee,platform:"web",cookieName:Se.trackerName,cookieDomain:Se.cookieDomain,discoverRootDomain:Se.discoverRootDomain,encodeBase64:Se.encodeBase64,pageUnloadTimer:300,post:Se.enablePost,respectDoNotTrack:!!Se.dnt,forceSecureTracker:Se.forceSecureTracker,sessionCookieTimeout:Se.sessionDuration,bufferSize:Se.bufferSize,cookieSecure:Se.cookieSecure,cookieSameSite:Se.cookieSameSite,beacon:i},!window[window[b].settings.trackerName]){const e="$OPHI_GN",t=window[b].settings.trackerName;window[e]=window[e]||[],window[e].push(t),window[t]=(...e)=>{(window[t].q=window[t].q||[]).push(e)},window[t].q=window[t].q||[];const{onLoadCallback:n}=window[b].settings;window[t]((()=>{pe((()=>{n&&v(n)&&n(),ye()}))}))}try{const{linkedDomains:e,host:t=window[b].data.environment.host}=window[b].settings;if(Array.isArray(e)){const n=de(t,e,a),i=new RegExp(`(${n.join(")|(").replace(/\./gi,"\\.")})`,"i");window[b].settings.trackerSettings.crossDomainLinker=e=>i.test(e.href)}}catch(t){window[b].log("Cross domain tracking failure",e,ve,t,c,i)}const{data:{page:{breadcrumb:Ae,title:Me,type:Ue}=c,visitor:{type:Le,isLoggedIn:_e,uid:Ve}=c,environment:{isAdBlocked:Re,isPrivate:Fe,host:ze}=c,client_session:{userId:Be,sessionId:qe}=c,pvUUID:Ze}=c,settings:{sessionDuration:Je,onePageApp:We,trackerName:He,duplicateEndpoint:Ge,duplicateT:Qe,client:Ye,collectorEndpoint:Xe,trackerSettings:Ke,enablePagePing:et,pagePing:{start:tt,interval:nt},enableClickTracking:it,clickFilter:ot,pseudoClicks:rt,noConfigFile:at,pvUUIDName:st,isSPA:ct,cookieLifeTime:lt,adCallback:dt,videoCallback:pt,contentImpressionCallback:ut,videoDisabledList:gt,iframeOriginList:mt,plugin:{adblock:ft=i,private:ht=i,video:bt,advancedVideo:wt}=c}=c}=window[b]||c,yt=(e=o)=>{if(e&&w(e)){if(new RegExp("^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$").test(e))return e}return(()=>{const e=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1);return`${e()+e()}-${e()}-${e()}-${e()}-${e()+e()+e()}`})()},vt=(e,t=o)=>{try{const i="getAttribute",r=(n="meta",[...document.getElementsByTagName(n)]).filter((t=>(t[i]("name")||t[i]("property"))===e))[0].content;return r?r.substring(0,t):o}catch(e){return o}var n},kt=e=>[null,l,o][p](e)||Number.isNaN(e)||"boolean"==typeof e?o:+e,It=(e,t=0)=>kt(e)>t?kt(e):o,St="defaultContexts",$t=["facebook","google","linkedin","twitter","microsoft","auth0","auth2","aws","active directory","azure","sharepoint","ip","ldap","yahoo","wordpress","baidu","ping federate","ws-federation","yandex","instagram","weibo","other"],Tt="version",Ct="fields",Nt="vendor",Dt="dataFunction",Ot="dataValidator",xt="feature",Pt="action",Et="label",jt="contentId",At="article",Mt="string",Ut="com.snowplowanalytics.snowplow",Lt="com.sophi",_t={defaultValue:r},Vt={defaultValue:0},Rt={isRequired:i},Ft={[Ot]:e=>(e=>"string"!=typeof e||0===e.length?o:e)(e)},zt={[Ot]:e=>(e=>"number"!=typeof e||Number.isNaN(e)||e===1/0?o:e)(e)},Bt={[Ot]:e=>(e=>"boolean"!=typeof e?o:e)(e)},qt={[Ot]:e=>(e=>!y(e)||e.length<1?o:e)(e)},Zt={[Ot]:e=>M(e)},Jt={[Ot]:e=>(e=>"string"==typeof e&&new RegExp(A).test(e.toUpperCase())?e.toUpperCase():o)(e)},Wt=["Anonymous","Registered","Subscribed"],Ht={defaultValue:Wt[0]},Gt=["article","section","account","subscription","game","tool","stock","gallery","slideshow","video","error","utility","page","funnel","conversion","in app web-view","(not provided)"],Qt=["article","video","audio","image"],Yt={connector:()=>({[Tt]:"1-0-4",[Ct]:{pageViewUUID:{...Rt,defaultValue:(window.sophi.data.pvUUID=yt(window.sophi.data?.pvUUID||window[window.sophi.settings?.pvUUIDName]),window.sophi.data?.pvUUID),...Ft}}}),environment:()=>({[Tt]:"1-0-8",[Ct]:{state:{[Dt]:e=>document.hidden?"inactive":e,...Rt,defaultValue:"active",...Ft},environment:{[Dt]:(e=l)=>C(["dev","stg"][p](e)?e:"prod"),...Rt,defaultValue:"prod",...Ft},client:{[Dt]:C,...Ft},clientConfigVersion:{...Ft},isAdBlock:{[Dt]:k,...Bt},[Tt]:{[Dt]:C,...Ft},trackerVersion:{...Ft},screenOrientation:{[Dt]:e=>e||(window.matchMedia("(orientation: portrait)").matches?"portrait":"landscape"),...Ft},connectionType:{[Dt]:e=>{const{mozConnection:t,webkitConnection:n,connection:i}=navigator;return e||(i||t||n||c).effectiveType},...Ft}}}),page:()=>({[Tt]:"1-0-14",[Ct]:{[u]:{[Dt]:e=>Gt[p](e)?e:Qt[p]((window.sophi.data?.content||c).type)?At:o,...Rt,..._t,...Ft},breadcrumb:{[Dt]:e=>{let t=e;t||(t=document?.location?.pathname?.split("/").filter((e=>e&&e.length>0)),(window.sophi.data?.page||c).type===At&&t.splice(-1)),t&&w(t)&&/:(section|article)$/i.test(t)&&(t=t.replace(/:(section|article)$/i,""));const n=C(t,I(1024));return n?n.replace(/\/|>/g,":").replace(/(^:)|(:$)/g,""):o},...Rt,..._t,...Ft},sectionName:{[Dt]:e=>N(e!==r&&e?e:((window.sophi.data?.page||c).breadcrumb||l).split(":")[0]),...Rt,..._t,...Ft},keywords:{[Dt]:(e=s)=>{let t=e;return e&&e[d]||(t=vt("keywords")),"string"==typeof t&&t[d]&&(t=t.split(",").map((e=>e.trim()))),E(t)},...qt},topics:{[Dt]:E,...qt},dateCreated:{[Dt]:O,...Jt},dateModified:{[Dt]:O,...Jt},datePublished:{[Dt]:O,...Jt},layout:{[Dt]:N,...Ft},flags:{[Dt]:e=>E(e,20),...qt},isTranslated:{[Dt]:e=>document.documentElement?/translated-(ltr|rtl)/.test(document.documentElement?.className)&&!!document.documentElement?.getAttribute("lang"):e,...Bt},rid:{[Dt]:e=>{const t=(window.sophi.data?.page||c).rid||e;if(t)return t;const{referrer:n}=window?.document,i=se(`click-rid-${n}`);return i&&(window.sophi.data.page.rid=i,se(`click-rid-${n}`,null)),i},...Ft}}}),metadata:()=>({[Tt]:"1-0-1",[Ct]:{canonicalURL:{[Dt]:e=>T(e||(h("link[rel=canonical]")||c).href),...Ft},amphtmlURL:{[Dt]:e=>T(e||(h("link[rel=amphtml]")||c).href),...Ft},ogSiteName:{[Dt]:e=>D(e||vt("og:site_name")),...Ft},ogTitle:{[Dt]:e=>D(e||vt("og:title"),512),...Ft},ogDescription:{[Dt]:e=>D(e||vt("og:description"),2048),...Ft},ogType:{[Dt]:e=>N(e||vt("og:type")),...Ft},articlePublishedTime:{[Dt]:e=>O(e||vt("article:published_time")),...Ft,...Jt},articleTag:{[Dt]:e=>D(e||vt("article:tag"),512),...Ft},articleSection:{[Dt]:e=>D(e||vt("article:section"),512),...Ft}}}),content:()=>({[Tt]:"1-0-12",[Ct]:{[u]:{[Dt]:e=>e&&Qt[p](e)?e:o,...Rt,defaultValue:At,...Ft},[jt]:{[Dt]:e=>D(e,256),...Rt,..._t,...Ft},accessName:{[Dt]:e=>N(e,256),...Ft},subtype:{[Dt]:N,...Ft},accessCategory:{...Rt,defaultValue:"free access",...Ft},creditLine:{[Dt]:e=>N(e,256),...Ft},ownership:{[Dt]:N,...Ft},byline:{[Dt]:e=>{if(e&&e[d]){const t=e.map((e=>D(e))),n=x(t);return y(n)&&n[d]>10&&(n[d]=10),n}return o},...qt},contentSize:{[Dt]:e=>{if("Subscribed"!==(window.sophi.data?.visitor||c).type&&"subscribers only"===(window.sophi.data?.content||c).accessCategory)return o;let t=e;return Number.isNaN(t)&&(t=0),t>0?t:(t=(((e="article p, .article p")=>{let t=[...document.querySelectorAll(e)];return t=t.filter((e=>{const{right:t,left:n}=e.getBoundingClientRect();return t-n>0})),t[d]?t:o})()||s).map((e=>e.innerText)).join().split(/\W+/).filter(Boolean)[d],!Number.isNaN(t)&&t>0?t:o)},...zt},relatedIds:{[Dt]:e=>{if(e&&e[d]){const t=x(e);return y(t)&&t[d]>10&&(t[d]=10),t}return o},[Ot]:e=>y(e)?e.map((e=>{return n={id:Mt,relationship:Mt},"object"==typeof(t=e)&&M(n)&&Object.entries(n).every((([e,n])=>e in t&&typeof t[e]===n))?t:o;var t,n})):o},contentOrder:{[Dt]:e=>e?D(String(e),16):o,...Ft}}}),visitor:()=>({[Tt]:"1-0-8",[Ct]:{[u]:{[Dt]:t=>{const n=Wt[0],r=(e=>{if(e){if(Wt[p](e))return e}return o})(se("vat")),a=e=>{se("vat",e),se("vatP",e)};if(t){if(Wt[p](t)){const e=(window.sophi.data?.visitor||c).type;return t===n&&e&&t!==e?(a(e),e):e===n&&r&&e!==r?r:(t!==r&&a(t),t)}re(`Unexpected account type, resetting to ${r||n}`,e,St,c,{type:t},i)}return r||n},...Rt,...Ht,...Ft},isLoggedIn:{[Dt]:e=>{const n="boolean"==typeof(i=se("loggedIn"))?i:o;var i;return"boolean"==typeof e?(e!==n&&se("loggedIn",e),e):n||t},...Rt,defaultValue:!1,...Bt},postalCode:{[Dt]:(e=l)=>e&&/^[A-Z0-9-]{2,24}$/.test(e)?`${e}`.toUpperCase():o,...Ft},countryCode:{[Dt]:(e=l)=>e&&/^[A-Z]{2}$/.test(e)?`${e}`.toUpperCase():o,...Ft},loginProvider:{[Dt]:e=>{const t=e=>{const t=C(e);return $t[p](t)?t:"in-house"},n=t(se("vlp"));if(e){const i=t(e);return i!==n&&se("vlp",i),i}return n},...Ft},serviceCode:{[Dt]:e=>D(e,512),...Ft},legacyUserId:{[Dt]:e=>D(e,256),...Ft},audienceId:{[Dt]:e=>D(e,256),...Ft},isInternal:{[Dt]:k,...Bt},flags:{[Ot]:U}}}),wall_hit:()=>({[Tt]:"1-0-9",[Ct]:{[u]:{[Dt]:C,...Rt,..._t,...Ft},name:{...Ft},isDynamic:{[Dt]:k,...Bt},wallReason:{...Zt},meterCount:{[Dt]:kt,...zt},meterLimit:{[Dt]:kt,...zt},adsVisible:{[Dt]:k,...Bt},countVisibleParagraphs:{[Dt]:kt,...zt},viewType:{[Dt]:C,...Ft}}}),payment:()=>({[Tt]:"1-0-6",[Ct]:{transactionId:{...Rt,..._t,...Ft},revenue:{[Dt]:kt,...Rt,...Vt,...zt},tax:{[Dt]:kt,...Rt,...Vt,...zt},currency:{[Dt]:e=>(N(e,3)||l).toUpperCase()||o,...Ft},paymentType:{[Dt]:C,...Ft}}}),subscription_add:()=>({[Tt]:"1-0-5",[Ct]:{transactionId:{...Rt,..._t,...Ft},name:{...Rt,..._t,...Ft},termPrice:{[Dt]:kt,...zt},termPeriod:{...Ft},termLength:{[Dt]:kt,...zt},startDate:{[Dt]:O,...Jt},endDate:{[Dt]:O,...Jt},funnelName:{[Dt]:N,...Ft},id:{...Ft},campaignCode:{...Ft},accountType:{...Ft},rateType:{...Ft},trialTermPrice:{[Dt]:kt,...zt},trialTermPeriod:{...Ft},trialTermLength:{[Dt]:kt,...zt},promotionCode:{...Ft},subscriptionType:{[Dt]:t=>{const n=C(t);return["digital","print","3rd party"][p](n)?n:(re("Unexpected subscriptionType",e,St,c,{subscriptionType:t},i),o)},...Rt,..._t,...Ft}}}),link_impressions:()=>({[Tt]:"1-0-11",[Ct]:{links:{[Dt]:e=>{const t=e.map((e=>({uri:e.uri?D(e.uri,2048):r,[jt]:e[jt]?D(e[jt],256):o,[Et]:e[Et]?N(e[Et],256):o,[xt]:e[xt]?N(e[xt]):r,top:kt(e.top),left:kt(e.left),height:kt(e.height),width:kt(e.width),position:It(e.position),tab:It(e.tab),total:It(e.total),isCurated:k(e.isCurated)})));return x(t)},...Rt,defaultValue:[{uri:r,[Et]:"link_impressions generated with no data supplied"}],...qt}}}),content_impressions:()=>({[Tt]:"1-0-5",[Ct]:{content:{[Dt]:e=>{const t=e.map((e=>({[xt]:e[xt]?N(e[xt]):r,[u]:e[u]?N(e[u]):r,[Pt]:e[Pt]?N(e[Pt]):r,[Et]:N(e[Et],256),[jt]:D(e[jt],256),id:D(e.id,256),timestamp:kt(e.timestamp),top:kt(e.top),left:kt(e.left),height:kt(e.height),width:kt(e.width),total:It(e.total),position:It(e.position)})));return x(t)},...Rt,defaultValue:[{[xt]:r,[Pt]:r,[u]:r,[Et]:"content_impressions generated with no data supplied"}],...qt}}}),newsletter_interaction:()=>({[Tt]:"1-0-1",[Ct]:{[Pt]:{[Dt]:C,...Rt,...Ft,..._t},name:{[Dt]:C,...Ft},isUnsubscribeAll:{[Dt]:k,...Bt},frequency:{...Ft}}}),account_interaction:()=>({[Tt]:"1-0-6",[Ct]:{[u]:{[Dt]:e=>{if(e){const t=C(e);if(["registration","login","account","alert"][p](t))return t}return r},...Rt,..._t,...Ft},[Pt]:{[Dt]:N,...Rt,..._t,...Ft},[Et]:{...Ft}}}),comment_interaction:()=>({[Tt]:"1-0-1",[Ct]:{[Pt]:{[Dt]:C,...Rt,..._t,...Ft},[xt]:{[Dt]:C,...Ft}}}),link_click:()=>({[Tt]:"1-0-1",[Nt]:Ut,[Ct]:{targetUrl:{[Dt]:T,...Rt,..._t,...Ft},elementId:{...Ft},elementClasses:{...qt},elementTarget:{...Ft},elementContent:{...Ft}}}),click:()=>({[Tt]:"1-0-13",[Ct]:{[xt]:{[Dt]:N,...Rt,..._t,...Ft},[u]:{[Dt]:C,...Rt,defaultValue:"link",...Ft},[Et]:{[Dt]:e=>N(e,256),...Rt,..._t,...Ft},position:{[Dt]:It,...zt},linkCount:{[Dt]:It,...zt},targetContentId:{...Ft},presentation:{[Dt]:e=>P(j(e),10,128),...qt},presentationItemIDs:{[Dt]:e=>P(j(e),10,256),...qt},hierarchy:{[Dt]:e=>It(e,-1),...zt},engine:{[Dt]:N,...Ft},engineId:{[Dt]:e=>N(e,256),...Ft},isSponsored:{[Dt]:k,...Bt},tab:{[Dt]:It,...zt},[Pt]:{[Dt]:N,...Ft},isCurated:{[Dt]:k,...Bt}}}),client_session:()=>({[Tt]:"1-0-1",[Nt]:Ut,[Ct]:{userId:{[Dt]:e=>{if(e&&e!==f){const t=C(e);return se(g,t),t}return se(g)||f},...Rt,..._t,...Ft},sessionId:{[Dt]:e=>{const t="csSessionId";if(e&&e!==f){const n=C(e);return se(t,`${n}|${Date.now()}`,Je),n}let n=se(t);return n?(n=n.split("|"),(Date.now()-n[1])/1e3/60>30?(se(t,`${f}|${Date.now()}`,Je),f):n[0]):f},...Rt,defaultValue:f,...Ft},sessionIndex:{[Dt]:e=>{const t="csSessionIndex";let n=se(t),i=kt(Math.round(+e));return n&&(n=n.split("|"),(n[0]>i||!i)&&([i]=n),(Date.now()-n[1])/1e3/60>30&&(i<=n[0]||!i)&&(i=kt(n[0])+1)),i=kt(Math.round(+i)),se(t,`${i}|${Date.now()}`,Je),i},...Rt,defaultValue:0,...zt},previousSessionId:{[Dt]:C,...Rt,defaultValue:null,[Ot]:e=>"string"==typeof e&&0===e.length||null===e?e:o},storageMechanism:{...Rt,defaultValue:"SQLITE",...Ft},firstEventId:{[Dt]:C,...Ft}}}),media_event:()=>({[Tt]:"1-0-2",[Nt]:Lt,[Ct]:{[u]:{[Dt]:C,...Rt,..._t,...Ft},[Pt]:{[Dt]:C,...Rt,..._t,...Ft},id:{[Dt]:C,...Rt,..._t,...Ft},isAutoPlay:{[Dt]:k,...Bt},isLiveStream:{[Dt]:k,...Bt},duration:{[Dt]:kt,...zt},timeElapsed:{[Dt]:kt,...zt},playbackRate:{[Dt]:kt,...zt},previousPosition:{[Dt]:kt,...zt},featureType:{[Dt]:C,...Ft},[xt]:{[Dt]:C,...Ft},isFullScreen:{[Dt]:k,...Bt},isInView:{[Dt]:k,...Bt},isMute:{[Dt]:k,...Bt},isPopOut:{[Dt]:k,...Bt},platform:{[Dt]:C,...Rt,..._t,...Ft},language:{[Dt]:C,...Ft},voiceOption:{[Dt]:C,...Ft},closedCaptions:{[Dt]:C,...Ft},milestone:{[Dt]:kt,...zt}}}),ad_event:()=>({[Tt]:"1-0-2",[Nt]:Lt,[Ct]:{[u]:{[Dt]:C,...Rt,..._t,...Ft},[Pt]:{[Dt]:C,...Rt,..._t,...Ft},id:{[Dt]:C,...Rt,..._t,...Ft},mediaId:{[Dt]:C,...Ft},isMute:{[Dt]:k,...Bt},pricingModel:{[Dt]:C,...Ft},cost:{[Dt]:kt,...zt},isLinear:{[Dt]:k,...Bt},timingType:{[Dt]:C,...Ft},top:{[Dt]:kt,...zt},left:{[Dt]:kt,...zt},height:{[Dt]:kt,...zt},width:{[Dt]:kt,...zt},[xt]:{[Dt]:C,...Ft}}}),ab_tests:()=>({[Tt]:"1-0-0",[Nt]:Lt,[Ct]:{tests:{[Dt]:(e=[])=>{if(!e||!Array.isArray(e))return o;let t=[];return e[d]>0&&(t=x(e.map((e=>{let{testId:t,engine:n,variantName:i,segmentName:a,duration:s,expiry:c,pageURL:l}=e,d=e.store;if(t=D(t),t){const e=(new Date).getTime();return n=D(n)||r,i=D(i)||r,a=D(a),["page","visit","visitor","duration"][p](d)||(d=o),"duration"!==d||Number.isNaN(kt(s))?"visit"===d?c=Math.round(e+1e3*Je):"page"===d&&(l=document.location.href):(s=kt(s),c=Math.round(e+24*s*60*60*1e3)),{testId:t,engine:n,variantName:i,segmentName:a,store:d,duration:s,expiry:c,pageURL:l}}return o})),"testId")),t},...Rt,defaultValue:[{testId:r,variantName:r,segmentName:"ab_tests generated with no data supplied"}],[Ot]:U}}}),error:()=>({[Tt]:"1-0-2",[Ct]:{[u]:{[Dt]:C,...Rt,defaultValue:"issue",...Ft},origin:{[Dt]:C,...Rt,..._t,...Ft},message:{[Dt]:C,...Rt,..._t,...Ft},errorObject:{...Zt},contextData:{...Zt},isFatal:{[Dt]:k,...Bt}}}),extra_data:e=>{var t;const n=e&&((t=e)&&"object"==typeof t&&t.constructor===Object)?Object.keys(e):s,i=e=>w(e)?T(e,I(256)):$(e)?kt(e):S(e)?e:o,r=e=>{if(y(e)){if(e.filter((e=>w(e)||S(e)||$(e)))[d]){return e.map(i).filter(Boolean)}return o}return i(e)},a=e=>w(e)||S(e)||$(e)||y(e)?e:o,c={};n[d]&&n.forEach((e=>{c[e]={[Dt]:r,[Ot]:a}}));return{[Tt]:"1-0-0",[Nt]:Lt,[Ct]:c}}},Xt=(e,t)=>{let n={},i={},r={};try{if(e){const{fields:n,vendor:a,version:s}=Yt[e](t);if(i=window.sophi.data[e]||{},t&&t.constructor===Object&&Object.keys(t)[d]&&(i={...i,...t}),r={schema:`iglu:${a||"com.globeandmail"}/${e}/jsonschema/${s}`,data:{}},r=(({fields:e,sophiData:t,context:n})=>(Object.entries(e).forEach((([e,{dataFunction:i,dataValidator:r,isRequired:a,defaultValue:s,value:c}])=>{let l=c;if(l="boolean"==typeof t[e]?t[e]:y(t[e])?x(t[e]):t?t[e]:c,v(i)&&(l=i(l)),l=v(r)?r(l):o,l===o&&s!==o&&(l=s),n.data[e]=y(l)&&!l[d]?o:l,!n.data[e]&&n.data[e]===o&&a)throw new Error(`Field ${e} is required but not set`)})),n))({fields:n,sophiData:i,context:r}),r=(e=>e.data&&Object.values(e.data).some((e=>S(e)||e))?e:o)(r),r)return r}throw new Error("Context contains no data")}catch(e){n=e}return re(`Failed to generate ${e} context`,"error","getContexts",n,{contextData:t,sophiData:i,context:r}),o};window[b].data.environment.clientConfigVersion="1.3",Ie.itemImpression={...Ie.itemImpression,properties:{featureProperties:Ie.itemImpression.properties.featureProperties,source:"hybrid",parentElement:["[data-fid]",".c-package",".pb-f-related-articles",".pb-f-global-package",".pb-f-marketing-container-placeholder",".pb-f-generic-text",".pb-c-section-Xn-columns",".pb-f-marketing-container",".pb-f-article-content",".pb-f-topics-article-related",".pb-f-article-actions",".pb-f-recommended-articles",".c-topic",".pb-f-global-story-feed",".pb-f-global-financial-search",".gtext",".pb-container"],delay:500,condition:e=>!e.closest(".pb-f-global-header, .pb-f-global-footer-nav, .c-scroll-menu__link, .pb-f-article-comment, .arc-following-topics-group-homepage__info"),data:(e,t,n,i,r)=>{let a=e;const s=a.label;if(s&&/(?:^.{1,300}\n.{1,300}$)/.test(s)){const e=s.split(/\n/);a.label=e[/^[A-Z\s]+$/.test(e[0])?1:0]}const c=a.feature;if(c&&/[a-z]+/.test(c)){const e=(t.target||t).closest(".l-container");if(e){const t=e.innerText.split(/\n/),n=t.indexOf(c)-1;t[n]&&(a.feature=t[n])}}if(i&&i.className.split(" ").includes("pb-f-article-content")&&(a.feature="article-body"),i&&i.dataset&&i.dataset.fid){const{dataset:e}=i;a.feature=(e.pid?`${e.pid}:`:"")+e.fid}if(r&&(a.position=r.position),a=Object.fromEntries(Object.entries(a).map((([e,t])=>"string"!=typeof t||["contentId","sophi","cid"].includes(e)?[e,t]:[e,t.trim().toLowerCase()]))),a.feature&&!n&&(a.feature=Ie.itemImpression.dedupeFeatureName(a.feature,i)),"hybrid"===Ie.itemImpression.properties.source&&/^coronavirusinfo\s?/.test(a.feature)&&(a.position=r.position),!a.contentId&&a.cid&&(a.contentId=a.cid),n)return a;const{feature:l,label:d,position:p,total:u,uri:g,top:m,left:f,height:h,width:b,cid:w,sophi:y,contentId:v}=a,k={top:m,left:f,height:h,width:b,uri:g,contentId:v||y||w,feature:l,position:p,total:u,label:d};return Ie.itemImpression.linkData.push(k),o}},linkData:[],linkProcessed:[]},Ie.contexts.extract.click=e=>{try{let t=Ie.itemImpression.properties.featureProperties(e,!0,!0);t=Ie.itemImpression.properties.data(t,e,!0,e.closest(Ie.itemImpression.properties.parentElement.join(",")));const n={targetContentId:t.contentId||t.sophi,isSponsored:!!(t.isSponsored||t.sponsored||t.sophiIsSponsored),feature:t.feature,position:t.position,linkCount:t.linkCount||t.total,sophiEngine:t.sophiEngine,engineId:t.engineId,engine:t.engine,label:t.label,type:t.type};return Xt("click",n)}catch(t){Ie.log("Click data extraction failed","error","sophi/config.js",t,{element:e})}return o};const Kt=Ie.settings,en=e=>{const t=Ie.contexts.extract.click(e),{clickCallback:n}=Kt;return"function"==typeof n&&n(t.data),t};if(Kt.enableClickTracking){const e=Kt.trackerName,t="function"==typeof Kt.clickFilter?{filter:Kt.clickFilter}:null;window[e](`enableLinkClickTracking:${e}`,t,!0,!0,[en])}window.sophi.startItemImpression()})()})();