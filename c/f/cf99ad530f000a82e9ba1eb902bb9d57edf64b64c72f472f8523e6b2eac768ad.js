"use strict";(self.webpackChunk_kambi_micro_frontend_app_router=self.webpackChunk_kambi_micro_frontend_app_router||[]).push([[1117],{12981:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(38513),i=n(97849),r=n(74553);class o extends s.Jk{etHeaders(){const e=super.getHeaders();return Object.assign(e,{"Accept-Language":i.Session.get(r.SessionAPIConstants.LOCALE)})}pdatePollingIntervals(){for(const e of Object.values(this.channels))e.pollingInterval=e.getPollingInterval()}}},10600:(e,t,n)=>{n.d(t,{Z:()=>d});var s=n(23459),i=n(94798),r=n(50019),o=n(20578);class c extends r.Z{get pushConnection(){return o.Z}routingKeyForParams(){return"ev"}getPushSubscriptionOptions(e){return{key:this.routingKeyForParams(e)}}andleMessage(e,t){if(e===s.Z.PUSH_MSG_UPDATE_EVENT_SCORE)return i.EventBus.send(i.EventKeys.SCORE_UPDATED,{eventId:t.score.eventId,data:t.score.score})}}const d=new c},89733:(e,t,n)=>{n.d(t,{P8:()=>g,Qc:()=>C,Sl:()=>E,VP:()=>h,oL:()=>a,s7:()=>v});var s=n(51679),i=n(48401),r=n(69656),o=n(4591);const c=d=(e,t)=>{const n=[];for(let t=0;t<=e.length;t+=1)n[t]=[];for(let e=0;e<=t.length;e++)n[0][e]=0;for(let t=0;t<=e.length;t++)n[t][0]=0;for(let s=1;s<=e.length;s++)for(let i=1;i<=t.length;i++)e[s-1]===t[i-1]?n[s][i]=n[s-1][i-1]+1:n[s][i]=0;return c(n.map(c))};function E(e){switch(e.source){case o.nh.SCORE:return;case o.Y2.FEED:return Number.isInteger(e.secondInMatch)?e.minute=Math.ceil(e.secondInMatch/60):(Number.isInteger(e.secondInPeriod)||(e.secondInPeriod=e.periodLengthInSeconds-e.remainingSecondInPeriod),e.minute=Math.ceil(e.secondInPeriod/60)),e.secondInPeriodAddedTime&&(e.extraTimeMinute=Math.ceil(e.secondInPeriodAddedTime/60)),e;case o.Y2.TICKER:return e.minute+=1,e}}function u(e){return e.occurrenceTypeId?o.Y2.FEED:e.score?o.Y2.SCORE:o.Y2.TICKER}function a(e){const{source:t=u(e),type:n,occurrenceTypeId:s}=e;switch(t){case o.Y2.FEED:return o.r4[s];case o.Y2.SCORE:return o.nh.SCORE;case o.Y2.TICKER:return o.Lw[n]}}function h(e,t){const{source:n=u(e)}=e;switch(n){case o.Y2.FEED:{const t=e.occurrenceTypeId;if(new RegExp(`${o.fK.HOME}$`).test(t))return o.gf.HOME;if(new RegExp(`${o.fK.AWAY}$`).test(t))return o.gf.AWAY;break}case o.Y2.SCORE:if(e.score.who===o.fK.HOME)return o.gf.HOME;if(e.score.who===o.fK.AWAY)return o.gf.AWAY;break;case o.Y2.TICKER:{const n=e.message,s=t.get("homeName"),i=t.get("awayName"),r=t.get("englishName");if(!n)return;if(new RegExp(`^${s}`).test(n))return o.gf.HOME;if(new RegExp(`^${i}`).test(n))return o.gf.AWAY;if(new RegExp(`^${r.split(" - ")[0]}`).test(n))return o.gf.HOME;if(new RegExp(`^${r.split(" - ")[1]}`).test(n))return o.gf.AWAY;return(s?d(n,s):"")>(i?d(n,i):"")?o.gf.HOME:o.gf.AWAY}}}function v(e){const{source:t=u(e)}=e;return t===o.Y2.FEED&&o.Jm[e.action]||o.JA.ADDED}function C(e){const t=s.Z.get(e.eventId);if(!t)return;if(e.source=u(e),e.type=a(e),e.action=v(e),!e.type)return;o.Xf.includes(e.type)&&e.periodId===o.jw.PS&&(e.type=o.Q_[e.type]),e.team=h(e,t),e.message=function(e,t){const{source:n=u(e)}=e;switch(n){case o.Y2.FEED:{const{team:n=h(e,t),type:s=e.occurrenceTypeId}=e,i=o.r8[s];return i&&n===o.gf.HOME?(0,r.i0)(i,t.get("homeName")):i&&n===o.gf.AWAY?(0,r.i0)(i,t.get("awayName")):e.message?e.message:""}case o.Y2.SCORE:return"";case o.Y2.TICKER:return e.message}}(e,t);const n=t.toJSON();return n.occurrencesSource!==o.my.FEED||o.DV[e.source]!==o.my.NON_FEED?(e=(0,i.UP)(n.sport)?function(e,t){if(e.source===o.Y2.SCORE){const{homeName:n,awayName:s}=t,{who:i,home:r,away:c}=e.score;if(!(i&&r&&c)||"0"===r&&"0"===c)return;e.message=`${n} ${r} - ${c} ${s}`,e.type=o.nh.POINT,e.homeName=n,e.awayName=s,e.scoreHome=r,e.scoreAway=c,e.homeScored=i===o.fK.HOME?o.Tb.TRUE:o.Tb.FALSE,e.awayScored=i===o.fK.AWAY?o.Tb.TRUE:o.Tb.FALSE}return delete e.minute,e}(e,n):E(e),e?(e.title=o.UY[e.type],e):void 0):void 0}function g(e){let{type:t,occurrenceId:n,periodId:s}=e;const i=t.id.split(".")[1],r=o.nh[i],c=t.defaultName;return"OT"===s&&(s="OT1"),delete e.type,{...e,id:n,defaultName:c,title:o.UY[r],occurrenceTypeId:i,periodId:s}}},32057:(e,t,n)=>{n.d(t,{Z:()=>R});var s=n(64572),i=n(38513),r=n(94798),o=n(23459),c=n(50019),d=n(20578),E=n(74661);class u extends c.Z{get pushConnection(){return d.Z}routingKeyForParams(){return"ev"}getPushSubscriptionOptions(e){return{key:this.routingKeyForParams(e)}}andleMessage(e,t){if(e===o.Z.PUSH_MSG_REMOVE_MATCH_CLOCK)return r.EventBus.send(r.EventKeys.MATCH_CLOCK_REMOVED,t.mcr.eventId);if(e===o.Z.PUSH_MSG_UPDATE_MATCH_CLOCK){const{eventId:e,matchClock:n}=t.mcu,s=(0,E.x)({...n,eventId:e});return r.EventBus.send(r.EventKeys.MATCH_CLOCK_UPDATED,s)}}}const a=new u;var h=n(7298),v=n.n(h),C=n(4591);const g=Date.now(),l=e=>{const t=Date.now();return t-1e3*(60*e.minute+e.second)-(t-g)%1e3},S=({minute:e,minutesLeftInPeriod:t,second:n,secondsLeftInMinute:s}={},i)=>Number.isInteger(e)&&Number.isInteger(t)&&Number.isInteger(s)&&Number.isInteger(n)?Math.round(e+t+(s+n)/60):i;function T({minute:e,second:t}={}){const n=Date.now();return n+1e3*(60*e+t)-(n-g)%1e3}function _(e,t,n){let s,i=Number.isInteger(t)?60-parseInt(t,10):void 0;if(Number.isInteger(n)){const r=n-e;s=t>0&&r>=1?r-1:r>=0?r:0,e+s===n&&(i=0)}return{secondsLeftInMinute:i,minutesLeftInPeriod:s}}const m=()=>1e3-(Date.now()-g)%1e3;class I extends v().Model{get idAttribute(){return"eventId"}defaults(){return{eventId:void 0,disabled:void 0,running:void 0,period:void 0,periodTime:void 0,minute:void 0,second:void 0,zeroTime:void 0,secondsLeftInMinute:void 0,minutesLeftInPeriod:void 0,periodLengthInSeconds:void 0,remainingSecondInPeriod:void 0,source:void 0}}constructor(e,t){e.zeroTime=l(e),e.reversed&&(e.endTime=T(e)),e.periodTime=S(e),Number.isInteger(e.minute)&&Number.isInteger(e.second)&&(e={...e,..._(e.minute,e.second,e.periodTime)}),super(e,t)}syncState(e){(e.minute>=0||e.second>=0)&&(e.zeroTime=l(e)),e.reversed&&(e.endTime=T(e)),e.periodTime=S(e,this.get("periodTime")),Number.isInteger(e.minute)&&Number.isInteger(e.second)&&(e={...e,..._(e.minute,e.second,this.get("periodTime"))}),this.set(e)}update(e){if(this.get("running")){const t=(this.get("reversed")&&this.get("source")===C.my.FEED?this.get("endTime")-e:e-this.get("zeroTime"))/1e3,n=Math.floor(t%60),s=Math.floor(t/60),i=_(s,n,this.get("periodTime"));this.set({second:n,minute:s,...i})}}}var p=n(51679),O=n(10194);class f extends i.IX{constructor(){super(),(0,s.Z)(this,"model",I),(0,s.Z)(this,"MATCH_CLOCKS","match_clocks"),(0,s.Z)(this,"LIVE_DATA","livedata"),(0,s.Z)(this,"services",{[this.MATCH_CLOCKS]:a,[this.LIVE_DATA]:O.Z}),(0,s.Z)(this,"_onMatchClocksReceived",(),(0,s.Z)(this,"_onMatchClockRemoved",(),(0,s.Z)(this,"_onMatchClockUpdated",(e=>{const{eventId:t,source:n,disabled:s}=e;let i=this.get(t);i||(e.eventId=t,this.add(e),i=this.get(t)),i.get("source")&&i.get("source")!==n&&n!==C.my.FEED?i.set({eventId:t,disabled:s}):i.syncState(e)})),(0,s.Z)(this,"_updateMatchClocks",(()=>{const e=Date.now();this.each((),setTimeout(this._updateMatchClocks,m())})),(0,s.Z)(this,"_onMatchClockSetSource",(e=>{const{eventId:t,source:n}=e,s=this.get(t);s&&s.set({source:n})})),r.EventBus.subscribe(r.EventKeys.MATCH_CLOCKS_RECEIVED,this._onMatchClocksReceived),r.EventBus.subscribe(r.EventKeys.MATCH_CLOCK_REMOVED,this._onMatchClockRemoved),r.EventBus.subscribe(r.EventKeys.MATCH_CLOCK_UPDATED,this._onMatchClockUpdated),r.EventBus.subscribe(r.EventKeys.MATCH_CLOCK_SET_SOURCE,this._onMatchClockSetSource),this.listenTo(p.Z,"remove",this._onEventRemoved),setTimeout(this._updateMatchClocks,m()),super.initialize()}_onEventRemovedconst R=new f},82369:(e,t,n)=>{n.d(t,{Z:()=>k});var s=n(64572),i=n(97586),r=n(38513),o=n(94798),c=n(89733),d=n(23459),E=n(50019),u=n(20578),a=n(4591);class h extends E.Z{et MESSAGE_TYPESoutingKeyForParams(e){return e&&e.id?`ev.${e.id}`:"ev"}ndleMessage(e,t){let n;switch(e){case d.Z.PUSH_MSG_UPDATE_EVENT_SCORE:n=t.score;break;case d.Z.PUSH_MSG_EVENT_INCIDENT:n=t.tu;break;case d.Z.PUSH_MSG_MATCH_OCCURRENCE:n=t.mo}if(n){if([...this.subscriptions].find(()){const e=(0,c.Qc)(n);if(e){const t=e.action===a.JA.ADDED?o.EventKeys.OCCURRENCE_RECEIVED:o.EventKeys.OCCURRENCE_REMOVED;o.EventBus.send(t,e)}}}}}const v=new h;var C=n(51679),g=n(64384),l=n(7298),S=n.n(l);class T extends l.Model{get defaults(){return{id:"",eventId:"",type:"",message:"",minute:"",relevantBetoffer:void 0,source:void 0,team:void 0,title:void 0,action:void 0,occurrenceInformations:void 0}}}var _=n(12981),m=n(83533),I=n(6549),p=n(74661),O=n(80726),f=n(97849);class R extends _.Z{constructor(){super(),o.EventBus.subscribe(o.EventKeys.PUSH_EVENT_STATE_UPDATES_CONNECTED,(()=>{this.socketUp()})),o.EventBus.subscribe(o.EventKeys.PUSH_EVENT_STATE_UPDATES_DISCONNECTED,()}url(){return`${(0,O.lm)(m.Fy)}graphql/`}parse(e){if(e&&e.data&&e.data.eventState){const{eventId:t,occurrenceSummaries:n,currentOccurrences:s}=e.data.eventState;if(n&&o.EventBus.send(o.EventKeys.LIVE_STATISTICS_RECEIVED,{eventId:t,liveStatistics:(0,I.Q)((0,I.H)(n)),source:a.my.FEED}),s){const e=s.map(c.P8),n=e.find((e=>[a.nh.CLOCK_STARTED,a.nh.CLOCK_STOPPED].includes(a.nh[e.occurrenceTypeId])));if(n){const e=(0,p.C)(n);o.EventBus.send(o.EventKeys.MATCH_CLOCKS_RECEIVED,[e])}o.EventBus.send(o.EventKeys.OCCURRENCES_RECEIVED,{eventId:t,occurrences:e})}}}getBody(e){const t={variables:{eventId:e.id,offeringId:f.Session.get(f.SessionAPIConstants.OFFERING)},query:"\n\t\t\t\tquery($eventId: Long!, $offeringId: String!) {\n\t\t\t\t\teventState(eventId: $eventId, offeringId: $offeringId) {\n\t\t\t\t\t\teventId\n\t\t\t\t\t\toccurrenceSummaries {\n\t\t\t\t\t\t\tsum\n\t\t\t\t\t\t\tperiodId\n\t\t\t\t\t\t\ttype {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentOccurrences {\n\t\t\t\t\t\t\taction\n\t\t\t\t\t\t\teventId\n\t\t\t\t\t\t\tlastUpdated\n\t\t\t\t\t\t\toccurrenceId\n\t\t\t\t\t\t\toccurrenceInformations {\n\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttype {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\tdefaultName\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tperiodId\n\t\t\t\t\t\t\tperiodLengthInSeconds\n\t\t\t\t\t\t\tremainingSecondInPeriod\n\t\t\t\t\t\t\tsecondInPeriod\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t"};return Object.assign({},super.getBody(),t)}removeSubscription(e){super.removeSubscription(e);const t=e.params.id;o.EventBus.send(o.EventKeys.MATCH_CLOCK_SET_SOURCE,{eventId:t,source:a.my.NON_FEED})}}const N=new R;var y=n(78420);class A{constructor({url:e}){(0,s.Z)(this,"EVENT_CONNECT","eventConnect"),(0,s.Z)(this,"EVENT_DISCONNECT","eventDisconnect"),(0,s.Z)(this,"EVENT_RECONNECT","eventReconnect"),(0,s.Z)(this,"EVENT_MESSAGE","eventMessage"),(0,s.Z)(this,"EVENT_ERROR","eventError"),(0,s.Z)(this,"subscriptions",new Map),(0,s.Z)(this,"onConnected",(()=>{this.trigger(this.EVENT_CONNECT)})),(0,s.Z)(this,"onDisconnected",(()=>{this.trigger(this.EVENT_DISCONNECT)})),(0,s.Z)(this,"onReconnected",(()=>{this.trigger(this.EVENT_RECONNECT)})),(0,s.Z)(this,"onError",(),(0,s.Z)(this,"onMessageReceived",(({data:e}={})=>{e&&this.trigger(this.EVENT_MESSAGE,e)})),this.wsClient=new y.SubscriptionClient(e,{lazy:!0,reconnect:!0}),this.wsClient.maxConnectTimeGenerator.setMin(5e3),this.eventHandlers=[this.wsClient.onConnected(this.onConnected),this.wsClient.onDisconnected(this.onDisconnected),this.wsClient.onReconnected(this.onReconnected),this.wsClient.onError(this.onError)]}subscribe(e){const t=JSON.stringify(e);let n=this.subscriptions.get(t);n?n.count++:(n=this.wsClient.request(e).subscribe({next:),this.subscriptions.set(t,{subscription:n,count:1}))}unsubscribe(e){const t=JSON.stringify(e),n=this.subscriptions.get(t);n&&0==--n.count&&(n.subscription.unsubscribe(),this.subscriptions.delete(t))}dispose(){this.wsClient.close(),this.eventHandlers.forEach(()}}Object.assign(A.prototype,l.Events);class D{ubscribe({url:e,variables:t,query:n}){const s=this.subscriptions.get(e)||{};let{client:i}=s;i?s.count++:(i=this.getClient({url:e}),this.subscriptions.set(e,{client:i,count:1})),i.subscribe({variables:t,query:n})}unsubscribe({url:e,variables:t,query:n}){const s=this.subscriptions.get(e)||{};let{client:i}=s;i&&(i.unsubscribe({variables:t,query:n}),0==--s.count&&(i.dispose(),this.stopListening(i),this.subscriptions.delete(e)))}getClient(e){const t=new A(e);return this.listenTo(t,t.EVENT_MESSAGE,this.onMessagReceived),this.listenTo(t,t.EVENT_CONNECT,this.onConnected.bind(this,e)),this.listenTo(t,t.EVENT_DISCONNECT,this.onDisconnected.bind(this,e)),this.listenTo(t,t.EVENT_RECONNECT,this.onReconnected.bind(this,e)),t}onConnected(e){this.trigger(o.EventKeys.PUSH_CONNECTED,e)}onDisconnected(e){this.trigger(o.EventKeys.PUSH_DISCONNECTED,e)}nMessagReceived(e){const t=Object.keys(e)[0];if(t)return this.trigger(t,e)}}Object.assign(D.prototype,S().Events);const M=new D,b="eventStateUpdates";class P extends E.Z{constructor(...e){super(...e),(0,s.Z)(this,"url",`${(0,O.kM)(m.Fy)}subscriptions`)}get pushConnection(){return M}nPushConnected(e){e.url===this.url&&o.EventBus.send(o.EventKeys.PUSH_EVENT_STATE_UPDATES_CONNECTED)}onPushDisconnected(e){e.url===this.url&&o.EventBus.send(o.EventKeys.PUSH_EVENT_STATE_UPDATES_DISCONNECTED)}getPushSubscriptionOptions(e={}){return{url:this.url,variables:{eventId:e.id,offeringId:f.Session.get(f.SessionAPIConstants.OFFERING)},query:`\n\t\t\t\tsubscription($eventId: Long!, $offeringId: String!) {\n\t\t\t\t\t${b}(eventId: $eventId, offeringId: $offeringId) {\n\t\t\t\t\t\teventId\n\t\t\t\t\t\toccurrenceSummaries {\n\t\t\t\t\t\t\tsum\n\t\t\t\t\t\t\tperiodId\n\t\t\t\t\t\t\ttype {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentOccurrences {\n\t\t\t\t\t\t\taction\n\t\t\t\t\t\t\teventId\n\t\t\t\t\t\t\tlastUpdated\n\t\t\t\t\t\t\toccurrenceId\n\t\t\t\t\t\t\toccurrenceInformations {\n\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttype {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\tdefaultName\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tperiodId\n\t\t\t\t\t\t\tremainingSecondInPeriod\n\t\t\t\t\t\t\tsecondInPeriod\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`}}handleMessage(e,t){const{eventId:n,occurrenceSummaries:s,currentOccurrences:i}=t.eventStateUpdates;if(s&&o.EventBus.send(o.EventKeys.LIVE_STATISTICS_UPDATED,{eventId:n,data:(0,I.H)(s),source:a.my.FEED}),i){const e=i.map(().filter(();e.forEach((e=>{const t=e.action===a.JA.REMOVED?o.EventKeys.OCCURRENCE_REMOVED:o.EventKeys.OCCURRENCE_RECEIVED;o.EventBus.send(t,e)}));const t=e.find((e=>[a.nh.CLOCK_STARTED,a.nh.CLOCK_STOPPED].includes(a.nh[e.occurrenceTypeId])));if(t){const e=(0,p.C)(t);o.EventBus.send(o.EventKeys.MATCH_CLOCK_UPDATED,e)}}}removeSubscription(e){super.removeSubscription(e);const t=e.params.id;o.EventBus.send(o.EventKeys.MATCH_CLOCK_SET_SOURCE,{eventId:t,source:a.my.NON_FEED})}}const U=new P;var K=n(99315),Z=n(45948);const{SPORT_AMERICAN_FOOTBALL:w}=Z.Z,H=[a.nh.PENALTY_SHOOTOUT_SCORED,a.nh.PENALTY_SHOOTOUT_MISSED],L=e=>e.id,V=["FOOTBALL","AMERICAN_FOOTBALL"];class F extends r.IX{constructor(){super(),(0,s.Z)(this,"model",T),(0,s.Z)(this,"OCCURRENCES","occurrences"),(0,s.Z)(this,"EVENT_STATE","event-state"),(0,s.Z)(this,"EVENT_STATE_UPDATES","event-state-updates"),(0,s.Z)(this,"services",{[this.OCCURRENCES]:v,[this.EVENT_STATE]:N,[this.EVENT_STATE_UPDATES]:U}),(0,s.Z)(this,"onPushedOccurenceReceived",(e=>{const t=C.Z.get(e.eventId);let n;if(t&&(e.source===a.Y2.FEED?t.set("occurrencesSource",a.my.FEED):t.get("occurrencesSource")||t.set("occurrencesSource",a.my.NON_FEED),n=t.get("occurrencesSource")),n&&n===a.DV[e.source]){if(e.type===a.nh.LIFETIME_END&&e.periodId===a.jw.PS){const{homePenalties:t,awayPenalties:n}=this.getPenaltiesForEvent(e.eventId);if(e.type===a.nh.LIFETIME_END){const s=(0,i.oA)(t).length,r=(0,i.oA)(n).length;e.team=s>r?a.gf.HOME:a.gf.AWAY}}this.setModels([e])}e.source===a.Y2.TICKER&&e.type===a.nh.MESSAGE?o.EventBus.send(o.EventKeys.MESSAGE_TO_PUNTERS_RECEIVED,{eventId:e.eventId,message:e.message}):e.type===a.nh.POINT&&o.EventBus.send(o.EventKeys.POINT_RECEIVED,{eventId:e.eventId})})),(0,s.Z)(this,"onPushedOccurenceRemoved",(),(0,s.Z)(this,"onEventAddedOrChanged",(e=>{const t=e.get("liveData"),n=e.hasTag(K.ju.LIVE_OCCURRENCE_FEED)&&e.get("sport")===w;t&&!n&&this.parseLiveData(e,t)})),(0,s.Z)(this,"onEventRemoved",(e=>{this.remove(this.where({eventId:e.id}))})),(0,s.Z)(this,"onBetofferRemoved",(e=>{this.filter((t=>t.get("eventId")===e.get("eventId")&&t.get("relevantBetoffer")&&t.get("relevantBetoffer").id===e.id)).forEach((e=>e.set("relevantBetoffer",void 0)))})),(0,s.Z)(this,"onOccurrencesReceived",(({eventId:e,occurrences:t})=>{const n=C.Z.get(e);n&&this.parseLiveData(n,{occurrences:t})})),o.EventBus.subscribe(o.EventKeys.OCCURRENCE_RECEIVED,this.onPushedOccurenceReceived),o.EventBus.subscribe(o.EventKeys.OCCURRENCE_REMOVED,this.onPushedOccurenceRemoved),o.EventBus.subscribe(o.EventKeys.OCCURRENCES_RECEIVED,this.onOccurrencesReceived),C.Z.on("add",this.onEventAddedOrChanged),C.Z.on("change:liveData",this.onEventAddedOrChanged),C.Z.on("remove",this.onEventRemoved),g.Z.on("remove",this.onBetofferRemoved)}parseLiveData(e,t){const n=e.id,s=V.includes(e.get("sport"))&&!!t.occurrences,r=s?a.my.FEED:a.my.NON_FEED,d=(0,i.dF)(t.liveFeedUpdates,(e=>e.type===a.Jj.TICKER&&e.ticker.type===a.dv.MESSAGE));if(d&&t.statistics){const e=t.statistics.sets?(0,i.qr)(t.liveFeedUpdates,():-1;t.liveFeedUpdates.indexOf(d)>e&&o.EventBus.send(o.EventKeys.MESSAGE_TO_PUNTERS_RECEIVED,{eventId:n,message:d.ticker.message})}let E;if(s){const e=(t.liveFeedUpdates||[]).filter((e=>e.type===a.Jj.TICKER&&e.ticker.type===a.dv.MESSAGE)).map((e=>({id:e.ticker.id,eventId:e.ticker.eventId,occurrenceTypeId:"MESSAGE",message:e.ticker.message,secondInMatch:e.ticker.minute?60*(e.ticker.minute+1):0})));E=[...new Set([...t.occurrences,...e])]}else{if(!t.liveFeedUpdates)return;E=t.liveFeedUpdates.map((e=>({...e.ticker||e,eventId:n})))}e.set("occurrencesSource",r),E=(0,i.oA)(E.map(c.Qc));const u=this.where({eventId:n});if(s){const e=u.map(L),t=E.map(L),n=(0,i.e5)(e,t);this.removeModels(n)}else this.reset();this.setModels(E)}getPenaltyShootoutScore(e){const t={score:{home:0,away:0},home:[],away:[]};return this.filter((t=>t.get("eventId")===e&&t.get("periodId")===a.jw.PS&&H.includes(t.get("type")))).forEach((e=>{const n=e.get("team")===a.gf.HOME,s=e.get("type")===a.nh.PENALTY_SHOOTOUT_SCORED;(n?t.home:t.away).push({scored:s,id:e.id}),s&&(t.score[n?"home":"away"]+=1)})),t}setModels(e){this.set(e,{remove:!1})}etPenaltiesForEvent(e){const t=this.filter((t=>t.get("eventId")===e&&(t.get("type")===a.nh.PENALTY_SHOOTOUT_SCORED||t.get("type")===a.nh.PENALTY_SHOOTOUT_MISSED)));return{homePenalties:t.filter((e=>e.get("team")===a.gf.HOME)).map((e=>e.get("type")===a.nh.PENALTY_SHOOTOUT_SCORED)),awayPenalties:t.filter((e=>e.get("team")===a.gf.AWAY)).map(()}}isPenaltyShootoutDoneForEvent(e){const{homePenalties:t,awayPenalties:n}=this.getPenaltiesForEvent(e);return((e=[],t=[])=>{const n=(0,i.oA)(e).length,s=(0,i.oA)(t).length;if(e.length===t.length&&e.length>5&&e[e.length-1]!==t[t.length-1])return!0;if(Math.max(e.length,t.length)<=5){const i=Math.abs(n-s);if(5-(n-s<0?e:t).length<i)return!0}return!1})(t,n)}}const k=new F},23645:(e,t,n)=>{n.d(t,{Z:);var s=n(38513),i=n(94798),r=n(10600),o=n(7298);class c extends o.Model{get idAttribute(){return"eventId"}get defaultsvar d=n(51679);class E extends s.IX{tialize(){i.EventBus.subscribe(i.EventKeys.SCORES_RECEIVED,this._onScoresReceived.bind(this)),i.EventBus.subscribe(i.EventKeys.SCORE_RECEIVED,this._onScoreReceived.bind(this)),i.EventBus.subscribe(i.EventKeys.SCORE_UPDATED,(e=>{this._onScoreUpdated(e.eventId,e.data)})),i.EventBus.subscribe(i.EventKeys.STATISTICS_UPDATED,(),d.Z.on("remove",this._onEventRemoved.bind(this)),super.initialize()}_onSetUpdated(e,t){const n=this.get(e);n&&t&&t.sets&&n.set("sets",t.sets)}_onScoresReceived(e){this.set(e,{remove:!1})}_onScoreReceivedonScoreUpdated(e,t){const n=this.get(e);n?n.set(t):(t.eventId=e,this.add(t))}_onEventRemoved(e){this.remove(this.where({eventId:e.id}))}}const u=new E}}]);
//# sourceMappingURL=kambi-chunk-1117.cb1078d67e78b7569791.js.map