;
(self.AMP=self.AMP||[]).push({m:0,v:"2401191523000",n:"amp-video-docking",ev:"0.1",l:!0,f:function(t,i){!function(){e;rray.isArray;var a=Object.prototype,u=a.hasOwnProperty;unction h(t,i,n,o,r,e,s,a,u,c,h){return t}a.toString;var d,l,v,f=/(\0)|^(-)$|([\x01-\x1f\x7f]|^-?[0-9])|([\x80-\uffff0-9a-zA-Z_-]+)|[^]/g;ion y(t){for(var i=t.querySelectorAll("[ref]"),n=c(),o=0;o<i.length;o++){var r=i[o],e=r.getAttribute("ref");h(e),r.removeAttribute("ref"),h(void 0===n[e]),n[e]=r}return r O=["Webkit","webkit","Moz","moz","ms","O","o"P_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var T=self.__AMP_LOfunction(t){return U(t,"platform")},K=function(t){return F(t,"timer")},function nt(t,i,n,o){return tt(t,i,n,o}function rt(t,i,n){n=n.sort}));var o=-1;n.forEach((function(n){var r=n.className,e=n.minWidth;e<=i&&e>o?(t.classList.add(r),o=e):t.classList.remove(r)}))}var et="dock-dismiss-on-tap",st="dock-scroll-back}var ut=function(){function t(t,i){this.$r=K(t),this.Wr=i,this.Xt=null}var i=t.prototype;return i.trigger=function(t){for(var i=this,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];this.cancel(),this.Xt=this.$r.delay}),t)},i.cance},i.isWaitin},t}(),ct="dock",ht="registered",dt="playing_manual",lt=["<div class=i-amphtml-video-docked-overlay hidden></div>"],vt=['<div class=amp-video-docked-controls hidden><div class="amp-video-docked-main-button-group amp-video-docked-control-set-playback"><div class=amp-video-docked-button-group><div role=button ref=playButton class=amp-video-docked-play></div><div role=button ref=pauseButton class=amp-video-docked-pause></div></div><div class=amp-video-docked-button-group><div role=button ref=muteButton class=amp-video-docked-mute></div><div role=button ref=unmuteButton class=amp-video-docked-unmute></div></div><div class=amp-video-docked-button-group><div role=button ref=fullscreenButton class=amp-video-docked-fullscreen></div></div></div><div class="amp-video-docked-main-button-group amp-video-docked-control-set-scroll-back" hidden><div class=amp-video-docked-button-group><div role=button ref=scrollBackButton class=amp-video-docked-scroll-back></div></div></div><div class=amp-video-docked-button-dismiss-group ref=dismissContainer><div role=button ref=dismissButton class=amp-video-docked-dismiss></div></div></div>'],ft="playback",mt="scroll-back",pt=[{className:"amp-small",minWidth:0},{className:"amp-large",minWidth:300}];function gt(t,i){E(t,!1),E(i,!0)}var kt=function(){function t(t){var i=this;this.wi=t;var n=w(t.getBody());this.container=function(t){return t(vt)}(n),this.overlay=function(t){return t(lt)}(n);var o=y(this.container),};this.t2=r("dismissButton"),this.i2=r("playButton"),this.n2=r("pauseButton"),this.o2=r("muteButton"),this.e2=r("unmuteButton"),this.s2=r("fullscreenButton"),this.a2=r("scrollBackButton"),this.u2=r("dismissContainer"),this.c2=this.container.querySelectorAll(".amp-video-docked-main-button-group"),this.h2=!1,this.d2=!1,this.l2=P((function(){return new ut(i.wi.win}))})),this.v2=[],this.f2=null,this.m2=null,this.g2=null,this.lj=null,this.b2(),this.w2()}var i=t.prototype;return i.disable=function(){this.h2=!0},i.enabl},i.setVideo=function(t,i){this.g2=i,this.lj!==t&&(this.lj=t,this.PT(t))},i.z2=function(t){var i="amp-video-docked-control-set-".concat(t);!function(t,n){for(var o=t.length,r=0;r<o;r++)E(e=t[r],e.classList.contains(i));var e}(this.c2)},i.PT=function(t){var i=this;this.hb();var n="click",o=t.element;this.v2.push(this.M2(this.t2,n,(function(){i.H2(et)})),this.M2(this.i2,n,(function(){!function(t,i){var n;(},new Promise}))).catch}))}(t)})),this.M2(this.n2,n,(function(){t.pause()})),this.M2(this.o2,n,(function(){t.mute()})),this.M2(this.e2,n,(function(){t.unmute()})),this.M2(this.s2,n,(function(){t.fullscreenEnter()})),this.M2(this.a2,n})),nt(this.container,"mouseup"})),nt(o,"playing",(function(){return i.j2()})),nt(o,"pause",(function(){return i.O2()})),nt(o,"muted",(function(){return i.V2()})),nt(o,"unmuted",(function(){return i.B2()})),nt(o,"ad_start",(function(){return i.z2(mt)})),nt(o,"ad_end"})))},i.H2=function(t){this.container.dispatchEvent(it(this.wi.win,t,void 0))},i.j2=function(){var t=this.n2,i=this.i2;this.d2=!1,gt(i,t)},i.O2=function(){var t=this.n2,i=this.i2;this.d2=!0,gt(t,i)},i.V},i.B2=function(){var t=this.o2;gt(this.e2,t)},i.M2=function(t,i,n){var o=this;return nt(t,i}))},i.h},i.hideOnTimeout=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1200;this.l2().trigger(t)},i.w2=function(){var t=this,i=this.overlay,n=function(){return t.A2()};this.M2(i,"click",n),this.M2(i,"mouseover",n)},i.A},i.L2=function(){var t=Q(this.wi),i=Y(this.lj),n=t.isRollingAd(i),o=t.isMuted(i),r="paused"!==t.getPlayingState(i),e=this.container,s=this.overlay;E(e,!0),e.classList.add("amp-video-docked-controls-shown"),s.classList.add("amp-video-docked-controls-bg"),this.z2(n?mt:ft),E(this.i2,!r),E(this.n2,r),E(this.o2,!o),E(this.e2,o),this.E2(),this.hideOnTimeout()},i.positionOnVsync=function(t,i,n,o,r){this.g2=b(i,n,o*t,r*t);var e=this.container,s=t/2,a=i+o*s,u=n+r*s;rt(e,t*o,pt),A(e,{"transform":C(a,u)});var c=o*s-4-40,h=-(r*s-4-40);A(this.u2,{"transform":C(c,h)})},i.b2=function(){var t=this;nt(this.wi.getRootNode(),"mousedown",(function(i){t.S2(i.target)||t.hide(!0)}))},i.S2=function(t){return t==this.overlay||(".amp-video-docked-controls",!!((i=t).closest?i.closest(".amp-video-docked-controls"}(i}))));var i},i.hide=function(t,i){var n="amp-video-docked-controls-shown",o=this.container,r=this.overlay;o.classList.contains(n)&&(t&&this.d2||(i&&(E(o,!1),E(r,!1)),r.classList.remove("amp-video-docked-controls-bg"),o.classList.remove(n)))},i.E2=function(){var t=this;this.f2||(this.f2=nt(this.overlay,"mousemove",(function(){t.A2()})),this.m2=nt(this.overlay,"mouseout",(function(i){Y(t.g2);var n=at(i),o=n.x,r=n.y,e=t.g2,s=e.bottom,a=e.left,u=e.right,c=e.top;(o<a||o>u||r<c||r>s)&&(t.hide(!0),t.N2())})))},i.N},i.reset=function(){var t=this.container,i=this.overlay,n=[i,t];E(i,!1),this.hide();for(var o=0;o<n.length;o++)W(n[o],["transform","transition","width","height"])},t}(),bt="left",wt="right",xt="bottom",yt=.02;function zt(t,i,n,o){return o*(t-i-2*n}function Ht(t,i,n,o){return zt(t,i,n,-o)}var jt=function(t,i,n){return 1,(o=t)<0?o=0:o>1&&(o=1),(o-0)*(n-(r=i))/1+r;var o,r};function Ot(t,i,n,o,r,e,s){var a=i.width,u=Math.min(s,e*a),c=t.width/t.height,h=Math.max(r,a*o),d=h/c;return b(n==wt?i.right-u-h:i.left+u,u,h,d)}var V},B}var Lt=["<div class=amp-video-docked-shadow hidden></div>"],Et=["<div class=amp-video-docked-placeholder-background><div class=amp-video-docked-placeholder-background-poster ref=poster></div><div class=amp-video-docked-placeholder-icon ref=icon></div></div>"],St=.85,Nt=[{className:"amp-small",minWidth:0},{className:"amp-large",minWidth:420}],Ct="i-amphtml-video-docked",Wt="slot",I};function Pt(t,i){var n=!1;return function(){for(var o=arguments.length,r=new Array(o),e=0;e<o;e++)r[e]=arguments[e];n||(n=!0,t.requestAnimationFrame})))}}var Tt=function(){function t(t){var i,n,o,r=this;this.wi=t,this.$w=P})),this.Ls=X(t,"viewport"),this.cn=(i=this.Ls,n=Bt((function(){return i.getSize().width})),o=Bt})),Object.defineProperties(b(0,0,0,0),{width:n,height:o,right:n,bottom:o})),this.C2=null,this.W2=null;var e=w(this.I2());this.P2=P((function(){return r.uJ(function(t){return t(Lt)}(e))})),this.T2=P((function(){return r._2()})),this.R2=P((function(){return r.u}(e))})),this.Y2=P})),this.U2=null,this.X2=null,this.Z2=null,this.D2=null,this._F=this.Ls.getScrollTop(),this.F2=!1,this.q2=0,this.G2=0,this.J2=0,this.xi=[],this.$F=P((function(){var t=r.wi;r.Ls.onScroll(Pt(t.win,(function(){return r.K2()}))),r.Ls.onResize((function(){return r.Q2()})}(t)})),this.t4=P})),this.mb=null,this.n4=!1,this.o4()}var o=t.prototype;return o.o4=function(){var t=this;if(this.r4()){for(var i=this.wi,n="[".concat(String(ct).replace(f,m),"]"),o=i.getRootNode().querySelectorAll(n),r=0;r<o.length;r++){var e=o[r];e.signals&&e.signals().get(ht)&&this.registerElement(e)}nt(i.getBody(),ht,(function(i){var n=i.target;(function(t){return t.hasAttribute(ct)})(n)&&t.registerElement(n)}))}},o.r4=function(){return!J(this.wi.win).isIos()||!(t=this.wi,X(t,"viewer")).isEmbedded();var t},o.i4=function(){var t=this.wi.getRootNode(),i=t.querySelector("[dock]");$(i.signals().get(ht),"`dock` attribute can only be set on video components.");var n=i.getAttribute("dock").trim();if(""==n)return null;var o=t.querySelector(n);return o&&$("amp-layout"==o.tagName.toLowerCase(),"Dock slot must be an <amp-layout> element."),o},o.Q2=function(){var t,i=this;this.cn.width!==(null===(t=this.C2)||void 0===t?void 0:t.viewportRect.width)&&this.xi.forEach((function(t){return i.e4(t)}))},o.s},o.register=function(t){var i=this;this.$F(),this.mb||(this.mb=new IntersectionObserver((function(t){for(var n=[],o=function(o){var r=t[o],e=r.boundingClientRect,s=r.target;n.indexOf(s)<0&&(s.getImpl().then})),n.push(s))},r=t.length-1;r>=0;r--)o(r)}),{threshold:[0,.1,.2,.8,.9,1]})),this.mb.observe(t.element),this.xi.push(t)},o.registerElement=function(t){var i=this;t.getImpl().then((function(t){return i.register(t)}))},o.K2=function(){var t=this.Ls.getScrollTop();if(!(Math.abs(t-this._F)<5)){var i=t>this._F?"top":xt;this.D2=i,this._F=t}},o.I2=function(){var t=this.wi.getRootNode();return t.ownerDocument||t},o.uJ=function(t){return(this.I2().body||this.I2()).appendChild(t)},o.c4=function(t){var i=this,};return nt(t,"touchstart",n),nt(t,"mousedown",n),t},o._2=function(){var t=this,i=new kt(this.wi),n=i.container,o=i.overlay;return nt(n,et,(function(){t.h4()})),nt(n,st})),this.c4(n),this.c4(o),this.uJ(n),this.uJ(o),i},o.h4=function(){this.T2().hide(!1,!0),this.l4(this.v4())},o.v},o.f4=function(t,i){if(this.F2||!this.m4(t,i)||this.g4(t)||this.b4(t))return null;var n=t.element,o=function(t){for(var i=-1/0,n=1/0,o=-1/0,r=1/0,e=0;e<arguments.length;e++){var s=arguments[e];if(s&&(i=Math.max(i,s.left),n=Math.min(n,s.left+s.width),o=Math.max(o,s.top),r=Math.min(r,s.top+s.height),n<i||r<o))return null}return n==1/0?null:b(i,o,n-i,r-o)}(i||n.getBoundingClientRect(),this.cn);return o&&Vt(o)?o.top>this.s4()?null:this.w4(t,i):null},o.x4=function(t){return(t=t.element||t).getBoundingClientRect()},o.e4=function(t){var i=this;this.kc((function(){var n=i.f4(t);n?i.y4(t,n,1):i.z4(t)&&i.l4(t)}))},o.k},o.u4=function(t,i){if(!this.n4)if("top"==this.D2){var n=this.f4(t,i);n&&this.M4(t,n,i)}else if(this.D2==xt){if(!this.C2)return;t===this.v4()&&this.Fi(t,St,i)&&this.l4(t,!1,i)}},o.b4=function(t){return!this.C2&&!this.ob(t)},o.g4=function(t){return!!this.C2&&!this.z4(t)},o.m4=function(t,i){var n,o,r=i||t.element.getBoundingClientRect(),e=r.height;return r.width/e<.98?(o=(n=t.element).tagName.toUpperCase(),_().error(o,"Minimize-to-corner (`dock`) does not support portrait video.",n),!1):this.cn.width>=320&&this.cn.height>=e*St},o.ob=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=t||this.v4();return this.$w().getPlayingState(i)==dt},o.M4=function(t,i,n){this.H4(t)||this.C2||this.j4(t,i,n)},o.j4=function(t,i,n){var o=this;return this.y4(t,i,.05,n,!0).then((function(){return new Promise((function(r){o.kc((function(){o.y4(t,i,1,n).then(r)}))}))}))},o.y4=function(t,i,n,o,r){var e=this,s=t.element;this.Uj(s);var a=this.O4(t,i,n,o),u=a.relativeX,c=a.scale,h=a.x,d=a.y;t.hideControls();var l=this.V4(n);return this.B4(t,i,n),this.A4(t,h,d,c,n,l,u,o).then((function(){r||e.T2().enable()}))},o.Br=function(t,i){var n=i&&i.slot||this.a4()||this.v4().element,o=it(this.wi.win,t,{})})(n).trigger(n,t,o,1)},o.H4=function(t){return this.U2==t&&(this.Fi(t.element,yt)&&this.L4(),!0)},o.L},o.V4=function(t){return this.C2?300*Math.abs(t-this.C2.step):0},o.E4=function(t,i,n){return!!this.X2&&this.X2.x==t&&this.X2.y==i&&this.X2.scale==n},o.A4=function(t,i,n,o,r,e,a,u){var c=this,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"fixed";if(this.E4(i,n,o))return s();this.n4=!0;var d=t.element,l=u||t.element.getBoundingClientRect(),v=l.height,f=l.width;this.X2={x:i,y:n,scale:o};var m=r>0?"ease-out":"ease-in",p=I(d),g=this.P2(),b=this.T2(),w=b.overlay,x=this.R2(),y=this.Y2().icon,z=void 0!==a,M=a==bt;z&&(rt(y,f,Nt),y.classList.toggle("amp-rtl",M),this.T2().container.classList.toggle("amp-rtl",M));var H=this.S4(f,v),j=function(t){H&&A(t,{"width":S(f),"height":S(v),"min-width":S(f),"min-height":S(v)})},},V=function(t){return A(t,{"transition-duration":"".concat(e,"ms"),"transition-timing-function":m})},B=y.classList.contains("amp-small"),L=B?32:48,N=B?20:40,C=M?Ht:Mt,W=C(f,L,N,r);return t.mutateElement((function(){p.classList.add(Ct),A(d,{"overflow":"visible"}),E(g,!0),E(w,!0),k(c.Y2().poster),k(x),c.N4(t),d.appendChild(x),c.kc((function(){t.mutateElement((function(){O(x),V(x),V(y),z&&A(y,{"transform":It(W,0,1)})}))}));var r=0,e=0,s=0,a=0;"absolute"===h&&(r=l.left,e=l.top,s=d.offsetLeft,a=d.offsetTop),c.C4(t).forEach((function(t){var u=Number(t!==p),c=u*a-e;A(t,{"position":h,"left":S(u*s-r),"top":S(c),"transform":It(i,n,o)}),V(t),j(t)})),O(g),c.T2().positionOnVsync(o,i,n,f,v)})),this.W4().promise(e).then}))},o.W},o.C4=function(t){return[I(t.element),this.P2(),this.T2().overlay]},o.N4=function(t){var i=this.Y2().poster,n=function(t){var i=t.getAttribute("poster")||t.getAttribute("data-poster");if(i)return i;var }(t,"amp-img[placeholder],img[placeholder],[placeholder] amp-img");return n?n.getAttribute("src"):void 0}(t.element);n?(E(i,!0}(i,{"background-image":"url(".concat(n,")")})):E(i,!1)},o.S4=function(t,i){var n=!this.Z2||this.Z2.width!=t||this.Z2.height!=i;return n&&(this.Z2={width:t,height:i}),n},o.z4=function(t){return!!this.C2&&this.C2.video==t},o.B4=function(t,o,r){var e,s,a=this.C2,}({},this.cn);this.C2={video:t,target:o,step:r,viewportRect:u},a&&a.video==t&&(e=o.rect,s=a.target.rect,e&&s&&e.left==s.left&&e.top==s.top&&e.width==s.width&&e.height==s.height)||(this.T2().setVideo(t,o.rect),this.Br("dock",o))},o.I4=function(t){var i=this.v4(),n=this.C2.target,o=this.O4(i,n,1),r=o.scale,e=o.x,s=o.y,a=this.P4(t),u=this.T4(a);this.J2=t-this.G2,this.G2=t,this.A4(i,e+t,s,r,1,0,u)},o.Fi=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=n||this.x4(t);if(!Vt(o))return 0;var r=Math.min(o.bottom,this.cn.bottom)-Math.max(o.top,this.cn.top),e=Math.max(0,r/o.height);return e>i-yt},o.Yp=function(t){var i=this;if(this.C2&&!this._4(Wt)&&!this.n4){this.q2=0;var n=at(t).x,o=this.C2.target.directionX,r=Pt(this.wi.win})),e=function(){return i.Y4(a)},s=this.wi.getRootNode(),a=[this.U4(),this.X4(),this.Z4(),nt(s,"touchmove",r),nt(s,"mousemove",r),ot(s,"touchend",e),ot(s,"mouseup",e)]}},o._4=function(t){return!!this.C2&&this.C2.target.type===t},o.X4=function(){var t=this.I2().documentElement,i="i-amphtml-select-disabled";return t.classList.add(i}},o.U4=function(){return this.Ls.disableScroll(),this.Ls.resetScroll.bind(this.Ls)},o.R4=function(t,i,n){if(this.C2.target.directionX===i){var o=at(t).x-n;this.q2=o,o<=10||(t.preventDefault(),t.stopPropagation(),this.T2().hide(!1,!0),this.F2=!0,this.T2().disable(),this.I4(o))}},o.Z4=function(){var t=this.wi.win;if(!J(t).isIos())retur};var i=function(t){return t.preventDefault()};return t.addEventListener("touchmove",i,{passive:!1}}},o.Y4=function(t){t.forEach})),this.F2=!1,this.T2().enable(),Math.abs(this.J2)<40?this.QW(this.q2):this.D4(this.G2,Math.sign(this.J2)),this.J2=0,this.G2=0,this.q2=0},o.D4=function(t,i){var n=this;Y(1==Math.abs(i));var o=this.v4();if(o.pause(),this.Fi(o,.2))this.F4(o,t,i);else{var r=Y(this.C2).target,e=r.rect,s=e.width,a=e.x,u=e.y,c=this.O4(o,r,1).scale,h=a+t,d=1==i?this.cn.right:this.cn.left-s,l=this.q4(d-h);this.G4(),o.showControls(),this.A4(o,d,u,c,0,l).then((function(){n.J4(o)}))}},o.F4=function(t,i,n){var o=this;Y(1==Math.abs(n));var r=Y(this.C2).target,e=r.rect,s=e.width,a=e.x,u=e.y,c=this.O4(t,r,1).scale,h=this.cn.width,d=a+i,l=1==n?Mt(h,s,0,1):Ht(h,s,0,1),v=this.q4(l-d);this.G4(),this.A4(t,l,u,c,0,v).then}))},o.q4=function(t){return Math.min(300,Math.abs(t)/2)},o.P4=function(t){var i=this.C2,n=i.step,o=i.target,r=this.v4(),e=r.element.getBoundingClientRect().width,s=this.O4(r,o,n),a=s.scale;return s.x+t+e*a/2},o.QW=function(t){var i=this.v4(),n=this.C2.step,o=this.T4(t);this.W2=o;var r=this.w4(i);this.C2.target=r;var e=this.O4(i,r,n),s=e.scale,a=e.x,u=e.y;this.A4(i,a,u,s,n,200,o)},o.T4=function(t){return this.P4(t)>=this.cn.width/2?wt:bt},o.O4=function(t,i,n,o){return function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=i.x<t.x?bt:wt,r=jt(n,t.x,i.x),e=jt(n,t.y,i.y),s=jt(n,t.width,i.width)/t.width;return{x:r,y:e,scale:s,relativeX:o}}(o||this.x4(t),i.rect,n)},o.l4=function(t,i,n){var o=this,r=this.Fi(t,St,n);r||(t.pause(),t.showControls()),i||this.G4();var e=Y(this.C2).target,s=this.O4(t,e,0),a=s.relativeX,u=s.scale,c=s.x,h=s.y,d=r?this.V4(0):0;return this.A4(t,c,h,u,0,d,a,n,"absolute").then}))},o.G4=function(){this.T2().disable(),this.T2().hide(!1,!0),this.Br("undock")},o.J4=function(t){var i=this,n=I(t.element);return t.mutateElement((function(){n.classList.remove(Ct);var t=i.P2(),o=i.Y2().icon,r=i.R2();E(t,!1),i.T2().reset(),[n,t,r,o].forEach((function(t){W(t,["transform","transition","min-width","min-height","width","height","opacity","overflow","position","left","top"])})),i.X2=null,i.Z2=null,i.C2=null}))},o.Uj=function(t){var i,n,o=t.querySelector(".i-amphtml-android-poster-bug");o&&(null===(n=(i=o).parentElement)||void 0===n||n.removeChild(i))},o.d4=function(){this.C2&&this.Ls.animateScrollIntoView(this.v4().element,"center")},o.w4=function(t,i){var n,o,r,e,s,a,u,c,h,d,l,v,f=this.a4(),m=i||t.element.getBoundingClientRect();return f?{type:Wt,rect:(n=m,o=f.getBoundingClientRect(),a=n.height,u=n.width,c=o.height,h=o.left,d=o.top,l=o.width,u/a>l/c?(e=d+c/2-a*(s=l/u)/2,r=h):(r=h+l/2-u*(s=c/a)/2,e=d),b(r,e,u*s,a*s)),slot:f}:(null===this.W2&&(this.W2="rtl"==((v=this.I2()).body.getAttribute("dir")||v.documentElement.getAttribute("dir")||"ltr")?bt:wt),{type:"corner",rect:Ot(m,this.cn,this.W2,.3,180,.04,30),directionX:this.W2})},o.a4=function(){var t=this.t4();return t&&Vt(t.getBoundingClientRect())?t:null},t}();t.registerServiceForDoc("video-docking",Tt)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-video-docking-0.1.js.map