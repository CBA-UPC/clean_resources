/*! For license information please see sdk-qa.js.LICENSE.txt */
!function(){"use strict";var e={975:645:379:,t={};.n=n.d=n.o=n.nc=void 0,function(){var e=n(379),t=n.n(e),o=n(975);t()(o.Z,{insert:"head",singleton:!1}),o.Z.locals,window.openTestTool=function(){new Promise((function(e,t){document.getElementsByTagName("body");var n=document.createElement("script");n.src="https://kit.fontawesome.com/608cdf593e.js";var o=document.createElement("script");o.src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.noStyle.js";var r=document.createElement("link");r.rel="stylesheet",r.href="https://unpkg.com/ag-grid-community/dist/styles/ag-grid.css";var i=document.createElement("link");i.rel="stylesheet",i.href="https://unpkg.com/ag-grid-community/dist/styles/ag-theme-balham.css";var a=document.createElement("link");a.rel="stylesheet",a.href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css";var c=document.createElement("link");c.rel="stylesheet",c.href="https://fonts.googleapis.com/icon?family=Material+Icons";var s=document.createElement("link");s.rel="stylesheet",s.href="https://fonts.googleapis.com/css?family=Roboto&display=swap";var l=document.createElement("div");l.id="optimoveSdkWebTool",l.className="ag-theme-balham";var p=document.createElement("div");p.id="optimovePanelHead",p.classList.add("panel-heading");var u=document.createElement("div");u.classList.add("optimoveTopHeadLine");var d=document.createElement("img");d.classList.add("optimoveIcon"),d.ID="optimoveIcon",d.src="data:image/png;base64,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";var m=document.createElement("div"),f=document.createElement("div"),h=document.createElement("p");h.innerHTML='The Web SDK testing tool has been replaced by Optimove\'s Events Log. Click <a href="https://academy.optimove.com/en/article/monitoring-events-in-optimove"  target="_blank" title="https://academy.optimove.com/en/article/monitoring-events-in-optimove/"> here</a> to learn more about the Events Log in Optimove\'s academy. If you are unable to access the academy article, please contact your customer success manager.',f.appendChild(h);var v=document.createElement("i");v.classList.add("material-icons"),v.innerText="clear";var g=document.createElement("div");g.appendChild(v),g.classList.add("optimoveWebToolBtnClose"),g.width="10px",g.height="10px",g.onclick=function(){we()};var b=document.createElement("div");b.classList.add("optimoveTopHeadLineText"),b.classList.add("font-weight-bold"),b.id="OptimoveSDKEvents",b.textContent="| Web SDK testing tool",u.appendChild(d),u.appendChild(b),u.appendChild(m),u.appendChild(g);var y=document.createElement("div"),w=document.createElement("div");w.id="optimoveBottomHeadLineText",w.classList.add("optimoveBottomHeadLineText"),w.textContent="",y.appendChild(w),p.appendChild(u),p.appendChild(y),p.appendChild(f),l.appendChild(p),document.body.appendChild(n),document.body.appendChild(o),document.body.appendChild(r),document.body.appendChild(i),document.body.appendChild(c),document.body.appendChild(s),document.body.appendChild(l),l.classList.add("open"),document.body.classList.add("optimoveSdkWebToolOpen"),o.onload=function(){e()}})).then((function(){window.sessionStorage.setItem("isSideBarShouldBeOpen",!0);var e=window.sessionStorage.getItem("OptimovePanelWidth");e>0&&(document.getElementById("optimoveSdkWebTool").style.width=e+"px",document.body.style.width=parseInt(window.width-e)+"px")}))};var r,i,a,c,s,l,p,u,d,m,f,h,v,g,b,y,w,x,k,S,E,I,D,T,C,P,M,L,O,A,R,W,F,U,_,j,K,B,H,N,z,V,q,J,G,X,Y,Q,Z,$,ee,te,ne,oe,re,ie,ae,ce,se,le,pe,ue,de,me,fe,he,ve,ge,be,ye,we=function(){var e=document.getElementById("optimoveSdkWebTool");null!=e&&(e.remove(),window.sessionStorage.setItem("isSideBarShouldBeOpen",!1)),document.body.classList.remove("optimoveSdkWebToolOpen"),document.body.style.width="auto"},xe=window.openTestTool;ow.optimoveSDK=(C="2.0.21",P="990a6d8eb6cbb8ea44b73d21f1e473b43b9c74ea",M="0b006d8eb623b8ea11b73d61f1e483b47b9d7422",L="4ba302311571f45d57f1aa75e428b9b78d59a7a2",O="85bdeae0a9e0dad7fdd022d8f90da5d3a241b3d0",A="d0df7f0a4c2724ff587c1cfb3e315b432e2d1f50",R="647a3d19ac2647f361068a43df3a4da1",W="19a826c7f361268a43da3a46a12047f3",F="215d26f4be2047f348066e44ee7fe3d6",U="511a26f4be2047a348064e4abe8ce2a9","set_page_visit",_="set_user_id_event",j="set_email_event",K="web_popup_displayed",B="prod",H="",N="",i={info:1,warning:2,error:3,none:4},a="none",z={setLevel:log:function(e,t){if("prod"!=B&&i[e]>=i[a])switch(i[e]){case 1:console.info(t);break;case 2:console.warn(t);break;case 3:console.error(t);break;default:console.log(t)}}},V=q={cleanUrl:function(e){return["http://www.","http://","https://www.","https://","www."].forEach((function(t){e=e.startsWith(t)?e.replace(t,""):e})),e},validatePageURL:function(e){return/(https?|http?|ftp):\/\/[^\s\/$.?#].[^\s]*$/.test(e)},validateUserIdLength:validateUserId:function(e){return!e||" "!=e&&"null"!=e.toLowerCase()&&"none"!=e.toLowerCase()&&!e.toLowerCase().includes("undefine")},validateEmail:getUrlParams:function(e){var t=e?e.split("?")[1]:window.location.search.slice(1),n={};if(t)for(var o=(t=t.split("#")[0]).split("&"),r=0;r<o.length;r++){var i=o[r].split("="),a=i[0],c=void 0===i[1]||i[1];if(a=a.toLowerCase(),"string"==typeof c&&(c=c.toLowerCase()),a.match(/\[(\d+)?\]$/)){var s=a.replace(/\[(\d+)?\]/,"");if(n[s]||(n[s]=[]),a.match(/\[\d+\]$/)){var l=/\[(\d+)\]/.exec(a)[1];n[s][l]=c}else n[s].push(c)}else n[a]=c}return Object.keys(n).forEach((),n},convertUTMArray:function(e){return(e=(e=e.toString()).replace(/,/g,"_")).toLowerCase()},getUserLanguage:function(){var e=navigator.language.toLowerCase();return"chrome://global/locale/intl.properties"==e&&(e=null),e},generateUUID:,J=function(e){var t,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;o&&z.setLevel(o),B=Z(P)||B,Q(P,B),N=window.location.hostname,t="prod"==B?"web-configuration.1.0.0":"web-configuration.1.0.0-stg",(r=self.optimoveTenantConfiguration)?G((function(){te(),r.enableWebPush&&(z.log("info","call initializeOptimobile"),he.initializeOptimobile()),r.enableOptitrack&&(z.log("info","call initializeOptiTrack"),fe.initializeOptiTrack((function(){fe.logMetadataCoreEvent().then((function(e){n&&"function"==typeof n&&n()}))}))),r.enableRealtime&&(z.log("info","call initializeRealtime"),me.initializeRealtime())})):X(H="//sdk-cdn.optimove.net/webconfig/"+e+"/"+t+".js",(function(){z.log("info","configuration loaded successfully"),z.log("info","core events loaded successfully"),G((function(){te(),r.enableWebPush&&(z.log("info","call initializeOptimobile"),he.initializeOptimobile()),r.enableOptitrack&&(z.log("info","call initializeOptiTrack"),fe.initializeOptiTrack((function(){fe.logMetadataCoreEvent().then(()}))),r.enableRealtime&&(z.log("info","call initializeRealtime"),me.initializeRealtime()),ce()&&optimoveSDK.API.openWebTestTool()}))}))},G=function(e){r=self.optimoveTenantConfiguration,pe(r),e&&"function"==typeof e&&e()},X=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.async=!1,n.defer=!1,n.src=e,document.getElementsByTagName("script")[1].appendChild(n),n.readyState?n.onreadystatechange=n.onload=,c=[],s=function(){var e=Ee(ke().mark((function e(t,n){var o;return ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],n.forEach((),e.next=4,fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Request-ID":q.generateUUID()},body:JSON.stringify(n)}).then(().then((function(e){return z.log("info","event".concat(o.length>1?"s":""," ").concat(o.join(", ")," reported to ").concat(t," successfully")),{payload:n,response:e}})).catch((function(e){return z.log("error","event".concat(o.length>1?"s":""," ").concat(o.join(", ")," not reported to ").concat(t," due to ").concat(e)),{payload:n,response:e}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=Ee(ke().mark((function e(){var t,n,o,i;return ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],n=[],c.length){e.next=4;break}return e.abrupt("return");case 4:if(c.forEach((function(e){t.push(e),e.event!=K&&n.push(e)})),r.enableWebPush&&he.reportEventsToOptimobile(c),c=[],!(r.enableOptitrack&&t.length>0)){e.next=13;break}return e.next=10,s(fe.getOptitrackEndpoint(),t);case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,Promise.resolve();case 15:e.t0=e.sent;case 16:if(o=e.t0,!(r.enableRealtime&&n.length>0)){e.next=23;break}return e.next=20,s(me.getRealtimeEndpoint(),n).then((function(e){me.postRealtimeEvent(e)}));case 20:e.t1=e.sent,e.next=26;break;case 23:return e.next=25,Promise.resolve();case 25:e.t1=e.sent;case 26:return i=e.t1,e.abrupt("return",Promise.all([o,i]).then(());case 28:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=Y={logEvent:function(e,t,n){try{var o,i;t="object"===Ie(t=t||{})&&Object.keys(t).length>0?se(t):{},Object.assign(t,de()),n&&e!=_?(o=n.updatedVisitorId,i=n.userId):e==_?(o=t.updatedVisitorId,i=t.userId):(o=$(),i=oe());var a={tenant:r.optitrackMetaData.siteId,category:p(e),origin:"sdk",event:e,context:t,timestamp:(new Date).toISOString(),metadata:{firstVisitorDate:ae(),eventId:q.generateUUID(),sdk_platform:"web",sdk_version:C},visitor:o,customer:i};c.push(a)}catch(t){z.log("error","could not log event: ".concat(e," error log: ").concat(t))}},dispatch:l},Q=function(e,t){try{var n=localStorage.getItem(e);null!=n&&n==t||localStorage.setItem(e,t)}catch(e){z.log("error","OptimoveSDK: persistSDKLocalData() Failed error = ".concat(e))}},Z=function(e){try{var t=localStorage.getItem(e);if(null!=t)return t}catch(e){return z.log("error","OptimoveSDK: getPersistedSDKLocalDatas () Failed error = ".concat(e)),null}},$=function(){return Z(R)||null},ee=function(e){Q(R,e)},te=function(){var e=Z(R),t=Z(W);if(e||(e=q.generateUUID(),Q(R,e)),!t){var n="_pk_id.".concat(r.optitrackMetaData.siteId,"."),o=document.cookie.match(new RegExp("(^| )"+n+".{1,}=([^;]+)")),i=Array.isArray(o)&&null!=o[2]?o[2].split(".")[0]:null;Q(W,i||e),Q(U,(new Date).toISOString())}return e},ne=function(){return Z(W)||null},oe=re=ie=ae=ce=function(){try{return"true"==window.sessionStorage.getItem("isSideBarShouldBeOpen")}catch(e){z.log("error","Web sdk test tool : session storage access has failed :  ".concat(e))}},se=function(e){if(null!=e){var t=Object.getOwnPropertyNames(e),n=1;return t.forEach((function(t){if(n>r.optitrackMetaData.maxActionCustomDimensions)delete e[t];else{var o=e[t];if("string"==typeof o){var i=o.trim();e[t]=i}}"customURL"==t&&(e[t]=q.cleanUrl(e[t]).toLowerCase()),n++})),e}z.log("info","normalizeEventParameters: event parameter is null")},le=function(e){var t="desktop",n="windows",o="";if(void 0!==e){var r=e.os.name;n=r,o=r+" "+e.os.version,Object.keys(e.device).length>0&&void 0!==e.device.type&&(t=e.device.type,z.log("info","found deviceType="+t)),Q(M,n),Q(L,t),Q(O,o),Q(A,"false")}},pe=function(e){void 0===Z(M)&&function(e,t){window.navigator.userAgent;var n=new XMLHttpRequest,o=e.sdkServicesEndPoint;n.open("GET",o,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n.onreadystatechange=function(){try{if(4==n.readyState&&200==n.status){var e=JSON.parse(n.responseText);z.log("info",e),t&&t(e)}}catch(e){z.log("error",e)}},n.send()}(e,le)},ue=function(){var e=fe.getOptitrackVisitorInfo(),t=new Object;return null!=e?(t.visitorId=e[1],t.visitCount=e[3]):(z.log("error","in getVisitorsInfoObj Optitrack"),t=void 0),t},de=function(){return{event_platform:Z(M),event_device_type:Z(L),event_os:Z(O),event_native_mobile:Z(A)}},d=!1,m=function e(t){t&&(!0!==t&&t.target!=document.getElementById("optiRealPopupDimmer")&&"optiRealclosePopupImage"!=t.target.id||(document.body.removeChild(u),document.removeEventListener("mousedown",e)))},f=function(e){try{var t=document.createElement("div"),n="";n="<div id='optiRealPopupDimmer' style='position: fixed;bottom: 0;right: 0;top: 0;left: 0;overflow: hidden;display: none; z-index:999999999;background: #000000;opacity : "+(r.realtimeMetaData.options.showDimmer?.5:0)+";display:block;width: auto;height: auto;'></div>",document.addEventListener("mousedown",m),n+="<div style='max-height:90%;max-width:90%;top: 50%;left: 50%;transform:translate(-50%, -50%);position: fixed;z-index:9999999999;'><div style=' clear:both;min-width: 100px;min-height: 100px;background-color:white; text-align:center;box-shadow:0 0 5px 0 rgba(0, 0, 0, 0.2);'><div style='position:absolute;right:-13px;top:-13px;cursor:pointer;z-index:99999999999; color:white' onclick='optimoveSDK.API.closeRealtimePopup();'><img id='optiRealclosePopupImage' src='https://d3qycynbsy5rsn.cloudfront.net/banner_pop_x.png' /></div><div>"+e+"</div></div>"+(r.realtimeMetaData.options.showDimmer&&r.realtimeMetaData.options.showWatermark?"<div style='position: absolute;z-index:9999999999; clear:both;font-family : Arial;font-size : 9px;color : #CCCCCC;padding-top:6px;margin-left: 5px;'>Powered by Optimove</div>":"")+"</div>",t.innerHTML=n,u=t,document.body.appendChild(t);var o=t.getElementsByTagName("script");o.length>0&&window.eval(o[0].innerText)}catch(e){z.log("error","Error while executing popup ".concat(e))}},h=function(e,t,n,o){if(!t||void 0===t||0==t)return!1;if(null==o||null==n)return!0;var r,i=localStorage.getItem("optimove_popup_"+t+"_"+e),a={};return i&&(i=JSON.parse(i),new Date(i.recurrenceFrameStopTime)>new Date((new Date).toISOString())?r=Math.min(o,i.recurrenceLeft):(r=o,a.recurrenceFrameStopTime=n),o=r),a.recurrenceFrameStopTime=n,a.recurrenceLeft=o-1,localStorage.setItem("optimove_popup_"+t+"_"+e,JSON.stringify(a)),!(o<=0)},v=function(){var e=Ee(ke().mark((function e(t){var n,o,i,a,c;return ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{(n=t.response).IsSuccess&&n.Data&&n.Metadata&&(n.Metadata.delayValue||(n.Metadata.delayValue=0),o=n.Metadata.campaignDetailId?parseInt(n.Metadata.campaignDetailId):1,i=n.Metadata.templateId?parseInt(n.Metadata.templateId):0,a=n.Metadata.actionChannelId?parseInt(n.Metadata.actionChannelId):0,c=n.Metadata.sendId?n.Metadata.sendId:null,d||(d=!0,setTimeout((function(){if(h(t.visitorId,o,n.Metadata.recurrenceFrameStopTime,n.Metadata.recurrenceLeft)){r.realtimeMetaData.options.popupCallback?r.realtimeMetaData.options.popupCallback(n):f(n.Data);var e=Y;e.logEvent(K,{campaign_detail_id:o,template_id:i,action_channel_id:a,send_id:c}),e.dispatch().then(()}}),1e3*n.Metadata.delayValue)))}catch(e){z.log("error",e)}case 1:case"end":return e.stop()}}),e)})));return (),me={initializeRealtime:function(e){g(),e&&"function"==typeof e&&e()},postRealtimeEvent:v,executePopup:f,closePopup:m,getRealtimeEndpoint:g=,b="set_user_id_event",y="a5c127e180652c82e615be143677e248",w=null,x=function(){var e=Ee(ke().mark((function e(t,n){return ke().wrap((,e)})));return (),k=function(){var e=Ee(ke().mark((function e(){var t,n,o,r;return ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z.log("info","OptiTrackModule: in logMetadataCoreEvent"),!(t=D(y))||"true"!==t.value){e.next=4;break}return e.abrupt("return");case 4:return n=q.getUrlParams(),o={sdk_platform:"Web",sdk_version:C,app_ns:N,campaign_name:n.utm_campaign?n.utm_campaign:null,campaign_keyword:n.utm_term?n.utm_term:null,campaign_source:n.utm_source?n.utm_source:null,campaign_medium:n.utm_medium?n.utm_medium:null,campaign_content:n.utm_content?n.utm_content:null,campaign_id:n.utm_id?n.utm_id:null,language:q.getUserLanguage()},""!==H&&(o.config_file_url=H),(r=Y).logEvent("optimove_sdk_metadata",o),e.abrupt("return",r.dispatch().then(().catch((function(e){z.log("warning","OptiTrackModule:logMetadataCoreEvent Failed!!, error = ".concat(e))})));case 10:case"end":return e.stop()}}),e)})));return (),S=function(e){var t=r.events[e];return null==t?null:t},E=function(e,t){var n=e.parameters[t];return null==n?null:n},fe={initializeOptiTrack:function(e){w=T(),e&&"function"==typeof e&&e()},logSetUserId:function(e,t,n){try{var o=S(b);if(null==e||null==t)return void z.log("error","OptiTrackModule:logSetUserIdEvent Failed!!, error = origVisitorIdValue == undefined || updatedUserIdValue == undefined ");if(null!=o){E(o,"originalVisitorId"),E(o,"updatedVisitorId"),E(o,"userId");var r={originalVisitorId:e,userId:oe(),updatedVisitorId:$()};reportEvent(b,r).then(()}}catch(e){z.log("error","OptiTrackModule:logSetUserIdEvent Failed!!, error =  "+e)}},logUserEmail:function(e){reportEvent("set_email_event",{email:e}).catch(()},logMetadataCoreEvent:k,getOptitrackVisitorInfo:getUserId:oe,getKeyId:function(e,t){try{var n=null;switch(t){case"datonics":n="75f8c5fdab43daca991a35c854a5a6d2";break;case"liveRamp":n="4007d0a432ab6289711974163b25a06d";break;default:n=null}return n}catch(e){var o="OptiTrackModule:getKeyId  Failed!!, error = "+e;_logger.log("error",o)}},getOptitrackEndpoint:T=reportOptitrackEvent:x,getPersistedSDKSessionData:D=function(e){try{if(1!=r.optitrackMetaData.useSessionStorage)return z.log("info","Optitrack: persistSDKSessionData() key: ".concat(e," Not Persisted")),null;var t=sessionStorage.getItem(e);if(null!=t)return{key:e,value:t}}catch(e){return z.log("error","OptiTrackModule: getPersistedSDKSessionData () Failed error = ".concat(e)),null}},persistSDKSessionData:I=function(e,t){try{if(1==r.optitrackMetaData.useSessionStorage){var n=sessionStorage.getItem(e);null!=n&&n==t||sessionStorage.setItem(e,t)}else z.log("info","Optitrack: persistSDKSessionData() Not Persisted")}catch(e){z.log("error","OptiTrackModule: persistSDKSessionData () Failed error = ".concat(e))}}},he={initializeOptimobile:function(){var e,t;(e=window)[t="Kumulos"]=e[t]||var n=r.kumulosWebSdkMetaData,o=ne();if(null!==o){var i={apiKey:n.apiKey,secretKey:n.secretKey,vapidPublicKey:n.vapidPublicKey,region:n.region,originalVisitorId:o,sdkVersion:C,tenantId:r.optitrackMetaData.siteId},a=oe();a&&(i.customerId=a);var c,s=document.querySelector("script[data-optimove-service-worker-path]");if(s){var l=s.dataset.optimoveServiceWorkerPath;if("js"!==l.split(".").pop())throw"Optimove: incorrect service worker path";i.serviceWorkerPath=l}Kumulos("init",i),c="loading"!==document.readyState?c():document.addEventListener("DOMContentLoaded",c)}else console.error("Optimobile cannot initialize: no originalVisitorId present")},reportEventsToOptimobile:function(e){e.forEach((function(e){z.log("info","reporting to kumulos event "+e.event),Kumulos("trackEvent",e.event,e.context)}))},pushRegister:function(){Kumulos("pushRegister")},getPushSubscriptionStatus:function(e){Kumulos("getPushSubscriptionStatus",e)},pushUnregister:setPushReceivedListener:function(e){Kumulos("setPushReceivedListener",e)},setPushOpenedListener:function(e){Kumulos("setPushOpenedListener",e)},setPushSubscriptionStateListener:,ve={updateLiveRampDataMatching:function(){var e,t=fe.getKeyId(fe,"liveRamp"),n=fe.getPersistedSDKSessionData(fe,t);if(e=ue().visitorId,(null==n||n.value!=e)&&void 0!==r.LiveRampMetaData&&void 0!==r.LiveRampMetaData.tenantToken&&void 0!==r.LiveRampMetaData.baseEndpoint){var o=r.LiveRampMetaData.tenantToken,i=r.LiveRampMetaData.liveRampTenantToken,a=r.LiveRampMetaData.baseEndpoint,c=r.optitrackMetaData.siteId,s=new RegExp("(\\[liveRampToken\\])","g");!function(e){if(o!=e){var t=document,n=t.createElement("img"),r=t.getElementsByTagName("script")[0];n.type="text/javascript",n.async=!0,n.defer=!0,n.src=e,r.parentNode.insertBefore(n,r)}}(a.replace(s,i)+o+"_"+c+"_"+e),fe.persistSDKSessionData(fe,t,e)}}},ge={updateDatonicsDataMatching:function(){var e,t=fe.getKeyId(fe,"datonics"),n=fe.getPersistedSDKSessionData(fe,t);e=ue().visitorId,(null==n||n.value!=e)&&(function(e,t){if(null!=e){var n=r.DatonicsCookieMatchingMetaData.baseEndpoint,o=document,i=o.createElement("img"),a=o.getElementsByTagName("script")[0];i.type="text/javascript",i.async=!0,i.defer=!0;var c=Math.round(1e16*Math.random());i.src=n+"csync="+t+"_"+e+";rnd=("+c+")",a.parentNode.insertBefore(i,a)}}(e,r.optitrackMetaData.siteId),fe.persistSDKSessionData(fe,t,e))}},be=function(e){var t=e,n=ie();return n.userId&&n.userId===t?(z.log("info","setUserId: User ID is already set"),!1):{userId:t,originalVisitorId:n.originalVisitorId?ne():te(),updatedVisitorId:V(e||"").substring(0,16)}},ye={getVersion:function(){return C},getConfigurationVersion:getVisitorId:function(){return $()},getInitialVisitorID:function(){return ne()},getUserId:signOutUser:function(){var e=ie();e.originalVisitorId?e.userId?(function(e){try{localStorage.removeItem(e)}catch(e){z.log("error","OptimoveSDK: deletePersistedSDKLocalData() Failed - ".concat(e))}}(F),ee(e.originalVisitorId),Kumulos("signOutUser")):z.log("warning","OptimoveSDK: userId is null"):z.log("error","OptimoveSDK: originalVisitorId is null")},setRealTimeOptions:function(e){null!=e.showDimmer&&(r.realtimeMetaData.options.showDimmer=e.showDimmer),null!=e.showWatermark&&(r.realtimeMetaData.options.showWatermark=e.showWatermark),null!=e.reportEventCallback&&(r.realtimeMetaData.options.popupCallback=e.reportEventCallback)},setUserId:function(e,t){var n=e||null;if(n||t){var o=be(n);if(o){var i=Y;i.logEvent(_,o),i.dispatch().then((function(e){q.validateUserId(n)&&q.validateUserIdLength(n)&&(ee(o.updatedVisitorId),re(n),r.enableWebPush&&(z.log("info","kumulos associating user identifier: "+o.userId),Kumulos("associateUser",o.userId))),"function"==typeof t&&t()})).catch((function(e){z.log("error","setUserId error = ".concat(e))}))}else"function"==typeof t&&t()}else console.error("UserId is not defined ".concat(n,", no user ID had been set"))},setUserEmail:function(e,t,n){var o,i=n||null,a=Y;if(e){if(e.trim()){var c={email:e};i&&(o=be(i))&&a.logEvent(_,o),a.logEvent(j,c,o),a.dispatch().then((function(e){o&&q.validateUserId(i)&&q.validateUserIdLength(i)&&(ee(o.updatedVisitorId),re(i),r.enableWebPush&&(z.log("info","kumulos associating user identifier: "+o.userId),Kumulos("associateUser",o.userId))),t&&"function"==typeof t&&t()})).catch(()}}else z.log("error","setUserEmail: email is missing")},registerUser:function(e,t,n,o,i){var a=e||null;if(a){var c=be(a);if(c){var s=Y;s.logEvent(_,c),t&&s.logEvent(j,{email:t},c),n&&s.logEvent(n,o,c),s.dispatch().then((function(){c&&q.validateUserId(a)&&q.validateUserIdLength(a)&&(ee(c.updatedVisitorId),re(a),r.enableWebPush&&(z.log("info","kumulos associating user identifier: "+c.userId),Kumulos("associateUser",c.userId))),i&&"function"==typeof i&&i()}))}else i&&"function"==typeof i&&i()}else console.error("UserId is not defined ".concat(a,", no user ID had been set"))},reportEvent:function(e,t,n,o){var i,a=o||null,c=Y;a&&(i=be(a))&&c.logEvent(_,i),c.logEvent(e,t,i),c.dispatch().then((function(e){i&&q.validateUserId(a)&&q.validateUserIdLength(a)&&(ee(i.updatedVisitorId),re(a),r.enableWebPush&&(z.log("info","kumulos associating user identifier: "+i.userId),Kumulos("associateUser",i.userId))),n&&"function"==typeof n&&n()}))},setPageVisit:function(e,t,n,o){var i,a=t?t.trim():null,c=null!=n?n.trim():null,s=encodeURI(e),l={customURL:s=s.trim().toLowerCase(),pageTitle:a,category:c},p=o||null,u=Y;p&&(i=be(p))&&u.logEvent(_,i),u.logEvent("set_page_visit",l,i),u.dispatch().then((function(e){i&&q.validateUserId(p)&&q.validateUserIdLength(p)&&(ee(i.updatedVisitorId),re(p),r.enableWebPush&&(z.log("info","kumulos associating user identifier: "+i.userId),Kumulos("associateUser",i.userId)))})),void 0!==r.supportDatonicsCookieMatching&&1==r.supportDatonicsCookieMatching&&(z.log("info","call setPageVisit support DatonicsCookieMatching"),ge.updateDatonicsDataMatching()),void 0!==r.supportLiveRamp&&1==r.supportLiveRamp&&ve.updateLiveRampDataMatching()},getPushSubscriptionStatus:pushRegister:function(){he.pushRegister()},pushUnregister:setPushReceivedListener:function(e){he.setPushReceivedListener(e)},setPushOpenedListener:function(e){he.setPushOpenedListener(e)},setPushSubscriptionStateListener:showRealtimePopup:me.executePopup,closeRealtimePopup:me.closePopup,openWebTestTool:closeWebTestTool:function(){var e=document.getElementById("optimoveSdkWebTool");if(null!=e){e.remove();try{window.sessionStorage.setItem("isSideBarShouldBeOpen",!1)}catch(e){z.log("error","Web sdk test tool : session storage access has failed :  ".concat(e))}}document.body.classList.remove("optimoveSdkWebToolOpen"),document.body.style.width="auto"},tools:,self.optimoveTenantConfiguration&&J(null,null,null,"info"),{initialize:J,API:ye})}()}();