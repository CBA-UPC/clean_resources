"use strict";(self.webpackChunkpolaris=self.webpackChunkpolaris||[]).push([[849],{94849:(t,e,r)=>{r.d(e,{BL:()=>v,TX:);var i={exports:{}};i.exports=function(t){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];ello")),"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||),p.prototype.append=p.prototype.appendBinary=p.prototype.end=p.prototype.reset=p.prototype.getState=p.prototype.setState=p.prototype.destroy=p.prototype._finish=p.hash=p.hashBinary=p.ArrayBuffer=p.ArrayBuffer.prototype.append=p.ArrayBuffer.prototype.end=p.ArrayBuffer.prototype.reset=p.ArrayBuffer.prototype.getState=p.ArrayBuffer.prototype.setState=p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.hash=p}();var s=i.exports;const n=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;class a{onstructor(t){this.file=t,this.chunkSize=2097152,this.chunkCount=Math.ceil(this.file.size/this.chunkSize),this.chunkIndex=0}create(t){this.callback=t,this.md5Buffer=new s.ArrayBuffer,this.fileReader=new FileReader,this.fileReader.addEventListener("load",(t=>this.fileReaderDidLoad(t))),this.fileReader.addEventListener("error",(t=>this.fileReaderDidError(t))),this.readNextChunk()}fileReaderDidLoadileReaderDidError(t){this.callback(`Error reading ${this.file.name}`)}readNextChunkunction o(t,e,r={}){const{disabled:i}=t,{bubbles:s,cancelable:n,detail:a}=r,h=document.createEvent("Event");h.initEvent(e,s||!0,n||!0),h.detail=a||{};try{t.disabled=!1,t.dispatchEvent(h)}finally{t.disabled=i}return h}lass c{constructor(t,e,r,i={}){this.file=t,this.attributes={filename:t.name,content_type:t.type||"application/octet-stream",byte_size:t.size,checksum:e},this.xhr=new XMLHttpRequest,this.xhr.open("POST",r,!0),this.xhr.responseType="json",this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("Accept","application/json"),this.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(i).forEach(();const s=function(t){const e=h(document.head,`meta[name="${t}"]`);if(e)return e.getAttribute("content")}("csrf-token");void 0!=s&&this.xhr.setRequestHeader("X-CSRF-Token",s),this.xhr.addEventListener("load",(t=>this.requestDidLoad(t))),this.xhr.addEventListener("error",(t=>this.requestDidError(t)))}et response(){const{responseType:t,response:e}=this.xhr;return"json"==t?e:JSON.parse(e)}createequestDidLoad(t){if(this.status>=200&&this.status<300){const{response:t}=this,{direct_upload:e}=t;delete t.direct_upload,this.attributes=t,this.directUploadData=e,this.callback(null,this.toJSON())}else this.requestDidError(t)}requestDidError(t){this.callback(`Error creating Blob for "${this.file.name}". Status: ${this.status}`)}toJSONclass f{constructor(t){this.blob=t,this.file=t.file;const{url:e,headers:r}=t.directUploadData;this.xhr=new XMLHttpRequest,this.xhr.open("PUT",e,!0),this.xhr.responseType="text";for(const i in r)this.xhr.setRequestHeader(i,r[i]);this.xhr.addEventListener("load",(t=>this.requestDidLoad(t))),this.xhr.addEventListener("error",(t=>this.requestDidError(t)))}createequestDidLoad(t){const{status:e,response:r}=this.xhr;e>=200&&e<300?this.callback(null,r):this.requestDidError(t)}requestDidError(t){this.callback(`Error storing "${this.file.name}". Status: ${this.xhr.status}`)}}let l=0;class d{constructor(t,e,r,i={}){this.id=++l,this.file=t,this.url=e,this.delegate=r,this.customHeaders=i}create(t){a.create(this.file,((e,r)=>{if(e)return void t(e);const i=new c(this.file,r,this.url,this.customHeaders);p(this.delegate,"directUploadWillCreateBlobWithXHR",i.xhr),i.create((e=>{if(e)t(e);else{const e=new f(i);p(this.delegate,"directUploadWillStoreFileWithXHR",e.xhr),e.create((e=>{e?t(e):t(null,i.toJSON())}))}}))}))}}function p(t,e,...r){if(t&&"function"==typeof t[e])return t[e](...r)}class y{constructor(t,e){this.input=t,this.file=e,this.directUpload=new d(this.file,this.url,this),this.dispatch("initialize")}start(t){const e=document.createElement("input");e.type="hidden",e.name=this.input.name,this.input.insertAdjacentElement("beforebegin",e),this.dispatch("start"),this.directUpload.create(((r,i)=>{r?(e.parentNode.removeChild(e),this.dispatchError(r)):e.value=i.signed_id,this.dispatch("end"),t(r)}))}uploadRequestDidProgressspatch(t,e={}){return e.file=this.file,e.id=this.directUpload.id,o(this.input,`direct-upload:${t}`,{detail:e})}dispatchErrorrectUploadWillStoreFileWithXHR(t){this.dispatch("before-storage-request",{xhr:t}),t.upload.addEventListener("progress",()}}class b{constructor(t){var e,r;this.form=t,this.inputs=(e=t,r="input[type=file][data-direct-upload-url]:not([disabled])","string"==typeof e&&(r=e,e=document),u(e.querySelectorAll(r))).filter(()}start(t){const e=this.createDirectUploadControllers(),r=()=>{const i=e.shift();i?i.start((e=>{e?(t(e),this.dispatch("end")):r()})):(t(),this.dispatch("end"))};this.dispatch("start"),r()}createDirectUploadControllers(){const t=[];return this.inputs.forEach((e=>{u(e.files).forEach(()})),t}dispatch(t,e={}){return o(this.form,`direct-uploads:${t}`,{detail:e})}}const g="data-direct-uploads-processing",m=new WeakMap;let A=!1;function v(){A||(A=!0,document.addEventListener("click",_,!0),document.addEventListener("submit",x,!0),document.addEventListener("ajax:before",k))}function _(t){const{target:e}=t;"INPUT"!=e.tagName&&"BUTTON"!=e.tagName||"submit"!=e.type||!e.form||m.set(e.form,e)}nction E(t){const e=t.target;if(e.hasAttribute(g))return void t.preventDefault();const r=new b(e),{inputs:i}=r;i.length&&(t.preventDefault(),e.setAttribute(g,""),i.forEach(S),r.start((t=>{e.removeAttribute(g),t?i.forEach(w):function(t){let e=m.get(t)||h(t,"input[type=submit], button[type=submit]");if(e){const{disabled:t}=e;e.disabled=!1,e.focus(),e.click(),e.disabled=t}else e=document.createElement("input"),e.type="submit",e.style.display="none",t.appendChild(e),e.click(),t.removeChild(e);m.delete(t)}(e)})))}function S(t){t.disabled=!0}etTimeout((,1)}}]);
//# sourceMappingURL=849-28661faeecf7283ebd9e.js.map