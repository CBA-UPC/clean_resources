!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[8448],{44238:(e,t,s)=>{s.d(t,{Z:()=>g});var a=s(50209),r=s.n(a),n=s(5754),o=s.n(n),i=s(95004),l=s(60612),h=s(61792),d=s(78093),c=s(2629);class u extends i.Component{constructor(){super(...arguments),r()(this,"transitionNodeRef",(0,i.createRef)()),r()(this,"prevCount",0),r()(this,"renderContentFromTransitionStatus",e=>{var t=this.props,s=t.count,a=t.showNumber,r=t.isCircle,n=t.className,i=t.style,d=this.prevCount>s&&0===s,u=[l.d0,l.cn,l.Ix].includes(e),g=d&&u?this.prevCount:s;return(0,c.jsx)("div",{ref:this.transitionNodeRef,className:o()("jpu7k",n,{D0OOd:[l.d0,l.cn].includes(e),e2EeC:r,XnKJk:!r}),style:i,role:"status",children:a&&(0,h.Z)(g,99)})})}componentDidUpdate(e){this.prevCount=(null==e?void 0:e.count)||0}render(){var e=this.props.count;return(0,c.jsx)(l.ZP,{nodeRef:this.transitionNodeRef,in:e>0,timeout:d.notificationBadgeTransitionDurationMs,children:this.renderContentFromTransitionStatus})}}r()(u,"defaultProps",{count:0,showNumber:!0});let g=u},68144:(e,t,s)=>{s.d(t,{Cq:()=>h,UX:()=>l,jV:()=>o,nT:()=>i,sn:()=>n});var a=s(36343),r=e=>(0,a.q)("caret-thin",{altIcon:"caret-thin-alt",style:{transform:`rotate(${e}deg)`,transformOrigin:"center"}}),n=(0,a.q)("caret-thin",{altIcon:"caret-thin-alt"}),o=r(270),i=r(0),l=r(90),h=r(180);[o,i,l,h].forEach(e=>e.defaultProps={size:{width:15,height:9},useAltIcon:!1})},19299:(e,t,s)=>{s.d(t,{Z:()=>r});var a=(0,s(36343).q)("lock",{altIcon:"lock-alt"});a.defaultProps={size:{width:24,height:24},useAltIcon:!1};let r=a},902:(e,t,s)=>{s.d(t,{Z:()=>r});var a=(0,s(36343).q)("posts-ask");a.defaultProps={size:{width:24,height:24}};let r=a},81022:(e,t,s)=>{s.d(t,{Z:()=>r});var a=(0,s(36343).q)("posts-audio",{altIcon:"posts-audio-alt"});a.defaultProps={size:{width:24,height:24},useAltIcon:!1};let r=a},48430:(e,t,s)=>{s.d(t,{Z:()=>r});var a=(0,s(36343).q)("posts-link",{altIcon:"posts-link-alt"});a.defaultProps={size:{width:24,height:24},useAltIcon:!1};let r=a},40565:(e,t,s)=>{s.d(t,{Z:()=>r});var a=(0,s(36343).q)("posts-video",{altIcon:"posts-video-alt"});a.defaultProps={size:{width:24,height:24},useAltIcon:!1};let r=a},82145:(e,t,s)=>{s.d(t,{Z:()=>p});var a=s(54138),r=s.n(a),n=s(54589),o=s.n(n),i=s(36343),l=s(55015),h=s(2629),d=["isCompact","isRounded"],c=(0,i.q)("reblog"),u=(0,i.q)("reblog-compact"),g=(0,i.q)("reblog-rounded"),m=e=>{var t=e.isCompact,s=e.isRounded,a=o()(e,d);return t?(0,h.jsx)(u,r()({},a)):s?(0,h.jsx)(g,r()({},a)):(0,h.jsx)(c,r()({},a))};m.defaultProps={size:l.Z.desktop.reblogIconSize,isCompact:!1,isRounded:!1};let p=m},37560:(e,t,s)=>{s.d(t,{Z:()=>h});var a=s(50209),r=s.n(a),n=s(95004),o=s(36485),i=s(2629);class l extends n.Component{render(){var e=this.props,t=e.className,s=e.src,a=e.title,r=e.queryParams,n=e.scrolling,l=e.frameBorder,h=e.style,d=e.onLoad,c=e.placementId,u=e.allow,g=e.allowFullScreen;return(0,i.jsx)("iframe",{className:t,name:c,title:a,src:(0,o.Z)(s,r),scrolling:n,frameBorder:l,style:h,onLoad:d,allow:u,allowFullScreen:g})}}r()(l,"defaultProps",{className:"",queryParams:{},scrolling:"no",frameBorder:0});let h=l},4237:(e,t,s)=>{s.d(t,{Z:()=>u});var a=s(50209),r=s.n(a),n=s(95004),o=s(93853),i=s(17144),l=s(78667),h=s(2629),d=e=>{var t=e.children,s=e.avatar;return(0,h.jsxs)("div",{className:"JWdar",children:[s,t]})};class c extends n.Component{constructor(){super(...arguments),r()(this,"placeHolders",[this.props.appContext._t("New message"),this.props.appContext._t("Your message here"),this.props.appContext._t("Write a message"),this.props.appContext._t("Say something"),this.props.appContext._t("Say your thing")]),r()(this,"state",{textareaHeight:"auto",textareaHasFocus:!!this.props.autoFocus,placeholder:this.props.isDeactivated?this.props.appContext._c("Placeholder of messaging input when receiver is deactivated account","Messaging unavailable"):this.props.isDisabled?"":(0,i.I)(this.placeHolders)}),r()(this,"textareaRef",(0,n.createRef)()),r()(this,"focus",()=>this.textareaRef.current&&this.textareaRef.current.focus()),r()(this,"onFocus",()=>this.setState({textareaHasFocus:!0})),r()(this,"onBlur",()=>this.setState({textareaHasFocus:!1})),r()(this,"onPaste",e=>{var t,s,a=function(e){var t=Array.from(e.clipboardData.items).filter(;return 0===t.length?[]:t.map(.filter(}(e);a.length&&(null===(t=(s=this.props).onPasteImage)||void 0===t||t.call(s,a[a.length-1]))}),r()(this,"onKeyDown",e=>{if(e.key===o.SV.Enter&&!e.shiftKey&&!e.nativeEvent.isComposing){var t=this.props.onSubmit;e.preventDefault(),t&&t()}}),r()(this,"resizeTextarea",()=>{var e=this.props,t=e.heightModifier,s=e.onResize;this.setState({textareaHeight:"auto"},()=>{this.textareaRef.current&&void 0!==t&&this.setState({textareaHeight:`${this.textareaRef.current.scrollHeight+t}px`},})})}componentDidMount(){this.resizeTextarea()}ender(){var e=this.props,t=e.value,s=e.onSubmit,a=e.onChange,r=e.autoFocus,n=e.maxLength,i=e.isDisabled,l=e.isMobile,c=e.avatar,u=this.state,g=u.textareaHeight,m=u.textareaHasFocus,p=u.placeholder;return(0,h.jsxs)(h.Fragment,{children:[!l&&(0,h.jsx)(o.ZP,{disable:m?o.z9:void 0}),(0,h.jsx)(d,{avatar:c,children:(0,h.jsx)("textarea",{ref:this.textareaRef,className:"xXTjk",autoFocus:r,placeholder:p,value:t,rows:1,maxLength:n,onSubmit:s,onChange:a,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onPaste:this.onPaste,onBlur:this.onBlur,disabled:i,style:{height:g,overflowY:"auto"===g?"hidden":"auto"}})})]})}}r()(c,"defaultProps",{maxLength:4096,autoFocus:!1,heightModifier:0});let u=(0,l.tM)(c)},29824:(e,t,s)=>{s.d(t,{Z:()=>c});var a=s(54138),r=s.n(a),n=s(88203),o=s.n(n),i=s(63415),l=s(70505),h=(e,t)=>(0,l.sW)(null==e?void 0:e.backgroundColor,null==e?void 0:e.linkColor,!!t&&(null==e?void 0:e.showHeaderImage)),d=e=>o()(h(e)).alpha(.1).string();let c={getThemedButtonColor:(e,t)=>{var s=(0,i.II)(t.white);return e&&(0,l.hY)(s,e)?e:(0,i.II)(t.black)},getFullyThemedButtonColor:e=>{var t=e.linkColor,s=e.backgroundColor;return(0,l.hY)(s,t)?t:(0,l.ps)(s)},parseConversationInfoFromResponse:(e,t)=>{var s=e.response,a=s.participants[0],r=s.participants[1];return s.participants.map(e=>{e.name===t?a=e:r=e}),{selectedBlog:a,otherParticipant:r,conversation:s,token:s.token}},conversationWindowDividerHeightPx:1,getConversationWindowThemeTextColor:h,getConversationWindowThemedBorderCssString:(e,t)=>`solid 1px ${d(r()(r()({},e),{},{showHeaderImage:!!t&&e.showHeaderImage}))}`}},19434:(e,t,s)=>{s.r(t),s.d(t,{default:()=>tD});var a=s(17276),r=s.n(a),n=s(54138),o=s.n(n),i=s(50209),l=s.n(i),h=s(5754),d=s.n(h),c=s(95004),u=s(78994),g=s(23117),m=s(29846),p=s(50213),v=s(6135),f=(0,c.createContext)(null),b=f.Provider,w=f.Consumer,x=s(45222),C=s(44009),M=s(7817),y=s(27755),S=s(98478),N=s(36343),T=(0,N.q)("gif-outline");T.defaultProps={size:{width:24,height:24}};var k=(0,N.q)("image-upload");k.defaultProps={size:{width:20,height:20}};var j=s(16558),P=s(35665),I=s(9557),B=s(5849),F=s(37236),E=s(43684),R=s(5700),A=s(59215),O=s(20318),Z=s(98384),D=s(23326),L=s(63788),H=s(78667),_=s(44561);let W={actions:"n6qP1",actionButtonWrapper:"kC0_t",actionButton:"UYD9p",blockSetting:"IAags",soundSetting:"Ua7cG"};var U=s(2629);class z extends c.Component{constructor(){super(...arguments),l()(this,"state",{isDeleteModalOpen:!1,isBlockModalOpen:!1}),l()(this,"toggleDeleteModal",()=>this.setState(e=>({isDeleteModalOpen:!e.isDeleteModalOpen}))),l()(this,"openBlockModal",()=>this.setState({isBlockModalOpen:!0})),l()(this,"toggleBlockModal",e=>{this.setState(e=>({isBlockModalOpen:!e.isBlockModalOpen})),e&&this.props.closeConversation()})}render(){var e=this.state,t=e.isDeleteModalOpen,s=e.isBlockModalOpen,a=this.props,r=a.otherParticipantName,n=a.selectedBlogName,o=a.userBlogs,i=(0,_.g)(r,o);return(0,U.jsx)(w,{children:e=>(0,U.jsxs)("ul",{className:W.actions,children:[(0,U.jsx)("li",{children:this.renderSettingsButton()}),(0,U.jsx)("li",{children:this.renderDeleteConversationButton()}),!i&&(0,U.jsx)("li",{children:this.renderBlockButton()}),!i&&(0,U.jsx)("li",{children:this.renderReportSpamButton()}),t&&e&&this.renderDeleteModal(e.deleteConversation),s&&(0,U.jsx)(L.Z,{currentTumblelog:n,tumblelogNameToBlock:r,closeDialog:this.toggleBlockModal})]})})}renderSettingsButton(){var e=this.props.appContext._t;return(0,U.jsx)(C.Z,{wrapperClassName:W.actionButtonWrapper,className:W.actionButton,label:e("Sound settings"),children:(0,U.jsxs)("a",{className:W.soundSetting,href:"/settings/dashboard",tabIndex:-1,children:[(0,U.jsx)("span",{children:e("Sound settings")}),(0,U.jsx)(Z.iL,{size:{width:10,height:10}})]})})}renderDeleteConversationButton(){var e=this.props.appContext._t;return(0,U.jsx)(C.Z,{wrapperClassName:W.actionButtonWrapper,className:W.actionButton,onClick:this.toggleDeleteModal,children:e("Delete conversation")})}renderBlockButton(){var e=this.props,t=e.otherParticipantName,s=e.appContext._c;return(0,U.jsx)(C.Z,{wrapperClassName:W.actionButtonWrapper,className:d()(W.actionButton,W.blockSetting),onClick:this.openBlockModal,children:s("Blocking a user from sending more messages to you","Block %1$s",[t])})}renderReportSpamButton(){var e=this.props,t=e.appContext._t,s=e.markAsSpam;return(0,U.jsx)(C.Z,{wrapperClassName:W.actionButtonWrapper,className:W.actionButton,onClick:s,children:t("Mark as spam")})}renderDeleteModal(e){var t=this.props.appContext._t;return(0,U.jsx)(p.Z,{onGlassClick:this.toggleDeleteModal,glassIsClickable:!1,children:(0,U.jsx)(D.O,{title:t("Permanently delete this conversation?"),buttons:[{text:t("Nevermind"),onClick:this.toggleDeleteModal,buttonStyle:D.X.Neutral},{text:t("Delete"),onClick:e,buttonStyle:D.X.Cancel}]})})}}let Y=(0,H.HJ)(z);var q=s(29824),$=s(4237);let G={footer:"KnIls",imagePreview:"CdOQq",removeImagePreviewButton:"iDU8U",iconBackground:"u7nA8",submit:"nWfaK",corporeal:"CMFMg",hasContent:"bMGN0",submitted:"gmByZ",ghost:"k76lX",controls:"sgf6Y",control:"RR_oP",isDisabled:"w2mTX",actionsContainer:"uDAaF",isMobile:"Zfv1_"};class X extends c.Component{constructor(){super(...arguments),l()(this,"state",{isSubmitted:!1,textareaHasFocus:!1,messageText:""}),l()(this,"compositionAreaRef",(0,c.createRef)()),l()(this,"setFooterRef",,l()(this,"closeIconOnClick",()=>{var e,t,s;this.setState({messageImage:void 0}),null===(e=(t=this.props).updateMessageImage)||void 0===e||e.call(t,void 0),null===(s=this.compositionAreaRef.current)||void 0===s||s.focus()}),l()(this,"onChangeTextarea",e=>{var t,s;this.setState({messageText:e.target.value}),null===(t=(s=this.props).updateMessageText)||void 0===t||t.call(s,e.target.value)}),l()(this,"gifOnClick",e=>{var t,s,a;null===(t=this.compositionAreaRef.current)||void 0===t||t.focus(),this.setState({messageImage:e}),null===(s=(a=this.props).updateMessageImage)||void 0===s||s.call(a,e)}),l()(this,"onPasteImage",e=>{var t,s=URL.createObjectURL(e),a=new Image;a.onload=()=>{var t,r,n={file:e,type:R.kH.Image,media:[{url:s,width:a.width,height:a.height}]};this.setState({messageImage:n}),null===(t=(r=this.props).updateMessageImage)||void 0===t||t.call(r,n)},a.src=s,null===(t=this.compositionAreaRef.current)||void 0===t||t.focus()}),l()(this,"uploadImageOnChange",e=>{var t,s=e.target.files;if(null!=s&&s.length){var a=s[0],r=URL.createObjectURL(a),n=new Image;n.onload=()=>{var e,t,s={file:a,type:R.kH.Image,media:[{url:r,width:n.width,height:n.height}]};this.setState({messageImage:s}),null===(e=(t=this.props).updateMessageImage)||void 0===e||e.call(t,s)},n.src=r,e.target.value="",null===(t=this.compositionAreaRef.current)||void 0===t||t.focus()}}),l()(this,"communicateUpFooterHeight",()=>{var e=this.props.setFooterHeight;e&&this.footerRef&&e(`${this.footerRef.getBoundingClientRect().height}px`)}),l()(this,"submit",()=>{var e=this.props,t=e.isDisabled,s=e.onSubmitMessage,a=e.appContext.getUserInfo;if(!t&&this.verifyMessageHasContent()){var r,n,o=this.state;s({text:o.messageText,image:o.messageImage}),this.setState({isSubmitted:!0,messageText:"",messageImage:void 0},,null===(r=(n=this.props).resetNewMessageData)||void 0===r||r.call(n),a().then(e=>O.ZP.play(e,O.gO.MESSAGE_SENT))}}),l()(this,"verifyMessageHasContent",()=>{var e=this.state,t=e.messageText,s=e.messageImage;return!!t.trim().length||!!s}),l()(this,"onAnimationEndButton",}componentDidMount(){this.footerRef&&this.communicateUpFooterHeight();var e=this.props,t=e.messageText,s=e.messageImage;t&&this.setState({messageText:t}),s&&this.setState({messageImage:s})}render(){var e=this.props.deviceContext.isMobile;return(0,U.jsxs)("div",{className:d()(G.footer,{[G.isMobile]:e}),ref:this.setFooterRef,children:[this.renderImagePreview(),this.renderTextareaAndButtons()]})}renderImagePreview(){var e=this.state.messageImage,t=this.props.appContext._t;return e?(0,U.jsxs)("div",{className:G.imagePreview,children:[(0,U.jsx)(C.Z,{wrapperClassName:G.removeImagePreviewButton,label:t("Remove image from being sent"),onClick:this.closeIconOnClick,children:(0,U.jsx)("div",{className:G.iconBackground,children:(0,U.jsx)(S.Z,{size:{width:10,height:10}})})}),(0,U.jsx)(P.Z,{imageResponse:(0,R.I3)(e),altText:t("Image to be sent"),sizes:""})]}):null}renderTextareaAndButtons(){var e=this.props,t=e.appContext._t,s=e.deviceContext.isMobile,a=e.userBlogs,r=e.otherParticipant,n=e.selectedBlog,o=e.isDisabled,i=e.closeConversation,l=e.onClickMarkAsSpam;return(0,U.jsxs)(U.Fragment,{children:[this.renderTextArea(!1),(0,U.jsxs)("div",{className:G.controls,children:[(0,U.jsx)(M.Z,{buttonWrapperClassName:d()(G.control,{[G.isDisabled]:o}),gifOnClick:this.gifOnClick,disabled:o,searchContext:"messaging-gif",children:(0,U.jsx)(T,{size:{width:22,height:22}})}),(0,U.jsx)(B.Z,{wrapperClassName:d()(G.control,{[G.isDisabled]:o}),fileTypes:["image"],onChange:this.uploadImageOnChange,disabled:o,multiple:!1,children:(0,U.jsx)(k,{size:{width:22,height:22}})}),!s&&(0,U.jsx)("div",{className:G.actionsContainer,children:(0,U.jsx)(I.Z,{targetWrapperClassName:G.control,component:(0,U.jsx)(Y,{userBlogs:a,otherParticipantName:r.name,selectedBlogName:n.name,closeConversation:i,markAsSpam:l}),positionBasedOffsetModifiers:{[E.I2.Top]:{top:2}},position:E.I2.TopEnd,boundary:E.gc.ScrollParent,width:200,height:"auto",children:(0,U.jsx)(C.Z,{label:t("Conversation Menu"),children:(0,U.jsx)(j.Z,{useAltIcon:!0,size:{width:22,height:22}})})})}),this.renderSubmitButton()]})]})}renderTextArea(e){var t=this.props,s=t.isDisabled,a=t.selectedBlog,r=t.otherParticipant,n=this.state.messageText;return(0,U.jsx)($.Z,{avatar:(0,U.jsx)(x.Z,{name:a.name,imageResponse:a.avatar,avatarShape:F.o.Circle,isLink:!1,dimension:24,showBlogCard:!1}),ref:this.compositionAreaRef,value:n,autoFocus:!e,heightModifier:e?0:q.Z.conversationWindowDividerHeightPx,isDisabled:s,isMobile:e,onSubmit:this.submit,onChange:this.onChangeTextarea,onPasteImage:this.onPasteImage,onResize:this.communicateUpFooterHeight,blogName:a.name,isDeactivated:!!r&&!r.isActive})}renderSubmitButton(){var e=this.props,t=e.isDisabled,s=e.appContext._t,a=this.state.isSubmitted,r=!t&&this.verifyMessageHasContent(),n=d()(G.corporeal,{[G.hasContent]:r,[G.submitted]:a});return(0,U.jsx)(C.Z,{type:"submit",label:s("Send"),disabled:!r,wrapperClassName:G.submit,onClick:this.submit,children:(0,U.jsxs)("div",{className:G.control,children:[(0,U.jsx)("div",{className:n,onAnimationEnd:this.onAnimationEndButton,children:(0,U.jsx)(y.Z,{size:{width:20,height:20}})}),(0,U.jsx)("div",{className:G.ghost,children:(0,U.jsx)(y.Z,{size:{width:20,height:20}})})]})})}}let V=(0,A.X9)(X,{appContext:!0,deviceContext:!0,paletteContext:!0});var J=s(17287),K=s(93853),Q=s(2474),ee=s(30420),et=s(18042),es=s(25190),ea=s(50869);let er={headerDesktop:"znXuz",header:"cOy8n",participantName:"ySwFJ",controls:"RGQ9e",control:"mEtpN",participant:"Nudz8",goBackButton:"j7qzg"},en=e=>{var t=e.otherParticipant,s=e.selectedBlog,a=e.userBlogs,r=e.closeConversation,n=e.minimizeConversation,o=e.onClickMarkAsSpam,i=(0,H.bp)(),l=i._t,h=i._c,c=(0,es.v$)().isMobile,g=(0,u.s0)(),m=h("Label for go back button available in messaging on mobile","Go back"),p=t.avatar,v=t.secondsSinceLastActivity,f=t.name,b=t.isAdult;return(0,U.jsxs)("div",{className:d()(c?er.header:er.headerDesktop),children:[c&&(0,U.jsx)("div",{className:d()(er.control,er.goBackButton),children:(0,U.jsx)(C.Z,{className:er.back,label:m,onClick:()=>g(`/messaging${s.primary?"":`/${s.name}`}`),children:(0,U.jsx)(Q.Mq,{size:{width:18,height:14}})})}),(0,U.jsxs)("div",{className:er.participant,children:[!c&&(0,U.jsx)(x.Z,{name:f,imageResponse:p,avatarShape:F.o.Circle,dimension:36,isOnline:(0,ea.k)(v),isAdult:b,showBlogCard:!1}),(0,U.jsx)("div",{className:er.participantName,children:(0,U.jsx)(J.Z,{blogName:t.name,showBlogCard:!1,children:t.name})})]}),(0,U.jsxs)("div",{className:er.controls,children:[c&&(0,U.jsx)(I.Z,{targetWrapperClassName:er.control,component:(0,U.jsx)(Y,{userBlogs:a,otherParticipantName:t.name,selectedBlogName:s.name,closeConversation:r,markAsSpam:o}),position:E.I2.BottomEnd,boundary:E.gc.ScrollParent,positionBasedOffsetModifiers:{[E.I2.Bottom]:{top:-4}},width:200,height:"auto",children:(0,U.jsx)(C.Z,{label:l("Conversation Menu"),children:(0,U.jsx)(et.b,{size:{width:18,height:12}})})}),!c&&(0,U.jsx)("div",{className:er.control,children:(0,U.jsx)(C.Z,{label:l("Minimize Conversation"),onClick:n,children:(0,U.jsx)(Q.br,{size:{width:16,height:18}})})}),!c&&(0,U.jsxs)("div",{className:er.control,children:[(0,U.jsx)(K.ZP,{hotkey:{key:K.SV.Escape,command:r,allowInputs:!0}}),(0,U.jsx)(C.Z,{label:l("Close"),onClick:r,children:(0,U.jsx)(ee.Z,{size:{width:14,height:14}})})]})]})]})};var eo=s(10131),ei=s(71228),el=s(68582),eh=s(61248),ed=s(94156),ec=s(68346),eu=s(96467);let eg={imageWrapper:"DMq0a",blurredImageWrapper:"WT4pK"};var em=e=>{var t=e.imageResponse,s=e.isBlurredImages,a=e.shouldOpenLightbox,r=new ec.Z(t).getLargestImage(),n=!!r&&!r.originalDimensionsMissing,i=(0,el.c)(n,r),l=r.width<eu.messageBubbleMaxWidth,h={imageResponse:t,sizes:`${eu.desktopConversationWidthPx}px`,loading:"eager",style:{width:l?r.width:`${eu.messageBubbleMaxWidth}px`}},d=(0,U.jsx)("div",{className:eg.imageWrapper,style:{paddingBottom:i},children:s?(0,U.jsx)(ei.Z,o()(o()({},h),{},{wrapperClassName:eg.blurredImageWrapper})):(0,U.jsx)(P.Z,o()({},h))});return a?(0,U.jsx)(eh.Z,{children:(0,U.jsx)(ed.Z,{imageResponse:t,children:d})}):d};let ep=e=>{var t=e.message,s=e.isBlurredImages,a=t.images;return a?(0,U.jsx)("div",{className:"ZkVTS",children:(0,U.jsx)(em,{imageResponse:a[0].altSizes,isBlurredImages:s,shouldOpenLightbox:!0})}):null};var ev=s(96977),ef=s(84397),eb=s(58546),ew=s(68868);let ex={messagePost:"nyrq3",hasMediaPreview:"Naqm8",header:"QXol6",disabled:"mNgWd",headerPreview:"wJVEU",action:"uDTXq",summary:"gqU9U",summaryShort:"MgIFK",thumbnail:"x47LP",play:"asuid"};var eC=[R.ms.Answer,R.ms.Ask],eM=[R.lr.Chat,R.lr.Quote],ey=(e,t)=>{var s=(0,ef.Z)(null==e?void 0:e.trail,null==e?void 0:e.content,t);return Array.isArray(s)?s[0]:s},eS=e=>{var t=null==e?void 0:e.layout,s=t&&!(0,eb.y)(t)?t[0].type:void 0;return s&&eC.includes(s)?s:void 0},eN=e=>{var t=e.subtype;return t&&eM.includes(t)?t:void 0},eT=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=eS(e),a=ey(e,t),r=a?eN(a):void 0;return s||r||(null==a?void 0:a.type)},ek=(e,t)=>{var s,a,r=ey(e,t);return(0,R.gD)(r)?(a=!!r.poster,s=r.poster):s=r&&(0,R.I3)(r),(0,U.jsxs)(U.Fragment,{children:[s&&(0,U.jsx)(em,{imageResponse:s}),a&&(0,U.jsx)("div",{className:ex.play,children:(0,U.jsx)(ev.Z,{size:{width:96,height:96}})})]})},ej=e=>{var t,s=e.name,a=e.post,r=e.isOwnMessage,n=(0,H.bp)()._c,o=r?n("Label at the top of your own message with shared post that's no longer available (in messaging)","You shared a post that's no longer available."):n("Label at the top of message sent to you with shared post that's no longer available (in messaging)","%1$s shared a post that's no longer available.",[s]);if(a&&(0,ew.A)(a))return(0,U.jsx)("div",{className:ex.messagePost,children:(0,U.jsx)("div",{className:d()(ex.header,ex.disabled),children:o})});var i=!1,l=eT(a);if(l===R.kH.Text){var h=eT(a,!0);h&&(i=!0,l=h)}var c=l===R.kH.Video||l===R.kH.Image,u=r?n("Label at the top of your own message with shared post (in messaging)","You shared a post"):n("Label at the top of message sent to you with shared post (in messaging)","%1$s shared a post",[s]);return(0,U.jsx)(J.Z,{blogName:null==a?void 0:a.blogName,postId:null==a?void 0:a.id,showBlogCard:!1,children:(0,U.jsxs)("div",{className:d()(ex.messagePost,{[ex.hasMediaPreview]:c}),children:[(0,U.jsx)("div",{className:ex.header,children:(0,U.jsxs)("div",{className:ex.headerPreview,children:[(0,U.jsx)("div",{className:ex.action,children:u}),!!(null!=a&&null!==(t=a.summary)&&void 0!==t&&t.length)&&(0,U.jsx)("span",{className:d()(ex.summary,{[ex.summaryShort]:c}),children:a.summary})]})}),c&&(0,U.jsx)("div",{className:ex.thumbnail,children:ek(a,i)})]})})},eP=s(76319),eI=s(34728),eB=s(33970),eF=s.n(eB),eE=s(46244),eR=s(43523),eA=s(22424),eO=s(93613),eZ=s(11770),eD=e=>{var t=e.inviteLink,s=(0,H.bp)().updateLabsSettings,a=(0,H.bp)(),r=a.apiFetch,n=a._c,o=a._t,i=(0,u.s0)(),l=(0,eO.V)().toggleToast,h=(0,eA.wL)().logEvent,d=(0,c.useState)(!1),g=eF()(d,2),m=g[0],p=g[1],v=new URL(t).searchParams.get("invite"),f=b=(0,eE.D)({mutationFn:()=>r("/v2/settings/labs/invite/accept",{method:"POST",body:{invite:v}}),onError:f,onSuccess:e=>{var t=e.response,a=t.labId,r=t.redirect,n=(0,eZ.T)(`experiment${a}`);n?(p(!0),s(n,!0),l(o("Congrats! You've joined our experiment!"),"success"),h({eventName:eR.J.LabsJoinFromInvite,eventDetails:{labId:a}})):f(),r&&(r.startsWith("https://")?window.location.assign(r):i(r))}});return(0,U.jsx)(C.Z,{wrapperClassName:"MfHzX",onClick:()=>b.mutate(),disabled:m,children:m?n("Action button to showing that an invite to a Tumblr Lab experiment was accepted","Accepted"):n("Action button to accept an invite to a Tumblr Lab experiment","Accept")})};let eL={messageText:"CX_9D",messageHeader:"_fx8y",isCollapsed:"Pri9Z",ownMessage:"qWqk3"};function eH(e){var t,s=null!=e&&null!==(t=e.formatting)&&void 0!==t&&t.length?null==e?void 0:e.formatting[0]:null;return s&&e&&s.type===R.TV.Link?(0,eI.Q7)(e.text,(0,eI.hA)(null==e?void 0:e.formatting)):null==e?void 0:e.text}let e_=e=>{var t=e.message,s=e.isCollapsed,a=e.isOwnMessage;return(0,U.jsxs)("div",{className:d()(eL.messageText,{[eL.ownMessage]:a}),children:[(0,U.jsx)("div",{className:d()(eL.messageHeader,{[eL.isCollapsed]:s})}),(0,U.jsx)("div",{className:eL.message,children:function(e){return"t:XbGKiuQIRifkGQrgFV1L0w"===e.participant&&e.content?function(e){var t=e.text.match(/https?:\/\/(?:\w+\.)+(?:tumblr\.com|tumblr\.net)\/settings\/invite-labs\/accept\?invite=([^&]+)(?:&.*)?/g);if(t){var s=t[0];return(0,eP.Z)({mixedString:e.text.replace(s,"{{AcceptLabsInviteButton/}}"),components:{AcceptLabsInviteButton:(0,U.jsx)(eD,{inviteLink:s})}})}return eH(e)}(e.content):eH(null==e?void 0:e.content)}(t)})]})},eW={message:"_0u3Ix",collapsed:"qgtXd",messageAnimation:"cidEK",bubble:"CvL1C",ownMessage:"gCivL",retry:"oFT8O",cannotSend:"ZZYkp",messageStatus:"bmQBQ",isRetrying:"OM4aM"},eU=e=>{var t=e.message,s=e.wrapperClassName,a=t.isRetrying,r=t.couldNotSend,n=(0,H.bp)()._c;return(0,U.jsx)(w,{children:e=>{var o=a?n("Label text showing when message fails to send and is retrying","Retrying message..."):n("Label text showing when message fails to send","Error Message - Retry");return r?(0,U.jsx)("span",{className:d()(s,eW.cannotSend),children:n("A message could not be sent. This text should be brief to accomodate the small form-factor of conversation windows","Could not send")}):(0,U.jsx)(C.Z,{wrapperClassName:s,className:d()(eW.retry,{[eW.isRetrying]:a}),onClick:()=>!a&&(null==e?void 0:e.retryMessage(t)),label:o,children:o})}})};var ez=s(67023),eY=e=>{var t=e.children,s=e.isOwnMessage;return(0,U.jsx)("div",{className:d()("cuHJ6",{jE1z2:s}),children:t})},eq=e=>{var t=e.message,s=e.isOwnMessage,a=(0,H.bp)(),r=a._getLocaleDateString,n=a._getRelativeDateString,o=a._t,i=t.ts&&new Date(parseInt(t.ts,10));if(!i)return null;var l=new Date,h=i.getFullYear()===l.getFullYear(),d=n(i,ez.q.Days),c=[o("Today"),o("Yesterday")].includes(d)?d:r(i,h?ez.C.MonthDayShort:ez.C.MonthDayYearShort,!0),u=r(i,ez.C.Time,!0);return(0,U.jsxs)(eY,{isOwnMessage:s,children:[c," ",u]})},e$=e=>{var t=e.participant,s=e.message,a=e.isBlurredImages,r=e.isCollapsed,n=e.isOwnMessage,o=null;switch(s.type){case eo.C.Image:case eo.C.Sticker:o=(0,U.jsx)(ep,{message:s,isBlurredImages:a});break;case eo.C.Post:o=(0,U.jsx)(ej,{name:t.name,post:s.post,isOwnMessage:n});break;case eo.C.Text:o=(0,U.jsx)(e_,{message:s,name:t.name,isOwnMessage:n,isCollapsed:r})}return(0,U.jsx)("div",{className:d()(eW.bubble,{[eW.ownMessage]:n}),children:o})},eG=e=>{var t=e.participant,s=e.message,a=e.showTimestamp,r=e.isOwnMessage,n=e.isCollapsed,o=e.isBlurredImages,i=e.animateOnMount,l=s.isPending,h=s.canRetry,u=s.couldNotSend,g=(0,c.useRef)(!!i);return(0,U.jsxs)("div",{className:d()(eW.message,{[eW.collapsed]:n,[eW.messageAnimation]:g}),children:[(0,U.jsx)(e$,{participant:t,message:s,isBlurredImages:o,isOwnMessage:r,isCollapsed:n}),(h||u)&&(l?(0,U.jsx)("div",{className:eW.messageStatus,children:(0,U.jsx)(v.Z,{small:!0})}):(0,U.jsx)(eU,{message:s,wrapperClassName:eW.messageStatus})),a&&(0,U.jsx)(eq,{message:s,isOwnMessage:r})]})};class eX extends c.Component{constructor(){super(...arguments),l()(this,"state",{hasError:!1})}componentDidCatch(e){this.setState({hasError:!0}),e.message=`[MessagePost error: ${e.message}]`,window.dispatchEvent(new ErrorEvent("error",{error:e,message:e.message}))}render(){return this.state.hasError?null:(0,U.jsx)(eG,o()({},this.props))}}var eV=(e,t,s)=>{if(!t||e.participant!==t.participant)return!1;var a=e.ts||e.pendingTs,r=t.ts||t.pendingTs;return!!a&&!!r&&parseInt(a,10)-parseInt(r,10)<s},eJ=(e,t,s)=>!!t&&!!e.ts&&!!t.ts&&parseInt(e.ts,10)-parseInt(t.ts,10)>s,eK=(e,t,s)=>!!t&&!!e.ts&&!!t.ts&&parseInt(t.ts,10)-parseInt(e.ts,10)>s;class eQ extends c.Component{nder(){var e=this.props,t=e.messages,s=e.participants,a=e.isBlurredImages,r=e.selectedBlog,n=s.find(e=>e.name!==r.name);return(0,U.jsx)("div",{className:"iI6zv",children:t.map((e,r)=>{var o,i=s.find(,l=r===t.length-1||eK(e,t[r+1],36e5);return i&&(0,U.jsx)(eX,{participant:i,isOwnMessage:i!==n,message:e,isBlurredImages:a&&i===n,isCollapsed:eV(e,t[r-1],6e4),showHeaderTimestamp:eJ(e,t[r-1],36e5),themeBackgroundColor:null==n||null===(o=n.theme)||void 0===o?void 0:o.backgroundColor,animateOnMount:this.areMessageUpdatesNewMessages,showTimestamp:l},r)})})}}var e0=s(26705),e1=s(2493),e2=s(90127),e4=s(71768),e3=s(63665),e5=s(85795),e6=s(25749),e9=s(81095),e8=s(1308),e7=s(88451),te=s(73125),tt=s(40092),ts=s(86033),ta=s(13003),tr=s(45051),tn=s(63583),to=s(94742),ti=s(42162),tl=s(17144),th=s(399),td=function(e){return e.VerificationRequired="403.7001",e.TheirFollowNeeded="403.7003",e.TheirFollowNeededTwo="428",e.YourFollowNeeded="409",e.MessagingLimitReached="429",e}(td||{});class tc extends c.Component{constructor(){super(...arguments),l()(this,"state",{errorMessage:""}),l()(this,"specificErrorMessages",(()=>{var e=this.props,t=e.otherParticipant,s=e.appContext._t,a=s("Sorry, %1$s only allows messages from Tumblrs they follow.",[t?t.name:"this Tumblr"]);return{[td.VerificationRequired]:s("Please verify your email address before talking to a Tumblr."),[td.TheirFollowNeeded]:a,[td.TheirFollowNeededTwo]:a,[td.MessagingLimitReached]:s("You've hit the daily limit on new conversations. Impressive."),[td.YourFollowNeeded]:s("You can only send messages to Tumblrs you follow.")}})()),l()(this,"genericErrorMessages",(0,th.Pk)(this.props.appContext._t)),l()(this,"renderPostMessageContent",()=>{var e=this.props.responseErrorCode;return e===td.YourFollowNeeded?this.renderFollowButton():this.specificErrorMessages[e]?null:this.renderGenericErrorRetryButton()}),l()(this,"renderGenericErrorRetryButton",()=>{var e=(0,this.props.appContext._t)("Retry");return(0,U.jsx)(C.Z,{label:e,onClick:this.refreshConversation,wrapperStyle:{backgroundColor:this.getButtonBackground()},wrapperClassName:"EHFnT",children:e})}),l()(this,"renderFollowButton",()=>{var e=this.props,t=e.otherParticipant,s=t.name,a=t.url,r=t.followed,n=e.appContext._c;return(0,U.jsx)(ti.Z,{blogName:s,blogUrl:a,following:!!r,onFollow:this.refreshConversation,style:{backgroundColor:this.getButtonBackground()},className:"nY_EE",followCaption:n("A button that allows the user to begin following the specified blog","Follow %1$s",[this.props.otherParticipant.name])})}),l()(this,"getButtonBackground",()=>{var e;return q.Z.getThemedButtonColor(null===(e=this.props.otherParticipant.theme)||void 0===e?void 0:e.linkColor,this.props.paletteContext.colors)}),l()(this,"refreshConversation",,l()(this,"regenerateErrorMessage",()=>{var e=this.props.responseErrorCode;this.setState({errorMessage:this.specificErrorMessages[e]||(0,tl.I)(this.genericErrorMessages)})})}omponentDidUpdate(e){e&&e.responseErrorCode&&e.responseErrorCode!==this.props.responseErrorCode&&this.regenerateErrorMessage()}render(){var e=this.props.otherParticipant,t=this.state.errorMessage;return e?(0,U.jsxs)("div",{className:"hKMVX",children:[t,this.renderPostMessageContent()]}):null}}let tu=(0,A.X9)(tc,{appContext:!0,paletteContext:!0});var tg=(0,N.q)("messaging-error");tg.defaultProps={size:{width:18,height:18}};let tm={deactivatedTumblrErrorMessage:"T43d7",text:"HBsL7"},tp=()=>{var e=(0,H.bp)()._t;return(0,U.jsxs)("div",{className:tm.deactivatedTumblrErrorMessage,children:[(0,U.jsx)("div",{className:tm.icon,children:(0,U.jsx)(tg,{colors:{primary:tn.paletteGray80}})}),(0,U.jsx)("div",{className:tm.text,children:e("This Tumblr has been deactivated and can no longer receive messages")})]})};var tv=s(54382),tf=s(42946),tb=s(46978);let tw={iceBreaker:"b7hYL",name:"Su8XY",avatar:"TZTRp",relationship:"bHZr2",blogLink:"Q0H97",descriptionContainer:"c5cWI",description:"X3v32"};var tx=["topTagsFewer","followed","isFollowingYou","durationBlogFollowingYou","durationFollowingBlog"],tC=(e,t)=>{switch(e){case ty.Mutuals:return t>=1?(0,U.jsxs)(tv.M2,{comment:"Mutuals meaning that you mutually follow each other",number:t,children:[(0,U.jsx)(tv.CJ,{children:"Mutuals for a year"}),(0,U.jsx)(tv.CN,{children:"Mutuals for [number] years"})]}):(0,U.jsx)(tv.ZP,{comment:"Mutuals meaning that you mutually follow each other",children:"Mutuals for less than a year"});case ty.FollowingYou:return t>=1?(0,U.jsxs)(tv.M2,{comment:"Someone else is following you",number:t,children:[(0,U.jsx)(tv.CJ,{children:"Following you for a year"}),(0,U.jsx)(tv.CN,{children:"Following you for [number] years"})]}):(0,U.jsx)(tv.ZP,{comment:"Someone else is following you",children:"Following you for less than a year"});case ty.Following:default:return t>=1?(0,U.jsxs)(tv.M2,{comment:"You are following a diferent blog",number:t,children:[(0,U.jsx)(tv.CJ,{children:"Following for a year"}),(0,U.jsx)(tv.CN,{children:"Following for [number] years"})]}):(0,U.jsx)(tv.ZP,{comment:"You are following a diferent blog",children:"Following for less than a year"})}},tM=(e,t)=>t&&t.length>1?e("Posts about #%1$s and #%2$s",[t[0],t[1]]):t&&1===t.length?e("Posts about #%1$s",[t[0]]):null,ty=ty||{}),tS=e=>{var t=e.followed,s=e.isFollowingYou,a=e.durationBlogFollowingYou,r=e.durationFollowingBlog;return s&&t&&void 0!==r&&void 0!==a?tC(ty.Mutuals,Math.floor(Math.min(r,a)/tf.y.Year)):t&&void 0!==r?tC(ty.Following,Math.floor(r/tf.y.Year)):s&&void 0!==a?tC(ty.FollowingYou,Math.floor(a/tf.y.Year)):(0,U.jsx)(tv.ZP,{children:"Not following each other"})},tN=e=>{var t=e.otherParticipant,s=e.isNewConversation,a=e.selectedBlog,r=(0,H.bp)()._t;if(!t||!a||"boolean"!=typeof s)return null;var n=t.avatar,o=t.secondsSinceLastActivity,i=t.url,l=t.name,h=t.descriptionNpf,d=t.isAdult,c=t.topTagsFewer;return(0,U.jsxs)("div",{className:tw.iceBreaker,children:[(0,U.jsx)("div",{className:tw.avatar,children:(0,U.jsx)(x.Z,{name:l,imageResponse:n,avatarShape:F.o.Circle,dimension:40,isOnline:(0,ea.k)(o),isAdult:d,showBlogCard:!1})}),(0,U.jsxs)(J.Z,{blog:t,className:tw.blogLink,href:i,showBlogCard:!1,children:[(0,U.jsx)("div",{className:tw.name,children:l}),(0,U.jsx)("div",{className:tw.descriptionContainer,children:s?(0,U.jsx)("div",{className:tw.tags,children:tM(r,c)}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("div",{className:tw.description,children:(0,tb.C)(h)}),(0,U.jsx)("div",{className:tw.relationship,children:tS(t)})]})})]})]})},tT=s(66834);let tk=e=>{var t=e.onClickMarkAsSpam,s=(0,H.bp)()._t,a=s("Mark as spam");return(0,U.jsxs)("div",{className:"Enof8",children:[(0,U.jsx)("div",{className:"ca4GL",children:s("Is this spam?")}),(0,U.jsx)(C.Z,{label:a,className:"C_Wi4",onClick:t,children:a})]})};var tj=s(60612),tP=s(78093);class tI extends c.Component{constructor(){super(...arguments),l()(this,"renderContentFromTransitionStatus",e=>{var t=this.props,s=t.footerHeightInPx,a=t.numUnreadMessages,r=t.onClick,n=t.appContext._t,o=d()("EA92L",{GwWtH:[tj.d0,tj.Ix,tj.Wj].includes(e)});return(0,U.jsxs)(C.Z,{wrapperClassName:o,wrapperStyle:{bottom:s},label:n("Scroll to new messages"),onClick:r,disabled:0===a,children:[this.getUnreadMessagesText(),(0,U.jsx)(Q.br,{size:{width:12,height:16}})]})}),l()(this,"getUnreadMessagesText",()=>{var e=this.props,t=e.numUnreadMessages;return(0,e.appContext._cn)("Notifying the user of how many messages are in the current conversation window that they have not seen yet","%1$s unread message","%1$s unread messages",t)})}render(){var e=this.props,t=e.shouldShow,s=e.onExited;return(0,U.jsx)(tj.ZP,{in:t,timeout:{enter:0,exit:tP.unreadMessagesTransitionDurationInMs},exit:!0,appear:!0,onExited:s,children:this.renderContentFromTransitionStatus})}}let tB=(0,H.HJ)(tI);var tF=s(62217),tE=e=>{var t=e.fetchForMessagesSinceLastTelegraphMessage,s=e.conversationId,a=(0,tF.z)();return(0,c.useEffect)(()=>{if(s){var e,r=(null===(e=a.data)||void 0===e?void 0:e.unreadMessagesByBlogAndConversationId)||{};Object.keys(r).forEach(e=>{var n;(null===(n=r[e])||void 0===n?void 0:n[s])&&t(!0).then(})}},[a,s,t]),null};let tR={conversation:"hpABw",isMobile:"fJ37B",paginationLoader:"P3Whd",messages:"vwvdr",isLoading:"fAglS",headerWrapper:"GmRpU",mobileHeaderWrapper:"sirZx",headerBufferForMobile:"fPMDM",statusIndicator:"WKwiW"};var tA=2*eu.conversationMessageTextLineHeightPx+eu.conversationLastMessageBottomMarginPx,tO={isNewConversation:!1,redirect:!1,hasFetchedFullConversationHistory:!1,showUnreadMessageNotification:!1,numUnreadMessages:0,messagesContainerRef:null};class tZ extends c.Component{constructor(){var e;super(...arguments),e=this,l()(this,"state",this.props.appContext.getBootstrap(e4.R,tO)),l()(this,"apiHelper",(0,e5.ZP)(this.props.appContext.apiFetch)),l()(this,"channel",null),l()(this,"hasPossiblyMissedSomeMessages",!1),l()(this,"deleteConversationRequest",null),l()(this,"userInfoFetch",null),l()(this,"blogInfoFetch",null),l()(this,"newMessageData",{}),l()(this,"transformPaginatorMessages",null),l()(this,"refreshConversation",tr.Z),l()(this,"retryMessage",e=>this.submitNewMessage(o()(o()({},e),{},{isRetrying:!0,pendingTs:Date.now().toString()}),e.pendingTs).then(),l()(this,"deleteConversation",()=>{this.closeConversation(),null===(e=this.deleteConversationRequest)||void 0===e||e.cancel();var e,t=this.getConversationId();return this.state.selectedBlog&&t?(this.deleteConversationRequest=(0,ts.Z)(this.apiHelper.deleteConversation(t,this.state.selectedBlog.name).fetch()),this.deleteConversationRequest.then(()=>{this.props.deviceContext.isMobile&&this.setState({redirect:!0})})):Promise.resolve()}),l()(this,"contextValue",{retryMessage:this.retryMessage,deleteConversation:this.deleteConversation}),l()(this,"setMessagesContainerRef",e=>this.setState({messagesContainerRef:e})),l()(this,"renderHeader",e=>{var t;return!!this.state.userBlogs&&!!this.state.selectedBlog&&(0,U.jsx)("div",{className:d()(tR.headerWrapper,{[tR.mobileHeaderWrapper]:e}),children:(0,U.jsx)(en,{userBlogs:this.state.userBlogs,otherParticipant:null!==(t=this.state.otherParticipant)&&void 0!==t?t:{name:this.props.conversationWindowObject.otherParticipantName,url:""},selectedBlog:this.state.selectedBlog,closeConversation:this.closeConversation,minimizeConversation:this.minimizeConversation,onClickMarkAsSpam:this.toggleIsMarkAsSpamModal})})}),l()(this,"renderMessages",()=>this.state.messagesContainerRef&&(0,U.jsx)(e1.Z,{scrollContainer:this.state.messagesContainerRef,direction:e3.cU.Bottom,edgeDistance:20,onScrollToEdge:this.hideUnreadMessageNotification,children:(0,U.jsx)(e0.ZP,{scrollContainer:this.state.messagesContainerRef,direction:e3.cU.Top,fetchDistance:100,endpointApiRequest:this.apiHelper.getConversation(this.props.conversationWindowObject),getObjectsFromResponse:this.getMessagesFromResponse,getNextLink:this.getNextLinkFromResponse,onPaginationError:this.onPaginationError,onPagination:this.onPagination,initialLoader:(0,U.jsx)(tT.a,{}),loader:this.renderPaginatorLoader(),children:this.renderPaginatorContent,errorView:this.renderPaginatorErrorView()})})),l()(this,"getMessagesFromResponse",e=>q.Z.parseConversationInfoFromResponse(e).conversation.messages.data),l()(this,"getNextLinkFromResponse",,l()(this,"onPaginationError",e=>{var t=e.error;404===t.status?this.setState({isNewConversation:!0,hasFetchedFullConversationHistory:!0}):this.setResponseErrorCode(t)}),l()(this,"setResponseErrorCode",e=>{var t=e.status,s=e.detailedErrors,a=t&&s.length&&s[0].code?`.${s[0].code}`:"",r=`${t}${a}`;this.setState({responseErrorCode:r})}),l()(this,"onPagination",t=>{var s,a=t.nextLink,n=t.requestType,i=t.response,l=this.props,h=l.conversationWindowObject.selectedBlogName,d=l.pollerContext.rerequestPoll,c=this.state.otherParticipant,u=q.Z.parseConversationInfoFromResponse(i,h);this.setState(o()(o()({},u),{},{otherParticipant:o()(o()({},c),u.otherParticipant),hasFetchedFullConversationHistory:!(null!=a&&null!==(s=a.href)&&void 0!==s&&s.length)}),function(){return r()().async(function(t){for(;;)switch(t.prev=t.next){case 0:if(n!==e3.vO.Initial){t.next=5;break}return d(),t.next=4,r()().awrap(e.establishTelegraphConnection());case 4:e.onConversationLoaded(u.conversation.participants);case 5:case"end":return t.stop()}},null,null,null,Promise)})}),l()(this,"renderPaginatorContent",e=>{var t=e.objects,s=e.refresh,a=e.transformObjects;this.transformPaginatorMessages=a,this.refreshConversation=s;var r=this.state,n=r.isNewConversation,o=r.conversation,i=r.otherParticipant,l=r.selectedBlog,h=r.responseErrorCode,d=r.hasFetchedFullConversationHistory;if(!(l&&i)||h)return null;var c=!!i&&!i.isActive,u=(null==o?void 0:o.participants)||[l,i],g=!!n||!o||o.isBlurredImages;return(0,U.jsxs)("div",{children:[d&&(0,U.jsx)(tN,{otherParticipant:i,selectedBlog:l,isNewConversation:n}),!!t.length&&(0,U.jsx)(eQ,{messages:t,participants:u,isBlurredImages:g,selectedBlog:l}),this.renderMarkAsSpamContent(),(0,ea.k)(i.secondsSinceLastActivity)&&this.renderOnlineIndicator(),c&&(0,U.jsx)(tp,{})]})}),l()(this,"renderPaginatorErrorView",()=>{var e=this.state,t=e.otherParticipant,s=e.responseErrorCode;return t?s?(0,U.jsx)(tu,{responseErrorCode:s,otherParticipant:t,refreshConversation:this.refreshConversation}):null:(0,U.jsx)(tT.a,{})}),l()(this,"unreadMessagesOnClick",,l()(this,"hideUnreadMessageNotification",,l()(this,"setNoUnreadMessages",()=>!!this.state.numUnreadMessages&&this.setState({numUnreadMessages:0})),l()(this,"renderOnlineIndicator",()=>{var e=this.state.otherParticipant,t={textColor:tn.paletteTransparentBlack60};return(0,U.jsx)("div",{className:tR.statusIndicator,children:(0,U.jsx)(g.Z,o()({secondsSinceLastActivity:null==e?void 0:e.secondsSinceLastActivity},t))})}),l()(this,"renderMarkAsSpamContent",()=>{var e=this.state,t=e.otherParticipant,s=e.isMarkAsSpamModalOpen,a=e.conversation,r=this.props.appContext._t;return t&&(0,U.jsxs)(U.Fragment,{children:[(null==a?void 0:a.isPossibleSpam)&&(0,U.jsx)(tk,{onClickMarkAsSpam:this.toggleIsMarkAsSpamModal}),s&&(0,U.jsx)(p.Z,{onGlassClick:this.toggleIsMarkAsSpamModal,glassIsClickable:!1,isAboveOverlays:!0,children:(0,U.jsx)(D.O,{title:r("Mark conversation as spam?"),body:r("%1$s will be blocked and reported, and any trace of this conversation will disappear from your messages.",[t.name]),buttons:[{text:r("Nevermind"),onClick:this.toggleIsMarkAsSpamModal,buttonStyle:D.X.Neutral},{text:r("Flag and block"),onClick:this.markChatParticipantAsSpam,buttonStyle:D.X.Cancel}]})})]})}),l()(this,"markChatParticipantAsSpam",()=>{var e=this.getConversationId();return this.state.selectedBlog&&e?this.apiHelper.flagConversation(e9.b.SPAM,this.state.selectedBlog.name,e).fetch().then(this.deleteConversation):Promise.resolve()}),l()(this,"toggleIsMarkAsSpamModal",()=>this.setState(e=>({isMarkAsSpamModalOpen:!e.isMarkAsSpamModalOpen}))),l()(this,"closeConversation",()=>{var e=this.props,t=e.conversationWindowObject,s=t.selectedBlogName,a=t.otherParticipantName,r=e.messagingContext;null==r||r.closeConversationWindow({selectedBlogName:s,otherParticipantName:a,conversationId:this.getConversationId()})}),l()(this,"minimizeConversation",()=>{var e=this.props,t=e.conversationWindowObject,s=t.selectedBlogName,a=t.otherParticipantName,r=t.messageText,n=t.messageImage,i=e.messagingContext,l=this.state.otherParticipant,h={selectedBlogName:s,otherParticipantName:a,avatar:l?l.avatar:void 0,conversationId:this.getConversationId(),messageText:r,messageImage:n},d=this.newMessageData,c=d.messageText,u=d.messageImage;h=o()(o()(o()({},h),c&&{messageText:c}),u&&{messageImage:u}),null==i||i.minimizeConversationWindow(h)}),l()(this,"updateMessageText",e=>{this.newMessageData=o()(o()(o()({},this.props.conversationWindowObject),this.newMessageData),{},{messageText:e})}),l()(this,"updateMessageImage",e=>{this.newMessageData=o()(o()(o()({},this.props.conversationWindowObject),this.newMessageData),{},{messageImage:e})}),l()(this,"resetNewMessageData",()=>{var e,t=o()(o()({},this.props.conversationWindowObject),{messageText:void 0,messageImage:void 0});this.newMessageData=t,null===(e=this.props.messagingContext)||void 0===e||e.onConversationUpdated(t)}),l()(this,"setFooterHeight",,l()(this,"onSubmitMessage",e=>{var t=e.text,s=e.image;if(!this.state.selectedBlog||!this.state.selectedBlog.uuid)return Promise.resolve();var a=this.state.selectedBlog.uuid,r=s?null!=s&&s.file?{imageFile:s.file,images:[{altSizes:s.media,originalSize:s.media[0]}]}:{context:eo.b.GIF,attribution:s.attribution,post:{type:s.type,content:[s]}}:{};return s&&s.file&&(0,tt.du)(s.file)?(this.markMessageCouldNotSend(o()(o()({participant:a},r),{},{type:eo.C.Image,pendingTs:Date.now().toString()})),t&&this.markMessageCouldNotSend({participant:a,type:eo.C.Text,pendingTs:Date.now().toString(),content:{text:t,formatting:[]}}),Promise.resolve()):(s?this.submitNewMessage(o()(o()({participant:a},r),{},{type:s.file?eo.C.Image:eo.C.Post,pendingTs:Date.now().toString()})):Promise.resolve()).then(()=>t?this.submitNewMessage({participant:a,type:eo.C.Text,pendingTs:Date.now().toString(),content:{text:t,formatting:[]}}):Promise.resolve())}),l()(this,"submitNewMessage",(e,t)=>{this.updatePaginatorMessagesStateWithNewMessages([e],t),this.scrollToBottom();var s=this.getConversationId();return this.apiHelper.sendMessage(e,this.submitNewMessageGetParticipants(s)).fetch().then(.catch(}),l()(this,"submitNewMessageGetParticipants",e=>{var t=this.state,s=t.conversation,a=t.isNewConversation,r=t.selectedBlog,n=t.otherParticipant;return{conversationId:e,participants:a?null!=r&&r.uuid&&null!=n&&n.uuid?[r.uuid,n.uuid]:[]:((null==s?void 0:s.participants)||[]).flatMap(e=>e.uuid?[e.uuid]:[])}}),l()(this,"submitNewMessageUpdateConversationFromResponse",(e,t)=>{var s,a=this.state.isNewConversation;null===(s=this.transformPaginatorMessages)||void 0===s||s.call(this,s=>{var r=s.filter(t=>t.pendingTs!==e.pendingTs);return this.setState({isNewConversation:!1,token:t.token,conversation:t},()=>a&&this.establishTelegraphConnection()),(0,ta.YC)(r,t.messages.data)})}),l()(this,"submitNewMessageErrorHandler",(e,t)=>{var s;return[403,428,413].includes(t.status)?this.markMessageCouldNotSend(e):null===(s=this.transformPaginatorMessages)||void 0===s?void 0:s.call(this,this.markPendingMessagesRetryable)}),l()(this,"markMessageCouldNotSend",e=>{var t;return null===(t=this.transformPaginatorMessages)||void 0===t?void 0:t.call(this,t=>(0,ta.YC)(t.filter(,[o()(o()({},e),{},{couldNotSend:!0,canRetry:!1,isRetrying:!1,isPending:!1})]))}),l()(this,"markPendingMessagesRetryable",e=>e.map(e=>(e.pendingTs&&(e.canRetry=!0,e.isRetrying=!1,e.isPending=!1),e))),l()(this,"updatePaginatorMessagesStateWithNewMessages",(e,t)=>{var s;return null===(s=this.transformPaginatorMessages)||void 0===s?void 0:s.call(this,s=>{if(e.some(e=>this.messageIsNotFromSelectedBlog(e)&&!t&&!this.isScrolledFromBottom(0))){var a,r=null===(a=this.state.messagesContainerRef)||void 0===a?void 0:a.scrollTop,n=this.isScrolledFromBottom(tA);this.setState(e=>o()(o()({},n?{numUnreadMessages:e.numUnreadMessages}:{showUnreadMessageNotification:!0,numUnreadMessages:e.numUnreadMessages+1}),{},{responseErrorCode:void 0}),()=>n?this.scrollToBottom():r&&this.scrollTo(r))}var i=t?s.filter(:s;return(0,ta.YC)(i,e)})}),l()(this,"establishTelegraphConnection",function(){var t,s,a;return r()().async(function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state.token,s=e.props.messagingContext,!(!t||!s)){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,r()().awrap(s.getPusherConnection(t));case 6:(a=n.sent)&&!e.channel&&(a.connection.bind("state_change",t=>{var s=t.previous;switch(t.current){case"unavailable":e.hasPossiblyMissedSomeMessages=!0;break;case"connected":e.fetchForMessagesSinceLastTelegraphMessage();break;case"connecting":"connected"===s&&(e.hasPossiblyMissedSomeMessages=!0)}}),e.startListeningToChannel());case 8:case"end":return n.stop()}},null,null,null,Promise)}),l()(this,"fetchForMessagesSinceLastTelegraphMessage",function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.hasPossiblyMissedSomeMessages||t?e.apiHelper.getConversation(e.props.conversationWindowObject,{after:e.mostRecentTelegraphTs}).fetch().then(e.getMessagesFromResponse).then(e.updatePaginatorMessagesStateWithNewMessages).then(()=>{e.hasPossiblyMissedSomeMessages=!1}).catch(:Promise.resolve()}),l()(this,"startListeningToChannel",function(){var t,s,a,n,o,i;return r()().async(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=(s=e.state).conversation,n=s.selectedBlog,o=s.token,i=e.props.messagingContext,!(o&&a&&n&&i)){l.next=8;break}return l.next=5,r()().awrap(i.getPusherConnection(o));case 5:l.t0=l.sent.subscribe(`private-messaging-${a.id}-${(0,te.Z)(n.name)}`),l.next=9;break;case 8:l.t0=null;case 9:e.channel=l.t0,null===(t=e.channel)||void 0===t||t.bind("message:new",e.onChannelNewMessage);case 11:case"end":return l.stop()}},null,null,null,Promise)}),l()(this,"onChannelNewMessage",e=>{var t=this.props,s=t.appContext.getUserInfo,a=t.conversationWindowObject,r=a.selectedBlogName,n=a.conversationId,o=(0,e7.l)(e);this.hasPossiblyMissedSomeMessages||(this.mostRecentTelegraphTs=o.ts),this.messageIsNotFromSelectedBlog(o)&&r&&n&&(s().then(,this.apiHelper.markConversationAsRead(r,n).fetch()),this.updatePaginatorMessagesStateWithNewMessages([o])}),l()(this,"messageIsNotFromSelectedBlog",e=>this.state.selectedBlog&&e.participant!==this.state.selectedBlog.uuid),l()(this,"renderPaginatorLoader",()=>(0,U.jsx)("div",{className:tR.paginationLoader,children:(0,U.jsx)(v.Z,{centerOrientation:"horizontal",small:!0,color:tn.paletteGray65})})),l()(this,"areParticipantsLoaded",()=>!!this.state.selectedBlog&&!!this.state.otherParticipant),l()(this,"onConversationLoaded",e=>{var t,s=this.props,a=s.conversationWindowObject,r=a.selectedBlogName,n=a.otherParticipantName,o=s.messagingContext;null==o||null===(t=o.onConversationLoaded)||void 0===t||t.call(o,{selectedBlogName:r,otherParticipantName:n,conversationId:this.getConversationId()},e)}),l()(this,"getConversationId",()=>{var e;return(null===(e=this.state.conversation)||void 0===e?void 0:e.id)||this.props.conversationWindowObject.conversationId}),l()(this,"fetchParticipantBlogInfo",function(){var t,s,a,n;return r()().async(function(o){for(;;)switch(o.prev=o.next){case 0:return t=[],s=void 0,o.prev=2,o.next=5,r()().awrap(e.getUserInfo());case 5:t=(a=o.sent).userBlogs,s=a.selectedBlog,o.next=14;break;case 10:return o.prev=10,o.t0=o.catch(2),e.closeConversation(),o.abrupt("return");case 14:return n=void 0,o.prev=15,o.next=18,r()().awrap(e.getOtherParticipant());case 18:n=o.sent,o.next=25;break;case 21:return o.prev=21,o.t1=o.catch(15),e.setState({selectedBlog:s,userBlogs:t}),o.abrupt("return");case 25:e.setState({selectedBlog:s,otherParticipant:n,userBlogs:t},()=>s&&n&&e.onConversationLoaded([s,n]));case 26:case"end":return o.stop()}},null,null,[[2,10],[15,21]],Promise)}),l()(this,"getUserInfo",()=>{var e;return null===(e=this.userInfoFetch)||void 0===e||e.cancel(),this.userInfoFetch=(0,ts.Z)(this.props.appContext.getUserInfo()),this.userInfoFetch.then(e=>({userBlogs:e.blogs,selectedBlog:(0,to.$)(e,this.props.conversationWindowObject.selectedBlogName)}))}),l()(this,"getOtherParticipant",()=>{var e;return null===(e=this.blogInfoFetch)||void 0===e||e.cancel(),this.blogInfoFetch=(0,ts.Z)(this.apiHelper.getBlogInfo(this.props.conversationWindowObject.otherParticipantName,(0,e8.n9)([...e6.O7,...tx,"isActive"])).fetch()),this.blogInfoFetch.then(}),l()(this,"scrollToBottom",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";return e.state.messagesContainerRef&&e.scrollTo(e.state.messagesContainerRef.scrollHeight,t)}),l()(this,"scrollTo",function(t){var s,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";return null===(s=e.state.messagesContainerRef)||void 0===s||null===(a=s.scrollTo)||void 0===a?void 0:a.call(s,{top:t,behavior:r,left:0})}),l()(this,"cancelRequestsIfNecessary",()=>{var e,t,s;null===(e=this.deleteConversationRequest)||void 0===e||e.cancel(),null===(t=this.userInfoFetch)||void 0===t||t.cancel(),null===(s=this.blogInfoFetch)||void 0===s||s.cancel()})}omponentWillUnmountender(){if(this.state.redirect)return(0,U.jsx)(u.Fg,{to:e2.o_.messaging,replace:!0});var e,t=this.props.deviceContext.isMobile,s=d()(tR.conversation,{[tR.isLoading]:!this.areParticipantsLoaded(),[tR.isMobile]:t});return(0,U.jsxs)(b,{value:this.contextValue,children:[t&&(0,U.jsx)(m.Z,{overflow:"hidden"}),(0,U.jsxs)("div",{className:s,"data-skip-glass-focus-trap":"1",children:[t?(0,U.jsx)("div",{className:tR.headerBufferForMobile}):this.renderHeader(t),(0,U.jsx)("div",{className:tR.messages,ref:this.setMessagesContainerRef,children:this.renderMessages()}),t&&this.renderFooterBufferForMobile(),t&&this.renderHeader(t),this.renderUnreadMessageNotification(),this.renderFooter()]}),(0,U.jsx)(tE,{fetchForMessagesSinceLastTelegraphMessage:this.fetchForMessagesSinceLastTelegraphMessage,conversationId:(null===(e=this.state.conversation)||void 0===e?void 0:e.id)||this.props.conversationWindowObject.conversationId})]})}renderFooterBufferForMobile(){var e=this.state.footerHeightInPx;return e&&(0,U.jsx)("div",{"data-testid":e,style:{minHeight:e}})}renderUnreadMessageNotification(){var e=this.state,t=e.showUnreadMessageNotification,s=e.numUnreadMessages,a=e.footerHeightInPx;return(0,U.jsx)(tB,{shouldShow:!!t,numUnreadMessages:s,footerHeightInPx:a,onExited:this.setNoUnreadMessages,onClick:this.unreadMessagesOnClick})}renderFooter(){var e=this.props.conversationWindowObject,t=e.messageText,s=e.messageImage,a=this.state,r=a.otherParticipant,n=a.userBlogs,o=a.selectedBlog;return n&&o&&null!=r&&r.theme?(0,U.jsx)(V,{theme:r.theme,isDisabled:this.isFooterDisabled(),userBlogs:n,otherParticipant:r,selectedBlog:o,closeConversation:this.closeConversation,onClickMarkAsSpam:this.toggleIsMarkAsSpamModal,onSubmitMessage:this.onSubmitMessage,setFooterHeight:this.setFooterHeight,messageText:t,messageImage:s,updateMessageText:this.updateMessageText,updateMessageImage:this.updateMessageImage,resetNewMessageData:this.resetNewMessageData}):null}isFooterDisabled(){var e=this.state,t=e.isNewConversation,s=e.conversation;return!!e.responseErrorCode||!t&&this.areParticipantsLoaded()&&!!s&&!s.canSend}isScrolledFromBottom(e){var t=this.state.messagesContainerRef;return!!t&&t.scrollTop+t.offsetHeight>=t.scrollHeight-e}}let tD=(0,A.X9)(tZ,{appContext:!0,deviceContext:!0,pollerContext:!0,messagingContext:!0})},17144:(e,t,s)=>{s.d(t,{I:()=>r});var a=s(68782);,48352:(e,t,s)=>{s.d(t,{Z:()=>v});var a=s(54138),r=s.n(a),n=s(33970),o=s.n(n),i=s(95004),l=s(78994),h=s(55673),d=s(43523),c=s(22424),u=s(12736),g=s(14544),m=s(78667);let p=e=>{var t=(0,m.bp)().logEvent,s=(0,l.TH)().pathname,a=(0,h.lr)(),n=o()(a,1)[0];(0,i.useEffect)(()=>{"embed"===n.get("source")&&t({pathname:s,eventName:d.J.EmbedPostClick,eventDetails:r()(r()({},e),{},{refUrl:n.get("refUrl"),action:n.get("action")})})},[])},v=e=>{var t=e.page,s=e.eventDetails,a=(0,c.wL)().logEvent,n=(0,l.TH)().pathname,m=(0,h.lr)(),v=o()(m,1)[0],f=(0,g.M)().name,b=(0,u.z)(),w=b.isModalShowing,x=b.isPeeprShowing,C=(0,i.useRef)(w||x),M=v.get("source"),y=()=>a({page:t,pathname:n,eventName:d.J.ScreenView,eventDetails:r()(r()({pathname:n,referrer:document.referrer,color_palette:f},M&&{source:M}),s)});return(0,i.useEffect)([n,t]),(0,i.useEffect)(()=>{!C.current||w||x||y(),C.current=w||x},[C,w,x]),p(),null}},9557:(e,t,s)=>{s.d(t,{Z:()=>d});var a=s(54138),r=s.n(a),n=s(50209),o=s.n(n),i=s(95004),l=s(53714),h=s(2629);class d extends i.Component{constructor(){super(...arguments),o()(this,"state",{isOpen:!1}),o()(this,"toggle",}render(){return(0,h.jsx)(l.ZP,r()(r()({isOpen:this.state.isOpen,toggle:this.toggle},this.props),{},{children:this.props.children}))}}},5553:(e,t,s)=>{s.d(t,{n:()=>r});var a=s(32415);10131:(e,t,s)=>{s.d(t,{C:()=>a,b:()=>o});var a={}),r=function(e){return e.Active="ACTIVE",e.Inactive="INACTIVE",e}(r||{}),n=n||{}),o={})},399:(e,t,s)=>{s.d(t,{$G:()=>h,F5:()=>r,MM:()=>n,Pk:()=>a,Qe:()=>d,X:()=>g,ed:()=>u,gz:()=>m,iI:()=>c,m1:()=>l,qg:()=>o});var a=e=>[e("Something went screwy."),e("Something's busted."),e("Something got snagged."),e("Something's acting up."),e("Something sucks!"),e("Internet is being dumb."),e("Computer weirdness."),e("The server is being foolish."),e("Something fizzled."),e("The internet evaporated."),e("The internet is being wiggly."),e("Something went splat."),e("Server turned to dust."),e("Something's wonky."),e("Something's not happening."),e("Something's not working."),e("Something got messed up."),e("Unknown, totally annoying error."),e("A nameless error mysteriously occurred."),e("Our computer is a loser."),e("Something pooped out."),e("Something fell into a volcano."),e("Something is all gummed up."),e("Something melted.")],r=e=>[e("The message displayed when there are no results.","Nothing turned up. Bummer."),e("The message displayed when there are no results.","Looked around but didnt see anything about that."),e("The message displayed when there are no results.","Sadly, nothing."),e("The message displayed when there are no results.","Tragically, nothing."),e("The message displayed when there are no results.","Welcome to the void. There is nothing here."),e("The message displayed when there are no results.","We found nothing. Here it isnt."),e("The message displayed when there are no results.","Couldnt find that. Please, dont be upset. Please."),e("The message displayed when there are no results. A joke like the end of a written letter.","Sincerely, we found nothing."),e("The message displayed when there are no results.","Nothing to see here."),e("The message displayed when there are no results.","This? Here? Yeah, nothing."),e("The message displayed when there are no results.","If you were looking for nothing, congrats, you found it."),e("The message displayed when there are no results.","Remember: The internet is a series of tubes. Empty, empty tubes.")],n=e=>[e("Meditate for a while on this empty Tumblr."),e("This Tumblr is cool, but empty."),e("This minimalist Tumblr has no posts."),e("Posts? Nah."),e("This Tumblr is content-free.")],o=(e,t,s)=>[e("This post isn't here anymore, but the Tumblr still is."),t("Error message for missing post. Placeholder is a blog name.","This post is gone, gone, gone. But there's more, more, more, on %1$s's Tumblr.",[s]),t("Error message for missing post. Placeholder is a blog name.","Ghost post! Spooky. See what else is haunting %1$s's Tumblr.",[s]),e("You're too late. This post is no more."),e("This post has ceased to exist."),e("This post went to heaven.")],i=e=>[e("The message displayed when there are no search results.","Maybe you spelled it wrong?"),e("The message displayed when there are no search results.","Your search returned nothing, nothing, nothing."),e("The message displayed when there are no search results.","Maybe try a similar search but use different words? Dunno."),e("The message displayed when there are no search results.","Aw, we dont have anything about that. Sorry."),e("The message displayed when there are no search results.","That search was weird and we didnt really get it."),e("The message displayed when there are no search results.","That search was amazing, but the world just isnt r[...r(e),...i(e)],h=(e,t)=>[e("Error message for empty search text. Placeholder is the search text.","No posts for %1$s",[t]),e("Error message for empty search text. Placeholder is the search text.","This Tumblr is cool, but empty for %1$s",[t]),e("Error message for empty search text. Placeholder is the search text.","This Tumblr is content-free for %1$s",[t])],d=e=>[e("No search result found for message recipients","That isn't anyone."),e("No search result found for message recipients","Uh, who?"),e("No search result found for message recipients","Huh what?"),e("No search result found for message recipients","Never heard of 'em."),e("No search result found for message recipients","???"),e("No search result found for message recipients","Eh?"),e("No search result found for message recipients","Whaaa?")],c=e=>{var t=[e("Error message when a user tries to tip themself","Really...?"),e("Error message when a user tries to tip themself","Cheatin' uh?"),e("Error message when a user tries to tip themself","It looks like you're trying to launder money, not that i know what that means!"),e("Error message when a user tries to tip themself","You deserve great things. But not like this."),e("Error message when a user tries to tip themself","Mission impossible"),e("Error message when a user tries to tip themself","That would be counter productive."),e("Error message when a user tries to tip themself","nope.gif")];return t[Math.floor(Math.random()*t.length)]},u=e=>{var t=[e("[TumblrMart] Text describing what one thinks about when they remember crabs","a salty summer breeze"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","drawn butter and a squirt of lemon juice"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","the turning of the tides"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","eurphoric sunsets on the beach"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","the sound of tiny waves splashing on the sand"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","the many waves that flow through clouds and sunken caves"),e("[TumblrMart] Text describing what one thinks about when they remember crabs","the color of the sky")];return t[Math.floor(Math.random()*t.length)]},g=e=>[e("Post form crash","A wild tumbeast ate your post! Sorry about that - we'll try to rein this one in!"),e("Post form crash","Your post was too out of this world and crashed the editor!"),e("Post form crash","Our editor is not cool enough (yet) to handle your post!")],m=e=>{var t=[e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","the burdens of a life well lived"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","the rich smell of leather"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","arriving at a destination on the back of my best friend"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","strong galloping sounds"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","kisses from a big, wet mouth"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","secret confessions that are only uttered at death's door"),e("[TumblrMart] Text describing what one thinks about when they remember Horse Friend","an autumn walk through a cemetery")];return t[Math.floor(Math.random()*t.length)]}},95867:(e,t,s)=>{s.d(t,{ZP:()=>u,jx:()=>d,n5:()=>c});var a=s(33970),r=s.n(a),n=s(95004),o=s(5553),i=s(44561),l=s(49116),h="lastSelectedBlog",d=e=>{var t;try{t=JSON.parse(l.E.getItem(h)||"null")}catch(e){}return null==e?void 0:e.find(e=>{var s;return e.uuid===(null===(s=t)||void 0===s?voON.stringify(e))};let u=()=>{var e=(0,n.useState)(),t=r()(e,2),s=t[0],a=t[1],l=(0,o.n)().data;return(0,n.useEffect)(()=>{var e=d(l||[]),t=(0,i.Z)(l||[]);a(e||t)},[l]),{selectedBlog:s,onCog:e=>{a(e),c(e)}}}},68859:(e,t,s)=>{s.d(t,{Z:()=>a});let a=e=>{if(!e)return!1;try{t=new URL(e)}catch(e){return!1}var t,s=t.hostname;return"safe.txmblr.com"===s||/(?:^tumblr|\.tumblr)\.(?:com|net)$/.test(s)}},60042:(e,t,s)=>{s.d(t,{Ev:()=>o,ag:()=>i,bG:()=>l,oL:()=>n});var a=s(94576),r=s(68859);function n(e,t){var s,n=a=>{var n=function(e){var t,s=e.origin,a=e.source,n=e.data;if(!(n&&s&&a)||!(0,r.Z)(s))return null;try{t=JSON.parse(n)}catch(e){return null}if(!t.method)return null;var o=t.method.match(/^([^:]+):(.+)$/);if(!o)return null;var i=o[1],l=o[2],h=t.args[0];return{origin:s,namespace:i,name:l,source:a,cid:t.cid,data:h}}(a);if(n&&n.namespace===e){if("_syn"===n.name){s={namespace:e,source:n.source,origin:n.origin},function(e,t,s,a){var r=JSON.stringify({method:`${s}:_method_callback_responder`,args:[a]});e.postMessage(r,t)}(n.source,n.origin,e,{response:"ack",cid_response:n.cid});return}t[n.name]&&t[n.name](n.data)}};return(0,a.Rr)("message",n),{handler:n,getCoQ)("message",e)}var i={listen:n,unlisten:o};function l(e,t,s){var a=e.source,r=e.target,n=e.namespace,o=JSON.stringify({method:`${n}:${t}`,args:[s]});a.postMessage(o,r)}},68868:(e,t,s)=>{s.d(tstate||!!e.isNsfw},59379:(e,t,s)=>{s.d(t,{h:()=>r});var a=s(22979),r=e=>{var t=e.editablePost,s=e.isReblog,r=e.isReblogWithPaywall,n=e.isInbox,o=e.isAsk,i=e.isPrefilledPost,l=e.isReblogWithPoll;return!!(null!=t&&t.isBlocksPostFormat||s&&t&&(0,a.WN)(t))||!!l||!!r||!!o||null!=t&&!!t.isAdFreeGiftAsk||null!=t&&!!t.isTumblrmartGiftAsk||!!n&&!(null!=t&&t.isSubmission)||!!i}},8737:(e,t,s)=>{s.d(t,{Ly:()=>i,Tf:()=>n,r9:()=>o});var a=s(49116),r="reblogPostData",n=(e,t)=>{try{var s=a.E.getItem(r);if(s){var n=JSON.parse(s),o=n.postId,l=n.placementId,h=n.isLongPost,d=n.tabId;if(e!==o)return i(),{placementId:t};return{placementId:l,isLongPost:h,tabId:d}}return{placementId:t}}catch(e){return{placementId:t}}},o=(e,t,s,n)=>{try{a.E.setItem(r,JSON.stringify({postId:e,placementId:t,isLongPost:s,tabId:nem(r)}catch(e){}}},82560:(e,t,s)=>{s.d(t,{fE:()=>r});var a=s(59379),r=e=>{var t=e.isMobile,s=e.features,r=s.redpopDesktopEditorBeta,n=s.legacyEditorAccess,o=e.editablePost,i=e.isReblog,l=e.isReblogWithPaywall,h=e.isInbox,d=e.isAsk,c=e.isPrefilledPost,u=e.isReblogWithPoll,g=e.isPremiumPartner;return!(0,a.h)({editablePost:o,isReblog:i,isReblogWithPaywall:l,isAsk:d,isInbox:h,isPrefilledPost:c,isReblogWithPoll:u})&&(null!=o&&!!o.shouldOpenInLegacy||!t&&!!(n||g)&&!r)}},20318:(e,t,s)=>{sZP:()=>d,gO:()=>l});var a=s(17276),r=s.n(a),n=s(50209),o=s."send_aim.mp3",e}(l||{});function h(e){return new Audio(new URL(e,"https://assets.tumblr.com/sounds/notifications/messaging/").toString())}let d=new class{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;o()(this,"cachedAudioElements",{}),this.fetch=e}play(e,t){var s,a=this;return r()().async(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(e.sounds&&e.sounds.global.web)){r.next=3;break}return s=a.cachedAudioElements[t]||a.fetchAndCacheAudio(t),r.abrupt("return",null==s?void 0:s.play().catch(i.Z));case 3:case"end":return r.stop()}},null,null,null,Promise)}fetchAndCacheAudio(e){return this.cachedAudioElements[e]=this.fetch(e)}}}}]);