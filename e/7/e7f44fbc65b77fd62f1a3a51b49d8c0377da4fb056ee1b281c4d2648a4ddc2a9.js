(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[565],{YQN1:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("fFwu");function r(e,t){return Object(i.initializeFluentTheme)(t.fluentThemeSubscription),e.bootstrapOfficeStart()}},bmzq:function(e,t,n){"use strict";var i=n("mXGw"),r=n("xARA"),o=function(){eturn e.prototype.ngOnInit=e.prototype.render=function(){var e=this;return this.onRenderPromise=new Promise((function(t){i&&r?e.getReactElement().then((function(n){return!e.destroyed&&(e.rendered=!0,r.render(n,e.getTargetElementRef().nativeElement,t))})):t()})),this.onRenderPromise},e.prototype.ngOnDestroy=function(){i&&r&&(this.destroyed=!0,this.rendered&&r.unmountComponentAtNode(this.target.nativeElement))},e.prototype.getTargetElementRef=e}();t.a=o},dqLy:function(e,t,n){"use strict";n.r(t),n.d(t,"InstallReactModuleNgFactory",(function(){return F}));var i=n("keVe"),r=(n("H0tC"),n("hhzZ"),function(){return function(){}}()),o=r,s=),l=n("QjXU"),a=n("N9Jb"),u=n("dL/1"),c=n("M21c"),h=n("mXGw"),p=n("zvoD"),m=n("y3b+"),f=n("YQN1"),b=n("9WrL"),d=n("bmzq"),v=n("6nG3"),g=n("7Gwk"),C=n("w1PR"),S=n("4/We"),w=n("cgnd"),y=n("LQqy"),D=n("fVt+"),I=n("Hp80"),k=n("vSs+"),O=function(e){function t(t,n,i,r,o,s,l,a,u,c,h){var p=e.call(this,t)||this;return p.capabilitiesService=n,p.consumerInstallConfigService=i,p.consumerPublicDataService=r,p.eventService=o,p.installConfigService=s,p.officeStartBootstrapperService=l,p.startupConfigService=a,p.themingService=u,p.upsellDataService=c,p.userConsentConfigService=h,p.showConsumerUpsell=!1,p.launchDime=void 0,Object(f.a)(p.officeStartBootstrapperService,p.themingService),p}return Object(l.__extends)(t,e),t.prototype.ngOnInit=function(){var t=this;this.startupConfigService.config.authType===w.a.MSA&&(this.capabilitiesService.capabilities.workloadPublicDataEnabled?Promise.all([this.consumerPublicDataService.getConfig(),this.consumerInstallConfigService.getConfig()]).then((function(e){var n=Object(l.__read)(e,2);t.initializeConsumerInstallInfo(n[1],n[0].hasBusinessLicense)})).catch(this.initializeConsumerInstallInfo):this.consumerInstallConfigService.getConfig().then(()),e.prototype.ngOnInit.call(this)},t.prototype.ngOnDestroy=t.prototype.getReactElement=function(){return Object(l.__awaiter)(this,void 0,void 0,(function(){return Object(l.__generator)(this,(function(e){return h?[2,h.createElement(c.a,{className:"install-provider"},h.createElement(a.a,null,h.createElement(u.a,{appFilter:this.appFilter,componentArea:this.componentArea,showInstallButton:this.showInstallButton,showConsumerUpsell:this.showConsumerUpsell,showConsumerInstallMenu:this.capabilitiesService.capabilities.installButtonReactMenuForConsumerEnabled,launchDime:this.launchDime})))]:[2,null]}))}))},t.prototype.initializeConsumerInstallInfo=function(e,t){var n=this;void 0===t&&(t=!1);var i=e&&e.currentSkuInfo?e.currentSkuInfo.skuType:v.b.NotDetected;return this.showConsumerUpsell=(i===v.b.NotSubscribed||i===v.b.NonActive)&&!t,this.installConfigService.config.dimeEnabled&&this.capabilitiesService.capabilities.userConsentCallEnabled&&this.showConsumerUpsell&&this.userConsentConfigService.getConfig().then((function(e){n.showConsumerUpsell=n.showConsumerUpsell&&0===e.userConsent,n.showConsumerUpsell&&(n.upsellDataService.warmupDime("buybutton"),n.upsellDataService.warmupDime("installbutton"),n.launchDime=function(e,t){n.installConfigService.config.dimeEnabled&&n.showConsumerUpsell&&n.upsellDataService.launchDime("InstallGoPremiumButton"===e?"installbutton":"buybutton",t)},n.subscribeToDimeEvents(),n.render())})),Promise.resolve()},t.prototype.subscribeToDimeEvents=function(){var e=this;this.convertedToPaidSubscription=this.eventService.events.withScope(1).pipe(Object(p.a)(()).subscribe(()},t.prototype.unsubscribeFromDimeEvents=t}(d.a),T=i.Fb({encapsulation:2,styles:[],data:{}});function E(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-install-react-content",[],null,null,null,null,null)),i.Gb(1,212992,null,0,O,[i.o,S.a,y.a,I.a,g.a,m.a,b.a,w.b,C.b,k.a,D.a],{componentArea:[0,"componentArea"],showInstallButton:[1,"showInstallButton"],appFilter:[2,"appFilter"]},null)],(,null)}var P=i.Db("ohp-install-react",r,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-install-react",[],null,null,null,E,T)),i.Gb(1,49152,null,0,r,[],null,null)],null,null)}),{componentArea:"componentArea",showInstallButton:"showInstallButton",appFilter:"appFilter"},{},[]),U=n("TOqr"),A=n("izKO"),B=n("CCRL"),F=i.Eb(s,[],(function(e){return i.Tb([i.Ub(512,i.k,i.hb,[[8,[P]],[3,i.k],i.D]),i.Ub(4608,U.m,U.l,[i.z]),i.Ub(1073742336,U.c,U.c,[]),i.Ub(1073742336,A.a,A.a,[]),i.Ub(1073742336,s,s,[]),i.Ub(256,B.a,o,[])])}))},fFwu:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeFluentTheme",(function(){return l})),n.d(t,"getOfficeStartThemeObservable",();var i,r=n("+fvi"),o=n("dpyN"),s=!1;function l(e){s||(s=!0,(i=e.withScope(0).pipe(Object(o.a)((function(e,t){return e.mode===t.mode&&e.overridePaletteMapping===t.overridePaletteMapping&&e.overrideTokenMapping===t.overrideTokenMapping&&e.themeId===t.themeId&&u(e.lightBrandColors,t.lightBrandColors)&&u(e.darkBrandColors,t.darkBrandColors)})))).subscribe((function(e){Object(r.d)(e,!1,!1)})))}unction u(e,t){return e===t||!(!e||!t)&&e.themeDark===t.themeDark&&e.themeDarkAlt===t.themeDarkAlt&&e.themeDarker===t.themeDarker&&e.themeLight===t.themeLight&&e.themeLighter===t.themeLighter&&e.themeLighterAlt===t.themeLighterAlt&&e.themePrimary===t.themePrimary&&e.themeSecondary===t.themeSecondary&&e.themeTertiary===t.themeTertiary}}}]);
//# sourceMappingURL=install-rc.f9be5cd59d495a39974a.chunk.v7.js.map