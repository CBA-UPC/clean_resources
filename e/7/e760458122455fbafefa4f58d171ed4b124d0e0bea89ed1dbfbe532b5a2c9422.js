(self.webpackChunkweb=self.webpackChunkweb||[]).push([[63339],{97538:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:);var i,o,r,n=t(67294),a=t(37974),p=t(70365),l=t.n(p),c=t(66601),u=t(94184),d=t.n(u),h=t(45318),m=t(72091),f=t.n(m);function b(e,s,t,i){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,n=arguments.length-3;if(s||0===n||(s={children:void 0}),1===n)s.children=i;else if(n>1){for(var a=new Array(n),p=0;p<n;p++)a[p]=arguments[p+3];s.children=a}if(s&&o)for(var l in o)void 0===s[l]&&(s[l]=o[l]);else s||(s=o||{});return{$$typeof:r,type:e,key:void 0===t?null:""+t,ref:null,props:s,_owner:null}}class g extends n.Component{losePopUp(){this.props.onClickOfCross()}nder(){const e=this.props.isEmailValid?"":b("div",{className:f().T10errMessage},void 0,this.props.errorMessageOnValidaton),s=this.props.successMessageOnSubmit?b("div",{className:f().T10successMessage},void 0,this.props.successMessageOnSubmit):"",t=1===this.props.popupView;return b("div",{className:d()({[f()[h.Jq]]:t,[`${f()["C19-sticky"]}`]:this.props.stickyView,[`${f()[h.LK]} eduhp-cv19`]:!t,[`${f()["T10-popUpActive"]}`]:this.props.withTransition,[f().rhs]:"RHS"===this.props.view,[f().home]:"HOME"===this.props.view})},void 0,b("div",{className:f().nlouterbox},void 0,(t||this.props.stickyView)&&b("span",{className:`${f().newsletter_wdtclose}`,onClick:this.closePopUp}),b("div",{className:f().virusImg},void 0,i||(i=b("img",{src:"https://static.toiimg.com/photo/74700451.cms",alt:"virus_logo"}))),b("div",{className:f().column},void 0,o||(o=b("h2",{},void 0,"the ",b("span",{},void 0,"CORONA "),"letter")),b("p",{className:f().top10text},void 0,"Covid-19 daily briefing")),b("div",{className:`${f().nlfooter} ${this.props.hideInputBox?f().noborder:""}`},void 0,!this.props.hideInputBox&&b(n.Fragment,{},void 0,b("p",{},void 0,b("input",{type:"text",value:this.props.emailValue,onChange:this.handleEmailTextBoxChange,placeholder:"Your email address",disabled:this.props.isSubscribed,"aria-label":"Your Email address",className:this.props.isSubscribed?f().disable:""})),!this.props.isSubscribed&&n.createElement(n.Fragment,null,b("p",{},void 0,b("input",{type:"button",className:f().submitbtn,onClick:this.onSubscribe,value:"subscribe",disabled:this.props.isSubscribed})),e)),s)))}}g.defaultProps={userData:void 0,popupView:0,onClickOfCross:null,onSubmit:null,isSubscribed:!1,isEmailValid:!0,onTextBoxChange:null,successMessageOnSubmit:"",emailValue:"",withTransition:!1,errorMessageOnValidaton:"",stickyView:!1,view:"",hideInputBox:!1};const w=g;var y=t(55518),v=t(49669);st E="covid19",T=`toi/covid19/${"SET_CORONA_LETTER_SUBSCRIPTION"}`;var x,V,k,I,P,U,D;Z.register(E,(function(e={},s={}){return s.type===T?C(C({},e),{},{is_Subscribed:s.paylaod}):e}));let N=(x=(0,y.GA)({category:h.p1,action:"covid19_newsletter-subscribe",label:"valid-<msid-url>"}),V=(0,y.GA)({category:h.p1,action:"covid19_newsletter-subscribe",label:"invalid-<msid-url>"}),k=(0,y.GA)({category:h.p1,action:h.b3}),I=(0,y.GA)({category:h.p1,action:h.vn}),P=(0,y.GA)({category:h.p1,action:h.vn}),A((U=class extends n.Component{constructor(e){super(e),this.IsValidEmailId=e=>{let s="";return/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,6})$/.test(e)&&(s=e),s},this.registerWithPopupManager=()=>{this.timesTop10PopUp=window.TimesApps.PopUpManager.registerPopup(this.moduleName,this.setStateConditionalFlow)},this.setWdtShowExpiryTimestamp=()=>{c.qQ(h.vd,`${this.getTimeStampAfterGivenDays(h.$R)}`)},this.setStateConditionalFlow=(e=this.stateCondition)=>{const s=c.$o(h.WZ);switch(e){case 1:case 4:this.setState({showTimesTop10:!0}),"function"==typeof this.props.onShowHideCallback&&this.props.onShowHideCallback(!0),this.setWdtShowExpiryTimestamp();break;case 2:this.setState({showTimesTop10:!0,emailValue:this.IsValidEmailId(s.emailId)?s.emailId:s.registeredEmailId}),"function"==typeof this.props.onShowHideCallback&&this.props.onShowHideCallback(!0),this.setWdtShowExpiryTimestamp();break;case 3:this.setState({emailValue:this.loginEmailId,showTimesTop10:!0,registeredEmailId:this.loginEmailId}),"function"==typeof this.props.onShowHideCallback&&this.props.onShowHideCallback(!0),this.setWdtShowExpiryTimestamp()}},this.getTimeStampAfterGivenDays=e=>{const s=new Date;return new Date(s.getTime()+24*e*60*60*1e3).getTime()},this.addUserEmailSubscription=(e,s)=>{l()(e,null,((e,t)=>{e?console.warn(e):t&&"Success"===t.Status&&("already verified user"===t.message.toLowerCase()?this.alreadyVerifiedUser(s):this.newUser(s),this.props.setSubscriptionStatus(!0),1===this.props.popupView&&setTimeout((,2e3))}))},this.removeExpiryObject=this.isCovid19Subscribed=e=>{let s=!1;for(let t=0;t<e.length;t+=1)if("1036"===e[t].ID){s=!0;break}return s},this.getInfo=e=>{l()(e,null,((e,s)=>{if(e)console.error(e.message);else if(s)if("Success"===s.Status)if(s.message&&s.message.NL_MAP&&s.message.NL_MAP.length>0&&this.isCovid19Subscribed(s.message.NL_MAP))this.setExpiryObject(!0,!1,s.message.E_ID,s.message.E_ID),this.props.setSubscriptionStatus(!0),this.props.setFallback(!0);else if(this.loginEmailId=this.props.userData.getEmail(),this.props.setSubscriptionStatus(!1),s.message&&s.message.E_ID&&(this.loginEmailId=s.message.E_ID),this.stateCondition=3,1!==this.props.popupView)this.setStateConditionalFlow(this.stateCondition);else{const e=this.timesTop10PopUp;this.activeClass=!0,e&&e.onReadyCallback(1)}else if(this.stateCondition=4,this.props.setSubscriptionStatus(!1),1!==this.props.popupView)this.setStateConditionalFlow(this.stateCondition);else{const e=this.timesTop10PopUp;this.activeClass=!0,e&&e.onReadyCallback(1)}}))},this.state={showTimesTop10:!1,isEmailValid:void 0,successMessageOnSubmit:"",errorMessageOnValidaton:"",emailValue:"",registeredEmailId:"",hideInputBox:!1},this.activeClass=!1,this.timesTop10PopUp=null,this.stateCondition=0,this.loginEmailId="",this.moduleName="covid19",this.onSubmit=this.onSubmit.bind(this),this.onClickOfCross=this.onClickOfCross.bind(this),this.onTextBoxChange=this.onTextBoxChange.bind(this)}componentDidMount(){window.TimesGDPR&&window.TimesGDPR.common.consentModule.gdprCallback&&window.TimesGDPR.common.consentModule.gdprCallback((e=>{if(!e.isEUuser){const e=c.$o(h.WZ);window.TimesApps&&window.TimesApps.PopUpManager&&this.props.popupView&&this.registerWithPopupManager(),this.props.userData&&this.props.userData.isLoggedIn?this.whenUserisLogin(e):this.props.userData&&!1===this.props.userData.isLoggedIn&&this.whenUserIsNotLogin(e)}}))}componentDidUpdate(e){const s=c.$o(h.WZ);this.props.userData&&!1===this.props.userData.isLoggedIn&&void 0===e.userData.isLoggedIn?this.whenUserIsNotLogin(s):this.props.userData&&this.props.userData.isLoggedIn&&void 0===e.userData.isLoggedIn&&this.whenUserisLogin(s)}onTextBoxChange(e){this.setState({emailValue:e.target.value,successMessageOnSubmit:"",errorMessageOnValidaton:""})}whenUserIsNotLogin(e){if(!e||e&&e.isExpired||1!==this.props.popupView&&e&&!e.isSubscribed)if(this.stateCondition=1,1!==this.props.popupView)this.setStateConditionalFlow(this.stateCondition);else{const e=this.timesTop10PopUp;this.activeClass=!0,e&&e.onReadyCallback(1)}1!==this.props.popupView&&e&&e.isSubscribed&&!1===e.isExpired&&this.props.setFallback(!0)}whenUserisLogin(e){if(e&&e.isExpired||1!==this.props.popupView&&e&&!e.isSubscribed)if(this.stateCondition=2,1!==this.props.popupView)this.setStateConditionalFlow(this.stateCondition);else{const e=this.timesTop10PopUp;this.activeClass=!0,e&&e.onReadyCallback(1)}else this.props.isSubscribed||((!e||e&&!e.isSubscribed&&e.isExpired)&&this.getInfo(`${h.ct}?id=${this.props.userData.getEmail()}`),1!==this.props.popupView&&e&&e.isSubscribed&&!1===e.isExpired&&this.props.setFallback(!0))}fireGaOnValidEmail(){return this}nSubmit(){const e=`?id=${this.state.emailValue}&frequency=1&scheduletime=1&status=1&nlid=1036&configid=74711134&subscriptionwithconfirmation=true&confirmationpage=timestopten`;this.IsValidEmailId(this.state.emailValue)?(this.fireGaOnValidEmail(),this.addUserEmailSubscription(`${h.Z1}${e}`,this.state.emailValue)):(this.fireGaOnInValidEmail(),this.setState({isEmailValid:!1,errorMessageOnValidaton:h.tX}))}alreadyVerifiedUser(e){this.setExpiryObject(!0,!1,e),this.setState({successMessageOnSubmit:h.iW})}newUser(e){this.setExpiryObject(!0,!1,e),this.setState({successMessageOnSubmit:h.bf,hideInputBox:!0})}onClickOfCross(){this.activeClass=!1,this.setExpiryObject(!!this.props.isSubscribed,!1,this.state.emailValue,this.state.registeredEmailId),this.props.isSubscribed&&this.props.setSubscriptionStatus(!0),this.setState({showTimesTop10:!1}),"function"==typeof this.props.onShowHideCallback&&this.props.onShowHideCallback(!1)}setExpiryObject(e,s,t,i=""){if(!c.$o(h.WZ)||e){const o={isSubscribed:e,timeStamp:this.getTimeStampAfterGivenDays(h.$R),isExpired:s,emailId:t,registeredEmailId:i};c.qQ(h.WZ,JSON.stringify(o))}}render(){if(!0===this.props.forceHide)return null;if(this.props.isPrivateUser)return null;const e=c.$o(h.WZ);let s=this.state.emailValue;if(this.props.isSubscribed&&(s=e.emailId),!this.state.showTimesTop10)return null;const t=this.timesTop10PopUp;return t&&this.state.showTimesTop10&&t.onShowCallback(!0),M(w,{onSubmit:this.onSubmit,userData:this.props.userData,withTransition:this.activeClass,emailValue:s,popupView:this.props.popupView,stickyView:this.props.stickyView,view:this.props.view,isSubscribed:this.props.isSubscribed,isEmailValid:this.state.isEmailValid,successMessageOnSubmit:this.state.successMessageOnSubmit,onTextBoxChange:this.onTextBoxChange,errorMessageOnValidaton:this.state.errorMessageOnValidaton,onClickOfCross:this.onClickOfCross,hideInputBox:this.state.hideInputBox,inUshome:!0})}}).prototype,"fireGaOnValidEmail",[x],Object.getOwnPropertyDescriptor(U.prototype,"fireGaOnValidEmail"),U.prototype),A(U.prototype,"fireGaOnInValidEmail",[V],Object.getOwnPropertyDescriptor(U.prototype,"fireGaOnInValidEmail"),U.prototype),A(U.prototype,"onSubmit",[k],Object.getOwnPropertyDescriptor(U.prototype,"onSubmit"),U.prototype),A(U.prototype,"alreadyVerifiedUser",[I],Object.getOwnPropertyDescriptor(U.prototype,"alreadyVerifiedUser"),U.prototype),A(U.prototype,"newUser",[P],Object.getOwnPropertyDescriptor(U.prototype,"newUser"),U.prototype),U);N.defaultProps={userData:void 0,isSubscribed:void 0,popupView:0,stickyView:!1,isPrivateUser:!0,onShowHideCallback:()=>{},forceHide:!1,view:"",setFallback:;const j=(0,a.$j)((e=>({userData:e.login&&e.login.userData?e.login.userData:{},isSubscribed:e.timesTop10&&e.covid19.is_Subscribed,isPrivateUser:e.gdpr.isPrivateUser,forceHide:e.commonPopUpManager&&e.commonPopUpManager.forceHide})),(e=>({setSubscriptionStatus:)))(N)},70365:(e,s,t)=>{var i=t(81445)("jsonp");e.exports=var o=0;,81445:84805:20971:72091:e=>{e.exports={"T10-widget":"etPYU","T10-popUp":"xptUA","C19-sticky":"siFKV",nllogo:"Sx28Y","T10-popUpActive":"m81yF",newsletter_wdtclose:"CB5lw",rhs:"JOewU",nlouterbox:"uK1bX",virusImg:"BZaVG",top10text:"VtAVx",nlfooter:"VY58V",home:"oIsIP",column:"pkTDR",t10SeparationLine:"cOypI",footerlink:"F1ZMv",disable:"AgsTN",submitbtn:"qNaCg",noborder:"uU6fS",T10successMessage:"hywgU",T10errMessage:"gOzyC"}}}]);
//# sourceMappingURL=WithCovid19SubscriptionWdt_es6_module.97591871.chunk.js.map