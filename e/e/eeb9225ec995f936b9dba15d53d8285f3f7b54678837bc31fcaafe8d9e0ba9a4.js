;
(self.AMP=self.AMP||[]).push({m:0,v:"2401032027001",n:"amp-next-page",ev:"1.0",l:!0,f:function(t,n){!function(){rray.isArray;ar h=Object.prototype,f=h.hasOwnProperty,l=h.toString;ction m(t,n,i,r,e,o,u,s,a,c,h){return t}r y,w=/(\0)|^(-)$|([\x01-\x1f\x7f]|^-?[0-9])|([\x80-\uffff0-9a-zA-Z_-]+)|[^]/g;ion P(t,n){return j(n),O(t,"> [".concat(n,"]") C=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/}function U(t){var n=(t||self).location;retur}(n.originalHash||n.hash)}var z="elf.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var _,V=self.__AMP_LO,vt=function(t){return G(t,"batched-xhr")},p},dt=function(t){return Q(t,"mutator")},mt=function(t){return Q(t,"viewer")},gt=function(t){return G(t,"vsync")},bt=function(t){return Q(t,"viewport")},yt=function(t){return G(t,"xhr")},wt="prerender",xt="visible",kt="hiddenvar jt=["Webkit","webkit","Moz","moz","ms","O","o" At="inside",Tt="top",Lt="bottom";function Ct(t,n){return!(!t||!n)&&t.left==n.left&&t.top==n.top&&t.width==n.width&&t.height==n.height}var Mt,Ut,zt=function(}var n=t.prototype;return n.No=function(t){var n=this.sR;if(!(n&&Ct(n.positionRect,t.positionRect)&&Ct(n.viewportRect,t.viewportRect))){W(t.positionRect);var i,r,e=t.positionRect;t.relativePos=(i=e,r=t.viewportRect,i.top<r.top?Tt:i.bottom>r.bottom?Lt:At}(e,t.viewportRect)?(this.sR=t,this.Do(t)):this.sR&&(this.sR=null,t.positionRect=null,this.Do(t))}},n.update=function(t){var n=this;if(!t){if(0!=this.turn)return void this.turn--;0==this.fidelity&&(this.turn=4)}var i,r,e=this.Ph.getSize(),o={left:0,top:0,width:i=e.width,height:r=e.height,bottom:0+r,right:0+i,x:0,y:0};this.Ph.getClientRectAsync(this.element).then}))},t}(),$t=function(){function t(t){var n=this;this.Ye=t,this.t=t.win,this.oR=[],this.Ih=gt(this.t),this.Ph=bt(t),this.Ly=[],this.uR=!1,this.hR=!1,this.fR=!1,this.c}(this.t,(function(){n.uR=!1}))}var n=t.prototype;return n.observ},n.unobserve=function(t){for(var n=0;n<this.oR.length;n++)if(this.oR[n].element==t)return void this.aR(n);J().error("POSITION_OBSERVER","cannot unobserve unobserved element")},n.aR=function(t){this.oR.splice(t,1),0==this.oR.length&&this.vR()},n.l},n.v},n.updateAllEntrie},n.p},n.d},n.m},t}(),Dt=function(){function t(t,n){this.Je=t,this.$ut=null,this.Vut=null,this.callback=n}var n=t.prototype;return n.observe=function(t,n){var i=this,r=t.ownerDocument.createElement("div");r.classList.add("i-amphtml-next-page-document-top-sentinel");var e=t.ownerDocument.createElement("div");e.classList.add("i-amphtml-next-page-document-bottom-sentinel"),n.insertBefore(r,t),n.insertBefore(e,t.nextSibling),this.Je.getPositionObserver().observe(r,0,(function(t){return i.Qut(t)})),this.Je.getPositionObserver().observe(e,0,(function(t){return i.Xut(t)}))},n.Qut=function(t){this.$ut=t.relativePos,this.Je.updateRelativePos(this)},n.Xut=function(t){this.Vut=t.relativePos,this.Je.updateRelativePos(this)},n.usesSentinel=function(){return!0},Nt(t,[{key:"top",get:function(){return this.$ut}},{key:"bottom",get:function(){return this.Vut}}]),t}(),Ht=function(t){i(r,t);var n=u(r);function r(t,i,r){var e;return(e=n.call(this,t,i)).Zat=r,e}return r.prototype.usesSentine},Nt(r,[{key:"nextPageEl",get:function(){return this.Zat}}]),r}(Dt),_t=function(){function t(t){this.Ye=t,this.Jp=[],this.FF=0,this.Z8=-1,this.Yat=null,this.Ph=bt(t),this.tct=0,this.nct=!1,this.Ac=dt(t);var }(t.win,this.J8.bind(this));this.Ph.onScroll(n.bind(this)),this.Ph.onResize(n.bind(this)),this.J8()}var n=t.prototype;return n.J8=function(){var t=this;this.nct||(this.nct=!0,this.Ac.measureElement((function(){t.tct=t.Ph.getHeight();var n=t.Ph.getScrollTop(),i=n-t.FF;if(!(Math.abs(i)<20)){var r=i>0?-1:1;t.Jp.forEach((function(n){n.usesSentinel()&&t.Yat===r||t.updateRelativePos(n)})),t.FF=n,t.Yat=t.Z8,t.Z8=r}})).then})))},n.isScrollingU},n.isScrollingDow},n.observe=function(t,n,i){var r=new Dt(this,i);this.Jp.push(r),r.observe(t,n)},n.observeHost=function(t,n){var i=new Ht(this,n,t);this.Jp.push(i)},n.getPositionObserver=function(){return t=this.Ye,n="position-observer",i=$}(it(r=nt(t)),r,n,i),Q(this.Ye.getHeadNode(),"position-observer");var t,n,i,r},n.updateRelativePos=function(t){var n=t.usesSentinel()?this.getRelativePosFromSentinel(t):this.getRelativePosFromScroll(t);n&&t.callback(W(n))},n.getRelativePosFromScroll=function(t){var n=this.FF,i=this.tct,r=t.nextPageEl.getLayoutBox().top;return n<r-i?5:n<r&&r<=i&&n<=0?1:n<r?this.isScrollingDown()?3:4:2},n.getRelativePosFromSentinel=function(t){var n=t.bottom,i=t.top;return i||n?i===At&&n===At?1:i&&i!==Tt||n&&n!==Lt?(i&&i!==Tt||n!==Tt)&&(i!==Lt||n&&n!==Lt)?!(i!==Tt&&i!==At||n&&n!==Lt)==!!this.isScrollingUp()?3:4:2:5:null},Nt(t,[{key:"mutator",get:function(){return this.Ac}}]),t}(),Vt="amp-next-page-hidden",Zt=function(){function t(t,n){this.uy=t,this.Nq=n.title,this.be=n.url,this.ict=n.url,this.fY=n.image,this.rct=null,this.pg=null,this.M5=null,this._e=1,this.J=wt,this.ect=2}var n=t.prototype;return n.i},n.isLoade},n.isVisibl},n.setVisibility=function(t){this.isLoaded()&&t!=this.J&&(this.is(6)&&t===xt&&this.resume(),this.J=t,this.rct&&(this.rct.setVisibilityState(t),this.rct.ampdoc.getBody().classList.toggle("amp-next-page-visible",this.isVisible()),this.rct.ampdoc.getBody().classList.toggle(Vt,!this.isVisible())))},n.pause=function(){var t=this;return this.rct?this.rct.close().then((function(){return t.uy.closeDocument(t).then((function(){t.rct=null,t.J=kt,t._e=6}))})):F()},n.resum},n.fetch=function(){var t=this;return 5===this._e||2===this._e||3===this._e||4===this._e?F():(this._e=2,this.uy.fetchPageDocument(this).then((function(n){return t._e=3,t.M5=n,t.pg=t.uy.createDocumentContainerForPage(t),t.oct()})).catch})))},n.oct=function(){var t=this;return this.uy.attachDocumentToPage(this,W(this.M5),this.is(6)).then((function(n){n?(t._e=5,t.rct=n,t.is(6)||t.uy.setLastFetchedPage(t)):t._e=4}))},Nt(t,[{key:"url",get:function(){return this.be},set:function(t){this.be=t}},{key:"initialUrl",get:function(){return this.ict}},{key:"image",get:function(){return this.fY}},{key:"title",get:function(){return this.Nq}},{key:"relativePos",get:function(){return this.ect},set:function(t){this.ect=t}},{key:"document",get:function(){if(this.rct)return this.rct.ampdoc.getRootNode()}},{key:"container",get:function(){return this.pg}},{key:"shadowDoc",get:function(){return this.rct}}]),t}(),qt=function(t){i(r,t);var n=u(r);function r(t,i,r,e,o){var u;return(u=n.call(this,t,i))._e=r,u.J=e,u.Wv=o,u}return Nt(r,[{key:"document",get:function(){return this.Wv}}]),r}(Zt),B}(),J}(),Wt=new Set(["c","v","a","ad"]),Yunction Qt(t){if}(t=Yt(t)))return t.href;var n=t.pathname.split("/"),i=n[1];Y(Wt.has(i),"Unknown path prefix in url %s",t.href);var r=n[2],e="s"==r?"https://"+decodeURIComponent(n[3]):"http://"+decodeURIComponent(r);return Y(e.indexOf(".")>0,"Expected a . in origin %s",e),n.splice(1,"s"==r?3:2),e+n.join("/"}(t.search)+(t.hash||""}function tn(t,n){var i=Ft(t),r=Ft(n).origin,e=Xt(n);return Y(i.origin===r||i.origin===e,"Invalid page URL supplied to amp-next-page, pages must be from the same origin as the current document"),i}var nn='.i-amphtml-next-page-document{overflow:hidden}.i-amphtml-next-page-document:not(.amp-next-page-visible) [i-amphtml-fixedid]{display:none}.i-amphtml-next-page-document.amp-next-page-visible{opacity:1;overflow:visible}.i-amphtml-next-page-document:after,.i-amphtml-next-page-document:before{content:" ";display:table}.i-amphtml-next-page-placeholder{background:#eee}.amp-next-page-separator{border-bottom:1px solid rgba(0,0,0,0.12)}.amp-next-page-links{border-top:1px solid rgba(0,0,0,0.1);margin-top:16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.amp-next-page-link{border-bottom:1px solid rgba(0,0,0,0.1);display:block;overflow:auto;padding:10px 0;text-decoration:none}.amp-next-page-image{width:72px;height:72px;float:left;margin:0 10px;background-size:cover;background-position:50%}.amp-next-page-text{position:relative;margin:5px 30px 5px 0;color:#3c4043;font-size:17px}\n/*# sourceURL=/extensions/amp-next-page/1.0/amp-next-page.css*/}var en,on,un="render-start",sn="none",an="v0";function cn(){if(void 0!==on)return on;if(hn()==sn)on=!1;else{var t=hn()===an?self.document.createElement("div").createShadowRoot():self.document.createElement("div").attachShadow({mode:"open"});n=ShadowRoot,on=!!n&&-1!=n.toString().indexOf("[native code]")&&t instanceof ShadowRoot}var n;return ovar ln="-shadowcsshost",vn=")(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",pn=(new RegExp("("+ln+vn,"gim"),new RegExp("(-shadowcsscontext"+vn,"gim"),"([>\\s~+[.,{:][\\s\\S]*)?$"),dn=ln+"-no-combinator",mn=new RegExp(ln,"gim");function gn(t,n,i,r,e){var o=t.getHeadNode(),u=function(t,n,i,r){var e=t.__AMP_CSS_SM;e||(e=t.__AMP_CSS_SM=v());var o=!i&&r&&"amp-custom"!=r&&"amp-keyframes"!=r,u=i?"amp-runtime":o?"amp-extension=".concat(r):null;if(u){var s=bn(t,e,u);if(s)return"STYLE"==s.tagName&&s.textContent!==n&&(s.textContent=n),s}var a=(t.ownerDocument||t).createElement("style");a.textContent=n;var c=null;return i?a.setAttribute("amp-runtime",""):o?(a.setAttribute("amp-extension",r||""),c=bn(t,e,"amp-runtime")):(r&&a.setAttribute(r,""),c=t.lastChild}(t,a,c),u&&(e[u]=a),a}(}(o,n),r||!1,e||null);if(i){var s=t.getRootNode();if(yn(s,u))return i(u),u;var a=setInterval((function(){yn(s,u)&&(clearInterval(a),i(u))}),4)}return new RegExp("-shadowcsscontext","gim");var wn=function(){function t(t){this.dd=t.document.implementation.createHTMLDocument(""),this.dd.open(),this.Ih=gt(t),this.md=this.pd.bind(this),this.bd=null,this.gd=null,this.yd=null,this.wd=!1,this.Ad=F(),this.xd=!1,this.Ed=null}var n=t.prototype;return n.onBody=function(t){this.bd=t},n.onBodyChunk=function(t){this.gd=t},n.onEnd=function(t){this.yd=t},n.write=function(t){if(this.xd)throw new Error("closed already");return t&&this.dd.write(t),this.Ms(),this.Ad},n.close=function(){return this.dd.close(),this.xd=!0,this.Ms(),this.Ad},n.abort=function(t){throw new Error("Not implemented")},n.releaseLock=function(){throw new Error("Not implemented")},n.Ms=function(){m(this.bd&&this.gd&&this.yd),this.wd||(this.wd=!0,this.Ih.mutate(this.md))},n.pd=function(){if(this.wd=!1,!this.Ed&&this.dd.body&&(this.Ed=this.bd(this.dd)),this.Ed){var t=this.dd.body,n=m(this.Ed),i=0;for(kn(t);t.firstChild;)i++,n.appendChild(t.firstChild);i>0&&this.gd()}this.xd&&this.yd()},Nt(t,[{key:"closed",get:function(){throw new Error("Not implemented")}},{key:"desiredSize",get:function(){throw new Error("Not implemented")}},{key:"ready",get:function(){throw new Error("Not implemented")}}]),t}(),xn=function(){function t(t){this.Od=[],this.Ih=gt(t),this.bd=null,this.gd=null,this.yd=null,this.Ad=F(),this.xd=!1}var n=t.prototype;return n.onBody=function(t){this.bd=t},n.onBodyChunk=function(t){this.gd=t},n.onEnd=function(t){this.yd=t},n.write=function(t){if(m(this.bd&&this.gd&&this.yd),this.xd)throw new Error("closed already");return t&&this.Od.push(t),this.Ad},n.close=function(){var t=this;return m(this.bd&&this.gd&&this.yd),this.xd=!0,this.Ih.mutate((function(){return t.Pl()})),this.Ad},n.abor},n.releaseLock=function(){throw new Error("Not implemented")},n.Pl=function(){var t=this.Od.join(""),n=(new DOMParser).parseFromString(t,"text/html");if(n.body){var i=n.body,r=this.bd(n),e=0;for(kn(i);i.firstChild;)e++,r.appendChild(i.firstChild);e>0&&this.gd()}this.yd()},Nt(t,[{key:"closed",get:function(){throw new Error("Not implemented")}},{key:"desiredSize",get:function(){throw new Error("Not implemented")}},{key:"ready",ge}}]),t}();function kn(t){I(t,"noscript").forEach(N)}var Rn,Sn=/[^\.\-\_0-9a-zA-Z]/,jn=/[^\-\_0-9a-zA-Z]/;function En(t,n,i){var r,e,o=t.ownerDocument;if(cn())r=o.importNode(n,i);else{"block",e=(r=o.createElement("amp-body")).style,m(!0),m(!e.display),e.display="block";for(var u=0;u<n.attributes.length;u++)r.setAttribute(n.attributes[0].name,n.attributes[0].value);if(i)for(var s=n.firstChild;s;s=s.nextSibling)r.appendChild(o.importNode(s,!0))}Et(r,"position","relative");var a=t.body;return a&&t.removeChild(a),t.appendChild(r),Object.defineProperty(t,"body",{configurable:!0,value:r}),ar Nn="multidoc-manager",An=function(}var i=n.prototype;return i.Pd=function(n,i,r,e){var o=this;r=r||Object.create(null),this.Id(),Et(n,"visibility","hidden");var u=function(t){var n,i=b(t),r=t.shadowRoot||t.__AMP_SHADOW_ROOT;if(r){if(self.trustedTypes&&self.trustedTypes.createPolicy){var e=self.trustedTypes.createPolicy("shadow-embed#createShadowRoot",{createHTM}});r.innerHTML=e.createHTML("")}else r.innerHTML="";return r}var o,u=hn();if("v1"==u?(n=t.attachShadow({mode:"open"})).styleSheets||Object.defineProperty(n,"styleSheets",{ge}}):n=u==an?t.createShadowRoot(}(t),!cn()){var a="i-amphtml-sd-".concat(i.Math.floor(1e4*i.Math.random()));n.id=a,n.host.classList.add(a),},n.__AMP_CSS_TR=o}return n}(n);u.AMP&&(q().warn(Nn,"Shadow doc wasn't previously closed"),this.Sd(u));var c={};u.AMP=c,c.url=i;var h=Ft(i).origin,f=this.dv.installShadowDoc(i,u,{params:r});c.ampdoc=f,J().fine(Nn,"Attach to shadow root:",u,f),gn(f,t.combinedCss,null,!0),t.installAmpdocServices(f);var v,p,d=mt(f);return c.setVisibilityStat},c.postMessage=d.receiveMessage.bind(d),c.onMessag},d.setMessageDeliverer((function(t,n,i){var r;return"broadcast"==t?(o.Md(n,u),i?F():void 0):null===(r=v)||void 0===r?void 0:r(t,n,i)}),h),c.clos},(p=self,p.__AMP_MODE?p.__AMP_MODE:p.__AMP_MOD}(p)).development&&(c.toggleRuntime=d.toggleRuntime.bind(d),c.resources=Q(f,"resources")),c.getState=function(t){return pt(u).then}))},c.setState=function(t){return pt(u).then((function(n){return n?"string"==typeof t?n.setStateWithExpression(t,{}):(i=t,"[object Object]"===l.call(i)||a(t)?n.setStateWithObject(t):Promise.reject("Invalid state")):Promise.reject("amp-bind is not available in this document");var i}))},e(c,u,f).then((function(){f.setReady(),f.signals().signal(un),Et(n,"visibility","visible")})),this.Td.includes(u)||this.Td.push(u),J().fine(Nn,"Shadow root initialization is done:",u,f),c},i.attachShadowDoc=function(t,n,i,r){var e=this;return q().assertString(i),J().fine(Nn,"Attach shadow doc:",n),this.Pd(t,i,r,(function(i,r,o){if(e.Rd(o,r,n),n.body){var u=En(r,n.body,!0);u.classList.add("amp-shadow"),o.setBody(u)}return setTimeout((function(){o.signals().signal(un),Et(t,"visibility","visible")}),50),F()}))},i.attachShadowDocAsStream=function(t,n,i){var r=this;return q().assertString(n),J().fine(Nn,"Attach shadow doc as stream"),this.Pd(t,n,i,(function(n,i,e){var o,u=!1,s=function(t){return void 0===Rn&&(Rn=function(t){return!(!t.document.implementation||"function"!=typeof t.document.implementation.createHTMLDocument||(n=t,G(n,"platform")).isFirefox());var n}(t)),Rn}(o=r.win)?new wn(o):new xn(o);return n.writer=s,s.onBody((function(t){r.Rd(e,i,t);var n=En(i,t.body,!1);return n.classList.add("amp-shadow"),e.setBody(n),n})),s.onBodyChunk((function(){u||(u=!0,setTimeout((function(){e.signals().signal(un),Et(t,"visibility","visible")}),50))})),new Promise((function(t){s.onEnd}))}))}))},i.Rd=function(t,n,i){if(i.head){n.AMP.head=i.head;for(var r={},e=I(this.win.document.head,"link"),o=0;o<e.length;o++){var u=e[o].getAttribute("href");u&&(r[u]=!0)}for(var s=i.head.firstElementChild;s;s=s.nextElementSibling){var a=s.tagName,c=s.getAttribute("name"),h=s.getAttribute("rel");switch(a){case"TITLE":n.AMP.title=s.textContent,J().fine(Nn,"- set title: ",n.AMP.title);break;case"META":s.hasAttribute("charset")||"viewport"==c||(c?t.setMetaByName(c,s.getAttribute("content")||""):J().warn(Nn,"meta ignored: ",s));break;case"LINK":var f=s.getAttribute("href");if("canonical"==h)n.AMP.canonicalUrl=f,J().fine(Nn,"- set canonical: ",n.AMP.canonicalUrl);else if("stylesheet"==h)if(r[f])J().fine(Nn,"- stylesheet already included: ",f),gn(t,'@import "'.concat(f,'"'),null,!1);else{r[f]=!0;var l=this.win.document.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",f),this.win.document.head.appendChild(l),J().fine(Nn,"- import font to parent: ",f,l)}else J().fine(Nn,"- ignore link rel=",h);break;case"STYLE":s.hasAttribute("amp-boilerplate")?J().fine(Nn,"- ignore boilerplate style: ",s):s.hasAttribute("amp-custom")?(gn(t,s.textContent,null,!1,"amp-custom"),J().fine(Nn,"- import style: ",s)):s.hasAttribute("amp-keyframes")&&(gn(t,s.textContent,null,!1,"amp-keyframes"),J().fine(Nn,"- import style: ",s));break;case"SCRIPT":if(s.hasAttribute("src")){J().fine(Nn,"- src script: ",s);var v=s.getAttribute("src"),p=H(v),d=s.getAttribute("custom-element"),m=s.getAttribute("custom-template"),g=d||m;p?g?this.nd.installExtensionForDoc(t,g,p.extensionVersion):s.hasAttribute("data-amp-report-test")||q().error(Nn,"- unknown script: ",s,v):J().fine(Nn,"- ignore runtime script: ",v)}else-1==(s.getAttribute("type")||"application/javascript").indexOf("javascript")?(n.appendChild(this.win.document.importNode(s,!0)),J().fine(Nn,"- non-src script: ",s)):s.hasAttribute("amp-onerror")||q().error(Nn,"- unallowed inline javascript: ",s);break;case"NOSCRIPT":break;default:q().error(Nn,"- UNKNOWN head element:",s)}}}t.setExtensionsKnown()},i.Md=function(t,n){var i=this;this.Id(),this.Td.forEach((function(r){if(r!=n){var e=mt(r.AMP.ampdoc);i.jo.delay}),0)}}))},i.Sd=function(t){this._d(t);var n=t.AMP;delete t.AMP;var i=n.ampdoc;return i.overrideVisibilityState("inactive"),function(t)}(t)}(i),this.jo.timeoutPromise(15,new this.win.Promise((function(t){tt(i,"resources").then}))})),"Timeout reached waiting for visibility state change callback").catch}))},i._},i.kd=function(t){var n=this;this.jo.delay}),0)},i.Id=function(){var t=this;this.Td.forEach((function(n){n.host&&function(t){var n=t.isConnected;if(void 0!==n)return n;for(var i=t;(i=L(i)).host;)i=i.host;return i.nodeType===Node.DOCUMENT_NODE}(n.host)||(q().warn(Nn,"Shadow doc wasn't previously closed"),t._d(n),t.kd(n))}))},n}(),Tn=['<div class=amp-next-page-separator aria-label="Next article separator" tabindex=0></div>'],Ln=['<div class=amp-next-page-links aria-label="Read more articles"></div>'],Cn=["<a class=amp-next-page-link><img ref=image class=amp-next-page-image> <span ref=title class=amp-next-page-text></span></a>"],Mn="amp-next-page",Un="i-amphtml-next-page-document",zn="i-amphtml-next-page-shadow-root",$n="i-amphtml-next-page-placeholder",D},Hn=function(){function t(t){var n=this;this.Ye=t,this.t=t.win,this.zt=this.t.document,this.Ph=bt(t),this.au=mt(t),this.Ac=dt(t),this.Xb=Q(t,"templates"),this.Hrt=null,this.uct=null,this.sct=Dn,this.act=!1,this.cct=null,this.hct=null,this.fct=null,this.qrt=null,this.Ah=null,this.WC=null,this.JI,this.lct=null,this.vct=null,this.pct=null,this.dct={},this.mct=!1,this.gct=1/0,this.bct=null,this.xe=null,this.pe=new Promise}))}var n=t.prototype;return n.isBuil},n.build=function(t){var n=this;if(this.isBuilt())return F();this.Ye.getBody().lastElementChild!==t&&q().warn(Mn,"should be the last element in the body of the document, a footer element can be added as a child of <amp-next-page> if it has the `footer` attribute"),this.hct=t,this.bct=this.yct().getAttribute("src"),this.mct=this.yct().hasAttribute("deep-parsing")?"false"!==this.yct().getAttribute("deep-parsing"):!this.bct,this.gct=this.yct().hasAttribute("max-pages")?parseInt(this.yct().getAttribute("max-pages"),10):1/0,this.Hrt=this.wct(t),this.uct=this.xct(t),this.vct=this.createHostPage(),this.pct=this.vct,this.toggleHiddenAndReplaceableElements(this.zt),T(this.hct,this.uct),this.Ah=Q(this.Ye,"history"),this.WC=Q(this.Ye,"navigation"),this.qrt=new An(this.t,G(this.t,"ampdoc"}(this.t),rt(this.t,"timer")),this.fct=new _t(this.Ye),this.pe.then((function(){n.fct.observeHost(n.yct()}))})),this.JI||(this.JI=[this.vct],this.setLastFetchedPage(this.vct));var };return this.kct().then((function(){return n.Rct()})).then(i,i),this.yct().classList.add("i-amphtml-next-page"),this.pe},n.kct=function(){var t=this;return new Promise((function(n){if(0!=t.Ph.getScrollTop())return n();var i=t.Ph.onScroll}))}))},n.yc},n.maybeFetchNext=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.JI.filter})).length>this.gct,r=this.JI.some((function(t){return t.is(2)})),e=this.Sct()>3&&!n;if(this.act||r||e||i)return F();var o=this.JI.length,u=this.JI[this.jct(this.lct)+1];return u?u.fetch().then((function(){u.is(4)&&t.setLastFetchedPage(u)})).then((function(){return t.sct()})})):this.Ect().then((function(n){return t.Oct(n)})).then((function(){return t.JI.length<=o?(t.act=!0,t.sct()):t.maybeFetchNext(!0)}))},n.updateVisibility=function(){var t=this;this.JI.forEach((function(n,i){2===n.relativePos?n.isVisible()&&n.setVisibility(kt):3!==n.relativePos&&(n.isVisible()||n.setVisibility(xt),t.Pct(i),t.Ict(i))})),this.JI.some((function(t){return t.isVisible()}))||this.vct.setVisibility(xt),this.JI.filter((function(t){return t.isVisible()})).forEach}));var n=function(t,n){for(var i=0;i<t.length;i++)if(t[i].isVisible())return i;return-1}(this.JI),i=this.JI[n]||null;i&&this.pct!==i&&this.setTitlePage(i),this.maybeFetchNext()},n.Pct=function(t,n){var i=void 0===n?5:n;this.fct.isScrollingDown()&&this.vct.isVisible()&&this.vct.setVisibility(kt);var r=this.fct.isScrollingDown()?this.JI.slice(1,t).reverse():this.JI.slice(t+1);return Promise.all(r.filter})).map((function(t,n){if(t.isVisible()&&t.setVisibility(kt),n>=i)return t.pause()})))},n.Ict=function(t,n){var i=void 0===n?5:n,r=this.JI.slice(1).slice(Math.max(0,t-i-1),Math.min(this.JI.length,t+i+1)).filter}));return Promise.all(r.map})))},n.setLastFetchedPag},n.setTitlePage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.vct;if(t){var n=t.title,i=t.url;this.zt.title=n,this.Ah.replace({title:n,url:i}),this.pct=t,Pt(this.yct(),"amp-next-page-scroll",{"title":n,"url":i},!1)}else J().warn(Mn,"setTitlePage called before next-page-service is built")},n.createHostPage=function(){var t,n,i,r=this.zt,e=r.location,o=r.title,u=e.href,}(this.zt)||((t=this.zt.querySelector('meta[property="og:image"]'))?t.getAttribute("content"):void 0)||(n=this.zt,(i=n.querySelector('link[rel="shortcut icon"]')||n.querySelector('link[rel="icon"]'))?i.getAttribute("href"):void 0)||"";return new qt(this,{url:u,title:o||"",image:s},5,xt,this.zt)},n.createDocumentContainerForPage=function(t){var n=this,i=this.zt.createElement("div");i.classList.add("i-amphtml-next-page-document-container"),this.hct.insertBefore(i,this.uct);var r=this.zt.createElement("div");return r.classList.add(zn),i.appendChild(r),this.fct.observe(r,i})),i},n.Nc},n.attachDocumentToPage=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.Sct()<1&&!i)return Promise.resolve(null);var r=t.container,e=O(r,"> .".concat(S(zn)));if(!e){W(t.is(6));var o=O(r,"> .".concat(S($n)));(e=this.zt.createElement("div")).classList.add(zn),r.replaceChild(e,o)}this.sanitizeDoc(n);try{var u=this.qrt.attachShadowDoc(e,n,t.url,{visibilityState:wt,cap:this.Nct()}),s=this.au.maybeGetMessageDeliverer();s&&u.onMessage((function(t,n,i){if("documentHeight"!==t&&"scroll"!==t&&"viewport"!==t)return s(t,n,i)}));var a=W(u.ampdoc);gn(a,nn,null,!1,Mn);var c=a.getBody();c.classList.add(Un);var h=this.Hrt.cloneNode(!0);T(r,h);var f=this.Act(h,t);return f.then}))}catch(t){return J().error(Mn,"failed to attach shadow document for page",t),Promise.resolve(null)}},n.closeDocument=function(t){if(t.is(6))return F();var n=t.container,i=O(n,"> .".concat(S(zn))),r=this.zt.createElement("div");r.classList.add($n);var e=0,o=0;return this.Ac.measureMutateElement(i}),(function()}(r,{"height":"".concat(e,"px"),"width":"".concat(o,"px")}),n.replaceChild(r,i)}))},n.sanitizeDoc=function(t){var n=this;s(t.querySelectorAll("amp-next-page")).forEach((function(t){if(n.mct){var i=n.Tct(t);n.Lct(i)}N(t)})),t.body.classList.add(Vt),this.toggleHiddenAndReplaceableElements(t,!1)},n.toggleHiddenAndReplaceableElements=function(t){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t!==this.vct.document&&s(t.querySelectorAll("[next-page-hide]")).forEach})),i&&s(t.querySelectorAll("*:not(amp-next-page) [next-page-replace]")).forEach((function(t){var i=t.getAttribute("next-page-replace");i||(i=String(Date.now()+Math.floor(100*Math.random())),t.setAttribute("next-page-replace",i)),n.dct[i]&&n.dct[i]!==t&&Ot(n.dct[i],!1),n.dct[i]=t,Ot(t,!0)}))},n.Sct=function(){return Math.round((this.Ph.getScrollHeight()-this.Ph.getScrollTop()-this.Ph.getHeight())/this.Ph.getHeight())},n.jc},n.fetchPageDocument=function(t){var n=this;return yt(this.t).fetch(t.url,{ampCors:!1}).then((function(i){return tn(i.url,n.Ye.getUrl()),t.url=i.url,i.text()})).then((function(t){var i=n.zt.implementation.createHTMLDocument("");return i.open(),i.write(t),i.close(),i})).catch((function(n){throw q().error(Mn,"failed to fetch %s",t.url,n),n}))},n.Rct=function(){var t=this,n=this.Tct(this.yct());return n.length?this.Lct(n):(Y(this.bct,"%s should contain a <script> child or a URL specified in [src]",Mn),this.Ect().then((function(n){return 0===n.length?(q().warn(Mn,"Could not find recommendations"),F()):t.Lct(n)})))},n.Oct=function(t){var n=this;return!t.length||this.act||t.forEach((function(t){try{if(function(t,n){q().assertString(t.url,"page url must be a string");var i,r,e=Qt(n),o=Ft(n).origin;t.url=(i=t.url,r=Yt(r=e),"function"==typeof URL?new URL(i,r.href).toString(}(i,r));var u=tn(t.url,n);q().assertString(t.image,"page image must be a string"),q().assertString(t.title,"page title must be a string");var s=Xt(n);s!==o&&u.origin===s&&(t.url="".concat(o,"/c/")+("https:"===u.protocol?"s/":"")+encodeURIComponent(u.host)+u.pathname+(u.search||"")+(u.hash||""))}(t,n.Ye.getUrl()),n.JI.some})))return;n.JI.push(new Zt(n,t))}catch(t){q().error(Mn,"Failed to queue page due to error:",t)}})),F()},n.Lct=function(t){var n=this;return this.Oct(t).then((function(){return n.maybeFetchNext()}))},n.Tct=function(t){var n=I(t,"SCRIPT");if(!n.length)return[];Y(1===n.length,"".concat(Mn," should contain at most one <script> child"));var i=n[0];Y(function(t){var n;return"SCRIPT"==t.tagName&&"APPLICATION/JSON"==(null===(n=t.getAttribute("type"))||void 0===n?void 0:n.toUpperCase())}(i),"".concat(Mn," page list should ")+'be inside a <script> tag with type="application/json"');var r=g(i.textContent})),o=q().assertArray(r,"".concat(Mn," Page list expected an array, found: ").concat(e(r)));return N(i),o},n.Ect=function(){var t=this;return this.bct?(this.cct||(this.cc}(this.Ye,this.yct(),{urlReplacement:2,xssiPrefix:this.yct().getAttribute("xssi-prefix")||void 0}).then((function(n){return t.bct=n.next||null,t.bct&&t.yct().setAttribute("src",t.bct),n.pages||[]})).catch((function(n){return q().error(Mn,"error fetching page list from remote server",n),t.bct=null,[]}))),this.cct):Promise.resolve([])},n.wct=function(t){var n=P(t,"separator");return n?(N(n),n.hasAttribute("tabindex")||n.setAttribute("tabindex","0"),n):this.Cct()},n.Cct=function(){return Rt(this.yct())(Tn)},n.Act=function(t,n){var i=this;if(!this.Xb.hasTemplate(t))return F();var r={title:n.title,url:n.url,image:n.image};return this.Xb.findAndRenderTemplate(t,r).then((function(n){return i.Ac.mutateElement(t}))}))},n.xct=function(t){var n=this,i=P(t,"recommendation-box");return i?(this.sct=this.Xb.hasTemplate(i)?function(){return n.Mct()}:Dn,i):(this.sc},this.zct())},n.zct=function(){return Rt(this.yct())(Ln)},n.Mct=function(){var t=this,n=this.uct;W(this.Xb.hasTemplate(n));var i=this.Xb.maybeFindTemplate(n),r={pages:(this.JI||[]).filter((function(t){return!t.isLoaded()&&!t.is(2)})).map((function(t){return{title:t.title,url:t.url,image:t.image}}))};return this.Xb.findAndRenderTemplate(n,r).then((function(r){return t.Ac.mutateElement(n,(function(){A(n),n.appendChild(i),n.appendChild(r)}))}))},n.Uct=function(){var t=this,n=this.uct,i={pages:(this.JI||[]).filter((function(t){return!t.isLoaded()&&!t.is(2)})).map}))},r=Rt(this.yct()),e=i.pages.map((function(n){var i=r(Cn),e=function(t){for(var n=t.querySelectorAll("[ref]"),i=v(),r=0;r<n.length;r++){var e=n[r],o=e.getAttribute("ref");m(o),e.removeAttribute("ref"),m(void 0===i[o]),i[o]=e}return i}(i),o=e.image,u=e.title;return o.src=n.image,u.textContent=n.title,i.href=n.url,i.addEventListener("click",(function(i){Pt(t.yct(),"amp-next-page-click",{"title":n.title,"url":n.url},!1),t.WC.navigateToAmpUrl(n.url,"content-discovery")&&i.preventDefault()})),i}));return this.Ac.mutateElement(n,(function(){A(n),e.forEach}))}))},t}(),_n=function(t){i(r,t);var n=u(r);function r(t){var i;return(i=n.call(this,t)).$ct=null,i}var e=r.prototype;return e.isLayoutSupporte},e.buildCallback=function(){return this.$ct=Q(this.element,"next-page"),this.$ct.build(this.element)},r}(t.BaseElement);t.registerServiceForDoc("next-page",Hn),t.registerElement("amp-next-page",_n,nn)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
/**
* @license
* Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
* Use of this source code is governed by a BSD-style
* license that can be found in the LICENSE file or at
* https://developers.google.com/open-source/licenses/bsd
*/}});
//# sourceMappingURL=amp-next-page-1.0.js.map