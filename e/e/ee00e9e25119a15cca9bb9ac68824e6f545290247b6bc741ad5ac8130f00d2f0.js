var wtAdTracer=function(){"use strict";o=0;r a,l=function(){function t(){this.player=void 0,this.utils=void 0,this.SHORT_NAME="Must be implemented",this.PLAYER_EVENTS={}}var e=t.prototype;return e.start=function(){},e.getVideoSlot=function(){},e.getMediaId=function(){},e.getPlayerId=function(){},e.getPlayerVersion=function(){},e.getAdBlock=function(){},e.getAdMgV=function(){},e.getIdx=function(){},e.getPercentViewable=function(){},e.getIsLive=function(){},t}(),d={endpoint:"https://us.q2s15.com/v5/in",batchSize:5,batchInterval:1e3,debug:!1},u={0:[]},c=0,g=!1,p=!1,f=function(){if(d.debug)try{for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.warn.apply(null,["%cWTAT.stream","background:#ffd400;color:#000;padding:2px"].concat(e))}catch(t){}};function y(){d.batchInterval>0&&(a=setInterval(m,d.batchInterval))}unction m(){if(!g){g=!0,v();var t=c;u[c+1]=[],c++,u[t].length&&function(t,e){f("sending",t);try{var n=JSON.stringify(t);if(navigator.sendBeacon){var i=new FormData;i.append("batch",n),i.append("apiKey",d.apiKey),navigator.sendBeacon(d.endpoint,i)||f("beacon queue error"),w(e)}else{var o=new XMLHttpRequest;o.open("POST",d.endpoint,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.setRequestHeader("x-api-key",d.apiKey),o.setRequestHeader("Connection","keep-alive"),o.onreadystatechange=o.send("batch="+encodeURIComponent(n))}}catch(t){f("xhr error",t.message)}}(u[t],t),g=!1,y()}}ar h=function(){function t(t){void 0===t&&(t={}),d=Object.assign(d,t),y()}var e=t.prototype;return e.push=function(t){!p&&t&&(f("received",t),u[c].push(t),u[c].length>=d.batchSize&&m())},e.stop=function(){p=!0,u[c].length&&m(),v()},t}(),b=function(t,e){var n,i=this;this.options={debug:!1,sendAllCustom:!1},this.sessionId=void 0,this.loopIdx=0,this.staticData={},this.sessionFlags={},this.env={},this.stream=void 0,this.createGuid=function(){for(var t="",e=0;e<12;e++)t+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZY01234567890".charAt(Math.floor(64*Math.random()));return Date.now()+"-"+t},this.createSession=function(){var t,e,n=!1;try{n=!!window.top.innerWidth||!!window.top.document.documentElement.clientWidth||!!window.top.document.body.clientWidth}catch(t){}i.sessionFlags={firstTimeDataSent:!1,isFif:n,sessionStartTime:Date.now()},i.sessionId=i.createGuid(),0===i.loopIdx&&(i.playlistId=i.createGuid()),i.loopIdx+=1;var o=function(){var t,e;try{var n=k(window.top);t=n[0],e=n[1]}catch(t){}if(!t){var i=window,o=k(i);t=o[0],e=o[1];try{for(;i.parent&&i!==i.parent;){var r=k(i.parent);t=r[0],e=r[1],i=i.parent}}catch(t){}}return[t,e]}();return i.sessionFlags.ww=o[0],i.sessionFlags.wh=o[1],i.sessionFlags.pu=function(t){var e=document.referrer;!e&&t&&(e=document.documentURI);try{var n,i;(window.location===window.parent.location||!e&&null!=(n=document)&&null!=(i=n.location)&&i.href)&&(e=document.location.href)}catch(t){}return e}(n),i.staticData={rid:i.sessionId,idx:(null==(t=i.env)||null==t.getIdx?void 0:t.getIdx())||i.loopIdx,plGid:i.playlistId,src:i.options.src,v:i.options.v,plV:null==(e=i.env)||null==e.getPlayerVersion?void 0:e.getPlayerVersion(),fif:+i.sessionFlags.isFif,domain:P(i.sessionFlags.pu)},i.sessionId},this.sendData=this.gatherData=function(t){var e,n,o;void 0===t&&(t={});var r,s=Object.assign({},t,i.staticData,{mediaId:null==(e=i.env)||null==e.getMediaId?void 0:e.getMediaId(),playerId:null==(n=i.env)||null==n.getPlayerId?void 0:n.getPlayerId(),cst:Date.now()-i.sessionFlags.sessionStartTime,pVisible:E(),isLive:null==(o=i.env)||null==o.getIsLive?void 0:o.getIsLive()});i.sessionFlags.firstTimeDataSent||(i.sessionFlags.firstTimeDataSent=!0,s.cst=0,s.ww=i.sessionFlags.ww,s.wh=i.sessionFlags.wh,s.pu=i.sessionFlags.pu);try{var a=i.env.getVideoSlot();if(a){var l,d;s.per=null!=(l=null==(d=i.env)||null==d.getPercentViewable?void 0:d.getPercentViewable())?l:function(t,e){if(!t)return;try{var n=window.getComputedStyle(t,null),i=n.getPropertyValue("visibility"),o=n.getPropertyValue("display");if("hidden"===i||"none"===o)return 0;try{if(e){var r=k(window.top),s=r[0],a=r[1],l=t.getBoundingClientRect(),d=0,u=0;if(s===1/0||a===1/0)return;var c=F(t,window);try{d=c.bottom<0||c.top>a?0:c.top<a&&c.bottom>a?(a-c.top)/l.height*100:c.top<0&&c.bottom>0?c.bottom/l.height*100:100,u=c.right<0||c.left>s?0:c.left<s&&c.right>s?(s-c.left)/l.width*100:c.left<0&&c.right>0?c.right/l.width*100:100}catch(t){return}return parseInt(u*d/100,10)}}catch(t){}}catch(t){}}(a,i.sessionFlags.isFif);var u=a.getBoundingClientRect();s.w=parseInt(u.width,10),s.h=parseInt(u.height,10)}}catch(t){i.log("gatherData ERROR reading ad WxH:",t.message)}try{var c=A(window,["wtatCustom","fields"],{});Object.keys(c).length&&(s.custom=s.custom||{},Object.entries(c).forEach((function(t){var e=t[0],n=t[1];"function"==typeof n?s.custom[e]=n(s):!i.options.sendAllCustom&&i.sessionFlags.staticCustomSent||(s.custom[e]=n)}))),i.sessionFlags.staticCustomSent=!0}catch(t){i.log("gatherData error",t.message)}if(r=s,!A(window,["wtatCustom","ignoredEvents"],[]).some((function(t){return Object.entries(t).every((function(t){var e=t[0],n=t[1];return A(r,e)===n}))})))return s},this.logger=function(t){return function(){if(i.options.debug)try{for(var e,n,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];console.warn.apply(null,["%c"+t+" "+(null!=(e=null==(n=i.env)||null==n.getPlayerId?void 0:n.getPlayerId())?e:""),"background:#ffd400;color:#000;padding:2px"].concat(r))}catch(t){}}},this.options=Object.assign(this.options,t),this.env=e;var o={debug:this.options.debug,apiKey:this.options.apiKey};this.options.wtUrl&&(o.endpoint=this.options.wtUrl),window&&window.wtStream?this.stream=window.wtStream:(this.stream=new h(o),window&&(window.wtStream=this.stream)),this.log=this.logger("WTAT.core",this.options.debug,null==(n=this.env)||null==n.getPlayerId?void 0:n.getPlayerId()),this.log("version",this.options.v)};function A(t,e,n){if(!t)return n;for(var o,r=t,s=i(Array.isArray(e)?e:e.split("."));!(o=s()).done;){var a=o.value;if(void 0===r[a])return n;r=r[a]}return r}function E(){return void 0!==document.visibilityState?Number("visible"===document.visibilityState):void 0!==document.hidden?Number(!document.hidden):void 0}function F(t,e){var n=e,i=e.parent,o={left:0,right:0,top:0,bottom:0};if(t){var r=t.getBoundingClientRect();n!==i&&(o=F(n.frameElement,i)),o={left:r.left+o.left,right:r.right+o.left,top:r.top+o.top,bottom:r.bottom+o.top}}return o}function k(t){var e=1/0,n=1/0;return!isNaN(t.document.body.clientWidth)&&t.document.body.clientWidth>0&&(e=t.document.body.clientWidth),!isNaN(t.document.body.clientHeight)&&t.document.body.clientHeight>0&&(n=t.document.body.clientHeight),t.document.documentElement&&t.document.documentElement.clientWidth&&!isNaN(t.document.documentElement.clientWidth)&&(e=t.document.documentElement.clientWidth),t.document.documentElement&&t.document.documentElement.clientHeight&&!isNaN(t.document.documentElement.clientHeight)&&(n=t.document.documentElement.clientHeight),t.innerWidth&&!isNaN(t.innerWidth)&&(e=Math.min(e,t.innerWidth)),t.innerHeight&&!isNaN(t.innerHeight)&&(n=Math.min(n,t.innerHeight)),[e,n]}function P(t){if(t)try{return new URL(t).hostname}catch(t){}}var S=["loaded","start","impression","firstQuartile","midpoint","thirdQuartile","complete","adError","log","click","volumeChange","mute","unmute"],I=r("getEventData"),B=function(n){var o,r;function a(t,o){var r;if(void 0===o&&(o={}),(r=n.call(this)||this).player=void 0,r.options=void 0,r.sessionFlags={likelyBreak:0,likelyBreakPos:0},r.log=r.utils=void 0,r.SHORT_NAME="jw-ima",r._getAdDetails=function(t){if(t)return{adId:t.getAdId(),adSys:t.getAdSystem(),adAN:t.getAdvertiserName(),adDID:t.getDealId(),adWId:t.getWrapperAdIds(),adWSys:t.getWrapperAdSystems(),adMU:t.getMediaUrl(),adCId:t.getCreativeId(),adWCId:t.getWrapperCreativeIds()}},r._getAdPod=function(t,e){void 0===e&&(e=!1);var n={adMgV:r.getAdMgV()},i=null==t||null==t.getAdPodInfo?void 0:t.getAdPodInfo();if(i){try{var o;n.adBreak=null!=(o=null==i||null==i.getPodIndex?void 0:i.getPodIndex())?o:0,r.sessionFlags.likelyBreak=n.adBreak}catch(t){n.adBreak=e?r.sessionFlags.likelyBreak:0}try{var s;n.adBreakPos=(null!=(s=null==i||null==i.getAdPosition?void 0:i.getAdPosition())?s:1)-1,r.sessionFlags.likelyBreakPos=n.adBreakPos}catch(t){n.adBreakPos=e?r.sessionFlags.likelyBreakPos:0}n.adGid=r.utils.sessionId+"-"+n.adBreak+"-"+n.adBreakPos;try{var a=null==i||null==i.getTotalAds?void 0:i.getTotalAds();r.sessionFlags.totalAds||(r.sessionFlags.totalAds={}),r.sessionFlags.totalAds[n.adBreak]=a}catch(t){}}else e&&(n.adBreak=r.sessionFlags.likelyBreak,n.adBreakPos=r.sessionFlags.likelyBreakPos,n.adGid=r.utils.sessionId+"-"+n.adBreak+"-"+n.adBreakPos);return n},r._adError=function(t,e){var n,i,o={type:"error"};return t&&("string"==typeof t?o.err=t:(o.st=null==t||null==t.getType?void 0:t.getType(),o.err=null==t||null==t.getVastErrorCode?void 0:t.getVastErrorCode(),o.err2=null==t||null==t.getErrorCode?void 0:t.getErrorCode())),Object.assign(o,r._getAdPod(e,!0)),null!=(n=r.sessionFlags)&&null!=(i=n.totalAds)&&i[r.sessionFlags.likelyBreak]?r.sessionFlags.likelyBreakPos<r.sessionFlags.totalAds[r.sessionFlags.likelyBreak]-1?r.sessionFlags.likelyBreakPos++:(r.sessionFlags.likelyBreak++,r.sessionFlags.likelyBreakPos=0):r.sessionFlags.likelyBreakPos++,o},r.PLAYER_EVENTS={ready:playlistItem:function(){return r.sessionFlags.resetOnInit&&r.resetState(),r.sessionFlags.resetOnInit=!0,{type:"init",aBl:r.getAdBlock()}},adsManager:function(t){var e=function(t){r.player.trigger("wtat-"+t.type,{originalEvent:t})};S.forEach(()},adBreakStart:function(){var t;r.sessionFlags.duringAd=!0,r.sessionFlags.likelyBreak>0&&(null==(t=r.sessionFlags.podEndedRanFor)||!t.includes(r.sessionFlags.likelyBreak-1))&&r.sessionFlags.likelyBreak++,r.sessionFlags.likelyBreakPos=0},adBreakEnd:function(){delete r.sessionFlags.duringAd,r.sessionFlags.podEndedRanFor||(r.sessionFlags.podEndedRanFor=[]),r.sessionFlags.podEndedRanFor.push(r.sessionFlags.likelyBreak),r.sessionFlags.likelyBreak++,r.sessionFlags.likelyBreakPos=0},adRequest:function(t){return{type:"serve",adURL:t.tag,adMgV:r.getAdMgV()}},"wtat-loaded":function(t){var e={type:"al"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdPod(n)),e},"wtat-start":function(t){var e={type:"sa"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdDetails(n)),Object.assign(e,r._getAdPod(n)),e},"wtat-impression":function(t){var e={type:"imp"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdPod(n)),e},"wtat-firstQuartile":function(t){var e={type:"efq"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdPod(n)),e},"wtat-midpoint":function(t){var e={type:"esq"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdPod(n)),e},"wtat-thirdQuartile":function(t){var e={type:"etq"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdPod(n)),e},"wtat-complete":function(t){var e={type:"ecp"},n=t.originalEvent.getAd();Object.assign(e,r._getAdPod(n));var i=null==n||null==n.getAdPodInfo?void 0:n.getAdPodInfo();return i&&(i.getAdPosition()<i.getTotalAds()?r.sessionFlags.likelyBreakPos++:(r.sessionFlags.likelyBreak++,r.sessionFlags.likelyBreakPos=0)),e},"wtat-mute":function(t){var e={type:"mute"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdPod(n)),e},"wtat-unmute":function(t){var e={type:"unmute"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdPod(n)),e},"wtat-click":function(t){var e={type:"adClick"},n=t.originalEvent.getAd();return Object.assign(e,r._getAdPod(n)),e},"wtat-adError":function(t){return{type:"wtat-adError",debug:JSON.stringify(Object.keys(t.originalEvent))}},"wtat-log":function(t){var e,n;return r._adError(null==(e=t.originalEvent)||null==e.getAdData||null==(n=e.getAdData())?void 0:n.adError,t.originalEvent.getAd())},adError:function(t){if(!t.ima)return Object.assign({type:"error",err:t.code,err2:t.adErrorCode},r._adError())},beforePlay:function(t){if(!r.sessionFlags.playSent){r.sessionFlags.playSent=!0;var e={type:"play",autoplay:!1};return"autostart"===t.playReason&&(e.autoplay=!0),e}},firstFrame:function(t){var e=t.loadTime;return r.sessionFlags.c0Sent=!0,{type:"c0",custom:{ttFF:e}}},time:function(t){if(r.sessionFlags.c0Sent){var e=Math.floor(100*t.position/t.duration);if(!r.sessionFlags.c95Sent&&e>=95)return r.sessionFlags.c95Sent=!0,r.sessionFlags.c75Sent=!0,r.sessionFlags.c50Sent=!0,r.sessionFlags.c25Sent=!0,{type:"c95"};if(!r.sessionFlags.c75Sent&&e>=75)return r.sessionFlags.c75Sent=!0,r.sessionFlags.c50Sent=!0,r.sessionFlags.c25Sent=!0,{type:"c75"};if(!r.sessionFlags.c50Sent&&e>=50)return r.sessionFlags.c50Sent=!0,r.sessionFlags.c25Sent=!0,{type:"c50"};if(!r.sessionFlags.c25Sent&&e>=25)return r.sessionFlags.c25Sent=!0,{type:"c25"}}}},r.start=function(){r.utils=new b(r.options,e(r)),r.log=r.utils.logger("WTAT."+r.SHORT_NAME),r.resetState();for(var t=0,n=Object.entries(A(window,["wtatCustom","events"],{}));t<n.length;t++){var i=n[t],o=i[0],s=i[1];r.PLAYER_EVENTS[o]?r.PLAYER_EVENTS[o]=[r.PLAYER_EVENTS[o],s]:r.PLAYER_EVENTS[o]=s}Object.keys(r.PLAYER_EVENTS).forEach(()},r.resetState=function(){r.log("resetting state"),r.sessionFlags={likelyBreak:0,likelyBreakPos:0},r.utils.createSession()},Object.defineProperty(e(r),I,{writable:!0,value:function(t,n){var o;if("function"==typeof t)try{o=t(n)}catch(t){r.log("Error executing event listener for",n.type,t.message)}else if(!0===t)o={type:n.type};else if(Array.isArray(t)){o=[];for(var a,l=i(t);!(a=l()).done;){var d=a.value;o.push(s(e(r),I)[I](d,n))}}else o=t;return o}}),r._onPlayerEvent=function(t){if(r.PLAYER_EVENTS[t.type]){var n=s(e(r),I)[I](r.PLAYER_EVENTS[t.type],t);Array.isArray(n)&&(n=Object.assign.apply(Object,n)),n&&(n.type?r.utils.sendData(n):r.log("Encountered an event without a type. Not sending",t.type,n))}else r.log("Untracked player event triggered",t.type,t)},r.getVideoSlot=r.getMediaId=function(){var t;return null==(t=r.player.getPlaylistItem())?void 0:t.mediaid},r.getPlayerId=r.getPlayerVersion=function(){if(!r.sessionFlags.plV){var t=r.player.version.split(/\W/);r.sessionFlags.plV=t[0]+"."+t[1]+"."+t[2]}return r.sessionFlags.plV},r.getAdBlock=function(){return+r.player.getAdBlock()},r.getAdMgV=function(){var t,e;return null==(t=google)||null==(e=t.ima)?void 0:e.VERSION},r.getPercentViewable=r.getIsLive=function(){return Number(r.player.getDuration()===1/0)},r.player=t,r.options=o,r.options.src=r.SHORT_NAME,"debug"===r.options.debug)debugger;return r}return r=n,(o=a).prototype=Object.create(r.prototype),o.prototype.constructor=o,t(o,r),a}(l),O={v:"5.8.0"},j={};try{var C=localStorage.getItem("wtDebug"),_=localStorage.getItem("wtUrl");C&&(j.debug=C),_&&(j.wtUrl=_)}catch(t){}function V(t,e){var n=Object.assign({},O,e,j);n.wtatCustom&&(window.wtatCustom=window.wtatCustom||{},n.wtatCustom.fields&&(window.wtatCustom.fields=Object.assign({},window.wtatCustom.fields||{},n.wtatCustom.fields)),n.wtatCustom.events&&(window.wtatCustom.events=Object.assign({},window.wtatCustom.events||{},n.wtatCustom.events)),n.wtatCustom.ignoredEvents&&(window.wtatCustom.ignoredEvents=[].concat(window.wtatCustom.ignoredEvents||[],n.wtatCustom.ignoredEvents)),delete n.wtatCustom);var i=new B(t,n);t.wtAdTracer=i,i.start()}var R;return!(R=window.jwplayerPluginJsonp)&&"function"==typeof window.jwplayer&&window.jwplayer().registerPlugin&&(R=window.jwplayer().registerPlugin),R&&R("us.wtat.plugin-jw_ima.min","8.17.0",(),function(t,e,n){var i;void 0===t&&(t={}),void 0===n&&(n=!1),e?"string"==typeof e?i=jwplayer(e):"object"==typeof e&&e.id?i=jwplayer(e.id):e.on&&(i=e):i=jwplayer(),n?V(i,t):i.on("ready",()}}();
