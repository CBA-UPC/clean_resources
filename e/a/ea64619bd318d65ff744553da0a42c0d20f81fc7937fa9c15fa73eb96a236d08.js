"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7553],{46154:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Ce});l(75930),l(46758),l(53321),l(65484),l(35174),l(96241);var a=l(50959),n=l(29132),r=l(75802),i=l(74965),s=l(43495),o=l(11317),c=l(85648),u=l(41038),d=l(38024),g=l(91643),f=l(50879),m=l(65432),p=l(36199),y=l(50216),h=l(61046),k=l(57370),T=l(19848),x=l(47262),F=(l(86277),l(73516)),C=l(1666),j=l(75516),b=l(91054);function D(e,t,l){const a={uri:e};return(0,F.R4)(a,t),(0,C.U6)(a,null==l?void 0:l.map((e=>(0,j.cj)(e)??null)).filter(b.K)),a}var I=l(20980),S=l(22527),v=l(80626),E=l(10226),P=l(57562),w=l(80683),L=l(57986),A=l(67408),M=l(5542),N=l(47895),R=(l(80378),l(51837)),_=l(87236),K=l(8824),Q=l(55538),U=l(11527);const B=a.memo((e=>{let{tracklistDomRef:t}=e;const{spec:l,logger:n}=(0,v.fU)(R.createDesktopSearchBarEventFactory,{}),r=(0,a.useCallback)((()=>{n.logInteraction(l.filterFieldFactory().keyStrokeFilter())}),[n,l]),i=(0,a.useCallback)((()=>{n.logInteraction(l.filterFieldFactory().hitClearFilter())}),[n,l]),s=(0,_.v)().filter((e=>y.P0.includes(e)));return(0,U.jsxs)("div",{className:f.Z.searchBoxContainer,children:[(0,U.jsx)(a.Suspense,{fallback:null,children:(0,U.jsx)(K.K,{placeholder:c.ag.get("playlist.search_in_playlist"),clearOnEscapeInElementRef:t,onFilter:r,onClear:i})}),(0,U.jsx)(Q.l,{columns:s})]})}));l(45205);var O=l(82187),q=l.n(O),V=l(79612),W=l(66205),z=l(59047),G=l(1469),H=l(42340),J=l(76950),Z=l(22795),$=l(90284),X=l(65786);const Y="liked-songs-tags";function ee(){return(0,X.z)("liked-songs-current-tag-filter",null)}const te="bnAGyFvicDJD8TnVSKnq",le=e=>({id:e.filter,getName:()=>e.name,ubiId:e.name}),ae=(0,a.memo)((e=>{let{spec:t,nrTracks:l}=e;const{tags:n,currentTag:r,setCurrentTag:i}=function(e){let{nrTracks:t}=e;const l=(0,Z.y)(),n=(0,z.NL)(),[r,i]=ee(),[s,o]=(0,a.useState)([]),{data:c}=(0,G.a)({queryKey:[Y],queryFn:()=>null==l?void 0:l.getTracksFilterTags(),staleTime:0,gcTime:864e5,placeholderData:H.Wk,refetchOnWindowFocus:!1});(0,a.useLayoutEffect)((()=>{if(!(null==c?void 0:c.find((e=>e.filter===r)))&&r){if(t>0)return;i(null)}o(c??[])}),[r,i,t,c]);const u=(0,a.useCallback)((e=>{let{data:{list:t}}=e;t===J.XD.TRACKS&&n.invalidateQueries({queryKey:[Y]})}),[n]);(0,$.b)(J.EW.UPDATE,u);const d=(0,a.useMemo)((()=>s.find((e=>e.filter===r))),[r,s]),g=(0,a.useCallback)((e=>{i((null==e?void 0:e.filter)??null)}),[i]);return{tags:r||t?s:[],currentTag:d,setCurrentTag:g}}({nrTracks:l}),s=(0,v.$P)(),o=(0,a.useCallback)(((e,l,a)=>{let r;if(!e)return r=t.clearButtonFactory().hitClearFilter(),void s.logInteraction(r);const o=n.find((t=>{let{filter:l}=t;return l===e}));if(!o)return;const c=t.filterChipFactory({identifier:o.name,position:a});l?(r=c.hitClearFilter(),i(null)):(r=c.hitFilter(),o&&i(o)),s.logInteraction(r)}),[s,i,t,n]),u=r?[]:n.map(le),d=r?[le(r)]:[];return n.length?(0,U.jsx)(W.F,{children:(0,U.jsx)(V.V,{availableFilters:u,selectedFilters:d,toggleFilterId:()=>{},resetFilterIds:()=>i(null),onFilterClick:o,ariaLabel:c.ag.get("web-player.liked-songs.liked-songs-filter-tags"),clearBtnAriaLabel:c.ag.get("web-player.liked-songs.clear-filter"),className:q()(te),applyLightThemeControls:!0})}):null}));var ne=l(15842),re=l(66819),ie=l(17676),se=l(25230),oe=l(72417);const ce="bKlB8pmFVoswJlZ_jhtL",ue=a.memo((function(e){let{metadata:t,onClickTogglePlay:l,isPlaying:n,spec:r,logger:i,backgroundColor:s,canSort:o,canFilter:u}=e;const{uri:d,name:g,totalLength:f}=t,m=(0,a.useRef)(null),p=(0,a.useMemo)((()=>r.actionBarFactory()),[r]),y=(0,a.useMemo)((()=>p.shuffleButtonContainerFactory()),[p]),h=(0,a.useMemo)((()=>p.filtersFactory()),[p]),k=f>0,T=f>0,x=o&&u,F=(0,oe.Q)(),C=(0,a.useCallback)(((e,t)=>{const l=p.downloadButtonFactory();t===M.mc.ADD?i.logInteraction(l.hitDownload({itemToDownload:d})):t===M.mc.REMOVE?i.logInteraction(l.hitRemoveDownload({itemToRemoveFromDownloads:d})):t===M.mc.NO_PERMISSION&&i.logInteraction(l.hitUiReveal())}),[p,i,d]),j=(0,re.j)(),b=(0,E.W6)(ie.rVA);return(0,U.jsxs)(ne.o,{backgroundColor:s,children:[(0,U.jsxs)(W.F,{children:[T?(0,U.jsx)(L.$,{onClick:l,isPlaying:n,size:j,uri:d,ariaPauseLabel:c.ag.get("playlist.a11y.pause",g),ariaPlayLabel:c.ag.get("playlist.a11y.play",g)}):null,F&&(0,U.jsx)(v.Nh,{spec:y,children:(0,U.jsx)(se.K,{entityName:g,contextUri:d,activationPlacement:"bottomEnd",size:j})}),(0,U.jsx)(P.o,{uri:d,canDownload:k,isFollowing:!0,onFollow:()=>{},size:j,onClick:C}),x?(0,U.jsx)(v.Nh,{spec:p,children:(0,U.jsx)(B,{tracklistDomRef:m})}):(0,U.jsx)("div",{className:ce,children:(0,U.jsx)(w.F,{property:N.FM,renderNewExperience:()=>(0,U.jsx)(A.A,{options:[],onSelect:()=>{},selected:null,enableViewModeMenu:!0})})})]}),b&&(0,U.jsx)(ae,{spec:h,nrTracks:f})]})}));var de=l(30933),ge=l(18615),fe=l(56822),me=l(64222),pe=l(87350),ye=l(93295),he=l(44450),ke=l(62675);const Te=[p.QD.INDEX,p.QD.TITLE_AND_ARTIST,p.QD.ALBUM,p.QD.ADDED_AT,p.QD.DURATION],xe=e=>{let{data:t,canFilter:l,canSort:n}=e;const{uri:o,name:F,totalLength:C}=t.metadata,j=(0,a.useRef)(null),I=(0,x.Y5)("#5038a0"),[E]=ee(),{filter:P}=(0,a.useContext)(m.fo),{sortState:w,setSortState:L}=(0,a.useContext)(y.Gb),{spec:A,logger:M}=(0,v.fU)(s.Q,{data:{uri:o}}),N=a.useMemo((()=>A.headerFactory()),[A]),R=a.useMemo((()=>A.tracklistFactory()),[A]);(0,a.useEffect)((()=>{null===w.column&&L({column:p.QD.ADDED_AT,order:p.kn.DESC})}),[w,L]);const _=(0,r.ur)(),K=(0,r.TH)(),Q="POP"!==_?new URLSearchParams(K.search).get("uri"):null,{isPlaying:B,togglePlay:O,usePlayContextItem:q,isActive:V}=(0,S.n)(D(o,(0,de.w)(w),[P,E].filter(b.K)),{featureIdentifier:"your_library",referrerIdentifier:"your_library"}),W=()=>{const e=(0,me.aK)({isPlaying:B,isActive:V,spec:A.actionBarFactory().playButtonFactory(),logger:M,uri:o});O({loggingParams:e})},[z]=(0,fe.d4)(),{isCompactMode:G}=(0,T.mJ)(),H=(e=>{let{isCompactMode:t=!1}=e;const l=[...Te];return t&&l.splice(l.indexOf(p.QD.TITLE_AND_ARTIST),1,p.QD.TITLE,p.QD.ARTIST),l})({isCompactMode:G});return(0,U.jsx)(h.a,{columns:H,children:(0,U.jsxs)("section",{role:"presentation",className:f.Z.playlist,"data-testid":"playlist-page",children:[(0,U.jsx)(u.$,{children:c.ag.get("playlist.page-title",F)}),(0,U.jsx)(k.s,{metadata:{...t.metadata,hasSpotifyTracks:!0},totalItems:z,isPlaying:B,togglePlay:W,backgroundColor:I,specLikedSongs:N}),(0,U.jsx)(ue,{metadata:t.metadata,onClickTogglePlay:W,isPlaying:B,spec:A,logger:M,backgroundColor:I,canSort:n,canFilter:l}),(0,U.jsx)("div",{className:"contentSpacing",children:C>0?(0,U.jsx)(a.Suspense,{fallback:(0,U.jsx)(g.h,{hasError:!1,errorMessage:c.ag.get("error.request-collection-tracks-failure")}),children:(0,U.jsx)(v.Nh,{spec:R,children:(0,U.jsx)(ge.p,{nrTracks:C,collectionUri:o,scrollToUri:Q,usePlayContextItem:q,outerDomRef:j,spec:R,initialItems:t.contents.items,isCompactMode:G,tagFilter:E})})}):(0,U.jsx)(d.u,{message:c.ag.get("collection.empty-page.songs-subtitle"),title:c.ag.get("collection.empty-page.songs-title"),linkTo:"/search",linkTitle:c.ag.get("collection.empty-page.songs-cta"),renderInline:!0,children:(0,U.jsx)(i.F,{"aria-hidden":"true"})})})]})})},Fe=a.memo((function(e){let{user:t,uri:l}=e;const{filter:n}=(0,a.useContext)(m.fo),{sortState:r}=(0,a.useContext)(y.Gb),[i]=ee(),s=function(e,t,l){const n=(0,a.useContext)(I.H),r=(0,z.NL)(),i=(0,ye.jP)((()=>["useLikedSongs",e,l]),[e,l]),{data:s}=(0,G.a)({queryKey:i(),queryFn:()=>n.getTracks(l),gcTime:18e5,placeholderData:H.Wk,refetchOnWindowFocus:!1}),o=(0,a.useCallback)((()=>{r.invalidateQueries({queryKey:i()})}),[r,i]);(0,$.b)(J.EW.UPDATE,o);const c=(0,ke.I2)(t.id);return c&&s?{metadata:{uri:e,name:c.name,images:c.images,totalLength:null==s?void 0:s.totalLength,unfilteredTotalLength:s.unfilteredTotalLength,owner:(0,he.V)(t)},contents:s}:null}(l,t,{offset:0,limit:25,sort:(0,de.w)(r),filters:[n,i].filter(b.K)}),o=(0,a.useContext)(I.H).getCapabilities();return s?(0,U.jsx)(xe,{data:s,canFilter:o.canFilterTracksAndEpisodes&&s.metadata.unfilteredTotalLength>0,canSort:o.canSortTracksAndEpisodes&&s.metadata.unfilteredTotalLength>0}):(0,U.jsx)(g.h,{hasError:!1,errorMessage:c.ag.get("error.not_found.title.playlist"),loadOffline:o.canModifyOffline})})),Ce=()=>{const{user:e}=(0,n.v9)(pe.Gg);if(null===e)return null;const t=(0,o.wG)(e.id).toURI();return(0,U.jsx)(y.kz,{uri:t,children:(0,U.jsx)(m.hz,{uri:t,children:(0,U.jsx)(fe.Y4,{children:(0,U.jsx)(Fe,{uri:t,user:e})})})})}}}]);
//# sourceMappingURL=xpui-routes-collection-songs.b7e6811a.js.map