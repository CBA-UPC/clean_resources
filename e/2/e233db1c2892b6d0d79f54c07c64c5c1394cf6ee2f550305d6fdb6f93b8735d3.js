/**
 * IMPORTANT NOTE:
 *
 * This file is licensed only for the use of Apple developers in providing MusicKit Web Services,
 * and is subject to the Apple Media Services Terms and Conditions and the Apple Developer Program
 * License Agreement. You may not copy, modify, re-host, or create derivative works of this file or the
 * accompanying Documentation, or any part thereof, including any updates, without Apple's written consent.
 *
 * ACKNOWLEDGEMENTS:
 * https://js-cdn.music.apple.com/musickit/v1/acknowledgements.txt
 */

!this,(function(e){"use strict";var t=void 0!==typeof self?self:this,r="undefined"!=typeof FastBoot?FastBoot.require("buffer").Buffer:"undefined"!=typeof process&&null!==process.versions&&null!==process.versions.node?Buffer:window.Buffer;t n=memoize(e=>/^[a|i|l|p]{1}\.[a-zA-Z0-9]+$/.test(e)),i=memoize(e=>/^(a\.)?[a-zA-Z0-9]+$/.test(e));nst o=memoize(detectNodeEnvironment()?e=>window.atob(e));memoize(detectNodeEnvironment()?e=>window.btoa(e));const debounce=arrayEquals=a=memoize(,s=memoize(;onst c=memoize(,l=memoize(,d=memoize(;n hasSessionStorage(){let e=!1;try{e="undefined"!=typeof sessionStorage}catch(t){}return e}function getSessionStorage(){let e;return hasSessionStorage()&&(e=sessionStorage),e}ction _define_property$22(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}et isMergeableObject=let u="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;ion _define_property$21(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$21(e,t,r[t])}))}return e}function _object_spread_props$v(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _object_without_properties$2(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var p;deepmerge.all=p||(p={}));const isDataRecord=nction _define_property$20(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}unction _define_property$1$(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const h={INVALID_ERROR_ID:"INVALID_ERROR_ID",INVALID_ERROR_REASON:"INVALID_ERROR_REASON",ACCESS_DENIED:"ACCESS_DENIED",AGE_VERIFICATION:"AGE_VERIFICATION",AGE_GATE:"AGE_GATE",AUTHORIZATION_ERROR:"AUTHORIZATION_ERROR",BUFFER_STALLED_ERROR:"BUFFER_STALLED_ERROR",CONFIGURATION_ERROR:"CONFIGURATION_ERROR",CONTENT_EQUIVALENT:"CONTENT_EQUIVALENT",CONTENT_RESTRICTED:"CONTENT_RESTRICTED",CONTENT_UNAVAILABLE:"CONTENT_UNAVAILABLE",CONTENT_UNSUPPORTED:"CONTENT_UNSUPPORTED",DEVICE_LIMIT:"DEVICE_LIMIT",GEO_BLOCK:"GEO_BLOCK",INVALID_ARGUMENTS:"INVALID_ARGUMENTS",PLAYREADY_CBC_ENCRYPTION_ERROR:"PLAYREADY_CBC_ENCRYPTION_ERROR",MEDIA_CERTIFICATE:"MEDIA_CERTIFICATE",MEDIA_DESCRIPTOR:"MEDIA_DESCRIPTOR",MEDIA_LICENSE:"MEDIA_LICENSE",MEDIA_KEY:"MEDIA_KEY",MEDIA_PLAYBACK:"MEDIA_PLAYBACK",MEDIA_SESSION:"MEDIA_SESSION",NETWORK_ERROR:"NETWORK_ERROR",NOT_FOUND:"NOT_FOUND",PARSE_ERROR:"PARSE_ERROR",PLAY_ACTIVITY:"PLAY_ACTIVITY",REQUEST_ERROR:"REQUEST_ERROR",QUOTA_EXCEEDED:"QUOTA_EXCEEDED",SERVER_ERROR:"SERVER_ERROR",SERVICE_UNAVAILABLE:"SERVICE_UNAVAILABLE",STREAM_UPSELL:"STREAM_UPSELL",SUBSCRIPTION_ERROR:"SUBSCRIPTION_ERROR",TOKEN_EXPIRED:"TOKEN_EXPIRED",UNAUTHORIZED_ERROR:"UNAUTHORIZED_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR",UNSUPPORTED_ERROR:"UNSUPPORTED_ERROR",USER_INTERACTION_REQUIRED:"USER_INTERACTION_REQUIRED",INTERNAL_ERROR:"INTERNAL_ERROR",OUTPUT_RESTRICTED:"OUTPUT_RESTRICTED",WIDEVINE_CDM_EXPIRED:"WIDEVINE_CDM_EXPIRED"},y={400:h.REQUEST_ERROR,401:h.UNAUTHORIZED_ERROR,403:h.ACCESS_DENIED,404:h.NOT_FOUND,405:h.NOT_FOUND,413:h.REQUEST_ERROR,414:h.REQUEST_ERROR,429:h.QUOTA_EXCEEDED,500:h.SERVER_ERROR,501:h.NOT_FOUND,503:h.SERVICE_UNAVAILABLE},_={"-1004":h.DEVICE_LIMIT,"-1017":h.GEO_BLOCK,1010:h.NOT_FOUND,2002:h.AUTHORIZATION_ERROR,2034:h.TOKEN_EXPIRED,3059:h.DEVICE_LIMIT,3063:h.SUBSCRIPTION_ERROR,3076:h.CONTENT_UNAVAILABLE,3082:h.CONTENT_RESTRICTED,3084:h.STREAM_UPSELL,5002:h.SERVER_ERROR,180202:h.PLAYREADY_CBC_ENCRYPTION_ERROR,190121:h.WIDEVINE_CDM_EXPIRED},f=new Set([h.CONTENT_EQUIVALENT,h.CONTENT_UNAVAILABLE,h.CONTENT_UNSUPPORTED,h.SERVER_ERROR,h.SUBSCRIPTION_ERROR,h.UNSUPPORTED_ERROR,h.USER_INTERACTION_REQUIRED]);define_property$1$(MKError,"Reason",h),Object.assign(MKError,h);unction _define_property$1_(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const DEFAULT_CACHE_KEY_FUNCTION=}function _define_property$1Z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1Z(e,t,r[t])}))}return e}function _object_spread_props$u(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const addPathToUR),addQueryParamsToUR},v="undefined"!=typeof Headers,headersToDic},mergeFetchHeader),mergeFetchOptionnst recursiveEncodeParameter}function asyncGeneratorStep$1q(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$1Y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1Y(e,t,r[t])}))}return e}var g;!function(e){e.JSON="application/json",e.FORM="application/x-www-form-urlencoded"}(g||(g={}))}}Date.now();isNodeEnvironment$1();const m=/\/(?:([a-z]{2})\/)?(album|artist|episode|movie|music-video|playlist|podcast|post|season|show|song|station)\/(?:[^/]*\/)?(?:id)?(\d+|[a-z]{2}\.[a-z0-9-]+|umc.cmc.[a-zA-Z0-9]+)(?:.*(?:[?|&]i=(\d+)).*)?.*}}const b=/^http(?:s)?\:\/\/(?:itunes|(embed\.)?(music|podcasts|tv))\.apple\.com/i,S=["allow-forms","allow-popups","allow-same-origin","allow-scripts","allow-storage-access-by-user-activation","allow-top-navigation-by-user-activation"],P=["autoplay *","encrypted-media *","fullscreen *","clipboard-write"];var E,T;e.PlaybackType=void 0,(E=e.PlaybackType||(e.PlaybackType={}))[E.none=0]="none",E[E.preview=1]="preview",E[E.unencryptedFull=2]="unencryptedFull",E[E.encryptedFull=3]="encryptedFud"}(T||(T={}));const k={AFG:"143610",AGO:"143564",AIA:"143538",ALB:"143575",AND:"143611",ARE:"143481",ARG:"143505",ARM:"143524",ATG:"143540",AUS:"143460",AUT:"143445",AZE:"143568",BEL:"143446",BEN:"143576",BFA:"143578",BGD:"143490",BGR:"143526",BHR:"143559",BHS:"143539",BIH:"143612",BLR:"143565",BLZ:"143555",BMU:"143542",BOL:"143556",BRA:"143503",BRB:"143541",BRN:"143560",BTN:"143577",BWA:"143525",CAF:"143623",CAN:"143455",CHE:"143459",CHL:"143483",CHN:"143465",CIV:"143527",CMR:"143574",COD:"143613",COG:"143582",COL:"143501",CPV:"143580",CRI:"143495",CYM:"143544",CYP:"143557",CZE:"143489",DEU:"143443",DMA:"143545",DNK:"143458",DOM:"143508",DZA:"143563",ECU:"143509",EGY:"143516",ESP:"143454",EST:"143518",ETH:"143569",FIN:"143447",FJI:"143583",FRA:"143442",FSM:"143591",GAB:"143614",GBR:"143444",GEO:"143615",GHA:"143573",GIN:"143616",GMB:"143584",GNB:"143585",GRC:"143448",GRD:"143546",GTM:"143504",GUY:"143553",HKG:"143463",HND:"143510",HRV:"143494",HUN:"143482",IDN:"143476",IND:"143467",IRL:"143449",IRQ:"143617",ISL:"143558",ISR:"143491",ITA:"143450",JAM:"143511",JOR:"143528",JPN:"143462",KAZ:"143517",KEN:"143529",KGZ:"143586",KHM:"143579",KNA:"143548",KOR:"143466",KWT:"143493",LAO:"143587",LBN:"143497",LBR:"143588",LBY:"143567",LCA:"143549",LIE:"143522",LKA:"143486",LTU:"143520",LUX:"143451",LVA:"143519",MAC:"143515",MAR:"143620",MCO:"143618",MDA:"143523",MDG:"143531",MDV:"143488",MEX:"143468",MKD:"143530",MLI:"143532",MLT:"143521",MMR:"143570",MNE:"143619",MNG:"143592",MOZ:"143593",MRT:"143590",MSR:"143547",MUS:"143533",MWI:"143589",MYS:"143473",NAM:"143594",NER:"143534",NGA:"143561",NIC:"143512",NLD:"143452",NOR:"143457",NPL:"143484",NRU:"143606",NZL:"143461",OMN:"143562",PAK:"143477",PAN:"143485",PER:"143507",PHL:"143474",PLW:"143595",PNG:"143597",POL:"143478",PRT:"143453",PRY:"143513",PSE:"143596",QAT:"143498",ROU:"143487",RUS:"143469",RWA:"143621",SAU:"143479",SEN:"143535",SGP:"143464",SLB:"143601",SLE:"143600",SLV:"143506",SRB:"143500",STP:"143598",SUR:"143554",SVK:"143496",SVN:"143499",SWE:"143456",SWZ:"143602",SYC:"143599",TCA:"143552",TCD:"143581",THA:"143475",TJK:"143603",TKM:"143604",TON:"143608",TTO:"143551",TUN:"143536",TUR:"143480",TWN:"143470",TZA:"143572",UGA:"143537",UKR:"143492",URY:"143514",USA:"143441",UZB:"143566",VCT:"143550",VEN:"143502",VGB:"143543",VNM:"143471",VUT:"143609",WSM:"143607",XKX:"143624",YEM:"143571",ZAF:"143472",ZMB:"143622",ZWE:"143605"};function asyncGeneratorStep$1p(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1p(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1p(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1p(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}const w={AW:"ABW",AF:"AFG",AO:"AGO",AI:"AIA",AX:"ALA",AL:"ALB",AD:"AND",AE:"ARE",AR:"ARG",AM:"ARM",AS:"ASM",AQ:"ATA",TF:"ATF",AG:"ATG",AU:"AUS",AT:"AUT",AZ:"AZE",BI:"BDI",BE:"BEL",BJ:"BEN",BQ:"BES",BF:"BFA",BD:"BGD",BG:"BGR",BH:"BHR",BS:"BHS",BA:"BIH",BL:"BLM",BY:"BLR",BZ:"BLZ",BM:"BMU",BO:"BOL",BR:"BRA",BB:"BRB",BN:"BRN",BT:"BTN",BV:"BVT",BW:"BWA",CF:"CAF",CA:"CAN",CC:"CCK",CH:"CHE",CL:"CHL",CN:"CHN",CI:"CIV",CM:"CMR",CD:"COD",CG:"COG",CK:"COK",CO:"COL",KM:"COM",CV:"CPV",CR:"CRI",CU:"CUB",CW:"CUW",CX:"CXR",KY:"CYM",CY:"CYP",CZ:"CZE",DE:"DEU",DJ:"DJI",DM:"DMA",DK:"DNK",DO:"DOM",DZ:"DZA",EC:"ECU",EG:"EGY",ER:"ERI",EH:"ESH",ES:"ESP",EE:"EST",ET:"ETH",FI:"FIN",FJ:"FJI",FK:"FLK",FR:"FRA",FO:"FRO",FM:"FSM",GA:"GAB",GB:"GBR",GE:"GEO",GG:"GGY",GH:"GHA",GI:"GIB",GN:"GIN",GP:"GLP",GM:"GMB",GW:"GNB",GQ:"GNQ",GR:"GRC",GD:"GRD",GL:"GRL",GT:"GTM",GF:"GUF",GU:"GUM",GY:"GUY",HK:"HKG",HM:"HMD",HN:"HND",HR:"HRV",HT:"HTI",HU:"HUN",ID:"IDN",IM:"IMN",IN:"IND",IO:"IOT",IE:"IRL",IR:"IRN",IQ:"IRQ",IS:"ISL",IL:"ISR",IT:"ITA",JM:"JAM",JE:"JEY",JO:"JOR",JP:"JPN",KZ:"KAZ",KE:"KEN",KG:"KGZ",KH:"KHM",KI:"KIR",KN:"KNA",KR:"KOR",KW:"KWT",LA:"LAO",LB:"LBN",LR:"LBR",LY:"LBY",LC:"LCA",LI:"LIE",LK:"LKA",LS:"LSO",LT:"LTU",LU:"LUX",LV:"LVA",MO:"MAC",MF:"MAF",MA:"MAR",MC:"MCO",MD:"MDA",MG:"MDG",MV:"MDV",MX:"MEX",MH:"MHL",MK:"MKD",ML:"MLI",MT:"MLT",MM:"MMR",ME:"MNE",MN:"MNG",MP:"MNP",MZ:"MOZ",MR:"MRT",MS:"MSR",MQ:"MTQ",MU:"MUS",MW:"MWI",MY:"MYS",YT:"MYT",NA:"NAM",NC:"NCL",NE:"NER",NF:"NFK",NG:"NGA",NI:"NIC",NU:"NIU",NL:"NLD",NO:"NOR",NP:"NPL",NR:"NRU",NZ:"NZL",OM:"OMN",PK:"PAK",PA:"PAN",PN:"PCN",PE:"PER",PH:"PHL",PW:"PLW",PG:"PNG",PL:"POL",PR:"PRI",KP:"PRK",PT:"PRT",PY:"PRY",PS:"PSE",PF:"PYF",QA:"QAT",RE:"REU",RO:"ROU",RU:"RUS",RW:"RWA",SA:"SAU",SD:"SDN",SN:"SEN",SG:"SGP",GS:"SGS",SH:"SHN",SJ:"SJM",SB:"SLB",SL:"SLE",SV:"SLV",SM:"SMR",SO:"SOM",PM:"SPM",RS:"SRB",SS:"SSD",ST:"STP",SR:"SUR",SK:"SVK",SI:"SVN",SE:"SWE",SZ:"SWZ",SX:"SXM",SC:"SYC",SY:"SYR",TC:"TCA",TD:"TCD",TG:"TGO",TH:"THA",TJ:"TJK",TK:"TKL",TM:"TKM",TL:"TLS",TO:"TON",TT:"TTO",TN:"TUN",TR:"TUR",TV:"TUV",TW:"TWN",TZ:"TZA",UG:"UGA",UA:"UKR",UM:"UMI",UY:"URY",US:"USA",UZ:"UZB",VA:"VAT",VC:"VCT",VE:"VEN",VG:"VGB",VI:"VIR",VN:"VNM",VU:"VUT",WF:"WLF",WS:"WSM",XK:"XKX",YE:"YEM",ZA:"ZAF",ZM:"ZMB",ZW:"ZWE"};const O={af:48,sq:1,ar:34,eu:1,bg:49,be:1,ca:42,zh:19,"zh-tw":18,"zh-cn":19,"zh-hk":45,"zh-sg":19,hr:41,cs:22,da:11,nl:10,"nl-be":65,en:1,"en-us":1,"en-eg":26,"en-au":27,"en-gb":2,"en-ca":6,"en-nz":27,"en-ie":26,"en-za":26,"en-jm":26,"en-bz":26,"en-tt":26,"en-001":26,et:30,fo:1,fa:59,fi:12,fr:3,"fr-ca":5,gd:2,de:4,"de-ch":57,el:23,he:36,hi:50,hu:21,is:31,id:37,it:7,ja:9,ko:13,lv:33,lt:32,mk:1,mt:1,no:14,nb:14,nn:14,pl:20,"pt-br":15,pt:24,rm:1,ro:39,ru:16,sr:1,sk:40,sl:52,es:8,"es-mx":28,"es-419":44,sv:17,th:35,ts:1,tn:1,tr:25,uk:29,ur:55,ve:1,vi:43,xh:1,yi:1,zu:56,ms:38,iw:36,lo:46,tl:47,kk:51,ta:53,te:54,bn:58,ga:60,ht:61,la:62,pa:63,sa:64};let I="Music-User-Tok[]}I="Media-User-Token";const Aonst R=JsonDevFlag.register("mk-hlsjs-automation-config"),$=new RegExp("^https://([a-z0-9]+-)?"+("js-cdn.music.apple.com"+"/musickit/v3/".replace(/v3/,"(v2|v3)")).replace(/[\.\/]/g,"\\$&"),"i"),C=/^https:\/\/(.*\/includes\/js-cdn)\//i,D=/^([a-z]+:)?\/)}function determineCdnBasePrefix(){for(const e of getScriptSrcElements()){const t=$.exec(e.src);if(t)return t[1]||""}retur}const M=StringDevFlag.register("mk-hlsjs-log-level"),L=StringDevFlag.register("mk-hlsjs-versio}const x=new ,n}const j={CRITICAL:50,ERROR:40,WARNING:30,NOTICE:20,INFO:10,DEBUG:2,TRACE:1,NONE:0};const N={OFF:"NONE",0:"NONE","+":"INFO","++":"DEBUG",V:"DEBUG",D:"DEBUG",VERBOSE:"DEBUG",VV:"TRACE",SILLY:"TRACE","*":"TRAC}function _define_property$1W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1W(e,t,r[t])}))}return e}function _object_spread_props$t(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _define_property1(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const U=j.ERROR,DEFAULT_POL)}}function _define_property$1V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}}const F=/%{([^}]+)}/gi;var B;const V={timestamp:e=>String(e.time),time:e=>String(e.time),datetime:e=>new Date(e.time).toISOString(),dg(),leel),levelnWN",message:e=>e.message,np(),namespace:e=>e.namespace};function _define_property$1U(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const G=new Map([[j.CRITICAL,"error"],[j.ERROR,"error"],[j.WARNING,"warn"],[j.NOTICE,"warn"],[j.INFO,"log"],[j.DEBUG,"debug"]]),H=(W="%{datetime} %{levelname} - [%{namespace}] %{messag))});var W;const q=new Logger$1("storekit");function _define_property$1T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Y=["apps.apple.com","books.apple.com","fitness.apple.com","mediaauth.apple.com","multidev.apple.com","music.apple.com","one.apple.com","podcasts.apple.com","tv.apple.com","itunes.apple.com"];function _define_property$1S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=)}}const z=new Set(["apps","books","music","podcasts","tv"]),Q=/\.apple\.co,r}var J,")}!function(e){e.APP="music",e.P="subscribe"}(J||(J={})),function(e){e.DEFAULT_CID="pldfltcid",e.TV_CID="pltvcid",e.RESTRICTIONS_ENABLED="itre",e.STOREFRONT_COUNTRY_CODE="itua",e.USER_TOKEN="media-user-token"}(X||(X={})),e.SKRealm=void 0,(Z=e.SKRealm||(e.SKRealm={}))[Z.MUSIC=0]="MUSIC",Z[Z.PODCAST=1]="PODCAST",Z[Z.TV=2]="TV";const ee={[e.SKRealm.TV]:"com.apple.onboarding.tvapp",[e.SKRealm.MUSIC]:"com.apple.onboarding.applemusic"},te={[e.SKRealm.TV]:"pltvcid",[e.SKRealm.MUSIC]:"pldfltcid"},re={"com.apple.onboarding.tvapp":5,"com.apple.onboarding.applemusic":3};function asyncGeneratorStep$1o(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$1R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var r"}(ne||(ne={)}}function asyncGeneratorStep$1n(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1n(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1n(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1n(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1Q(e,t,r[t])}))}return e}function _object_spread_props$s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}varD"}(ie||(ie={}));const oe=`https://${getCommerceHostname("buy")}/commerce/account/authenticateMusicKitRequest`,ae="https://authorize.music.apple.com",se=/^https?:\/\/(.+\.)*(apple\.com|apps\.mzstatic\.com)(\/[\w\d]+)*$/;var ce,le,de;!function(e){e[e.AUTHORIZE=0]="AUTHORIZE",e[e.SUBSCRIBE=1]="SUBSCRIBE"}(ce||(ce={}}}function asyncGeneratorStep$1m(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1m(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1m(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1m(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=s)}!function(e){e.ID="us",e.LANGUAGE_TAG="en-gb"}(le||(le={`}}function asyncGeneratorStep$1l(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1l(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1l(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1l(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1O(e,t,r[t])}))}return e}function _ts_metadata$C(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,e"}(de||(de={})),X.DEFAULT_CID;let ue=!1;ue=!0;const pe="https://"+getCommerceHostname("buy"),he=`https://${getCommerceHostname("play")}/WebObjects/MZPlay.woa/wa`;class StoreKit extends Notificati 0}get authorizationStatus(){return this._authorizationStat parentalControls(){return this._parentalContr}get privacyAcknowledgements(){return this._privacyAcknowledgemet storefrontIdentifier(){return this._storefrontIdentif}get dynamicUserToken(){return this._dynamicUserTo})}get userToken(){return invoke(this.dynamicUserToken)}set userToken(e){this.dynamicUserToken=e}get userTokenIsValid(){return validateToken(this.userTokscribeViewEligibility(){this._dispatchedSubscribeView)}me(){if(this.authorizationStatus<=ie.DENIED)return Promise.reject("Not authorized: "+this.authorizationStatus);if(!this._me){var t=this;this._me=new Promise(function(){var r=_async_to_generator$1l((function*(r,n){const i=new Headers({Authorization:"Bearer "+t.developerToken,[I]:t.userToken||""}),o=addQueryParamsToURL(t.apiBase+"/me/account",_object_spread$K({meta:"subscription"},t.meParameters));let a;try{a=yield fetch(o,{headers:i})}catch(u){return n(new MKError(MKError.Reason.NETWORK_ERROR,"Failed to fetch /me/account"))}if(a&&!a.ok)return t.realm!==e.SKRealm.TV&&t._reset(),n("Account error.");let s=yield a.json();if(s.errors)return n(s.errors);const{data:c,meta:l}=s;if(!l||!l.subscription)return n("Account error.");t.storefrontCountryCode=l.subscription.storefront;const d={meta:l,subscription:l.subscription};c&&c.length&&(d.attributes=c[0].attributes);try{let e=yield fetch(t.iTunesBuyBase+"/account/web/info",{credentials:"include",headers:i});if(s=yield e.json(),t.parentalControls=s.parentalControlsData,t.privacyAcknowledgements=s.privacyAcknowledgem!0}(t.privacyAcknowledgements||{})){try{yield t.infoRefresh()}catch(u){r(d)}e=yield fetch(t.iTunesBuyBase+"/account/web/info",{credentials:"include",headers:i}),s=yield e.json(),t.parentalControls=s.parentalControlsData,t.privacyAcknowledgements=s.privacyAcknowledgement}d.info=s}catch(u){console.warn("Failed to fetch privacyAcknowledgements",u)}return r(d)}));return function(e,t){return r.apply(this,arguments)}}()).t,e}).cae)))}return this.ye,_e;!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}}})(900),_ts_metadata$C("design:type",Function),_ts_metadata$C("design:paramtypes",[])],StoreKit.prototype,"_getIsActiveSubscription",null),e.PlaybackStates=void 0,(ye=e.PlaybackStates||(e.PlaybackStates={}))[ye.none=0]="none",ye[ye.loading=1]="loading",ye[ye.playing=2]="playing",ye[ye.paused=3]="paused",ye[ye.stopped=4]="stopped",ye[ye.ended=5]="ended",ye[ye.seeking=6]="seeking",ye[ye.waiting=8]="waiting",ye[ye.stalled=9]="stalled",ye[ye.completed=10]="completed",e.PresentationMode=void 0,(_e=e.PresentationMode||(e.PresentationMode={}))[_e.pictureinpicture=0]="pictureinpicture",_e[_e.inline=1]="inline";const fe=["contributors","modalities","movie","musicVideo","musicMovie","trailer","tvEpisode","uploadedVideo","uploaded-videos","music-videos","music-movies","tv-episodes","workoutt ve,t}const ge=["contributors","modalities","musicVideo","podcast-episodes","radioStation","song","uploaded-audios","uploadedAudio","uploaded-videos","uploadedVideo","workouts","workout-programs"],me=["Vod","LiveService","EbsEvent","Event"],be={mediaItemStateDidChange:"mediaItemStateDidChange",mediaItemStateWillChange:"mediaItemStateWillChange"},Se=new Logger$1("media-item"),{none:Pe,loading:Ee,ready:Te,playing:ke,ended:we,unavailable:Oe,restricted:Ie,error:Ae,unsupported:Re}=T,$e={[Pe]:{allowed:[Ee],unknown:[we,Oe,Ie,Ae,Re]},[Ee]:{allowed:[Te,Ie,Ae,Re],unknown:[]},[Te]:{allowed:[ke],unknown:[Ae]},[ke]:{allowed:[we,Ae],unknown:[Oe,Ie,Re]},[we]:{allowed:[],unknown:[]},[Oe]:{allowed:[],unknown:[]},[Ie]:{allowed:[],unknown:[]},[Ae]:{allowed:[],unknown:[]},[Re]:{allowed:[],unknown:[]}},toName=e=>T[e],createMediaItemStateGu)}function _define_property$1N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{mediaItemStateDidChange:Ce,mediaItemStateWillChange:De}=be,Me={isEntitledToPlay:!0},Le=BooleanDevFlag.register("mk-music-movie-playbac)}}const xe=new Logger$1("player"),K=()=>{},asAsK)};var je;!function(e){e.NONE="none",e.FAIRPLAY="com.apple.fps",e.PLAYREADY="com.microsoft.playready",e.WIDEVINE="com.widevine.alpha"}(je||(je={}));const Ne={app:{},features:{},urls:{}},Ue="mk-player-tsid",Fe='audio/mp4;codecs="mp4a.40.2"';var Be,Ke,Ve;function asyncGeneratorStep$1k(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1k(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1k(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1k(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function findMediaKeySystemAccess(e,t){return _findMediaKeySystemAccess.apply(this,argumend"}(Be||(Be={})),function(e){e.MP4="audio/mp4",e.AVC1="video/mp4"}(Ke||(Ke={})),function(e){e.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",e.PLAYREADY="com.microsoft.playready",e.FAIRPLAY="com.apple.streamingkeydelivery"}(Ve||(Ve={}));let Ge;const{NONE:He,FAIRPLAY:We,WIDEVINE:qe,PLAYREADY:Ye}]}function findKeySystemPreference(e){return _findKeySystemPreference.apply(this,argumenfunction _define_property$1M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1M(e,t,r[t])}))}return e}function _object_spread_props$r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var ze,Qe;const Je={browser:[[/^(itunes|music|tv)\/([\w\.]+)\1})],[/(?:(?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i,e=>_object_spread$I({name:"webview",variant:"facebook",mobile:!0},parseVersion(e[1]))],[/(instagram|snapchat)[\/ ]([-\w\.]+)/i,e=>_object_spread$I({name:"webview",variant:e[1].trim().toLowerCase(),mobile:!0},parseVersion(e[2]))],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i,e=>_object_spread$I({name:"webview",variant:"tiktok",mobile:!0},parseVersion(e[1]))],[/twitte0})],[/ wv\).+?(?:version|chrome)\/([\w\.]+)/i,e=>_object_spread$I({name:"webview",mobile:!0},parseVersion(e[1]))],[/electron\/([\w\.]+) safari/i,e=>_object_spread$I({name:"electron",mobile:!1},parseVersion(e[1]))],[/tesla\/(.*?(20\d\d\.([-\w\.])+)]})],[/(samsung|huawei)browser\/([-\w\.]+]))],[/yabrowser\/([-\w\.]+)/i,e=>_object_spread$I({name:"other",variant:"yandex",mobile:!1},parseVersion(e[1]))],[/(brave|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)))],[/edg(e|ios|a)?\/([\w\.]+)/i,e=>_object_spread$I({name:"edge",mobile:/(edgios|edga)/i.test(null!==(ze=e[1])&&void 0!==ze?ze:"")},parseVersion(e[2]))],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i,e=>_object_spread$I({name:"ie",mobile:!1},parseVersion(e[1]))],[/opr\/([\w\.]+)/i,/opera mini\/([-\w\.]+)/i,/opera [mobiletab]{3,6}\b.+version\/([-\w\.]+)/i,/opera(?:.+version\/|[\/ ]+)([\w\.]+)/i,e=>_object_spread$I({name:"opera",mobile:/mobile/i.test(e[0])},parseVersion(e[1]))],[/headlesschrome(?:\/([\w\.]+)| )/i,e=>_object_spread$I({name:"chrome",variant:"headless",mobile:!1},parseVersion(e[1]))],[/\b(?:crmo|crios)\/([\w\.]+)/i,e=>_object_spread$I({name:"chrome",mobile:!0},parseVersion(e[1]))],[/chrome(?: browser)?\/v?([\w\.]+)( mobile)]))],[/\bfocus\/([\w\.]+]))],[/fxios\/([\w\.-]+)/i,/(?:mobile|tablet);.*(?:firefox)\/([\w\.-]+)/i,e=>_object_spread$I({name:"firefox",mobile:!0},parseVersion(e[1]))],[/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+]))],[/(?:firefox)\/([\w\.]+)/i,/(?:mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d]))],[/version\/([\w\.\,]+) .*mobile(?:\/\w+ | ?)safari/i,/version\/([\w\.\,]+) .*(safari)/i,/webkit.+?(?:mobile ?safari|safari)(?:\/([\w\.]+)]))]],engine:[[/webkit\/(?:537\.36).+chrome\/(?!27)([\w\.]+)/i,e=>_object_spread$I({name:"blink"},parseVersion(e[1]))],[/windows.+ edge\/([\w\.]+)/i,e=>_object_spread$I({name:"blink"},parseVersion(e[1]))],[/presto\/([\w\.]+)/i,e=>_object_spread$I({name:"presto"},parseVersion(e[2]))],[/trident\/([\w\.]+)/i,e=>_object_spread$I({name:"trident"},parseVersion(e[1]))],[/gecko\/([\w\.]+)/i,e=>_object_spread$I({name:"gecko"},parseVersion(e[1]))],[/(khtml|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,e=>_object_spread$I({name:"other"},parseVersion(e[2]))],[/webkit\/([\w\.]+)/i,e=>_object_spread$I({name:"webkit"},parseVersion(e[1]))]],os:[[/microsoft windows (vista|xp)/i,/windows nt 6\.2; (arm)/i,/windows (?:phone(?: os)?|mobile)[\/ ]?([\d\.\w ]*)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i,e=>_object_spread$I({name:"windows"},parseVersion(e[1]))],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,e=>_object_spread$I({name:"ios"},parseVersion(e[1].replace(/_/g,".")))],[/mac(?:intosh;?)? os x ?([\d\._]+)))],[/cros [\w]+(?:\)| ([\w\.]+)\b)/i,e=>_object_spread$I({name:"chromeos"},parseVersion(e[1]))],[/(?:android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/droid ([\w\.]+|[\d+])\b.+(android[- ]x86|harmonyos]))],[/linu"})])}function _define_property$1L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1L(e,t,r[t])}))}return e}function _object_spread_props$q(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})})}function asyncGeneratorStep$1j(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1j(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1j(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1j(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function isBrowserEnvironment(){return _isBrowserEnvironment.apply(this,arguments)}function _isBrowserEnvironment(){return(_isBrowserEnvironment=_async_to_generator$1j((function*(){var e;return void 0!==(null===(e=window)||void 0===e?void 0:e.navigator)}))).apply(this,arguments)}function asyncGeneratorStep$1i(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1i(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1i(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1i(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function isNodeEnvironment(){return _isNodeEnvironment.apply(this,argumens)}function asyncGeneratorStep$1h(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1h(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1h(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1h(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}const Xe={playready:["com.microsoft.playready","com.youtube.playready"],widevine:["com.widevine.alpha"],clearkey:["org.w3.clearkey"],fairplay:["com.apple.fps","com.apple.fairplay"]};function detectEMESupport(){return _detectEMESupport.apply(this,argumens)}function detectEMEKeySystems(){return _detectEMEKeySystems.apply(this,argumens)}function asyncGeneratorStep$1g(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1g(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1g(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1g(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function detectES2015(){return _detectES2015.apply(this,argumens)}function asyncGeneratorStep$1f(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1f(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1f(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1f(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function detectMSESupport(){return _detectMSESupport.apply(this,argumens)}function asyncGeneratorStep$1e(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1e(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1e(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1e(o,n,i,_next,_throw,"throw",e)}_next(void 0)})}function asyncGeneratorStep$1d(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$1K(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=0}}const AsyncDebou=a},asyncDebou}}function asyncGeneratorStep$1c(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1c(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1c(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1c(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}const Ze={},SerialAsi}};var et,tt,rt;e.PlaybackBitrate=void 0,(et=e.PlaybackBitrate||(e.PlaybackBitrate={}))[et.STANDARD=64]="STANDARD",et[et.HIGH=256]="HIt"}(tt||(tt={})),function(e){e[e.ACCURATE=0]="ACCURATE",e[e.ROUND=1]="ROUND"}(rt||(rt={D}}const nt={audioTrackAdded:"audioTrackAdded",audioTrackChanged:"audioTrackChanged",audioTrackRemoved:"audioTrackRemoved",bufferedProgressDidChange:"bufferedProgressDidChange",drmUnsupported:"drmUnsupported",forcedTextTrackChanged:"forcedTextTrackChanged",mediaCanPlay:"mediaCanPlay",mediaElementCreated:"mediaElementCreated",mediaPlaybackError:"mediaPlaybackError",nowPlayingItemDidChange:"nowPlayingItemDidChange",nowPlayingItemWillChange:"nowPlayingItemWillChange",metadataDidChange:"metadataDidChange",playbackBitrateDidChange:"playbackBitrateDidChange",playbackDurationDidChange:"playbackDurationDidChange",playbackProgressDidChange:"playbackProgressDidChange",playbackRateDidChange:"playbackRateDidChange",playbackStateDidChange:"playbackStateDidChange",playbackStateWillChange:"playbackStateWillChange",playbackTargetAvailableDidChange:"playbackTargetAvailableDidChange",playbackTargetIsWirelessDidChange:"playbackTargetIsWirelessDidChange",playbackTimeDidChange:"playbackTimeDidChange",playbackVolumeDidChange:"playbackVolumeDidChange",playerTypeDidChange:"playerTypeDidChange",presentationModeDidChange:"presentationModeDidChange",primaryPlayerDidChange:"primaryPlayerDidChange",textTrackAdded:"textTrackAdded",textTrackChanged:"textTrackChanged",textTrackRemoved:"textTrackRemoved",timedMetadataDidChange:"timedMetadataDidChange"};function _define_property$1H(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=)}}var it,ot,at,st,ct,lt,n"}(it||(it={T"}(ot||(ot={N"}(at||(at={})),e.SeekReasonType=void 0,(st=e.SeekReasonType||(e.SeekReasonType={}))[st.Manual=0]="Manual",st[st.Interval=1]="Interval",st[st.SkipIntro=2]="SkipIntD"}(ct||(ct={})),function(e){e[e.NO_SELECTION_PLAY=0]="NO_SELECTION_PLAY",e[e.RESUME_LAST_PLAYED_SONG=1]="RESUME_LAST_PLAYED_SONG",e[e.RESUME_CURRENT_DEVICE_POSITION=2]="RESUME_CURRENT_DEVICE_POSITION"}(lt||(lt={D"}(dt||(dt={}));var ut,pt,ht,yt,_t,ft,vt,gt,mt,bt,St,Pt,Et,Tt;!function(e){e[e.UNKNOWN_FORMAT=0]="UNKNOWN_FORMAT",e[e.STEREO=1]="STEREO",e[e.SPATIAL=2]="SPATIAL",e[e.PREFERENCE_FORMAT_UNSUPPORTED=3]="PREFERENCE_FORMAT_UNSUPPORTED"}(ut||(ut={D"}(pt||(pt={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.STATIC=1]="STATIC",e[e.LINE_BY_LINE=2]="LINE_BY_LINE",e[e.WORD_BY_WORD=3]="WORD_BY_WORD"}(ht||(ht={})),function(e){e[e.REPEAT_UNKNOWN=0]="REPEAT_UNKNOWN",e[e.REPEAT_OFF=1]="REPEAT_OFF",e[e.REPEAT_ONE=2]="REPEAT_ONE",e[e.REPEAT_ALL=3]="REPEAT_ALL"}(yt||(yt={})),function(e){e[e.SHUFFLE_UNKNOWN=0]="SHUFFLE_UNKNOWN",e[e.SHUFFLE_OFF=1]="SHUFFLE_OFF",e[e.SHUFFLE_ON=2]="SHUFFLE_ON"}(_t||(_t={D"}(ft||(ft={})),function(e){e[e.NOT_SPECIFIED=0]="NOT_SPECIFIED",e[e.CONTAINER_CHANGED=1]="CONTAINER_CHANGED"}(vt||(vt={})),function(e){e[e.PLAY_END=0]="PLAY_END",e[e.PLAY_START=1]="PLAY_START",e[e.LYRIC_DISPLAY=2]="LYRIC_DISPLAY"}(gt||(gt={S"}(mt||(mt={})),function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO"}(bt||(bt={})),function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(St||(St={A"}(Pt||(Pt={})),function(e){e[e.EPISODE=1]="EPISODE",e[e.SHOUTCAST=2]="SHOUTCAST"}(Et||(Et={})),new Map([["play",gt.PLAY_START],["playbackstarted",gt.PLAY_START],["stop",gt.PLAY_END],["playbackstopped",gt.PLAY_END]]),new Map([["exit",at.EXITED_APPLICATION],["next",at.TRACK_SKIPPED_FORWARDS],["pause",at.PLAYBACK_MANUALLY_PAUSED],["playbackfinished",at.NATURAL_END_OF_TRACK],["playbackstopped",at.PLAYBACK_MANUALLY_PAUSED],["previous",at.TRACK_SKIPPED_BACKWARDS],["scrub_begin",at.SCRUB_BEGIN],["scrub_end",at.SCRUB_END],["stop",at.NATURAL_END_OF_TRACK]]),new Logger$1("paA"}(Tt||(Tt={}));const B}}},kt=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],wt=["fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement"],Ot=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],noop=()=>Promise.resolve(),)}})(HTMLDocument),t]})(HTMLDocument),)}})(HTMLElement);function asyncGeneratorStep$1b(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$1b(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$1b(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$1b(o,n,i,_next,_throw,"throw",e)}_next(void 0)}e}}function asyncGeneratorStep$1a(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$1F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=)}}class PlayerSeeker{get ended(){return this._ended}get isEngagedInPlayback(){return this._player.isEngagedInPlaybspatchEndEvent(){this._ended=!0,this.dispatch(tt.playbackScrub,{item:this._currentItem,position:this._lastSeekedTime,endReasonType:at.SCRUB_EN=e}}function asyncGeneratorStep$19(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$1E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$B(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$B(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const{visibilityChangeEvent:$t,visibilityState:Ct,unloadEventName:D"}}t}}function asyncGeneratorStep$18(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$18(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$18(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$18(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1D(e,t,r[t])}))}return e}function _ts_metadata$A(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}_ts_decorate$B([Bind(),_ts_metadata$B("design:type",Function),_ts_metadata$B("design:paramtypes",[void 0])],WindowHandlers.prototype,"storage",null),_ts_decorate$B([Bind(),_ts_metadata$B("design:type",Function),_ts_metadata$B("design:paramtypes",["undefined"==typeof Event?Object:Event])],WindowHandlers.prototype,"visibilityChanged",null),_ts_decorate$B([Bind(),_ts_metadata$B("design:type",Function),_ts_metadata$B("design:paramtypes",[])],WindowHandlers.prototype,"windowUnloaded",null);const{bufferedProgressDidChange:Mt,mediaCanPlay:Lt,mediaElementCreated:xt,mediaPlaybackError:jt,nowPlayingItemDidChange:Nt,nowPlayingItemWillChange:Ut,metadataDidChange:Ft,primaryPlayerDidChange:Bt,playbackDurationDidChange:Kt,playbackProgressDidChange:Vt,playbackStateDidChange:Gt,playbackRateDidChange:Ht,playbackStateWillChange:Wt,playbackTargetAvailableDidChange:qt,playbackTargetIsWirelessDidChange:Yt,playbackTimeDidChange:zt,playbackVolumeDidChange:Qt}=nt,Jt=["canplay","durationchange","ended","error","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","timeupdate","volumechange","waiting"],Xt=["NotAllowedError","NotSupportedError"],{ended:Zt,loading:er,paused:tr,playing:rr,seeking:nr,stopped:ir,waiting:or}=e.PlaybackStates;class BasePlayer{get bitrate(){return this._bitrateCalculator.bitrate}get currentBufferedProgress(){return this._currentBufferedProgress}get _currentDuration(){return this._targetElement.durat)}get currentPlaybackTime(){return this.calculateTime(this._currentTime)}calculateTime(e){return this._timing.time(e)}get currentPlaybackTimeRemaining(){return this.currentPlaybackDuration-this.currentPlaybackTget isPrimaryPlayer(){return this._isPrimaryPlae}get nowPlayingItem(){return this._nowPlayingI))}get playbackRate(){return this._targetElement.playbackRate}set playbackRate(e){this._targetElement.playbackRate=e}get playbackState(){return this._playbackStn)}get playbackTargetAvailable(){return void 0!==window.WebKitPlaybackTargetAvailabilityEvent&&this._playbackTargetAvailable}set playbackTargetAvailable(e){e!==this._playbackTargetAvailable&&(this._playbackTargetAvailable=e,this._dispatcher.publish(qt,{available:e)}get volume(){return this._targetElement.volume}set volume(e){this._targetElement.volume=e}get isDestroyed(){return this._isDestroisPaused(){return this._paused}exitFullscreen(){return this.fullscreen.exit()}requestFullscreen(e){return this.fullscreen.request}onPlaybackError(e,t){this.resetDeferredPlay(),this.stop({endReasonType:at.FAILED_TO_LOAD,userInitiated:!}handleEvent(e){var t=this;return _async_to_generator$18((function*(){"timeupdate"!==e.type&&xe.debug("BasePlayer.handleEvent: ",e.type,e,t.isPaused(),t._stopped);const{nowPlayingItem:r}=t;switch(e.timestamp=Date.now(),e.type){case"canplay":t._dispatcher.publish(Lt,e),t._playbackState!==or||t._targetElement.paused||t.setPlaybackState(rr,r);break;case"durationchange":t._targetElement.duration!==1/0&&(e.duration=t.currentPlaybackDuration,t._dispatcher.publish(Kt,e),t.calculatePlaybackProgress());break;case"ended":{var n,i;if(xe.debug('media element "ended" event'),null===(n=t.nowPlayingItem)||void 0===n?void 0:n.isLinearStream)return void xe.warn("ignoring ended event for linear stream",e);if(t.isElementCleaned()){xe.debug('media element already cleaned, ignoring "ended" event');break}const r=t.nowPlayingItem,o=(null===(i=r)||void 0===i?void 0:i.playbackDuration)?r.playbackDuration/1e3:t.currentPlaybackTime,a=t.currentPlayingDate;yield t.stopMediaAndCleanup(Zt),t.dispatch(tt.playbackStop,{item:r,position:o,playingDate:a,endReasonType:at.NATURAL_END_OF_TRACK});break}case"error":xe.error("Playback Error",e,t._targetElement.error),t._dispatcher.publish(jt,new MKError(MKError.Reason.MEDIA_PLAYBACK,"Playback Error"));break;case"loadedmetadata":t._dispatcher.publish(Ft,e);break;case"loadstart":t.setPlaybackState(er,r);break;case"pause":t.setPlaybackState(t._stopped?ir:tr,r);break;case"play":case"playing":t._paused=!1,t._stopped=!1,t.isPrimaryPlayer=!0,t.setPlaybackState(rr,r);break;case"progress":{const e=t._targetElement.buffered;t.handleBufferStart(),1===e.length&&0===e.start(0)&&t.calculateBufferedProgress(e.end(0));break}case"ratechange":t._dispatcher.publish(Ht,e);break;case"seeked":t._stopped?t.setPlaybackState(ir,r):t._paused?t.setPlaybackState(tr,r):t.playbackState!==Zt&&t.setPlaybackState(rr,r);break;case"seeking":t.playbackState===tr?t._paused=!0:t.playbackState===ir&&(t._stopped=!0),t.playbackState!==Zt&&t.setPlaybackState(nr,r);break;case"timeupdate":{t._dispatcher.publish(zt,{currentPlaybackDuration:t.currentPlaybackDuration,currentPlaybackTime:t.currentPlaybackTime,currentPlaybackTimeRemaining:t.currentPlaybackTimeRemaining}),t.calculatePlaybackProgress();const e=t._buffer;e&&(e.currentTime=t.currentPlaybackTime);break}case"volumechange":t._dispatcher.publish(Qt,e);break;case"waiting":t.setPlaybackState(or,r)}})}preload(){return this._loadMedieferredPlay(){this._deferredPlay=voir ar;!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$A("design:type",Function),_ts_metadata$A("design:paramtypes",[String,void 0===MKError?Object:MKError])],BasePlayer.prototype,"onPlaybackError",null),function(e){e.Home="com.apple.amp.appletv.home-team-radio",e.Away="com.apple.amp.appletv.away-team-radio"}(ar||(ar={}));function isHomeRadioTrack(e){return void 0!==e.characteristics&&e.characteristics.includes("com.apple.amp.appletv.home-team-radio")}function isAwayRadioTrack(e){return void 0!==e.characteristics&&e.characteristics.includes("com.apple.amp.appletv.away-team-radir}}const sr=["label","language","kin}function _define_property$1B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{audioTrackAdded:cr,audioTrackChanged:lr,audioTrackRemoved:dr}=nt,{audioTracksSwitched:ur,audioTracksUpdated:pr}=Be;class AudioTrackManager{get isDestroyed(){return this._isDestrod)}set currentTrack(e){e&&(xe.debug("MEDIA_TRACK Setting audio track "+e.label),this.extensionTracks?(xe.debug(`MEDIA_TRACK Setting track on extension ${e.id}-${e.label}`),this.extensionTracks.audioTrack=e):(xe.debug("MEDIA_TRACK disabling all audio tracks"),Array.from(this.mediaElement.audioTracks).forE1)}),xe.debug("MEDIA_TRACK enabling",e),e.enabled=!0),isHomeRadioTrack(e)||isAwayRadioTrack(e)||(this.saveTrack(e),xe.debug(`MEDIA_TRACK save track selection ${e.language},${e.label},${e.kind}`}}restoreSelectedTrack(){return restoreSelectedTrack("mk-audio-track",this)}saveTrack(e){saveTrack("mk-audio-track"}onAudioTrackChanged(e){this.dispatcher.publish(lr,e)}onAudioTrackRemoved(e){this.dispatcher.publish(dr)}}}const hr=[],yr}const _r=BooleanDevFlag.register("mk-load-manifest-once"),shouldLoadManifestOled;var fr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?selfs}var vr=createCommonjsModu)}}));unwrapExports(vr),vr.isValidScrollSetting,vr.isValidPositionAlignSetting,vr.isValidLineAlignSetting,vr.isValidLineAndPositionSetting,vr.isValidDirectionSetting,vr.isValidAlignSetting,vr.isValidPercentValue;var gr=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""},n={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},i={v:"title",lang:"lang"},o={rt:"ruby"},a={"text-combine-upright":"-webkit-text-combine:horizontal; text-orientation: mixed;"};class Parse]):null}static parseContent(e,t,s){let rn l}const l=e.document.createElement("div"),d=[];let u,p,h=l;for(;null!==(u=nextToken());)if("<"!==u[0])h.appendChild(e.document.createTextNode(u.replace(/&(amp|lt|gt|lrm|rlm|nbsp);/g,unescape1)));else{if("/"===u[1]){d.length&&d[d.length-1]===u.substr(2).replace(">","")&&(d.pop(),h=h.parentNode);continue}const t=ParserUtility.parseTimeStamp(u.substr(1,u.length-2));let r;if(t){r=e.document.createProcessingInstruction("timestamp",t.toString()),h.appendChild(r);continue}if(p=/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/.exec(u),!p)continue;if(r=createElement(p[1],p[2],p[3]),!r)continue;if(!shouldAdd(h,r))continue;p[2],d.push(p[1]),h.appendChild(r),h=r}return l}}t.default=ParserUtility}));unwrapExports(gr);var mr=createCommonjTTCue=n}));unwrapExports(mr),mr.VTTCue;var br=createCommonjegion=n}));unwrapExports(br),br.VTTRegion;var Sr=createCommonjue:!0})}));unwrapExports(Sr);var Pr=createCommonjer,n(Sr,t)}));unwrapExports(Pr),Pr.VTTRegion,Pr.VTTCue,Pr.WebVTTParser,Pr.ParsingError;var Er=createCommer,n(Sr,t)}));unwrapExports(Er),Er.VTTCue,Er.WebVTTRenderer,Er.BoxPosition,Er.CueStyleBox,Er.StyleBox;var Tr=createCommt),n(Er,t)}));unwrapExports(Tr);var kr=Tr.WebVTTRenderer;function _define_property$1A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{audioTrackAdded:wr,audioTrackChanged:Or,forcedTextTrackChanged:Ir,textTrackAdded:Ar,textTrackChanged:Rr,textTrackRemoved:$r}=nt,{textTracksSwitched:Cr,textTracksUpdated:Dr,inlineStylesParChanged)}}function asyncGeneratorStep$17(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$17(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$17(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$17(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$z(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const Lr={"picture-in-picture":e.PresentationMode.pictureinpicture,inline:e.PresentationMode.inline},xr={};xr[e.PresentationMode.pictureinpicture]="picture-in-picture",xr[e.PresentationMode.inline]="inline";const{presentationModeDidChange:jr}=nt,{playbackLicenseError:Nr}=Be,{stopped:Ur}=e.PlaestOnce()}}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$z("design:type",Function),_ts_metadata$z("design:paramtypes",[void 0])],VideoPlayer.prototype,"onPlaybackLicenseError",null);const decayiblyRetry)});let Fr={developerToken:"developerTokenNotSet",musicUserToken:"musicUserTokenNotSet",cid:"cidNotSet"};function asyncGeneratorStep$16(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$16(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$16(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$16(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1y(e,t,r[t])}oid 0)}}function asyncGeneratorStep$15(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$15(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$15(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$15(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$y(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.mew License}}function asyncGeneratorStep$14(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$14(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$14(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$14(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$x(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$y("design:type",Function),_ts_metadata$y("design:paramtypes",[void 0])],KeySession.prototype,"startLicenseSes",void 0)}}function asyncGeneratorStep$13(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$13(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$13(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$13(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$x("design:type",Function),_ts_metadata$x("design:paramtypes",[void 0])],FairplayEncryptedSession.prototype,"startFairplayLicenseSession",null);const Br=/^(?:.*)(skdyEme",!0)}}function asyncGeneratorStep$12(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$12(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$12(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$12(o,n,i,_next,_throw,"throw",e)}_next(*(){}))()}}const Kr={[je.WIDEVINE]:Ve.WIDEVINE,[je.FAIRPLAY]:Ve.FAIRPLAY,[je.PLAYREADY]:Ve.PLAYREADY},Vr=[0,0,1,222,112,115,115,104,0,0,0,0,154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149,0,0,1,190],Gr=[190,1,0,0,1,0h;return n}const{WIDEVINE:Hr,PLAYREADY:Wr}=je,qPSSH",ty,Vr,Gr,i)};function asyncGeneratorStep$11(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$11(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$11(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$11(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0wals",{})}}function asyncGeneratorStep$10(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$10(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$10(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$10(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Yr=BooleanDevFlag.register("mk-safari-mentType=t}}const zr=BooleanDevFlag.register("mk-force-audio-mse"),shouldFo>zr.enabled;function asyncGeneratorStep$$(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$1s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0endByte}`}}function asyncGeneratorStep$_(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$1r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0Segment=t}}function _define_property$1q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Qr=/^#EXT-X-BYTERANGE:([^\n]+)\n/gim,Jr=/^#EXT-X-MAP:([^\n]+)\n/im,Xr=/#EXTINF:\d*\.\d*\,[\n](.+)|^#EXT-X-MAP:URI="([^"]*)"/gim,Zr=/#EXTINF:\d*\.\d*,\s*#EXT-X-BITRATE:\d{1,3}[\n](.+)|^#EXT-X-MAP:URI="(ents",{})}}var en;function asyncGeneratorStep$Z(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$Z(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$Z(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$Z(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$w(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e){e.keysParsed="keysParsed"}(en||(en={}));const tn=/^#EXT-X-TARGETDURATION:(\d+)/im,rn=/^#EXT-X-KEY:[^\n]+URI="([^"]+)"/im,nn=/^#EXT-X-KEY:[^\n]+URI="([^"]+)",KEYFORMAT="([^"]+)"/gim;function loadManifestData(e){return _loadManifestData.apply(thisassetURL}}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$w("design:type",Function),_ts_metadata$w("design:paramtypes",[])],Manifest.prototype,"liveRadioRefresh",null);const on="seamlessAudioTransition",an="bufferTimedMetadataDidChange",sn="loadSegmentError",cn=isNodeEnvironment$1()?require("util").TextDecoder:self.(e&1<<t)}function _define_property$1o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0his.end=n}}const ln=[237,239,139,169,121,214,74,206,163,200,39,220,213buffer,t)}}function _define_property$1m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!01));n+=t}}const rewrit.keyBytes)};function _define_property$1l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0(127&e[3])}const dn={0:"iso-8859-1",1:"utf-16",2:"utf-16be",3:"utf-8"},un={TPE1:!0,TIT2:!0,WXXX:!0,PRIV:!0,TALB:is,e,t}return r}function _define_property$1k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}Y=121]="Y"}(pn||(pn={}));const hn={TALB:"album",TIT2:"title",TPE1:"performer"},yn=["performer","titl=r)})}}})}}function _define_property$1j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0.payload)}}function _define_property$1i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0ind(this)}}function _define_property$1h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0tadata)})}}function asyncGeneratorStep$Y(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$Y(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$Y(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$Y(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$v(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$v(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const _n=xe.createChild("mse"),fn=BooleanDevFlag.get("mk-mse-buffer"),{manifestPaffer=this}}function asyncGeneratorStep$X(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$X(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$X(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$X(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$u(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}_ts_decorate$v([Bind(),_ts_metadata$v("design:type",Function),_ts_metadata$v("design:paramtypes",[])],MseBuffer.prototype,"onSourceOpen",null),_ts_decorate$v([Bind(),_ts_metadata$v("design:type",Function),_ts_metadata$v("design:paramtypes",[])],MseBuffer.prototype,"onManifestParsed",null),_ts_decorate$v([Bind(),_ts_metadata$v("design:type",Function),_ts_metadata$v("design:paramtypes",[])],MseBuffer.prototype,"updateEndHandler",null);const{mediaPlaybackEentError)}}function asyncGeneratorStep$W(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$W(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$W(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$W(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_ts_decorate$u([Bind(),_ts_metadata$u("design:type",Function),_ts_metadata$u("design:paramtypes",[void 0])],AudioPlayer.prototype,"onLoadSegmentError",null),_ts_decorate$u([AsyncDebounce(250),_ts_metadata$u("design:type",Function),_ts_metadata$u("design:paramtypes",[Number])],AudioPlayer.prototype,"seekToTime",null),_ts_decorate$u([Bind(),_ts_metadata$u("design:type",Function),_ts_metadata$u("design:paramtypes",[])],AudioPlayer.prototype,"onTimeUpdate",null),_ts_decorate$u([Bind(),_ts_metadata$u("design:type",Function),_ts_metadata$u("design:paramtypes",[])],AudioPlayer.prototype,"delayedCdmUpdateCheck",null),_ts_decorate$u([Bind(),_ts_metadata$u("design:type",Function),_ts_metadata$u("design:paramtypes",[void 0])],AudioPlayer.prototype,"loadKeysHan",void 0)}}function asyncGeneratorStep$V(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$V(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$V(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$V(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0ession=!0}}function asyncGeneratorStep$U(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$U(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$U(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$U(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0stroy(e)}}const mn=BooleanDevFlag.register("mk-send-manifest-headers");function asyncGeneratorStep$T(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$T(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$T(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$T(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$1b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const bn=["https://play.itunes.apple.com/","https://linear.tv.apple.com/","https://play-edge.itunes.apple.com"];cr:new Map}};function asyncGeneratorStep$S(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$S(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$S(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$S(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _ts_decorate$t(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$t(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const{mediaPlaybackError:Pn}=nt,{playbackLicenseError:En,playbackSessionE}):t[r]=n}}function _define_property$19(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_ts_decorate$t([Bind(),_ts_metadata$t("design:type",Function),_ts_metadata$t("design:paramtypes",[void 0])],NativeSafariVideoPlayer.prototype,"onPlaybackSessionError",null),_ts_decorate$t([Bind(),_ts_metadata$t("design:type",Function),_ts_metadata$t("design:paramtypes",[])],NativeSafariVideoPlayer.prototype,"onMetadataLoaded",null),_ts_decorate$t([AsyncDebounce(250),_ts_metadata$t("design:type",Function),_ts_metadata$t("design:paramtypes",[Number])],NativeSafariVideoPlayer.prototype,"seekTohis.hls=e}}function _define_property$18(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$18(e,t,r[t])}))}return e}function _object_spread_props$p(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_decorate$s(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const{audioTracksSwitched:kn,audioTracksUpdated:wn,inlineStylesParsed:On,textTracksSwitched:In,textTracksUpdComplete)}}function asyncGeneratorStep$R(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$R(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$R(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$R(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$17(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$r(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$r(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}_ts_decorate$s([Bind(),_ts_metadata$s("design:type",Function),_ts_metadata$s("design:paramtypes",[])],HlsJsTracks.prototype,"handleAudioTrackSwitched",null),_ts_decorate$s([Bind(),_ts_metadata$s("design:type",Function),_ts_metadata$s("design:paramtypes",[void 0,void 0])],HlsJsTracks.prototype,"handleInlineStylesParsed",null),_ts_decorate$s([Bind(),_ts_metadata$s("design:type",Function),_ts_metadata$s("design:paramtypes",[void 0,void 0])],HlsJsTracks.prototype,"handleManifestLoaded",null),_ts_decorate$s([Bind(),_ts_metadata$s("design:type",Function),_ts_metadata$s("design:paramtypes",[void 0,void 0])],HlsJsTracks.prototype,"handleSessionDataComplete",null),_ts_decorate$s([Bind(),_ts_metadata$s("design:type",Function),_ts_metadata$s("design:paramtypes",[void 0,void 0])],HlsJsTracks.prototype,"handleSubtitleTrackSwitch",null);const Rn={bufferStalledError:"bufferStalledError",keySystemGenericError:"keySystemGenericError"};var $n;!function(e){e.Seek="Seek",e.HighBuffer="HighBuffer",e.LowBuffer="LowBuffer"}($n||($n={}));const Cn=new Set([MKError.Reason.DEVICE_LIMIT,MKError.Reason.GEO_BLOCK,MKError.Reason.WIDEVINE_CDM_EXPIRED]),Dn={};Dn[je.FAIRPLAY]="fairplaystreaming",Dn[je.PLAYREADY]="playready",Dn[je.WIDEVINE]="widevine";const Mn=BooleanDevFlag.get("mk-block-report-cdn-server"),configureCdnReporting=e=>{const{Hls:t}=window;if(t&&Mn){const r=function deepClone(e){const t=Object.prototype.toString.call(e).toLowerCase().slice(8,-1);switch(t){case"set":return new Set([...e].map(e=>deepClone(e)));case"map":return new MapepClone(t)]));case"date":return new Date(e.getTime());case"regexp":{const t=e,r="string"==typeof t.flags?t.flags:[t.global?"g":void 0,t.ignoreCase?"i":void 0,t.multiline?"m":void 0,t.sticky?"y":void 0,t.unicode?"u":voi>void 0!==e).join("");return RegExp(e.source,r)}case"arraybuffer":{const t=e;if("function"==typeof t.slice)return t.slice(0);{const r=new e.constructor(t.byteLength);return new Uint8Array(r).set(new Uint8Array(t)),r}}case"dataview":case"int8array":case"uint8array":case"uint8clampedarray":case"int16array":case"uint16array":case"int32array":case"uint32array":case"float32array":case"float64array":case"bigint64array":case"biguint64array":{const r=e;return new(0,r.constructor)(deepClone(r.buffer),r.byteOffset,"dataview"===t?r.byteLength:r.length)}case"array":case"object":{const t=Array.isArray(e)?[]:{};for(const r in e)hasOwn(e,r)&&(t[r]=deepClone(e[r]));return t}default:return e}}(t.DefaultConfig.fragLoadPolicy);r.default.reportCDNServer=!1,r.customURL.reportCDNServer=!1,e.fragLoadPolicy=r}},Ln={nightly:!0,carry:!0},xn=JsonDevFlag.register("mk-hlsjs-config-overrides");class HlsJsVideoPlayer extends VideoPlayer{get shouldDispatchErrors(){return!this.userInitiated||this._playbageCodec))}get currentPlayingDate(){var e;return null===(e=this._hls)||void 0===e?void 0:e.playingDate}get isPlayingAtLiveEdge(){var e;const t=this._hls;return!(!t||!(null===(e=this.nowPlayingItem)||void 0===e?void 0:e.isLinearStream))&&!!t.isPlayingAtLive}get seekableTimeRanges(){const e=this._hls;return e?e.seekableTimeRanges:this.currentPlaybackDuration?[{start:0,end:this.currentPlaybackDurati),d}))()}createHlsPlayer(){const{_keySystem:e}=this,{Hls:t}=window,r=M.get(),{os:n}=this.services.runtime,i={clearMediaKeysOnPromise:!1,customTextTrackCueRenderer:!0,debug:!!r,debugLevel:r,enableIFramePreloading:!1,enablePerformanceLogging:!!r,enablePlayReadyKeySystem:!0,enableQueryParamsForITunes:!this._shouldLoadManifestsOnce,enableRtcReporting:void 0!==this._rtcTracker,keySystemPreference:Dn[e],useMediaKeySystemAccessFilter:!0,nativeControlsEnabled:n.isAndroid,enableContentSteering:!0,allowFastSwitchUp:!0};configureCdnRelog=t.log)})(i),(e=>{const t=xn.value;t&&"object"==typeof t&&Object.assign(e,t)})(i);const o=new t(i),{ERROR:a,INTERNAL_ERROR:s,MANIFEST_PARSED:c,KEY_REQUEST_STARTED:l,LICENSE_CHALLENGE_CREATED:d,LEVEL_SWITCHED:u,UNRESOLVED_URI_LOADING:p}=t.Events;o.on(a,this.handleHlsError),o.on(s,this.handleHlsError),o.on(c,this.handleManifestParsed),o.on(l,this.handleKeyRequestStarted),o.on(d,this.handleLicenseChallengeCreated),o.on(u,this.handleLevelSwitched),this._shouldLoadManifestsOnce&&o.on(p,this.handleUnresolvedUriLoading),this._hls=o,window.hlsSession=o,this._hlsJsTracks=new HlsJsTracks(this._hls),this.setupTrackManagers(this._hlsJsTracks),this._hlsPreviewImageLoader=new HlsJsPreviewImageLoader "+i)}))()}handleLevelSwitched(e,t){var r,n,i;const{level:o}=t;if(!o)return;const a=null===(r=this._levels)||void 0===r?void 0:r.find(e=>e.persistentId===o);if(!a||(null===(n=this._currentLevel)||void 0===n?void 0:n.persistentId)===(null===(i=a)||void 0===i?void 0:i.persistentId))return;this._currentLevel=a;const s=void 0!==a.audioGroupId?this._channelsByGroup[a.audioGroupId]:void 0;this._dispatcher.publish(tt.hlsLevelUpdated,{level:a,ckError,n)}}handleManifestParsed(e,t){var r=this;return _async_to_generator$R((function*(){var e,n;let i;xe.debug("handleManifestParsed",t),r._levels=null!==(e=t.levels)&&void 0!==e?e:[],r.nowPlayingItem.state=T.ready,r._channelsByGroup=(null!==(n=t.audioTracks)&&void 0!==n?n:[]).reduce((e,t)=>(e[t.groupId]=t.channels,e),{});try{yield r._playMedia()}catch(o){throw xe.warn("error from media element, possibly non-fatal",o),o}finally{i=yield r.finishPlaybackSequence()}return i}))()}handleKeyRequestStarted(e,t){xe.debug("hlsjs-video.handleKeyRequestStarted"),this._hls.generateKeyRequest(t.keyuri,{})}handleLicenseChallengeCreated(e,t){var r=this;return _async_to_generator$R((function*(){const{_licenseServerUrl:e,nowPlayingItem:n,_keySystem:i,userInitiated:o}=r;try{var a,c;const l=yield null===(a=r._license)||void 0===a?void 0:a.start(e,n,t,i,o),d={statusCode:l.status};(null===(c=l)||void 0===c?void 0:c.license)&&(i===je.FAIRPLAY?d.ckc=s(l.license):d.license=s(l.license));const u=l["renew-after"];u&&(d.renewalDate=new Date(Date.now()+1e3*u)),r._hls.setLicenseResponse(t.keyuri,d)}catch(Ae){var l;if(r._unrecoverableError)return;const n=Ae.data,i={};void 0!==(null===(l=n)||void 0===l?void 0:l.status)&&(i.statusCode=+n.status),xe.warn("Passing license response error to Hls.js",i),r._hls.setLicenseResponse(t.keyuri,i),MKError.isMKError(Ae)&&Cn.has(Ae.reason)&&(r._unrecoverableError=Ae,r.resetDeferredPlay(),yield r.stop({endReasonType:at.FAILED_TO_LOAD,userInitiated:o})),r.onPlaybackLicenseError(Ae)}}))()}seekToTime(e){var t=this;return _async_to_generator$R((function*(){t._hls?(xe.debug("hlsjs-video: hls seekTo",e),t._hls.seekTo=e):(xe.debug("hlsjs-video: media element seek to",e),t._targetElement.currentTw License}}var jn;_ts_decorate$r([Bind(),_ts_metadata$r("design:type",Function),_ts_metadata$r("design:paramtypes",[String,"undefined"==typeof HlsUnresolvedUriData?Object:HlsUnresolvedUriData])],HlsJsVideoPlayer.prototype,"handleUnresolvedUriLoading",null),_ts_decorate$r([Bind(),_ts_metadata$r("design:type",Function),_ts_metadata$r("design:paramtypes",[void 0,void 0])],HlsJsVideoPlayer.prototype,"handleLevelSwitched",null),_ts_decorate$r([Bind(),_ts_metadata$r("design:type",Function),_ts_metadata$r("design:paramtypes",[void 0,void 0])],HlsJsVideoPlayer.prototype,"handleHlsError",null),_ts_decorate$r([Bind(),_ts_metadata$r("design:type",Function),_ts_metadata$r("design:paramtypes",[void 0,void 0])],HlsJsVideoPlayer.prototype,"handleManifestParsed",null),_ts_decorate$r([Bind(),_ts_metadata$r("design:type",Function),_ts_metadata$r("design:paramtypes",[void 0,void 0])],HlsJsVideoPlayer.prototype,"handleKeyRequestStarted",null),_ts_decorate$r([Bind(),_ts_metadata$r("design:type",Function),_ts_metadata$r("design:paramtypes",[void 0,void 0])],HlsJsVideoPlayer.prototype,"handleLicenseChallengeCreated",null),_ts_decorate$r([AsyncDebounce(250),_ts_metadata$r("design:type",Function),_ts_metadata$r("design:paramtypes",[Number])],HlsJsVideoPlayer.prototype,"seekToTime",null),_ts_decorate;r.value=n}),_ts_metadata$r("design:type",Function),_ts_metadata$r("design:paramtypes",[Number])],HlsJsVideoPlayer.prototype,"loadPreviewImage",null),e.version="2.2350.2";const Nn=e.version.split("."),Un=Nn[0],Fn=Nn[Nn.length-1];var Bn,Kn;Nn[0]="3",Nn[Nn.length-1]=Fn+"-prerelease",Nn[0]=Un,Nn[Nn.length-1]=Fn,e.version=Nn.join("."),function(e){e.REPEAT="REPEAT",e.SHUFFLE="SHUFFLE",e.AUTOPLAY="AUTOPLAY"}(Bn||(Bn={})),e.PlaybackMode=void 0,(Kn=e.PlaybackMode||(e.PlaybackMode={}))[Kn.PREVIEW_ONLY=0]="PREVIEW_ONLY",Kn[Kn.MIXED_CONTENT=1]="MIXED_CONTENT",Kn[Kn.FULL_PLAYBACK_ONLY=2]="FULL_PLAYBACK_ONLY",Kn[Kn.SHAREPLAY_PARTICIPANT=3]="SHAREPLAY_PARTICIPANT";const Vn={configured:"musickitconfigured",loaded:"musickitloaded",audioTrackAdded:nt.audioTrackAdded,audioTrackChanged:nt.audioTrackChanged,audioTrackRemoved:nt.audioTrackRemoved,authorizationStatusDidChange:de.authorizationStatusDidChange,authorizationStatusWillChange:de.authorizationStatusWillChange,bufferedProgressDidChange:nt.bufferedProgressDidChange,capabilitiesChanged:"capabilitiesChanged",autoplayEnabledDidChange:"autoplayEnabledDidChange",drmUnsupported:nt.drmUnsupported,eligibleForSubscribeView:de.eligibleForSubscribeView,forcedTextTrackChanged:nt.forcedTextTrackChanged,mediaCanPlay:nt.mediaCanPlay,mediaElementCreated:nt.mediaElementCreated,mediaItemStateDidChange:be.mediaItemStateDidChange,mediaItemStateWillChange:be.mediaItemStateWillChange,mediaPlaybackError:nt.mediaPlaybackError,mediaSkipAvailable:"mediaSkipAvailable",mediaRollEntered:"mediaRollEntered",mediaUpNext:"mediaUpNext",metadataDidChange:nt.metadataDidChange,needsGDPRDidChange:"needsGDPRDidChange",nowPlayingItemDidChange:nt.nowPlayingItemDidChange,nowPlayingItemWillChange:nt.nowPlayingItemWillChange,playInitiated:"playInitiated",playbackBitrateDidChange:nt.playbackBitrateDidChange,playbackDurationDidChange:nt.playbackDurationDidChange,playbackProgressDidChange:nt.playbackProgressDidChange,playbackRateDidChange:nt.playbackRateDidChange,playbackStateDidChange:nt.playbackStateDidChange,playbackStateWillChange:nt.playbackStateWillChange,playbackTargetAvailableDidChange:nt.playbackTargetAvailableDidChange,playbackTargetIsWirelessDidChange:nt.playbackTargetIsWirelessDidChange,playbackTimeDidChange:nt.playbackTimeDidChange,playbackVolumeDidChange:nt.playbackVolumeDidChange,playerTypeDidChange:nt.playerTypeDidChange,presentationModeDidChange:nt.presentationModeDidChange,primaryPlayerDidChange:nt.primaryPlayerDidChange,queueIsReady:"queueIsReady",queueItemsDidChange:"queueItemsDidChange",queueItemForStartPosition:"queueItemForStartPosition",queuePositionDidChange:"queuePositionDidChange",shuffleModeDidChange:"shuffleModeDidChange",repeatModeDidChange:"repeatModeDidChange",storefrontCountryCodeDidChange:de.storefrontCountryCodeDidChange,storefrontIdentifierDidChange:de.storefrontIdentifierDidChange,textTrackAdded:nt.textTrackAdded,textTrackChanged:nt.textTrackChanged,textTrackRemoved:nt.textTrackRemoved,timedMetadataDidChange:nt.timedMetadataDidChange,userTokenDidChange:de.userTokenDidChange,webComponentsLoaded:"musickitwebcomponentsloaded"};function parseSkipItems(e){const t=parseInt(e.hlsMetadata["skip.count"],10),r=[];if(isNaN(t)||0===t)return r;for(let n=0;n<t;n++){const t={start:parseFloat(e.hlsMetadata[`skip.${n}.start`]),duration:parseFloat(e.hlsMetadata[`skip.${n}.duration`]),target:parseFloat(e.hlsMetadata[`skip.${n}.target`]),label:e.hlsMetadata[`skip.${n}.label`]};void 0!==e.hlsMetadata[`skip.${n}.promo.enabled`]&&(t.promo={enabled:"true"===e.hlsMetadata[`skip.${n}.promo.enabled`],image:e.hlsMetadata[`skip.${n}.promo.image`],"image-height":parseInt(e.hlsMetadata[`skip.${n}.promo.image-height`],10),"image-width":parseInt(e.hlsMetadata[`skip.${n}.promo.image-width`],10),genre:e.hlsMetadata[`skip.${n}.promo.genre`],"release-year":parseInt(e.hlsMetadata[`skip.${n}.promo.release-year`],10),"rating-display-name":e.hlsMetadata[`skip.${n}.promo.rating-display-name`],"rating-system":e.hlsMetadata[`skip.${n}.promo.rating-system`],"canonical-id":e.hlsMetadata[`skip.${n}.promo.canonical-id`],title:e.hlsMetadata[`skip.${n}.promo.title`],"rating-tag":e.hlsMetadata[`skip.${n}.promo.rating-tag`],"rating-rank":e.hlsMetadata[`skip.${n}.promo.rating-rank`],"up-next":{"is-added":"true"===e.hlsMetadata[`skip.${n}.promo.up-next.is-added`],"add-label":e.hlsMetadata[`skip.${n}.promo.up-next.add-label`],"added-label":e.hlsMetadata[`skip.${n}.promo.up-next.added-label`]},runtime:parseInt(e.hlsMetadata[`skip.${n}.promo.runtime`],10)}),r.push(t)}return r}function parseRollItems(e,t=["pre-roll","mid-roll","post-roll"]){if(void 0===e.hlsMetadata)return[];const r=[];returr.push(o)}}),r}const addRollI+t.duration;function asyncGeneratorStep$Q(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$16(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$q(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.mechSpan=!1}}function _define_property$15(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$q("design:type",Function),_ts_metadata$q("design:paramtypes",[void 0,void 0])],SpanWatcher.prototype,"handleTimeChpiManager}}function asyncGeneratorStep$P(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$p("design:type",Function),_ts_metadata$p("design:paramtypes",[])],PlaybackMonitor.prototype,"handleMediaItemChange",null);class RollMonitor extends Play 0)}))})()}shouldMonitor(){if(!super.shouldMonitor())return!1;return this.getRollMetadata().length>0}startMonitor(){this.setupWatchers(this.getRollMetadata()),super.startMonitor()}getRollMetadata(){const e=this.playbackController.nowPlayingItem;return void 0===e?[]:parseRollItems(e,["pre-roll","pwatchers=t}constructor(e){var t,r,n;super(e),t=this,r="rollMap",n=new Map,r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}}function asyncGeneratorStep$O(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}class SkipAvailable extends Playonitor()}getNowPlayingMetadata(){const e=this.playbackController.nowPlayingItem;return void 0===e?[]:parseS}):t[r]=n}}const Gn=new Logger$1("services");function asyncGeneratorStep$N(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$12(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const getContentCompletionThreshold=e=>Math.min(Math.round(getUpNextStart(e)),Math.round(getWatchedTime(e))),hasContentCompletionThhedTime(e)),getUpNextStart=e=>parseFloat(e.hlsMetadata["up-next.start"]),gethedrguments)}}();function asyncGeneratorStep$M(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _ts_metadata$o(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.me{super(e)}}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$o("design:type",Function),_ts_metadata$o("design:paramtypes",[])],UpNextMonitor.prototype,"handlePlaybackThreshold",null);const Wn=getHlsJsCdnConfig(),qn={app:{},autoplay:{maxQueueSizeForAutoplay:50,maxQueueSizeInRequest:10,maxUpcomingTracksToMaintain:10},features:{xtrick:!0,isWeb:!0,bookmarking:!1,"seamless-audio-transitions":!0,"enhanced-hls":!1},urls:{hls:Wn.hls,rtc:Wn.rtc,mediaApi:"https://amp-api.music.apple.com/v1",webPlayback:`https://${getCommerceHostname("play")}/WebObjects/MZPlay.woa/wa/webPlayback`}},Yn=JsonDevFlag.register("mk-offers-key-urls").get();function asyncGeneratorStep$L(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$L(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$L(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$L(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$11(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread_props$o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}let zn;qn.urls.hlsOffersKeyUrls=Yn||{"hls-key-cert-url":"https://s.mzstatic.com/skdtool_2021_certbundle.bin","hls-key-server-url":"https://play.itunes.apple.com/WebObjects/MZPlay.woa/podcast/hls/license/streaming/start","widevine-cert-url":"https://play.itunes.apple.com/WebObjects/MZPlay.woa/wa/wid3600/60)}}function asyncGeneratorStep$K(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$K(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$K(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$K(o,n,i,_next,_throw,"throw",e)}_next(kenIsValid}function hasMusicSubscription(e){return _hasMusicSubscription.apply(thisarguments)}function _define_property$10(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$n(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$n(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.mendlers())}}function _define_property$$(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Qn;_ts_decorate$n([Bind(),_ts_metadata$n("design:type",Function),_ts_metadata$n("design:paramtypes",[])],MediaSessionManager.prototype,"onCapabilitiesChanged",null),_ts_decorate$n([Bind(),_ts_metadata$n("design:type",Function),_ts_metadata$n("design:paramtypes",[void 0,void 0])],MediaSessionManager.prototype,"onNowPlayingItemDidCh]="VOLUME"}(Qr(this,e)}}function _define_property$_(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0Type"},e))}const Jn=StringDevFlag.register("mk-logging-levels"),Xn=BooleanDevFlag.register("mk-console-logging"),Zn=j.ERROR;let ei=Zn;const ti=new Logger$1("mk",{level:ei,handlers:{0!==i?i:H}}({enabled:!1}),external:new CallbackHandler=t?t:ei}const ril!=e?e:"*"),setCutput(!1))},setLull!=t&&t)},clearLngLevels()},eturn t}(e)};function _define_property$Z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$Z(e,t,r[t])}))}return e}function _object_spread_props$n(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}Xn.enabled&&ri.setConsoleOutput(Xn.enabled),void 0!==Jn.value&&ri.setLoggingLevels(Jn.value,Xn.enabled);const ni={condition:()=>!ontext:r})]};function _define_property$Y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$Y(e,t,r[t])}))}return e}function _object_spread_props$m(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ii:t.isLive)reName}})]}},hasR 0:r.daincludes(t),wit}:${e}`:e};function _define_property$X(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread_props$l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var oi;const getCooi:it.SONG},aiontext:r}]},condition:typeIs("songs","library-songs","music-videos")};function _define_property$W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$W(e,t,r[t])}))}return e}function _object_spread_props$k(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const th-1]]})(t),si={condition:typeIs("uploaded-audios","uploadedAudio","uploaded-videos","uploadedVideo";return[s]}};function _define_property$V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread_props$j(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ciontext:r})),condition:hasRelationship("episodes"),requiredRelationships:["episodes"]};function asyncGeneratorStep$J(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$J(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$J(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$J(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$U(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$U(e,t,r[t])},"")}const getIST:void 0};function _define_property$T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$T(e,t,r[t])}))}return e}function _object_spread_props$i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const li=ntext:r}))},condition:hasRelationship("tracks"),requiredRelationships:["tracks"]},ci,ai,ii,si,{condition:typeIs("music-movies";return[s]}}],dsh(...r),e},[]),ui=new Set(dih||t(e[0])),isMedia 0!==e.type,id 0!==e.id,ista.itemType,isQueueLoaded=e=>e&&e.loaded,isQuee=>e&&e.url;function _define_property$S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const pi=ti.linkChild(new Logger$1("queue")),descriptorToMediaIteay(e.items))(e)&&!isQueueLoaded(e))return[];const t=isQueueLoaded(e)?loadedDescriptorToMediaItem(e):unloadedDescriptorToMediaItem(e);retur,t.context)),t},unloadedDescriptorItem(e)):[],loadedDescriptor(r,n,i):[]},dataRecordTtem(n,t,r)},resource)})(e,t,r));function _define_property$R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0ayback=t}}function _define_property$Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=l=2]="all"}(hi||(hi={}));class BaseRepeatable{get repeatMode(){retMode",!1)}}class Repeatable{get repeatMode(){return this._repeatMode}set repeatMode(e){e in hi&&e!==this._repeatMode&&(this._repeatMode=e,this.dispatcher.publish(Vn.repeatModeDidChange,this._repeatMode))}constructor(e,t=hi.none){_define_property$Q(this,"canSetRepeatMode",!0),_define_property$Q(this,"dispatcher",void 0),_define_property$Q(this,"_repeatMode",void 0),this.dispatcher=e,this._repeatMode=t}}function _define_property$P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const yi=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$P(e,t,r[t])}))}return e}({},{NEXT_ITEM:"NEXT"},at);function asyncGeneratorStep$I(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$I(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$I(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$I(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _i=["EditorialVideoClip","uploaded-videos","uploadedVideo","musirganSeek=!1}}claK:15}})(e)}seekBackward(t=this._seekToBeginning){var r=this;return _async_to_generator$I((function*(){if(void 0===r.mediaItemPlayback.nowPlayingItem)return void Gn.warn("Cannot seekBackward when nowPlayingItem is not yet set.");const n=r.mediaItemPlayback.currentPlaybackTime-r.getSeekSeconds(r.mediaItemPlayback.nowPlayingItem).BACK;n<0?yield t.call(r):yield r.seekToTime(n,e.SeekReasonType.Interval)}))()}seekForward(t=this._seekToEnd){var r=this;return _async_to_generator$I((function*(){if(void 0===r.mediaItemPlayback.nowPlayingItem)return void Gn.warn("Cannot seekForward when nowPlayingItem is not yet set.");const n=r.mediaItemPlayback.currentPlaybackTime+r.getSeekSeconds(r.mediaItemPlayback.nowPlayingItem).FORWARD;n>r.mediaItemPlayback.currentPlaybackDuration?yield t.call(r):yield r.seekToTime(n,e.SeekReasonType.Interval)}))()}seekToTime(t,r=e.SeekReasonType.Manual){var n=this;return _async_to_gonType:r})}))()}_seekToBeginning(){var t=this;return _async_to_generator$I((function*(){yield t.seekToTime(0,e.SeekReasonType.Interval)}))()}_seekToEnd(){var t=this;return _async_to_generator$I((function*(){yield t.seekToTime(t.mediaItemPlayback.currentPlaybackDuration,e.SeekReasonType.IntcanSeek=!0}}const shuffli}return t};function _define_property$N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0)}return i}const vi=ti.createChi>e.item)}const{queueItemsDidChange:gi,queuePositionDidChange:mi}=Vn;trict()})}get isRestricted(){return this._it&&(e=t),e}get items(){return toMediaItems(this._queueItems)}get autoplayItems(){return toMediaItems(this._queueItems.filter(e=>e.iAutoplay))}get userAddedItems(){return toMediaItems(this._queueItems.filter(e=>!e.iAutoplay))}get playableItems(){return toMediaItems(this._queueItems.filter(e=>canPlay(e.item,this.playackMode)))}get length(){return this._queueItems.length}get nextPlayableItem(){if(-1!==this.nextPlayableItemIndex)return this.item(this.nextPlayableItemIndex}get position(){return thiitem}get currentItem(){return this.item(thifindPlayableIndexForward(e=this.position){var t;if(this.isEmpty)return-1;if(this.isInitiated&&!indexInBounds([0,this.position],e))return-1;const r=null===(t=this.repeatable)||void 0===t?void 0:t.repeatMode;if(e<this.length)for(let n=e+1;n<this.length;n++){if(canPlay(this.item(n),this.playbackMode))return n}if(r===hi.all)for(let n=0;n<=e;n++){if(canPlay(this.item(n),this.playbackMode))return n}return-1}findPlayableIndexBackward(e=this.position){var t;if(this.isEmpty)return-1;if(!indexInBounds([0,this.position],e))return-1;const r=null===(t=this.repeatable)||void 0===t?void 0:t.repeatMode;if(e>0)for(let n=e-1;n>=0;n--){if(canPlay(this.item(n),this.playbackMode))return n}if(r===hi.all)for(let n=this.length-1;n>=e;n--){if(canPlay(this.item(n),this.playbackMode))return<=e[1]}function _define_property$M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var bi;!function(e){e[e.off=0]="off",e[e.songs=1]="songs"}(bi||(bi={}));const Si="Shuffling is not supported in this playback method.";class BaseShuffler{set shuffle(e){Gn.warn(Si)}get shuffleMode(){return bi.off}set shuffleMode(e){",void 0)}}class Shuffler{get queue(){return e=>e.id))ngs:bi.off}get shuffleMode(){return this.mode}set shuffleMode(e){e!==this.shuffleMode&&e in bi&&(Gn.debug(`mk: set shuffleMode from ${this.shuffleMode} to ${e}`),this.mode=e,this.mode===bi.songs?this.shuffleQueue():this.unshuffleQueue(),this.controller.nowPlayingItem&&(this._queue.position=this._queue.indexForItem(this.controller.nowPlayingItem.id)),this.dispatcher.publish(Vn.shuffleModeDidChange,this.shuffleMode))}checkAndReshuffle(e=!1){this.shuffleMode===bi.songs&&this.shufosition=i}constructor(e,{dispatcher:t}){_define_property$M(this,"controller",void 0),_define_property$M(this,"canSetShuffleMode",void 0),_define_property$M(this,"dispatcher",void 0),_define_property$M(this,"mode",void 0),_define_property$M(this,"_queue",void 0),_define_property$M(this,"_unshuffledIDs",void 0),_define_property$M(this,"_isSpliceFromShuffle",void 0),this.controller=e,this.canSetShuffleMode=!0,this.mode=bi.off,this._unshuffledIDs=[],this._isSpliceFromShuffle=!1,this.dispatcher=t,this.dispatcher.subscribe(tt.queueModified,this.queueModifiedHandler),this._queue=e.queue}}function asyncGeneratorStep$H(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$H(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$H(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$H(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$L(e,t,r[t])}))}return e}function _object_spread_props$h(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_metadata$l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var Pi;!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$m("design:type",Function),_ts_metadata$m("design:paramtypes",[String,Object])],Shuffler.prototype,"queueModifiedHanl="serial"}(Pi||(Pi={}));const{queueItemsDidChange:Ei}=Vn;class PlaybackController{get isDestroyed(){return this._!==i?i:{}}get context(){return thhorization}set continuous(e){this._continuous=e}get autoplayEnabled(){return this._autoplayEnabled}set autoplayEnabled(e){this._autoplayEnabled=e}get previewOnly(){return this._mediaItemPlayback.previewOnly}get _dispatcher(){return this._services.storekit)}get isPlaying(){return this._mediaItemPlayback.isPlaying}get isPrimaryPlayer(){return this._mediaItemPlayback.isPrimaryPlayer}set isPrimaryPlayer(e){this._mediaItemPlayback.isPrimaryPlayer=e}get isReady(){return this._mediaItemPlayback.isReady}get _mediaItemPlayback(){return this._services.mediaItemPlayback}get nowPlayingItem(){return this._mediaItemPlayback.nowosition:-1}get playbackMode(){return this._packMode=e)}get queue(){return i,e.items)}get repeatMode(){return this._repeatable.repeatMode}set repeatMode(e){this._repeatable.rSeconds(e)}set shuffle(e){this._shuffler.shuffle=e}get shuffleMode(){return this._shuffler.shuffleMode}set shuffleMode(e){this._shuffler.shuffleMode=e}get storekit(){return this._storekit}set storekit(e){if(e){var t=this;e.addEventListener(de.authorizationStatusWillChange,function(){var e=_async_to_generator$H((function*({authorizationStatus:e,newAuthorizationStatus:r}){e>ie.DENIED&&r<ie.RESTRICTED?yield t.stop({endReasonType:at.PLAYBACK_SUSPENDED,userInitiated:!1}):yield t.stop({userInitiated:!1})}));return function(t){return e.apply(this,arguments)}}()),this._queue}))()}insertAt(e,t){var r=this;return _async_to_generator$H((function*(){const n=yield r._dataForQueueOptions(t);return r._queueModifier.insertAt(e,n),r!1}}pause(e){var t=this;return _async_to_generator$H((function*(){return t._mediaItemPlayback.pa,e)}}))()}onPlaybackStateDidChange(t,r){var n=this;return _async_to_generator$H((function*(){r.state===e.PlaybackStates.ended&&(n.continuous||n.repeatMode===hi.one)&&(Gn.debug("controller detected track ended event, moving to next item."),n._dispatcher.publish(tt.applicationActivityIntent,{endReasonType:at.TRACK_SKIPPED_FORWARDS,userInitiated:!1}),yield n._next())}))()}preload(){var e=this;return _async_to_generator$H((function*(){return e._mediaItemPlayback.prequeue}))()}prepareToPlay(e){var t=this;return _async_to_generator$H((function*(){return t._mediaItemPlayback.prepareToPetPicker()}seekBackward(){var e=this;return _async_to_generator$H((function*(){return e._seekable.seekBackd(e))}))()}skipToNextItem(){var e=this;return _async_to_generator$H((function*(){return e._next({userInitiate:!0})}))()}getNewSeeker(){return this._mediaItemPlayback.get)}))()}_next(e={}){var t=this;return _async_to_generator$H((function*(){if(t.queue.isEmpty)return;const{userInitiated:r=!1}=e;return t.repeatMode===hi.one&&void 0!==t.queue.currentItem?(yield t.stop(_object_spread$q({userInitiated:r},e)),void(yield t.play())):(!r&&e.seamlessAudioTransition&&(t._dispatcher.publish(tt.playbackStop,_object_spread$q({userInitiated:r,endReasonType:at.NATURAL_END_OF_TRACK},e)),e={userInitiated:e.userInitiated,seamlessAudioTransition:!0}),t._nextAtIndex(t.queue.nextPlayableItemIndex,e))}))()}_nextAtIndex(t,r={}){var n=this;return _async_to_generator$H((function*(){if(n.queue.isEmpty)return;const{_mediaItemPlayback:i}=n;var o;const a=null!==(o=r.userInitiated)&&void 0!==o&&o;if(t<0)return Gn.debug("controller/index._next no next item available, stopping playback"),yield n.stop({userInitiated:a,seamlessAudioTransition:r.seamlessAudioTransition}),void(i.playbackState=e.PlaybackStates.completed);const s=n.isPlaying,c=i.currentPlaybackTime,l=yield n._changeToMediaAtIndex(t,{userInitiated:a});var d;return n._notifySkip(s,l,{userInitiated:a,seamlessAudioTransition:null!==(d=r.seamlessAudioTransition)&&void 0!==d&&d,position:c,direction:at.TRACK_SKIPPED_FORWARDS}),l}))()}_previous(e={}){var t=this;return _async_to_generator$H((function*(){if(t.queue.isEmpty)return;const{userInitiated:r=!1}=e;if(t.repeatMode===hi.one&&void 0!==t.queue.currentItem)return yield t.stop({endReasonType:at.TRACK_SKIPPED_BACKWARDS,userInitiated:r}),void(yield t.play());const n=t.queue.previousPlayableItemIndex;if(r&&t.repeatMode===hi.none&&void 0!==t.nowPlayingItem&&-1===n)return yield t.stop({endReasonType:at.TRACK_SKIPPED_BACKWARDS,userInitiated:!0}),void(yield t.play());if(-1===n)return;const i=t.isPlaying,o=t._mediaItemPlayback.currentPlaybackTime,a=yield t._changeToMediaAtIndex(n,{userInitiated:r});return t._notifySkip(i,a,{userInitiated:r,seamlessAudioTransition:!1,direction:at.TRACK_SKIPPED_BACKWARDS,position:o}),a}))()}_notifySkip(e,t,r){const{userInitiated:n,direction:i,position:o,seamlessAudioTransition:a=!1}=r,s=this._dispatcher;a?(Gn.debug("seamlessAudioTransition transition, PAF play"),s.publish(tt.playbackPlay,{item:t,position:0,endReasonType:at.NATURAL_END_OF_TRACK})):e?t?s.publish(tt.playbackSkip,{item:t,userInitiated:n,direction:i,position:o}):s.publish(tt.playbackStop,{item:t,userInitiated:n,position:o}):t&&s.publish(tt.playbackPlay,_object_spread$q({item:t,position:0},n?{endReasonType:at.MANUALLY_SELECTED_PLAYBACK_OF_A_DIFFrty(t,r,a)}([Bind(),_ts_metadata$l("design:type",Function),_ts_metadata$l("design:paramtypes",[String,Boolean])],PlaybackController.prototype,"updateAutojoin("")}var Ti;function _define_property$K(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0ter"}(Ti||(Ti={}));const ki=fetchMiddlewareFactory("undefined"!=typeof  ):e[t]=r,e}function _object_spread$o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$J(e,t,r[t])}))}return e}function _object_spread_props$f(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var wi;!function(e){e.Replace="REPLACE",e.Merge="MERGE"}(wi||(wi={}));constfigure(e)}}function _object_without_properties(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const Ii={music:{url:"https://api.music.apple.com"},apps:{url:"https://amp-api.apps.apple.com"},books:{url:"https://amp-api.books.apple.com"},fitness:{url:"https://amp-api.fitness.apple.com"}};Ii.music={url:"https://amp-api.music.apple.com"},Ii.videos={url:"https://amp-api.videos.apple.com"},Ii.podcasts={url:"https://amp-api.podcasts.ure(s,e)}}}function asyncGeneratorStep$F(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$H(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$k(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.meManager=n}}var Ai,Ri;!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$k("design:type",Function),_ts_metadata$k("design:paramtypes",[])],StationTrackLoader.prototype,"checkLoadMore",null),function(e){e.artist="artist",e.song="song",e.station="station",e.radioStation="radioStation"}(Ai||(Ai={})),function(e){e.BEATS1="beats1"}(Ri||(Ri={}));const isIdentityQueue=e=>e&&void 0!==e.identity;function asyncGeneratorStep$E(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$E(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$E(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$E(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$j(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const{queueIsRinuous=!0}}function asyncGeneratorStep$D(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$i(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$i(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$j("design:type",Function),_ts_metadata$j("design:paramtypes",[void 0===Qn?Object:Qn])],ContinuousPlaybackController.prototype,"hasCapabilieshold=-1}}function asyncGeneratorStep$C(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}_ts_decorate$i([Bind(),_ts_metadata$i("design:type",Function),_ts_metadata$i("design:paramtypes",[void 0,void 0])],PercentageWatcher.prototype,"handleTimeChange",null),_ts_decorate$i([Bind(),_ts_metadata$i("design:type",Function),_ts_metadata$i("design:paramtypes",[void 0,void 0])],PercentageWatcher.prototype,"updateThreswerCase()}function asyncGeneratorStep$B(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$B(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$B(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$B(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$D(e,t,r[t])}))}return e}function _object_spread_props$e(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function loadRelationshipData(e,t,r){return _loadRelationshipData.apply(thisargumentrguments)}}(),getNamedQ);rrguments)}}();function loadSelectedQueueValue(e,t,r,n){return _loadSelectedQueueValue.apply(thisarguments)}function loadSelectedQueueValueV2(e,t,r,n){return _loadSelectedQueueValueV2.apply(thisguments)}function asyncGeneratorStep$A(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$A(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$A(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$A(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$C(e,t,r[t])}))}return e}function _object_spread_props$d(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_decorate$h(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const Mi=["library-songs","songs"];class Autoplayueue())}onRepeaoplay)}loadNextTracks(e=qn.autoplay.maxUpcomingTracksToMaintain){var t=this;return _async_to_generator$A((function*(){var r;if(t.repeatable.repeatMode!==hi.none)return;let n,{station:i}=t;if(t.station){try{var o,a;n=yield t.api.music("v1/me/stations/next-tracks/"+t.station.id,{limit:e},{fetchOptions:{method:"POST"}}),n=null===(a=n)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.data}catch(u){return}if(!t.isActive)return}else{var s,c;const r=yield t.startStation(e);if(!r||!t.isActive)return void(t.queue.hasAutoplayStation=!1);var l;if(i=t.station=r.station,t.queue.hasAutoplayStation=!0,n=r.tracks,!(null===(c=r)||void 0===c||null===(s=c.tracks)||void 0===s?void 0:s.length))Gn.warn("No track data is available for the current station",{stationId:null===(l=i)||void 0===l?void 0:l.id})}const d=descriptorToMediaItems({context:_object_spread_props$d(_object_spread$l({},t.context),{featureName:"now_playing",reco_id:(null===(r=t.context.featureName)||void 0===r?void 0:r.startsWith("listen-now"))?void 0:t.context.reco_id}),loaded:n,container:i});t.queue.appendQueueItems(toQueueItems(d,{isAutoplay:!0}))}))()}startStation(e){var t=this;return _async_to_generator$A((function*(){var r;const{userAddedItems:i}=t.queue;var o;const a=null===(r=null!==(o=i[i.length-2])&&void 0!==o?o:i[i.length-1])||void 0===r?void 0:r.container,s=a?{container:{id:a.id,type:a.type}}:void 0,c=t.queue.items.slice(-1*qn.autoplay.maxQueueSizeInRequest).reduce((e,{id:r,type:i})tentType(t))(r,i);return(e=>Mi.includes(e))(o)&&!t.errorIds.has(r)&&e.push({id:r,type:o,meta:s}),e},[]);if(0===c.length)return;const l={data:c};let d;try{var u,p;d=yield t.api.music("v1/me/stations/continuous",{"limit[results:tracks]":e,with:["tracks"]},{fetchOptions:{method:"POST",body:JSON.stringify(l,void 0,2)}}),d=null===(p=d)||void 0===p||null===(u=p.data)||void 0===u?void 0:u.results}catch(hs.add(e.id))}reiManager=n}}function asyncGeneratorStep$z(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$z(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$z(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$z(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$B(e,t,r[t])}))}return e}function _object_spread_props$c(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_decorate$g(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}_ts_decorate$h([Bind(),_ts_metadata$h("design:type",Function),_ts_metadata$h("design:paramtypes",[])],AutoplayTrackLoader.prototype,"onRepeatableChanged",null),_ts_decorate$h([Bind(),_ts_metadata$h("design:type",Function),_ts_metadata$h("design:paramtypes",[])],AutoplayTrackLoader.prototype,"onQueueChanged",null),_ts_eset),t},r},_ts_metadata$h("design:type",Function),_ts_metadata$h("design:paramtypes",[Number])],AutoplayTrackLoader.prototype,"loadNextTracks",null);const{queueIsReady:Li}=Vn;var xi,ji;!function(e){e.album="album",e.musicVideo="musicVideo",e.playlist="playlist",e.song="song",e.episode="episode",e.podcast="podcast",e.uploadedAudio="uploadedAudio",e.uploadedVideo="uploadedVideo"}(xi||(xi={})),function(e){e.albums="albums",e.musicVideos="musicVideos",e.playlists="playlists",e.songs="songs",e.episodes="episodes",e.podcasts="podcasts",e.uploadedAudio="uploadedAudios",e.uploadedVideo="uploadedVideos"}(ji||(ji={}));class SerialPlaybackController extends PlaybackController{get autoplayEnabled(){return this._autop()}))()}onSeamlessAudioTransition(e,t){Gn.debug("controller handling seamless audio transition, PAF stop",t),this._next({userInitiated:!1,seamlessAudioTransition:!0,endReasonType:at.NATURAL_END_OF_TRACK,position:t.previous.playbackDuration/1e3,isPItem,!0))}prepareToPlay(e,t=!1){var r=this;return _async_to_generator$z((function*(){if(Gn.debug("mk: SerialController - prepareToPlay - ",{item:e,preload:t}),e.isPlayable)return r._mediaItemPlayback.prepareToPlay(e).catch(e=>{const n=!t&&-1===[MKError.Reason.DEVICE_LIMIT,MKError.Reason.STREAM_UPSELL].indexOf(e.reason);if(r.continuous&&n)return r._dispatcher.publish(tt.applicationActivityIntent,{endReasonType:at.TRACK_SKIPPED_FORWARDS,userInitiated:!1}),r._next();thrurn n}))()}returnQueueForOptions(e){var t=this;return _async_to_generator$z((function*(){vtion",r),r})(e)).startPosition&&(deprecationWarning("startPosition",{message:"startPosition has been deprecated in favor of startWith"}),void 0===e.startWith&&(e.startWith=e.startPosition));const r=yield t._dataForQueueOptions(e),n={services:{runtime:t._services.runtime,dispatcher:t._services.dispatcher,mediaItemPlayback:t._services.mediaItemPlayback},descriptor:r,playbackMode:t.playbackMode};if(void 0!==e.shuffleMode&&(t.shuffleMode=e.shuffleMode),t.queue=new Queue(n),"number"==typeof e.startTime){const r=t.queue.nextPlayableItem;r&&t._mediaItemPlayback.playOptions.set(r.id,{startTime:e.startTime})}if(0===t.queue.length)throw Gn.warn("No item data is available for the current media queue",e),new MKError(MKError.Reason.CONTENT_UNAVAILABLE,"No item data is available for the current media queue.");return t._autoplayTrackLoader&&t._autoplayTrackLoader.deactivate(),t._autoplayTrackLoader=new AutoplayTrackLoader(t.queue,t._repeatable,{dispatcher:t._dispatcher,apiManager:t._services.apiManager},t._context),t.autoplayEnabled&&t.hasCapabilities(Qn.AUTOPLAY)&&t._autoplayTrackLoader.start(),t._dispatcher.publish(Li,t.queue.items),tder(n)}}function _define_property$A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_ts_decorate$g([Bind(),_ts_metadata$g("design:type",Function),_ts_metadata$g("design:paramtypes",[void 0,void 0])],SerialPlaybackController.prototype,"onSeamlessAudioTransition",null),_ts_decorate$g([Bind(),_ts_metadata$g("design:type",Function),_ts_metadata$g("design:paramtypes",[void 0===Qn?Object:Qn])],SerialPlaybackController.prototype,"hasCapabilities",null),_ts_decorate$g([Bind(),_ts_metadata$g("design:type",Function),_ts_metadata$g("design:paramtypes",[])],SerialPlaybackController.prototype,"onRepeatModeCh0;\n}\n")}}var Ni;function asyncGeneratorStep$y(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.SupportedAPIs=void 0,(Ni=e.SupportedAPIs||(e.SupportedAPIs={})).MEDIA_API="media-api",Ni.UTS_CLIENT="uts-client";class APIServiceManager{get api(){return this.getApiByType(this._nfigured")}get mediaAPI(){return this.getApiByType(e.SupportedAPIsurn t.api}set defaultApiType(e){this._dByType={}}}i[e]=t),t}function asyncGeneratorStep$x(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$x(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$x(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$x(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Fi=Gn.createCoptions=e}}function asyncGeneratorStep$w(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$f(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.meigured=!0}}function asyncGeneratorStep$v(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$v(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$v(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$v(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}_ts_decorate$f([Bind(),_ts_metadata$f("design:type",Function),_ts_metadata$f("design:paramtypes",[String,Object])],PlayActivityService.prototype,"handleEvent",null),_ts_decorate$f([Bind(),_ts_metadata$f("design:type",Function),_ts_metadata$f("design:paramtypes",[String,"undefined"==typeof ActivityIntention?Object:ActivityIntention])],PlayActivityService.prototype,"recordApplicationIntent",null),_ts_decorate$f([Bind(),_ts_metadata$f("design:type",Function),_ts_metadata$f("design:paramtypes",[String,"undefined"==typeof ActivityIntention?Object:ActivityIntention])],PlayActivityService.prototype,"recordUserIntent",null);const Bi=BooleanDevFlag.register("mk-force-safBi.enabled}function requiresHlsJs(e){return _requiresHlsJs.apply(thisarguments)}function asyncGeneratorStep$u(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread_props$b(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))rguments)}}();function asyncGeneratorStep$t(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$t(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$t(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$t(o,n,i,_next,_throw,"throw",e)}_next(void 0)})rgumergumergumerguments)}}(),extractAssetsFromMaso,URL:a})}},filterUnavailableLileError(t)},makeContentUnavat.drguments)}}();function asyncGeneratorStep$s(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$s(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$s(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$s(o,n,i,_next,_throw,"throw",e)}_next(URL)}}}function asyncGeneratorStep$r(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$r(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$r(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$r(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$e(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$e(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const Yi={keySystemGenericError:"keySystemGenericError"},zi=new Set([MKError.Reason.DEVICE_LIMIT,MKError.Reason.GEO_BLOCK]),Qi={};Qi[je.FAIRPLAY]="fairplaystreaming",Qi[je.PLAYREADY]="playready",Qi[je.WIDEVINE]="widevine";const Ji=xe.createChild("hlsjs-audio"),Xi=JsonDevFlag.register("mk-hlsjs-config-overrides");class HlsJsAudioPlayer extends BasePlayer{loadPreviewImage(){return _async_to_generator$r((function*(){}))()}get _targetElement(){return this.mediaElement}setNextSeamlessItem(e){return _async_to_generator$r((functi)}))()}isPlayerSupported}handleLicenseChallengeCreated(e,t){var r=this;return _async_to_generator$r((function*(){const{_licenseServerUrl:e,nowPlayingItem:n,_keySystem:i,userInitiated:o}=r;try{var a,c;const l=yield null===(a=r._license)||void 0===a?void 0:a.start(e,n,t,i,o),d={statusCode:l.status};(null===(c=l)||void 0===c?void 0:c.license)&&(i===je.FAIRPLAY?d.ckc=s(l.license):d.license=s(l.license));const u=l["renew-after"];u&&(d.renewalDate=new Date(Date.now()+1e3*u)),r.hls.setLicenseResponse(t.keyuri,d)}catch(d){var l;if(r._unrecoverableError)return;const e=d.data,n={};void 0!==(null===(l=e)||void 0===l?void 0:l.status)&&(n.statusCode=+e.status),Ji.warn("Passing license response error to Hls.js",n),r.hls.setLicenseResponse(t.keyuri,n),zi.has(d.name)&&(r._unrecoverableError=d,r.resetDeferredPlay(),yield r.stop({endReasonType:at.FAILED_TO_LOAD,userInitiated:o})),r.onPlaybackLicenseErr License}}function asyncGeneratorStep$q(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$q(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$q(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$q(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_ts_decorate$e([Bind(),_ts_metadata$e("design:type",Function),_ts_metadata$e("design:paramtypes",[void 0,void 0])],HlsJsAudioPlayer.prototype,"handleLevelSwitched",null),_ts_decorate$e([Bind(),_ts_metadata$e("design:type",Function),_ts_metadata$e("design:paramtypes",[void 0,void 0])],HlsJsAudioPlayer.prototype,"handleHlsError",null),_ts_decorate$e([Bind(),_ts_metadata$e("design:type",Function),_ts_metadata$e("design:paramtypes",[void 0,void 0])],HlsJsAudioPlayer.prototype,"handleManifestParsed",null),_ts_decorate$e([Bind(),_ts_metadata$e("design:type",Function),_ts_metadata$e("design:paramtypes",[void 0,void 0])],HlsJsAudioPlayer.prototype,"handleKeyRequestStarted",null),_ts_decorate$e([Bind(),_ts_metadata$e("design:type",Function),_ts_metadata$e("design:paramtypes",[void 0,void 0])],HlsJsAudioPlayer.prototype,"handleLicenseChallengeCreated",null),_ts_decorate$e([Bind(),_ts_metadata$e("design:type",Function),_ts_metadata$e("design:paramtypes",["undefined"==typeof Error?Object:Error])],HlsJsAudioPlayer.prototype,"onPlaybackLicenseError",null),_ts_decorate$e([AsyncDebounce(250),_ts_metadata$e("design:type",Function),_ts_metadata$e("design:paramtypes",[Number])],HlsJsAudioPlayer.prototype,"seekToTime",null);const Zi=BooleanDevFlag.register("mk-force-native-safari-video-player"),eo=BooleanDevFlag.register("mk-force-hlsjs-video-player"),to=BooleanDevFlag.register("mk-force-hls-audio-player"),ro=xe.createChild("factory");function contentRequiresHLSjs(e){return _contentRequiresHLSjs.apply(this.runtime}}function asyncGeneratorStep$p(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$p(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$p(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$p(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$d(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const{mediaPlaybackError:no,playerTypeDidChange:io}=nt,{playbackLicenseError:oo}=Be,{keySystemGenericErrorguments)}}();let co=!1;class MediaItemPlayback{get isDestroyed(){return this._isDestroyed}get currentPlaybackTime(){return this._currentPlayer.currentPlaybackTime}get currentPlaybackTimeRemaining(){return this._currentPlayer.currentPlaybackTimeRemaining}get currentPlayingDate(){return this._currentPlayer.currentPlayingDate}get isPlayingAtLiveEdge(){return this._currentPlayer.isPlayingAtLiveEdge}get seekableTimeRanges(){return this._currentPlayer.seekableTimeRanges}get audioTracks(){return this._currentPlayer.audioTracks}get currentAudioTrack(){return this._currentPlayer.currentAudioTrack}set currentAudioTrack(e){this._currentPlayer.currentAudioTrack=e}get currentPlaybackDuration(){return this._currentPlayer.currentPlaybackDuration}get currentBufferedProgress(){return this._currentPlayer.currentBufferedProgress}get currentPlaybackProgress(){return this._currentPlayer.currentPlaybackProgress}get currentTextTrack(){return this._currentPlayer.currentTextTrack}set currentTextTrack(e){this._currentPlayer.currentTextTrack=e}get previewOnly(){return this._previewOnly}set previewOnly(e){this._previewOnly=e}get isPlaying(){return this._currentPlayer.isPlaying}get isPrimaryPlayer(){return this._currentPlayer.isPrimaryPlayer}set isPrimaryPlayer(e){this._currentPlayer.isPrimaryPlayer=e}get isReady(){return this._currentPlayer.isReady}get nowPlayingItem(){return this._currentPlayer.nowPlayingItem}get playbackRate(){return this._currentPlayer.pckRate",e)}get playbackState(){return this._currentPlayer.playingItem)}get playbackTargetAvailable(){return this._currentPlayer.playbackTargetAvailable}get playbackTargetIsWireless(){return this._currentPlayer.playbackTargetIsWireless}get supportsPreviewImages(){return this._currentPlayer.supportsPreviewImages}get textTracks(){return this._currentPlayer.textTracks}get volume(){return this._currentPlvolume",e)}clearNextManifest(){this._currentPlayer.clearNexericError)}exitFullscreen(){return this._currentPlayer.exitFullscreen()}loadPreviewImage(e){var t=this;return _async_to_generator$p((function*(){return t._currentPlayer.loadPreviewImage(e)}))()}getNewSeeker(){return this._currentPlayer.s.volume=0}pause(e){var t=this;return _async_to_generator$p((function*(){return t._currentPlayer.pause(e)}))()}play(){var e=this;return _async_to_generator$p((function*(){return e._currentPlayer.play()}))()}preload(){var e=this;return _async_to_generator$p((function*(){return e._currentPlayer.pree)),i}))()}requelscreen(e)}showPlaybackTargetPicker(){this._currentPlayer.showPlaybackTargetPicker()}seekToTime(t,r=e.SeekReasonType.Manual){var n=this;return _async_to_generator$p((function*(){yield n._currentPlayer.seekToTime(t,r)}))()}setPresentationMode(e){var t=this;return _async_to_generator$p((function*(){return t._currentPlayer.setPresentationM}))()}stop(e){var t=this;return _async_to_generator$p((function*(){yield t._currentPlayer.s}))}))()}getCurrentPlayer(){return this._cuError)}}function asyncGeneratorStep$o(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$o(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$o(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$o(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0ata(e,t)}_ts_decorate$d([Bind(),_ts_metadata$d("design:type",Function),_ts_metadata$d("design:paramtypes",[void 0,void 0])],MediaItemPlayback.prototype,"onKeySystemGenericError",null),_ts_decorate$d([Bind(),_ts_metadata$d("design:type",Function),_ts_metadata$d("design:paramtypes",[void 0,void 0])],MediaItemPlayback.prototype,"onPlaybackLicenseError",null);const lo=[MKError.Reason.AGE_VERIFICATION,MKError.Reason.CONTENT_EQUIVALENT,MKError.Reason.CONTENT_RESTRICTED,MKError.Reason.CONTENT_UNAVAILABLE,MKError.Reason.CONTENT_UNSUPPORTED,MKError.Reason.SERVER_ERROR,MKError.Reason.SUBSCRIPTION_ERROR,MKError.Reason.UNSUPPORTED_ERROR,MKError.Reason.USER_INTERACTION_REQUIRED],uo=JsonDevFlag.register("mk-bag-features-overrides");class MKInstance{get developerToken(){return zn.developerToken}get api(){return this._services.apiManager.api}get audioTracks(){return this._mediaItemPlayback.audioTracks}get authorizationStatus(){return zn.authorizationStatus}get bitrate(){return this._services.bitrateCalcula.bitrate=e}get browserSupportsPictureInPicture(){return detectPictureInPictu)&&zn.cid}get continuous(){return this._playbackController.continuous}set continuous(e){this._playbackController.continuous=e}get autoplayEnabled(){return this._autoyEnabled))}get currentAudioTrack(){return this._mediaItemPlayback.currentAudioTrack}set currentAudioTrack(e){this._mediaItemPlayback.currentAudioTrack=e}get currentPlaybackDuration(){return this._mediaItemPlayback.currentPlaybackDuration}get currentPlaybackProgress(){return this._mediaItemPlayback.currentPlaybackProgress}get currentPlaybackTime(){return this._mediaItemPlayback.currentPlaybackTime}get currentPlayingDate(){return this._mediaItemPlayback.currentPlayingDate}get isPlayingAtLiveEdge(){return this._mediaItemPlayback.isPlayingAtLiveEdge}get seekableTimeRanges(){return this._mediaItemPlayback.seekableTimeRanges}get currentPlaybackTimeRemaining(){return this._mediaItemPlayback.currentPlaybackTimeRemaining}get currentTextTrack(){return this._mediaItemPlayback.currentTextTrack}set currentTextTrack(e){this._mediaItemPlayback.currentTextTrack=e}get isAuthorized(){return zn.isAuthorized}get isPlaying(){return this._playbackController.isPlaying}get isRestricted(){return zn.isRestricted}get metricsClientId(){return zn.metricsClientId}set metricsClientId(e){zn.metricsClientId=e}get musicUserToken(){return zn.musStorage()}get needsGDPR(){return zn.needsGDPR}get nowPlayingItem(){return this._mediaItemPlayback.nowPlayingItem}get nowPlayingItemIndex(){return this._playbackController.nowPlayingItemIndex}get playbackMode(){return this._packMode=t)}get playbackRate(){return this._mediaItemPlayback.playbackRate}set playbackRate(e){this._mediaItemPlayback.playbackRate=e}get playbackState(){return this._mediaItemPlayback.playbackState}get playbackTargetAvailable(){return this._mediaItemPlayback.playbackTargetAvailable}get playbackTargetIsWireless(){return this._mediaItemPlayback.playbackTargeD_CONTENT}get queue(){return this._playbackContrue.isEmpty}get realm(){return zn.realm}get repeatMode(){return this._playbackController.repeatMode}set repeatMode(e){this._playbackController.repeatMode=e}set requestUserToken(e){zn.requestUserToken=e}get restrictedEnabled(){return zn.restrictedEnabled}set restrictedEnabled(e){zn.restrictedEnabled=e}get supportsPreviewImages(){return this._mediaItemPlayback.supportsPreviewImages}get seekSeconds(){return this._playbackController.._services}set shuffle(e){this._playbackController.shuffle=e}get shuffleMode(){return this._playbackController.shuffleMode}set shuffleMode(e){this._playbackController.shuffleMode=e}get storefrontCountryCode(){return zn.storefrontCountryCode}get subscribeURL(){return zn.subscribeURL}get subscribeFamilyURL(){return zn.subscribeFamilyURL}get subscribeIndividualURL(){return zn.subscribeIndividualURL}get subscribeStudentURL(){return zn.subscribeStudentURL}get textTracks(){return this._mediaItemPlayback.textTracks}get videoContainerElement(){return this.context.videoContainerElement}set videoContainerElement(e){this.context.videoContainerElement=e}get volume(){return this._mediaItemPlayleanup(){var e=this;return _async_to_generator$o((function*(){var t;null===(t=e._services.mediaItemPlayback)||void 0===t||t.destroy(),e._signalIntent({endReasonType:at.EXITED_APPLICATION});const r=Object.keys(e._playbackContr].destroy());try{yield Promise.all(r)}catch(n){ti.error("Error cleaning up controller",n)}e._services.dispatcher.cit)}mute(){return this._mediaItemPlayback.mute()}pause(e){var t=this;return _async_to_generator$o((function*(){if(t._isPlaybackSupported()){try{t._signalIntent({endReasonType:at.PLAYBACK_MANUALLY_PAUSED}),yield t._playbackController.pause(e)}catch(Ae){t._handlePlaybackError(Ae)}return Promise.resoen(e)}loadPreviewImage(e){var t=this;return _async_to_generator$o((function*(){return t._mediaItemPlayback.loadPreviewImage(e)}))()}getNewSeeker(){return this._playbackController.getNewSeeker()}seekToTime(t,r=e.SeekReasonType.Manual){var n=this;return _async_to_gresolve()}}))()}setPresentationMode(e){var t=this;return _async_to_generator$o((function*(){return t._mediaItemPlayback.setPresentationMode(e)}))()}skipToNextItem(){var e=this;return _async_to_generator$o((function*(){if(e._isPlaybackSupported()){yield e._validateAuthorization(),e._signalIntent({endReasonType:at.TRACK_SKIPPED_FORWARDS,direction:at.TRACK_SKIPPED_FORWARDS});try{yield e._playbackController.skipToNextItem()}catch(Ae){e._handlePlaybackError(Ae)}}}))()}skipToPreviousItem(){var e=this;return _async_to_generator$o((function*(){if(e._isPlaybackSupported()){yield e._validateAuthorization(),e._signalIntent({endReasonType:at.TRACK_SKIPPED_BACKWARDS,direction:at.TRACK_SKIPPED_BACKWARDS});try{yield e._playbackController.skipToPreviousItem()}catch(Ae){e._handlePlaybackError(Ae)}}}))()}seekForward(){var e=this;return _async_to_generator$o((function*(){if(e._isPlaybackSupported()){yield e._validateAuthorization();try{e._signalIntent({endReasonType:at.TRACK_SKIPPED_FORWARDS,direction:at.TRACK_SKIPPED_FORWARDS}),yield e._playbackController.seekForward()}catch(Ae){e._handlePlaybackErrorAe)}}}))()}showPlaybackTargetPicker(){this._playbackController.showPlaybackTare()}))()}unmute(){return this._mediaItemPlaybafunction asyncGeneratorStep$n(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$n(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$n(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$n(o,n,i,_next,_throw,"throw",e)}_next(rguments)}function asyncGeneratorStep$m(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$m(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$m(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$m(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$r(e,t,r[t])}))}return e}_ts_decorate$c([AsyncDebounce(250,{isImmediate:!0}),_ts_metadata$c("design:type",Function),_ts_metadata$c("design:paramtypes",["undefined"==typeof ActivityNotificationOptions?Object:ActivityNotificationOptions])],MKInstance.prototype,"pause",null),_ts_decorate$c([AsyncDebounce(250,{isImmediate:!0}),_ts_metadata$c("design:type",Function),_ts_metadata$c("design:paramtypes",[])],MKInstance.prototype,"play",null),_ts_decorate$c([SerialAsync("skip"),_ts_metadata$c("design:type",Function),_ts_metadata$c("design:paramtypes",[])],MKInstance.prototype,"skipToNextItem",null),_ts_decorate$c([SerialAsync("skip"),_ts_metadata$c("design:type",Function),_ts_metadata$c("design:paramtypes",[])],MKInstance.prototype,"skipToPreviousItem",null),_ts_decorate$c([SerialAsync("seek"),_ts_metadata$c("design:type",Function),_ts_metadata$c("design:paramtypes",[])],MKInstance.prototype,"seekForward",null),_ts_decorate$c([SerialAsync("seek"),_ts_metadata$c("design:type",Function),_ts_metadata$c("design:paramtypes",[])],MKInstance.prototype,"seekBackward",null);const po="undefined"!=typeof window&&"undefined"!=typeof document;let ho=!1;const yo=[];function cleanupInstances(){return _cleanupInstances.apply(thisarguments)}function configure$3(e){return _configure$2.apply(thist.id===e)}function _define_property$q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$q(e,t,r[t])}ef:r})),t}po&&(asAsync(function(){return _loadWebComponents.apply(this,arguments)}()),dispatchDocumentEvent(|"songs"})}function _define_property$p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _o=["extend","include","l","platfortoreData)}}function asyncGeneratorStep$l(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$l(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$l(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$l(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}const CkedIdApi}}},formatTimros(n,2)}`},lr;return r};function asyncGeneratorStep$k(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$k(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$k(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$k(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread_props$a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_metadata$b(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.meetadata")}}function asyncGeneratorStep$j(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$j(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$j(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$j(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$n(e,t,r[t])}))}return e}function _object_spread_props$9(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_metadata$a(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([ChunkedIdApi(1),_ts_metadata$b("design:type",Function),_ts_metadata$b("design:paramtypes",[String,Object,"undefined"==typeof QueryParameters?Object:QueryParameters,"undefined"==typeof InternalMakeRequestOptions?Object:InternalMakeRequestOptions])],Books.prototype,"collecetadata")}}function asyncGeneratorStep$i(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$m(e,t,r[t])}))}return e}function _object_spread_props$8(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_metadata$9(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([ChunkedIdApi(1),_ts_metadata$a("design:type",Function),_ts_metadata$a("design:paramtypes",[String,Object,"undefined"==typeof QueryParameters?Object:QueryParameters,"undefined"==typeof InternalMakeRequestOptions?Object:InternalMakeRequestOptions])],Podcasts.prototype,"collection",null);const fo=new Set(["editoritadata"])}}function asyncGeneratorStep$h(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$h(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$h(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$h(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$l(e,t,r[t])}))}return e}function _object_spread_props$7(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_metadata$8(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([ChunkedIdApi(1),_ts_metadata$9("design:type",Function),_ts_metadata$9("design:paramtypes",[String,Object,"undefined"==typeof QueryParameters?Object:QueryParameters,"undefined"==typeof MakeRequestOptions?Object:MakeRequestOptions])],Fitness.prototype,"collecetadata")}}function asyncGeneratorStep$g(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$g(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$g(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$g(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$9(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$k(e,t,r[t])}))}return e}function _object_spread_props$6(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([ChunkedIdApi(1),_ts_metadata$8("design:type",Function),_ts_metadata$8("design:paramtypes",[String,"undefined"==typeof QueryParameters?Object:QueryParameters,"undefined"==typeof InternalMakeRequestOptions?Object:InternalMakeRequestOptions])],TVLibrary.prototype,"collection",null);const RecommendonUpdate}}};function asyncGeneratorStep$f(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0ge(),this.load()}}function asyncGeneratorStep$e(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$e(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$e(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$e(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$8(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$i(e,t,r[t])}))}return e}function _object_spread_props$5(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_metadata$7(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}conation-metadata")}}function asyncGeneratorStep$d(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$d(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$d(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$d(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$7(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$h(e,t,r[t])}))}return e}function _object_spread_props$4(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_decorate$6(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$6(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var go,mo;!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([ChunkedIdApi(1),_ts_metadata$7("design:type",Function),_ts_metadata$7("design:paramtypes",[String,Object,"undefined"==typeof QueryParameters?Object:QueryParameters,"undefined"==typeof MakeRequestOptions?Object:MakeRequestOptions])],Library.prototype,e.Social="so"]="library-s]+(\/)?$/,"")}}})}}function asyncGeneratorStep$c(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$c(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$c(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$c(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let bo;_ts_decorate$6([RecommendationUpdate(),_ts_metadata$6("design:type",Function),_ts_metadata$6("design:paramtypes",[Object,"undefined"==typeof QueryParameters?Object:QueryParameters,"undefined"==typeof MakeRequestOptions?Object:MakeRequestOptions,void 0])],API.prototype,"personalRecommendations",null),_ts_decorate$6([RecommendationUpdate(),_ts_metadata$6("design:type",Function),_ts_metadata$6("design:paramtypes",[Object,"undefined"==typeof QueryParameters?Object:QueryParameters,"undefined"==typeof MakeRequestOptions?Object:MakeRequestOptions])],API.prototype,"recommendations",null),_ts_decorate$6([ChunkedIdApi(2),_ts_metadata$6("design:type",Function),_ts_metadata$6("design:paramtypes",[void 0===go?Object:go,String,Object,"undefined"==typeof QueryParameters?Object:QueryParameters,"undefined"==typeof InternalMakeRequestOptions?Object:InternalMakeRequestOptions])],API.prototype,"collecty(this,arguments)}}(),Po={album:{isPlural:!1,apiMethod:"album",relationshipMethod:{method:"albumRelationship",relationship:"tracks"}},albums:{isPlural:!0,apiMethod:"albums"},audioBook:{isPlural:!1,apiMethod:"audioBook"},audioBooks:{isPlural:!0,apiMethod:"audioBooks"},episode:{isPlural:!1,apiMethod:"episode"},episodes:{isPlural:!0,apiMethod:"episodes"},musicVideo:{isPlural:!1,apiMethod:"musicVideo"},musicVideos:{isPlural:!0,apiMethod:"musicVideos"},musicMovie:{isPlural:!1,apiMethod:"musicMovie"},musicMovies:{isPlural:!0,apiMethod:"musicMovies"},podcast:{isPlural:!1,apiMethod:"podcast"},podcasts:{isPlural:!0,apiMethod:"podcasts"},playlist:{isPlural:!1,apiMethod:"playlist",relationshipMethod:{method:"playlistRelationship",relationship:"tracks"}},playlists:{isPlural:!0,apiMethod:"playlists"},song:{isPlural:!1,apiMethod:"song"},songs:{isPlural:!0,apiMethod:"songs"},tvEpisode:{isPlural:!1,apiMethod:"tvEpisode"},tvEpisodes:{isPlural:!0,apiMethod:"tvEpisodes"},uploadedAudio:{isPlural:!1,apiMethod:"uploadedAudio"},uploadedAudios:{isPlural:!0,apiMethod:"uploadedAudios"},uploadedVideo:{isPlural:!1,apiMethod:"uploadedVideo"},uploadedVideos:{isPlural:!0,apiMethods,arguments)}}())}}function asyncGeneratorStep$b(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$b(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$b(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$b(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _configure$1(){return(_configure$1=_async_to_generator$b((function*(e){const t=new UTSClientService;return yield t.configure(e),t}))).apply(this,arguments)}cla void 0!==this.api}configure(e){var t=this;return _async_to_generator$b((function*(){var r;t.api=(null!==(r=e.apiOptions)&&void 0!==ient}))()}clear(){}getAPIForItem(e){var t=this;return _asred");return t.api}))()}constructor(){_define_property$f(this,"api",void 0),_define_property$f(this,"namedQueueOptions",{}),_define_property$f(this,"url","")}}function asyncGeneratorStep$a(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class NpPlay{getNpPayloadContent(e,t,r,n="com.apple.tv"){var i,o,a,s;const c={context:{user:{id:r,keyspace:"cid"},userAgent:navigator.userAgent,appleStoreFront:null===(s=this.utsClient)||void 0===s||null===(a=s.configuration)||void 0===a||null===(o=a.applicationProps)||void 0===o||null===(i=o.storefront)||void 0===i?void 0:i.storefrontId,source:"Client_Device",cadence:"Contract",bundleId:n,millisecondsSinceEvent:0},event:{}};return"vod"===e?c.event.vodEvent=t:"live"===e&&(c.event.liveEvent=t),c}send(e,t,r,n="com.apple.tv"){var i,o=this;return(i=function*(){var i;const a={headers:{Authorization:"Bearer "+o.tokens.developerToken,"Media-User-Token":null!==(i=o.tokens.musicUserToken)&&void 0!==i?i:""},method:"POST",body:JSON.stringify(o.getNpPayloadContent(e,t,r,n))};return yield fetch("/api/np/play/json",a)},function(){var e=this,t=arguments;return new Promise((function(r,n){var o=i.apply(e,t);function _next(e){asyncGeneratorStep$a(o,r,n,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$a(o,r,n,_next,_throw,"throw",e)}_e,this.utsClient=t}}function _define_property$d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_metadata$5(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}class Legacy.handleTimeChange)}stopMonitor(){this.dispatcher.unsubscribe(Vn.playbackTimeDidChange,this.handleTimeChange)}handleTimeChange(){const e=Date.now(),t=this.decoratedLive.events[this.currentIndex];t?(e>=t.startTime&&!this.hasSentEventStart&&(this.hasSentEventStart=!0,this.callback("Event_Start",this.decoratedLive,t)),e>=t.endTime&&(this.hasSentEventStart=!1,this.currentIndex+=1,this.callback("Event_End",this.decoratedLive,t)),this.currentIndex>=this.decoratedLive.events.length&&this.stopMonitor()):this.stopMonitor()}constructor(e,t,r){_define_property$d(this,"dispatcher",void 0),_define_property$d(this,"callback",void 0),_define_property$d(this,"decoratedLive",void 0),_define_property$d(this,"currentIndex",void 0),_define_property$d(this,"hasSentEventStart",void 0),this.dispatcher=e,this.callback=t,this.decoratedLive=r,this.currentIndex=0,this.hasSentEventStart=!1}}function asyncGeneratorStep$9(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$5("design:type",Function),_ts_metadata$5("design:paramtypes",[])],LegacyDecorateLiveMonitor.prototype,"handleTimeChange",null);class PlayMetadata{get isDestroyed(){return this._isDestroyed}destroy(){var e;this._isDestroyed=!0,null===(e=this.watcher)||void 0===e||e.stopMonitor(),this.watcher=void 0}trackActivity(e,t){return(r=function*(){return Promise.resolve()},function(){var e=this,t=arguments;return new Promise((function(n,i){var o=r.apply(e,t);function _next(e){asyncGeneratorStep$9(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$9(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))})();var r}getAppBundleIds(e,t){var r,n,i,o;const a=null===(r=t)||void 0===r?void 0:r.channels;if(!Array.isArray(a)||void 0===(null===(n=e)||void 0===n?void 0:n.channelId))return;var s;return null!==>t.id===e.channelId))||void 0===o||null===(i=o.appBundleIds)||void 0===i?void 0:i[0])&&void 0!==s?s:void 0}determineRelativePosition(e,t){return e<=t.mainContentStarts?0:e>=t.mainContentEnds?t.mainContentEnds:e-t.mainContentStarts}constructor(e,t,r,n,i,o,a){_define_property$c(this,"appBundleIds",void 0),_define_property$c(this,"dispatcher",void 0),_define_property$c(this,"item",void 0),_define_property$c(this,"itemTiming",void 0),_define_property$c(this,"mediaItemPlayback",void 0),_define_property$c(this,"npPlay",void 0),_define_property$c(this,"playable",void 0),_define_property$c(this,"pldfltcid",void 0),_define_property$c(this,"utsClient",void 0),_define_property$c(this,"watcher",void 0),_define_property$c(this,"_isDestroyed",!1),this.dispatcher=e,this.item=r,this.mediaItemPlayback=t,this.npPlay=a,this.playable=n,this.pldfltcid=i,this.utsClient=o,this.appBundleIds=this.getAppBundleIds(n,r),this.itemTiming=function(e){const t=parseRollItems(e,["pre-roll"]),r=parseRollItems(e,["post-roll"]),n=t.reduce(addRollItemDuration,0),i=r.reduce(addRollItemDuration,0);var o,a;const s=null!==(a=null!==(o=e.hlsMetadata["up-next.start"])&&void 0!==o?o:e.hlsMetadata["watched.time"])&&void 0!==a?a:e.hlsMetadata["feature.duration"],c=parseFloat(s);return{mainContentStarts:n,mainContentEnds:c,mainContentLength:c-n,totalContentLength:c+i}}(r)}}function asyncGeneratorStep$8(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$8(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$8(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$8(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _ts_metadata$4(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}const Eo=new Set(["play","stop","Event_End","Event_Start"]);class LegacyLive extends PlayMetadata{init(){var e=this;return _async_to_generator$8((function*(){var t,r,n;const{playable:i}=e,o=yield null===(t=e.utsClient)||void 0===t?void 0:t.refresh("activityDecorateLive",{channelId:i.channelId,externalServiceId:i.externalServiceId});var a;e.legacyDecoratedLive=null!==(a=null===(r=o)||void 0===r?void 0:r.data)&&void 0!==a?a:o,e.legacyDecoratedLive&&(null===(n=e.legacyDecoratedLive.events)||void 0===n?void 0:n.length)&&e.setupLegacyLiveWatcher(e.legacyDecoratedLive)}))()}setupLegacyLiveWatcher(e){var t;this.watcher=new LegacyDecorateLiveMonitor(this.dispatcher,this.onLegacyLiveEvent,e),null===(t=this.watcher)||void 0===t||t.startMonitor()}onLegacyLiveEvent(e,t,r){var n=this;return _async_to_generator$8((function*(){if("Event_Start"===e||"Event_End"===e){var i;const o=n.pldfltcid,{appBundleIds:a,playable:s,utsClient:c}=n;if(!o||!c||!s)return;const l=n.generateLiveEvent(e,t,r);yield null===(i=n.npPlay)||void 0===i?void 0:i.send("live",l,o,null!=a?a:"com.apple.tv")}}))()}trackActivity(e,t){var r=this;return _async_to_generator$8((function*(){var t;const{legacyDecoratedLive:n}=r;if(!n||!r.playable||!Eo.has(e))return;const i=r.generateLiveEvent(e,n);var o;yield null===(t=r.npPlay)||void 0===t?void 0:t.send("live",i,r.pldfltcid,null!==(o=r.appBundleIds)&&void 0!==o?o:"com.apple.tv")}))()}generateLiveEvent(e,t,r){let n;var i,o;"play"===e?n="Tune_In":"stop"===e?n="Tune_Out":"Event_Start"!==e&&"Event_End"!==e||(n=e);const a={bundleId:null!==(i=this.appBundleIds)&&void 0!==i?i:"com.apple.tv",millisecondsSinceEvent:0,channel:{channelCanonicalId:t.serviceId,channelBrandId:t.channelId,channelExternalLiveServiceId:t.externalServiceId,channelInternalLegId:null!==(o=t.legId)&&void 0!==o?o:t.serviceId},cause:n};if(a.expectedStartTimeEpochMillis=t.scheduleStartTime,a.cleanupTimeEpochMillis=t.scheduleEndTime,r){let e;"number"==typeof r.endTime&&"number"==typeof r.startTime&&(e=r.endAirTime-r.startAirTime),a.content={contentCanonicalId:r.canonicalId,contentBrandId:r.channelId,contentExternalPlayableId:r.playableExternalId,contentMediaLengthInMilliseconds:e,contentLiveFeatureOrLiveEndCredits:"Event_Start"===n?"Live_Feature":"Live_End_Credits",contentInternalLegId:r.legId},a.expectedStartTimeEpochMillis=r.startTime,a.cleanupTimeEpochMillisitable:!0}):t[r]=n}}function asyncGeneratorStep$7(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$7(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$7(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$7(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread_props$3(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_metadata$3(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$4("design:type",Function),_ts_metadata$4("design:paramtypes",["undefined"==typeof LiveEventCause?Object:LiveEventCause,"undefined"==typeof LegacyDecorateLiveProperties?Object:LegacyDecorateLiveProperties,"undefined"==typeof LegacyDecorateLiveEvent?Object:LegacyDecorateLiveEvent])],LegacyLive.prototype,"onLegacyLiveEvent",null);const To=new Set(["exit","pause","play","scrub","seek","skip","stop"]);class LegacyVod extends PlayMetadata{init(){var e=this;return _async_to_generator$7((function*(){var t,r,n,i;const{item:o,playable:a}=e;if(hasContentCompletionThresholdData(o)){const t=getContentCompletionThreshold(o);e.setupLegacyVodWatcher(t,Number.POSITIVE_INFINITY)}const s=1e3*parseInt(""+a.duration,10),c=`${a.channelId}:${a.externalId}:${s}`,l=yield null===(t=e.utsClient)||void 0===t?void 0:t.refresh("activityPlayablesDecorate",{ids:c});var d;e.legacyDecorated=null!==(d=null===(r=l)||void 0===r?void 0:r[c])&&void 0!==d?d:null===(i=l)||void 0===i||null===(n=i.data)||void 0===n?void 0:n[c]}))()}setupLegacyVodWatcher(e,t){this.watcher=new SpanWatcher(this.dispatcher,this.onContentCompletionThreshhold,e,t,!0),this.watcher.startMonitor()}onContentCompletionThreshhold(e){var t=this;return _async_to_generator$7((function*(){yield t.trackActivity("exit",e),t.dispatcher.publish(tt.mediaContentComplete,t.item)}))()}trackActivity(e,t){var r=this;return _async_to_generator$7((function*(){var n,i;const{appBundleIds:o,legacyDecorated:a,playable:s,pldfltcid:c}=r;let{itemTiming:l}=r;if(!(a&&s&&l&&To.has(e)))return;if("stop"===e){var d;const e=r.itemTiming.totalContentLength;if(!(null===(d=r.item)||void 0===d?void 0:d.isLinearStream)&&void 0!==e&&void 0!==t){const r=e-t;r>=0&&r<5&&(t=e+.5)}}const u=null===(n=r.mediaItemPlayback)||void 0===n?void 0:n.currentPlaybackDuration;if(isNaN(l.totalContentLength)||u&&u<l.totalContentLength){const e=null!=u?u:NaN;isNaN(e)||(r.itemTiming=l=_object_spread_props$3(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$a(e,t,r[t])}))}return e}({},l),{mainContentEnds:e,mainContentLength:e,totalContentLength:e}))}const p=r.generateVodEvent(s,a,l,t);yield null===(i=r.npPlay)||void 0===i?void 0:i.send("vod",p,c,null!=o?o:"com.apple.tv")}))()}generateVodEvent(e,t,r,n){const i={playable:{externalPlayableId:e.externalId,brandId:t.brandId},internalLegId:t.internalLegId,canonicalId:t.canonicalId,mediaLengthInMilliseconds:Math.floor(1e3*r.totalContentLength),mainContentLengthInMilliseconds:Math.floor(1e3*r.mainContentLength),playHeadInMilliseconds:Math.floor(1e3*n),mainContentPlayHeadInMilliseconds:Math.floor(1e3*this.determineRelativePosition(n,r)),featureOrEndCredits:n>r.mainContentEnds?"End_Credits":"Feature"};return"Episode"===t.contentType&&(i.tvEpisode={externalShowId:t.externalShowId,canonicalShowId:t.canonicalShowId,currentOrPreviousEpisode:t.isCurrent?"Latest_And_Current_Episode":"Previous_Episode",openOrClosedShow:t.isShowClosed?"Show_Closed_No_More_Episodes_Expected":"Show_Open_More_EpiDecorated",void 0)}}function asyncGeneratorStep$6(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$6(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$6(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$6(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$9(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ts_decorate$2(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata$2(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$3("design:type",Function),_ts_metadata$3("design:paramtypes",[Number])],LegacyVod.prototype,"onContentCompletionThreshhold",null);class Live extends PlayMetadata{init(){var e=this;return _async_to_generator$6((function*(){var t,r;const{playable:n}=e,i=yield null===(t=e.utsClient)||void 0===t?void 0:t.refresh("getContentsPlayMetadataLive",{brandId:n.channelId,externalServiceId:n.externalServiceId});var o;e.playMetadataLive=null!==(o=null===(r=i)||void 0===r?void 0:r.data)&&void 0!==o?o:i,e.rethis.unsubscribe()}trackActivity(e,t){var r=this;return _async_to_generator$6((function*(){"scrub"!==e&&"seek"!==e||r.resetListening()}))()}handleTimeChange(){var e,t;const{scheduleItems:r}=this;var n;const i=null!==(n=null===(t=this.mediaItemPlayback)||void 0===t||null===(e=t.currentPlayingDate)||void 0===e?void 0:e.getTime())&&void 0!==n?n:0;if(0!==i&&r){for(let e=0;e<r.length;e++){const t=r[e],n="eventTime"in t?t.eventTime.liveBadgeTime.startTime:t.startAirTime,o="eventTime"in t?t.eventTime.liveBadgeTime.endTime:t.endAirTime;if(i>=n&&i<=o)r.splice(e,1),e-=1,this.onLiveEvent(t);else if(i>n)r.splice(e,1),e-=1;else if(i<n)return}0===r.length&&this.unsubscribe()}}onLiveEvent(e){var t=this;return _async_to_generator$6((function*(){var r;const n=t.pldfltcid,{appBundleIds:i,playable:o,utsClient:a}=t;if(!n||!a||!o)return;const s=t.generateEventStartEvent(e);yield null===(r=t.npPlay)||void 0===r?void 0:r.send("live",s,n,null!=i?i:"com.apple.tv")}))()}generateEventStartEvent(e){var t;return{bundleId:"com.apple.tv",millisecondsSinceEvent:0,cause:"Event_Start",passThrough:null===(t=e)||void 0===t?void 0:t.nowPlayingPassThrough}}resetListening(){var e;const t=null===(e=this.playMetadataLive)||void 0===e?void 0:e.schedule;t&&t.length&&(this.scheduleItems=[...t],this.unsubscribe(),this.subscribe())}subscribe(){this.dispatcher.subscribe(Vn.playbackTimeDidChange,thi.handleTimeChange)}constructor(...e){super(...e),_define_property$9(this,"playMetadataLive",void 0),_define_property$9(this,"scheduleItems",[])}}function asyncGeneratorStep$5(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$5(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$5(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$5(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$8(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread_props$2(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_metadata$1(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}_ts_decorate$2([Bind(),_ts_metadata$2("design:type",Function),_ts_metadata$2("design:paramtypes",[])],Live.prototype,"handleTimeChange",null),_ts_decorate$2([Bind(),_ts_metadata$2("design:type",Function),_ts_metadata$2("design:paramtypes",[Object])],Live.prototype,"onLiveEvent",null);const ko=new Set(["exit","pause","play","scrub","seek","skip","stop"]);class Vod extends PlayMetadata{init(){var e=this;return _async_to_generator$5((function*(){var t,r;const{item:n,playable:i}=e;if(hasContentCompletionThresholdData(n)){const t=getContentCompletionThreshold(n);e.setupVodWatcher(t,Number.POSITIVE_INFINITY)}const o=yield null===(t=e.utsClient)||void 0===t?void 0:t.refresh("getContentsPlayMetadataVOD",{externalId:i.externalId,brandId:i.channelId,hlsAssetDuration:e.mediaItemPlayback.currentPlaybackDuration});var a;e.metadata=null!==(a=null===(r=o)||void 0===r?void 0:r.data)&&void 0!==a?a:o}))()}setupVodWatcher(e,t){this.watcher=new SpanWatcher(this.dispatcher,this.onContentCompletionThreshhold,e,t,!0),this.watcher.startMonitor()}onContentCompletionThreshhold(e){var t=this;return _async_to_generator$5((function*(){yield t.trackActivity("exit",e),t.dispatcher.publish(tt.mediaContentComplete,t.item)}))()}trackActivity(e,t){var r=this;return _async_to_generator$5((function*(){var n,i;const{appBundleIds:o,metadata:a,playable:s,pldfltcid:c}=r;let{itemTiming:l}=r;if(!(a&&s&&l&&ko.has(e)))return;if("stop"===e){var d;const e=r.itemTiming.totalContentLength;if(!(null===(d=r.item)||void 0===d?void 0:d.isLinearStream)&&void 0!==e&&void 0!==t){const r=e-t;r>=0&&r<5&&(t=e+.5)}}const u=null===(n=r.mediaItemPlayback)||void 0===n?void 0:n.currentPlaybackDuration;if(isNaN(l.totalContentLength)||u&&u<l.totalContentLength){const e=null!=u?u:NaN;isNaN(e)||(r.itemTiming=l=_object_spread_props$2(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$8(e,t,r[t])}))}return e}({},l),{mainContentEnds:e,mainContentLength:e,totalContentLength:e}))}const p=r.generateVodEvent(s,a,l,t);yield null===(i=r.npPlay)||void 0===i?void 0:i.send("vod",p,c,null!=o?o:"com.apple.tv")}))()}generateVodEvent(e,t,r,n){var i,o;return{playHeadInMilliseconds:Math.floor(1e3*n),mediaLengthInMilliseconds:Math.floor(1e3*r.totalContentLength),mainContentInfo:{isDone:n>=r.mainContentEnds?"Done":"Not_Done",playHeadInMilliseconds:Math.floor(1e3*this.determineRelativePosition(n,r)),lengthInMilliseconds:Math.floor(1e3*r.mainContentLength),passThrough:null!==(o=null===(i=this.metadata)||void 0===i?void 0:i.nowPlayingPassThrough)&&void 0!==o?o:""}}}constructor(...e){super(...e),_define_property$8(this,"metadata",void 0)}}function asyncGeneratorStep$4(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$4(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$4(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$4(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$7(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([Bind(),_ts_metadata$1("design:type",Function),_ts_metadata$1("design:paramtypes",[Number])],Vod.prototype,"onContentCompletionThreshhold",null);class Ebs extends PlayMetadata{init(){var e=this;return _async_to_generator$4((function*(){var t,r;const{playable:n}=e,i=yield null===(t=e.utsClient)||void 0===t?void 0:t.refresh("getContentsPlayMetadataEBS",{brandId:n.channelId,externalId:n.externalId});var o;const a=null!==(o=null===(r=i)||void 0===r?void 0:r.data)&&void 0!==o?o:i;e.playMetadataEbs=a}))()}trackActivity(e,t){var r=this;return _async_to_generator$4((function*(){if("exit"!==e&&"stop"!==e){if("play"===e&&!r.sentEventStart){var t;const e=r.pldfltcid,{appBundleIds:n,playable:i,utsClient:o}=r;if(!e||!o||!i)return;const a=r.generateEventStartEvent();yield null===(t=r.npPlay)||void 0===t?void 0:t.send("live",a,e,null!=n?n:"com.apple.tv"),r.sentEventStart=!0}}else r.sentEventStart=!1}))()}generateEventStartEvent(){var e,t;return{bundleId:"com.apple.tv",millisecondsSinceEvent:0,cause:"Event_Start",passThrough:null!==(t=null===(e=this.playMetadataEbs)||void 0===e?void 0:e.nowPlayingPassThrough)&&void 0!==t?t:""}}constructor(...e){super(...e),_define_property$7(this,"playMetadataEbs",void 0),_define_property$7(this,"sentEventStart",!1)}}function asyncGeneratorStep$3(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$3(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$3(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$3(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$6(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class BookmarkTracker{get requestedEvents(){return Array.from(this.dispatchTable.keys())}get isConfigured(){return void 0!==this.npPlay}configure(e){var t=this;return _async_to_generator$3((function*(){var r,n,i,o,a,s;if(!t.shouldConfigure(e.instance))return;const c=e.instance;t.dispatcher=e.services.dispatcher,t.mediaItemPlayback=e.services.mediaItemPlayback,t.utsClient=null===(r=e.services.apiManager)||void 0===r?void 0:r.utsClient,t.npPlay=new NpPlay({get developerToken(){return c.developerToken)&&void 0!==e?e:""}},t.utsClient);const l=null===(s=t.utsClient)||void 0===s||null===(a=s.configuration)||void 0===a||null===(o=a.applicationProps)||void 0===o||null===(i=o.requiredParamsMap)||void 0===i||null===(n=i.Default)||void 0===n?void 0:n.v;parseInt(null!=l?l:"0",10)>=64&&(t.usePlayMetadataEndpoints=!0)}))()}cleanup(){var e=this;return _async_to_generator$3((function*(){e.clearItem()}))()}shouldConfigure(e){return _async_to_generator$3((function*(){return!!qn.features.bookmarking&&e.isAuthorized}))()}shouldTrackPlayActivity(t,r){if(!r||!this.utsClient)return!1;const n=-1===[e.PlaybackType.none,e.PlaybackType.preview].indexOf(r.playbackType),i="Bonus"!==r.type&&"Extra"!==r.contentType;return Gn.debug("Bookmark shouldTrackPlayActivity",n&&i,t),n&&i}handleEvent(e,t,r){if(!this.shouldTrackPlayActivity(e,r))return;const n=this.dispatchTable.get(e);void 0!==n&&"function"==typeof this[n]&&this[n](r,t)}exit(e,t={}){var r=this;return _async_to_generator$3((function*(){yield r.trackActivity("exit",void 0,t.position),r.clearItem()}))()}pause(e,t={}){var r=this;return _async_to_generator$3((function*(){yield r.trackActivity("pause",e,t.position)}))()}play(e,t={}){var r=this;return _async_to_generator$3((function*(){const n=void 0===t.position?0:t.position;yield r.trackActivity("play",e,n)}))()}scrub(e,t={}){var r=this;return _async_to_generator$3((function*(){yield r.trackActivity("scrub",e,t.position)}))()}seek(e,t={}){var r=this;return _async_to_generator$3((function*(){yield r.trackActivity("seek",e,t.position)}))()}skip(e,t={}){var r=this;return _async_to_generator$3((function*(){yield r.trackActivity("skip",e,t.position)}))()}stop(e,t={}){var r=this;return _async_to_generator$3((function*(){yield r.trackActivity("stop",e,t.position),r.clearItem()}))()}clearItem(){var e;this.currentItem=void 0,null===(e=this.playMetadata)||void 0===e||e.destroy(),this.playMetadata=void 0}trackActivity(e,t,r){var n=this;return _async_to_generator$3((function*(){var i,o;if(void 0!==r&&void 0!==n.utsClient&&(void 0!==t&&t.id!==(null===(i=n.currentItem)||void 0===i?void 0:i.id)&&(yield n.updateItem(t)),void 0!==n.currentItem))return null===(o=n.playMetadata)||void 0===o?void 0:o.trackActivity(e,r)}))()}updateItem(e){var t=this;return _async_to_generator$3((function*(){var r,n;const i=yield zn.storekit.pldfltcid();if(void 0===t.utsClient||!t.dispatcher||!i)return;if(t.currentItem&&t.currentItem.id!==e.id&&t.clearItem(),void 0!==t.currentItem)return;t.currentItem=e;const o=e.defaultPlayable;if(void 0===o)return;let a;null===(r=t.playMetadata)||void 0===r||r.destroy(),a=e.isLinearStream?t.usePlayMetadataEndpoints?"EbsEvent"===o.type?Ebs:Live:LegacyLive:t.usePlayMetadataEndpoints?Vod:LegacyVod,t.playMetadata=new a(t.dispatcher,t.mediaItemPlayback,e,o,i,t.utsClient,t.npPlay),yield null===(n=t.playMetadata)||void 0===n?void 0:n.init()}))()}constructor(){_define_property$6(this,"currentItem",void 0),_define_property$6(this,"playMetadata",void 0),_define_property$6(this,"dispatcher",void 0),_define_property$6(this,"mediaItemPlayback",void 0),_define_property$6(this,"utsClient",void 0),_define_property$6(this,"usePlayMetadataEndpoints",!1),_define_property$6(this,"npPlay",void 0),_define_property$6(this,"dispatchTable",new Map([[tt.playbackPlay,"play"],[tt.playbackPause,"pause"],[tt.playbackScrub,"scrub"],[tt.playbackSeek,"seek"],[tt.playbackSkip,"skip"],[tt.playbackStop,"stop"],[tt.playerExit,"exit"]]))}}var ined(e)&&null!==e}function isEmptyString(e){return isStrict.keys(e).length}function isFunction$1(e){return"nstanceof String}function isArray$1(e){return!!e&&e.i=!0}}return i}function detachMethods(e){var t=!1;for(var r in e){if(isFunction$1(e[r])&&!0===e[r].attachedMethod)if(e[r].origFunction)for(;e[r].origFunction;)e[r]=e[r].origFunction,t=!0;else durn Object.keys(r)}var Oo=Object.freeze({__proto__:null,_utResetNonOo={setDelegatn[o]=e[o];return n},isDefined:isDefined,isDefinedNonNull:isDefinedNonNull,isDef&!isEmptyObject(e)},isEmptyString:isEmptyString,isEmptyArray:isEmptyArray,isEmptyObject:isEmptyObject,isFunction:isFunction$1,isNumber:isNumber$1,isInteger:isInteger$2,isString!!e&&1==e.nodeType},isArray:isArray$1,isObjt.pust.push(r);roperty(t))return!0(t)&&e[t])return!0},hasGetterAndSetterMethods:hasGetterAndSet.push([e[r]]=r);return t},extend:extend$5,copyKeysAndValues:copyKeysAndValues$1,addNonOvr r=e[t];wo[r]=!0}},attachMethods:attachMethods$1,detachMethods:detachMett,null,n)}rette(t[n]));returhods(n))}return!!t},coplegate(i)}return r},dedupedArray:dedupedArray}),Io={maxWait:1500,initialDelay:100,factor:2},ExponentialStrategy=function(e,t,r){this.delay=e||Io.initialDelay,this.maxWait=isNumber$1(t)?t:Io.maxWait,this.factor=r||Io.factor,this.timeWaited=0};ExponentialStrategy.lay*this.factor),e};var Ao=Object.freeze({__proto__:null,exponentialBackoff:function(e,t,r,n,i,o){!function _backoff(eapply(n,arguments)}))}(new ExponentialStratealue("disabled",e)}function denylistedEvents(e){var t=this.value("denylistedEvents",e);return dedupedArray(this.value("blacksFields",e)||[]}var Ro=Object.freeze({__proto__:null,disabled:disabled,blacklistedEvents:function(e){return denylistedEvents.call(this,e)},denylistedEvents:denylistedEvents,blacklistedFields:function(e){return denylistedFields.call(this,e)},denylistedFields:denylistedFields,removeBlacklistedFields:function(e,t){return removeDenylistedFields$1.call(this,e,t)},removeDenylistedFields:removeDenylistedFields$1,metricsDisablet$1.call(this,e,t)},metricsDisabledOrDenylistedEvent:metricsDisabledOrDenylistedEvent$1,deResFields:deRicantDigits))})),e}}),$o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqaracter(e,r,n)),i}var Do=Object.freeze({__proto__:null,base10Alphabet:"0123456789",base16Alphabet:"0123456789ABCDEF",base36Alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",base61Alphabet:$o,base62Alp===e.indeOf(t)===i}return n},trim:function(e,t,r){var n=null,i=new RegExp("^[\t\n\v\f\r \u2028\u2029]+"),o=new RegExp("[\t\n\v\f\r \u2028\u2029]+$");if(e)if(r||t&&"\t\n\v\f\r \u2028\u2029"!=t||!e.trim){var a=null,s=null,c=null;t&&void 0!==t?(a="["+(t=t.replace(/([.?*+^$[\]\\(){}-])/g,"\\$1"))+"]",s=new RegExp("^"+a+"+"),c=new RegExp(a+"+$")):(a="\t\n\v\f\r \u2028\u2029",s=i,c=o();return n},snam-specific d{var t="",r="",n=!0;for(varomUserAgent:function(e,t){var r=null;t=t||"\\S+";var n=new RegExp("\\b"+t+"/(\\S+)\\b","i").exec(e);return n&&n[1]&&(r=n[1]),r},requestId:function(e){var t=Datex",n="",i=0,o=r.length;i<o;i++)n+="x"===(t=r.charAt(i))?randomHexCoUpperCase();else{for(varf(ength>1&&(r=r.concat(Array.prototype.slice.call(arguments,1)));for(var n=0;n<r.length;n++)t.freeze({__proto__:null,valn];if(i&&i.constructor===Array)for(var o=0;o<i.length;o++)r.push(i[o]);else r.push(i)}return copyKeysAndVgth)for(var s=0fientials="boolean"!=typeof o.withCredentials||o.withCredn/json"),a.send(r)}var xo=Object.freeze({__proto__:null,makeAjaxGetRequest:function(e,t,r){makeAjaxRequest$2(e,"GET",nction(e){return this.storage[e]},setItem:function(e,t){this.storage[e]=t},removeItem:function(e){delete this.storage[e]}})),t}};function _defaultStorageObject(e){var t=null,r=e===jo.LOCAL_STORAGE;try{t="undefined"!==(r?typeof localStorage:typeof sessionStorage)?r?localStorage:sessionStorage:null}catch(n){t=null,console.error("_utils.storage._defaultStorageObject: Unable to retrieve storage object: "+n)}return t}var No=_storageObject(_defaultStorageObject(jo.LOCAL_STOR(jo.SESSION_STORAGE));var Fo=Object.freeze({__proto__:null,_utDefajectToStorage:functenction(e,t){var r=null,n=e.getItem(t);if(n)try{r=JSON.parse(n)}catch(i){r=void 0}return r}});function FlagSymbol(e){this.key=e}FlagSymbol.prototype.toString=function(){return this.key};var Bo={flagArguments:{INCLUDE_CALL_STACK:new FlagSymbol("INCLUDE_CALL_STACK"),MIRROR_TO_SERVER:new FlagSymbol("MIRROR_TO_SERVER"),SUPPRESS_CLIENT_OUTPUT:new FlagSymbol("SUPPRESS_CLIENT_OUTPUT")},setDelegate:function(e){return Oo.attachDelegate(this,e)},execute:function(e,t,r){var n=e.levelStringToIntMap[t];if(e.level()!==e.NONE&&e.level()<=n){var i=Array.prototype.slice.call(r),o=Bo.nonFlagLogArguments(i),a=Bo.logOptions(e,n,i),s=a.includeCallStack?(new Error).stack:null,c=s?o.concat("\n"+s):o;if(e[t]._lastLog=c,a.mirrorToServer,a.throwInsteadOfPrint)throw new Esole[t].apply(consol&e===Bo.flaNE&&e.mirrorTi.mirrorToServer=!0),e.throwLevel()!==e.NONE&&e.throwLevel()<=t&&(i.throwInsteadOfPrint=!0),i},sendToServer:function(e,t,r,n){}},Ko={NONE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4},Vo={MIN_LEVEL:Ko.NONE,MAX_LEVEL:Ko.ERROR,levelIntToStringMap:{0:"none",1:"debug",2:"info",3:"warn",4:"error"},levelStringToIntMap:{none:0,debug:1,info:2,warn:3,error:4}};Oo.extend(Vo,Ko);var Go={loggerName:"defaultLogger",level:Vo.INFO,throwLevel:Vo.NONE},Ho=!1,Wo={};function Logger(e){this._loLogger.prototype,Bo.flagArguments))}function loggerNamed(e){var t=Wo[e=e||Go.loggerName];return t||(t=new Logger(e),Wo[e]=t),t}Logger.level=function(){return Go.level},Logger.throwLevel=function(){return Go.throwLevel},Logger.prototype.setDelegate=function(e){return Oo.isString(e)?t=this.levelStringToIntMap[e.toLowerCase()]:Oo.isNumber(e)&&(t=e),t>=this.MIN_LEVEL&&t<=this.MAX_LEVEL&&(r=t),r},Lo&&(this._level=t)},Logger.prototype.setThrowLevel=function(e){var t=this.levelParameterAsInt(e);null!==t&&(this._throwLev;return Oo.isNumber(e)?e:LogngMap[this.level()]},Logger.prototype.throwLevel=function(){var e=this._throwLevel;return Oo.isNumber(e)?e:Logger.throwLevel()},Logger.prototype.debug=function(){Bo.execute(this,"debug",arguments)},Logger.prototype.info=function(totype.warn=function(){Boerror=function(){Bo.execute(this,"error",arguments)},Logger.prototype.lastLog=function(e){return this[e]?this[e]._lastLog:null},Logger.level,Logger.throwLevel;var qo=Oo.attachDelegate,Yo={setDelegate:function(e){return qo(this,e)},localStorageObject:Fo.localStorageObject,sessionStorageObject:Fo.sessionStorageObject},zo=Oo.attachDelegate,Qo={setDelegate:function(e){return zo(this,e)},makeAjaxRequest:xo.makeAjaxRequest},Jo=Oo.attachDelegate,Xo=Oo.hasAnyKeys,Zo=Oo.isArray,ea=Fo.saveObjectToStorage,ta=Fo.objectFromStorage,ra=Ao.exponentialBackoff,na=Mo.valueForKeyPath,ia={blacklistedFields:["capacitySystem","capacitySystemAvailable","capacityDisk","capacityData","capacityDataAvailable"],compoundSeparator:"_",configBaseUrl:"https://xp.apple.com/config/1/report",constraints:{profiles:{AMPWeb:{precedenceOrderedRules:[{filters:"any",fieldConstraints:{clientId:{generateValue:!0,namespace:"AMPWeb_isSignedOut",expirationPeriod:864e5}}},{filters:{valueMatches:{isSignedIn:[!0]}},fieldConstraints:{clientId:{generateValue:!0,namespace:"AMPWeb_isSignedIn",expirationPeriod:15552e6}}}]},strict:{precedenceOrderedRules:[{filters:"any",fieldConstraints:{clientId:{generateValue:!0,scopeFieldName:"parentPageUrl",scopeStrategy:"mainDomain",expirationPeriod:864e5},consumerId:{blacklisted:!0},dsId:{blacklisted:!0},parentPageUrl:{scope:"hostname"}}},{filters:{valueMatches:{eventType:["click"],actionType:["signUp"]}},fieldConstraints:{parentPageUrl:{scope:"fullWithoutParams"}}},{filters:{valueMatches:{eventType:["dialog"],dialogType:["upsell"],result:["upsell"]}},fieldConstraints:{parentPageUrl:{scope:"fullWithoutParams"}}},{filters:{valueMatches:{userType:["signedIn"]}},fieldConstraints:{clientId:{scopeStrategy:"all"}}},{filters:{valueMatches:{userType:["signedIn"],eventType:["click","dialog","media","search"]}},fieldConstraints:{clientId:{blacklisted:!0},consumerId:{blacklisted:!1},dsId:{blacklisted:!1}}},{filters:{valueMatches:{userType:["signedIn"],eventType:["page","impressions"]},nonEmptyFields:["pageHistory"]},fieldConstraints:{clientId:{blacklisted:!0},consumerId:{blacklisted:!1},dsId:{blacklisted:!1}}}]}}},fieldsMap:{cookies:["itcCt","itscc"],custom:{impressions:["id","adamId","link.type","station-hash"],location:["id","adamId","dataSetId","name","fcKind","kindIds","type","link.type","station-hash","core-seed-name"]},single:{targetId:["id","adamId","contentId","type","link.type","fcId","userPreference","label","station-hash","linkIdentifier"]}},metricsUrl:"https://xp.appleeparatoSource"+ia.compoundSConfig.createConfinitCalled&&i.init(t,(e),oa[e]=t),t},Config.cleanupConfig=function(e){if(e&&oa[e]){var t=oa[enction(){return Config.getConfig()},Config.value=function(e,t){var r=t&&oa[t]||Config.defaultConfig();return r.value.call(r,e)},Config.environment=Yo,Config.logger=loggerNamed("mt-client-config"),Config.network=Qo,Config.prototype._defaults=function(){return ia},Config.prototype._setInitialized=function(e){this._initialized=e},Config.prototype._setInitCalled=function(e){this._initCalled=e},Config.prototype._setShowedDebugWarning=function(e){this._showedDebugWarning=e},Config.prototype._setShowedNoProvidedSourceWarning=function(e){this._showedNoProvidedSourceWarning=e},Config.prototype.setDelegate=function(e){return Jo(this,e)aseUrl"),"noTopicConfig"!==this._topic?e+="/"+this.topic():CoOf("blacklisted")?a?[r,n,i,o]:[ia]:[ia,r,n,iappendSectionAndSubsectionToConfigSources(o,t,i[a]);r.push(o)}else _appendSectionAndSubsectionToConfigSources(r,t,i)}}return r},Config.prototype.setDebugSource=function(e){return this._debugSource=e||null,ea(Yo.localStorageObject(),this.DEBUG_SOURCE_KEY,this._debugSource)},Config.prototype.debugSource=function(){return this._debugSochedSource=function(e){return nction(){return this._cachedSourceOURCE_KEY)),this._cachedSource},Config.prototype.setServiceSource=function(e){return this._serviceSource=e,this._serviceSource},Config.prototype.serviceSource=function(){return tra(Qo.makeAjaxRequest.bind(ar i=this.configUrl(),o=funconfig(i,o,r)}}},Config.prototype.initialize=function(e,t,r){return this.init.apply(this,Array.prototype.slice.call(arguments))},Config.prototype.initialized=function(){return this._initia=r),n}function _removeIdentifiableFieldsForTopic(e,t){ca[e]=ca[e]||{},ca[e].anonymous&&la.forEach((function(e){delete t[e]}))}var da=Oo.attachDelegate,ua={setDelegate:function(e){return da(this,e)},makeAjaxRequest:xo.makeAjaxRequest};Oo.isString,Oo.isFunction,Ro.disabled;var pa=1e4,ha="events",ya="1.0",_a=2;function enrichAndSerializeEvents(e){var t=null;if(e&&e.length){var r={};r.deliveryVersion=ya,r.postTime=Date.now(),r[ha]=e;try{t=JSON.stringify(r)}catch(n){loggerNamed("mt-event-queue").error("Error stringifying events as JSON: "+n)}}return t}function _immediateRecordEvent(e,t){var r=enrichAndSerializeEvents([t]);if(r){var n=function(e){return Config.value("metricsUrl",e)+"/"+_a+"/"+e}(e),i={timeout:function(e){var t=Config.value("requestTimeout",e)||pa;return t=Math.min(t,Config.value("postFrequency",e))}(e)};ca[e]&&ca[e].anonymous&&(i.withCredentials=!1),ua.makeAjaxRequest(n,"POST",r,null,null,i)}}Oo.attachDelegate;var fa,va,ga={_document:function(){if("undefined"!=("undefined"!=typeof window)return window;throw"metricskit-delegates-html.environment HTML delegate 'window' object not foutPageUrl:function(){var e,t=ga._window(),r=t.parent;if(r!==t)try{e=r.location.href}catch(n){e=ga._document().referrer}return e},pixelRatio:function(){return ga._window().devicePixelRatio.height},screenWidth:function(){return ga._window().screen.width},userAgent:function(){return ga._window().navigator.userAgent},windowInnerHeight:function(){return ga._window().innerHeight},windowInneridth},windowOuterterWidth},timeOriginOffset:function(){var e=null,t=ga._window().performance;return t&&t.timing&&(e=t.timing.navigationStart),e},app:function(){},appVersion:function(){},capacityData:function(){},capacityDataAvailable:function(){},capacityDisk:function(){},capacitySystem:function(){},capacitySystemAvailable:function(){},connectionType:function(){},dsId:function(){},hardwareBrand:function(){},hardwareFamily:function(){},hardwareModel:function(){},hostApp:function(){},hostAppVersion:function(){},os:function(){},osBuildNumber:function(){},osLanguages:function(){},osVersion:function(){},resorecordEvent:function(e,t){return recordEvent.apply(null,ototype.tcreenHeight","screenWidth","userAgent"].concat(["delegateApp","hardwareBrand","sldNames().forEach((function(e){Base$1.prototype[e]=function(t){return t&&t.hasOwnProperty(e)?t[e]:this.environment()[e]()}})))}Base$1._className="eventHandlers.base",Base$1.prototype.setDelegate=function(e){return Sa(this,e)},Base$1.prototype.topic=function(){throw Ea(Base$1._className,"topic")},Base$1.prototype.environment=function(){throw Ea(Base$1._className,"environment")},Base$1.prototype.eventRecorder=function(){throw Ea(Base$1._className,"eventRecorder")},Base$1.prototype.metricsData=function(){throw Ea(Base$1._className,"metricsData")n","clientEventId","connectioType","eventVersion","timezoneOBase$1.prototype.baseVersion=function(){return 1},Base$1.prototype.clientEventId=function(e){return e&&e.clientEventId||Pa(!0)},Base$1.prototype.connection=function(e){return e&&e.connection||this.environmenction(e){return e&&e.dsId||thintTime=function(e){return e&&e.e&&e.eventVersion||null},Base$1.prOffset()},Base$1.prototype.xpPrequency",this.topic())},Base$1.prototype.xpSendMethod=function(e){return e&&e.xpSendMethod||this.eventRecorder(","hardwareBrand","storeFrontCountryCode","storeFrontHeader"].forEach((function(e){Environment$1.prototype[e]=function(){}})))}Environment$1._classNameon(e){return wa(this,e)},Environment$1.prototype.connectionType=function(){throw Oa(Environment$1._className,"connectionType")},Environment$1.prototype.dsId=function(){},,Environment$1.prototype.sessionStorageObject=Aa;var Ra=Environment$1,$a=Oo.extend;function MetricsData$2(){this._eventData={}}MetricsData$2.prototyppply(null,[this._eventData].concat(Array.prototype.slice.call(arguments)))};var Ca,Da=MetricsData$2;function topic(){return Ca}var Ma="unknown",La="next",xa="previous",ja="location",Na="interval",Ua="playhead",Fa="scrub",Ba="transition",Ka="interruption",Va="buffering",Ga="play",Ha="seek",Wa="skipIntro",qa="actionType",Ya="consumerId",za="consumerNs",Qa="dsId",Ja="eventType",Xa="eventVersion",Za="isOffline",es="videoViewportHeight",ts="videoViewportWidth",rs={TYPE:{MANUAL:"manual",AUTOMATIC:"automatic",UNKNOWN:Ma},PLAY_START_REASON:{PLAY:Ga,UNPAUSE:"unpause",NEXT:La,PREVIOUS:xa,SEEK:Ha,TRANSITION:Ba,INTERRUPTION:Ka,FOREGROUND:"foreground",FOCUS:"focus",BUFFERING:Va,UNKNOWN:Ma},PLAY_START_REASON_TYPE:{SKIP_INTRO:Wa},PLAY_STOP_REASON:{COMPLETE:"complete",TRANSITION:Ba,PLAY_OTHER:"playOther",PAUSE:"pause",SEEK:Ha,NEXT:La,INTERRUPTION:Ka,BACKGROUND:"background",EXIT:"exit",INACTIVITY:"inactivity",BUFFERING:Va,ERROR:"error",FAILURE:"failure",UNKNOWN:Ma,CLOSE_PLAYER:"closePlayer"},PLAY_STOP_REASON_TYPE:{SKIP_INTRO:Wa},SEEK_START_REASON:{NEXT:La,PREVIOUS:xa,LOCATION:ja,INTERVAL:Na,PLAYHEAD:Ua,SCRUB:Fa,UNKNOWN:Ma,SKIP_INTRO:Wa},SEEK_STOP_REASON:{NEXT:La,PREVIOUS:xa,LOCATION:ja,INTERVAL:Na,PLAYHEAD:Ua,SCRUB:Fa,UNKNOWN:Ma,SKIP_INTRO:Wa}},ns={ACTIVITY_TYPE:{PLAY:Ga,SEEK:Ha},ACTION_TYPE:{START:"start",STOP:"stop"},EVENT_TYPE:{PLAY_ACTIVITY:"playActivity",SEEK_ACTIVdesStartPositions",INCLUDES_END_POSITIONS:"includesEndPositions"},os=Ra;function VPAFKitEnvironment(){os.apply(this,arguments)}VPAFKitEnvironment.prototype=new os,VPAFKitEnvironment.prototype.constructor=VPAFKitEnvironment,VPAFKitEnvironment.prototype.consumerId=function(){},VPAFKitEnvironment.prototype.consumerNs=function(){},VPAFKitEnvironment.prototype.isOffline=function(){},VPAFKitEnvironment.prototype.videoViewportHeight=function(){},VPAFKitEnvironment.prototype.videoViewpString,cs={ction(e,t){throw ss("system.eventRecorder","recordEvent")},sendMethod:function(){throw ss("system.eventRecorder","sendMethod")},flushUnreportedEvents:function(e){}},ls={};ls.environmenrder=cs,ls.logger=loggerNamed("mt-vpafkit");var ds=ka,us=Lo.processMetricsData,VPAFKitBase=function(){ds.apply(this,arguments)};(VPAFKitBase.prototype=new ds).constructor=VPAFKitBase,VPAFKitBase.prototype.environment=function(){return ls.environment},VPAFKitBase.prototype.eventRecorder=function(){return ls.eventRecorder},VPAFKitBase.prototype.knownFields=function(){var e=ds.prototype.knownFields().concat([qa,Ya,za,Qa,Za,es,ts]);return e},VPAFKitBase.prototype.consumerId=function(e){var t=Ya;return e&&t in e?e[t]:this.environment().consumerId()},VPAFKitBase.prototype.consumerNs=function(e){var t=za;return e&&t in e?e[t]:this.environment().consumerNs()},VPAFKitBase.prototype.isOffline=function(e){var t=Za;return e&&t in e?e[t]:this.environment().isOffline()},VPAFKitBase.prototype.videoViewportHeight=function(e){var t=es;return e&&t in e?e[t]:this.environment().videoViewportHeight()},VPAFKitBase.prototype.videoViewportWidth=function(e){var t=ts;retpic()}));ps.metricsData=function(){return ps.processMetricsData.apply(ps,[null].concat(Array.prototype.slice.call(arguments)))},ps.processMetricsData=function(e){var t=null;if(!Config.metricsDisabledOrBlacklistedEvent(e,topic())){var r=Array.prototype.slice.call(arguments,1);if(this!==ps){var n=ps.metricsData.apply(ps,r);r=[n].concat(r)}t=us(this,ttachDelegate,ys=Oo.extend,MediaActivity=function(e,t){this._defaultEventType=e,this._reasonConstants=t,this._defaultActionType};ys(MediaActivity,ns),Object.defineProperties(MediaActivity.prototype,{TYPE:{get:function(){return rs.TYPE}},REASON:{get:function(){return this._reasonConstants}}}),MediaActivity.prototype.setDelegate=function(e){return hs(this,e)},MediaActivity.prototype.knownFields=function(){var e=[qa,Ja,){return this._defaultEventType},Mee){var t=ps.eventVersion(e);return null!==t?t:1},MediaActivity.prototype.actionType=function(e){return this._defaultActionType};var StartMediaActivity=function(e,t){MediaActivity.apply(this,arguments),this._defaultActionType=MediaActivity.ACTION_TYPE.,startType:r,startReason:n},a=Array.prototype.slice.call(arguments,4);return ps.processMetricsData.apply(this,[i,o].concat(a))};var StopMediaActivity=function(e,t){MediaActivity.apply(this,arguments),this._defaultActionType=MediaActivity.ACTION_TstartAssetId=i.assetId);var s=Array.prototype.slice.call(arguments,5);return ps.processMetricsData.apply(this,[o,a].concat(s))};var _s=new StartMediaActivity(MediaActivity.EVENT_TYPE.PLAY_ACTIVITY,rs.PLAY_START_REASON),fs=new StopMediaActivity(MediaActivity.EVENT_TYPE.PLAY_ACTIVITY,rs.PLAY_STOP_REASON),vs=new StartMediaActivity(MediaActivity.EVENT_TYPE.SEEK_ACTIVITY,rs.SEEK_START_REASON),gs=new StopMediaActivity(MediaActivity.EVENT_TYPE.SEEK_ACTIVITY,rs.SEEK_STOP_RE:vs,seekStop:gs}),bs=Oo.extend,MediaActivity$1=function(e){this._activityType=e,this._startMetricsData=null,this._isStopped=!1};MediaActivity$1.ACTIVITY_TYPE=ns.ACTIVITY_TYPE,Object.defineProperties(MediaActivity$1.prototype_activityType}},startOverallPosition:{get:function(){return this._startMetricsData?this._startMetricsData.overallPosition:null}}}),bs(MediaActivity$1.prototype,rs),MediaActivity$1.prototype.started=function(e,t,r,n){var i=this._startEventHandler();i&&(this._startMetricsData=i.metricsData.apply(i,arguments),this.type!=MediaActivity$1.ACTIVITY_TYPE.SEEK&&cs.recordEvent(topic(),this._startMetricsData))},MediaActivity$1.prototype.stopped=function(e,t,r,n){var i=this._stopEventHandler();if(i){this._isStopped=!0;var o=[e,t,r,n,this._startMetricsData].concat(Array.prototype.slice.call(arguments,4)),a=i.metricsData.apply(i,o);cs.recordEvent(topic(),a)}},MediaActivity$1.prototype._startEventHandler=function(){var e;switch(this.type){case MediaActivity$1.ACTIVITY_TYPE.PLAY:e=_s;break;case MediaActivity$1.ACTIVITY_TYPE.SEEK:e=vs}return e},MediaActivity$1.prototype._stopEventHandler=function(){var e;switch(this.type){case MediaActivity$1.ACTIVITY_TYPE.PLAY:e=fs;break;case MediaActivity$1.ACTIVITY_TYPE.SEEK:e=gs}return e};var Ss=Oo.isInteger,TimeTracker=function(e,t){this._date=new Date,this._position=t,this._validatePlaybackRate(e),this._playbackRate=e};Object.Tracker.prototype.update=function(e,t){this._date=new Date,this._position=t,this._validatePlaybackRate(e),this._playbackRate=e},TimeTracker.prototype.estimatedTime=function(e){var t;Ss(e)?t=e:(ls.logger.error("VPAFKit error: position should be an integer"),t=Math.round(e));var r=(t-this._position)/(0meTracker.prototype._validatePlaybackRate=function(e){0==e&&ls.logger.error("VPAFKit error: playbackRate should not be zero.")};var Ps=Oo.attachDelegate,Es=Otivity=null,this._playStartPlaylistItem=null,this._seekActivity=null,this._timeTracker=null,this._shouldGenerateTransitions=!0};(MediaActivityTracker.prototype=new ws).constructor=MediaActivityTracker,Es(MediaActivityTracker.prototype,rs),Object.defineProperties(MediaActivityTracker.prototype,{shouldGenerateTransitions:{get:function(){return this._shouldGenerateTransitions},set:function(e){this._shouldGenerateTransityStarted=function(e,t,r){return this.playStartedWithPlaybaci].concat(Array.prototype.slice.call(argumethis._error("inconsistent state: did you forget yStarted.apply(this,[e,this.TYPE.AUTOMATIC,_seekActivity=new MediaActivity$1(MediaActi._seekActivity.stopped.apply(this._seekActint state: did you forget to call playStoppeds._playActivity=new MediaActivity$1(MediaActArguments.apply(this,[n].concat(Array.prototype.slice.call(arguments)));this._playActivity.stopped.apply(this._playActivity,i)},MediaActivityTracker.prototype._playlistItem=function(e,t){var r;return this._playlist&&Ts(this._playlist.getItem)&&(r=this._playlist.getItem(e,t)),r||this._error("unable to get item from playlist"),r},MediaActivityTracker.prototype._playlistItems=function(e,t){var r=[];return this._playlist&&Ts(this._playlist.getItems)?r=this._playlist.getItems(e,t):this._error("unable to get items from playlist"),r},MediaActivityTracker.prototype._relativePosition=function(e,t){var r;return(t=t||this._playlistItem(e))&&ks:null,n=e?e.eventData:null,i=[];return r&&i.push(rthis._relativePosition(t,e),o=this._combineEventData(e,Array.prototype.slice.call(arguments,4)),a=[i,t,r,n].concat(o);return a},MediaActivityTracker.prototype._generatePlaylistTransitionsIfNecessary=function(e){if(this.shouldGenerateTransitions&&this._hasUnstoppedActivity(this._playActivity)){var t,r,n,i=this._playActivity.startOverallPosition||0,o=this._playlistItems(i,e);this._playlist._returnsOrderedItems||o.sort(this._playlistItemComparator);for(var a=0;a+1<o.length;a++)if(o[a],!((t=(r=o[a+1]).startOverallPosition)<=i)){if(t>=e)break;n={eventTime:this._timeTracker?this._timeTracker.estimatedTime(t):null},this._playStopped(t,this.TYPE.AUTOMATIC,this.PLAY_STOP_REASON.TRANSITION,n),this._phis.PLAY_START_REASON.TRANSITION,n)}}},MediaActivityTracker.prototype._hasUnstoppedActivity=function(e){return e&&!e.isStopped},MediaActivityTracker.prototyperator=function(e,t){return etion?-1:1};var As=Da,MediaPlaylistItem=function(e){As.apply(this,arguments),this._startOverallPosition=e,this._startPosition=0};(MediaPlaylistItem.prototype=new As).constructor=MediaPlaylistItem,Object.defineProperties(MediaPlaylistItem.prototype,{startOverallPosition:{get:function(){return this._startOverallPosition}},startPosition:{get:function(){return tht:function(){return this._eventData}}});var HLSRollItem=function(e,t){MediaPlaylistItem.apply(this,arguments),this._duration=t};(HLSRollItem.prototype=new MediaPlaylistItem).constructor=HLSRtion:{get:function(){return this._duration}},endOn}}}),HLSRollItem.prototype.containsOverallPosition=function(e){return this.startOverallPosition<=e&&this.endOverallPosition>e};var MediaPlaylist=function(){};MediaPlaylist.prototype.RANGE_OPTIONS=is,Object.defineProperties(MediaPlaylist.prototype,{eventData:{get:function(){}}}),MediaPlaylist.prototype.getItem=function(e,t){},MediaPlaylist.prototype.getItems=function(e,t){};var Rs=Oo.attachDelegate,$s=Oo.copyKeysAndValues,Cs=Oo.extend,Ds=Oo.isInteger,HLSVideoPlaylist=function(e){MediaPlaylist.apply(this,arguments),this._startPosition=e,this._mainFeatureMetricsData=$s.apply(null,[!1,!1,!1,null].concat(Array.prototype.slice.call(arguments,1))),this._rprototype=new MediaPlaylist).constructor=HLS)},HLSVideoPlaylist.prototype.addRollInfoIt}),this)},HLSVideoPlaylist.prototype.adem=function(e,t){var r=new HLSRollItem(e,t);r.updateData.apply(r,Array.prototype.slice.call(arguments,2)),this._addRollItem(r)},HLSVideoPlaylist.prototype.updateMainFeatureMetricsData=function(){Cs.apply(null,[this._mainFeatureMetricsData].concat(Array.prototype.slice.call(arguments)))},HLSVideoPlaylist.prototype.getItem=function(e,t){var r,n=this._indexOfLastRollItemWithStartBeforePosition(e);if(Ds(n)){for(;t!=this.RANGE_OPTIONS.INCLUDES_START_POSITIONS&&this._rollItems[n].startOverallPosition==e&&n>0;)n--;(r=this._rollItems[n]).containsOverallPosition(e)||t==this.RANGE_OPTIONS.INCLUDES_END_POSITIONS&&r.endOverallPosition==e||(r=this._mainFeatureItemWithStartOverallPosition(r.endOverallPosition))}else r=this._mainFeatureItemWithStartOverallPosition(this._startPosition);return r},HLSVideoPlaylist.prototype.getItems=function(e,t){var r=[];if(this._rollItems.length){var n=this._indexOfLastRollItemWithStartBeforePosition(e);for(Ds(n)||(r.push(this._mainFeatureItemWithStartOverallPosition(this._startPosition)),n=0);n<this._rollItems.length;){var i=this._rollItems[n];if(i.startOverallPosition>t)break;if(i.endOverallPosition>=e&&r.push(i),n++,i.endOverallPosition<t)if(n<this._rollItems.length){var o=this._rollItems[n];o.startOverallPosition&&o.startOverallPosition>i.endOverallPosition&&r.push(this._mainFeatureItemWithStartOverallPosition(i.endOverallPosition))}else r.push(this._mainFeatureItemWithStartOverallPosition(i.endOverallPosition))}}elollItem=function(e){if(e){var t=this._insertionIndexForItemWithPosition(e.startOverallPosition);this._rollItems.splice(t,0,e)}},HLSVideoPlaylist.prototype._indexOfLastRollItemWithStartBeforePosition=function(e){var t,r=this._rollItems[0];return r&&Ds(e)&&r.startOveral(var t=0,r=this._rollItems.length;t<r;){var n=Math.floor((t+r)/2);th=new MediaPlaylistItem(e);return t.startPosition=this._featurePlayheadProgress(e),t.updateData(this._mainFeatureMetricsData),t},HLSVideoPlaylist.prototype._featurePlayheadProgress=function(e){e=e||0;var t,r,n=this._indexOfLastRollItemWithStartBeforePosition(e),i=this._startPosition||0;Ds(n)||(n=-1);for(var o=n;o>=0;o--)t=this._rollItems[o],0===o?i+=t.startOverallPosition:(r=this._rollItems[o-1],i+=t.startOverallPosition-r.endOverallPosition);return i};var Ms=Object.freeze({__proto__:null,createTracker:function(e){vtion(e){var t=new HLSVideoPlaylist(e);return t.updateMainFeatureMetricsData.apply(t,Array.prototype.slice.call(arguments,1)),t}});var Ls=Object.freeze({__proto__:null,applyFieldsMap:function(e,t){var r=Config.value("fieldsMap",topic());return Lo.applyFieldsMap(e,t,r)}}),xs=Object.freeze({__proto__:null,eventFields:Ls}),js=Oo.setDelegates,Ns=Oo.attachMethods,Us=Oo.copyDelegatedFunctions,Fs=Ro.metricsDisabledOrBlacklistedEvent,Bs=Ro.removeBConfig(),this._initCalled=!1}PlayActivity.prototype._utReset=function(){this.config=Config.defaultConfig(),this._yActivity.prototype.init=function(e,t,r,n,i){if(!this._initCalled){this._initCalled=!0,r&&(js(ms,r),js(ls,r)),function(e){Ca=e}(e);var o=Config.getConfig(e),a={metricsDisabledOrBlacklistedEvent:Fs,removeBlacklistedFields:Bs};Ns(o,a,o),Ns(Config,a,Config),Us(this.config,o),o.setDebugSource(this.config.debugSource()),o.init(t,n,i),this.config=o}},PlayActivity.prototype.system=ls,PlayActivity.prototype.eventHandlers=ms,PlayActivity.prototype.mediaActivityTracker=Ms,PlayActivity.prototype.utils=xs;var Ks=new PlayActivity;const Vs={"ac-3":"AC3","mp4a.a5":"AC3",alac:"Apple Lossless","ec-3":"EC3","mp4a.a6":"EC3",flac:"Free Los","mp4a.40.29":"AAC","mp4a.40.34":"MP3","mp4a.40.42":"AAC"},Gs=/^[0-9]+\/JOC$/,isAtmos=(e,t)=>"EC3"===Vs[e]&&(edvh1.05.01","dvhe.05.06"],Ws={PQ:"HDR",HLG:"HDR",SDH:"SDH"};var qs;const convertToVideoColorRange=(e,t)=>(e=>-1!==Hs.indexOf(e))(e)?"DolbyVision":(e=>null!==(qs=Ws[e])&&void 0!==qs?qs:e)(t);function _define_properconfigurable:!0,writable:!0}):e[t]=r,e}var Ys,zs,Qs;!function(e){e.MANUAL="MANUAL",e.AUTOMATIC="AUTOMATIC",e.UNKNOWFFER_START",e.bufferStop="BUFFER_STOP",e.exit="EXIT",e.play="PLAY",e.pause="PAUSE",e.stop="STOP",e.next="NEXT",e.newItem="NEW"}(Qs||(Qs={}));const Js={initial:"idle",states:{idle:{on:{PLAY:{target:"playing",context:{reason:"PLAY",manual:"MANUAL",fromInitialPlay:!0}}}},playing:{on:{BUFFER_START:{target:"buffering",context:{reason:"BUFFERING",manual:"AUTOMATIC",fromInitialPlay:"~~previous~~"}},EXIT:{target:"idle",context:{reason:"EXIT"}},PAUSE:{target:"paused",context:{reason:"PAUSE"}},STOP:{target:"idle",context:{}},NEXT:{target:"idle",context:{reason:"NEXT"}},NEW:{target:"idle",context:{}}}},paused:{on:{PLAY:{target:"playing",context:{reason:"UNPAUSE"}},NEW:{target:"idle",context:{}},EXIT:{target:"idle",context:{reason:"EXIT"}}}},buffering:{on:{BUFFER_STOP:{target:"playing",context:{reason:"BUFFERING",manual:"AUTOMATIC"}},EXKNOWN",reason:"UNKNOWN",fromInitialPlay:!1};class VPAFStateMachine{isAllowedTransition(e){return void 0!==this.getNextState(e)}transition(e,t={}){const r=this.getNextState(e);if(!r)return;Gn.debug(`[mk/activity/vpaf] Transitioning from ${this.currentState} to ${r.target} because ${e}`);const n={};return hasOwn(t,"manual")&&(void 0!==t.manual?n.manual=t.manual?"MANUAL":"AUTOMATIC":n.manual="UNKNOWN"),void 0!==t.reason&&(n.reason=t.reason),this.currentContext=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$5(e,t,r[Context(r.context)),this.currentState=r.target,this.currentContext}reset(){this.currentState=Js.initial,this.currentContext=Xs}getNextState(e){return Js.states[this.currentState].on[e]}preservePreviousContext(e){const t={};return["manual","reason","reasonType","fromInitialPlay"].forEach(r=>{"~~previous~~"===e[r]&&(t[r]=this.currentContext[r])}),t}constructor(){_define_property$5(this,"currentState",Js.initial),_define_property$5(this,"currentContext",Xs)}}function asyncGeneratorStep$2(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator$2(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep$2(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep$2(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property$4(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$3(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$4(e,t,r[t])}))}return e}function _object_spread_props$1(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _ts_decorate(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function _ts_metadata(e,t){if("obunction(e){e.SEEK_STARTED="seekStarted",e.SEEK_STOPPED="seekStopped",e.PLAY_STARTED="playStarted",e.PLAY_STOPPED="playStopped"}(ec||(ec={}));const tc={[tt.playbackPause]:Qs.pause,[tt.playbackPlay]:Qs.play,[tt.playbackStop]:Qs.stop,[tt.playerExit]:Qs.exit},rc={[at.EXITED_APPLICATION]:"EXIT",[at.FAILED_TO_LOAD]:"FAILURE",[at.MANUALLY_SELECTED_PLAYBACK_OF_A_DIFF_ITEM]:"PLAY_OTHER",[at.NATURAL_END_OF_TRACK]:"COMPLETE",[at.PLAYBACK_PAUSED_DUE_TO_INACTIVITY]:"INACTIVITY",[at.SCRUB_BEGIN]:"SEEK",[at.TRACK_SKIPPED_BACKWARDS]:"SEEK",[at.TRACK_SKIPPED_FORWARDS]:"SEEK",[yi.NEXT_ITEM]:"NEXTInPicture",[e.PresentationMode.inline]:"foreground",_default:"foreground"};function asMilliseconds(e){return Math.round(1e3*e)}function ensurePositionData(e,t){var r;if(null===(r=t)||void 0===r?void 0:r.isLinearStream){if(void 0===e.playingDate)throw new Error('VPAFTracker: The property `playingDate` is required on data for "linear" content');return e}if(void 0===required on data "vod" content');return e}class VPAFTracker{get requestedEvents(){return Array.from(this.dispatchTable.keys())}get isConfigured(){return void 0!==this.instance}get currentItem(){return this._currentItem}set currentItem(e){this._currentItem=e,this.currentSkipItems=e?parseSkipItems(e):void 0}configure(e){var t=this;return _async_to_generator$2((function*(){var r;if(t.instance=e.instance,t.services=e.services,t.dispatcher=e.services.dispatcher,!zn.storekit.cid)try{yield zn.storekit.infoRefresh()}catch(i){}const n=null===(r=e.services.apiManager)||void 0===r?void 0:r.utsClient;return new Promise((e,r)=>{const i=function(){if(Array.isArray(navigator.languages))return navigator.languages;if("string"==typeof navigator.language)return[navigator.language];if("string"==typeof globalThis.navigator.userLanguage)return[globalThis.navigator.userLanguage];return[]}(),onSuccess=()=>(Ks.system.ennt.setDelegale.tv",appVersion:()=>"1.0",consuekit.cid,consumerNs:()=>"TV",isOffline:()=>!1,delegateApp:()=>"web-tv-player",osLanguages:()=>i,resourceRevNum:()=>qn.app.build,storeFrontCountryCode(){var e,t,r,i;return null!==(i=null===(r=n)||void 0===r||null===(t=r.configuration)||void 0===t||null===(e=t.userProps)||void 0===e?void 0:e.country)&&void 0!==i?i:""}}),t.setupListeners(),t.vpafKitInited=!0.vpafKitInited)return onSuccess();const o={environment:ga,eventRecorder:ma};Ks.init("xp_amp_tv_vpaf",null,o,onSuccess,e=>{r(e)})})}))()}cleanup(){var e=this;return _async_to_generator$2((function*(){e.tracker=void 0,e.isScrubbing=!1,e.scrubStopPosition=void 0,e.teardownListeners(),e.stopSynchronizing()}))()}shouldTrackPlayActivity(e,t){if(!t)returhis.shouldTrackPlayActivity(e,r))return;const n=this.dispatchTable.get(e);void 0!==n&&"function"==typeof this[n]&&this[n](r,t)}bufferStart(e,t){var r=this;return _async_to_generator$2((function*(){var n;if(Zs.debug("VPAFTracker: handling bufferStart()"),!(yield r.canTrackItem(e)))return void Zs.debug("VPAFTracker: aborting bufferStart, no tracker");if(r.state.currentState!==zs.playing)return void Zs.debug("VPAFTracker: aborting bufferStart, not playing");if("seek"===(null===(n=r.lastTrackedEvent)||void 0===n?void 0:n.reason))return void Zs.debug("VPAFTracker: aborting bufferStart, after a seek");const i=r.state.currentContext.fromInitialPlay,o=r.calculatePlaybackPosition(e,ensurePositionData(t,e));r.state.transition(Qs.bufferStart),i?Zs.debug("VPAFTracker: bufferStart() not tracking PLAY_STOPPED, it is from initial play"):r.trackEvent("playStopped",o)}))()}bufferEnd(e,t){var r=this;return _async_to_generator$2((function*(){var n;if(Zs.debug("VPAFTracker: handling bufferEnd()"),!(yield r.canTrackItem(e)))return;if(r.state.currentState!==zs.buffering)return void Zs.debug("VPAFTracker: aborting bufferEnd, not buffering");if("seek"===(null===(n=r.lastTrackedEvent)||void 0===n?void 0:n.reason))return void Zs.debug("VPAFTracker: aborting bufferEnd, after a seek");const i=r.state.currentContext.fromInitialPlay,o=r.calculatePlaybackPosition(e,ensurePositionData(t,e));r.state.transition(Qs.bufferStop),i?Zs.debug("VPAFTracker: bufferEnd() not tracking PLAY_STARTED, it is from initial play"):r.trackEvent("playStarted",o)}))()}exit(e,t={}){var r=this;return _async_to_generator$2((function*(){(yield r.canTrackItem(r.currentItem))&&(Zs.debug("VPAFTracker.exit()"),r.state.transition(Qs.exit),r.trackEvent("playStopped",r.calculatePlaybackPosition(void 0,ensurePositionData(t,t.item))),r.stopSynchronizing(),r.currentItem=void 0)}))()}pause(e,t={}){var r=this;return _async_to_generator$2((function*(){if(!(yield r.canTrackItem(e)))return;Zs.debug("VPAFTracker.pause()");const n=r.calculatePlaybackPosition(e,ensurePositionData(t,e)),i=t.endReasonType===yi.NEXT_ITEM?Qs.next:Qs.pause;r.state.transition(i,r.getExplicitStateContext(t)),r.trackEvent("playStopped",n)}))()}play(e,t={}){var r=this;return _async_to_generator$2((function*(){if(!(yield r.canTrackItem(e)))return;Zs.debug("VPAFTracker.play()");const n=r.calculatePlaybackPosition(e,_object_spread$3({position:0},t));r.state.transition(Qs.play,r.getExplicitStateContext(t)),r.trackEvent("playStarted",n)}))()}scrub(e,t={}){var r=this;return _async_to_generator$2((function*(){if(void 0===e||void 0===t.position)return;const n=r.calculatePlaybackPosition(e,ensurePositionData(t,e));r.isScrubbing&&void 0===t.endReasonType?r.scrubStopPosition=n:r.isScrubbing&&r.scrubEnd(e,n)}))()}seek(e,t={}){var r=this;return _async_to_generator$2((function*(){void 0!==e&&(!e.isLinearStream||void 0!==t.playingDate&&void 0!==t.startPlayingDate)&&(e.isLinearStream||void 0!==t.position&&void 0!==t.startPosition)&&(r.isSkippingIntro(t)||r.isSeekingInterval(t)?yield r.trackSeek(e,t):yield r.trackScrub(e,t))}))()}skip(e,t={}){return _async_to_generator$2((function*(){}))()}stop(e,t={}){var r=this;return _async_to_generator$2((function*(){if(!(yield r.canTrackItem(e)))return;Zs.debug("VPAFTracker.stop()");const n=r.calculatePlaybackPosition(e,ensurePositionData(t,e));r.state.transition(Qs.stop,r.getExplicitStateContext(t)),r.trackEvent("playStopped",n),r.stopSynchronizing(),r.currentItem=void 0}))()}lyricsPlay(e,t){return _async_to_generator$2((function*(){}))()}lyricsStop(){return _async_to_generator$2((function*(){}))()}trackSeek(e,t){var r=this;return _async_to_generator$2((function*(){const n={},i=r.getSkipActionName(t.position);r.isSkippingIntro(t)&&"string"==typeof i&&(n.actionName=i);const o=_object_spread_props$1(_object_spread$3({},t),{position:t.startPosition,playingDate:t.startPlayingDate});yield r.trackSeekStart(e,o,n),yield r.trackSeekStop(e,t,n)}))()}trackSeekStart(t,r,n={}){var i=this;return _async_to_generator$2((function*(){const o=r.seekReasonType===e.SeekReasonType.SkipIntro?i.tracker.SEEK_START_REASON.SKIP_INTRO:i.tracker.SEEK_START_REASON.INTERVAL,a=i.calculatePlaybackPosition(t,ensurePositionData(r,t)),s=i.tracker.TYPE.MANUAL;if(i.state.currentState===zs.playing){const e=i.isSkippingIntro(r)?_object_spread_props$1(_object_spread$3({},n),{stopReasonType:i.tracker.PLAY_STOP_REASON_TYPE.SKIP_INTRO}):n;i.trackEvent("playStopped",a,s,i.tracker.PLAY_STOP_REASON.SEEK,e)}i.trackEvent("seekStarted",a,s,o,n)}))()}trackSeekStop(e,t,r={}){var n=this;return _async_to_generator$2((function*(){const i=n.isSeekingInterval(t)?n.tracker.SEEK_STOP_REASON.INTERVAL:n.tracker.SEEK_STOP_REASON.SKIP_INTRO,o=n.calculatePlaybackPosition(e,ensurePositionData(t,e)),a=n.tracker.TYPE.AUTOMATIC;if(n.trackEvent("seekStopped",o,a,i,r),n.state.currentState===zs.playing){const e=n.isSkippingIntro(t)?_object_spread_props$1(_object_spread$3({},r),{startReasonType:n.tracker.PLAY_START_REASON_TYPE.SKIP_INTRO}):r;n.trackEvent("playStarted",o,a,n.tracker.PLAY_START_REASON.SEEK,e)}}))()}trackScrub(e,t){var r=this;return _async_to_generator$2((function*(){const n=e.isLinearStream?t.playingDate.getTime():asMilliseconds(t.position),i=e.isLinearStream?t.startPlayingDate.getTime():asMilliseconds(t.startPosition);yield r.scrubStart(e,i),yield r.scrubEnd(e,n)}))()}scrubStart(e,t){var r=this;return _async_to_generator$2((function*(){(yield r.canTrackItem(e))&&(r.isScrubbing=!0,r.scrubStopPosition=t,r.state.currentState===zs.playing&&r.trackEvent("playStopped",r.scrubStopPosition,r.tracker.TYPE.AUTOMATIC,r.tracker.PLAY_STOP_REASON.SEEK),r.trackEvent("seekStarted",t,r.tracker.TYPE.MANUAL,r.tracker.SEEK_START_REASON.SCRUB))}))()}scrubEnd(e,t){var r=this;return _async_to_generator$2((function*(){r.trackEvent("seekStopped",t,r.tracker.TYPE.MANUAL,r.tracker.SEEK_STOP_REASON.SCRUB),r.state.currentState===zs.playing&&r.trackEvent("playStarted",t,r.tracker.TYPE.AUTOMATIC,r.tracker.PLAY_START_REASON.SEEK),r.isScrubbing=!1,r.scrubStopPosition=void 0}))()}trackEvent(e,t,r,n,i){void 0===r&&(r=this.tracker.TYPE[this.state.currentContext.manual]),void 0===n&&(n="playStarted"===e?this.tracker.PLAY_START_REASON[this.state.currentContext.reason]:this.tracker.PLAY_STOP_REASON[this.state.currentContext.reason]),Zs.debug(`VPAFTracker.trackEvent(${e}, ${t}, ${r}, ${n})`,i),this.tracker[e].call(this.tracker,Math.round(t),r,n,i),this.lastTrackedEvent={eventType:e,position:t,type:r,reason:n,namedArgs:i}}calculatePlaybackPosition(e,t){var r,n;if(null===(r=e)||void 0===r?void 0:r.isLinearStream){if(void 0===t.playingDate)throw new Error("VPAF: Can't report playback position for linear stream without playingDate value");return t.playingDate.getTime()}return asMilliseconds(null!==(n=t.position)&&void 0!==n?n:0)}createTracker(e){var t=this;return _async_to_generator$2((function*(){var r;const n=e.defaultPlayable,i=function(e){var t,r;const n={url:e.attributes.url,assetId:null===(r=e)||void 0===r||null===(t=r.hlsMetadata)||void 0===t?void 0:t["feature.adam-id"]};e.isLinearStream||(n.assetPlacement="feature");!0===e.attributes.isAdultContent&&(n.sensitiveContentType="adult");return n}(e),o=parseRollItems(e).map(e=>{const t={start:e.start,duration:e.duration,metricsData:{assetPlacement:e.type.replace("-",""),assetId:e["adam-id"],isSkippable:e.skippable}};return void 0!==e["dynamic-id"]&&(t.metricsData["data.dynamicSlot.dataSetId"]=e["dynamic-id"]),t});Zs.debug("VPAF: Creating HLS Playlist",i);const a=Ks.mediaActivityTracker.createHLSVideoPlaylist(0,i);Zs.debug("VPAF: adding roll items",o),a.addRollInfoItems(o);const s=_object_spread_props$1(_object_spread$3({},n.vpafMetrics,function(e,t,r){var n,i,o,a;const s=null===(i=e)||void 0===i||null===(n=i.videoContainerElement)||void 0===n?void 0:n.querySelector("video"),c={programmingType:t.isLinearStream?"live":"videoOnDemand",downloadState:"streaming",playbackFocus:"foreground",videoViewportHeight:null===(o=s)||void 0===o?void 0:o.clientHeight,videoViewportWidth:null===(a=s)||void 0===a?void 0:a.clientWidth,delegatedPlayback:determineDelegatedPlayback(e)},l=currentAudioData(e,r),d=function(e,t){var r;const{language:n,kind:i}=null!==(r=e.currentTextTrack)&&void 0!==r?r:{};if("captions"===i)return{subtitleLocale:void 0,closedCaptionLocale:n};if("subtitles"===i)return{subtitleLocale:n,closedCaptionLocale:void 0};return{subtitleLocale:void 0,closedCaptionLocale:void 0}}(e);return _object_spread$3({},c,l,d)}(t.instance,e,n)),{overallLength:calculateOverallLength(e,n,o),featureAssetId:i.assetId});return Zs.debug("VPAFTracker.createTracker: creating new tracker for "+(null===(r=e)||void 0===r?void 0:r.id)),t.tracker=Ks.mediaActivityTracker.createTracker(a,Ks.utils.eventFields.applyFieldsMap(n,"utsVpafPlayable"),Ks.utils.eventFields.applyFieldsMap(e.attributes,"utsVpafContent"),s),t.startSynconType)return rc[e.endReasonType]}getExplicitStateContext(e){return{manual:e.userInitiated,reason:this.getMappedStopReason(e)}}onPlaybackStateChange(t,r){var n=this;return _async_to_generator$2((function*(){const{state:t}=r,i=n.currentItem;var o;const a={position:n.instance.currentPlaybackTime,playingDate:n.instance.currentPlayingDate,userInitiated:null!==(o=r.userInitiated)&&void 0!==o&&o},s="PlaybackStates."+e.PlaybackStates[r.oldState],c="PlaybackStates."+e.PlaybackStates[r.state];Zs.debug(`onPlaybackStateChange: ${s} -> ${c}`,a),t===e.PlaybackStates.waiting?(n.isBuffering=!0,Zs.debug("VPAFTracker.onPlaybackStateChange: triggering bufferStart()",a),yield n.bufferStart(i,a)):t===e.PlaybackStates.playing?n.isBuffering&&(n.isBuffering=!1,Zs.debug("VPAFTracker.onPlaybackStateChange: triggering bufferEnd()",a),yield n.bufferEnd(i,a)):t!==e.PlaybackStates.stalled&&(Zs.debug("VPAFTracker.onPlaybackStateChange: resetting isBuffering=false"),n.isBuffering=!1)}))()}handleLevelUpdated(e,t){var r;const{level:n,channels:i}=t;if(!n)return;const{audioCodec:o,videoRange:a,videoCodec:s}=n;if(!(o&&i||a&&s))return;const c={};o&&i&&(c.audioFormat=((e,t)=>{var r,n;const i=null!==(n=null===(r=e)||void 0===r?void 0:r.toLowerCase())&&void 0!==n?n:"";var o;return isAtmos(i,t)?"Atmos":null!==(o=Vs[i])&&void 0!==o?o:e})(o,i)),a&&s&&(c.videoColorRange=convertToVideoColorRange(s,a)),null===(r=this.tracker)||void 0===r||r.updateData(c)}handleAudioTrackChange(){if(void 0===this.tracker||void 0===this.instance)return;const e=currentAudioData(this.instance);e&&(Zs.debug("Updating AudioData",e),this.tracker.updateData(e))}handleForcedTextTrackChange(e,t){var r,n;null===(n=this.tracker)||void 0===n||n.updateData({forcedSubtitleLocale:null===(r=t)||void 0===r?void 0:r.language})}handlePresentationModeChange(e,{mode:t}){var r,n;const i=null!==(n=nc[t])&&void 0!==n?n:nc._default;null===(r=this.tracker)||void 0===r||r.updateData({playbackFocus:i})}handleTargetWirelessChange(){var e;void 0!==this.instance&&(null===(e=this.tracker)||void 0===e||e.updateData({delegatedPlayback:determineDelegatedPlayback(this.instance)}))}handleTextTrackChange(){var e,t;const{tracker:r}=this;if(void 0===r)return;const n=null===(e=this.instance)||void 0===e?void 0:e.currentTextTrack;if(!n||"captions"!==n.kind&&"subtitles"!==(null===(t=n)||void 0===t?void 0:t.kind))return;const i=""===n.language?void 0:n.language,o={closedCaptionLocale:"captions"===n.kind?i:void 0,subtitleLocale:"subtitles"===n.kind?i:void 0};r.updateData(o)}handleNowPlayingItemDidChange(e,t){const{item:r}=t;r||(Zs.debug("handleNowPlayingItemDidChange: calling exit and clearing currentItem"),this.state.transition(Qs.{return t.seekReasonType===e.SeekReasonType.SkipIntro}isSeekingInterval(t){return t.seekReasonType===e.SeekReasonType.Interval}canTrackItem(e){var t=this;return _async_to_generator$2((function*(){var r;return void 0!==e&&void 0!==e.defaultPlayable&&((null===(r=t.currentItem)||void 0===r?void 0:r.id)!==e.id&&(t.state.transition(Qs.newItem),t.currentItem=e,yield t.createTracker(e)),er)}))()}getSkipActionName(e){var t,r;return null===(t=(null!==(r=this.currentSkipItems)&&void 0!==r?r:[]).find(t=>t.target===e))||void 0===t?void 0:t.label}onVideoComponentScrubStart(e){return this.scrubStart(this.currentItem,asMilliseconds(e.detail.currentSeconds))}setupListeners(){var e,t;void 0!==this.dispatcher&&(this.dispatcher.subscribe(Vn.audioTrackChanged,this.handleAudioTrackChange),this.dispatcher.subscribe(Vn.textTrackChanged,this.handleTextTrackChange),this.dispatcher.subscribe(Vn.forcedTextTrackChanged,this.handleForcedTextTrackChange),this.dispatcher.subscribe(Vn.nowPlayingItemDidChange,this.handleNowPlayingItemDidChange),this.dispatcher.subscribe(Vn.playbackStateDidChange,this.onPlaybackStateChange),this.dispatcher.subscribe(tt.hlsLevelUpdated,this.handleLevelUpdated),this.dispatcher.subscribe(Vn.playbackTargetIsWirelessDidChange,this.handleTargetWirelessChange),this.dispatcher.subscribe(Vn.presentationModeDidChange,this.handlePresentationModeChange)),(null===(t=this.services)||void 0===t||null===(e=t.runtime)||void 0===e?void 0:e.isBrowserEnvironment)&&window.addEventListener("triggerSeekStart",this.onVideoComponentScrubStart)}teardownListeners(){var e,t;void 0!==this.dispatcher&&(this.dispatcher.unsubscribe(Vn.audioTrackChanged,this.handleAudioTrackChange),this.dispatcher.unsubscribe(Vn.textTrackChanged,this.handleTextTrackChange),this.dispatcher.unsubscribe(Vn.forcedTextTrackChanged,this.handleForcedTextTrackChange),this.dispatcher.unsubscribe(Vn.nowPlayingItemDidChange,this.handleNowPlayingItemDidChange),this.dispatcher.unsubscribe(Vn.playbackStateDidChange,this.onPlaybackStateChange),this.dispatcher.unsubscribe(tt.hlsLevelUpdated,this.handleLevelUpdated),this.dispatcher.unsubscribe(Vn.playbackTargetIsWirelessDidChange,this.handleTargetWirelessChange),this.dispatcher.unsubscribe(Vn.presentationModeDidChange,this.handlePresentationModeChange)),(null===(t=this.services)||void 0===t||null===(e=t.runtstopSynchronizing(){void 0!==this.synchronizeTimeout&&(clearInterval(this.synchronizeTimeout),this.synchronizeTimeout=void 0)}synchronize(){if(void 0===this.tracker||void 0===this.instance||void 0===this.currentItem)return void this.stopSynchronizing();const e=this.state.currentState===zs.paused,{playbackRate:t,currentPlaybackTime:r}=this.instance,n=e?0:t,i=Math.round(1e3*r);Zs.debug(`VPAF: synchronize rate: ${n} and current time: ${i}`),this.tracker.synchronize(n,i)}constructor(){_define_property$4(this,"_currentItem",void 0),_define_property$4(this,"currentSkipItems",void 0),_define_property$4(this,"dispatcher",void 0),_define_property$4(this,"instance",void 0),_define_property$4(this,"services",void 0),_define_property$4(this,"isScrubbing",!1),_define_property$4(this,"isBuffering",!1),_define_property$4(this,"scrubStopPosition",void 0),_define_property$4(this,"tracker",void 0),_define_property$4(this,"vpafKitInited",!1),_define_property$4(this,"synchronizeTimeout",void 0),_define_property$4(this,"state",void 0),_define_property$4(this,"lastTrackedEvent",void 0),_define_property$4(this,"dispatchTable",new Map([[tt.playbackPlay,"play"],[tt.playbackPause,"pause"],[tt.playbackScrub,"scrub"],[tt.playbackSeek,"seek"],[tt.playbackSkip,"skip"],[tt.playbackStop,"stop"],[tt.playerExit,"exit"]])),this.state=new VPAFStateMachine,Ks.config.setDelegate({configHostname:()=>"daf.xp.apple.com"})}}function calculateOverallLength(e,t,r){if("EbsEvent"===t.type)return;var n;let i=parseFloat(null!==(n=e.hlsMetadata["feature.duration"])&&void 0!==n?n:t.duration);for(const o of r)i+=o.duration;return asMilliseconds(i)}function currentAudioData(e,t){var r,n;const{currentAudioTrack:i,nowPlayingItem:o}=e;let a,s;var c,l,d,u,p;"description"===(null===(r=i)||void 0===r?void 0:r.kind)?(s=null===(c=i)||void 0===c?void 0:c.language,a=void 0):(a=null!==(p=null===(l=i)||void 0===l?void 0:l.language)&&void 0!==p?p:null===(u=t)||void 0===u||null===(d=u.primaryLocale)||void 0===d?void 0:d.locale,s=void 0)rStream)&&i){const e=null===(y=i.characteristics)||void 0===y?void 0:y.find(e=>e.startsWith("com.apple.amp.appletv.identifier"));isHomeRadioescriptionLocale:s,audioVariantId:h}}function determineDelegatedPlayback(e){return e.playbackTargetIsWireless?"Airplay":"None"}function _define_property$3(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[String,Object])],VPAFTracker.prototype,"onPlaybackStateChange",null),_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[Object,Object])],VPAFTracker.prototype,"handleLevelUpdated",null),_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[])],VPAFTracker.prototype,"handleAudioTrackChange",null),_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[Object,Object])],VPAFTracker.prototype,"handleForcedTextTrackChange",null),_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[Object,void 0])],VPAFTracker.prototype,"handlePresentationModeChange",null),_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[])],VPAFTracker.prototype,"handleTargetWirelessChange",null),_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[])],VPAFTracker.prototype,"handleTextTrackChange",null),_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",[String,Object])],VPAFTracker.prototype,"handleNowPlayingItemDidChange",null),_ts_decorate([Bind(),_ts_metadata("design:type",Function),_ts_metadata("design:paramtypes",["undefined"==typeof CustomEvent?Object:CustomEvent])],VPAFTracker.prototype,"onVideoComponentScrubStart",null),_ts_decorate([Bind(),_ts_metadata("design:types",[])],VPAFTracker.prototype,"synchronize",null);const augmentUrlQueryParameters=e=>addQueryParamsToURL(e,{webbrowser:!0}),addPreviewFromPlayable=(e,t)=>{var r,n,i,o;const a=null!==(o=null!==(i=null===(r=t.assets)||void 0===r?void 0:r.hlsUrl)&&void 0!==i?i:t.hlsUrl)&&void 0!==o?o:null===(n=t.clipAssets)||void 0===n?void 0:n[0].url;e.previews=a?[{url:augmentUrlQueryParameters(a)}]:[]},addKeysFromPlayable=(e,t)=>{const{assets:r}=t;r&&(r.fpsKeyServerUrl&&(e.keyServerQueryParameters=r.fpsKeyServerQueryParameters,e.keyURLs={"hls-key-cert-url":r.fpsCertificateUrl,"hls-key-server-url":r.fpsKeyServerUrl,"widevine-cert-url":r.wideVineCertificateUrl}),e.assetURL=augmentUrlQueryParameters(r.hlsUrl))},addPlayableToItem=(e,t,r)=>{var n,i,o,a,s,c;e.type=null!==(i=null!==(n=e.type)&&void 0!==n?n:t.type)&&void 0!==i?i:r,e.contentType=null!==(o=e.contentType)&&void 0!==o?o:t.contentType,e.attributes=null!==(a=e.attributes)&&void 0!==a?a:{},e.attributes.title=null!==(c=null!==(s=e.attributes.title)&&void 0!==s?s:e.title)&&void 0!==c?c:t.title,delete e.title,addPreviewFromPlayable(e.attributes,t),addKeysFromPlayable(e,t),e.id||(e.id=generateUUID()),e.playables=[t]},createMediaItem=e=>{var t;const r=JSON.stringify(e),n=JSON.parse(r),i=null===(t=n.playables)||void 0===t?void 0:t[0];var o;n.attributes=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$3(e,t,r[t])}))}return e}({},null!==(o=n.attributes)&&void 0!==o?o:{},n),addPlayableToItem(n,i);return new MediaItem(n)},ic=["contributors","modalities","movie","musicVideo","musicMovie","trailer","tvEpisode","uploadedVideo","uploaded-videos","music-videos","music-movies","tv-episodes","workouts"];function asyncGeneratorStep$1(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _define_property$2(e,t,r){retur0),_define_property$2(this,"rtcTracker",void 0),_define_property$2(this,"requestedEvents",[Vn.playInitiated,Vn.mediaCanPlay])}}function _define_property$1(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread$1(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property$1(e,t,r[t])}))}return e}function _object_spread_props(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,ObdevFlags=Object.entries(A).reduce((function(e,[t,r]){return _object_spread_props(_object_spread$1({},e),{[t]:r.value})}),{}),u}},A);function asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(Ae){return void r(Ae)}s.done?t(c):Promise.resolve(c).then(n,i)}function _async_to_generator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,n,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _define_property(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _object_spread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property(e,t,r[t])}))}return e}const sc={mediaApi:{configureFn:So,apiType:e.SupportedAPIs.MEDIA_API,allowDefault:!1},utsClient:{configureFn:function(e){return _configure$1.apply(this,arguments)},apiType:e.SupportedAPIs.UTS_CLI:o,allowDefault:a}=sc[e];var s;const c=((e,...t)=>{const r={};return Object.keys(e).forEach(n=>{t.includes(n)||(r[n]=e[n])}),r})(null!==(s=t.apiOptions)&&void 0!==s?s:{},"mediaApi","utsClient"),l={apiType:o,configureFn:i,options:{}};if(null===(n=t.apiOptions)||void 0===n||null===(r=n[e])||void 0===r?void 0:r.api)l.options.api=t.apiOptions[e].api;else{var d,u,p,h;const r=a?c:{};var y,_,f;l.options.apiOptions=null!==(f=null!==(_=null!==(y=null===(u=t.apiOptions)||void 0===u||null===(d=u[e])||void 0===d?void 0:d.configureOptions)&&void 0!==y?y:null===(h=t.apiOptions)||void 0===h||null===(p=h[e])||void 0===p?void 0:p.apiOptions)&&void 0!==_?_:r)&&void 0!==f?f:{}}return l};class MediaKitInstance extends MKInstance{playUtsItem(e,t,r){var n=this;return _async_to_generator((function*(){e=JSON.parse(JSON.stringify(e)),t?t=JSON.parse(JSON.stringify(t)):"EditorialVideoClip"===(t=JSON.parse(JSON.stringify(e))).type&&(t.type="Vod");const{id:i,type:o}=e,a={id:i,type:o,attributes:_object_spread({},e),playables:[t]};"Show"===o?(a.attributes.showId=e.id,a.attributes.showTitle=a.attributes.title,a.attributes.title=t.title):"Season"===o&&(a.attributes.title=t.title),addPreviewFromPlayable(a.attributes,t),addKeysFromPlayable(a,t);const s=new MediaItem(a);return n.playMediaItem(s,r)}))()}}function _configure(){return(_configure=_async_to_generator((function*(t){ti.linkChild(Gn),ti.linkChild(xe),ti.linkChild(q),t.playActivityAPI=[new VPAFTracker,new BookmarkTracker],t.realm=e.SKRealm.TV,t.rtcOptions&&(t.playActivityAPI=[...t.playActivityAPI,new RTCStreamingTracker(t.rtcOptions),new ClickToPlayTracker]);return yield configure$3(t,MediaKitInstance,function(){var e=_async_to_generator((function*(e){var r,n;const i=[];(null===(r=t.apiOptions)||void 0===r?void 0:r.utsClient)&&i.push(createAPIConfiguration("utsClient",t)),(null===(n=t.apiOptions)||void 0===n?void 0:n.mediaApi)&&i.push(createAPIConfiguration("mediaApi",t)),yield e.configure(i)}));return function(t){return e.apply(this,arguments)}}())}))).apply(this,arguments)}e.Events=Vn,e.MKError=MKError,e.MediaKitInstance=MediaKitInstance,e.PlayActivityEndReasonType=yi,e.VideoTypes={movie:!0,musicVideo:!0,musicMovie:!0,trailer:!0,tvEpisode:!0,uploadedVideo:!0,"uploaded-videos":!0,"music-videos":!0,"music-movies":!0,"tv-episodes":!0,Bonus:!0,Extra:!0,Episode:!0,Movie:!0,Preview:!0,Promotional:!0,Season:!0,Show:!0,Vod:!0,EditorialVideoClip:!0,RealityVideo:!0,SportingEvent:!0,LiveService:!0},e.__dev=ac,e.__log=ri,e.configure=function(e){return _configure.apply(this,arguments)},e.createMediaItem=createMediaItem,e.createMediaItemFromPlayable=(e,t="Show")=>{if(Array.isArray(e.playables))return createMediaItem(e);cofy(e),n=JSON.parse(r),i={id:n.id};addPlayableToItem(i,ath.floor(e%3600%60);const i=[];return r?(i.push(""+r),i.push(0"+e:""+e),i.join(t)},e.formattedMediaURL=formattedMediaURL,e.formattedMilliseconds=function(e){return formattedSeconds(e/1e3)},e.formattedSeconds=formattedSeconds,e.generateEmbedCode=function(e,t={height:"450",width:"660"}){if(!b.test(e))throw new Error("Invalid content url");var r;let n=null!==(r=t.height)&&void 0!==r?r:"450";var i;let o=null!==(i=t.width)&&void 0!==i?i:"660";const{kind:a,isUTS:s}=formattedMediaURL(e),c="post"===a||"musicVideo"===a||s;"song"===a||"episode"===a?n="175":c&&(n=""+Math.round(.5625*parseInt(o,10))),n=(""+n).replace(/(\d+)px/i,"$1"),o=(""+o).replace(/^(\d+)(?!px)%?$/i,"$1px");const l=(c?"width:"+o:"width:100%;"+(o?"max-width:"+o:""))+";overflow:hidden;border-radius:10px;";let d="https://embed.music.apple.com";return["podcast","episode"].includes(null!=a?a:"")&&!s&&(d="https://embed.podcasts.apple.com"),["movie","episode","season","show"].includes(null!=a?a:"")&&s&&(d="https://embed.tv.apple.com"),`<iframe ${[`allow="${P.join("; ")}"`,'frameborder="0"',n?`height="${n}"`:"",`style="${l}"`,`sandbox="${S.join(" ")}"`,`"`].join(" ")}><ype)?"audio":null!==(a=null===(o=e)||void 0===o||null===(i=o.attributes)||void 0===i?void 0:i.mediaKind)&&void 0!==a?a:"audio"},Object.defineProperty(e,"__esModule",{value:!0})}));
