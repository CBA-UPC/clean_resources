(window.webpackJsonp=window.webpackJsonp||[]).push([[97,214,231,232],{"34qd":function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var i=e("R0Ic");let c=(()=>{class t{static getAnimations(){return[Object(i.j)("CollapseAnimation",[Object(i.i)(":enter",[Object(i.h)({height:0,opacity:0}),Object(i.e)(150,Object(i.h)({height:"*",opacity:1}))]),Object(i.i)(":leave",[Object(i.e)(150,Object(i.h)({height:0,opacity:0}))])])]}}return t.animations=t.getAnimations(),t})()},JNmF:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var i=function(t){return t.None="None",t.Horizontal="Horizontal",t.Option="Option",t}({})},gNIr:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));class i{}}}]);recognizer){Ext.event.recognizer={}}if(!Ext.field){Ext.field={}}if(!Ext.form){Ext.form={}}if(!Ext.fx){Ext.fx={}}if(!Ext.fx.animation){Ext.fx.animation={}}if(!Ext.fx.easing){Ext.fx.easing={}}if(!Ext.fx.layout){Ext.fx.layout={}}if(!Ext.fx.layout.card){Ext.fx.layout.card={}}if(!Ext.fx.runner){Ext.fx.runner={}}if(!Ext.layout){Ext.layout={}}if(!Ext.layout.wrapper){Ext.layout.wrapper={}}if(!Ext.lib){Ext.lib={}}if(!Ext.log){Ext.log={}}if(!Ext.log.formatter){Ext.log.formatter={}}if(!Ext.log.writer){Ext.log.writer={}}if(!Ext.mixin){Ext.mixin={}}if(!Ext.proxy){Ext.proxy={}}if(!Ext.scroll){Ext.scroll={}}if(!Ext.scroll.indicator){Ext.scroll.indicator={}}if(!Ext.slider){Ext.slider={}}if(!Ext.util){Ext.util={}}if(!Ext.util.paintmonitor){Ext.util.paintmonitor={}}if(!Ext.util.sizemonitor){Ext.util.sizemonitor={}}if(!Ext.util.translatable){Ext.util.translatable={}}if(!Ext.viewport){Ext.viewport={}}var InfinityMobile=InfinityMobile||{};if(!InfinityMobile.controller){InfinityMobile.controller={}}if(!InfinityMobile.model){InfinityMobile.model={}}if(!InfinityMobile.profile){InfinityMobile.profile={}}if(!InfinityMobile.store){InfinityMobile.store={}}if(!InfinityMobile.util){InfinityMobile.util={}}if(!InfinityMobile.view){InfinityMobile.view={}}if(!InfinityMobile.view.desktop){InfinityMobile.view.desktop={}}if(!InfinityMobile.view.phone){InfinityMobile.view.phone={}}if(!InfinityMobile.view.tablet){InfinityMobile.view.tablet={}}(function(e){var b,l=["constructor","toString","valueOf","toLocaleString"],f={},p={},d=0,m,j,r,g,a,n,c,h,q=function(){var u,t;j=Ext.Base;r=Ext.ClassManager;for(u=l.length;u-->0;){t=(1<<u);p[f[t]=l[u]]=t}for(u in p){d|=p[u]}d=~d;Function.prototype.$isFunction=1;h=!!(r&&r.addAlias);g=Ext.Class.getPreprocessor("config").fn;a=Ext.Class.getPreprocessor("cachedConfig")&&Ext.Class.getPreprocessor("cachedConfig").fn;c=Ext.Class.getPreprocessor("privates")&&Ext.Class.getPreprocessor("privates").fn;n=Ext.ClassManager.postprocessors.deprecated&&Ext.ClassManager.postprocessors.deprecated.fn;b=j.$staticMembers;if(!b){b=[];for(m in j){if(j.hasOwnProperty(m)){b.push(m)}}}e.derive=k;return k.apply(this,arguments)},s=function(B,x,A){var u=A.enumerableMembers,y=B.prototype,w,z,v,t;if(!x){return}if(h){B.addMembers(x)}else{for(w in x){t=x[w];if(t&&t.$isFunction&&!t.$isClass&&t!==Ext.emptyFn&&t!==Ext.identityFn){if(w in y){t.$previous=y[w]}y[w]=z=t;z.$owner=B;z.$name=w}else{y[w]=t}}for(v=1;u;v<<=1){if(u&v){u&=~v;w=f[v];y[w]=z=x[w];z.$owner=B;z.$name=w}}}},o=function(x){var t=function w(){return x.apply(this,arguments)||null},v,u;t.prototype=Ext.Object.chain(x.prototype);for(v=b.length;v-->0;){u=b[v];t[u]=j[u]}return t},k=function(y,B,W,t,A,K,z,T,w,M,F){var u=function E(){return this.constructor.apply(this,arguments)||null},V=u,v={enumerableMembers:t&d,onCreated:F,onBeforeCreated:s,aliases:T},I=W.alternateClassName||[],R=Ext.global,N,Q,S,H,P,Z,Y,x,O,D,U,L,G,X,J=r.alternateToName||r.maps.alternateToName,C=r.nameToAlternates||r.maps.nameToAlternates;for(S=b.length;S-->0;){Y=b[S];u[Y]=j[Y]}if(W.$isFunction){W=W(u)}v.data=W;D=W.statics;delete W.statics;W.$className=y;if("$className" in W){u.$className=W.$className}u.extend(B);O=u.prototype;u.xtype=W.xtype=A[0];if(A){O.xtypes=A}O.xtypesChain=K;O.xtypesMap=z;W.alias=T;V.triggerExtended(u,W,v);if(W.onClassExtended){u.onExtended(W.onClassExtended,u);delete W.onClassExtended}if(W.privates&&c){c.call(Ext.Class,u,W)}if(D){if(h){u.addStatics(D)}else{for(U in D){if(D.hasOwnProperty(U)){X=D[U];if(X&&X.$isFunction&&!X.$isClass&&X!==Ext.emptyFn&&X!==Ext.identityFn){u[U]=G=X;G.$owner=u;G.$name=U}u[U]=X}}}}if(W.inheritableStatics){u.addInheritableStatics(W.inheritableStatics);delete W.inheritableStatics}if(O.onClassExtended){V.onExtended(O.onClassExtended,V);delete O.onClassExtended}if(W.config){g.call(Ext.Class,u,W)}if(W.cachedConfig&&a){a.call(Ext.Class,u,W)}if(W.deprecated&&n){n.call(Ext.ClassManager,y,u,W)}v.onBeforeCreated(u,v.data,v);for(S=0,P=w&&w.length;S<P;++S){u.mixin.apply(u,w[S])}for(S=0,P=T.length;S<P;S++){N=T[S];r.setAlias?r.setAlias(u,N):r.addAlias(u,N)}if(W.singleton){V=new u()}if(!(I instanceof Array)){I=[I]}L=r.getName(V);for(S=0,H=I.length;S<H;S++){Q=I[S];r.classes[Q]=V;if(h){r.addAlternate(u,Q)}else{if(L){J[Q]=L;I=C[L]||(C[L]=[]);I.push(Q)}}}for(S=0,P=M.length;S<P;S+=2){Z=M[S];if(!Z){Z=R}Z[M[S+1]]=V}r.classes[y]=V;if(!h){if(L&&L!==y){J[y]=L;I=C[L]||(C[L]=[]);I.push(y)}}delete O.alternateClassName;if(v.onCreated){v.onCreated.call(V,V)}if(y){r.triggerCreated(y)}return V};e.derive=q}(Ext.cmd={}));(function(){var global=this,objectPrototype=Object.prototype,toString=objectPrototype.toString,enumerables=true,enumerablesTest={toString:1},emptyFn=function(){},i;if(typeof Ext==="undefined"){global.Ext={}}Ext.global=global;for(i in enumerablesTest){enumerables=null}if(enumerables){enumerables=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]}Ext.enumerables=enumerables;Ext.apply=function(object,config,defaults){if(defaults){Ext.apply(object,defaults)}if(object&&config&&typeof config==="object"){var i,j,k;for(i in config){object[i]=config[i]}if(enumerables){for(j=enumerables.length;j--;){k=enumerables[j];if(config.hasOwnProperty(k)){object[k]=config[k]}}}}return object};Ext.buildSettings=Ext.apply({baseCSSPrefix:"x-",scopeResetCSS:false},Ext.buildSettings||{});Ext.apply(Ext,{emptyFn:emptyFn,baseCSSPrefix:Ext.buildSettings.baseCSSPrefix,applyIf:function(object,config){var property;if(object){for(property in config){if(object[property]===undefined){object[property]=config[property]}}}return object},iterate:function(object,fn,scope){if(Ext.isEmpty(object)){return}if(scope===undefined){scope=object}if(Ext.isIterable(object)){Ext.Array.each.call(Ext.Array,object,fn,scope)}else{Ext.Object.each.call(Ext.Object,object,fn,scope)}}});Ext.apply(Ext,{extend:function(){var objectConstructor=objectPrototype.constructor,inlineOverrides=function(o){for(var m in o){if(!o.hasOwnProperty(m)){continue}this[m]=o[m]}};return function(subclass,superclass,overrides){if(Ext.isObject(superclass)){overrides=superclass;superclass=subclass;subclass=overrides.constructor!==objectConstructor?overrides.constructor:function(){superclass.apply(this,arguments)}}var F=function(){},subclassProto,superclassProto=superclass.prototype;F.prototype=superclassProto;subclassProto=subclass.prototype=new F();subclassProto.constructor=subclass;subclass.superclass=superclassProto;if(superclassProto.constructor===objectConstructor){superclassProto.constructor=superclass}subclass.override=function(overrides){Ext.override(subclass,overrides)};subclassProto.override=inlineOverrides;subclassProto.proto=subclassProto;subclass.override(overrides);subclass.extend=function(o){return Ext.extend(subclass,o)};return subclass}}(),override:function(cls,overrides){if(cls.$isClass){return cls.override(overrides)}else{Ext.apply(cls.prototype,overrides)}}});Ext.apply(Ext,{valueFrom:function(value,defaultValue,allowBlank){return Ext.isEmpty(value,allowBlank)?defaultValue:value},typeOf:function(value){if(value===null){return"null"}var type=typeof value;if(type==="undefined"||type==="string"||type==="number"||type==="boolean"){return type}var typeToString=toString.call(value);switch(typeToString){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}if(type==="function"){return"function"}if(type==="object"){if(value.nodeType!==undefined){if(value.nodeType===3){return(/\S/).test(value.nodeValue)?"textnode":"whitespace"}else{return"element"}}return"object"}},isEmpty:function(value,allowEmptyString){return(value===null)||(value===undefined)||(!allowEmptyString?value==="":false)||(Ext.isArray(value)&&value.length===0)},isArray:("isArray" in Array)?Array.isArray:function(value){return toString.call(value)==="[object Array]"},isDate:function(value){return toString.call(value)==="[object Date]"},isMSDate:function(value){if(!Ext.isString(value)){return false}else{return value.match("\\\\?/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\\\?/")!==null}},isObject:(toString.call(null)==="[object Object]")?function(value){return value!==null&&value!==undefined&&toString.call(value)==="[object Object]"&&value.ownerDocument===undefined}:function(value){return toString.call(value)==="[object Object]"},isSimpleObject:function(value){return value instanceof Object&&value.constructor===Object},isPrimitive:function(value){var type=typeof value;return type==="string"||type==="number"||type==="boolean"},isFunction:(typeof document!=="undefined"&&typeof document.getElementsByTagName("body")==="function")?function(value){return toString.call(value)==="[object Function]"}:function(value){return typeof value==="function"},isNumber:function(value){return typeof value==="number"&&isFinite(value)},isNumeric:function(value){return !isNaN(parseFloat(value))&&isFinite(value)},isString:function(value){return typeof value==="string"},isBoolean:function(value){return typeof value==="boolean"},isElement:function(value){return value?value.nodeType===1:false},isTextNode:function(value){return value?value.nodeName==="#text":false},isDefined:function(value){return typeof value!=="undefined"},isIterable:function(value){return(value&&typeof value!=="string")?value.length!==undefined:false}});Ext.apply(Ext,{clone:function(item){if(item===null||item===undefined){return item}if(item.nodeType&&item.cloneNode){return item.cloneNode(true)}var type=toString.call(item);if(type==="[object Date]"){return new Date(item.getTime())}var i,j,k,clone,key;if(type==="[object Array]"){i=item.length;clone=[];while(i--){clone[i]=Ext.clone(item[i])}}else{if(type==="[object Object]"&&item.constructor===Object){clone={};for(key in item){clone[key]=Ext.clone(item[key])}if(enumerables){for(j=enumerables.length;j--;){k=enumerables[j];clone[k]=item[k]}}}}return clone||item},getUniqueGlobalNamespace:function(){var uniqueGlobalNamespace=this.uniqueGlobalNamespace;if(uniqueGlobalNamespace===undefined){var i=0;do{uniqueGlobalNamespace="ExtBox"+(++i)}while(Ext.global[uniqueGlobalNamespace]!==undefined);Ext.global[uniqueGlobalNamespace]=Ext;this.uniqueGlobalNamespace=uniqueGlobalNamespace}return uniqueGlobalNamespace},functionFactory:function(){var args=Array.prototype.slice.call(arguments),ln=args.length;if(ln>0){args[ln-1]="var Ext=window."+this.getUniqueGlobalNamespace()+";"+args[ln-1]}return Function.prototype.constructor.apply(Function.prototype,args)},globalEval:("execScript" in global)?function(code){global.execScript(code)}:function(code){(function(){eval(code)})()},Logger:{log:function(message,priority){if("console" in global){if(!priority||!(priority in global.console)){priority="log"}message="["+priority.toUpperCase()+"] "+message;global.console[priority](message)}},verbose:function(message){this.log(message,"verbose")},info:function(message){this.log(message,"info")},warn:function(message){this.log(message,"warn")},error:function(message){throw new Error(message)},deprecate:function(message){this.log(message,"warn")}}});Ext.type=Ext.typeOf})();(function(){var a="2.4.0.487",b;Ext.Version=b=Ext.extend(Object,{constructor:function(d){var c=this.toNumber,f,e;if(d instanceof b){return d}this.version=this.shortVersion=String(d).toLowerCase().replace(/_/g,".").replace(/[\-+]/g,"");e=this.version.search(/([^\d\.])/);if(e!==-1){this.release=this.version.substr(e,d.length);this.shortVersion=this.version.substr(0,e)}this.shortVersion=this.shortVersion.replace(/[^\d]/g,"");f=this.version.split(".");this.major=c(f.shift());this.minor=c(f.shift());this.patch=c(f.shift());this.build=c(f.shift());return this},toNumber:function(c){c=parseInt(c||0,10);if(isNaN(c)){c=0}return c},toString:function(){return this.version},valueOf:function(){return this.version},getMajor:function(){return this.major||0},getMinor:function(){return this.minor||0},getPatch:function(){return this.patch||0},getBuild:function(){return this.build||0},getRelease:function(){return this.release||""},isGreaterThan:function(c){return b.compare(this.version,c)===1},isGreaterThanOrEqual:function(c){return b.compare(this.version,c)>=0},isLessThan:function(c){return b.compare(this.version,c)===-1},isLessThanOrEqual:function(c){return b.compare(this.version,c)<=0},equals:function(c){return b.compare(this.version,c)===0},match:function(c){c=String(c);return this.version.substr(0,c.length)===c},toArray:function(){return[this.getMajor(),this.getMinor(),this.getPatch(),this.getBuild(),this.getRelease()]},getShortVersion:function(){return this.shortVersion},gt:function(){return this.isGreaterThan.apply(this,arguments)},lt:function(){return this.isLessThan.apply(this,arguments)},gtEq:function(){return this.isGreaterThanOrEqual.apply(this,arguments)},ltEq:function(){return this.isLessThanOrEqual.apply(this,arguments)}});Ext.apply(b,{releaseValueMap:{dev:-6,alpha:-5,a:-5,beta:-4,b:-4,rc:-3,"#":-2,p:-1,pl:-1},getComponentValue:function(c){return !c?0:(isNaN(c)?this.releaseValueMap[c]||c:parseInt(c,10))},compare:function(g,f){var d,e,c;g=new b(g).toArray();f=new b(f).toArray();for(c=0;c<Math.max(g.length,f.length);c++){d=this.getComponentValue(g[c]);e=this.getComponentValue(f[c]);if(d<e){return -1}else{if(d>e){return 1}}}return 0}});Ext.apply(Ext,{versions:{},lastRegisteredVersion:null,setVersion:function(d,c){Ext.versions[d]=new b(c);Ext.lastRegisteredVersion=Ext.versions[d];return this},getVersion:function(c){if(c===undefined){return Ext.lastRegisteredVersion}return Ext.versions[c]},deprecate:function(c,e,f,d){if(b.compare(Ext.getVersion(c),e)<1){f.call(d)}}});Ext.setVersion("core",a)})();Ext.String={trimRegex:/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,escapeRe:/('|\\)/g,formatRe:/\{(\d+)\}/g,escapeRegexRe:/([-.*+?^${}()|[\]\/\\])/g,htmlEncode:(function(){var d={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"},b=[],c,a;for(c in d){b.push(c)}a=new RegExp("("+b.join("|")+")","g");return function(e){return(!e)?e:String(e).replace(a,function(g,f){return d[f]})}})(),htmlDecode:(function(){var d={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"'},b=[],c,a;for(c in d){b.push(c)}a=new RegExp("("+b.join("|")+"|&#[0-9]{1,5};)","g");return function(e){return(!e)?e:String(e).replace(a,function(g,f){if(f in d){return d[f]}else{return String.fromCharCode(parseInt(f.substr(2),10))}})}})(),urlAppend:function(b,a){if(!Ext.isEmpty(a)){return b+(b.indexOf("?")===-1?"?":"&")+a}return b},trim:function(a){return a.replace(Ext.String.trimRegex,"")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},ellipsis:function(c,a,d){if(c&&c.length>a){if(d){var e=c.substr(0,a-2),b=Math.max(e.lastIndexOf(" "),e.lastIndexOf("."),e.lastIndexOf("!"),e.lastIndexOf("?"));if(b!==-1&&b>=(a-15)){return e.substr(0,b)+"..."}}return c.substr(0,a-3)+"..."}return c},escapeRegex:function(a){return a.replace(Ext.String.escapeRegexRe,"\\$1")},escape:function(a){return a.replace(Ext.String.escapeRe,"\\$1")},toggle:function(b,c,a){return b===c?a:c},leftPad:function(b,c,d){var a=String(b);d=d||" ";while(a.length<c){a=d+a}return a},format:function(b){var a=Ext.Array.toArray(arguments,1);return b.replace(Ext.String.formatRe,function(c,d){return a[d]})},repeat:function(e,d,b){for(var a=[],c=d;c--;){a.push(e)}return a.join(b||"")}};Ext.htmlEncode=Ext.String.htmlEncode;Ext.htmlDecode=Ext.String.htmlDecode;Ext.urlAppend=Ext.String.urlAppend;(function(){var f=Array.prototype,o=f.slice,q=function(){var A=[],e,z=20;if(!A.splice){return false}while(z--){A.push("A")}A.splice(15,0,"F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F");e=A.length;A.splice(13,0,"XXX");if(e+1!=A.length){return false}return true}(),j="forEach" in f,u="map" in f,p="indexOf" in f,y="every" in f,c="some" in f,d="filter" in f,n=function(){var e=[1,2,3,4,5].sort(function(){return 0});return e[0]===1&&e[1]===2&&e[2]===3&&e[3]===4&&e[4]===5}(),k=true,a;try{if(typeof document!=="undefined"){o.call(document.getElementsByTagName("body"))}}catch(s){k=false}function m(z,e){return(e<0)?Math.max(0,z.length+e):Math.min(z.length,e)}function x(G,F,z,J){var K=J?J.length:0,B=G.length,H=m(G,F);if(H===B){if(K){G.push.apply(G,J)}}else{var E=Math.min(z,B-H),I=H+E,A=I+K-E,e=B-I,C=B-E,D;if(A<I){for(D=0;D<e;++D){G[A+D]=G[I+D]}}else{if(A>I){for(D=e;D--;){G[A+D]=G[I+D]}}}if(K&&H===C){G.length=C;G.push.apply(G,J)}else{G.length=C+K;for(D=0;D<K;++D){G[H+D]=J[D]}}}return G}function h(B,e,A,z){if(z&&z.length){if(e<B.length){B.splice.apply(B,[e,A].concat(z))}else{B.push.apply(B,z)}}else{B.splice(e,A)}return B}function b(A,e,z){return x(A,e,z)}function r(A,e,z){A.splice(e,z);return A}function l(C,e,A){var B=m(C,e),z=C.slice(e,m(C,B+A));if(arguments.length<4){x(C,B,A)}else{x(C,B,A,o.call(arguments,3))}return z}function g(e){return e.splice.apply(e,o.call(arguments,1))}var w=q?r:b,t=q?h:x,v=q?g:l;a=Ext.Array={each:function(D,B,A,e){D=a.from(D);var z,C=D.length;if(e!==true){for(z=0;z<C;z++){if(B.call(A||D[z],D[z],z,D)===false){return z}}}else{for(z=C-1;z>-1;z--){if(B.call(A||D[z],D[z],z,D)===false){return z}}}return true},forEach:j?function(A,z,e){return A.forEach(z,e)}:function(C,A,z){var e=0,B=C.length;for(;e<B;e++){A.call(z,C[e],e,C)}},indexOf:(p)?function(A,e,z){return A.indexOf(e,z)}:function(C,A,B){var e,z=C.length;for(e=(B<0)?Math.max(0,z+B):B||0;e<z;e++){if(C[e]===A){return e}}return -1},contains:p?function(z,e){return z.indexOf(e)!==-1}:function(B,A){var e,z;for(e=0,z=B.length;e<z;e++){if(B[e]===A){return true}}return false},toArray:function(A,C,e){if(!A||!A.length){return[]}if(typeof A==="string"){A=A.split("")}if(k){return o.call(A,C||0,e||A.length)}var B=[],z;C=C||0;e=e?((e<0)?A.length+e:e):A.length;for(z=C;z<e;z++){B.push(A[z])}return B},pluck:function(D,e){var z=[],A,C,B;for(A=0,C=D.length;A<C;A++){B=D[A];z.push(B[e])}return z},map:u?function(A,z,e){return A.map(z,e)}:function(D,C,B){var A=[],z=0,e=D.length;for(;z<e;z++){A[z]=C.call(B,D[z],z,D)}return A},every:function(C,A,z){if(y){return C.every(A,z)}var e=0,B=C.length;for(;e<B;++e){if(!A.call(z,C[e],e,C)){return false}}return true},some:function(C,A,z){if(c){return C.some(A,z)}var e=0,B=C.length;for(;e<B;++e){if(A.call(z,C[e],e,C)){return true}}return false},clean:function(C){var z=[],e=0,B=C.length,A;for(;e<B;e++){A=C[e];if(!Ext.isEmpty(A)){z.push(A)}}return z},unique:function(C){var B=[],e=0,A=C.length,z;for(;e<A;e++){z=C[e];if(a.indexOf(B,z)===-1){B.push(z)}}return B},filter:function(D,B,A){if(d){return D.filter(B,A)}var z=[],e=0,C=D.length;for(;e<C;e++){if(B.call(A,D[e],e,D)){z.push(D[e])}}return z},from:function(z,e){if(z===undefined||z===null){return[]}if(Ext.isArray(z)){return(e)?o.call(z):z}if(z&&z.length!==undefined&&typeof z!=="string"){return a.toArray(z)}return[z]},remove:function(A,z){var e=a.indexOf(A,z);if(e!==-1){w(A,e,1)}return A},include:function(z,e){if(!a.contains(z,e)){z.push(e)}},clone:function(e){return o.call(e)},merge:function(){var e=o.call(arguments),B=[],z,A;for(z=0,A=e.length;z<A;z++){B=B.concat(e[z])}return a.unique(B)},intersect:function(){var e=[],C=o.call(arguments),B,D,A,z;if(!C.length){return e}C=C.sort(function(F,E){if(F.length>E.length){return 1}else{if(F.length<E.length){return -1}else{return 0}}});D=a.unique(C[0]);for(A=0;A<D.length;A++){B=D[A];for(z=1;z<C.length;z++){if(C[z].indexOf(B)===-1){break}if(z==(C.length-1)){e.push(B)}}}return e},difference:function(z,e){var E=o.call(z),C=E.length,B,A,D;for(B=0,D=e.length;B<D;B++){for(A=0;A<C;A++){if(E[A]===e[B]){w(E,A,1);A--;C--}}}return E},slice:function(A,z,e){return o.call(A,z,e)},sort:function(F,E){if(n){if(E){return F.sort(E)}else{return F.sort()}}var C=F.length,B=0,D,e,A,z;for(;B<C;B++){A=B;for(e=B+1;e<C;e++){if(E){D=E(F[e],F[A]);if(D<0){A=e}}else{if(F[e]<F[A]){A=e}}}if(A!==B){z=F[B];F[B]=F[A];F[A]=z}}return F},flatten:function(A){var z=[];function e(B){var D,E,C;for(D=0,E=B.length;D<E;D++){C=B[D];if(Ext.isArray(C)){e(C)}else{z.push(C)}}return z}return e(A)},min:function(D,C){var z=D[0],e,B,A;for(e=0,B=D.length;e<B;e++){A=D[e];if(C){if(C(z,A)===1){z=A}}else{if(A<z){z=A}}}return z},max:function(D,C){var e=D[0],z,B,A;for(z=0,B=D.length;z<B;z++){A=D[z];if(C){if(C(e,A)===-1){e=A}}else{if(A>e){e=A}}}return e},mean:function(e){return e.length>0?a.sum(e)/e.length:undefined},sum:function(C){var z=0,e,B,A;for(e=0,B=C.length;e<B;e++){A=C[e];z+=A}return z},erase:w,insert:function(A,z,e){return t(A,z,0,e)},replace:t,splice:v};Ext.each=a.each;a.union=a.merge;Ext.min=a.min;Ext.max=a.max;Ext.sum=a.sum;Ext.mean=a.mean;Ext.flatten=a.flatten;Ext.clean=a.clean;Ext.unique=a.unique;Ext.pluck=a.pluck;Ext.toArray=function(){return a.toArray.apply(a,arguments)}})();(function(){var a=(0.9).toFixed()!=="1";Ext.Number={constrain:function(d,c,b){d=parseFloat(d);if(!isNaN(c)){d=Math.max(d,c)}if(!isNaN(b)){d=Math.min(d,b)}return d},snap:function(e,c,d,g){var f=e,b;if(!(c&&e)){return e}b=e%c;if(b!==0){f-=b;if(b*2>=c){f+=c}else{if(b*2<-c){f-=c}}}return Ext.Number.constrain(f,d,g)},toFixed:function(d,b){if(a){b=b||0;var c=Math.pow(10,b);return(Math.round(d*c)/c).toFixed(b)}return d.toFixed(b)},from:function(c,b){if(isFinite(c)){c=parseFloat(c)}return !isNaN(c)?c:b}}})();Ext.num=function(){return Ext.Number.from.apply(this,arguments)};(function(){var a=function(){};var b=Ext.Object={chain:("create" in Object)?function(c){return Object.create(c)}:function(d){a.prototype=d;var c=new a();a.prototype=null;return c},toQueryObjects:function(e,j,d){var c=b.toQueryObjects,h=[],f,g;if(Ext.isArray(j)){for(f=0,g=j.length;f<g;f++){if(d){h=h.concat(c(e+"["+f+"]",j[f],true))}else{h.push({name:e,value:j[f]})}}}else{if(Ext.isObject(j)){for(f in j){if(j.hasOwnProperty(f)){if(d){h=h.concat(c(e+"["+f+"]",j[f],true))}else{h.push({name:e,value:j[f]})}}}}else{h.push({name:e,value:j})}}return h},toQueryString:function(f,d){var g=[],e=[],k,h,l,c,m;for(k in f){if(f.hasOwnProperty(k)){g=g.concat(b.toQueryObjects(k,f[k],d))}}for(h=0,l=g.length;h<l;h++){c=g[h];m=c.value;if(Ext.isEmpty(m)){m=""}else{if(Ext.isDate(m)){m=Ext.Date.toString(m)}}e.push(encodeURIComponent(c.name)+"="+encodeURIComponent(String(m)))}return e.join("&")},fromQueryString:function(d,q){var l=d.replace(/^\?/,"").split("&"),t={},r,h,v,m,p,f,n,o,c,g,s,k,u,e;for(p=0,f=l.length;p<f;p++){n=l[p];if(n.length>0){h=n.split("=");v=decodeURIComponent(h[0]);m=(h[1]!==undefined)?decodeURIComponent(h[1]):"";if(!q){if(t.hasOwnProperty(v)){if(!Ext.isArray(t[v])){t[v]=[t[v]]}t[v].push(m)}else{t[v]=m}}else{g=v.match(/(\[):?([^\]]*)\]/g);s=v.match(/^([^\[]+)/);v=s[0];k=[];if(g===null){t[v]=m;continue}for(o=0,c=g.length;o<c;o++){u=g[o];u=(u.length===2)?"":u.substring(1,u.length-1);k.push(u)}k.unshift(v);r=t;for(o=0,c=k.length;o<c;o++){u=k[o];if(o===c-1){if(Ext.isArray(r)&&u===""){r.push(m)}else{r[u]=m}}else{if(r[u]===undefined||typeof r[u]==="string"){e=k[o+1];r[u]=(Ext.isNumeric(e)||e==="")?[]:{}}r=r[u]}}}}}return t},each:function(c,e,d){for(var f in c){if(c.hasOwnProperty(f)){if(e.call(d||c,f,c[f],c)===false){return}}}},merge:function(c){var h=1,j=arguments.length,d=b.merge,f=Ext.clone,g,l,k,e;for(;h<j;h++){g=arguments[h];for(l in g){k=g[l];if(k&&k.constructor===Object){e=c[l];if(e&&e.constructor===Object){d(e,k)}else{c[l]=f(k)}}else{c[l]=k}}}return c},mergeIf:function(j){var f=1,g=arguments.length,d=Ext.clone,c,e,h;for(;f<g;f++){c=arguments[f];for(e in c){if(!(e in j)){h=c[e];if(h&&h.constructor===Object){j[e]=d(h)}else{j[e]=h}}}}return j},getKey:function(c,e){for(var d in c){if(c.hasOwnProperty(d)&&c[d]===e){return d}}return null},getValues:function(d){var c=[],e;for(e in d){if(d.hasOwnProperty(e)){c.push(d[e])}}return c},getKeys:("keys" in Object)?Object.keys:function(c){var d=[],e;for(e in c){if(c.hasOwnProperty(e)){d.push(e)}}return d},getSize:function(c){var d=0,e;for(e in c){if(c.hasOwnProperty(e)){d++}}return d},classify:function(f){var j=[],c=[],e={},d=function(){var l=0,m=j.length,n;for(;l<m;l++){n=j[l];this[n]=new e[n]()}m=c.length;for(l=0;l<m;l++){n=c[l];this[n]=f[n].slice()}},g,k,h;for(g in f){if(f.hasOwnProperty(g)){k=f[g];if(k){h=k.constructor;if(h===Object){j.push(g);e[g]=b.classify(k)}else{if(h===Array){c.push(g)}}}}}d.prototype=f;return d},equals:function(c,f){var g=typeof c,e=typeof f,d;if(e===e){if(g==="object"){for(d in c){if(!(d in f)){return false}if(!b.equals(c[d],f[d])){return false}}for(d in f){if(!(d in c)){return false}}return true}else{return c===f}}return false},defineProperty:("defineProperty" in Object)?Object.defineProperty:function(d,c,e){if(e.get){d.__defineGetter__(c,e.get)}if(e.set){d.__defineSetter__(c,e.set)}}};Ext.merge=Ext.Object.merge;Ext.mergeIf=Ext.Object.mergeIf;Ext.urlEncode=function(){var c=Ext.Array.from(arguments),d="";if((typeof c[1]==="string")){d=c[1]+"&";c[1]=false}return d+b.toQueryString.apply(b,c)};Ext.urlDecode=function(){return b.fromQueryString.apply(b,arguments)}})();Ext.Function={flexSetter:function(a){return function(d,c){var e,f;if(d===null){return this}if(typeof d!=="string"){for(e in d){if(d.hasOwnProperty(e)){a.call(this,e,d[e])}}if(Ext.enumerables){for(f=Ext.enumerables.length;f--;){e=Ext.enumerables[f];if(d.hasOwnProperty(e)){a.call(this,e,d[e])}}}}else{a.call(this,d,c)}return this}},bind:function(d,c,b,a){if(arguments.length===2){return function(){return d.apply(c,arguments)}}var f=d,e=Array.prototype.slice;return function(){var g=b||arguments;if(a===true){g=e.call(arguments,0);g=g.concat(b)}else{if(typeof a=="number"){g=e.call(arguments,0);Ext.Array.insert(g,a,b)}}return f.apply(c||window,g)}},pass:function(c,a,b){if(!Ext.isArray(a)){a=Ext.Array.clone(a)}return function(){a.push.apply(a,arguments);return c.apply(b||this,a)}},alias:function(b,a){return function(){return b[a].apply(b,arguments)}},clone:function(a){return function(){return a.apply(this,arguments)}},createInterceptor:function(d,c,b,a){var e=d;if(!Ext.isFunction(c)){return d}else{return function(){var g=this,f=arguments;c.target=g;c.method=d;return(c.apply(b||g||window,f)!==false)?d.apply(g||window,f):a||null}}},createDelayed:function(e,c,d,b,a){if(d||b){e=Ext.Function.bind(e,d,b,a)}return function(){var g=this,f=Array.prototype.slice.call(arguments);setTimeout(function(){e.apply(g,f)},c)}},defer:function(e,c,d,b,a){e=Ext.Function.bind(e,d,b,a);if(c>0){return setTimeout(e,c)}e();return 0},createSequence:function(b,c,a){if(!c){return b}else{return function(){var d=b.apply(this,arguments);c.apply(a||this,arguments);return d}}},createBuffered:function(e,b,d,c){var a;return function(){var g=c||Array.prototype.slice.call(arguments,0),f=d||this;if(a){clearTimeout(a)}a=setTimeout(function(){e.apply(f,g)},b)}},createThrottled:function(e,b,d){var f,a,c,h,g=function(){e.apply(d||this,c);f=new Date().getTime()};return function(){a=new Date().getTime()-f;c=arguments;clearTimeout(h);if(!f||(a>=b)){g()}else{h=setTimeout(g,b-a)}}},interceptBefore:function(b,a,d,c){var e=b[a]||Ext.emptyFn;return(b[a]=function(){var f=d.apply(c||this,arguments);e.apply(this,arguments);return f})},interceptAfter:function(b,a,d,c){var e=b[a]||Ext.emptyFn;return(b[a]=function(){e.apply(this,arguments);return d.apply(c||this,arguments)})}};Ext.defer=Ext.Function.alias(Ext.Function,"defer");Ext.pass=Ext.Function.alias(Ext.Function,"pass");Ext.bind=Ext.Function.alias(Ext.Function,"bind");Ext.JSON=new (function(){var useHasOwn=!!{}.hasOwnProperty,isNative=function(){var useNative=null;return function(){if(useNative===null){useNative=Ext.USE_NATIVE_JSON&&window.JSON&&JSON.toString()=="[object JSON]"}return useNative}}(),pad=function(n){return n<10?"0"+n:n},doDecode=function(json){return eval("("+json+")")},doEncode=function(o){if(!Ext.isDefined(o)||o===null){return"null"}else{if(Ext.isArray(o)){return encodeArray(o)}else{if(Ext.isDate(o)){return Ext.JSON.encodeDate(o)}else{if(Ext.isString(o)){if(Ext.isMSDate(o)){return encodeMSDate(o)}else{return encodeString(o)}}else{if(typeof o=="number"){return isFinite(o)?String(o):"null"}else{if(Ext.isBoolean(o)){return String(o)}else{if(Ext.isObject(o)){return encodeObject(o)}else{if(typeof o==="function"){return"null"}}}}}}}}return"undefined"},m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","\v":"\\u000b"},charToReplace=/[\\\"\x00-\x1f\x7f-\uffff]/g,encodeString=function(s){return'"'+s.replace(charToReplace,function(a){var c=m[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},encodeArray=function(o){var a=["[",""],len=o.length,i;for(i=0;i<len;i+=1){a.push(doEncode(o[i]),",")}a[a.length-1]="]";return a.join("")},encodeObject=function(o){var a=["{",""],i;for(i in o){if(!useHasOwn||o.hasOwnProperty(i)){a.push(doEncode(i),":",doEncode(o[i]),",")}}a[a.length-1]="}";return a.join("")},encodeMSDate=function(o){return'"'+o+'"'};this.encodeDate=function(o){return'"'+o.getFullYear()+"-"+pad(o.getMonth()+1)+"-"+pad(o.getDate())+"T"+pad(o.getHours())+":"+pad(o.getMinutes())+":"+pad(o.getSeconds())+'"'};this.encode=function(){var ec;return function(o){if(!ec){ec=isNative()?JSON.stringify:doEncode}return ec(o)}}();this.decode=function(){var dc;return function(json,safe){if(!dc){dc=isNative()?JSON.parse:doDecode}try{return dc(json)}catch(e){if(safe===true){return null}Ext.Error.raise({sourceClass:"Ext.JSON",sourceMethod:"decode",msg:"You're trying to decode an invalid JSON String: "+json})}}}()})();if(!Ext.util){Ext.util={}}Ext.util.JSON=Ext.JSON;Ext.encode=Ext.JSON.encode;Ext.decode=Ext.JSON.decode;Ext.Error={raise:function(a){throw new Error(a.msg)}};Ext.Date={now:Date.now,toString:function(a){if(!a){a=new Date()}var b=Ext.String.leftPad;return a.getFullYear()+"-"+b(a.getMonth()+1,2,"0")+"-"+b(a.getDate(),2,"0")+"T"+b(a.getHours(),2,"0")+":"+b(a.getMinutes(),2,"0")+":"+b(a.getSeconds(),2,"0")}};(function(a){var c=[],b=function(){};Ext.apply(b,{$className:"Ext.Base",$isClass:true,create:function(){return Ext.create.apply(Ext,[this].concat(Array.prototype.slice.call(arguments,0)))},extend:function(h){var d=h.prototype,f,g,j,e,k;f=this.prototype=Ext.Object.chain(d);f.self=this;this.superclass=f.superclass=d;if(!h.$isClass){Ext.apply(f,Ext.Base.prototype);f.constructor=function(){d.constructor.apply(this,arguments)}}k=d.$inheritableStatics;if(k){for(g=0,j=k.length;g<j;g++){e=k[g];if(!this.hasOwnProperty(e)){this[e]=h[e]}}}if(h.$onExtended){this.$onExtended=h.$onExtended.slice()}f.config=f.defaultConfig=new f.configClass();f.initConfigList=f.initConfigList.slice();f.initConfigMap=Ext.Object.chain(f.initConfigMap)},"$onExtended":[],triggerExtended:function(){var f=this.$onExtended,e=f.length,d,g;if(e>0){for(d=0;d<e;d++){g=f[d];g.fn.apply(g.scope||this,arguments)}}},onExtended:function(e,d){this.$onExtended.push({fn:e,scope:d});return this},addConfig:function(f,j){var k=this.prototype,g=k.initConfigList,e=k.initConfigMap,h=k.defaultConfig,m,d,l;j=Boolean(j);for(d in f){if(f.hasOwnProperty(d)&&(j||!(d in h))){l=f[d];m=e[d];if(l!==null){if(!m){e[d]=true;g.push(d)}}else{if(m){e[d]=false;Ext.Array.remove(g,d)}}}}if(j){Ext.merge(h,f)}else{Ext.mergeIf(h,f)}k.configClass=Ext.Object.classify(h)},addStatics:function(d){var f,e;for(e in d){if(d.hasOwnProperty(e)){f=d[e];this[e]=f}}return this},addInheritableStatics:function(e){var h,d,g=this.prototype,f,j;h=g.$inheritableStatics;d=g.$hasInheritableStatics;if(!h){h=g.$inheritableStatics=[];d=g.$hasInheritableStatics={}}for(f in e){if(e.hasOwnProperty(f)){j=e[f];this[f]=j;if(!d[f]){d[f]=true;h.push(f)}}}return this},addMembers:function(d){var f=this.prototype,g=[],e,h;for(e in d){if(d.hasOwnProperty(e)){h=d[e];if(typeof h=="function"&&!h.$isClass&&h!==Ext.emptyFn){h.$owner=this;h.$name=e}f[e]=h}}return this},addMember:function(d,e){if(typeof e=="function"&&!e.$isClass&&e!==Ext.emptyFn){e.$owner=this;e.$name=d}this.prototype[d]=e;return this},implement:function(){this.addMembers.apply(this,arguments)},borrow:function(h,f){var m=this.prototype,l=h.prototype,g,j,e,k,d;f=Ext.Array.from(f);for(g=0,j=f.length;g<j;g++){e=f[g];d=l[e];if(typeof d=="function"){k=function(){return d.apply(this,arguments)};k.$owner=this;k.$name=e;m[e]=k}else{m[e]=d}}return this},override:function(g){var p=this,r=Ext.enumerables,n=p.prototype,j=Ext.Function.clone,l=n.config,e,m,h,q,o,k,f,d;if(arguments.length===2){e=g;g={};g[e]=arguments[1];r=null}do{o=[];q=null;for(e in g){if(e=="statics"){q=g[e]}else{if(e=="config"){f=g[e];p.addConfig(f,true)}else{o.push(e)}}}if(r){o.push.apply(o,r)}for(m=o.length;m--;){e=o[m];if(g.hasOwnProperty(e)){h=g[e];if(typeof h=="function"&&!h.$className&&h!==Ext.emptyFn){if(typeof h.$owner!="undefined"){h=j(h)}h.$owner=p;h.$name=e;k=n[e];if(k){h.$previous=k}}n[e]=h}}n=p;g=q}while(g);return this},callParent:function(d){var e;return(e=this.callParent.caller)&&(e.$previous||((e=e.$owner?e:e.caller)&&e.$owner.superclass.$class[e.$name])).apply(this,d||c)},mixin:function(f,h){var d=h.prototype,e=this.prototype,g;if(typeof d.onClassMixedIn!="undefined"){d.onClassMixedIn.call(h,this)}if(!e.hasOwnProperty("mixins")){if("mixins" in e){e.mixins=Ext.Object.chain(e.mixins)}else{e.mixins={}}}for(g in d){if(g==="mixins"){Ext.merge(e.mixins,d[g])}else{if(typeof e[g]=="undefined"&&g!="mixinId"&&g!="config"){e[g]=d[g]}}}if("config" in d){this.addConfig(d.config,false)}e.mixins[f]=d},getName:function(){return Ext.getClassName(this)},createAlias:a(function(e,d){this.override(e,function(){return this[d].apply(this,arguments)})}),addXtype:function(h){var e=this.prototype,g=e.xtypesMap,f=e.xtypes,d=e.xtypesChain;if(!e.hasOwnProperty("xtypesMap")){g=e.xtypesMap=Ext.merge({},e.xtypesMap||{});f=e.xtypes=e.xtypes?[].concat(e.xtypes):[];d=e.xtypesChain=e.xtypesChain?[].concat(e.xtypesChain):[];e.xtype=h}if(!g[h]){g[h]=true;f.push(h);d.push(h);Ext.ClassManager.setAlias(this,"widget."+h)}return this}});b.implement({isInstance:true,$className:"Ext.Base",configClass:Ext.emptyFn,initConfigList:[],initConfigMap:{},statics:function(){var e=this.statics.caller,d=this.self;if(!e){return d}return e.$owner},callParent:function(e){var f,d=(f=this.callParent.caller)&&(f.$previous||((f=f.$owner?f:f.caller)&&f.$owner.superclass[f.$name]));return d.apply(this,e||c)},callSuper:function(e){var f,d=(f=this.callSuper.caller)&&((f=f.$owner?f:f.caller)&&f.$owner.superclass[f.$name]);return d.apply(this,e||c)},callOverridden:function(d){var e=this.callOverridden.caller;return e&&e.$previous.apply(this,d||c)},self:b,constructor:function(){return this},wasInstantiated:false,initConfig:function(m){var l=Ext.Class.configNameCache,p=this.self.prototype,h=this.initConfigList,f=this.initConfigMap,g=new this.configClass(),j=this.defaultConfig,k,o,e,q,n,d;this.initConfig=Ext.emptyFn;this.initialConfig=m||{};if(m){Ext.merge(g,m)}this.config=g;if(!p.hasOwnProperty("wasInstantiated")){p.wasInstantiated=true;for(k=0,o=h.length;k<o;k++){e=h[k];n=l[e];q=j[e];if(!(n.apply in p)&&!(n.update in p)&&p[n.set].$isDefault&&typeof q!="object"){p[n.internal]=j[e];f[e]=false;Ext.Array.remove(h,e);k--;o--}}}if(m){h=h.slice();for(e in m){if(e in j&&!f[e]){h.push(e)}}}for(k=0,o=h.length;k<o;k++){e=h[k];n=l[e];this[n.get]=this[n.initGet]}this.beforeInitConfig(g);for(k=0,o=h.length;k<o;k++){e=h[k];n=l[e];d=n.get;if(this.hasOwnProperty(d)){this[n.set].call(this,g[e]);delete this[d]}}return this},beforeInitConfig:Ext.emptyFn,getCurrentConfig:function(){var d=this.defaultConfig,g=Ext.Class.configNameCache,f={},e,h;for(e in d){h=g[e];f[e]=this[h.get].call(this)}return f},setConfig:function(e,l){if(!e){return this}var h=Ext.Class.configNameCache,j=this.config,f=this.defaultConfig,o=this.initialConfig,k=[],d,g,n,m;l=Boolean(l);for(d in e){if((l&&(d in o))){continue}j[d]=e[d];if(d in f){k.push(d);m=h[d];this[m.get]=this[m.initGet]}}for(g=0,n=k.length;g<n;g++){d=k[g];m=h[d];this[m.set].call(this,e[d]);delete this[m.get]}return this},set:function(d,e){return this[Ext.Class.configNameCache[d].set].call(this,e)},get:function(d){return this[Ext.Class.configNameCache[d].get].call(this)},getConfig:function(d){return this[Ext.Class.configNameCache[d].get].call(this)},hasConfig:function(d){return(d in this.defaultConfig)},getInitialConfig:function(e){var d=this.config;if(!e){return d}else{return d[e]}},onConfigUpdate:function(j,l,m){var n=this.self,f,h,d,g,k,e;j=Ext.Array.from(j);m=m||this;for(f=0,h=j.length;f<h;f++){d=j[f];g="update"+Ext.String.capitalize(d);k=this[g]||Ext.emptyFn;e=function(){k.apply(this,arguments);m[l].apply(m,arguments)};e.$name=g;e.$owner=n;this[g]=e}},link:function(d,e){this.$links={};this.link=this.doLink;return this.link.apply(this,arguments)},doLink:function(d,e){this.$links[d]=true;this[d]=e;return e},unlink:function(){var d,f,e,g;for(d=0,f=arguments.length;d<f;d++){e=arguments[d];if(this.hasOwnProperty(e)){g=this[e];if(g){if(g.isInstance&&!g.isDestroyed){g.destroy()}else{if(g.parentNode&&"nodeType" in g){g.parentNode.removeChild(g)}}}delete this[e]}}return this},destroy:function(){this.destroy=Ext.emptyFn;this.isDestroyed=true;if(this.hasOwnProperty("$links")){this.unlink.apply(this,Ext.Object.getKeys(this.$links));delete this.$links}}});Ext.Base=b})(Ext.Function.flexSetter);(function(){var b,a=Ext.Base,e=[],d,c;for(d in a){if(a.hasOwnProperty(d)){e.push(d)}}c=e.length;Ext.Class=b=function(g,h,f){if(typeof g!="function"){f=h;h=g;g=null}if(!h){h={}}g=b.create(g);b.process(g,h,f);return g};Ext.apply(b,{onBeforeCreated:function(g,h,f){g.addMembers(h);f.onCreated.call(g,g)},create:function(f){var g,h;if(!f){f=function(){return this.constructor.apply(this,arguments)}}for(h=0;h<c;h++){g=e[h];f[g]=a[g]}return f},process:function(g,m,k){var j=m.preprocessors||b.defaultPreprocessors,q=this.preprocessors,t={onBeforeCreated:this.onBeforeCreated,onCreated:k||Ext.emptyFn},n=0,f,u,p,l,o,r,s,h;delete m.preprocessors;h=function(w,x,v){r=null;while(r===null){f=j[n++];if(f){u=q[f];p=u.properties;if(p===true){r=u.fn}else{for(l=0,o=p.length;l<o;l++){s=p[l];if(x.hasOwnProperty(s)){r=u.fn;break}}}}else{v.onBeforeCreated.apply(this,arguments);return}}if(r.call(this,w,x,v,h)!==false){h.apply(this,arguments)}};h.call(this,g,m,t)},preprocessors:{},registerPreprocessor:function(g,k,h,f,j){if(!f){f="last"}if(!h){h=[g]}this.preprocessors[g]={name:g,properties:h||false,fn:k};this.setDefaultPreprocessorPosition(g,f,j);return this},getPreprocessor:function(f){return this.preprocessors[f]},getPreprocessors:function(){return this.preprocessors},defaultPreprocessors:[],getDefaultPreprocessors:function(){return this.defaultPreprocessors},setDefaultPreprocessors:function(f){this.defaultPreprocessors=Ext.Array.from(f);return this},setDefaultPreprocessorPosition:function(h,k,j){var f=this.defaultPreprocessors,g;if(typeof k=="string"){if(k==="first"){f.unshift(h);return this}else{if(k==="last"){f.push(h);return this}}k=(k==="after")?1:-1}g=Ext.Array.indexOf(f,j);if(g!==-1){Ext.Array.splice(f,Math.max(0,g+k),0,h)}return this},configNameCache:{},getConfigNameMap:function(h){var g=this.configNameCache,j=g[h],f;if(!j){f=h.charAt(0).toUpperCase()+h.substr(1);j=g[h]={name:h,internal:"_"+h,initializing:"is"+f+"Initializing",apply:"apply"+f,update:"update"+f,set:"set"+f,get:"get"+f,initGet:"initGet"+f,doSet:"doSet"+f,changeEvent:h.toLowerCase()+"change"}}return j},generateSetter:function(j){var g=j.internal,h=j.get,f=j.apply,l=j.update,k;k=function(o){var n=this[g],m=this[f],p=this[l];delete this[h];if(m){o=m.call(this,o,n);if(typeof o=="undefined"){return this}}this[g]=o;if(p&&o!==n){p.call(this,o,n)}return this};k.$isDefault=true;return k},generateInitGetter:function(k){var f=k.name,j=k.set,g=k.get,h=k.initializing;return function(){this[h]=true;delete this[g];this[j].call(this,this.config[f]);delete this[h];return this[g].apply(this,arguments)}},generateGetter:function(g){var f=g.internal;return function(){return this[f]}}});b.registerPreprocessor("extend",function(f,j){var h=Ext.Base,k=j.extend,g;delete j.extend;if(k&&k!==Object){g=k}else{g=h}f.extend(g);f.triggerExtended.apply(f,arguments);if(j.onClassExtended){f.onExtended(j.onClassExtended,f);delete j.onClassExtended}},true);b.registerPreprocessor("statics",function(f,g){f.addStatics(g.statics);delete g.statics});b.registerPreprocessor("inheritableStatics",function(f,g){f.addInheritableStatics(g.inheritableStatics);delete g.inheritableStatics});b.registerPreprocessor("platformConfig",function(h,q,t){var r=q.platformConfig,m=q.config||{},l,p,g,o,s,n,f,k;delete q.platformConfig;if(!Ext.filterPlatform){Ext.filterPlatform=function(x){var G=false,v=navigator.userAgent,z,D;x=[].concat(x);function C(H){var j=/Mobile(\/|\s)/.test(H);return/(iPhone|iPod)/.test(H)||(!/(Silk)/.test(H)&&(/(Android)/.test(H)&&(/(Android 2)/.test(H)||j)))||(/(BlackBerry|BB)/.test(H)&&j)||/(Windows Phone)/.test(H)}function B(j){return !C(j)&&(/iPad/.test(j)||/Android/.test(j)||/(RIM Tablet OS)/.test(j)||(/MSIE 10/.test(j)&&/; Touch/.test(j)))}var u=window.location.search.substr(1),w=u.split("&"),y={},E,A;for(A=0;A<w.length;A++){var F=w[A].split("=");y[F[0]]=F[1]}E=y.platform;if(E){return x.indexOf(E)!=-1}for(z=0,D=x.length;z<D;z++){switch(x[z]){case"phone":G=C(v);break;case"tablet":G=B(v);break;case"desktop":G=!C(v)&&!B(v);break;case"ios":G=/(iPad|iPhone|iPod)/.test(v);break;case"android":G=/(Android|Silk)/.test(v);break;case"blackberry":G=/(BlackBerry|BB)/.test(v);break;case"safari":G=/Safari/.test(v)&&!(/(BlackBerry|BB)/.test(v));break;case"chrome":G=/Chrome/.test(v);break;case"ie10":G=/MSIE 10/.test(v);break;case"windows":G=/MSIE 10/.test(v)||/Trident/.test(v);break;case"tizen":G=/Tizen/.test(v);break;case"firefox":G=/Firefox/.test(v)}if(G){return true}}return false}}for(o=0,s=r.length;o<s;o++){g=r[o];l=g.platform;k=g.exclude||[];delete g.platform;p=[].concat(g.theme);f=p.length;delete g.theme;if(l&&Ext.filterPlatform(l)&&!Ext.filterPlatform(k)){Ext.merge(m,g)}if(f){for(n=0;n<f;n++){if(Ext.theme.name==p[n]){Ext.merge(m,g)}}}}});b.registerPreprocessor("config",function(h,n){var k=n.config,q=h.prototype,m=q.config,p,g,o,f,j,l,r;delete n.config;for(g in k){if(k.hasOwnProperty(g)&&!(g in m)){r=k[g];p=this.getConfigNameMap(g);o=p.set;f=p.get;j=p.initGet;l=p.internal;n[j]=this.generateInitGetter(p);if(r===null&&!n.hasOwnProperty(l)){n[l]=null}if(!n.hasOwnProperty(f)){n[f]=this.generateGetter(p)}if(!n.hasOwnProperty(o)){n[o]=this.generateSetter(p)}}}h.addConfig(k,true)});b.registerPreprocessor("mixins",function(j,n,f){var g=n.mixins,k,h,l,m;delete n.mixins;Ext.Function.interceptBefore(f,"onCreated",function(){if(g instanceof Array){for(l=0,m=g.length;l<m;l++){h=g[l];k=h.prototype.mixinId||h.$className;j.mixin(k,h)}}else{for(k in g){if(g.hasOwnProperty(k)){j.mixin(k,g[k])}}}})});Ext.extend=function(h,j,g){if(arguments.length===2&&Ext.isObject(j)){g=j;j=h;h=null}var f;if(!j){throw new Error("[Ext.extend] Attempting to extend from a class which has not been loaded on the page.")}g.extend=j;g.preprocessors=["extend","statics","inheritableStatics","mixins","platformConfig","config"];if(h){f=new b(h,g)}else{f=new b(g)}f.prototype.override=function(l){for(var k in l){if(l.hasOwnProperty(k)){this[k]=l[k]}}};return f}})();(function(b,d,f,c,e){var a=Ext.ClassManager={classes:{},existCache:{},namespaceRewrites:[{from:"Ext.",to:Ext}],maps:{alternateToName:{},aliasToName:{},nameToAliases:{},nameToAlternates:{}},enableNamespaceParseCache:true,namespaceParseCache:{},instantiators:[],isCreated:function(l){var k=this.existCache,j,m,h,g,n;if(this.classes[l]||k[l]){return true}g=e;n=this.parseNamespace(l);for(j=0,m=n.length;j<m;j++){h=n[j];if(typeof h!="string"){g=h}else{if(!g||!g[h]){return false}g=g[h]}}k[l]=true;this.triggerCreated(l);return true},createdListeners:[],nameCreatedListeners:{},triggerCreated:function(q){var s=this.createdListeners,k=this.nameCreatedListeners,l=this.maps.nameToAlternates[q],r=[q],n,p,m,o,h,g;for(n=0,p=s.length;n<p;n++){h=s[n];h.fn.call(h.scope,q)}if(l){r.push.apply(r,l)}for(n=0,p=r.length;n<p;n++){g=r[n];s=k[g];if(s){for(m=0,o=s.length;m<o;m++){h=s[m];h.fn.call(h.scope,g)}delete k[g]}}},onCreated:function(l,k,j){var h=this.createdListeners,g=this.nameCreatedListeners,m={fn:l,scope:k};if(j){if(this.isCreated(j)){l.call(k,j);return}if(!g[j]){g[j]=[]}g[j].push(m)}else{h.push(m)}},parseNamespace:function(j){var g=this.namespaceParseCache;if(this.enableNamespaceParseCache){if(g.hasOwnProperty(j)){return g[j]}}var k=[],m=this.namespaceRewrites,o=e,h=j,r,q,p,l,n;for(l=0,n=m.length;l<n;l++){r=m[l];q=r.from;p=r.to;if(h===q||h.substring(0,q.length)===q){h=h.substring(q.length);if(typeof p!="string"){o=p}else{k=k.concat(p.split("."))}break}}k.push(o);k=k.concat(h.split("."));if(this.enableNamespaceParseCache){g[j]=k}return k},setNamespace:function(k,n){var h=e,o=this.parseNamespace(k),m=o.length-1,g=o[m],l,j;for(l=0;l<m;l++){j=o[l];if(typeof j!="string"){h=j}else{if(!h[j]){h[j]={}}h=h[j]}}h[g]=n;return h[g]},createNamespaces:function(){var g=e,n,k,l,h,m,o;for(l=0,m=arguments.length;l<m;l++){n=this.parseNamespace(arguments[l]);for(h=0,o=n.length;h<o;h++){k=n[h];if(typeof k!="string"){g=k}else{if(!g[k]){g[k]={}}g=g[k]}}}return g},set:function(g,l){var k=this,n=k.maps,m=n.nameToAlternates,j=k.getName(l),h;k.classes[g]=k.setNamespace(g,l);if(j&&j!==g){n.alternateToName[g]=j;h=m[j]||(m[j]=[]);h.push(g)}return this},get:function(j){var l=this.classes;if(l[j]){return l[j]}var g=e,n=this.parseNamespace(j),h,k,m;for(k=0,m=n.length;k<m;k++){h=n[k];if(typeof h!="string"){g=h}else{if(!g||!g[h]){return null}g=g[h]}}return g},setAlias:function(g,h){var k=this.maps.aliasToName,l=this.maps.nameToAliases,j;if(typeof g=="string"){j=g}else{j=this.getName(g)}if(h&&k[h]!==j){k[h]=j}if(!l[j]){l[j]=[]}if(h){Ext.Array.include(l[j],h)}return this},addNameAliasMappings:function(g){var m=this.maps.aliasToName,n=this.maps.nameToAliases,k,l,j,h;for(k in g){l=n[k]||(n[k]=[]);for(h=0;h<g[k].length;h++){j=g[k][h];if(!m[j]){m[j]=k;l.push(j)}}}return this},addNameAlternateMappings:function(k){var g=this.maps.alternateToName,n=this.maps.nameToAlternates,j,l,m,h;for(j in k){l=n[j]||(n[j]=[]);for(h=0;h<k[j].length;h++){m=k[j];if(!g[m]){g[m]=j;l.push(m)}}}return this},getByAlias:function(g){return this.get(this.getNameByAlias(g))},getNameByAlias:function(g){return this.maps.aliasToName[g]||""},getNameByAlternate:function(g){return this.maps.alternateToName[g]||""},getAliasesByName:function(g){return this.maps.nameToAliases[g]||[]},getName:function(g){return g&&g.$className||""},getClass:function(g){return g&&g.self||null},create:function(h,j,g){j.$className=h;return new b(j,function(){var m=j.postprocessors||a.defaultPostprocessors,t=a.postprocessors,q=0,u=[],s,k,n,r,l,p,o,v;delete j.postprocessors;for(n=0,r=m.length;n<r;n++){s=m[n];if(typeof s=="string"){s=t[s];o=s.properties;if(o===true){u.push(s.fn)}else{if(o){for(l=0,p=o.length;l<p;l++){v=o[l];if(j.hasOwnProperty(v)){u.push(s.fn);break}}}}}else{u.push(s)}}k=function(x,w,y){s=u[q++];if(!s){a.set(h,w);if(g){g.call(w,w)}a.triggerCreated(h);return}if(s.call(this,x,w,y,k)!==false){k.apply(this,arguments)}};k.call(a,h,this,j)})},createOverride:function(j,l,g){var k=l.override,h=Ext.Array.from(l.requires);delete l.override;delete l.requires;this.existCache[j]=true;Ext.require(h,function(){this.onCreated(function(){var m=this.get(k);if(m.singleton){m.self.override(l)}else{m.override(l)}if(g){g.call(m,m)}this.triggerCreated(j)},this,k)},this);return this},instantiateByAlias:function(){var h=arguments[0],g=f.call(arguments),j=this.getNameByAlias(h);if(!j){j=this.maps.aliasToName[h];Ext.syncRequire(j)}g[0]=j;return this.instantiate.apply(this,g)},instantiate:function(){var j=arguments[0],h=f.call(arguments,1),k=j,l,g;if(typeof j!="function"){g=this.get(j)}else{g=j}if(!g){l=this.getNameByAlias(j);if(l){j=l;g=this.get(j)}}if(!g){l=this.getNameByAlternate(j);if(l){j=l;g=this.get(j)}}if(!g){Ext.syncRequire(j);g=this.get(j)}return this.getInstantiator(h.length)(g,h)},dynInstantiate:function(h,g){g=c(g,true);g.unshift(h);return this.instantiate.apply(this,g)},getInstantiator:function(k){var j=this.instantiators,l;l=j[k];if(!l){var h=k,g=[];for(h=0;h<k;h++){g.push("a["+h+"]")}l=j[k]=new Function("c","a","return new c("+g.join(",")+")")}return l},postprocessors:{},defaultPostprocessors:[],registerPostprocessor:function(h,l,j,g,k){if(!g){g="last"}if(!j){j=[h]}this.postprocessors[h]={name:h,properties:j||false,fn:l};this.setDefaultPostprocessorPosition(h,g,k);return this},setDefaultPostprocessors:function(g){this.defaultPostprocessors=c(g);return this},setDefaultPostprocessorPosition:function(h,l,k){var j=this.defaultPostprocessors,g;if(typeof l=="string"){if(l==="first"){j.unshift(h);return this}else{if(l==="last"){j.push(h);return this}}l=(l==="after")?1:-1}g=Ext.Array.indexOf(j,k);if(g!==-1){Ext.Array.splice(j,Math.max(0,g+l),0,h)}return this},getNamesByExpression:function(o){var m=this.maps.nameToAliases,p=[],g,l,j,h,q,k,n;if(o.indexOf("*")!==-1){o=o.replace(/\*/g,"(.*?)");q=new RegExp("^"+o+"$");for(g in m){if(m.hasOwnProperty(g)){j=m[g];if(g.search(q)!==-1){p.push(g)}else{for(k=0,n=j.length;k<n;k++){l=j[k];if(l.search(q)!==-1){p.push(g);break}}}}}}else{h=this.getNameByAlias(o);if(h){p.push(h)}else{h=this.getNameByAlternate(o);if(h){p.push(h)}else{p.push(o)}}}return p}};a.registerPostprocessor("alias",function(j,h,m){var g=m.alias,k,l;for(k=0,l=g.length;k<l;k++){d=g[k];this.setAlias(h,d)}},["xtype","alias"]);a.registerPostprocessor("singleton",function(h,g,k,j){j.call(this,h,new g(),k);return false});a.registerPostprocessor("alternateClassName",function(h,g,m){var k=m.alternateClassName,j,l,n;if(!(k instanceof Array)){k=[k]}for(j=0,l=k.length;j<l;j++){n=k[j];this.set(n,g)}});Ext.apply(Ext,{create:d(a,"instantiate"),widget:function(h){var g=f.call(arguments);g[0]="widget."+h;return a.instantiateByAlias.apply(a,g)},createByAlias:d(a,"instantiateByAlias"),define:function(h,j,g){if("override" in j){return a.createOverride.apply(a,arguments)}return a.create.apply(a,arguments)},getClassName:d(a,"getName"),getDisplayName:function(g){if(g){if(g.displayName){return g.displayName}if(g.$name&&g.$class){return Ext.getClassName(g.$class)+"#"+g.$name}if(g.$className){return g.$className}}return"Anonymous"},getClass:d(a,"getClass"),namespace:d(a,"createNamespaces")});Ext.createWidget=Ext.widget;Ext.ns=Ext.namespace;b.registerPreprocessor("className",function(g,h){if(h.$className){g.$className=h.$className}},true,"first");b.registerPreprocessor("alias",function(s,m){var q=s.prototype,j=c(m.xtype),g=c(m.alias),t="widget.",r=t.length,n=Array.prototype.slice.call(q.xtypesChain||[]),k=Ext.merge({},q.xtypesMap||{}),l,p,o,h;for(l=0,p=g.length;l<p;l++){o=g[l];if(o.substring(0,r)===t){h=o.substring(r);Ext.Array.include(j,h)}}s.xtype=m.xtype=j[0];m.xtypes=j;for(l=0,p=j.length;l<p;l++){h=j[l];if(!k[h]){k[h]=true;n.push(h)}}m.xtypesChain=n;m.xtypesMap=k;Ext.Function.interceptAfter(m,"onClassCreated",function(){var u=q.mixins,w,v;for(w in u){if(u.hasOwnProperty(w)){v=u[w];j=v.xtypes;if(j){for(l=0,p=j.length;l<p;l++){h=j[l];if(!k[h]){k[h]=true;n.push(h)}}}}}});for(l=0,p=j.length;l<p;l++){h=j[l];Ext.Array.include(g,t+h)}m.alias=g},["xtype","alias"])})(Ext.Class,Ext.Function.alias,Array.prototype.slice,Ext.Array.from,Ext.global);(function(a,c,d,h,k,j,g,l){var e=["extend","mixins","requires"],b,f=0;b=Ext.Loader={isInHistory:{},history:[],config:{enabled:true,disableCaching:true,disableCachingParam:"_dc",paths:{Ext:"."}},setConfig:function(m,n){if(Ext.isObject(m)&&arguments.length===1){Ext.merge(this.config,m)}else{this.config[m]=(Ext.isObject(n))?Ext.merge(this.config[m],n):n}f+=1;return this},getConfig:function(m){if(m){return this.config[m]}return this.config},setPath:d(function(m,n){this.config.paths[m]=n;f+=1;return this}),addClassPathMappings:function(n){var m;if(f==0){b.config.paths=n}else{for(m in n){b.config.paths[m]=n[m]}}f++;return b},getPath:function(m){var o="",p=this.config.paths,n=this.getPrefix(m);if(n.length>0){if(n===m){return p[n]}o=p[n];m=m.substring(n.length+1)}if(o.length>0){o+="/"}return o.replace(/\/\.\//g,"/")+m.replace(/\./g,"/")+".js"},getPrefix:function(n){var p=this.config.paths,o,m="";if(p.hasOwnProperty(n)){return n}for(o in p){if(p.hasOwnProperty(o)&&o+"."===n.substring(0,o.length+1)){if(o.length>m.length){m=o}}}return m},require:function(o,n,m,p){if(n){n.call(m)}},syncRequire:function(){},exclude:function(n){var m=this;return{require:function(q,p,o){return m.require(q,p,o,n)},syncRequire:function(q,p,o){return m.syncRequire(q,p,o,n)}}},onReady:function(p,o,q,m){var n;if(q!==false&&Ext.onDocumentReady){n=p;p=function(){Ext.onDocumentReady(n,o,m)}}p.call(o)}};Ext.apply(b,{documentHead:typeof document!="undefined"&&(document.head||document.getElementsByTagName("head")[0]),isLoading:false,queue:[],isClassFileLoaded:{},isFileLoaded:{},readyListeners:[],optionalRequires:[],requiresMap:{},numPendingFiles:0,numLoadedFiles:0,hasFileLoadError:false,classNameToFilePathMap:{},syncModeEnabled:false,scriptElements:{},refreshQueue:function(){var m=this.queue,s=m.length,p,r,n,q,o;if(s===0){this.triggerReady();return}for(p=0;p<s;p++){r=m[p];if(r){q=r.requires;o=r.references;if(q.length>this.numLoadedFiles){continue}n=0;do{if(a.isCreated(q[n])){g(q,n,1)}else{n++}}while(n<q.length);if(r.requires.length===0){g(m,p,1);r.callback.call(r.scope);this.refreshQueue();break}}}return this},injectScriptElement:function(m,s,p,u,n){var t=document.createElement("script"),r=this,q=function(){r.cleanupScriptElement(t);s.call(u)},o=function(){r.cleanupScriptElement(t);p.call(u)};t.type="text/javascript";t.src=m;t.onload=q;t.onerror=o;t.onreadystatechange=function(){if(this.readyState==="loaded"||this.readyState==="complete"){q()}};if(n){t.charset=n}this.documentHead.appendChild(t);return t},removeScriptElement:function(n){var m=this.scriptElements;if(m[n]){this.cleanupScriptElement(m[n],true);delete m[n]}return this},cleanupScriptElement:function(n,m){n.onload=null;n.onreadystatechange=null;n.onerror=null;if(m){this.documentHead.removeChild(n)}return this},loadScriptFile:function(n,u,q,y,m){var t=this,z=this.isFileLoaded,o=this.scriptElements,x=n+(this.getConfig("disableCaching")?("?"+this.getConfig("disableCachingParam")+"="+Ext.Date.now()):""),w,p,s,v;if(z[n]){return this}y=y||this;this.isLoading=true;if(!m){v=function(){};if(!Ext.isReady&&Ext.onDocumentReady){Ext.onDocumentReady(function(){if(!z[n]){o[n]=t.injectScriptElement(x,u,v,y)}})}else{o[n]=this.injectScriptElement(x,u,v,y)}}else{if(typeof XMLHttpRequest!="undefined"){w=new XMLHttpRequest()}else{w=new ActiveXObject("Microsoft.XMLHTTP")}try{w.open("GET",x,false);w.send(null)}catch(r){}p=(w.status==1223)?204:w.status;s=w.responseText;if((p>=200&&p<300)||p==304||(p==0&&s.length>0)){Ext.globalEval(s+"\n//@ sourceURL="+n);u.call(y)}else{}w=null}},syncRequire:function(){var m=this.syncModeEnabled;if(!m){this.syncModeEnabled=true}this.require.apply(this,arguments);if(!m){this.syncModeEnabled=false}this.refreshQueue()},require:function(H,v,p,s){var x={},o={},A=this.queue,E=this.classNameToFilePathMap,C=this.isClassFileLoaded,u=[],J=[],G=[],n=[],t,I,z,y,m,r,F,D,B,w,q;if(s){s=j(s);for(D=0,w=s.length;D<w;D++){m=s[D];if(typeof m=="string"&&m.length>0){u=a.getNamesByExpression(m);for(B=0,q=u.length;B<q;B++){x[u[B]]=true}}}}H=j(H);if(v){if(v.length>0){t=function(){var M=[],L,N,K;for(L=0,N=n.length;L<N;L++){K=n[L];M.push(a.get(K))}return v.apply(this,M)}}else{t=v}}else{t=Ext.emptyFn}p=p||Ext.global;for(D=0,w=H.length;D<w;D++){y=H[D];if(typeof y=="string"&&y.length>0){J=a.getNamesByExpression(y);q=J.length;for(B=0;B<q;B++){F=J[B];if(x[F]!==true){n.push(F);if(!a.isCreated(F)&&!o[F]){o[F]=true;G.push(F)}}}}}if(G.length>0){if(!this.config.enabled){throw new Error("Ext.Loader is not enabled, so dependencies cannot be resolved dynamically. Missing required class"+((G.length>1)?"es":"")+": "+G.join(", "))}}else{t.call(p);return this}I=this.syncModeEnabled;if(!I){A.push({requires:G.slice(),callback:t,scope:p})}w=G.length;for(D=0;D<w;D++){r=G[D];z=this.getPath(r);if(I&&C.hasOwnProperty(r)){this.numPendingFiles--;this.removeScriptElement(z);delete C[r]}if(!C.hasOwnProperty(r)){C[r]=false;E[r]=z;this.numPendingFiles++;this.loadScriptFile(z,k(this.onFileLoaded,[r,z],this),k(this.onFileLoadError,[r,z]),this,I)}}if(I){t.call(p);if(w===1){return a.get(r)}}return this},onFileLoaded:function(n,m){this.numLoadedFiles++;this.isClassFileLoaded[n]=true;this.isFileLoaded[m]=true;this.numPendingFiles--;if(this.numPendingFiles===0){this.refreshQueue()}},onFileLoadError:function(o,n,m,p){this.numPendingFiles--;this.hasFileLoadError=true},addOptionalRequires:function(o){var q=this.optionalRequires,n,p,m;o=j(o);for(n=0,p=o.length;n<p;n++){m=o[n];l(q,m)}return this},triggerReady:function(n){var p=this.readyListeners,o=this.optionalRequires,m;if(this.isLoading||n){this.isLoading=false;if(o.length!==0){o=o.slice();this.optionalRequires.length=0;this.require(o,k(this.triggerReady,[true],this),this);return this}while(p.length){m=p.shift();m.fn.call(m.scope);if(this.isLoading){return this}}}return this},onReady:function(p,o,q,m){var n;if(q!==false&&Ext.onDocumentReady){n=p;p=function(){Ext.onDocumentReady(n,o,m)}}if(!this.isLoading){p.call(o)}else{this.readyListeners.push({fn:p,scope:o})}},historyPush:function(n){var m=this.isInHistory;if(n&&this.isClassFileLoaded.hasOwnProperty(n)&&!m[n]){m[n]=true;this.history.push(n)}return this}});Ext.require=h(b,"require");Ext.syncRequire=h(b,"syncRequire");Ext.exclude=h(b,"exclude");Ext.onReady=function(o,n,m){b.onReady(o,n,true,m)};c.registerPreprocessor("loader",function(z,o,y,x){var v=this,t=[],u=a.getName(z),p,n,s,r,w,q,m;for(p=0,s=e.length;p<s;p++){q=e[p];if(o.hasOwnProperty(q)){m=o[q];if(typeof m=="string"){t.push(m)}else{if(m instanceof Array){for(n=0,r=m.length;n<r;n++){w=m[n];if(typeof w=="string"){t.push(w)}}}else{if(typeof m!="function"){for(n in m){if(m.hasOwnProperty(n)){w=m[n];if(typeof w=="string"){t.push(w)}}}}}}}}if(t.length===0){return}b.require(t,function(){for(p=0,s=e.length;p<s;p++){q=e[p];if(o.hasOwnProperty(q)){m=o[q];if(typeof m=="string"){o[q]=a.get(m)}else{if(m instanceof Array){for(n=0,r=m.length;n<r;n++){w=m[n];if(typeof w=="string"){o[q][n]=a.get(w)}}}else{if(typeof m!="function"){for(var A in m){if(m.hasOwnProperty(A)){w=m[A];if(typeof w=="string"){o[q][A]=a.get(w)}}}}}}}}x.call(v,z,o,y)});return false},true,"after","className");a.registerPostprocessor("uses",function(p,n,t){var m=j(t.uses),o=[],q,s,r;for(q=0,s=m.length;q<s;q++){r=m[q];if(typeof r=="string"){o.push(r)}}b.addOptionalRequires(o)});a.onCreated(function(m){this.historyPush(m)},b)})(Ext.ClassManager,Ext.Class,Ext.Function.flexSetter,Ext.Function.alias,Ext.Function.pass,Ext.Array.from,Ext.Array.erase,Ext.Array.include);(function(){var a=document.getElementsByTagName("script"),b=a[a.length-1],d=b.src,c=d.substring(0,d.lastIndexOf("/")+1),e=Ext.Loader;e.setConfig({enabled:true,disableCaching:!/[?&](cache|breakpoint)/i.test(location.search),paths:{Ext:c+"src"}})})();Ext.setVersion("touch","2.4.0.487");Ext.apply(Ext,{version:Ext.getVersion("touch"),idSeed:0,repaint:function(){var a=Ext.getBody().createChild({cls:"x-mask x-mask-transparent"});setTimeout(function(){a.destroy()},0)},id:function(a,b){if(a&&a.id){return a.id}a=Ext.getDom(a)||{};if(a===document||a===document.documentElement){a.id="ext-app"}else{if(a===document.body){a.id="ext-body"}else{if(a===window){a.id="ext-window"}}}a.id=a.id||((b||"ext-")+(++Ext.idSeed));return a.id},getBody:function(){if(!Ext.documentBodyElement){if(!document.body){throw new Error("[Ext.getBody] document.body does not exist at this point")}Ext.documentBodyElement=Ext.get(document.body)}return Ext.documentBodyElement},getHead:function(){if(!Ext.documentHeadElement){Ext.documentHeadElement=Ext.get(document.head||document.getElementsByTagName("head")[0])}return Ext.documentHeadElement},getDoc:function(){if(!Ext.documentElement){Ext.documentElement=Ext.get(document)}return Ext.documentElement},getCmp:function(a){return Ext.ComponentMgr.get(a)},copyTo:function(a,b,d,c){if(typeof d=="string"){d=d.split(/[,;\s]/)}Ext.each(d,function(e){if(c||b.hasOwnProperty(e)){a[e]=b[e]}},this);return a},destroy:function(){var a=arguments,d=a.length,b,c;for(b=0;b<d;b++){c=a[b];if(c){if(Ext.isArray(c)){this.destroy.apply(this,c)}else{if(Ext.isFunction(c.destroy)){c.destroy()}}}}},getDom:function(a){if(!a||!document){return null}return a.dom?a.dom:(typeof a=="string"?document.getElementById(a):a)},removeNode:function(a){if(a&&a.parentNode&&a.tagName!="BODY"){Ext.get(a).clearListeners();a.parentNode.removeChild(a);delete Ext.cache[a.id]}},defaultSetupConfig:{eventPublishers:{dom:{xclass:"Ext.event.publisher.Dom"},touchGesture:{xclass:"Ext.event.publisher.TouchGesture",recognizers:{drag:{xclass:"Ext.event.recognizer.Drag"},tap:{xclass:"Ext.event.recognizer.Tap"},doubleTap:{xclass:"Ext.event.recognizer.DoubleTap"},longPress:{xclass:"Ext.event.recognizer.LongPress"},swipe:{xclass:"Ext.event.recognizer.Swipe"},pinch:{xclass:"Ext.event.recognizer.Pinch"},rotate:{xclass:"Ext.event.recognizer.Rotate"},edgeSwipe:{xclass:"Ext.event.recognizer.EdgeSwipe"}}},componentDelegation:{xclass:"Ext.event.publisher.ComponentDelegation"},componentPaint:{xclass:"Ext.event.publisher.ComponentPaint"},elementPaint:{xclass:"Ext.event.publisher.ElementPaint"},elementSize:{xclass:"Ext.event.publisher.ElementSize"}},logger:{enabled:true,xclass:"Ext.log.Logger",minPriority:"deprecate",writers:{console:{xclass:"Ext.log.writer.Console",throwOnErrors:true,formatter:{xclass:"Ext.log.formatter.Default"}}}},animator:{xclass:"Ext.fx.Runner"},viewport:{xclass:"Ext.viewport.Viewport"}},isSetup:false,frameStartTime:+new Date(),setupListeners:[],onSetup:function(b,a){if(Ext.isSetup){b.call(a)}else{Ext.setupListeners.push({fn:b,scope:a})}},setup:function(t){var l=Ext.defaultSetupConfig,n=Ext.emptyFn,b=t.onReady||n,f=t.onUpdated||n,a=t.scope,d=Ext.Array.from(t.requires),m=Ext.onReady,h=Ext.getHead(),g,r,j;Ext.setup=function(){throw new Error("Ext.setup has already been called before")};delete t.requires;delete t.onReady;delete t.onUpdated;delete t.scope;g=function(){var w=Ext.setupListeners,x=w.length,v,y;delete Ext.setupListeners;Ext.isSetup=true;for(v=0;v<x;v++){y=w[v];y.fn.call(y.scope)}Ext.onReady=m;Ext.onReady(b,a)};Ext.onUpdated=f;Ext.onReady=function(x,w){var v=b;b=function(){v();Ext.onReady(x,w)}};t=Ext.merge({},l,t);Ext.onDocumentReady(function(){Ext.factoryConfig(t,function(w){Ext.event.Dispatcher.getInstance().setPublishers(w.eventPublishers);if(w.logger){Ext.Logger=w.logger}if(w.animator){Ext.Animator=w.animator}if(w.viewport){Ext.Viewport=r=w.viewport;if(!a){a=r}Ext.require(d,function(){Ext.Viewport.on("ready",g,null,{single:true})})}else{Ext.require(d,g)}});if(!Ext.microloaded&&navigator.userAgent.match(/IEMobile\/10\.0/)){var v=document.createElement("style");v.appendChild(document.createTextNode("@media screen and (orientation: portrait) {@-ms-viewport {width: 320px !important;}}@media screen and (orientation: landscape) {@-ms-viewport {width: 560px !important;}}"));h.appendChild(v)}});function k(v,w){var x=document.createElement("meta");x.setAttribute("name",v);x.setAttribute("content",w);h.append(x)}function o(v,x,y){var w=document.createElement("link");w.setAttribute("rel","apple-touch-icon"+(y?"-precomposed":""));w.setAttribute("href",v);if(x){w.setAttribute("sizes",x)}h.append(w)}function e(v,x){var w=document.createElement("link");w.setAttribute("rel","apple-touch-startup-image");w.setAttribute("href",v);if(x){w.setAttribute("media",x)}h.append(w)}var q=t.icon,u=Boolean(t.isIconPrecomposed),s=t.startupImage||{},c=t.statusBarStyle||"black",p=window.devicePixelRatio||1;if(navigator.standalone){k("viewport","width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0")}else{k("viewport","initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, minimum-ui")}k("apple-mobile-web-app-capable","yes");k("apple-touch-fullscreen","yes");if(Ext.browser.is.ie){k("msapplication-tap-highlight","no")}if(c){k("apple-mobile-web-app-status-bar-style",c)}if(Ext.isString(q)){q={57:q,72:q,114:q,144:q}}else{if(!q){q={}}}if(Ext.os.is.iPad){if(p>=2){if("1496x2048" in s){e(s["1496x2048"],"(orientation: landscape)")}if("1536x2008" in s){e(s["1536x2008"],"(orientation: portrait)")}if("144" in q){o(q["144"],"144x144",u)}}else{if("748x1024" in s){e(s["748x1024"],"(orientation: landscape)")}if("768x1004" in s){e(s["768x1004"],"(orientation: portrait)")}if("72" in q){o(q["72"],"72x72",u)}}}else{if(p>=2&&Ext.os.version.gtEq("4.3")){if(Ext.os.is.iPhone5){e(s["640x1096"])}else{e(s["640x920"])}if("114" in q){o(q["114"],"114x114",u)}}else{e(s["320x460"]);if("57" in q){o(q["57"],null,u)}}}},application:function(b){var a=b.name,e,d,c;if(!b){b={}}if(!Ext.Loader.config.paths[a]){Ext.Loader.setPath(a,b.appFolder||"app")}c=Ext.Array.from(b.requires);b.requires=["Ext.app.Application"];e=b.onReady;d=b.scope;b.onReady=function(){b.requires=c;new Ext.app.Application(b);if(e){e.call(d)}};Ext.setup(b)},factoryConfig:function(a,l){var g=Ext.isSimpleObject(a);if(g&&a.xclass){var f=a.xclass;delete a.xclass;Ext.require(f,function(){Ext.factoryConfig(a,function(n){l(Ext.create(f,n))})});return}var d=Ext.isArray(a),m=[],k,j,c,e;if(g||d){if(g){for(k in a){if(a.hasOwnProperty(k)){j=a[k];if(Ext.isSimpleObject(j)||Ext.isArray(j)){m.push(k)}}}}else{for(c=0,e=a.length;c<e;c++){j=a[c];if(Ext.isSimpleObject(j)||Ext.isArray(j)){m.push(c)}}}c=0;e=m.length;if(e===0){l(a);return}function h(n){a[k]=n;c++;b()}function b(){if(c>=e){l(a);return}k=m[c];j=a[k];Ext.factoryConfig(j,h)}b();return}l(a)},factory:function(b,e,a,f){var d=Ext.ClassManager,c;if(!b||b.isInstance){if(a&&a!==b){a.destroy()}return b}if(f){if(typeof b=="string"){return d.instantiateByAlias(f+"."+b)}else{if(Ext.isObject(b)&&"type" in b){return d.instantiateByAlias(f+"."+b.type,b)}}}if(b===true){return a||d.instantiate(e)}if("xtype" in b){c=d.instantiateByAlias("widget."+b.xtype,b)}else{if("xclass" in b){c=d.instantiate(b.xclass,b)}}if(c){if(a){a.destroy()}return c}if(a){return a.setConfig(b)}return d.instantiate(e,b)},deprecateClassMember:function(b,c,a,d){return this.deprecateProperty(b.prototype,c,a,d)},deprecateClassMembers:function(b,c){var d=b.prototype,e,a;for(e in c){if(c.hasOwnProperty(e)){a=c[e];this.deprecateProperty(d,e,a)}}},deprecateProperty:function(b,c,a,d){if(!d){d="'"+c+"' is deprecated"}if(a){d+=", please use '"+a+"' instead"}if(a){Ext.Object.defineProperty(b,c,{get:function(){return this[a]},set:function(e){this[a]=e},configurable:true})}},deprecatePropertyValue:function(b,a,d,c){Ext.Object.defineProperty(b,a,{get:function(){return d},configurable:true})},deprecateMethod:function(b,a,d,c){b[a]=function(){if(d){return d.apply(this,arguments)}}},deprecateClassMethod:function(a,b,h,d){if(typeof b!="string"){var g,f;for(g in b){if(b.hasOwnProperty(g)){f=b[g];Ext.deprecateClassMethod(a,g,f)}}return}var c=typeof h=="string",e;if(!d){d="'"+b+"()' is deprecated, please use '"+(c?h:h.name)+"()' instead"}if(c){e=function(){return this[h].apply(this,arguments)}}else{e=function(){return h.apply(this,arguments)}}if(b in a.prototype){Ext.Object.defineProperty(a.prototype,b,{value:null,writable:true,configurable:true})}a.addMember(b,e)},isReady:false,readyListeners:[],triggerReady:function(){var b=Ext.readyListeners,a,c,d;if(!Ext.isReady){Ext.isReady=true;for(a=0,c=b.length;a<c;a++){d=b[a];d.fn.call(d.scope)}delete Ext.readyListeners}},onDocumentReady:function(d,c){if(Ext.isReady){d.call(c)}else{var b=Ext.triggerReady;Ext.readyListeners.push({fn:d,scope:c});if((Ext.browser.is.WebWorks||Ext.browser.is.PhoneGap)&&!Ext.os.is.Desktop){if(!Ext.readyListenerAttached){Ext.readyListenerAttached=true;document.addEventListener(Ext.browser.is.PhoneGap?"deviceready":"webworksready",b,false)}}else{var a=(/MSIE 10/.test(navigator.userAgent))?/interactive|complete|loading|loaded/:/interactive|complete|loaded/;if(document.readyState.match(a)!==null){b()}else{if(!Ext.readyListenerAttached){Ext.readyListenerAttached=true;window.addEventListener("DOMContentLoaded",function(){if(navigator.standalone){setTimeout(function(){setTimeout(function(){b()},1)},1)}else{setTimeout(function(){b()},1)}},false)}}}}},callback:function(d,c,b,a){if(Ext.isFunction(d)){b=b||[];c=c||window;if(a){Ext.defer(d,a,c,b)}else{d.apply(c,b)}}}});(Ext.cmd.derive("Ext.env.Browser",Ext.Base,{statics:{browserNames:{ie:"IE",firefox:"Firefox",safari:"Safari",chrome:"Chrome",opera:"Opera",dolfin:"Dolfin",webosbrowser:"webOSBrowser",chromeMobile:"ChromeMobile",chromeiOS:"ChromeiOS",silk:"Silk",other:"Other"},engineNames:{webkit:"WebKit",gecko:"Gecko",presto:"Presto",trident:"Trident",other:"Other"},enginePrefixes:{webkit:"AppleWebKit/",gecko:"Gecko/",presto:"Presto/",trident:"Trident/"},browserPrefixes:{ie:"MSIE ",firefox:"Firefox/",chrome:"Chrome/",safari:"Version/",opera:"OPR/",dolfin:"Dolfin/",webosbrowser:"wOSBrowser/",chromeMobile:"CrMo/",chromeiOS:"CriOS/",silk:"Silk/"}},styleDashPrefixes:{WebKit:"-webkit-",Gecko:"-moz-",Trident:"-ms-",Presto:"-o-",Other:""},stylePrefixes:{WebKit:"Webkit",Gecko:"Moz",Trident:"ms",Presto:"O",Other:""},propertyPrefixes:{WebKit:"webkit",Gecko:"moz",Trident:"ms",Presto:"o",Other:""},is:Ext.emptyFn,name:null,version:null,engineName:null,engineVersion:null,setFlag:function(a,b){if(typeof b=="undefined"){b=true}this.is[a]=b;this.is[a.toLowerCase()]=b;return this},constructor:function(p){this.userAgent=p;var l=this.statics(),c=p.match(new RegExp("((?:"+Ext.Object.getValues(l.browserPrefixes).join(")|(?:")+"))([\\w\\._]+)")),b=p.match(new RegExp("((?:"+Ext.Object.getValues(l.enginePrefixes).join(")|(?:")+"))([\\w\\._]+)")),g=l.browserNames,k=g.other,f=l.engineNames,o=f.other,n="",m="",h=false,e,d,a;e=this.is=function(q){return e[q]===true};if(c){k=g[Ext.Object.getKey(l.browserPrefixes,c[1])];n=new Ext.Version(c[2])}if(b){o=f[Ext.Object.getKey(l.enginePrefixes,b[1])];m=new Ext.Version(b[2])}if(o=="Trident"&&k!="IE"){k="IE";var j=p.match(/.*rv:(\d+.\d+)/);if(j&&j.length){j=j[1];n=new Ext.Version(j)}}if(p.match(/FB/)&&k=="Other"){k=g.safari;o=f.webkit}if(p.match(/Android.*Chrome/g)){k="ChromeMobile"}if(p.match(/OPR/)){k="Opera";c=p.match(/OPR\/(\d+.\d+)/);n=new Ext.Version(c[1])}if(k==="Safari"&&p.match(/BB10/)){k="BlackBerry"}Ext.apply(this,{engineName:o,engineVersion:m,name:k,version:n});this.setFlag(k);if(n){this.setFlag(k+(n.getMajor()||""));this.setFlag(k+n.getShortVersion())}for(d in g){if(g.hasOwnProperty(d)){a=g[d];this.setFlag(a,k===a)}}this.setFlag(a);if(m){this.setFlag(o+(m.getMajor()||""));this.setFlag(o+m.getShortVersion())}for(d in f){if(f.hasOwnProperty(d)){a=f[d];this.setFlag(a,o===a)}}this.setFlag("Standalone",!!navigator.standalone);this.setFlag("Ripple",!!document.getElementById("tinyhippos-injected")&&!Ext.isEmpty(window.top.ripple));this.setFlag("WebWorks",!!window.blackberry);if(typeof window.PhoneGap!="undefined"||typeof window.Cordova!="undefined"||typeof window.cordova!="undefined"){h=true;this.setFlag("PhoneGap");this.setFlag("Cordova")}else{if(!!window.isNK){h=true;this.setFlag("Sencha")}}if(/(Glass)/i.test(p)){this.setFlag("GoogleGlass")}if(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)(?!.*FBAN)/i.test(p)){h=true}this.setFlag("WebView",h);this.isStrict=document.compatMode=="CSS1Compat";this.isSecure=/^https/i.test(window.location.protocol);return this},getStyleDashPrefix:function(){return this.styleDashPrefixes[this.engineName]},getStylePrefix:function(){return this.stylePrefixes[this.engineName]},getVendorProperyName:function(a){var b=this.propertyPrefixes[this.engineName];if(b.length>0){return b+Ext.String.capitalize(a)}return a},getPreferredTranslationMethod:function(a){if(typeof a=="object"&&"translationMethod" in a&&a.translationMethod!=="auto"){return a.translationMethod}else{if(this.is.AndroidStock2||this.is.IE){return"scrollposition"}else{return"csstransform"}}}},1,0,0,0,0,0,[Ext.env,"Browser"],function(){var a=Ext.browser=new this(Ext.global.navigator.userAgent)}));(Ext.cmd.derive("Ext.env.OS",Ext.Base,{statics:{names:{ios:"iOS",android:"Android",windowsPhone:"WindowsPhone",webos:"webOS",blackberry:"BlackBerry",rimTablet:"RIMTablet",mac:"MacOS",win:"Windows",tizen:"Tizen",linux:"Linux",bada:"Bada",chrome:"ChromeOS",other:"Other"},prefixes:{tizen:"(Tizen )",ios:"i(?:Pad|Phone|Pod)(?:.*)CPU(?: iPhone)? OS ",android:"(Android |HTC_|Silk/)",windowsPhone:"Windows Phone ",blackberry:"(?:BlackBerry|BB)(?:.*)Version/",rimTablet:"RIM Tablet OS ",webos:"(?:webOS|hpwOS)/",bada:"Bada/",chrome:"CrOS "}},is:Ext.emptyFn,name:null,version:null,setFlag:function(a,b){if(typeof b=="undefined"){b=true}this.is[a]=b;this.is[a.toLowerCase()]=b;return this},constructor:function(o,b,k){var l=this.statics(),j=l.names,d=l.prefixes,a,h="",c,g,f,n,e,m;k=k||Ext.browser;e=this.is=function(p){return this.is[p]===true};for(c in d){if(d.hasOwnProperty(c)){g=d[c];f=o.match(new RegExp("(?:"+g+")([^\\s;]+)"));if(f){a=j[c];m=f[1];if(m&&m=="HTC_"){h=new Ext.Version("2.3")}else{if(m&&m=="Silk/"){h=new Ext.Version("2.3")}else{h=new Ext.Version(f[f.length-1])}}break}}}if(!a){a=j[(o.toLowerCase().match(/mac|win|linux/)||["other"])[0]];h=new Ext.Version("")}this.name=a;this.version=h;if(b){this.setFlag(b.replace(/ simulator$/i,""))}this.setFlag(a);if(h){this.setFlag(a+(h.getMajor()||""));this.setFlag(a+h.getShortVersion())}for(c in j){if(j.hasOwnProperty(c)){n=j[c];if(!e.hasOwnProperty(a)){this.setFlag(n,(a===n))}}}if(this.name=="iOS"&&window.screen.height==568){this.setFlag("iPhone5")}if(k.is.Safari||k.is.Silk){if(this.is.Android2||this.is.Android3||k.version.shortVersion==501){k.setFlag("AndroidStock");k.setFlag("AndroidStock2")}if(this.is.Android4){k.setFlag("AndroidStock");k.setFlag("AndroidStock4")}}return this}},1,0,0,0,0,0,[Ext.env,"OS"],function(){var a=Ext.global.navigator,e=a.userAgent,b,g,d;Ext.os=b=new this(e,a.platform);g=b.name;var c=window.location.search.match(/deviceType=(Tablet|Phone)/),f=window.deviceType;if(c&&c[1]){d=c[1]}else{if(f==="iPhone"){d="Phone"}else{if(f==="iPad"){d="Tablet"}else{if(!b.is.Android&&!b.is.iOS&&!b.is.WindowsPhone&&/Windows|Linux|MacOS/.test(g)){d="Desktop";Ext.browser.is.WebView=Ext.browser.is.Ripple?true:false}else{if(b.is.iPad||b.is.RIMTablet||b.is.Android3||Ext.browser.is.Silk||(b.is.Android4&&e.search(/mobile/i)==-1)){d="Tablet"}else{d="Phone"}}}}}b.setFlag(d,true);b.deviceType=d}));(Ext.cmd.derive("Ext.env.Feature",Ext.Base,{constructor:function(){this.testElements={};this.has=function(a){return !!this.has[a]};if(!Ext.theme){Ext.theme={name:"Default"}}Ext.theme.is={};Ext.theme.is[Ext.theme.name]=true;Ext.onDocumentReady(function(){this.registerTest({ProperHBoxStretching:function(){var b=document.createElement("div"),c=b.appendChild(document.createElement("div")),d=c.appendChild(document.createElement("div")),a;b.setAttribute("style","width: 100px; height: 100px; position: relative;");c.setAttribute("style","position: absolute; display: -ms-flexbox; display: -webkit-flex; display: -moz-flexbox; display: flex; -ms-flex-direction: row; -webkit-flex-direction: row; -moz-flex-direction: row; flex-direction: row; min-width: 100%;");d.setAttribute("style","width: 200px; height: 50px;");document.body.appendChild(b);a=c.offsetWidth;document.body.removeChild(b);return(a>100)}})},this)},getTestElement:function(a,b){if(a===undefined){a="div"}else{if(typeof a!=="string"){return a}}if(b){return document.createElement(a)}if(!this.testElements[a]){this.testElements[a]=document.createElement(a)}return this.testElements[a]},isStyleSupported:function(c,b){var d=this.getTestElement(b).style,a=Ext.String.capitalize(c);if(typeof d[c]!=="undefined"||typeof d[Ext.browser.getStylePrefix(c)+a]!=="undefined"){return true}return false},isStyleSupportedWithoutPrefix:function(b,a){var c=this.getTestElement(a).style;if(typeof c[b]!=="undefined"){return true}return false},isEventSupported:function(c,a){if(a===undefined){a=window}var e=this.getTestElement(a),b="on"+c.toLowerCase(),d=(b in e);if(!d){if(e.setAttribute&&e.removeAttribute){e.setAttribute(b,"");d=typeof e[b]==="function";if(typeof e[b]!=="undefined"){e[b]=undefined}e.removeAttribute(b)}}return d},getSupportedPropertyName:function(b,a){var c=Ext.browser.getVendorProperyName(a);if(c in b){return c}else{if(a in b){return a}}return null},registerTest:Ext.Function.flexSetter(function(a,b){this.has[a]=b.call(this);return this})},1,0,0,0,0,0,[Ext.env,"Feature"],function(){Ext.feature=new this();var a=Ext.feature.has;Ext.feature.registerTest({Canvas:function(){var b=this.getTestElement("canvas");return !!(b&&b.getContext&&b.getContext("2d"))},Svg:function(){var b=document;return !!(b.createElementNS&&!!b.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)},Vml:function(){var c=this.getTestElement(),b=false;c.innerHTML="<!--[if vml]><br><![endif]-->";b=(c.childNodes.length===1);c.innerHTML="";return b},Touch:function(){return Ext.browser.is.Ripple||(this.isEventSupported("touchstart")&&!(Ext.os&&Ext.os.name.match(/Windows|MacOS|Linux/)&&!Ext.os.is.BlackBerry6))},Pointer:function(){if(typeof window.navigator.msPointerEnabled==="undefined"){return !!window.navigator.pointerEnabled}else{return !!window.navigator.msPointerEnabled}},Orientation:function(){return("orientation" in window)&&this.isEventSupported("orientationchange")},OrientationChange:function(){return this.isEventSupported("orientationchange")},DeviceMotion:function(){return this.isEventSupported("devicemotion")},Geolocation:function(){return"geolocation" in window.navigator},SqlDatabase:function(){return"openDatabase" in window},WebSockets:function(){return"WebSocket" in window},Range:function(){return !!document.createRange},CreateContextualFragment:function(){var b=!!document.createRange?document.createRange():false;return b&&!!b.createContextualFragment},History:function(){return("history" in window&&"pushState" in window.history)},CssTransforms:function(){return this.isStyleSupported("transform")},CssTransformNoPrefix:function(){if(!Ext.browser.is.AndroidStock){return this.isStyleSupportedWithoutPrefix("transform")}else{return this.isStyleSupportedWithoutPrefix("transform")&&!this.isStyleSupportedWithoutPrefix("-webkit-transform")}},Css3dTransforms:function(){return this.has("CssTransforms")&&this.isStyleSupported("perspective")&&!Ext.browser.is.AndroidStock2},CssAnimations:function(){return this.isStyleSupported("animationName")},CssTransitions:function(){return this.isStyleSupported("transitionProperty")},Audio:function(){return !!this.getTestElement("audio").canPlayType},Video:function(){return !!this.getTestElement("video").canPlayType},ClassList:function(){return"classList" in this.getTestElement()},LocalStorage:function(){var b=false;try{if("localStorage" in window&&window.localStorage!==null){localStorage.setItem("sencha-localstorage-test","test success");localStorage.removeItem("sencha-localstorage-test");b=true}}catch(c){}return b},XHR2:function(){return window.ProgressEvent&&window.FormData&&window.XMLHttpRequest&&("withCredentials" in new XMLHttpRequest())},XHRUploadProgress:function(){if(window.XMLHttpRequest&&!Ext.browser.is.AndroidStock){var b=new XMLHttpRequest();return b&&("upload" in b)&&("onprogress" in b.upload)}return false},NumericInputPlaceHolder:function(){return !(Ext.browser.is.AndroidStock4&&Ext.os.version.getMinor()<2)}})}));(Ext.cmd.derive("Ext.dom.Query",Ext.Base,{select:function(h,b){var g=[],d,f,e,c,a;b=b||document;if(typeof b=="string"){b=document.getElementById(b)}h=h.split(",");for(f=0,c=h.length;f<c;f++){if(typeof h[f]=="string"){if(h[f][0]=="@"){d=b.getAttributeNode(h[f].substring(1));g.push(d)}else{d=b.querySelectorAll(h[f]);for(e=0,a=d.length;e<a;e++){g.push(d[e])}}}}return g},selectNode:function(b,a){return this.select(b,a)[0]},is:function(c,f){var a,e,b,d;if(typeof c=="string"){c=document.getElementById(c)}if(Ext.isArray(c)){e=true;d=c.length;for(b=0;b<d;b++){if(!this.is(c[b],f)){e=false;break}}}else{a=c.parentNode;if(!a){a=document.createDocumentFragment();a.appendChild(c);e=this.select(f,a).indexOf(c)!==-1;a.removeChild(c);a=null}else{e=this.select(f,a).indexOf(c)!==-1}}return e},isXml:function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":false}},0,0,0,0,0,0,[Ext.dom,"Query"],function(){Ext.ns("Ext.core");Ext.core.DomQuery=Ext.DomQuery=new this();Ext.query=Ext.Function.alias(Ext.DomQuery,"select")}));(Ext.cmd.derive("Ext.dom.Helper",Ext.Base,{emptyTags:/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,confRe:/tag|children|cn|html|tpl|tplData$/i,endRe:/end/i,attribXlat:{cls:"class",htmlFor:"for"},closeTags:{},decamelizeName:function(){var c=/([a-z])([A-Z])/g,b={};function a(d,f,e){return f+"-"+e.toLowerCase()}return function(d){return b[d]||(b[d]=d.replace(c,a))}}(),generateMarkup:function(d,c){var g=this,b,h,a,e,f;if(typeof d=="string"){c.push(d)}else{if(Ext.isArray(d)){for(e=0;e<d.length;e++){if(d[e]){g.generateMarkup(d[e],c)}}}else{a=d.tag||"div";c.push("<",a);for(b in d){if(d.hasOwnProperty(b)){h=d[b];if(!g.confRe.test(b)){if(typeof h=="object"){c.push(" ",b,'="');g.generateStyles(h,c).push('"')}else{c.push(" ",g.attribXlat[b]||b,'="',h,'"')}}}}if(g.emptyTags.test(a)){c.push("/>")}else{c.push(">");if((h=d.tpl)){h.applyOut(d.tplData,c)}if((h=d.html)){c.push(h)}if((h=d.cn||d.children)){g.generateMarkup(h,c)}f=g.closeTags;c.push(f[a]||(f[a]="</"+a+">"))}}}return c},generateStyles:function(e,c){var b=c||[],d;for(d in e){if(e.hasOwnProperty(d)){b.push(this.decamelizeName(d),":",e[d],";")}}return c||b.join("")},markup:function(a){if(typeof a=="string"){return a}var b=this.generateMarkup(a,[]);return b.join("")},applyStyles:function(a,b){Ext.fly(a).applyStyles(b)},createContextualFragment:function(c){var f=document.createElement("div"),a=document.createDocumentFragment(),b=0,d,e;f.innerHTML=c;e=f.childNodes;d=e.length;for(;b<d;b++){a.appendChild(e[b].cloneNode(true))}return a},insertHtml:function(d,a,f){var k,g,l,c,b,h;d=d.toLowerCase();if(Ext.isTextNode(a)){if(d=="afterbegin"){d="beforebegin"}else{if(d=="beforeend"){d="afterend"}}}b=d=="beforebegin";h=d=="afterbegin";g=Ext.feature.has.CreateContextualFragment?a.ownerDocument.createRange():undefined;k="setStart"+(this.endRe.test(d)?"After":"Before");if(b||d=="afterend"){if(g){g[k](a);l=g.createContextualFragment(f)}else{l=this.createContextualFragment(f)}a.parentNode.insertBefore(l,b?a:a.nextSibling);return a[(b?"previous":"next")+"Sibling"]}else{c=(h?"first":"last")+"Child";if(a.firstChild){if(g){try{g[k](a[c]);l=g.createContextualFragment(f)}catch(j){l=this.createContextualFragment(f)}}else{l=this.createContextualFragment(f)}if(h){a.insertBefore(l,a.firstChild)}else{a.appendChild(l)}}else{a.innerHTML=f}return a[c]}},insertBefore:function(a,c,b){return this.doInsert(a,c,b,"beforebegin")},insertAfter:function(a,c,b){return this.doInsert(a,c,b,"afterend")},insertFirst:function(a,c,b){return this.doInsert(a,c,b,"afterbegin")},append:function(a,c,b){return this.doInsert(a,c,b,"beforeend")},overwrite:function(a,c,b){a=Ext.getDom(a);a.innerHTML=this.markup(c);return b?Ext.get(a.firstChild):a.firstChild},doInsert:function(b,d,c,e){var a=this.insertHtml(e,Ext.getDom(b),this.markup(d));return c?Ext.get(a,true):a},createTemplate:function(b){var a=this.markup(b);return new Ext.Template(a)}},0,0,0,0,0,0,[Ext.dom,"Helper"],function(){Ext.ns("Ext.core");Ext.core.DomHelper=Ext.DomHelper=new this()}));(Ext.cmd.derive("Ext.mixin.Identifiable",Ext.Base,{statics:{uniqueIds:{}},isIdentifiable:true,mixinId:"identifiable",idCleanRegex:/\.|[^\w\-]/g,defaultIdPrefix:"ext-",defaultIdSeparator:"-",getOptimizedId:function(){return this.id},getUniqueId:function(){var f=this.id,b,d,e,a,c;if(!f){b=this.self.prototype;d=this.defaultIdSeparator;a=Ext.mixin.Identifiable.uniqueIds;if(!b.hasOwnProperty("identifiablePrefix")){e=this.xtype;if(e){c=this.defaultIdPrefix+e+d}else{c=b.$className.replace(this.idCleanRegex,d).toLowerCase()+d}b.identifiablePrefix=c}c=this.identifiablePrefix;if(!a.hasOwnProperty(c)){a[c]=0}f=this.id=c+(++a[c])}this.getUniqueId=this.getOptimizedId;return f},setId:function(a){this.id=a},getId:function(){var a=this.id;if(!a){a=this.getUniqueId()}this.getId=this.getOptimizedId;return a}},0,0,0,0,0,0,[Ext.mixin,"Identifiable"],0));(Ext.cmd.derive("Ext.dom.Element",Ext.Base,{alternateClassName:"Ext.Element",observableType:"element",statics:{CREATE_ATTRIBUTES:{style:"style",className:"className",cls:"cls",classList:"classList",text:"text",hidden:"hidden",html:"html",children:"children"},create:function(c,b){var f=this.CREATE_ATTRIBUTES,e,h,k,j,a,d,g;if(!c){c={}}if(c.isElement){return c.dom}else{if("nodeType" in c){return c}}if(typeof c=="string"){return document.createTextNode(c)}k=c.tag;if(!k){k="div"}if(c.namespace){e=document.createElementNS(c.namespace,k)}else{e=document.createElement(k)}h=e.style;for(a in c){if(a!="tag"){j=c[a];switch(a){case f.style:if(typeof j=="string"){e.setAttribute(a,j)}else{for(d in j){if(j.hasOwnProperty(d)){h[d]=j[d]}}}break;case f.className:case f.cls:e.className=j;break;case f.classList:e.className=j.join(" ");break;case f.text:e.textContent=j;break;case f.hidden:if(j){e.style.display="none"}break;case f.html:e.innerHTML=j;break;case f.children:for(d=0,g=j.length;d<g;d++){e.appendChild(this.create(j[d],true))}break;default:e.setAttribute(a,j)}}}if(b){return e}else{return this.get(e)}},documentElement:null,cache:{},get:function(c){var b=this.cache,a,d,e;if(!c){return null}if(typeof c=="string"){d=document.getElementById(c);if(b.hasOwnProperty(c)){a=b[c]}if(d){if(a){a.dom=d}else{a=b[c]=new this(d)}}else{if(!a){a=null}}return a}if("tagName" in c){e=c.id;if(b.hasOwnProperty(e)){a=b[e];a.dom=c;return a}else{a=new this(c);b[a.getId()]=a}return a}if(c.isElement){return c}if(c.isComposite){return c}if(Ext.isArray(c)){return this.select(c)}if(c===document){if(!this.documentElement){this.documentElement=new this(document.documentElement);this.documentElement.setId("ext-application")}return this.documentElement}return null},data:function(c,b,e){var a=Ext.cache,f,d;c=this.get(c);if(!c){return null}f=c.id;d=a[f].data;if(!d){a[f].data=d={}}if(arguments.length==2){return d[b]}else{return(d[b]=e)}},serializeForm:function(c){var d=c.elements||(document.forms[c]||Ext.getDom(c)).elements,p=false,n=encodeURIComponent,h="",g=d.length,j,a,m,r,q,k,f,l,b;for(k=0;k<g;k++){j=d[k];a=j.name;m=j.type;r=j.options;if(!j.disabled&&a){if(/select-(one|multiple)/i.test(m)){l=r.length;for(f=0;f<l;f++){b=r[f];if(b.selected){q=b.hasAttribute?b.hasAttribute("value"):b.getAttributeNode("value").specified;h+=Ext.String.format("{0}={1}&",n(a),n(q?b.value:b.text))}}}else{if(!(/file|undefined|reset|button/i.test(m))){if(!(/radio|checkbox/i.test(m)&&!j.checked)&&!(m=="submit"&&p)){h+=n(a)+"="+n(j.value)+"&";p=/submit/i.test(m)}}}}}return h.substr(0,h.length-1)},serializeNode:function(d){var b="",c,f,a,e;if(d.nodeType===document.TEXT_NODE){return d.nodeValue}b+="<"+d.nodeName;if(d.attributes.length){for(c=0,f=d.attributes.length;c<f;c++){a=d.attributes[c];b+=" "+a.name+'="'+a.value+'"'}}b+=">";if(d.childNodes&&d.childNodes.length){for(c=0,f=d.childNodes.length;c<f;c++){e=d.childNodes[c];b+=this.serializeNode(e)}}b+="</"+d.nodeName+">";return b}},isElement:true,constructor:function(a){if(typeof a=="string"){a=document.getElementById(a)}if(!a){throw new Error("Invalid domNode reference or an id of an existing domNode: "+a)}this.dom=a;this.getUniqueId()},attach:function(a){this.dom=a;this.id=a.id;return this},getUniqueId:function(){var b=this.id,a;if(!b){a=this.dom;if(a.id.length>0){this.id=b=a.id}else{a.id=b=this.mixins.identifiable.getUniqueId.call(this)}Ext.Element.cache[b]=this}return b},setId:function(c){var a=this.id,b=Ext.Element.cache;if(a){delete b[a]}this.dom.id=c;this.id=c;b[c]=this;return this},setHtml:function(a){this.dom.innerHTML=a},getHtml:function(){return this.dom.innerHTML},setText:function(a){this.dom.textContent=a},redraw:function(){var b=this.dom,a=b.style;a.display="none";b.offsetHeight;a.display=""},isPainted:(function(){return !Ext.browser.is.IE?function(){var a=this.dom;return Boolean(a&&a.offsetParent)}:function(){var a=this.dom;return Boolean(a&&(a.offsetHeight!==0&&a.offsetWidth!==0))}})(),set:function(a,b){var e=this.dom,c,d;for(c in a){if(a.hasOwnProperty(c)){d=a[c];if(c=="style"){this.applyStyles(d)}else{if(c=="cls"){e.className=d}else{if(b!==false){if(d===undefined){e.removeAttribute(c)}else{e.setAttribute(c,d)}}else{e[c]=d}}}}}return this},is:function(a){return Ext.DomQuery.is(this.dom,a)},getValue:function(b){var a=this.dom.value;return b?parseInt(a,10):a},getAttribute:function(a,b){var c=this.dom;return c.getAttributeNS(b,a)||c.getAttribute(b+":"+a)||c.getAttribute(a)||c[a]},setSizeState:function(d){var c=["x-sized","x-unsized","x-stretched"],a=[true,false,null],b=a.indexOf(d),e;if(b!==-1){e=c[b];c.splice(b,1);this.addCls(e)}this.removeCls(c);return this},destroy:function(){this.isDestroyed=true;var a=Ext.Element.cache,b=this.dom;if(b&&b.parentNode&&b.tagName!="BODY"){b.parentNode.removeChild(b)}delete a[this.id];delete this.dom}},1,["element"],["element"],{element:true},["widget.element"],[[Ext.mixin.Identifiable.prototype.mixinId||Ext.mixin.Identifiable.$className,Ext.mixin.Identifiable]],[Ext.dom,"Element",Ext,"Element"],function(a){Ext.elements=Ext.cache=a.cache;this.addStatics({Fly:new Ext.Class({extend:a,constructor:function(b){this.dom=b}}),_flyweights:{},fly:function(e,c){var f=null,d=a._flyweights,b;c=c||"_global";e=Ext.getDom(e);if(e){f=d[c]||(d[c]=new a.Fly());f.dom=e;f.isSynchronized=false;b=Ext.cache[e.id];if(b&&b.isElement){b.isSynchronized=false}}return f}});Ext.get=function(b){return a.get(b)};Ext.fly=function(){return a.fly.apply(a,arguments)};Ext.ClassManager.onCreated(function(){a.mixin("observable",Ext.mixin.Observable)},null,"Ext.mixin.Observable")}));Ext.dom.Element.addStatics({numberRe:/\d+$/,unitRe:/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,camelRe:/(-[a-z])/gi,cssRe:/([a-z0-9-]+)\s*:\s*([^;\s]+(?:\s*[^;\s]+)*);?/gi,opacityRe:/alpha\(opacity=(.*)\)/i,propertyCache:{},defaultUnit:"px",borders:{l:"border-left-width",r:"border-right-width",t:"border-top-width",b:"border-bottom-width"},paddings:{l:"padding-left",r:"padding-right",t:"padding-top",b:"padding-bottom"},margins:{l:"margin-left",r:"margin-right",t:"margin-top",b:"margin-bottom"},addUnits:function(b,a){if(b===""||b=="auto"||b===undefined||b===null){return b||""}if(Ext.isNumber(b)||this.numberRe.test(b)){return b+(a||this.defaultUnit||"px")}else{if(!this.unitRe.test(b)){return b||""}}return b},isAncestor:function(b,d){var a=false;b=Ext.getDom(b);d=Ext.getDom(d);if(b&&d){if(b.contains){return b.contains(d)}else{if(b.compareDocumentPosition){return !!(b.compareDocumentPosition(d)&16)}else{while((d=d.parentNode)){a=d==b||a}}}}return a},parseBox:function(b){if(typeof b!="string"){b=b.toString()}var c=b.split(" "),a=c.length;if(a==1){c[1]=c[2]=c[3]=c[0]}else{if(a==2){c[2]=c[0];c[3]=c[1]}else{if(a==3){c[3]=c[1]}}}return{top:c[0]||0,right:c[1]||0,bottom:c[2]||0,left:c[3]||0}},unitizeBox:function(c,a){var b=this;c=b.parseBox(c);return b.addUnits(c.top,a)+" "+b.addUnits(c.right,a)+" "+b.addUnits(c.bottom,a)+" "+b.addUnits(c.left,a)},camelReplaceFn:function(b,c){return c.charAt(1).toUpperCase()},normalize:function(a){return this.propertyCache[a]||(this.propertyCache[a]=a.replace(this.camelRe,this.camelReplaceFn))},fromPoint:function(a,b){return Ext.get(document.elementFromPoint(a,b))},parseStyles:function(c){var a={},b=this.cssRe,d;if(c){b.lastIndex=0;while((d=b.exec(c))){a[d[1]]=d[2]}}return a}});Ext.dom.Element.addMembers({appendChild:function(a){this.dom.appendChild(Ext.getDom(a));return this},removeChild:function(a){this.dom.removeChild(Ext.getDom(a));return this},append:function(){this.appendChild.apply(this,arguments)},appendTo:function(a){Ext.getDom(a).appendChild(this.dom);return this},insertBefore:function(a){a=Ext.getDom(a);a.parentNode.insertBefore(this.dom,a);return this},insertAfter:function(a){a=Ext.getDom(a);a.parentNode.insertBefore(this.dom,a.nextSibling);return this},insertFirst:function(b){var a=Ext.getDom(b),d=this.dom,c=d.firstChild;if(!c){d.appendChild(a)}else{d.insertBefore(a,c)}return this},insertSibling:function(e,c,d){var f=this,b,a=(c||"before").toLowerCase()=="after",g;if(Ext.isArray(e)){g=f;Ext.each(e,function(h){b=Ext.fly(g,"_internal").insertSibling(h,c,d);if(a){g=b}});return b}e=e||{};if(e.nodeType||e.dom){b=f.dom.parentNode.insertBefore(Ext.getDom(e),a?f.dom.nextSibling:f.dom);if(!d){b=Ext.get(b)}}else{if(a&&!f.dom.nextSibling){b=Ext.core.DomHelper.append(f.dom.parentNode,e,!d)}else{b=Ext.core.DomHelper[a?"insertAfter":"insertBefore"](f.dom,e,!d)}}return b},replace:function(a){a=Ext.getDom(a);a.parentNode.replaceChild(this.dom,a);return this},replaceWith:function(a){var b=this;if(a.nodeType||a.dom||typeof a=="string"){a=Ext.get(a);b.dom.parentNode.insertBefore(a.dom,b.dom)}else{a=Ext.core.DomHelper.insertBefore(b.dom,a)}delete Ext.cache[b.id];Ext.removeNode(b.dom);b.id=Ext.id(b.dom=a);return b},doReplaceWith:function(a){var b=this.dom;b.parentNode.replaceChild(Ext.getDom(a),b)},createChild:function(b,a,c){b=b||{tag:"div"};if(a){return Ext.core.DomHelper.insertBefore(a,b,c!==true)}else{return Ext.core.DomHelper[!this.dom.firstChild?"insertFirst":"append"](this.dom,b,c!==true)}},wrap:function(b,c){var e=this.dom,f=this.self.create(b,c),d=(c)?f:f.dom,a=e.parentNode;if(a){a.insertBefore(d,e)}d.appendChild(e);return f},wrapAllChildren:function(a){var d=this.dom,b=d.childNodes,e=this.self.create(a),c=e.dom;while(b.length>0){c.appendChild(d.firstChild)}d.appendChild(c);return e},unwrapAllChildren:function(){var c=this.dom,b=c.childNodes,a=c.parentNode;if(a){while(b.length>0){a.insertBefore(c,c.firstChild)}this.destroy()}},unwrap:function(){var c=this.dom,a=c.parentNode,b;if(a){b=a.parentNode;b.insertBefore(c,a);b.removeChild(a)}else{b=document.createDocumentFragment();b.appendChild(c)}return this},detach:function(){var a=this.dom;if(a&&a.parentNode&&a.tagName!=="BODY"){a.parentNode.removeChild(a)}return this},insertHtml:function(b,c,a){var d=Ext.core.DomHelper.insertHtml(b,this.dom,c);return a?Ext.get(d):d}});Ext.dom.Element.override({getX:function(){return this.getXY()[0]},getY:function(){return this.getXY()[1]},getXY:function(){var b=this.dom.getBoundingClientRect(),a=Math.round;return[a(b.left+window.pageXOffset),a(b.top+window.pageYOffset)]},getOffsetsTo:function(a){var c=this.getXY(),b=Ext.fly(a,"_internal").getXY();return[c[0]-b[0],c[1]-b[1]]},setX:function(a){return this.setXY([a,this.getY()])},setY:function(a){return this.setXY([this.getX(),a])},setXY:function(d){var b=this;if(arguments.length>1){d=[d,arguments[1]]}var c=b.translatePoints(d),a=b.dom.style;for(d in c){if(!c.hasOwnProperty(d)){continue}if(!isNaN(c[d])){a[d]=c[d]+"px"}}return b},getLeft:function(){return parseInt(this.getStyle("left"),10)||0},getRight:function(){return parseInt(this.getStyle("right"),10)||0},getTop:function(){return parseInt(this.getStyle("top"),10)||0},getBottom:function(){return parseInt(this.getStyle("bottom"),10)||0},translatePoints:function(a,g){g=isNaN(a[1])?g:a[1];a=isNaN(a[0])?a:a[0];var d=this,e=d.isStyle("position","relative"),f=d.getXY(),b=parseInt(d.getStyle("left"),10),c=parseInt(d.getStyle("top"),10);b=!isNaN(b)?b:(e?0:d.dom.offsetLeft);c=!isNaN(c)?c:(e?0:d.dom.offsetTop);return{left:(a-f[0]+b),top:(g-f[1]+c)}},setBox:function(d){var c=this,b=d.width,a=d.height,f=d.top,e=d.left;if(e!==undefined){c.setLeft(e)}if(f!==undefined){c.setTop(f)}if(b!==undefined){c.setWidth(b)}if(a!==undefined){c.setHeight(a)}return this},getBox:function(g,k){var h=this,e=h.dom,c=e.offsetWidth,m=e.offsetHeight,o,f,d,a,n,j;if(!k){o=h.getXY()}else{if(g){o=[0,0]}else{o=[parseInt(h.getStyle("left"),10)||0,parseInt(h.getStyle("top"),10)||0]}}if(!g){f={x:o[0],y:o[1],0:o[0],1:o[1],width:c,height:m}}else{d=h.getBorderWidth.call(h,"l")+h.getPadding.call(h,"l");a=h.getBorderWidth.call(h,"r")+h.getPadding.call(h,"r");n=h.getBorderWidth.call(h,"t")+h.getPadding.call(h,"t");j=h.getBorderWidth.call(h,"b")+h.getPadding.call(h,"b");f={x:o[0]+d,y:o[1]+n,0:o[0]+d,1:o[1]+n,width:c-(d+a),height:m-(n+j)}}f.left=f.x;f.top=f.y;f.right=f.x+f.width;f.bottom=f.y+f.height;return f},getPageBox:function(e){var g=this,c=g.dom;if(!c){return new Ext.util.Region()}var k=c.offsetWidth,f=c.offsetHeight,n=g.getXY(),m=n[1],a=n[0]+k,j=n[1]+f,d=n[0];if(e){return new Ext.util.Region(m,a,j,d)}else{return{left:d,top:m,width:k,height:f,right:a,bottom:j}}}});Ext.dom.Element.addMembers({WIDTH:"width",HEIGHT:"height",MIN_WIDTH:"min-width",MIN_HEIGHT:"min-height",MAX_WIDTH:"max-width",MAX_HEIGHT:"max-height",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left",VISIBILITY:1,DISPLAY:2,OFFSETS:3,SEPARATOR:"-",trimRe:/^\s+|\s+$/g,wordsRe:/\w/g,spacesRe:/\s+/,styleSplitRe:/\s*(?::|;)\s*/,transparentRe:/^(?:transparent|(?:rgba[(](?:\s*\d+\s*[,]){3}\s*0\s*[)]))$/i,classNameSplitRegex:/[\s]+/,borders:{t:"border-top-width",r:"border-right-width",b:"border-bottom-width",l:"border-left-width"},paddings:{t:"padding-top",r:"padding-right",b:"padding-bottom",l:"padding-left"},margins:{t:"margin-top",r:"margin-right",b:"margin-bottom",l:"margin-left"},defaultUnit:"px",isSynchronized:false,synchronize:function(){var g=this.dom,a={},d=g.className,f,c,e,b;if(d.length>0){f=g.className.split(this.classNameSplitRegex);for(c=0,e=f.length;c<e;c++){b=f[c];a[b]=true}}else{f=[]}this.classList=f;this.hasClassMap=a;this.isSynchronized=true;return this},addCls:function(j,g,k){if(!j){return this}if(!this.isSynchronized){this.synchronize()}var e=this.dom,c=this.hasClassMap,d=this.classList,a=this.SEPARATOR,f,h,b;g=g?g+a:"";k=k?a+k:"";if(typeof j=="string"){j=j.split(this.spacesRe)}for(f=0,h=j.length;f<h;f++){b=g+j[f]+k;if(!c[b]){c[b]=true;d.push(b)}}e.className=d.join(" ");return this},removeCls:function(j,g,k){if(!j){return this}if(!this.isSynchronized){this.synchronize()}if(!k){k=""}var e=this.dom,c=this.hasClassMap,d=this.classList,a=this.SEPARATOR,f,h,b;g=g?g+a:"";k=k?a+k:"";if(typeof j=="string"){j=j.split(this.spacesRe)}for(f=0,h=j.length;f<h;f++){b=g+j[f]+k;if(c[b]){delete c[b];Ext.Array.remove(d,b)}}e.className=d.join(" ");return this},replaceCls:function(d,k,h,l){if(!d&&!k){return this}d=d||[];k=k||[];if(!this.isSynchronized){this.synchronize()}if(!l){l=""}var f=this.dom,c=this.hasClassMap,e=this.classList,a=this.SEPARATOR,g,j,b;h=h?h+a:"";l=l?a+l:"";if(typeof d=="string"){d=d.split(this.spacesRe)}if(typeof k=="string"){k=k.split(this.spacesRe)}for(g=0,j=d.length;g<j;g++){b=h+d[g]+l;if(c[b]){delete c[b];Ext.Array.remove(e,b)}}for(g=0,j=k.length;g<j;g++){b=h+k[g]+l;if(!c[b]){c[b]=true;e.push(b)}}f.className=e.join(" ");return this},hasCls:function(a){if(!this.isSynchronized){this.synchronize()}return this.hasClassMap.hasOwnProperty(a)},setCls:function(c){var e=this.hasClassMap,b,d,a;if(typeof c=="string"){c=c.split(this.spacesRe)}for(b=0,d=c.length;b<d;b++){a=c[b];if(!e[a]){e[a]=true}}this.classList=c.slice();this.dom.className=c.join(" ")},toggleCls:function(a,b){if(typeof b!=="boolean"){b=!this.hasCls(a)}return(b)?this.addCls(a):this.removeCls(a)},swapCls:function(b,f,a,d){if(a===undefined){a=true}var e=a?b:f,c=a?f:b;if(c){this.removeCls(d?d+"-"+c:c)}if(e){this.addCls(d?d+"-"+e:e)}return this},setWidth:function(a){return this.setLengthValue(this.WIDTH,a)},setHeight:function(a){return this.setLengthValue(this.HEIGHT,a)},setSize:function(b,a){if(Ext.isObject(b)){a=b.height;b=b.width}this.setWidth(b);this.setHeight(a);return this},setMinWidth:function(a){return this.setLengthValue(this.MIN_WIDTH,a)},setMinHeight:function(a){return this.setLengthValue(this.MIN_HEIGHT,a)},setMaxWidth:function(a){return this.setLengthValue(this.MAX_WIDTH,a)},setMaxHeight:function(a){return this.setLengthValue(this.MAX_HEIGHT,a)},setTop:function(a){return this.setLengthValue(this.TOP,a)},setRight:function(a){return this.setLengthValue(this.RIGHT,a)},setBottom:function(a){return this.setLengthValue(this.BOTTOM,a)},setLeft:function(a){return this.setLengthValue(this.LEFT,a)},setMargin:function(b){var a=this.dom.style;if(b||b===0){b=this.self.unitizeBox((b===true)?5:b);a.setProperty("margin",b,"important")}else{a.removeProperty("margin-top");a.removeProperty("margin-right");a.removeProperty("margin-bottom");a.removeProperty("margin-left")}},setPadding:function(b){var a=this.dom.style;if(b||b===0){b=this.self.unitizeBox((b===true)?5:b);a.setProperty("padding",b,"important")}else{a.removeProperty("padding-top");a.removeProperty("padding-right");a.removeProperty("padding-bottom");a.removeProperty("padding-left")}},setBorder:function(a){var b=this.dom.style;if(a||a===0){a=this.self.unitizeBox((a===true)?1:a);b.setProperty("border-width",a,"important")}else{b.removeProperty("border-top-width");b.removeProperty("border-right-width");b.removeProperty("border-bottom-width");b.removeProperty("border-left-width")}},setLengthValue:function(a,c){var b=this.dom.style;if(c===null){b.removeProperty(a);return this}if(typeof c=="number"){c=c+"px"}b.setProperty(a,c,"important");return this},setVisible:function(b){var a=this.getVisibilityMode(),c=b?"removeCls":"addCls";switch(a){case this.VISIBILITY:this.removeCls(["x-hidden-display","x-hidden-offsets"]);this[c]("x-hidden-visibility");break;case this.DISPLAY:this.removeCls(["x-hidden-visibility","x-hidden-offsets"]);this[c]("x-hidden-display");break;case this.OFFSETS:this.removeCls(["x-hidden-visibility","x-hidden-display"]);this[c]("x-hidden-offsets");break}return this},getVisibilityMode:function(){var b=this.dom,a=Ext.dom.Element.data(b,"visibilityMode");if(a===undefined){Ext.dom.Element.data(b,"visibilityMode",a=this.DISPLAY)}return a},setVisibilityMode:function(a){this.self.data(this.dom,"visibilityMode",a);return this},show:function(){var a=this.dom;if(a){a.style.removeProperty("display")}},hide:function(){this.dom.style.setProperty("display","none","important")},setVisibility:function(a){var b=this.dom.style;if(a){b.removeProperty("visibility")}else{b.setProperty("visibility","hidden","important")}},styleHooks:{},addStyles:function(h,g){var b=0,f=h.match(this.wordsRe),e=0,a=f.length,d,c;for(;e<a;e++){d=f[e];c=d&&parseInt(this.getStyle(g[d]),10);if(c){b+=Math.abs(c)}}return b},isStyle:function(a,b){return this.getStyle(a)==b},getStyleValue:function(a){return this.dom.style.getPropertyValue(a)},getStyle:function(f){var c=this,e=c.dom,d=c.styleHooks[f],b,a;if(e==document){return null}if(!d){c.styleHooks[f]=d={name:Ext.dom.Element.normalize(f)}}if(d.get){return d.get(e,c)}b=window.getComputedStyle(e,"");a=(b&&b[d.name]);return a},setStyle:function(a,h){var f=this,d=f.dom,j=f.styleHooks,b=d.style,e=Ext.valueFrom,c,g;if(typeof a=="string"){g=j[a];if(!g){j[a]=g={name:Ext.dom.Element.normalize(a)}}h=e(h,"");if(g.set){g.set(d,h,f)}else{b[g.name]=h}}else{for(c in a){if(a.hasOwnProperty(c)){g=j[c];if(!g){j[c]=g={name:Ext.dom.Element.normalize(c)}}h=e(a[c],"");if(g.set){g.set(d,h,f)}else{b[g.name]=h}}}}return f},getHeight:function(b){var c=this.dom,a=b?(c.clientHeight-this.getPadding("tb")):c.offsetHeight;return a>0?a:0},getWidth:function(a){var c=this.dom,b=a?(c.clientWidth-this.getPadding("lr")):c.offsetWidth;return b>0?b:0},getBorderWidth:function(a){return this.addStyles(a,this.borders)},getPadding:function(a){return this.addStyles(a,this.paddings)},applyStyles:function(d){if(d){var e=this.dom,c,b,a;if(typeof d=="function"){d=d.call()}c=typeof d;if(c=="string"){d=Ext.util.Format.trim(d).split(this.styleSplitRe);for(b=0,a=d.length;b<a;){e.style[Ext.dom.Element.normalize(d[b++])]=d[b++]}}else{if(c=="object"){this.setStyle(d)}}}return this},getSize:function(b){var a=this.dom;return{width:Math.max(0,b?(a.clientWidth-this.getPadding("lr")):a.offsetWidth),height:Math.max(0,b?(a.clientHeight-this.getPadding("tb")):a.offsetHeight)}},repaint:function(){var a=this.dom;this.addCls("x-repaint");setTimeout(function(){Ext.fly(a).removeCls("x-repaint")},1);return this},getMargin:function(b){var c=this,d={t:"top",l:"left",r:"right",b:"bottom"},e={},a;if(!b){for(a in c.margins){e[d[a]]=parseFloat(c.getStyle(c.margins[a]))||0}return e}else{return c.addStyles.call(c,b,c.margins)}},translate:function(){var a="webkitTransform" in document.createElement("div").style?"webkitTransform":"transform";return function(b,d,c){this.dom.style[a]="translate3d("+(b||0)+"px, "+(d||0)+"px, "+(c||0)+"px)"}}()});Ext.dom.Element.addMembers({getParent:function(){return Ext.get(this.dom.parentNode)},getFirstChild:function(){return Ext.get(this.dom.firstElementChild)},contains:function(a){if(!a){return false}var b=Ext.getDom(a);return(b===this.dom)||this.self.isAncestor(this.dom,b)},findParent:function(h,g,c){var e=this.dom,a=document.body,f=0,d;g=g||50;if(isNaN(g)){d=Ext.getDom(g);g=Number.MAX_VALUE}while(e&&e.nodeType==1&&f<g&&e!=a&&e!=d){if(Ext.DomQuery.is(e,h)){return c?Ext.get(e):e}f++;e=e.parentNode}return null},findParentNode:function(d,c,a){var b=Ext.fly(this.dom.parentNode,"_internal");return b?b.findParent(d,c,a):null},up:function(b,a){return this.findParentNode(b,a,true)},select:function(a,b){return Ext.dom.Element.select(a,b,this.dom)},query:function(a){return Ext.DomQuery.select(a,this.dom)},down:function(a,b){var c=Ext.DomQuery.selectNode(a,this.dom);return b?c:Ext.get(c)},child:function(a,b){var d,c=this,e;e=Ext.get(c).id;e=e.replace(/[\.:]/g,"\\$0");d=Ext.DomQuery.selectNode("#"+e+" > "+a,c.dom);return b?d:Ext.get(d)},parent:function(a,b){return this.matchNode("parentNode","parentNode",a,b)},next:function(a,b){return this.matchNode("nextSibling","nextSibling",a,b)},prev:function(a,b){return this.matchNode("previousSibling","previousSibling",a,b)},first:function(a,b){return this.matchNode("nextSibling","firstChild",a,b)},last:function(a,b){return this.matchNode("previousSibling","lastChild",a,b)},matchNode:function(b,e,a,c){if(!this.dom){return null}var d=this.dom[e];while(d){if(d.nodeType==1&&(!a||Ext.DomQuery.is(d,a))){return !c?Ext.get(d):d}d=d[b]}return null},isAncestor:function(a){return this.self.isAncestor.call(this.self,this.dom,a)}});(Ext.cmd.derive("Ext.dom.CompositeElementLite",Ext.Base,{alternateClassName:["Ext.CompositeElementLite","Ext.CompositeElement"],statics:{importElementMethods:function(){}},constructor:function(b,a){this.elements=[];this.add(b,a);this.el=new Ext.dom.Element.Fly()},isComposite:true,getElement:function(a){return this.el.attach(a).synchronize()},transformElement:function(a){return Ext.getDom(a)},getCount:function(){return this.elements.length},add:function(c,a){var e=this.elements,b,d;if(!c){return this}if(typeof c=="string"){c=Ext.dom.Element.selectorFunction(c,a)}else{if(c.isComposite){c=c.elements}else{if(!Ext.isIterable(c)){c=[c]}}}for(b=0,d=c.length;b<d;++b){e.push(this.transformElement(c[b]))}return this},invoke:function(d,a){var f=this.elements,e=f.length,c,b;for(b=0;b<e;b++){c=f[b];if(c){Ext.dom.Element.prototype[d].apply(this.getElement(c),a)}}return this},item:function(b){var c=this.elements[b],a=null;if(c){a=this.getElement(c)}return a},addListener:function(b,h,g,f){var d=this.elements,a=d.length,c,j;for(c=0;c<a;c++){j=d[c];if(j){j.on(b,h,g||j,f)}}return this},each:function(f,d){var g=this,c=g.elements,a=c.length,b,h;for(b=0;b<a;b++){h=c[b];if(h){h=this.getElement(h);if(f.call(d||h,h,g,b)===false){break}}}return g},fill:function(a){var b=this;b.elements=[];b.add(a);return b},filter:function(a){var b=[],d=this,c=Ext.isFunction(a)?a:function(e){return e.is(a)};d.each(function(g,e,f){if(c(g,f)!==false){b[b.length]=d.transformElement(g)}});d.elements=b;return d},indexOf:function(a){return Ext.Array.indexOf(this.elements,this.transformElement(a))},replaceElement:function(e,c,a){var b=!isNaN(e)?e:this.indexOf(e),f;if(b>-1){c=Ext.getDom(c);if(a){f=this.elements[b];f.parentNode.insertBefore(c,f);Ext.removeNode(f)}Ext.Array.splice(this.elements,b,1,c)}return this},clear:function(){this.elements=[]},addElements:function(c,a){if(!c){return this}if(typeof c=="string"){c=Ext.dom.Element.selectorFunction(c,a)}var b=this.elements;Ext.each(c,function(d){b.push(Ext.get(d))});return this},first:function(){return this.item(0)},last:function(){return this.item(this.getCount()-1)},contains:function(a){return this.indexOf(a)!=-1},removeElement:function(c,e){var b=this,d=this.elements,a;Ext.each(c,function(f){if((a=(d[f]||d[f=b.indexOf(f)]))){if(e){if(a.dom){a.remove()}else{Ext.removeNode(a)}}Ext.Array.erase(d,f,1)}});return this}},1,0,0,0,0,0,[Ext.dom,"CompositeElementLite",Ext,"CompositeElementLite",Ext,"CompositeElement"],function(){var a=Ext.dom.Element,d=a.prototype,c=this.prototype,b;for(b in d){if(typeof d[b]=="function"){(function(e){if(e==="destroy"){c[e]=function(){return this.invoke(e,arguments)}}else{c[e]=c[e]||function(){return this.invoke(e,arguments)}}}).call(c,b)}}c.on=c.addListener;a.selectorFunction=Ext.DomQuery.select;Ext.dom.Element.select=function(e,h,f){var g;if(typeof e=="string"){g=Ext.dom.Element.selectorFunction(e,f)}else{if(e.length!==undefined){g=e}else{}}return(h===true)?new Ext.dom.CompositeElement(g):new Ext.dom.CompositeElementLite(g)};Ext.select=function(){return a.select.apply(a,arguments)}}));(Ext.cmd.derive("Ext.event.ListenerStack",Ext.Base,{currentOrder:"current",length:0,constructor:function(){this.listeners={before:[],current:[],after:[]};this.lateBindingMap={};return this},add:function(h,j,k,e){var a=this.lateBindingMap,g=this.getAll(e),f=g.length,b,d,c;if(typeof h=="string"&&j.isIdentifiable){c=j.getId();b=a[c];if(b){if(b[h]){return false}else{b[h]=true}}else{a[c]=b={};b[h]=true}}else{if(f>0){while(f--){d=g[f];if(d.fn===h&&d.scope===j){d.options=k;return false}}}}d=this.create(h,j,k,e);if(k&&k.prepend){delete k.prepend;g.unshift(d)}else{g.push(d)}this.length++;return true},getAt:function(b,a){return this.getAll(a)[b]},getAll:function(a){if(!a){a=this.currentOrder}return this.listeners[a]},count:function(a){return this.getAll(a).length},create:function(d,c,b,a){return{stack:this,fn:d,firingFn:false,boundFn:false,isLateBinding:typeof d=="string",scope:c,options:b||{},order:a}},remove:function(h,j,e){var g=this.getAll(e),f=g.length,b=false,a=this.lateBindingMap,d,c;if(f>0){while(f--){d=g[f];if(d.fn===h&&d.scope===j){g.splice(f,1);b=true;this.length--;if(typeof h=="string"&&j.isIdentifiable){c=j.getId();if(a[c]&&a[c][h]){delete a[c][h]}}break}}}return b}},1,0,0,0,0,0,[Ext.event,"ListenerStack"],0));(Ext.cmd.derive("Ext.event.Controller",Ext.Base,{isFiring:false,listenerStack:null,constructor:function(a){this.firingListeners=[];this.firingArguments=[];this.setInfo(a);return this},setInfo:function(a){this.info=a},getInfo:function(){return this.info},setListenerStacks:function(a){this.listenerStacks=a},fire:function(h,e){var n=this.listenerStacks,m=this.firingListeners,d=this.firingArguments,k=m.push,g=n.length,j,l,c,o,a=false,b=false,f;m.length=0;if(e){if(e.order!=="after"){a=true}else{b=true}}if(g===1){j=n[0].listeners;l=j.before;c=j.current;o=j.after;if(l.length>0){k.apply(m,l)}if(a){k.call(m,e)}if(c.length>0){k.apply(m,c)}if(b){k.call(m,e)}if(o.length>0){k.apply(m,o)}}else{for(f=0;f<g;f++){l=n[f].listeners.before;if(l.length>0){k.apply(m,l)}}if(a){k.call(m,e)}for(f=0;f<g;f++){c=n[f].listeners.current;if(c.length>0){k.apply(m,c)}}if(b){k.call(m,e)}for(f=0;f<g;f++){o=n[f].listeners.after;if(o.length>0){k.apply(m,o)}}}if(m.length===0){return this}if(!h){h=[]}d.length=0;d.push.apply(d,h);d.push(null,this);this.doFire();return this},doFire:function(){var k=this.firingListeners,c=this.firingArguments,g=c.length-2,d,f,b,o,h,n,a,j,l,e,m;this.isPausing=false;this.isPaused=false;this.isStopped=false;this.isFiring=true;for(d=0,f=k.length;d<f;d++){b=k[d];o=b.options;h=b.fn;n=b.firingFn;a=b.boundFn;j=b.isLateBinding;l=b.scope;if(j&&a&&a!==l[h]){a=false;n=false}if(!a){if(j){a=l[h];if(!a){continue}}else{a=h}b.boundFn=a}if(!n){n=a;if(o.buffer){n=Ext.Function.createBuffered(n,o.buffer,l)}if(o.delay){n=Ext.Function.createDelayed(n,o.delay,l)}b.firingFn=n}c[g]=o;e=c;if(o.args){e=o.args.concat(e)}if(o.single===true){b.stack.remove(h,l,b.order)}m=n.apply(l,e);if(m===false){this.stop()}if(this.isStopped){break}if(this.isPausing){this.isPaused=true;k.splice(0,d+1);return}}this.isFiring=false;this.listenerStacks=null;k.length=0;c.length=0;this.connectingController=null},connect:function(a){this.connectingController=a},resume:function(){var a=this.connectingController;this.isPausing=false;if(this.isPaused&&this.firingListeners.length>0){this.isPaused=false;this.doFire()}if(a){a.resume()}return this},isInterrupted:function(){return this.isStopped||this.isPaused},stop:function(){var a=this.connectingController;this.isStopped=true;if(a){this.connectingController=null;a.stop()}this.isFiring=false;this.listenerStacks=null;return this},pause:function(){var a=this.connectingController;this.isPausing=true;if(a){a.pause()}return this}},1,0,0,0,0,0,[Ext.event,"Controller"],0));(Ext.cmd.derive("Ext.event.Dispatcher",Ext.Base,{statics:{getInstance:function(){if(!this.instance){this.instance=new this()}return this.instance},setInstance:function(a){this.instance=a;return this}},config:{publishers:{}},wildcard:"*",constructor:function(a){this.listenerStacks={};this.activePublishers={};this.publishersCache={};this.noActivePublishers=[];this.controller=null;this.initConfig(a);return this},getListenerStack:function(e,g,c,b){var d=this.listenerStacks,f=d[e],a;b=Boolean(b);if(!f){if(b){d[e]=f={}}else{return null}}f=f[g];if(!f){if(b){d[e][g]=f={}}else{return null}}a=f[c];if(!a){if(b){f[c]=a=new Ext.event.ListenerStack()}else{return null}}return a},getController:function(d,f,c,b){var a=this.controller,e={targetType:d,target:f,eventName:c};if(!a){this.controller=a=new Ext.event.Controller()}if(a.isFiring){a=new Ext.event.Controller()}a.setInfo(e);if(b&&a!==b){a.connect(b)}return a},applyPublishers:function(c){var a,b;this.publishersCache={};for(a in c){if(c.hasOwnProperty(a)){b=c[a];this.registerPublisher(b)}}return c},registerPublisher:function(b){var a=this.activePublishers,c=b.getTargetType(),d=a[c];if(!d){a[c]=d=[]}d.push(b);b.setDispatcher(this);return this},getCachedActivePublishers:function(c,b){var a=this.publishersCache,d;if((d=a[c])&&(d=d[b])){return d}return null},cacheActivePublishers:function(c,b,d){var a=this.publishersCache;if(!a[c]){a[c]={}}a[c][b]=d;return d},getActivePublishers:function(f,b){var g,a,c,e,d;if((g=this.getCachedActivePublishers(f,b))){return g}a=this.activePublishers[f];if(a){g=[];for(c=0,e=a.length;c<e;c++){d=a[c];if(d.handles(b)){g.push(d)}}}else{g=this.noActivePublishers}return this.cacheActivePublishers(f,b,g)},hasListener:function(c,d,b){var a=this.getListenerStack(c,d,b);if(a){return a.count()>0}return false},addListener:function(e,f,b){var g=this.getActivePublishers(e,b),d=g.length,c,a;a=this.doAddListener.apply(this,arguments);if(a&&d>0){for(c=0;c<d;c++){g[c].subscribe(f,b)}}return a},doAddListener:function(g,h,c,f,e,d,a){var b=this.getListenerStack(g,h,c,true);return b.add(f,e,d,a)},removeListener:function(e,f,b){var g=this.getActivePublishers(e,b),d=g.length,c,a;a=this.doRemoveListener.apply(this,arguments);if(a&&d>0){for(c=0;c<d;c++){g[c].unsubscribe(f,b)}}return a},doRemoveListener:function(f,g,c,e,d,a){var b=this.getListenerStack(f,g,c);if(b===null){return false}return b.remove(e,d,a)},clearListeners:function(a,e,d){var j=this.listenerStacks,f=arguments.length,b,h,c,g;if(f===3){if(j[a]&&j[a][e]){this.removeListener(a,e,d);delete j[a][e][d]}}else{if(f===2){if(j[a]){b=j[a][e];if(b){for(d in b){if(b.hasOwnProperty(d)){h=this.getActivePublishers(a,d);for(c=0,f=h.length;c<f;c++){h[c].unsubscribe(e,d,true)}}}delete j[a][e]}}}else{if(f===1){h=this.activePublishers[a];for(c=0,f=h.length;c<f;c++){h[c].unsubscribeAll()}delete j[a]}else{h=this.activePublishers;for(a in h){if(h.hasOwnProperty(a)){g=h[a];for(c=0,f=g.length;c<f;c++){g[c].unsubscribeAll()}}}delete this.listenerStacks;this.listenerStacks={}}}}return this},dispatchEvent:function(d,e,a){var f=this.getActivePublishers(d,a),c=f.length,b;if(c>0){for(b=0;b<c;b++){f[b].notify(e,a)}}return this.doDispatchEvent.apply(this,arguments)},doDispatchEvent:function(a,g,f,j,c,b){var h=this.getListenerStack(a,g,f),d=this.getWildcardListenerStacks(a,g,f),e;if((h===null||h.length==0)){if(d.length==0&&!c){return}}else{d.push(h)}e=this.getController(a,g,f,b);e.setListenerStacks(d);e.fire(j,c);return !e.isInterrupted()},getWildcardListenerStacks:function(g,h,d){var f=[],b=this.wildcard,c=d!==b,e=h!==b,a;if(c&&(a=this.getListenerStack(g,h,b))){f.push(a)}if(e&&(a=this.getListenerStack(g,b,d))){f.push(a)}return f},getPublisher:function(a){return this.getPublishers()[a]}},1,0,0,0,0,0,[Ext.event,"Dispatcher"],0));(Ext.cmd.derive("Ext.mixin.Mixin",Ext.Base,{onClassExtended:function(b,e){var a=e.mixinConfig,d,f,c;if(a){d=b.superclass.mixinConfig;if(d){a=e.mixinConfig=Ext.merge({},d,a)}e.mixinId=a.id;f=a.beforeHooks;c=a.hooks||a.afterHooks;if(f||c){Ext.Function.interceptBefore(e,"onClassMixedIn",function(h){var g=this.prototype;if(f){Ext.Object.each(f,function(k,j){h.override(j,function(){if(g[k].apply(this,arguments)!==false){return this.callOverridden(arguments)}})})}if(c){Ext.Object.each(c,function(k,j){h.override(j,function(){var l=this.callOverridden(arguments);g[k].apply(this,arguments);return l})})}})}}}},0,0,0,0,0,0,[Ext.mixin,"Mixin"],0));(Ext.cmd.derive("Ext.mixin.Observable",Ext.mixin.Mixin,{mixinConfig:{id:"observable",hooks:{destroy:"destroy"}},alternateClassName:"Ext.util.Observable",isObservable:true,observableType:"observable",validIdRegex:/^([\w\-]+)$/,observableIdPrefix:"#",listenerOptionsRegex:/^(?:delegate|single|delay|buffer|args|prepend)$/,eventFiringSuspended:false,config:{listeners:null,bubbleEvents:null},constructor:function(a){this.initConfig(a)},applyListeners:function(a){if(a){this.addListener(a)}},applyBubbleEvents:function(a){if(a){this.enableBubble(a)}},getOptimizedObservableId:function(){return this.observableId},getObservableId:function(){if(!this.observableId){var a=this.getUniqueId();this.observableId=this.observableIdPrefix+a;this.getObservableId=this.getOptimizedObservableId}return this.observableId},getOptimizedEventDispatcher:function(){return this.eventDispatcher},getEventDispatcher:function(){if(!this.eventDispatcher){this.eventDispatcher=Ext.event.Dispatcher.getInstance();this.getEventDispatcher=this.getOptimizedEventDispatcher;this.getListeners();this.getBubbleEvents()}return this.eventDispatcher},getManagedListeners:function(c,b){var d=c.getUniqueId(),a=this.managedListeners;if(!a){this.managedListeners=a={}}if(!a[d]){a[d]={};c.doAddListener("destroy","clearManagedListeners",this,{single:true,args:[c]})}if(!a[d][b]){a[d][b]=[]}return a[d][b]},getUsedSelectors:function(){var a=this.usedSelectors;if(!a){a=this.usedSelectors=[];a.$map={}}return a},fireEvent:function(a){var b=Array.prototype.slice.call(arguments,1);return this.doFireEvent(a,b)},fireAction:function(c,e,g,f,d,a){var b=typeof g,h;if(e===undefined){e=[]}if(b!="undefined"){h={fn:g,isLateBinding:b=="string",scope:f||this,options:d||{},order:a}}return this.doFireEvent(c,e,h)},doFireEvent:function(c,e,g,a){var f=this,d=true,b;if(f.eventFiringSuspended){b=f.eventQueue;if(!b){f.eventQueue=b=[]}b.push([c,e,g,a])}else{d=f.getEventDispatcher().dispatchEvent(f.observableType,f.getObservableId(),c,e,g,a)}return d},doAddListener:function(a,j,l,m,c){var e=(l&&l!==this&&l.isIdentifiable),b=this.getUsedSelectors(),f=b.$map,d=this.getObservableId(),g,k,h;if(!m){m={}}if(!l){l=this}if(m.delegate){h=m.delegate;d+=" "+h}if(!(d in f)){f[d]=true;b.push(d)}g=this.addDispatcherListener(d,a,j,l,m,c);if(g&&e){k=this.getManagedListeners(l,a);k.push({delegate:h,scope:l,fn:j,order:c})}return g},addDispatcherListener:function(b,d,f,e,c,a){return this.getEventDispatcher().addListener(this.observableType,b,d,f,e,c,a)},doRemoveListener:function(b,k,m,n,d){var g=(m&&m!==this&&m.isIdentifiable),e=this.getObservableId(),a,l,f,h,c,j;if(n&&n.delegate){j=n.delegate;e+=" "+j}if(!m){m=this}a=this.removeDispatcherListener(e,b,k,m,d);if(a&&g){l=this.getManagedListeners(m,b);for(f=0,h=l.length;f<h;f++){c=l[f];if(c.fn===k&&c.scope===m&&c.delegate===j&&c.order===d){l.splice(f,1);break}}}return a},removeDispatcherListener:function(b,c,e,d,a){return this.getEventDispatcher().removeListener(this.observableType,b,c,e,d,a)},clearManagedListeners:function(d){var j=this.managedListeners,a,c,h,f,e,g,b,k;if(!j){return this}if(d){if(typeof d!="string"){a=d.getUniqueId()}else{a=d}c=j[a];for(f in c){if(c.hasOwnProperty(f)){h=c[f];for(e=0,g=h.length;e<g;e++){b=h[e];k={};if(b.delegate){k.delegate=b.delegate}if(this.doRemoveListener(f,b.fn,b.scope,k,b.order)){e--;g--}}}}delete j[a];return this}for(a in j){if(j.hasOwnProperty(a)){this.clearManagedListeners(a)}}},changeListener:function(l,h,n,p,q,d){var b,m,g,j,a,o,f,k,c,e;if(typeof n!="undefined"){if(typeof h!="string"){for(f=0,k=h.length;f<k;f++){a=h[f];l.call(this,a,n,p,q,d)}return this}l.call(this,h,n,p,q,d)}else{if(Ext.isArray(h)){m=h;for(f=0,k=m.length;f<k;f++){c=m[f];l.call(this,c.event,c.fn,c.scope,c,c.order)}}else{g=this.listenerOptionsRegex;q=h;b=[];m=[];j={};for(a in q){o=q[a];if(a==="scope"){p=o;continue}else{if(a==="order"){d=o;continue}}if(!g.test(a)){e=typeof o;if(e!="string"&&e!="function"){l.call(this,a,o.fn,o.scope||p,o,o.order||d);continue}b.push(a);m.push(o)}else{j[a]=o}}for(f=0,k=b.length;f<k;f++){l.call(this,b[f],m[f],p,j,d)}}}return this},addListener:function(b,e,d,c,a){return this.changeListener(this.doAddListener,b,e,d,c,a)},toggleListener:function(b,c,f,e,d,a){return this.changeListener(b?this.doAddListener:this.doRemoveListener,c,f,e,d,a)},addBeforeListener:function(a,d,c,b){return this.addListener(a,d,c,b,"before")},addAfterListener:function(a,d,c,b){return this.addListener(a,d,c,b,"after")},removeListener:function(b,e,d,c,a){return this.changeListener(this.doRemoveListener,b,e,d,c,a)},removeBeforeListener:function(a,d,c,b){return this.removeListener(a,d,c,b,"before")},removeAfterListener:function(a,d,c,b){return this.removeListener(a,d,c,b,"after")},clearListeners:function(){var e=this.getUsedSelectors(),c=this.getEventDispatcher(),b,d,a;for(b=0,d=e.length;b<d;b++){a=e[b];c.clearListeners(this.observableType,a)}},hasListener:function(a){return this.getEventDispatcher().hasListener(this.observableType,this.getObservableId(),a)},suspendEvents:function(){this.eventFiringSuspended=true},resumeEvents:function(e){var d=this,a=d.eventQueue||[],b,c;d.eventFiringSuspended=false;if(!e){for(b=0,c=a.length;b<c;b++){d.doFireEvent.apply(d,a[b])}}d.eventQueue=[]},relayEvents:function(b,d,g){var c,f,e,a;if(typeof g=="undefined"){g=""}if(typeof d=="string"){d=[d]}if(Ext.isArray(d)){for(c=0,f=d.length;c<f;c++){e=d[c];a=g+e;b.addListener(e,this.createEventRelayer(a),this)}}else{for(e in d){if(d.hasOwnProperty(e)){a=g+d[e];b.addListener(e,this.createEventRelayer(a),this)}}}return this},relayEvent:function(e,f,h,j,a){var g=typeof f,c=e[e.length-1],d=c.getInfo().eventName,b;e=Array.prototype.slice.call(e,0,-2);e[0]=this;if(g!="undefined"){b={fn:f,scope:h||this,options:j||{},order:a,isLateBinding:g=="string"}}return this.doFireEvent(d,e,b,c)},createEventRelayer:function(a){return function(){return this.doFireEvent(a,Array.prototype.slice.call(arguments,0,-2))}},enableBubble:function(d){var a=this.isBubblingEnabled,c,e,b;if(!a){a=this.isBubblingEnabled={}}if(typeof d=="string"){d=Ext.Array.clone(arguments)}for(c=0,e=d.length;c<e;c++){b=d[c];if(!a[b]){a[b]=true;this.addListener(b,this.createEventBubbler(b),this)}}},createEventBubbler:function(a){return function b(){var c=("getBubbleTarget" in this)?this.getBubbleTarget():null;if(c&&c!==this&&c.isObservable){c.fireAction(a,Array.prototype.slice.call(arguments,0,-2),b,c,null,"after")}}},getBubbleTarget:function(){return false},destroy:function(){if(this.observableId){this.fireEvent("destroy",this);this.clearListeners();this.clearManagedListeners()}},addEvents:Ext.emptyFn},1,0,0,0,0,[[Ext.mixin.Identifiable.prototype.mixinId||Ext.mixin.Identifiable.$className,Ext.mixin.Identifiable]],[Ext.mixin,"Observable",Ext.util,"Observable"],function(){this.createAlias({on:"addListener",un:"removeListener",onBefore:"addBeforeListener",onAfter:"addAfterListener",unBefore:"removeBeforeListener",unAfter:"removeAfterListener"})}));(Ext.cmd.derive("Ext.Evented",Ext.Base,{alternateClassName:"Ext.EventedBase",statics:{generateSetter:function(e){var c=e.internal,b=e.apply,a=e.changeEvent,d=e.doSet;return function(h){var j=this.initialized,g=this[c],f=this[b];if(f){h=f.call(this,h,g);if(typeof h=="undefined"){return this}}g=this[c];if(h!==g){if(j){this.fireAction(a,[this,h,g],this.doSet,this,{nameMap:e})}else{this[c]=h;if(this[d]){this[d].call(this,h,g)}}}return this}}},initialized:false,constructor:function(a){this.initialConfig=a;this.initialize()},initialize:function(){this.initConfig(this.initialConfig);this.initialized=true},doSet:function(c,d,b,a){var e=a.nameMap;c[e.internal]=d;if(c[e.doSet]){c[e.doSet].call(this,d,b)}},onClassExtended:function(a,e){if(!e.hasOwnProperty("eventedConfig")){return}var d=Ext.Class,c=e.config,g=e.eventedConfig,b,f;e.config=(c)?Ext.applyIf(c,g):g;for(b in g){if(g.hasOwnProperty(b)){f=d.getConfigNameMap(b);e[f.set]=this.generateSetter(f)}}}},1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext,"Evented",Ext,"EventedBase"],0));(Ext.cmd.derive("Ext.AbstractComponent",Ext.Evented,{onClassExtended:function(b,f){if(!f.hasOwnProperty("cachedConfig")){return}var g=b.prototype,c=f.config,e=f.cachedConfig,d=g.cachedConfigList,j=g.hasCachedConfig,a,h;delete f.cachedConfig;g.cachedConfigList=d=(d)?d.slice():[];g.hasCachedConfig=j=(j)?Ext.Object.chain(j):{};if(!c){f.config=c={}}for(a in e){if(e.hasOwnProperty(a)){h=e[a];if(!j[a]){j[a]=true;d.push(a)}c[a]=h}}},getElementConfig:Ext.emptyFn,referenceAttributeName:"reference",referenceSelector:"[reference]",addReferenceNode:function(a,b){Ext.Object.defineProperty(this,a,{get:function(){var c;delete this[a];this[a]=c=new Ext.Element(b);return c},configurable:true})},initElement:function(){var k=this.self.prototype,n=this.getId(),s=[],g=true,x=this.referenceAttributeName,p=false,e,v,b,o,t,d,l,c,f,j,w,m,a,q,h,y,u,r;if(k.hasOwnProperty("renderTemplate")){e=this.renderTemplate.cloneNode(true);v=e.firstChild}else{g=false;p=true;e=document.createDocumentFragment();v=Ext.Element.create(this.getElementConfig(),true);e.appendChild(v)}o=e.querySelectorAll(this.referenceSelector);for(t=0,d=o.length;t<d;t++){l=o[t];c=l.getAttribute(x);if(g){l.removeAttribute(x)}if(c=="element"){l.id=n;this.element=b=new Ext.Element(l)}else{this.addReferenceNode(c,l)}s.push(c)}this.referenceList=s;if(!this.innerElement){this.innerElement=b}if(!this.bodyElement){this.bodyElement=this.innerElement}if(v===b.dom){this.renderElement=b}else{this.addReferenceNode("renderElement",v)}if(p){f=Ext.Class.configNameCache;j=this.config;w=this.cachedConfigList;m=this.initConfigList;a=this.initConfigMap;q=[];for(t=0,d=w.length;t<d;t++){y=w[t];u=f[y];if(a[y]){a[y]=false;Ext.Array.remove(m,y)}if(j[y]!==null){q.push(y);this[u.get]=this[u.initGet]}}for(t=0,d=q.length;t<d;t++){y=q[t];u=f[y];r=u.internal;this[r]=null;this[u.set].call(this,j[y]);delete this[u.get];k[r]=this[r]}v=this.renderElement.dom;k.renderTemplate=e=document.createDocumentFragment();e.appendChild(v.cloneNode(true));h=e.querySelectorAll("[id]");for(t=0,d=h.length;t<d;t++){b=h[t];b.removeAttribute("id")}for(t=0,d=s.length;t<d;t++){c=s[t];this[c].dom.removeAttribute("reference")}}return this}},0,0,0,0,0,0,[Ext,"AbstractComponent"],0));(Ext.cmd.derive("Ext.util.HashMap",Ext.Base,{constructor:function(a){this.callParent();this.mixins.observable.constructor.call(this);this.clear(true)},getCount:function(){return this.length},getData:function(a,b){if(b===undefined){b=a;a=this.getKey(b)}return[a,b]},getKey:function(a){return a.id},add:function(a,d){var b=this,c;if(b.containsKey(a)){throw new Error("This key already exists in the HashMap")}c=this.getData(a,d);a=c[0];d=c[1];b.map[a]=d;++b.length;b.fireEvent("add",b,a,d);return d},replace:function(b,d){var c=this,e=c.map,a;if(!c.containsKey(b)){c.add(b,d)}a=e[b];e[b]=d;c.fireEvent("replace",c,b,d,a);return d},remove:function(b){var a=this.findKey(b);if(a!==undefined){return this.removeByKey(a)}return false},removeByKey:function(a){var b=this,c;if(b.containsKey(a)){c=b.map[a];delete b.map[a];--b.length;b.fireEvent("remove",b,a,c);return true}return false},get:function(a){return this.map[a]},clear:function(a){var b=this;b.map={};b.length=0;if(a!==true){b.fireEvent("clear",b)}return b},containsKey:function(a){return this.map[a]!==undefined},contains:function(a){return this.containsKey(this.findKey(a))},getKeys:function(){return this.getArray(true)},getValues:function(){return this.getArray(false)},getArray:function(d){var a=[],b,c=this.map;for(b in c){if(c.hasOwnProperty(b)){a.push(d?b:c[b])}}return a},each:function(d,c){var a=Ext.apply({},this.map),b,e=this.length;c=c||this;for(b in a){if(a.hasOwnProperty(b)){if(d.call(c,b,a[b],e)===false){break}}}return this},clone:function(){var c=new Ext.util.HashMap(),b=this.map,a;c.suspendEvents();for(a in b){if(b.hasOwnProperty(a)){c.add(a,b[a])}}c.resumeEvents();return c},findKey:function(b){var a,c=this.map;for(a in c){if(c.hasOwnProperty(a)&&c[a]===b){return a}}return undefined}},1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.util,"HashMap"],0));(Ext.cmd.derive("Ext.AbstractManager",Ext.Base,{typeName:"type",constructor:function(a){Ext.apply(this,a||{});this.all=Ext.create("Ext.util.HashMap");this.types={}},get:function(a){return this.all.get(a)},register:function(a){this.all.add(a)},unregister:function(a){this.all.remove(a)},registerType:function(b,a){this.types[b]=a;a[this.typeName]=b},isRegistered:function(a){return this.types[a]!==undefined},create:function(a,d){var b=a[this.typeName]||a.type||d,c=this.types[b];return new c(a)},onAvailable:function(e,c,b){var a=this.all,d;if(a.containsKey(e)){d=a.get(e);c.call(b||d,d)}else{a.on("add",function(h,f,g){if(f==e){c.call(b||g,g);a.un("add",c,b)}})}},each:function(b,a){this.all.each(b,a||this)},getCount:function(){return this.all.getCount()}},1,0,0,0,0,0,[Ext,"AbstractManager"],0));(Ext.cmd.derive("Ext.mixin.Traversable",Ext.mixin.Mixin,{mixinConfig:{id:"traversable"},setParent:function(a){this.parent=a;return this},hasParent:function(){return Boolean(this.parent)},getParent:function(){return this.parent},getAncestors:function(){var b=[],a=this.getParent();while(a){b.push(a);a=a.getParent()}return b},getAncestorIds:function(){var b=[],a=this.getParent();while(a){b.push(a.getId());a=a.getParent()}return b}},0,0,0,0,0,0,[Ext.mixin,"Traversable"],0));(Ext.cmd.derive("Ext.ComponentManager",Ext.Base,{alternateClassName:"Ext.ComponentMgr",singleton:true,constructor:function(){var a={};this.all={map:a,getArray:function(){var b=[],c;for(c in a){if(a.hasOwnProperty(c)){b.push(a[c])}}return b}};this.map=a},register:function(a){var b=a.getId();this.map[a.getId()]=a},unregister:function(a){delete this.map[a.getId()]},isRegistered:function(a){return this.map[a]!==undefined},get:function(a){return this.map[a]},create:function(a,c){if(a.isComponent){return a}else{if(Ext.isString(a)){return Ext.createByAlias("widget."+a)}else{var b=a.xtype||c;return Ext.createByAlias("widget."+b,a)}}},registerType:Ext.emptyFn},1,0,0,0,0,0,[Ext,"ComponentManager",Ext,"ComponentMgr"],0));(function(){function b(d){var c=Array.prototype.slice.call(arguments,1);return d.replace(/\{(\d+)\}/g,function(e,f){return c[f]})}Ext.DateExtras={now:Date.now||function(){return +new Date()},getElapsed:function(d,c){return Math.abs(d-(c||new Date()))},useStrict:false,formatCodeToRegex:function(d,c){var e=a.parseCodes[d];if(e){e=typeof e=="function"?e():e;a.parseCodes[d]=e}return e?Ext.applyIf({c:e.c?b(e.c,c||"{0}"):e.c},e):{g:0,c:null,s:Ext.String.escapeRegex(d)}},parseFunctions:{MS:function(d,c){var e=new RegExp("\\\\?/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\\\?/");var f=(d||"").match(e);return f?new Date(((f[1]||"")+f[2])*1):null}},parseRegexes:[],formatFunctions:{MS:function(){return"\\/Date("+this.getTime()+")\\/"}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},defaultFormat:"m/d/Y",getShortMonthName:function(c){return a.monthNames[c].substring(0,3)},getShortDayName:function(c){return a.dayNames[c].substring(0,3)},getMonthNumber:function(c){return a.monthNumbers[c.substring(0,1).toUpperCase()+c.substring(1,3).toLowerCase()]},formatCodes:{d:"Ext.String.leftPad(this.getDate(), 2, '0')",D:"Ext.Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"Ext.Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"Ext.Date.getSuffix(this)",w:"this.getDay()",z:"Ext.Date.getDayOfYear(this)",W:"Ext.String.leftPad(Ext.Date.getWeekOfYear(this), 2, '0')",F:"Ext.Date.monthNames[this.getMonth()]",m:"Ext.String.leftPad(this.getMonth() + 1, 2, '0')",M:"Ext.Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"Ext.Date.getDaysInMonth(this)",L:"(Ext.Date.isLeapYear(this) ? 1 : 0)",o:"(this.getFullYear() + (Ext.Date.getWeekOfYear(this) == 1 && this.getMonth() > 0 ? +1 : (Ext.Date.getWeekOfYear(this) >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"Ext.String.leftPad(this.getFullYear(), 4, '0')",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"Ext.String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"Ext.String.leftPad(this.getHours(), 2, '0')",i:"Ext.String.leftPad(this.getMinutes(), 2, '0')",s:"Ext.String.leftPad(this.getSeconds(), 2, '0')",u:"Ext.String.leftPad(this.getMilliseconds(), 3, '0')",O:"Ext.Date.getGMTOffset(this)",P:"Ext.Date.getGMTOffset(this, true)",T:"Ext.Date.getTimezone(this)",Z:"(this.getTimezoneOffset() * -60)",c:function(){for(var j="Y-m-dTH:i:sP",g=[],f=0,d=j.length;f<d;++f){var h=j.charAt(f);g.push(h=="T"?"'T'":a.getFormatCode(h))}return g.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(n,c,l,j,f,g,e){j=j||0;f=f||0;g=g||0;e=e||0;var k=a.add(new Date(n<100?100:n,c-1,l,j,f,g,e),a.YEAR,n<100?n-100:0);return n==k.getFullYear()&&c==k.getMonth()+1&&l==k.getDate()&&j==k.getHours()&&f==k.getMinutes()&&g==k.getSeconds()&&e==k.getMilliseconds()},parse:function(d,f,c){var e=a.parseFunctions;if(e[f]==null){a.createParser(f)}return e[f](d,Ext.isDefined(c)?c:a.useStrict)},parseDate:function(d,e,c){return a.parse(d,e,c)},getFormatCode:function(d){var c=a.formatCodes[d];if(c){c=typeof c=="function"?c():c;a.formatCodes[d]=c}return c||("'"+Ext.String.escape(d)+"'")},createFormat:function(g){var f=[],c=false,e="";for(var d=0;d<g.length;++d){e=g.charAt(d);if(!c&&e=="\\"){c=true}else{if(c){c=false;f.push("'"+Ext.String.escape(e)+"'")}else{if(e=="\n"){f.push(Ext.JSON.encode(e))}else{f.push(a.getFormatCode(e))}}}}a.formatFunctions[g]=Ext.functionFactory("return "+f.join("+"))},createParser:(function(){var c=["var dt, y, m, d, h, i, s, ms, o, z, zz, u, v,","def = Ext.Date.defaults,","results = String(input).match(Ext.Date.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = Ext.Date.clearTime(new Date);","y = Ext.Number.from(y, Ext.Number.from(def.y, dt.getFullYear()));","m = Ext.Number.from(m, Ext.Number.from(def.m - 1, dt.getMonth()));","d = Ext.Number.from(d, Ext.Number.from(def.d, dt.getDate()));","h  = Ext.Number.from(h, Ext.Number.from(def.h, dt.getHours()));","i  = Ext.Number.from(i, Ext.Number.from(def.i, dt.getMinutes()));","s  = Ext.Number.from(s, Ext.Number.from(def.s, dt.getSeconds()));","ms = Ext.Number.from(ms, Ext.Number.from(def.ms, dt.getMilliseconds()));","if(z >= 0 && y >= 0){","v = Ext.Date.add(new Date(y < 100 ? 100 : y, 0, 1, h, i, s, ms), Ext.Date.YEAR, y < 100 ? y - 100 : 0);","v = !strict? v : (strict === true && (z <= 364 || (Ext.Date.isLeapYear(v) && z <= 365))? Ext.Date.add(v, Ext.Date.DAY, z) : null);","}else if(strict === true && !Ext.Date.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","v = Ext.Date.add(new Date(y < 100 ? 100 : y, m, d, h, i, s, ms), Ext.Date.YEAR, y < 100 ? y - 100 : 0);","}","}","}","if(v){","if(zz != null){","v = Ext.Date.add(v, Ext.Date.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = Ext.Date.add(v, Ext.Date.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");return function(l){var e=a.parseRegexes.length,m=1,f=[],k=[],j=false,d="";for(var h=0;h<l.length;++h){d=l.charAt(h);if(!j&&d=="\\"){j=true}else{if(j){j=false;k.push(Ext.String.escape(d))}else{var g=a.formatCodeToRegex(d,m);m+=g.g;k.push(g.s);if(g.g&&g.c){f.push(g.c)}}}}a.parseRegexes[e]=new RegExp("^"+k.join("")+"$","i");a.parseFunctions[l]=Ext.functionFactory("input","strict",b(c,e,f.join("")))}})(),parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(\\d{1,2})"},D:function(){for(var c=[],d=0;d<7;c.push(a.getShortDayName(d)),++d){}return{g:0,c:null,s:"(?:"+c.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+a.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:0,c:null,s:"(?:\\d{2})"},F:function(){return{g:1,c:"m = parseInt(Ext.Date.getMonthNumber(results[{0}]), 10);\n",s:"("+a.monthNames.join("|")+")"}},M:function(){for(var c=[],d=0;d<12;c.push(a.getShortMonthName(d)),++d){}return Ext.applyIf({s:"("+c.join("|")+")"},a.formatCodeToRegex("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(\\d{2})"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(\\d{1,2})"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:function(){return a.formatCodeToRegex("Y")},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > Ext.Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(am|pm|AM|PM)"},A:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(AM|PM|am|pm)"},g:function(){return a.formatCodeToRegex("G")},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(\\d{1,2})"},h:function(){return a.formatCodeToRegex("H")},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Ext.String.leftPad(hr, 2, '0') + Ext.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Ext.String.leftPad(hr, 2, '0') + Ext.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,4}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){var e=[],c=[a.formatCodeToRegex("Y",1),a.formatCodeToRegex("m",2),a.formatCodeToRegex("d",3),a.formatCodeToRegex("h",4),a.formatCodeToRegex("i",5),a.formatCodeToRegex("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",a.formatCodeToRegex("P",8).c,"}else{",a.formatCodeToRegex("O",8).c,"}","}"].join("\n")}];for(var f=0,d=c.length;f<d;++f){e.push(c[f].c)}return{g:1,c:e.join(""),s:[c[0].s,"(?:","-",c[1].s,"(?:","-",c[2].s,"(?:","(?:T| )?",c[3].s,":",c[4].s,"(?::",c[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}},dateFormat:function(c,d){return a.format(c,d)},format:function(d,e){if(a.formatFunctions[e]==null){a.createFormat(e)}var c=a.formatFunctions[e].call(d);return c+""},getTimezone:function(c){return c.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,4})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(c,d){var e=c.getTimezoneOffset();return(e>0?"-":"+")+Ext.String.leftPad(Math.floor(Math.abs(e)/60),2,"0")+(d?":":"")+Ext.String.leftPad(Math.abs(e%60),2,"0")},getDayOfYear:function(f){var e=0,h=Ext.Date.clone(f),c=f.getMonth(),g;for(g=0,h.setDate(1),h.setMonth(0);g<c;h.setMonth(++g)){e+=a.getDaysInMonth(h)}return e+f.getDate()-1},getWeekOfYear:(function(){var c=86400000,d=7*c;return function(f){var g=Date.UTC(f.getFullYear(),f.getMonth(),f.getDate()+3)/c,e=Math.floor(g/7),h=new Date(e*d).getUTCFullYear();return e-Math.floor(Date.UTC(h,0,7)/d)+1}})(),isLeapYear:function(c){var d=c.getFullYear();return !!((d&3)==0&&(d%100||(d%400==0&&d)))},getFirstDayOfMonth:function(d){var c=(d.getDay()-(d.getDate()-1))%7;return(c<0)?(c+7):c},getLastDayOfMonth:function(c){return a.getLastDateOfMonth(c).getDay()},getFirstDateOfMonth:function(c){return new Date(c.getFullYear(),c.getMonth(),1)},getLastDateOfMonth:function(c){return new Date(c.getFullYear(),c.getMonth(),a.getDaysInMonth(c))},getDaysInMonth:(function(){var c=[31,28,31,30,31,30,31,31,30,31,30,31];return function(e){var d=e.getMonth();return d==1&&a.isLeapYear(e)?29:c[d]}})(),getSuffix:function(c){switch(c.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(c){return new Date(c.getTime())},isDST:function(c){return new Date(c.getFullYear(),0,1).getTimezoneOffset()!=c.getTimezoneOffset()},clearTime:function(e,j){if(j){return Ext.Date.clearTime(Ext.Date.clone(e))}var g=e.getDate();e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0);if(e.getDate()!=g){for(var f=1,h=a.add(e,Ext.Date.HOUR,f);h.getDate()!=g;f++,h=a.add(e,Ext.Date.HOUR,f)){}e.setDate(g);e.setHours(h.getHours())}return e},add:function(f,e,g){var h=Ext.Date.clone(f);if(!e||g===0){return h}switch(e.toLowerCase()){case Ext.Date.MILLI:h=new Date(h.valueOf()+g);break;case Ext.Date.SECOND:h=new Date(h.valueOf()+g*1000);break;case Ext.Date.MINUTE:h=new Date(h.valueOf()+g*60000);break;case Ext.Date.HOUR:h=new Date(h.valueOf()+g*3600000);break;case Ext.Date.DAY:h=new Date(h.valueOf()+g*86400000);break;case Ext.Date.MONTH:var c=f.getDate();if(c>28){c=Math.min(c,Ext.Date.getLastDateOfMonth(Ext.Date.add(Ext.Date.getFirstDateOfMonth(f),"mo",g)).getDate())}h.setDate(c);h.setMonth(f.getMonth()+g);break;case Ext.Date.YEAR:h.setFullYear(f.getFullYear()+g);break}return h},between:function(d,f,c){var e=d.getTime();return f.getTime()<=e&&e<=c.getTime()},diff:function(e,c,g){var d=Ext.Date,f,h=+c-e;switch(g){case d.MILLI:return h;case d.SECOND:return Math.floor(h/1000);case d.MINUTE:return Math.floor(h/60000);case d.HOUR:return Math.floor(h/3600000);case d.DAY:return Math.floor(h/86400000);case"w":return Math.floor(h/604800000);case d.MONTH:f=(c.getFullYear()*12+c.getMonth())-(e.getFullYear()*12+e.getMonth());if(Ext.Date.add(e,g,f)>c){return f-1}else{return f}case d.YEAR:f=c.getFullYear()-e.getFullYear();if(Ext.Date.add(e,g,f)>c){return f-1}else{return f}}},align:function(d,f,e){var c=new Date(+d);switch(f.toLowerCase()){case Ext.Date.MILLI:return c;break;case Ext.Date.SECOND:c.setUTCSeconds(c.getUTCSeconds()-c.getUTCSeconds()%e);c.setUTCMilliseconds(0);return c;break;case Ext.Date.MINUTE:c.setUTCMinutes(c.getUTCMinutes()-c.getUTCMinutes()%e);c.setUTCSeconds(0);c.setUTCMilliseconds(0);return c;break;case Ext.Date.HOUR:c.setUTCHours(c.getUTCHours()-c.getUTCHours()%e);c.setUTCMinutes(0);c.setUTCSeconds(0);c.setUTCMilliseconds(0);return c;break;case Ext.Date.DAY:if(e==7||e==14){c.setUTCDate(c.getUTCDate()-c.getUTCDay()+1)}c.setUTCHours(0);c.setUTCMinutes(0);c.setUTCSeconds(0);c.setUTCMilliseconds(0);return c;break;case Ext.Date.MONTH:c.setUTCMonth(c.getUTCMonth()-(c.getUTCMonth()-1)%e,1);c.setUTCHours(0);c.setUTCMinutes(0);c.setUTCSeconds(0);c.setUTCMilliseconds(0);return c;break;case Ext.Date.YEAR:c.setUTCFullYear(c.getUTCFullYear()-c.getUTCFullYear()%e,1,1);c.setUTCHours(0);c.setUTCMinutes(0);c.setUTCSeconds(0);c.setUTCMilliseconds(0);return d;break}}};var a=Ext.DateExtras;Ext.apply(Ext.Date,a)})();(Ext.cmd.derive("Ext.util.Format",Ext.Base,{singleton:true,defaultDateFormat:"m/d/Y",escapeRe:/('|\\)/g,trimRe:/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,formatRe:/\{(\d+)\}/g,escapeRegexRe:/([-.*+?^${}()|[\]\/\\])/g,dashesRe:/-/g,iso8601TestRe:/\d\dT\d\d/,iso8601SplitRe:/[- :T\.Z\+]/,ellipsis:function(c,a,d){if(c&&c.length>a){if(d){var e=c.substr(0,a-2),b=Math.max(e.lastIndexOf(" "),e.lastIndexOf("."),e.lastIndexOf("!"),e.lastIndexOf("?"));if(b!=-1&&b>=(a-15)){return e.substr(0,b)+"..."}}return c.substr(0,a-3)+"..."}return c},escapeRegex:function(a){return a.replace(Ext.util.Format.escapeRegexRe,"\\$1")},escape:function(a){return a.replace(Ext.util.Format.escapeRe,"\\$1")},toggle:function(b,c,a){return b==c?a:c},trim:function(a){return a.replace(Ext.util.Format.trimRe,"")},leftPad:function(d,b,c){var a=String(d);c=c||" ";while(a.length<b){a=c+a}return a},format:function(b){var a=Ext.toArray(arguments,1);return b.replace(Ext.util.Format.formatRe,function(c,d){return a[d]})},htmlEncode:function(a){return !a?a:String(a).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},htmlDecode:function(a){return !a?a:String(a).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},date:function(f,g){var b=f;if(!f){return""}if(!Ext.isDate(f)){b=new Date(Date.parse(f));if(isNaN(b)){if(this.iso8601TestRe.test(f)){if(Ext.os.is.Android&&Ext.os.version.isLessThan("3.0")){var h=[1,4,5,6,7,10,11];var e,d=0;if((e=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(f))){for(var c=0,a;(a=h[c]);++c){e[a]=+e[a]||0}e[2]=(+e[2]||1)-1;e[3]=+e[3]||1;if(e[8]!=="Z"&&e[9]!==undefined){d=e[10]*60+e[11];if(e[9]==="+"){d=0-d}}b=new Date(Date.UTC(e[1],e[2],e[3],e[4],e[5]+d,e[6],e[7]))}}else{b=f.split(this.iso8601SplitRe);b=new Date(b[0],b[1]-1,b[2],b[3],b[4],b[5])}}}if(isNaN(b)){b=new Date(Date.parse(f.replace(this.dashesRe,"/")))}f=b}return Ext.Date.format(f,g||Ext.util.Format.defaultDateFormat)}},0,0,0,0,0,0,[Ext.util,"Format"],0));(Ext.cmd.derive("Ext.Template",Ext.Base,{inheritableStatics:{from:function(b,a){b=Ext.getDom(b);return new this(b.value||b.innerHTML,a||"")}},constructor:function(d){var f=this,b=arguments,a=[],c=0,e=b.length,g;f.initialConfig={};if(e===1&&Ext.isArray(d)){b=d;e=b.length}if(e>1){for(;c<e;c++){g=b[c];if(typeof g=="object"){Ext.apply(f.initialConfig,g);Ext.apply(f,g)}else{a.push(g)}}}else{a.push(d)}f.html=a.join("");if(f.compiled){f.compile()}},isTemplate:true,disableFormats:false,re:/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,apply:function(a){var g=this,d=g.disableFormats!==true,f=Ext.util.Format,c=g,b;if(g.compiled){return g.compiled(a).join("")}function e(h,k,l,j){if(l&&d){if(j){j=[a[k]].concat(Ext.functionFactory("return ["+j+"];")())}else{j=[a[k]]}if(l.substr(0,5)=="this."){return c[l.substr(5)].apply(c,j)}else{return f[l].apply(f,j)}}else{return a[k]!==undefined?a[k]:""}}b=g.html.replace(g.re,e);return b},applyOut:function(a,b){var c=this;if(c.compiled){b.push.apply(b,c.compiled(a))}else{b.push(c.apply(a))}return b},applyTemplate:function(){return this.apply.apply(this,arguments)},set:function(a,c){var b=this;b.html=a;b.compiled=null;return c?b.compile():b},compileARe:/\\/g,compileBRe:/(\r\n|\n)/g,compileCRe:/'/g,compile:function(){var me=this,fm=Ext.util.Format,useFormat=me.disableFormats!==true,body,bodyReturn;function fn(m,name,format,args){if(format&&useFormat){args=args?","+args:"";if(format.substr(0,5)!="this."){format="fm."+format+"("}else{format="this."+format.substr(5)+"("}}else{args="";format="(values['"+name+"'] == undefined ? '' : "}return"',"+format+"values['"+name+"']"+args+") ,'"}bodyReturn=me.html.replace(me.compileARe,"\\\\").replace(me.compileBRe,"\\n").replace(me.compileCRe,"\\'").replace(me.re,fn);body="this.compiled = function(values){ return ['"+bodyReturn+"'];};";eval(body);return me},insertFirst:function(b,a,c){return this.doInsert("afterBegin",b,a,c)},insertBefore:function(b,a,c){return this.doInsert("beforeBegin",b,a,c)},insertAfter:function(b,a,c){return this.doInsert("afterEnd",b,a,c)},append:function(b,a,c){return this.doInsert("beforeEnd",b,a,c)},doInsert:function(b,d,a,e){var c=Ext.DomHelper.insertHtml(b,Ext.getDom(d),this.apply(a));return e?Ext.get(c):c},overwrite:function(c,a,d){var b=Ext.DomHelper.overwrite(Ext.getDom(c),this.apply(a));return d?Ext.get(b):b}},1,0,0,0,0,0,[Ext,"Template"],0));(Ext.cmd.derive("Ext.XTemplateParser",Ext.Base,{constructor:function(a){Ext.apply(this,a)},doTpl:Ext.emptyFn,parse:function(l){var v=this,p=l.length,o={elseif:"elif"},q=v.topRe,c=v.actionsRe,e,d,j,n,g,k,h,u,r,b,f,a;v.level=0;v.stack=d=[];for(e=0;e<p;e=b){q.lastIndex=e;n=q.exec(l);if(!n){v.doText(l.substring(e,p));break}r=n.index;b=q.lastIndex;if(e<r){v.doText(l.substring(e,r))}if(n[1]){b=l.indexOf("%}",r+2);v.doEval(l.substring(r+2,b));b+=2}else{if(n[2]){b=l.indexOf("]}",r+2);v.doExpr(l.substring(r+2,b));b+=2}else{if(n[3]){v.doTag(n[3])}else{if(n[4]){f=null;while((u=c.exec(n[4]))!==null){j=u[2]||u[3];if(j){j=Ext.String.htmlDecode(j);g=u[1];g=o[g]||g;f=f||{};k=f[g];if(typeof k=="string"){f[g]=[k,j]}else{if(k){f[g].push(j)}else{f[g]=j}}}}if(!f){if(v.elseRe.test(n[4])){v.doElse()}else{if(v.defaultRe.test(n[4])){v.doDefault()}else{v.doTpl();d.push({type:"tpl"})}}}else{if(f["if"]){v.doIf(f["if"],f);d.push({type:"if"})}else{if(f["switch"]){v.doSwitch(f["switch"],f);d.push({type:"switch"})}else{if(f["case"]){v.doCase(f["case"],f)}else{if(f.elif){v.doElseIf(f.elif,f)}else{if(f["for"]){++v.level;if(a=v.propRe.exec(n[4])){f.propName=a[1]||a[2]}v.doFor(f["for"],f);d.push({type:"for",actions:f})}else{if(f.exec){v.doExec(f.exec,f);d.push({type:"exec",actions:f})}}}}}}}}else{if(n[0].length===5){d.push({type:"tpl"})}else{h=d.pop();v.doEnd(h.type,h.actions);if(h.type=="for"){--v.level}}}}}}}},topRe:/(?:(\{\%)|(\{\[)|\{([^{}]*)\})|(?:<tpl([^>]*)\>)|(?:<\/tpl>)/g,actionsRe:/\s*(elif|elseif|if|for|exec|switch|case|eval)\s*\=\s*(?:(?:"([^"]*)")|(?:'([^']*)'))\s*/g,propRe:/prop=(?:(?:"([^"]*)")|(?:'([^']*)'))/,defaultRe:/^\s*default\s*$/,elseRe:/^\s*else\s*$/},1,0,0,0,0,0,[Ext,"XTemplateParser"],0));(Ext.cmd.derive("Ext.XTemplateCompiler",Ext.XTemplateParser,{useEval:Ext.isGecko,useIndex:Ext.isIE6||Ext.isIE7,useFormat:true,propNameRe:/^[\w\d\$]*$/,compile:function(a){var c=this,b=c.generate(a);return c.useEval?c.evalTpl(b):(new Function("Ext",b))(Ext)},generate:function(a){var d=this,b="var fm=Ext.util.Format,ts=Object.prototype.toString;",c;d.maxLevel=0;d.body=["var c0=values, a0="+d.createArrayTest(0)+", p0=parent, n0=xcount, i0=xindex, v;\n"];if(d.definitions){if(typeof d.definitions==="string"){d.definitions=[d.definitions,b]}else{d.definitions.push(b)}}else{d.definitions=[b]}d.switches=[];d.parse(a);d.definitions.push((d.useEval?"$=":"return")+" function ("+d.fnArgs+") {",d.body.join(""),"}");c=d.definitions.join("\n");d.definitions.length=d.body.length=d.switches.length=0;delete d.definitions;delete d.body;delete d.switches;return c},doText:function(c){var b=this,a=b.body;c=c.replace(b.aposRe,"\\'").replace(b.newLineRe,"\\n");if(b.useIndex){a.push("out[out.length]='",c,"'\n")}else{a.push("out.push('",c,"')\n")}},doExpr:function(b){var a=this.body;a.push("v="+b+"; if (v !== undefined && v !== null) out");if(this.useIndex){a.push("[out.length]=v+''\n")}else{a.push(".push(v+'')\n")}},doTag:function(a){this.doExpr(this.parseTag(a))},doElse:function(){this.body.push("} else {\n")},doEval:function(a){this.body.push(a,"\n")},doIf:function(b,c){var a=this;if(b==="."){a.body.push("if (values) {\n")}else{if(a.propNameRe.test(b)){a.body.push("if (",a.parseTag(b),") {\n")}else{a.body.push("if (",a.addFn(b),a.callFn,") {\n")}}if(c.exec){a.doExec(c.exec)}},doElseIf:function(b,c){var a=this;if(b==="."){a.body.push("else if (values) {\n")}else{if(a.propNameRe.test(b)){a.body.push("} else if (",a.parseTag(b),") {\n")}else{a.body.push("} else if (",a.addFn(b),a.callFn,") {\n")}}if(c.exec){a.doExec(c.exec)}},doSwitch:function(b){var a=this;if(b==="."){a.body.push("switch (values) {\n")}else{if(a.propNameRe.test(b)){a.body.push("switch (",a.parseTag(b),") {\n")}else{a.body.push("switch (",a.addFn(b),a.callFn,") {\n")}}a.switches.push(0)},doCase:function(e){var d=this,c=Ext.isArray(e)?e:[e],f=d.switches.length-1,a,b;if(d.switches[f]){d.body.push("break;\n")}else{d.switches[f]++}for(b=0,f=c.length;b<f;++b){a=d.intRe.exec(c[b]);c[b]=a?a[1]:("'"+c[b].replace(d.aposRe,"\\'")+"'")}d.body.push("case ",c.join(": case "),":\n")},doDefault:function(){var a=this,b=a.switches.length-1;if(a.switches[b]){a.body.push("break;\n")}else{a.switches[b]++}a.body.push("default:\n")},doEnd:function(b,d){var c=this,a=c.level-1;if(b=="for"){if(d.exec){c.doExec(d.exec)}c.body.push("}\n");c.body.push("parent=p",a,";values=r",a+1,";xcount=n",a,";xindex=i",a,"\n")}else{if(b=="if"||b=="switch"){c.body.push("}\n")}}},doFor:function(f,h){var e=this,d,b=e.level,a=b-1,c="p"+b,g;if(f==="."){d="values"}else{if(e.propNameRe.test(f)){d=e.parseTag(f)}else{d=e.addFn(f)+e.callFn}}if(e.maxLevel<b){e.maxLevel=b;e.body.push("var ")}if(f=="."){g="c"+b}else{g="a"+a+"?c"+a+"[i"+a+"]:p"+b}e.body.push("i",b,"=0,n",b,"=0,c",b,"=",d,",a",b,"=",e.createArrayTest(b),",p",b,"=c",a,",r",b,"=values;\n","parent=",g,"\n","if (c",b,"){if(a",b,"){n",b,"=c",b,".length;}else if (c",b,".isMixedCollection){c",b,"=c",b,".items;n",b,"=c",b,".length;}else if(c",b,".isStore){c",b,"=c",b,".data.items;n",b,"=c",b,".length;}else{c",b,"=[c",b,"];n",b,"=1;}}\n","for (xcount=n",b,";i",b,"<n"+b+";++i",b,"){\n","values=c",b,"[i",b,"]");if(h.propName){e.body.push(".",h.propName)}e.body.push("\n","xindex=i",b,"+1\n")},createArrayTest:("isArray" in Array)?function(a){return"Array.isArray(c"+a+")"}:function(a){return"ts.call(c"+a+')==="[object Array]"'},doExec:function(c,d){var b=this,a="f"+b.definitions.length;b.definitions.push("function "+a+"("+b.fnArgs+") {"," try { with(values) {","  "+c," }} catch(e) {","}","}");b.body.push(a+b.callFn+"\n")},addFn:function(a){var c=this,b="f"+c.definitions.length;if(a==="."){c.definitions.push("function "+b+"("+c.fnArgs+") {"," return values","}")}else{if(a===".."){c.definitions.push("function "+b+"("+c.fnArgs+") {"," return parent","}")}else{c.definitions.push("function "+b+"("+c.fnArgs+") {"," try { with(values) {","  return("+a+")"," }} catch(e) {","}","}")}}return b},parseTag:function(b){var g=this,a=g.tagRe.exec(b),e=a[1],h=a[2],d=a[3],f=a[4],c;if(e=="."){if(!g.validTypes){g.definitions.push("var validTypes={string:1,number:1,boolean:1};");g.validTypes=true}c='validTypes[typeof values] || ts.call(values) === "[object Date]" ? values : ""'}else{if(e=="#"){c="xindex"}else{if(e.substr(0,7)=="parent."){c=e}else{if(isNaN(e)&&e.indexOf("-")==-1&&e.indexOf(".")!=-1){c="values."+e}else{c="values['"+e+"']"}}}}if(f){c="("+c+f+")"}if(h&&g.useFormat){d=d?","+d:"";if(h.substr(0,5)!="this."){h="fm."+h+"("}else{h+="("}}else{return c}return h+c+d+")"},evalTpl:function($){eval($);return $},newLineRe:/\r\n|\r|\n/g,aposRe:/[']/g,intRe:/^\s*(\d+)\s*$/,tagRe:/([\w-\.\#\$]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\/]\s?[\d\.\+\-\*\/\(\)]+)?/},0,0,0,0,0,0,[Ext,"XTemplateCompiler"],function(){var a=this.prototype;a.fnArgs="out,values,parent,xindex,xcount";a.callFn=".call(this,"+a.fnArgs+")"}));(Ext.cmd.derive("Ext.XTemplate",Ext.Template,{emptyObj:{},apply:function(a){return this.applyOut(a,[]).join("")},applyOut:function(a,b,d){var g=this,f=a.xindex,j=a.xcount,c;if(!g.fn){c=new Ext.XTemplateCompiler({useFormat:g.disableFormats!==true,definitions:g.definitions});g.fn=c.compile(g.html)}try{f=typeof f==="number"?f:1;j=typeof j==="number"?j:1;g.fn.call(g,b,a,d||g.emptyObj,f,j)}catch(h){}return b},compile:function(){return this},statics:{getTpl:function(a,c){var b=a[c],d;if(b&&!b.isTemplate){b=Ext.ClassManager.dynInstantiate("Ext.XTemplate",b);if(a.hasOwnProperty(c)){a[c]=b}else{for(d=a.self.prototype;d;d=d.superclass){if(d.hasOwnProperty(c)){d[c]=b;break}}}}return b||null}}},0,0,0,0,0,0,[Ext,"XTemplate"],0));(Ext.cmd.derive("Ext.behavior.Behavior",Ext.Base,{constructor:function(a){this.component=a;a.on("destroy","onComponentDestroy",this)},onComponentDestroy:Ext.emptyFn},1,0,0,0,0,0,[Ext.behavior,"Behavior"],0));(Ext.cmd.derive("Ext.fx.easing.Abstract",Ext.Base,{config:{startTime:0,startValue:0},isEasing:true,isEnded:false,constructor:function(a){this.initConfig(a);return this},applyStartTime:function(a){if(!a){a=Ext.Date.now()}return a},updateStartTime:function(a){this.reset()},reset:function(){this.isEnded=false},getValue:Ext.emptyFn},1,0,0,0,0,0,[Ext.fx.easing,"Abstract"],0));(Ext.cmd.derive("Ext.fx.easing.Linear",Ext.fx.easing.Abstract,{config:{duration:0,endValue:0},updateStartValue:function(a){this.distance=this.getEndValue()-a},updateEndValue:function(a){this.distance=a-this.getStartValue()},getValue:function(){var a=Ext.Date.now()-this.getStartTime(),b=this.getDuration();if(a>b){this.isEnded=true;return this.getEndValue()}else{return this.getStartValue()+((a/b)*this.distance)}}},0,0,0,0,["easing.linear"],0,[Ext.fx.easing,"Linear"],0));(Ext.cmd.derive("Ext.util.translatable.Abstract",Ext.Evented,{config:{useWrapper:null,easing:null,easingX:null,easingY:null},x:0,y:0,activeEasingX:null,activeEasingY:null,isAnimating:false,isTranslatable:true,constructor:function(a){this.initConfig(a)},factoryEasing:function(a){return Ext.factory(a,Ext.fx.easing.Linear,null,"easing")},applyEasing:function(a){if(!this.getEasingX()){this.setEasingX(this.factoryEasing(a))}if(!this.getEasingY()){this.setEasingY(this.factoryEasing(a))}},applyEasingX:function(a){return this.factoryEasing(a)},applyEasingY:function(a){return this.factoryEasing(a)},doTranslate:Ext.emptyFn,translate:function(a,c,b){if(b){return this.translateAnimated(a,c,b)}if(this.isAnimating){this.stopAnimation()}if(!isNaN(a)&&typeof a=="number"){this.x=a}if(!isNaN(c)&&typeof c=="number"){this.y=c}this.doTranslate(a,c)},translateAxis:function(b,d,c){var a,e;if(b=="x"){a=d}else{e=d}return this.translate(a,e,c)},animate:function(b,a){this.activeEasingX=b;this.activeEasingY=a;this.isAnimating=true;this.lastX=null;this.lastY=null;Ext.AnimationQueue.start(this.doAnimationFrame,this);this.fireEvent("animationstart",this,this.x,this.y);return this},translateAnimated:function(b,g,e){if(!Ext.isObject(e)){e={}}if(this.isAnimating){this.stopAnimation()}var d=Ext.Date.now(),f=e.easing,c=(typeof b=="number")?(e.easingX||f||this.getEasingX()||true):null,a=(typeof g=="number")?(e.easingY||f||this.getEasingY()||true):null;if(c){c=this.factoryEasing(c);c.setStartTime(d);c.setStartValue(this.x);c.setEndValue(b);if("duration" in e){c.setDuration(e.duration)}}if(a){a=this.factoryEasing(a);a.setStartTime(d);a.setStartValue(this.y);a.setEndValue(g);if("duration" in e){a.setDuration(e.duration)}}return this.animate(c,a)},doAnimationFrame:function(){var e=this,c=e.activeEasingX,b=e.activeEasingY,d=Date.now(),a,f;if(!e.isAnimating){return}e.lastRun=d;if(c===null&&b===null){e.stopAnimation();return}if(c!==null){e.x=a=Math.round(c.getValue());if(c.isEnded){e.activeEasingX=null;e.fireEvent("axisanimationend",e,"x",a)}}else{a=e.x}if(b!==null){e.y=f=Math.round(b.getValue());if(b.isEnded){e.activeEasingY=null;e.fireEvent("axisanimationend",e,"y",f)}}else{f=e.y}if(e.lastX!==a||e.lastY!==f){e.doTranslate(a,f);e.lastX=a;e.lastY=f}e.fireEvent("animationframe",e,a,f)},stopAnimation:function(){if(!this.isAnimating){return}this.activeEasingX=null;this.activeEasingY=null;this.isAnimating=false;Ext.AnimationQueue.stop(this.doAnimationFrame,this);this.fireEvent("animationend",this,this.x,this.y)},refresh:function(){this.translate(this.x,this.y)},destroy:function(){if(this.isAnimating){this.stopAnimation()}Ext.Evented.prototype.destroy.apply(this,arguments)}},1,0,0,0,0,0,[Ext.util.translatable,"Abstract"],0));(Ext.cmd.derive("Ext.util.translatable.Dom",Ext.util.translatable.Abstract,{config:{element:null},applyElement:function(a){if(!a){return}return Ext.get(a)},updateElement:function(){this.refresh()}},0,0,0,0,0,0,[Ext.util.translatable,"Dom"],0));(Ext.cmd.derive("Ext.util.translatable.CssTransform",Ext.util.translatable.Dom,{doTranslate:function(a,c){var b=this.getElement();if(!this.isDestroyed&&!b.isDestroyed){b.translate(a,c)}},destroy:function(){var a=this.getElement();if(a&&!a.isDestroyed){a.dom.style.webkitTransform=null}Ext.util.translatable.Dom.prototype.destroy.call(this)}},0,0,0,0,0,0,[Ext.util.translatable,"CssTransform"],0));(Ext.cmd.derive("Ext.util.translatable.ScrollPosition",Ext.util.translatable.Dom,{type:"scrollposition",config:{useWrapper:true},getWrapper:function(){var c=this.wrapper,b=this.getElement(),a;if(!c){a=b.getParent();if(!a){return null}if(a.hasCls("x-translatable-hboxfix")){a=a.getParent()}if(this.getUseWrapper()){c=b.wrap()}else{c=a}b.addCls("x-translatable");c.addCls("x-translatable-container");this.wrapper=c;c.on("painted",function(){if(!this.isAnimating){this.refresh()}},this);this.refresh()}return c},doTranslate:function(a,d){var c=this.getWrapper(),b;if(c){b=c.dom;if(typeof a=="number"){b.scrollLeft=500000-a}if(typeof d=="number"){b.scrollTop=500000-d}}},destroy:function(){var a=this.getElement(),b=this.wrapper;if(b){if(!a.isDestroyed){if(this.getUseWrapper()){b.doReplaceWith(a)}a.removeCls("x-translatable")}if(!b.isDestroyed){b.removeCls("x-translatable-container");b.un("painted","refresh",this)}delete this.wrapper;delete this._element}Ext.util.translatable.Dom.prototype.destroy.call(this)}},0,0,0,0,0,0,[Ext.util.translatable,"ScrollPosition"],0));(Ext.cmd.derive("Ext.util.translatable.CssPosition",Ext.util.translatable.Dom,{doTranslate:function(a,c){var b=this.getElement().dom.style;if(typeof a=="number"){b.left=a+"px"}if(typeof c=="number"){b.top=c+"px"}},destroy:function(){var a=this.getElement().dom.style;a.left=null;a.top=null;Ext.util.translatable.Dom.prototype.destroy.apply(this,arguments)}},0,0,0,0,0,0,[Ext.util.translatable,"CssPosition"],0));(Ext.cmd.derive("Ext.util.Translatable",Ext.Base,{constructor:function(a){var b=Ext.util.translatable;switch(Ext.browser.getPreferredTranslationMethod(a)){case"scrollposition":return new b.ScrollPosition(a);case"csstransform":return new b.CssTransform(a);case"cssposition":return new b.CssPosition(a)}}},1,0,0,0,0,0,[Ext.util,"Translatable"],0));(Ext.cmd.derive("Ext.behavior.Translatable",Ext.behavior.Behavior,{setConfig:function(c){var a=this.translatable,b=this.component;if(c){if(!a){this.translatable=a=new Ext.util.Translatable(c);a.setElement(b.renderElement);a.on("destroy","onTranslatableDestroy",this)}else{if(Ext.isObject(c)){a.setConfig(c)}}}else{if(a){a.destroy()}}return this},getTranslatable:function(){return this.translatable},onTranslatableDestroy:function(){delete this.translatable},onComponentDestroy:function(){var a=this.translatable;if(a){a.destroy()}}},0,0,0,0,0,0,[Ext.behavior,"Translatable"],0));(Ext.cmd.derive("Ext.util.Draggable",Ext.Base,{isDraggable:true,config:{cls:"x-draggable",draggingCls:"x-dragging",element:null,constraint:"container",disabled:null,direction:"both",initialOffset:{x:0,y:0},translatable:{}},DIRECTION_BOTH:"both",DIRECTION_VERTICAL:"vertical",DIRECTION_HORIZONTAL:"horizontal",defaultConstraint:{min:{x:-Infinity,y:-Infinity},max:{x:Infinity,y:Infinity}},containerWidth:0,containerHeight:0,width:0,height:0,constructor:function(a){var b;this.extraConstraint={};this.initialConfig=a;this.offset={x:0,y:0};this.listeners={dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",resize:"onElementResize",touchstart:"onPress",touchend:"onRelease",scope:this};if(a&&a.element){b=a.element;delete a.element;this.setElement(b)}return this},applyElement:function(a){if(!a){return}return Ext.get(a)},updateElement:function(a){a.on(this.listeners);this.initConfig(this.initialConfig)},updateInitialOffset:function(b){if(typeof b=="number"){b={x:b,y:b}}var c=this.offset,a,d;c.x=a=b.x;c.y=d=b.y;this.getTranslatable().translate(a,d)},updateCls:function(a){this.getElement().addCls(a)},applyTranslatable:function(a,b){a=Ext.factory(a,Ext.util.Translatable,b);if(a){a.setElement(this.getElement())}return a},setExtraConstraint:function(a){this.extraConstraint=a||{};this.refreshConstraint();return this},addExtraConstraint:function(a){Ext.merge(this.extraConstraint,a);this.refreshConstraint();return this},applyConstraint:function(a){this.currentConstraint=a;if(!a){a=this.defaultConstraint}if(a==="container"){return Ext.merge(this.getContainerConstraint(),this.extraConstraint)}return Ext.merge({},this.extraConstraint,a)},updateConstraint:function(){this.refreshOffset()},getContainerConstraint:function(){var a=this.getContainer(),b=this.getElement();if(!a||!b.dom){return this.defaultConstraint}return{min:{x:0,y:0},max:{x:this.containerWidth-this.width,y:this.containerHeight-this.height}}},getContainer:function(){var a=this.container;if(!a){a=this.getElement().getParent();if(a){this.container=a;a.on({resize:"onContainerResize",destroy:"onContainerDestroy",scope:this})}}return a},onElementResize:function(a,b){this.width=b.width;this.height=b.height;this.refresh()},onContainerResize:function(a,b){this.containerWidth=b.width;this.containerHeight=b.height;this.refresh()},onContainerDestroy:function(){delete this.container;delete this.containerSizeMonitor},detachListeners:function(){this.getElement().un(this.listeners)},isAxisEnabled:function(a){var b=this.getDirection();if(a==="x"){return(b===this.DIRECTION_BOTH||b===this.DIRECTION_HORIZONTAL)}return(b===this.DIRECTION_BOTH||b===this.DIRECTION_VERTICAL)},onPress:function(a){this.fireAction("touchstart",[this,a])},onRelease:function(a){this.fireAction("touchend",[this,a])},onDragStart:function(a){if(this.getDisabled()){return false}var b=this.offset;this.fireAction("dragstart",[this,a,b.x,b.y],this.initDragStart)},initDragStart:function(b,c,a,d){this.dragStartOffset={x:a,y:d};this.isDragging=true;this.getElement().addCls(this.getDraggingCls())},onDrag:function(b){if(!this.isDragging){return}var a=this.dragStartOffset;this.fireAction("drag",[this,b,a.x+b.deltaX,a.y+b.deltaY],this.doDrag)},doDrag:function(b,c,a,d){b.setOffset(a,d)},onDragEnd:function(a){if(!this.isDragging){return}this.onDrag(a);this.isDragging=false;this.getElement().removeCls(this.getDraggingCls());this.fireEvent("dragend",this,a,this.offset.x,this.offset.y)},setOffset:function(j,h,b){var f=this.offset,a=this.getConstraint(),e=a.min,c=a.max,d=Math.min,g=Math.max;if(this.isAxisEnabled("x")&&typeof j=="number"){j=d(g(j,e.x),c.x)}else{j=f.x}if(this.isAxisEnabled("y")&&typeof h=="number"){h=d(g(h,e.y),c.y)}else{h=f.y}f.x=j;f.y=h;this.getTranslatable().translate(j,h,b)},getOffset:function(){return this.offset},refreshConstraint:function(){this.setConstraint(this.currentConstraint)},refreshOffset:function(){var a=this.offset;this.setOffset(a.x,a.y)},refresh:function(){this.refreshConstraint();this.getTranslatable().refresh();this.refreshOffset()},enable:function(){return this.setDisabled(false)},disable:function(){return this.setDisabled(true)},destroy:function(){var a=this.getTranslatable();var b=this.getElement();if(b&&!b.isDestroyed){b.removeCls(this.getCls())}this.detachListeners();if(a){a.destroy()}}},1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.util,"Draggable"],function(){}));(Ext.cmd.derive("Ext.behavior.Draggable",Ext.behavior.Behavior,{setConfig:function(c){var a=this.draggable,b=this.component;if(c){if(!a){b.setTranslatable(c.translatable);this.draggable=a=new Ext.util.Draggable(c);a.setTranslatable(b.getTranslatable());a.setElement(b.renderElement);a.on("destroy","onDraggableDestroy",this);b.on(this.listeners)}else{if(Ext.isObject(c)){a.setConfig(c)}}}else{if(a){a.destroy()}}return this},getDraggable:function(){return this.draggable},onDraggableDestroy:function(){delete this.draggable},onComponentDestroy:function(){var a=this.draggable;if(a){a.destroy()}}},0,0,0,0,0,0,[Ext.behavior,"Draggable"],0));(function(a){(Ext.cmd.derive("Ext.Component",Ext.AbstractComponent,{alternateClassName:"Ext.lib.Component",requires:["Ext.ComponentManager","Ext.XTemplate","Ext.dom.Element","Ext.behavior.Translatable","Ext.behavior.Draggable"],observableType:"component",cachedConfig:{baseCls:null,cls:null,floatingCls:a+"floating",hiddenCls:a+"item-hidden",ui:null,margin:null,padding:null,border:null,styleHtmlCls:a+"html",styleHtmlContent:null},eventedConfig:{flex:null,left:null,top:null,right:null,bottom:null,width:null,height:null,minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,docked:null,centered:null,hidden:null,disabled:null},config:{style:null,html:null,draggable:null,translatable:null,renderTo:null,zIndex:null,tpl:null,enterAnimation:null,exitAnimation:null,showAnimation:null,hideAnimation:null,tplWriteMode:"overwrite",data:null,disabledCls:a+"item-disabled",contentEl:null,itemId:undefined,record:null,plugins:null},listenerOptionsRegex:/^(?:delegate|single|delay|buffer|args|prepend|element)$/,alignmentRegex:/^([a-z]+)-([a-z]+)(\?)?$/,isComponent:true,floating:false,rendered:false,isInner:true,activeAnimation:null,dockPositions:{top:true,right:true,bottom:true,left:true},innerElement:null,element:null,template:[],widthLayoutSized:false,heightLayoutSized:false,layoutStretched:false,sizeState:false,sizeFlags:0,LAYOUT_WIDTH:1,LAYOUT_HEIGHT:2,LAYOUT_BOTH:3,LAYOUT_STRETCHED:4,constructor:function(c){var d=this,b=d.config,e;d.onInitializedListeners=[];d.initialConfig=c;if(c!==undefined&&"id" in c){e=c.id}else{if("id" in b){e=b.id}else{e=d.getId()}}d.id=e;d.setId(e);Ext.ComponentManager.register(d);d.initElement();d.initConfig(d.initialConfig);d.refreshSizeState=d.doRefreshSizeState;d.refreshFloating=d.doRefreshFloating;if(d.refreshSizeStateOnInitialized){d.refreshSizeState()}if(d.refreshFloatingOnInitialized){d.refreshFloating()}d.initialize();d.triggerInitialized();if(d.config.fullscreen){d.fireEvent("fullscreen",d)}d.fireEvent("initialize",d)},beforeInitConfig:function(b){this.beforeInitialize.apply(this,arguments)},beforeInitialize:Ext.emptyFn,initialize:Ext.emptyFn,getTemplate:function(){return this.template},getElementConfig:function(){return{reference:"element",classList:["x-unsized"],children:this.getTemplate()}},triggerInitialized:function(){var f=this.onInitializedListeners,g=f.length,h,e,d,b,c;if(!this.initialized){this.initialized=true;if(g>0){for(c=0;c<g;c++){h=f[c];e=h.fn;d=h.scope;b=h.args;if(typeof e=="string"){d[e].apply(d,b)}else{e.apply(d,b)}}f.length=0}}},onInitialized:function(e,d,b){var c=this.onInitializedListeners;if(!d){d=this}if(this.initialized){if(typeof e=="string"){d[e].apply(d,b)}else{e.apply(d,b)}}else{c.push({fn:e,scope:d,args:b})}},renderTo:function(b,d){var f=this.renderElement.dom,e=Ext.getDom(b),c=Ext.getDom(d);if(e){if(c){e.insertBefore(f,c)}else{e.appendChild(f)}this.setRendered(Boolean(f.offsetParent))}},setParent:function(c){var b=this.parent;if(c&&b&&b!==c){b.remove(this,false)}this.parent=c;return this},applyPlugins:function(b){var d,c,e;if(!b){return b}b=[].concat(b);for(c=0,d=b.length;c<d;c++){e=b[c];b[c]=Ext.factory(e,"Ext.plugin.Plugin",null,"plugin")}return b},updatePlugins:function(e,b){var d,c;if(e){for(c=0,d=e.length;c<d;c++){e[c].init(this)}}if(b){for(c=0,d=b.length;c<d;c++){Ext.destroy(b[c])}}},updateRenderTo:function(b){this.renderTo(b)},updateStyle:function(b){this.element.applyStyles(b)},updateBorder:function(b){this.element.setBorder(b)},updatePadding:function(b){this.innerElement.setPadding(b)},updateMargin:function(b){this.element.setMargin(b)},updateUi:function(b,e){var d=this.getBaseCls(),c=this.element,f=this.currentUi;if(d){if(e){if(f){c.removeCls(f)}else{c.removeCls(d+"-"+e)}}if(b){c.addCls(b,d);this.currentUi=d+"-"+b;if(!this.self.prototype.currentUi){this.self.prototype.currentUi=this.currentUi}}}},applyBaseCls:function(b){return b||a+this.xtype},updateBaseCls:function(b,c){var d=this,e=d.getUi();if(c){this.element.removeCls(c);if(e){this.element.removeCls(this.currentUi)}}if(b){this.element.addCls(b);if(e){this.element.addCls(b,null,e);this.currentUi=b+"-"+e}}},addCls:function(b,h,j){var e=this.getCls(),g=(e)?e.slice():[],f,d,c;h=h||"";j=j||"";if(typeof b=="string"){b=[b]}f=b.length;if(!g.length&&h===""&&j===""){g=b}else{for(d=0;d<f;d++){c=h+b[d]+j;if(g.indexOf(c)==-1){g.push(c)}}}this.setCls(g)},removeCls:function(b,g,h){var d=this.getCls(),f=(d)?d.slice():[],e,c;g=g||"";h=h||"";if(typeof b=="string"){f=Ext.Array.remove(f,g+b+h)}else{e=b.length;for(c=0;c<e;c++){f=Ext.Array.remove(f,g+b[c]+h)}}this.setCls(f)},replaceCls:function(e,j,d,h){var k=this.getCls(),f=(k)?k.slice():[],g,c,b;d=d||"";h=h||"";if(typeof e=="string"){f=Ext.Array.remove(f,d+e+h)}else{if(e){g=e.length;for(c=0;c<g;c++){f=Ext.Array.remove(f,d+e[c]+h)}}}if(typeof j=="string"){f.push(d+j+h)}else{if(j){g=j.length;if(!f.length&&d===""&&h===""){f=j}else{for(c=0;c<g;c++){b=d+j[c]+h;if(f.indexOf(b)==-1){f.push(b)}}}}}this.setCls(f)},toggleCls:function(c,e){var b=this.getCls(),d=(b)?b.slice():[];if(e||d.indexOf(c)==-1){d.push(c)}else{Ext.Array.remove(d,c)}this.setCls(d);return this},applyCls:function(b){if(typeof b=="string"){b=[b]}if(!b||!b.length){b=null}return b},updateCls:function(c,b){if(this.element&&((c&&!b)||(!c&&b)||c.length!=b.length||Ext.Array.difference(c,b).length>0)){this.element.replaceCls(b,c)}},updateStyleHtmlCls:function(d,b){var e=this.innerHtmlElement,c=this.innerElement;if(this.getStyleHtmlContent()&&b){if(e){e.replaceCls(b,d)}else{c.replaceCls(b,d)}}},applyStyleHtmlContent:function(b){return Boolean(b)},updateStyleHtmlContent:function(d){var b=this.getStyleHtmlCls(),c=this.innerElement,e=this.innerHtmlElement;if(d){if(e){e.addCls(b)}else{c.addCls(b)}}else{if(e){e.removeCls(b)}else{c.addCls(b)}}},applyContentEl:function(b){if(b){return Ext.get(b)}},updateContentEl:function(b,c){if(c){c.hide();Ext.getBody().append(c)}if(b){this.setHtml(b.dom);b.show()}},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},isCentered:function(){return Boolean(this.getCentered())},isFloating:function(){return this.floating},isDocked:function(){return Boolean(this.getDocked())},isInnerItem:function(){return this.isInner},setIsInner:function(b){if(b!==this.isInner){this.isInner=b;if(this.initialized){this.fireEvent("innerstatechange",this,b)}}},filterLengthValue:function(b){if(b==="auto"||(!b&&b!==0)){return null}return b},applyTop:function(b){return this.filterLengthValue(b)},applyRight:function(b){return this.filterLengthValue(b)},applyBottom:function(b){return this.filterLengthValue(b)},applyLeft:function(b){return this.filterLengthValue(b)},applyWidth:function(b){return this.filterLengthValue(b)},applyHeight:function(b){return this.filterLengthValue(b)},applyMinWidth:function(b){return this.filterLengthValue(b)},applyMinHeight:function(b){return this.filterLengthValue(b)},applyMaxWidth:function(b){return this.filterLengthValue(b)},applyMaxHeight:function(b){return this.filterLengthValue(b)},doSetTop:function(b){this.element.setTop(b);this.refreshFloating()},doSetRight:function(b){this.element.setRight(b);this.refreshFloating()},doSetBottom:function(b){this.element.setBottom(b);this.refreshFloating()},doSetLeft:function(b){this.element.setLeft(b);this.refreshFloating()},doSetWidth:function(b){this.element.setWidth(b);this.refreshSizeState()},doSetHeight:function(b){this.element.setHeight(b);this.refreshSizeState()},applyFlex:function(b){if(b){b=Number(b);if(isNaN(b)){b=null}}else{b=null}return b},doSetFlex:Ext.emptyFn,refreshSizeState:function(){this.refreshSizeStateOnInitialized=true},doRefreshSizeState:function(){var c=this.getWidth()!==null||this.widthLayoutSized||(this.getLeft()!==null&&this.getRight()!==null),d=this.getHeight()!==null||this.heightLayoutSized||(this.getTop()!==null&&this.getBottom()!==null),f=this.layoutStretched||this.hasCSSMinHeight||(!d&&this.getMinHeight()!==null),e=c&&d,b=(c&&this.LAYOUT_WIDTH)|(d&&this.LAYOUT_HEIGHT)|(f&&this.LAYOUT_STRETCHED);if(!e&&f){e=null}this.setSizeState(e);this.setSizeFlags(b)},setLayoutSizeFlags:function(b){this.layoutStretched=!!(b&this.LAYOUT_STRETCHED);this.widthLayoutSized=!!(b&this.LAYOUT_WIDTH);this.heightLayoutSized=!!(b&this.LAYOUT_HEIGHT);this.refreshSizeState()},setSizeFlags:function(b){if(b!==this.sizeFlags){this.sizeFlags=b;var c=!!(b&this.LAYOUT_WIDTH),d=!!(b&this.LAYOUT_HEIGHT),e=!!(b&this.LAYOUT_STRETCHED);if(c&&!e&&!d){this.element.addCls("x-has-width")}else{this.element.removeCls("x-has-width")}if(d&&!e&&!c){this.element.addCls("x-has-height")}else{this.element.removeCls("x-has-height")}if(this.initialized){this.fireEvent("sizeflagschange",this,b)}}},getSizeFlags:function(){if(!this.initialized){this.doRefreshSizeState()}return this.sizeFlags},setSizeState:function(b){if(b!==this.sizeState){this.sizeState=b;this.element.setSizeState(b);if(this.initialized){this.fireEvent("sizestatechange",this,b)}}},getSizeState:function(){if(!this.initialized){this.doRefreshSizeState()}return this.sizeState},doSetMinWidth:function(b){this.element.setMinWidth(b)},doSetMinHeight:function(b){this.element.setMinHeight(b);this.refreshSizeState()},doSetMaxWidth:function(b){this.element.setMaxWidth(b)},doSetMaxHeight:function(b){this.element.setMaxHeight(b)},applyCentered:function(b){b=Boolean(b);if(b){this.refreshInnerState=Ext.emptyFn;if(this.isFloating()){this.resetFloating()}if(this.isDocked()){this.setDocked(false)}this.setIsInner(false);delete this.refreshInnerState}return b},doSetCentered:function(b){this.toggleCls(this.getFloatingCls(),b);if(!b){this.refreshInnerState()}},applyDocked:function(b){if(!b){return null}this.refreshInnerState=Ext.emptyFn;if(this.isFloating()){this.resetFloating()}if(this.isCentered()){this.setCentered(false)}this.setIsInner(false);delete this.refreshInnerState;return b},doSetDocked:function(c,b){this.fireEvent("afterdockedchange",this,c,b);if(!c){this.refreshInnerState()}},resetFloating:function(){this.setTop(null);this.setRight(null);this.setBottom(null);this.setLeft(null)},refreshInnerState:function(){this.setIsInner(!this.isCentered()&&!this.isFloating()&&!this.isDocked())},refreshFloating:function(){this.refreshFloatingOnInitialized=true},doRefreshFloating:function(){var c=true,b=this.getFloatingCls();if(this.getTop()===null&&this.getBottom()===null&&this.getRight()===null&&this.getLeft()===null){c=false}else{this.refreshSizeState()}if(c!==this.floating){this.floating=c;if(c){this.refreshInnerState=Ext.emptyFn;if(this.isCentered()){this.setCentered(false)}if(this.isDocked()){this.setDocked(false)}this.setIsInner(false);delete this.refreshInnerState}this.element.toggleCls(b,c);if(this.initialized){this.fireEvent("floatingchange",this,c)}if(!c){this.refreshInnerState()}}},updateFloatingCls:function(b,c){if(this.isFloating()){this.replaceCls(c,b)}},applyDisabled:function(b){return Boolean(b)},doSetDisabled:function(b){this.element[b?"addCls":"removeCls"](this.getDisabledCls())},updateDisabledCls:function(b,c){if(this.isDisabled()){this.element.replaceCls(c,b)}},disable:function(){this.setDisabled(true)},enable:function(){this.setDisabled(false)},isDisabled:function(){return this.getDisabled()},applyZIndex:function(b){if(!b&&b!==0){b=null}if(b!==null){b=Number(b);if(isNaN(b)){b=null}}return b},updateZIndex:function(d){var c=this.element,b;if(c&&!c.isDestroyed){b=c.dom.style;if(d!==null){b.setProperty("z-index",d,"important")}else{b.removeProperty("z-index")}}},getInnerHtmlElement:function(){var b=this.innerHtmlElement,c;if(!b||!b.dom||!b.dom.parentNode){this.innerHtmlElement=b=Ext.Element.create({cls:"x-innerhtml"});if(this.getStyleHtmlContent()){c=this.getStyleHtmlCls();this.innerHtmlElement.addCls(c);this.innerElement.removeCls(c)}this.innerElement.appendChild(b)}return b},updateHtml:function(b){if(!this.isDestroyed){var c=this.getInnerHtmlElement();if(Ext.isElement(b)){c.setHtml("");c.append(b)}else{c.setHtml(b)}}},applyHidden:function(b){return Boolean(b)},doSetHidden:function(c){var b=this.renderElement;if(b.isDestroyed){return}if(c){b.hide()}else{b.show()}if(this.element){this.element[c?"addCls":"removeCls"](this.getHiddenCls())}this.fireEvent(c?"hide":"show",this)},updateHiddenCls:function(b,c){if(this.isHidden()){this.element.replaceCls(c,b)}},isHidden:function(){return this.getHidden()},hide:function(b){this.setCurrentAlignmentInfo(null);if(this.activeAnimation){this.activeAnimation.on({animationend:function(){this.hide(b)},scope:this,single:true});return this}if(!this.getHidden()){if(b===undefined||(b&&b.isComponent)){b=this.getHideAnimation()}if(b){if(b===true){b="fadeOut"}this.onBefore({hiddenchange:"animateFn",scope:this,single:true,args:[b]})}this.setHidden(true)}return this},show:function(c){if(this.activeAnimation){this.activeAnimation.on({animationend:function(){this.show(c)},scope:this,single:true});return this}var b=this.getHidden();if(b||b===null){if(c===true){c="fadeIn"}else{if(c===undefined||(c&&c.isComponent)){c=this.getShowAnimation()}}if(c){this.beforeShowAnimation();this.onBefore({hiddenchange:"animateFn",scope:this,single:true,args:[c]})}this.setHidden(false)}return this},beforeShowAnimation:function(){if(this.element){this.renderElement.show();this.element.removeCls(this.getHiddenCls())}},animateFn:function(g,e,h,d,c,b){var f=this;if(g&&(!h||(h&&this.isPainted()))){this.activeAnimation=new Ext.fx.Animation(g);this.activeAnimation.setElement(e.element);if(!Ext.isEmpty(h)){this.activeAnimation.setOnEnd(function(){f.activeAnimation=null;b.resume()});b.pause()}Ext.Animator.run(f.activeAnimation)}},setVisibility:function(b){this.renderElement.setVisibility(b)},isRendered:function(){return this.rendered},isPainted:function(){return this.renderElement.isPainted()},applyTpl:function(b){return(Ext.isObject(b)&&b.isTemplate)?b:new Ext.XTemplate(b)},applyData:function(b){if(Ext.isObject(b)){return Ext.apply({},b)}else{if(!b){b={}}}return b},updateData:function(d){var e=this;if(d){var c=e.getTpl(),b=e.getTplWriteMode();if(c){c[b](e.getInnerHtmlElement(),d)}this.fireEvent("updatedata",e,d)}},applyRecord:function(b){if(b&&Ext.isObject(b)&&b.isModel){return b}return null},updateRecord:function(c,b){var d=this;if(b){b.unjoin(d)}if(!c){d.updateData("")}else{c.join(d);d.updateData(c.getData(true))}},afterEdit:function(){this.updateRecord(this.getRecord())},afterErase:function(){this.setRecord(null)},applyItemId:function(b){return b||this.getId()},isXType:function(c,b){if(b){return this.xtypes.indexOf(c)!=-1}return Boolean(this.xtypesMap[c])},getXTypes:function(){return this.xtypesChain.join("/")},getDraggableBehavior:function(){var b=this.draggableBehavior;if(!b){b=this.draggableBehavior=new Ext.behavior.Draggable(this)}return b},applyDraggable:function(b){this.getDraggableBehavior().setConfig(b)},getDraggable:function(){return this.getDraggableBehavior().getDraggable()},getTranslatableBehavior:function(){var b=this.translatableBehavior;if(!b){b=this.translatableBehavior=new Ext.behavior.Translatable(this)}return b},applyTranslatable:function(b){this.getTranslatableBehavior().setConfig(b)},getTranslatable:function(){return this.getTranslatableBehavior().getTranslatable()},translateAxis:function(c,e,d){var b,f;if(c==="x"){b=e}else{f=e}return this.translate(b,f,d)},translate:function(){var b=this.getTranslatable();if(!b){this.setTranslatable(true);b=this.getTranslatable()}b.translate.apply(b,arguments)},setRendered:function(c){var b=this.rendered;if(c!==b){this.rendered=c;return true}return false},setSize:function(c,b){if(c!=undefined){this.setWidth(c)}if(b!=undefined){this.setHeight(b)}},doAddListener:function(d,f,e,c,b){if(c&&"element" in c){return this[c.element].doAddListener(d,f,e||this,c,b)}if(d=="painted"||d=="resize"){return this.element.doAddListener(d,f,e||this,c,b)}return Ext.AbstractComponent.prototype.doAddListener.apply(this,arguments)},doRemoveListener:function(d,f,e,c,b){if(c&&"element" in c){this[c.element].doRemoveListener(d,f,e||this,c,b)}return Ext.AbstractComponent.prototype.doRemoveListener.apply(this,arguments)},showBy:function(c,f){var e=this,b=Ext.Viewport,d=e.getParent();e.setVisibility(false);if(d!==b){b.add(e)}e.show();e.on({hide:"onShowByErased",destroy:"onShowByErased",single:true,scope:e});b.on("resize","alignTo",e,{args:[c,f]});e.alignTo(c,f);e.setVisibility(true)},onShowByErased:function(){Ext.Viewport.un("resize","alignTo",this)},getAlignmentInfo:function(k,j){var c=k.isComponent?k.renderElement:k,g=c.getPageBox(),d=this.renderElement,e=d.getPageBox(),f={alignToBox:g,alignment:j,top:g.top,left:g.left,alignToWidth:g.width,alignToHeight:g.height,width:e.width,height:e.height},b=this.getCurrentAlignmentInfo(),h=true;if(!Ext.isEmpty(b)){Ext.Object.each(f,function(l,m){if(!Ext.isObject(m)&&b[l]!=m){h=false;return false}return true})}else{h=false}return{isAligned:h,stats:f}},getCurrentAlignmentInfo:function(){return this.$currentAlignmentInfo},setCurrentAlignmentInfo:function(b){this.$currentAlignmentInfo=Ext.isEmpty(b)?null:Ext.merge({},b.stats?b.stats:b)},alignTo:function(m,h){var p=this.getAlignmentInfo(m,h);if(p.isAligned){return}var o=p.stats.alignToBox,A=this.getParent().element.getPageBox(),x=p.stats.alignToHeight,n=p.stats.alignToWidth,s=p.stats.height,u=p.stats.width;A.bottom-=5;A.height-=10;A.left+=5;A.right-=5;A.top+=5;A.width-=10;if(!h||h==="auto"){if(A.bottom-o.bottom<s){if(o.top-A.top<s){if(o.left-A.left<u){h="cl-cr?"}else{h="cr-cl?"}}else{h="bc-tc?"}}else{h="tc-bc?"}}var b=h.match(this.alignmentRegex);var v=b[1].split(""),c=b[2].split(""),y=(b[3]==="?"),g=v[0],t=v[1]||g,k=c[0],l=c[1]||k,q=o.top,d=o.left,j=x/2,e=n/2,f=u/2,r=s/2,w,z;switch(g){case"t":switch(k){case"c":q+=j;break;case"b":q+=x}break;case"b":switch(k){case"c":q-=(s-j);break;case"t":q-=s;break;case"b":q-=s-x}break;case"c":switch(k){case"t":q-=r;break;case"c":q-=(r-j);break;case"b":q-=(r-x)}break}switch(t){case"l":switch(l){case"c":d+=j;break;case"r":d+=n}break;case"r":switch(l){case"r":d-=(u-n);break;case"c":d-=(u-f);break;case"l":d-=u}break;case"c":switch(l){case"l":d-=f;break;case"c":d-=(f-e);break;case"r":d-=(f-n)}break}if(y){w=(A.left+A.width)-u;z=(A.top+A.height)-s;d=Math.max(A.left,Math.min(w,d));q=Math.max(A.top,Math.min(z,q))}this.setLeft(d);this.setTop(q);this.setCurrentAlignmentInfo(p)},up:function(c){var b=this.parent;if(c){for(;b;b=b.parent){if(Ext.ComponentQuery.is(b,c)){return b}}}return b},getBubbleTarget:function(){return this.getParent()},destroy:function(){this.destroy=Ext.emptyFn;var e=this.getParent(),c=this.referenceList,d,f,b;this.isDestroying=true;Ext.destroy(this.getTranslatable(),this.getPlugins());if(e){e.remove(this,false)}for(d=0,f=c.length;d<f;d++){b=c[d];this[b].destroy();delete this[b]}Ext.destroy(this.innerHtmlElement);this.setRecord(null);Ext.AbstractComponent.prototype.destroy.call(this);Ext.ComponentManager.unregister(this)}},1,["component"],["component"],{component:true},["widget.component"],[[Ext.mixin.Traversable.prototype.mixinId||Ext.mixin.Traversable.$className,Ext.mixin.Traversable]],[Ext,"Component",Ext.lib,"Component"],function(){}))})("x-");(Ext.cmd.derive("Ext.layout.Abstract",Ext.Base,{isLayout:true,constructor:function(a){this.initialConfig=a},setContainer:function(a){this.container=a;this.initConfig(this.initialConfig);return this},onItemAdd:function(){},onItemRemove:function(){},onItemMove:function(){},onItemCenteredChange:function(){},onItemFloatingChange:function(){},onItemDockedChange:function(){},onItemInnerStateChange:function(){}},1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.layout,"Abstract"],0));(Ext.cmd.derive("Ext.mixin.Bindable",Ext.mixin.Mixin,{mixinConfig:{id:"bindable"},bind:function(a,d,h,c,b){if(!h){h=d}var f=a[d],e,g;if(f&&f.hasOwnProperty("$binding")){g=f.$binding;if(g.bindingMethod===h&&g.bindingScope===this){return this}}a[d]=e=function(){var l=e.$binding,k=l.bindingScope,j=Array.prototype.slice.call(arguments);j.push(arguments);if(b){j.push.apply(j,b)}if(!l.preventDefault&&k[l.bindingMethod].apply(k,j)!==false){return l.boundFn.apply(this,arguments)}};e.$binding={preventDefault:!!c,boundFn:f,bindingMethod:h,bindingScope:this};return this},unbind:function(a,b,g){if(!g){g=b}var d=a[b],e=d.$binding,c,f;while(e){c=e.boundFn;if(e.bindingMethod===g&&e.bindingScope===this){if(f){f.boundFn=c}else{a[b]=c}return this}f=e;e=c.$binding}return this}},0,0,0,0,0,0,[Ext.mixin,"Bindable"],0));(Ext.cmd.derive("Ext.util.Wrapper",Ext.Base,{constructor:function(c,b){var a=this.link("element",Ext.Element.create(c));if(b){a.insertBefore(b);this.wrap(b)}},bindSize:function(b){var c=this.wrappedElement,a;this.boundSizeName=b;this.boundMethodName=a=b==="width"?"setWidth":"setHeight";this.bind(c,a,"onBoundSizeChange");c[a].call(c,c.getStyleValue(b))},onBoundSizeChange:function(c,a){var b=this.element;if(typeof c==="string"&&c.substr(-1)==="%"){a[0]="100%"}else{c=""}b[this.boundMethodName].call(b,c)},wrap:function(c){var b=this.element,a;this.wrappedElement=c;a=b.dom;while(a.firstElementChild!==null){a=a.firstElementChild}a.appendChild(c.dom)},destroy:function(){var d=this.element,f=d.dom,e=this.wrappedElement,b=this.boundMethodName,a=f.parentNode,c;if(b){this.unbind(e,b,"onBoundSizeChange");c=d.getStyle(this.boundSizeName);if(c){e[b].call(e,c)}}if(a){if(!e.isDestroyed){a.replaceChild(f.firstElementChild,f)}delete this.wrappedElement}this.callSuper()}},1,0,0,0,0,[[Ext.mixin.Bindable.prototype.mixinId||Ext.mixin.Bindable.$className,Ext.mixin.Bindable]],[Ext.util,"Wrapper"],0));(Ext.cmd.derive("Ext.layout.wrapper.BoxDock",Ext.Base,{config:{direction:"horizontal",element:{className:"x-dock"},bodyElement:{className:"x-dock-body"},innerWrapper:null,sizeState:false,container:null},positionMap:{top:"start",left:"start",bottom:"end",right:"end"},constructor:function(a){this.items={start:[],end:[]};this.itemsCount=0;this.initConfig(a)},addItems:function(a){var b,d,c;for(b=0,d=a.length;b<d;b++){c=a[b];this.addItem(c)}},addItem:function(n){var o=n.getDocked(),g=this.positionMap[o],a=n.$dockWrapper,b=this.getContainer(),h=b.indexOf(n),f=n.element,l=this.items,k=l[g],e,j,m,d,c;if(a){a.removeItem(n)}n.$dockWrapper=this;n.addCls("x-dock-item");n.addCls("x-docked-"+o);for(e=0,j=k.length;e<j;e++){m=k[e];c=b.indexOf(m);if(c>h){d=m.element;k.splice(e,0,n);break}}if(!d){k.push(n);d=this.getBodyElement()}this.itemsCount++;if(g==="start"){f.insertBefore(d)}else{f.insertAfter(d)}},removeItem:function(c){var a=c.getDocked(),b=this.items[this.positionMap[a]];Ext.Array.remove(b,c);c.element.detach();delete c.$dockWrapper;c.removeCls("x-dock-item");c.removeCls("x-docked-"+a);if(--this.itemsCount===0){this.destroy()}},getItemsSlice:function(c){var a=this.getContainer(),b=this.items,h=[],g,d,f,e;for(g=b.start,d=0,f=g.length;d<f;d++){e=g[d];if(a.indexOf(e)>c){h.push(e)}}for(g=b.end,d=0,f=g.length;d<f;d++){e=g[d];if(a.indexOf(e)>c){h.push(e)}}return h},applyElement:function(a){return Ext.Element.create(a)},updateElement:function(a){a.addCls("x-dock-"+this.getDirection())},applyBodyElement:function(a){return Ext.Element.create(a)},updateBodyElement:function(a){this.getElement().append(a)},updateInnerWrapper:function(a,c){var b=this.getBodyElement();if(c&&c.$outerWrapper===this){c.getElement().detach();delete c.$outerWrapper}if(a){a.setSizeState(this.getSizeState());a.$outerWrapper=this;b.append(a.getElement())}},updateSizeState:function(b){var a=this.getInnerWrapper();this.getElement().setSizeState(b);if(a){a.setSizeState(b)}},destroy:function(){var c=this.getInnerWrapper(),b=this.$outerWrapper,a;if(c){if(b){b.setInnerWrapper(c)}else{a=c.getElement();if(!a.isDestroyed){a.replace(this.getElement())}delete c.$outerWrapper}}delete this.$outerWrapper;this.setInnerWrapper(null);this.unlink("_bodyElement","_element");this.callSuper()}},1,0,0,0,0,0,[Ext.layout.wrapper,"BoxDock"],0));(Ext.cmd.derive("Ext.layout.wrapper.Inner",Ext.Base,{config:{sizeState:null,container:null},constructor:function(a){this.initConfig(a)},getElement:function(){return this.getContainer().bodyElement},setInnerWrapper:Ext.emptyFn,getInnerWrapper:Ext.emptyFn},1,0,0,0,0,0,[Ext.layout.wrapper,"Inner"],0));(Ext.cmd.derive("Ext.layout.Default",Ext.layout.Abstract,{isAuto:true,config:{animation:null},centerWrapperClass:"x-center",dockWrapperClass:"x-dock",positionMap:{top:"start",left:"start",middle:"center",bottom:"end",right:"end"},positionDirectionMap:{top:"vertical",bottom:"vertical",left:"horizontal",right:"horizontal"},setContainer:function(a){var b={delegate:"> component"};this.dockedItems=[];Ext.layout.Abstract.prototype.setContainer.apply(this,arguments);a.on("centeredchange","onItemCenteredChange",this,b,"before").on("floatingchange","onItemFloatingChange",this,b,"before").on("dockedchange","onBeforeItemDockedChange",this,b,"before").on("afterdockedchange","onAfterItemDockedChange",this,b)},monitorSizeStateChange:function(){this.monitorSizeStateChange=Ext.emptyFn;this.container.on("sizestatechange","onContainerSizeStateChange",this)},monitorSizeFlagsChange:function(){this.monitorSizeFlagsChange=Ext.emptyFn;this.container.on("sizeflagschange","onContainerSizeFlagsChange",this)},onItemAdd:function(a){var b=a.getDocked();if(b!==null){this.dockItem(a)}else{if(a.isCentered()){this.onItemCenteredChange(a,true)}else{if(a.isFloating()){this.onItemFloatingChange(a,true)}else{this.onItemInnerStateChange(a,true)}}}},onItemInnerStateChange:function(b,a,c){if(a){this.insertInnerItem(b,this.container.innerIndexOf(b))}else{this.removeInnerItem(b)}},insertInnerItem:function(f,d){var b=this.container,h=b.innerElement.dom,e=f.element.dom,g=d!==-1?b.getInnerAt(d+1):null,c=null,a;if(g){a=g.getTranslatable();if(a&&a.getUseWrapper()){c=a.getWrapper().dom}else{c=g?g.element.dom:null}}h.insertBefore(e,c);return this},insertBodyItem:function(c){var a=this.container.setUseBodyElement(true),b=a.bodyElement.dom;if(c.getZIndex()===null){c.setZIndex((a.indexOf(c)+1)*2)}b.insertBefore(c.element.dom,b.firstChild);return this},removeInnerItem:function(a){a.element.detach()},removeBodyItem:function(a){a.setZIndex(null);a.element.detach()},onItemRemove:function(b,a,c){var d=b.getDocked();if(d){this.undockItem(b)}else{if(b.isCentered()){this.onItemCenteredChange(b,false)}else{if(b.isFloating()){this.onItemFloatingChange(b,false)}else{this.onItemInnerStateChange(b,false,c)}}}},onItemMove:function(b,c,a){if(b.isCentered()||b.isFloating()){b.setZIndex((c+1)*2)}else{if(b.isInnerItem()){this.insertInnerItem(b,this.container.innerIndexOf(b))}else{this.undockItem(b);this.dockItem(b)}}},onItemCenteredChange:function(c,a){var b="$centerWrapper";if(a){this.insertBodyItem(c);c.link(b,new Ext.util.Wrapper({className:this.centerWrapperClass},c.element))}else{c.unlink(b);this.removeBodyItem(c)}},onItemFloatingChange:function(a,b){if(b){this.insertBodyItem(a)}else{this.removeBodyItem(a)}},onBeforeItemDockedChange:function(a,c,b){if(b){this.undockItem(a)}},onAfterItemDockedChange:function(a,c,b){if(c){this.dockItem(a)}},onContainerSizeStateChange:function(){var a=this.getDockWrapper();if(a){a.setSizeState(this.container.getSizeState())}},onContainerSizeFlagsChange:function(){var a=this.dockedItems,b,d,c;for(b=0,d=a.length;b<d;b++){c=a[b];this.refreshDockedItemLayoutSizeFlags(c)}},refreshDockedItemLayoutSizeFlags:function(d){var b=this.container,e=this.positionDirectionMap[d.getDocked()],c=(e==="horizontal")?b.LAYOUT_HEIGHT:b.LAYOUT_WIDTH,a=(b.getSizeFlags()&c);d.setLayoutSizeFlags(a)},dockItem:function(s){var b=Ext.layout.wrapper.BoxDock,p=this.dockedItems,g=p.length,h=this.container,t=h.indexOf(s),f=this.positionDirectionMap,u=f[s.getDocked()],r=this.dockInnerWrapper,l,m,v,e,q,k,n,a,d,o,c,j;this.monitorSizeStateChange();this.monitorSizeFlagsChange();if(!r){r=this.link("dockInnerWrapper",new Ext.layout.wrapper.Inner({container:this.container}))}if(g===0){p.push(s);o=new b({container:this.container,direction:u});o.addItem(s);o.getElement().replace(r.getElement());o.setInnerWrapper(r);h.onInitialized("onContainerSizeStateChange",this)}else{for(m=0;m<g;m++){v=p[m];e=h.indexOf(v);if(e>t){n=q||p[0];p.splice(m,0,s);break}q=v}if(!n){n=p[g-1];p.push(s)}a=n.getDocked();d=n.$dockWrapper;l=f[a];if(u===l){d.addItem(s)}else{k=d.getItemsSlice(t);o=new b({container:this.container,direction:u});if(k.length>0){if(k.length===d.itemsCount){c=d;o.setSizeState(c.getSizeState());o.getElement().replace(c.getElement())}else{c=new b({container:this.container,direction:l});c.setInnerWrapper(d.getInnerWrapper());c.addItems(k);d.setInnerWrapper(o)}o.setInnerWrapper(c)}else{j=d.getInnerWrapper();d.setInnerWrapper(null);o.setInnerWrapper(j);d.setInnerWrapper(o)}o.addItem(s)}}h.onInitialized("refreshDockedItemLayoutSizeFlags",this,[s])},getDockWrapper:function(){var a=this.dockedItems;if(a.length>0){return a[0].$dockWrapper}return null},undockItem:function(b){var a=this.dockedItems;if(b.$dockWrapper){b.$dockWrapper.removeItem(b)}Ext.Array.remove(a,b);b.setLayoutSizeFlags(0)},destroy:function(){this.dockedItems.length=0;delete this.dockedItems;Ext.layout.Abstract.prototype.destroy.call(this)}},0,0,0,0,["layout.auto","layout.default"],0,[Ext.layout,"Default"],0));(Ext.cmd.derive("Ext.layout.Box",Ext.layout.Default,{config:{orient:"horizontal",align:"start",pack:"start"},layoutBaseClass:"x-layout-tablebox",itemClass:"x-layout-tablebox-item",setContainer:function(a){Ext.layout.Default.prototype.setContainer.apply(this,arguments);a.innerElement.addCls(this.layoutBaseClass);a.on("flexchange","onItemFlexChange",this,{delegate:"> component"})},onItemInnerStateChange:function(b,a){Ext.layout.Default.prototype.onItemInnerStateChange.apply(this,arguments);b.toggleCls(this.itemClass,a)},onItemFlexChange:function(){}},0,0,0,0,["layout.tablebox"],0,[Ext.layout,"Box"],0));(Ext.cmd.derive("Ext.fx.layout.card.Abstract",Ext.Evented,{isAnimation:true,config:{direction:"left",duration:null,reverse:null,layout:null},updateLayout:function(){this.enable()},enable:function(){var a=this.getLayout();if(a){a.onBefore("activeitemchange","onActiveItemChange",this)}},disable:function(){var a=this.getLayout();if(this.isAnimating){this.stopAnimation()}if(a){a.unBefore("activeitemchange","onActiveItemChange",this)}},onActiveItemChange:Ext.emptyFn,destroy:function(){var a=this.getLayout();if(this.isAnimating){this.stopAnimation()}if(a){a.unBefore("activeitemchange","onActiveItemChange",this)}this.setLayout(null);if(this.observableId){this.fireEvent("destroy",this);this.clearListeners();this.clearManagedListeners()}}},0,0,0,0,0,0,[Ext.fx.layout.card,"Abstract"],0));(Ext.cmd.derive("Ext.fx.State",Ext.Base,{isAnimatable:{"background-color":true,"background-image":true,"background-position":true,"border-bottom-color":true,"border-bottom-width":true,"border-color":true,"border-left-color":true,"border-left-width":true,"border-right-color":true,"border-right-width":true,"border-spacing":true,"border-top-color":true,"border-top-width":true,"border-width":true,bottom:true,color:true,crop:true,"font-size":true,"font-weight":true,height:true,left:true,"letter-spacing":true,"line-height":true,"margin-bottom":true,"margin-left":true,"margin-right":true,"margin-top":true,"max-height":true,"max-width":true,"min-height":true,"min-width":true,opacity:true,"outline-color":true,"outline-offset":true,"outline-width":true,"padding-bottom":true,"padding-left":true,"padding-right":true,"padding-top":true,right:true,"text-indent":true,"text-shadow":true,top:true,"vertical-align":true,visibility:true,width:true,"word-spacing":true,"z-index":true,zoom:true,transform:true},constructor:function(a){this.data={};this.set(a)},setConfig:function(a){this.set(a);return this},setRaw:function(a){this.data=a;return this},clear:function(){return this.setRaw({})},setTransform:function(c,g){var f=this.data,a=Ext.isArray(g),b=f.transform,e,d;if(!b){b=f.transform={translateX:0,translateY:0,translateZ:0,scaleX:1,scaleY:1,scaleZ:1,rotate:0,rotateX:0,rotateY:0,rotateZ:0,skewX:0,skewY:0}}if(typeof c=="string"){switch(c){case"translate":if(a){e=g.length;if(e==0){break}b.translateX=g[0];if(e==1){break}b.translateY=g[1];if(e==2){break}b.translateZ=g[2]}else{b.translateX=g}break;case"rotate":if(a){e=g.length;if(e==0){break}b.rotateX=g[0];if(e==1){break}b.rotateY=g[1];if(e==2){break}b.rotateZ=g[2]}else{b.rotate=g}break;case"scale":if(a){e=g.length;if(e==0){break}b.scaleX=g[0];if(e==1){break}b.scaleY=g[1];if(e==2){break}b.scaleZ=g[2]}else{b.scaleX=g;b.scaleY=g}break;case"skew":if(a){e=g.length;if(e==0){break}b.skewX=g[0];if(e==1){break}b.skewY=g[1]}else{b.skewX=g}break;default:b[c]=g}}else{for(d in c){if(c.hasOwnProperty(d)){g=c[d];this.setTransform(d,g)}}}},set:function(a,d){var c=this.data,b;if(typeof a!="string"){for(b in a){d=a[b];if(b==="transform"){this.setTransform(d)}else{c[b]=d}}}else{if(a==="transform"){this.setTransform(d)}else{c[a]=d}}return this},unset:function(a){var b=this.data;if(b.hasOwnProperty(a)){delete b[a]}return this},getData:function(){return this.data}},1,0,0,0,0,0,[Ext.fx,"State"],0));(Ext.cmd.derive("Ext.fx.animation.Abstract",Ext.Evented,{isAnimation:true,config:{name:"",element:null,before:null,from:{},to:{},after:null,states:{},duration:300,easing:"linear",iteration:1,direction:"normal",delay:0,onBeforeStart:null,onEnd:null,onBeforeEnd:null,scope:null,reverse:null,preserveEndState:false,replacePrevious:true},STATE_FROM:"0%",STATE_TO:"100%",DIRECTION_UP:"up",DIRECTION_DOWN:"down",DIRECTION_LEFT:"left",DIRECTION_RIGHT:"right",stateNameRegex:/^(?:[\d\.]+)%$/,constructor:function(){this.states={};Ext.Evented.prototype.constructor.apply(this,arguments);return this},applyElement:function(a){return Ext.get(a)},applyBefore:function(a,b){if(a){return Ext.factory(a,Ext.fx.State,b)}},applyAfter:function(b,a){if(b){return Ext.factory(b,Ext.fx.State,a)}},setFrom:function(a){return this.setState(this.STATE_FROM,a)},setTo:function(a){return this.setState(this.STATE_TO,a)},getFrom:function(){return this.getState(this.STATE_FROM)},getTo:function(){return this.getState(this.STATE_TO)},setStates:function(a){var c=this.stateNameRegex,b;for(b in a){if(c.test(b)){this.setState(b,a[b])}}return this},getStates:function(){return this.states},stop:function(){this.fireEvent("stop",this)},destroy:function(){this.stop();Ext.Evented.prototype.destroy.call(this)},setState:function(b,d){var a=this.getStates(),c;c=Ext.factory(d,Ext.fx.State,a[b]);if(c){a[b]=c}return this},getState:function(a){return this.getStates()[a]},getData:function(){var l=this.getStates(),e={},g=this.getBefore(),c=this.getAfter(),h=l[this.STATE_FROM],j=l[this.STATE_TO],k=h.getData(),f=j.getData(),d,b,a;for(b in l){if(l.hasOwnProperty(b)){a=l[b];d=a.getData();e[b]=d}}if(Ext.browser.is.AndroidStock2){e["0.0001%"]=k}return{before:g?g.getData():{},after:c?c.getData():{},states:e,from:k,to:f,duration:this.getDuration(),iteration:this.getIteration(),direction:this.getDirection(),easing:this.getEasing(),delay:this.getDelay(),onEnd:this.getOnEnd(),onBeforeEnd:this.getOnBeforeEnd(),onBeforeStart:this.getOnBeforeStart(),scope:this.getScope(),preserveEndState:this.getPreserveEndState(),replacePrevious:this.getReplacePrevious()}}},1,0,0,0,0,0,[Ext.fx.animation,"Abstract"],0));(Ext.cmd.derive("Ext.fx.animation.Slide",Ext.fx.animation.Abstract,{alternateClassName:"Ext.fx.animation.SlideIn",config:{direction:"left",out:false,offset:0,easing:"auto",containerBox:"auto",elementBox:"auto",isElementBoxFit:true,useCssTransform:true},reverseDirectionMap:{up:"down",down:"up",left:"right",right:"left"},applyEasing:function(a){if(a==="auto"){return"ease-"+((this.getOut())?"in":"out")}return a},getContainerBox:function(){var a=this._containerBox;if(a==="auto"){a=this.getElement().getParent().getPageBox()}return a},getElementBox:function(){var a=this._elementBox;if(this.getIsElementBoxFit()){return this.getContainerBox()}if(a==="auto"){a=this.getElement().getPageBox()}return a},getData:function(){var q=this.getElementBox(),c=this.getContainerBox(),g=q?q:c,o=this.getFrom(),p=this.getTo(),f=this.getOut(),e=this.getOffset(),n=this.getDirection(),b=this.getUseCssTransform(),h=this.getReverse(),d=0,a=0,m,k,l,j;if(h){n=this.reverseDirectionMap[n]}switch(n){case this.DIRECTION_UP:if(f){a=c.top-g.top-g.height-e}else{a=c.bottom-g.bottom+g.height+e}break;case this.DIRECTION_DOWN:if(f){a=c.bottom-g.bottom+g.height+e}else{a=c.top-g.height-g.top-e}break;case this.DIRECTION_RIGHT:if(f){d=c.right-g.right+g.width+e}else{d=c.left-g.left-g.width-e}break;case this.DIRECTION_LEFT:if(f){d=c.left-g.left-g.width-e}else{d=c.right-g.right+g.width+e}break}m=(f)?0:d;k=(f)?0:a;if(b){o.setTransform({translateX:m,translateY:k})}else{o.set("left",m);o.set("top",k)}l=(f)?d:0;j=(f)?a:0;if(b){p.setTransform({translateX:l,translateY:j})}else{p.set("left",l);p.set("top",j)}return Ext.fx.animation.Abstract.prototype.getData.apply(this,arguments)}},0,0,0,0,["animation.slide","animation.slideIn"],0,[Ext.fx.animation,"Slide",Ext.fx.animation,"SlideIn"],0));(Ext.cmd.derive("Ext.fx.animation.SlideOut",Ext.fx.animation.Slide,{config:{out:true}},0,0,0,0,["animation.slideOut"],0,[Ext.fx.animation,"SlideOut"],0));(Ext.cmd.derive("Ext.fx.animation.Fade",Ext.fx.animation.Abstract,{alternateClassName:"Ext.fx.animation.FadeIn",config:{out:false,before:{display:null,opacity:0},after:{opacity:null},reverse:null},updateOut:function(a){var c=this.getTo(),b=this.getFrom();if(a){b.set("opacity",1);c.set("opacity",0)}else{b.set("opacity",0);c.set("opacity",1)}}},0,0,0,0,["animation.fade","animation.fadeIn"],0,[Ext.fx.animation,"Fade",Ext.fx.animation,"FadeIn"],0));(Ext.cmd.derive("Ext.fx.animation.FadeOut",Ext.fx.animation.Fade,{config:{out:true,before:{}}},0,0,0,0,["animation.fadeOut"],0,[Ext.fx.animation,"FadeOut"],0));(Ext.cmd.derive("Ext.fx.animation.Flip",Ext.fx.animation.Abstract,{config:{easing:"ease-in",direction:"right",half:false,out:null},getData:function(){var h=this.getFrom(),j=this.getTo(),g=this.getDirection(),b=this.getOut(),m=this.getHalf(),c=(m)?90:180,e=1,a=1,l=0,k=0,f=0,d=0;if(b){a=0.8}else{e=0.8}switch(g){case this.DIRECTION_UP:if(b){f=c}else{l=-c}break;case this.DIRECTION_DOWN:if(b){f=-c}else{l=c}break;case this.DIRECTION_RIGHT:if(b){d=c}else{k=-c}break;case this.DIRECTION_LEFT:if(b){d=-c}else{k=c}break}h.setTransform({rotateX:l,rotateY:k,scale:e});j.setTransform({rotateX:f,rotateY:d,scale:a});return Ext.fx.animation.Abstract.prototype.getData.apply(this,arguments)}},0,0,0,0,["animation.flip"],0,[Ext.fx.animation,"Flip"],0));(Ext.cmd.derive("Ext.fx.animation.Pop",Ext.fx.animation.Abstract,{alternateClassName:"Ext.fx.animation.PopIn",config:{out:false,before:{display:null,opacity:0},after:{opacity:null}},getData:function(){var c=this.getTo(),b=this.getFrom(),a=this.getOut();if(a){b.set("opacity",1);b.setTransform({scale:1});c.set("opacity",0);c.setTransform({scale:0})}else{b.set("opacity",0);b.setTransform({scale:0});c.set("opacity",1);c.setTransform({scale:1})}return Ext.fx.animation.Abstract.prototype.getData.apply(this,arguments)}},0,0,0,0,["animation.pop","animation.popIn"],0,[Ext.fx.animation,"Pop",Ext.fx.animation,"PopIn"],0));(Ext.cmd.derive("Ext.fx.animation.PopOut",Ext.fx.animation.Pop,{config:{out:true,before:{}}},0,0,0,0,["animation.popOut"],0,[Ext.fx.animation,"PopOut"],0));(Ext.cmd.derive("Ext.fx.Animation",Ext.Base,{constructor:function(b){var a=Ext.fx.animation.Abstract,c;if(typeof b=="string"){c=b;b={}}else{if(b&&b.type){c=b.type}}if(c){if(Ext.browser.is.AndroidStock2){if(c=="pop"){c="fade"}if(c=="popIn"){c="fadeIn"}if(c=="popOut"){c="fadeOut"}}a=Ext.ClassManager.getByAlias("animation."+c)}return Ext.factory(b,a)}},1,0,0,0,0,0,[Ext.fx,"Animation"],0));(Ext.cmd.derive("Ext.fx.layout.card.Style",Ext.fx.layout.card.Abstract,{config:{inAnimation:{before:{visibility:null},preserveEndState:false,replacePrevious:true},outAnimation:{preserveEndState:false,replacePrevious:true}},constructor:function(b){var c,a;this.initConfig(b);this.endAnimationCounter=0;c=this.getInAnimation();a=this.getOutAnimation();c.on("animationend","incrementEnd",this);a.on("animationend","incrementEnd",this)},updateDirection:function(a){this.getInAnimation().setDirection(a);this.getOutAnimation().setDirection(a)},updateDuration:function(a){this.getInAnimation().setDuration(a);this.getOutAnimation().setDuration(a)},updateReverse:function(a){this.getInAnimation().setReverse(a);this.getOutAnimation().setReverse(a)},incrementEnd:function(){this.endAnimationCounter++;if(this.endAnimationCounter>1){this.endAnimationCounter=0;this.fireEvent("animationend",this)}},applyInAnimation:function(b,a){return Ext.factory(b,Ext.fx.Animation,a)},applyOutAnimation:function(b,a){return Ext.factory(b,Ext.fx.Animation,a)},updateInAnimation:function(a){a.setScope(this)},updateOutAnimation:function(a){a.setScope(this)},onActiveItemChange:function(a,e,h,j,d){var b=this.getInAnimation(),g=this.getOutAnimation(),f,c;if(e&&h&&h.isPainted()){f=e.renderElement;c=h.renderElement;b.setElement(f);g.setElement(c);g.setOnBeforeEnd(function(k,l){if(l||Ext.Animator.hasRunningAnimations(k)){d.firingArguments[1]=null;d.firingArguments[2]=null}});g.setOnEnd(function(){d.resume()});f.dom.style.setProperty("visibility","hidden","important");e.show();Ext.Animator.run([g,b]);d.pause()}},destroy:function(){Ext.destroy(this.getInAnimation(),this.getOutAnimation());Ext.fx.layout.card.Abstract.prototype.destroy.apply(this,arguments)}},1,0,0,0,0,0,[Ext.fx.layout.card,"Style"],0));(Ext.cmd.derive("Ext.fx.layout.card.Slide",Ext.fx.layout.card.Style,{config:{inAnimation:{type:"slide",easing:"ease-out"},outAnimation:{type:"slide",easing:"ease-out",out:true}},updateReverse:function(a){this.getInAnimation().setReverse(a);this.getOutAnimation().setReverse(a)}},0,0,0,0,["fx.layout.card.slide"],0,[Ext.fx.layout.card,"Slide"],0));(Ext.cmd.derive("Ext.fx.layout.card.Cover",Ext.fx.layout.card.Style,{config:{reverse:null,inAnimation:{before:{"z-index":100},after:{"z-index":0},type:"slide",easing:"ease-out"},outAnimation:{easing:"ease-out",from:{opacity:0.99},to:{opacity:1},out:true}},updateReverse:function(a){this.getInAnimation().setReverse(a);this.getOutAnimation().setReverse(a)}},0,0,0,0,["fx.layout.card.cover"],0,[Ext.fx.layout.card,"Cover"],0));(Ext.cmd.derive("Ext.fx.layout.card.Reveal",Ext.fx.layout.card.Style,{config:{inAnimation:{easing:"ease-out",from:{opacity:0.99},to:{opacity:1}},outAnimation:{before:{"z-index":100},after:{"z-index":0},type:"slide",easing:"ease-out",out:true}},updateReverse:function(a){this.getInAnimation().setReverse(a);this.getOutAnimation().setReverse(a)}},0,0,0,0,["fx.layout.card.reveal"],0,[Ext.fx.layout.card,"Reveal"],0));(Ext.cmd.derive("Ext.fx.layout.card.Fade",Ext.fx.layout.card.Style,{config:{reverse:null,inAnimation:{type:"fade",easing:"ease-out"},outAnimation:{type:"fade",easing:"ease-out",out:true}}},0,0,0,0,["fx.layout.card.fade"],0,[Ext.fx.layout.card,"Fade"],0));(Ext.cmd.derive("Ext.fx.layout.card.Flip",Ext.fx.layout.card.Style,{config:{duration:500,inAnimation:{type:"flip",half:true,easing:"ease-out",before:{"backface-visibility":"hidden"},after:{"backface-visibility":null}},outAnimation:{type:"flip",half:true,easing:"ease-in",before:{"backface-visibility":"hidden"},after:{"backface-visibility":null},out:true}},onActiveItemChange:function(e,c,f,b,a){var d=c.element.getParent();d.addCls("x-layout-card-perspective");this.on("animationend",function(){d.removeCls("x-layout-card-perspective")},this,{single:true});Ext.fx.layout.card.Style.prototype.onActiveItemChange.apply(this,arguments)},updateDuration:function(d){var c=d/2,b=this.getInAnimation(),a=this.getOutAnimation();b.setDelay(c);b.setDuration(c);a.setDuration(c)}},0,0,0,0,["fx.layout.card.flip"],0,[Ext.fx.layout.card,"Flip"],0));(Ext.cmd.derive("Ext.fx.layout.card.Pop",Ext.fx.layout.card.Style,{config:{duration:500,inAnimation:{type:"pop",easing:"ease-out"},outAnimation:{type:"pop",easing:"ease-in",out:true}},updateDuration:function(d){var c=d/2,b=this.getInAnimation(),a=this.getOutAnimation();b.setDelay(c);b.setDuration(c);a.setDuration(c)}},0,0,0,0,["fx.layout.card.pop"],0,[Ext.fx.layout.card,"Pop"],0));(Ext.cmd.derive("Ext.fx.layout.card.Scroll",Ext.fx.layout.card.Abstract,{config:{duration:150},constructor:function(a){this.initConfig(a)},getEasing:function(){var a=this.easing;if(!a){this.easing=a=new Ext.fx.easing.Linear()}return a},updateDuration:function(a){this.getEasing().setDuration(a)},onActiveItemChange:function(a,d,m,n,c){var j=this.getDirection(),g=this.getEasing(),l,e,b,h,k,f;if(d&&m){if(this.isAnimating){this.stopAnimation()}d.setWidth("100%");d.setHeight("100%");l=this.getLayout().container.innerElement;h=l.getWidth();k=l.getHeight();e=d.renderElement;b=m.renderElement;this.oldItem=m;this.newItem=d;this.currentEventController=c;this.containerElement=l;this.isReverse=f=this.getReverse();d.show();if(j=="right"){j="left";this.isReverse=f=!f}else{if(j=="down"){j="up";this.isReverse=f=!f}}if(j=="left"){if(f){g.setConfig({startValue:h,endValue:0});l.dom.scrollLeft=h;b.setLeft(h)}else{g.setConfig({startValue:0,endValue:h});e.setLeft(h)}}else{if(f){g.setConfig({startValue:k,endValue:0});l.dom.scrollTop=k;b.setTop(k)}else{g.setConfig({startValue:0,endValue:k});e.setTop(k)}}this.startAnimation();c.pause()}},startAnimation:function(){this.isAnimating=true;this.getEasing().setStartTime(Date.now());Ext.AnimationQueue.start(this.doAnimationFrame,this)},doAnimationFrame:function(){var d=this.getEasing(),c=this.getDirection(),a="scrollTop",b;if(c=="left"||c=="right"){a="scrollLeft"}if(d.isEnded){this.stopAnimation()}else{b=d.getValue();this.containerElement.dom[a]=b}},stopAnimation:function(){var c=this,e=c.getDirection(),a="setTop",d=c.oldItem,b=c.newItem;if(e=="left"||e=="right"){a="setLeft"}c.currentEventController.resume();if(c.isReverse&&d&&d.renderElement&&d.renderElement.dom){d.renderElement[a](null)}else{if(b&&b.renderElement&&b.renderElement.dom){b.renderElement[a](null)}}Ext.AnimationQueue.stop(this.doAnimationFrame,this);c.isAnimating=false;c.fireEvent("animationend",c)}},1,0,0,0,["fx.layout.card.scroll"],0,[Ext.fx.layout.card,"Scroll"],0));(Ext.cmd.derive("Ext.fx.layout.Card",Ext.Base,{constructor:function(b){var a=Ext.fx.layout.card.Abstract,c;if(!b){return null}if(typeof b=="string"){c=b;b={}}else{if(b.type){c=b.type}}b.elementBox=false;if(c){if(Ext.browser.is.AndroidStock2){if(c!="fade"){c="scroll"}}a=Ext.ClassManager.getByAlias("fx.layout.card."+c)}return Ext.factory(b,a)}},1,0,0,0,0,0,[Ext.fx.layout,"Card"],0));(Ext.cmd.derive("Ext.layout.Card",Ext.layout.Default,{isCard:true,layoutClass:"x-layout-card",itemClass:"x-layout-card-item",applyAnimation:function(a){return new Ext.fx.layout.Card(a)},updateAnimation:function(b,a){if(b&&b.isAnimation){b.setLayout(this)}if(a){a.destroy()}},setContainer:function(a){Ext.layout.Default.prototype.setContainer.apply(this,arguments);a.innerElement.addCls(this.layoutClass);a.onInitialized("onContainerInitialized",this)},onContainerInitialized:function(){var a=this.container,b=a.getInnerAt(0),c=a.getActiveItem();if(c){c.show();if(b&&b!==c){b.hide()}}a.on("activeitemchange","onContainerActiveItemChange",this)},onContainerActiveItemChange:function(a){this.relayEvent(arguments,"doActiveItemChange")},onItemInnerStateChange:function(c,b,d){Ext.layout.Default.prototype.onItemInnerStateChange.apply(this,arguments);var a=this.container,e=a.getActiveItem();c.toggleCls(this.itemClass,b);c.setLayoutSizeFlags(b?a.LAYOUT_BOTH:0);if(b){if(e!==a.innerIndexOf(c)&&e!==c&&c!==a.pendingActiveItem){c.hide()}}else{if(!d&&!c.isDestroyed&&c.isDestroying!==true){c.show()}}},doActiveItemChange:function(b,c,a){if(a){a.hide()}if(c){c.show()}},destroy:function(){Ext.layout.Default.prototype.destroy.apply(this,arguments);Ext.destroy(this.getAnimation())}},0,0,0,0,["layout.card"],0,[Ext.layout,"Card"],0));(Ext.cmd.derive("Ext.layout.Fit",Ext.layout.Default,{isFit:true,layoutClass:"x-layout-fit",itemClass:"x-layout-fit-item",setContainer:function(a){Ext.layout.Default.prototype.setContainer.apply(this,arguments);a.innerElement.addCls(this.layoutClass);this.onContainerSizeFlagsChange();this.monitorSizeFlagsChange()},onContainerSizeFlagsChange:function(){var a=this.container,b=a.getSizeFlags(),g=Boolean(b&a.LAYOUT_STRETCHED),f=a.innerItems,c,e,d;Ext.layout.Default.prototype.onContainerSizeFlagsChange.call(this);for(c=0,e=f.length;c<e;c++){d=f[c];d.setLayoutSizeFlags(b)}a.innerElement.toggleCls("x-stretched",g)},onItemInnerStateChange:function(b,a){Ext.layout.Default.prototype.onItemInnerStateChange.apply(this,arguments);b.toggleCls(this.itemClass,a);b.setLayoutSizeFlags(a?this.container.getSizeFlags():0)}},0,0,0,0,["layout.fit"],0,[Ext.layout,"Fit"],0));(Ext.cmd.derive("Ext.layout.FlexBox",Ext.layout.Box,{config:{align:"stretch"},layoutBaseClass:"x-layout-box",itemClass:"x-layout-box-item",setContainer:function(a){Ext.layout.Box.prototype.setContainer.apply(this,arguments);this.monitorSizeFlagsChange()},applyOrient:function(a){return a},updateOrient:function(c,b){var a=this.container,d={delegate:"> component"};if(c==="horizontal"){this.sizePropertyName="width"}else{this.sizePropertyName="height"}a.innerElement.swapCls("x-"+c,"x-"+b);if(b){a.un(b==="horizontal"?"widthchange":"heightchange","onItemSizeChange",this,d);this.redrawContainer()}a.on(c==="horizontal"?"widthchange":"heightchange","onItemSizeChange",this,d)},onItemInnerStateChange:function(d,c){Ext.layout.Box.prototype.onItemInnerStateChange.apply(this,arguments);var a,b;d.toggleCls(this.itemClass,c);if(c){a=d.getFlex();b=d.get(this.sizePropertyName);if(a){this.doItemFlexChange(d,a)}else{if(b){this.doItemSizeChange(d,b)}}}this.refreshItemSizeState(d)},refreshItemSizeState:function(e){var c=e.isInnerItem(),a=this.container,f=a.LAYOUT_HEIGHT,d=a.LAYOUT_WIDTH,g=this.sizePropertyName,b=0,h=a.getSizeFlags();if(c){b|=a.LAYOUT_STRETCHED;if(this.getAlign()==="stretch"){b|=h&(g==="width"?f:d)}if(e.getFlex()){b|=h&(g==="width"?d:f)}}e.setLayoutSizeFlags(b)},refreshAllItemSizedStates:function(){var d=this.container.innerItems,a,c,b;for(a=0,c=d.length;a<c;a++){b=d[a];this.refreshItemSizeState(b)}},onContainerSizeFlagsChange:function(){this.refreshAllItemSizedStates();Ext.layout.Box.prototype.onContainerSizeFlagsChange.apply(this,arguments)},onItemSizeChange:function(b,a){if(b.isInnerItem()){this.doItemSizeChange(b,a)}},doItemSizeChange:function(b,a){if(a){b.setFlex(null);this.redrawContainer()}},onItemFlexChange:function(b,a){if(b.isInnerItem()){this.doItemFlexChange(b,a);this.refreshItemSizeState(b)}},doItemFlexChange:function(b,a){this.setItemFlex(b,a);if(a){b.set(this.sizePropertyName,null)}else{this.redrawContainer()}},redrawContainer:function(){var a=this.container,b=a.element.dom.parentNode;if(b&&b.nodeType!==11){a.innerElement.redraw()}},setItemFlex:function(c,a){var b=c.element;b.toggleCls("x-flexed",!!a);if(!a){a=""}else{a=String(a)}if(Ext.browser.is.WebKit){b.dom.style.setProperty("-webkit-box-flex",a,null)}else{if(Ext.browser.is.IE){b.dom.style.setProperty("-ms-flex",a+" 0 0px",null)}else{b.dom.style.setProperty("flex",a+" 0 0px",null)}}},convertPosition:function(a){var b=this.positionMap;if(b.hasOwnProperty(a)){return b[a]}return a},applyAlign:function(a){return this.convertPosition(a)},updateAlign:function(c,b){var a=this.container;a.innerElement.swapCls(c,b,true,"x-align");if(b!==undefined){this.refreshAllItemSizedStates()}},applyPack:function(a){return this.convertPosition(a)},updatePack:function(a,b){this.container.innerElement.swapCls(a,b,true,"x-pack")}},0,0,0,0,["layout.box"],0,[Ext.layout,"FlexBox"],0));(Ext.cmd.derive("Ext.layout.Float",Ext.layout.Default,{config:{direction:"left"},layoutClass:"layout-float",itemClass:"layout-float-item",setContainer:function(a){Ext.layout.Default.prototype.setContainer.apply(this,arguments);a.innerElement.addCls(this.layoutClass)},onItemInnerStateChange:function(b,a){Ext.layout.Default.prototype.onItemInnerStateChange.apply(this,arguments);b.toggleCls(this.itemClass,a)},updateDirection:function(c,a){var b="direction-";this.container.innerElement.swapCls(b+c,b+a)}},0,0,0,0,["layout.float"],0,[Ext.layout,"Float"],0));(Ext.cmd.derive("Ext.layout.HBox",Ext.layout.FlexBox,{},0,0,0,0,["layout.hbox"],0,[Ext.layout,"HBox"],0));(Ext.cmd.derive("Ext.layout.VBox",Ext.layout.FlexBox,{config:{orient:"vertical"}},0,0,0,0,["layout.vbox"],0,[Ext.layout,"VBox"],0));(Ext.cmd.derive("Ext.layout.wrapper.Dock",Ext.Base,{config:{direction:"horizontal",element:{className:"x-dock"},bodyElement:{className:"x-dock-body"},innerWrapper:null,sizeState:false,container:null},positionMap:{top:"start",left:"start",bottom:"end",right:"end"},constructor:function(a){this.items={start:[],end:[]};this.itemsCount=0;this.initConfig(a)},addItems:function(a){var b,d,c;for(b=0,d=a.length;b<d;b++){c=a[b];this.addItem(c)}},addItem:function(o){var p=o.getDocked(),h=this.positionMap[p],b=o.$dockWrapper,c=this.getContainer(),j=c.indexOf(o),m=this.items,l=m[h],a,g,f,k,n,e,d;if(b){b.removeItem(o)}o.$dockWrapper=this;a=o.link("$dockItemWrapper",new Ext.util.Wrapper({className:"x-dock-item"}));o.addCls("x-docked-"+p);g=a.element;for(f=0,k=l.length;f<k;f++){n=l[f];d=c.indexOf(n);if(d>j){e=n.element;l.splice(f,0,o);break}}if(!e){l.push(o);e=this.getBodyElement()}this.itemsCount++;if(h==="start"){g.insertBefore(e)}else{g.insertAfter(e)}a.wrap(o.element);a.bindSize(this.getDirection()==="horizontal"?"width":"height")},removeItem:function(c){var a=c.getDocked(),b=this.items[this.positionMap[a]];c.removeCls("x-docked-"+a);Ext.Array.remove(b,c);c.unlink("$dockItemWrapper");c.element.detach();delete c.$dockWrapper;if(--this.itemsCount===0){this.destroy()}},getItemsSlice:function(c){var a=this.getContainer(),b=this.items,h=[],g,d,f,e;for(g=b.start,d=0,f=g.length;d<f;d++){e=g[d];if(a.indexOf(e)>c){h.push(e)}}for(g=b.end,d=0,f=g.length;d<f;d++){e=g[d];if(a.indexOf(e)>c){h.push(e)}}return h},applyElement:function(a){return Ext.Element.create(a)},updateElement:function(a){a.addCls("x-dock-"+this.getDirection())},applyBodyElement:function(a){return Ext.Element.create(a)},updateBodyElement:function(a){this.getElement().append(a)},updateInnerWrapper:function(a,c){var b=this.getBodyElement();if(c&&c.$outerWrapper===this){b.remove(c.getElement());delete c.$outerWrapper}if(a){a.setSizeState(this.getSizeState());a.$outerWrapper=this;b.append(a.getElement())}},updateSizeState:function(b){var a=this.getInnerWrapper();this.getElement().setSizeState(b);if(a){a.setSizeState(b)}},destroy:function(){var b=this.getInnerWrapper(),a=this.$outerWrapper;if(b){if(a){a.setInnerWrapper(b)}else{b.getElement().replace(this.getElement());delete b.$outerWrapper}}delete this.$outerWrapper;this.setInnerWrapper(null);this.unlink("_bodyElement","_element");this.callSuper()}},1,0,0,0,0,0,[Ext.layout.wrapper,"Dock"],0));(Ext.cmd.derive("Ext.util.Filter",Ext.Base,{isFilter:true,config:{property:null,value:null,filterFn:Ext.emptyFn,anyMatch:false,exactMatch:false,caseSensitive:false,root:null,id:undefined,scope:null},applyId:function(a){if(!a){if(this.getProperty()){a=this.getProperty()+"-"+String(this.getValue())}if(!a){a=Ext.id(null,"ext-filter-")}}return a},constructor:function(a){this.initConfig(a)},applyFilterFn:function(b){if(b===Ext.emptyFn){b=this.getInitialConfig("filter");if(b){return b}var a=this.getValue();if(!this.getProperty()&&!a&&a!==0){return Ext.emptyFn}else{return this.createFilterFn()}}return b},createFilterFn:function(){var a=this,b=a.createValueMatcher();return function(d){var c=a.getRoot(),e=a.getProperty();if(c){d=d[c]}return b.test(d[e])}},createValueMatcher:function(){var d=this,e=d.getValue(),f=d.getAnyMatch(),c=d.getExactMatch(),a=d.getCaseSensitive(),b=Ext.String.escapeRegex;if(e===null||e===undefined||!e.exec){e=String(e);if(f===true){e=b(e)}else{e="^"+b(e);if(c===true){e+="$"}}e=new RegExp(e,a?"":"i")}return e}},1,0,0,0,0,0,[Ext.util,"Filter"],0));(Ext.cmd.derive("Ext.util.AbstractMixedCollection",Ext.Base,{constructor:function(b,a){var c=this;c.items=[];c.map={};c.keys=[];c.length=0;c.allowFunctions=b===true;if(a){c.getKey=a}c.mixins.observable.constructor.call(c)},allowFunctions:false,add:function(b,e){var d=this,f=e,c=b,a;if(arguments.length==1){f=c;c=d.getKey(f)}if(typeof c!="undefined"&&c!==null){a=d.map[c];if(typeof a!="undefined"){return d.replace(c,f)}d.map[c]=f}d.length++;d.items.push(f);d.keys.push(c);d.fireEvent("add",d.length-1,f,c);return f},getKey:function(a){return a.id},replace:function(c,e){var d=this,a,b;if(arguments.length==1){e=arguments[0];c=d.getKey(e)}a=d.map[c];if(typeof c=="undefined"||c===null||typeof a=="undefined"){return d.add(c,e)}b=d.indexOfKey(c);d.items[b]=e;d.map[c]=e;d.fireEvent("replace",c,a,e);return e},addAll:function(f){var e=this,d=0,b,a,c;if(arguments.length>1||Ext.isArray(f)){b=arguments.length>1?arguments:f;for(a=b.length;d<a;d++){e.add(b[d])}}else{for(c in f){if(f.hasOwnProperty(c)){if(e.allowFunctions||typeof f[c]!="function"){e.add(c,f[c])}}}}},each:function(e,d){var b=[].concat(this.items),c=0,a=b.length,f;for(;c<a;c++){f=b[c];if(e.call(d||f,f,c,a)===false){break}}},eachKey:function(e,d){var f=this.keys,b=this.items,c=0,a=f.length;for(;c<a;c++){e.call(d||window,f[c],b[c],c,a)}},findBy:function(e,d){var f=this.keys,b=this.items,c=0,a=b.length;for(;c<a;c++){if(e.call(d||window,b[c],f[c])){return b[c]}}return null},insert:function(a,b,e){var d=this,c=b,f=e;if(arguments.length==2){f=c;c=d.getKey(f)}if(d.containsKey(c)){d.suspendEvents();d.removeAtKey(c);d.resumeEvents()}if(a>=d.length){return d.add(c,f)}d.length++;Ext.Array.splice(d.items,a,0,f);if(typeof c!="undefined"&&c!==null){d.map[c]=f}Ext.Array.splice(d.keys,a,0,c);d.fireEvent("add",a,f,c);return f},remove:function(a){return this.removeAt(this.indexOf(a))},removeAll:function(a){Ext.each(a||[],function(b){this.remove(b)},this);return this},removeAt:function(a){var c=this,d,b;if(a<c.length&&a>=0){c.length--;d=c.items[a];Ext.Array.erase(c.items,a,1);b=c.keys[a];if(typeof b!="undefined"){delete c.map[b]}Ext.Array.erase(c.keys,a,1);c.fireEvent("remove",d,b);return d}return false},removeAtKey:function(a){return this.removeAt(this.indexOfKey(a))},getCount:function(){return this.length},indexOf:function(a){return Ext.Array.indexOf(this.items,a)},indexOfKey:function(a){return Ext.Array.indexOf(this.keys,a)},get:function(b){var d=this,a=d.map[b],c=a!==undefined?a:(typeof b=="number")?d.items[b]:undefined;return typeof c!="function"||d.allowFunctions?c:null},getAt:function(a){return this.items[a]},getByKey:function(a){return this.map[a]},contains:function(a){return Ext.Array.contains(this.items,a)},containsKey:function(a){return typeof this.map[a]!="undefined"},clear:function(){var a=this;a.length=0;a.items=[];a.keys=[];a.map={};a.fireEvent("clear")},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},sum:function(g,b,h,a){var c=this.extractValues(g,b),f=c.length,e=0,d;h=h||0;a=(a||a===0)?a:f-1;for(d=h;d<=a;d++){e+=c[d]}return e},collect:function(j,e,g){var k=this.extractValues(j,e),a=k.length,b={},c=[],h,f,d;for(d=0;d<a;d++){h=k[d];f=String(h);if((g||!Ext.isEmpty(h))&&!b[f]){b[f]=true;c.push(h)}}return c},extractValues:function(c,a){var b=this.items;if(a){b=Ext.Array.pluck(b,a)}return Ext.Array.pluck(b,c)},getRange:function(f,a){var e=this,c=e.items,b=[],d;if(c.length<1){return b}f=f||0;a=Math.min(typeof a=="undefined"?e.length-1:a,e.length-1);if(f<=a){for(d=f;d<=a;d++){b[b.length]=c[d]}}else{for(d=f;d>=a;d--){b[b.length]=c[d]}}return b},filter:function(d,c,f,a){var b=[],e;if(Ext.isString(d)){b.push(Ext.create("Ext.util.Filter",{property:d,value:c,anyMatch:f,caseSensitive:a}))}else{if(Ext.isArray(d)||d instanceof Ext.util.Filter){b=b.concat(d)}}e=function(g){var m=true,n=b.length,h;for(h=0;h<n;h++){var l=b[h],k=l.getFilterFn(),j=l.getScope();m=m&&k.call(j,g)}return m};return this.filterBy(e)},filterBy:function(e,d){var h=this,a=new this.self(),g=h.keys,b=h.items,f=b.length,c;a.getKey=h.getKey;for(c=0;c<f;c++){if(e.call(d||h,b[c],g[c])){a.add(g[c],b[c])}}return a},findIndex:function(c,b,e,d,a){if(Ext.isEmpty(b,false)){return -1}b=this.createValueMatcher(b,d,a);return this.findIndexBy(function(f){return f&&b.test(f[c])},null,e)},findIndexBy:function(e,d,h){var g=this,f=g.keys,b=g.items,c=h||0,a=b.length;for(;c<a;c++){if(e.call(d||g,b[c],f[c])){return c}}return -1},createValueMatcher:function(c,e,a,b){if(!c.exec){var d=Ext.String.escapeRegex;c=String(c);if(e===true){c=d(c)}else{c="^"+d(c);if(b===true){c+="$"}}c=new RegExp(c,a?"":"i")}return c},clone:function(){var e=this,f=new this.self(),d=e.keys,b=e.items,c=0,a=b.length;for(;c<a;c++){f.add(d[c],b[c])}f.getKey=e.getKey;return f}},1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.util,"AbstractMixedCollection"],0));(Ext.cmd.derive("Ext.util.Sorter",Ext.Base,{isSorter:true,config:{property:null,sorterFn:null,root:null,transform:null,direction:"ASC",id:undefined},constructor:function(a){this.initConfig(a)},applyId:function(a){if(!a){a=this.getProperty();if(!a){a=Ext.id(null,"ext-sorter-")}}return a},createSortFunction:function(b){var c=this,a=c.getDirection().toUpperCase()=="DESC"?-1:1;return function(e,d){return a*b.call(c,e,d)}},defaultSortFn:function(e,c){var g=this,f=g._transform,b=g._root,d,a,h=g._property;if(b!==null&&b!==undefined){e=e[b];c=c[b]}d=e[h];a=c[h];if(f){d=f(d);a=f(a)}return d>a?1:(d<a?-1:0)},updateDirection:function(){this.updateSortFn()},updateSortFn:function(){this.sort=this.createSortFunction(this.getSorterFn()||this.defaultSortFn)},toggle:function(){this.setDirection(Ext.String.toggle(this.getDirection(),"ASC","DESC"))}},1,0,0,0,0,0,[Ext.util,"Sorter"],0));(Ext.cmd.derive("Ext.util.Sortable",Ext.mixin.Mixin,{isSortable:true,mixinConfig:{hooks:{destroy:"destroy"}},defaultSortDirection:"ASC",initSortable:function(){var a=this,b=a.sorters;a.sorters=Ext.create("Ext.util.AbstractMixedCollection",false,function(c){return c.id||c.property});if(b){a.sorters.addAll(a.decodeSorters(b))}},sort:function(g,f,c,e){var d=this,h,b,a;if(Ext.isArray(g)){e=c;c=f;a=g}else{if(Ext.isObject(g)){e=c;c=f;a=[g]}else{if(Ext.isString(g)){h=d.sorters.get(g);if(!h){h={property:g,direction:f};a=[h]}else{if(f===undefined){h.toggle()}else{h.setDirection(f)}}}}}if(a&&a.length){a=d.decodeSorters(a);if(Ext.isString(c)){if(c==="prepend"){g=d.sorters.clone().items;d.sorters.clear();d.sorters.addAll(a);d.sorters.addAll(g)}else{d.sorters.addAll(a)}}else{d.sorters.clear();d.sorters.addAll(a)}if(e!==false){d.onBeforeSort(a)}}if(e!==false){g=d.sorters.items;if(g.length){b=function(l,k){var j=g[0].sort(l,k),n=g.length,m;for(m=1;m<n;m++){j=j||g[m].sort.call(this,l,k)}return j};d.doSort(b)}}return g},onBeforeSort:Ext.emptyFn,decodeSorters:function(f){if(!Ext.isArray(f)){if(f===undefined){f=[]}else{f=[f]}}var d=f.length,g=Ext.util.Sorter,a=this.model?this.model.prototype.fields:null,e,b,c;for(c=0;c<d;c++){b=f[c];if(!(b instanceof g)){if(Ext.isString(b)){b={property:b}}Ext.applyIf(b,{root:this.sortRoot,direction:"ASC"});if(b.fn){b.sorterFn=b.fn}if(typeof b=="function"){b={sorterFn:b}}if(a&&!b.transform){e=a.get(b.property);b.transform=e?e.sortType:undefined}f[c]=Ext.create("Ext.util.Sorter",b)}}return f},getSorters:function(){return this.sorters.items},destroy:function(){this.callSuper();Ext.destroy(this.sorters)}},0,0,0,0,0,0,[Ext.util,"Sortable"],0));(Ext.cmd.derive("Ext.util.MixedCollection",Ext.util.AbstractMixedCollection,{constructor:function(){var a=this;Ext.util.AbstractMixedCollection.prototype.constructor.apply(this,arguments);a.mixins.sortable.initSortable.call(a)},doSort:function(a){this.sortBy(a)},_sort:function(k,a,j){var h=this,d,e,b=String(a).toUpperCase()=="DESC"?-1:1,g=[],l=h.keys,f=h.items;j=j||function(m,c){return m-c};for(d=0,e=f.length;d<e;d++){g[g.length]={key:l[d],value:f[d],index:d}}Ext.Array.sort(g,function(m,c){var n=j(m[k],c[k])*b;if(n===0){n=(m.index<c.index?-1:1)}return n});for(d=0,e=g.length;d<e;d++){f[d]=g[d].value;l[d]=g[d].key}h.fireEvent("sort",h)},sortBy:function(c){var g=this,b=g.items,f=g.keys,e=b.length,a=[],d;for(d=0;d<e;d++){a[d]={key:f[d],value:b[d],index:d}}Ext.Array.sort(a,function(j,h){var k=c(j.value,h.value);if(k===0){k=(j.index<h.index?-1:1)}return k});for(d=0;d<e;d++){b[d]=a[d].value;f[d]=a[d].key}g.fireEvent("sort",g,b,f)},reorder:function(d){var g=this,b=g.items,c=0,f=b.length,a=[],e=[],h;g.suspendEvents();for(h in d){a[d[h]]=b[h]}for(c=0;c<f;c++){if(d[c]==undefined){e.push(b[c])}}for(c=0;c<f;c++){if(a[c]==undefined){a[c]=e.shift()}}g.clear();g.addAll(a);g.resumeEvents();g.fireEvent("sort",g)},sortByKey:function(a,b){this._sort("key",a,b||function(d,c){var f=String(d).toUpperCase(),e=String(c).toUpperCase();return f>e?1:(f<e?-1:0)})}},1,0,0,0,0,[["sortable",Ext.util.Sortable]],[Ext.util,"MixedCollection"],0));(Ext.cmd.derive("Ext.ItemCollection",Ext.util.MixedCollection,{getKey:function(a){return a.getItemId()},has:function(a){return this.map.hasOwnProperty(a.getId())}},0,0,0,0,0,0,[Ext,"ItemCollection"],0));(Ext.cmd.derive("Ext.fx.easing.Momentum",Ext.fx.easing.Abstract,{config:{acceleration:30,friction:0,startVelocity:0},alpha:0,updateFriction:function(b){var a=Math.log(1-(b/10));this.theta=a;this.alpha=a/this.getAcceleration()},updateStartVelocity:function(a){this.velocity=a*this.getAcceleration()},updateAcceleration:function(a){this.velocity=this.getStartVelocity()*a;this.alpha=this.theta/a},getValue:function(){return this.getStartValue()-this.velocity*(1-this.getFrictionFactor())/this.theta},getFrictionFactor:function(){var a=Ext.Date.now()-this.getStartTime();return Math.exp(a*this.alpha)},getVelocity:function(){return this.getFrictionFactor()*this.velocity}},0,0,0,0,0,0,[Ext.fx.easing,"Momentum"],0));(Ext.cmd.derive("Ext.fx.easing.Bounce",Ext.fx.easing.Abstract,{config:{springTension:0.3,acceleration:30,startVelocity:0},getValue:function(){var b=Ext.Date.now()-this.getStartTime(),c=(b/this.getAcceleration()),a=c*Math.pow(Math.E,-this.getSpringTension()*c);return this.getStartValue()+(this.getStartVelocity()*a)}},0,0,0,0,0,0,[Ext.fx.easing,"Bounce"],0));(Ext.cmd.derive("Ext.fx.easing.BoundMomentum",Ext.fx.easing.Abstract,{config:{momentum:null,bounce:null,minMomentumValue:0,maxMomentumValue:0,minVelocity:0.01,startVelocity:0},applyMomentum:function(a,b){return Ext.factory(a,Ext.fx.easing.Momentum,b)},applyBounce:function(a,b){return Ext.factory(a,Ext.fx.easing.Bounce,b)},updateStartTime:function(a){this.getMomentum().setStartTime(a);Ext.fx.easing.Abstract.prototype.updateStartTime.apply(this,arguments)},updateStartVelocity:function(a){this.getMomentum().setStartVelocity(a)},updateStartValue:function(a){this.getMomentum().setStartValue(a)},reset:function(){this.lastValue=null;this.isBouncingBack=false;this.isOutOfBound=false;return Ext.fx.easing.Abstract.prototype.reset.apply(this,arguments)},getValue:function(){var a=this.getMomentum(),k=this.getBounce(),e=a.getStartVelocity(),f=e>0?1:-1,g=this.getMinMomentumValue(),d=this.getMaxMomentumValue(),c=(f==1)?d:g,h=this.lastValue,j,b;if(e===0){return this.getStartValue()}if(!this.isOutOfBound){j=a.getValue();b=a.getVelocity();if(Math.abs(b)<this.getMinVelocity()){this.isEnded=true}if(j>=g&&j<=d){return j}this.isOutOfBound=true;k.setStartTime(Ext.Date.now()).setStartVelocity(b).setStartValue(c)}j=k.getValue();if(!this.isEnded){if(!this.isBouncingBack){if(h!==null){if((f==1&&j<h)||(f==-1&&j>h)){this.isBouncingBack=true}}}else{if(Math.round(j)==c){this.isEnded=true}}}this.lastValue=j;return j}},0,0,0,0,0,0,[Ext.fx.easing,"BoundMomentum"],0));(Ext.cmd.derive("Ext.fx.easing.EaseOut",Ext.fx.easing.Linear,{config:{exponent:4,duration:1500},getValue:function(){var f=Ext.Date.now()-this.getStartTime(),d=this.getDuration(),b=this.getStartValue(),h=this.getEndValue(),a=this.distance,c=f/d,g=1-c,e=1-Math.pow(g,this.getExponent()),j=b+(e*a);if(f>=d){this.isEnded=true;return h}return j}},0,0,0,0,["easing.ease-out"],0,[Ext.fx.easing,"EaseOut"],0));(Ext.cmd.derive("Ext.scroll.Scroller",Ext.Evented,{config:{element:null,direction:"auto",fps:"auto",disabled:null,directionLock:false,momentumEasing:{momentum:{acceleration:30,friction:0.5},bounce:{acceleration:30,springTension:0.3},minVelocity:1},bounceEasing:{duration:400},outOfBoundRestrictFactor:0.5,startMomentumResetTime:300,maxAbsoluteVelocity:6,containerSize:"auto",size:"auto",autoRefresh:true,initialOffset:{x:0,y:0},slotSnapSize:{x:0,y:0},slotSnapOffset:{x:0,y:0},slotSnapEasing:{duration:150},translatable:{translationMethod:"auto",useWrapper:false}},cls:"x-scroll-scroller",containerCls:"x-scroll-container",dragStartTime:0,dragEndTime:0,isDragging:false,isAnimating:false,constructor:function(a){var b=a&&a.element;this.listeners={scope:this,touchstart:"onTouchStart",touchend:"onTouchEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd"};this.minPosition={x:0,y:0};this.startPosition={x:0,y:0};this.position={x:0,y:0};this.velocity={x:0,y:0};this.isAxisEnabledFlags={x:false,y:false};this.flickStartPosition={x:0,y:0};this.flickStartTime={x:0,y:0};this.lastDragPosition={x:0,y:0};this.dragDirection={x:0,y:0};this.initialConfig=a;if(b){this.setElement(b)}return this},applyElement:function(a){if(!a){return}return Ext.get(a)},updateElement:function(a){this.initialize();if(!this.FixedHBoxStretching){a.addCls(this.cls)}if(!this.getDisabled()){this.attachListeneners()}this.onConfigUpdate(["containerSize","size"],"refreshMaxPosition");this.on("maxpositionchange","snapToBoundary");this.on("minpositionchange","snapToBoundary");return this},applyTranslatable:function(b,a){return Ext.factory(b,Ext.util.Translatable,a)},updateTranslatable:function(a){a.setConfig({element:this.getElement(),listeners:{animationframe:"onAnimationFrame",animationend:"onAnimationEnd",scope:this}})},updateFps:function(a){if(a!=="auto"){this.getTranslatable().setFps(a)}},attachListeneners:function(){this.getContainer().on(this.listeners)},detachListeners:function(){this.getContainer().un(this.listeners)},updateDisabled:function(a){if(a){this.detachListeners()}else{this.attachListeneners()}},updateInitialOffset:function(c){if(typeof c=="number"){c={x:c,y:c}}var b=this.position,a,d;b.x=a=c.x;b.y=d=c.y;this.getTranslatable().translate(-a,-d)},applyDirection:function(a){var e=this.getMinPosition(),d=this.getMaxPosition(),c,b;this.givenDirection=a;if(a==="auto"){c=d.x>e.x;b=d.y>e.y;if(c&&b){a="both"}else{if(c){a="horizontal"}else{a="vertical"}}}return a},updateDirection:function(f,e){var b=this.isAxisEnabledFlags,d=this.cls+"-vertical",a=this.cls+"-horizontal",c=this.getElement();if(e==="both"||e==="horizontal"){c.removeCls(a)}if(e==="both"||e==="vertical"){c.removeCls(d)}b.x=b.y=false;if(f==="both"||f==="horizontal"){b.x=true;c.addCls(a)}if(f==="both"||f==="vertical"){b.y=true;c.addCls(d)}},isAxisEnabled:function(a){this.getDirection();return this.isAxisEnabledFlags[a]},applyMomentumEasing:function(b){var a=Ext.fx.easing.BoundMomentum;return{x:Ext.factory(b,a),y:Ext.factory(b,a)}},applyBounceEasing:function(b){var a=Ext.fx.easing.EaseOut;return{x:Ext.factory(b,a),y:Ext.factory(b,a)}},updateBounceEasing:function(a){this.getTranslatable().setEasingX(a.x).setEasingY(a.y)},applySlotSnapEasing:function(b){var a=Ext.fx.easing.EaseOut;return{x:Ext.factory(b,a),y:Ext.factory(b,a)}},getMinPosition:function(){var a=this.minPosition;if(!a){this.minPosition=a={x:0,y:0};this.fireEvent("minpositionchange",this,a)}return a},getMaxPosition:function(){var c=this.maxPosition,a,b;if(!c){a=this.getSize();b=this.getContainerSize();this.maxPosition=c={x:Math.max(0,a.x-b.x),y:Math.max(0,a.y-b.y)};this.fireEvent("maxpositionchange",this,c)}return c},refreshMaxPosition:function(){this.maxPosition=null;this.getMaxPosition()},applyContainerSize:function(b){var c=this.getContainer().dom,a,d;if(!c){return}this.givenContainerSize=b;if(b==="auto"){a=c.offsetWidth;d=c.offsetHeight}else{a=b.x;d=b.y}return{x:a,y:d}},applySize:function(b){var c=this.getElement().dom,a,d;if(!c){return}this.givenSize=b;if(b==="auto"){a=c.offsetWidth;d=c.offsetHeight}else{if(typeof b=="number"){a=b;d=b}else{a=b.x;d=b.y}}return{x:a,y:d}},updateAutoRefresh:function(a){this.getElement().toggleListener(a,"resize","onElementResize",this);this.getContainer().toggleListener(a,"resize","onContainerResize",this)},applySlotSnapSize:function(a){if(typeof a=="number"){return{x:a,y:a}}return a},applySlotSnapOffset:function(a){if(typeof a=="number"){return{x:a,y:a}}return a},getContainer:function(){var a=this.container,b;if(!a){b=this.getElement().getParent();this.container=a=this.FixedHBoxStretching?b.getParent():b;a.addCls(this.containerCls)}return a},refresh:function(){this.stopAnimation();this.getTranslatable().refresh();this.setSize(this.givenSize);this.setContainerSize(this.givenContainerSize);this.setDirection(this.givenDirection);this.fireEvent("refresh",this);return this},onElementResize:function(a,b){this.setSize({x:b.width,y:b.height});this.refresh()},onContainerResize:function(a,b){this.setContainerSize({x:b.width,y:b.height});this.refresh()},scrollTo:function(c,h,g){if(this.isDestroyed){return this}var b=this.getTranslatable(),a=this.position,d=false,f,e;if(this.isAxisEnabled("x")){if(isNaN(c)||typeof c!="number"){c=a.x}else{if(a.x!==c){a.x=c;d=true}}f=-c}if(this.isAxisEnabled("y")){if(isNaN(h)||typeof h!="number"){h=a.y}else{if(a.y!==h){a.y=h;d=true}}e=-h}if(d){if(g!==undefined&&g!==false){b.translateAnimated(f,e,g)}else{this.fireEvent("scroll",this,a.x,a.y);b.translate(f,e)}}return this},scrollToTop:function(b){var a=this.getInitialOffset();return this.scrollTo(a.x,a.y,b)},scrollToEnd:function(c){var b=this.getSize(),a=this.getContainerSize();return this.scrollTo(b.x-a.x,b.y-a.y,c)},scrollBy:function(b,d,c){var a=this.position;b=(typeof b=="number")?b+a.x:null;d=(typeof d=="number")?d+a.y:null;return this.scrollTo(b,d,c)},onTouchStart:function(){this.isTouching=true;this.stopAnimation()},onTouchEnd:function(){var a=this.position;this.isTouching=false;if(!this.isDragging&&this.snapToSlot()){this.fireEvent("scrollstart",this,a.x,a.y)}},onDragStart:function(m){var p=this.getDirection(),g=m.absDeltaX,f=m.absDeltaY,k=this.getDirectionLock(),j=this.startPosition,d=this.flickStartPosition,l=this.flickStartTime,h=this.lastDragPosition,c=this.position,b=this.dragDirection,o=c.x,n=c.y,a=Ext.Date.now();this.isDragging=true;if(k&&p!=="both"){if((p==="horizontal"&&g>f)||(p==="vertical"&&f>g)){m.stopPropagation()}else{this.isDragging=false;return}}h.x=o;h.y=n;d.x=o;d.y=n;j.x=o;j.y=n;l.x=a;l.y=a;b.x=0;b.y=0;this.dragStartTime=a;this.isDragging=true;this.fireEvent("scrollstart",this,o,n)},onAxisDrag:function(j,r){if(!this.isAxisEnabled(j)){return}var h=this.flickStartPosition,m=this.flickStartTime,k=this.lastDragPosition,e=this.dragDirection,g=this.position[j],l=this.getMinPosition()[j],p=this.getMaxPosition()[j],d=this.startPosition[j],q=k[j],o=d-r,c=e[j],n=this.getOutOfBoundRestrictFactor(),f=this.getStartMomentumResetTime(),b=Ext.Date.now(),a;if(o<l){o*=n}else{if(o>p){a=o-p;o=p+a*n}}if(o>q){e[j]=1}else{if(o<q){e[j]=-1}}if((c!==0&&(e[j]!==c))||(b-m[j])>f){h[j]=g;m[j]=b}k[j]=o},onDrag:function(b){if(!this.isDragging){return}var a=this.lastDragPosition;this.onAxisDrag("x",b.deltaX);this.onAxisDrag("y",b.deltaY);this.scrollTo(a.x,a.y)},onDragEnd:function(c){var b,a;if(!this.isDragging){return}this.dragEndTime=Ext.Date.now();this.onDrag(c);this.isDragging=false;b=this.getAnimationEasing("x",c);a=this.getAnimationEasing("y",c);if(b||a){this.getTranslatable().animate(b,a)}else{this.onScrollEnd()}},getAnimationEasing:function(g,k){if(!this.isAxisEnabled(g)){return null}var f=this.position[g],c=this.getMinPosition()[g],j=this.getMaxPosition()[g],a=this.getMaxAbsoluteVelocity(),d=null,b=this.dragEndTime,h=k.flick.velocity[g],l;if(f<c){d=c}else{if(f>j){d=j}}if(d!==null){l=this.getBounceEasing()[g];l.setConfig({startTime:b,startValue:-f,endValue:-d});return l}if(h===0){return null}if(h<-a){h=-a}else{if(h>a){h=a}}if(Ext.browser.is.IE){h*=2}l=this.getMomentumEasing()[g];l.setConfig({startTime:b,startValue:-f,startVelocity:h*1.5,minMomentumValue:-j,maxMomentumValue:0});return l},onAnimationFrame:function(c,b,d){var a=this.position;a.x=-b;a.y=-d;this.fireEvent("scroll",this,a.x,a.y)},onAnimationEnd:function(){this.snapToBoundary();this.onScrollEnd()},stopAnimation:function(){this.getTranslatable().stopAnimation()},onScrollEnd:function(){var a=this.position;if(this.isTouching||!this.snapToSlot()){this.fireEvent("scrollend",this,a.x,a.y)}},snapToSlot:function(){var b=this.getSnapPosition("x"),a=this.getSnapPosition("y"),c=this.getSlotSnapEasing();if(b!==null||a!==null){this.scrollTo(b,a,{easingX:c.x,easingY:c.y});return true}return false},getSnapPosition:function(c){var g=this.getSlotSnapSize()[c],d=null,a,f,e,b;if(g!==0&&this.isAxisEnabled(c)){a=this.position[c];f=this.getSlotSnapOffset()[c];e=this.getMaxPosition()[c];b=Math.floor((a-f)%g);if(b!==0){if(a!==e){if(Math.abs(b)>g/2){d=Math.min(e,a+((b>0)?g-b:b-g))}else{d=a-b}}else{d=a-b}}}return d},snapToBoundary:function(){var g=this.position,c=this.getMinPosition(),f=this.getMaxPosition(),e=c.x,d=c.y,b=f.x,a=f.y,j=Math.round(g.x),h=Math.round(g.y);if(j<e){j=e}else{if(j>b){j=b}}if(h<d){h=d}else{if(h>a){h=a}}this.scrollTo(j,h)},destroy:function(){var c=this.getElement(),b=this.sizeMonitors,a;if(b){b.element.destroy();b.container.destroy()}if(c&&!c.isDestroyed){c.removeCls(this.cls);a=this.getContainer();if(a&&!a.isDestroyed){a.removeCls(this.containerCls)}}Ext.destroy(this.getTranslatable());Ext.Evented.prototype.destroy.apply(this,arguments)}},1,0,0,0,0,0,[Ext.scroll,"Scroller"],function(){}));(function(){var c=0,e=["ms","moz","webkit","o"],b=e.length,a,d;for(a=0;a<b&&!window.requestAnimationFrame;++a){d=e[a];if(window[d+"RequestAnimationFrame"]){window.requestAnimationFrame=window[d+"RequestAnimationFrame"];window.cancelAnimationFrame=window[d+"CancelAnimationFrame"]||window[d+"CancelRequestAnimationFrame"]}}if(!window.Ext){window.Ext={}}Ext.performance={};if(window.performance&&window.performance.now){Ext.performance.now=function(){return window.performance.now()}}else{Ext.performance.now=function(){return Date.now()}}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(j){var f=Ext.performance.now(),g=Math.max(0,16-(f-c)),h=window.setTimeout(function(){j(f+g)},g);c=f+g;return h}}else{Ext.trueRequestAnimationFrames=true}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(f){clearTimeout(f)}}}());(function(a){(Ext.cmd.derive("Ext.AnimationQueue",Ext.Base,{singleton:true,constructor:function(){var b=Ext.Function.bind;this.queue=[];this.taskQueue=[];this.runningQueue=[];this.idleQueue=[];this.isRunning=false;this.isIdle=true;this.run=b(this.run,this);this.whenIdle=b(this.whenIdle,this);this.processIdleQueueItem=b(this.processIdleQueueItem,this);this.processTaskQueueItem=b(this.processTaskQueueItem,this);if(Ext.os.is.iOS){setInterval(this.watch,500)}},start:function(d,c,b){this.queue.push(arguments);if(!this.isRunning){if(this.hasOwnProperty("idleTimer")){clearTimeout(this.idleTimer);delete this.idleTimer}if(this.hasOwnProperty("idleQueueTimer")){clearTimeout(this.idleQueueTimer);delete this.idleQueueTimer}this.isIdle=false;this.isRunning=true;this.doStart()}},watch:function(){if(this.isRunning&&Date.now()-this.lastRunTime>=500){this.run()}},run:function(){if(!this.isRunning){return}var b=this.runningQueue,c,d;this.lastRunTime=Date.now();this.frameStartTime=Ext.performance.now();b.push.apply(b,this.queue);for(c=0,d=b.length;c<d;c++){this.invoke(b[c])}b.length=0;this.doIterate()},doStart:function(){this.animationFrameId=requestAnimationFrame(this.run);this.lastRunTime=Date.now()},doIterate:function(){this.animationFrameId=requestAnimationFrame(this.run)},doStop:function(){cancelAnimationFrame(this.animationFrameId)},stop:function(f,e,c){if(!this.isRunning){return}var b=this.queue,h=b.length,d,g;for(d=0;d<h;d++){g=b[d];if(g[0]===f&&g[1]===e&&g[2]===c){b.splice(d,1);d--;h--}}if(h===0){this.doStop();this.isRunning=false;this.idleTimer=setTimeout(this.whenIdle,100)}},onIdle:function(f,e,b){var d=this.idleQueue,c,g,h;for(c=0,g=d.length;c<g;c++){h=d[c];if(f===h[0]&&e===h[1]&&b===h[2]){return}}d.push(arguments);if(this.isIdle){this.processIdleQueue()}},unIdle:function(f,e,b){var d=this.idleQueue,c,g,h;for(c=0,g=d.length;c<g;c++){h=d[c];if(f===h[0]&&e===h[1]&&b===h[2]){d.splice(c,1);return true}}return false},queueTask:function(d,c,b){this.taskQueue.push(arguments);this.processTaskQueue()},dequeueTask:function(f,e,b){var d=this.taskQueue,c,g,h;for(c=0,g=d.length;c<g;c++){h=d[c];if(f===h[0]&&e===h[1]&&b===h[2]){d.splice(c,1);c--;g--}}},invoke:function(e){var d=e[0],c=e[1],b=e[2];d=(typeof d=="string"?c[d]:d);if(Ext.isArray(b)){d.apply(c,b)}else{d.call(c,b)}},whenIdle:function(){this.isIdle=true;this.processIdleQueue()},processIdleQueue:function(){if(!this.hasOwnProperty("idleQueueTimer")){this.idleQueueTimer=setTimeout(this.processIdleQueueItem,1)}},processIdleQueueItem:function(){delete this.idleQueueTimer;if(!this.isIdle){return}var b=this.idleQueue,c;if(b.length>0){c=b.shift();this.invoke(c);this.processIdleQueue()}},processTaskQueue:function(){if(!this.hasOwnProperty("taskQueueTimer")){this.taskQueueTimer=setTimeout(this.processTaskQueueItem,15)}},processTaskQueueItem:function(){delete this.taskQueueTimer;var b=this.taskQueue,c;if(b.length>0){c=b.shift();this.invoke(c);this.processTaskQueue()}},showFps:function(){if(!Ext.trueRequestAnimationFrames){alert("This browser does not support requestAnimationFrame. The FPS listed will not be accurate")}Ext.onReady(function(){Ext.Viewport.add([{xtype:"component",bottom:50,left:0,width:50,height:20,html:"Average",style:"background-color: black; color: white; text-align: center; line-height: 20px; font-size: 8px;"},{id:"__averageFps",xtype:"component",bottom:0,left:0,width:50,height:50,html:"0",style:"background-color: red; color: white; text-align: center; line-height: 50px;"},{xtype:"component",bottom:50,left:50,width:50,height:20,html:"Min (Last 1k)",style:"background-color: black; color: white; text-align: center; line-height: 20px; font-size: 8px;"},{id:"__minFps",xtype:"component",bottom:0,left:50,width:50,height:50,html:"0",style:"background-color: orange; color: white; text-align: center; line-height: 50px;"},{xtype:"component",bottom:50,left:100,width:50,height:20,html:"Max (Last 1k)",style:"background-color: black; color: white; text-align: center; line-height: 20px; font-size: 8px;"},{id:"__maxFps",xtype:"component",bottom:0,left:100,width:50,height:50,html:"0",style:"background-color: yellow; color: black; text-align: center; line-height: 50px;"},{xtype:"component",bottom:50,left:150,width:50,height:20,html:"Current",style:"background-color: black; color: white; text-align: center; line-height: 20px; font-size: 8px;"},{id:"__currentFps",xtype:"component",bottom:0,left:150,width:50,height:50,html:"0",style:"background-color: green; color: white; text-align: center; line-height: 50px;"}]);Ext.AnimationQueue.resetFps()})},resetFps:function(){var d=Ext.getCmp("__currentFps"),c=Ext.getCmp("__averageFps"),j=Ext.getCmp("__minFps"),h=Ext.getCmp("__maxFps"),e=1000,b=0,g=0,f=0;Ext.AnimationQueue.onFpsChanged=function(k){g++;if(!(g%10)){e=1000;b=0}f+=k;e=Math.min(e,k);b=Math.max(b,k);d.setHtml(Math.round(k));c.setHtml(Math.round(f/g));j.setHtml(Math.round(e));h.setHtml(Math.round(b))}}},1,0,0,0,0,0,[Ext,"AnimationQueue"],function(){}))})(this);(Ext.cmd.derive("Ext.TaskQueue",Ext.Base,{singleton:true,pending:false,mode:true,constructor:function(){this.readQueue=[];this.writeQueue=[];this.run=Ext.Function.bind(this.run,this);this.watch=Ext.Function.bind(this.watch,this);if(Ext.os.is.iOS){setInterval(this.watch,500)}},requestRead:function(c,b,a){this.request(true);this.readQueue.push(arguments)},requestWrite:function(c,b,a){this.request(false);this.writeQueue.push(arguments)},request:function(a){if(!this.pending){this.pendingTime=Date.now();this.pending=true;this.mode=a;if(a){setTimeout(this.run,1)}else{requestAnimationFrame(this.run)}}},watch:function(){if(this.pending&&Date.now()-this.pendingTime>=500){this.run()}},run:function(){this.pending=false;var j=this.readQueue,e=this.writeQueue,c=null,f;if(this.mode){f=j;if(e.length>0){c=false}}else{f=e;if(j.length>0){c=true}}var b=f.slice(),d,g,a,h,k;f.length=0;for(d=0,g=b.length;d<g;d++){a=b[d];h=a[0];k=a[1];if(typeof h=="string"){h=k[h]}if(a.length>2){h.apply(k,a[2])}else{h.call(k)}}b.length=0;if(c!==null){this.request(c)}}},1,0,0,0,0,0,[Ext,"TaskQueue"],0));(Ext.cmd.derive("Ext.scroll.indicator.Abstract",Ext.Component,{config:{baseCls:"x-scroll-indicator",axis:"x",value:null,length:null,minLength:6,hidden:true,ui:"dark",autoHide:true},cachedConfig:{ratio:1,barCls:"x-scroll-bar",active:true},barElement:null,barLength:0,gapLength:0,getElementConfig:function(){return{reference:"barElement",children:[Ext.Component.prototype.getElementConfig.call(this)]}},applyRatio:function(a){if(isNaN(a)||a>1){a=1}return a},refresh:function(){var f=this.barElement,e=f.dom,c=this.getRatio(),b=this.getAxis(),a=(b==="x")?e.offsetWidth:e.offsetHeight,d=a*c;this.barLength=a;this.gapLength=a-d;this.setLength(d);this.updateValue(this.getValue())},updateBarCls:function(a){this.barElement.addCls(a)},updateAxis:function(a){this.element.addCls(this.getBaseCls(),null,a);this.barElement.addCls(this.getBarCls(),null,a)},updateValue:function(f){var b=this.barLength,c=this.gapLength,d=this.getLength(),e,g,a;if(f<=0){g=0;this.updateLength(this.applyLength(d+f*b))}else{if(f>=1){a=Math.round((f-1)*b);e=this.applyLength(d-a);a=d-e;this.updateLength(e);g=c+a}else{g=c*f}}this.setOffset(g)},updateActive:function(a){this.barElement[a?"addCls":"removeCls"]("active")},doSetHidden:function(b){var a=this;if(b){a.getAutoHide()&&a.setOffset(-10000)}else{delete a.lastLength;delete a.lastOffset;a.updateValue(a.getValue())}},applyLength:function(a){return Math.max(this.getMinLength(),a)},updateLength:function(a){a=Math.round(a);if(this.lastLength===a){return}this.lastLength=a;Ext.TaskQueue.requestWrite("doUpdateLength",this,[a])},doUpdateLength:function(c){if(!this.isDestroyed){var b=this.getAxis(),a=this.element;if(b==="x"){a.setWidth(c)}else{a.setHeight(c)}}},setOffset:function(a){a=Math.round(a);if(this.lastOffset===a||this.lastOffset===-10000){return}this.lastOffset=a;Ext.TaskQueue.requestWrite("doSetOffset",this,[a])},doSetOffset:function(c){if(!this.isDestroyed){var b=this.getAxis(),a=this.element;if(b==="x"){a.translate(c,0)}else{a.translate(0,c)}}}},0,0,["component"],{component:true},0,0,[Ext.scroll.indicator,"Abstract"],0));(Ext.cmd.derive("Ext.scroll.indicator.CssTransform",Ext.scroll.indicator.Abstract,{config:{cls:"csstransform"}},0,0,["component"],{component:true},0,0,[Ext.scroll.indicator,"CssTransform"],0));(Ext.cmd.derive("Ext.scroll.indicator.ScrollPosition",Ext.scroll.indicator.Abstract,{config:{cls:"scrollposition"},getElementConfig:function(){var a=Ext.scroll.indicator.Abstract.prototype.getElementConfig.apply(this,arguments);a.children.unshift({className:"x-scroll-bar-stretcher"});return a},updateValue:function(a){if(this.gapLength===0){if(a>=1){a--}this.setOffset(this.barLength*a)}else{this.setOffset(this.gapLength*a)}},doUpdateLength:function(){if(!this.isDestroyed){var a=this.barLength,b=this.element;Ext.scroll.indicator.Abstract.prototype.doUpdateLength.apply(this,arguments);if(this.getAxis()==="x"){b.setLeft(a)}else{b.setTop(a)}}},doSetOffset:function(d){if(!this.isDestroyed){var b=this.barLength,a=this.getMinLength(),c=this.barElement.dom;if(d!==-10000){d=Math.min(b-a,Math.max(d,a-this.getLength()));d=b-d}if(this.getAxis()==="x"){c.scrollLeft=d}else{c.scrollTop=d}}}},0,0,["component"],{component:true},0,0,[Ext.scroll.indicator,"ScrollPosition"],0));(Ext.cmd.derive("Ext.scroll.indicator.Rounded",Ext.scroll.indicator.Abstract,{config:{cls:"rounded"},constructor:function(){Ext.scroll.indicator.Abstract.prototype.constructor.apply(this,arguments);this.transformPropertyName=Ext.browser.getVendorProperyName("transform")},getElementConfig:function(){var a=Ext.scroll.indicator.Abstract.prototype.getElementConfig.call(this);a.children[0].children=[{reference:"startElement"},{reference:"middleElement"},{reference:"endElement"}];return a},refresh:function(){var d=this.getAxis(),c=this.startElement.dom,a=this.endElement.dom,e=this.middleElement,b,f;if(d==="x"){b=c.offsetWidth;f=a.offsetWidth;e.setLeft(b)}else{b=c.offsetHeight;f=a.offsetHeight;e.setTop(b)}this.startElementLength=b;this.endElementLength=f;Ext.scroll.indicator.Abstract.prototype.refresh.call(this)},doUpdateLength:function(c){if(!this.isDestroyed){var b=this.getAxis(),a=this.endElement,e=this.middleElement.dom.style,d=this.endElementLength,h=c-d,g=h-this.startElementLength,f=this.transformPropertyName;if(b==="x"){a.translate(h,0);e[f]="translate3d(0, 0, 0) scaleX("+g+")";e.transform="translate3d(0, 0, 0) scaleX("+g+")"}else{a.translate(0,h);e[f]="translate3d(0, 0, 0) scaleY("+g+")";e.transform="translate3d(0, 0, 0) scaleY("+g+")"}}}},1,0,["component"],{component:true},0,0,[Ext.scroll.indicator,"Rounded"],0));(Ext.cmd.derive("Ext.scroll.Indicator",Ext.Base,{alternateClassName:"Ext.util.Indicator",constructor:function(a){var b=Ext.scroll.indicator;switch(Ext.browser.getPreferredTranslationMethod(a)){case"scrollposition":return new b.ScrollPosition(a);case"csstransform":if(Ext.browser.is.AndroidStock4){return new b.CssTransform(a)}else{return new b.Rounded(a)}}}},1,0,0,0,0,0,[Ext.scroll,"Indicator",Ext.util,"Indicator"],0));(Ext.cmd.derive("Ext.scroll.View",Ext.Evented,{alternateClassName:"Ext.util.ScrollView",config:{indicatorsUi:"dark",element:null,scroller:{},indicators:{x:{axis:"x"},y:{axis:"y"}},indicatorsHidingDelay:100,cls:"x-scroll-view"},processConfig:function(c){if(!c){return null}if(typeof c=="string"){c={direction:c}}c=Ext.merge({},c);var a=c.scroller,b;if(!a){c.scroller=a={}}for(b in c){if(c.hasOwnProperty(b)){if(!this.hasConfig(b)){a[b]=c[b];delete c[b]}}}return c},constructor:function(a){a=this.processConfig(a);this.useIndicators={x:true,y:true};this.doHideIndicators=Ext.Function.bind(this.doHideIndicators,this);this.initConfig(a)},setConfig:function(a){return this.callParent([this.processConfig(a)])},updateIndicatorsUi:function(a){var b=this.getIndicators();b.x.setUi(a);b.y.setUi(a)},applyScroller:function(a,b){return Ext.factory(a,Ext.scroll.Scroller,b)},applyIndicators:function(b,d){var a=Ext.scroll.Indicator,c=this.useIndicators;if(!b){b={}}if(!b.x){c.x=false;b.x={}}if(!b.y){c.y=false;b.y={}}return{x:Ext.factory(b.x,a,d&&d.x),y:Ext.factory(b.y,a,d&&d.y)}},updateIndicators:function(a){this.indicatorsGrid=Ext.Element.create({className:"x-scroll-bar-grid-wrapper",children:[{className:"x-scroll-bar-grid",children:[{children:[{},{children:[a.y.barElement]}]},{children:[{children:[a.x.barElement]},{}]}]}]})},updateScroller:function(a){a.on({scope:this,scrollstart:"onScrollStart",scroll:"onScroll",scrollend:"onScrollEnd",refresh:"refreshIndicators"})},isAxisEnabled:function(a){return this.getScroller().isAxisEnabled(a)&&this.useIndicators[a]},applyElement:function(a){if(a){return Ext.get(a)}},updateElement:function(c){var b=this.getScroller(),a;a=c.getFirstChild().getFirstChild();if(this.FixedHBoxStretching){a=a.getFirstChild()}c.addCls(this.getCls());c.insertFirst(this.indicatorsGrid);b.setElement(a);this.refreshIndicators();return this},showIndicators:function(){var a=this.getIndicators();if(this.hasOwnProperty("indicatorsHidingTimer")){clearTimeout(this.indicatorsHidingTimer);delete this.indicatorsHidingTimer}if(this.isAxisEnabled("x")){a.x.show()}if(this.isAxisEnabled("y")){a.y.show()}},hideIndicators:function(){var a=this.getIndicatorsHidingDelay();if(a>0){this.indicatorsHidingTimer=setTimeout(this.doHideIndicators,a)}else{this.doHideIndicators()}},doHideIndicators:function(){var a=this.getIndicators();if(this.isAxisEnabled("x")){a.x.hide()}if(this.isAxisEnabled("y")){a.y.hide()}},onScrollStart:function(){this.onScroll.apply(this,arguments);this.showIndicators()},onScrollEnd:function(){this.hideIndicators()},onScroll:function(b,a,c){this.setIndicatorValue("x",a);this.setIndicatorValue("y",c)},setIndicatorValue:function(b,f){if(!this.isAxisEnabled(b)){return this}var a=this.getScroller(),c=a.getMaxPosition()[b],e=a.getContainerSize()[b],d;if(c===0){d=f/e;if(f>=0){d+=1}}else{if(f>c){d=1+((f-c)/e)}else{if(f<0){d=f/e}else{d=f/c}}}this.getIndicators()[b].setValue(d)},refreshIndicator:function(d){if(!this.isAxisEnabled(d)){return this}var a=this.getScroller(),b=this.getIndicators()[d],e=a.getContainerSize()[d],f=a.getSize()[d],c=e/f;b.setRatio(c);b.refresh()},refresh:function(){return this.getScroller().refresh()},refreshIndicators:function(){var a=this.getIndicators();a.x.setActive(this.isAxisEnabled("x"));a.y.setActive(this.isAxisEnabled("y"));this.refreshIndicator("x");this.refreshIndicator("y")},destroy:function(){var a=this.getElement(),b=this.getIndicators();Ext.destroy(this.getScroller(),this.indicatorsGrid);if(this.hasOwnProperty("indicatorsHidingTimer")){clearTimeout(this.indicatorsHidingTimer);delete this.indicatorsHidingTimer}if(a&&!a.isDestroyed){a.removeCls(this.getCls())}b.x.destroy();b.y.destroy();delete this.indicatorsGrid;Ext.Evented.prototype.destroy.apply(this,arguments)}},1,0,0,0,0,0,[Ext.scroll,"View",Ext.util,"ScrollView"],0));(Ext.cmd.derive("Ext.behavior.Scrollable",Ext.behavior.Behavior,{constructor:function(){this.listeners={painted:"onComponentPainted",scope:this};Ext.behavior.Behavior.prototype.constructor.apply(this,arguments)},onComponentPainted:function(){this.scrollView.refresh()},setConfig:function(f){var c=this.scrollView,e=this.component,b,d,a,g;if(f){if(!c){this.scrollView=c=new Ext.scroll.View(f);c.on("destroy","onScrollViewDestroy",this);e.setUseBodyElement(true);this.scrollerElement=b=e.innerElement;if(!Ext.feature.has.ProperHBoxStretching){a=c.getScroller();g=(Ext.isObject(f)?f.direction:f)||"auto";if(g!=="vertical"){d=b.wrap();d.addCls("x-translatable-hboxfix");if(g=="horizontal"){d.setStyle({height:"100%"})}this.scrollContainer=d.wrap();c.FixedHBoxStretching=a.FixedHBoxStretching=true}else{this.scrollContainer=b.wrap()}}else{this.scrollContainer=b.wrap()}c.setElement(e.bodyElement);if(e.isPainted()){this.onComponentPainted()}e.on(this.listeners)}else{if(Ext.isString(f)||Ext.isObject(f)){c.setConfig(f)}}}else{if(c){c.destroy()}}return this},getScrollView:function(){return this.scrollView},onScrollViewDestroy:function(){var b=this.component,a=this.scrollerElement;if(!a.isDestroyed){this.scrollerElement.unwrap()}this.scrollContainer.destroy();if(!b.isDestroyed){b.un(this.listeners)}delete this.scrollerElement;delete this.scrollView;delete this.scrollContainer},onComponentDestroy:function(){var a=this.scrollView;if(a){a.destroy()}}},1,0,0,0,0,0,[Ext.behavior,"Scrollable"],0));(Ext.cmd.derive("Ext.util.InputBlocker",Ext.Base,{singleton:true,blockInputs:function(){if(Ext.browser.is.ie){Ext.select(".x-field-text .x-field-input:not(.x-item-disabled) .x-input-el, .x-field-textarea .x-field-input:not(.x-item-disabled) .x-input-el, .x-field-search .x-field-input:not(.x-item-disabled) .x-input-el").each(function(a){if(a.dom.offsetWidth>0){a.dom.setAttribute("disabled",true);a.dom.setAttribute("overlayfix",true)}})}},unblockInputs:function(){if(Ext.browser.is.ie){Ext.select("[overlayfix]").each(function(a){a.dom.removeAttribute("disabled");a.dom.removeAttribute("overlayfix")})}}},0,0,0,0,0,0,[Ext.util,"InputBlocker"],0));(Ext.cmd.derive("Ext.Mask",Ext.Component,{config:{baseCls:"x-mask",transparent:false,top:0,left:0,right:0,bottom:0},initialize:function(){Ext.Component.prototype.initialize.call(this);this.element.on("*","onEvent",this);this.on({hide:"onHide"})},onHide:function(){Ext.util.InputBlocker.unblockInputs();if(Ext.browser.is.AndroidStock4&&Ext.os.version.getMinor()===0){var a=this.element.getFirstChild();if(a){a.redraw()}}},onEvent:function(b){var a=arguments[arguments.length-1];if(a.info.eventName==="tap"){this.fireEvent("tap",this,b);return false}if(b&&b.stopEvent){b.stopEvent()}return false},updateTransparent:function(a){this[a?"addCls":"removeCls"](this.getBaseCls()+"-transparent")}},0,["mask"],["component","mask"],{component:true,mask:true},["widget.mask"],0,[Ext,"Mask"],0));(Ext.cmd.derive("Ext.Container",Ext.Component,{alternateClassName:"Ext.lib.Container",eventedConfig:{activeItem:0,scrollable:null},config:{layout:null,control:{},defaults:null,items:null,autoDestroy:true,defaultType:null,useBodyElement:null,masked:null,modal:null,hideOnMaskTap:null},isContainer:true,constructor:function(a){var b=this;b._items=b.items=new Ext.ItemCollection();b.innerItems=[];b.onItemAdd=b.onFirstItemAdd;Ext.Component.prototype.constructor.apply(this,arguments)},getElementConfig:function(){return{reference:"element",classList:["x-container","x-unsized"],children:[{reference:"innerElement",className:"x-inner"}]}},applyMasked:function(b){var a=true,c;if(b===false){b=true;a=false}c=Ext.factory(b,Ext.Mask,this.getMasked());if(c){this.add(c);c.setHidden(!a)}return c},mask:function(a){this.setMasked(a||true)},unmask:function(){this.setMasked(false)},setParent:function(a){Ext.Component.prototype.setParent.apply(this,arguments);if(a){var b=this.getModal();if(b){a.insertBefore(b,this);b.setZIndex(this.getZIndex()-1)}}},applyModal:function(c,b){var a=true;if(c===false){c=true;a=false}b=Ext.factory(c,Ext.Mask,b);if(b){b.setVisibility(a)}return b},updateModal:function(b){var a=this.getParent();if(a){if(b){a.insertBefore(b,this);b.setZIndex(this.getZIndex()-1)}else{a.remove(b)}}},updateHideOnMaskTap:function(b){var a=this.getModal();if(a){a[b?"on":"un"].call(a,"tap","hide",this)}},updateZIndex:function(b){var a=this.getModal();Ext.Component.prototype.updateZIndex.apply(this,arguments);if(a){a.setZIndex(b-1)}},updateBaseCls:function(a,b){var c=this,d=c.getUi();if(b){this.element.removeCls(b);this.innerElement.removeCls(a,null,"inner");if(d){this.element.removeCls(this.currentUi)}}if(a){this.element.addCls(a);this.innerElement.addCls(a,null,"inner");if(d){this.element.addCls(a,null,d);this.currentUi=a+"-"+d}}},updateUseBodyElement:function(a){if(a){this.link("bodyElement",this.innerElement.wrap({cls:"x-body"}))}},applyItems:function(a,d){if(a){var b=this;b.getDefaultType();b.getDefaults();if(b.initialized&&d.length>0){b.removeAll()}b.add(a);if(b.initialized){var c=b.initialConfig.activeItem||b.config.activeItem||0;b.setActiveItem(c)}}},applyControl:function(c){var a,b,e,d;for(a in c){d=c[a];for(b in d){e=d[b];if(Ext.isObject(e)){e.delegate=a}}d.delegate=a;this.addListener(d)}return c},onFirstItemAdd:function(){delete this.onItemAdd;if(this.innerHtmlElement&&!this.getHtml()){this.innerHtmlElement.destroy();delete this.innerHtmlElement}this.on("innerstatechange","onItemInnerStateChange",this,{delegate:"> component"});return this.onItemAdd.apply(this,arguments)},getLayout:function(){var a=this.layout;if(!a){a=this.link("_layout",this.link("layout",Ext.factory(this._layout||"default",Ext.layout.Default,null,"layout")));a.setContainer(this)}return a},updateDefaultType:function(a){this.defaultItemClass=Ext.ClassManager.getByAlias("widget."+a)},applyDefaults:function(a){if(a){this.factoryItem=this.factoryItemWithDefaults;return a}},factoryItem:function(a){return Ext.factory(a,this.defaultItemClass)},factoryItemWithDefaults:function(c){var b=this,d=b.getDefaults(),a;if(!d){return Ext.factory(c,b.defaultItemClass)}if(c.isComponent){a=c;if(d&&c.isInnerItem()&&!b.has(a)){a.setConfig(d,true)}}else{if(d&&!c.ignoreDefaults){if(!(c.hasOwnProperty("left")&&c.hasOwnProperty("right")&&c.hasOwnProperty("top")&&c.hasOwnProperty("bottom")&&c.hasOwnProperty("docked")&&c.hasOwnProperty("centered"))){c=Ext.mergeIf({},c,d)}}a=Ext.factory(c,b.defaultItemClass)}return a},add:function(a){var e=this,b,d,c,f;if(Ext.isArray(a)){for(b=0,d=a.length;b<d;b++){c=e.factoryItem(a[b]);this.doAdd(c);if(!f&&!this.getActiveItem()&&this.innerItems.length>0&&c.isInnerItem()){f=c}}}else{c=e.factoryItem(a);this.doAdd(c);if(!f&&!this.getActiveItem()&&this.innerItems.length>0&&c.isInnerItem()){f=c}}if(f){this.setActiveItem(f)}return c},doAdd:function(d){var c=this,a=c.getItems(),b;if(!a.has(d)){b=a.length;a.add(d);if(d.isInnerItem()){c.insertInner(d)}d.setParent(c);c.onItemAdd(d,b)}},remove:function(d,b){var c=this,a=c.indexOf(d),e=c.getInnerItems();if(b===undefined){b=c.getAutoDestroy()}if(a!==-1){if(!c.removingAll&&e.length>1&&d===c.getActiveItem()){c.on({activeitemchange:"doRemove",scope:c,single:true,order:"after",args:[d,a,b]});c.doResetActiveItem(e.indexOf(d))}else{c.doRemove(d,a,b);if(e.length===0){c.setActiveItem(null)}}}return c},doResetActiveItem:function(a){if(a===0){this.setActiveItem(1)}else{this.setActiveItem(0)}},doRemove:function(d,a,b){var c=this;c.items.remove(d);if(d.isInnerItem()){c.removeInner(d)}c.onItemRemove(d,a,b);d.setParent(null);if(b){d.destroy()}},removeAll:function(c,f){var a=this.items,e=a.length,b=0,d;if(typeof c!="boolean"){c=this.getAutoDestroy()}f=Boolean(f);this.removingAll=true;for(;b<e;b++){d=a.getAt(b);if(d&&(f||d.isInnerItem())){this.doRemove(d,b,c);b--;e--}}this.setActiveItem(null);this.removingAll=false;return this},getAt:function(a){return this.items.getAt(a)},getInnerAt:function(a){return this.innerItems[a]},removeAt:function(a){var b=this.getAt(a);if(b){this.remove(b)}return this},removeInnerAt:function(a){var b=this.getInnerItems()[a];if(b){this.remove(b)}return this},has:function(a){return this.getItems().indexOf(a)!=-1},hasInnerItem:function(a){return this.innerItems.indexOf(a)!=-1},indexOf:function(a){return this.getItems().indexOf(a)},innerIndexOf:function(a){return this.innerItems.indexOf(a)},insertInner:function(d,b){var a=this.getItems().items,f=this.innerItems,g=f.indexOf(d),c=-1,e;if(g!==-1){f.splice(g,1)}if(typeof b=="number"){do{e=a[++b]}while(e&&!e.isInnerItem());if(e){c=f.indexOf(e);f.splice(c,0,d)}}if(c===-1){f.push(d);c=f.length-1}if(g!==-1){this.onInnerItemMove(d,c,g)}return this},onInnerItemMove:Ext.emptyFn,removeInner:function(a){Ext.Array.remove(this.innerItems,a);return this},insert:function(a,d){var c=this,b;if(Ext.isArray(d)){for(b=d.length-1;b>=0;b--){c.insert(a,d[b])}return c}d=this.factoryItem(d);this.doInsert(a,d);return d},doInsert:function(d,f){var e=this,b=e.items,c=b.length,a,g;g=f.isInnerItem();if(d>c){d=c}if(b[d-1]===f){return e}a=e.indexOf(f);if(a!==-1){if(a<d){d-=1}b.removeAt(a)}b.insert(d,f);if(a===-1){f.setParent(e)}if(g){e.insertInner(f,d)}if(a!==-1){e.onItemMove(f,d,a)}else{e.onItemAdd(f,d)}},insertFirst:function(a){return this.insert(0,a)},insertLast:function(a){return this.insert(this.getItems().length,a)},insertBefore:function(c,a){var b=this.indexOf(a);if(b!==-1){this.insert(b,c)}return this},insertAfter:function(c,a){var b=this.indexOf(a);if(b!==-1){this.insert(b+1,c)}return this},onItemAdd:function(b,a){this.doItemLayoutAdd(b,a);if(this.initialized){this.fireEvent("add",this,b,a)}},doItemLayoutAdd:function(c,a){var b=this.getLayout();if(this.isRendered()&&c.setRendered(true)){c.fireAction("renderedchange",[this,c,true],"onItemAdd",b,{args:[c,a]})}else{b.onItemAdd(c,a)}},onItemRemove:function(b,a,c){this.doItemLayoutRemove(b,a,c);this.fireEvent("remove",this,b,a)},doItemLayoutRemove:function(c,a,d){var b=this.getLayout();if(this.isRendered()&&c.setRendered(false)){c.fireAction("renderedchange",[this,c,false],"onItemRemove",b,{args:[c,a,d]})}else{b.onItemRemove(c,a,d)}},onItemMove:function(b,c,a){if(b.isDocked()){b.setDocked(null)}this.doItemLayoutMove(b,c,a);this.fireEvent("move",this,b,c,a)},doItemLayoutMove:function(b,c,a){this.getLayout().onItemMove(b,c,a)},onItemInnerStateChange:function(c,a){var b=this.getLayout();if(a){this.insertInner(c,this.items.indexOf(c))}else{this.removeInner(c)}b.onItemInnerStateChange.apply(b,arguments)},getInnerItems:function(){return this.innerItems},getDockedItems:function(){var a=this.getItems().items,c=[],e=a.length,d,b;for(b=0;b<e;b++){d=a[b];if(d.isDocked()){c.push(d)}}return c},applyActiveItem:function(d,a){var c=this.getInnerItems();this.getItems();if(!d&&c.length===0){return 0}else{if(typeof d=="number"){d=Math.max(0,Math.min(d,c.length-1));d=c[d];if(d){return d}else{if(a){return null}}}else{if(d){var b;if(typeof d=="string"){b=this.child(d);d={xtype:d}}if(!b||!b.isComponent){b=this.factoryItem(d)}this.pendingActiveItem=b;if(!this.has(b)){this.add(b)}return b}}}},animateActiveItem:function(d,c){var b=this.getLayout(),a;if(this.activeItemAnimation){this.activeItemAnimation.destroy()}this.activeItemAnimation=c=new Ext.fx.layout.Card(c);if(c&&b.isCard){c.setLayout(b);a=b.getAnimation();if(a){a.disable()}c.on("animationend",function(){if(a){a.enable()}c.destroy()},this)}return this.setActiveItem(d)},doSetActiveItem:function(b,a){delete this.pendingActiveItem;if(a){a.fireEvent("deactivate",a,this,b)}if(b){b.fireEvent("activate",b,this,a)}},show:function(){Ext.Component.prototype.show.apply(this,arguments);var a=this.getModal();if(a){a.setHidden(false)}return this},hide:function(){Ext.Component.prototype.hide.apply(this,arguments);var a=this.getModal();if(a){a.setHidden(true)}return this},doSetHidden:function(b){var a=this.getModal();if(a&&(a.getHidden()!==b)){a.setHidden(b)}Ext.Component.prototype.doSetHidden.apply(this,arguments)},setRendered:function(d){if(Ext.Component.prototype.setRendered.apply(this,arguments)){var a=this.items.items,b,c;for(b=0,c=a.length;b<c;b++){a[b].setRendered(d)}return true}return false},getScrollableBehavior:function(){var a=this.scrollableBehavior;if(!a){a=this.scrollableBehavior=new Ext.behavior.Scrollable(this)}return a},applyScrollable:function(a){if(typeof a==="boolean"){this.getScrollableBehavior().setConfig({disabled:!a})}else{if(a&&!a.isObservable){this.getScrollableBehavior().setConfig(a)}}return a},doSetScrollable:function(){},getScrollable:function(){return this.getScrollableBehavior().getScrollView()},getRefItems:function(a){var b=this.getItems().items.slice(),e=b.length,c,d;if(a){for(c=0;c<e;c++){d=b[c];if(d.getRefItems){b=b.concat(d.getRefItems(true))}}}return b},getComponent:function(a){if(Ext.isObject(a)){a=a.getItemId()}return this.getItems().get(a)},getDockedComponent:function(a){if(Ext.isObject(a)){a=a.getItemId()}var c=this.getDockedItems(),e=c.length,d,b;if(Ext.isNumber(a)){return c[a]}for(b=0;b<e;b++){d=c[b];if(d.id==a){return d}}return false},query:function(a){return Ext.ComponentQuery.query(a,this)},child:function(a){return this.query("> "+a)[0]||null},down:function(a){return this.query(a)[0]||null},destroy:function(){var b=this,a=b.getModal();if(a){a.destroy()}b.removeAll(true,true);b.unlink("_scrollable");Ext.destroy(b.items);Ext.Component.prototype.destroy.call(this)}},1,["container"],["component","container"],{component:true,container:true},["widget.container"],0,[Ext,"Container",Ext.lib,"Container"],function(){this.addMember("defaultItemClass",this)}));(Ext.cmd.derive("Ext.util.Point",Ext.Base,{radianToDegreeConstant:180/Math.PI,statics:{fromEvent:function(b){var a=b.changedTouches,c=(a&&a.length>0)?a[0]:b;return this.fromTouch(c)},fromTouch:function(a){return new this(a.pageX,a.pageY)},from:function(a){if(!a){return new this(0,0)}if(!(a instanceof this)){return new this(a.x,a.y)}return a}},constructor:function(a,b){if(typeof a=="undefined"){a=0}if(typeof b=="undefined"){b=0}this.x=a;this.y=b;return this},clone:function(){return new this.self(this.x,this.y)},copy:function(){return this.clone.apply(this,arguments)},copyFrom:function(a){this.x=a.x;this.y=a.y;return this},toString:function(){return"Point["+this.x+","+this.y+"]"},equals:function(a){return(this.x===a.x&&this.y===a.y)},isCloseTo:function(c,b){if(typeof b=="number"){b={x:b};b.y=b.x}var a=c.x,f=c.y,e=b.x,d=b.y;return(this.x<=a+e&&this.x>=a-e&&this.y<=f+d&&this.y>=f-d)},isWithin:function(){return this.isCloseTo.apply(this,arguments)},translate:function(a,b){this.x+=a;this.y+=b;return this},roundedEquals:function(a){if(typeof a!="object"){a={x:0,y:0}}return(Math.round(this.x)===Math.round(a.x)&&Math.round(this.y)===Math.round(a.y))},getDistanceTo:function(b){if(typeof b!="object"){b={x:0,y:0}}var c=this.x-b.x,a=this.y-b.y;return Math.sqrt(c*c+a*a)},getAngleTo:function(b){if(typeof b!="object"){b={x:0,y:0}}var c=this.x-b.x,a=this.y-b.y;return Math.atan2(a,c)*this.radianToDegreeConstant}},3,0,0,0,0,0,[Ext.util,"Point"],0));(Ext.cmd.derive("Ext.util.LineSegment",Ext.Base,{constructor:function(b,a){var c=Ext.util.Point;this.point1=c.from(b);this.point2=c.from(a)},intersects:function(m){var p=this.point1,n=this.point2,j=m.point1,f=m.point2,c=p.x,b=n.x,a=j.x,r=f.x,q=p.y,o=n.y,l=j.y,h=f.y,g=(c-b)*(l-h)-(q-o)*(a-r),k,e;if(g==0){return null}k=((a-r)*(c*o-q*b)-(c-b)*(a*h-l*r))/g;e=((l-h)*(c*o-q*b)-(q-o)*(a*h-l*r))/g;if(k<Math.min(c,b)||k>Math.max(c,b)||k<Math.min(a,r)||k>Math.max(a,r)||e<Math.min(q,o)||e>Math.max(q,o)||e<Math.min(l,h)||e>Math.max(l,h)){return null}return new Ext.util.Point(k,e)},getLength:function(){return Math.abs(this.point1.getDistanceTo(this.point2))},getAngleToX:function(){var d=this.point1,c=this.point2,a=c.y-d.y,b=c.x-d.x;return Math.atan2(a,b)},getInBetweenPoint:function(e){var b=this.point1,c=this.getAngleToX(),a=b.x+Math.cos(c)*e,d=b.y+Math.sin(c)*e;return new Ext.util.Point(a,d)},toString:function(){return this.point1.toString()+" "+this.point2.toString()}},3,0,0,0,0,0,[Ext.util,"LineSegment"],0));(Ext.cmd.derive("Ext.Panel",Ext.Container,{alternateClassName:"Ext.lib.Panel",isPanel:true,config:{baseCls:"x-panel",bodyPadding:null,bodyMargin:null,bodyBorder:null},getElementConfig:function(){return{reference:"element",classList:["x-container","x-unsized"],children:[{reference:"innerElement",className:"x-inner"},{reference:"tipElement",className:"x-anchor",hidden:true}]}},applyBodyPadding:function(a){if(a===true){a=5}if(a){a=Ext.dom.Element.unitizeBox(a)}return a},updateBodyPadding:function(a){this.element.setStyle("padding",a)},applyBodyMargin:function(a){if(a===true){a=5}if(a){a=Ext.dom.Element.unitizeBox(a)}return a},updateBodyMargin:function(a){this.element.setStyle("margin",a)},applyBodyBorder:function(a){if(a===true){a=1}if(a){a=Ext.dom.Element.unitizeBox(a)}return a},updateBodyBorder:function(a){this.element.setStyle("border-width",a)},alignTo:function(o,j){var t=this.getAlignmentInfo(o,j);if(t.isAligned){return}var z=this.tipElement;z.hide();if(this.currentTipPosition){z.removeCls("x-anchor-"+this.currentTipPosition)}Ext.Container.prototype.alignTo.apply(this,arguments);var f=Ext.util.LineSegment,d=o.isComponent?o.renderElement:o,a=this.renderElement,p=d.getPageBox(),m=a.getPageBox(),b=m.left,w=m.top,F=m.right,h=m.bottom,l=b+(m.width/2),k=w+(m.height/2),q={x:b,y:w},n={x:F,y:w},E={x:b,y:h},G={x:F,y:h},B={x:l,y:k},v=p.left+(p.width/2),s=p.top+(p.height/2),y={x:v,y:s},c=new f(B,y),g=0,D=0,e,C,u,r,A,x;z.setVisibility(false);z.show();e=z.getSize();C=e.width;u=e.height;if(c.intersects(new f(q,n))){A=Math.min(Math.max(v,b+C),F-(C));x=w;D=u+10;r="top"}else{if(c.intersects(new f(q,E))){A=b;x=Math.min(Math.max(s+(C/2),C*1.6),h-(C/2.2));g=u+10;r="left"}else{if(c.intersects(new f(E,G))){A=Math.min(Math.max(v,b+C),F-C);x=h;D=-u-10;r="bottom"}else{if(c.intersects(new f(n,G))){A=F;x=Math.max(Math.min(s-u,h-C*1.3),C/2);g=-u-10;r="right"}}}}if(A||x){this.currentTipPosition=r;z.addCls("x-anchor-"+r);z.setLeft(A-b);z.setTop(x-w);z.setVisibility(true);this.setLeft(this.getLeft()+g);this.setTop(this.getTop()+D)}}},0,["panel"],["component","container","panel"],{component:true,container:true,panel:true},["widget.panel"],0,[Ext,"Panel",Ext.lib,"Panel"],0));(Ext.cmd.derive("Ext.Button",Ext.Component,{cachedConfig:{pressedCls:"x-button-pressing",badgeCls:"x-badge",hasBadgeCls:"x-hasbadge",labelCls:"x-button-label",iconCls:null},config:{badgeText:null,text:null,icon:false,iconAlign:"left",pressedDelay:0,handler:null,scope:null,autoEvent:null,ui:"normal",baseCls:"x-button"},template:[{tag:"span",reference:"badgeElement",hidden:true},{tag:"span",className:"x-button-icon",reference:"iconElement"},{tag:"span",reference:"textElement",hidden:true}],initialize:function(){Ext.Component.prototype.initialize.call(this);this.element.on({scope:this,tap:"onTap",touchstart:"onPress",touchend:"onRelease"})},updateBadgeText:function(c){var a=this.element,b=this.badgeElement;if(c){b.show();b.setText(c)}else{b.hide()}a[(c)?"addCls":"removeCls"](this.getHasBadgeCls())},updateText:function(b){var a=this.textElement;if(a){if(b){a.show();a.setHtml(b)}else{a.hide()}this.refreshIconAlign()}},updateHtml:function(b){var a=this.textElement;if(b){a.show();a.setHtml(b)}else{a.hide()}},updateBadgeCls:function(b,a){this.badgeElement.replaceCls(a,b)},updateHasBadgeCls:function(b,c){var a=this.element;if(a.hasCls(c)){a.replaceCls(c,b)}},updateLabelCls:function(b,a){this.textElement.replaceCls(a,b)},updatePressedCls:function(b,c){var a=this.element;if(a.hasCls(c)){a.replaceCls(c,b)}},updateIcon:function(b){var c=this,a=c.iconElement;if(b){c.showIconElement();a.setStyle("background-image","url("+b+")");c.refreshIconAlign()}else{a.setStyle("background-image","");c.hideIconElement()}},updateIconCls:function(c,a){var d=this,b=d.iconElement;if(c){d.showIconElement();b.replaceCls(a,c);d.refreshIconAlign()}else{b.removeCls(a);d.hideIconElement()}},updateIconAlign:function(d,c){var b=this.element,a="x-iconalign-";if(!this.getText()){d="center"}b.removeCls(a+"center");b.removeCls(a+c);if(this.getIcon()||this.getIconCls()){b.addCls(a+d)}},refreshIconAlign:function(){this.updateIconAlign(this.getIconAlign())},applyAutoEvent:function(b){var a=this;if(typeof b=="string"){b={name:b,scope:a.scope||a}}return b},updateAutoEvent:function(c){var a=c.name,b=c.scope;this.setHandler(function(){b.fireEvent(a,b,this)});this.setScope(b)},hideIconElement:function(){this.iconElement.removeCls("x-shown");this.iconElement.addCls("x-hidden")},showIconElement:function(){this.iconElement.removeCls("x-hidden");this.iconElement.addCls("x-shown")},applyUi:function(a){if(a&&Ext.isString(a)){var b=a.split("-");if(b&&(b[1]=="back"||b[1]=="forward")){return b}}return a},getUi:function(){var a=this._ui;if(Ext.isArray(a)){return a.join("-")}return a},applyPressedDelay:function(a){if(Ext.isNumber(a)){return a}return(a)?100:0},onPress:function(){var c=this,a=c.element,d=c.getPressedDelay(),b=c.getPressedCls();if(!c.getDisabled()){if(d>0){c.pressedTimeout=setTimeout(function(){delete c.pressedTimeout;if(a){a.addCls(b)}},d)}else{a.addCls(b)}}},onRelease:function(a){this.fireAction("release",[this,a],"doRelease")},doRelease:function(a,b){if(!a.getDisabled()){if(a.hasOwnProperty("pressedTimeout")){clearTimeout(a.pressedTimeout);delete a.pressedTimeout}else{a.element.removeCls(a.getPressedCls())}}},onTap:function(a){if(this.getDisabled()){return false}this.fireAction("tap",[this,a],"doTap")},doTap:function(c,d){var b=c.getHandler(),a=c.getScope()||c;if(!b){return}if(typeof b=="string"){b=a[b]}if(d&&d.preventDefault){d.preventDefault()}b.apply(a,arguments)}},0,["button"],["component","button"],{component:true,button:true},["widget.button"],0,[Ext,"Button"],function(){}));(Ext.cmd.derive("Ext.data.Connection",Ext.Base,{statics:{requestId:0},config:{url:null,async:true,method:null,username:"",password:"",disableCaching:true,disableCachingParam:"_dc",timeout:30000,extraParams:null,defaultHeaders:null,useDefaultHeader:true,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:true,defaultXhrHeader:"XMLHttpRequest",autoAbort:false},textAreaRe:/textarea/i,multiPartRe:/multipart\/form-data/i,lineBreakRe:/\r\n/g,constructor:function(a){this.initConfig(a);this.requests={}},request:function(l){l=l||{};var f=this,k=l.scope||window,e=l.username||f.getUsername(),h=l.password||f.getPassword()||"",g=l.xhr2===true&&Ext.feature.has.XHR2,b,c,d,a,j;if(!Ext.isEmpty(e)&&!Ext.isEmpty(h,true)&&Ext.isEmpty(l.withCredentials)){l.withCredentials=true}if(f.fireEvent("beforerequest",f,l)!==false){c=f.setOptions(l,k);if(this.isFormUpload(l)===true){this.upload(l.form,c.url,c.data,l);return null}if(l.autoAbort===true||f.getAutoAbort()){f.abort()}j=this.getXhrInstance();b=l.async!==false?(l.async||f.getAsync()):false;if(e){j.open(c.method,c.url,b,e,h)}else{j.open(c.method,c.url,b)}a=f.setupHeaders(j,l,c.data,c.params);d={id:++Ext.data.Connection.requestId,xhr:j,headers:a,options:l,async:b,timeout:setTimeout(function(){d.timedout=true;f.abort(d)},l.timeout||f.getTimeout())};f.requests[d.id]=d;if(b){j[g?"onload":"onreadystatechange"]=Ext.Function.bind(f.onStateChange,f,[d])}if(g){j.onerror=Ext.Function.bind(f.onStateChange,f,[d])}if(l.progress){j.onprogress=function(m){if(l.progress.isProgressable){if(m.total===0&&l.progress.getDynamic()){Ext.Logger.warn("Server is not configured to properly return Content-Length. Dynamic progress will be disabled");l.progress.setState.call(l.progress,"download");l.progress.setDynamic(false);j.onprogress=null;return}Ext.callback(l.progress.updateProgress,l.progress,[(m.loaded/m.total),"download"]);if(m.total>0&&!l.progress.getDynamic()&&l.progress.getInitialConfig().dynamic){l.progress.setDynamic(true)}}else{if(Ext.isFunction(l.progress)){Ext.callback(l.progress,l.progressScope||d,[m,"download"])}}};if(Ext.feature.has.XHRUploadProgress){j.upload.onprogress=function(m){f.fireEvent("requestuploadprogress",f,d,m);if(l.progress.isProgressable){Ext.callback(l.progress.updateProgress,l.progress,[(m.loaded/m.total),"upload"])}else{if(Ext.isFunction(l.progress)){Ext.callback(l.progress,l.progressScope||d,[m,"upload"])}}}}if(l.progress.isProgressable){if(!Ext.feature.has.XHRUploadProgress){l.progress.setDynamic(false)}Ext.callback(l.progress.startProgress,l.progress)}}j.send(c.data);if(!b){return this.onComplete(d)}return d}else{Ext.callback(l.callback,l.scope,[l,undefined,undefined]);return null}},upload:function(e,c,j,m){e=Ext.getDom(e);m=m||{};var d=Ext.id(),l=this,h=document.createElement("iframe"),k=[],g="multipart/form-data",f={target:e.target,method:e.method,encoding:e.encoding,enctype:e.enctype,action:e.action},b=function(n,o){a=document.createElement("input");Ext.fly(a).set({type:"hidden",value:o,name:n});e.appendChild(a);k.push(a)},a;Ext.fly(h).set({id:d,name:d,cls:"x-hide-display",src:Ext.SSL_SECURE_URL});document.body.appendChild(h);if(document.frames){document.frames[d].name=d}Ext.fly(e).set({target:d,method:"POST",enctype:g,encoding:g,action:c||f.action});if(j){Ext.iterate(Ext.Object.fromQueryString(j),function(n,o){if(Ext.isArray(o)){Ext.each(o,function(p){b(n,p)})}else{b(n,o)}})}h.addEventListener("load",function(){Ext.callback(l.onUploadComplete,l,[h,m,d]);h.removeEventListener("load",arguments.callee)});e.submit();Ext.fly(e).set(f);Ext.each(k,function(n){Ext.removeNode(n)})},onUploadComplete:function(h,c,j){var b={responseText:"",responseXML:null,request:{options:c}},g,a,f;try{g=(h.contentWindow&&h.contentWindow.document)||h.contentDocument||window.frames[j].document;if(g){if(g.hasOwnProperty("body")&&g.body){a=g.body}if(a){f=a.firstChild||{};if(this.textAreaRe.test(f.tagName)){b.responseText=f.value}else{b.responseText=f.innerHTML}b.responseXML=a.XMLDocument}}}catch(d){b.success=false;b.message="Cross-Domain access is not permitted between frames. XHR2 is recommended for this type of request.";b.error=d}this.onAfterUploadComplete(b,h,c)},onAfterUploadComplete:function(a,d,b){var c=this;c.fireEvent("requestcomplete",c,a,b);Ext.callback(b.callback,b.scope,[b,true,a]);setTimeout(function(){Ext.removeNode(d)},100)},isFormUpload:function(a){var b=this.getForm(a);if(b){return(a.isUpload||(this.multiPartRe).test(b.getAttribute("enctype")))}return false},getForm:function(a){return Ext.getDom(a.form)||null},setOptions:function(l,k){var h=this,e=l.params||{},g=h.getExtraParams(),d=l.urlParams,c=l.url||h.getUrl(),j=l.jsonData,b,a,f;if(Ext.isFunction(e)){e=e.call(k,l)}if(Ext.isFunction(c)){c=c.call(k,l)}c=this.setupUrl(l,c);f=l.data||l.rawData||l.binaryData||l.xmlData||j||null;if(j&&!Ext.isPrimitive(j)){f=Ext.encode(f)}if(l.binaryData){if(f instanceof Array){f=(new Uint8Array(l.binaryData))}if(f instanceof Uint8Array){f=f.buffer}}if(Ext.isObject(e)){e=Ext.Object.toQueryString(e)}if(Ext.isObject(g)){g=Ext.Object.toQueryString(g)}e=e+((g)?((e)?"&":"")+g:"");d=Ext.isObject(d)?Ext.Object.toQueryString(d):d;e=this.setupParams(l,e);b=(l.method||h.getMethod()||((e||f)?"POST":"GET")).toUpperCase();this.setupMethod(l,b);a=l.disableCaching!==false?(l.disableCaching||h.getDisableCaching()):false;if(a){c=Ext.urlAppend(c,(l.disableCachingParam||h.getDisableCachingParam())+"="+(new Date().getTime()))}if((b=="GET"||f)&&e){c=Ext.urlAppend(c,e);e=null}if(d){c=Ext.urlAppend(c,d)}return{url:c,method:b,data:f||e||null}},setupUrl:function(b,a){var c=this.getForm(b);if(c){a=a||c.action}return a},setupParams:function(a,d){var c=this.getForm(a),b;if(c&&!this.isFormUpload(a)){b=Ext.Element.serializeForm(c);d=d?(d+"&"+b):b}return d},setupMethod:function(a,b){if(this.isFormUpload(a)){return"POST"}return b},setupHeaders:function(m,n,d,c){var h=this,b=Ext.apply({},n.headers||{},h.getDefaultHeaders()||{}),l=h.getDefaultPostHeader(),j=n.jsonData,a=n.xmlData,k,f;if(!b["Content-Type"]&&(d||c)){if(d){if(n.rawData){l="text/plain"}else{if(a&&Ext.isDefined(a)){l="text/xml"}else{if(j&&Ext.isDefined(j)){l="application/json"}}}}if(!(Ext.feature.has.XHR2&&d instanceof FormData)){b["Content-Type"]=l}}if(((h.getUseDefaultXhrHeader()&&n.useDefaultXhrHeader!==false)||n.useDefaultXhrHeader)&&!b["X-Requested-With"]){b["X-Requested-With"]=h.getDefaultXhrHeader()}if(!Ext.isEmpty(n.username)&&!Ext.isEmpty(n.password)){b.Authorization="Basic "+btoa(n.username+":"+n.password)}try{for(k in b){if(b.hasOwnProperty(k)){f=b[k];m.setRequestHeader(k,f)}}}catch(g){h.fireEvent("exception",k,f)}if(n.responseType){try{m.responseType=n.responseType==="blob"&&Ext.browser.is.Safari?"arraybuffer":n.responseType}catch(g){}}if(n.withCredentials){m.withCredentials=n.withCredentials}return b},getXhrInstance:(function(){var b=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0,a=b.length,f;for(;c<a;++c){try{f=b[c];f();break}catch(d){}}return f})(),isLoading:function(a){if(!(a&&a.xhr)){return false}var b=a.xhr.readyState;return !(b===0||b==4)},abort:function(b){var a=this,d=a.requests,c;if(b&&a.isLoading(b)){b.xhr.onreadystatechange=null;b.xhr.abort();a.clearTimeout(b);if(!b.timedout){b.aborted=true}a.onComplete(b);a.cleanup(b)}else{if(!b){for(c in d){if(d.hasOwnProperty(c)){a.abort(d[c])}}}}},abortAll:function(){this.abort()},onStateChange:function(a){if(a.xhr.readyState==4){this.clearTimeout(a);this.onComplete(a);this.cleanup(a)}},clearTimeout:function(a){clearTimeout(a.timeout);delete a.timeout},cleanup:function(a){a.xhr=null;delete a.xhr},onComplete:function(f){var d=this,c=f.options,a,h,b;try{a=d.parseStatus(f.xhr.status,f.xhr);if(f.timedout){a.success=false}}catch(g){a={success:false,isException:false}}h=a.success;if(h){b=d.createResponse(f);d.fireEvent("requestcomplete",d,b,c);Ext.callback(c.success,c.scope,[b,c])}else{if(a.isException||f.aborted||f.timedout){b=d.createException(f)}else{b=d.createResponse(f)}d.fireEvent("requestexception",d,b,c);Ext.callback(c.failure,c.scope,[b,c])}Ext.callback(c.callback,c.scope,[c,h,b]);if(c.progress&&c.progress.isProgressable){Ext.callback(c.progress.endProgress,c.progress,[a])}delete d.requests[f.id];return b},parseStatus:function(a,d){a=a==1223?204:a;var c=(a>=200&&a<300)||a==304||(a==0&&d.responseText&&d.responseText.length>0),b=false;if(!c){switch(a){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:b=true;break}}return{success:c,isException:b}},createResponse:function(d){var k=d.xhr,a={},l,f,m,g,j,b,e=k.responseType==="blob"||k.responseType==="arraybuffer",h=k.responseType==="text",c=k.responseType==="document";if(d.timedout||d.aborted){d.success=false;l=[]}else{l=k.getAllResponseHeaders().replace(this.lineBreakRe,"\n").split("\n")}f=l.length;while(f--){m=l[f];g=m.indexOf(":");if(g>=0){j=m.substr(0,g).toLowerCase();if(m.charAt(g+1)==" "){++g}a[j]=m.substr(g+1)}}d.xhr=null;delete d.xhr;b={request:d,requestId:d.id,status:k.status,statusText:k.statusText,getResponseHeader:function(n){return a[n.toLowerCase()]},getAllResponseHeaders:function(){return a},responseText:e?null:c?null:k.responseText,responseXML:e?null:h?null:k.responseXML,responseBytes:e?k.response:null};if(d.options.responseType==="blob"&&k.responseType==="arraybuffer"){b.responseBytes=new Blob([b.responseBytes],{type:k.getResponseHeader("Content-Type")})}k=null;return b},createException:function(a){return{request:a,requestId:a.id,status:a.aborted?-1:0,statusText:a.aborted?"transaction aborted":"communication failure",aborted:a.aborted,timedout:a.timedout}}},1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.data,"Connection"],0));(Ext.cmd.derive("Ext.Ajax",Ext.data.Connection,{singleton:true,autoAbort:false},0,0,0,0,0,0,[Ext,"Ajax"],0));(Ext.cmd.derive("Ext.Anim",Ext.Base,{isAnim:true,disableAnimations:false,defaultConfig:{from:{},to:{},duration:250,delay:0,easing:"ease-in-out",autoClear:true,out:true,direction:null,reverse:false},opposites:{left:"right",right:"left",up:"down",down:"up"},constructor:function(a){a=Ext.apply({},a||{},this.defaultConfig);this.config=a;this.callSuper([a]);this.running=[]},initConfig:function(c,b){var d=this,a=Ext.apply({},b||{},d.config);a.el=c=Ext.get(c);if(a.reverse&&d.opposites[a.direction]){a.direction=d.opposites[a.direction]}if(d.config.before){d.config.before.call(a,c,a)}if(b.before){b.before.call(a.scope||a,c,a)}return a},run:function(c,a){c=Ext.get(c);a=a||{};var d=this,b=c.dom.style,e,f=a.after;if(d.running[c.id]){d.onTransitionEnd(null,c,{config:a,after:f})}a=this.initConfig(c,a);if(this.disableAnimations){for(e in a.to){if(!a.to.hasOwnProperty(e)){continue}b[e]=a.to[e]}this.onTransitionEnd(null,c,{config:a,after:f});return d}c.un("transitionend",d.onTransitionEnd,d);b.webkitTransitionDuration="0ms";for(e in a.from){if(!a.from.hasOwnProperty(e)){continue}b[e]=a.from[e]}setTimeout(function(){if(!c.dom){return}if(a.is3d===true){c.parent().setStyle({"-webkit-perspective":"1200","-webkit-transform-style":"preserve-3d"})}b.webkitTransitionDuration=a.duration+"ms";b.webkitTransitionProperty="all";b.webkitTransitionTimingFunction=a.easing;c.on("transitionend",d.onTransitionEnd,d,{single:true,config:a,after:f});for(e in a.to){if(!a.to.hasOwnProperty(e)){continue}b[e]=a.to[e]}},a.delay||5);d.running[c.id]=a;return d},onTransitionEnd:function(e,c,g){c=Ext.get(c);if(this.running[c.id]===undefined){return}var b=c.dom.style,a=g.config,d=this,f;if(a.autoClear){for(f in a.to){if(!a.to.hasOwnProperty(f)||a[f]===false){continue}b[f]=""}}b.webkitTransitionDuration=null;b.webkitTransitionProperty=null;b.webkitTransitionTimingFunction=null;if(a.is3d){c.parent().setStyle({"-webkit-perspective":"","-webkit-transform-style":""})}if(d.config.after){d.config.after.call(a,c,a)}if(g.after){g.after.call(a.scope||d,c,a)}delete d.running[c.id]}},1,0,0,0,0,0,[Ext,"Anim"],function(){Ext.Anim.seed=1000;Ext.Anim.run=function(b,c,a){if(b.isComponent){b=b.element}else{b=Ext.get(b)}a=a||{};if(c.isAnim){c.run(b,a)}else{if(Ext.isObject(c)){if(a.before&&c.before){a.before=Ext.createInterceptor(a.before,c.before,c.scope)}if(a.after&&c.after){a.after=Ext.createInterceptor(a.after,c.after,c.scope)}a=Ext.apply({},a,c);c=c.type}if(!Ext.anims[c]){throw c+" is not a valid animation type."}else{if(b&&b.dom){Ext.anims[c].run(b,a)}}}};Ext.anims={fade:new Ext.Anim({type:"fade",before:function(b){var c=1,a=1,e=b.getStyle("z-index")=="auto"?0:b.getStyle("z-index"),d=e;if(this.out){a=0}else{d=Math.abs(e)+1;c=0}this.from={opacity:c,"z-index":d};this.to={opacity:a,"z-index":d}}}),slide:new Ext.Anim({direction:"left",cover:false,reveal:false,opacity:false,"z-index":false,before:function(a){var c=a.getStyle("z-index")=="auto"?0:a.getStyle("z-index"),f=a.getStyle("opacity"),h=c+1,d=this.out,m=this.direction,l=0,j=0,k=0,g=0,b=a.getHeight(),e=a.getWidth();if(m=="left"||m=="right"){if(d){l=-e}else{k=e}}else{if(m=="up"||m=="down"){if(d){j=-b}else{g=b}}}if(m=="right"||m=="down"){j*=-1;l*=-1;g*=-1;k*=-1}if(this.cover&&d){l=0;j=0;h=c}else{if(this.reveal&&!d){k=0;g=0;h=c}}this.from={"-webkit-transform":"translate3d("+k+"px, "+g+"px, 0)","z-index":h,opacity:f-0.01};this.to={"-webkit-transform":"translate3d("+l+"px, "+j+"px, 0)","z-index":h,opacity:f}}}),pop:new Ext.Anim({scaleOnExit:true,before:function(d){var b=1,c=1,g=1,a=1,h=d.getStyle("z-index")=="auto"?0:d.getStyle("z-index"),f=h,e=h;if(!this.out){b=0.01;f=h+1;e=h+1;g=0}else{if(this.scaleOnExit){c=0.01;a=0}else{a=0.8}}this.from={"-webkit-transform":"scale("+b+")","-webkit-transform-origin":"50% 50%",opacity:g,"z-index":f};this.to={"-webkit-transform":"scale("+c+")","-webkit-transform-origin":"50% 50%",opacity:a,"z-index":e}}}),flip:new Ext.Anim({is3d:true,direction:"left",before:function(c){var f="Y",a=1,b=1,e=0,d=0;if(this.out){d=-180;b=0.8}else{e=180;a=0.8}if(this.direction=="up"||this.direction=="down"){f="X"}if(this.direction=="right"||this.direction=="left"){d*=-1;e*=-1}this.from={"-webkit-transform":"rotate"+f+"("+e+"deg) scale("+a+")","-webkit-backface-visibility":"hidden"};this.to={"-webkit-transform":"rotate"+f+"("+d+"deg) scale("+b+")","-webkit-backface-visibility":"hidden"}}}),cube:new Ext.Anim({is3d:true,direction:"left",style:"outer",before:function(b){var l="0% 0%",m=0,a=0,j="Y",f=0,g=0,e=b.getWidth(),d=b.getHeight(),k=true,c=" translateX(0)",h="";if(this.direction=="left"||this.direction=="right"){if(this.out){l="100% 100%";g=e;a=-90}else{l="0% 0%";f=e;m=90}}else{if(this.direction=="up"||this.direction=="down"){j="X";if(this.out){l="100% 100%";g=d;a=90}else{l="0% 0%";f=d;m=-90}}}if(this.direction=="down"||this.direction=="right"){m*=-1;a*=-1;l=(l=="0% 0%")?"100% 100%":"0% 0%"}if(this.style=="inner"){f*=-1;g*=-1;m*=-1;a*=-1;if(!this.out){h=" translateX(0px)";l="0% 50%"}else{h=c;l="100% 50%"}}this.from={"-webkit-transform":"rotate"+j+"("+m+"deg)"+(k?" translateZ("+f+"px)":"")+c,"-webkit-transform-origin":l};this.to={"-webkit-transform":"rotate"+j+"("+a+"deg) translateZ("+g+"px)"+h,"-webkit-transform-origin":l}},duration:250}),wipe:new Ext.Anim({before:function(b){var d=b.getStyle("z-index"),c,a="";if(!this.out){c=d+1;a="-webkit-gradient(linear, left bottom, right bottom, from(transparent), to(#000), color-stop(66%, #000), color-stop(33%, transparent))";this.from={"-webkit-mask-image":a,"-webkit-mask-size":b.getWidth()*3+"px "+b.getHeight()+"px","z-index":c,"-webkit-mask-position-x":0};this.to={"-webkit-mask-image":a,"-webkit-mask-size":b.getWidth()*3+"px "+b.getHeight()+"px","z-index":c,"-webkit-mask-position-x":-b.getWidth()*2+"px"}}},duration:500})}}));(Ext.cmd.derive("Ext.ComponentQuery",Ext.Base,{singleton:true},0,0,0,0,0,0,[Ext,"ComponentQuery"],function(){var g=this,k=["var r = [],","i = 0,","it = items,","l = it.length,","c;","for (; i < l; i++) {","c = it[i];","if (c.{0}) {","r.push(c);","}","}","return r;"].join(""),e=function(p,o){return o.method.apply(this,[p].concat(o.args))},a=function(q,u){var o=[],r=0,t=q.length,s,p=u!==">";for(;r<t;r++){s=q[r];if(s.getRefItems){o=o.concat(s.getRefItems(p))}}return o},f=function(p){var o=[],q=0,s=p.length,r;for(;q<s;q++){r=p[q];while(!!(r=(r.ownerCt||r.floatParent))){o.push(r)}}return o},m=function(p,u,t){if(u==="*"){return p.slice()}else{var o=[],q=0,s=p.length,r;for(;q<s;q++){r=p[q];if(r.isXType(u,t)){o.push(r)}}return o}},j=function(p,s){var u=Ext.Array,o=[],q=0,t=p.length,r;for(;q<t;q++){r=p[q];if(r.el?r.el.hasCls(s):u.contains(r.initCls(),s)){o.push(r)}}return o},n=function(s,v,p,u){var x=[],r=0,o=s.length,w,t,q;for(;r<o;r++){w=s[r];t=Ext.Class.getConfigNameMap(v).get;if(w[t]){q=w[t]();if(!u?!!q:(String(q)===u)){x.push(w)}}else{if(w.config&&w.config[v]){if(!u?!!w.config[v]:(String(w.config[v])===u)){x.push(w)}}else{if(!u?!!w[v]:(String(w[v])===u)){x.push(w)}}}}return x},d=function(p,t){var o=[],q=0,s=p.length,r;for(;q<s;q++){r=p[q];if(r.getId()===t||r.getItemId()===t){o.push(r)}}return o},l=function(o,p,q){return g.pseudos[p](o,q)},h=/^(\s?([>\^])\s?|\s|$)/,c=/^(#)?([\w\-]+|\*)(?:\((true|false)\))?/,b=[{re:/^\.([\w\-]+)(?:\((true|false)\))?/,method:m},{re:/^(?:[\[](?:@)?([\w\-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]])/,method:n},{re:/^#([\w\-]+)/,method:d},{re:/^\:([\w\-]+)(?:\(((?:\{[^\}]+\})|(?:(?!\{)[^\s>\/]*?(?!\})))\))?/,method:l},{re:/^(?:\{([^\}]+)\})/,method:k}];g.Query=Ext.extend(Object,{constructor:function(o){o=o||{};Ext.apply(this,o)},execute:function(p){var r=this.operations,s=0,t=r.length,q,o;if(!p){o=Ext.ComponentManager.all.getArray()}else{if(Ext.isArray(p)){o=p}}for(;s<t;s++){q=r[s];if(q.mode==="^"){o=f(o||[p])}else{if(q.mode){o=a(o||[p],q.mode)}else{o=e(o||a([p]),q)}}if(s===t-1){return o}}return[]},is:function(q){var p=this.operations,t=Ext.isArray(q)?q:[q],o=t.length,u=p[p.length-1],s,r;t=e(t,u);if(t.length===o){if(p.length>1){for(r=0,s=t.length;r<s;r++){if(Ext.Array.indexOf(this.execute(),t[r])===-1){return false}}}return true}return false}});Ext.apply(this,{cache:{},pseudos:{not:function(u,o){var v=Ext.ComponentQuery,s=0,t=u.length,r=[],q=-1,p;for(;s<t;++s){p=u[s];if(!v.is(p,o)){r[++q]=p}}return r}},query:function(p,w){var x=p.split(","),o=x.length,q=0,r=[],y=[],v={},t,s,u;for(;q<o;q++){p=Ext.String.trim(x[q]);t=this.parse(p);r=r.concat(t.execute(w))}if(o>1){s=r.length;for(q=0;q<s;q++){u=r[q];if(!v[u.id]){y.push(u);v[u.id]=true}}r=y}return r},is:function(p,o){if(!o){return true}var q=this.cache[o];if(!q){this.cache[o]=q=this.parse(o)}return q.is(p)},parse:function(r){var p=[],q=b.length,v,s,w,x,y,t,u,o;while(r&&v!==r){v=r;s=r.match(c);if(s){w=s[1];if(w==="#"){p.push({method:d,args:[Ext.String.trim(s[2])]})}else{if(w==="."){p.push({method:j,args:[Ext.String.trim(s[2])]})}else{p.push({method:m,args:[Ext.String.trim(s[2]),Boolean(s[3])]})}}r=r.replace(s[0],"")}while(!(x=r.match(h))){for(t=0;r&&t<q;t++){u=b[t];y=r.match(u.re);o=u.method;if(y){p.push({method:Ext.isString(u.method)?Ext.functionFactory("items",Ext.String.format.apply(Ext.String,[o].concat(y.slice(1)))):u.method,args:y.slice(1)});r=r.replace(y[0],"");break}}}if(x[1]){p.push({mode:x[2]||x[1]});r=r.replace(x[0],"")}}return new g.Query({operations:p})}})}));(Ext.cmd.derive("Ext.Decorator",Ext.Component,{isDecorator:true,config:{component:{}},statics:{generateProxySetter:function(a){return function(c){var b=this.getComponent();b[a].call(b,c);return this}},generateProxyGetter:function(a){return function(){var b=this.getComponent();return b[a].call(b)}}},onClassExtended:function(c,e){if(!e.hasOwnProperty("proxyConfig")){return}var f=Ext.Class,j=e.proxyConfig,d=e.config;e.config=(d)?Ext.applyIf(d,j):j;var b,h,g,a;for(b in j){if(j.hasOwnProperty(b)){h=f.getConfigNameMap(b);g=h.set;a=h.get;e[g]=this.generateProxySetter(g);e[a]=this.generateProxyGetter(a)}}},applyComponent:function(a){return Ext.factory(a,Ext.Component)},updateComponent:function(a,b){if(b){if(this.isRendered()&&b.setRendered(false)){b.fireAction("renderedchange",[this,b,false],"doUnsetComponent",this,{args:[b]})}else{this.doUnsetComponent(b)}}if(a){if(this.isRendered()&&a.setRendered(true)){a.fireAction("renderedchange",[this,a,true],"doSetComponent",this,{args:[a]})}else{this.doSetComponent(a)}}},doUnsetComponent:function(a){if(a.renderElement.dom){a.setLayoutSizeFlags(0);this.innerElement.dom.removeChild(a.renderElement.dom)}},doSetComponent:function(a){if(a.renderElement.dom){a.setLayoutSizeFlags(this.getSizeFlags());this.innerElement.dom.appendChild(a.renderElement.dom)}},setRendered:function(b){var a;if(Ext.Component.prototype.setRendered.apply(this,arguments)){a=this.getComponent();if(a){a.setRendered(b)}return true}return false},setDisabled:function(a){this.callParent(arguments);this.getComponent().setDisabled(a)},destroy:function(){Ext.destroy(this.getComponent());Ext.Component.prototype.destroy.call(this)}},0,0,["component"],{component:true},0,0,[Ext,"Decorator"],0));(Ext.cmd.derive("Ext.Img",Ext.Component,{config:{src:null,baseCls:"x-img",imageCls:"x-img-image",backgroundCls:"x-img-background",mode:"background"},beforeInitialize:function(){var a=this;a.onLoad=Ext.Function.bind(a.onLoad,a);a.onError=Ext.Function.bind(a.onError,a)},initialize:function(){var a=this;Ext.Component.prototype.initialize.call(this);a.relayEvents(a.renderElement,"*");a.element.on({tap:"onTap",scope:a})},hide:function(){Ext.Component.prototype.hide.apply(this,arguments);this.hiddenSrc=this.hiddenSrc||this.getSrc();this.setSrc(null)},show:function(){Ext.Component.prototype.show.apply(this,arguments);if(this.hiddenSrc){this.setSrc(this.hiddenSrc);delete this.hiddenSrc}},updateMode:function(d){var c=this,a=c.getImageCls(),b=c.getBackgroundCls();if(d==="background"){if(c.imageElement){c.imageElement.destroy();delete c.imageElement;c.updateSrc(c.getSrc())}c.replaceCls(a,b)}else{c.imageElement=c.element.createChild({tag:"img"});c.replaceCls(b,a)}},updateImageCls:function(b,a){this.replaceCls(a,b)},updateBackgroundCls:function(b,a){this.replaceCls(a,b)},onTap:function(a){this.fireEvent("tap",this,a)},onAfterRender:function(){this.updateSrc(this.getSrc())},updateSrc:function(a){var b=this,c;if(b.getMode()==="background"){c=this.imageObject||new Image()}else{c=b.imageElement.dom}this.imageObject=c;c.setAttribute("src",Ext.isString(a)?a:"");c.addEventListener("load",b.onLoad,false);c.addEventListener("error",b.onError,false)},detachListeners:function(){var a=this.imageObject;if(a){a.removeEventListener("load",this.onLoad,false);a.removeEventListener("error",this.onError,false)}},onLoad:function(a){this.detachListeners();if(this.getMode()==="background"){this.element.dom.style.backgroundImage='url("'+this.imageObject.src+'")'}this.fireEvent("load",this,a)},onError:function(a){this.detachListeners();if(this.getMode()==="background"){this.element.dom.style.backgroundImage='url("'+this.imageObject.src+'")'}this.fireEvent("error",this,a)},doSetWidth:function(b){var a=(this.getMode()==="background")?this.element:this.imageElement;a.setWidth(b);Ext.Component.prototype.doSetWidth.apply(this,arguments)},doSetHeight:function(b){var a=(this.getMode()==="background")?this.element:this.imageElement;a.setHeight(b);Ext.Component.prototype.doSetHeight.apply(this,arguments)},destroy:function(){this.detachListeners();Ext.destroy(this.imageObject,this.imageElement);delete this.imageObject;delete this.imageElement;Ext.Component.prototype.destroy.call(this)}},0,["image","img"],["component","image","img"],{component:true,image:true,img:true},["widget.image","widget.img"],0,[Ext,"Img"],0));(Ext.cmd.derive("Ext.Label",Ext.Component,{config:{baseCls:"x-label"}},0,["label"],["component","label"],{component:true,label:true},["widget.label"],0,[Ext,"Label"],0));(Ext.cmd.derive("Ext.LoadMask",Ext.Mask,{config:{message:"Loading...",cls:"x-loading-mask",messageCls:"x-mask-message",indicator:true},getTemplate:function(){var a="x-";return[{reference:"innerElement",cls:a+"mask-inner",children:[{reference:"indicatorElement",cls:a+"loading-spinner-outer",children:[{cls:a+"loading-spinner",children:[{tag:"span",cls:a+"loading-top"},{tag:"span",cls:a+"loading-right"},{tag:"span",cls:a+"loading-bottom"},{tag:"span",cls:a+"loading-left"}]}]},{reference:"messageElement"}]}]},updateMessage:function(b){var a="x-has-message";if(b){this.addCls(a)}else{this.removeCls(a)}this.messageElement.setHtml(b)},updateMessageCls:function(b,a){this.messageElement.replaceCls(a,b)},updateIndicator:function(a){this[a?"removeCls":"addCls"]("x-indicator-hidden")}},0,["loadmask"],["component","mask","loadmask"],{component:true,mask:true,loadmask:true},["widget.loadmask"],0,[Ext,"LoadMask"],function(){}));(Ext.cmd.derive("Ext.Title",Ext.Component,{config:{baseCls:"x-title",title:""},updateTitle:function(a){this.setHtml(a)}},0,["title"],["component","title"],{component:true,title:true},["widget.title"],0,[Ext,"Title"],0));(Ext.cmd.derive("Ext.Spacer",Ext.Component,{config:{},constructor:function(a){a=a||{};if(!a.width){a.flex=1}Ext.Component.prototype.constructor.call(this,a)}},1,["spacer"],["component","spacer"],{component:true,spacer:true},["widget.spacer"],0,[Ext,"Spacer"],0));(Ext.cmd.derive("Ext.Toolbar",Ext.Container,{isToolbar:true,config:{baseCls:"x-toolbar",ui:"dark",title:null,defaultType:"button",minHeight:null,layout:{type:"hbox",align:"center"}},hasCSSMinHeight:true,constructor:function(a){a=a||{};if(a.docked=="left"||a.docked=="right"){a.layout={type:"vbox",align:"stretch"}}Ext.Container.prototype.constructor.call(this,a)},applyTitle:function(a){if(typeof a=="string"){a={title:a,centered:Ext.theme.is.Tizen?false:true}}return Ext.factory(a,Ext.Title,this.getTitle())},updateTitle:function(b,a){if(b){this.add(b)}if(a){a.destroy()}},showTitle:function(){var a=this.getTitle();if(a){a.show()}},hideTitle:function(){var a=this.getTitle();if(a){a.hide()}}},1,["toolbar"],["component","container","toolbar"],{component:true,container:true,toolbar:true},["widget.toolbar"],0,[Ext,"Toolbar"],function(){}));(Ext.cmd.derive("Ext.field.Input",Ext.Component,{tag:"input",cachedConfig:{cls:"x-form-field",focusCls:"x-field-focus",maskCls:"x-field-mask",useMask:"auto",type:"text",checked:false},config:{baseCls:"x-field-input",name:null,value:null,isFocused:false,tabIndex:null,placeHolder:null,minValue:null,maxValue:null,stepValue:null,maxLength:null,autoComplete:null,autoCapitalize:null,autoCorrect:null,readOnly:null,maxRows:null,pattern:null,startValue:false,fastFocus:true},getTemplate:function(){var a=[{reference:"input",tag:this.tag},{reference:"mask",classList:[this.config.maskCls]},{reference:"clearIcon",cls:"x-clear-icon"}];return a},initElement:function(){var a=this;Ext.Component.prototype.initElement.call(this);a.input.on({scope:a,keyup:"onKeyUp",keydown:"onKeyDown",focus:"onFocus",blur:"onBlur",input:"onInput",paste:"onPaste",tap:"onInputTap"});if(Ext.browser.is.AndroidStock){a.input.dom.addEventListener("mousedown",function(b){if(document.activeElement!=b.target){b.preventDefault()}});a.input.dom.addEventListener("touchend",function(){a.focus()})}a.mask.on({scope:a,tap:"onMaskTap"});if(a.clearIcon){a.clearIcon.on({tap:"onClearIconTap",touchstart:"onClearIconPress",touchend:"onClearIconRelease",scope:a})}if(Ext.browser.is.ie&&Ext.browser.version.major>=10){a.input.on({scope:a,keypress:"onKeyPress"})}},updateFastFocus:function(a){if(a){if(this.getFastFocus()&&Ext.os.is.iOS){this.input.on({scope:this,touchstart:"onTouchStart"})}}else{this.input.un({scope:this,touchstart:"onTouchStart"})}},useManualMaxLength:function(){return Boolean((Ext.os.is.Android&&!Ext.browser.is.Chrome))},applyUseMask:function(a){if(a==="auto"){a=Ext.os.is.iOS&&Ext.os.version.lt("5")}return Boolean(a)},updateUseMask:function(a){this.mask[a?"show":"hide"]()},updatePattern:function(a){this.updateFieldAttribute("pattern",a)},updateFieldAttribute:function(b,c){var a=this.input;if(!Ext.isEmpty(c,true)){a.dom.setAttribute(b,c)}else{a.dom.removeAttribute(b)}},updateCls:function(b,a){this.input.addCls("x-input-el");this.input.replaceCls(a,b)},updateType:function(a,c){var b="x-input-";this.input.replaceCls(b+c,b+a);this.updateFieldAttribute("type",a)},updateName:function(a){this.updateFieldAttribute("name",a)},getValue:function(){var a=this.input;if(a){this._value=a.dom.value}return this._value},applyValue:function(a){return(Ext.isEmpty(a))?"":a},updateValue:function(b){var a=this.input;if(a){a.dom.value=b}},setValue:function(b){var a=this._value;this.updateValue(this.applyValue(b));b=this.getValue();if(String(b)!=String(a)&&this.initialized){this.onChange(this,b,a)}return this},updateTabIndex:function(a){this.updateFieldAttribute("tabIndex",a)},testAutoFn:function(a){return[true,"on"].indexOf(a)!==-1},updateMaxLength:function(a){if(!this.useManualMaxLength()){this.updateFieldAttribute("maxlength",a)}},updatePlaceHolder:function(a){this.updateFieldAttribute("placeholder",a)},applyAutoComplete:function(a){return this.testAutoFn(a)},updateAutoComplete:function(a){var b=a?"on":"off";this.updateFieldAttribute("autocomplete",b)},applyAutoCapitalize:function(a){return this.testAutoFn(a)},updateAutoCapitalize:function(b){var a=b?"on":"off";this.updateFieldAttribute("autocapitalize",a)},applyAutoCorrect:function(a){return this.testAutoFn(a)},updateAutoCorrect:function(a){var b=a?"on":"off";this.updateFieldAttribute("autocorrect",b)},updateMinValue:function(a){this.updateFieldAttribute("min",a)},updateMaxValue:function(a){this.updateFieldAttribute("max",a)},updateStepValue:function(a){this.updateFieldAttribute("step",a)},checkedRe:/^(true|1|on)/i,getChecked:function(){var a=this.input,b;if(a){b=a.dom.checked;this._checked=b}return b},applyChecked:function(a){return !!this.checkedRe.test(String(a))},setChecked:function(a){this.updateChecked(this.applyChecked(a));this._checked=a},updateChecked:function(a){this.input.dom.checked=a},updateReadOnly:function(a){this.updateFieldAttribute("readonly",a?true:null)},updateMaxRows:function(a){this.updateFieldAttribute("rows",a)},doSetDisabled:function(a){Ext.Component.prototype.doSetDisabled.apply(this,arguments);if(Ext.browser.is.Safari&&!Ext.os.is.BlackBerry){this.input.dom.tabIndex=(a)?-1:0}this.input.dom.disabled=(Ext.browser.is.Safari&&!Ext.os.is.BlackBerry)?false:a;if(!a){this.blur()}},isDirty:function(){if(this.getDisabled()){return false}return String(this.getValue())!==String(this.originalValue)},reset:function(){this.setValue(this.originalValue)},onInputTap:function(a){this.fireAction("inputtap",[this,a],"doInputTap")},doInputTap:function(a,b){if(a.getDisabled()){return false}if(this.getFastFocus()&&Ext.os.is.iOS){a.focus()}},onMaskTap:function(a){this.fireAction("masktap",[this,a],"doMaskTap")},doMaskTap:function(a,b){if(a.getDisabled()){return false}a.focus()},showMask:function(){if(this.getUseMask()){this.mask.setStyle("display","block")}},hideMask:function(){if(this.getUseMask()){this.mask.setStyle("display","none")}},focus:function(){var b=this,a=b.input;if(a&&a.dom.focus){a.dom.focus()}return b},blur:function(){var b=this,a=this.input;if(a&&a.dom.blur){a.dom.blur()}return b},select:function(){var b=this,a=b.input;if(a&&a.dom.setSelectionRange){a.dom.setSelectionRange(0,9999)}return b},onFocus:function(a){this.fireAction("focus",[a],"doFocus")},doFocus:function(b){var a=this;a.hideMask();if(!a.getIsFocused()){a.setStartValue(a.getValue())}a.setIsFocused(true)},onTouchStart:function(a){if(document.activeElement!=a.target){a.preventDefault()}},onBlur:function(a){this.fireAction("blur",[a],"doBlur")},doBlur:function(d){var b=this,c=b.getValue(),a=b.getStartValue();b.showMask();b.setIsFocused(false);if(String(c)!=String(a)){b.onChange(b,c,a)}},onClearIconTap:function(a){this.fireEvent("clearicontap",this,a);if(Ext.os.is.Android){this.focus()}},onClearIconPress:function(){this.clearIcon.addCls("x-pressing")},onClearIconRelease:function(){this.clearIcon.removeCls("x-pressing")},onClick:function(a){this.fireEvent("click",a)},onChange:function(b,c,a){if(this.useManualMaxLength()){this.trimValueToMaxLength()}this.fireEvent("change",b,c,a)},onPaste:function(a){if(this.useManualMaxLength()){this.trimValueToMaxLength()}this.fireEvent("paste",a)},onKeyUp:function(a){if(this.useManualMaxLength()){this.trimValueToMaxLength()}this.fireEvent("keyup",a)},onKeyDown:function(){this.ignoreInput=true},onInput:function(b){var a=this;if(a.ignoreInput){a.ignoreInput=false;return}setTimeout(function(){if(!a.ignoreInput){a.fireEvent("keyup",b);a.ignoreInput=false}},10)},onKeyPress:function(a){if(a.browserEvent.keyCode==13){this.fireEvent("keyup",a)}},onMouseDown:function(a){this.fireEvent("mousedown",a)},trimValueToMaxLength:function(){var a=this.getMaxLength();if(a){var b=this.getValue();if(b.length>this.getMaxLength()){this.setValue(b.slice(0,a))}}}},0,["input"],["component","input"],{component:true,input:true},["widget.input"],0,[Ext.field,"Input"],0));(Ext.cmd.derive("Ext.field.Field",Ext.Decorator,{alternateClassName:"Ext.form.Field",isField:true,isFormField:true,config:{baseCls:"x-field",label:null,labelAlign:"left",labelWidth:"30%",labelWrap:false,clearIcon:null,required:false,inputType:null,name:null,value:null,tabIndex:null},platformConfig:[{theme:["Windows","MountainView","Blackberry","Tizen"],labelAlign:"top"}],cachedConfig:{labelCls:null,requiredCls:"x-field-required",inputCls:null},getElementConfig:function(){var a="x-";return{reference:"element",className:"x-container",children:[{reference:"label",cls:a+"form-label",children:[{reference:"labelspan",tag:"span"}]},{reference:"innerElement",cls:a+"component-outer"}]}},updateLabel:function(b,d){var a=this.renderElement,c="x-";if(b){this.labelspan.setHtml(b);a.addCls(c+"field-labeled")}else{a.removeCls(c+"field-labeled")}},updateLabelAlign:function(b,c){var a=this.renderElement,d="x-";if(b){a.addCls(d+"label-align-"+b);if(b=="top"||b=="bottom"){this.label.setWidth("100%")}else{this.updateLabelWidth(this.getLabelWidth())}}if(c){a.removeCls(d+"label-align-"+c)}},updateLabelCls:function(a,b){if(a){this.label.addCls(a)}if(b){this.label.removeCls(b)}},updateLabelWidth:function(b){var a=this.getLabelAlign();if(b){if(a=="top"||a=="bottom"){this.label.setWidth("100%")}else{this.label.setWidth(b)}}},updateLabelWrap:function(b,c){var a="x-form-label-nowrap";if(!b){this.addCls(a)}else{this.removeCls(a)}},updateRequired:function(a){this.renderElement[a?"addCls":"removeCls"](this.getRequiredCls())},updateRequiredCls:function(a,b){if(this.getRequired()){this.renderElement.replaceCls(b,a)}},initialize:function(){var a=this;Ext.Decorator.prototype.initialize.call(this);a.doInitValue()},doInitValue:function(){this.originalValue=this.getInitialConfig().value},reset:function(){this.setValue(this.originalValue);return this},resetOriginalValue:function(){this.originalValue=this.getValue()},isDirty:function(){return false}},0,["field"],["component","field"],{component:true,field:true},["widget.field"],0,[Ext.field,"Field",Ext.form,"Field"],function(){}));(Ext.cmd.derive("Ext.field.Text",Ext.field.Field,{alternateClassName:"Ext.form.Text",config:{ui:"text",clearIcon:true,placeHolder:null,maxLength:null,autoComplete:null,autoCapitalize:null,autoCorrect:null,readOnly:null,component:{xtype:"input",type:"text",fastFocus:true},bubbleEvents:["action"]},initialize:function(){var a=this;Ext.field.Field.prototype.initialize.call(this);a.getComponent().on({scope:this,keyup:"onKeyUp",change:"onChange",focus:"onFocus",blur:"onBlur",paste:"onPaste",mousedown:"onMouseDown",clearicontap:"onClearIconTap"});a.originalValue=a.getValue()||"";a.getComponent().originalValue=a.originalValue;a.syncEmptyCls()},syncEmptyCls:function(){var b=(this._value)?this._value.length:false,a="x-empty";if(b){this.removeCls(a)}else{this.addCls(a)}},updateValue:function(c){var b=this.getComponent(),a=c!==undefined&&c!==null&&c!=="";if(b){b.setValue(c)}this[a&&this.isDirty()?"showClearIcon":"hideClearIcon"]();this.syncEmptyCls()},getValue:function(){var a=this;a._value=a.getComponent().getValue();a.syncEmptyCls();return a._value},updatePlaceHolder:function(a){this.getComponent().setPlaceHolder(a)},updateMaxLength:function(a){this.getComponent().setMaxLength(a)},updateAutoComplete:function(a){this.getComponent().setAutoComplete(a)},updateAutoCapitalize:function(a){this.getComponent().setAutoCapitalize(a)},updateAutoCorrect:function(a){this.getComponent().setAutoCorrect(a)},updateReadOnly:function(a){if(a){this.hideClearIcon()}else{this.showClearIcon()}this.getComponent().setReadOnly(a)},updateInputType:function(a){var b=this.getComponent();if(b){b.setType(a)}},updateName:function(a){var b=this.getComponent();if(b){b.setName(a)}},updateTabIndex:function(b){var a=this.getComponent();if(a){a.setTabIndex(b)}},updateInputCls:function(a,b){var c=this.getComponent();if(c){c.replaceCls(b,a)}},doSetDisabled:function(b){var c=this;Ext.field.Field.prototype.doSetDisabled.apply(this,arguments);var a=c.getComponent();if(a){a.setDisabled(b)}if(b){c.hideClearIcon()}else{c.showClearIcon()}},showClearIcon:function(){var b=this,c=b.getValue(),a=c!==undefined&&c!==null&&c!=="";if(b.getClearIcon()&&!b.getDisabled()&&!b.getReadOnly()&&a){b.element.addCls("x-field-clearable")}return b},hideClearIcon:function(){if(this.getClearIcon()){this.element.removeCls("x-field-clearable")}},onKeyUp:function(a){this.fireAction("keyup",[this,a],"doKeyUp")},doKeyUp:function(b,d){var c=b.getValue(),a=c!==undefined&&c!==null&&c!=="";this[a?"showClearIcon":"hideClearIcon"]();if(d.browserEvent.keyCode===13){b.fireAction("action",[b,d],"doAction")}},doAction:function(){this.blur()},onClearIconTap:function(a){this.fireAction("clearicontap",[this,a],"doClearIconTap")},doClearIconTap:function(a,b){a.setValue("");a.getValue()},onChange:function(b,c,a){b.fireEvent("change",this,c,a)},onFocus:function(a){this.addCls("x-field-focused");this.isFocused=true;this.fireEvent("focus",this,a)},onBlur:function(b){var a=this;this.removeCls("x-field-focused");this.isFocused=false;a.fireEvent("blur",a,b);setTimeout(function(){a.isFocused=false},50)},onPaste:function(a){this.fireEvent("paste",this,a)},onMouseDown:function(a){this.fireEvent("mousedown",this,a)},focus:function(){this.getComponent().focus();return this},blur:function(){this.getComponent().blur();return this},select:function(){this.getComponent().select();return this},resetOriginalValue:function(){Ext.field.Field.prototype.resetOriginalValue.call(this);var a=this.getComponent();if(a&&a.hasOwnProperty("originalValue")){this.getComponent().originalValue=this.originalValue}this.reset()},reset:function(){this.getComponent().reset();this.getValue();this[this.isDirty()?"showClearIcon":"hideClearIcon"]()},isDirty:function(){var a=this.getComponent();if(a){return a.isDirty()}return false}},0,["textfield"],["component","field","textfield"],{component:true,field:true,textfield:true},["widget.textfield"],0,[Ext.field,"Text",Ext.form,"Text"],0));(Ext.cmd.derive("Ext.app.Action",Ext.Base,{config:{scope:null,application:null,controller:null,action:null,args:[],url:undefined,data:{},title:null,beforeFilters:[],currentFilterIndex:-1},constructor:function(a){this.initConfig(a);this.getUrl()},applyBeforeFilters:function(a){return a||[]},execute:function(){this.resume()},resume:function(){var b=this.getCurrentFilterIndex()+1,c=this.getBeforeFilters(),a=this.getController(),d=c[b];if(d){this.setCurrentFilterIndex(b);d.call(a,this)}else{a[this.getAction()].apply(a,this.getArgs())}},applyUrl:function(a){if(a===null||a===undefined){a=this.urlEncode()}return a},applyController:function(a){var c=this.getApplication(),b=c.getCurrentProfile();if(Ext.isString(a)){a=c.getController(a,b?b.getNamespace():null)}return a},urlEncode:function(){var a=this.getController(),b;if(a instanceof Ext.app.Controller){b=a.$className.split(".");a=b[b.length-1]}return a+"/"+this.getAction()}},1,0,0,0,0,0,[Ext.app,"Action"],0));(Ext.cmd.derive("Ext.app.Controller",Ext.Base,{config:{refs:{},routes:{},control:{},before:{},application:{},stores:[],models:[],views:[]},constructor:function(a){this.initConfig(a);this.mixins.observable.constructor.call(this,a)},init:Ext.emptyFn,launch:Ext.emptyFn,redirectTo:function(a){return this.getApplication().redirectTo(a)},execute:function(b,a){b.setBeforeFilters(this.getBefore()[b.getAction()]);b.execute()},applyBefore:function(e){var d,a,c,b;for(a in e){d=Ext.Array.from(e[a]);c=d.length;for(b=0;b<c;b++){d[b]=this[d[b]]}e[a]=d}return e},applyControl:function(a){this.control(a,this);return a},applyRefs:function(a){this.ref(a);return a},applyRoutes:function(a){var f=this instanceof Ext.app.Application?this:this.getApplication(),c=f.getRouter(),b,e,d;for(e in a){b=a[e];d={controller:this.$className};if(Ext.isString(b)){d.action=b}else{Ext.apply(d,b)}c.connect(e,d)}return a},applyStores:function(a){return this.getFullyQualified(a,"store")},applyModels:function(a){return this.getFullyQualified(a,"model")},applyViews:function(a){return this.getFullyQualified(a,"view")},getFullyQualified:function(b,e){var f=b.length,a=this.getApplication().getName(),c,d;for(d=0;d<f;d++){c=b[d];if(Ext.isString(c)&&(Ext.Loader.getPrefix(c)===""||c===a)){b[d]=a+"."+e+"."+c}}return b},control:function(a){this.getApplication().control(a,this)},ref:function(b){var d=this,f,c,a,e;for(f in b){a=b[f];c="get"+Ext.String.capitalize(f);if(!this[c]){if(Ext.isString(b[f])){e={ref:f,selector:a}}else{e=b[f]}this[c]=function(j,h){var g=[j,h];return function(){return d.getRef.apply(d,g.concat.apply(g,arguments))}}(f,e)}this.references=this.references||[];this.references.push(f.toLowerCase())}},getRef:function(d,e,a){this.refCache=this.refCache||{};e=e||{};a=a||{};Ext.apply(e,a);if(e.forceCreate){return Ext.ComponentManager.create(e,"component")}var c=this,b=c.refCache[d];if(!b){c.refCache[d]=b=Ext.ComponentQuery.query(e.selector)[0];if(!b&&e.autoCreate){c.refCache[d]=b=Ext.ComponentManager.create(e,"component")}if(b){b.on("destroy",function(){c.refCache[d]=null})}}return b},hasRef:function(a){return this.references&&this.references.indexOf(a.toLowerCase())!==-1}},1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.app,"Controller"],function(){}));(Ext.cmd.derive("Ext.app.History",Ext.Base,{config:{actions:[],updateUrl:true,token:""},constructor:function(a){if(Ext.feature.has.History){window.addEventListener("hashchange",Ext.bind(this.detectStateChange,this))}else{setInterval(Ext.bind(this.detectStateChange,this),100)}this.initConfig(a);if(a&&Ext.isEmpty(a.token)){this.setToken(window.location.hash.substr(1))}},add:function(c,a){c=Ext.factory(c,Ext.app.Action);this.getActions().push(c);var b=c.getUrl();if(this.getUpdateUrl()){this.setToken(b);window.location.hash=b}if(a!==true){this.fireEvent("change",b)}this.setToken(b)},back:function(){var b=this.getActions(),a=b[b.length-2];if(a){b.pop();a.getController().getApplication().redirectTo(a.getUrl())}else{b[b.length-1].getController().getApplication().redirectTo("")}},applyToken:function(a){return a[0]=="#"?a.substr(1):a},detectStateChange:function(){var b=this.applyToken(window.location.hash),a=this.getToken();if(b!=a){this.onStateChange();this.setToken(b)}},onStateChange:function(){this.fireEvent("change",window.location.hash.substr(1))}},1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.app,"History"],0));(Ext.cmd.derive("Ext.app.Profile",Ext.Base,{config:{namespace:"auto",name:"auto",controllers:[],models:[],views:[],stores:[],application:null},constructor:function(a){this.initConfig(a);this.mixins.observable.constructor.apply(this,arguments)},isActive:function(){return false},launch:Ext.emptyFn,applyNamespace:function(a){if(a=="auto"){a=this.getName()}return a.toLowerCase()},applyName:function(a){if(a=="auto"){var b=this.$className.split(".");a=b[b.length-1]}return a},getDependencies:function(){var c=[],g=Ext.String.format,b=this.getApplication().getName(),d=this.getNamespace(),f={model:this.getModels(),view:this.getViews(),controller:this.getControllers(),store:this.getStores()},e,h,a;for(e in f){h=[];Ext.each(f[e],function(j){if(Ext.isString(j)){if(Ext.isString(j)&&(Ext.Loader.getPrefix(j)===""||j===b)){j=b+"."+e+"."+d+"."+j}h.push(j);c.push(j)}},this);f[e]=h}f.all=c;return f}},1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.app,"Profile"],0));(Ext.cmd.derive("Ext.app.Route",Ext.Base,{config:{conditions:{},url:null,controller:null,action:null,initialized:false},constructor:function(a){this.initConfig(a)},recognize:function(b){if(!this.getInitialized()){this.initialize()}if(this.recognizes(b)){var c=this.matchesFor(b),a=b.match(this.matcherRegex);a.shift();return Ext.applyIf(c,{controller:this.getController(),action:this.getAction(),url:b,args:a,historyUrl:b})}},initialize:function(){this.paramMatchingRegex=new RegExp(/:([0-9A-Za-z\_]*)/g);this.paramsInMatchString=this.getUrl().match(this.paramMatchingRegex)||[];this.matcherRegex=this.createMatcherRegex(this.getUrl());this.setInitialized(true)},recognizes:function(a){return this.matcherRegex.test(a)},matchesFor:function(b){var f={},e=this.paramsInMatchString,a=b.match(this.matcherRegex),d=e.length,c;a.shift();for(c=0;c<d;c++){f[e[c].replace(":","")]=a[c]}return f},argsFor:function(c){var b=[],f=this.paramsInMatchString,a=c.match(this.matcherRegex),e=f.length,d;a.shift();for(d=0;d<e;d++){b.push(f[d].replace(":",""));params[f[d].replace(":","")]=a[d]}return params},urlFor:function(b){var a=this.getUrl();for(var c in b){a=a.replace(":"+c,b[c])}return a},createMatcherRegex:function(a){var e=this.paramsInMatchString,d=e.length,b,c,f;for(b=0;b<d;b++){c=this.getConditions()[e[b]];f=Ext.util.Format.format("({0})",c||"[%a-zA-Z0-9\\-\\_\\s,]+");a=a.replace(new RegExp(e[b]),f)}return new RegExp("^"+a+"$")}},1,0,0,0,0,0,[Ext.app,"Route"],0));(Ext.cmd.derive("Ext.app.Router",Ext.Base,{config:{routes:[],defaults:{action:"index"}},constructor:function(a){this.initConfig(a)},connect:function(b,c){c=Ext.apply({url:b},c||{},this.getDefaults());var a=Ext.create("Ext.app.Route",c);this.getRoutes().push(a);return a},recognize:function(c){var b=this.getRoutes(),e=b.length,d,a;for(d=0;d<e;d++){a=b[d].recognize(c);if(a!==undefined){return a}}return undefined},draw:function(a){a.call(this,this)},clear:function(){this.setRoutes([])}},1,0,0,0,0,0,[Ext.app,"Router"],function(){}));(Ext.cmd.derive("Ext.app.Application",Ext.app.Controller,{config:{profiles:[],controllers:[],history:{},name:null,appFolder:"app",router:{},controllerInstances:[],profileInstances:[],currentProfile:null,launch:Ext.emptyFn,enableLoader:true,requires:[],themeVariationPrefix:"x-theme-variation-",themeVariationTransitionCls:null,themeVariation:null},constructor:function(a){a=a||{};Ext.applyIf(a,{application:this});this.initConfig(a);for(var b in a){this[b]=a[b]}Ext.require(this.getRequires(),function(){if(this.getEnableLoader()!==false){Ext.require(this.getProfiles(),this.onProfilesLoaded,this)}},this)},dispatch:function(e,d){e=e||{};Ext.applyIf(e,{application:this});e=Ext.factory(e,Ext.app.Action);if(e){var c=this.getCurrentProfile(),b=c?c.getNamespace():undefined,a=this.getController(e.getController(),b);if(a){if(d!==false){this.getHistory().add(e,true)}a.execute(e)}}},redirectTo:function(c){if(Ext.data&&Ext.data.Model&&c instanceof Ext.data.Model){var a=c;c=a.toUrl()}var b=this.getRouter().recognize(c);if(b){b.url=c;if(a){b.data={};b.data.record=a}return this.dispatch(b)}},control:function(h,d){d=d||this;var j=this.getEventDispatcher(),g=(d)?d.getRefs():{},c,e,b,f,a;for(c in h){if(h.hasOwnProperty(c)){f=h[c];a=g[c];if(a){c=a.selector||a}for(e in f){b=f[e];if(Ext.isString(b)){b=d[b]}j.addListener("component",c,e,b,d)}}}},getController:function(b,d){var f=this.getControllerInstances(),a=this.getName(),e=Ext.String.format,c;if(b instanceof Ext.app.Controller){return b}if(f[b]){return f[b]}else{c=e("{0}.controller.{1}",a,b);d=e("{0}.controller.{1}.{2}",a,d,b);return f[d]||f[c]}},onProfilesLoaded:function(){var b=this.getProfiles(),e=b.length,g=[],d=this.gatherDependencies(),f,c,a;for(c=0;c<e;c++){g[c]=Ext.create(b[c],{application:this});a=g[c].getDependencies();d=d.concat(a.all);if(g[c].isActive()&&!f){f=g[c];this.setCurrentProfile(f);this.setControllers(this.getControllers().concat(a.controller));this.setModels(this.getModels().concat(a.model));this.setViews(this.getViews().concat(a.view));this.setStores(this.getStores().concat(a.store))}}this.setProfileInstances(g);Ext.require(d,this.loadControllerDependencies,this)},loadControllerDependencies:function(){this.instantiateControllers();var g=this.getControllerInstances(),f=[],c=[],e,b,a,d;for(d in g){b=g[d];a=b.getStores();c=c.concat(a);f=f.concat(b.getModels().concat(b.getViews()).concat(a))}this.setStores(this.getStores().concat(c));Ext.require(f,this.onDependenciesLoaded,this)},onDependenciesLoaded:function(){var c=this,b=this.getCurrentProfile(),e=this.getLaunch(),d,a;this.instantiateStores();d=this.getControllerInstances();for(a in d){d[a].init(this)}if(b){b.launch()}e.call(c);for(a in d){d[a].launch(this)}c.redirectTo(window.location.hash.substr(1))},gatherDependencies:function(){var a=this.getModels().concat(this.getViews()).concat(this.getControllers());Ext.each(this.getStores(),function(b){if(Ext.isString(b)){a.push(b)}},this);return a},instantiateStores:function(){var b=this.getStores(),f=b.length,c,a,d,g,e;for(e=0;e<f;e++){c=b[e];if(Ext.data&&Ext.data.Store&&!(c instanceof Ext.data.Store)){if(Ext.isString(c)){d=c;a=Ext.ClassManager.classes[c];c={xclass:c};if(a.prototype.defaultConfig.storeId===undefined){g=d.split(".");c.id=g[g.length-1]}}b[e]=Ext.factory(c,Ext.data.Store)}}this.setStores(b)},instantiateControllers:function(){var e=this.getControllers(),d={},c=e.length,a,b;for(b=0;b<c;b++){a=e[b];d[a]=Ext.create(a,{application:this})}return this.setControllerInstances(d)},applyControllers:function(a){return this.getFullyQualified(a,"controller")},applyProfiles:function(a){return this.getFullyQualified(a,"profile")},applyName:function(a){var b;if(a&&a.match(/ /g)){b=a;a=a.replace(/ /g,"")}return a},updateName:function(a){Ext.ClassManager.setNamespace(a+".app",this);if(!Ext.Loader.config.paths[a]){Ext.Loader.setPath(a,this.getAppFolder())}},applyRouter:function(a){return Ext.factory(a,Ext.app.Router,this.getRouter())},applyHistory:function(a){var b=Ext.factory(a,Ext.app.History,this.getHistory());b.on("change",this.onHistoryChange,this);return b},onHistoryChange:function(a){this.dispatch(this.getRouter().recognize(a),false)},updateThemeVariation:function(h,l){var f=Ext.getBody().getParent(),d=this.getThemeVariationPrefix()||"",k=this.getThemeVariationTransitionCls();if(Ext.isFunction(h)){h=h.call(this)}if(!Ext.isString(h)){Ext.Error.raise("Theme variation must be a String.'")}if(k){var g="",c=0,m=document.styleSheets[0].cssRules,e,j,a,b;f.addCls(k);for(e in m){j=m[e];if(j.selectorText&&j.selectorText.indexOf("."+k)>=1){g+=j.cssText}}a=g.match(/[0-9]+s/g);for(e in a){b=parseInt(a[e]);if(b>c){c=b}}if(this.$themeVariationChangeTimeout){clearTimeout(this.$themeVariationChangeTimeout);this.$themeVariationChangeTimeout=null}this.$themeVariationChangeTimeout=Ext.defer(function(){f.removeCls(k)},b*1000)}f.removeCls(d+l);f.addCls(d+h)}},1,0,0,0,0,0,[Ext.app,"Application"],function(){}));(Ext.cmd.derive("Ext.carousel.Item",Ext.Decorator,{config:{baseCls:"x-carousel-item",component:null,translatable:true}},0,0,["component"],{component:true},0,0,[Ext.carousel,"Item"],0));Ext.define("Ext.carousel.Indicator",{extend:Ext.Component,xtype:"carouselindicator",alternateClassName:"Ext.Carousel.Indicator",config:{baseCls:"x-carousel-indicator",direction:"horizontal"},initialize:function(){Ext.Component.prototype.initialize.call(this);this.indicators=[];this.element.on({tap:"onTap",scope:this})},updateDirection:function(a,c){var b=this.getBaseCls();this.element.replaceCls(c,a,b);if(a==="horizontal"){this.setBottom(0);this.setRight(null)}else{this.setRight(0);this.setBottom(null)}},addIndicator:function(){this.indicators.push(this.element.createChild({tag:"span"}))},removeIndicator:function(){var a=this.indicators;if(a.length>0){a.pop().destroy()}},setActiveIndex:function(b){var e=this.indicators,d=this.activeIndex,a=e[d],f=e[b],c=this.getBaseCls();if(a){a.removeCls(c,null,"active")}if(f){f.addCls(c,null,"active")}this.activeIndex=b;return this},onTap:function(f){var g=f.touch,a=this.element.getPageBox(),d=a.left+(a.width/2),b=a.top+(a.height/2),c=this.getDirection();if((c==="horizontal"&&g.pageX>=d)||(c==="vertical"&&g.pageY>=b)){this.fireEvent("next",this)}else{this.fireEvent("previous",this)}},destroy:function(){var d=this.indicators,b,c,a;for(b=0,c=d.length;b<c;b++){a=d[b];a.destroy()}d.length=0;Ext.Component.prototype.destroy.call(this)}});(Ext.cmd.derive("Ext.util.TranslatableGroup",Ext.util.translatable.Abstract,{config:{items:[],activeIndex:0,itemLength:{x:0,y:0}},applyItems:function(a){return Ext.Array.from(a)},doTranslate:function(n,m){var l=this.getItems(),p=this.getActiveIndex(),j=this.getItemLength(),d=j.x,c=j.y,h=Ext.isNumber(n),g=Ext.isNumber(m),e,f,k,o,b,a;for(f=0,k=l.length;f<k;f++){o=l[f];if(o){e=(f-p);if(h){b=n+e*d}if(g){a=m+e*c}o.translate(b,a)}}}},0,0,0,0,0,0,[Ext.util,"TranslatableGroup"],0));Ext.define("Ext.carousel.Carousel",{extend:Ext.Container,alternateClassName:"Ext.Carousel",xtype:"carousel",config:{baseCls:"x-carousel",direction:"horizontal",directionLock:false,animation:{duration:250,easing:{type:"ease-out"}},indicator:true,ui:"dark",itemConfig:{},bufferSize:1,itemLength:null},itemLength:0,offset:0,flickStartOffset:0,flickStartTime:0,dragDirection:0,count:0,painted:false,activeIndex:-1,beforeInitialize:function(){this.element.on({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",scope:this});this.element.on("painted",function(){this.onSizeChange()},this,{delay:10,single:true});this.carouselItems=[];this.orderedCarouselItems=[];this.inactiveCarouselItems=[];this.hiddenTranslation=0},updateBufferSize:function(n){var l=Ext.carousel.Item,h=n*2+1,m=this.isRendered(),c=this.innerElement,g=this.carouselItems,f=g.length,e=this.getItemConfig(),d=this.getItemLength(),j=this.getDirection(),b=j==="horizontal"?"setWidth":"setHeight",a,k;for(a=f;a<h;a++){k=Ext.factory(e,l);if(d){k[b].call(k,d)}k.setLayoutSizeFlags(this.LAYOUT_BOTH);g.push(k);c.append(k.renderElement);if(m&&k.setRendered(true)){k.fireEvent("renderedchange",this,k,true)}}this.getTranslatable().setActiveIndex(n)},setRendered:function(g){var a=this.rendered;if(g!==a){this.rendered=g;var b=this.items.items,d=this.carouselItems,c,f,e;for(c=0,f=b.length;c<f;c++){e=b[c];if(!e.isInnerItem()){e.setRendered(g)}}if(d!=null){for(c=0,f=d.length;c<f;c++){d[c].setRendered(g)}}return true}return false},onSizeChange:function(){this.refreshSizing();this.refreshCarouselItems();this.refreshActiveItem()},onItemAdd:function(c,b){Ext.Container.prototype.onItemAdd.apply(this,arguments);var d=this.getInnerItems().indexOf(c),a=this.getIndicator();if(a&&c.isInnerItem()){a.addIndicator()}if(d<=this.getActiveIndex()){this.refreshActiveIndex()}if(this.isIndexDirty(d)&&!this.isItemsInitializing){this.refreshActiveItem()}},doItemLayoutAdd:function(a){if(a.isInnerItem()){return}Ext.Container.prototype.doItemLayoutAdd.apply(this,arguments)},onItemRemove:function(f,b){Ext.Container.prototype.onItemRemove.apply(this,arguments);var h=this.getInnerItems().indexOf(f),a=this.getIndicator(),d=this.carouselItems,c,e,g;if(f.isInnerItem()&&a){a.removeIndicator()}if(h<=this.getActiveIndex()){this.refreshActiveIndex()}if(this.isIndexDirty(h)){for(c=0,e=d.length;c<e;c++){g=d[c];if(g.getComponent()===f){g.setComponent(null)}}this.refreshActiveItem()}},doItemLayoutRemove:function(a){if(a.isInnerItem()){return}Ext.Container.prototype.doItemLayoutRemove.apply(this,arguments)},onInnerItemMove:function(b,c,a){if((this.isIndexDirty(c)||this.isIndexDirty(a))){this.refreshActiveItem()}},doItemLayoutMove:function(a){if(a.isInnerItem()){return}Ext.Container.prototype.doItemLayoutMove.apply(this,arguments)},isIndexDirty:function(b){var a=this.getActiveIndex(),c=this.getBufferSize();return(b>=a-c&&b<=a+c)},getTranslatable:function(){var a=this.translatable;if(!a){this.translatable=a=new Ext.util.TranslatableGroup();a.setItems(this.orderedCarouselItems);a.on("animationend","onAnimationEnd",this)}return a},onDragStart:function(f){var d=this.getDirection(),b=f.absDeltaX,a=f.absDeltaY,c=this.getDirectionLock();this.isDragging=true;if(c){if((d==="horizontal"&&b>a)||(d==="vertical"&&a>b)){f.stopPropagation()}else{this.isDragging=false;return}}this.getTranslatable().stopAnimation();this.dragStartOffset=this.offset;this.dragDirection=0},onDrag:function(k){if(!this.isDragging){return}var l=this.dragStartOffset,m=this.getDirection(),n=m==="horizontal"?k.deltaX:k.deltaY,a=this.offset,j=this.flickStartTime,c=this.dragDirection,b=Ext.Date.now(),h=this.getActiveIndex(),f=this.getMaxItemIndex(),d=c,g;if((h===0&&n>0)||(h===f&&n<0)){n*=0.5}g=l+n;if(g>a){c=1}else{if(g<a){c=-1}}if(c!==d||(b-j)>300){this.flickStartOffset=a;this.flickStartTime=b}this.dragDirection=c;this.setOffset(g)},onDragEnd:function(k){if(!this.isDragging){return}this.onDrag(k);this.isDragging=false;var a=Ext.Date.now(),j=this.itemLength,g=j/2,f=this.offset,n=this.getActiveIndex(),c=this.getMaxItemIndex(),h=0,m=f-this.flickStartOffset,b=a-this.flickStartTime,l=this.getIndicator(),d;if(b>0&&Math.abs(m)>=10){d=m/b;if(Math.abs(d)>=1){if(d<0&&n<c){h=-1}else{if(d>0&&n>0){h=1}}}}if(h===0){if(n<c&&f<-g){h=-1}else{if(n>0&&f>g){h=1}}}if(l){l.setActiveIndex(n-h)}this.animationDirection=h;this.setOffsetAnimated(h*j)},applyAnimation:function(a){a.easing=Ext.factory(a.easing,Ext.fx.easing.EaseOut);return a},updateDirection:function(b){var a=this.getIndicator();this.currentAxis=(b==="horizontal")?"x":"y";if(a){a.setDirection(b)}},setOffset:function(a){this.offset=a;if(Ext.isNumber(this.itemOffset)){this.getTranslatable().translateAxis(this.currentAxis,a+this.itemOffset)}return this},setOffsetAnimated:function(b){var a=this.getIndicator();if(a){a.setActiveIndex(this.getActiveIndex()-this.animationDirection)}this.offset=b;this.getTranslatable().translateAxis(this.currentAxis,b+this.itemOffset,this.getAnimation());return this},onAnimationEnd:function(b){var c=this.getActiveIndex(),a=this.animationDirection,e=this.currentAxis,f=b[e],d=this.itemLength,g;if(a===-1){g=d+f}else{if(a===1){g=f-d}else{g=f}}g-=this.itemOffset;this.offset=g;this.setActiveItem(c-a)},refresh:function(){this.refreshSizing();this.refreshActiveItem()},refreshSizing:function(){var a=this.element,b=this.getItemLength(),e={x:0,y:0},c,d;if(this.getDirection()==="horizontal"){d=a.getWidth()}else{d=a.getHeight()}this.hiddenTranslation=-d;if(b===null){b=d;c=0}else{c=(d-b)/2}this.itemLength=b;this.itemOffset=c;e[this.currentAxis]=b;this.getTranslatable().setItemLength(e)},refreshOffset:function(){this.setOffset(this.offset)},refreshActiveItem:function(){this.doSetActiveItem(this.getActiveItem())},getActiveIndex:function(){return this.activeIndex},refreshActiveIndex:function(){this.activeIndex=this.getInnerItemIndex(this.getActiveItem())},refreshCarouselItems:function(){var a=this.carouselItems,b,d,c;for(b=0,d=a.length;b<d;b++){c=a[b];c.getTranslatable().refresh()}this.refreshInactiveCarouselItems()},refreshInactiveCarouselItems:function(){var a=this.inactiveCarouselItems,f=this.hiddenTranslation,c=this.currentAxis,b,e,d;for(b=0,e=a.length;b<e;b++){d=a[b];d.translateAxis(c,f)}},getMaxItemIndex:function(){return this.innerItems.length-1},getInnerItemIndex:function(a){return this.innerItems.indexOf(a)},getInnerItemAt:function(a){return this.innerItems[a]},applyActiveItem:function(){var b=Ext.Container.prototype.applyActiveItem.apply(this,arguments),a;if(b){a=this.getInnerItemIndex(b);if(a!==-1){this.activeIndex=a;return b}}},doSetActiveItem:function(g){var q=this.getActiveIndex(),e=this.getMaxItemIndex(),m=this.getIndicator(),c=this.getBufferSize(),k=this.carouselItems.slice(),n=this.orderedCarouselItems,p={},o={},a,l,b,f,h,j,d;if(k.length===0){return}Ext.Container.prototype.doSetActiveItem.apply(this,arguments);n.length=0;if(g){b=g.getId();o[b]=g;p[b]=c;if(q>0){for(f=1;f<=c;f++){h=q-f;if(h>=0){a=this.getInnerItemAt(h);b=a.getId();o[b]=a;p[b]=c-f}else{break}}}if(q<e){for(f=1;f<=c;f++){h=q+f;if(h<=e){a=this.getInnerItemAt(h);b=a.getId();o[b]=a;p[b]=c+f}else{break}}}for(f=0,j=k.length;f<j;f++){d=k[f];l=d.getComponent();if(l){b=l.getId();if(p.hasOwnProperty(b)){k.splice(f,1);f--;j--;delete o[b];n[p[b]]=d}}}for(b in o){if(o.hasOwnProperty(b)){a=o[b];d=k.pop();d.setComponent(a);n[p[b]]=d}}}this.inactiveCarouselItems.length=0;this.inactiveCarouselItems=k;this.refreshOffset();this.refreshInactiveCarouselItems();if(m){m.setActiveIndex(q)}},next:function(){this.setOffset(0);if(this.activeIndex===this.getMaxItemIndex()){return this}this.animationDirection=-1;this.setOffsetAnimated(-this.itemLength);return this},previous:function(){this.setOffset(0);if(this.activeIndex===0){return this}this.animationDirection=1;this.setOffsetAnimated(this.itemLength);return this},applyIndicator:function(a,b){return Ext.factory(a,Ext.carousel.Indicator,b)},updateIndicator:function(a){if(a){this.insertFirst(a);a.setUi(this.getUi());a.on({next:"next",previous:"previous",scope:this})}},destroy:function(){var a=this.carouselItems.slice();this.carouselItems.length=0;Ext.destroy(a,this.getIndicator(),this.translatable);Ext.Container.prototype.destroy.call(this);delete this.carouselItems}},function(){});(Ext.cmd.derive("Ext.mixin.Sortable",Ext.mixin.Mixin,{mixinConfig:{id:"sortable"},config:{sorters:null,defaultSortDirection:"ASC",sortRoot:null},dirtySortFn:false,sortFn:null,sorted:false,applySorters:function(a,b){if(!b){b=this.createSortersCollection()}b.clear();this.sorted=false;if(a){this.addSorters(a)}return b},createSortersCollection:function(){this._sorters=Ext.create("Ext.util.Collection",function(a){return a.getId()});return this._sorters},addSorter:function(b,a){this.addSorters([b],a)},addSorters:function(c,a){var b=this.getSorters();return this.insertSorters(b?b.length:0,c,a)},insertSorter:function(a,c,b){return this.insertSorters(a,[c],b)},insertSorters:function(e,h,a){if(!Ext.isArray(h)){h=[h]}var f=h.length,j=a||this.getDefaultSortDirection(),c=this.getSortRoot(),k=this.getSorters(),l=[],g,b,m,d;if(!k){k=this.createSortersCollection()}for(b=0;b<f;b++){m=h[b];g={direction:j,root:c};if(typeof m==="string"){d=k.get(m);if(!d){g.property=m}else{if(a){d.setDirection(a)}else{d.toggle()}continue}}else{if(Ext.isFunction(m)){g.sorterFn=m}else{if(Ext.isObject(m)){if(!m.isSorter){if(m.fn){m.sorterFn=m.fn;delete m.fn}g=Ext.apply(g,m)}else{l.push(m);if(!m.getRoot()){m.setRoot(c)}continue}}}}m=Ext.create("Ext.util.Sorter",g);l.push(m)}for(b=0,f=l.length;b<f;b++){k.insert(e+b,l[b])}this.dirtySortFn=true;if(k.length){this.sorted=true}return k},removeSorter:function(a){return this.removeSorters([a])},removeSorters:function(d){if(!Ext.isArray(d)){d=[d]}var b=d.length,c=this.getSorters(),a,e;for(a=0;a<b;a++){e=d[a];if(typeof e==="string"){c.removeAtKey(e)}else{if(typeof e==="function"){c.each(function(f){if(f.getSorterFn()===e){c.remove(f)}})}else{if(e.isSorter){c.remove(e)}}}}if(!c.length){this.sorted=false}},updateSortFn:function(){var a=this.getSorters().items;this.sortFn=function(d,c){var f=a.length,b,e;for(e=0;e<f;e++){b=a[e].sort.call(this,d,c);if(b!==0){break}}return b};this.dirtySortFn=false;return this.sortFn},getSortFn:function(){if(this.dirtySortFn){return this.updateSortFn()}return this.sortFn},sort:function(a){Ext.Array.sort(a,this.getSortFn());return a},findInsertionIndex:function(b,e,g){var h=0,a=b.length-1,d=g||this.getSortFn(),c,f;while(h<=a){c=(h+a)>>1;f=d(e,b[c]);if(f>=0){h=c+1}else{if(f<0){a=c-1}}}return h}},0,0,0,0,0,0,[Ext.mixin,"Sortable"],0));(Ext.cmd.derive("Ext.mixin.Filterable",Ext.mixin.Mixin,{mixinConfig:{id:"filterable"},config:{filters:null,filterRoot:null},dirtyFilterFn:false,filterFn:null,filtered:false,applyFilters:function(a,b){if(!b){b=this.createFiltersCollection()}b.clear();this.filtered=false;this.dirtyFilterFn=true;if(a){this.addFilters(a)}return b},createFiltersCollection:function(){this._filters=Ext.create("Ext.util.Collection",function(a){return a.getId()});return this._filters},addFilter:function(a){this.addFilters([a])},addFilters:function(b){var a=this.getFilters();return this.insertFilters(a?a.length:0,b)},insertFilter:function(a,b){return this.insertFilters(a,[b])},insertFilters:function(h,c){if(!Ext.isArray(c)){c=[c]}var j=c.length,a=this.getFilterRoot(),d=this.getFilters(),e=[],f,g,b;if(!d){d=this.createFiltersCollection()}for(g=0;g<j;g++){b=c[g];f={root:a};if(Ext.isFunction(b)){f.filterFn=b}else{if(Ext.isObject(b)){if(!b.isFilter){if(b.fn){b.filterFn=b.fn;delete b.fn}f=Ext.apply(f,b)}else{e.push(b);if(!b.getRoot()){b.setRoot(a)}continue}}}b=Ext.create("Ext.util.Filter",f);e.push(b)}for(g=0,j=e.length;g<j;g++){d.insert(h+g,e[g])}this.dirtyFilterFn=true;if(d.length){this.filtered=true}return d},removeFilters:function(e){if(!Ext.isArray(e)){e=[e]}var d=e.length,c=this.getFilters(),a,b;for(a=0;a<d;a++){b=e[a];if(typeof b==="string"){c.each(function(f){if(f.getProperty()===b){c.remove(f)}})}else{if(typeof b==="function"){c.each(function(f){if(f.getFilterFn()===b){c.remove(f)}})}else{if(b.isFilter){c.remove(b)}else{if(b.property!==undefined&&b.value!==undefined){c.each(function(f){if(f.getProperty()===b.property&&f.getValue()===b.value){c.remove(f)}})}}}}}if(!c.length){this.filtered=false}},updateFilterFn:function(){var a=this.getFilters().items;this.filterFn=function(h){var f=true,g=a.length,b;for(b=0;b<g;b++){var e=a[b],d=e.getFilterFn(),c=e.getScope()||this;f=f&&d.call(c,h)}return f};this.dirtyFilterFn=false;return this.filterFn},filter:function(a){return this.getFilters().length?Ext.Array.filter(a,this.getFilterFn()):a},isFiltered:function(a){return this.getFilters().length?!this.getFilterFn()(a):false},getFilterFn:function(){if(this.dirtyFilterFn){return this.updateFilterFn()}return this.filterFn}},0,0,0,0,0,0,[Ext.mixin,"Filterable"],0));(Ext.cmd.derive("Ext.util.Collection",Ext.Base,{config:{autoFilter:true,autoSort:true},constructor:function(b,a){var c=this;c.all=[];c.items=[];c.keys=[];c.indices={};c.map={};c.length=0;if(b){c.getKey=b}this.initConfig(a)},updateAutoSort:function(a,b){if(b===false&&a&&this.items.length){this.sort()}},updateAutoFilter:function(b,a){if(a===false&&b&&this.all.length){this.filter()}},insertSorters:function(){this.mixins.sortable.insertSorters.apply(this,arguments);if(this.getAutoSort()&&this.items.length){this.sort()}return this},removeSorters:function(a){this.mixins.sortable.removeSorters.call(this,a);if(this.sorted&&this.getAutoSort()&&this.items.length){this.sort()}return this},applyFilters:function(a){var b=this.mixins.filterable.applyFilters.call(this,a);if(!a&&this.all.length&&this.getAutoFilter()){this.filter()}return b},addFilters:function(a){this.mixins.filterable.addFilters.call(this,a);if(this.items.length&&this.getAutoFilter()){this.filter()}return this},removeFilters:function(a){this.mixins.filterable.removeFilters.call(this,a);if(this.filtered&&this.all.length&&this.getAutoFilter()){this.filter()}return this},filter:function(c,b,d,a){if(c){if(Ext.isString(c)){this.addFilters({property:c,value:b,anyMatch:d,caseSensitive:a});return this.items}else{this.addFilters(c);return this.items}}this.items=this.mixins.filterable.filter.call(this,this.all.slice());this.updateAfterFilter();if(this.sorted&&this.getAutoSort()){this.sort()}},updateAfterFilter:function(){var a=this.items,f=this.keys,g=this.indices={},e=a.length,c,d,b;f.length=0;for(c=0;c<e;c++){d=a[c];b=this.getKey(d);g[b]=c;f[c]=b}this.length=a.length;this.dirtyIndices=false},sort:function(e,a){var d=this.items,h=this.keys,g=this.indices,c=d.length,b,j,f;if(e){this.addSorters(e,a);return this.items}for(b=0;b<c;b++){d[b]._current_key=h[b]}this.handleSort(d);for(b=0;b<c;b++){j=d[b];f=j._current_key;h[b]=f;g[f]=b;delete j._current_key}this.dirtyIndices=true},handleSort:function(a){this.mixins.sortable.sort.call(this,a)},add:function(j,l){var g=this,d=this.filtered,e=this.sorted,h=this.all,f=this.items,m=this.keys,k=this.indices,a=this.mixins.filterable,b=f.length,c=b;if(arguments.length==1){l=j;j=g.getKey(l)}if(typeof j!="undefined"&&j!==null){if(typeof g.map[j]!="undefined"){return g.replace(j,l)}g.map[j]=l}h.push(l);if(d&&this.getAutoFilter()&&a.isFiltered.call(g,l)){return null}g.length++;if(e&&this.getAutoSort()){c=this.findInsertionIndex(f,l)}if(c!==b){this.dirtyIndices=true;Ext.Array.splice(m,c,0,j);Ext.Array.splice(f,c,0,l)}else{k[j]=b;m.push(j);f.push(l)}return l},getKey:function(a){return a.id},replace:function(d,n){var j=this,g=j.sorted,f=j.filtered,b=j.mixins.filterable,h=j.items,o=j.keys,l=j.all,c=j.map,m=null,a=h.length,p,e,k;if(arguments.length==1){n=d;d=k=j.getKey(n)}else{k=j.getKey(n)}p=c[d];if(typeof d=="undefined"||d===null||typeof p=="undefined"){return j.add(k,n)}j.map[k]=n;if(k!==d){delete j.map[d]}if(g&&j.getAutoSort()){Ext.Array.remove(h,p);Ext.Array.remove(o,d);Ext.Array.remove(l,p);l.push(n);j.dirtyIndices=true;if(f&&j.getAutoFilter()){if(b.isFiltered.call(j,n)){if(a!==h.length){j.length--}return null}else{if(a===h.length){j.length++;m=n}}}e=this.findInsertionIndex(h,n);Ext.Array.splice(o,e,0,k);Ext.Array.splice(h,e,0,n)}else{if(f){if(j.getAutoFilter()&&b.isFiltered.call(j,n)){if(j.indexOf(p)!==-1){Ext.Array.remove(h,p);Ext.Array.remove(o,d);j.length--;j.dirtyIndices=true}return null}else{if(j.indexOf(p)===-1){h.push(n);o.push(k);j.indices[k]=j.length;j.length++;return n}}}e=j.indexOf(p);o[e]=k;h[e]=n;if(k!==d){this.dirtyIndices=true}}return m},addAll:function(h){var q=this,e=q.filtered,a=q.sorted,b=q.all,k=q.items,j=q.keys,p=q.map,l=q.getAutoFilter(),m=q.getAutoSort(),r=[],f=[],c=q.mixins.filterable,d=[],g,s,n,o;if(Ext.isObject(h)){for(s in h){if(h.hasOwnProperty(s)){f.push(k[s]);r.push(s)}}}else{f=h;g=h.length;for(n=0;n<g;n++){r.push(q.getKey(h[n]))}}for(n=0;n<g;n++){s=r[n];o=f[n];if(typeof s!="undefined"&&s!==null){if(typeof p[s]!="undefined"){q.replace(s,o);continue}p[s]=o}b.push(o);if(e&&l&&c.isFiltered.call(q,o)){continue}q.length++;j.push(s);k.push(o);d.push(o)}if(d.length){q.dirtyIndices=true;if(a&&m){q.sort()}return d}return null},each:function(e,d){var b=this.items.slice(),c=0,a=b.length,f;for(;c<a;c++){f=b[c];if(e.call(d||f,f,c,a)===false){break}}},eachKey:function(d,c){var f=this.keys,a=this.items,e=f.length,b;for(b=0;b<e;b++){d.call(c||window,f[b],a[b],b,e)}},findBy:function(e,d){var f=this.keys,b=this.items,c=0,a=b.length;for(;c<a;c++){if(e.call(d||window,b[c],f[c])){return b[c]}}return null},filterBy:function(e,d){var h=this,c=new this.self(),g=h.keys,a=h.all,f=a.length,b;c.getKey=h.getKey;for(b=0;b<f;b++){if(e.call(d||h,a[b],h.getKey(a[b]))){c.add(g[b],a[b])}}return c},insert:function(c,d,f){var e=this,a=this.sorted,g=this.map,b=this.filtered;if(arguments.length==2){f=d;d=e.getKey(f)}if(c>=e.length||(a&&e.getAutoSort())){return e.add(d,f)}if(typeof d!="undefined"&&d!==null){if(typeof g[d]!="undefined"){e.replace(d,f);return false}g[d]=f}this.all.push(f);if(b&&this.getAutoFilter()&&this.mixins.filterable.isFiltered.call(e,f)){return null}e.length++;Ext.Array.splice(e.items,c,0,f);Ext.Array.splice(e.keys,c,0,d);e.dirtyIndices=true;return f},insertAll:function(g,d){if(g>=this.items.length||(this.sorted&&this.getAutoSort())){return this.addAll(d)}var s=this,h=this.filtered,a=this.sorted,b=this.all,m=this.items,l=this.keys,r=this.map,n=this.getAutoFilter(),o=this.getAutoSort(),t=[],j=[],f=[],c=this.mixins.filterable,e=false,k,u,p,q;if(a&&this.getAutoSort()){}if(Ext.isObject(d)){for(u in d){if(d.hasOwnProperty(u)){j.push(m[u]);t.push(u)}}}else{j=d;k=d.length;for(p=0;p<k;p++){t.push(s.getKey(d[p]))}}for(p=0;p<k;p++){u=t[p];q=j[p];if(typeof u!="undefined"&&u!==null){if(typeof r[u]!="undefined"){s.replace(u,q);continue}r[u]=q}b.push(q);if(h&&n&&c.isFiltered.call(s,q)){continue}s.length++;Ext.Array.splice(m,g+p,0,q);Ext.Array.splice(l,g+p,0,u);e=true;f.push(q)}if(e){this.dirtyIndices=true;if(a&&o){this.sort()}return f}return null},remove:function(c){var a=this.items.indexOf(c);if(a===-1){Ext.Array.remove(this.all,c);if(typeof this.getKey=="function"){var b=this.getKey(c);if(b!==undefined){delete this.map[b]}}return c}return this.removeAt(this.items.indexOf(c))},removeAll:function(a){if(a){var c=a.length,b;for(b=0;b<c;b++){this.remove(a[b])}}return this},removeAt:function(b){var g=this,a=g.items,f=g.keys,d=g.all,e,c;if(b<g.length&&b>=0){e=a[b];c=f[b];if(typeof c!="undefined"){delete g.map[c]}Ext.Array.erase(a,b,1);Ext.Array.erase(f,b,1);Ext.Array.remove(d,e);delete g.indices[c];g.length--;this.dirtyIndices=true;return e}return false},removeAtKey:function(a){return this.removeAt(this.indexOfKey(a))},getCount:function(){return this.length},indexOf:function(b){if(this.dirtyIndices){this.updateIndices()}var a=b?this.indices[this.getKey(b)]:-1;return(a===undefined)?-1:a},indexOfKey:function(b){if(this.dirtyIndices){this.updateIndices()}var a=this.indices[b];return(a===undefined)?-1:a},updateIndices:function(){var a=this.items,e=a.length,f=this.indices={},c,d,b;for(c=0;c<e;c++){d=a[c];b=this.getKey(d);f[b]=c}this.dirtyIndices=false},get:function(b){var d=this,a=d.map[b],c;if(a!==undefined){c=a}else{if(typeof b=="number"){c=d.items[b]}}return typeof c!="function"||d.getAllowFunctions()?c:null},getAt:function(a){return this.items[a]},getByKey:function(a){return this.map[a]},contains:function(b){var a=this.getKey(b);if(a){return this.containsKey(a)}else{return Ext.Array.contains(this.items,b)}},containsKey:function(a){return typeof this.map[a]!="undefined"},clear:function(){var a=this;a.length=0;a.items.length=0;a.keys.length=0;a.all.length=0;a.dirtyIndices=true;a.indices={};a.map={}},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},getRange:function(f,a){var e=this,c=e.items,b=[],d;if(c.length<1){return b}f=f||0;a=Math.min(typeof a=="undefined"?e.length-1:a,e.length-1);if(f<=a){for(d=f;d<=a;d++){b[b.length]=c[d]}}else{for(d=f;d>=a;d--){b[b.length]=c[d]}}return b},findIndexBy:function(d,c,h){var g=this,f=g.keys,a=g.items,b=h||0,e=a.length;for(;b<e;b++){if(d.call(c||g,a[b],f[b])){return b}}return -1},clone:function(){var e=this,f=new this.self(),d=e.keys,a=e.items,b=0,c=a.length;for(;b<c;b++){f.add(d[b],a[b])}f.getKey=e.getKey;return f},destroy:function(){this.callSuper();this.clear()}},1,0,0,0,0,[["sortable",Ext.mixin.Sortable],["filterable",Ext.mixin.Filterable]],[Ext.util,"Collection"],0));(Ext.cmd.derive("Ext.data.Operation",Ext.Base,{config:{synchronous:true,action:null,filters:null,sorters:null,grouper:null,start:null,limit:null,batch:null,callback:null,scope:null,resultSet:null,records:null,request:null,response:null,withCredentials:null,params:null,url:null,page:null,node:null,model:undefined,addRecords:false},started:false,running:false,complete:false,success:undefined,exception:false,error:undefined,constructor:function(a){this.initConfig(a)},applyModel:function(a){if(typeof a=="string"){a=Ext.data.ModelManager.getModel(a);if(!a){Ext.Logger.error("Model with name "+arguments[0]+" doesnt exist.")}}if(a&&!a.prototype.isModel&&Ext.isObject(a)){a=Ext.data.ModelManager.registerType(a.storeId||a.id||Ext.id(),a)}return a},getRecords:function(){var a=this.getResultSet();return this._records||(a?a.getRecords():[])},setStarted:function(){this.started=true;this.running=true},setCompleted:function(){this.complete=true;this.running=false},setSuccessful:function(){this.success=true},setException:function(a){this.exception=true;this.success=false;this.running=false;this.error=a},hasException:function(){return this.exception===true},getError:function(){return this.error},isStarted:function(){return this.started===true},isRunning:function(){return this.running===true},isComplete:function(){return this.complete===true},wasSuccessful:function(){return this.isComplete()&&this.success===true},allowWrite:function(){return this.getAction()!="read"},process:function(d,b,c,a){if(b.getSuccess()!==false){this.setResponse(a);this.setResultSet(b);this.setCompleted();this.setSuccessful()}else{this.setResponse(a);this.setResultSet(b);return false}return this["process"+Ext.String.capitalize(d)].call(this,b,c,a)},processRead:function(d){var b=d.getRecords(),g=[],f=this.getModel(),e=b.length,c,a;for(c=0;c<e;c++){a=b[c];g.push(new f(a.data,a.id,a.node))}this.setRecords(g);d.setRecords(g);return true},processCreate:function(e){var c=e.getRecords(),b=this.getRecords(),f=c.length,d,a,g;for(d=0;d<f;d++){g=c[d];if(g.clientId===null&&b.length==1&&c.length==1){a=b[d]}else{a=this.findCurrentRecord(g.clientId)}if(a){this.updateRecord(a,g)}}return true},processUpdate:function(e){var c=e.getRecords(),b=this.getRecords(),f=c.length,d,a,g;for(d=0;d<f;d++){g=c[d];a=b[d];if(a){this.updateRecord(a,g)}}return true},processDestroy:function(d){var b=d.getRecords(),e=b.length,c,a,f;for(c=0;c<e;c++){f=b[c];a=this.findCurrentRecord(f.id);if(a){a.setIsErased(true);a.notifyStores("afterErase",a)}}},findCurrentRecord:function(a){var c=this.getRecords(),e=c.length,d,b;for(d=0;d<e;d++){b=c[d];if(b.getId()===a){return b}}},updateRecord:function(b,d){var a=d.data,c=d.id;b.beginEdit();b.set(a);if(c!==null){b.setId(c)}b.endEdit(true);b.commit()}},1,0,0,0,0,0,[Ext.data,"Operation"],0));(Ext.cmd.derive("Ext.data.ResultSet",Ext.Base,{config:{loaded:true,count:null,total:null,success:false,records:null,message:null},constructor:function(a){this.initConfig(a)},applyCount:function(a){if(!a&&a!==0){return this.getRecords().length}return a},updateRecords:function(a){this.setCount(a.length)}},1,0,0,0,0,0,[Ext.data,"ResultSet"],0));(Ext.cmd.derive("Ext.data.reader.Reader",Ext.Base,{alternateClassName:["Ext.data.Reader","Ext.data.DataReader"],isReader:true,config:{idProperty:undefined,clientIdProperty:"clientId",totalProperty:"total",successProperty:"success",messageProperty:null,rootProperty:"",implicitIncludes:true,model:undefined},constructor:function(a){this.initConfig(a)},fieldCount:0,applyModel:function(a){if(typeof a=="string"){a=Ext.data.ModelManager.getModel(a);if(!a){Ext.Logger.error("Model with name "+arguments[0]+" doesnt exist.")}}if(a&&!a.prototype.isModel&&Ext.isObject(a)){a=Ext.data.ModelManager.registerType(a.storeId||a.id||Ext.id(),a)}return a},applyIdProperty:function(a){if(!a&&this.getModel()){a=this.getModel().getIdProperty()}return a},updateModel:function(a){if(a){if(!this.getIdProperty()){this.setIdProperty(a.getIdProperty())}this.buildExtractors()}},createAccessor:Ext.emptyFn,createFieldAccessExpression:function(){return"undefined"},buildExtractors:function(){if(!this.getModel()){return}var b=this,c=b.getTotalProperty(),a=b.getSuccessProperty(),d=b.getMessageProperty();if(c){b.getTotal=b.createAccessor(c)}if(a){b.getSuccess=b.createAccessor(a)}if(d){b.getMessage=b.createAccessor(d)}b.extractRecordData=b.buildRecordDataExtractor()},buildRecordDataExtractor:function(){var k=this,e=k.getModel(),g=e.getFields(),j=g.length,a=[],h=k.getModel().getClientIdProperty(),f="__field",b=["var me = this,\n","    fields = me.getModel().getFields(),\n","    idProperty = me.getIdProperty(),\n",'    idPropertyIsFn = (typeof idProperty == "function"),',"    value,\n","    internalId"],d,l,c,m;g=g.items;for(d=0;d<j;d++){l=g[d];m=l.getName();if(m===e.getIdProperty()){a[d]="idField"}else{a[d]=f+d}b.push(",\n    ",a[d],' = fields.get("',l.getName(),'")')}b.push(";\n\n    return function(source) {\n        var dest = {};\n");b.push("        if (idPropertyIsFn) {\n");b.push("            idField.setMapping(idProperty);\n");b.push("        }\n");for(d=0;d<j;d++){l=g[d];c=a[d];m=l.getName();if(m===e.getIdProperty()&&l.getMapping()===null&&e.getIdProperty()!==this.getIdProperty()){l.setMapping(this.getIdProperty())}b.push("        try {\n");b.push("            value = ",k.createFieldAccessExpression(l,c,"source"),";\n");b.push("            if (value !== undefined) {\n");b.push('                dest["'+l.getName()+'"] = value;\n');b.push("            }\n");b.push("        } catch(e){}\n")}if(h){b.push("        internalId = "+k.createFieldAccessExpression(Ext.create("Ext.data.Field",{name:h}),null,"source")+";\n");b.push("        if (internalId !== undefined) {\n");b.push('            dest["_clientId"] = internalId;\n        }\n')}b.push("        return dest;\n");b.push("    };");return Ext.functionFactory(b.join("")).call(k)},getFields:function(){return this.getModel().getFields().items},getData:function(a){return a},getResponseData:function(a){return a},getRoot:function(a){return a},read:function(c){var g=c,h=this.getModel(),e,b,d,f,a;if(c){g=this.getResponseData(c)}if(g){e=this.readRecords(g);b=e.getRecords();for(d=0,f=b.length;d<f;d++){a=b[d];b[d]=new h(a.data,a.id,a.node)}return e}else{return this.nullResultSet}},process:function(a){var b=a;if(a){b=this.getResponseData(a)}if(b){return this.readRecords(b)}else{return this.nullResultSet}},readRecords:function(c){var e=this;e.rawData=c;c=e.getData(c);if(c.metaData){e.onMetaChange(c.metaData)}var d=Ext.isArray(c),g=d?c:e.getRoot(c),j=true,b=0,f,h,a,k;if(d&&Ext.isEmpty(c.length)){return e.nullResultSet}if(e.getTotal){h=parseInt(e.getTotal(c),10);if(!isNaN(h)){f=h}}if(e.getSuccess){h=e.getSuccess(c);if(h===false||h==="false"){j=false}}if(e.getMessage){k=e.getMessage(c)}if(g){a=e.extractData(g);b=a.length}else{b=0;a=[]}return new Ext.data.ResultSet({total:f,count:b,records:a,success:j,message:k})},extractData:function(l){var j=this,e=[],c=l.length,h=j.getModel(),m=h.getIdProperty(),k=h.getFields(),d,g,f,b,a;if(k.isDirty){j.buildExtractors(true);delete k.isDirty}if(!l.length&&Ext.isObject(l)){l=[l];c=1}for(g=0;g<c;g++){a=null;b=null;d=l[g];if(d.isModel){f=d.data}else{f=j.extractRecordData(d)}if(f._clientId!==undefined){a=f._clientId;delete f._clientId}if(f[m]!==undefined){b=f[m]}if(j.getImplicitIncludes()){j.readAssociated(f,d)}e.push({clientId:a,id:b,data:f,node:d})}return e},readAssociated:function(b,h){var f=this.getModel().associations.items,g=f.length,e=0,a,d,c;for(;e<g;e++){a=f[e];c=a.getAssociationKey();d=this.getAssociatedDataRoot(h,c);if(d){b[c]=d}}},getAssociatedDataRoot:function(d,a){var c=/[\[\.]/,b=String(a).search(c);if(b>=0){return Ext.functionFactory("obj","return obj"+(b>0?".":"")+a)(d)}return d[a]},onMetaChange:function(f){var a=f.fields,e=this,d,c,b;e.metaData=f;if(f.rootProperty!==undefined){e.setRootProperty(f.rootProperty)}else{if(f.root!==undefined){e.setRootProperty(f.root)}}if(f.idProperty!==undefined){e.setIdProperty(f.idProperty)}if(f.totalProperty!==undefined){e.setTotalProperty(f.totalProperty)}if(f.successProperty!==undefined){e.setSuccessProperty(f.successProperty)}if(f.messageProperty!==undefined){e.setMessageProperty(f.messageProperty)}if(a){if(e.getModel()){e.getModel().setFields(a);e.buildExtractors()}else{b=e.getIdProperty();c={fields:a};if(b){c.idProperty=b}d=Ext.define("Ext.data.reader.MetaModel"+Ext.id(),{extend:"Ext.data.Model",config:c});e.setModel(d)}}else{e.buildExtractors()}}},1,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.data.reader,"Reader",Ext.data,"Reader",Ext.data,"DataReader"],function(){Ext.apply(this.prototype,{nullResultSet:new Ext.data.ResultSet({total:0,count:0,records:[],success:false})})}));(Ext.cmd.derive("Ext.data.reader.Json",Ext.data.reader.Reader,{alternateClassName:"Ext.data.JsonReader",config:{record:null,useSimpleAccessors:false},objectRe:/[\[\.]/,getResponseData:function(a){var d=a;if(a&&a.responseText){d=a.responseText}if(typeof d!=="string"){return d}var c;try{c=Ext.decode(d)}catch(b){this.fireEvent("exception",this,a,"Unable to parse the JSON returned by the server: "+b.toString());Ext.Logger.warn("Unable to parse the JSON returned by the server: "+b.toString())}return c},buildExtractors:function(){var b=this,a=b.getRootProperty();Ext.data.reader.Reader.prototype.buildExtractors.apply(this,arguments);if(a){b.rootAccessor=b.createAccessor(a)}else{delete b.rootAccessor}},getRoot:function(b){var a=this.getModel().getFields();if(a.isDirty){this.buildExtractors(true);delete a.isDirty}if(this.rootAccessor){return this.rootAccessor.call(this,b)}else{return b}},extractData:function(a){var e=this.getRecord(),d=[],c,b;if(e){c=a.length;if(!c&&Ext.isObject(a)){c=1;a=[a]}for(b=0;b<c;b++){d[b]=a[b][e]}}else{d=a}return Ext.data.reader.Reader.prototype.extractData.call(this,d)},createAccessor:function(){var a=/[\[\.]/;return function(c){if(Ext.isEmpty(c)){return Ext.emptyFn}if(Ext.isFunction(c)){return c}if(this.getUseSimpleAccessors()!==true){var b=String(c).search(a);if(b>=0){return Ext.functionFactory("obj","var value; try {value = obj"+(b>0?".":"")+c+"} catch(e) {}; return value;")}}return function(d){return d[c]}}}(),createFieldAccessExpression:function(g,b,c){var f=this,h=f.objectRe,e=(g.getMapping()!==null),a=e?g.getMapping():g.getName(),j,d;if(typeof a==="function"){j=b+".getMapping()("+c+", this)"}else{if(f.getUseSimpleAccessors()===true||((d=String(a).search(h))<0)){if(!e||isNaN(a)){a='"'+a+'"'}j=c+"["+a+"]"}else{j=c+(d>0?".":"")+a}}return j}},0,0,0,0,["reader.json"],0,[Ext.data.reader,"Json",Ext.data,"JsonReader"],0));(Ext.cmd.derive("Ext.data.writer.Writer",Ext.Base,{alternateClassName:["Ext.data.DataWriter","Ext.data.Writer"],config:{writeAllFields:true,nameProperty:"name"},constructor:function(a){this.initConfig(a)},write:function(e){var c=e.getOperation(),b=c.getRecords()||[],a=b.length,d=0,f=[];for(;d<a;d++){f.push(this.getRecordData(b[d]))}return this.writeRecords(e,f)},writeDate:function(c,b){if(!b){return null}var a=c.getDateFormat()||"timestamp";switch(a){case"timestamp":return b.getTime()/1000;case"time":return b.getTime();default:return Ext.Date.format(b,a)}},getRecordData:function(e){var k=e.phantom===true,b=this.getWriteAllFields()||k,c=this.getNameProperty(),f=e.getFields(),d={},h,a,g,l,j;if(b){f.each(function(m){if(m.getPersist()){a=m.config[c]||m.getName();j=e.get(m.getName());if(m.getType().type=="date"){j=this.writeDate(m,j)}d[a]=j}},this)}else{h=e.getChanges();for(l in h){if(h.hasOwnProperty(l)){g=f.get(l);if(g.getPersist()){a=g.config[c]||g.getName();j=h[l];if(g.getType().type=="date"){j=this.writeDate(g,j)}d[a]=j}}}if(!k){d[e.getIdProperty()]=e.getId()}}return d}},1,0,0,0,["writer.base"],0,[Ext.data.writer,"Writer",Ext.data,"DataWriter",Ext.data,"Writer"],0));(Ext.cmd.derive("Ext.data.writer.Json",Ext.data.writer.Writer,{alternateClassName:"Ext.data.JsonWriter",config:{rootProperty:undefined,encode:false,allowSingle:true,encodeRequest:false},applyRootProperty:function(a){if(!a&&(this.getEncode()||this.getEncodeRequest())){a="data"}return a},writeRecords:function(d,e){var a=this.getRootProperty(),f=d.getParams(),b=this.getAllowSingle(),c;if(this.getAllowSingle()&&e&&e.length==1){e=e[0]}if(this.getEncodeRequest()){c=d.getJsonData()||{};if(e&&(e.length||(b&&Ext.isObject(e)))){c[a]=e}d.setJsonData(Ext.apply(c,f||{}));d.setParams(null);d.setMethod("POST");return d}if(!e||!(e.length||(b&&Ext.isObject(e)))){return d}if(this.getEncode()){if(a){f[a]=Ext.encode(e)}else{}}else{c=d.getJsonData()||{};if(a){c[a]=e}else{c=e}d.setJsonData(c)}return d}},0,0,0,0,["writer.json"],0,[Ext.data.writer,"Json",Ext.data,"JsonWriter"],0));(Ext.cmd.derive("Ext.data.Batch",Ext.Base,{config:{autoStart:false,pauseOnException:true,proxy:null},current:-1,total:0,isRunning:false,isComplete:false,hasException:false,constructor:function(a){var b=this;b.initConfig(a);b.operations=[]},add:function(a){this.total++;a.setBatch(this);this.operations.push(a)},start:function(){this.hasException=false;this.isRunning=true;this.runNextOperation()},runNextOperation:function(){this.runOperation(this.current+1)},pause:function(){this.isRunning=false},runOperation:function(d){var e=this,c=e.operations,b=c[d],a;if(b===undefined){e.isRunning=false;e.isComplete=true;e.fireEvent("complete",e,c[c.length-1])}else{e.current=d;a=function(f){var g=f.hasException();if(g){e.hasException=true;e.fireEvent("exception",e,f)}else{e.fireEvent("operationcomplete",e,f)}if(g&&e.getPauseOnException()){e.pause()}else{f.setCompleted();e.runNextOperation()}};b.setStarted();e.getProxy()[b.getAction()](b,a,e)}}},1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.data,"Batch"],0));(Ext.cmd.derive("Ext.data.proxy.Proxy",Ext.Evented,{alternateClassName:["Ext.data.DataProxy","Ext.data.Proxy"],config:{batchOrder:"create,update,destroy",batchActions:true,model:null,reader:{type:"json"},writer:{type:"json"}},isProxy:true,applyModel:function(a){if(typeof a=="string"){a=Ext.data.ModelManager.getModel(a);if(!a){Ext.Logger.error("Model with name "+arguments[0]+" doesnt exist.")}}if(a&&!a.prototype.isModel&&Ext.isObject(a)){a=Ext.data.ModelManager.registerType(a.storeId||a.id||Ext.id(),a)}return a},updateModel:function(b){if(b){var a=this.getReader();if(a&&!a.getModel()){a.setModel(b)}}},applyReader:function(b,a){return Ext.factory(b,Ext.data.Reader,a,"reader")},updateReader:function(a){if(a){var b=this.getModel();if(!b){b=a.getModel();if(b){this.setModel(b)}}else{a.setModel(b)}if(a.onMetaChange){a.onMetaChange=Ext.Function.createSequence(a.onMetaChange,this.onMetaChange,this)}}},onMetaChange:function(b){var a=this.getReader().getModel();if(!this.getModel()&&a){this.setModel(a)}this.fireEvent("metachange",this,b)},applyWriter:function(b,a){return Ext.factory(b,Ext.data.Writer,a,"writer")},create:Ext.emptyFn,read:Ext.emptyFn,update:Ext.emptyFn,destroy:Ext.emptyFn,onDestroy:function(){Ext.destroy(this.getReader(),this.getWriter());Ext.Evented.prototype.destroy.apply(this,arguments)},batch:function(e,f){var g=this,d=g.getBatchActions(),c=g.getModel(),b,a;if(e.operations===undefined){e={operations:e,listeners:f}}if(e.batch&&e.batch.isBatch){b=e.batch}else{b=new Ext.data.Batch(e.batch||{})}b.setProxy(g);b.on("complete",Ext.bind(g.onBatchComplete,g,[e],0));if(e.listeners){b.on(e.listeners)}Ext.each(g.getBatchOrder().split(","),function(h){a=e.operations[h];if(a){if(d){b.add(new Ext.data.Operation({action:h,records:a,model:c}))}else{Ext.each(a,function(j){b.add(new Ext.data.Operation({action:h,records:[j],model:c}))})}}},g);b.start();return b},onBatchComplete:function(a,b){var c=a.scope||this;if(b.hasException){if(Ext.isFunction(a.failure)){Ext.callback(a.failure,c,[b,a])}}else{if(Ext.isFunction(a.success)){Ext.callback(a.success,c,[b,a])}}if(Ext.isFunction(a.callback)){Ext.callback(a.callback,c,[b,a])}Ext.destroy(b)}},0,0,0,0,["proxy.proxy"],0,[Ext.data.proxy,"Proxy",Ext.data,"DataProxy",Ext.data,"Proxy"],function(){}));(Ext.cmd.derive("Ext.data.proxy.Client",Ext.data.proxy.Proxy,{alternateClassName:"Ext.proxy.ClientProxy",clear:function(){}},0,0,0,0,0,0,[Ext.data.proxy,"Client",Ext.proxy,"ClientProxy"],0));(Ext.cmd.derive("Ext.data.proxy.Memory",Ext.data.proxy.Client,{alternateClassName:"Ext.data.MemoryProxy",isMemoryProxy:true,config:{data:[]},finishOperation:function(b,f,d){if(b){var c=0,e=b.getRecords(),a=e.length;for(c;c<a;c++){e[c].commit()}b.setCompleted();b.setSuccessful();Ext.callback(f,d||this,[b])}},create:function(){this.finishOperation.apply(this,arguments)},update:function(){this.finishOperation.apply(this,arguments)},destroy:function(){this.finishOperation.apply(this,arguments)},read:function(b,e,c){var d=this,a=d.getReader();if(b.process("read",a.process(d.getData()))===false){this.fireEvent("exception",this,null,b)}Ext.callback(e,c||d,[b])},clear:Ext.emptyFn},0,0,0,0,["proxy.memory"],0,[Ext.data.proxy,"Memory",Ext.data,"MemoryProxy"],0));(Ext.cmd.derive("Ext.data.SortTypes",Ext.Base,{singleton:true,stripTagsRE:/<\/?[^>]+>/gi,none:function(a){return a},asText:function(a){return String(a).replace(this.stripTagsRE,"")},asUCText:function(a){return String(a).toUpperCase().replace(this.stripTagsRE,"")},asUCString:function(a){return String(a).toUpperCase()},asDate:function(a){if(!a){return 0}if(Ext.isDate(a)){return a.getTime()}return Date.parse(String(a))},asFloat:function(a){a=parseFloat(String(a).replace(/,/g,""));return isNaN(a)?0:a},asInt:function(a){a=parseInt(String(a).replace(/,/g,""),10);return isNaN(a)?0:a}},0,0,0,0,0,0,[Ext.data,"SortTypes"],0));(Ext.cmd.derive("Ext.data.Types",Ext.Base,{singleton:true,stripRe:/[\$,%]/g,dashesRe:/-/g,iso8601TestRe:/\d\dT\d\d/,iso8601SplitRe:/[- :T\.Z\+]/},0,0,0,0,0,0,[Ext.data,"Types"],function(){var b=this,a=Ext.data.SortTypes;Ext.apply(b,{AUTO:{convert:function(c){return c},sortType:a.none,type:"auto"},STRING:{convert:function(c){return(c===undefined||c===null)?(this.getAllowNull()?null:""):String(c)},sortType:a.asUCString,type:"string"},INT:{convert:function(c){return(c!==undefined&&c!==null&&c!=="")?((typeof c==="number")?parseInt(c,10):parseInt(String(c).replace(b.stripRe,""),10)):(this.getAllowNull()?null:0)},sortType:a.none,type:"int"},FLOAT:{convert:function(c){return(c!==undefined&&c!==null&&c!=="")?((typeof c==="number")?c:parseFloat(String(c).replace(b.stripRe,""),10)):(this.getAllowNull()?null:0)},sortType:a.none,type:"float"},BOOL:{convert:function(c){if((c===undefined||c===null||c==="")&&this.getAllowNull()){return null}return c!=="false"&&c!=="0"&&!!c},sortType:a.none,type:"bool"},DATE:{convert:function(e){var c=this.getDateFormat(),d;if(!e){return null}if(Ext.isDate(e)){return e}if(c){if(c=="timestamp"){return new Date(e*1000)}if(c=="time"){return new Date(parseInt(e,10))}return Ext.Date.parse(e,c)}d=new Date(Date.parse(e));if(isNaN(d)){if(b.iso8601TestRe.test(e)){d=e.split(b.iso8601SplitRe);d=new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5])}if(isNaN(d)){d=new Date(Date.parse(e.replace(b.dashesRe,"/")))}}return isNaN(d)?null:d},sortType:a.asDate,type:"date"}});Ext.apply(b,{BOOLEAN:this.BOOL,INTEGER:this.INT,NUMBER:this.FLOAT})}));(Ext.cmd.derive("Ext.data.Field",Ext.Base,{isField:true,config:{name:null,type:"auto",convert:undefined,dateFormat:null,allowNull:true,defaultValue:undefined,mapping:null,sortType:undefined,sortDir:"ASC",allowBlank:true,persist:true,encode:null,decode:null,bubbleEvents:"action"},constructor:function(a){if(Ext.isString(a)){a={name:a}}this.initConfig(a)},applyType:function(c){var b=Ext.data.Types,a=b.AUTO;if(c){if(Ext.isString(c)){return b[c.toUpperCase()]||a}else{return c}}return a},updateType:function(a,b){var c=this.getConvert();if(b&&c===b.convert){this.setConvert(a.convert)}},applySortType:function(d){var c=Ext.data.SortTypes,a=this.getType(),b=a.sortType;if(d){if(Ext.isString(d)){return c[d]||b}else{return d}}return b},applyConvert:function(b){var a=this.getType().convert;if(b&&b!==a){this._hasCustomConvert=true;return b}else{this._hasCustomConvert=false;return a}},hasCustomConvert:function(){return this._hasCustomConvert}},1,0,0,0,["data.field"],0,[Ext.data,"Field"],0));(Ext.cmd.derive("Ext.data.identifier.Simple",Ext.Base,{statics:{AUTO_ID:1},config:{prefix:"ext-record-"},constructor:function(a){this.initConfig(a)},generate:function(a){return this._prefix+this.self.AUTO_ID++}},1,0,0,0,["data.identifier.simple"],0,[Ext.data.identifier,"Simple"],0));(Ext.cmd.derive("Ext.data.ModelManager",Ext.AbstractManager,{alternateClassName:["Ext.ModelMgr","Ext.ModelManager"],singleton:true,modelNamespace:null,registerType:function(c,b){var d=b.prototype,a;if(d&&d.isModel){a=b}else{b={extend:b.extend||"Ext.data.Model",config:b};a=Ext.define(c,b)}this.types[c]=a;return a},onModelDefined:Ext.emptyFn,getModel:function(b){var a=b;if(typeof a=="string"){a=this.types[a];if(!a&&this.modelNamespace){a=this.types[this.modelNamespace+"."+a]}}return a},create:function(c,b,d){var a=typeof b=="function"?b:this.types[b||c.name];return new a(c,d)}},0,0,0,0,0,0,[Ext.data,"ModelManager",Ext,"ModelMgr",Ext,"ModelManager"],function(){Ext.regModel=function(){return this.ModelManager.registerType.apply(this.ModelManager,arguments)}}));(Ext.cmd.derive("Ext.data.Request",Ext.Base,{config:{action:null,params:null,method:"GET",url:null,operation:null,proxy:null,disableCaching:false,headers:{},callbackKey:null,jsonP:null,jsonData:null,xmlData:null,withCredentials:null,username:null,password:null,callback:null,scope:null,timeout:30000,records:null,directFn:null,args:null,useDefaultXhrHeader:null},constructor:function(a){this.initConfig(a)}},1,0,0,0,0,0,[Ext.data,"Request"],0));(Ext.cmd.derive("Ext.data.proxy.Server",Ext.data.proxy.Proxy,{alternateClassName:"Ext.data.ServerProxy",config:{url:null,pageParam:"page",startParam:"start",limitParam:"limit",groupParam:"group",sortParam:"sort",filterParam:"filter",directionParam:"dir",enablePagingParams:true,simpleSortMode:false,noCache:true,cacheString:"_dc",timeout:30000,api:{create:undefined,read:undefined,update:undefined,destroy:undefined},extraParams:{}},constructor:function(a){a=a||{};if(a.nocache!==undefined){a.noCache=a.nocache}Ext.data.proxy.Proxy.prototype.constructor.call(this,a)},create:function(){return this.doRequest.apply(this,arguments)},read:function(){return this.doRequest.apply(this,arguments)},update:function(){return this.doRequest.apply(this,arguments)},destroy:function(){return this.doRequest.apply(this,arguments)},setExtraParam:function(a,b){this.getExtraParams()[a]=b},buildRequest:function(a){var c=this,d=Ext.applyIf(a.getParams()||{},c.getExtraParams()||{}),b;d=Ext.applyIf(d,c.getParams(a));b=Ext.create("Ext.data.Request",{params:d,action:a.getAction(),records:a.getRecords(),url:a.getUrl(),operation:a,proxy:c});b.setUrl(c.buildUrl(b));a.setRequest(b);return b},processResponse:function(l,b,d,c,k,m){var h=this,a=b.getAction(),f,j;if(l===true){f=h.getReader();try{j=f.process(h.getResponseResult(c))}catch(g){b.setException(g.message);h.fireEvent("exception",h,c,b);return}if(!b.getModel()){b.setModel(this.getModel())}if(b.process(a,j,d,c)===false){h.setException(b,c);h.fireEvent("exception",h,c,b)}}else{h.setException(b,c);h.fireEvent("exception",this,c,b)}if(typeof k=="function"){k.call(m||h,b)}h.afterRequest(d,l)},getResponseResult:function(a){return a},setException:function(b,a){if(Ext.isObject(a)){b.setException({status:a.status,statusText:a.statusText})}},applyEncoding:function(a){return Ext.encode(a)},encodeSorters:function(d){var b=[],c=d.length,a=0;for(;a<c;a++){b[a]={property:d[a].getProperty(),direction:d[a].getDirection()}}return this.applyEncoding(b)},encodeFilters:function(d){var b=[],c=d.length,a=0;for(;a<c;a++){b[a]={property:d[a].getProperty(),value:d[a].getValue()}}return this.applyEncoding(b)},getParams:function(j){var o=this,h={},a=j.getGrouper(),n=j.getSorters(),f=j.getFilters(),m=j.getPage(),d=j.getStart(),g=j.getLimit(),p=o.getSimpleSortMode(),r=o.getPageParam(),l=o.getStartParam(),q=o.getLimitParam(),k=o.getGroupParam(),e=o.getSortParam(),c=o.getFilterParam(),b=o.getDirectionParam();if(o.getEnablePagingParams()){if(r&&m!==null){h[r]=m}if(l&&d!==null){h[l]=d}if(q&&g!==null){h[q]=g}}if(k&&a){h[k]=o.encodeSorters([a])}if(e&&n&&n.length>0){if(p){h[e]=n[0].getProperty();h[b]=n[0].getDirection()}else{h[e]=o.encodeSorters(n)}}if(c&&f&&f.length>0){h[c]=o.encodeFilters(f)}return h},buildUrl:function(c){var b=this,a=b.getUrl(c);if(b.getNoCache()){a=Ext.urlAppend(a,Ext.String.format("{0}={1}",b.getCacheString(),Ext.Date.now()))}return a},getUrl:function(a){return a?a.getUrl()||this.getApi()[a.getAction()]||this._url:this._url},doRequest:function(){},afterRequest:Ext.emptyFn},1,0,0,0,["proxy.server"],0,[Ext.data.proxy,"Server",Ext.data,"ServerProxy"],0));(Ext.cmd.derive("Ext.data.proxy.Ajax",Ext.data.proxy.Server,{alternateClassName:["Ext.data.HttpProxy","Ext.data.AjaxProxy"],config:{withCredentials:false,useDefaultXhrHeader:true,username:null,password:null,actionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"},headers:{}},doRequest:function(a,f,b){var d=this,e=d.getWriter(),c=d.buildRequest(a);c.setConfig({headers:d.getHeaders(),timeout:d.getTimeout(),method:d.getMethod(c),callback:d.createRequestCallback(c,a,f,b),scope:d,proxy:d,useDefaultXhrHeader:d.getUseDefaultXhrHeader()});if(a.getWithCredentials()||d.getWithCredentials()){c.setWithCredentials(true);c.setUsername(d.getUsername());c.setPassword(d.getPassword())}c=e.write(c);Ext.Ajax.request(c.getCurrentConfig());return c},getMethod:function(a){return this.getActionMethods()[a.getAction()]},createRequestCallback:function(d,a,e,b){var c=this;return function(g,h,f){c.processResponse(h,a,d,f,e,b)}}},0,0,0,0,["proxy.ajax"],0,[Ext.data.proxy,"Ajax",Ext.data,"HttpProxy",Ext.data,"AjaxProxy"],0));(Ext.cmd.derive("Ext.data.association.Association",Ext.Base,{alternateClassName:"Ext.data.Association",config:{ownerModel:null,ownerName:undefined,associatedModel:null,associatedName:undefined,associationKey:undefined,primaryKey:"id",reader:null,type:null,name:undefined},statics:{create:function(a){if(!a.isAssociation){if(Ext.isString(a)){a={type:a}}a.type=a.type.toLowerCase();return Ext.factory(a,Ext.data.association.Association,null,"association")}return a}},constructor:function(a){this.initConfig(a)},applyName:function(a){if(!a){a=this.getAssociatedName()}return a},applyOwnerModel:function(a){var b=Ext.data.ModelManager.getModel(a);if(b===undefined){Ext.Logger.error("The configured ownerModel was not valid (you tried "+a+")")}return b},applyOwnerName:function(a){if(!a){a=this.getOwnerModel().modelName}a=a.slice(a.lastIndexOf(".")+1);return a},updateOwnerModel:function(a,b){if(b){this.setOwnerName(a.modelName)}},applyAssociatedModel:function(a){var b=Ext.data.ModelManager.types[a];if(b===undefined){Ext.Logger.error("The configured associatedModel was not valid (you tried "+a+")")}return b},applyAssociatedName:function(a){if(!a){a=this.getAssociatedModel().modelName}a=a.slice(a.lastIndexOf(".")+1);return a},updateAssociatedModel:function(b,a){if(a){this.setAssociatedName(b.modelName)}},applyReader:function(a){if(a){if(Ext.isString(a)){a={type:a}}if(!a.isReader){Ext.applyIf(a,{type:"json"})}}return Ext.factory(a,Ext.data.Reader,this.getReader(),"reader")},updateReader:function(a){a.setModel(this.getAssociatedModel())}},1,0,0,0,0,0,[Ext.data.association,"Association",Ext.data,"Association"],0));(Ext.cmd.derive("Ext.util.Inflector",Ext.Base,{singleton:true,plurals:[[(/(quiz)$/i),"$1zes"],[(/^(ox)$/i),"$1en"],[(/([m|l])ouse$/i),"$1ice"],[(/(matr|vert|ind)ix|ex$/i),"$1ices"],[(/(x|ch|ss|sh)$/i),"$1es"],[(/([^aeiouy]|qu)y$/i),"$1ies"],[(/(hive)$/i),"$1s"],[(/(?:([^f])fe|([lr])f)$/i),"$1$2ves"],[(/sis$/i),"ses"],[(/([ti])um$/i),"$1a"],[(/(buffal|tomat|potat)o$/i),"$1oes"],[(/(bu)s$/i),"$1ses"],[(/(alias|status|sex)$/i),"$1es"],[(/(octop|vir)us$/i),"$1i"],[(/(ax|test)is$/i),"$1es"],[(/^person$/),"people"],[(/^man$/),"men"],[(/^(child)$/),"$1ren"],[(/s$/i),"s"],[(/$/),"s"]],singulars:[[(/(quiz)zes$/i),"$1"],[(/(matr)ices$/i),"$1ix"],[(/(vert|ind)ices$/i),"$1ex"],[(/^(ox)en/i),"$1"],[(/(alias|status)es$/i),"$1"],[(/(octop|vir)i$/i),"$1us"],[(/(cris|ax|test)es$/i),"$1is"],[(/(shoe)s$/i),"$1"],[(/(o)es$/i),"$1"],[(/(bus)es$/i),"$1"],[(/([m|l])ice$/i),"$1ouse"],[(/(x|ch|ss|sh)es$/i),"$1"],[(/(m)ovies$/i),"$1ovie"],[(/(s)eries$/i),"$1eries"],[(/([^aeiouy]|qu)ies$/i),"$1y"],[(/([lr])ves$/i),"$1f"],[(/(tive)s$/i),"$1"],[(/(hive)s$/i),"$1"],[(/([^f])ves$/i),"$1fe"],[(/(^analy)ses$/i),"$1sis"],[(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i),"$1$2sis"],[(/([ti])a$/i),"$1um"],[(/(n)ews$/i),"$1ews"],[(/people$/i),"person"],[(/s$/i),""]],uncountable:["sheep","fish","series","species","money","rice","information","equipment","grass","mud","offspring","deer","means"],singular:function(b,a){this.singulars.unshift([b,a])},plural:function(b,a){this.plurals.unshift([b,a])},clearSingulars:function(){this.singulars=[]},clearPlurals:function(){this.plurals=[]},isTransnumeral:function(a){return Ext.Array.indexOf(this.uncountable,a)!=-1},pluralize:function(f){if(this.isTransnumeral(f)){return f}var e=this.plurals,d=e.length,a,c,b;for(b=0;b<d;b++){a=e[b];c=a[0];if(c==f||(c.test&&c.test(f))){return f.replace(c,a[1])}}return f},singularize:function(f){if(this.isTransnumeral(f)){return f}var e=this.singulars,d=e.length,a,c,b;for(b=0;b<d;b++){a=e[b];c=a[0];if(c==f||(c.test&&c.test(f))){return f.replace(c,a[1])}}return f},classify:function(a){return Ext.String.capitalize(this.singularize(a))},ordinalize:function(d){var b=parseInt(d,10),c=b%10,a=b%100;if(11<=a&&a<=13){return d+"th"}else{switch(c){case 1:return d+"st";case 2:return d+"nd";case 3:return d+"rd";default:return d+"th"}}}},0,0,0,0,0,0,[Ext.util,"Inflector"],function(){var b={alumnus:"alumni",cactus:"cacti",focus:"foci",nucleus:"nuclei",radius:"radii",stimulus:"stimuli",ellipsis:"ellipses",paralysis:"paralyses",oasis:"oases",appendix:"appendices",index:"indexes",beau:"beaux",bureau:"bureaux",tableau:"tableaux",woman:"women",child:"children",man:"men",corpus:"corpora",criterion:"criteria",curriculum:"curricula",genus:"genera",memorandum:"memoranda",phenomenon:"phenomena",foot:"feet",goose:"geese",tooth:"teeth",antenna:"antennae",formula:"formulae",nebula:"nebulae",vertebra:"vertebrae",vita:"vitae"},a;for(a in b){this.plural(a,b[a]);this.singular(b[a],a)}}));(Ext.cmd.derive("Ext.data.association.HasMany",Ext.data.association.Association,{alternateClassName:"Ext.data.HasManyAssociation",config:{foreignKey:undefined,store:undefined,storeName:undefined,filterProperty:null,autoLoad:false,autoSync:false},constructor:function(a){a=a||{};if(a.storeConfig){a.store=a.storeConfig;delete a.storeConfig}Ext.data.association.Association.prototype.constructor.call(this,a)},applyName:function(a){if(!a){a=Ext.util.Inflector.pluralize(this.getAssociatedName().toLowerCase())}return a},applyStoreName:function(a){if(!a){a=this.getName()+"Store"}return a},applyForeignKey:function(b){if(!b){var a=this.getInverseAssociation();if(a){b=a.getForeignKey()}else{b=this.getOwnerName().toLowerCase()+"_id"}}return b},applyAssociationKey:function(a){if(!a){var b=this.getAssociatedName();a=Ext.util.Inflector.pluralize(b[0].toLowerCase()+b.slice(1))}return a},updateForeignKey:function(b,d){var a=this.getAssociatedModel().getFields(),c=a.get(b);if(!c){c=new Ext.data.Field({name:b});a.add(c);a.isDirty=true}if(d){c=a.get(d);if(c){a.remove(c);a.isDirty=true}}},applyStore:function(b){var e=this,j=e.getAssociatedModel(),f=e.getStoreName(),d=e.getForeignKey(),h=e.getPrimaryKey(),g=e.getFilterProperty(),c=e.getAutoLoad(),a=e.getAutoSync();return function(){var l=this,n,p,m,k={},o={addrecords:e.onAddRecords,removerecords:e.onRemoveRecords,scope:e};if(l[f]===undefined){if(g){p={property:g,value:l.get(g),exactMatch:true}}else{p={property:d,value:l.get(h),exactMatch:true}}k[d]=l.get(h);n=Ext.apply({},b,{model:j,filters:[p],remoteFilter:true,autoSync:a,modelDefaults:k});m=l[f]=Ext.create("Ext.data.Store",n);m.boundTo=l;m.onAfter(o);if(c){l[f].load()}}return l[f]}},onAddRecords:function(c,b){var e=b.length,f=c.boundTo.getId(),d,a;for(d=0;d<e;d++){a=b[d];a.set(this.getForeignKey(),f)}this.updateInverseInstances(c.boundTo)},onRemoveRecords:function(c,b){var e=b.length,d,a;for(d=0;d<e;d++){a=b[d];a.set(this.getForeignKey(),null)}},updateStore:function(a){this.getOwnerModel().prototype[this.getName()]=a},read:function(b,a,e){var d=b[this.getName()](),c=a.read(e).getRecords();d.add(c)},updateInverseInstances:function(b){var c=b[this.getName()](),a=this.getInverseAssociation();if(a){c.each(function(d){d[a.getInstanceName()]=b})}},getInverseAssociation:function(){var a=this.getOwnerModel().modelName;return this.getAssociatedModel().associations.findBy(function(b){return b.getType().toLowerCase()==="belongsto"&&b.getAssociatedModel().modelName===a})}},1,0,0,0,["association.hasmany"],0,[Ext.data.association,"HasMany",Ext.data,"HasManyAssociation"],0));(Ext.cmd.derive("Ext.data.association.BelongsTo",Ext.data.association.Association,{alternateClassName:"Ext.data.BelongsToAssociation",config:{foreignKey:undefined,getterName:undefined,setterName:undefined,instanceName:undefined},applyForeignKey:function(a){if(!a){a=this.getAssociatedName().toLowerCase()+"_id"}return a},updateForeignKey:function(b,d){var a=this.getOwnerModel().getFields(),c=a.get(b);if(!c){c=new Ext.data.Field({name:b});a.add(c);a.isDirty=true}if(d){c=a.get(d);if(c){a.isDirty=true;a.remove(c)}}},applyInstanceName:function(a){if(!a){a=this.getAssociatedName()+"BelongsToInstance"}return a},applyAssociationKey:function(a){if(!a){var b=this.getAssociatedName();a=b[0].toLowerCase()+b.slice(1)}return a},applyGetterName:function(a){if(!a){var b=this.getAssociatedName();a="get"+b[0].toUpperCase()+b.slice(1)}return a},applySetterName:function(a){if(!a){var b=this.getAssociatedName();a="set"+b[0].toUpperCase()+b.slice(1)}return a},updateGetterName:function(b,c){var a=this.getOwnerModel().prototype;if(c){delete a[c]}if(b){a[b]=this.createGetter()}},updateSetterName:function(b,c){var a=this.getOwnerModel().prototype;if(c){delete a[c]}if(b){a[b]=this.createSetter()}},createSetter:function(){var d=this,c=d.getForeignKey(),f=d.getAssociatedModel(),e,a,b;return function(l,j,k){var h=d.getInverseAssociation(),g=this;if(l&&l.isModel){l=l.getId()}if(Ext.isFunction(j)){j={callback:j,scope:k||g}}delete g[d.getInstanceName()];e=Ext.data.Model.cache[Ext.data.Model.generateCacheId(f.modelName,this.get(c))];a=Ext.data.Model.cache[Ext.data.Model.generateCacheId(f.modelName,l)];g.set(c,l);if(h){if(a){if(h.getType().toLowerCase()==="hasmany"){b=a[h.getName()]();b.add(g)}else{a[h.getInstanceName()]=g}}if(e){if(h.getType().toLowerCase()==="hasmany"){b=e[h.getName()]();b.remove(g)}else{delete l[h.getInstanceName()]}}}if(a){g[d.getInstanceName()]=a}if(Ext.isObject(j)){return g.save(j)}return g}},createGetter:function(){var c=this,d=c.getAssociatedModel(),b=c.getForeignKey(),a=c.getInstanceName();return function(h,j){h=h||{};var g=this,k=g.get(b),l,e,f;e=g[a];if(!e){e=Ext.data.Model.cache[Ext.data.Model.generateCacheId(d.modelName,k)];if(e){g[a]=e}}if(h.reload===true||e===undefined){if(typeof h=="function"){h={callback:h,scope:j||g}}l=h.success;h.success=function(m){g[a]=m;if(l){l.apply(this,arguments)}};d.load(k,h)}else{f=[e];j=j||g;Ext.callback(h,j,f);Ext.callback(h.success,j,f);Ext.callback(h.failure,j,f);Ext.callback(h.callback,j,f);return e}}},read:function(b,a,c){b[this.getInstanceName()]=a.read([c]).getRecords()[0]},getInverseAssociation:function(){var b=this.getOwnerModel().modelName,a=this.getForeignKey();return this.getAssociatedModel().associations.findBy(function(d){var c=d.getType().toLowerCase();return(c==="hasmany"||c==="hasone")&&d.getAssociatedModel().modelName===b&&d.getForeignKey()===a})}},0,0,0,0,["association.belongsto"],0,[Ext.data.association,"BelongsTo",Ext.data,"BelongsToAssociation"],0));(Ext.cmd.derive("Ext.data.association.HasOne",Ext.data.association.Association,{alternateClassName:"Ext.data.HasOneAssociation",config:{foreignKey:undefined,getterName:undefined,setterName:undefined,instanceName:undefined},applyForeignKey:function(b){if(!b){var a=this.getInverseAssociation();if(a){b=a.getForeignKey()}else{b=this.getAssociatedName().toLowerCase()+"_id"}}return b},updateForeignKey:function(b,d){var a=this.getOwnerModel().getFields(),c=a.get(b);if(!c){c=new Ext.data.Field({name:b});a.add(c);a.isDirty=true}if(d){c=a.get(d);if(c){a.remove(c);a.isDirty=true}}},applyInstanceName:function(a){if(!a){a=this.getAssociatedName()+"HasOneInstance"}return a},applyAssociationKey:function(a){if(!a){var b=this.getAssociatedName();a=b[0].toLowerCase()+b.slice(1)}return a},applyGetterName:function(a){if(!a){var b=this.getAssociatedName();a="get"+b[0].toUpperCase()+b.slice(1)}return a},applySetterName:function(a){if(!a){var b=this.getAssociatedName();a="set"+b[0].toUpperCase()+b.slice(1)}return a},updateGetterName:function(b,c){var a=this.getOwnerModel().prototype;if(c){delete a[c]}if(b){a[b]=this.createGetter()}},updateSetterName:function(b,c){var a=this.getOwnerModel().prototype;if(c){delete a[c]}if(b){a[b]=this.createSetter()}},createSetter:function(){var c=this,b=c.getForeignKey(),a=c.getInstanceName(),d=c.getAssociatedModel();return function(h,f,g){var j=Ext.data.Model,e;if(h&&h.isModel){h=h.getId()}this.set(b,h);if(h||h===0){e=j.cache[j.generateCacheId(d.modelName,h)];if(e){this[a]=e}}else{delete this[a]}if(Ext.isFunction(f)){f={callback:f,scope:g||this}}if(Ext.isObject(f)){return this.save(f)}return this}},createGetter:function(){var c=this,d=c.getAssociatedModel(),b=c.getForeignKey(),a=c.getInstanceName();return function(h,j){h=h||{};var g=this,k=g.get(b),l,e,f;if(h.reload===true||g[a]===undefined){if(typeof h=="function"){h={callback:h,scope:j||g}}l=h.success;h.success=function(m){g[a]=m;if(l){l.apply(this,arguments)}};d.load(k,h)}else{e=g[a];f=[e];j=j||g;Ext.callback(h,j,f);Ext.callback(h.success,j,f);Ext.callback(h.failure,j,f);Ext.callback(h.callback,j,f);return e}}},read:function(c,a,e){var b=this.getInverseAssociation(),d=a.read([e]).getRecords()[0];c[this.getSetterName()].call(c,d);if(b){d[b.getInstanceName()]=c}},getInverseAssociation:function(){var a=this.getOwnerModel().modelName;return this.getAssociatedModel().associations.findBy(function(b){return b.getType().toLowerCase()==="belongsto"&&b.getAssociatedModel().modelName===a})}},0,0,0,0,["association.hasone"],0,[Ext.data.association,"HasOne",Ext.data,"HasOneAssociation"],0));(Ext.cmd.derive("Ext.data.Error",Ext.Base,{config:{field:null,message:""},constructor:function(a){this.initConfig(a)}},1,0,0,0,0,0,[Ext.data,"Error"],0));(Ext.cmd.derive("Ext.data.Errors",Ext.util.Collection,{isValid:function(){return this.length===0},getByField:function(d){var c=[],a,b;for(b=0;b<this.length;b++){a=this.items[b];if(a.getField()==d){c.push(a)}}return c},add:function(){var a=arguments.length==1?arguments[0]:arguments[1];if(!(a instanceof Ext.data.Error)){a=Ext.create("Ext.data.Error",{field:a.field||a.name,message:a.error||a.message})}return Ext.util.Collection.prototype.add.call(this,a)}},0,0,0,0,0,0,[Ext.data,"Errors"],0));(Ext.cmd.derive("Ext.data.Model",Ext.Base,{alternateClassName:"Ext.data.Record",isModel:true,config:{idProperty:"id",data:null,fields:undefined,validations:null,associations:null,hasMany:null,hasOne:null,belongsTo:null,proxy:null,identifier:{type:"simple"},clientIdProperty:"clientId",isErased:false,useCache:true},staticConfigs:["idProperty","fields","validations","associations","hasMany","hasOne","belongsTo","clientIdProperty","identifier","useCache","proxy"],statics:{EDIT:"edit",REJECT:"reject",COMMIT:"commit",cache:{},generateProxyMethod:function(a){return function(){var b=this.prototype;return b[a].apply(b,arguments)}},generateCacheId:function(b,c){var a;if(b&&b.isModel){a=b.modelName;if(c===undefined){c=b.getId()}}else{a=b}return a.replace(/\./g,"-").toLowerCase()+"-"+c}},inheritableStatics:{load:function(a,b,h){var f=this.getProxy(),j=this.getIdProperty(),e=null,d={},g,c;h=h||(b&&b.scope)||this;if(Ext.isFunction(b)){b={callback:b,scope:h}}d[j]=a;b=Ext.apply({},b);b=Ext.applyIf(b,{action:"read",params:d,model:this});c=Ext.create("Ext.data.Operation",b);if(!f){Ext.Logger.error("You are trying to load a model that doesn't have a Proxy specified")}g=function(k){if(k.wasSuccessful()){e=k.getRecords()[0]||null;Ext.callback(b.success,h,[e,k])}else{Ext.callback(b.failure,h,[e,k])}Ext.callback(b.callback,h,[e,k])};f.read(c,g,this)}},editing:false,dirty:false,phantom:false,constructor:function(f,h,c,g){var e=this,d=null,a=e.getUseCache(),b=e.getIdProperty();f=f||g||{};if(h||h===0){f[b]=e.internalId=h}h=f[b];if(a&&(h||h===0)){d=Ext.data.Model.cache[Ext.data.Model.generateCacheId(this,h)];if(d){d.raw=c||d.raw;return d.mergeData(g||f||{})}}e.modified={};e.raw=c||f||{};e.stores=[];if(g){e.setConvertedData(f)}else{e.setData(f)}e.id=e.getIdentifier().generate(e);h=e.data[b];if(!h&&h!==0){e.data[b]=e.internalId=e.id;e.phantom=true;if(this.associations.length){this.handleInlineAssociationData(f)}}else{this.internalId=h}if(a){Ext.data.Model.cache[Ext.data.Model.generateCacheId(e)]=e}if(this.init&&typeof this.init=="function"){this.init()}},mergeData:function(a){var h=this,f=h.getFields().items,g=f.length,l=h.modified,c=[],d=h.data,e,j,m,k,b;for(e=0;e<g;e++){j=f[e];m=j._name;k=a[m];if(k!==undefined&&!l.hasOwnProperty(m)){if(j._convert){k=j._convert(k,h)}if(d[m]!==k){if(c.length===0&&!h.editing){this.beginEdit()}c.push(m)}d[m]=k}else{if(Ext.isFunction(j._convert)){k=j._convert(k,h);d[m]=k}}}if(h.associations.length){h.handleInlineAssociationData(a)}if(c.length>0&&h.editing){this.endEdit(false,c)}return this},setData:function(a){var k=this,g=k.fields.items,h=g.length,f=Ext.isArray(a),d=k._data=k.data={},e,l,b,m,j,c;if(!a){return k}for(e=0;e<h;e++){l=g[e];b=l._name;j=l._convert;if(f){m=a[e]}else{m=a[b];if(typeof m=="undefined"){m=l._defaultValue}}if(j){m=l._convert(m,k)}d[b]=m}c=k.getId();if(k.associations.length&&(c||c===0)){k.handleInlineAssociationData(a)}return k},handleInlineAssociationData:function(e){var d=this.associations.items,h=d.length,f,c,b,g,j,a;e=Ext.apply({},e,this.raw);for(f=0;f<h;f++){c=d[f];a=c.getAssociationKey();b=e[a];if(b){g=c.getReader();if(!g){j=c.getAssociatedModel().getProxy();if(j){g=j.getReader()}else{g=new Ext.data.JsonReader({model:c.getAssociatedModel()})}}c.read(this,g,b)}}},setId:function(b){var a=this.getId();this.set(this.getIdProperty(),b);this.internalId=b;if(this.getUseCache()){delete Ext.data.Model.cache[Ext.data.Model.generateCacheId(this,a)];Ext.data.Model.cache[Ext.data.Model.generateCacheId(this)]=this}},getId:function(){return this.get(this.getIdProperty())},setConvertedData:function(a){this._data=this.data=a;return this},get:function(a){return this.data[a]},set:function(o,k){var h=this,b=h.fields.map,n=h.modified,a=!h.editing,e=0,c=[],j,m,d,l,f,g;if(arguments.length==1){for(m in o){if(o.hasOwnProperty(m)){j=b[m];if(j&&j.hasCustomConvert()){c.push(m);continue}if(!e&&a){h.beginEdit()}++e;h.set(m,o[m])}}f=c.length;if(f){if(!e&&a){h.beginEdit()}e+=f;for(d=0;d<f;d++){j=c[d];h.set(j,o[j])}}if(a&&e){h.endEdit(false,c)}}else{if(n){j=b[o];g=j&&j.getConvert();if(g){k=g.call(j,k,h)}l=h.data[o];h.data[o]=k;if(j&&!h.isEqual(l,k)){if(n.hasOwnProperty(o)){if(h.isEqual(n[o],k)){delete n[o];h.dirty=false;for(m in n){if(n.hasOwnProperty(m)){h.dirty=true;break}}}}else{h.dirty=true;n[o]=l}}if(a){h.afterEdit([o],n)}}}},isEqual:function(d,c){if(Ext.isDate(d)&&Ext.isDate(c)){return d.getTime()===c.getTime()}return d===c},beginEdit:function(){var a=this;if(!a.editing){a.editing=true;a.dirtySave=a.dirty;a.dataSave=Ext.apply({},a.data);a.modifiedSave=Ext.apply({},a.modified)}},cancelEdit:function(){var a=this;if(a.editing){a.editing=false;a.modified=a.modifiedSave;a.data=a.dataSave;a.dirty=a.dirtySave;delete a.modifiedSave;delete a.dataSave;delete a.dirtySave}},endEdit:function(a,c){var b=this;if(b.editing){b.editing=false;if(a!==true&&(b.changedWhileEditing())){b.afterEdit(c||Ext.Object.getKeys(this.modified),this.modified)}delete b.modifiedSave;delete b.dataSave;delete b.dirtySave}},changedWhileEditing:function(){var c=this,b=c.dataSave,d=c.data,a;for(a in d){if(d.hasOwnProperty(a)){if(!c.isEqual(d[a],b[a])){return true}}}return false},getChanges:function(){var a=this.modified,b={},c;for(c in a){if(a.hasOwnProperty(c)){b[c]=this.get(c)}}return b},isModified:function(a){return this.modified.hasOwnProperty(a)},save:function(b,d){var e=this,f=e.phantom?"create":"update",c=e.getProxy(),a,g;if(!c){Ext.Logger.error("You are trying to save a model instance that doesn't have a Proxy specified")}b=b||{};d=d||e;if(Ext.isFunction(b)){b={callback:b,scope:d}}Ext.applyIf(b,{records:[e],action:f,model:e.self});a=Ext.create("Ext.data.Operation",b);g=function(h){if(h.wasSuccessful()){Ext.callback(b.success,d,[e,h])}else{Ext.callback(b.failure,d,[e,h])}Ext.callback(b.callback,d,[e,h])};c[f](a,g,e);return e},erase:function(b,d){var e=this,c=this.getProxy(),a,f;if(!c){Ext.Logger.error("You are trying to erase a model instance that doesn't have a Proxy specified")}b=b||{};d=d||e;if(Ext.isFunction(b)){b={callback:b,scope:d}}Ext.applyIf(b,{records:[e],action:"destroy",model:this.self});a=Ext.create("Ext.data.Operation",b);f=function(g){if(g.wasSuccessful()){Ext.callback(b.success,d,[e,g])}else{Ext.callback(b.failure,d,[e,g])}Ext.callback(b.callback,d,[e,g])};c.destroy(a,f,e);return e},reject:function(a){var c=this,b=c.modified,d;for(d in b){if(b.hasOwnProperty(d)){if(typeof b[d]!="function"){c.data[d]=b[d]}}}c.dirty=false;c.editing=false;c.modified={};if(a!==true){c.afterReject()}},commit:function(a){var c=this,b=this.modified;c.phantom=c.dirty=c.editing=false;c.modified={};if(a!==true){c.afterCommit(b)}},afterEdit:function(b,a){this.notifyStores("afterEdit",b,a)},afterReject:function(){this.notifyStores("afterReject")},afterCommit:function(a){this.notifyStores("afterCommit",Ext.Object.getKeys(a||{}),a)},notifyStores:function(e){var c=Ext.Array.clone(arguments),a=this.stores;if(Ext.isArray(a)){var f=a.length,d,b;c[0]=this;for(d=0;d<f;++d){b=a[d];if(b!==undefined&&typeof b[e]=="function"){b[e].apply(b,c)}}}},copy:function(c){var d=this,b=d.getIdProperty(),a=Ext.apply({},d.raw),e=Ext.apply({},d.data);delete a[b];delete e[b];return new d.self(null,c,a,e)},getData:function(a){var b=this.data;if(a===true){Ext.apply(b,this.getAssociatedData())}return b},getAssociatedData:function(){return this.prepareAssociatedData(this,[],null)},prepareAssociatedData:function(d,m,c){var r=d.associations.items,g=r.length,s={},o=[],n,u,b,a,k,e,l,q,p,f,t,h;for(q=0;q<g;q++){e=r[q];u=e.getName();f=e.getType();t=true;if(c){t=f==c}if(t&&f.toLowerCase()=="hasmany"){n=d[e.getStoreName()];s[u]=[];if(n&&n.getCount()>0){b=n.data.items;k=b.length;o.length=0;for(p=0;p<k;p++){a=b[p];l=a.id;if(Ext.Array.indexOf(m,l)==-1){m.push(l);s[u][p]=a.getData();o.push({associationName:u,j:p,associatedRecord:a,ids:m,associationType:c})}}while(o.length>0){h=o.shift();Ext.apply(s[h.associationName][h.j],this.prepareAssociatedData(h.associatedRecord,h.ids,h.associationType))}}}else{if(t&&(f.toLowerCase()=="belongsto"||f.toLowerCase()=="hasone")){a=d[e.getInstanceName()];if(a!==undefined){l=a.id;if(Ext.Array.indexOf(m,l)===-1){m.push(l);s[u]=a.getData();Ext.apply(s[u],this.prepareAssociatedData(a,m,c))}}}}}return s},join:function(a){Ext.Array.include(this.stores,a)},unjoin:function(a){Ext.Array.remove(this.stores,a)},setDirty:function(){var b=this,a;b.dirty=true;b.fields.each(function(c){if(c.getPersist()){a=c.getName();b.modified[a]=b.get(a)}})},validate:function(){var j=Ext.create("Ext.data.Errors"),c=this.getValidations().items,e=Ext.data.Validations,b,d,h,a,g,f;if(c){b=c.length;for(f=0;f<b;f++){d=c[f];h=d.field||d.name;g=d.type;a=e[g](d,this.get(h));if(!a){j.add(Ext.create("Ext.data.Error",{field:h,message:d.message||e.getMessage(g)}))}}}return j},isValid:function(){return this.validate().isValid()},toUrl:function(){var b=this.$className.split("."),a=b[b.length-1].toLowerCase();return a+"/"+this.getId()},destroy:function(){var a=this;a.notifyStores("afterErase",a);if(a.getUseCache()){delete Ext.data.Model.cache[Ext.data.Model.generateCacheId(a)]}a.raw=a.stores=a.modified=null;a.callParent(arguments)},applyProxy:function(b,a){return Ext.factory(b,Ext.data.Proxy,a,"proxy")},updateProxy:function(a){if(a){a.setModel(this.self)}},applyAssociations:function(a){if(a){this.addAssociations(a,"hasMany")}},applyBelongsTo:function(a){if(a){this.addAssociations(a,"belongsTo")}},applyHasMany:function(a){if(a){this.addAssociations(a,"hasMany")}},applyHasOne:function(a){if(a){this.addAssociations(a,"hasOne")}},addAssociations:function(e,h){var f,d,b,c=this.self.modelName,g=this.self.associations,a;e=Ext.Array.from(e);for(d=0,f=e.length;d<f;d++){b=e[d];if(!Ext.isObject(b)){b={model:b}}Ext.applyIf(b,{type:h,ownerModel:c,associatedModel:b.model});delete b.model;a=Ext.Function.bind(function(j){g.add(Ext.data.association.Association.create(this))},b);Ext.ClassManager.onCreated(a,this,(typeof b.associatedModel==="string")?b.associatedModel:Ext.getClassName(b.associatedModel))}},applyValidations:function(a){if(a){if(!Ext.isArray(a)){a=[a]}this.addValidations(a)}},addValidations:function(a){this.self.validations.addAll(a)},applyFields:function(a){var b=this.superclass.fields;if(b){a=b.items.concat(a||[])}return a||[]},updateFields:function(c){var d=c.length,e=this,h=e.self.prototype,j=this.getIdProperty(),a,f,g,b;f=e._fields=e.fields=new Ext.util.Collection(h.getFieldName);for(b=0;b<d;b++){g=c[b];if(!g.isField){g=new Ext.data.Field(c[b])}f.add(g)}a=f.get(j);if(!a){f.add(new Ext.data.Field(j))}else{a.setType("auto")}f.addSorter(h.sortConvertFields)},applyIdentifier:function(a){if(typeof a==="string"){a={type:a}}return Ext.factory(a,Ext.data.identifier.Simple,this.getIdentifier(),"data.identifier")},getFieldName:function(a){return a.getName()},sortConvertFields:function(a,d){var c=a.hasCustomConvert(),b=d.hasCustomConvert();if(c&&!b){return 1}if(!c&&b){return -1}return 0},onClassExtended:function(l,d,k){var f=k.onBeforeCreated,b=this,h=b.prototype,e=Ext.Class.configNameCache,g=h.staticConfigs.concat(d.staticConfigs||[]),c=h.config,a=d.config||{},j;d.config=a;k.onBeforeCreated=function(B,u){var w=[],y=B.prototype,x={},n=y.config,o=g.length,r=["set","get"],t=r.length,p=n.associations||[],m=Ext.getClassName(B),A,z,s,q,v;for(s=0;s<o;s++){A=g[s];for(q=0;q<t;q++){z=e[A][r[q]];if(z in y){x[z]=b.generateProxyMethod(z)}}}B.addStatics(x);B.modelName=m;y.modelName=m;if(n.belongsTo){w.push("association.belongsto")}if(n.hasMany){w.push("association.hasmany")}if(n.hasOne){w.push("association.hasone")}for(s=0,v=p.length;s<v;++s){w.push("association."+p[s].type.toLowerCase())}if(n.identifier){if(typeof n.identifier==="string"){w.push("data.identifier."+n.identifier)}else{if(typeof n.identifier.type==="string"){w.push("data.identifier."+n.identifier.type)}}}if(n.proxy){if(typeof n.proxy==="string"){w.push("proxy."+n.proxy)}else{if(typeof n.proxy.type==="string"){w.push("proxy."+n.proxy.type)}}}if(n.validations){w.push("Ext.data.Validations")}Ext.require(w,function(){Ext.Function.interceptBefore(k,"onCreated",function(){Ext.data.ModelManager.registerType(m,B);var C=B.prototype.superclass;B.prototype.associations=B.associations=B.prototype._associations=(C&&C.associations)?C.associations.clone():new Ext.util.Collection(function(D){return D.getName()});B.prototype.validations=B.validations=B.prototype._validations=(C&&C.validations)?C.validations.clone():new Ext.util.Collection(function(D){return D.field?(D.field+"-"+D.type):(D.name+"-"+D.type)});B.prototype=Ext.Object.chain(B.prototype);B.prototype.initConfig.call(B.prototype,n);delete B.prototype.initConfig});f.call(b,B,u,k)})}}},1,0,0,0,0,[["observable",Ext.mixin.Observable]],[Ext.data,"Model",Ext.data,"Record"],0));(Ext.cmd.derive("Ext.data.StoreManager",Ext.util.Collection,{alternateClassName:["Ext.StoreMgr","Ext.data.StoreMgr","Ext.StoreManager"],singleton:true,register:function(){for(var a=0,b;(b=arguments[a]);a++){this.add(b)}},unregister:function(){for(var a=0,b;(b=arguments[a]);a++){this.remove(this.lookup(b))}},lookup:function(c){if(Ext.isArray(c)){var b=["field1"],e=!Ext.isArray(c[0]),f=c,d,a;if(e){f=[];for(d=0,a=c.length;d<a;++d){f.push([c[d]])}}else{for(d=2,a=c[0].length;d<=a;++d){b.push("field"+d)}}return Ext.create("Ext.data.ArrayStore",{data:f,fields:b,autoDestroy:true,autoCreated:true,expanded:e})}if(Ext.isString(c)){return this.get(c)}else{if(c instanceof Ext.data.Store){return c}else{return Ext.factory(c,Ext.data.Store,null,"store")}}},getKey:function(a){return a.getStoreId()}},0,0,0,0,0,0,[Ext.data,"StoreManager",Ext,"StoreMgr",Ext.data,"StoreMgr",Ext,"StoreManager"],function(){Ext.regStore=function(c,b){var a;if(Ext.isObject(c)){b=c}else{if(b instanceof Ext.data.Store){b.setStoreId(c)}else{b.storeId=c}}if(b instanceof Ext.data.Store){a=b}else{a=Ext.create("Ext.data.Store",b)}return Ext.data.StoreManager.register(a)};Ext.getStore=function(a){return Ext.data.StoreManager.lookup(a)}}));(Ext.cmd.derive("Ext.util.Grouper",Ext.util.Sorter,{isGrouper:true,config:{groupFn:null,sortProperty:null,sorterFn:function(d,c){var e=this.getSortProperty(),g,b,f,a;g=this.getGroupFn();b=g.call(this,d);f=g.call(this,c);if(e){if(b!==f){return this.defaultSortFn.call(this,d,c)}else{return 0}}return(b>f)?1:((b<f)?-1:0)}},defaultSortFn:function(e,c){var g=this,f=g._transform,b=g._root,d,a,h=g._sortProperty;if(b!==null){e=e[b];c=c[b]}d=e[h];a=c[h];if(f){d=f(d);a=f(a)}return d>a?1:(d<a?-1:0)},updateProperty:function(a){this.setGroupFn(this.standardGroupFn)},standardGroupFn:function(b){var a=this.getRoot(),d=this.getProperty(),c=b;if(a){c=b[a]}return c[d]},getGroupString:function(a){var b=this.getGroupFn().call(this,a);return(b!==null&&typeof b!="undefined")?b.toString():""}},0,0,0,0,0,0,[Ext.util,"Grouper"],0));(Ext.cmd.derive("Ext.data.Store",Ext.Evented,{statics:{create:function(a){if(!a.isStore){if(!a.type){a.type="store"}a=Ext.createByAlias("store."+a.type,a)}return a}},isStore:true,config:{storeId:undefined,data:null,autoLoad:null,autoSync:false,model:undefined,proxy:undefined,fields:null,remoteSort:false,remoteFilter:false,remoteGroup:false,filters:null,sorters:null,grouper:null,groupField:null,groupDir:null,getGroupString:null,pageSize:25,totalCount:null,clearOnPageLoad:true,params:{},modelDefaults:{},autoDestroy:false,syncRemovedRecords:true,destroyRemovedRecords:true,buffered:false,plugins:null},currentPage:1,constructor:function(a){a=a||{};this.data=this._data=this.createDataCollection();this.data.setSortRoot("data");this.data.setFilterRoot("data");this.removed=[];if(a.id&&!a.storeId){a.storeId=a.id;delete a.id}this.initConfig(a);Ext.Evented.prototype.constructor.apply(this,arguments)},applyPlugins:function(a){var c,b,d;if(!a){return a}a=[].concat(a);for(b=0,c=a.length;b<c;b++){d=a[b];a[b]=Ext.factory(d,"Ext.plugin.Plugin",null,"plugin")}return a},updatePlugins:function(d,a){var c,b;if(d){for(b=0,c=d.length;b<c;b++){d[b].init(this)}}if(a){for(b=0,c=a.length;b<c;b++){Ext.destroy(a[b])}}},createDataCollection:function(){return new Ext.util.Collection(function(a){return a.getId()})},applyStoreId:function(a){if(a===undefined||a===null){a=this.getUniqueId()}return a},updateStoreId:function(a,b){if(b){Ext.data.StoreManager.unregister(this)}if(a){Ext.data.StoreManager.register(this)}},applyModel:function(b){if(typeof b=="string"){var d=Ext.data.ModelManager.getModel(b);if(!d){Ext.Logger.error('Model with name "'+b+'" does not exist.')}b=d}if(b&&!b.prototype.isModel&&Ext.isObject(b)){b=Ext.data.ModelManager.registerType(b.storeId||b.id||Ext.id(),b)}if(!b){var a=this.getFields(),c=this.config.data;if(!a&&c&&c.length){a=Ext.Object.getKeys(c[0])}if(a){b=Ext.define("Ext.data.Store.ImplicitModel-"+(this.getStoreId()||Ext.id()),{extend:"Ext.data.Model",config:{fields:a,useCache:false,proxy:this.getProxy()}});this.implicitModel=true}}if(!b&&this.getProxy()){b=this.getProxy().getModel()}return b},updateModel:function(a){var b=this.getProxy();if(b&&!b.getModel()){b.setModel(a)}},applyProxy:function(b,a){b=Ext.factory(b,Ext.data.Proxy,a,"proxy");if(!b&&this.getModel()){b=this.getModel().getProxy()}if(!b){b=new Ext.data.proxy.Memory({model:this.getModel()})}if(b.isMemoryProxy){this.setSyncRemovedRecords(false)}return b},updateProxy:function(b,a){if(b){if(!b.getModel()){b.setModel(this.getModel())}b.on("metachange","onMetaChange",this)}if(a){b.un("metachange","onMetaChange",this)}},applyData:function(c){var b=this,a;if(c){a=b.getProxy();if(a instanceof Ext.data.proxy.Memory){a.setData(c);b.load();return}else{b.removeAll(true);b.fireEvent("clear",b);b.suspendEvents();b.add(c);b.resumeEvents();b.dataLoaded=true}}else{b.removeAll(true);b.fireEvent("clear",b)}b.fireEvent("refresh",b,b.data)},clearData:function(){this.setData(null)},addData:function(d){var a=this.getProxy().getReader(),c=a.read(d),b=c.getRecords();this.add(b)},updateAutoLoad:function(a){var b=this.getProxy();if(a&&(b&&!b.isMemoryProxy)){this.load(Ext.isObject(a)?a:null)}},isAutoLoading:function(){var a=this.getProxy();return(this.getAutoLoad()||(a&&a.isMemoryProxy)||this.dataLoaded)},updateGroupField:function(a){var b=this.getGrouper();if(a){if(!b){this.setGrouper({property:a,direction:this.getGroupDir()||"ASC"})}else{b.setProperty(a)}}else{if(b){this.setGrouper(null)}}},updateGroupDir:function(a){var b=this.getGrouper();if(b){b.setDirection(a)}},applyGetGroupString:function(b){var a=this.getGrouper();if(b){if(a){a.setGroupFn(b)}else{this.setGrouper({groupFn:b})}}else{if(a){this.setGrouper(null)}}},applyGrouper:function(a){if(typeof a=="string"){a={property:a}}else{if(typeof a=="function"){a={groupFn:a}}}a=Ext.factory(a,Ext.util.Grouper);return a},updateGrouper:function(b,a){var c=this.data;if(a){c.removeSorter(a);if(!b){c.getSorters().removeSorter("isGrouper")}}if(b){c.insertSorter(0,b);if(!a){c.getSorters().addSorter({direction:"DESC",property:"isGrouper",transform:function(d){return(d===true)?1:-1}})}}if(a){this.fireEvent("refresh",this,c)}},isGrouped:function(){return !!this.getGrouper()},updateSorters:function(d){var b=this.getGrouper(),c=this.data,a=c.getAutoSort();c.setAutoSort(false);c.setSorters(d);if(b){c.insertSorter(0,b)}this.updateSortTypes();c.setAutoSort(a)},updateSortTypes:function(){var b=this.getModel(),a=b&&b.getFields(),c=this.data;if(a){c.getSorters().each(function(f){var d=f.getProperty(),e;if(!f.isGrouper&&d&&!f.getTransform()){e=a.get(d);if(e){f.setTransform(e.getSortType())}}})}},updateFilters:function(a){this.data.setFilters(a)},add:function(a){if(!Ext.isArray(a)){a=Array.prototype.slice.call(arguments)}return this.insert(this.data.length,a)},insert:function(f,b){if(!Ext.isArray(b)){b=Array.prototype.slice.call(arguments,1)}var j=this,l=false,d=this.data,g=b.length,a=this.getModel(),h=j.getModelDefaults(),k=false,c,e;b=b.slice();for(c=0;c<g;c++){e=b[c];if(!e.isModel){e=new a(e)}else{if(this.removed.indexOf(e)!=-1){Ext.Array.remove(this.removed,e)}}e.set(h);e.join(j);b[c]=e;l=l||(e.phantom===true)}if(b.length===1){k=d.insert(f,b[0]);if(k){k=[k]}}else{k=d.insertAll(f,b)}if(k){j.fireEvent("addrecords",j,k)}if(j.getAutoSync()&&l){j.sync()}return b},remove:function(b){if(b.isModel){b=[b]}var k=this,l=false,d=0,a=this.getAutoSync(),o=k.getSyncRemovedRecords(),c=this.getDestroyRemovedRecords(),j=b.length,n=[],g=[],m,h=k.data.items,e,f;for(;d<j;d++){e=b[d];if(k.data.contains(e)){m=(e.phantom===true);f=h.indexOf(e);if(f!==-1){g.push(e);n.push(f)}e.unjoin(k);k.data.remove(e);if(c&&!o&&!e.stores.length){e.destroy()}else{if(!m&&o){k.removed.push(e)}}l=l||!m}}k.fireEvent("removerecords",k,g,n);if(a&&l){k.sync()}},removeAt:function(b){var a=this.getAt(b);if(a){this.remove(a)}},removeAll:function(a){if(a!==true&&this.eventFiringSuspended!==true){this.fireAction("clear",[this],"doRemoveAll")}else{this.doRemoveAll.call(this,true)}},doRemoveAll:function(d){var g=this,a=this.getDestroyRemovedRecords(),h=this.getSyncRemovedRecords(),c=g.data.all.slice(),f=c.length,e,b;for(e=0;e<f;e++){b=c[e];b.unjoin(g);if(a&&!h&&!b.stores.length){b.destroy()}else{if(b.phantom!==true&&h){g.removed.push(b)}}}g.data.clear();if(d!==true){g.fireEvent("refresh",g,g.data)}if(g.getAutoSync()){this.sync()}},each:function(b,a){this.data.each(b,a)},getCount:function(){return this.data.items.length||0},getAllCount:function(){return this.data.all.length||0},getAt:function(a){return this.data.getAt(a)},getRange:function(b,a){return this.data.getRange(b,a)},getById:function(a){return this.data.findBy(function(b){return b.getId()==a})},indexOf:function(a){return this.data.indexOf(a)},indexOfId:function(a){return this.data.indexOfKey(a)},afterEdit:function(c,g,d){var f=this,h=f.data,a=d[c.getIdProperty()]||c.getId(),b=h.keys.indexOf(a),e;if(b===-1&&h.map[a]===undefined){return}if(f.getAutoSync()){f.sync()}if(a!==c.getId()){h.replace(a,c)}else{h.replace(c)}e=h.indexOf(c);if(b===-1&&e!==-1){f.fireEvent("addrecords",f,[c])}else{if(b!==-1&&e===-1){f.fireEvent("removerecords",f,[c],[b])}else{if(e!==-1){f.fireEvent("updaterecord",f,c,e,b,g,d)}}}},afterReject:function(a){var b=this.data.indexOf(a);this.fireEvent("updaterecord",this,a,b,b,[],{})},afterCommit:function(c,g,d){var f=this,h=f.data,a=d[c.getIdProperty()]||c.getId(),b=h.keys.indexOf(a),e;if(b===-1&&h.map[a]===undefined){return}if(a!==c.getId()){h.replace(a,c)}else{h.replace(c)}e=h.indexOf(c);if(b===-1&&e!==-1){f.fireEvent("addrecords",f,[c])}else{if(b!==-1&&e===-1){f.fireEvent("removerecords",f,[c],[b])}else{if(e!==-1){f.fireEvent("updaterecord",f,c,e,b,g,d)}}}},afterErase:function(a){var c=this,d=c.data,b=d.indexOf(a);if(b!==-1){d.remove(a);c.fireEvent("removerecords",c,[a],[b])}},applyRemoteFilter:function(b){var a=this.getProxy();return b||(a&&a.isSQLProxy===true)},applyRemoteSort:function(b){var a=this.getProxy();return b||(a&&a.isSQLProxy===true)},applyRemoteGroup:function(b){var a=this.getProxy();return b||(a&&a.isSQLProxy===true)},updateRemoteFilter:function(a){this.data.setAutoFilter(!a)},updateRemoteSort:function(a){this.data.setAutoSort(!a)},sort:function(f,d,c){var e=this.data,b=this.getGrouper(),a=e.getAutoSort();if(f){e.setAutoSort(false);if(typeof c==="string"){if(c=="prepend"){e.insertSorters(b?1:0,f,d)}else{e.addSorters(f,d)}}else{e.setSorters(null);if(b){e.addSorters(b)}e.addSorters(f,d)}this.updateSortTypes();e.setAutoSort(a)}if(!this.getRemoteSort()){if(!f){this.data.sort()}this.fireEvent("sort",this,this.data,this.data.getSorters());if(e.length){this.fireEvent("refresh",this,this.data)}}},filter:function(e,d,f,a){var c=this.data,b=null;if(e){if(Ext.isFunction(e)){b={filterFn:e}}else{if(Ext.isArray(e)||e.isFilter){b=e}else{b={property:e,value:d,anyMatch:f,caseSensitive:a,id:e}}}}if(this.getRemoteFilter()){c.addFilters(b)}else{c.filter(b);this.fireEvent("filter",this,c,c.getFilters());this.fireEvent("refresh",this,c)}},filterBy:function(b,a){var d=this,e=d.data,c=e.length;e.filter({filterFn:function(f){return b.call(a||d,f,f.getId())}});this.fireEvent("filter",this,e,e.getFilters());if(e.length!==c){this.fireEvent("refresh",this,e)}},queryBy:function(b,a){return this.data.filterBy(b,a||this)},clearFilter:function(a){var b=this.data.length;if(a){this.suspendEvents()}this.data.setFilters(null);if(a){this.resumeEvents(true)}else{if(b!==this.data.length){this.fireEvent("refresh",this,this.data)}}},isFiltered:function(){return this.data.filtered},isSorted:function(){return this.data.sorted},getSorters:function(){var a=this.data.getSorters();return(a)?a.items:[]},getFilters:function(){var a=this.data.getFilters();return(a)?a.items:[]},getGroups:function(c){var e=this.data.items,b=e.length,a=this.getGrouper(),d=[],k={},g,h,j,f;for(f=0;f<b;f++){g=e[f];h=a.getGroupString(g);j=k[h];if(j===undefined){j={name:h,children:[]};d.push(j);k[h]=j}j.children.push(g)}return c?k[c]:d},getGroupString:function(a){var b=this.getGrouper();if(b){return b.getGroupString(a)}return null},find:function(g,d,e,f,a,c){var b=Ext.create("Ext.util.Filter",{property:g,value:d,anyMatch:f,caseSensitive:a,exactMatch:c,root:"data"});return this.data.findIndexBy(b.getFilterFn(),null,e)},findRecord:function(){var b=this,a=b.find.apply(b,arguments);return a!==-1?b.getAt(a):null},findExact:function(c,a,b){return this.data.findIndexBy(function(d){return d.get(c)===a},this,b)},findBy:function(b,a,c){return this.data.findIndexBy(b,a,c)},load:function(c,e){var f=this,b,d=f.currentPage,a=f.getPageSize();c=c||{};if(Ext.isFunction(c)){c={callback:c,scope:e||this}}if(f.getRemoteSort()){c.sorters=c.sorters||this.getSorters()}if(f.getRemoteFilter()){c.filters=c.filters||this.getFilters()}if(f.getRemoteGroup()){c.grouper=c.grouper||this.getGrouper()}Ext.applyIf(c,{page:d,start:(d-1)*a,limit:a,addRecords:false,action:"read",params:this.getParams(),model:this.getModel()});b=Ext.create("Ext.data.Operation",c);if(f.fireEvent("beforeload",f,b)!==false){f.loading=true;f.getProxy().read(b,f.onProxyLoad,f)}return f},isLoading:function(){return Boolean(this.loading)},isLoaded:function(){return Boolean(this.loaded)},sync:function(c){var e=this,b={},f=e.getNewRecords(),d=e.getUpdatedRecords(),a=e.getRemovedRecords(),g=false;if(f.length>0){b.create=f;g=true}if(d.length>0){b.update=d;g=true}if(a.length>0){b.destroy=a;g=true}if(g&&e.fireEvent("beforesync",this,b)!==false){e.getProxy().batch(Ext.merge({operations:b,listeners:e.getBatchListeners()},c||{}))}return{added:f,updated:d,removed:a}},first:function(){return this.data.first()},last:function(){return this.data.last()},sum:function(e){var d=0,c=0,b=this.data.items,a=b.length;for(;c<a;++c){d+=b[c].get(e)}return d},min:function(f){var d=1,b=this.data.items,a=b.length,e,c;if(a>0){c=b[0].get(f)}for(;d<a;++d){e=b[d].get(f);if(e<c){c=e}}return c},max:function(f){var d=1,c=this.data.items,b=c.length,e,a;if(b>0){a=c[0].get(f)}for(;d<b;++d){e=c[d].get(f);if(e>a){a=e}}return a},average:function(e){var c=0,b=this.data.items,a=b.length,d=0;if(b.length>0){for(;c<a;++c){d+=b[c].get(e)}return d/a}return 0},getBatchListeners:function(){return{scope:this,exception:this.onBatchException,complete:this.onBatchComplete}},onBatchComplete:function(b){var e=this,a=b.operations,d=a.length,c;for(c=0;c<d;c++){e.onProxyWrite(a[c])}},onBatchException:function(b,a){},onProxyLoad:function(b){var d=this,a=b.getRecords(),c=b.getResultSet(),e=b.wasSuccessful();if(c){d.setTotalCount(c.getTotal())}if(e){this.fireAction("datarefresh",[this,this.data,b],"doDataRefresh")}d.loaded=true;d.loading=false;d.fireEvent("load",this,a,e,b);Ext.callback(b.getCallback(),b.getScope()||d,[a,b,e])},doDataRefresh:function(m,h,d){var c=d.getRecords(),l=this,f=l.getDestroyRemovedRecords(),e=h.all.slice(),k=e.length,b=c.length,a={},g,j;if(d.getAddRecords()!==true){for(g=0;g<b;g++){a[c[g].id]=true}for(g=0;g<k;g++){j=e[g];j.unjoin(l);if(a[j.id]!==true&&f&&!j.stores.length){j.destroy()}}h.clear();l.fireEvent("clear",l)}if(c&&c.length){l.suspendEvents();l.add(c);l.resumeEvents(true)}l.fireEvent("refresh",l,h)},onProxyWrite:function(b){var c=this,d=b.wasSuccessful(),a=b.getRecords();switch(b.getAction()){case"create":c.onCreateRecords(a,b,d);break;case"update":c.onUpdateRecords(a,b,d);break;case"destroy":c.onDestroyRecords(a,b,d);break}if(d){c.fireEvent("write",c,b)}Ext.callback(b.getCallback(),b.getScope()||c,[a,b,d])},onCreateRecords:function(b,a,c){},onUpdateRecords:function(b,a,c){},onDestroyRecords:function(b,a,c){this.removed=[]},onMetaChange:function(b){var a=this.getProxy().getModel();if(!this.getModel()&&a){this.setModel(a)}this.fireEvent("metachange",this,b)},getNewRecords:function(){return this.data.filterBy(function(a){return a.phantom===true&&a.isValid()}).items},getUpdatedRecords:function(){return this.data.filterBy(function(a){return a.dirty===true&&a.phantom!==true&&a.isValid()}).items},getRemovedRecords:function(){return this.removed},loadPage:function(f,c,d){if(typeof c==="function"){c={callback:c,scope:d||this}}var e=this,b=e.getPageSize(),a=e.getClearOnPageLoad();c=Ext.apply({},c);e.currentPage=f;e.load(Ext.applyIf(c,{page:f,start:(f-1)*b,limit:b,addRecords:!a}))},nextPage:function(a){this.loadPage(this.currentPage+1,a)},previousPage:function(a){this.loadPage(this.currentPage-1,a)},destroy:function(){this.clearData();var a=this.getProxy();if(a){a.onDestroy()}Ext.data.StoreManager.unregister(this);Ext.destroy(this.getPlugins());if(this.implicitModel&&this.getModel()){delete Ext.data.ModelManager.types[this.getModel().getName()]}Ext.destroy(this.data);Ext.Evented.prototype.destroy.apply(this,arguments)}},1,0,0,0,["store.store"],0,[Ext.data,"Store"],0));(Ext.cmd.derive("Ext.data.ArrayStore",Ext.data.Store,{config:{proxy:{type:"memory",reader:"array"}},loadData:function(b,a){this.callParent([b,a])}},0,0,0,0,["store.array"],0,[Ext.data,"ArrayStore"],function(){Ext.data.SimpleStore=Ext.data.ArrayStore}));(Ext.cmd.derive("Ext.data.Validations",Ext.Base,{alternateClassName:"Ext.data.validations",singleton:true,config:{presenceMessage:"must be present",lengthMessage:"is the wrong length",formatMessage:"is the wrong format",inclusionMessage:"is not included in the list of acceptable values",exclusionMessage:"is not an acceptable value",emailMessage:"is not a valid email address"},constructor:function(a){this.initConfig(a)},getMessage:function(a){var b=this["get"+a[0].toUpperCase()+a.slice(1)+"Message"];if(b){return b.call(this)}return""},emailRe:/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/,presence:function(a,b){if(arguments.length===1){b=a}return !!b||b===0},length:function(b,e){if(e===undefined||e===null){return false}var d=e.length,c=b.min,a=b.max;if((c&&d<c)||(a&&d>a)){return false}else{return true}},email:function(b,a){return Ext.data.validations.emailRe.test(a)},format:function(a,b){if(b===undefined||b===null){b=""}return !!(a.matcher&&a.matcher.test(b))},inclusion:function(a,b){return a.list&&Ext.Array.indexOf(a.list,b)!=-1},exclusion:function(a,b){return a.list&&Ext.Array.indexOf(a.list,b)==-1}},1,0,0,0,0,0,[Ext.data,"Validations",Ext.data,"validations"],0));(Ext.cmd.derive("Ext.data.reader.Array",Ext.data.reader.Json,{alternateClassName:"Ext.data.ArrayReader",config:{totalProperty:undefined,successProperty:undefined},createFieldAccessExpression:function(g,c,b){var f=this,e=g.getMapping(),d=(e==null)?f.getModel().getFields().indexOf(g):e,a;if(typeof d==="function"){a=c+".getMapping()("+b+", this)"}else{if(isNaN(d)){d='"'+d+'"'}a=b+"["+d+"]"}return a}},0,0,0,0,["reader.array"],0,[Ext.data.reader,"Array",Ext.data,"ArrayReader"],0));(Ext.cmd.derive("Ext.device.communicator.Default",Ext.Base,{SERVER_URL:"http://localhost:3000",callbackDataMap:{},callbackIdMap:{},idSeed:0,globalScopeId:"0",generateId:function(){return String(++this.idSeed)},getId:function(a){var b=a.$callbackId;if(!b){a.$callbackId=b=this.generateId()}return b},getCallbackId:function(h,d){var c=this.callbackIdMap,b=this.callbackDataMap,g,a,f,e;if(!d){a=this.globalScopeId}else{if(d.isIdentifiable){a=d.getId()}else{a=this.getId(d)}}f=this.getId(h);if(!c[a]){c[a]={}}if(!c[a][f]){g=this.generateId();e={callback:h,scope:d};c[a][f]=g;b[g]=e}return c[a][f]},getCallbackData:function(a){return this.callbackDataMap[a]},invoke:function(c,a){var b=this.getCallbackData(c);b.callback.apply(b.scope,a)},send:function(c){var e,d,b,f;if(!c){c={}}else{if(c.callbacks){e=c.callbacks;d=c.scope;delete c.callbacks;delete c.scope;for(b in e){if(e.hasOwnProperty(b)){f=e[b];if(typeof f=="function"){c[b]=this.getCallbackId(f,d)}}}}}c.__source=document.location.href;var a=this.doSend(c);return(a&&a.length>0)?JSON.parse(a):null},doSend:function(a){var c=new XMLHttpRequest();c.open("GET",this.SERVER_URL+"?"+Ext.Object.toQueryString(a)+"&_dc="+new Date().getTime(),false);try{c.send(null);return c.responseText}catch(b){if(a.failure){this.invoke(a.failure)}else{if(a.callback){this.invoke(a.callback)}}}}},0,0,0,0,0,0,[Ext.device.communicator,"Default"],0));(Ext.cmd.derive("Ext.device.communicator.Android",Ext.device.communicator.Default,{doSend:function(a){return window.Sencha.action(JSON.stringify(a))}},0,0,0,0,0,0,[Ext.device.communicator,"Android"],0));(Ext.cmd.derive("Ext.device.Communicator",Ext.Base,{singleton:true,constructor:function(){if(Ext.os.is.Android){return new Ext.device.communicator.Android()}return new Ext.device.communicator.Default()}},1,0,0,0,0,0,[Ext.device,"Communicator"],0));(Ext.cmd.derive("Ext.device.connection.Abstract",Ext.Evented,{config:{online:false,type:null},UNKNOWN:"Unknown connection",ETHERNET:"Ethernet connection",WIFI:"WiFi connection",CELL_2G:"Cell 2G connection",CELL_3G:"Cell 3G connection",CELL_4G:"Cell 4G connection",NONE:"No network connection",isOnline:function(){return this.getOnline()}},0,0,0,0,0,[[Ext.mixin.Observable.prototype.mixinId||Ext.mixin.Observable.$className,Ext.mixin.Observable]],[Ext.device.connection,"Abstract"],0));(Ext.cmd.derive("Ext.device.connection.Sencha",Ext.device.connection.Abstract,{constructor:function(){Ext.device.connection.Abstract.prototype.constructor.apply(this,arguments);Ext.device.Communicator.send({command:"Connection#watch",callbacks:{callback:this.onConnectionChange},scope:this})},onConnectionChange:function(a){this.setOnline(Boolean(a.online));this.setType(this[a.type]);this.fireEvent("onlinechange",this.getOnline(),this.getType())}},1,0,0,0,0,0,[Ext.device.connection,"Sencha"],0));(Ext.cmd.derive("Ext.device.connection.Cordova",Ext.device.connection.Abstract,{alternateClassName:"Ext.device.connection.PhoneGap",constructor:function(){var a=this;document.addEventListener("online",function(){a.fireEvent("online",a)});document.addEventListener("offline",function(){a.fireEvent("offline",a)})},syncOnline:function(){var a=navigator.connection.type;this._type=a;this._online=a!=Connection.NONE},getOnline:function(){this.syncOnline();return this._online},getType:function(){this.syncOnline();return this._type}},1,0,0,0,0,0,[Ext.device.connection,"Cordova",Ext.device.connection,"PhoneGap"],0));(Ext.cmd.derive("Ext.device.connection.Simulator",Ext.device.connection.Abstract,{getOnline:function(){this._online=navigator.onLine;this._type=Ext.device.Connection.UNKNOWN;return this._online}},0,0,0,0,0,0,[Ext.device.connection,"Simulator"],0));(Ext.cmd.derive("Ext.device.Connection",Ext.Base,{singleton:true,constructor:function(){var a=Ext.browser.is;if(a.WebView){if(a.Cordova){return Ext.create("Ext.device.connection.Cordova")}else{if(a.Sencha){return Ext.create("Ext.device.connection.Sencha")}}}return Ext.create("Ext.device.connection.Simulator")}},1,0,0,0,0,0,[Ext.device,"Connection"],0));(Ext.cmd.derive("Ext.event.Event",Ext.Base,{alternateClassName:"Ext.EventObject",isStopped:false,set:function(a,b){if(arguments.length===1&&typeof a!="string"){var c=a;for(a in c){if(c.hasOwnProperty(a)){this[a]=c[a]}}}else{this[a]=c[a]}},stopEvent:function(){return this.stopPropagation()},stopPropagation:function(){this.isStopped=true;return this}},0,0,0,0,0,0,[Ext.event,"Event",Ext,"EventObject"],0));(Ext.cmd.derive("Ext.event.Dom",Ext.event.Event,{constructor:function(a){var c=a.target,b;if(c&&c.nodeType!==1){c=c.parentNode}b=a.changedTouches;if(b){b=b[0];this.pageX=b.pageX;this.pageY=b.pageY}else{this.pageX=a.pageX;this.pageY=a.pageY}this.browserEvent=this.event=a;this.target=this.delegatedTarget=c;this.type=a.type;this.timeStamp=this.time=+a.timeStamp;return this},stopEvent:function(){this.preventDefault();return Ext.event.Event.prototype.stopEvent.call(this)},preventDefault:function(){this.browserEvent.preventDefault()},getPageX:function(){return this.pageX||this.browserEvent.pageX},getPageY:function(){return this.pageY||this.browserEvent.pageY},getXY:function(){if(!this.xy){this.xy=[this.getPageX(),this.getPageY()]}return this.xy},getTarget:function(b,c,a){if(arguments.length===0){return this.delegatedTarget}return b?Ext.fly(this.target).findParent(b,c,a):(a?Ext.get(this.target):this.target)},getTime:function(){return this.time},setDelegatedTarget:function(a){this.delegatedTarget=a},makeUnpreventable:function(){this.browserEvent.preventDefault=Ext.emptyFn}},1,0,0,0,0,0,[Ext.event,"Dom"],0));(Ext.cmd.derive("Ext.event.Touch",Ext.event.Dom,{constructor:function(b,c,a,h){var f=[],d,e,j,g;if(c){this.set(c)}this.changedTouches=this.cloneTouches(b.changedTouches,a);for(e=0,j=h.length;e<j;e++){g=h[e];f.push(a[g])}this.touches=f;this.targetTouches=f.slice();d=this.changedTouches[0];Ext.event.Dom.prototype.constructor.call(this,b);this.target=this.delegatedTarget=d.target;this.pageX=d.pageX;this.pageY=d.pageY},cloneTouches:function(f,e){var d=[],b,c,g,a;for(b=0,c=f.length;b<c;b++){g=f[b];a=g.identifier;d[b]=e[a]}return d}},1,0,0,0,0,0,[Ext.event,"Touch"],0));(Ext.cmd.derive("Ext.event.publisher.Publisher",Ext.Base,{targetType:"",idSelectorRegex:/^#([\w\-]+)$/i,constructor:function(){var b=this.handledEvents,a,c,e,d;a=this.handledEventsMap={};for(c=0,e=b.length;c<e;c++){d=b[c];a[d]=true}this.subscribers={};return this},handles:function(a){var b=this.handledEventsMap;return !!b[a]||!!b["*"]||a==="*"},getHandledEvents:function(){return this.handledEvents},setDispatcher:function(a){this.dispatcher=a},subscribe:function(){return false},unsubscribe:function(){return false},unsubscribeAll:function(){delete this.subscribers;this.subscribers={};return this},notify:function(){return false},getTargetType:function(){return this.targetType},dispatch:function(c,a,b){this.dispatcher.doDispatchEvent(this.targetType,c,a,b)}},1,0,0,0,0,0,[Ext.event.publisher,"Publisher"],0));(Ext.cmd.derive("Ext.event.publisher.ComponentDelegation",Ext.event.publisher.Publisher,{targetType:"component",optimizedSelectorRegex:/^#([\w\-]+)((?:[\s]*)>(?:[\s]*)|(?:\s*))([\w\-]+)$/i,handledEvents:["*"],getSubscribers:function(b,a){var d=this.subscribers,c=d[b];if(!c&&a){c=d[b]={type:{$length:0},selector:[],$length:0}}return c},subscribe:function(g,f){if(this.idSelectorRegex.test(g)){return false}var e=g.match(this.optimizedSelectorRegex),a=this.getSubscribers(f,true),l=a.type,c=a.selector,d,j,k,b,h;if(e!==null){d=e[1];j=e[2].indexOf(">")===-1;k=e[3];b=l[k];if(!b){l[k]=b={descendents:{$length:0},children:{$length:0},$length:0}}h=j?b.descendents:b.children;if(h.hasOwnProperty(d)){h[d]++;return true}h[d]=1;h.$length++;b.$length++;l.$length++}else{if(c.hasOwnProperty(g)){c[g]++;return true}c[g]=1;c.push(g)}a.$length++;return true},unsubscribe:function(g,f,l){var a=this.getSubscribers(f);if(!a){return false}var e=g.match(this.optimizedSelectorRegex),m=a.type,c=a.selector,d,j,k,b,h;l=Boolean(l);if(e!==null){d=e[1];j=e[2].indexOf(">")===-1;k=e[3];b=m[k];if(!b){return true}h=j?b.descendents:b.children;if(!h.hasOwnProperty(d)||(!l&&--h[d]>0)){return true}delete h[d];h.$length--;b.$length--;m.$length--}else{if(!c.hasOwnProperty(g)||(!l&&--c[g]>0)){return true}delete c[g];Ext.Array.remove(c,g)}if(--a.$length===0){delete this.subscribers[f]}return true},notify:function(d,a){var c=this.getSubscribers(a),e,b;if(!c||c.$length===0){return false}e=d.substr(1);b=Ext.ComponentManager.get(e);if(b){this.dispatcher.doAddListener(this.targetType,d,a,"publish",this,{args:[a,b]},"before")}},matchesSelector:function(b,a){return Ext.ComponentQuery.is(b,a)},dispatch:function(d,b,c,a){this.dispatcher.doDispatchEvent(this.targetType,d,b,c,null,a)},publish:function(g,k){var e=this.getSubscribers(g);if(!e){return}var p=arguments[arguments.length-1],o=e.type,b=e.selector,d=Array.prototype.slice.call(arguments,2,-2),l=k.xtypesChain,s,n,t,a,m,v,r,u,h,f,q,c;for(u=0,h=l.length;u<h;u++){f=l[u];e=o[f];if(e&&e.$length>0){s=e.descendents;if(s.$length>0){if(!a){a=k.getAncestorIds()}for(q=0,c=a.length;q<c;q++){m=a[q];if(s.hasOwnProperty(m)){this.dispatch("#"+m+" "+f,g,d,p)}}}n=e.children;if(n.$length>0){if(!t){if(a){t=a[0]}else{v=k.getParent();if(v){t=v.getId()}}}if(t){if(n.hasOwnProperty(t)){this.dispatch("#"+t+" > "+f,g,d,p)}}}}}h=b.length;if(h>0){for(u=0;u<h;u++){r=b[u];if(this.matchesSelector(k,r)){this.dispatch(r,g,d,p)}}}}},0,0,0,0,0,0,[Ext.event.publisher,"ComponentDelegation"],0));(Ext.cmd.derive("Ext.event.publisher.ComponentPaint",Ext.event.publisher.Publisher,{targetType:"component",handledEvents:["erased"],eventNames:{painted:"painted",erased:"erased"},constructor:function(){Ext.event.publisher.Publisher.prototype.constructor.apply(this,arguments);this.hiddenQueue={};this.renderedQueue={}},getSubscribers:function(b,a){var c=this.subscribers;if(!c.hasOwnProperty(b)){if(!a){return null}c[b]={$length:0}}return c[b]},setDispatcher:function(a){var b=this.targetType;a.doAddListener(b,"*","renderedchange","onBeforeComponentRenderedChange",this,null,"before");a.doAddListener(b,"*","hiddenchange","onBeforeComponentHiddenChange",this,null,"before");a.doAddListener(b,"*","renderedchange","onComponentRenderedChange",this,null,"after");a.doAddListener(b,"*","hiddenchange","onComponentHiddenChange",this,null,"after");return Ext.event.publisher.Publisher.prototype.setDispatcher.apply(this,arguments)},subscribe:function(d,a){var b=d.match(this.idSelectorRegex),c,e;if(!b){return false}e=b[1];c=this.getSubscribers(a,true);if(c.hasOwnProperty(e)){c[e]++;return true}c[e]=1;c.$length++;return true},unsubscribe:function(e,a,c){var b=e.match(this.idSelectorRegex),d,f;if(!b||!(d=this.getSubscribers(a))){return false}f=b[1];if(!d.hasOwnProperty(f)||(!c&&--d[f]>0)){return true}delete d[f];if(--d.$length===0){delete this.subscribers[a]}return true},onBeforeComponentRenderedChange:function(b,d,g){var f=this.eventNames,c=g?f.painted:f.erased,e=this.getSubscribers(c),a;if(e&&e.$length>0){this.renderedQueue[d.getId()]=a=[];this.publish(e,d,c,a)}},onBeforeComponentHiddenChange:function(c,d){var f=this.eventNames,b=d?f.erased:f.painted,e=this.getSubscribers(b),a;if(e&&e.$length>0){this.hiddenQueue[c.getId()]=a=[];this.publish(e,c,b,a)}},onComponentRenderedChange:function(b,c){var d=this.renderedQueue,e=c.getId(),a;if(!d.hasOwnProperty(e)){return}a=d[e];delete d[e];if(a.length>0){this.dispatchQueue(a)}},onComponentHiddenChange:function(c){var b=this.hiddenQueue,d=c.getId(),a;if(!b.hasOwnProperty(d)){return}a=b[d];delete b[d];if(a.length>0){this.dispatchQueue(a)}},dispatchQueue:function(g){var l=this.dispatcher,a=this.targetType,b=this.eventNames,e=g.slice(),f=e.length,c,k,h,d,j;g.length=0;if(f>0){for(c=0;c<f;c++){k=e[c];h=k.component;d=k.eventName;j=h.isPainted();if((d===b.painted&&j)||d===b.erased&&!j){l.doDispatchEvent(a,"#"+k.id,d,[h])}}e.length=0}},publish:function(a,k,f,j){var c=k.getId(),b=false,d,h,e,g,l;if(a[c]){d=this.eventNames;l=k.isPainted();if((f===d.painted&&!l)||f===d.erased&&l){b=true}else{return this}}if(k.isContainer){h=k.getItems().items;for(e=0,g=h.length;e<g;e++){this.publish(a,h[e],f,j)}}else{if(k.isDecorator){this.publish(a,k.getComponent(),f,j)}}if(b){j.push({id:c,eventName:f,component:k})}}},1,0,0,0,0,0,[Ext.event.publisher,"ComponentPaint"],0));(Ext.cmd.derive("Ext.event.publisher.Dom",Ext.event.publisher.Publisher,{targetType:"element",idOrClassSelectorRegex:/^([#|\.])([\w\-]+)$/,handledEvents:["focus","blur","paste","input","change","keyup","keydown","keypress","submit","transitionend","animationstart","animationend"],classNameSplitRegex:/\s+/,SELECTOR_ALL:"*",constructor:function(){var f=this.getHandledEvents(),e={},b,c,a,d;this.doBubbleEventsMap={click:true,submit:true,mousedown:true,mousemove:true,mouseup:true,mouseover:true,mouseout:true,transitionend:true};this.onEvent=Ext.Function.bind(this.onEvent,this);for(b=0,c=f.length;b<c;b++){a=f[b];d=this.getVendorEventName(a);e[d]=a;this.attachListener(d)}this.eventNameMap=e;return Ext.event.publisher.Publisher.prototype.constructor.call(this)},getSubscribers:function(a){var c=this.subscribers,b=c[a];if(!b){b=c[a]={id:{$length:0},className:{$length:0},selector:[],all:0,$length:0}}return b},getVendorEventName:function(a){if(Ext.browser.is.WebKit){if(a==="transitionend"){a=Ext.browser.getVendorProperyName("transitionEnd")}else{if(a==="animationstart"){a=Ext.browser.getVendorProperyName("animationStart")}else{if(a==="animationend"){a=Ext.browser.getVendorProperyName("animationEnd")}}}}return a},bindListeners:function(d,e){var a=this.getHandledEvents(),c=a.length,b;for(b=0;b<c;b++){this.bindListener(d,this.getVendorEventName(a[b]),e)}},bindListener:function(b,a,c){if(c){this.attachListener(a,b)}else{this.removeListener(a,b)}return this},attachListener:function(a,c){if(!c){c=document}var b=c.defaultView;if(Ext.os.is.iOS||Ext.browser.is.AndroidStock){document.addEventListener(a,this.onEvent,!this.doesEventBubble(a))}else{if(b&&b.addEventListener){c.defaultView.addEventListener(a,this.onEvent,!this.doesEventBubble(a))}else{c.addEventListener(a,this.onEvent,!this.doesEventBubble(a))}}return this},removeListener:function(a,c){if(!c){c=document}var b=c.defaultView;if((Ext.os.is.iOS&&Ext.os.version.getMajor()<5)&&Ext.browser.is.AndroidStock){document.removeEventListener(a,this.onEvent,!this.doesEventBubble(a))}else{if(b&&b.addEventListener){c.defaultView.removeEventListener(a,this.onEvent,!this.doesEventBubble(a))}else{c.removeEventListener(a,this.onEvent,!this.doesEventBubble(a))}}return this},doesEventBubble:function(a){return !!this.doBubbleEventsMap[a]},subscribe:function(g,f){if(!this.handles(f)){return false}var e=g.match(this.idOrClassSelectorRegex),a=this.getSubscribers(f),c=a.id,d=a.className,b=a.selector,h,j;if(e!==null){h=e[1];j=e[2];if(h==="#"){if(c.hasOwnProperty(j)){c[j]++;return true}c[j]=1;c.$length++}else{if(d.hasOwnProperty(j)){d[j]++;return true}d[j]=1;d.$length++}}else{if(g===this.SELECTOR_ALL){a.all++}else{if(b.hasOwnProperty(g)){b[g]++;return true}b[g]=1;b.push(g)}}a.$length++;return true},unsubscribe:function(g,f,k){if(!this.handles(f)){return false}var e=g.match(this.idOrClassSelectorRegex),a=this.getSubscribers(f),c=a.id,d=a.className,b=a.selector,h,j;k=Boolean(k);if(e!==null){h=e[1];j=e[2];if(h==="#"){if(!c.hasOwnProperty(j)||(!k&&--c[j]>0)){return true}delete c[j];c.$length--}else{if(!d.hasOwnProperty(j)||(!k&&--d[j]>0)){return true}delete d[j];d.$length--}}else{if(g===this.SELECTOR_ALL){if(k){a.all=0}else{a.all--}}else{if(!b.hasOwnProperty(g)||(!k&&--b[g]>0)){return true}delete b[g];Ext.Array.remove(b,g)}}a.$length--;return true},getElementTarget:function(a){if(a.nodeType!==1){a=a.parentNode;if(!a||a.nodeType!==1){return null}}return a},getBubblingTargets:function(b){var a=[];if(!b){return a}do{a[a.length]=b;b=b.parentNode}while(b&&b.nodeType===1);return a},dispatch:function(c,a,b){b.push(b[0].target);Ext.event.publisher.Publisher.prototype.dispatch.apply(this,arguments)},publish:function(b,a,c){var d=this.getSubscribers(b),e;if(d.$length===0||!this.doPublish(d,b,a,c)){e=this.getSubscribers("*");if(e.$length>0){this.doPublish(e,b,a,c)}}return this},doPublish:function(f,h,x,u){var r=f.id,g=f.className,b=f.selector,p=r.$length>0,a=g.$length>0,l=b.length>0,o=f.all>0,y={},e=[u],q=false,m=this.classNameSplitRegex,v,k,t,d,z,n,c,w,s;for(v=0,k=x.length;v<k;v++){z=x[v];u.setDelegatedTarget(z);if(p){n=z.getAttribute("id");if(n){if(r.hasOwnProperty(n)){q=true;this.dispatch("#"+n,h,e)}}}if(a){c=z.className;if(c){w=c.split(m);for(t=0,d=w.length;t<d;t++){c=w[t];if(!y[c]){y[c]=true;if(g.hasOwnProperty(c)){q=true;this.dispatch("."+c,h,e)}}}}}if(u.isStopped){return q}}if(o&&!q){u.setDelegatedTarget(u.browserEvent.target);q=true;this.dispatch(this.SELECTOR_ALL,h,e);if(u.isStopped){return q}}if(l){for(t=0,d=x.length;t<d;t++){z=x[t];for(v=0,k=b.length;v<k;v++){s=b[v];if(this.matchesSelector(z,s)){u.setDelegatedTarget(z);q=true;this.dispatch(s,h,e)}if(u.isStopped){return q}}}}return q},matchesSelector:function(){var b=Element.prototype,a=("webkitMatchesSelector" in b)?"webkitMatchesSelector":(("msMatchesSelector" in b)?"msMatchesSelector":("mozMatchesSelector" in b?"mozMatchesSelector":null));if(a){return function(d,c){return d[a](c)}}return function(d,c){Ext.DomQuery.is(d,c)}}(),onEvent:function(d){var b=this.eventNameMap[d.type];Ext.frameStartTime=d.timeStamp;if(!b||this.getSubscribersCount(b)===0){return}var c=this.getElementTarget(d.target),a;if(!c){return}if(this.doesEventBubble(b)){a=this.getBubblingTargets(c)}else{a=[c]}this.publish(b,a,new Ext.event.Dom(d))},getSubscribersCount:function(a){if(!this.handles(a)){return 0}return this.getSubscribers(a).$length+this.getSubscribers("*").$length}},1,0,0,0,0,0,[Ext.event.publisher,"Dom"],0));(Ext.cmd.derive("Ext.util.paintmonitor.Abstract",Ext.Base,{config:{element:null,callback:Ext.emptyFn,scope:null,args:[]},eventName:"",monitorClass:"",constructor:function(a){this.onElementPainted=Ext.Function.bind(this.onElementPainted,this);this.initConfig(a)},bindListeners:function(a){this.monitorElement[a?"addEventListener":"removeEventListener"](this.eventName,this.onElementPainted,true)},applyElement:function(a){if(a){return Ext.get(a)}},updateElement:function(a){this.monitorElement=Ext.Element.create({classList:["x-paint-monitor",this.monitorClass]},true);a.appendChild(this.monitorElement);a.addCls("x-paint-monitored");this.bindListeners(true)},onElementPainted:function(){},destroy:function(){var b=this.monitorElement,a=b.parentNode,c=this.getElement();this.bindListeners(false);delete this.monitorElement;if(c&&!c.isDestroyed){c.removeCls("x-paint-monitored");delete this._element}if(a){a.removeChild(b)}this.callSuper()}},1,0,0,0,0,0,[Ext.util.paintmonitor,"Abstract"],0));(Ext.cmd.derive("Ext.util.paintmonitor.CssAnimation",Ext.util.paintmonitor.Abstract,{eventName:Ext.browser.is.WebKit?"webkitAnimationEnd":"animationend",monitorClass:"cssanimation",onElementPainted:function(a){if(a.animationName==="x-paint-monitor-helper"){this.getCallback().apply(this.getScope(),this.getArgs())}}},0,0,0,0,0,0,[Ext.util.paintmonitor,"CssAnimation"],0));(Ext.cmd.derive("Ext.util.paintmonitor.OverflowChange",Ext.util.paintmonitor.Abstract,{eventName:Ext.browser.is.Firefox?"overflow":"overflowchanged",monitorClass:"overflowchange",onElementPainted:function(a){this.getCallback().apply(this.getScope(),this.getArgs())}},0,0,0,0,0,0,[Ext.util.paintmonitor,"OverflowChange"],0));(Ext.cmd.derive("Ext.util.PaintMonitor",Ext.Base,{constructor:function(a){if(Ext.browser.is.Firefox||(Ext.browser.is.WebKit&&Ext.browser.engineVersion.gtEq("536")&&!Ext.os.is.Blackberry)){return new Ext.util.paintmonitor.OverflowChange(a)}else{return new Ext.util.paintmonitor.CssAnimation(a)}}},1,0,0,0,0,0,[Ext.util,"PaintMonitor"],0));Ext.define("InfinityMobile.util.PaintMonitor",{override:"Ext.util.PaintMonitor",constructor:function(a){if(Ext.browser.is.Firefox||(Ext.browser.is.WebKit&&Ext.browser.engineVersion.gtEq("536")&&!Ext.browser.engineVersion.ltEq("537.36")&&!Ext.os.is.Blackberry)){return new Ext.util.paintmonitor.CssAnimation(a)}else{return new Ext.util.paintmonitor.CssAnimation(a)}}},function(){});(Ext.cmd.derive("Ext.event.publisher.ElementPaint",Ext.event.publisher.Publisher,{targetType:"element",handledEvents:["painted"],constructor:function(){this.monitors={};Ext.event.publisher.Publisher.prototype.constructor.apply(this,arguments)},subscribe:function(d){var a=d.match(this.idSelectorRegex),c=this.subscribers,e,b;if(!a){return false}e=a[1];if(c.hasOwnProperty(e)){c[e]++;return true}c[e]=1;b=Ext.get(e);this.monitors[e]=new Ext.util.PaintMonitor({element:b,callback:this.onElementPainted,scope:this,args:[d,b]});return true},unsubscribe:function(e,a,c){var b=e.match(this.idSelectorRegex),d=this.subscribers,f;if(!b){return false}f=b[1];if(!d.hasOwnProperty(f)||(!c&&--d[f]>0)){return true}delete d[f];this.monitors[f].destroy();delete this.monitors[f];return true},onElementPainted:function(b,a){Ext.TaskQueue.requestRead("dispatch",this,[b,"painted",[a]])}},1,0,0,0,0,0,[Ext.event.publisher,"ElementPaint"],0));(Ext.cmd.derive("Ext.mixin.Templatable",Ext.mixin.Mixin,{mixinConfig:{id:"templatable"},referenceAttributeName:"reference",referenceSelector:"[reference]",getElementConfig:function(){return{reference:"element"}},getElementTemplate:function(){var a=document.createDocumentFragment();a.appendChild(Ext.Element.create(this.getElementConfig(),true));return a},initElement:function(){var a=this.self.prototype;a.elementTemplate=this.getElementTemplate();a.initElement=a.doInitElement;this.initElement.apply(this,arguments)},linkElement:function(a,b){this.link(a,b)},doInitElement:function(){var g=this.referenceAttributeName,c,d,e,f,b,a;c=this.elementTemplate.cloneNode(true);d=c.querySelectorAll(this.referenceSelector);for(e=0,f=d.length;e<f;e++){b=d[e];a=b.getAttribute(g);b.removeAttribute(g);this.linkElement(a,b)}}},0,0,0,0,0,0,[Ext.mixin,"Templatable"],0));(Ext.cmd.derive("Ext.util.sizemonitor.Abstract",Ext.Base,{config:{element:null,callback:Ext.emptyFn,scope:null,args:[]},width:0,height:0,contentWidth:0,contentHeight:0,constructor:function(a){this.refresh=Ext.Function.bind(this.refresh,this);this.info={width:0,height:0,contentWidth:0,contentHeight:0,flag:0};this.initElement();this.initConfig(a);this.bindListeners(true)},bindListeners:Ext.emptyFn,applyElement:function(a){if(a){return Ext.get(a)}},updateElement:function(a){a.append(this.detectorsContainer);a.addCls("x-size-monitored")},applyArgs:function(a){return a.concat([this.info])},refreshMonitors:Ext.emptyFn,forceRefresh:function(){Ext.TaskQueue.requestRead("refresh",this)},getContentBounds:function(){return this.detectorsContainer.getBoundingClientRect()},getContentWidth:function(){return this.detectorsContainer.offsetWidth},getContentHeight:function(){return this.detectorsContainer.offsetHeight},refreshSize:function(){var d=this.getElement();if(!d||d.isDestroyed){return false}var b=d.getWidth(),k=d.getHeight(),a=this.getContentWidth(),j=this.getContentHeight(),h=this.contentWidth,f=this.contentHeight,c=this.info,e=false,g;this.width=b;this.height=k;this.contentWidth=a;this.contentHeight=j;g=((h!==a?1:0)+(f!==j?2:0));if(g>0){c.width=b;c.height=k;c.contentWidth=a;c.contentHeight=j;c.flag=g;e=true;this.getCallback().apply(this.getScope(),this.getArgs())}return e},refresh:function(a){if(this.refreshSize()||a){Ext.TaskQueue.requestWrite("refreshMonitors",this)}},destroy:function(){var a=this.getElement();this.bindListeners(false);if(a&&!a.isDestroyed){a.removeCls("x-size-monitored")}delete this._element;this.callSuper()}},1,0,0,0,0,[[Ext.mixin.Templatable.prototype.mixinId||Ext.mixin.Templatable.$className,Ext.mixin.Templatable]],[Ext.util.sizemonitor,"Abstract"],0));(Ext.cmd.derive("Ext.util.sizemonitor.Default",Ext.util.sizemonitor.Abstract,{updateElement:function(a){},bindListeners:function(b){var a=this.getElement().dom;if(!a){return}if(b){a.onresize=this.refresh}else{delete a.onresize}},getContentBounds:function(){return this.getElement().dom.getBoundingClientRect()},getContentWidth:function(){return this.getElement().getWidth()},getContentHeight:function(){return this.getElement().getHeight()}},0,0,0,0,0,0,[Ext.util.sizemonitor,"Default"],0));(Ext.cmd.derive("Ext.util.sizemonitor.Scroll",Ext.util.sizemonitor.Abstract,{getElementConfig:function(){return{reference:"detectorsContainer",classList:["x-size-monitors","scroll"],children:[{reference:"expandMonitor",className:"expand"},{reference:"shrinkMonitor",className:"shrink"}]}},constructor:function(a){this.onScroll=Ext.Function.bind(this.onScroll,this);Ext.util.sizemonitor.Abstract.prototype.constructor.apply(this,arguments)},bindListeners:function(b){var a=b?"addEventListener":"removeEventListener";this.expandMonitor[a]("scroll",this.onScroll,true);this.shrinkMonitor[a]("scroll",this.onScroll,true)},forceRefresh:function(){Ext.TaskQueue.requestRead("refresh",this,[true])},onScroll:function(){Ext.TaskQueue.requestRead("refresh",this)},refreshMonitors:function(){var b=this.expandMonitor,c=this.shrinkMonitor,a=1000000;if(b&&!b.isDestroyed){b.scrollLeft=a;b.scrollTop=a}if(c&&!c.isDestroyed){c.scrollLeft=a;c.scrollTop=a}}},1,0,0,0,0,0,[Ext.util.sizemonitor,"Scroll"],0));(Ext.cmd.derive("Ext.util.sizemonitor.OverflowChange",Ext.util.sizemonitor.Abstract,{constructor:function(a){this.onExpand=Ext.Function.bind(this.onExpand,this);this.onShrink=Ext.Function.bind(this.onShrink,this);Ext.util.sizemonitor.Abstract.prototype.constructor.apply(this,arguments)},getElementConfig:function(){return{reference:"detectorsContainer",classList:["x-size-monitors","overflowchanged"],children:[{reference:"expandMonitor",className:"expand",children:[{reference:"expandHelper"}]},{reference:"shrinkMonitor",className:"shrink",children:[{reference:"shrinkHelper"}]}]}},bindListeners:function(b){var a=b?"addEventListener":"removeEventListener";this.expandMonitor[a](Ext.browser.is.Firefox?"underflow":"overflowchanged",this.onExpand,true);this.shrinkMonitor[a](Ext.browser.is.Firefox?"overflow":"overflowchanged",this.onShrink,true)},onExpand:function(a){if(Ext.browser.is.Webkit&&a.horizontalOverflow&&a.verticalOverflow){return}Ext.TaskQueue.requestRead("refresh",this)},onShrink:function(a){if(Ext.browser.is.Webkit&&!a.horizontalOverflow&&!a.verticalOverflow){return}Ext.TaskQueue.requestRead("refresh",this)},refreshMonitors:function(){if(this.isDestroyed){return}var f=this.expandHelper,e=this.shrinkHelper,b=this.getContentBounds(),d=b.width,a=b.height,c;if(f&&!f.isDestroyed){c=f.style;c.width=(d+1)+"px";c.height=(a+1)+"px"}if(e&&!e.isDestroyed){c=e.style;c.width=d+"px";c.height=a+"px"}Ext.TaskQueue.requestRead("refresh",this)}},1,0,0,0,0,0,[Ext.util.sizemonitor,"OverflowChange"],0));(Ext.cmd.derive("Ext.util.SizeMonitor",Ext.Base,{constructor:function(a){var b=Ext.util.sizemonitor;if(Ext.browser.is.Firefox){return new b.OverflowChange(a)}else{if(Ext.browser.is.WebKit){if(!Ext.browser.is.Silk&&Ext.browser.engineVersion.gtEq("535")){return new b.OverflowChange(a)}else{return new b.Scroll(a)}}else{if(Ext.browser.is.IE11){return new b.Scroll(a)}else{return new b.Default(a)}}}}},1,0,0,0,0,0,[Ext.util,"SizeMonitor"],0));Ext.define("InfinityMobile.util.SizeMonitor",{override:"Ext.util.SizeMonitor",constructor:function(a){var b=Ext.util.sizemonitor;if(Ext.browser.is.Firefox){return new b.OverflowChange(a)}else{if(Ext.browser.is.WebKit){if(!Ext.browser.is.Silk&&Ext.browser.engineVersion.gtEq("535")&&!Ext.browser.engineVersion.ltEq("537.36")){return new b.Scroll(a)}else{return new b.Scroll(a)}}else{if(Ext.browser.is.IE11){return new b.Scroll(a)}else{return new b.Scroll(a)}}}}},function(){});(Ext.cmd.derive("Ext.event.publisher.ElementSize",Ext.event.publisher.Publisher,{targetType:"element",handledEvents:["resize"],constructor:function(){this.monitors={};Ext.event.publisher.Publisher.prototype.constructor.apply(this,arguments)},subscribe:function(e){var b=e.match(this.idSelectorRegex),d=this.subscribers,f,c,a;if(!b){return false}f=b[1];if(d.hasOwnProperty(f)){d[f]++;return true}d[f]=1;c=Ext.get(f);this.monitors[f]=a=new Ext.util.SizeMonitor({element:c,callback:this.onElementResize,scope:this,args:[e,c]});this.dispatcher.addListener("element",e,"painted","forceRefresh",a);return true},unsubscribe:function(g,a,e){var c=g.match(this.idSelectorRegex),f=this.subscribers,d=this.monitors,h,b;if(!c){return false}h=c[1];if(!f.hasOwnProperty(h)||(!e&&--f[h]>0)){return true}delete f[h];b=d[h];this.dispatcher.removeListener("element",g,"painted","forceRefresh",b);b.destroy();delete d[h];return true},onElementResize:function(c,a,b){Ext.TaskQueue.requestRead("dispatch",this,[c,"resize",[a,b]])}},1,0,0,0,0,0,[Ext.event.publisher,"ElementSize"],0));(Ext.cmd.derive("Ext.event.publisher.TouchGesture",Ext.event.publisher.Dom,{isNotPreventable:/^(select|a)$/i,handledEvents:["touchstart","touchmove","touchend","touchcancel"],mouseToTouchMap:{mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},lastEventType:null,config:{moveThrottle:0,recognizers:{}},constructor:function(a){var b=this;this.eventProcessors={touchstart:this.onTouchStart,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchEnd};this.eventToRecognizerMap={};this.activeRecognizers=[];this.touchesMap={};this.currentIdentifiers=[];if(Ext.browser.is.Chrome&&Ext.os.is.Android){this.screenPositionRatio=Ext.browser.version.gt("18")?1:1/window.devicePixelRatio}else{if(Ext.browser.is.AndroidStock4){this.screenPositionRatio=1}else{if(Ext.os.is.BlackBerry){this.screenPositionRatio=1/window.devicePixelRatio}else{if(Ext.browser.engineName=="WebKit"&&Ext.os.is.Desktop){this.screenPositionRatio=1}else{this.screenPositionRatio=window.innerWidth/window.screen.width}}}}this.initConfig(a);if(Ext.feature.has.Touch){b.onTargetTouchMove=b.onTargetTouchMove.bind(b);b.onTargetTouchEnd=b.onTargetTouchEnd.bind(b)}return Ext.event.publisher.Dom.prototype.constructor.call(this)},applyRecognizers:function(b){var c,a;for(c in b){if(b.hasOwnProperty(c)){a=b[c];if(a){this.registerRecognizer(a)}}}return b},handles:function(a){return Ext.event.publisher.Dom.prototype.handles.apply(this,arguments)||this.eventToRecognizerMap.hasOwnProperty(a)},doesEventBubble:function(){return true},onEvent:function(f){var d=f.type,b=this.lastEventType,c=[f];if(this.eventProcessors[d]){this.eventProcessors[d].call(this,f);if(d==="touchend"&&b&&b==="touchstart"){f.preventDefault()}this.lastEventType=d;return}if("button" in f&&f.button>0){return}else{if(d==="mousedown"&&b&&b!=="mouseup"){var a=document.createEvent("MouseEvent");a.initMouseEvent("mouseup",f.bubbles,f.cancelable,document.defaultView,f.detail,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.metaKey,f.button,f.relatedTarget);this.onEvent(a)}if(d!=="mousemove"){this.lastEventType=d}f.identifier=1;f.touches=(d!=="mouseup")?c:[];f.targetTouches=(d!=="mouseup")?c:[];f.changedTouches=c;this.eventProcessors[this.mouseToTouchMap[d]].call(this,f)}},registerRecognizer:function(a){var g=this.eventToRecognizerMap,e=this.activeRecognizers,c=a.getHandledEvents(),d,f,b;a.setOnRecognized(this.onRecognized);a.setCallbackScope(this);for(d=0,f=c.length;d<f;d++){b=c[d];g[b]=a}e.push(a);return this},onRecognized:function(f,h,d,a){var k=[],j=d.length,g,c,b;if(j===1){return this.publish(f,d[0].targets,h,a)}for(c=0;c<j;c++){b=d[c];k.push(b.targets)}g=this.getCommonTargets(k);this.publish(f,g,h,a)},publish:function(b,a,c,d){c.set(d);return Ext.event.publisher.Dom.prototype.publish.call(this,b,a,c)},getCommonTargets:function(a){var h=a[0],f=a.length;if(f===1){return h}var d=[],e=1,g,b,c;while(true){g=h[h.length-e];if(!g){return d}for(c=1;c<f;c++){b=a[c];if(b[b.length-e]!==g){return d}}d.unshift(g);e++}return d},invokeRecognizers:function(c,g){var b=this.activeRecognizers,f=b.length,d,a;if(c==="onStart"){for(d=0;d<f;d++){b[d].isActive=true}}for(d=0;d<f;d++){a=b[d];if(a.isActive&&a[c].call(a,g)===false){a.isActive=false}}},getActiveRecognizers:function(){return this.activeRecognizers},updateTouch:function(f){var b=f.identifier,d=this.touchesMap[b],c,a,e;if(!d){c=this.getElementTarget(f.target);this.touchesMap[b]=d={identifier:b,target:c,targets:this.getBubblingTargets(c)};this.currentIdentifiers.push(b)}a=f.pageX;e=f.pageY;if(a===d.pageX&&e===d.pageY){return false}d.pageX=a;d.pageY=e;d.timeStamp=f.timeStamp;d.point=new Ext.util.Point(a,e);return d},updateTouches:function(d){var a,c,e,b=[];for(a=0,c=d.length;a<c;a++){e=this.updateTouch(d[a]);if(e){b.push(e)}}return b},factoryEvent:function(a){return new Ext.event.Touch(a,null,this.touchesMap,this.currentIdentifiers)},onTouchStart:function(f){var k=f.changedTouches,g=f.target,h=k.length,a=this.isNotPreventable,b=(f.type==="touchstart"),j=this,d,c,l;this.updateTouches(k);f=this.factoryEvent(f);k=f.changedTouches;if(Ext.browser.is.AndroidStock&&this.currentIdentifiers.length>=2){f.preventDefault()}if(b){g.addEventListener("touchmove",j.onTargetTouchMove);g.addEventListener("touchend",j.onTargetTouchEnd);g.addEventListener("touchcancel",j.onTargetTouchEnd)}for(d=0;d<h;d++){c=k[d];this.publish("touchstart",c.targets,f,{touch:c})}if(!this.isStarted){this.isStarted=true;this.invokeRecognizers("onStart",f)}this.invokeRecognizers("onTouchStart",f);l=g.parentNode||{}},onTouchMove:function(a){if(!this.isStarted){return}if(!this.animationQueued){this.animationQueued=true;Ext.AnimationQueue.start("onAnimationFrame",this)}this.lastMoveEvent=a},onAnimationFrame:function(){var a=this.lastMoveEvent;if(a){this.lastMoveEvent=null;this.doTouchMove(a)}},doTouchMove:function(d){var b,a,c,f;b=this.updateTouches(d.changedTouches);c=b.length;d=this.factoryEvent(d);for(a=0;a<c;a++){f=b[a];this.publish("touchmove",f.targets,d,{touch:f})}if(c>0){this.invokeRecognizers("onTouchMove",d)}},onTouchEnd:function(h){if(!this.isStarted){return}if(this.lastMoveEvent){this.onAnimationFrame()}var a=this.touchesMap,d=this.currentIdentifiers,f=h.changedTouches,g=f.length,b,c,j;this.updateTouches(f);f=h.changedTouches;for(c=0;c<g;c++){Ext.Array.remove(d,f[c].identifier)}h=this.factoryEvent(h);for(c=0;c<g;c++){b=f[c].identifier;j=a[b];delete a[b];this.publish("touchend",j.targets,h,{touch:j})}this.invokeRecognizers("onTouchEnd",h);if(h.touches.length===0&&d.length){d.length=0;this.touchesMap={}}if(d.length===0){this.isStarted=false;this.invokeRecognizers("onEnd",h);if(this.animationQueued){this.animationQueued=false;Ext.AnimationQueue.stop("onAnimationFrame",this)}}},onTargetTouchMove:function(a){if(!Ext.getBody().contains(a.target)){this.onTouchMove(a)}},onTargetTouchEnd:function(d){var b=this,c=d.target,a=0,f;for(identifier in this.touchesMap){f=this.touchesMap[identifier].target;if(f===c){a++}}if(a<=1){c.removeEventListener("touchmove",b.onTargetTouchMove);c.removeEventListener("touchend",b.onTargetTouchEnd);c.removeEventListener("touchcancel",b.onTargetTouchEnd)}if(!Ext.getBody().contains(c)){b.onTouchEnd(d)}}},1,0,0,0,0,0,[Ext.event.publisher,"TouchGesture"],function(){if(Ext.feature.has.Pointer){this.override({pointerToTouchMap:{MSPointerDown:"touchstart",MSPointerMove:"touchmove",MSPointerUp:"touchend",MSPointerCancel:"touchcancel",pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"},touchToPointerMapEdge:{touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},touchToPointerMap:{touchstart:"MSPointerDown",touchmove:"MSPointerMove",touchend:"MSPointerUp",touchcancel:"MSPointerCancel"},attachListener:function(a,b){if(navigator.appVersion.indexOf("Edge")!=-1){a=this.touchToPointerMapEdge[a]}else{a=this.touchToPointerMap[a]}if(!a){return}return this.callOverridden([a,b])},onEvent:function(b){var a=b.type;if(this.currentIdentifiers.length===0&&(b.pointerType===b.MSPOINTER_TYPE_TOUCH||b.pointerType==="touch")&&(a==="MSPointerMove"||a==="pointermove")){a="MSPointerDown"}if("button" in b&&b.button>0){return}a=this.pointerToTouchMap[a];b.identifier=b.pointerId;b.changedTouches=[b];this.eventProcessors[a].call(this,b)}})}else{if(!Ext.browser.is.Ripple&&(Ext.os.is.ChromeOS||!Ext.feature.has.Touch)){this.override({handledEvents:["touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup"]})}}}));(Ext.cmd.derive("Ext.event.recognizer.Recognizer",Ext.Base,{handledEvents:[],config:{onRecognized:Ext.emptyFn,onFailed:Ext.emptyFn,callbackScope:null},constructor:function(a){this.initConfig(a);return this},getHandledEvents:function(){return this.handledEvents},onStart:Ext.emptyFn,onEnd:Ext.emptyFn,fail:function(){this.getOnFailed().apply(this.getCallbackScope(),arguments);return false},fire:function(){this.getOnRecognized().apply(this.getCallbackScope(),arguments)}},1,0,0,0,0,[[Ext.mixin.Identifiable.prototype.mixinId||Ext.mixin.Identifiable.$className,Ext.mixin.Identifiable]],[Ext.event.recognizer,"Recognizer"],0));(Ext.cmd.derive("Ext.event.recognizer.Touch",Ext.event.recognizer.Recognizer,{onTouchStart:Ext.emptyFn,onTouchMove:Ext.emptyFn,onTouchEnd:Ext.emptyFn},0,0,0,0,0,0,[Ext.event.recognizer,"Touch"],0));(Ext.cmd.derive("Ext.event.recognizer.SingleTouch",Ext.event.recognizer.Touch,{inheritableStatics:{NOT_SINGLE_TOUCH:1,TOUCH_MOVED:2},onTouchStart:function(a){if(a.touches.length>1){return this.fail(this.self.NOT_SINGLE_TOUCH)}}},0,0,0,0,0,0,[Ext.event.recognizer,"SingleTouch"],0));(Ext.cmd.derive("Ext.event.recognizer.DoubleTap",Ext.event.recognizer.SingleTouch,{inheritableStatics:{DIFFERENT_TARGET:3},config:{maxDuration:300,moveDistance:15},handledEvents:["singletap","doubletap"],singleTapTimer:null,startTime:0,lastTapTime:0,onTouchStart:function(a){if(Ext.event.recognizer.SingleTouch.prototype.onTouchStart.apply(this,arguments)===false){return false}this.startTime=a.time;this.startPoint=a.changedTouches[0].point;clearTimeout(this.singleTapTimer)},onTouchMove:function(b){var c=b.changedTouches[0],a=c.point;if(Math.abs(a.getDistanceTo(this.startPoint))>=this.getMoveDistance()){return this.fail(this.self.TOUCH_MOVED)}},onEnd:function(g){var j=this,d=this.getMaxDuration(),f=g.changedTouches[0],a=g.time,h=g.target,k=this.lastTapTime,b=this.lastTarget,c;this.lastTapTime=a;this.lastTarget=h;if(k){c=a-k;if(c<=d){if(h!==b){return this.fail(this.self.DIFFERENT_TARGET)}this.lastTarget=null;this.lastTapTime=0;this.fire("doubletap",g,[f],{touch:f,duration:c});return}}if(a-this.startTime>d){this.fireSingleTap(g,f)}else{this.singleTapTimer=setTimeout(function(){j.fireSingleTap(g,f)},d)}},fireSingleTap:function(a,b){this.fire("singletap",a,[b],{touch:b})}},0,0,0,0,0,0,[Ext.event.recognizer,"DoubleTap"],0));(Ext.cmd.derive("Ext.event.recognizer.Drag",Ext.event.recognizer.SingleTouch,{isStarted:false,startPoint:null,previousPoint:null,lastPoint:null,handledEvents:["dragstart","drag","dragend"],config:{minDistance:8},constructor:function(){Ext.event.recognizer.SingleTouch.prototype.constructor.apply(this,arguments);this.info={touch:null,previous:{x:0,y:0},x:0,y:0,delta:{x:0,y:0},absDelta:{x:0,y:0},flick:{velocity:{x:0,y:0}},direction:{x:0,y:0},time:0,previousTime:{x:0,y:0}}},onTouchStart:function(a){if(Ext.event.recognizer.SingleTouch.prototype.onTouchStart.apply(this,arguments)===false){if(this.isStarted&&this.lastMoveEvent!==null){this.lastMoveEvent.isStopped=false;this.onTouchEnd(this.lastMoveEvent)}return false}this.startTime=a.time;this.startPoint=a.changedTouches[0].point},tryDragStart:function(f){var b=this.startPoint,d=f.changedTouches,h=d[0],a=h.point,g=this.getMinDistance(),c=this.info;if(Math.abs(a.getDistanceTo(b))>=g){this.isStarted=true;this.previousPoint=this.lastPoint=a;this.resetInfo("x",f,h);this.resetInfo("y",f,h);c.time=f.time;this.fire("dragstart",f,d,c)}},onTouchMove:function(c){if(!this.isStarted){this.tryDragStart(c)}if(!this.isStarted){return}var b=c.changedTouches,d=b[0],a=d.point;if(this.lastPoint){this.previousPoint=this.lastPoint}this.lastPoint=a;this.lastMoveEvent=c;this.updateInfo("x",c,d,true);this.updateInfo("y",c,d,true);this.info.time=c.time;this.fire("drag",c,b,this.info)},onAxisDragEnd:function(a,c){var b=c.time-c.previousTime[a];if(b>0){c.flick.velocity[a]=(c[a]-c.previous[a])/b}},resetInfo:function(c,g,j){var d=this.lastPoint[c],b=this.startPoint[c],h=d-b,a=c.toUpperCase(),f=this.info;f.touch=j;f.delta[c]=h;f.absDelta[c]=Math.abs(h);f.previousTime[c]=this.startTime;f.previous[c]=b;f[c]=d;f.direction[c]=0;f["start"+a]=this.startPoint[c];f["previous"+a]=f.previous[c];f["page"+a]=f[c];f["delta"+a]=f.delta[c];f["absDelta"+a]=f.absDelta[c];f["previousDelta"+a]=0;f.startTime=this.startTime},updateInfo:function(f,l,k,m){var d=l.time,o=this.lastPoint[f],g=this.previousPoint[f],a=this.startPoint[f],p=o-a,c=this.info,n=c.direction,j=f.toUpperCase(),b=c.previous[f],h;c.touch=k;h=c.delta[f];c.delta[f]=p;c.absDelta[f]=Math.abs(p);if(m&&o!==b&&o!==c[f]&&d-c.previousTime[f]>=50){c.previous[f]=c[f];c.previousTime[f]=c.time}c[f]=o;if(o>g){n[f]=1}else{if(o<g){n[f]=-1}}c["start"+j]=this.startPoint[f];c["previous"+j]=c.previous[f];c["page"+j]=c[f];c["delta"+j]=c.delta[f];c["absDelta"+j]=c.absDelta[f];c["previousDelta"+j]=h;c.startTime=this.startTime},onTouchEnd:function(d){if(!this.isStarted){this.tryDragStart(d)}if(this.isStarted){var c=d.changedTouches,f=c[0],a=f.point,b=this.info;this.isStarted=false;this.lastPoint=a;this.updateInfo("x",d,f);this.updateInfo("y",d,f);b.time=d.time;this.onAxisDragEnd("x",b);this.onAxisDragEnd("y",b);this.fire("dragend",d,c,b);this.startPoint=null;this.previousPoint=null;this.lastPoint=null;this.lastMoveEvent=null}}},1,0,0,0,0,0,[Ext.event.recognizer,"Drag"],0));(Ext.cmd.derive("Ext.event.recognizer.Swipe",Ext.event.recognizer.SingleTouch,{handledEvents:["swipestart","swipe"],inheritableStatics:{MAX_OFFSET_EXCEEDED:16,MAX_DURATION_EXCEEDED:17,DISTANCE_NOT_ENOUGH:18},config:{minDistance:80,maxOffset:35,maxDuration:1000},onTouchStart:function(a){if(Ext.event.recognizer.SingleTouch.prototype.onTouchStart.apply(this,arguments)===false){return false}var b=a.changedTouches[0];this.startTime=a.time;this.isHorizontal=true;this.isVertical=true;this.startX=b.pageX;this.startY=b.pageY},onTouchMove:function(k){var j=k.changedTouches[0],n=j.pageX,l=j.pageY,h=n-this.startX,g=l-this.startY,d=Math.abs(n-this.startX),c=Math.abs(l-this.startY),f=k.time-this.startTime,o=this.getMinDistance(),b=k.time,m,a;if(b-this.startTime>this.getMaxDuration()){return this.fail(this.self.MAX_DURATION_EXCEEDED)}if(this.isHorizontal&&c>this.getMaxOffset()){this.isHorizontal=false}if(this.isVertical&&d>this.getMaxOffset()){this.isVertical=false}if(!this.isVertical||!this.isHorizontal){if(this.isHorizontal&&d<o){m=(h<0)?"left":"right";a=d}else{if(this.isVertical&&c<o){m=(g<0)?"up":"down";a=c}}}if(m&&!this.started){this.started=true;this.fire("swipestart",k,[j],{touch:j,direction:m,distance:a,duration:f})}if(!this.isHorizontal&&!this.isVertical){return this.fail(this.self.MAX_OFFSET_EXCEEDED)}},onTouchEnd:function(j){if(this.onTouchMove(j)===false){return false}var h=j.changedTouches[0],m=h.pageX,k=h.pageY,g=m-this.startX,f=k-this.startY,c=Math.abs(g),b=Math.abs(f),n=this.getMinDistance(),d=j.time-this.startTime,l,a;if(this.isVertical&&b<n){this.isVertical=false}if(this.isHorizontal&&c<n){this.isHorizontal=false}if(this.isHorizontal){l=(g<0)?"left":"right";a=c}else{if(this.isVertical){l=(f<0)?"up":"down";a=b}else{return this.fail(this.self.DISTANCE_NOT_ENOUGH)}}this.started=false;this.fire("swipe",j,[h],{touch:h,direction:l,distance:a,duration:d})}},0,0,0,0,0,0,[Ext.event.recognizer,"Swipe"],0));(Ext.cmd.derive("Ext.event.recognizer.EdgeSwipe",Ext.event.recognizer.Swipe,{handledEvents:["edgeswipe","edgeswipestart","edgeswipeend"],inheritableStatics:{NOT_NEAR_EDGE:19},config:{minDistance:60},onTouchStart:function(a){if(Ext.event.recognizer.Swipe.prototype.onTouchStart.apply(this,arguments)===false){return false}var b=a.changedTouches[0];this.started=false;this.direction=null;this.isHorizontal=true;this.isVertical=true;this.startX=b.pageX;this.startY=b.pageY},onTouchMove:function(l){var j=l.changedTouches[0],p=j.pageX,m=j.pageY,h=p-this.startX,g=m-this.startY,b=Math.abs(m-this.startY),c=Math.abs(p-this.startX),q=this.getMinDistance(),f=this.getMaxOffset(),d=l.time-this.startTime,o=Ext.Viewport&&Ext.Viewport.element.getWidth(),k=Ext.Viewport&&Ext.Viewport.element.getHeight(),n,a;if(this.isVertical&&c>f){this.isVertical=false}if(this.isHorizontal&&b>f){this.isHorizontal=false}if(this.isVertical&&this.isHorizontal){if(b>c){this.isHorizontal=false}else{this.isVertical=false}}if(this.isHorizontal){n=(h<0)?"left":"right";a=h}else{if(this.isVertical){n=(g<0)?"up":"down";a=g}}this.direction=this.direction||n;if(this.direction=="up"){a=g*-1}else{if(this.direction=="left"){a=h*-1}}this.distance=a;if(a==0){return this.fail(this.self.DISTANCE_NOT_ENOUGH)}if(!this.started){if(this.direction=="right"&&this.startX>q){return this.fail(this.self.NOT_NEAR_EDGE)}else{if(this.direction=="down"&&this.startY>q){return this.fail(this.self.NOT_NEAR_EDGE)}else{if(this.direction=="left"&&(o-this.startX)>q){return this.fail(this.self.NOT_NEAR_EDGE)}else{if(this.direction=="up"&&(k-this.startY)>q){return this.fail(this.self.NOT_NEAR_EDGE)}}}}this.started=true;this.startTime=l.time;this.fire("edgeswipestart",l,[j],{touch:j,direction:this.direction,distance:this.distance,duration:d})}else{this.fire("edgeswipe",l,[j],{touch:j,direction:this.direction,distance:this.distance,duration:d})}},onTouchEnd:function(b){if(this.onTouchMove(b)!==false){var c=b.changedTouches[0],a=b.time-this.startTime;this.fire("edgeswipeend",b,[c],{touch:c,direction:this.direction,distance:this.distance,duration:a})}}},0,0,0,0,0,0,[Ext.event.recognizer,"EdgeSwipe"],0));(Ext.cmd.derive("Ext.event.recognizer.LongPress",Ext.event.recognizer.SingleTouch,{inheritableStatics:{DURATION_NOT_ENOUGH:32},config:{minDuration:1000},handledEvents:["longpress"],fireLongPress:function(a){var b=a.changedTouches[0];this.fire("longpress",a,[b],{touch:b,duration:this.getMinDuration()});this.isLongPress=true},onTouchStart:function(b){var a=this;if(Ext.event.recognizer.SingleTouch.prototype.onTouchStart.apply(this,arguments)===false){return false}this.isLongPress=false;this.timer=setTimeout(function(){a.fireLongPress(b)},this.getMinDuration())},onTouchMove:function(){return this.fail(this.self.TOUCH_MOVED)},onTouchEnd:function(){if(!this.isLongPress){return this.fail(this.self.DURATION_NOT_ENOUGH)}},fail:function(){clearTimeout(this.timer);return Ext.event.recognizer.SingleTouch.prototype.fail.apply(this,arguments)}},0,0,0,0,0,0,[Ext.event.recognizer,"LongPress"],function(){this.override({handledEvents:["longpress","taphold"],fire:function(a){if(a==="longpress"){var b=Array.prototype.slice.call(arguments);b[0]="taphold";this.fire.apply(this,b)}return this.callOverridden(arguments)}})}));(Ext.cmd.derive("Ext.event.recognizer.MultiTouch",Ext.event.recognizer.Touch,{requiredTouchesCount:2,isTracking:false,isStarted:false,onTouchStart:function(d){var a=this.requiredTouchesCount,c=d.touches,b=c.length;if(b===a){this.start(d)}else{if(b>a){this.end(d)}}},onTouchEnd:function(a){this.end(a)},start:function(){if(!this.isTracking){this.isTracking=true;this.isStarted=false}},end:function(a){if(this.isTracking){this.isTracking=false;if(this.isStarted){this.isStarted=false;this.fireEnd(a)}}}},0,0,0,0,0,0,[Ext.event.recognizer,"MultiTouch"],0));(Ext.cmd.derive("Ext.event.recognizer.Pinch",Ext.event.recognizer.MultiTouch,{requiredTouchesCount:2,handledEvents:["pinchstart","pinch","pinchend"],startDistance:0,lastTouches:null,onTouchMove:function(c){if(!this.isTracking){return}var b=Array.prototype.slice.call(c.touches),d,a,f;d=b[0].point;a=b[1].point;f=d.getDistanceTo(a);if(f===0){return}if(!this.isStarted){this.isStarted=true;this.startDistance=f;this.fire("pinchstart",c,b,{touches:b,distance:f,scale:1})}else{this.fire("pinch",c,b,{touches:b,distance:f,scale:f/this.startDistance})}this.lastTouches=b},fireEnd:function(a){this.fire("pinchend",a,this.lastTouches)},fail:function(){return Ext.event.recognizer.MultiTouch.prototype.fail.apply(this,arguments)}},0,0,0,0,0,0,[Ext.event.recognizer,"Pinch"],0));(Ext.cmd.derive("Ext.event.recognizer.Rotate",Ext.event.recognizer.MultiTouch,{requiredTouchesCount:2,handledEvents:["rotatestart","rotate","rotateend"],startAngle:0,lastTouches:null,lastAngle:null,onTouchMove:function(h){if(!this.isTracking){return}var g=Array.prototype.slice.call(h.touches),b=this.lastAngle,d,f,c,a,j,k;d=g[0].point;f=g[1].point;c=d.getAngleTo(f);if(b!==null){k=Math.abs(b-c);a=c+360;j=c-360;if(Math.abs(a-b)<k){c=a}else{if(Math.abs(j-b)<k){c=j}}}this.lastAngle=c;if(!this.isStarted){this.isStarted=true;this.startAngle=c;this.fire("rotatestart",h,g,{touches:g,angle:c,rotation:0})}else{this.fire("rotate",h,g,{touches:g,angle:c,rotation:c-this.startAngle})}this.lastTouches=g},fireEnd:function(a){this.lastAngle=null;this.fire("rotateend",a,this.lastTouches)}},0,0,0,0,0,0,[Ext.event.recognizer,"Rotate"],0));(Ext.cmd.derive("Ext.event.recognizer.Tap",Ext.event.recognizer.SingleTouch,{handledEvents:["tap","tapcancel"],config:{moveDistance:15},onTouchStart:function(a){if(Ext.event.recognizer.SingleTouch.prototype.onTouchStart.apply(this,arguments)===false){return false}this.startPoint=a.changedTouches[0].point},onTouchMove:function(b){var c=b.changedTouches[0],a=c.point;if(Math.abs(a.getDistanceTo(this.startPoint))>=this.getMoveDistance()){this.fire("tapcancel",b,[c],{touch:c});return this.fail(this.self.TOUCH_MOVED)}},onTouchEnd:function(a){var b=a.changedTouches[0];this.fire("tap",a,[b],{touch:b})}},0,0,0,0,0,0,[Ext.event.recognizer,"Tap"],0));(Ext.cmd.derive("Ext.slider.Thumb",Ext.Component,{config:{baseCls:"x-thumb",pressedCls:"x-thumb-pressing",draggable:{direction:"horizontal"}},platformConfig:[{platform:["ie10"],draggable:{translatable:{translationMethod:"csstransform"}}}],elementWidth:0,initialize:function(){Ext.Component.prototype.initialize.call(this);this.getDraggable().onBefore({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",scope:this});this.getDraggable().on({touchstart:"onPress",touchend:"onRelease",scope:this});this.element.on("resize","onElementResize",this)},getTemplate:function(){if(Ext.theme.is.Blackberry){return[{tag:"div",className:"x-thumb-inner",reference:"innerElement"}]}else{return this.template}},updatePressedCls:function(b,c){var a=this.element;if(a.hasCls(c)){a.replaceCls(c,b)}},onPress:function(){var c=this,a=c.element,b=c.getPressedCls();if(!c.getDisabled()){a.addCls(b)}},onRelease:function(a){this.fireAction("release",[this,a],"doRelease")},doRelease:function(a,b){if(!a.getDisabled()){a.element.removeCls(a.getPressedCls())}},onDragStart:function(){if(this.isDisabled()){return false}this.relayEvent(arguments)},onDrag:function(){if(this.isDisabled()){return false}this.relayEvent(arguments)},onDragEnd:function(){if(this.isDisabled()){return false}this.relayEvent(arguments)},onElementResize:function(a,b){this.elementWidth=b.width},getElementWidth:function(){return this.elementWidth}},0,["thumb"],["component","thumb"],{component:true,thumb:true},["widget.thumb"],0,[Ext.slider,"Thumb"],0));(Ext.cmd.derive("Ext.slider.Slider",Ext.Container,{config:{baseCls:"x-slider",thumbConfig:{draggable:{translatable:{easingX:{duration:300,type:"ease-out"}}}},increment:1,value:0,minValue:0,maxValue:100,allowThumbsOverlapping:false,animation:true,readOnly:false},elementWidth:0,offsetValueRatio:0,activeThumb:null,constructor:function(a){a=a||{};if(a.hasOwnProperty("values")){a.value=a.values}Ext.Container.prototype.constructor.call(this,a)},initialize:function(){var b=this.element;Ext.Container.prototype.initialize.call(this);b.on({scope:this,tap:"onTap",resize:"onResize"});this.on({scope:this,delegate:"> thumb",tap:"onTap",dragstart:"onThumbDragStart",drag:"onThumbDrag",dragend:"onThumbDragEnd"});var a=this.getThumb(0);if(a){a.on("resize","onThumbResize",this)}},factoryThumb:function(){return Ext.factory(this.getThumbConfig(),Ext.slider.Thumb)},getThumbs:function(){return this.innerItems},getThumb:function(a){if(typeof a!="number"){a=0}return this.innerItems[a]},refreshOffsetValueRatio:function(){var b=this.getMaxValue()-this.getMinValue(),a=this.elementWidth-this.thumbWidth;this.offsetValueRatio=a/b},onThumbResize:function(){var a=this.getThumb(0);if(a){this.thumbWidth=a.getElementWidth()}this.refresh()},onResize:function(a,b){this.elementWidth=b.width;this.refresh()},refresh:function(){this.refreshValue()},setActiveThumb:function(b){var a=this.activeThumb;if(a&&a!==b){a.setZIndex(null)}this.activeThumb=b;b.setZIndex(2);return this},onThumbDragStart:function(a,b){if(b.absDeltaX<=b.absDeltaY||this.getReadOnly()){return false}else{b.stopPropagation()}if(this.getAllowThumbsOverlapping()){this.setActiveThumb(a)}this.dragStartValue=this.getValue()[this.getThumbIndex(a)];this.fireEvent("dragstart",this,a,this.dragStartValue,b)},onThumbDrag:function(c,g,a){var d=this.getThumbIndex(c),f=this.offsetValueRatio,b=this.constrainValue(this.getMinValue()+a/f);g.stopPropagation();this.setIndexValue(d,b);this.fireEvent("drag",this,c,this.getValue(),g);return false},setIndexValue:function(d,f,b){var a=this.getThumb(d),h=this.getValue(),e=this.getMinValue(),c=this.offsetValueRatio,g=this.getIncrement(),j=a.getDraggable();j.setOffset((f-e)*c,null,b);h[d]=e+Math.round((j.offset.x/c)/g)*g},onThumbDragEnd:function(a,f){this.refreshThumbConstraints(a);var c=this.getThumbIndex(a),d=this.getValue()[c],b=this.dragStartValue;this.fireEvent("dragend",this,a,this.getValue(),f);if(b!==d){this.fireEvent("change",this,a,d,b)}},getThumbIndex:function(a){return this.getThumbs().indexOf(a)},refreshThumbConstraints:function(d){var b=this.getAllowThumbsOverlapping(),a=d.getDraggable().getOffset().x,c=this.getThumbs(),e=this.getThumbIndex(d),g=c[e-1],h=c[e+1],f=this.thumbWidth;if(g){g.getDraggable().addExtraConstraint({max:{x:a-((b)?0:f)}})}if(h){h.getDraggable().addExtraConstraint({min:{x:a+((b)?0:f)}})}},onTap:function(j){if(this.isDisabled()||this.getReadOnly()){return}var k=Ext.get(j.target);if(!k||(Ext.browser.engineName=="WebKit"&&k.hasCls("x-thumb"))){return}var n=j.touch.point.x,h=this.element,c=h.getX(),d=n-c-(this.thumbWidth/2),o=this.constrainValue(this.getMinValue()+d/this.offsetValueRatio),r=this.getValue(),q=Infinity,m=r.length,g,f,l,p,b,a;if(m===1){p=0}else{for(g=0;g<m;g++){l=r[g];f=Math.abs(l-o);if(f<q){q=f;p=g}}}b=r[p];a=this.getThumb(p);this.setIndexValue(p,o,this.getAnimation());this.refreshThumbConstraints(a);if(b!==o){this.fireEvent("change",this,a,o,b)}},updateThumbs:function(a){this.add(a)},applyValue:function(g){var d=Ext.Array.from(g||0),b=[],c=this.getMinValue(),a,e,f;for(e=0,f=d.length;e<f;e++){a=this.constrainValue(d[e]);if(a<c){a=c}b.push(a);c=a}return b},updateValue:function(f,b){var a=this.getThumbs(),d=f.length,e=this.getMinValue(),g=this.offsetValueRatio,c;this.setThumbsCount(d);for(c=0;c<d;c++){a[c].getDraggable().setExtraConstraint(null).setOffset((f[c]-e)*g)}for(c=0;c<d;c++){this.refreshThumbConstraints(a[c])}},refreshValue:function(){this.refreshOffsetValueRatio();this.setValue(this.getValue())},constrainValue:function(e){var b=this,d=b.getMinValue(),f=b.getMaxValue(),a=b.getIncrement(),c;e=parseFloat(e);if(isNaN(e)){e=d}c=(e-d)%a;e-=c;if(Math.abs(c)>=(a/2)){e+=(c>0)?a:-a}e=Math.max(d,e);e=Math.min(f,e);return e},setThumbsCount:function(e){var a=this.getThumbs(),f=a.length,c,d,b;if(f>e){for(c=0,d=f-e;c<d;c++){b=a[a.length-1];b.destroy()}}else{if(f<e){for(c=0,d=e-f;c<d;c++){this.add(this.factoryThumb())}}}return this},setValues:function(a){this.setValue(a)},getValues:function(){return this.getValue()},applyIncrement:function(a){if(a===0){a=1}return Math.abs(a)},updateAllowThumbsOverlapping:function(b,a){if(typeof a!="undefined"){this.refreshValue()}},updateMinValue:function(b,a){if(typeof a!="undefined"){this.refreshValue()}},updateMaxValue:function(b,a){if(typeof a!="undefined"){this.refreshValue()}},updateIncrement:function(b,a){if(typeof a!="undefined"){this.refreshValue()}},doSetDisabled:function(c){Ext.Container.prototype.doSetDisabled.apply(this,arguments);var a=this.getItems().items,d=a.length,b;for(b=0;b<d;b++){a[b].setDisabled(c)}}},1,["slider"],["component","container","slider"],{component:true,container:true,slider:true},["widget.slider"],0,[Ext.slider,"Slider"],function(){}));(Ext.cmd.derive("Ext.field.Slider",Ext.field.Field,{alternateClassName:"Ext.form.Slider",config:{cls:"x-slider-field",tabIndex:-1,readOnly:false},proxyConfig:{increment:1,value:0,minValue:0,maxValue:100},constructor:function(a){a=a||{};if(a.hasOwnProperty("values")){a.value=a.values}Ext.field.Field.prototype.constructor.call(this,a);this.updateMultipleState()},initialize:function(){Ext.field.Field.prototype.initialize.call(this);this.getComponent().on({scope:this,change:"onSliderChange",dragstart:"onSliderDragStart",drag:"onSliderDrag",dragend:"onSliderDragEnd"})},applyComponent:function(a){return Ext.factory(a,Ext.slider.Slider)},updateComponent:function(a){Ext.field.Field.prototype.updateComponent.apply(this,arguments);a.setMinValue(this.getMinValue());a.setMaxValue(this.getMaxValue())},onSliderChange:function(){this.fireEvent.apply(this,[].concat("change",this,Array.prototype.slice.call(arguments)))},onSliderDragStart:function(){this.fireEvent.apply(this,[].concat("dragstart",this,Array.prototype.slice.call(arguments)))},onSliderDrag:function(){this.fireEvent.apply(this,[].concat("drag",this,Array.prototype.slice.call(arguments)))},onSliderDragEnd:function(){this.fireEvent.apply(this,[].concat("dragend",this,Array.prototype.slice.call(arguments)))},setValues:function(a){this.setValue(a);this.updateMultipleState()},getValues:function(){return this.getValue()},reset:function(){var b=this.config,a=(this.config.hasOwnProperty("values"))?b.values:b.value;this.setValue(a)},doSetDisabled:function(a){Ext.field.Field.prototype.doSetDisabled.apply(this,arguments);this.getComponent().setDisabled(a)},updateReadOnly:function(a){this.getComponent().setReadOnly(a)},isDirty:function(){if(this.getDisabled()){return false}return this.getValue()!==this.originalValue},updateMultipleState:function(){var a=this.getValue();if(a&&a.length>1){this.addCls("x-slider-multiple")}}},1,["sliderfield"],["component","field","sliderfield"],{component:true,field:true,sliderfield:true},["widget.sliderfield"],0,[Ext.field,"Slider",Ext.form,"Slider"],0));(Ext.cmd.derive("Ext.slider.Toggle",Ext.slider.Slider,{config:{baseCls:"x-toggle",minValueCls:"x-toggle-off",maxValueCls:"x-toggle-on"},initialize:function(){Ext.slider.Slider.prototype.initialize.call(this);this.on({change:"onChange"})},applyMinValue:function(){return 0},applyMaxValue:function(){return 1},applyIncrement:function(){return 1},updateMinValueCls:function(c,b){var a=this.element;if(b&&a.hasCls(b)){a.replaceCls(b,c)}},updateMaxValueCls:function(c,b){var a=this.element;if(b&&a.hasCls(b)){a.replaceCls(b,c)}},setValue:function(b,a){(arguments.callee.$previous||Ext.slider.Slider.prototype.setValue).apply(this,arguments);this.onChange(this,this.getThumbs()[0],b,a)},setIndexValue:function(c,e,d){var b=this.getValue()[c];Ext.slider.Slider.prototype.setIndexValue.apply(this,arguments);var a=this.getThumb(c),f=this.getValue()[c];if(b!==f){this.fireEvent("change",this,a,f,b)}},onChange:function(e,a,g,c){var h=g>0,b=e.getMaxValueCls(),f=e.getMinValueCls(),d=this.element;d.addCls(h?b:f);d.removeCls(h?f:b)},toggle:function(){var a=this.getValue();this.setValue((a==1)?0:1);return this},onTap:function(){if(this.isDisabled()||this.getReadOnly()){return}var b=this.getValue(),c=(b==1)?0:1,a=this.getThumb(0);this.setIndexValue(0,c,this.getAnimation());this.refreshThumbConstraints(a)}},0,0,["component","container","slider"],{component:true,container:true,slider:true},0,0,[Ext.slider,"Toggle"],0));(Ext.cmd.derive("Ext.field.Toggle",Ext.field.Slider,{alternateClassName:"Ext.form.Toggle",config:{cls:"x-toggle-field",labelAlign:"left",activeLabel:null,inactiveLabel:null},platformConfig:[{theme:["Windows"],labelAlign:"left"},{theme:["Blackberry","MountainView"],activeLabel:"On",inactiveLabel:"Off"}],proxyConfig:{minValueCls:"x-toggle-off",maxValueCls:"x-toggle-on"},applyComponent:function(a){return Ext.factory(a,Ext.slider.Toggle)},updateActiveLabel:function(b,a){if(b!=a){this.getComponent().element.dom.setAttribute("data-activelabel",b)}},updateInactiveLabel:function(b,a){if(b!=a){this.getComponent().element.dom.setAttribute("data-inactivelabel",b)}},setValue:function(b){if(b===true){b=1}var a=this.getValue();if(a!=b){this.getComponent().setValue(b);this.fireEvent("change",this,b,a)}return this},getValue:function(){return(this.getComponent().getValue()==1)?1:0},onSliderChange:function(c,a,d,b){this.fireEvent.call(this,"change",this,d,b)},toggle:function(){var a=this.getValue();this.setValue((a==1)?0:1);return this},onChange:function(){this.setLabel((this.getValue()==1)?this.toggleOnLabel:this.toggleOffLabel)}},0,["togglefield"],["component","field","sliderfield","togglefield"],{component:true,field:true,sliderfield:true,togglefield:true},["widget.togglefield"],0,[Ext.field,"Toggle",Ext.form,"Toggle"],0));(Ext.cmd.derive("Ext.fx.runner.Css",Ext.Evented,{prefixedProperties:{transform:true,"transform-origin":true,perspective:true,"transform-style":true,transition:true,"transition-property":true,"transition-duration":true,"transition-timing-function":true,"transition-delay":true,animation:true,"animation-name":true,"animation-duration":true,"animation-iteration-count":true,"animation-direction":true,"animation-timing-function":true,"animation-delay":true},lengthProperties:{top:true,right:true,bottom:true,left:true,width:true,height:true,"max-height":true,"max-width":true,"min-height":true,"min-width":true,"margin-bottom":true,"margin-left":true,"margin-right":true,"margin-top":true,"padding-bottom":true,"padding-left":true,"padding-right":true,"padding-top":true,"border-bottom-width":true,"border-left-width":true,"border-right-width":true,"border-spacing":true,"border-top-width":true,"border-width":true,"outline-width":true,"letter-spacing":true,"line-height":true,"text-indent":true,"word-spacing":true,"font-size":true,translate:true,translateX:true,translateY:true,translateZ:true,translate3d:true},durationProperties:{"transition-duration":true,"transition-delay":true,"animation-duration":true,"animation-delay":true},angleProperties:{rotate:true,rotateX:true,rotateY:true,rotateZ:true,skew:true,skewX:true,skewY:true},lengthUnitRegex:/([a-z%]*)$/,DEFAULT_UNIT_LENGTH:"px",DEFAULT_UNIT_ANGLE:"deg",DEFAULT_UNIT_DURATION:"ms",formattedNameCache:{},constructor:function(){var a=Ext.feature.has.Css3dTransforms;if(a){this.transformMethods=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","skewX","skewY","scaleX","scaleY","scaleZ"]}else{this.transformMethods=["translateX","translateY","rotate","skewX","skewY","scaleX","scaleY"]}this.vendorPrefix=Ext.browser.getStyleDashPrefix();this.ruleStylesCache={};return this},getStyleSheet:function(){var c=this.styleSheet,a,b;if(!c){a=document.createElement("style");a.type="text/css";(document.head||document.getElementsByTagName("head")[0]).appendChild(a);b=document.styleSheets;this.styleSheet=c=b[b.length-1]}return c},applyRules:function(j){var g=this.getStyleSheet(),l=this.ruleStylesCache,k=g.cssRules,c,e,h,b,d,a,f;for(c in j){e=j[c];h=l[c];if(h===undefined){d=k.length;g.insertRule(c+"{}",d);h=l[c]=k.item(d).style}b=h.$cache;if(!b){b=h.$cache={}}for(a in e){f=this.formatValue(e[a],a);a=this.formatName(a);if(b[a]!==f){b[a]=f;if(f===null){h.removeProperty(a)}else{h.setProperty(a,f,"important")}}}}return this},applyStyles:function(d){var g,c,f,b,a,e;for(g in d){if(d.hasOwnProperty(g)){c=document.getElementById(g);if(!c){return this}f=c.style;b=d[g];for(a in b){if(b.hasOwnProperty(a)){e=this.formatValue(b[a],a);a=this.formatName(a);if(e===null){f.removeProperty(a)}else{f.setProperty(a,e,"important")}}}}}return this},formatName:function(b){var a=this.formattedNameCache,c=a[b];if(!c){if((Ext.os.is.Tizen||!Ext.feature.has.CssTransformNoPrefix)&&this.prefixedProperties[b]){c=this.vendorPrefix+b}else{c=b}a[b]=c}return c},formatValue:function(j,b){var g=typeof j,l=this.DEFAULT_UNIT_LENGTH,e,a,d,f,c,k,h;if(j===null){return""}if(g=="string"){if(this.lengthProperties[b]){h=j.match(this.lengthUnitRegex)[1];if(h.length>0){}else{return j+l}}return j}else{if(g=="number"){if(j==0){return"0"}if(this.lengthProperties[b]){return j+l}if(this.angleProperties[b]){return j+this.DEFAULT_UNIT_ANGLE}if(this.durationProperties[b]){return j+this.DEFAULT_UNIT_DURATION}}else{if(b==="transform"){e=this.transformMethods;c=[];for(d=0,f=e.length;d<f;d++){a=e[d];c.push(a+"("+this.formatValue(j[a],a)+")")}return c.join(" ")}else{if(Ext.isArray(j)){k=[];for(d=0,f=j.length;d<f;d++){k.push(this.formatValue(j[d],b))}return(k.length>0)?k.join(", "):"none"}}}}return j}},1,0,0,0,0,0,[Ext.fx.runner,"Css"],0));(Ext.cmd.derive("Ext.fx.runner.CssTransition",Ext.fx.runner.Css,{listenersAttached:false,constructor:function(){this.runningAnimationsData={};return Ext.fx.runner.Css.prototype.constructor.apply(this,arguments)},attachListeners:function(){this.listenersAttached=true;this.getEventDispatcher().addListener("element","*","transitionend","onTransitionEnd",this)},onTransitionEnd:function(b){var a=b.target,c=a.id;if(c&&this.runningAnimationsData.hasOwnProperty(c)){this.refreshRunningAnimationsData(Ext.get(a),[b.browserEvent.propertyName])}},onAnimationEnd:function(g,f,d,j,n){var c=g.getId(),k=this.runningAnimationsData[c],o={},m={},b,h,e,l,a;d.un("stop","onAnimationStop",this);if(k){b=k.nameMap}o[c]=m;if(f.onBeforeEnd){f.onBeforeEnd.call(f.scope||this,g,j)}d.fireEvent("animationbeforeend",d,g,j);this.fireEvent("animationbeforeend",this,d,g,j);if(n||(!j&&!f.preserveEndState)){h=f.toPropertyNames;for(e=0,l=h.length;e<l;e++){a=h[e];if(b&&!b.hasOwnProperty(a)){m[a]=null}}}if(f.after){Ext.merge(m,f.after)}this.applyStyles(o);if(f.onEnd){f.onEnd.call(f.scope||this,g,j)}d.fireEvent("animationend",d,g,j);this.fireEvent("animationend",this,d,g,j);Ext.AnimationQueue.stop(Ext.emptyFn,d)},onAllAnimationsEnd:function(b){var c=b.getId(),a={};delete this.runningAnimationsData[c];a[c]={"transition-property":null,"transition-duration":null,"transition-timing-function":null,"transition-delay":null};this.applyStyles(a);this.fireEvent("animationallend",this,b)},hasRunningAnimations:function(a){var c=a.getId(),b=this.runningAnimationsData;return b.hasOwnProperty(c)&&b[c].sessions.length>0},refreshRunningAnimationsData:function(d,k,t,p){var g=d.getId(),q=this.runningAnimationsData,a=q[g];if(!a){return}var m=a.nameMap,s=a.nameList,b=a.sessions,f,h,e,u,l,c,r,o,n=false;t=Boolean(t);p=Boolean(p);if(!b){return this}f=b.length;if(f===0){return this}if(p){a.nameMap={};s.length=0;for(l=0;l<f;l++){c=b[l];this.onAnimationEnd(d,c.data,c.animation,t,p)}b.length=0}else{for(l=0;l<f;l++){c=b[l];r=c.map;o=c.list;for(h=0,e=k.length;h<e;h++){u=k[h];if(r[u]){delete r[u];Ext.Array.remove(o,u);c.length--;if(--m[u]==0){delete m[u];Ext.Array.remove(s,u)}}}if(c.length==0){b.splice(l,1);l--;f--;n=true;this.onAnimationEnd(d,c.data,c.animation,t)}}}if(!p&&!t&&b.length==0&&n){this.onAllAnimationsEnd(d)}},getRunningData:function(b){var a=this.runningAnimationsData;if(!a.hasOwnProperty(b)){a[b]={nameMap:{},nameList:[],sessions:[]}}return a[b]},getTestElement:function(){var c=this.testElement,b,d,a;if(!c){b=document.createElement("iframe");a=b.style;a.setProperty("visibility","hidden","important");a.setProperty("width","0px","important");a.setProperty("height","0px","important");a.setProperty("position","absolute","important");a.setProperty("border","0px","important");a.setProperty("zIndex","-1000","important");document.body.appendChild(b);d=b.contentDocument;d.open();d.writeln("</body>");d.close();this.testElement=c=d.createElement("div");c.style.setProperty("position","absolute","important");d.body.appendChild(c);this.testElementComputedStyle=window.getComputedStyle(c)}return c},getCssStyleValue:function(b,e){var d=this.getTestElement(),a=this.testElementComputedStyle,c=d.style;c.setProperty(b,e);if(Ext.browser.is.Firefox){d.offsetHeight}e=a.getPropertyValue(b);c.removeProperty(b);return e},run:function(q){var G=this,h=this.lengthProperties,y={},F={},H={},d,t,z,e,v,J,w,r,s,a,n,B,A,p,C,l,u,g,D,I,k,f,x,o,c,E,b,m;if(!this.listenersAttached){this.attachListeners()}q=Ext.Array.from(q);for(B=0,p=q.length;B<p;B++){C=q[B];C=Ext.factory(C,Ext.fx.Animation);d=C.getElement();Ext.AnimationQueue.start(Ext.emptyFn,C);g=window.getComputedStyle(d.dom);t=d.getId();H=Ext.merge({},C.getData());if(C.onBeforeStart){C.onBeforeStart.call(C.scope||this,d)}C.fireEvent("animationstart",C);this.fireEvent("animationstart",this,C);H[t]=H;v=H.before;z=H.from;e=H.to;H.fromPropertyNames=J=[];H.toPropertyNames=w=[];for(I in e){if(e.hasOwnProperty(I)){e[I]=k=this.formatValue(e[I],I);D=this.formatName(I);o=h.hasOwnProperty(I);if(!o){k=this.getCssStyleValue(D,k)}if(z.hasOwnProperty(I)){z[I]=x=this.formatValue(z[I],I);if(!o){x=this.getCssStyleValue(D,x)}if(k!==x){J.push(D);w.push(D)}}else{f=g.getPropertyValue(D);if(k!==f){w.push(D)}}}}l=w.length;if(l===0){this.onAnimationEnd(d,H,C);continue}a=this.getRunningData(t);b=a.sessions;if(b.length>0){this.refreshRunningAnimationsData(d,Ext.Array.merge(J,w),true,H.replacePrevious)}c=a.nameMap;E=a.nameList;u={};for(A=0;A<l;A++){I=w[A];u[I]=true;if(!c.hasOwnProperty(I)){c[I]=1;E.push(I)}else{c[I]++}}m={element:d,map:u,list:w.slice(),length:l,data:H,animation:C};b.push(m);C.on("stop","onAnimationStop",this);n=Ext.apply({},v);Ext.apply(n,z);if(E.length>0){J=Ext.Array.difference(E,J);w=Ext.Array.merge(J,w);n["transition-property"]=J}y[t]=n;F[t]=Ext.apply({},e);F[t]["transition-property"]=w;F[t]["transition-duration"]=H.duration;F[t]["transition-timing-function"]=H.easing;F[t]["transition-delay"]=H.delay;C.startTime=Date.now()}s=this.$className;this.applyStyles(y);r=function(j){if(j.data===s&&j.source===window){window.removeEventListener("message",r,false);G.applyStyles(F)}};if(Ext.browser.is.IE){window.requestAnimationFrame(function(){window.addEventListener("message",r,false);window.postMessage(s,"*")})}else{window.addEventListener("message",r,false);window.postMessage(s,"*")}},onAnimationStop:function(d){var f=this.runningAnimationsData,h,a,g,b,c,e;for(h in f){if(f.hasOwnProperty(h)){a=f[h];g=a.sessions;for(b=0,c=g.length;b<c;b++){e=g[b];if(e.animation===d){this.refreshRunningAnimationsData(e.element,e.list.slice(),false)}}}}}},1,0,0,0,0,0,[Ext.fx.runner,"CssTransition"],0));(Ext.cmd.derive("Ext.fx.Runner",Ext.Base,{constructor:function(){return new Ext.fx.runner.CssTransition()}},1,0,0,0,0,0,[Ext.fx,"Runner"],0));(Ext.cmd.derive("Ext.log.Base",Ext.Base,{config:{},constructor:function(a){this.initConfig(a);return this}},1,0,0,0,0,0,[Ext.log,"Base"],0));(function(){var a=(Ext.cmd.derive("Ext.log.Logger",Ext.log.Base,{statics:{defaultPriority:"info",priorities:{verbose:0,info:1,deprecate:2,warn:3,error:4}},config:{enabled:true,minPriority:"deprecate",writers:{}},log:function(m,k,c){if(!this.getEnabled()){return this}var h=a,n=h.priorities,j=n[k],d=this.log.caller,l="",e=this.getWriters(),b,f,g;if(!k){k="info"}if(n[this.getMinPriority()]>j){return this}if(!c){c=1}if(Ext.isArray(m)){m=m.join(" ")}else{m=String(m)}if(typeof c=="number"){f=c;do{f--;d=d.caller;if(!d){break}if(!g){g=d.caller}if(f<=0&&d.displayName){break}}while(d!==g);l=Ext.getDisplayName(d)}else{d=d.caller;l=Ext.getDisplayName(c)+"#"+d.$name}b={time:Ext.Date.now(),priority:j,priorityName:k,message:m,caller:d,callerDisplayName:l};for(f in e){if(e.hasOwnProperty(f)){e[f].write(Ext.merge({},b))}}return this}},0,0,0,0,0,0,[Ext.log,"Logger"],function(){Ext.Object.each(this.priorities,function(b){this.override(b,function(c,d){if(!d){d=1}if(typeof d=="number"){d+=1}this.log(c,b,d)})},this)}))})();(Ext.cmd.derive("Ext.log.formatter.Formatter",Ext.log.Base,{config:{messageFormat:"{message}"},format:function(a){return this.substitute(this.getMessageFormat(),a)},substitute:function(b,d){var a,c;for(a in d){if(d.hasOwnProperty(a)){c=d[a];b=b.replace(new RegExp("\\{"+a+"\\}","g"),c)}}return b}},0,0,0,0,0,0,[Ext.log.formatter,"Formatter"],0));(Ext.cmd.derive("Ext.log.formatter.Default",Ext.log.formatter.Formatter,{config:{messageFormat:"[{priorityName}][{callerDisplayName}] {message}"},format:function(a){var a=Ext.merge({},a,{priorityName:a.priorityName.toUpperCase()});return Ext.log.formatter.Formatter.prototype.format.call(this,a)}},0,0,0,0,0,0,[Ext.log.formatter,"Default"],0));(Ext.cmd.derive("Ext.log.writer.Writer",Ext.log.Base,{config:{formatter:null,filters:{}},constructor:function(){this.activeFilters=[];return Ext.log.Base.prototype.constructor.apply(this,arguments)},updateFilters:function(c){var d=this.activeFilters,a,b;d.length=0;for(a in c){if(c.hasOwnProperty(a)){b=c[a];d.push(b)}}},write:function(f){var e=this.activeFilters,b=this.getFormatter(),a,d,c;for(a=0,d=e.length;a<d;a++){c=e[a];if(!e[a].accept(f)){return this}}if(b){f.message=b.format(f)}this.doWrite(f);return this},doWrite:Ext.emptyFn},1,0,0,0,0,0,[Ext.log.writer,"Writer"],0));(Ext.cmd.derive("Ext.log.writer.Console",Ext.log.writer.Writer,{config:{throwOnErrors:true,throwOnWarnings:false},doWrite:function(d){var c=d.message,b=d.priorityName,a;if(b==="error"&&this.getThrowOnErrors()){throw new Error(c)}if(typeof console!=="undefined"){a=b;if(a==="deprecate"){a="warn"}if(a==="warn"&&this.getThrowOnWarnings()){throw new Error(c)}if(!(a in console)){a="log"}console[a](c)}}},0,0,0,0,0,0,[Ext.log.writer,"Console"],0));(Ext.cmd.derive("Ext.viewport.Default",Ext.Container,{PORTRAIT:"portrait",LANDSCAPE:"landscape",config:{autoMaximize:false,autoBlurInput:true,preventPanning:true,preventZooming:false,autoRender:true,layout:"card",width:"100%",height:"100%",useBodyElement:true,menus:{}},isReady:false,isViewport:true,isMaximizing:false,id:"ext-viewport",isInputRegex:/^(input|textarea|select|a)$/i,focusedElement:null,fullscreenItemCls:"x-fullscreen",constructor:function(a){var b=Ext.Function.bind;this.doPreventPanning=b(this.doPreventPanning,this);this.doPreventZooming=b(this.doPreventZooming,this);this.doBlurInput=b(this.doBlurInput,this);this.maximizeOnEvents=["ready","orientationchange"];window.devicePixelRatio=window.devicePixelRatio||1;Ext.Container.prototype.constructor.call(this,a);this.orientation=this.determineOrientation();this.windowWidth=this.getWindowWidth();this.windowHeight=this.getWindowHeight();this.windowOuterHeight=this.getWindowOuterHeight();if(!this.stretchHeights){this.stretchHeights={}}if(!Ext.os.is.Android||Ext.browser.is.ChromeMobile){if(this.supportsOrientation()){this.addWindowListener("orientationchange",b(this.onOrientationChange,this))}else{this.addWindowListener("resize",b(this.onResize,this))}}document.addEventListener("focus",b(this.onElementFocus,this),true);document.addEventListener("blur",b(this.onElementBlur,this),true);Ext.onDocumentReady(this.onDomReady,this);this.on("ready",this.onReady,this,{single:true});this.getEventDispatcher().addListener("component","*","fullscreen","onItemFullscreenChange",this);return this},onDomReady:function(){this.isReady=true;this.updateSize();this.fireEvent("ready",this)},onReady:function(){if(this.getAutoRender()){this.render()}if(Ext.browser.name=="ChromeiOS"){this.setHeight("-webkit-calc(100% - "+((window.outerHeight-window.innerHeight)/2)+"px)")}},onElementFocus:function(a){this.focusedElement=a.target},onElementBlur:function(){this.focusedElement=null},render:function(){if(!this.rendered){var a=Ext.getBody(),b="x-",h=[],d=Ext.os,g=d.name.toLowerCase(),f=Ext.browser.name.toLowerCase(),e=d.version.getMajor(),c=this.getOrientation();this.renderTo(a);h.push(b+d.deviceType.toLowerCase());if(d.is.iPad){h.push(b+"ipad")}h.push(b+g);h.push(b+f);if(e){h.push(b+g+"-"+e)}if(d.is.BlackBerry){h.push(b+"bb");if(Ext.browser.userAgent.match(/Kbd/gi)){h.push(b+"bb-keyboard")}}if(Ext.browser.is.WebKit){h.push(b+"webkit")}if(Ext.browser.is.Standalone){h.push(b+"standalone")}if(Ext.browser.is.AndroidStock){h.push(b+"android-stock")}if(Ext.browser.is.GoogleGlass){h.push(b+"google-glass")}h.push(b+c);a.addCls(h)}},applyAutoBlurInput:function(a){var b=(Ext.feature.has.Touch)?"touchstart":"mousedown";if(a){this.addWindowListener(b,this.doBlurInput,false)}else{this.removeWindowListener(b,this.doBlurInput,false)}return a},applyAutoMaximize:function(a){if(Ext.browser.is.WebView){a=false}if(a){this.on("ready","doAutoMaximizeOnReady",this,{single:true});this.on("orientationchange","doAutoMaximizeOnOrientationChange",this)}else{this.un("ready","doAutoMaximizeOnReady",this);this.un("orientationchange","doAutoMaximizeOnOrientationChange",this)}return a},applyPreventPanning:function(a){if(a){this.addWindowListener("touchmove",this.doPreventPanning,false)}else{this.removeWindowListener("touchmove",this.doPreventPanning,false)}return a},applyPreventZooming:function(a){var b=(Ext.feature.has.Touch)?"touchstart":"mousedown";if(a){this.addWindowListener(b,this.doPreventZooming,false)}else{this.removeWindowListener(b,this.doPreventZooming,false)}return a},doAutoMaximizeOnReady:function(){var a=arguments[arguments.length-1];a.pause();this.isMaximizing=true;this.on("maximize",function(){this.isMaximizing=false;this.updateSize();a.resume();this.fireEvent("ready",this)},this,{single:true});this.maximize()},doAutoMaximizeOnOrientationChange:function(){var a=arguments[arguments.length-1],b=a.firingArguments;a.pause();this.isMaximizing=true;this.on("maximize",function(){this.isMaximizing=false;this.updateSize();b[2]=this.windowWidth;b[3]=this.windowHeight;a.resume()},this,{single:true});this.maximize()},doBlurInput:function(b){var a=b.target,c=this.focusedElement;if(c&&c.nodeName.toUpperCase()!="BODY"&&!this.isInputRegex.test(a.tagName)){delete this.focusedElement;c.blur()}},doPreventPanning:function(a){a.preventDefault()},doPreventZooming:function(b){if("button" in b&&b.button!==0){return}var a=b.target;if(a&&a.nodeType===1&&!this.isInputRegex.test(a.tagName)){b.preventDefault()}},addWindowListener:function(b,c,a){window.addEventListener(b,c,Boolean(a))},removeWindowListener:function(b,c,a){window.removeEventListener(b,c,Boolean(a))},doAddListener:function(a,d,c,b){if(a==="ready"&&this.isReady&&!this.isMaximizing){d.call(c);return this}return Ext.Container.prototype.doAddListener.apply(this,arguments)},supportsOrientation:function(){return Ext.feature.has.Orientation},onResize:function(){var c=this.windowWidth,f=this.windowHeight,e=this.getWindowWidth(),a=this.getWindowHeight(),d=this.getOrientation(),b=this.determineOrientation();if((c!==e&&f!==a)&&d!==b){this.fireOrientationChangeEvent(b,d)}},onOrientationChange:function(){var b=this.getOrientation(),a=this.determineOrientation();if(a!==b){this.fireOrientationChangeEvent(a,b)}},fireOrientationChangeEvent:function(b,c){var a="x-";Ext.getBody().replaceCls(a+c,a+b);this.orientation=b;this.updateSize();this.fireEvent("orientationchange",this,b,this.windowWidth,this.windowHeight)},updateSize:function(b,a){this.windowWidth=b!==undefined?b:this.getWindowWidth();this.windowHeight=a!==undefined?a:this.getWindowHeight();return this},waitUntil:function(h,e,g,a,f){if(!a){a=50}if(!f){f=2000}var c=this,b=0;setTimeout(function d(){b+=a;if(h.call(c)===true){if(e){e.call(c)}}else{if(b>=f){if(g){g.call(c)}}else{setTimeout(d,a)}}},a)},maximize:function(){this.fireMaximizeEvent()},fireMaximizeEvent:function(){this.updateSize();this.fireEvent("maximize",this)},doSetHeight:function(a){Ext.getBody().setHeight(a);Ext.Container.prototype.doSetHeight.apply(this,arguments)},doSetWidth:function(a){Ext.getBody().setWidth(a);Ext.Container.prototype.doSetWidth.apply(this,arguments)},scrollToTop:function(){window.scrollTo(0,-1)},getWindowWidth:function(){return window.innerWidth},getWindowHeight:function(){return window.innerHeight},getWindowOuterHeight:function(){return window.outerHeight},getWindowOrientation:function(){return window.orientation},getOrientation:function(){return this.orientation},getSize:function(){return{width:this.windowWidth,height:this.windowHeight}},determineOrientation:function(){var b=this.PORTRAIT,a=this.LANDSCAPE;if(!Ext.os.is.Android&&this.supportsOrientation()){if(this.getWindowOrientation()%180===0){return b}return a}else{if(this.getWindowHeight()>=this.getWindowWidth()){return b}return a}},onItemFullscreenChange:function(a){a.addCls(this.fullscreenItemCls);this.add(a)},setMenu:function(e,a){var b=this;a=a||{};if(Ext.os.is.iOS&&!this.hasiOSOrientationFix){this.hasiOSOrientationFix=true;this.on("orientationchange",function(){window.scrollTo(0,0)},this)}if(!e){return}if(!a.side){return}if(["left","right","top","bottom"].indexOf(a.side)==-1){return}var d=b.getMenus();if(!d){d={}}if(!b.addedSwipeListener){b.addedSwipeListener=true;b.element.on({tap:b.onTap,swipestart:b.onSwipeStart,edgeswipestart:b.onEdgeSwipeStart,edgeswipe:b.onEdgeSwipe,edgeswipeend:b.onEdgeSwipeEnd,scope:b});if(window.blackberry){var c=function(){var f=b.getMenus(),g=f.top;if(!g){return}if(g.isHidden()){b.showMenu("top")}else{b.hideMenu("top")}};if(blackberry.app&&blackberry.app.event&&blackberry.app.event.onSwipeDown){blackberry.app.event.onSwipeDown(c)}else{if(blackberry.event&&blackberry.event.addEventListener){blackberry.event.addEventListener("swipedown",c)}}}}d[a.side]=e;e.$reveal=Boolean(a.reveal);e.$cover=a.cover!==false&&!e.$reveal;e.$side=a.side;b.fixMenuSize(e,a.side);if(a.side=="left"){e.setLeft(0);e.setRight(null);e.setTop(0);e.setBottom(0)}else{if(a.side=="right"){e.setLeft(null);e.setRight(0);e.setTop(0);e.setBottom(0)}else{if(a.side=="top"){e.setLeft(0);e.setRight(0);e.setTop(0);e.setBottom(null)}else{if(a.side=="bottom"){e.setLeft(0);e.setRight(0);e.setTop(null);e.setBottom(0)}}}}b.setMenus(d)},removeMenu:function(a){var b=this.getMenus()||{},c=b[a];if(c){this.hideMenu(a)}delete b[a];this.setMenus(b)},fixMenuSize:function(b,a){if(a=="top"||a=="bottom"){b.setWidth("100%")}else{if(a=="left"||a=="right"){b.setHeight("100%")}}},showMenu:function(b){var e=this.getMenus(),h=e[b],d,g,f,c;if(!h||h.isAnimating){return}this.hideOtherMenus(b);d={translateX:0,translateY:0};g={translateX:0,translateY:0};f={translateX:0,translateY:0};c={translateX:0,translateY:0};if(h.$reveal){Ext.getBody().insertFirst(h.element)}else{Ext.Viewport.add(h)}h.show();h.addCls("x-"+b);var a=(b=="left"||b=="right")?h.element.getWidth():h.element.getHeight();if(b=="left"){d.translateX=-a;c.translateX=a}else{if(b=="right"){d.translateX=a;c.translateX=-a}else{if(b=="top"){d.translateY=-a;c.translateY=a}else{if(b=="bottom"){d.translateY=a;c.translateY=-a}}}}if(h.$reveal){if(Ext.browser.getPreferredTranslationMethod()!="scrollposition"){h.translate(0,0)}}else{h.translate(d.translateX,d.translateY)}if(h.$cover){h.getTranslatable().on("animationend",function(){h.isAnimating=false},this,{single:true});h.translate(g.translateX,g.translateY,{preserveEndState:true,duration:200})}else{this.translate(f.translateX,f.translateY);this.getTranslatable().on("animationend",function(){h.isAnimating=false},this,{single:true});this.translate(c.translateX,c.translateY,{preserveEndState:true,duration:200})}h.isAnimating=true},hideMenu:function(c,a){var e=this.getMenus(),g=e[c],f,d,b;a=(a===false)?false:true;if(!g||(g.isHidden()||g.isAnimating)){return}f={translateX:0,translateY:0};d={translateX:0,translateY:0};b=(c=="left"||c=="right")?g.element.getWidth():g.element.getHeight();if(c=="left"){f.translateX=-b}else{if(c=="right"){f.translateX=b}else{if(c=="top"){f.translateY=-b}else{if(c=="bottom"){f.translateY=b}}}}if(g.$cover){if(a){g.getTranslatable().on("animationend",function(){g.isAnimating=false;g.hide()},this,{single:true});g.translate(f.translateX,f.translateY,{preserveEndState:true,duration:200})}else{g.translate(f.translateX,f.translateY);g.hide()}}else{if(a){this.getTranslatable().on("animationend",function(){g.isAnimating=false;g.hide()},this,{single:true});this.translate(d.translateX,d.translateY,{preserveEndState:true,duration:200})}else{this.translate(d.translateX,d.translateY);g.hide()}}},hideAllMenus:function(c){var b=this.getMenus();for(var a in b){this.hideMenu(a,c)}},hideOtherMenus:function(a,c){var b=this.getMenus();for(var d in b){if(a!=d){this.hideMenu(d,c)}}},toggleMenu:function(a){var b=this.getMenus(),c;if(b[a]){c=b[a];if(c.isHidden()){this.showMenu(a)}else{this.hideMenu(a)}}},sideForDirection:function(a){if(a=="left"){return"right"}else{if(a=="right"){return"left"}else{if(a=="up"){return"bottom"}else{if(a=="down"){return"top"}}}}},sideForSwipeDirection:function(a){if(a=="up"){return"top"}else{if(a=="down"){return"bottom"}}return a},onTap:function(a){},onSwipeStart:function(b){var a=this.sideForSwipeDirection(b.direction);this.hideMenu(a)},onEdgeSwipeStart:function(h){var k=this.sideForDirection(h.direction),d=this.getMenus(),b=d[k],l,j;if(!b||!b.isHidden()){return}for(l in d){j=d[l];if(j.isHidden()!==false){return}}this.$swiping=true;this.hideAllMenus(false);if(b.$reveal){Ext.getBody().insertFirst(b.element)}else{Ext.Viewport.add(b)}b.show();var m=(k=="left"||k=="right")?b.element.getWidth():b.element.getHeight(),a,g;a={translateX:0,translateY:0};g={translateX:0,translateY:0};if(k=="left"){a.translateX=-m}else{if(k=="right"){a.translateX=m}else{if(k=="top"){a.translateY=-m}else{if(k=="bottom"){a.translateY=m}}}}var c="webkitTransform" in document.createElement("div").style?"webkitTransform":"transform",f=b.element.dom.style[c];if(f){b.element.dom.style[c]=""}if(b.$reveal){if(Ext.browser.getPreferredTranslationMethod()!="scrollposition"){b.translate(0,0)}}else{b.translate(a.translateX,a.translateY)}if(!b.$cover){if(f){this.innerElement.dom.style[c]=""}this.translate(g.translateX,g.translateY)}},onEdgeSwipe:function(g){var c=this.sideForDirection(g.direction),j=this.getMenus()[c];if(!j||!this.$swiping){return}var b=(c=="left"||c=="right")?j.element.getWidth():j.element.getHeight(),h,f,a=Math.min(g.distance-b,0),d=Math.min(g.distance,b);h={translateX:0,translateY:0};f={translateX:0,translateY:0};if(c=="left"){h.translateX=a;f.translateX=d}else{if(c=="right"){h.translateX=-a;f.translateX=-d}else{if(c=="top"){h.translateY=a;f.translateY=d}else{if(c=="bottom"){h.translateY=-a;f.translateY=-d}}}}if(j.$cover){j.translate(h.translateX,h.translateY)}else{this.translate(f.translateX,f.translateY)}},onEdgeSwipeEnd:function(j){var k=this.sideForDirection(j.direction),b=this.getMenus()[k],h=false;if(!b){return}var l=(k=="left"||k=="right")?b.element.getWidth():b.element.getHeight(),f=(j.flick)?j.flick.velocity:0;if(k=="right"){if(f.x>0){h=true}}else{if(k=="left"){if(f.x<0){h=true}}else{if(k=="top"){if(f.y<0){h=true}}else{if(k=="bottom"){if(f.y>0){h=true}}}}}var c=(h)?l:0,d=(h)?0:-l,a,g;a={translateX:0,translateY:0};g={translateX:0,translateY:0};if(k=="left"){a.translateX=-c;g.translateX=-d}else{if(k=="right"){a.translateX=c;g.translateX=d}else{if(k=="top"){a.translateY=-c;g.translateY=-d}else{if(k=="bottom"){a.translateY=c;g.translateY=d}}}}if(b.$cover){b.getTranslatable().on("animationend",function(){if(h){b.hide()}},this,{single:true});b.translate(a.translateX,a.translateY,{preserveEndState:true,duration:200})}else{this.getTranslatable().on("animationend",function(){if(h){b.hide()}},this,{single:true});this.translate(g.translateX,g.translateY,{preserveEndState:true,duration:200})}this.$swiping=false}},1,["viewport"],["component","container","viewport"],{component:true,container:true,viewport:true},["widget.viewport"],0,[Ext.viewport,"Default"],0));(Ext.cmd.derive("Ext.viewport.Android",Ext.viewport.Default,{config:{translatable:{translationMethod:"csstransform"}},constructor:function(){this.on("orientationchange","hideKeyboardIfNeeded",this,{prepend:true});Ext.viewport.Default.prototype.constructor.apply(this,arguments);var a=this;Ext.onReady(function(){Ext.getBody().on("resize",a.onResize,a)})},getWindowWidth:function(){return this.element.getWidth()},getWindowHeight:function(){return this.element.getHeight()},getDummyInput:function(){var a=this.dummyInput,c=this.focusedElement,b=Ext.fly(c).getPageBox();if(!a){this.dummyInput=a=document.createElement("input");a.style.position="absolute";a.style.opacity="0";a.style.pointerEvents="none";document.body.appendChild(a)}a.style.left=b.left+"px";a.style.top=b.top+"px";a.style.display="";return a},doBlurInput:function(c){var b=c.target,d=this.focusedElement,a;if(d&&!this.isInputRegex.test(b.tagName)){a=this.getDummyInput();delete this.focusedElement;a.focus();setTimeout(function(){a.style.display="none"},100)}},hideKeyboardIfNeeded:function(){var a=arguments[arguments.length-1],b=this.focusedElement;if(b){delete this.focusedElement;a.pause();if(Ext.os.version.lt("4")){b.style.display="none"}else{b.blur()}setTimeout(function(){b.style.display="";a.resume()},1000)}},doFireOrientationChangeEvent:function(){var a=arguments[arguments.length-1];this.orientationChanging=true;a.pause();this.waitUntil(function(){return this.getWindowOuterHeight()!==this.windowOuterHeight},function(){this.windowOuterHeight=this.getWindowOuterHeight();this.updateSize();a.firingArguments[2]=this.windowWidth;a.firingArguments[3]=this.windowHeight;a.resume();this.orientationChanging=false},function(){});return this},determineOrientation:function(){return(this.getWindowHeight()>=this.getWindowWidth())?this.PORTRAIT:this.LANDSCAPE},getActualWindowOuterHeight:function(){return Math.round(this.getWindowOuterHeight()/window.devicePixelRatio)},maximize:function(){var c=this.stretchHeights,b=this.orientation,a;a=c[b];if(!a){c[b]=a=this.getActualWindowOuterHeight()}if(!this.addressBarHeight){this.addressBarHeight=a-this.getWindowHeight()}this.setHeight(a);var d=Ext.Function.bind(this.isHeightMaximized,this,[a]);this.scrollToTop();this.waitUntil(d,this.fireMaximizeEvent,this.fireMaximizeEvent)},isHeightMaximized:function(a){this.scrollToTop();return this.getWindowHeight()===a},supportsOrientation:function(){return false},onResize:function(){this.waitUntil(function(){var c=this.windowWidth,f=this.windowHeight,e=this.getWindowWidth(),a=this.getWindowHeight(),d=this.getOrientation(),b=this.determineOrientation();return((c!==e&&f!==a)&&d!==b)},function(){var b=this.getOrientation(),a=this.determineOrientation();this.fireOrientationChangeEvent(a,b)},Ext.emptyFn,250)},doPreventZooming:function(b){if("button" in b&&b.button!==0){return}var a=b.target;if(a&&a.nodeType===1&&!this.isInputRegex.test(a.tagName)&&!this.focusedElement){b.preventDefault()}}},1,0,["component","container","viewport"],{component:true,container:true,viewport:true},0,0,[Ext.viewport,"Android"],function(){if(!Ext.os.is.Android){return}var a=Ext.os.version,b=Ext.browser.userAgent,c=/(htc|desire|incredible|ADR6300)/i.test(b)&&a.lt("2.3");if(c){this.override({constructor:function(d){if(!d){d={}}d.autoMaximize=false;this.watchDogTick=Ext.Function.bind(this.watchDogTick,this);setInterval(this.watchDogTick,1000);return this.callParent([d])},watchDogTick:function(){this.watchDogLastTick=Ext.Date.now()},doPreventPanning:function(){var e=Ext.Date.now(),f=this.watchDogLastTick,d=e-f;if(d>=2000){return}return this.callParent(arguments)},doPreventZooming:function(){var e=Ext.Date.now(),f=this.watchDogLastTick,d=e-f;if(d>=2000){return}return this.callParent(arguments)}})}if(a.match("2")){this.override({onReady:function(){this.addWindowListener("resize",Ext.Function.bind(this.onWindowResize,this));this.callParent(arguments)},scrollToTop:function(){document.body.scrollTop=100},onWindowResize:function(){var e=this.windowWidth,g=this.windowHeight,f=this.getWindowWidth(),d=this.getWindowHeight();if(this.getAutoMaximize()&&!this.isMaximizing&&!this.orientationChanging&&window.scrollY===0&&e===f&&d<g&&((d>=g-this.addressBarHeight)||!this.focusedElement)){this.scrollToTop()}}})}else{if(a.gtEq("3.1")){this.override({isHeightMaximized:function(d){this.scrollToTop();return this.getWindowHeight()===d-1}})}else{if(a.match("3")){this.override({isHeightMaximized:function(){this.scrollToTop();return true}})}}}if(a.gtEq("4")){this.override({doBlurInput:Ext.emptyFn})}}));(Ext.cmd.derive("Ext.viewport.Ios",Ext.viewport.Default,{isFullscreen:function(){return this.isHomeScreen()},isHomeScreen:function(){return window.navigator.standalone===true},constructor:function(){Ext.viewport.Default.prototype.constructor.apply(this,arguments);if(this.getAutoMaximize()&&!this.isFullscreen()){this.addWindowListener("touchstart",Ext.Function.bind(this.onTouchStart,this))}},maximize:function(){if(this.isFullscreen()){return Ext.viewport.Default.prototype.maximize.call(this)}var c=this.stretchHeights,b=this.orientation,d=this.getWindowHeight(),a=c[b];if(window.scrollY>0){this.scrollToTop();if(!a){c[b]=a=this.getWindowHeight()}this.setHeight(a);this.fireMaximizeEvent()}else{if(!a){a=this.getScreenHeight()}this.setHeight(a);this.waitUntil(function(){this.scrollToTop();return d!==this.getWindowHeight()},function(){if(!c[b]){a=c[b]=this.getWindowHeight();this.setHeight(a)}this.fireMaximizeEvent()},function(){a=c[b]=this.getWindowHeight();this.setHeight(a);this.fireMaximizeEvent()},50,1000)}},getScreenHeight:function(){return window.screen[this.orientation===this.PORTRAIT?"height":"width"]},onElementFocus:function(){if(this.getAutoMaximize()&&!this.isFullscreen()){clearTimeout(this.scrollToTopTimer)}Ext.viewport.Default.prototype.onElementFocus.apply(this,arguments)},onElementBlur:function(){if(this.getAutoMaximize()&&!this.isFullscreen()){this.scrollToTopTimer=setTimeout(this.scrollToTop,500)}Ext.viewport.Default.prototype.onElementBlur.apply(this,arguments)},onTouchStart:function(){if(this.focusedElement===null){this.scrollToTop()}},scrollToTop:function(){window.scrollTo(0,0)}},1,0,["component","container","viewport"],{component:true,container:true,viewport:true},0,0,[Ext.viewport,"Ios"],function(){if(!Ext.os.is.iOS){return}if(Ext.os.version.lt("3.2")){this.override({constructor:function(){var a=this.stretchHeights={};a[this.PORTRAIT]=416;a[this.LANDSCAPE]=268;return this.callOverridden(arguments)}})}if(Ext.os.version.lt("5")){this.override({fieldMaskClsTest:"-field-mask",doPreventZooming:function(b){var a=b.target;if(a&&a.nodeType===1&&!this.isInputRegex.test(a.tagName)&&a.className.indexOf(this.fieldMaskClsTest)==-1){b.preventDefault()}}})}if(Ext.os.is.iPad){this.override({isFullscreen:function(){return true}})}if(Ext.os.version.gtEq("7")){if(Ext.os.deviceType==="Tablet"||!Ext.browser.is.Safari||window.navigator.standalone){this.override({constructor:function(){var d={},b={},a=this.determineOrientation(),f=window.screen.height,c=window.screen.width,e=a===this.PORTRAIT?f-window.innerHeight:c-window.innerHeight;d[this.PORTRAIT]=f-e;d[this.LANDSCAPE]=c-e;b[this.PORTRAIT]=c;b[this.LANDSCAPE]=f;this.stretchHeights=d;this.stretchWidths=b;this.callOverridden(arguments);this.on("ready",this.setViewportSizeToAbsolute,this);this.on("orientationchange",this.setViewportSizeToAbsolute,this)},getWindowHeight:function(){return this.stretchHeights[this.orientation]},getWindowWidth:function(){return this.stretchWidths[this.orientation]},setViewportSizeToAbsolute:function(){this.setWidth(this.getWindowWidth());this.setHeight(this.getWindowHeight())}})}if(Ext.os.deviceType==="Tablet"){this.override({constructor:function(){this.callOverridden(arguments);window.addEventListener("scroll",function(){if(window.scrollX!==0){window.scrollTo(0,window.scrollY)}},false)},setViewportSizeToAbsolute:function(){window.scrollTo(0,0);this.callOverridden(arguments)},onElementBlur:function(){this.callOverridden(arguments);if(window.scrollY!==0){window.scrollTo(0,0)}}})}}}));(Ext.cmd.derive("Ext.viewport.WindowsPhone",Ext.viewport.Default,{alternateClassName:"Ext.viewport.WP",config:{translatable:{translationMethod:"csstransform"}},initialize:function(){var a=function(d){var c=d.srcElement.nodeName.toUpperCase(),b=["INPUT","TEXTAREA"];if(b.indexOf(c)==-1){return false}};document.body.addEventListener("onselectstart",a);Ext.viewport.Default.prototype.initialize.apply(this,arguments)},supportsOrientation:function(){return false},onResize:function(){this.waitUntil(function(){var c=this.windowWidth,f=this.windowHeight,e=this.getWindowWidth(),a=this.getWindowHeight(),d=this.getOrientation(),b=this.determineOrientation();return((c!==e&&f!==a)&&d!==b)},function(){var b=this.getOrientation(),a=this.determineOrientation();this.fireOrientationChangeEvent(a,b)},Ext.emptyFn,250)}},0,0,["component","container","viewport"],{component:true,container:true,viewport:true},0,0,[Ext.viewport,"WindowsPhone",Ext.viewport,"WP"],0));(Ext.cmd.derive("Ext.viewport.Viewport",Ext.Base,{constructor:function(b){var c=Ext.os.name,d,a;switch(c){case"Android":d=(Ext.browser.name=="ChromeMobile")?"Default":"Android";break;case"iOS":d="Ios";break;case"Windows":d=(Ext.browser.name=="IE")?"WindowsPhone":"Default";break;case"WindowsPhone":d="WindowsPhone";break;default:d="Default";break}a=Ext.create("Ext.viewport."+d,b);return a}},1,0,0,0,0,0,[Ext.viewport,"Viewport"],0));(Ext.cmd.derive("InfinityMobile.model.MyModel",Ext.data.Model,{config:{fields:[{name:"landscapeBackgroundImage",type:"string"},{name:"showOnPortrait",type:"boolean"},{name:"dataURL",type:"string"},{name:"name",type:"string"},{name:"showOnLandscape",type:"boolean"},{name:"rootKeyPath",type:"string"},{name:"shareBetweenCanvasses",type:"boolean"},{name:"states",type:"auto"},{name:"position",type:"auto"},{name:"customizables",type:"auto"},{name:"anchors",type:"auto"},{name:"globalID",type:"string"},{name:"borders",type:"auto"},{name:"paddings",type:"auto"},{name:"identifier",type:"string"},{name:"defaultState",type:"string"},{name:"events",type:"auto"},{name:"subviews",type:"auto"},{name:"portraitBackgroundImage",type:"string"},{name:"type",type:"string"}]}},0,0,0,0,["model.mymodel"],0,[InfinityMobile.model,"MyModel"],0));(Ext.cmd.derive("InfinityMobile.store.EditionFlatplan",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"EditionFlatplan",proxy:{type:"ajax",url:"http://localhost/psapp/FlatPlans/c3cb755a-199f-4183-ae5f-82b2ed0980d7.txt",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"EditionFlatplan"],0));(Ext.cmd.derive("InfinityMobile.store.LatestEditionFlatplan",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"LatestEditionFlatplan",proxy:{type:"ajax",url:"http://localhost/psapp/FlatPlans/c3cb755a-199f-4183-ae5f-82b2ed0980d7.txt",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"LatestEditionFlatplan"],0));(Ext.cmd.derive("InfinityMobile.store.ArchiveStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"ArchiveStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"ArchiveStore"],0));(Ext.cmd.derive("InfinityMobile.store.SettingStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"SettingStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"SettingStore"],0));(Ext.cmd.derive("InfinityMobile.store.SearchStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"SearchStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"SearchStore"],0));(Ext.cmd.derive("InfinityMobile.store.SearchHighlightStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"SearchHighlightStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"SearchHighlightStore"],0));(Ext.cmd.derive("InfinityMobile.store.MediaStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"MediaStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"MediaStore"],0));(Ext.cmd.derive("InfinityMobile.store.ArticleStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"ArticleStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"ArticleStore"],0));(Ext.cmd.derive("InfinityMobile.store.LanguageStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"LanguageStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"LanguageStore"],0));(Ext.cmd.derive("InfinityMobile.store.PuzzleArchiveStore",Ext.data.Store,{config:{model:"InfinityMobile.model.MyModel",storeId:"PuzzleArchiveStore",proxy:{type:"ajax",noCache:false,reader:{type:"json"}}}},0,0,0,0,0,0,[InfinityMobile.store,"PuzzleArchiveStore"],0));(Ext.cmd.derive("InfinityMobile.controller.AppController",Ext.app.Controller,{config:{refs:{main:"main"},control:{main:{removeSplash:"removeSplashScreen"}}},init:function(){var a=this;a.initApp();$(document).on("dragstart",function(){return false});a.removedSplash=false;a.setupRenderOptions()},setupRenderOptions:function(){window.renderOptions={disableCanvasAlpha:false};if(currentProfile=="desktop"&&(Ext.browser.is.Chrome)&&Ext.os.is.Windows){try{var b=document.createElement("canvas").getContext("webgl");function d(f){try{var g=f.getExtension("WEBGL_debug_renderer_info");if(g){return f.getParameter(g.UNMASKED_RENDERER_WEBGL)}else{return -1}}catch(e){return -1}}var c=d(b);window.renderOptions.disableCanvasAlpha=c.toLowerCase().indexOf("intel")>=0;delete b}catch(a){console.warn("[AppController] Error Caught:\n",a)}}},fixOrientationBug:function(){var a=this},initApp:function(){var b=this;currentProfile="tablet";if(this.getApplication().getCurrentProfile()!=null){currentProfile=this.getApplication().getCurrentProfile().getName()}if(typeof(Worker)!=="undefined"){}else{}if(currentProfile=="phone"){if(Ext.os.is.iPhone){$("html").addClass("iphone")}}if(Ext.browser.userAgent.indexOf("CrOS")!=-1){currentProfile="desktop";Ext.os.is.Desktop=true;Ext.os.is.Phone=false;Ext.os.is.Tablet=false}b.setMainPanel();if(Ext.os.is.Android&&Ext.browser.is.Chrome){b.loadDimensionsAndroid()}else{b.loadDimensions()}device=currentProfile;var c=qs.appid;b.initAppReader();try{if(localStorage.getItem("udid")==null){udid=b.createUdid();localStorage.setItem("udid",udid)}else{udid=localStorage.getItem("udid")}}catch(a){udid=b.createUdid()}},checkTribuneCommunity:function(){if(typeof isTribReader!="undefined"&&isTribReader==true){if(settings.reader.showZonesOnLaunch=="true"){try{var a=localStorage.getItem("zones"+publicationguid)}catch(b){var a=null}if(a==null){mainPanel.fireEvent("toolbarZones")}}}},createUdid:function(){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},initialiseGA:function(a){(function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create",a,"auto")},initialiseComScore:function(c){var a=c;stageAccountID=c.split("|")[0];liveAccountID=c.split("|")[1];accountName=c.split("|")[2];accountIdVersion=stageAccountID+"|"+accountName;if(version=="live"){accountIdVersion=liveAccountID+"|"+accountName}try{cmSetClientID(accountIdVersion,false,comScoreServer,pagesuiteServer);daSiteCode=c.split("|")[2]+"|";daAttributes="-_--_--_--_--_--_--_--_-"+device+"-_-HTML 5 Edition"}catch(b){console.log("UNABLE TO SET CLIENT ID")}},loadDimensions:function(){screenHeight=screen.height;screenWidth=screen.width;windowHeight=window.innerHeight;windowWidth=window.innerWidth;topBarHeight=screenHeight-windowHeight;width=screenWidth;height=screenHeight;landscapeWidth=screenHeight;landscapeHeight=screenWidth;if(Ext.Viewport.getOrientation()=="landscape"){if(screenHeight>screenWidth){topBarHeight=screenWidth-windowHeight}else{width=screenHeight;height=screenWidth;landscapeWidth=screenWidth;landscapeHeight=screenHeight}}height=height-topBarHeight;landscapeHeight=landscapeHeight-topBarHeight},loadDimensionsAndroid:function(){screenHeight=screen.height;screenWidth=screen.width;windowHeight=window.innerHeight;windowWidth=window.innerWidth;width=screenWidth;height=screenHeight;landscapeWidth=screenHeight;landscapeHeight=screenWidth;chromeTopBarHeight=81;androidSoftMenuBarHeight=0;topBarHeight=screenHeight-windowHeight;if(topBarHeight>81){androidSoftMenuBarHeight=topBarHeight-chromeTopBarHeight}else{if(screenWidth>windowWidth){androidSoftMenuBarHeight=screenWidth-windowWidth}}if(screen.width>screen.height){landscapeHeight=screenHeight;landscapeWidth=windowWidth;width=screenHeight;var a=0;if(androidSoftMenuBarHeight>0){a=androidSoftMenuBarHeight+6}height=screenWidth-topBarHeight-a}else{width=windowWidth;height=windowHeight;var a=Math.max((androidSoftMenuBarHeight-6),0);landscapeWidth=screenHeight-a;landscapeHeight=screenWidth-topBarHeight-a}},setMainPanel:function(){mainPanel=Ext.create("InfinityMobile.view.Main",{fullscreen:true,layout:"card",id:"rootPanel"});Ext.Viewport.add(mainPanel);articleMode=""},setSplashScreen:function(){var b="InfinityMobile.view.tablet.SplashScreen";switch(currentProfile){case"phone":b="InfinityMobile.view.phone.SplashScreen";break;case"tablet":default:b="InfinityMobile.view.tablet.SplashScreen";break}var a=Ext.create(b,{});mainPanel.add(a)},removeSplashScreen:function(a){var b=this;if(!b.removedSplash){if(a!=null){clearInterval(a.clearSplash)}clearSplash();b.removedSplash=true}},initAppReader:function(){var a=this;a.loadArticleStore()},loadReader:function(e){var c=this;settings=e.data.items[0].raw;language=Ext.getStore("LanguageStore").data.items[0].raw;c.checkTribuneCommunity();mainPanel.fireEvent("settingsLoaded");var a=function(f){c.loadReaderStore(f)};c.loadReaderView(a);c.loadArchiveStore();if(settings.push!=null&&(window.location.protocol=="https:"||document.location.hostname=="localhost")){c.initializePush()}var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.tracking){var d=b.data.items[0].raw.tracking.trackingType;if(d=="GA"){c.initialiseGA(b.data.items[0].raw.tracking.accoundid)}else{if(d=="DA"){c.initialiseComScore(b.data.items[0].raw.tracking.accoundid)}}}if(Ext.os.is.Desktop&&settings.fullscreenPrompt!=null){Ext.create("InfinityMobile.view.FullscreenPrompt",{})}mainPanel.fireEvent("checkDataCapture");mainPanel.fireEvent("createDataCapture");mainPanel.fireEvent("initTracking")},loadReaderView:function(d){var c=this;if(navigator.onLine){var a="";if(stage){a="&stage=true"}var b="";if(typeof latestLM!="undefined"){b="&lm="+latestLM}$.ajax({crossDomain:true,type:"GET",contentType:"application/json; charset=utf-8",async:true,url:"../load_reader_view.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight+a+b}).done(function(e){c.modifyReaderView(e);d(e)})}},modifyReaderView:function(a){var g=this;var f=settings.reader;var h=settings.topbar;var l=a.subviews;for(var c=0;c<l.length;c++){var k=l[c];switch(k.globalID){case"ThumbLogo":case"ThumbLogoSmall":var n=k.states;for(var b=0;b<n.length;b++){var e=n[b];if(e.bindings.url!=null){e.bindings.url=h.logo;if(k.globalID=="ThumbLogoSmall"&&h.smallLogo){e.bindings.url=h.smallLogo}}}if(h.logoUrl!=null&&h.logoUrl!=""){console.log("GOT CUSTOM URL");var m=k.events.onTouch;for(var b=0;b<m.length;b++){var d=m[b];d.action="openURL";d.url=h.logoUrl}}break;case"ThumbLogoSmall":case"TopBar":case"topbar":var n=k.states;for(var b=0;b<n.length;b++){var e=n[b];if(e.bindings.backgroundColor!=null){e.bindings.backgroundColor="#"+h.backgroundColor}}if(currentProfile=="desktop"){k.type="PSLTopBar"}break;case"PreviousPageIcon":var n=k.states;for(var b=0;b<n.length;b++){var e=n[b];if(e.bindings.url!=null&&h.previousicon!="someimage.png"){e.bindings.url=h.previousicon}}break;case"NextPageIcon":var n=k.states;for(var b=0;b<n.length;b++){var e=n[b];if(e.bindings.url!=null&&h.nexticon!="someimage.png"){e.bindings.url=h.nexticon}}break;case"SearchIcon":var n=k.states;for(var b=0;b<n.length;b++){var e=n[b];if(e.bindings.url!=null&&h.searchicon!="someimage.png"){e.bindings.url=h.searchicon}}break;case"MenuIcon":var n=k.states;for(var b=0;b<n.length;b++){var e=n[b];if(e.bindings.url!=null&&h.menuicon!="someimage.png"){e.bindings.url=h.menuicon}}break;case"PageText":var n=k.states;for(var b=0;b<n.length;b++){var e=n[b];if(e.bindings.textColor!=null){e.bindings.textColor="#"+h.color}}break;case"SinglePageToggle":case"DoublePageToggle":if(f.toggleDPS=="false"){k.position.landscape.width=0;k.position.landscape.height=0}break;case"ZoomBar":k.type="PSLZoom";break}}},loadReaderStore:function(a){if(navigator.onLine){var c=Ext.getStore("EditionFlatplan");c.viewjson=a;var b="";if(typeof latestLM!="undefined"){b="&lm="+latestLM}c.setProxy({url:"../get_page_groups_from_eid.aspx?pubid="+publicationguid+"&eid="+editionguid+b});c.load()}},loadArchiveStore:function(){if(navigator.onLine){var e=settings.menu;var d=30;if(e!=null){d=e.archiveLength}var c="";if(typeof latestLM!="undefined"){c="&lm="+latestLM}var b="../../editionshtml5_json.aspx?publicationguid="+publicationguid+"&maxnumber="+d+c;if(currentProfile=="desktop"){b="../../editionsdesktop_json.aspx?publicationguid="+publicationguid+"&maxnumber="+d+c}var a=Ext.getStore("ArchiveStore");a.setProxy({url:b});a.load()}},loadSettingsStore:function(){var g="";try{var f=localStorage.getItem("checkLanguage"+publicationguid)}catch(c){var f=null}if(f!=null){var e=f;if(e!="false"){g="&language="+e}}var d=Ext.getStore("SettingStore");d.on({load:"loadReader",scope:this});var a="&version=production";if(version=="stage"){a="&version=stage"}var b="";if(typeof latestLM!="undefined"){b="&lm="+latestLM}d.setProxy({url:"../get_settings.aspx?pubid="+publicationguid+"&edid="+editionguid+"&device="+currentProfile+a+g+b});d.load()},loadArticleStore:function(){var b=Ext.getStore("ArticleStore");b.on({load:"loadLanguageStore",scope:this});var a="";if(typeof latestLM!="undefined"){a="&lm="+latestLM}b.setProxy({url:"../get_articles.aspx?&edid="+editionguid+"&pubid="+publicationguid+a});b.load()},loadLanguageStore:function(){var c=Ext.getStore("LanguageStore");c.on({load:"loadSettingsStore",scope:this});var a="&version=production";if(version=="stage"){a="&version=stage"}var b="";if(typeof latestLM!="undefined"){b="&lm="+latestLM}c.setProxy({url:"../get_language.aspx?pubid="+publicationguid+a+b});c.load()},initializePush:function(){var a=this;mainPanel.fireEvent("initializepush")}},0,0,0,0,0,0,[InfinityMobile.controller,"AppController"],0));(Ext.cmd.derive("InfinityMobile.controller.LayoutController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel",layoutviewcontroller:"layoutviewcontroller",readerViewController:"#readerViewController",carousel:"infinitecarousel2d",reader:"reader"},control:{main:{trapEvent:"TrapEvent"},layoutviewcontroller:{loadViewController:"layoutViewController"},readerpageviewer:{hideWrapAds:"hideWrapAds",showWrapAds:"showWrapAds"}}},layoutViewController:function(d){var c=this;var b=c.getSubViews(d.json,null,null,d,null);var a=this;d.setItems(b)},TrapEvent:function(e,c,g,d,a,b){var f=this;if(c.events[e]!=null){$.each(c.events[e],function(k,w){if(true){switch(w.action){case"removeView":mainPanel.removeView();break;case"loadView":var m=w.target;var s=Ext.getCmp(w.target);if(s!=null){var q="";if(w.viewid=="%Share Link%"){q=g["Share Link"]}else{q=w.viewid}s.loadViewByID(q)}else{if(g!=null&&(g["Share Link"]!=null)){var h="";if(g!=null){if(g["Share Link"]!=null){h=g["Share Link"]}}mainPanel.loadArticle(h)}else{if(w.viewid!=undefined&&w.viewid!=""){if(w.presentationStyle=="lightBox"){mainPanel.loadModalView(w,g,d,a)}else{mainPanel.loadview(w.viewid,g,d,a)}}}}break;case"set text":var o;o=Ext.getCmp(w.target);if(o!=null){o.setHtml(w.text)}else{console.log("No target")}break;case"loadDigitalEdition":var v="";var j="";if(w.publication=="%publicationguid%"||w.publicationguid=="%publicationguid%"){j=g.publicationguid}else{j=w.publication}if(w.edition=="%editionguid%"||w.editionguid=="%editionguid%"){v=g.editionguid}else{v=w.edition}var p=Ext.os.deviceType;if(p=="Desktop"){mainPanel.loadFlashReader(w.publication,v)}else{mainPanel.loadReader(applicatiionPlatformID,w.publication,v)}break;case"left":mainPanel.fireEvent("readerLeft");break;case"right":mainPanel.fireEvent("readerRight");break;case"showTutorial":mainPanel.fireEvent("showTutorial");break;case"openReaderMenu":mainPanel.fireEvent("openReaderMenu",w);break;case"loadURL":if(w.target!=null){Ext.Viewport.setMasked({xtype:"loadmask",message:"Loading"});var x=Ext.getCmp("collection"+w.target);if(x!=null){var t=x.json.templates[0].template;var h=g.url+"&maxarticles=2";$.ajax({crossDomain:true,type:"GET",async:true,data:{base64Url:$.base64.encode(h)},url:"../../API/binary_proxy.aspx"}).done(function(B){var C=$.JSONPath({data:B,resultType:"VALUE",keepHistory:true});var A=C.query("$."+x.json.rootKeyPath);var z=[];var y=0;$.each(A[0],function(E,F){if(y<30){var D=Ext.create("Ext.Container",{items:f.getSubViews(t,F,E,x,A[0])});z.push(D)}y++});x.subItems=z;x.setUpItems();Ext.Viewport.setMasked(false)})}}break;case"openURL":window.open(w.url,"_blank");break;case"changeState":var m=Ext.getCmp(w.target);if(m!=null){if(m.updateState!=null){m.updateState(w.state)}else{m.parent.updateState(w.state)}}break;case"download":var l={publicationguid:g.publicationguid,publicationname:g.publicationname,editionguid:g.editionguid,editionname:g.editionname,editiondate:g.editiondate,imageurl:g.imageurl};var u="edition"+g.editionguid;try{if(localStorage.getItem(u)==null){localStorage.setItem(u,JSON.stringify(l))}}catch(n){}break;case"removeDownload":var u="edition"+g.editionguid;try{if(localStorage.getItem(u)!=null){localStorage.removeItem(u)}}catch(n){}break;case"toggle dps mode":mainPanel.fireEvent("toggleDPSMode");break;case"dps mode on":mainPanel.fireEvent("dpsModeOn");break;case"dps mode off":mainPanel.fireEvent("dpsModeOff");break;case"sendFeedback":location.href="mailto:support@pagesuite.co.uk?subject=Feedback&body=Feedback";break;case"refresh":location.reload();break;case"clearCache":try{localStorage.clear()}catch(n){}location.reload();break;case"search":mainPanel.fireEvent("showSearch",g);break;case"jump to page":var r=parseInt(c.events.onTouch[0]["page number"])-1;mainPanel.fireEvent("pagejump",r);break;case"FirstPage":mainPanel.fireEvent("readerFirst");break;case"LastPage":mainPanel.fireEvent("readerLast");break;case"FullScreen":mainPanel.fireEvent("fullscreenMode");break;case"Fit":mainPanel.fireEvent("zoomModeFit");break;case"Fill":mainPanel.fireEvent("zoomModeFill");break;case"pageNumber":mainPanel.fireEvent("pageNumber",b);break;case"Archive":mainPanel.fireEvent("archive");break;case"Sections List":mainPanel.fireEvent("toolbarSectionList");break;case"Zones":mainPanel.fireEvent("toolbarZones");break;default:console.log(w.action)}}})}},GetState:function(a,b){if(a.states.length==1){return a.states[0].bindings[b]}else{var c=null;$.each(a.states,function(d,e){if(e.name=="default"){if(c==null){c=e}if(e.orientation.landscape==true&&Ext.Viewport.orientation=="landscape"){c=e}if(e.orientation.portrait==true&&Ext.Viewport.orientation=="portrait"){c=e}}});if(c.bindings[b]==undefined){return a.states[0].bindings[b]}else{return c.bindings[b]}}},AddBorder:function(b,a){return b.borders[Ext.Viewport.orientation][a].width+" "+b.borders[Ext.Viewport.orientation][a].type+" "+b.borders[Ext.Viewport.orientation][a].color},AddText:function(o,c,a,s,g,e){var q=this;var d=q.GetState(o,"text");if(s!=null&&s!=undefined){if(d.indexOf("%")==0&&d.indexOf(".")==-1){d=d.replace(d,s[d.substr(1,d.length-2)])}else{if(d.indexOf("%")==0){var h=$.JSONPath({data:s,resultType:"VALUE",keepHistory:true});var j=h.query("$."+d.substr(1,d.length-2));d=j[0]}}}var p=q.GetState(o,"textSize");var l=q.GetState(o,"justification");var k=q.GetState(o,"textColor");var b=q.GetState(o,"opacity");var n=q.GetState(o,"backgroundColor");var r=q.GetState(o,"objectOpacity");if(n==null){n="#ffffff"}if(r==null){r="1"}if(c==null){c=""}var f=Ext.create("Ext.Label",{html:d,id:o.identifier+c,height:o.position[Ext.Viewport.orientation].height,style:{opacity:r,"vertical-align":"middle",display:"table-cell"}});var m=Ext.create("InfinityMobile.view.LayoutTextView",{json:o,parentContainer:e,listeners:[{element:"element",event:"tap",fn:function(t){if(s!=null){q.TrapEvent("onTouch",o,s,g,c,this)}else{q.TrapEvent("onTouch",o,null,g,c,this)}t.stopPropagation()}}],items:[{style:"display:inline-block;width:auto;height:100%;text-align:"+l+";font-size:"+p+"px;",items:[f]}]});return m},AddButton:function(o,h,e,f,b,m){var l=this;var a=l.GetState(o,"text");if(f!=null){a=a.replace("%editionname%",f.editionname);a=a.replace("%price%",f.price)}var k=l.GetState(o,"textSize");var j=l.GetState(o,"justification");var d=l.GetState(o,"textColor");var g=l.GetState(o,"opacity");var n=Ext.create("Ext.Label",{html:a,style:{"font-size":k+"px","text-align":j,color:d,opacity:g,"vertical-align":"middle"}});var c=Ext.create("InfinityMobile.view.LayoutView",{json:o,parentContainer:m,contenttype:"button",type:"vbox",align:"center",pack:"center",listeners:[{element:"element",event:"tap",fn:function(){if(f!=null){l.TrapEvent("onTouch",o,f,b,h)}else{l.TrapEvent("onTouch",o,null,b,h)}}}],items:[n]});return c},AddTableView:function(l,d,g,k){var h=this;var a=[];var j=h.GetState(l,"backgroundColor");var f=h.GetState(l,"opacity");var c="0px";if(h.GetState(l,"cornerRadius")!=null){c=c=h.GetState(l,"cornerRadius")+"px"}var m=$.JSONPath({data:g,resultType:"VALUE",keepHistory:true});var e=m.query("$."+l.rootKeyPath);$.each(e[0],function(p,q){var o=[];var n=calculatetemplate(p,l);$.each(n.subviews,function(u,s){if(s.type=="PSLImageView"){var t=h.AddImage(s,p,0,q,e[0]);o.push(t)}else{if(s.type=="PSLLabel"){var w=h.AddText(s,p,0,q,e[0]);o.push(w)}else{if(s.type=="PSLShape"){var w=h.AddShape(s,p,0,q,e[0]);o.push(w)}else{if(s.type=="PSLButton"){var v=h.AddButton(s,p,0,q,e[0]);o.push(v)}else{console.log("Missing "+s.type)}}}}});var r=Ext.create("Ext.Container",{height:n.position.portrait.height,width:n.position.portrait.width,items:o,layout:"hbox"});a.push(r)});var b=Ext.create("InfinityMobile.view.LayoutView",{json:l,parentContainer:k,contenttype:"tableview",scrollable:"vertical",style:{"border-left":h.AddBorder(l,"left"),"border-right":h.AddBorder(l,"right"),"border-top":h.AddBorder(l,"top"),"border-bottom":h.AddBorder(l,"bottom"),opacity:f,"background-color":j,"border-radius":c,"webkit-border-radius":c,"-moz-border-radius":c},items:a});return b},AddCollectionView:function(j,d,f,h){var g=this;var k=$.JSONPath({data:f,resultType:"VALUE",keepHistory:true});var e=k.query("$."+j.rootKeyPath);var b=[];var a=0;$.each(e[0],function(n,o){if(a<30){var l=[];$.each(j.templates[0].template.subviews,function(r,p){switch(p.type){case"PSLImageView":var q=g.AddImage(p,n,0,o,e[0]);l.push(q);break;case"PSLLabel":var t=g.AddText(p,n,0,o,e[0]);l.push(t);break;case"PSLShape":case"PSLHorizontalKeyline":case"PSLVerticalKeyline":var t=g.AddShape(p,n,0,o,e[0]);l.push(t);break;case"PSLButton":var s=g.AddButton(p,n,0,o,e[0]);l.push(s);break;default:console.log("Missing "+p.type);break}});var m=Ext.create("InfinityMobile.view.LayoutCollectionViewCell",{pageNo:a,items:l});b.push(m);a++}});var c=Ext.create("InfinityMobile.view.LayoutCollectionView",{id:"collection"+j.identifier,json:j,parentContainer:h,contenttype:"collectionview",content:f,subItems:b});return c},AddImage:function(p,d,b,r,j,g){var q=this;var e=q.GetState(p,"url");if(settings.newsday!=null){switch(p.globalID.toLowerCase()){case"firstpageicon":if(settings.newsday.firstPageIcon!=null){if(settings.newsday.firstPageIcon.length>0){e=settings.newsday.firstPageIcon}}break;case"lastpageicon":if(settings.newsday.lastPageIcon!=null){if(settings.newsday.lastPageIcon.length>0){e=settings.newsday.lastPageIcon}}break;case"":if(e=="http://html5.pagesuite.com/reader/assets/reader%20icons/back-transparent.png"){if(settings.newsday.prevPageIcon!=null){if(settings.newsday.prevPageIcon.length>0){e=settings.newsday.prevPageIcon}}}if(e=="http://html5.pagesuite.com/reader/assets/reader%20icons/next-transparent.png"){if(settings.newsday.nextPageIcon!=null){if(settings.newsday.nextPageIcon.length>0){e=settings.newsday.nextPageIcon}}}break}}if(r!=null){if(e.indexOf("%")==0&&e.indexOf(".")==-1){e=e.replace(e,r[e.substr(1,e.length-2)])}else{if(e.indexOf("%")==0){var l=$.JSONPath({data:r,resultType:"VALUE",keepHistory:true});var m=l.query("$."+e.substr(1,e.length-2));if(m.length>0){e=m[0]}else{e=""}}}}if(e.indexOf("{width}")>-1){e=e.replace("{width}","186")}if(e.indexOf("{height}")>-1){e=e.replace("{height}","110")}if(e.indexOf("get_image")>-1){var h=p.position[Ext.Viewport.orientation].height.toString();if(h.indexOf(".")>-1){h=h.substr(0,h.indexOf("."))}var c=(h*window.devicePixelRatio);if(c.toString().indexOf(".")>-1){c=c.toString().substr(0,c.toString().indexOf("."))}e=e+="&h="+c}if(e=="http://origin.media.cdn.pagesuite.com/psapps/images/45/puzzle.png"){}var n=p.borders[Ext.Viewport.orientation]["top"].width.substr(0,p.borders[Ext.Viewport.orientation]["top"].width.length-2)+p.borders[Ext.Viewport.orientation]["bottom"].width.substr(0,p.borders[Ext.Viewport.orientation]["bottom"].width.length-2);var f=p.borders[Ext.Viewport.orientation]["left"].width.substr(0,p.borders[Ext.Viewport.orientation]["left"].width.length-2)+p.borders[Ext.Viewport.orientation]["right"].width.substr(0,p.borders[Ext.Viewport.orientation]["right"].width.length-2);var k=q.GetState(p,"scaleMode");var a="background-size: contain;";if(k!=null&&k=="aspect fill"){var a="background-size: cover;"}if(d==null){d=""}if(p.globalID=="ThumbLogo"){a+="background-position: left center"}var s=Ext.create("Ext.Img",{src:e,scrollable:null,height:"100%",width:"100%",id:p.identifier+d,style:a});var o=Ext.create("InfinityMobile.view.LayoutView",{contenttype:"image",scrollable:null,json:p,parentContainer:g,listeners:[{element:"element",event:"tap",fn:function(t){if(r!=null){q.TrapEvent("onTouch",p,r,j,d)}else{q.TrapEvent("onTouch",p,null,j,d)}t.stopPropagation();t.preventDefault()}}],items:s});return o},AddShape:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.LayoutView",{json:c,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(j){if(h!=null){f.TrapEvent("onTouch",c,h,e,b)}else{f.TrapEvent("onTouch",c,null,e,b)}j.stopPropagation()}}]});return a},AddSlider:function(j,e,c,d,a,h){var f=this;var g=f;var b=Ext.create("InfinityMobile.view.ReaderZoomSlider",{json:j,parentContainer:h});return b},AddTopBar:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.desktop.LayoutToolBarView",{json:c,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(j){if(h!=null){f.TrapEvent("onTouch",c,h,e,b)}else{f.TrapEvent("onTouch",c,null,e,b)}j.stopPropagation()}}]});return a},AddAdvert:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.LayoutAdvertView",{json:c,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(){if(h!=null){f.TrapEvent("onTouch",c,h,e,b)}else{f.TrapEvent("onTouch",c,null,e,b)}}}]});return a},AddVideo:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.LayoutVideoView",{json:c,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(){if(h!=null){f.TrapEvent("onTouch",c,h,e,b)}else{f.TrapEvent("onTouch",c,null,e,b)}}}]});return a},AddWebView:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.LayoutWebView",{json:c,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(){if(h!=null){f.TrapEvent("onTouch",c,h,e,b)}else{f.TrapEvent("onTouch",c,null,e,b)}}}]});return a},AddViewController:function(c,b,g,h,e,d){var f=this;var a=Ext.create("InfinityMobile.view.LayoutViewController",{json:c,id:c.identifier,parentContainer:d,listeners:[{element:"element",event:"tap",fn:function(j){if(h!=null){f.TrapEvent("onTouch",c,h,e,b)}else{f.TrapEvent("onTouch",c,null,e,b)}}}]});return a},AddReader:function(s,k){var y=this;if(settings.topbar.toggleTopBar=="true"){s.position.portrait.y=0;s.position.landscape.y=0;s.position.portrait.height+=40;s.position.landscape.height+=40}k.flatplandata=k.config.flatplandata;var m=k.flatplandata;var j=m.pageGroups;y.editionGuid=m.editionGUID;var n=0;var d=y.retrievePageNumber();if(pageNumber!=""){n=parseInt(pageNumber)-1}else{if(d!=1){n=d-1}}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){n=j.length-n-1}var t=settings.reader.defaultPageMode;var v=settings.reader.zoomMode;var c=settings.page.renderMode;var o=Ext.create("InfinityMobile.view.2DInfiniteCarousel",{width:"100%",flex:1,json:s,pageNumber:n,data:j,pageXPath:"pages",landscapePageIncrement:2,mode:t,zoomMode:v,pageTemplate:function(E,G,A){var D=this;if(pageOffset!=0){G=Math.min((G+pageOffset),(A.length-1));E=A[G].pages[0]}var C="";if((G-1)>=0){C=A[(G-1)].pages[0]}var B="";if((G+1)<=(A.length-1)){B=A[(G+1)].pages[0]}G=G-pageOffset;var z="InfinityMobile.view.ReaderPageViewer";if(c=="PDF"){z="InfinityMobile.view.ReaderPageViewerPDF"}var F=Ext.create(z,{page:E,previousPage:C,nextPage:B,pageNo:G,mode:D._mode,editionGuid:m.editionGUID});return F},returnPage:function(z,C){var A=this;var B="";z=z+pageOffset;if(z>=0&&z<A.getData().length-1){B=A.getData()[z].pages[0]}return B}});var q="e1e1e1";if(settings.reader.backgroundColor!=null){q=settings.reader.backgroundColor}var p=Ext.create("InfinityMobile.view.LayoutView",{id:"reader",layout:"vbox",json:s,parentContainer:k,items:[o],style:"background-color:#"+q});if(settings.reader.bannerAd!=null){var f="InfinityMobile.view.tablet.ReaderBannerAd";switch(currentProfile){case"phone":f="InfinityMobile.view.phone.ReaderBannerAd";break;case"tablet":default:f="InfinityMobile.view.tablet.ReaderBannerAd";break}var x=Ext.create(f,{pageNumber:n});if(settings.reader.bannerAd.canBeClosed==null||settings.reader.bannerAd.canBeClosed=="false"){p.add(x)}else{x.setBottom(0);Ext.Viewport.add(x)}}var g=0;if(settings.RSSTicker!=null){var h=settings.RSSTicker.split("|");var w=Ext.create("InfinityMobile.view.ReaderTicker",{url:h[1],num:h[0]});g=40;p.add(w)}y.articles=y.getApplication().getController("ArticleController").getArticles();var u=Ext.getStore("SettingStore");var l=[];if(u.data.items[0].raw.bookmarks!=null){l=u.data.items[0].raw.bookmarks.bookmark}if(y.articles.length>0){if(Ext.os.is.Phone){}else{if(Ext.os.is.Desktop){var a=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){a=false}}if(a){var e=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:y.articles,sections:l,mode:"toggle"})}else{var e=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:y.articles,sections:l,mode:"toggle"})}}else{var e=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:y.articles,sections:l,mode:"toggle"})}Ext.Viewport.add(e)}}else{if(!Ext.os.is.Phone){if(Ext.os.is.Desktop){var a=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){a=false}}if(a){var e=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:y.articles,sections:l,mode:"toggle"})}else{var e=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:y.articles,sections:l,mode:"toggle"})}}else{var e=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:y.articles,sections:l,mode:"toggle"})}Ext.Viewport.add(e)}}if(settings.reader.dataCapture!=null){try{var b=localStorage.getItem("datacapture"+publicationguid)}catch(r){var b=null}if(b==null){if(!Ext.os.is.Phone){e.hideMe()}}}return p},setupDesktopReader:function(j,a){var e=this;if(settings.topbar.toggleTopBar=="true"){j.position.portrait.y=0;j.position.landscape.y=0;j.position.portrait.height+=40;j.position.landscape.height+=40}a.flatplandata=a.config.flatplandata;var d=a.flatplandata;var c=d.pageGroups;e.editionGuid=d.editionGUID;startingPageNumber=0;var h=e.retrievePageNumber();if(pageNumber!=""){startingPageNumber=parseInt(pageNumber)-1}else{if(h!=1){startingPageNumber=h-1}}if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){startingPageNumber=c.length-startingPageNumber-1}var b=settings.reader.defaultPageMode;var g=settings.reader.zoomMode;var f="0px";if((typeof isTribReader!="undefined"&&isTribReader==true)||settings.reader.enableReaderPadding=="true"){if(settings.reader.wrapAd!=null){f="20px 0px"}else{f="20px 150px"}}if(b=="double"){startingPageNumber=d.pageMapper[startingPageNumber+1]-1}e.desktopReader=Ext.create("InfinityMobile.view.PDFInfiniteCarousel",{width:"100%",flex:1,json:j,pageNumber:startingPageNumber,data:c,pageXPath:"pages",landscapePageIncrement:2,mode:b,zoomMode:g,cls:"pdfinfinitecarousel "+g,style:"padding:"+f+";",pageTemplate:function(o,A,s){var D=this;var C="InfinityMobile.view.ReaderPageViewer";if(currentProfile=="desktop"){C="InfinityMobile.view.desktop.DesktopPageViewer"}var t="";var m="";var r="";var B="";var z="";var l="";var n=A+1;if(n%2==0){n++}n--;n=n+pageOffset;var y=n;if(y<=(s.length-1)){B=s[(y)].pages[0]}var p=(n-1);if(p>=0){if(s[p]!=null){r=s[p].pages[0]}}var E=(n-2);if(E>=0){m=s[E].pages[0]}var w=(n-3);if(w>=0){var k=s[w].pages[0];if(k.type=="page"){t=s[w].pages[0]}}var q=(n+1);if(q<=(s.length-1)){z=s[(q)].pages[0]}var v=(n+2);if(v<=(s.length-1)){var u=s[v].pages[0];if(u.type=="page"){l=s[(v)].pages[0]}}if((B.type=="advert"||r.type=="advert")&&settings.reader.interstitialPageFlow!=null){card=Ext.create("InfinityMobile.view.AdvertPageViewer",{pageNo:A,advertType:settings.reader.interstitialPageFlow.type,networkCode:settings.reader.interstitialPageFlow.networkCode,adUnit:settings.reader.interstitialPageFlow.adUnit,advertSize:settings.reader.interstitialPageFlow.size,adUrl:settings.reader.interstitialPageFlow.url,adLink:settings.reader.interstitialPageFlow.link,targeting:settings.reader.interstitialPageFlow.targeting,side:o.side,previousPage:m,nextPage:z});return card}else{var x=Ext.create(C,{pageNo:A,rightPage:B,leftPage:r,previousPage:m,hiddenLeftPage:t,nextPage:z,hiddenRightPage:l,mode:D._mode,zoomMode:D._zoomMode,editionGuid:d.editionGUID});return x}},returnPage:function(k,n){var l=this;var m="";k=k+pageOffset;if(k>=0&&k<=l.getData().length-1){m=l.getData()[k].pages[0]}return m}})},returnAdvertOffset:function(a){var b=this},setupReaderView:function(k,a){var h=this;var c="e1e1e1";if(settings.reader.backgroundColor!=null){c=settings.reader.backgroundColor}var b="none";if(settings.reader.backgroundImage!=""){b="url('"+settings.reader.backgroundImage+"')"}var j="cover";var g="no-repeat";var d="center";switch(settings.reader.backgroundImageLayout){case"cover":default:j="cover";g="no-repeat";d="center";break;case"contain":j="contain";g="no-repeat";d="center";break;case"stretch":j="100% 100%";g="no-repeat";d="center";break;case"repeat":j="auto";g="repeat";d="left top";break}var f="0";var e=Ext.create("InfinityMobile.view.ReaderView",{id:"reader",cls:"dekstopreader",layout:"vbox",json:k,parentContainer:a,fillPadding:f});h.desktopReader.element.dom.style.position="absolute";h.desktopReader.element.dom.style.height="100%";e.readerContainer.add(h.desktopReader);e.setStyle({backgroundColor:"#"+c,backgroundImage:b,backgroundSize:j,backgroundRepeat:g,backgroundPosition:d});return e},setupWrapAds:function(d){var e=this;if(settings.reader.wrapAd!=null){var b=parseInt(startingPageNumber)+1;var a=Ext.create("InfinityMobile.view.BackgroundWrapAdItem",{bottom:0,left:0,side:"left",pageNo:b});d.leftPadding.add(a);var c=Ext.create("InfinityMobile.view.BackgroundWrapAdItem",{bottom:0,right:0,side:"right",pageNo:b});d.rightPadding.add(c)}else{}},setupBannerAd:function(d,a){var g=this;if(settings.reader.bannerAd!=null){var k="InfinityMobile.view.tablet.ReaderBannerAd";switch(currentProfile){case"phone":k="InfinityMobile.view.phone.ReaderBannerAd";break;case"tablet":default:k="InfinityMobile.view.tablet.ReaderBannerAd";break}var b=parseInt(startingPageNumber)+1;var h=g.returnSection(b);var c=Ext.create(k,{pageNumber:b,section:h});if(settings.reader.bannerAd.position=="top"){var j=settings.topbar.backgroundColor.indexOf("#")==0?settings.topbar.backgroundColor:"#"+settings.topbar.backgroundColor;if(typeof g.hexaToRgba==="function"&&typeof g.hexToRgb==="function"){if(j.length>=8){j=g.hexaToRgba(j)}else{var f=g.hexToRgb(j);var e=settings.topbar.opacity!=null?settings.topbar.opacity:"0.9";j="rgba("+f.r+","+f.g+","+f.b+","+e+")"}}c.setStyle({backgroundColor:j});c.setStyle({borderBottom:"1px solid #ffffff"});c.setDocked("top");a.insert(0,c);c.show();d.bottomContainer.setHeight(0)}else{if(settings.reader.bannerAd.canBeClosed==null||settings.reader.bannerAd.canBeClosed=="false"){d.bottomContainer.add(c)}else{d.bottomContainer.setHeight(0);Ext.Viewport.add(c);c.setBottom(0);c.show()}}}else{d.bottomContainer.hide()}},returnSection:function(a){var e=this;var h=settings.bookmarks.bookmark;var f=null;if(h!=null&&h.length>0){for(var c in h){var b=parseInt(h[c].pageNumber);if(h[c].start!=null){b=h[c].start}var g=h[parseInt(c)+1];var d=null;if(g!=null){d=g.pageNumber;if(g.start!=null){d=g.start}}if(parseInt(a)>=b&&(d==null||parseInt(a)<parseInt(d))){f=h[c].name;break}}}return f},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},hexaToRgba:function(h){var j=h.match(/.{2}/g);if(j.length!=4){$("<p />",{"class":"user-message warning"}).text("Value provided is invalid.").insertAfter("form").hide().slideDown();$("#hex").addClass("error");$("#rgba").slideUp();return false}else{$("#hex").removeClass("error");$(".user-message").slideUp()}var g=function(a){return parseInt(a,16)};var f=function(a){return parseFloat(parseInt((parseInt(a,16)/255)*1000)/1000)};var b,e=[];b=f(j[3]);$.each(j.slice(0,3),function(c,a){e.push(g(a))});return e.join(",")+","+b},setupArticlesContainer:function(){var d=this;d.articles=d.getApplication().getController("ArticleController").getArticles();var c=Ext.getStore("SettingStore");var e=[];if(c.data.items[0].raw.bookmarks!=null){e=c.data.items[0].raw.bookmarks.bookmark}if(d.articles!=null&&d.articles.length>0){if(Ext.os.is.Phone){var a=Ext.create("InfinityMobile.view.phone.ArticlesContainer",{articles:d.articles,sections:e})}else{if(Ext.os.is.Desktop){var b=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){b=false}}if(b){var a=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:d.articles,sections:e,mode:"toggle"})}else{var a=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:d.articles,sections:e,mode:"toggle"})}}else{var a=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:d.articles,sections:e,mode:"toggle"})}}Ext.Viewport.add(a);a.show()}else{if(Ext.os.is.Desktop){var b=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){b=false}}if(b){var a=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:d.articles,sections:e,mode:"toggle"})}else{var a=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:d.articles,sections:e,mode:"toggle"})}}else{var a=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:d.articles,sections:e,mode:"toggle"})}Ext.Viewport.add(a);a.show()}},setupDataCapture:function(){var c=this;if(settings.reader.dataCapture!=null){try{var b=localStorage.getItem("datacapture"+publicationguid)}catch(a){var b=null}if(b==null){articlesContainer.hideMe()}}},AddDesktopReader:function(c,a){var d=this;d.setupDesktopReader(c,a);var b=d.setupReaderView(c,a);d.setupBannerAd(b,a);d.setupWrapAds(b);d.setupArticlesContainer();d.setupDataCapture();return b},retrievePageNumber:function(){var b=1;if(settings.reader.trackPagePosition!=null&&settings.reader.trackPagePosition=="true"){try{if(localStorage.getItem("page"+editionguid)!=null){var a=JSON.parse(localStorage["page"+editionguid]);var e=new Date();e=e.setHours(e.getHours()-1);var d=a.date;if(d>e){b=a.pageNumber}}}catch(c){}}return b},AddTextField:function(c,b,f,g,d){var e=this;var a=Ext.create("InfinityMobile.view.LayoutTextFieldView",{json:c,listeners:[{element:"element",event:"tap",fn:function(h){if(g!=null){e.TrapEvent("onTouch",c,g,d,b)}else{e.TrapEvent("onTouch",c,null,d,b)}h.stopPropagation()}}]});return a},getSubViews:function(g,f,b,a,c){var d=this;var e=[];$.each(g.subviews,function(o,u){switch(u.type){case"PSLImageView":var t=d.AddImage(u,b,0,f,c,a);e.push(t);break;case"PSLLabel":var h=d.AddText(u,b,0,f,c,a);e.push(h);break;case"PSLShape":case"PSLHorizontalKeyline":case"PSLVerticalKeyline":var h=d.AddShape(u,b,0,f,c,a);e.push(h);break;case"PSLButton":var m=d.AddButton(u,b,0,f,c,a);e.push(m);break;case"PSLAdvertView":var p=d.AddAdvert(u,b,0,f,c,a);e.push(p);break;case"PSLVideoPlayerView":var n=d.AddVideo(u,b,0,f,c,a);e.push(n);break;case"PSLWebView":var k=d.AddWebView(u,b,0,f,c,a);e.push(k);break;case"PSLTableView":var r=function(v){var w=d.AddTableView(u,0,v,a);e.push(w)};d.getCollectionType(u,r);break;case"PSLCollectionView":var r=function(v){var w=d.AddCollectionView(u,0,v,a);e.push(w)};d.getCollectionType(u,r);break;case"PSLViewController":var s=d.AddViewController(u,b,0,f,c,a);e.push(s);break;case"PSLReaderViewController":if(currentProfile=="desktop"){d.myReader=d.AddDesktopReader(u,a)}else{d.myReader=d.AddReader(u,a)}e.push(d.myReader);break;case"PSLTextField":var j=d.AddTextField(u,b,0,f,c,a);e.push(j);break;case"PSLZoom":var l=d.AddSlider(u,b,0,f,c,a);e.push(l);break;case"PSLTopBar":var q=d.AddTopBar(u,b,0,f,c,a);e.push(q);break;default:console.log("Missing "+u.type);break}});return e},getCollectionType:function(d,h){try{if(d.dataURL=="%DOWNLOADS%"){var g={Data:[]};for(var c=0;c<localStorage.length;c++){var b=localStorage.key(c);if(b.indexOf("edition")!=-1){var f=JSON.parse(localStorage[b]);g.Data.push(f)}}h(g)}else{if(navigator.onLine){$.ajax({crossDomain:true,type:"GET",async:false,data:{base64Url:$.base64.encode(d.dataURL)},url:"../../API/binary_proxy.aspx"}).done(function(j){localStorage.setItem("binary_proxy"+$.base64.encode(d.dataURL),JSON.stringify(j));h(j)})}else{if(localStorage.getItem("binary_proxy"+$.base64.encode(d.dataURL))!=null){var e=JSON.parse(localStorage.getItem("binary_proxy"+$.base64.encode(d.dataURL)));h(e)}else{console.log("Could not find offline copy for: binary_proxy"+$.base64.encode(d.dataURL))}}}}catch(a){}},hideWrapAds:function(){var a=this;var b=Ext.ComponentQuery.query(".backgroundwrapaditem");for(ad in b){b[ad].hide()}},showWrapAds:function(){var a=this;var b=Ext.ComponentQuery.query(".backgroundwrapaditem");for(ad in b){b[ad].show()}}},0,0,0,0,0,0,[InfinityMobile.controller,"LayoutController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderController",Ext.app.Controller,{config:{stores:["EditionFlatplan"],refs:{carousel:"infinitecarousel2d",readerView:"#reader",readerPanel:"reader",main:"#rootPanel",readerViewController:"#readerViewController",readerhelper:"readerhelper",readerlanguage:"readerlanguage",downloadEditionButton:"#ReaderMenuDownload",interstitial:"interstitial",readerpageviewer:"readerpageviewer",zoomSlider:"zoomSlider",navbutton:"navbutton",articlecarousel:"articlecarousel",articlescontainer:"articlescontainer",layouttoolbar:"layouttoolbar",readermenutts:"readermenutts",readertoolbarbottom:"readertoolbarbottom",bannerAd:"readerbannerad",layoutviewcontroller:"layoutviewcontroller"},control:{carousel:{pagechange:"readerPageChange",idle:"readerIdle",notidle:"killActiveRequest",showLeft:"showLeft",hideLeft:"hideLeft",showRight:"showRight",hideRight:"hideRight",resizeArticleController:"resizeArticleController",updatePageNumber:"setCurrentPageNumber"},readerPanel:{cacheEdition:"cacheEdition",ready:"readerContainerReady",toggleNavButtons:"toggleNavButtons"},readerhelper:{next:"helperNext",close:"closeHelper",articleHelper:"articleHelper"},articlehelper:{close:"closeHelper"},readerlanguage:{cancel:"languageCancel",update:"languageUpdate"},downloadEditionButton:{click:"downloadEdition"},interstitial:{closeInterstitial:"closeInterstitial"},main:{pagejump:"jumpToPage",checkActivePageInToolbarBottom:"checkActivePageInToolbarBottom"},zoomSlider:{zoomStart:"zoomStart",zoom:"zoom",zoomEnd:"zoomEnd"},navbutton:{jumpToPage:"jumpToPage",scrollLeft:"scrollLeft",scrollRight:"scrollRight",scrollUp:"scrollUp",scrollDown:"scrollDown"},readerpageviewer:{hideNavButtons:"hideNavButtons",showNavButtons:"showNavButtons",hideTop:"hideTop",showTop:"showTop",hideBottom:"hideBottom",showBottom:"showBottom",fitMode:"fitMode",fillMode:"fillMode",checkWrapAd:"checkWrapAd",checkPagesBrowser:"checkPagesBrowser",setupPrintContainer:"setupPrintContainer",setZoom:"setZoom"},articlesectionitemimg:{jumpToPage:"jumpToPage"},articlesectionitem:{jumpToPage:"jumpToPage"},backgroundwrapaditem:{resizeWrapAds:"resizeWrapAds"},articlescontainer:{checkActivePageInBrowser:"checkActivePageInBrowser"},readerbannerad:{bannerAdClose:"bannerAdClose"}}},init:function(){var b=this;b.loadPage=null;b.preRolAd=false;var a=Ext.getStore("EditionFlatplan");a.on({load:"editionFlatplanLoad",scope:this});b.initializeDB();b.initCacheVariables();b.canChangeAd=true;pageOffset=0;b.swipesUntilNewBannerAd=-1;Ext.Viewport.on("orientationchange",function(){b.ttsStateChange()});ttsFlag={status:"STOPPED"}},initCacheVariables:function(){var c=this;var a=document.createElement("canvas");var b=a.getContext("2d");c.needToClearBuffer=false;c.canProgressiveDownload=true;devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1;c.bufferValue=6;c.needToClearBuffer=true;c.canProgressiveDownload=true;activerequest=null},initializeDB:function(){var a=this},editionFlatplanLoad:function(a){var b=this;flatPlanData=a.data.items[0].raw;flatPlanData.sectionPageCount=0;b.storeOriginalNumbers();b.checkLeftHandAdvert();b.checkCheckSectionPages();b.checkAdvertInPageFlow();if(settings.reader.reverse!=null&&settings.reader.reverse=="true"){flatPlanData.pageGroups=flatPlanData.pageGroups.reverse()}b.setFirendlyPageNumbering(flatPlanData);b.setupPdfPageGroups();b.loadEditionMedia(flatPlanData,a);b.mediaController=b.getApplication().getController("MediaController")},setupPdfPageGroups:function(){flatPlanData.pdfPages=[];for(var b in flatPlanData.pageGroups){var a=flatPlanData.pageGroups[b].pages[0];if(a.type=="page"){flatPlanData.pdfPages.push(flatPlanData.pageGroups[b])}}},storeOriginalNumbers:function(){for(var a in flatPlanData.pageGroups){flatPlanData.pageGroups[a].pages[0].origPageNum=flatPlanData.pageGroups[a].pages[0].pageNum;flatPlanData.pageGroups[a].pages[0].pageName=flatPlanData.pageGroups[a].pages[0].pageNum;flatPlanData.pageGroups[a].pages[0].advertsAdded=0}},setFirendlyPageNumbering:function(f){if(settings.reader.friendlyNumbering!=null){var l=f.pageGroups.length;f.friendlyPageMapper={};var g=settings.reader.friendlyNumbering;var k=g.split("|");var m=[];var o=0;for(var h=0;h<k.length;h++){var j=k[h];var d=parseInt(k[h].split(":")[1]);if(j!=""){var b={name:k[h].split(":")[0],pageNumber:d};m.push(b);if(h>0){m[h-1].sectionLength=(d-o);if(h==(k.length-2)){m[h].sectionLength=l-d}}o=d}}if(m.length>0){var a=m[0];var e=null;if(m.length>1){e=m[1]}var n=f.pageGroups;var q=1;var c=1;for(var h=0;h<n.length;h++){var p=n[h].pages[0];if(e!=null){if(e.pageNumber==h){q++;c=1;a=e;if(m.length>q){e=m[q]}else{e=null}}}p.pageName=a.name+c;p.sectionLength=a.sectionLength;f.friendlyPageMapper[p.pageName]=h;c++}}}},checkLeftHandAdvert:function(){var c=this;if(settings.leftSideAd!=null){var b=null;if(settings.leftSideAd.link!=null){b=settings.leftSideAd.link}var a=settings.leftSideAd.url;if(location.protocol=="https:"&&settings.leftSideAd.url!=null){a=a.replace("http://pages.cdn.pagesuite.com","https://pages.pagesuite.com")}var e={image:a,adType:settings.leftSideAd.type,adUnit:settings.leftSideAd.adunit,networkCode:settings.leftSideAd.networkcode,pageIndex:1,pageNum:1,pdf:"",versionKey:"",view:0,type:"leftHandAd",link:b};var d={pages:[e]};flatPlanData.pageGroups.splice(0,0,d);pageOffset=1}},checkCheckSectionPages:function(){var f=this;if(typeof isTribReader!="undefined"&&isTribReader==true&&settings.reader.sectionFront!="false"){var a=settings.bookmarks;if(a!=null&&a.bookmark!=null&&a.bookmark.length>0){var b=[];for(var d=(a.bookmark.length-1);d>=0;d--){var g=a.bookmark[d];var j=parseInt(g.pageNumber);if(j!=1){b.push(parseInt(g.pageNumber))}b.sort(function(l,k){return k-l})}var c=0;for(var d=0;d<b.length;d++){var j=b[d];if(j%2==1){var j=b[d];var h={image:brandingFolder+"/previous-section@2x.png",pageIndex:j-1,pageNum:j,pdf:"",versionKey:"",view:0,type:"sectionpage"};var e={pages:[h]};flatPlanData.pageGroups.splice(j-1+pageOffset,0,e);c++;var h={image:brandingFolder+"/next-section@2x.png",pageIndex:j-2,pageNum:j-1,pdf:"",versionKey:"",view:0,type:"sectionpage"};var e={pages:[h]};flatPlanData.pageGroups.splice(j-1+pageOffset,0,e);c++}}flatPlanData.sectionPageCount=c;flatPlanData.bookmarks=b}}},checkAdvertInPageFlow:function(){flatPlanData.totalAdvertsAdded=0;if(settings.reader.interstitialPageFlow!=null){var b=settings.reader.interstitialPageFlow;var a=b.count;var e=JSON.parse(JSON.stringify(flatPlanData.pageGroups));var f=0;var g=0;for(var c=pageOffset;c<e.length;c++){var d=flatPlanData.pageGroups[c+g].pages[0];d.pageName=d.pageNum;d.pageNum+=f;d.advertsAdded=f;if(c!=pageOffset&&c%a==pageOffset){flatPlanData.pageGroups.splice(c+1+g,0,{pages:[{type:"advert",advert:b,pdf:"",pageIndex:d.pageNum+1,pageNum:d.pageNum+1,pageName:"Advertisement",side:"left"}]});flatPlanData.pageGroups.splice(c+2+g,0,{pages:[{type:"advert",advert:b,pdf:"",pageIndex:d.pageNum+1,pageNum:d.pageNum+1,pageName:"Advertisement",side:"right"}]});f++;g+=2}}flatPlanData.totalAdvertsAdded=g}},loadEditionMedia:function(e,a){var d=this;var c=Ext.getStore("MediaStore");c.on({load:function(){d.loadEdition(e,a.viewjson)}});var b="";if(typeof latestLM!="undefined"){b="&lm="+latestLM}c.setProxy({url:"../get_media.aspx?edid="+editionguid+b});c.load()},loadEdition:function(f,b){var e=this;editionFlatplanData=f;editionFlatplanData.pageMapper={};editionFlatplanData.reversePageMapper={};var a=editionFlatplanData.pageGroups;e.editionGuid=editionFlatplanData.editionGUID;for(var c=0;c<a.length;c++){var d=a[c].pages[0];d.pageIndex=c+1;if(d.type!="sectionpage"&&d.type!="leftHandAd"){editionFlatplanData.pageMapper[d.pageNum]=d.pageIndex-pageOffset}editionFlatplanData.reversePageMapper[d.pageIndex-pageOffset]=d.pageNum}var h="";if((typeof isTribReader!="undefined"&&isTribReader==true)||settings.reader.enableReaderPadding=="true"){h="20px 150px"}if(settings.reader.wrapAd!=null){h="0px 200px"}var g=function(){if(e.getReaderPanel()==null){var s=Ext.create("InfinityMobile.view.LayoutViewController",{id:"readerViewController",json:b,flatplandata:editionFlatplanData,cls:"reader2",width:"100%",height:"100%",padding:h});e.leftBtn=Ext.create("InfinityMobile.view.NavButton",{itemId:"leftBtn",xtype:"navbutton",left:0,style:"background-image:url('../assets/nav/left-arrow.png');left:0px;top:50%;transform:translateY(-50%);background-size:contain;background-repeat:no-repeat;",direction:"left",pagesLength:a.length-pageOffset});e.rightBtn=Ext.create("InfinityMobile.view.NavButton",{itemId:"rightBtn",xtype:"navbutton",right:0,style:"background-image:url('../assets/nav/right-arrow.png');right:0px;top:50%;transform:translateY(-50%);background-size:contain;background-repeat:no-repeat;",direction:"right",pagesLength:a.length-pageOffset});var u="11";if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){u="122"}e.topBtn=Ext.create("InfinityMobile.view.NavButton",{itemId:"topBtn",xtype:"navbutton",top:u+"px",left:"50%",style:"background-image:url('../assets/nav/right-arrow.png');left:50%;top:"+u+"px;transform:translateX(-50%) rotate(270deg);-webkit-transform:translateX(-50%) rotate(270deg);background-size:contain;background-repeat:no-repeat;",direction:"up",pagesLength:a.Length});if((settings.reader.bannerAd!=null&&((settings.reader.bannerAd.canBeClosed==null)||settings.reader.bannerAd.canBeClosed=="false"))&&settings.RSSTicker!=null&&settings.reader.bannerAd.position!="top"){var j=82}else{if(settings.reader.bannerAd!=null&&((settings.reader.bannerAd.canBeClosed==null)||settings.reader.bannerAd.canBeClosed=="false")&&settings.reader.bannerAd.position!="top"){var j=82}else{if(settings.RSSTicker!=null){var j=-28}else{var j=-28}}}e.toggledOn=true;e.bottomBtn=Ext.create("InfinityMobile.view.NavButton",{itemId:"topBtn",xtype:"navbutton",bottom:j+"px",left:"50%",style:"background-image:url('../assets/nav/right-arrow.png');left:50%;bottom:"+j+"px;transform:translateX(-50%) rotate(90deg);-webkit-transform:translateX(-50%) rotate(90deg);background-size:contain;background-repeat:no-repeat;",direction:"down",pagesLength:a.Length});e.topBtn.hide();if(settings.reader.zoomMode!="fill"){e.bottomBtn.hide();e.fill=false}else{e.fill=true;e.getApplication().getController("MediaController").keyControls()}var y=e.getCarousel();if(y.config.pageNumber==0){e.leftBtn.hide()}if(settings.reader.toggleNavButtons=="true"){if(settings.reader.startToggledNavButtonsOn=="false"){e.toggleNavButtons()}}var n=Ext.create("InfinityMobile.view.Reader",{viewType:"reader",items:[{flex:1,layout:"fit",style:"background-color:white",itemId:"readerItems",items:[{xtype:"readertoolbarbottom",bottom:0,width:"100%",height:190},s]}]});var o=true;if(currentProfile=="desktop"){if(settings.newsday!=null){if(settings.newsday.extraTopBar!=null&&settings.newsday.extraTopBar=="true"){var r=Ext.create("InfinityMobile.view.desktop.ExtraTopBar",{topBarColor:settings.topbar.backgroundColor});var w=e.getLayouttoolbar();if(w!=null){$(w.element.dom).css("top","0px")}n.insert(0,r);o=false}}if(settings.dateSelector!=null&&o){var l=Ext.create("InfinityMobile.view.desktop.ArchiveSelector",{});n.insert(0,l)}}var x=n.getComponent("readerItems");if(x!=null&&currentProfile=="desktop"){x.add(e.leftBtn);x.add(e.rightBtn);x.add(e.topBtn);x.add(e.bottomBtn)}if(settings.reader.ticker!=null){var v=Ext.create("InfinityMobile.view.Ticker",{bottom:0,url:settings.reader.ticker.url})}mainPanel.add(n);if(currentProfile=="phone"){e.leftBtn.destroy();e.rightBtn.destroy();e.topBtn.destroy();e.bottomBtn.destroy()}if(settings.dynamic!=null){var m=Ext.getStore("ArticleStore");m=m.data.items[0].raw;if(settings.dynamic.showDynamicArticleFirst=="true"&&m.length>0){var t="InfinityMobile.view.ArticleReader";var q=Ext.create(t,{orientation:e.returnOrientation()});mainPanel.add(q);mainPanel.setActiveItem(q)}else{mainPanel.setActiveItem(n)}}else{mainPanel.setActiveItem(n)}try{var k=localStorage.getItem("helper"+publicationguid)}catch(p){var k=null}if(k==null){if(Ext.browser.is.IE){if(document.cookie.indexOf("helper"+publicationguid)==-1){e.loadHelperView()}}else{e.loadHelperView()}}else{e.checkLanguage()}var y=e.getCarousel()}};e.cacheThumb(a[0].pages[0]);g()},loadHelperView:function(){var a=this;helperDisabled=false;if(settings.reader.disableHelperScreenOnLaunch!=null&&settings.reader.disableHelperScreenOnLaunch=="true"){helperDisabled=true}if(!helperDisabled){if(settings.dynamic!=null){if(settings.dynamic.showDynamicArticleFirst!="true"){a.helper()}}else{a.helper()}}},helper:function(){var b=this;if(currentProfile=="desktop"){var f=b.getLayouttoolbar();if(f!=null){f.howToTap()}}else{var d="InfinityMobile.view.tablet.ReaderHelper";switch(currentProfile){case"phone":d="InfinityMobile.view.phone.ReaderHelper";break;case"tablet":default:d="InfinityMobile.view.tablet.ReaderHelper";break}var e=Ext.create(d,{});mainPanel.add(e);e.show();var c=b.getCarousel();c.addCls("blur");var a=b.getArticlescontainer();if(a!=null){a.addCls("blur");a.disableEvents()}}},helperNext:function(b){var a=this;b.container.setHtml("<img class='portraitOnly' src='resources/images/branding/mobile-overlay-part2.png' style='width:100%' /><img class='landscapeOnly' src='resources/images/branding/mobile-overlay-landscape-part2.png' style='width:100%' />");b.nextButton.hide();b.continueButton.show()},closeHelper:function(e){var c=this;var d=c.getCarousel();d.removeCls("blur");mainPanel.remove(e,true);try{localStorage.setItem("helper"+publicationguid,"complete")}catch(b){}c.checkLanguage();var a=c.getArticlescontainer();if(a!=null){a.removeCls("blur");a.enableEvents()}if(typeof isTribReader!="undefined"&&isTribReader==true){c.checkTrialScreen()}},checkTrialScreen:function(){var a=this;if(typeof showTrialScreen!="undefined"){if(showTrialScreen){a.helperFree();showTrialScreen=false}}},checkLanguage:function(){var a=this},checkEdgeBrowser:function(){var c=this;if(navigator.appVersion.indexOf("Edge")!=-1){try{var b=localStorage.getItem("edgePrompt"+publicationguid)}catch(a){var b=null}if(b==null){var e="InfinityMobile.view.ReaderEdgeBrowserPopup";var d=Ext.create(e,{});mainPanel.add(d);d.show()}}},languageCancel:function(a){var c=this;try{localStorage.setItem("checkLanguage"+publicationguid,"false")}catch(b){}a.hide();c.checkEdgeBrowser()},languageUpdate:function(){var b=this;try{localStorage.setItem("checkLanguage"+publicationguid,navigator.language.substring(0,2))}catch(a){}location.reload()},latestEditionFlatplanLoad:function(b){var e=this;var f=b.data.items[0].raw;var a=f.pageGroups;for(var c=0;c<a.length;c++){var d=a[c].pages[0];d.pageIndex=c}e.startCaching(b.editionGuid,a)},readerContainerReady:function(b){var c=this;var a=c.getCarousel();c.readerPageChange(a)},trackPage:function(d){var f=this;var e=f.returnCorrectPageNumber(d);var a=e.split("-");if(typeof trackReaderEvent!="undefined"){var j=settings.bookmarks.bookmark;var h=null;if(j!=null&&j.length>0){var g=parseInt(d._pageNumber)+1;for(var c in j){if(g>=j[c].pageNumber&&(j[parseInt(c)+1]==null||g<j[parseInt(c)+1].pageNumber)){h=j[c].name;break}}}trackReaderEvent("pageTurn",{pageNum:e,pageNumArray:a,section:h})}if(settings.tracking!=null){var b=settings.tracking.trackingType;if(b=="GA"){f.gaPageChange(settings.tracking.accoundid,e)}else{if(b=="DA"&&typeof trackDaPageView!="undefined"){trackDaPageView("PDF|"+editionName+"|"+e,"Digital Edition")}}}f.trackTribune(d)},pagesuiteReports:function(a){var d=this;var e=a._pageNumber+1;var b=e-(e%2);var g=e+(1-e%2);var f="&pl="+b+"&pr="+g;if(d.returnOrientation()=="portrait"||a._mode=="single"){f="&pr="+e}if(typeof trackReports!="undefined"){if(trackReports.toLowerCase()=="true"){if(reports!=null&&visitorguid!=null&&startpageNumber!=null){var c=reports+"track.aspx?html5=true&eid="+editionguid+"&vid="+visitorguid+f+"&device="+currentProfile;$.ajax({crossDomain:true,type:"GET",async:true,url:c,cache:false})}}}},checkPageRestriction:function(b){var e=this;if(loggedIn.toLowerCase()!="true"){if(settings.subscription.pageRestriction!=null){var c=b._pageNumber;var d=parseInt(settings.subscription.pageRestriction.pages);var f=d-1;if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){c=(b.getData().length-c);f=(b.getData().length-f)}if(c>=d){var g=e.getCarousel();g.jumpToPage(f);var a=Ext.create("InfinityMobile.view.PageRestriction",{});if(settings.subscription.pageRestriction.disableRedirect==null){if(settings.subscription.pageRestriction.redirectUrl!=null){window.open(settings.subscription.pageRestriction.redirectUrl,"_blank")}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}}}}}},stopAudio:function(){var a=this;a.mediaController.stopAudio()},updatePagesBrowser:function(){var a=this;if(a.getArticlescontainer()!=null){if(a.getArticlescontainer().mode=="pages"){a.checkActivePageInBrowser(a.getArticlescontainer())}}if(Ext.os.is.Phone){if(a.getReadertoolbarbottom()!=null){a.checkActivePageInToolbarBottom(a.getReadertoolbarbottom())}}},readerPageChange:function(b){var v=this;v.trackOmniture(b);mainPanel.fireEvent("removeSplash");v.setCurrentPageNumber(b);var r=v.returnCorrectPageNumber(b);v.checkAdvert();var w=r.split("-");if(typeof trackReaderEvent!="undefined"){var l=settings.bookmarks.bookmark;var e=null;if(l!=null&&l.length>0){var u=parseInt(b._pageNumber)+1;for(var n in l){if(u>=l[n].pageNumber&&(l[parseInt(n)+1]==null||u<l[parseInt(n)+1].pageNumber)){e=l[n].name;break}}}trackReaderEvent("pageTurn",{pageNum:r,pageNumArray:w,section:e})}if(currentProfile=="desktop"){v.setupPrintContainer()}v.checkPayWall(b);v.checkInterstitial();v.killActiveRequest();if(Ext.os.is.Desktop){v.checkNavigationButtons(b)}v.getApplication().getController("MediaController").stopAudio();if(Ext.os.is.Desktop){var h=b.getActiveItem().audioObjects;for(var n in h){if(h[n]){if(b._pageNumber+1==h[n].mediaObject.page){if(h[n].mediaObject.autoPlay=="true"){h[n].playSound()}}}}var j=b.getActiveItem().mp4Objects;for(var n in j){if(j[n]){if(j[n].mediaObject.autoPlay=="true"){if(j[n].videoType=="mp4"){j[n].video.play()}else{if(j[n].videoType=="youtube"){j[n].playVideo()}}}}}}if(v.loadPage!=null){clearInterval(v.loadPage)}var s=300;if(currentProfile=="desktop"){s=100}v.loadPage=setInterval(function(){v.loadImages(v,b)},s);if(v.needToClearBuffer){var g=b._pageNumber;var f=editionFlatplanData.pageGroups;var q=v.bufferValue;var o=Math.max(0,g-q);var p=Math.min(f.length-1,g+q);for(var n=0;n<f.length;n++){if(n<o||n>p){var a=f[n].pages[0];v.clearBuffer(a)}}}var t=Ext.getStore("SettingStore");if(loggedIn.toLowerCase()!="true"){if(t.data.items[0].raw.subscription.pageRestriction!=null){if(b._pageNumber>=t.data.items[0].raw.subscription.pageRestriction.pages){var m=v.getCarousel();m.jumpToPage(t.data.items[0].raw.subscription.pageRestriction.pages-1);var c=Ext.create("InfinityMobile.view.PageRestriction",{});if(t.data.items[0].raw.subscription.pageRestriction.disableRedirect==null){if(t.data.items[0].raw.subscription.pageRestriction.redirectUrl!=null){window.open(t.data.items[0].raw.subscription.pageRestriction.redirectUrl,"_blank")}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}}}}}if(settings.tracking!=null){var k=settings.tracking.trackingType;if(k=="GA"){v.gaPageChange(settings.tracking.accoundid,g)}else{if(k=="DA"){trackDaPageView("PDF|"+editionName+"|"+g,"Digital Edition")}else{v.omniturePageChange()}}}else{if(typeof isTribReader!="undefined"&&isTribReader==true){v.trackTribune(b)}}if(typeof trackReports!="undefined"){if(trackReports.toLowerCase()=="true"){var d=reports+"track.aspx?html5=true&eid="+editionguid+"&vid="+visitorguid+"&pl="+startpageNumber+"&pr="+(b._pageNumber+1);$.ajax({crossDomain:true,type:"GET",async:true,url:d,cache:false})}}var m=v.getCarousel();if(m._zoomMode=="fill"){if(m.getActiveItem().id.indexOf("readeradvertpageviewer")==-1){if(m.getActiveItem().scroller.position.y==0){v.hideTop();v.showBottom()}else{if(m.getActiveItem().scroller.position.y==m.getActiveItem().scroller.maxPosition.y){v.showTop();v.hideBottom()}else{v.showTop();v.showBottom()}}}}v.ttsStateChange();if(v.getArticlescontainer()!=null){if(v.getArticlescontainer().mode=="pages"){v.checkActivePageInBrowser(v.getArticlescontainer())}}if(Ext.os.is.Phone){if(v.getReadertoolbarbottom()!=null){v.checkActivePageInToolbarBottom(v.getReadertoolbarbottom())}}v.updateBannerPageSwipes();v.checkFullscreenAdvert();v.checkAdvertPageFlow();v.refreshBannerAd(b._pageNumber+1)},checkAdvertPageFlow:function(){var a=this;if(a.advertFlowTimeout!=null){clearTimeout(a.advertFlowTimeout)}var b=a.getCarousel().getActiveItem();if(b.id.indexOf("readeradvertpageviewer")>=0){a.advertFlowTimeout=setTimeout(function(){b.loadAdvert()},500)}},checkFullscreenAdvert:function(){var b=this;if(settings.reader.interstitial!=null&&settings.reader.interstitial.dfpType=="fullscreen"){if(!b.isFullscreenAdInView()&&typeof b.isFullscreenAdInView()!="undefined"){var a=b.getInterstitial();if(a!=null){a.destroy()}}}},isFullscreenAdInView:function(){var c=this;if(settings.reader.interstitial!=null&&settings.reader.interstitial.dfpType=="fullscreen"){var d=$("body").children("div[draggable='false']");if(d.length>1){for(var b=0;b<d.length;b++){if(d[b].style!=null){var a=d[b].style.display;if(a!="none"){return true}else{return false}}}}}else{return false}},checkAdvert:function(){var b=this;var a=1500;if(currentProfile=="desktop"){a=1000}b.canLoadAd=false;if(b.bannerTimeout!=null){clearTimeout(b.bannerTimeout)}b.bannerTimeout=setTimeout(function(){if(currentProfile=="desktop"){var c=b.getApplication().getController("PageTurnController");if(!c.turning){b.canLoadAd=true;b.loadBannerAd();b.refreshWrapAd()}}else{b.canLoadAd=true;b.loadBannerAd();b.refreshWrapAd()}},a)},updateBannerPageSwipes:function(){var a=this;if(a.swipesUntilNewBannerAd-1>=0){a.swipesUntilNewBannerAd--}},setupPrintContainer:function(){var g=this;var f=g.getCarousel();var j=(f._pageNumber);var c=editionFlatplanData.pageGroups;var h=c[j].pages[0];var a="";if(!f.isDPS()){j=editionFlatplanData.pageMapper[j+1]-1}if(g.returnOrientation()=="landscape"&&f._mode=="double"&&j>0&&j<(c.length-1)){if(j%2==0){var b=j-1;var d=c[b].pages[0];a="<div style='position:absolute;width:100%;height:100%'>"+g.printPageHtml(d)+"</div>";a+="<div style='position:absolute;width:100%;height:100%;top:100%'>"+g.printPageHtml(h)+"</div>"}else{var b=j+1;var d=c[b].pages[0];a="<div style='position:absolute;width:100%;height:100%'>"+g.printPageHtml(h)+"</div>";a+="<div style='position:absolute;width:100%;height:100%;top:100%'>"+g.printPageHtml(d)+"</div>"}}else{if(currentProfile=="desktop"){j=editionFlatplanData.reversePageMapper[j+1]-1;h=c[j].pages[0]}a=g.printPageHtml(h)}var e=$(".printContainer")[0];e.innerHTML=a},printPageHtml:function(b){var c=this;var a="";var d=b.image;if(settings.page.useMobileFullJpg=="true"){d="http://pages.mobile.cdn.pagesuite.com/images/"+b.guid+"/full.jpg"}else{if(settings.page.highResImage){d=d.replace("page.jpg","largepage.jpg")}}if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){a='<img src="'+d+'" style="left:50%;transform:translateX(-50%);position:absolute;max-height:100%;max-width:100%;" />'}else{a='<img src="'+d+'" style="position:absolute;width:100%;height:100%;object-fit: contain" />'}return a},setCurrentPageNumber:function(a){var e=this;if(settings.reader.trackPagePosition!=null&&settings.reader.trackPagePosition=="true"){var c=new Date();c=c.setHours(c.getHours());var b=a._pageNumber+1;if(a.isDPS!=null&&a.isDPS()){b=editionFlatplanData.reversePageMapper[b]}var f={pageNumber:b,date:c};try{localStorage.setItem("page"+editionguid,JSON.stringify(f))}catch(d){}}},trackTribune:function(a){var b=this;var c=b.returnCorrectPageNumber(a);if(trackOmniture=="True"){trackPageTurn(c)}},checkNavigationButtons:function(b){var a=this;if(currentProfile=="desktop"||currentProfile=="tablet"){if(b._pageNumber>0){a.showLeft()}else{a.hideLeft()}if(b._pageNumber==(b.getData().length-1-pageOffset)){a.hideRightIcon()}else{a.showRightIcon()}}},gaPageChange:function(c,a){var b=this;ga("set","page","/"+(a+1));ga("send",{hitType:"pageview",title:publicationName+" - "+editionName})},omniturePageChange:function(){$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})},clearBuffer:function(a){a.request=null;a.tileImage=null;a.cached=null;delete a.pdfPage;delete a.pdfRequest},loadImages:function(j,e){var g=this;clearInterval(j.loadPage);var b="Image";if(currentProfile=="desktop"){b="PDF"}else{b=settings.page.renderMode}if(b=="PDF"){g.loadPDFs(e);g.tryRenderPDFPage(e)}else{var f=e.getItems().items;var d=e.getActiveItem();var k="";var h="";for(var c=0;c<f.length;c++){var a=f[c];if(a.getPageNo()!=d.getPageNo()){if(k==""){k=a}else{h=a}}}g.loadPageImage(d,function(){g.loadPageImage(k,function(){g.loadPageImage(h,function(){e.fireEvent("idle",e)})})})}},loadPageImage:function(a,b){if(a.completeImageLoaded!=null){a.completeImageLoaded(b)}},loadPDFs:function(c){var g=this;var b=editionFlatplanData.pageGroups;var d=g.returnMappedPageNumber(c,c._pageNumber);var f=b[d+pageOffset].pages[0];g.tryCachePDFPage(f);if(g.returnOrientation()=="landscape"){var e;if(d%2==0){e=Math.max(0,d-1)}else{e=Math.min(b.length-1,d+1)}if(b[e+pageOffset]!=null){var a=b[e+pageOffset].pages[0];g.tryCachePDFPage(a)}}setTimeout(function(){g.bufferPDFS(b,d)},100)},returnMappedPageNumber:function(a,b){var c=this;if(c.returnOrientation()=="landscape"&&a._mode=="double"){return b}return(flatPlanData.pageMapper[b+1]-1)},bufferPDFS:function(a,c){var h=this;for(var f=1;f<=h.bufferValue;f++){var g=Math.min(a.length-1,c+f);var e=a[g].pages[0];var d=Math.max(0,c-f);var b=a[d].pages[0];h.tryCachePDFPage(e);h.tryCachePDFPage(b)}},tryCachePDFPage:function(a){var b=this;if(a.cached==null){b.cachePDF(a);a.cached=true}},cachePDF:function(a){var c=this;if(a.pdf!=""){var e=a.pdf;var d="page.pdf";if(settings.page.pdf!=null){e=e.replace("page.pdf",settings.page.pdf)}else{if(settings.reader.useOrigPDF!=null&&settings.reader.useOrigPDF=="true"){e=e.replace("page.pdf","orig.pdf")}}var b=PDFJS.getDocument(e);b.then(function(f){if(f.pdfInfo.numPages>0){f.getPage(1).then(function(g){a.pdfPage=g})}});b.pageNo=a.pageNum;a.pdfRequest=b}},tryRenderPDFPage:function(a){var c=this;var b=a.getItems().items;var d=a.getActiveItem();c.renderPDFPage(d);if(currentProfile=="largetablet"){setTimeout(function(){var g="";var h="";for(var f=0;f<b.length;f++){var e=b[f];if(e.getPageNo()!=d.getPageNo()){if(g==""){g=e}else{h=e}}}c.renderPDFPage(g);c.renderPDFPage(h)},150)}},renderPDFPage:function(b){var a=this;if(b.completePDFLoaded!=null){b.completePDFLoaded()}},killActiveRequest:function(){var a=this;if(activerequest!=null&&activerequest.page.request!=null&&activerequest.page.request.readyState!=4){activerequest.page.request.abort();activerequest.page.request=null;activerequest.page.cached=null;activerequest.page.tileImage=null;activerequest=null}a.isIdle=false},readerIdle:function(a){var b=this;b.isIdle=true;if(b.canProgressiveDownload){b.startCaching(a)}},startCaching:function(c){var h=this;var b=editionFlatplanData.pageGroups;var e=c._pageNumber;var a=Math.max(0,e-h.bufferValue);var d=Math.min(b.length-1,e+h.bufferValue);for(var f=a;f<d;f++){var g=b[f].pages[0];if(!h.isIdle){break}if(g.cached==null){h.cachePage(g,function(){h.startCaching(c)});g.cached=true;break}}},cacheThumb:function(d){var c=this;if(d.image!=null){var b=d.image;if(d.pageNum>1){if(d.image.indexOf("pages.cdn.pagesuite.com")!=-1){b="http://pages.mobile.cdn.pagesuite.com/images/"+c.retrievePageGuid(d)+"/tablet.jpg"}}var a=document.createElement("img");a.src=b}},cachePage:function(e,f){var g=this;var d=g.editionGuid;var c=g.retrievePageGuid(e);g.cacheThumb(e);var j=settings.page;var b=j.lowres;var h=editionFlatplanData.pagesDomain;var a=h+"/"+c[0]+"/"+c[1]+"/"+c+"/tile/page_90_"+b+".json";g.loadInline(d,e,a,c,b,f)},loadWorker:function(g,e,b,d,c,a){var f=new Worker("resources/js/imageloader.js");f.addEventListener("message",function(m){var k=m.data;var l=[];for(var j=0;j<k.length;j++){var n=document.createElement("img");n.startX=k[j].startX;n.startY=k[j].startY;l.push(n);var h=window.URL||window.webkitURL;n.src=h.createObjectURL(k[j]);n.onload=function(){h.revokeObjectURL(this.src)}}e.tileImage=l;if(a!=null){a()}},false);f.postMessage({editionguid:g,page:e,url:b,pageguid:d,dpi:c})},loadInline:function(g,f,b,e,c,a){var d=this;f.request=$.ajax({crossDomain:true,type:"GET",contentType:"application/json",async:true,cache:true,url:b,success:function(h){f.tileImage=d.createImagesArray(h);if(a!=null){a()}},error:function(h){if(h.statusText!="abort"){var j="https://tile.html5.pagesuite-professional.co.uk/get_image_jpg_tile.aspx?pguid="+e+"&dpi="+c;$.ajax({crossDomain:true,type:"GET",contentType:"application/json",async:true,cache:true,url:j,success:function(k){f.tileImage=d.createImagesArray(k);if(a!=null){a()}},error:function(k,l){}})}}});activerequest={page:f}},createImagesArray:function(e){var c=this;var d=[];for(var b=0;b<e.images.length;b++){var f=document.createElement("img");var a=e.images[b];f.src=a.url;f.startX=a.startX;f.startY=a.startY;f.width=a.width;f.height=a.height;d.push(f)}return d},retrievePageGuid:function(c){var b=c.image.split("/");var a=b[b.length-2];return a},getPage:function(a,d){var c=this;if(c.db!=null){var b=c.db.transaction("image").objectStore("image").get(a);b.onsuccess=function(f){var e=f.target.result;if(e!=null){d(e.data)}else{d("")}}}else{d}},changeAdvert:function(c){var f=this;var a=f.getReaderViewController();var b=a.items.items;for(var e=0;e<b.length;e++){var d=b[e];if(d.json.globalID.indexOf("Ad Block")!=-1){d.toggleAd();break}}},checkInterstitial:function(){var d=this;var c=settings.reader.interstitial;if(c!=null){if(c.launchOnLoad=="true"&&!d.preRollAd){d.preRollAd=true;var f="InfinityMobile.view.tablet.Interstitial";switch(currentProfile){case"phone":f="InfinityMobile.view.phone.Interstitial";break;case"tablet":default:f="InfinityMobile.view.tablet.Interstitial";break}var b=Ext.create(f,{});Ext.Viewport.add(b);b.show();var e=d.getCarousel();e.disableTiling()}}if(c!=null&&(c.mode=="overlay"||c.mode=="swipe")){var a=c.count;if(pageSwipes===null){pageSwipes=0}else{pageSwipes++;if(pageSwipes%a==0){var f="InfinityMobile.view.tablet.Interstitial";switch(currentProfile){case"phone":f="InfinityMobile.view.phone.Interstitial";break;case"tablet":default:f="InfinityMobile.view.tablet.Interstitial";break}var b=Ext.create(f,{});Ext.Viewport.add(b);b.show();var e=d.getCarousel();e.disableTiling()}}}},closeInterstitial:function(){var a=this;var b=a.getCarousel();b.enableTiling()},killBannerAd:function(){var b=this;if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.refresh=="true"){var c=b.getReaderView();var d=c.query("readerbannerad");if(d.length>0){var a=d[0];c.remove(a)}}},loadBannerAd:function(){var d=this;if(d.canChangeAd){var c=d.getBannerAd();var g=d.getCarousel();var a=parseInt(g._pageNumber)+1;var h=g.getActiveItem();var b=h.config.pageNo;var f=currentPageNumber=b;var e=d.returnSection(d.returnCorrectSideNumber(f+pageOffset));if(c!=null){c.loadAdvert(a,e)}if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.refresh!=null&&settings.reader.bannerAd.refresh=="true"){d.canChangeAd=true}else{d.canChangeAd=false}}},returnCorrectSideNumber:function(a){var b=flatPlanData.pageGroups[a].pages[0];if(b.type!="page"){b=a%2==1?flatPlanData.pageGroups[a-1].pages[0]:flatPlanData.pageGroups[a+1].pages[0]}return b.origPageNum},returnSection:function(a){var e=this;var h=settings.bookmarks.bookmark;var f=null;if(h!=null&&h.length>0){for(var c in h){var b=parseInt(h[c].pageNumber);if(h[c].start!=null){b=h[c].start}var g=h[parseInt(c)+1];var d=null;if(g!=null){d=g.pageNumber;if(g.start!=null){d=g.start}}if(parseInt(a)>=b&&(d==null||parseInt(a)<parseInt(d))){f=h[c].name;break}}}return f},refreshWrapAd:function(){var e=this;if(settings.reader.wrapAd!=null&&settings.reader.wrapAd.refreshAdvert!=null&&settings.reader.wrapAd.refreshAdvert=="true"){var g=e.getCarousel();var a=parseInt(g._pageNumber)+1;var b=editionFlatplanData.reversePageMapper[a];var f=Ext.ComponentQuery.query(".backgroundwrapaditem");for(var c in f){var d=f[c];d.destroyAdvert();d.setAdvert(b)}}},refreshBannerAd:function(){var e=this;if(settings.reader.bannerAd!=null&&settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){if(e.swipesUntilNewBannerAd==0){var b=Ext.Viewport.query("readerbannerad");if(b.length<1){var k=e.getCarousel();var g=parseInt(k._pageNumber)+1;var j="InfinityMobile.view.tablet.ReaderBannerAd";switch(currentProfile){case"phone":j="InfinityMobile.view.phone.ReaderBannerAd";break;case"tablet":default:j="InfinityMobile.view.tablet.ReaderBannerAd";break}var a=Ext.create(j,{pageNumber:g});if(settings.reader.bannerAd.position=="top"){var h=settings.topbar.backgroundColor.indexOf("#")==0?settings.topbar.backgroundColor:"#"+settings.topbar.backgroundColor;if(typeof e.hexaToRgba==="function"&&typeof e.hexToRgb==="function"){if(h.length>=8){h=e.hexaToRgba(h)}else{var f=e.hexToRgb(h);var d=settings.topbar.opacity!=null?settings.topbar.opacity:"0.9";h="rgba("+f.r+","+f.g+","+f.b+","+d+")"}}a.setStyle({borderBottom:"1px solid #ffffff",backgroundColor:h,zIndex:9});a.setDocked("top");var c=e.getReaderViewController();c.insert(0,a);a.show();e.forcePageResizeOnShow()}else{Ext.Viewport.add(a);a.show();a.setBottom(0)}a.loadAdvert(g)}}}},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},hexaToRgba:function(h){var j=h.match(/.{2}/g);if(j.length!=4){$("<p />",{"class":"user-message warning"}).text("Value provided is invalid.").insertAfter("form").hide().slideDown();$("#hex").addClass("error");$("#rgba").slideUp();return false}else{$("#hex").removeClass("error");$(".user-message").slideUp()}var g=function(a){return parseInt(a,16)};var f=function(a){return parseFloat(parseInt((parseInt(a,16)/255)*1000)/1000)};var b,e=[];b=f(j[3]);$.each(j.slice(0,3),function(c,a){e.push(g(a))});return e.join(",")+","+b},bannerAdClose:function(a){var b=this;if(settings.reader.bannerAd!=null){if(settings.reader.bannerAd.position=="top"){var c=b.getReaderViewController();a.destroy();b.forcePageResizeOnHide()}else{Ext.Viewport.remove(a);a.destroy()}b.swipesUntilNewBannerAd=settings.reader.bannerAd.swipeCount}},checkPayWall:function(a){if(paywall){if(a._pageNumber>4){try{var e=localStorage.getItem("paywall")}catch(d){var e=null}if(e==null){var c="InfinityMobile.view.tablet.Paywall";switch(currentProfile){case"phone":viewToLoad="InfinityMobile.view.phone.Paywall";break;case"tablet":default:viewToLoad="InfinityMobile.view.tablet.Paywall";break}var b=Ext.create(viewToLoad,{});Ext.Viewport.add(b);b.show()}}}},trackOmniture:function(a){var b=this;if(trackOmniture=="True"){var c=b.returnCorrectPageNumber(a)}},returnCorrectPageNumber:function(a){var f=this;var d=a._pageNumber;if((a._mode=="double"&&currentProfile=="desktop")||(currentProfile!="desktop"&&f.returnOrientation()=="landscape"&&a._mode=="double")){d=editionFlatplanData.reversePageMapper[parseInt(d)+1]-1}var c=flatPlanData.pageMapper[d+1];c=flatPlanData.pageGroups[c-1+pageOffset]!=null?flatPlanData.pageGroups[c-1+pageOffset].pages[0].pageName:c;var h=flatPlanData.sectionPageCount!=null?flatPlanData.sectionPageCount:0;var g=flatPlanData.totalAdvertsAdded!=null?flatPlanData.totalAdvertsAdded:0;var e=a.getData().length-pageOffset-h-g;var b=c.toString();if(f.returnOrientation()=="landscape"&&a._mode=="double"){if(c>1&&c<e){if(c%2==0){b=c+"-"+(c+1)}else{b=(c-1)+"-"+c}}}return b},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(currentProfile=="desktop"){a="landscape"}else{if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}}return a},jumpToPage:function(a){var c=this;var b=Ext.getStore("SettingStore");if(loggedIn.toLowerCase()!="true"){if(b.data.items[0].raw.subscription.pageRestriction!=null){if(a>=b.data.items[0].raw.subscription.pageRestriction.pages){var d=c.getCarousel();d.jumpToPage(b.data.items[0].raw.subscription.pageRestriction.pages)}}else{var d=c.getCarousel();d.jumpToPage(a)}}else{var d=c.getCarousel();d.jumpToPage(a)}},zoomStart:function(d,c){var b=this;var a=b.getCarousel();b.readerActiveItem=a.getActiveItem();if(b.readerActiveItem!=null&&b.readerActiveItem.onZoomStart!=null){b.readerActiveItem.onZoomStart(d,c)}else{d.sliderElement.dom.value=1}},zoom:function(c,b){var a=this;if(a.readerActiveItem!=null&&a.readerActiveItem.onZoom!=null){a.readerActiveItem.onZoom(c,b)}else{c.sliderElement.dom.value=1}},zoomEnd:function(c,b){var a=this;document.activeElement.blur();if(a.readerActiveItem!=null&&a.readerActiveItem.onZoomEnd!=null){a.readerActiveItem.onZoomEnd(c,b)}else{c.sliderElement.dom.value=1}},hideNavButtons:function(){var a=this;var b=a.getCarousel();a.bottomBtn.element.dom.style.display="none";a.topBtn.element.dom.style.display="none";if(b._pageNumber==0){a.leftBtn.element.dom.style.display="none"}if(b._pageNumber==b.getData().length-1){a.rightBtn.element.dom.style.display="none"}},showNavButtons:function(){var b=this;var c=b.getCarousel();var a=true;if(settings.reader.toggleNavButtons=="true"){if(!b.toggledOn){a=false}}if(a){b.bottomBtn.element.dom.style.display="";b.topBtn.element.dom.style.display="";b.leftBtn.element.dom.style.display="";b.rightBtn.element.dom.style.display=""}},hideTop:function(){var a=this;if(a.topBtn.element!=null){a.topBtn.element.dom.style.display="none"}},showTop:function(){var b=this;var a=true;if(settings.reader.toggleNavButtons=="true"){if(!b.toggledOn){a=false}}if(a){b.topBtn.element.dom.style.display=""}},hideBottom:function(){var a=this;a.bottomBtn.element.dom.style.display="none"},showBottom:function(){var b=this;var a=true;if(settings.reader.toggleNavButtons=="true"){if(!b.toggledOn){a=false}}if(a){if(b.bottomBtn.element!=null){b.bottomBtn.element.dom.style.display=""}}},scrollLeft:function(){var b=this;var a=b.getCarousel();if(a.getActiveItem().getScrollable()==null){return}if(a.getActiveItem().getScrollable().getScroller().position.x-50>0){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x-50)}else{a.getActiveItem().getScrollable().getScroller().scrollTo(0)}},scrollRight:function(){var b=this;var a=b.getCarousel();if(a.getActiveItem().getScrollable()==null){return}if(a.getActiveItem().getScrollable().getScroller().position.x+50<a.getActiveItem().getScrollable().getScroller().maxPosition.x){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x+50)}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().maxPosition.x)}},scrollUp:function(){var b=this;var a=b.getCarousel();if(a.getActiveItem().getScrollable().getScroller().position.y-50>0){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().position.y-50);b.showTop();b.showBottom()}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,0);b.hideTop();b.showBottom()}},scrollDown:function(){var b=this;var a=b.getCarousel();if(a.getActiveItem().getScrollable().getScroller().position.y+50<a.getActiveItem().getScrollable().getScroller().maxPosition.y){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().position.y+50);b.showBottom();b.showTop()}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().maxPosition.y);b.hideBottom();b.showTop()}},showLeft:function(){var a=this;if(a.leftBtn.isHidden()){a.leftBtn.show()}},hideLeft:function(){var a=this;if(!a.leftBtn.isHidden()){a.leftBtn.hide()}},showRightIcon:function(){var a=this;if(a.rightBtn.isHidden()){a.rightBtn.show()}},hideRightIcon:function(){var a=this;if(!a.rightBtn.isHidden()){a.rightBtn.hide()}},fitMode:function(){var a=this;var b=a.getCarousel();if(a.topBtn!=null){if(!a.topBtn.isHidden()||a.topBtn.element.dom.style.display!="none"){a.topBtn.element.dom.style.display="none"}}if(a.bottomBtn!=null){if(!a.bottomBtn.isHidden()){a.bottomBtn.element.dom.style.display="none"}}},fillMode:function(){var a=this;var b=a.getCarousel();var c=b.getActiveItem();if(c.returnActiveImageContainer!=null&&c.element.dom.clientHeight<c.returnActiveImageContainer().clientHeight){if(c.scroller.position.y<=0){a.hideTop();a.showBottom()}else{if(c.scroller.position.y>=c.scroller.maxPosition.y){a.showTop();a.hideBottom()}else{a.showTop();a.showBottom()}}}else{a.hideBottom();a.hideTop()}},resizeArticleController:function(){var a=this;if(a.getArticlecarousel()!=null){a.getArticlecarousel().onSizeChange()}},getZoomValue:function(){var a=this;if(a.getCarousel().getActiveItem()!=null){return a.getCarousel().getActiveItem().scale}else{return 1}},resizeWrapAds:function(a){var b=this;a.element.dom.style.display="";if($(window).width()/$(window).height()<=1.4){a.removeCls("showWrapper");a.addCls("hideWrapper")}else{if(a.side=="left"){if(settings.reader.wrapAd!=null){if(settings.reader.wrapAd.hideLeftWrapperOnFirstPage!=null){if(settings.reader.wrapAd.hideLeftWrapperOnFirstPage=="true"){var c=b.getCarousel();if(c!=null){if(c.getActiveItem().getPageNo()==0){a.removeCls("showWrapper");a.addCls("hideWrapper")}else{a.removeCls("hideWraper");a.addCls("showWrapper")}}else{a.removeCls("hideWraper");a.addCls("showWrapper")}}else{a.removeCls("hideWraper");a.addCls("showWrapper")}}else{a.removeCls("hideWraper");a.addCls("showWrapper")}}else{a.removeCls("hideWraper");a.addCls("showWrapper")}}else{a.removeCls("hideWraper");a.addCls("showWrapper")}}},checkWrapAd:function(c){var a=this;var d=a.getCarousel();if(d!=null){if(c.getPageNo()==0&&c.getPageNo()==d.getActiveItem().getPageNo()){if(c.mode=="double"&&c.zoomMode=="fit"){var b=document.getElementsByClassName("leftWrapper");if(b!=null){b[0].style.display="none"}}}}},toggleNavButtons:function(){var b=this;if(b.toggledOn==true){b.bottomBtn.element.dom.style.display="none";b.topBtn.element.dom.style.display="none";b.leftBtn.element.dom.style.display="none";b.rightBtn.element.dom.style.display="none";b.toggledOn=false}else{var c=b.getCarousel();if(c.getActiveItem().scale==1){if(c._pageNumber>0){b.leftBtn.element.dom.style.display=""}if(c._pageNumber<c.getData().length-1){b.rightBtn.element.dom.style.display=""}if(c._zoomMode=="fill"){var a=c.getActiveItem().scroller;if(a.position.y>a.minPosition.y){b.topBtn.element.dom.style.display=""}if(a.position.y<a.maxPosition.y){b.bottomBtn.element.dom.style.display=""}}}else{b.bottomBtn.element.dom.style.display="";b.topBtn.element.dom.style.display="";b.leftBtn.element.dom.style.display="";b.rightBtn.element.dom.style.display=""}b.toggledOn=true}},articleHelper:function(c){var b=this;mainPanel.remove(c,true);var a=Ext.create("InfinityMobile.view.ReaderArticleHelper",{});mainPanel.add(a);a.show()},ttsStateChange:function(){if(settings.tts!=null||(typeof isTribReader!="undefined"&&isTribReader)){var b=this;if(b.getLayouttoolbar()!=null){var a=b.getLayouttoolbar().ttsToggle}else{var a=ttsFlag}if(a!=null){if(window.speechSynthesis!=null){if(window.speechSynthesis.paused==true){window.speechSynthesis.resume();a.status="STOPPED"}if(window.speechSynthesis.speaking==true){window.speechSynthesis.cancel();if(a.status!="STOPPED"){a.status="FINISHED"}a.removeCls("playing")}setTimeout(function(){if(a.status=="FINISHED"&&(settings.tts!=null&&(settings.tts.autoplay==true||settings.tts.autoplay=="true"))){if(a==ttsFlag){var c="noicon";b.getApplication().getController("MediaController").playArticleTTS(a,c)}else{b.getApplication().getController("MediaController").playArticleTTS(a)}}},200)}}}},returnAdvertOffset:function(c){var b=this;var d=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var e=settings.reader.interstitialPageFlow;var a=editionFlatplanData.pageGroups[c];if(a!=null&&a.pages[0]!=null){if(!isNaN(a.pages[0].advertsAdded)){d=a.pages[0].advertsAdded}}}return d},checkActivePageInBrowser:function(m){var l=this;var o=l.getCarousel();if(o!=null){var g=o.getActiveItem();var n=g.getPageNo();var a=flatPlanData.pageGroups[n+pageOffset].pages[0].origPageNum-1;if(g.xtype==="readeradvertpageviewer"){a=-1}if(m.mode=="pages"){var p=m.contentArea.items.items[0].items.items[a];var k=m.contentArea.items.items[0].items.items;if(k!=null){for(var f in k){$(k[f].img).css("border","")}}if(p!=null){var e=p.img;if(e!=null){var d=0;if(Ext.os.is.Desktop){if(o._mode=="double"){if(a%2==1){if(o.getActiveItem().config.rightPage.type!="sectionpage"){if(a+1<k.length){d=$(k[a-1].img).width()+10;$(k[a+1].img).css("border","5px solid #"+settings.reader.buttonColour)}}}else{if(a-1>0){if(o.getActiveItem().config.leftPage.type!="sectionpage"){$(k[a-1].img).css("border","5px solid #"+settings.reader.buttonColour)}}}}else{d=($(e).width()/2)+15}$(e).css("border","5px solid #"+settings.reader.buttonColour)}else{if(Ext.os.is.Tablet){if(l.returnOrientation()=="landscape"){if(o._mode=="double"){if(a%2==1){if(o.getActiveItem().landscapeimage.src.indexOf("resources/images/branding/next-section@2x.png")==-1){if(a+1<k.length){d=$(k[a-1].img).width()+10;$(k[a+1].img).css("border","5px solid #"+settings.reader.buttonColour)}}}else{if(a-1>0){if(o.getActiveItem().image.src.indexOf("resources/images/branding/previous-section@2x.png")==-1){$(k[a-1].img).css("border","5px solid #"+settings.reader.buttonColour)}}}}else{d=($(e).width()/2)+15}}else{d=($(e).width()/2)+15}$(e).css("border","5px solid #"+settings.reader.buttonColour)}}var j=p.element.dom.offsetLeft-($(document).width()/2)+d;if(m.scrollType=="senchaScroller"){var h=m.getComponent("con").getScrollable().getScroller();var c=m.getComponent("con");var b=null;if(j<h.minPosition.x){j=h.minPosition.x}else{if(j>h.maxPosition.x){j=h.maxPosition.x}}h.scrollTo(j,0,{duration:100})}else{if(j<0){j=0}else{if(j>m.contentArea.element.dom.scrollWidth){j=m.contentArea.element.dom.scrollWidth}}m.contentArea.element.dom.scrollLeft=j}}}}}},checkActivePageInToolbarBottom:function(p){var m=this;var o=m.getCarousel();if(o!=null){var e=o.getActiveItem();var b=e._pageNo;var a=p.getItems().items;if(a[1]!=null){a=a[1].items.items;if(a[0]!=null){a=a[0].items.items;for(var f in a){var q=$(a[f].element.dom).find("img");if(q.length>0){var j=q[0];$(j).css("border","")}}var l=$(a[b].element.dom).find("img");var c=0;if(m.returnOrientation()=="landscape"){if(o._mode=="double"){if(b%2==1){if(b+1<a.length){var n=$(a[b+1].element.dom).find("img");if(n.length>0){var k=n[0];$(k).css("border","5px solid #"+settings.reader.buttonColour)}}}else{if(b-1>0){var n=$(a[b-1].element.dom).find("img");if(n.length>0){var k=n[0];$(k).css("border","5px solid #"+settings.reader.buttonColour);c+=$(k).width()+20}}}}}if(l.length>0){var d=l[0];$(d).css("border","5px solid #"+settings.reader.buttonColour);var h=a[b].element.dom.offsetLeft-c;var g=p.scrollerContainer.getScrollable().getScroller();if(h>g.maxPosition.x){h=g.maxPosition.x}g.scrollTo(h,0,{duration:100})}}}}},checkPagesBrowser:function(){var a=this;a.checkActivePageInToolbarBottom(a.getReadertoolbarbottom())},forcePageResizeOnHide:function(){var a=this;if(a.showBannerTimeout!=null){clearTimeout(a.showBannerTimeout)}var b=a.getCarousel();if(b._zoomMode=="fit"){a.hideBannerTimeout=setTimeout(function(){a.forceReRender(b);b.onResize()},1000)}else{a.hideBannerTimeout=setTimeout(function(){var c=b.getActiveItem();if(c!=null&&c.xtype=="readeradvertpageviewer"){c.loadAdvert()}},1000)}a.updateTopBtnPosition()},forcePageResizeOnShow:function(){var a=this;if(a.hideBannerTimeout!=null){clearTimeout(a.hideBannerTimeout)}var b=a.getCarousel();if(b._zoomMode=="fit"){a.showBannerTimeout=setTimeout(function(){a.forceReRender(b);b.onResize()},1000)}a.updateTopBtnPosition()},forceReRender:function(d){if(d!=null){var a=d.getItems().items;for(var c in a){var b=a[c];b.doToggleCheck=true}}},updateTopBtnPosition:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){var a=b.getBannerAd();if(a!=null){b.topBtn.setTop(122)}else{b.topBtn.setTop(12)}}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderToolbarController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel",readerPanel:"reader",readerView:"#reader",readerMenu:"readermenu",readerToolBar:"readertoolbar",readerToolbarBottom:"readertoolbarbottom",readerPages:"readerpages",readerPagesContainer:"#pagescontainer",readerArchive:"readerarchive",readerArchiveContainer:"#archivecontainer",readerArchiveMonthItem:"archiveMonthItem",readerViewController:"#readerViewController",carousel:"infinitecarousel2d",backButton:"button[action=toolbarback]",menuCloseButton:".ReaderMenuClose",blocker:"blocker",navbutton:"navbutton",readerpageviewer:"readerpageviewer",readerpagenumber:"readerpagenumber",layouttoolbar:"layouttoolbar",layouttoolbartoggleicon:"layouttoolbartoggleicon",articlescontainer:"articlescontainer",sectionListOverlay:"sectionlistoverlay",sectionlistoverlayitem:"sectionlistoverlayitem",zonesOverlay:"zonesoverlay",zonesOverlayItem:"zonesoverlayitem",readerFree:"readerfree",fullscreenprompt:"fullscreenprompt"},control:{readerPanel:{ready:"readerContainerReady",readertap:"readerTap"},carousel:{pagechange:"readerPageChange",updatePageNumber:"readerPageChange"},readerToolbarBottom:{initialized:"toolbarBottomInit"},readerPages:{initialized:"renderPagesLoad"},readerArchive:{initialized:"renderArchiveLoad"},readerArchiveMonthItem:{changeMonth:"changeArchiveMonth"},mainPanel:{openReaderMenu:"toolbarMenu",readerRight:"toolbarNext",readerLeft:"toolbarPrevious",readerFirst:"toolbarFirst",readerLast:"toolbarLast",showTutorial:"toolbarShowTutorial",toggleDPSMode:"toggleDPSMode",dpsModeOn:"dpsModeOn",dpsModeOff:"dpsModeOff",fullscreenMode:"toolbarFullscreen",zoomModeFit:"zoomModeFit",zoomModeFill:"zoomModeFill",pageNumber:"toolbarPageNumber",toolbarShare:"toolbarShare",toolbarHowTo:"toolbarHowTo",toolbarSectionList:"toolbarSectionList",toolbarZones:"toolbarZones",archive:"renderArchive"},navbutton:{toolbarNext:"toolbarNext",toolbarPrevious:"toolbarPrevious"},readerpagenumber:{jumpToPage:"readerPageNumberJumpToPage",hide:"readerPageNumberHide",hideArticlesContainer:"hideArticlesContainer",showArticlesContainer:"showArticlesContainer"},layouttoolbartoggleicon:{addToggleGroup:"addToggleGroup",toggleGroupState:"toggleGroupState"},readertoolbarsharemenu:{loadShare:"toolbarLoadShare",shareMenuClose:"shareMenuClose"},zonesOverlay:{initialized:"zonesInitialized",close:"zonesClose"},zonesOverlayItem:{zoneEdition:"toolbarZoneEdition"},sectionListOverlay:{initialized:"sectionListInitialized",close:"sectionListClose",enableArticlesContainer:"enableArticlesContainer"},sectionlistoverlayitem:{sectionListPage:"toolbarSectionListPage"},readerFree:{close:"closeFree",subscribe:"subscribeFree",login:"loginFree"},fullscreenprompt:{launchfullscreen:"toolbarFullscreen"}}},init:function(){var a=this;a.showToolbar=true;pageSwipes=null;a.checkArchive();a.toggleGroups={}},checkArchive:function(){var b=this;var a=Ext.getStore("ArchiveStore");a.on({load:"archiveLoad",scope:this})},archiveLoad:function(h){var e=this;if(settings.menu!=null){if(settings.menu.archiveUsesTabs!=null){if(h.data.items[0].raw.editions!=null){var d=h.data.items[0].raw.editions.edition;h.months=[];if(d.length>0){var f=d[0];var a=f["@month"];var g=f["@year"];h.editionToLoad="month"+a+g;for(var c=0;c<d.length;c++){var b=d[c];var a=b["@month"];var g=b["@year"];var j="month"+a+g;if(h[j]==null){h.months.push(a+" "+g);h[j]=[b]}else{h[j].push(b)}}}}}}},readerTap:function(b){var d=this;var c=d.getReaderViewController();var a=d.getReaderToolbarBottom();a.setStyle({visibility:"hidden"});if(settings.topbar.toggleTopBar=="true"){d.toggleTopBar()}if(settings.reader.toggleNavButtons=="true"){d.toggleNavButtons()}},toggleNavButtons:function(){var b=this;var a=b.getReaderPanel();if(a!=null){a.fireEvent("toggleNavButtons")}},toolbarDisplay:function(a,e){var b=a.items.items;for(var d=0;d<b.length;d++){var c=b[d];if(c.id.indexOf("reader")==-1&&c.json.globalID.indexOf("Ad Block")){c.setStyle({visibility:e})}}},toolbarFullscreen:function(){var a=this;if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen()}else{if(document.documentElement.msRequestFullscreen){document.documentElement.msRequestFullscreen()}else{if(document.documentElement.mozRequestFullScreen){document.documentElement.mozRequestFullScreen()}else{if(document.documentElement.webkitRequestFullscreen){document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}}}}else{if(document.exitFullscreen){document.exitFullscreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}}}},toolbarBack:function(){mainPanel.setActiveItem(0);mainPanel.remove(this.getReaderPanel())},toolbarFirst:function(){var a=this.getCarousel();this.resetZoom();a.jumpToFirst();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"First page icon"})}},toolbarPrevious:function(){var a=this.getCarousel();this.resetZoom();this.getApplication().getController("PageTurnController").goLeft();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"Previous page icon"})}},toolbarNext:function(a){var b=this.getCarousel();this.resetZoom();this.getApplication().getController("PageTurnController").goRight();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"next page icon"})}},toolbarLast:function(){var a=this.getCarousel();this.resetZoom();a.jumpToLast();if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"last page icon"})}},toolbarPageNumber:function(c){var f=this;var b=f.getCarousel();var g=b.getActiveItem();var d=g.getPageNo()+1;var a=b.getData();var h=a.length-pageOffset-editionFlatplanData.sectionPageCount;var e=Ext.create("InfinityMobile.view.ReaderPageNumber",{currentPageNumber:d,maxValue:h});if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"page number navigation"})}Ext.Viewport.add(e);e.showBy(c)},readerPageNumberJumpToPage:function(a){var b=this;a.hide()},readerPageNumberHide:function(d){var e=this;var a=e.getCarousel();var b=(a._pageNumber+1);var g=e.getPageNumber(d);var f=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[g-1]!=null?flatPlanData.pdfPages[g-1].pages[0].advertsAdded:0;g+=f;if(g!=-1){var h=d.maxValue;var c=Math.min(g,h);c=Math.max(c,1);if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){c=(a.getData().length-c)+1}if(b!=c){a.jumpToPage(c-1)}}},getPageNumber:function(a){var b=this;var c=1;if(settings.reader.friendlyNumbering!=null){c=b.getPageNumberFriendly(a)}else{c=b.getPageNumberInt(a)}return c},getPageNumberFriendly:function(b){var c=this;var d=1;var a=b.pageNumberTextBox.value;if(!isNaN(a)){d=c.getPageNumberInt(b)}else{d=c.getPageNumberString(a)}return d},getPageNumberInt:function(a){var b=parseInt(a.pageNumberTextBox.value);if(b<1){b=-1}if(b>flatPlanData.pageGroups.length){b=-1}return b},getPageNumberString:function(b){var a=-1;var b=b.toUpperCase();if(flatPlanData.friendlyPageMapper[b]!=null){a=flatPlanData.friendlyPageMapper[b]+1}return a},returnReversePageMapper:function(a){return flatPlanData.reversePageMapper[a]},hideScrollNavBtns:function(){var d=this;var a=Ext.ComponentQuery.query("navbutton");var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode!="fill"){for(var b=0;b<a.length;b++){if(a[b].direction=="up"||a[b].direction=="down"){a[b].hide()}}}},resetZoom:function(){var a=this;if($("#slider").val()>1){var b=a.getCarousel();var c=b.getActiveItem();c.resetZoom();c.resetPage()}},toolbarShowTutorial:function(){},toggleDPSMode:function(){var a=this.getCarousel();a.toggleDPS()},dpsModeOn:function(){var c=this;var d=this.getCarousel();if(d.getMode()=="single"){d.toggleDPS();var a=c.getArticlescontainer();if(a!=null){a.fireEvent("checkActivePageInBrowser",a)}if(currentProfile=="desktop"){var b=c.getLayouttoolbar();if(b!=null&&settings.tts!=null){b.fireEvent("stopArticleTTS",b.ttsToggle,"na")}}else{if(settings.tts!=null){mainPanel.fireEvent("stopArticleTTS",ttsFlag,"na")}}}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"Double page mode icon"})}},dpsModeOff:function(){var c=this;var d=this.getCarousel();if(d.getMode()=="double"){d.toggleDPS();var a=c.getArticlescontainer();if(a!=null){a.fireEvent("checkActivePageInBrowser",a)}if(currentProfile=="desktop"){var b=c.getLayouttoolbar();if(b!=null&&settings.tts!=null){b.fireEvent("stopArticleTTS",b.ttsToggle,"na")}}else{if(settings.tts!=null){mainPanel.fireEvent("stopArticleTTS",ttsFlag,"na")}}}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"Single page mode icon"})}},zoomModeFit:function(){var a=this;if(currentProfile=="desktop"){a.desktopTryRemovePadding()}var b=this.getCarousel();if(b.getZoomMode()=="fill"){b.toggleZoomMode()}else{if(b.getActiveItem().scale>1&&b.getZoomMode()=="fit"){b._zoomMode="fill";b.toggleZoomMode()}}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"page fit mode icon"})}},zoomModeFill:function(){var a=this;if(currentProfile=="desktop"){a.desktopTrySetPadding()}var b=this.getCarousel();if(b.getZoomMode()=="fit"){b.toggleZoomMode()}else{if(b.getActiveItem().scale>1&&b.getZoomMode()=="fill"){b._zoomMode="fit";b.toggleZoomMode()}}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"page fill mode icon"})}},desktopTrySetPadding:function(){var b=this;var a=b.getReaderView();if(a.config.fillPadding!=null){a.setPadding(a.config.fillPadding)}},desktopTryRemovePadding:function(){var b=this;var a=b.getReaderView();if(a.config.fillPadding!=null){a.setPadding(0)}},toolbarMenu:function(){var a=this;var b="right";if(settings.newsday!=null){if(settings.newsday.menuDirection!=null){if(settings.newsday.menuDirection=="left"){b="left"}}}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"menu icon"});trackReaderEvent("menu")}var d="InfinityMobile.view.tablet.ReaderMenu";switch(currentProfile){case"phone":d="InfinityMobile.view.phone.ReaderMenu";break;case"tablet":default:d="InfinityMobile.view.tablet.ReaderMenu";break}var c=Ext.create(d,{direction:b});Ext.Viewport.add(c);c.show()},readerContainerReady:function(b){var c=this;var a=c.getCarousel();c.readerPageChange(a)},readerPageChange:function(e){var h=this;if(settings.reader.friendlyNumbering!=null){h.readerPageChangeFriendly(e)}else{var j=h.returnCurrentPageNumber(e);var b=e.getData();var f=b.length-pageOffset-flatPlanData.sectionPageCount-flatPlanData.totalAdvertsAdded;if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){j=b.length-j+1}var a=h.returnPageNumberString(j,f,e);e.json=e.config.json;var d=e.json.events.onValueChange[0];if(d!=null){var k=d.text;var g=d.target;if(a=="Advertisement"){k="Advertisement"}else{k=k.replace("%HPAGE%",a).replace("%HPCOUNT%",f);k=k.replace("Page ","")}var c=Ext.getCmp(g);if(c!=null){c.setHtml(k)}}}},readerPageChangeFriendly:function(f){var k=this;var l=(f._pageNumber+1);var c=f.getData();var h=c.length-pageOffset-flatPlanData.sectionPageCount;f.json=f.config.json;var e=f.json.events.onValueChange[0];if(e!=null){var m=e.text;var j=e.target;if(c[f._pageNumber].pages[0].pageName!=null){if(f._mode=="double"&&k.returnOrientation()=="landscape"){if(l!=1&&l!=h){var b=l;if(l%2==0){b=l+1}else{b=l-1}var g=Math.min(l,b);var a=Math.max(l,b);m=c[g-1].pages[0].pageName+" & "+c[a-1].pages[0].pageName+" / "+c[f._pageNumber].pages[0].sectionLength}else{m=c[f._pageNumber].pages[0].pageName+" / "+c[f._pageNumber].pages[0].sectionLength}}else{m=c[f._pageNumber].pages[0].pageName+" / "+c[f._pageNumber].pages[0].sectionLength}}else{m=m.replace("%HPAGE%",l).replace("%HPCOUNT%",c.length)}var d=Ext.getCmp(j);if(d!=null){d.setHtml(m)}}},returnPageNumberString:function(d,f,b){var e=this;var g=flatPlanData.pageMapper[d]-1;d=flatPlanData.pageGroups[g+pageOffset]!=null&&flatPlanData.pageGroups[g+pageOffset].pages[0].pageName!=null?flatPlanData.pageGroups[g+pageOffset].pages[0].pageName:d;if(b._mode=="double"&&e.returnOrientation()=="landscape"){if(d!="Advertisement"&&d!=1&&(d!=f||(d==f&&d%2==1))){var a=d;if(d%2==0){a=d+1}else{a=d-1}if(flatPlanData.bookmarks==null||(flatPlanData.bookmarks.indexOf(a)==-1&&flatPlanData.bookmarks.indexOf(a+1)==-1)){var c=d+"-"+a;if(d>a){c=a+"-"+d}return c}}}return d.toString()},returnCurrentPageNumber:function(a){var c=this;var b=(a._pageNumber+1);if(c.returnOrientation()=="landscape"&&a._mode=="double"){return flatPlanData.reversePageMapper[b]}return b},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){a="landscape"}}return a},toolbarBottomInit:function(){var b=this;var a=b.getReaderToolbarBottom();a.setStyle({visibility:"hidden"})},renderPages:function(){var c=this;var a=c.getReaderToolbarBottom();var b=a.scrollerContainer;b.removeAll(true);var d={xtype:"readerpages"}},renderPagesLoad:function(a){var l=this;var d=l.getCarousel().getData();var j=l.getReaderPages();var m=l.getReaderPagesContainer();var c=l.getReaderToolbarBottom();if(c!=null){var g=c.scroller.getScroller()}else{if(l.getArticlescontainer().scrollType=="senchaScroller"){var g=l.getArticlescontainer().getComponent("con").getScrollable().getScroller()}}for(var h=pageOffset;h<d.length;h++){var n=d[h].pages[0];if(n.type=="page"){var e=n.pageNum;if(settings.reader.reverse!=null&&settings.reader.reverse=="true"){e=d.length-e+1}var b=language.page+" "+(e);if(n.pageName!=null){var b=language.page+" "+n.pageName}var k=n.origPageNum;var f=Ext.create("InfinityMobile.view.ReaderPagesItem",{id:"page"+e,imgSrc:"https://edition.pagesuite-professional.co.uk/get_image.aspx?w=280&eid="+editionguid+"&pnum="+k,html:"<img id='imagepage"+e+"' class='readerPage' style='width:140px'  />",height:"100%",items:[{top:130,height:30,left:10,width:"120px",padding:"5 7 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; border-radius:5px; text-align:center",html:b}]});var o=f.element.down("img").dom;f.element.on({tap:function(p){if(l.getArticlescontainer()!=null){}l.clickPage(p,this.element.down("img").dom)},scope:f});m.add(f)}}if(settings.reader.reverse!=null&&settings.reader.reverse=="true"){g.scrollTo(d.length*150,0)}},renderArchive:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("archive")}a.disableArticlesContainer();var c="InfinityMobile.view.tablet.ReaderArchive";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ReaderArchive";break;case"desktop":c="InfinityMobile.view.desktop.ReaderArchive";break;case"tablet":if($(document).height()<700||$(document).width()<700){c="InfinityMobile.view.phone.ReaderArchive";break}default:c="InfinityMobile.view.tablet.ReaderArchive";break}var b=Ext.create(c,{});Ext.Viewport.add(b);b.show()},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},renderArchiveLoad:function(c){var b=this;var a=Ext.getStore("ArchiveStore");if(a.editionToLoad!=null){b.renderArchiveMonths(c)}b.renderArchivePages(c)},renderArchiveMonths:function(g){var h=this;var d=g.archiveMonthsContainer;var c=d.config.monthdirection;if(d!=null){var f=Ext.getStore("ArchiveStore");var b=f.months;for(var e=0;e<b.length;e++){var a=b[e];var j=Ext.create("InfinityMobile.view.ReaderArchiveMonthItem",{month:a,monthDirection:c});d.add(j)}}},changeArchiveMonth:function(e){var c=this;var a="month"+e.month.replace(" ","");var b=Ext.getStore("ArchiveStore");b.editionToLoad=a;var d=c.getReaderArchive();c.renderArchivePages(d)},renderArchivePages:function(g){var e=this;var b=Ext.getStore("ArchiveStore");var d=[];if(b.editionToLoad==null){if(b.data.items[0].raw.editions!=null){d=b.data.items[0].raw.editions.edition}g.hideMonthContainer()}else{d=b[b.editionToLoad]}var h=g.archiveItemsContainer;h.removeAll(true,true);if(d.length!=null){for(var c=0;c<d.length;c++){var f=d[c];var a=Ext.create("InfinityMobile.view.ReaderArchiveItem",{editionGuid:f["@editionguid"],editionName:f["@name"]});h.add(a)}}else{var f=d;var a=Ext.create("InfinityMobile.view.ReaderArchiveItem",{editionGuid:f["@editionguid"],editionName:f["@name"]});h.add(a)}},renderArchiveScroll:function(){var k=this;var h=Ext.getStore("ArchiveStore");var j=h.data.items[0].raw.editions.edition;var g=k.getReaderPages();var a=k.getReaderToolbarBottom();var d=a.getScrollable().getScroller();var f=Ext.Viewport.getWindowWidth()+d.position.x;var e=0;for(var c=0;c<j.length;c++){var b=j[c];if(e<f){var l=document.getElementById("imageedition"+(c+1));if(l.src==""){l.src="https://edition.pagesuite-professional.co.uk//get_image.aspx?w=280&eid="+b["@editionguid"]}}e+=150}d.on({scope:this,scrollend:k.renderPagesScroll,single:true})},clickPage:function(d,f){d.stopPropagation();var c=this;var b=parseInt(f.id.replace("imagepage",""));var e=this.getCarousel();e.jumpToPage((b-1));var a=c.getReaderToolbarBottom();if(a!=null){}},toggleTopBar:function(){var a=this;a.showToolbar=!a.showToolbar;if(currentProfile=="desktop"){a.toggleTopBarDesktop()}else{a.toggleTopBarMobile()}},toggleTopBarDesktop:function(){var b=this;var a=b.getLayouttoolbar();a.setHidden(!b.showToolbar);var c=b.getApplication().getController("ReaderController");if(!b.showToolbar){c.topBtn.setTop(-28)}else{c.topBtn.setTop(11)}},toggleTopBarMobile:function(){var e=this;var d=e.getReaderViewController();var b=d.items.items;for(var c=0;c<b.length;c++){var a=b[c];if(a.id!="reader"){a.setHidden(!e.showToolbar)}}},addToggleGroup:function(a,c){var b=this;if(b.toggleGroups[c]==null){b.toggleGroups[c]=[]}b.toggleGroups[c].push(a)},toggleGroupState:function(a,f){var e=this;if(e.toggleGroups[f]!=null){var b=e.toggleGroups[f];for(var d=0;d<b.length;d++){var c=b[d];c.updateState("")}}a.updateState("selected")},toolbarShare:function(a){var b=this;if(b.getArticlescontainer()!=null){b.disableArticlesContainer();b.hideArticlesContainer()}var c=Ext.create("InfinityMobile.view.desktop.ReaderToolbarShareMenu");if(settings.newsday!=null){Ext.Viewport.add(c);c.show();c.setLeft("50%");c.setTop("50%");c.setStyle({transform:"translate3d(-50%,-50%,0px)"})}else{c.showBy(a)}},toolbarLoadShare:function(b){var a=this;if(settings.sharing!=null&&settings.sharing.allSharing!=null&&settings.sharing.allSharing.length>0){a.populateShare(b)}},populateShare:function(e){var d=this;var f=settings.sharing.allSharing;for(var b=0;b<f.length;b++){var a=f[b];var c=settings.sharing[a];d.addShareItem(e,c.icon,c.link,a)}},addShareItem:function(b,l,e,k){var j=this;var m=j.getCarousel();var f=m.getActiveItem();var d=f.config.pageNo+1;if(f.xtype!="readeradvertpageviewer"){d=editionFlatplanData.reversePageMapper[d];var c=flatPlanData.pageMapper[d];var g=flatPlanData.pageGroups!=null&&flatPlanData.pageGroups[c-1]!=null?flatPlanData.pageGroups[c-1].pages[0].advertsAdded:0;d=g!=null?(d-g):d}else{d=null}if(e.indexOf("pinterest")!=-1){e=e.replace("{0}",encodeURIComponent("https://edition.pagesuite-professional.co.uk/get_image.aspx?w=280&eid="+editionguid+"&pnum="+d));e=e.replace("{1}","http://html5.pagesuite.com/desktop/share.aspx?edid="+editionguid+"&title="+encodeURIComponent(publicationName)+"&editionName="+encodeURIComponent(editionName)+"&pnum="+d);e=e.replace("{2}",encodeURIComponent(publicationName+" - "+editionName));var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:l,link:e,pnum:d,type:"pinterest",toolbar:true})}else{if(e.indexOf("mailto:")==-1){var a="http://html5.pagesuite.com/desktop/share.aspx?edid="+editionguid+"&title="+encodeURIComponent(publicationName)+"&editionName="+encodeURIComponent(editionName)+"&pnum="+d;var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:l,link:e,pnum:d,type:k,toolbar:true})}else{var k="";if(e.indexOf("mailto:")!=null){k="email"}var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:l,message:publicationName+" - "+editionName,link:e,pnum:d,type:k,toolbar:true})}}b.sharingContainer.add(h);b.setWidth($(b.element.dom).width()+40)},shareMenuClose:function(){var a=this;a.enableArticlesContainer()},showArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().element.dom.style.visibility="visible"}},hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}},toolbarHowTo:function(m,r,q,b,g){var t=this;if(t.hasHowTo==null||!t.hasHowTo){var d=window.onkeydown;window.onkeydown=null;t.hasHowTo=true;if(t.getArticlescontainer()!=null){t.getArticlescontainer().hide();t.getArticlescontainer().addCls("blur");t.getArticlescontainer().disableEvents()}var c=Ext.create("InfinityMobile.view.desktop.HowToEditionOptions",{});if(m!=null){c.showBy(m)}var j=Ext.create("InfinityMobile.view.desktop.HowToPageControl",{});if(r!=null){j.showBy(r)}var h=Ext.create("InfinityMobile.view.desktop.HowToViewOptions",{});if(q!=null){h.showBy(q)}var u=Ext.create("InfinityMobile.view.desktop.HowToDPS",{});if(g!=null&&typeof settings!="undefined"&&settings.reader!=null&&(settings.reader.toggleDPS=="true"||settings.reader.toggleDPS=="True")){u.showBy(g)}var k=Ext.create("InfinityMobile.view.desktop.HowToReader",{});Ext.Viewport.add(k);if(settings.newsday==null){var l=Ext.create("InfinityMobile.view.desktop.HowToMenuIcon",{});if(b!=null){l.showBy(b)}}if(t.getArticlescontainer()!=null){var p=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer=="true"){p=false}}if(p){var s=Ext.create("InfinityMobile.view.desktop.HowToArticlesContainer",{});s.showBy(t.getArticlescontainer().tab)}}var e=language.continueText;if(settings.newsday!=null){if(settings.newsday.articleHelper=="true"){e="Next"}}var a=typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"?50:100;var f=Ext.create("Ext.Container",{height:40,width:160,bottom:a,left:"50%",cls:"btn",html:"<p style='top:50%;left:50%;position:absolute;-webkit-transform:translate3d(-50%, -50%,0);transform:translate3d(-50%, -50%, 0);'>"+e+"</p>",style:"-webkit-transform:translateX(-50%);transform:translateX(-50%);background-color:rgb(69, 143, 187);color:white;"});f.element.on({tap:function(){window.onkeydown=d;var w=this;w.hasHowTo=false;c.destroy();j.destroy();h.destroy();k.destroy();f.destroy();if(s!=null){s.destroy()}if(l){l.destroy()}if(u!=null){u.destroy()}try{localStorage.setItem("helper"+publicationguid,"complete")}catch(x){w.setCookie("helper"+publicationguid,"complete")}if(typeof isTribReader!="undefined"&&isTribReader==true){w.checkTrialScreen()}else{w.removeBlur()}var v=Ext.create("InfinityMobile.view.ReaderArticleHelper",{});if(settings.newsday!=null){if(settings.newsday.articleHelper=="true"){mainPanel.add(v);v.show()}}},scope:t});Ext.Viewport.add(f);var o=t.getCarousel();o.addCls("blur");var n=Ext.ComponentQuery.query(".navbutton");for(btn in n){n[btn].addCls("blur")}}},checkTrialScreen:function(){var a=this;if(typeof showTrialScreen=="undefined"){showTrialScreen=false}if(showTrialScreen){a.helperFree();showTrialScreen=false}else{a.removeBlur()}},helperFree:function(b){showTrialScreen=true;var a="InfinityMobile.view.desktop.ReaderFree";var b=Ext.create(a,{});Ext.Viewport.add(b);b.show()},removeBlur:function(){var b=this;var c=b.getCarousel();c.removeCls("blur");if(b.getArticlescontainer()!=null){b.getArticlescontainer().removeCls("blur");b.getArticlescontainer().enableEvents()}var a=Ext.ComponentQuery.query(".navbutton");for(btn in a){a[btn].removeCls("blur")}},closeFree:function(b){var a=this;a.removeBlur();Ext.Viewport.remove(b,true)},subscribeFree:function(b){var a=this;a.removeBlur();Ext.Viewport.remove(b,true);a.showPayPanel()},loginFree:function(b){var a=this;a.removeBlur();Ext.Viewport.remove(b,true);fncLoginPopupShow()},showPayPanel:function(){fncFreeTrialSubscribe()},setCookie:function(d,g){var f=this;var b=new Date().getDay();switch(b){case 0:b="Sun";break;case 1:b="Mon";break;case 2:b="Tues";break;case 3:b="Wed";break;case 4:b="Thu";break;case 5:b="Fri";break;case 6:b="Sat";break}var c=new Date().getDate();var h=new Date().getMonth();switch(h){case 0:h="Jan";break;case 1:h="Feb";break;case 2:h="Mar";break;case 3:h="Apr";break;case 4:h="May";break;case 5:h="Jun";break;case 6:h="Jul";break;case 7:h="Aug";break;case 8:h="Sep";break;case 9:h="Oct";break;case 10:h="Nov";break;case 11:h="Dec";break}var e=new Date().getFullYear()+1;var a=b+", "+c+" "+h+" "+e+"12:00:00 UTC";document.cookie=d+"="+g+";expires="+a+";path=/"},toolbarZones:function(){var b=this;var c="InfinityMobile.view.desktop.ZonesOverlay";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ZonesOverlay";break;case"tablet":c="InfinityMobile.view.tablet.ZonesOverlay";break;case"desktop":c="InfinityMobile.view.desktop.ZonesOverlay";break}var a=Ext.create(c,{});Ext.Viewport.add(a);a.show()},zonesInitialized:function(a,g){var f=this;var d=settings.zones.zone;for(var b=0;b<d.length;b++){var e=d[b];var c=Ext.create("InfinityMobile.view.desktop.ZonesOverlayItem",{zoneItem:e});g.add(c)}},zonesClose:function(a){var b=this;a.hide()},toolbarZoneEdition:function(b,e,h){var f=this;var g="";if(e!=""){g="?edid="+e}else{g="?pubid="+h}var d="";if(qs.localhost!=null&&qs.localhost=="true"){d="&localhost=true"}var a="default.aspx";if(typeof isTribReader=="undefined"){isTribReader=false}if(isTribReader){try{localStorage.setItem("zones"+h,"true");setCookie("default_zone",h)}catch(c){setCookie("default_zone",h)}}window.location.href=a+g+d},toolbarSectionList:function(c){var b=this;b.disableArticlesContainer();b.hideArticlesContainer();var d="InfinityMobile.view.desktop.SectionListOverlay";switch(currentProfile){case"phone":d="InfinityMobile.view.phone.SectionListOverlay";break;case"tablet":d="InfinityMobile.view.tablet.SectionListOverlay";break;case"desktop":d="InfinityMobile.view.desktop.SectionListOverlay";break}var a=Ext.create(d,{});Ext.Viewport.add(a);a.show()},sectionListInitialized:function(e,g){var c=this;var f=settings.bookmarks.bookmark;for(var b=0;b<f.length;b++){var d=f[b];var a=Ext.create("InfinityMobile.view.desktop.SectionListOverlayItem",{sectionListText:d.name,sectionListPageNumber:d.pageNumber});g.add(a)}},sectionListClose:function(b){var a=this;b.hide()},toolbarSectionListPage:function(b,f){var e=this;var d=e.getSectionListOverlay();d.hide();var c=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[f-1]!=null?flatPlanData.pdfPages[f-1].pages[0].advertsAdded:0;var a=e.getCarousel();a.jumpToPage(parseInt(parseInt(f)+parseInt(c))-1)},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderToolbarController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderMenuController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel",readerMenu:"readermenu",readerSections:"readermenusection",readerArchive:"readerarchive",readerMenuItem:"readermenuitem",readerMenuSectionItem:"readermenusectionitem",reader:"reader",layouttoolbar:"layouttoolbar",carousel:"infinitecarousel2d",readerToolbarBottom:"readertoolbarbottom",articlereadermenu:"articlereadermenu",articlescontainer:"articlescontainer"},control:{main:{showZones:"renderZones"},readerMenu:{close:"menuClose",loadShare:"menuLoadShare",loadSections:"menuLoadSections",loadSupplements:"menuLoadSupplements",loadZones:"menuLoadZones",loadQuickLinks:"menuLoadQuickLinks",loadPrivacy:"menuLoadPrivacy",sectionclick:"sectionClick",disableArticlesContainer:"disableArticlesContainer",enableArticlesContainer:"enableArticlesContainer",hideArticlesContainer:"hideArticlesContainer"},readerMenuItem:{menuPages:"menuPages",menuArchive:"menuArchive",menuSearch:"menuSearch",menuDownload:"menuDownload",menuAddNote:"menuAddNote",menuCreateClipping:"menuCreateClipping",menuBookmarks:"menuBookmark",menuGames:"menuGames",menuBreakingNews:"menuBreakingNews",menuObituaries:"menuObituaries",menuHowToUse:"menuHowToUse","menuItem menuHowToUse":"menuHowToUse",menuWhatsNew:"menuWhatsNew",menuHelp:"menuHelp","menuItem menuHelp":"menuHelp",menuDynamicArticles:"menuDynamicArticles",menuArticles:"menuArticles",menuPrint:"menuPrint",menuUser:"menuUser",supplementItem:"menuSupplement",quickLinkItem:"menuQuickLink",privacyLinkItem:"menuQuickLink","privacyLinkItem menuItem":"menuQuickLink","quickLinkItem menuItem":"menuQuickLink",zoneItem:"menuZoneClick","zoneItem menuItem":"menuZoneClick",menuTerms:"menuTerms","menuItem menuTerms":"menuTerms",menuAccount:"menuAccount",menuSectionsBtn:"menuSectionsBtn",menuZonesBtn:"menuZonesBtn",menuStoryPref:"menuStoryPref",specialSupplmentMenuItem:"loadSpecialSupplements"},mainPanel:{toolbarInfo:"menuHowToUse",toolbarClipping:"menuCreateClipping",toolbarPrint:"menuPrint",toolbarBookmarks:"menuBookmark",toolbarDownload:"menuDownload",toolbarArchive:"menuArchive"},readerSections:{initialized:"sectionInit",back:"sectionBack",sectionclick:"sectionClick"},readerMenuSectionItem:{sectionclick:"sectionClick"},readerArchive:{close:"closeArchive",enableArticlesContainer:"enableArticlesContainer"},readerToolbarBottom:{close:"closePages"},articlereadermenu:{loadShare:"menuLoadShare"},readerspecialsupplements:{showSupplements:"showSupplements",close:"closeSupplements"}}},menuInit:function(){var b="InfinityMobile.view.tablet.ReaderMenu";switch(currentProfile){case"phone":b="InfinityMobile.view.phone.ReaderMenu";break;case"tablet":default:b="InfinityMobile.view.tablet.ReaderMenu";break}var a=Ext.create(b,{});Ext.Viewport.add(a);a.show()},menuClose:function(a){var b=this;var c=b.getReaderMenu();if(c==null){c=b.getArticlereadermenu()}if(c!=null){c.hide()}},menuDynamicArticles:function(){var a=this;articleMode="dynamic";var b="InfinityMobile.view.ArticleReader";var c=Ext.create(b,{orientation:a.returnOrientation()});a.menuClose();mainPanel.add(c);mainPanel.setActiveItem(c)},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},menuArchive:function(){var a=this;a.menuClose();a.renderArchive()},menuPages:function(){var a=this;a.menuClose();if(a.getArticlescontainer()==null){a.renderPages()}else{a.getArticlescontainer().pagesTabTap()}if(Ext.os.is.Phone){mainPanel.fireEvent("checkActivePageInToolbarBottom",a.getReaderToolbarBottom())}},menuSearch:function(){var a=this;mainPanel.fireEvent("showSearch","");a.menuClose()},menuAddNote:function(){var a=this;a.menuClose();mainPanel.fireEvent("addNote","")},menuCreateClipping:function(){var b=this;b.menuClose();var c=b.getCarousel();if(c.getActiveItem().xtype!="readeradvertpageviewer"){mainPanel.fireEvent("createClipping","")}else{var a=Ext.create("InfinityMobile.view.ReaderPrompt",{title:language.clippings.invalidClipping,message:language.clippings.invalidPage});a.show();Ext.Viewport.add(a)}},menuBookmark:function(){var a=this;a.menuClose();mainPanel.fireEvent("bookmark","")},menuSections:function(){var b=this;b.menuClose();var c="InfinityMobile.view.tablet.ReaderMenuSection";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ReaderMenuSection";break;case"tablet":default:c="InfinityMobile.view.tablet.ReaderMenuSection";break}var a=Ext.create(c,{});Ext.Viewport.add(a);a.show()},menuLoadShare:function(b){var a=this;if(settings.menu.hideSharing!=null){b.sharingContainer.hide()}else{if(settings.sharing!=null&&settings.sharing.allSharing!=null&&settings.sharing.allSharing.length>0){a.populateShare(b)}else{b.sharingContainer.hide()}}},populateShare:function(e){var d=this;var f=settings.sharing.allSharing;for(var b=0;b<f.length;b++){var a=f[b];var c=settings.sharing[a];d.addShareItem(e,c.icon,c.link,a)}},addShareItem:function(b,l,e,k){var j=this;var m=j.getCarousel();var f=m.getActiveItem();var d=f.config.pageNo+1;if(f.xtype!="readeradvertpageviewer"){d=editionFlatplanData.reversePageMapper[d];var c=flatPlanData.pageMapper[d];var g=flatPlanData.pageGroups!=null&&flatPlanData.pageGroups[c-1]!=null&&flatPlanData.pageGroups[c-1].pages[0].advertsAdded!=null?flatPlanData.pageGroups[c-1].pages[0].advertsAdded:0;d-=g}else{d=null}if(e.indexOf("pinterest")!=-1){e=e.replace("{0}",encodeURIComponent("https://edition.pagesuite-professional.co.uk/get_image.aspx?w=280&eid="+editionguid+"&pnum="+d));e=e.replace("{1}","http://html5.pagesuite.com/desktop/share.aspx?edid="+editionguid+"&title="+encodeURIComponent(publicationName)+"&editionName="+encodeURIComponent(editionName)+"&pnum="+d);e=e.replace("{2}",encodeURIComponent(publicationName+" - "+editionName));var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:l,link:e,pnum:d,type:"pinterest",menu:"true"})}else{if(e.indexOf("mailto:")==-1){var a="http://html5.pagesuite.com/desktop/share.aspx?edid="+editionguid+"&title="+encodeURIComponent(publicationName)+"&editionName="+encodeURIComponent(editionName)+"&pnum="+d;var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:l,link:e,type:k,pnum:d,menu:"true"})}else{var h=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{message:publicationName+" - "+editionName,icon:l,link:e,type:k,pnum:d,menu:true})}}b.sharingContainer.add(h)},menuLoadSections:function(b,d,e){var f=this;var j=settings.bookmarks;var a=settings.menu.sectionList;if(settings.menu.hideSectionList==null&&j.bookmark.length>0){if(settings.menu.bookmarkText!=null){e.setHtml(language.menu.sections.toUpperCase())}for(var c=0;c<j.bookmark.length;c++){var g=j.bookmark[c];var h=Ext.create("InfinityMobile.view.ReaderMenuSectionItem",{name:g.name,pageNumber:g.pageNumber});d.add(h)}}else{e.setHidden(true)}},menuLoadSupplements:function(f,c,g){var e=settings.menu.supplements;if(e!=null&&e.supplement.length>0){g.setHtml(language.menu.supplements.toUpperCase());for(var d=0;d<e.supplement.length;d++){var a=e.supplement[d];if(a.guid!=publicationguid){var b=Ext.create("InfinityMobile.view.ReaderMenuItem",{cls:"supplementItem",text:a.name,guid:a.guid,editionguid:a.editionGuid});c.add(b)}}}else{g.setHidden(true)}},loadSpecialSupplements:function(a){var b=this;b.menuClose();var d="InfinityMobile.view.desktop.ReaderSpecialSupplements";var c=Ext.create(d,{supplements:a.config.supplements});Ext.Viewport.add(c);c.show()},showSupplements:function(b){var d=this;console.log("supplements");var e=b.config.supplements;if(e!=null&&e.length>0){for(var c=0;c<e.length;c++){if(e[c]!=null){var a=Ext.create("InfinityMobile.view.ReaderSpecialSupplementsItem",{publicationGuid:e[c].guid,publicationName:e[c].name,editionGuid:e[c].editionGuid});b.itemsContainer.add(a);a.show()}}}},closeSupplements:function(a){a.hide()},menuLoadZones:function(b,h,e){var j=this;var g=settings.menu.zones;var c=settings.zones;if(typeof isTribReader=="undefined"){isTribReader=false}if(g!=null&&c!=null&&c.zone.length>0&&!isTribReader){for(var d=0;d<c.zone.length;d++){var k=c.zone[d];var f="zoneItem";if(settings.newsday!=null){f+=" menuItem"}var a=Ext.create("InfinityMobile.view.ReaderMenuItem",{cls:f,text:k.name,guid:k.guid,editionguid:k.editionGuid});h.add(a)}}else{e.setHidden(true)}},menuZoneClick:function(c){var b=this;var a="";if(qs.localhost!=null&&qs.localhost=="true"){a="&localhost=true"}window.location.href="default.aspx?&edid="+c.config.editionguid+a;window.open(quickLink.config.url)},menuLoadQuickLinks:function(a,f,c){var h=this;var e=settings.menu.quickLinks;if(e!=null&&e.quickLink.length>0){for(var g=0;g<e.quickLink.length;g++){var d=e.quickLink[g];var j="quickLinkItem";if(settings.newsday!=null){j+=" menuItem"}var b=Ext.create("InfinityMobile.view.ReaderMenuItem",{cls:j,text:d.name,url:d.value});f.add(b)}}else{c.setHidden(true)}},menuLoadPrivacy:function(a,d,g){var f=this;var h=settings.menu!=null?settings.menu.privacy:null;if(h!=null&&h.privacyLinks.length>0){for(var e=0;e<h.privacyLinks.length;e++){var c=h.privacyLinks[e];var j="privacyLinkItem";if(settings.newsday!=null){j+=" menuItem"}var b=Ext.create("InfinityMobile.view.ReaderMenuItem",{cls:j,text:c.name,url:c.value});d.add(b)}}else{g.setHidden(true)}},menuSupplement:function(a){console.log(a.config);if(a.config.text=="Courant Community"){window.location.href="launch_community.aspx"}else{if(a.config.editionguid!=""){window.location.href="default.aspx?edid="+a.config.editionguid}else{window.location.href="default.aspx?pubid="+a.config.guid}}},menuQuickLink:function(a){window.open(a.config.url)},menuDownload:function(){var a=this;mainPanel.fireEvent("showDownload","");a.menuClose()},menuGames:function(){var a=this;a.openLink("http://games.courant.com/")},menuBreakingNews:function(){var a=this;a.openLink("http://www.courant.com/breaking-news/")},menuObituaries:function(){var a=this;a.openLink("http://www.legacy.com/obituaries/hartfordcourant")},openLink:function(a){window.open(a)},renderPages:function(){var c=this;var a=c.getReaderToolbarBottom();var b=a.scrollerContainer;b.removeAll(true);var d={xtype:"readerpages"};b.add(d);a.setStyle({visibility:"visible"})},closePages:function(a){a.setStyle({visibility:"hidden"})},renderArchive:function(){var a=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("archive")}a.disableArticlesContainer();a.hideArticlesContainer();var c="InfinityMobile.view.tablet.ReaderArchive";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ReaderArchive";break;case"desktop":c="InfinityMobile.view.desktop.ReaderArchive";break;case"tablet":if($(document).height()<700||$(document).width()<700){c="InfinityMobile.view.phone.ReaderArchive";break}default:c="InfinityMobile.view.tablet.ReaderArchive";break}var b=Ext.create(c,{});Ext.Viewport.add(b);b.show()},closeArchive:function(a){a.hide()},sectionInit:function(f){var b=f.sectionItemsContainer;var e=Ext.getStore("BookmarkStore");var g=e.data.items[0].raw.bookmarks;for(var c=0;c<g.length;c++){var a=g[c];var d=Ext.create("InfinityMobile.view.ReaderMenuSectionItem",{name:a.name,pageNumber:a.pageNumber});b.add(d)}},sectionClose:function(){var a=this;var b=a.getReaderSections();b.hide()},sectionBack:function(){var a=this;a.sectionClose();a.menuInit()},sectionClick:function(b){var a=this;b.element.dom.style.backgroundColor="#458fbb";setTimeout(function(){if(a.getReaderMenu()!=null){a.menuClose()}else{a.sectionClose()}var d=a.getCarousel();var c=flatPlanData.pdfPages[parseInt(b.pageNumber)-1].pages[0].pageNum-1;d.jumpToPage(c)},100)},menuHowToUse:function(){var a=this;a.menuClose();if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide();a.getArticlescontainer().addCls("blur");a.getArticlescontainer().disableEvents()}showTrialScreen=false;if(!Ext.os.is.Desktop){var b="InfinityMobile.view.tablet.ReaderHelper";switch(currentProfile){case"phone":b="InfinityMobile.view.phone.ReaderHelper";break;case"tablet":default:b="InfinityMobile.view.tablet.ReaderHelper";break}var c=Ext.create(b,{});mainPanel.add(c);c.show();a.getCarousel().addCls("blur")}else{a.getLayouttoolbar().howToTap()}},menuWhatsNew:function(){var a=this;a.menuClose();var b="InfinityMobile.view.tablet.ReaderWhatsNew";switch(currentProfile){case"phone":b="InfinityMobile.view.phone.ReaderWhatsNew";break;case"tablet":default:b="InfinityMobile.view.tablet.ReaderWhatsNew";break}var c=Ext.create(b,{});mainPanel.add(c);c.show()},menuHelp:function(){var a=this;a.menuClose();window.location.href="mailto:"+settings.menu.contactUsEmailAddress},menuPrint:function(){var a=this;mainPanel.fireEvent("loadPrintMenu");a.menuClose()},menuArticles:function(){var a=this;if(Ext.os.is.Phone){a.menuDynamicArticles()}else{if(a.getArticlescontainer().articleTabTap!=null){a.getArticlescontainer().articleTabTap()}else{a.grabArticles()}}a.menuClose()},grabArticles:function(){var c=this;c.articles=c.getApplication().getController("ArticleController").getArticles();var b=Ext.getStore("SettingStore");var e=[];if(b.data.items[0].raw.menu.bookmarks!=null){e=b.data.items[0].raw.menu.bookmarks.bookmark}if(Ext.os.is.Phone){var a=Ext.create("InfinityMobile.view.phone.ArticlesContainer",{articles:c.articles,sections:e})}else{var d="InfinityMobile.view.ArticlesContainer";if(Ext.os.is.Tablet){d="InfinityMobile.view.tablet.ArticlesContainer"}if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){d="InfinityMobile.view.tablet.ArticlesContainer"}}var a=Ext.create(d,{articles:c.articles,sections:e})}Ext.Viewport.add(a);a.show()},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},menuUser:function(){$.ajax({url:"logout.aspx?pubid="+publicationguid}).done(function(a){window.location.href=a.url})},menuTerms:function(){var b=this;if(Ext.os.is.Phone){var a=Ext.create("InfinityMobile.view.phone.readerTerms",{})}else{var a=Ext.create("InfinityMobile.view.desktop.readerTerms",{})}b.menuClose()},menuAccount:function(){var a=this;window.open(editionDomain+"my_account.aspx?eid="+editionguid,"_blank")},menuSectionsBtn:function(){var a=this;a.getMainPanel().fireEvent("toolbarSectionList");a.menuClose()},menuZonesBtn:function(){var a=this;a.getMainPanel().fireEvent("toolbarZones");a.menuClose()},menuStoryPref:function(){var a=this;a.menuClose();var c="InfinityMobile.view.StoryWindowPreferences";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.StoryWindowPreferences";break}var b=Ext.create(c);Ext.Viewport.add(b);b.show();console.log(b)},hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderMenuController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderSearchController",Ext.app.Controller,{config:{stores:["SearchStore"],refs:{readerPanel:"reader",mainPanel:"#rootPanel",searchPanel:"search",searchItem:"searchItem",carousel:"infinitecarousel2d",articlescontainer:"articlescontainer"},control:{mainPanel:{toolbarSearch:"toolbarSearch",showSearch:"showSearch"},searchPanel:{close:"close",search:"search",searchCurrentEdition:"searchCurrentEdition",searchAllEditions:"searchAllEditions",showSearchDate:"showSearchDate",searchDate:"searchDate",enableArticlesContainer:"enableArticlesContainer"},searchItem:{click:"selectSearchItem"}}},init:function(){var b=this;var a=Ext.getStore("SearchStore");a.on({load:"searchLoad",scope:this})},close:function(a){a.hide()},toolbarSearch:function(){var a=this;a.showSearch("")},showSearch:function(b){var c=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("headerNav",{type:"search icon"})}c.disableArticlesContainer();c.hideArticlesContainer();if(c.searchContainer!=null){c.searchContainer.show()}else{var d="InfinityMobile.view.tablet.ReaderSearch";switch(currentProfile){case"phone":d="InfinityMobile.view.phone.ReaderSearch";break;case"tablet":default:d="InfinityMobile.view.tablet.ReaderSearch";break}var a=Ext.create(d,{searchTerm:b});Ext.Viewport.add(a);a.show();c.searchContainer=a}},hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}},search:function(){var j=this;var c=j.getSearchPanel();var d=c.searchTerm;var m=encodeBase64(d);j.hideSearchDate();if(d!=""){var k=c.searchType;var e=c.searchResultsContainer;if(typeof trackReaderEvent!="undefined"&&!j.isSearching){trackReaderEvent("search",{search:d,searchType:k})}var f="../../searchjson.aspx?q="+encodeURIComponent(m)+"&eid="+editionguid+"&t="+k+"&p=0&rp=100&f=100&s=r&base64=true&version="+version;if(k=="d"){var h=c.dateFrom;var l=c.dateTo;if(typeof isTribReader!="undefined"){if(isTribReader){var g=h.split("-");h=g[2]+"-"+g[0]+"-"+g[1];var b=l.split("-");l=b[2]+"-"+b[0]+"-"+b[1]}}f="../../searchjson.aspx?q="+encodeURIComponent(m)+"&eid="+editionguid+"&t="+k+"&dfrom="+h+"&dto="+l+"&p=0&rp=100&f=100&s=r&base64=true&version="+version}var a=Ext.getStore("SearchStore");a.setProxy({url:f});a.data.items[0]=null;a.on("load",function(){j.isSearching=false});j.isSearching=true;a.load();c.setMasked({xtype:"loadmask",message:language.search.searching})}},searchCurrentEdition:function(){var b=this;var a=b.getSearchPanel();a.searchType="e";b.search()},searchAllEditions:function(){var b=this;var a=b.getSearchPanel();a.searchType="p";b.search()},showSearchDate:function(){var b=this;var a=b.getSearchPanel();if(a.searchDateContainer.getCls()!="searchDate"){a.searchDateContainer.setCls("searchDate");a.searchDateContainer.removeCls("hideItem")}else{a.searchDateContainer.removeCls("searchDate");a.searchDateContainer.addCls("hideItem")}},hideSearchDate:function(){var b=this;var a=b.getSearchPanel();a.searchDateContainer.setCls("searchDate hidden")},searchDate:function(c){var b=this;var a=b.getSearchPanel();a.searchType="d";a.dateFrom=a.startDate.dom.value;a.dateTo=a.endDate.dom.value;a.searchDateContainer.setCls("searchDate hidden");b.search()},searchLoad:function(l){var k=this;console.log(l);var b=k.getSearchPanel();var o="Error while searching. Please try another search terms";var h="No results to display. Please try another search term";if(k.isSpanish()){o="Error en su bsqueda. Por favor intente nuevamente con otro trmino de bsqueda.";h="Error en su bsqueda. Por favor intente nuevamente con otro trmino de bsqueda."}if(b!=null){var c=b.searchResultsContainer;c.removeAll(true);if(l.data.items[0]!=null){if(l.data.items[0].raw.search!=null){var j=l.data.items[0].raw.search.results;var a=j["@hitCount"];if(j.result!=null){var f=j.result;if(a==1){var n=Ext.create("InfinityMobile.view.ReaderSearchItem",{pageNumber:f["@pnum"],name:f["@name"],editionGuid:f["@eid"],textString:f["#text"],searchType:b.searchType});c.add(n)}else{for(var d=0;d<f.length;d++){var e=f[d];var n=Ext.create("InfinityMobile.view.ReaderSearchItem",{pageNumber:e["@pnum"],name:e["@name"],editionGuid:e["@eid"],textString:e["#text"],searchType:b.searchType});c.add(n)}}}else{c.add({padding:20,html:h})}}else{c.add({padding:20,html:o})}}else{c.add({padding:20,html:o})}b.setMasked(false);if(Ext.os.is.Desktop&&Ext.browser.is.IE){if(b.searchResultsContainer!=null){var g=b.searchResultsContainer.getItems().items;var m=0;for(d in g){m+=$(g[d].element.dom).height()+1}b.scrollContainer.style.height=m+"px"}}}},isSpanish:function(){if(language.close.toLowerCase()=="cerrar"||language.go.toLowerCase()=="ir"){return true}else{return false}},selectSearchItem:function(d){var e=this;if(d.editionGuid==editionguid){var a=e.getCarousel();var c=parseInt(d.pageNumber)-1;c=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[c]!=null?flatPlanData.pdfPages[c].pages[0].pageNum-1:c;a.jumpToPage(c);e.loadPageSearchResults(c)}else{window.open("default.aspx?pubid="+publicationguid+"&edid="+d.editionGuid+"&pnum="+d.pageNumber,"_blank")}var b=e.getSearchPanel();e.close(b)},loadPageSearchResults:function(l){var h=this;var a="";var e="";if((l)%2==1){a=l+pageOffset;e=l+1+pageOffset}else{e=l+pageOffset;a=l-1+pageOffset}if(flatPlanData.pdfPages!=null){a=flatPlanData.pdfPages[a].pageNum;e=flatPlanData.pdfPages[e].pageNum}else{a=editionFlatplanData.pageMapper[a+1]-1;e=editionFlatplanData.pageMapper[e+1]-1}var b=editionFlatplanData.pageGroups;var j="";if(a>=0){var k=b[a].pages[0];j=h.retrievePageGuid(k)}var m="";if(e<=(b.length-2)){var g=b[e].pages[0];m=h.retrievePageGuid(g)}var d=h.getSearchPanel();var f=d.searchTerm;var c=Ext.getStore("SearchHighlightStore");c.leftPageNumber=a;c.rightPageNumber=e;c.leftPageGuid=j;c.rightPageGuid=m;c.term=f;c.setProxy({url:"../../searchhighlight.aspx?leftpageguid="+j+"&rightpageguid="+m+"&term="+f});c.load()},returnAdvertOffset:function(c){var b=this;var d=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var e=settings.reader.interstitialPageFlow;var a=editionFlatplanData.pageGroups[c-1];if(a!=null&&a.pages[0]!=null){if(!isNaN(a.pages[0].advertsAdded)){d=a.pages[0].advertsAdded}}}return d},retrievePageGuid:function(c){var b=c.image.split("/");var a=b[b.length-2];return a},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderSearchController"],0));(Ext.cmd.derive("InfinityMobile.controller.ReaderDownloadController",Ext.app.Controller,{config:{refs:{mainPanel:"#rootPanel",reader:"reader",carousel:"infinitecarousel2d",readerDownload:"download",readerDownloadItem:"downloaditem",articlescontainer:"articlescontainer",readerDownloadScreen:"downloadscreen",articlescontainer:"articlescontainer"},control:{mainPanel:{showDownload:"showDownload"},readerDownload:{close:"closeDownload",selectAll:"selectAll",selectNone:"selectNone",download:"download",enableArticlesContainer:"enableArticlesContainer",loadPages:"loadPages"},readerDownloadItem:{toggleCheckBox:"toggleCheckBox"},readerDownloadScreen:{back:"closeDownloadScreen"}}},init:function(){},showDownload:function(){var b=this;b.disableArticlesContainer();b.hideArticlesContainer();var c="InfinityMobile.view.tablet.ReaderDownload";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ReaderDownload";break;case"desktop":c="InfinityMobile.view.desktop.ReaderDownload";break;case"tablet":default:c="InfinityMobile.view.tablet.ReaderDownload";break}var a=Ext.create(c,{});Ext.Viewport.add(a);a.show()},hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}},closeDownload:function(a){a.hide()},selectAll:function(b){var e=this;var a=e.getAllDownloadItems(b);for(var d=0;d<a.length;d++){var c=a[d];e.checkCheckBox(c)}},selectNone:function(b){var e=this;var a=e.getAllDownloadItems(b);for(var d=0;d<a.length;d++){var c=a[d];e.uncheckCheckBox(c)}},getAllDownloadItems:function(a){return a.downloadItemsContainer.getItems().items},download:function(d){var g=this;var c=g.getAllDownloadItems(d);var b="";for(var f=0;f<c.length;f++){var e=c[f];if(g.getCheckedStatus(e)){var a=e.getPageIndex();if(b!=""){b+="|"}b+=(a)}}if(b!=""){d.setMasked({xtype:"loadmask",message:"Scheduling PDFs"});g.downloadPDF(b)}if(typeof trackDaEvent!="undefined"){trackDaEvent("Download Edition","Digital Edition")}if(typeof trackReaderEvent!="undefined"){trackReaderEvent("download")}},downloadPDF:function(b){var f=this;var g='<pages fromEdition="'+editionguid+'" mobile="true">';var a=b.split("|");for(var c=0;c<a.length;c++){var d=a[c];var e=f.retrievePageGuid(d);g+='<page id="'+e+'"/>'}g+="</pages>";f.postPages(g)},postPages:function(c){var b=this;var a="../../Queue_PDF.aspx";$.ajax({crossDomain:true,type:"POST",contentType:"text/xml",data:c,async:true,url:a,cache:false,success:function(e){var d=$(e).find("pdf").text();b.schedulePDF(d)},error:function(d){console.log(d)}})},schedulePDF:function(a){var b=this;$.ajax({crossDomain:true,type:"GET",async:true,url:a,cache:false,success:function(d){var c=b.getReaderDownload();c.setMasked(false);b.showDownloadScreen(a)},error:function(c){console.log(c)}})},showDownloadScreen:function(b){var c=this;var a=c.getReaderDownload();var d=Ext.create("InfinityMobile.view.ReaderDownloadScreen",{downloadUrl:b,startingOrientation:c.returnOrientation()});if(c.getArticlescontainer()!=null){c.getArticlescontainer().hideMe()}a.hide();mainPanel.add(d);mainPanel.setActiveItem(d)},closeDownloadScreen:function(b){var e=this;var a=e.getReader();mainPanel.setActiveItem(a);mainPanel.remove(b,true);var d=b.config.startingOrientation;var c=e.returnOrientation();if(e.getArticlescontainer()!=null){e.getArticlescontainer().element.dom.style.visibility="visible"}if(d!=c){var f=e.getCarousel();f.onResize()}},retrievePageGuid:function(b){var d=this;var a=d.getCarousel().getData();var c=a[(b-1)];thisActualPage=c.pages[0];return thisActualPage.image.split("/")[5]},loadPages:function(f,b){var h=this;var a=h.getCarousel().getData();for(var e=0;e<a.length;e++){var j=a[e].pages[0];if(j.type=="page"){var c=j.origPageNum!=null?j.origPageNum:j.pageNum;var g=j.pageIndex;var d=Ext.create("InfinityMobile.view.ReaderDownloadItem",{editionGuid:editionguid,pageNo:c,pageIndex:g});b.add(d)}}},checkCheckBox:function(a){a.editionLabelCheckBox.check()},getCheckedStatus:function(a){return a.editionLabelCheckBox.isChecked()},uncheckCheckBox:function(a){a.editionLabelCheckBox.uncheck()},toggleCheckBox:function(a,b){var c=this;if(c.getCheckedStatus(a)){c.uncheckCheckBox(a)}else{c.checkCheckBox(a)}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}}},0,0,0,0,0,0,[InfinityMobile.controller,"ReaderDownloadController"],0));(Ext.cmd.derive("InfinityMobile.controller.SubscribeController",Ext.app.Controller,{config:{refs:{main:"#rootPanel",subscribe:"subscribe",login:"login"},control:{main:{checkLogin:"checkLogin"},subscribe:{close:"subscribeClose",login:"subscribeShowLogin",digital:"subscribeDigital",premium:"subscribePremium"},login:{back:"loginBack",login:"tryLogIn"}}},init:function(){},checkLogin:function(){var a=this},showSubscribe:function(){var b="InfinityMobile.view.tablet.Subscribe";switch(currentProfile){case"phone":b="InfinityMobile.view.phone.Subscribe";break;case"tablet":default:b="InfinityMobile.view.tablet.Subscribe";break}var a=Ext.create(b,{});Ext.Viewport.add(a);a.show()},subscribeClose:function(a){a.hide()},subscribeDigital:function(a){var b=this;console.log("Subscribe Digital")},subscribePremium:function(a){var b=this;console.log("Subscribe Premium");b.subscribe(a)},subscribe:function(a){var b=this;localStorage.setItem("login","someLogin");b.subscribeClose(a)},subscribeShowLogin:function(a){var b=this;b.subscribeClose(a);b.showLogin()},showLogin:function(a){var c="InfinityMobile.view.tablet.Login";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.Login";break;case"tablet":default:c="InfinityMobile.view.tablet.Login";break}var b=Ext.create(c,{});Ext.Viewport.add(b);b.show()},loginBack:function(b){var a=this;a.closeLogin(b);a.showSubscribe()},closeLogin:function(a){a.hide()},tryLogIn:function(){console.log("Logging In")}},0,0,0,0,0,0,[InfinityMobile.controller,"SubscribeController"],0));(Ext.cmd.derive("InfinityMobile.controller.MediaController",Ext.app.Controller,{config:{refs:{main:"main",readerlinkobject:"readerlinkobject",readerarticleobject:"readerarticleobject",readerarticlepopover:"articleview",layouttoolbar:"layouttoolbar",articlecarousel:"articlecarousel",reader:"reader",readerCarousel:"infinitecarousel2d",readerpageviewer:"readerpageviewer",readervideo:"readervideo",readervideocontrols:"readervideocontrols",readerimage:"readerimage",imagegallery:"imagegallery",readerimagelinkobject:"readerimagelinkobject",readervideolinkobject:"readervideolinkobject",readerogalleryobject:"readerogalleryobject",readerovideoobject:"readerovideoobject",zoomSlider:"zoomSlider",sharepopup:"sharepopup",articlereader:"articlereader",articlescontainer:"articlescontainer",imagecarousel:"imagecarousel",lightboxlink:"lightboxlink",readermenutts:"readermenutts",dynamicimagegallery:"dynamicimagegallery",livenewsticker:"livenewsticker",sectionpopup:"sectionpopup",readerMenu:"readermenu"},control:{main:{addNote:"addNote",stopArticleTTS:"stopArticleTTS",trackArticleLinkClick:"trackArticleLinkClick",settingsLoaded:"settingsLoaded"},readerpageviewer:{loadMedia:"loadMediaPage",clearMedia:"clearMediaPage",keyControls:"keyControls",checkAudioOnToggle:"checkAudioOnToggle"},readerlinkobject:{linkClick:"linkClick",setupArticleTooltip:"setupArticleTooltip",hideArticleTooltip:"hideArticleTooltip",updateArticleTooltipPosition:"updateArticleTooltipPosition",popupLink:"popupLinkClick"},readerarticleobject:{articleClick:"articleClick",setupArticleTooltip:"setupArticleTooltip",hideArticleTooltip:"hideArticleTooltip",updateArticleTooltipPosition:"updateArticleTooltipPosition"},readerarticlepopover:{initialized:"readerArticleInitialize",close:"readerArticleClose",hide:"readerArticleHide",previous:"previousArticle",next:"nextArticle",sharepopup:"sharepopup",closeAndReset:"readerArticleCloseAndReset",setArticlePopoverHeight:"setArticlePopoverHeight",toggleTTS:"toggleTTS",playArticleTTS:"playArticleTTS",resumeArticleTTS:"resumeArticleTTS",pauseArticleTTS:"pauseArticleTTS",stopArtclesTTS:"stopArticleTTS",hidden:"onArticleHide",opened:"onArticleOpen",print:"articlePrint",jumpToComics:"jumpToComics",jumpToPuzzles:"jumpToPuzzles",selectTextMode:"selectTextMode",copyToClipboard:"copyToClipboard",sectionPopup:"sectionPopup",translateArticlePopover:"translateArticlePopover",translate:"translate",translateArticle:"translateArticle",readAloudMode:"readAloudMode"},layouttoolbar:{toggleTTS:"toggleTTS",playArticleTTS:"playArticleTTS",resumeArticleTTS:"resumeArticleTTS",pauseArticleTTS:"pauseArticleTTS",stopArtclesTTS:"stopArticleTTS"},readermenutts:{toggleTTS:"toggleTTS",playArticleTTS:"playArticleTTS",resumeArticleTTS:"resumeArticleTTS",pauseArticleTTS:"pauseArticleTTS",stopArtclesTTS:"stopArticleTTS"},readerarticlepopoveritem:{galleryClickFromArticle:"galleryClickFromArticle",ovideoclicked:"ovideoclicked",galleryClick:"galleryClick",fillPrintContainer:"fillPrintContainer",trackOLink:"trackOLink"},articlecarousel:{pagechange:"articleItemChange"},readervideo:{videoloaded:"videoLoaded",timeupdated:"videoTimeUpdated",checkActivePageVideo:"checkActivePageVideo"},readervideocontrols:{videoplay:"videoPlay",videofullscreen:"videoFullscreen"},readerimage:{fullscreenImage:"fullscreenImage",linkClick:"linkClick",setupArticleTooltip:"setupArticleTooltip",hideArticleTooltip:"hideArticleTooltip",updateArticleTooltipPosition:"updateArticleTooltipPosition"},imagegallery:{initialized:"galleryinitialized",close:"closegallery",bottomToolbar:"bottomToolbar"},readerimagelinkobject:{lightbox:"lightbox"},readervideolinkobject:{lightbox:"lightbox"},articlereaderitemlrg:{articleClick:"articleClick"},articlereaderitemsmall:{articleClick:"articleClick"},articlereaderitemmedwide:{articleClick:"articleClick"},articlereaderitemmedtall:{articleClick:"articleClick"},articlereaderitemmedwidetall:{articleClick:"articleClick"},articlereaderitemtopstoryitem:{articleClick:"articleClick"},articlereaderitemphone:{articleClick:"articleClick"},sharepopup:{loadShareIcons:"loadShareIcons"},sharepopupitem:{emailArticleShare:"emailArticleShare"},articlesectionitemimg:{articleClick:"articleClick"},articlesectionitem:{articleClick:"articleClick"},readeraudiomediaobject:{playAudio:"playAudio",pauseAudio:"pauseAudio",stopAudio:"stopAudio",checkActivePage:"checkActivePage"},readerogalleryobject:{galleryClick:"galleryClick"},readerogallery:{closeOGallery:"closeOGallery",ogalleryinitialized:"ogalleryinitialized",ogalleryinitializedArticle:"ogalleryinitializedArticle"},readerovideoobject:{ovideoclicked:"ovideoclicked"},readerovideo:{closeOVideo:"closeOVideo",oVideoError:"oVideoError",ovideoinitialized:"ovideoinitialized"},readerimagegallerythumb:{navigateGallery:"navigateGallery"},readerpuzzlepopoveritem:{puzzleArchive:"puzzleArchive",puzzlePrint:"puzzlePrint",puzzleShare:"puzzleShare",puzzleInteractive:"puzzleInteractive"},readerpuzzlearchive:{initialized:"archiveInitialized",back:"closeArchive",archivePageChange:"archivePageChange",archiveNextPage:"archiveNextPage",archivePreviousPage:"archivePreviousPage"},readerpuzzlearchiveitem:{loadPuzzleItem:"loadPuzzleItem"},readermediaobject:{triggerMedia:"triggerMedia"},articlePopoverInterstitial:{scaleInterstitial:"scaleInterstitial",scaleInterstitialOnDevice:"scaleInterstitialOnDevice"},lightboxlink:{close:"closeLightBoxLink"},dynamicimagegallery:{galleryVisible:"galleryVisible",galleryInvisible:"galleryInvisible"},sectionpopup:{loadSectionsPopup:"loadSectionsPopup"},readersectionpopupitem:{jumpToSectionPage:"jumpToSectionPage"},readaloudcontrols:{playArticleText:"playArticleText",pauseArticleText:"pauseArticleText",restartArticleText:"restartArticleText",stopArticleText:"stopArticleText"}}},selectTextMode:function(){var e=this;var d=e.articleCarousel.items.items;for(var c=0;c<d.length;c++){var b=d[c];var a=e.articleCarousel;if(b==e.articleCarousel.getActiveItem()){b.destoryAdvertMpuSlot()}if(!e.isPuzzleOrComic(b)){b.toggleToTextMode()}}var f=e.getReaderarticlepopover();if(f!=null){if(f.highlightMode){e.highlightDisable();f.highlightMode=false}else{e.highlightInstructions();f.highlightMode=true}}},isPuzzleOrComic:function(a){var b=this;var c=a.config.page.description;if(c.indexOf("Comics - ")!=-1||c.indexOf("Puzzles - ")!=-1){return true}else{return false}},init:function(){var a=this;a.startComic=0;a.startPuzzle=0;readAloud={type:"",status:"STOPPED",text:"",controls:null};a.mediaObjects=new Array();a.mediaStore=Ext.getStore("MediaStore");a.mediaStore.on({load:"mediaLoaded",scope:a});a.searchHighlightStore=Ext.getStore("SearchHighlightStore");a.searchHighlightStore.on({load:"searchHighlightLoaded",scope:a});if(a.getCookie("lang")){a.currentLang=a.getCookie("lang");if(a.currentLang=="es"&&a.getReaderarticlepopover()){a.getReaderarticlepopover().inappTrans.removeCls("spain")}}else{a.currentLang="en"}a.articleStore=Ext.getStore("ArticleStore");a.nextCounter=0;a.previousCounter=0;a.showAdAt=5;a.flippAdvertSetting={}},jumpToComics:function(a){var b=this;b.articleCarousel.jumpToPage(parseFloat(b.startComic))},jumpToPuzzles:function(a){var b=this;b.articleCarousel.jumpToPage(parseFloat(b.startPuzzle))},checkTopBar:function(b,a){var c=a.getActiveItem();if(typeof isTribReader!="undefined"&&isTribReader){if(c.id.indexOf("readerarticlepopoveritem")!=-1){if(b.readAloudControls!=null&&b.readAloudMode&&window.SpeechSynthesisUtterance!=undefined){b.readAloudControls.show()}if(b.ttsToggle!=null&&window.SpeechSynthesisUtterance!=undefined){b.ttsToggle.show()}}else{if(b.readAloudControls!=null&&b.readAloudMode&&window.SpeechSynthesisUtterance!=undefined){b.readAloudControls.hide()}if(b.ttsToggle!=null&&window.SpeechSynthesisUtterance!=undefined){b.ttsToggle.hide()}}}},mediaLoaded:function(b){var c=this;var a=b.data.items[0].raw;b.media=a.media;c.setUniqueArticles(b);c.checkPuzzlesAndComics(b.media)},checkPuzzlesAndComics:function(f){var e=this;var d=f.article;e.foundComic=false;e.foundPuzzle=false;for(var c=0;c<d.length;c++){var a=d[c].description;var g=d[parseInt(c)+1];if(g!=null){var b=g.description;if(a.indexOf("Comics")!=-1&&e.startComic==0&&b.indexOf("Comics")!=-1){e.startComic=c;e.foundComic=true}else{if(a.indexOf("Puzzles")!=-1&&e.startPuzzle==0&&b.indexOf("Puzzles")!=-1){e.startPuzzle=c;e.foundPuzzle=true}}}if(e.startComic!=0&&e.startPuzzle!=0){break}}},setUniqueArticles:function(e){var f=this;var c=[];var b=[];var a=e.media.article;for(var d=0;d<a.length;d++){var g=a[d];if((uniquearticleindex=$.inArray(g.file,c))==-1){b.push(g);c.push(g.file);g.uniquearticleindex=(b.length-1)}else{g.uniquearticleindex=uniquearticleindex}}f.mediaStore.media.uniquearticle=b;f.mediaStore.media.articleguidarray=c},returnAdvertOffset:function(c){var b=this;var d=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var e=settings.reader.interstitialPageFlow;var a=editionFlatplanData.pageGroups[c+pageOffset];if(a!=null&&a.pages[0]!=null){if(!isNaN(a.pages[0].advertsAdded)){d=a.pages[0].advertsAdded}}}return d},loadMediaPage:function(b,a,g){var f=this;var d=Ext.getStore("MediaStore");var e=f.returnAdvertOffset(b.getPageNo());a=a-e;if(Ext.os.is.Desktop){}if(settings.reader.reverse!=null&&settings.reader.reverse=="true"){a=flatPlanData.pageGroups.length-a+1}f.clearAllExistingMedia(g);f.loadArticleMediaPage(d.media,a,g,b);f.loadImageMediaPage(d.media,a,g,b);var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.leftSideAd!=null){}f.loadVideoMediaPage(d.media,a,g,b);f.loadVimeoMedia(d.media,a,g,b);f.loadAudioMedia(d.media,a,g,b);f.loadHtmlAnim(d.media,a,g);f.loadOGallery(d.media,a,g);f.loadOVideo(d.media,a,g);f.loadOLink(d.media,a,g);f.loadLinkMediaPage(d.media,a,g,b);f.mediaDiv=g;f.pageNumber=a},clearMediaPage:function(b){var a=this;a.clearAllExistingMedia(b)},clearAllExistingMedia:function(a){while(a.lastChild){a.removeChild(a.lastChild)}},loadOLink:function(g,a,e){var d=this;for(var c=0;c<g.olink.length;c++){var b=g.olink[c];var h=parseInt(b.page);if(h<=a){if(h==a){var f=Ext.create("InfinityMobile.view.ReaderOLinkObject",{mediaObject:b,pageNumber:a});e.appendChild(f.element.dom)}}else{break}if(typeof f!="undefined"){d.mediaObjects.push(f)}}},loadOGallery:function(g,a,e){var d=this;for(var c=0;c<g.ogallery.length;c++){var b=g.ogallery[c];var h=parseInt(b.page);if(h<=a){if(h==a){var f=Ext.create("InfinityMobile.view.ReaderOGalleryObject",{mediaObject:b,pageNumber:a});e.appendChild(f.element.dom)}}else{break}if(typeof f!="undefined"){d.mediaObjects.push(f)}}},loadOVideo:function(g,a,e){var d=this;for(var c=0;c<g.ovideo.length;c++){var b=g.ovideo[c];var h=parseInt(b.page);if(h<=a){if(h==a){var f=Ext.create("InfinityMobile.view.ReaderOVideoObject",{mediaObject:b,pageNumber:a});e.appendChild(f.element.dom)}}else{break}if(typeof f!="undefined"){d.mediaObjects.push(f)}}},loadAudioMedia:function(b,k,g,h){var j=this;j.mediaFiles=[];h.audioObjects=[];if(b.audio!=null){for(var f=0;f<b.audio.length;f++){var m=b.audio[f];var c=parseInt(m.page);if(c<=k){if(k==c){var e=Ext.create("InfinityMobile.view.ReaderAudioMediaObject",{mediaObject:m,page:h});g.appendChild(e.element.dom);console.log(e);if(h.audioObjects!=null){h.audioObjects[h.audioObjects.length]=e}else{h.audioObjects=[];h.audioObjects[0]=e}var n=m.file;var d=n.substr(0,1);var a=n.substr(1,1);var l="http://source.pagesuite.com/media/"+d+"/"+a+"/"+n+".mp3";j.mediaFiles[j.mediaFiles.length]=l;if(typeof e!="undefined"){j.mediaObjects.push(e);e=null}}else{break}}}}},loadHtmlAnim:function(a,j,g){var h=this;j=parseInt(j);var c=1;g.animObjects=[];if(a.flash!=null){for(var e=0;e<a.flash.length;e++){var f=a.flash[e];var b=parseInt(f.page);if(b<=j){if(j==b){var d=Ext.create("InfinityMobile.view.ReaderAnimationObject",{mediaObject:f,pageNumber:j,page:g});g.appendChild(d.element.dom);c++;g.animObjects.push(d)}}else{break}if(typeof d!="undefined"){h.mediaObjects.push(d)}}}},loadArticleMediaPage:function(b,l,g){var j=this;l=parseInt(l);var h=5;var e=h-1;var m=j.articleStore.allArticles;for(var f=0;f<b.article.length;f++){var d=b.article[f];var a=parseInt(d.page);var k=m[d.file];if(a<=l){if(l==a){var c=Ext.create("InfinityMobile.view.ReaderArticleObject",{mediaObject:d,pageNumber:l,articleIndex:d.uniquearticleindex,article:k});g.appendChild(c.element.dom)}}else{break}}},keyControls:function(){var d=this;var a=d.getReaderCarousel();var c=false;var b=false;window.onkeyup=function(f){f.stopPropagation();if(Ext.browser.is.Firefox&&f.keyCode==9){f.preventDefault()}if(f.keyCode==91){c=false}if(f.keyCode==37||f.keyCode==39){b=false}};window.onkeydown=function(g){if(Ext.browser.is.Firefox&&g.keyCode==9){g.preventDefault()}if($("#reg-overlay")[0]==null){if(g.keyCode==91){c=true}if($("#slider").val()>1){g.stopImmediatePropagation();if(g.keyCode==39){if(a.getActiveItem().getScrollable().getScroller().position.x+50<a.getActiveItem().getScrollable().getScroller().maxPosition.x){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x+50)}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().maxPosition.x)}}else{if(g.keyCode==37){if(a.getActiveItem().getScrollable().getScroller().position.x-50>0){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x-50)}else{a.getActiveItem().getScrollable().getScroller().scrollTo(0)}}}}else{g.stopImmediatePropagation();if(g.keyCode==39){if(!c){if(!b){b=true;var f=!d.isFullscreenAdInView();if(f){d.getApplication().getController("PageTurnController").goRight()}}}}else{if(g.keyCode==37){if(a.getActiveItem().config.pageNo>=1){if(!c){if(!b){b=true;var f=!d.isFullscreenAdInView();if(f){d.getApplication().getController("PageTurnController").goLeft()}}}}}}}if(g.keyCode===38){if(a.getActiveItem().getScrollable().getScroller().position.y-50>0){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().position.y-50);if(a.getActiveItem().zoomMode!="fit"){d.getApplication().getController("ReaderController").showTop();if(a.getActiveItem().getScrollable().getScroller().position.y-30<a.getActiveItem().getScrollable().getScroller().maxPosition.y){d.getApplication().getController("ReaderController").showBottom()}else{d.getApplication().getController("ReaderController").hideBottom()}}}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,0);if(a.getActiveItem().zoomMode!="fit"){d.getApplication().getController("ReaderController").hideTop();d.getApplication().getController("ReaderController").showBottom()}}}if(g.keyCode===40){if(a.getActiveItem().getScrollable().getScroller().position.y+50<a.getActiveItem().getScrollable().getScroller().maxPosition.y){a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().position.y+50);if(a.getActiveItem().zoomMode!="fit"){d.getApplication().getController("ReaderController").showBottom();if(a.getActiveItem().getScrollable().getScroller().position.y+30>0){d.getApplication().getController("ReaderController").showTop()}else{d.getApplication().getController("ReaderController").hideTop()}}}else{a.getActiveItem().getScrollable().getScroller().scrollTo(a.getActiveItem().getScrollable().getScroller().position.x,a.getActiveItem().getScrollable().getScroller().maxPosition.y);if(a.getActiveItem().zoomMode!="fit"){d.getApplication().getController("ReaderController").hideBottom();d.getApplication().getController("ReaderController").showTop()}}}}}},isFullscreenAdInView:function(){var c=this;if(settings.reader.interstitial!=null&&settings.reader.interstitial.dfpType=="fullscreen"){var d=$("body").children("div[draggable='false']");if(d.length>1){for(var b=0;b<d.length;b++){if(d[b].style!=null){var a=d[b].style.display;if(a!="none"){return true}else{return false}}}}}else{return false}},loadLinkMediaPage:function(a,g,d,e){var f=this;e.linkObjects=[];g=parseInt(g);if(g==0){f.loadLeftHandLinkMediaPage(d,e)}for(var c=0;c<a.link.length;c++){var h=a.link[c];var j=parseInt(h.page);if(j<=g){if(g==j){if(Ext.os.is.Desktop){if(h.x<0&&(g==1||g==0)){if(h.url!=null&&h.url.indexOf("?liveadvert=yes")!=-1){console.log(h);var b=Ext.create("InfinityMobile.view.ReaderLiveAdvertObject",{pageNumber:g,mediaObject:h,page:d,leftSideOverflow:true})}else{var b=Ext.create("InfinityMobile.view.ReaderLinkObject",{pageNumber:g,mediaObject:h,page:d,leftSideOverflow:true})}e.overflowMediaDiv.add(b)}else{if(h.url.indexOf("?liveadvert=yes")!=-1){console.log(h);var b=Ext.create("InfinityMobile.view.ReaderLiveAdvertObject",{pageNumber:g,mediaObject:h,page:d})}else{var b=Ext.create("InfinityMobile.view.ReaderLinkObject",{pageNumber:g,mediaObject:h,page:d})}d.appendChild(b.element.dom)}}else{if(h.url.indexOf("?liveadvert=yes")!=-1){console.log(h);var b=Ext.create("InfinityMobile.view.ReaderLiveAdvertObject",{pageNumber:g,mediaObject:h,page:d})}else{var b=Ext.create("InfinityMobile.view.ReaderLinkObject",{pageNumber:g,mediaObject:h,page:d})}d.appendChild(b.element.dom)}}}else{break}if(typeof b!="undefined"){f.mediaObjects.push(b);e.linkObjects.push(b)}}},loadLeftHandLinkMediaPage:function(e,d){var c=this;if(settings.leftSideAd!=null&&settings.leftSideAd.link!=null){var a=settings.leftSideAd.link;var b={guid:"5f49d0c8-c52c-4c76-a8ef-712c5977275f",page:0,x:0,y:0,width:100,height:100,description:"",backgroundColor:"ff0000",backgroundAlpha:0,showBorder:false,borderColor:"ff0000",url:a,file:"",param3:"NONE",animType:"",removeType:"",delayTime:"",duration:"",depthIndex:0,remove:"",removeDelay:"",appear:"",flash:false,flashSpeed:"0.5",flashOnce:"false"};var f=Ext.create("InfinityMobile.view.ReaderLinkObject",{pageNumber:0,mediaObject:b,page:e,disableToolTip:true});e.appendChild(f.element.dom)}},loadImageMediaPage:function(e,p,j,k){var m=this;p=parseInt(p);j.imageObjects=[];var f=0;if(k.overflowMediaDiv!=null){k.overflowMediaDiv.removeAll()}for(var h=0;h<e.image.length;h++){var o=e.image[h];var q=parseInt(o.page);var r={};var c=0;for(var n=0;n<e.link.length;n++){var d=parseFloat(o.x)+parseFloat(o.width);var b=parseFloat(o.y)+parseFloat(o.height);var a=parseFloat(e.link[n].x)+parseFloat(e.link[n].width);var l=parseFloat(e.link[n].y)+parseFloat(e.link[n].height);if((parseFloat(e.link[n].x)>=parseFloat(o.x)&&parseFloat(e.link[n].x)<=parseFloat(d))&&(parseFloat(e.link[n].y)>=parseFloat(o.y)&&parseFloat(e.link[n].y)<=parseFloat(b))){r[c]=e.link[n];c++}}if(q<=p&&o.file!="808a2503-c3d8-43c7-a2a0-017e57123e46"){if(e.image[h].url!="http://LIGHTBOX"){if(p==q){if(Ext.os.is.Desktop){if(o.x<0&&(p==1||p==0)){var g=Ext.create("InfinityMobile.view.ReaderImageObject",{mediaObject:o,pageNumber:p,page:j,links:r,leftSideOverflow:true});k.overflowMediaDiv.show();k.overflowMediaDiv.add(g)}else{var g=Ext.create("InfinityMobile.view.ReaderImageObject",{mediaObject:o,pageNumber:p,page:j,links:r});j.appendChild(g.element.dom)}}else{var g=Ext.create("InfinityMobile.view.ReaderImageObject",{mediaObject:o,pageNumber:p,page:j,links:r});j.appendChild(g.element.dom)}f++}}else{if(p==q){console.log("CREATING IMAGE LINK OBJECT");var g=Ext.create("InfinityMobile.view.ReaderImageLinkObject",{mediaObject:o});j.appendChild(g.element.dom);f++;o.imageObject=g}}}else{break}if(typeof g!="undefined"){m.mediaObjects.push(g)}}},fullscreenImage:function(d){var b=this;var e="InfinityMobile.view.FullScreenImageGallery";var c=Ext.create(e,{images:[{url:d.imageurl}]});var a=b.getReaderCarousel();Ext.Anim.run(a.getActiveItem(),{type:"fade",easing:"ease-out",after:function(){mainPanel.add(c);mainPanel.setActiveItem(c);c.setShowAnimation("fade");c.hide();c.show()}})},galleryinitialized:function(a){var b=this;var d="InfinityMobile.view.FullscreenImageGalleryItem";var c=Ext.create("InfinityMobile.view.ImageCarousel",{width:"100%",height:"100%",style:"background-color:black",mode:"single",data:a.images,pageTemplate:function(f,g,e){return Ext.create("InfinityMobile.view.FullscreenImageGalleryItem",{pageNo:g,page:f})}});a.add(c);b.gallery=a},closegallery:function(b){var c=this;var a=c.getReader();mainPanel.setActiveItem(a);mainPanel.remove(b,true);var d=c.getReaderCarousel();d.onResize()},loadVideoMediaPage:function(a,k,f,h){var j=this;k=parseInt(k);if(f.videoObjects==null){f.videoObjects=[];var b=1}else{var b=f.videoObjects.length}for(var d=0;d<a.video.length;d++){var g=a.video[d];var e=parseInt(g.page);if(a.video[d].param3!="LIGHTBOX"){if(e<=k){if(k==e){if(Ext.os.is.Desktop){if(g.x<0&&(k==1||k==0)){var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f,leftSideOverflow:true});h.overflowMediaDiv.show();h.overflowMediaDiv.add(c);h.mp4Objects[h.mp4Objects.length]=c}else{var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c}}else{var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c}b++;g.videoObject=c}}else{break}}else{if(k==e){var c=Ext.create("InfinityMobile.view.ReaderVideoLinkObject",{mediaObject:g});f.appendChild(c.element.dom);b++;g.videoObject=c}}if(typeof c!="undefined"){j.mediaObjects.push(c)}}},loadVimeoMedia:function(a,k,f,h){var j=this;k=parseInt(k);if(f.videoObjects==null){f.videoObjects=[];var b=1}else{var b=f.videoObjects.length}for(var d=0;d<a.vimeo.length;d++){var g=a.vimeo[d];var e=parseInt(g.page);if(e<=k){if(k==e){var c=Ext.create("InfinityMobile.view.ReaderVideoObject",{pageNumber:k,mediaObject:g,page:f});f.appendChild(c.element.dom);h.mp4Objects[h.mp4Objects.length]=c;b++;g.videoObject=c}}else{break}if(typeof c!="undefined"){j.mediaObjects.push(c)}}},videoLoaded:function(f){var d=this;var b=f.video.duration;var a=Math.floor(b/60);var e=Math.floor(b-(a*60));if(e<10){e="0"+e}var c=f.videoControls.totalTime;c.dom.innerHTML=a+":"+e},videoTimeUpdated:function(d){var b=this;var f=d.video.currentTime;var c=Math.floor(f/60);var a=Math.floor(f-(c*60));if(a<10){a="0"+a}var e=d.videoControls.currentTime;e.dom.innerHTML=c+":"+a},videoPlay:function(c,d,b){var a=this;if(b.paused){b.play();d.dom.className="playbutton pause"}else{b.pause();d.dom.className="playbutton play"}return false},videoFullscreen:function(c,b){var a=this;b.webkitEnterFullscreen();b.mozRequestFullScreen();return false},articleClick:function(a,b){var c=this;if(loggedIn.toLowerCase()!="true"){if(settings.subscription.pageRestriction!=null){if(a.pageNumber>=settings.subscription.pageRestriction.pages){}else{c.showArticlePopover(a,b)}}else{c.showArticlePopover(a,b)}}else{c.showArticlePopover(a,b)}},getSectionName:function(a){var c=this;var e=settings.bookmarks.bookmark;var d=null;if(e!=null&&e.length>0){for(var b in e){if(a>=e[b].pageNumber&&(e[parseInt(b)+1]==null||a<e[parseInt(b)+1].pageNumber)){d=e[b].name;break}}}return d},linkClick:function(h,e){var s=this;var n=this.getReaderCarousel();if(!isNaN(e)){var q=Ext.getStore("SettingStore");n.jumpToPage(e-1);var f=n.getActiveItem()}else{if(e.indexOf("mailto:")!=-1){window.location.href=e;if(typeof trackReaderEvent!="undefined"){var r=h.mediaObject.page;var g=s.getSectionName(r);trackReaderEvent("link",{url:e,pageNum:r,section:g})}}else{var b=e.split("//");var a=b[1];var p=h.pageNumber;var k="page"+p+a;var l=false;var d="";var m=Ext.getStore("MediaStore");if(a.indexOf("video")!=-1){var j=parseInt(a.replace("video",""))-1;if(m.media.video.length>j&&m.media.video[j].videoObject!=null){d=m.media.video[j].videoObject;l=true}}else{if(a.indexOf("image")!=-1){var o=parseInt(a.replace("image",""))-1;if(m.media.image.length>o&&m.media.image[o].imageObject!=null){d=m.media.image[o];l=true}}else{if(a.indexOf("animation")!=-1){var c=h.page.animObjects}}}if(d!=""){if(d.getHidden()){d.show()}}if(!l){if(typeof trackReaderEvent!="undefined"){var r=h.mediaObject.page;var g=s.getSectionName(r);trackReaderEvent("link",{url:e,pageNum:r,section:g})}window.open(e,"_blank")}}}},trackArticleLinkClick:function(a){var b=this;if(typeof trackReaderEvent!="undefined"){trackReaderEvent("link",{url:a.url,pageNum:a.pageNum,articleNumber:a.articleNumber,section:b.getSectionName(a.pageNum)})}},popupLinkClick:function(b,d){var c=this;c.startLightBoxOrientation=c.returnOrientation();var e="InfinityMobile.view.LightboxLink";switch(currentProfile){case"desktop":e="InfinityMobile.view.desktop.LightboxLink";break}var a=Ext.create(e,{mediaObject:d});if(currentProfile=="desktop"){Ext.Viewport.add(a);a.show()}else{mainPanel.add(a);mainPanel.setActiveItem(a)}},closeLightBoxLink:function(c){var d=this;var a=d.getReader();mainPanel.setActiveItem(a);mainPanel.remove(c,true);var b=d.returnOrientation();if(b!=d.startLightBoxOrientation){d.getReaderCarousel().onResize(null)}},showArticlePopover:function(e,l){var k=this;var b=e.config.articleIndex;var j=5;var n=k.mediaStore.media.article;var m="InfinityMobile.view.tablet.ReaderArticlePopover";switch(currentProfile){case"phone":m="InfinityMobile.view.phone.ReaderArticlePopover";var a=k.getArticlescontainer();if(a!=null){a.hide()}break;case"tablet":m="InfinityMobile.view.tablet.ReaderArticlePopover";var a=k.getArticlescontainer();if(a!=null){a.hide()}break;case"desktop":m="InfinityMobile.view.desktop.ReaderArticlePopover";break;default:m="InfinityMobile.view.tablet.ReaderArticlePopover";break}var h=Ext.create(m,{mediaController:k,articleguid:l,articleIndex:b,hasComics:k.foundComic,hasPuzzles:k.foundPuzzle});if(b==0){h.previousArticleButton.element.dom.style.visibility="hidden"}else{if(b==n.length-1){h.nextArticleButton.element.dom.style.visibility="hidden"}}var f=k.getReaderCarousel();f.fireEvent("notidle",f);if(!Ext.os.is.Desktop){if(articleMode=="dynamic"){mainPanel.add(h);mainPanel.setActiveItem(h)}else{Ext.Anim.run(f.getActiveItem(),{type:"fade",easing:"ease-in",after:function(){mainPanel.add(h);mainPanel.setActiveItem(h)}})}}var d=Ext.getStore("SettingStore");if(d.data.items[0].raw.tracking!=null){var c=d.data.items[0].raw.tracking.trackingType;if(c=="GA"){ga("set","page","/"+e.pageNumber);ga("send",{hitType:"pageview",title:publicationName+" - "+editionName});if(e.mediaObject==null){var g=e.headline}else{var g=e.mediaObject.description}ga("send","event","Open Article","click",g,e.pageNumber)}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight});k.trackOpenArticle(e.config.articleIndex)},trackOpenArticle:function(c){var d=this;if(typeof trackReaderEvent!="undefined"){var e={};var a=d.mediaStore.media.article;if(typeof a!="undefined"){var f=a[c];var b="";if(f!=null&&f.byline!=null&&f.byline.trim()!=""){b=f.byline}else{if(f.ID3_Artist!=null){b=f.ID3_Artist}}e={pageNumArray:[f.page],pageNum:f.page,author:b,articleGuid:f.guid,headline:f.description,section:d.getSectionName(f.page),articleNumber:c,articleExternalId:"externalId" in f&&f.externalId!=null?f.externalId:""}}trackReaderEvent("openArticle",e)}},readerArticleInitialize:function(e){var l=this;var a=e.content;var o=l.mediaStore.media.article;var d=l.mediaStore.media.uniquearticle;l.startArticleOrientation=l.returnOrientation();var c=e.config.articleIndex;var j=d.length;for(var n in d){d[n].articleNumber=parseFloat(n)+1}var g=0;if(settings.newsday!=null){if(settings.newsday.showInterstitialInArticlePopover=="true"){d=jQuery.extend(true,[],l.mediaStore.media.uniquearticle);for(var h=c+5;h<d.length;h=h+5){var m="InfinityMobile.view.desktop.ArticlePopoverInterstitial";switch(currentProfile){case"phone":m="InfinityMobile.view.phone.ArticlePopoverInterstitial";break;case"tablet":m="InfinityMobile.view.tablet.ArticlePopoverInterstitial";break}d.splice(h,0,{isAdvert:true})}for(var h=c-5;h>0;h=h-5){var m="InfinityMobile.view.desktop.ArticlePopoverInterstitial";g++;switch(currentProfile){case"phone":m="InfinityMobile.view.phone.ArticlePopoverInterstitial";break;case"tablet":m="InfinityMobile.view.tablet.ArticlePopoverInterstitial";break}var b=Ext.create(m,{isAdvert:true});d.splice(h,0,{isAdvert:true})}c=c+g}}l.articleCarousel=Ext.create("InfinityMobile.view.ArticleCarousel",{width:"100%",height:"100%",pageNumber:c,offset:g,data:d,numberOfArticles:j,pageTemplate:function(s,u,q){articleguid=s.file;var t=l.articleStore.allArticles[articleguid];if(typeof isTribReader!="undefined"){if(isTribReader){if(s.description.indexOf("Puzzles")!=-1||s.description.indexOf("Comics")!=-1){return Ext.create("InfinityMobile.view.desktop.ReaderPuzzlePopoverItem",{pageNo:u,page:s})}else{if(Ext.os.is.Desktop){return Ext.create("InfinityMobile.view.desktop.ReaderArticlePopoverItem",{pageNo:u,page:q[u],article:t,highlightMode:e.highlightMode,readAloudMode:e.readAloudMode})}else{return Ext.create("InfinityMobile.view.ReaderArticlePopoverItem",{pageNo:u,page:q[u],article:t,highlightMode:e.highlightMode})}}}else{if(Ext.os.is.Desktop){if(this.getData()[u].isAdvert==null){return Ext.create("InfinityMobile.view.desktop.ReaderArticlePopoverItem",{pageNo:u,page:q[u],article:t,highlightMode:e.highlightMode})}else{var r=Ext.create(m,{isAdvert:true});r.pageNo=u;r.config.pageNo=u;return r}}else{if(s.description!=null&&(s.description.indexOf("Puzzles")!=-1||s.description.indexOf("Comics")!=-1)){return Ext.create("InfinityMobile.view.ReaderPuzzlePopoverItem",{pageNo:u,page:s})}else{if(this.getData()[u].isAdvert==null){return Ext.create("InfinityMobile.view.ReaderArticlePopoverItem",{pageNo:u,page:q[u],article:t,highlightMode:e.highlightMode})}else{var r=Ext.create(m,{isAdvert:true});r.pageNo=u;r.config.pageNo=u;return r}}}}}else{if(Ext.os.is.Desktop){if(this.getData()[u].isAdvert==null){return Ext.create("InfinityMobile.view.desktop.ReaderArticlePopoverItem",{pageNo:u,page:q[u],article:t,highlightMode:e.highlightMode})}else{var r=Ext.create(m,{isAdvert:true});r.pageNo=u;r.config.pageNo=u;return r}}else{if(this.getData()[u].isAdvert==null){return Ext.create("InfinityMobile.view.ReaderArticlePopoverItem",{pageNo:u,page:q[u],article:t,highlightMode:e.highlightMode})}else{var r=Ext.create(m,{isAdvert:true});r.pageNo=u;r.config.pageNo=u;return r}}}}});a.add(l.articleCarousel);l.trackArticleChange(c,"Article Click",l.articleCarousel.getActiveItem());var f=d[c];var k="Article";if(language!=null&&language.article!=null){k=language.article}e.articleText.setHtml(k+" "+((d[c].articleNumber))+" / "+j);if(!Ext.os.is.Phone){l.articleLoadShare(e,f)}if(trackOmniture=="True"){trackArticle(f.page,f.description)}l.articleCarousel.on("hide",function(){console.log("hide")});if(Ext.os.is.Desktop){l.articleKeyControl()}if(settings.newsday!=null){if(l.articleCarousel.getActiveItem()!=null){var p=l.articleCarousel.getActiveItem();if(p.loadAdvert!=null){p.loadAdvert()}if(p.loadAdvertMpu!=null){p.loadAdvertMpu()}}}if(typeof isTribReader!="undefined"){if(isTribReader){l.checkTopBar(e,l.articleCarousel)}}},articleKeyControl:function(){var c=this;var a=c.articleCarousel;var b=true;if(settings.reader.disableArticleCarousel!=null&&settings.reader.disableArticleCarousel=="true"){b=false}if(b){window.onkeyup=function(d){if($("#slider").val()==1){if(d.keyCode==39){a.jumpToPage(a.getActiveItem().config.pageNo+1)}else{if(d.keyCode==37){if(a.getActiveItem().config.pageNo>=1){a.jumpToPage(a.getActiveItem().config.pageNo-1)}}}}};window.onkeydown=function(d){if(d.keyCode===38){a.getActiveItem().content.element.dom.scrollTop-=20}if(d.keyCode===40){a.getActiveItem().content.element.dom.scrollTop+=20}}}else{window.onkeyup=function(d){};window.onkeydown=function(d){}}},articleLoadShare:function(b,a){var c=this;if(settings.menu.hideSharing!=null){b.topBarShare.hide()}else{if(settings.sharing!=null&&settings.sharing.allSharing!=null&&settings.sharing.allSharing.length>0){c.populateShare(b,a)}else{b.topBarShare.hide()}}},populateShare:function(b,f){var h=this;var a="http://"+window.location.hostname+"/infinity/article_share.aspx?guid="+f.guid;var d=f.description;if(d==null){d=f.headline;a=f.url}var g=settings.sharing.allSharing;for(var e=0;e<g.length;e++){var j=g[e];var c=settings.sharing[j];h.addShareItem(b,c.iconDark,c.link,a,d)}},updateArticleShare:function(d,g){var j=this;var b=d.topBarShare;var h=b.query("readermenushareitem");if(g!=null){var c="http://"+window.location.hostname+"/infinity/article_share.aspx?guid="+g.guid;var e=g.description;if(e==null){e=g.headline;c=g.url}for(var f=0;f<h.length;f++){var a=h[f];a.updateMessage(e);a.updateUrl(c)}}},addShareItem:function(b,g,c,a,d){var f="";if(c.indexOf("mailto:")!=-1){f="email"}else{if(c.indexOf("facebook")!=-1){f="Facebook"}else{if(c.indexOf("twitter")!=-1){f="Twitter"}else{if(c.indexOf("pinterest")!=-1){f="Pinterest"}else{if(c.indexOf("google")!=-1){f="Google+"}else{if(c.indexOf("linkedin")!=-1){f="LinkedIn"}}}}}}var j=this.getArticlecarousel();var h=j.getActiveItem();var e=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:g,link:c,url:a,message:d,type:f,isArticle:true,articleItem:h});b.topBarShare.add(e)},sharepopup:function(d){var h=this;var j=h.getArticlecarousel();var g=j.getActiveItem();var c=h.mediaStore.media.uniquearticle;var j=h.getArticlecarousel();var b=j.getPageNumber();var f=c[b];var a="http://"+window.location.hostname+"/infinity/article_share.aspx?guid="+f.guid;var e=f.description;shareMenu=Ext.create("InfinityMobile.view.phone.ReaderSharePopup",{url:a,message:e,articleguid:d._articleguid})},loadShareIcons:function(j){var f=this;var a=j.url;var c=j.message;var e=settings.sharing.allSharing;for(var d=0;d<e.length;d++){var g=e[d];var b=settings.sharing[g];var h=Ext.create("InfinityMobile.view.phone.ReaderSharePopupItem",{icon:b.icon,articleLink:b.link,color:b.color,url:a,message:c,articleguid:j.articleguid});j.shareBtnsContainer.add(h)}},articlePrint:function(){var d=this;var c=d.getArticlecarousel();if(c.getActiveItem()._page.description.indexOf("Puzzles")!=-1||c.getActiveItem()._page.description.indexOf("Comics")!=-1){d.puzzlePrint(c.getActiveItem())}else{var b='<html><head><link rel="stylesheet" type="text/css" href="resources/css/article.css" /><style type="text/css" media="print">@page {size: auto;/* auto is the initial value */margin: 10mm;  /* this affects the margin in the printer settings */}.articleContentHtml5{font-size:'+fontEm+"px !important}</style><script>setText = function () {}<\/script></head><body>{{ARTICLEBODY}}</body></html>";b=b.replace("{{ARTICLEBODY}}",c.getActiveItem().content.getHtml());var a=Ext.create("InfinityMobile.view.PrintPreview",{doc:b,imgCheck:true,delayImages:50});Ext.Viewport.add(a);a.show()}},previousArticle:function(){var a=this;if(a.articleCarousel==null){a.articleCarousel=a.getArticlecarousel()}a.articleCarousel.previous()},nextArticle:function(){var a=this;if(a.articleCarousel==null){a.articleCarousel=a.getArticlecarousel()}a.articleCarousel.next()},articleItemChange:function(o,h,j){var k=this;console.log("ITEM CHANGE",o.destroyed);if(!o.destroyed){var d=k.getReaderarticlepopover();var n=k.mediaStore.media.article;var c=k.mediaStore.media.uniquearticle;var f=o.getActiveItem().config.page;if(h.config.page!=null){var l=h.config.page.page;var m=h.config.page.description}var a="Next Article";if(k.latestArticlePage!=null){if(o.getPageNumber()<k.latestArticlePage){a="Previous Article"}}else{if(o.getPageNumber()<j._pageNo){a="Previous Article"}}if(settings.newsday!=null){if(settings.newsday.showInterstitialInArticlePopover=="true"){}}k.trackArticleChange(o.getPageNumber(),a,h);var e=Ext.getStore("SettingStore");if(loggedIn.toLowerCase()!="true"){if(e.data.items[0].raw.subscription.pageRestriction!=null){console.log(o.getActiveItem().config.page.page,e.data.items[0].raw.subscription.pageRestriction.pages);if(o.getActiveItem().config.page.page>parseInt(e.data.items[0].raw.subscription.pageRestriction.pages)){o.jumpToPage(o.getActiveItem()._pageNo-1)}}}if(d.topBarShare!=null){k.updateArticleShare(d,f)}var g="Article";if(language!=null&&language.article!=null){g=language.article}if(d.config.isLive==null){if(o.getActiveItem().config.isAdvert==null){if(o.getActiveItem().config.page!=null){d.articleText.setHtml(g+" "+(o.getActiveItem().config.page.articleNumber)+" / "+o.config.numberOfArticles)}else{d.articleText.setHtml(g+" "+((o.getPageNumber())+1)+" / "+c.length)}}else{d.articleText.setHtml("Advertisement")}}else{if(k.getReaderarticlepopover().config.articles==null){d.articleText.setHtml(g+" "+((o.getPageNumber())+1)+" / "+k.getApplication().getController("ArticleController").liveArticles.length)}else{d.articleText.setHtml(g+" "+((o.getPageNumber())+1)+" / "+k.getReaderarticlepopover().config.articles.length)}}var e=Ext.getStore("SettingStore");if(e.data.items[0].raw.tracking!=null){var b=e.data.items[0].raw.tracking.trackingType;if(b=="GA"){ga("set","page","/"+o.getActiveItem()._pageNo);ga("send",{hitType:"pageview",title:publicationName+" - "+editionName});if(o.getActiveItem().article!=null){ga("send","event","Swipe Article","click",o.getActiveItem().article.headline,o.getActiveItem().article.pageNumber)}}else{if(b=="DA"){trackDaPageView(m,"Digital Edition")}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight+stageString})}}}else{if(typeof isTribReader!="undefined"&&isTribReader==true){k.trackTribune(l,m)}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight});if(window.speechSynthesis!=undefined&&d.readAloudMode){k.stopReading()}if(settings.newsday!=null){if(h.isAdvert==null){if(h.loadAdvert!=null){h.loadAdvert()}if(h.loadAdvertMpu!=null){h.loadAdvertMpu()}}}else{if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.type=="dfp"){if(j.destoryAdvertMpuSlot!=null){j.destoryAdvertMpuSlot()}if(h.mode=="html"&&h.loadAdvertMpu!=null){h.loadAdvertMpu()}else{if(h.mode=="frame"&&h.loadIframeAdvertMpu!=null){h.loadIframeAdvertMpu()}}}}if(settings.newsday!=null){if(typeof h.getPageNo=="function"&&h.config.page.articleNumber==1){d.previousArticleButton.element.dom.style.visibility="hidden"}else{d.previousArticleButton.element.dom.style.visibility=""}if(typeof h.getPageNo=="function"&&h.config.page.articleNumber==k.articleStore.data.items[0].raw.articles.length){d.nextArticleButton.element.dom.style.visibility="hidden"}else{d.nextArticleButton.element.dom.style.visibility=""}}else{if(h.getPageNo!=null&&h.getPageNo()==0){d.previousArticleButton.element.dom.style.visibility="hidden"}else{d.previousArticleButton.element.dom.style.visibility=""}if(h.getPageNo!=null&&h.getPageNo()==n.length-1){d.nextArticleButton.element.dom.style.visibility="hidden"}else{d.nextArticleButton.element.dom.style.visibility=""}}if(typeof isTribReader!="undefined"){if(isTribReader){k.checkTopBar(d,k.articleCarousel);if(d.highlightMode){}}}if(Ext.os.is.Android||currentProfile=="desktop"){k.populatePrintContainerAndroid()}if(!!h&&!!h.runFlipp){h.runFlipp()}}},populatePrintContainerAndroid:function(){var c=this;var f=mainPanel.getActiveItem();if(currentProfile!="desktop"){if(f.config.viewType!=null&&f.config.viewType=="reader"){}else{var b=c.getArticlecarousel();var e=b.getActiveItem();var a=e.config.page;if(a.description.indexOf("Puzzles")!=-1||a.description.indexOf("Comics")!=-1){c.prepPuzzlePrintAndroid(e)}else{c.prepArticlePrintAndroid()}}}else{var d=c.getReaderarticlepopover();if(d!=null){var b=c.getArticlecarousel();var e=b.getActiveItem();var a=e.config.page;if(a!=null){if(a.description.indexOf("Puzzles")!=-1||a.description.indexOf("Comics")!=-1){c.prepPuzzlePrintAndroid(e)}else{c.prepArticlePrintAndroid()}}}}},prepPuzzlePrintAndroid:function(d){var a=this;if(d.printImage!=null){var c=d.printImage.dom.src;if(c!=null){c=c.replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com")}var b="<img class='puzzleImage' src='"+c+"' />";b="<img src='"+c+"' style='position:absolute;width:100%;height:100%;object-fit: contain;' />";a.writePrintHtml(b)}else{if(d.config.page!=null&&d.config.page.ID3_Title!=null&&d.config.page.ID3_Title!=""){a.writePrintHtml("<img src='"+d.config.page.ID3_Title+"' style='position:absolute;width:100%;height:100%;object-fit: contain;' />")}else{a.writePrintHtml("")}}},prepArticlePrintAndroid:function(){var e=this;var d=e.getArticlecarousel();var b="phoneArticle";if(currentProfile=="tablet"){b="tabletArticle"}if(d.getActiveItem().content!=null){var a="<div class='"+b+"'>"+d.getActiveItem().content.getHtml()+"</div>";var c="<style>.printContainer .articleContentHtml5, .articleContent{font-size:"+fontEm+"px !important}</style>"+a}else{var c=""}c=c.replace(/<div*[\sa-zA-Z=\"\'\-0-9:;]* class=[\"\']mpuAdvert[\"\']\s?><\/div>/g,"").replace(/<div\sid\=[\"\']ext-readerarticlepopoveritem-[0-9]*advert[\"\'][a-zA-z0-9\-\=\:\;\s\'\"]*><\/div>/g,"");c=c.replace(/<div\sid\=[\"\']flipp-div-ext-readerarticlepopoveritem-[0-9]*[\"\'][a-zA-z0-9\-\=\:\;\s\'\"]*>.*<\/div>/g,"");e.writePrintHtml(c)},fillPrintContainer:function(c){var c=this;var b=c.getArticlecarousel();var d=b.getActiveItem();var a=d.config.page;if(a!=null&&a.description!=null&&(a.description.indexOf("Puzzles")!=-1||a.description.indexOf("Comics")!=-1)){c.prepPuzzlePrintAndroid(d)}else{c.prepArticlePrintAndroid()}},writePrintHtml:function(c){var d=this;var b=$(".printContainer")[0];if(c!=null){c=c.replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com")}b.innerHTML=c;if(Ext.os.is.Android&&currentProfile=="phone"){var a=$(b).find(".articleContentHtml5")[0];if(a!=null){$(a).addClass("printAndroid")}}},trackArticleChange:function(d,j,e){var h=this;if(typeof trackReaderEvent!="undefined"&&!e.isAdvert){var l=h.mediaStore.media.article;thisArticle=l[d];var f=e.config.page.page;thisEditionPage=editionFlatplanData.pageGroups[f-1].pages[0];var a="";var c=h.mediaStore.media.allArticles;var k=l[thisArticle.file];if(k!=null){a=k.author}else{if(e.article!=null&&e.article.byline!=null&&e.article.byline.trim()!=""){a=e.article.byline}else{if(thisArticle.ID3_Artist!=null){a=thisArticle.ID3_Artist}}}if(settings.newsday!=null){a=e.article.byline;if(e.article.reporters!=null){for(var b in e.article.reporters){a+=", "+e.article.reporters[b].name}}}var g={pageNum:thisEditionPage.pageNum,pageName:thisEditionPage.pageName,description:thisArticle.description,author:a,type:j,articleGuid:thisArticle.guid,headline:e!=null&&e.article!=null?e.article.headline:thisArticle.description,section:h.getSectionName(thisEditionPage.pageNum),articleExternalId:"externalId" in thisArticle&&thisArticle.externalId!=null?thisArticle.externalId:""};trackReaderEvent("article",g)}},trackTribune:function(a,b){if(trackOmniture=="True"){trackArticle(a,b)}},readerArticleClose:function(d){var g=this;var e=g.getReader();var a=g.getReaderCarousel();var m=a.getItems().items;var l=a.getPageNumber()+1;var n=g.getArticlecarousel();var k=true;if(n!=null){if(n.getActiveItem().config.page!=null){var c=n.getActiveItem().config.page.page;c=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[c-1]!=null?flatPlanData.pdfPages[c-1].pages[0].pageNum:c}else{k=false}}try{if(localStorage.getItem("returnToPage"+publicationguid)!=null){if(localStorage.getItem("returnToPage"+publicationguid)=="false"){k=false}}}catch(f){}d.highlightMode=false;if(k){if(Ext.os.is.Desktop){var j=l;var h=j;if(a._mode=="double"){var h=g.returnLandscapePageNo(l)}if(j!=c&&h!=c){a.jumpToPage(c-1)}Ext.Viewport.remove(d);if(a._mode=="double"&&a._zoomMode=="fit"){g.getApplication().getController("PageTurnController").setupKeys()}else{g.keyControls()}}else{if(Ext.os.is.Phone){if(g.getArticlereader()==null){if(d.isLive==null){var j=l;var h=j;if(g.returnOrientation()=="landscape"&&a._mode=="double"){var h=g.returnLandscapePageNo(l)}if(l!=c&&h!=c){a.jumpToPage(c-1)}}}mainPanel.remove(d,true);if(articleMode=="dynamic"){mainPanel.setActiveItem(g.getArticlereader())}var b=g.getArticlescontainer();if(b!=null){b.element.dom.style.visibility="visible"}}else{var b=g.getArticlescontainer();var j=l;var h=j;if(d.isLive==null){if(g.returnOrientation()=="landscape"&&a._mode=="double"){var h=g.returnLandscapePageNo(l)}if(b!=null){b.element.dom.style.visibility="visible"}if(articleMode!="dynamic"){mainPanel.setActiveItem(e);mainPanel.remove(d,true);if(l!=c&&h!=c){a.jumpToPage(c-1)}}else{if(g.getArticlereader()==null){if(l!=c&&h!=c){a.jumpToPage(c-1)}}}}mainPanel.remove(d,true);mainPanel.setActiveItem(g.getArticlereader())}}}else{d.destroy()}if((typeof isTribReader!="undefined"&&isTribReader)&&window.speechSynthesis!=null){g.stopReading()}a.getActiveItem().fireEvent("setupPrintContainer",a.getActiveItem())},onArticleOpen:function(){var b=this;if(b.getLayouttoolbar()!=null){var a=b.getLayouttoolbar().ttsToggle}else{var a=null}b.onArticleHide(a)},onArticleHide:function(a){var b=this;if(window.speechSynthesis!=undefined&&(typeof isTribReader!=undefined&&isTribReader)){b.stopReading()}},readerArticleHide:function(b){var a=this;if(Ext.os.is.Desktop){if(articleMode=="dynamic"){a.getApplication().getController("ArticleController").readerarticlehide()}else{a.keyControls()}}else{}},returnLandscapePageNo:function(a){if(a%2==0){return a+1}else{return a-1}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},puzzleArchive:function(f){var c=this;console.log("puzzleArchive");var c=this;var b=c.getArticlecarousel();var e=b.getActiveItem();if(currentProfile=="desktop"){var d="InfinityMobile.view.desktop.ReaderPuzzleArchive"}else{var d="InfinityMobile.view.ReaderPuzzleArchive"}var a=Ext.create(d,{puzzleArchiveParent:e});e.content.add(a);e.content.setActiveItem(a);e.bottomBar.setHeight(0)},archiveInitialized:function(a){var e=this;var b=a.config.puzzleArchiveParent.getPage().guid;var d=Ext.getStore("PuzzleArchiveStore");d.puzzleArchive=a,d.on({load:"puzzleArchiveStoreLoad",scope:this});d.setProxy({url:"../puzzle_archive.aspx?guid="+b+"&beginning=0&end=9"});d.load();var c=e.getReaderarticlepopover();c.setMasked({xtype:"loadmask",message:"Loading"})},puzzleArchiveStoreLoad:function(f){var g=this;var h=f.puzzleArchive;var d=f.data.items[0].raw;if(d.archive!=null){h.archiveLength=d.archiveLength;for(var e=h.location;e<h.location+9;e++){if(e<d.archive.length){var l=d.archive[e];var j=Ext.create("InfinityMobile.view.ReaderPuzzleArchiveItem",{image:l.image,text:l.name,mediaobject:l.guid,puzzleArchive:h})}h.container.add(j)}var a=h.archiveLength/10;if(a>=9){for(var k=1;k<10;k++){var c=Ext.create("InfinityMobile.view.ReaderArchivePageButton",{pageNo:k,puzzleArchive:h});h.pagesControl.add(c)}}else{for(var k=1;k<a+1;k++){var c=Ext.create("InfinityMobile.view.ReaderArchivePageButton",{pageNo:k,puzzleArchive:h});h.pagesControl.add(c)}}}h.page=1;h.pages=a;var b=g.getReaderarticlepopover();b.setMasked(false)},loadPuzzleItem:function(e){var d=this;var b=e.config.puzzleArchive;var a=b.config.puzzleArchiveParent;var c=a.content;a.articleguid=e.config.mediaobject;a.getContent();a.content.remove(b);a.content.setActiveItem[c];a.element.down(".x-innerhtml").dom.style.height="";a.bottomBar.show();a.bottomBar.setHeight(60)},closeArchive:function(b){var c=this;var a=c.getArticlecarousel();var d=a.getActiveItem();d.content.remove(b);d.content.setActiveItem[0];d.bottomBar.setHeight(60)},puzzlePrint:function(f){var e=this;if(Ext.os.is.Desktop){var b=f.element.down("img").dom.src;var c="print.aspx?edid="+editionguid+"&type=puzzle&url="+encodeURIComponent(b);window.open(c)}else{var b=f.element.down("img").dom.src;var d="<img src='"+b+"' style='max-width:21cm; max-height:26.7cm' />";var a=Ext.create("InfinityMobile.view.PrintPreview",{doc:d});Ext.Viewport.add(a);a.show()}},puzzleShare:function(b){var a=this;b.shareText.setHidden(true);setTimeout(function(){b.shareFrame.setHidden(false)},100)},puzzleInteractive:function(c){var a=this;console.log("puzzleInteractive");var b="http://games.courant.com/gamedetails/daily-crossword/";if(settings.menu.gamesLink!=null){b=settings.menu.gamesLink}window.open(b)},bottomToolbar:function(){var g=this;var f=g.getImagegallery().child("#bottomtoolbar");if(f!=null){g.getImagegallery().remove(f)}else{var h=Ext.create("InfinityMobile.view.ReaderToolbarBottom",{itemId:"bottomtoolbar",bottom:0,width:"100%",height:190});var g=this;var a=g.gallery;for(var d=0;d<a.images.length;d++){var e=a.images[d];var c=Ext.create("Ext.Panel",{id:"image"+(d+1),html:"<img id='imagepage"+(d+1)+"' class='readerPage' style='height:160px; padding:5px; float:left;'  />",height:"100%",width:"0px"});var b=c.element.down("img").dom;b.onclick=function(){g.clickPage(this)};b.addEventListener("touchstart",function(){g.clickPage(this)});b.src=a.images[d].url;h.scrollerContainer.add(c);c.show()}g.getImagegallery().add(h);h.show()}},clickPage:function(d){var b=this;var a=parseInt(d.id.replace("imagepage",""))-1;var c=b.getImagecarousel();c.jumpToPage(a)},addNote:function(){var b=this;var c=b.getReaderCarousel();var d=c.getActiveItem();var a=Ext.create("InfinityMobile.view.StickyNote",{pageNo:d.config.pageNo+1});d.mediaDiv.appendChild(a.element.dom)},lightbox:function(c,e,a){var b=this;var d=Ext.create("InfinityMobile.view.ReaderLightbox",{mediaObject:e,mediaType:a});Ext.Viewport.add(d);d.show()},createClipping:function(){var d=this;var g;var c=this;var e=d.getReaderCarousel();var f=e.getActiveItem();var b=d.getReader();var a=d.getReaderpageviewer();if(d.naturalW==null){d.naturalW=e.items.items[0].imagetoload.naturalWidth;d.naturalH=e.items.items[0].imagetoload.naturalHeight}if(d.clipper==null){var h=Ext.create("Ext.Container",{height:"1px",width:"100px",fullscreen:true,draggable:{direction:"both",constraint:null},style:"zIndex:10;",initialize:function(){var k=this;k.x=0;k.y=0;k.setHtml('<div id="clipper" style="box-shadow:10px 10px 10px #000000;left:0px;top:0px;width:30px;resize:both;overflow:auto;height:30px;border:2px solid red;"></div><div><input style="background-color:#1e1e1e;color:white;border-color:#1e1e1e;font-size:12px;padding-right:5px;padding-left:5px;" type="button" onclick="parent.save()" value="Clip"></input><input style="background-color:#1e1e1e;color:white;border-color:#1e1e1e;font-size:12px;padding-left:5px;padding-right:5px;" type="button" onclick="parent.cancel()" value="Cancel"></input></div>');save=function(){var q=document.getElementById("clipper");var l=k.x;var r=k.y;var m=0;var o=c.naturalW/f.imagetoload.clientWidth;var p=c.naturalH/f.imagetoload.clientHeight;if(l!=0&&r!=0){if(document.getElementById("slider").value==1){if(f._mode=="double"){l=k.x-((b.element.dom.clientWidth/2)-f.imagetoload.clientWidth);m=f._pageNo;if(k.x>(b.element.dom.clientWidth/2)){l-=f.imagetoload.clientWidth;m=f._pageNo+1}l=(l*o);r=k.y-40;r=r-(((b.element.dom.clientHeight-40)-f.imagetoload.clientHeight)/2);r=r*p}else{l=k.x-(((b.element.dom.clientWidth)-f.imagetoload.clientWidth)/2);l=l*o;m=f._pageNo+1;r=k.y-40;r=r-(((b.element.dom.clientHeight-40)-f.imagetoload.clientHeight)/2);r=r*p}var n="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+m+"&x="+Math.floor(l)+"&y="+Math.floor(r)+"&h="+Math.floor(q.offsetHeight*(c.naturalH/f.imagetoload.clientHeight))+"&w="+Math.floor(q.offsetWidth*(c.naturalW/f.imagetoload.clientWidth))}else{m=f._pageNo;if(k.x>=f.imagetoload.clientWidth){l-=f.imagetoload.clientWidth;m=f._pageNo+1}var n="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+m+"&x="+Math.floor(l)+"&y="+Math.floor(r)+"&h="+Math.floor(q.offsetHeight*(c.naturalH/f.imagetoload.clientHeight)/document.getElementById("slider").value)+"&w="+Math.floor(q.offsetWidth*(c.naturalW/f.imagetoload.clientWidth)/document.getElementById("slider").value)}}var n="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+m+"&x="+Math.floor(l)+"&y="+Math.floor(r)+"&h="+Math.floor(q.offsetHeight*(c.naturalH/f.imagetoload.clientHeight))+"&w="+Math.floor(q.offsetWidth*(c.naturalW/f.imagetoload.clientWidth));c.clippings[c.clippings.length]=n;c.clippingMenu();c.clipper=null;k.destroy()};cancel=function(){c.clipper=null;k.destroy()};var j={x:0,y:0};k.element.on("drag",function(m,l){m.stopPropagation()});k.element.on("dragstart",function(l){l.stopPropagation();j.x=l.clientX;j.y=l.clientY});k.element.on("dragend",function(p){p.stopPropagation();if(document.getElementById("slider").value==1){if(f._mode=="double"){k.x=p.pageX-p.event.offsetX;k.y=p.pageY-p.event.offsetY}else{k.x=p.pageX-p.event.offsetX;k.y=p.pageY-p.event.offsetY}}else{if(f._mode=="double"){k.x=p.pageX-p.event.offsetX;k.y=p.pageY-p.event.offsetY;var o=k.x;var n=k.y;var m=o+f.scroller.position.x;var l=n+f.scroller.position.y;k.x=((m)/(document.getElementById("slider").value));k.y=((l)/(document.getElementById("slider").value))}else{k.x=p.pageX-p.event.offsetX;k.y=p.pageY-p.event.offsetY}}})}});f.scrollerDiv.appendChild(h.element.dom);h.show();d.clipper=h}},clippingMenu:function(){var a=this;var b=Ext.create("InfinityMobile.view.ClippingMenu",{images:a.clippings})},DeleteClippings:function(d,e){var c=this;for(var b=0;b<e.length;b++){for(var a=0;a<c.clippings.length;a++){if(e[b]==c.clippings[a]){c.clippings.splice(a,1);break}}}d.updateImages(c.clippings)},galleryClick:function(c,b){var d=this;var e="InfinityMobile.view.ReaderOGallery";switch(currentProfile){case"desktop":e="InfinityMobile.view.desktop.ReaderOGallery";break;case"tablet":case"largetablet":e="InfinityMobile.view.tablet.ReaderOGallery";break}var a=Ext.create(e,{url:b,obj:c});Ext.Viewport.add(a);a.show();if(d.getArticlescontainer()!=null){d.getArticlescontainer().hideMe()}},galleryClickFromArticle:function(c,a,e){var d=this;if(Ext.os.is.Desktop){var b=Ext.create("InfinityMobile.view.desktop.ReaderOGallery",{images:a,article:e,obj:c})}else{var f="InfinityMobile.view.ReaderOGallery";switch(currentProfile){case"tablet":case"largetablet":f="InfinityMobile.view.tablet.ReaderOGallery";break}var b=Ext.create(f,{images:a,article:e,obj:c})}Ext.Viewport.add(b);b.show();if(d.getArticlescontainer()!=null){d.getArticlescontainer().hideMe()}},ovideoclicked:function(c,b){var d=this;var a=Ext.create("InfinityMobile.view.ReaderOVideo",{url:b,obj:c});Ext.Viewport.add(a);a.show();if(d.getArticlescontainer()!=null){d.getArticlescontainer().hideMe()}},playAudio:function(b){var a=this;if(typeof a.audioFile!==undefined){}else{a.audioFile.audioFile.pause()}a.audioFile=b;a.audioFile.audioFile.play()},pauseAudio:function(b){var a=this;b.audioFile.pause()},stopAudio:function(){var a=this;if(a.audioFile!=null){a.audioFile.audioFile.pause();a.audioFile.audioFile.currentTime=0}},searchHighlightLoaded:function(j){var h=this;var b=j.leftPageNumber;var g=j.leftPageGuid;var c=j.rightPageNumber;var f=j.rightPageGuid;var d=j.term;var l=h.getReaderCarousel().getActiveItem();var e=document.getElementsByClassName("searchHighlight");while(e.length>0){e[0].parentNode.removeChild(e[0])}var k=j.data.items[0].raw;if(k.highlight!=null&&k.highlight.results!=null){var a=k.highlight.results.result;if(g!=""){h.searchHighlightPage("left",b,l,a)}if(f!=""){h.searchHighlightPage("right",c,l,a)}}},searchHighlightPage:function(b,h,k,a){var g=this;var f;if(currentProfile=="desktop"){var j=k.getImageContainer(flatPlanData.pageMapper[h+1-pageOffset]);if(j!=null){f=j.mediaDiv}else{f=null}}else{f=k.returnMediaContainer(h+1)}if(f!=null){if(a!=null&&a.length!=null){for(var d=0;d<a.length;d++){var e=a[d];if(e["@side"]==b){e.x=e["@xpos"];e.y=""+(parseFloat(e["@ypos"]));e.width=e["@width"];e.height=e["@height"];e.backgroundColor="ffff00";e.depthIndex=1;e.backgroundAlpha=50;var c=Ext.create("InfinityMobile.view.ReaderMediaObject",{mediaObject:e,pageNumber:h,cls:"searchHighlight"});f.appendChild(c.element.dom)}}}else{var e=a;if(e!=null&&e["@side"]==b){e.x=e["@xpos"];e.y=""+(parseFloat(e["@ypos"]));e.width=e["@width"];e.height=e["@height"];e.backgroundColor="ffff00";e.depthIndex=1;e.backgroundAlpha=50;var c=Ext.create("InfinityMobile.view.ReaderMediaObject",{mediaObject:e,pageNumber:h,cls:"searchHighlight"});f.appendChild(c.element.dom)}}}},closeOGallery:function(a,b){var c=this;a.destroy();if(c.getArticlescontainer()!=null){c.getArticlescontainer().element.dom.style.visibility="visible"}},closeOVideo:function(b){var a=this;b.destroy();if(a.getArticlescontainer()!=null){a.getArticlescontainer().element.dom.style.visibility="visible"}},readerArticleCloseAndReset:function(d,a){var c=this;c.readerArticleClose(d);var b=c.returnOrientation();if(b!=c.startArticleOrientation){c.getReaderCarousel().onResize(null)}},emailArticleShare:function(d,f){var e=this;var b=e.getArticlecarousel();var a=e.mediaStore.media.article;var c=b._pageNumber;window.location.href=d+"&body="+f+a[c].guid},navigateGallery:function(c,a){var b=this;c.setActiveItem(a)},setupArticleTooltip:function(d){var a=this;var b=a.getReaderCarousel();if(b!=null){var c=b.getActiveItem();if(c!=null){c.tooltip.setHtml('<div style="position:absolute;" class="articleTooltip">'+d+"</div>");c.tooltip.show()}}},hideArticleTooltip:function(a){var b=this;var c=b.getReaderCarousel();if(c!=null){var d=c.getActiveItem();if(d!=null&&d.tooltip!=null){d.tooltip.hide()}}},updateArticleTooltipPosition:function(j){var k=this;var l=k.getReaderCarousel();var g=0;if((typeof isTribReader!="undefined"&&isTribReader==true)||settings.reader.enableReaderPadding=="true"){g=150}if(settings.reader.wrapAd!=null){g=180}var d=0;if(settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"){var f=Ext.Viewport.query("readerbannerad");if(f.length>0){d=f[0].getHeight()}}if(l!=null){var h=l.getActiveItem();if(h!=null){if(j.pageX<($(document).width()/2)){var b=(j.pageX+h.scroller.position.x+20-g);var a=(j.clientY+h.scroller.position.y-40)-d;var c="translate3d("+b+"px, "+a+"px, 0) scale3d(1,1,1)";h.tooltip.element.dom.style.webkitTransform=c;h.tooltip.element.dom.style.MozTransform=c;h.tooltip.element.dom.style.msTransform=c;h.tooltip.element.dom.style.transform=c}else{var b=(j.clientX+h.scroller.position.x-(h.tooltip.element.dom.scrollWidth+15)-g);var a=(j.clientY+h.scroller.position.y-40)-d;var c="translate3d("+b+"px, "+a+"px, 0) scale3d(1,1,1)";h.tooltip.element.dom.style.webkitTransform=c;h.tooltip.element.dom.style.MozTransform=c;h.tooltip.element.dom.style.msTransform=c;h.tooltip.element.dom.style.transform=c}}}},setArticlePopoverHeight:function(){var a=this;var b=a.getArticlecarousel();if(b!=null){b.getActiveItem().setContentHeight()}},checkActivePage:function(d){var b=this;var c=b.getReaderCarousel();if(c!=null){if(c.getActiveItem().getPageNo()==d.page.getPageNo()){if(d.mediaObject.autoPlay=="true"){d.playSound()}}else{if(c._mode=="double"){var a=c.getActiveItem().getPageNo()+1+((c.getActiveItem().getPageNo())%2);if(a==d.mediaObject.pageNo){if(d.mediaObject.autoPlay=="true"){d.playSound()}}}}}},checkActivePageVideo:function(b){var c=this;var d=c.getReaderCarousel();if(d!=null){if(d.getActiveItem().getPageNo()+1==b.mediaObject.page){if(b.mediaObject.autoPlay=="true"){if(b.videoType=="youtube"){b.playVideo()}else{b.video.play()}}}else{if(d._mode=="double"){var a=d.getActiveItem().getPageNo()+1+((d.getActiveItem().getPageNo())%2);if(a==b.mediaObject.page){if(b.mediaObject.autoPlay=="true"){if(b.videoType=="youtube"){b.playVideo()}else{b.video.play()}}}}}}},archivePageChange:function(b,a){var e=this;b.location.location=(a*10);var c=b.config.puzzleArchiveParent.getPage().guid;$.ajax({url:"../puzzle_archive.aspx?guid="+c+"&beginning="+((a-1)*10)+"&end="+(((a-1)*10)+9),success:function(g){e.puzzleArchiveStoreLoadPageChange(g,b);for(var f in b.pagesControl.getItems().items){b.pagesControl.getItems().items[f].unselected()}b.pagesControl.getItems().items[a-1].selected();b.page=a}});var d=e.getReaderarticlepopover();d.setMasked({xtype:"loadmask",message:"Loading"})},puzzleArchiveStoreLoadPageChange:function(f,a){var g=this;var e=f;if(e.archive!=null){a.container.removeAll();for(var b=a.location;b<a.location+9;b++){if(b<e.archive.length){var d=e.archive[b];var h=Ext.create("InfinityMobile.view.ReaderPuzzleArchiveItem",{image:d.image,text:d.name,mediaobject:d.guid,puzzleArchive:a})}a.container.add(h)}}var c=g.getReaderarticlepopover();c.setMasked(false)},archiveNextPage:function(a){var b=this;if(a.page!=null){if(a.page<a.pages){b.archivePageChange(a,a.page+1)}}},archivePreviousPage:function(a){var b=this;if(a.page!=null){if(a.page>1){b.archivePageChange(a,a.page-1)}}},triggerMedia:function(b){var d=this;for(var c in d.mediaObjects){if(b==d.mediaObjects[c].mediaObject.animID){var a=d.mediaObjects[c];if(a.mediaObject.appear=="TRIGGER"){a.element.dom.style.visibility="";a.appearAnim();switch(a.mediaType){case"video":if(Ext.os.is.Desktop){if(a.mediaObject.autoPlay=="true"){a.playVideo()}}break}}else{switch(a.mediaType){case"video":a.playVideo();break}}break}}},playArticleTTS:function(o,j){var u=this;o.status="PLAYING";if(j){if(j=="noicon"){}else{if(j=="na"){o.addCls("playing")}else{j.addCls("playing")}}}if(currentProfile=="desktop"){var b=u.getLayouttoolbar();if(b!=null){b.ttsToggle.addCls("playing");b.ttsToggle.status="PLAYING"}var m=u.getReaderMenu();if(m!=null){m.menuLayout.getComponent("editionOptionsSection").getComponent("menuTTS").ttsicon.addCls("playing")}ttsFlag.status="PLAYING"}if(window.speechSynthesis.speaking==true){window.speechSynthesis.cancel()}var l="";if(o.xtype=="layouttoolbaricon"||o==ttsFlag){var a=u.getReaderCarousel();var c="?";var e=0;if(settings.leftSideAd!=null){e=1}if(u.returnOrientation()=="portrait"||a.getMode()!="double"){var h=a.getActiveItem();var q=h.getPageNo();c+="dpsmode=single";if(typeof editionFlatplanData!="undefined"&&editionFlatplanData!=null){var d=editionFlatplanData.pageGroups[q+e];var n=u.retrievePageGuid(d.pages[0].image);c+="&pageguid="+encodeURIComponent(n);$.ajax({url:"../get_page_text.aspx"+c,async:false,success:function(v){u.speak(v,o,j)}})}}else{var h=a.getActiveItem();var q=h.getPageNo();c+="dpsmode=double";if(typeof editionFlatplanData!="undefined"&&editionFlatplanData!=null){var d=editionFlatplanData.pageGroups[q+e];var n=d.pages[0].guid;if(q%2==1){c+="&leftguid="+encodeURIComponent(n);var s=editionFlatplanData.pageGroups[q+1+e];if(s!=null){var f=u.retrievePageGuid(s.pages[0].image);c+="&rightguid="+encodeURIComponent(f)}}else{c+="&rightguid="+encodeURIComponent(n);var k=editionFlatplanData.pageGroups[q-1+e];if(k!=null){var r=u.retrievePageGuid(k.pages[0].image);c+="&leftguid="+encodeURIComponent(r)}}$.ajax({url:"../get_page_text.aspx"+c,async:true,success:function(v){u.speak(v,o,j)}})}}}else{if(u.getArticlecarousel().getActiveItem().articleText){l=u.getArticlecarousel().getActiveItem().articleText;u.speak(l,o,j)}else{if(u.getArticlecarousel().getActiveItem().article){var g=u.getCurrentArticle();var t=g.body;var p=document.createElement("textarea");p.innerHTML=t;var t=p.value;l=g.headline+". "+g.subHeadline+". "+g.byline+". "+t;u.speak(l,o,j);delete p}else{if(u.getArticlecarousel().getActiveItem().initialConfig.page.headline!=null){var g=u.getArticlecarousel().getActiveItem().initialConfig.page;l=g.headline+". "+g.subHeadline+". "+g.byline+". "+g.body;u.speak(l,o,j)}else{u.stopArticleTTS(o,j)}}}}},retrievePageGuid:function(a){return a.split("/")[5]},resumeArticleTTS:function(b,a){var e=this;b.status="PLAYING";if(a){if(a=="noicon"){}else{if(a=="na"){b.addCls("playing")}else{a.addCls("playing")}}}if(currentProfile=="desktop"){var d=e.getLayouttoolbar();if(d!=null){d.ttsToggle.addCls("playing");d.ttsToggle.status="PLAYING"}var c=e.getReaderMenu();if(c!=null){c.menuLayout.getComponent("editionOptionsSection").getComponent("menuTTS").ttsicon.addCls("playing")}ttsFlag.status="PLAYING"}if(window.speechSynthesis.paused===true){window.speechSynthesis.resume()}else{e.playArticleTTS(b)}},pauseArticleTTS:function(b,a){var e=this;b.status="PAUSED";if(a){if(a=="noicon"){}else{if(a=="na"){b.removeCls("playing")}else{a.removeCls("playing")}}}if(currentProfile=="desktop"){var d=e.getLayouttoolbar();if(d!=null){d.ttsToggle.removeCls("playing");d.ttsToggle.status="PAUSED"}var c=e.getReaderMenu();if(c!=null){c.menuLayout.getComponent("editionOptionsSection").getComponent("menuTTS").ttsicon.removeCls("playing")}ttsFlag.status="PAUSED"}window.speechSynthesis.pause()},stopArticleTTS:function(b,a){var e=this;b.status="STOPPED";if(a){if(a=="noicon"){}else{if(a=="na"){if(b.removeCls!=null){b.removeCls("playing")}}else{a.removeCls("playing")}}}if(currentProfile=="desktop"){var d=e.getLayouttoolbar();if(d!=null){d.ttsToggle.removeCls("playing");d.ttsToggle.status="STOPPED"}var c=e.getReaderMenu();if(c!=null){c.menuLayout.getComponent("editionOptionsSection").getComponent("menuTTS").ttsicon.removeCls("playing")}ttsFlag.status="STOPPED"}window.speechSynthesis.cancel()},getCurrentArticle:function(){var a=this;if(a.articleCarousel==null){a.articleCarousel=a.getArticlecarousel()}return a.articleCarousel.getActiveItem().article},callbackArticleTTS:function(a){var b=this;if(a){alert("An error has occured: "+a)}},getPageText:function(c,b,a){var e=this;var d=$.ajax("/preview/read_aloud.aspx?pageguid="+c);d.done(function(f){e.speak(f.content,b,a)})},speak:function(f,b,a){var e=this;f=f.split("'").join("\u2018").replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/\s\s+/g," ").trim();if(!f.startsWith("<<Error>>")){if(f.length>200&&Ext.os.is.Android){sentences=f.split(". ");for(i=0;i<sentences.length;i++){sentence=sentences[i];audio=new SpeechSynthesisUtterance(sentence);if(i==sentences.length-1){audio.onend=function(){b.status="FINISHED";if(a){if(a=="noicon"){}else{if(a=="na"){b.removeCls("playing")}else{a.removeCls("playing")}}}}}window.speechSynthesis.speak(audio)}}else{var d=new SpeechSynthesisUtterance();d.text=f;d.voice=window.speechSynthesis.getVoices()[0];if(typeof isTribReader!="undefined"&&isTribReader){d.lang="en-US"}else{if(settings.tts!=null&&settings.tts.language!=null){d.lang=settings.tts.languaage;window.speechSynthesis.onvoiceschanged=function(){d.voice=jQuery.grep(window.speechSynthesis.getVoices(),function(g){return g.lang==e.tts.lang})[0]}}else{d.lang="en-UK"}}if(settings.tts!=null&&settings.tts.rate!=null){d.rate=parseFloat(settings.tts.rate)}else{d.rate=1}if(settings.tts!=null&&settings.tts.pitch!=null){d.pitch=parseFloat(settings.tts.pitch)}d.onend=function(){if(window.speechSynthesis.speaking==false){if(b.status!="STOPPED"){b.status="FINISHED"}if(a){if(a=="noicon"){}else{if(a=="na"){b.removeCls("playing")}else{a.removeCls("playing")}}}}};d.onerror=function(g){};if(Ext.os.is.iOS&&settings.tts.language!=null){var c=window.speechSynthesis.getVoices();if(c.length==0){c=e.iOsVoices}d.lang=settings.tts.language;d.voice=jQuery.grep(c,function(g){return g.lang==d.lang})[0]}readAloud.utterance=d;console.log(d);window.speechSynthesis.speak(d)}}},scaleInterstitial:function(d,g,a){var f=this;var e=f.getReaderarticlepopover();if(e!=null){var j=e.content;if(j!=null){var b=a.element.dom.clientHeight/d.clientHeight;var c=a.element.dom.clientWidth/d.clientWidth;var h=Math.min(b,c);$(g).css("-ms-transform-origin","50% 0px");$(g).css("-webkit-transform-origin","50% 0px");$(g).css("-moz-transform-origin","50% 0px");$(g).css("transform-origin","50% 0px");$(g).css("-ms-transform","scale3d("+h+", "+h+", 1)");$(g).css("-webkit-transform","scale3d("+h+", "+h+", 1)");$(g).css("-moz-transform","scale3d("+h+", "+h+", 1)");$(g).css("transform","scale3d("+h+", "+h+", 1)")}}},scaleInterstitialOnDevice:function(c,k){var f=this;var e=f.getReaderarticlepopover();if(e!=null){var l=e.content;if(l!=null){if(Ext.os.is.Tablet){if(f.returnOrientation()=="landscape"){var h=768;var b=1024}else{var b=768;var h=1024}}else{if(Ext.os.is.Phone){if(f.returnOrientation()=="landscape"){var h=320;var b=480}else{var b=320;var h=480}}}if(f.returnOrientation()=="portrait"){var d=$(l.element.dom).height()/h;var a=d*b;var j=a/b;if(a>$(document).width()){a=$(document).width();j=a/b;var g=j*h;d=g/h}}else{var j=$(l.element.dom).width()/b;var g=j*h;var d=g/h;if(g>$(document).height()-80){g=$(document).height()-80;d=g/h;var a=d*b;j=a/b}}$(k).css("height",h+"px");$(k).css("width",b+"px");$(k).css("-ms-transform-origin","50% 0px");$(k).css("-webkit-transform-origin","50% 0px");$(k).css("-moz-transform-origin","50% 0px");$(k).css("transform-origin","50% 0px");$(k).css("-ms-transform","scale3d("+j+", "+d+", 1)");$(k).css("-webkit-transform","scale3d("+j+", "+d+", 1)");$(k).css("-moz-transform","scale3d("+j+", "+d+", 1)");$(k).css("transform","scale3d("+j+", "+d+", 1)")}}},galleryVisible:function(){var a=this;if(a.getLivenewsticker()!=null){a.getLivenewsticker().hide()}},galleryInvisible:function(){var a=this;if(a.getLivenewsticker()!=null){a.getLivenewsticker().show()}},checkAudioOnToggle:function(b){var a=this;if(a.audioFile!=null){b.leftSideImageLoad(false);b.rightSideImageLoad(false)}else{b.leftSideImageLoad();b.rightSideImageLoad()}},copyToClipboard:function(){var c=this;var b="";var d;var a=c.getReaderarticlepopover();if(c.getArticlecarousel().getActiveItem().articleText){b=c.getArticlecarousel().getActiveItem().articleText}else{if(c.getArticlecarousel().getActiveItem().article){var e=c.getCurrentArticle();b=e.headline+String.fromCharCode(13)+e.subHeadline+String.fromCharCode(13)+e.byline+String.fromCharCode(13)+e.body}else{if(c.getArticlecarousel().getActiveItem().initialConfig.page.headline!=null){var e=c.getArticlecarousel().getActiveItem().initialConfig.page;b=e.headline+String.fromCharCode(13)+e.subHeadline+String.fromCharCode(13)+e.byline+String.fromCharCode(13)+e.body}else{}}}d=new Clipboard(".copyButton",{text:function(){if(b.search("contentHead")!=-1){var h=b.split(/<[^>]*contentHead[^>]*>/g);var f=h[1].slice(0,h[1].indexOf("</div>")).replace(/<[^>]*>/g," ");var g=h[1].slice(h[1].indexOf("</div>"));b=h[0]+f+g+String.fromCharCode(13)}if(b.search("contentDeck")!=-1){var h=b.split(/<[^>]*contentDeck[^>]*>/g);var f=h[1].slice(0,h[1].indexOf("</div>")).replace(/<[^>]*>/g," ");var g=h[1].slice(h[1].indexOf("</div>"));b=h[0]+f+g+String.fromCharCode(13)}if(b.search("contentByline")!=-1){var h=b.split(/<[^>]*contentByline[^>]*>/g);var f=h[1].slice(0,h[1].indexOf("</div>")).replace(/<[^>]*>/g," ");var g=h[1].slice(h[1].indexOf("</div>"));b=h[0]+f+g+String.fromCharCode(13)}return b.replace(/<\/?p[^>]*>/g,String.fromCharCode(13)).replace(/<br[^>]*>/g,String.fromCharCode(13)).replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&glt;/g,"<").replace(/  +/g," ").replace(/\s\s+/g,String.fromCharCode(13)).trim().replace("PREVIOUS IMAGE Image NEXT IMAGE","")}});d.on("success",function(j){var f="Article copied to clipboard.";if(language!=null&&language.articlePopover!=null&&language.articlePopover.articleTextCopied!=null){f=language.articlePopover.articleTextCopied}var g=new InfinityMobile.view.Overlay({html:"<div class='tick-icon'></div> "+f,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000},cls:"copy-alert font15"});g.setZIndex(2147483641);var h=g.getModal();if(h!=null){h.setZIndex(2147483640)}Ext.Viewport.add(g);setTimeout(function(){g.addCls("hideAlert");$(g.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert")},800);setTimeout(function(){g.destroy()},1800);j.clearSelection();d.destroy()});d.on("error",function(h){if(currentProfile=="desktop"){var f=new InfinityMobile.view.Overlay({html:"Press CTRL + C (on Windows) or CMD + C (on Mac) to copy.",style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000},cls:"copy-alert font15"});a.add(f)}else{var g="Article failed to copy.";if(language!=null&&language.articlePopover!=null&&language.articlePopover.articleCopyFailed!=null){g=language.articlePopover.articleCopyFailed}var f=new InfinityMobile.view.Overlay({html:"<div class='cross-icon'></div> "+g,style:{backgroundColor:"#fff",color:"#000",zIndex:2.111111111111111e+24},cls:"copy-alert font15"});a.add(f);setTimeout(function(){f.addCls("hideAlert");$(f.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert")},800);setTimeout(function(){f.destroy()},1800)}})},highlightInstructions:function(){var e=this;var a="Close";if(language!=null&&language.close!=null){a=language.close}var f="Highlighted Text Mode";if(language!=null&&language.articlePopover!=null&&language.articlePopover.highlightedTextMode!=null){f=language.articlePopover.highlightedTextMode}var b="Hold down on the text to highlight copy";if(language!=null&&language.articlePopover!=null&&language.articlePopover.highlightedTextModeMessage!=null){b=language.articlePopover.highlightedTextModeMessage}var d=new InfinityMobile.view.Overlay({html:'<div class="highlightClose pointerCursor" style="color:rgb(69, 145, 184);position:absolute;top:0px;right:0px;font-size:11px;display:inline-flex;"><div style="padding:3px">'+a+'</div><img  src="../assets/article view/article-close-btn.png" style="width:15px;height:15px;margin:5px;"></div><span style="font-weight:bold;">'+f+"</span><br />"+b,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000,textAlign:"center",lineHeight:1.8},padding:15,zIndex:2147483641,cls:"copy-alert font15"});var c=d.getModal();if(c!=null){c.setZIndex(2147483640)}d.hide=function(){d.addCls("hideAlert");$(d.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert");setTimeout(function(){d.destroy()},1000)};Ext.Viewport.add(d);var g=$(d.element.dom).find(".highlightClose");if(g[0]!=null){g[0].onclick=function(){d.hide()};g[0].addEventListener("touchstart",function(){d.hide()})}},highlightDisable:function(){var c=this;var d="Highlight Text Mode Disabled";if(language!=null&&language.articlePopover!=null&&language.articlePopover.highlightedTextModeDisabled){d=language.articlePopover.highlightedTextModeDisabled}var b=new InfinityMobile.view.Overlay({html:d,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000,textAlign:"center",lineHeight:1.8},padding:15,zIndex:1e+21,cls:"copy-alert font15"});var a=b.getModal();if(a!=null){a.setZIndex(2147483640)}Ext.Viewport.add(b);setTimeout(function(){b.addCls("hideAlert");$(b.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert")},1000);setTimeout(function(){b.destroy()},2000)},sectionPopup:function(b,d){var c=this;var a=Ext.create("InfinityMobile.view.ReaderSectionPopup",{zIndex:9999});a.showBy(d)},loadSectionsPopup:function(a,b){var f=this;var l=settings.bookmarks.bookmark;var k=l;if(k!=null&&k.length>0){for(var d=0;d<k.length;d++){var h=k[d];var c=Ext.getStore("MediaStore").media.article;var e=null;for(var g in c){if(h.pageNumber==c[g].page){e=g;break}}if(e!=null){var j=Ext.create("InfinityMobile.view.ReaderSectionPopupItem",{name:h.name,pageNumber:h.pageValue,type:"popover",articleIndex:e});b.add(j)}}}},jumpToSectionPage:function(a){var d=this;var b=d.getArticlecarousel();if(b!=null){b.jumpToPage(a);var c=d.getSectionpopup();if(c!=null){c.hide()}}},translateArticle:function(d){var e=this;var a=e.getArticlecarousel();var h=a.getActiveItem();var b=settings.translateUrl+"?langpair=en|es&u=";var g=window.location.host;var c=window.location.pathname.split("/");var f="http://"+g+"/html5/desktop/article_translate.aspx?guid="+h.articleguid+"&html5="+currentProfile;b+=encodeURIComponent(f);window.open(b)},translate:function(a){var b=this;if(b.currentLang=="en"){for(i=0;i<b.getArticlecarousel().getItems().items.length;i++){var c=b.getArticlecarousel().getItems().items[i];c.setMasked({message:"Translating..."});c.lang="es";c.getContent()}b.currentLang="es";a.removeCls("spain")}else{for(i=0;i<b.getArticlecarousel().getItems().items.length;i++){var c=b.getArticlecarousel().getItems().items[i];c.setMasked({message:"Translating..."});c.lang="en";c.getContent()}b.currentLang="en";a.addCls("spain")}},getCookie:function(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)==0){return f.substring(b.length,f.length)}}return""},oVideoError:function(d){var c=this;d.destroy();var b=new InfinityMobile.view.Overlay({html:'<div class="highlightClose pointerCursor" style="color:rgb(69, 145, 184);position:absolute;top:0px;right:0px;font-size:11px;display:inline-flex;"><div style="padding:3px">Close</div><img  src="../assets/article view/article-close-btn.png" style="width:15px;height:15px;margin:5px;"></div><span style="font-weight:bold;">Error</span><br />There was an error playing the video.',style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000,textAlign:"center",lineHeight:1.8},padding:15,zIndex:2147483641,cls:"copy-alert font15"});var a=b.getModal();if(a!=null){a.setZIndex(2147483640)}b.hide=function(){b.addCls("hideAlert");$(b.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert");setTimeout(function(){b.destroy()},1000)};Ext.Viewport.add(b);var e=$(b.element.dom).find(".highlightClose");if(e[0]!=null){e[0].onclick=function(){b.hide()};e[0].addEventListener("touchstart",function(){b.hide()})}},ogalleryinitialized:function(a,e,b){var h=this;if(typeof trackReaderEvent!="undefined"){var j=a.config.obj.config.mediaObject.page;if(j==null){j=a.config.obj.config.page.page}var k=h.getSectionName(j);if(e.omniture!=null){var c=e.omniture.author;var l=e.omniture.contentTitle;var f=e.omniture.contentType;var g=e.omniture.hierarchy;var d=e.omniture.pageName}trackReaderEvent("ogallery",{pageNum:j,section:k,author:c,contenttitle:l,contenttype:f,hier:g,pagename:d,photoNum:b})}},ogalleryinitializedArticle:function(a,e,b){var h=this;if(typeof trackReaderEvent!="undefined"){var j=a.config.obj.config.page.page;var k=h.getSectionName(j);var c=e.author;var l=e.contentTitle;var f=e.contentType;var g="newsday:eedition";var d=l+" - "+g+" - "+f;trackReaderEvent("ogallery",{pageNum:j,section:k,author:c,contenttitle:l,contenttype:f,hier:g,pagename:d,photoNum:b})}},ovideoinitialized:function(a,d){var g=this;if(typeof trackReaderEvent!="undefined"){var h=a.config.obj.config.mediaObject.page;if(h==null){h=a.config.obj.config.page.page}var j=g.getSectionName(h);if(d.omniture!=null){var b=d.omniture.author;var k=d.omniture.contentTitle;var e=d.omniture.contentType;var f=d.omniture.hierarchy;var c=d.omniture.pageName}trackReaderEvent("ovideo",{pageNum:h,section:j,author:b,contenttitle:k,contenttype:e,hier:f,pagename:c})}},trackOLink:function(c,b,f){var d=this;if(typeof trackReaderEvent!="undefined"){var a=c.config.page.page;var e=d.getSectionName(a);trackReaderEvent("link",{url:b,pageNum:a,section:e})}},readAloudMode:function(){var e=this;var f=e.getReaderarticlepopover();var d=e.articleCarousel.items.items;if(f!=null){if(f.highlightMode){for(var c=0;c<d.length;c++){var b=d[c];if(!e.isPuzzleOrComic(b)){b.toggleToTextMode()}}f.highlightMode=false}}for(var c=0;c<d.length;c++){var b=d[c];var a=e.articleCarousel;if(b==e.articleCarousel.getActiveItem()){b.destoryAdvertMpuSlot()}if(!e.isPuzzleOrComic(b)){b.toggleToTextMode()}}if(f!=null){if(f.readAloudMode){e.readAloudDisable();e.disableReadAloud(f);e.stopReading()}else{e.readAloudInstructions();f.readAloudMode=true;f.ttsToggle.addCls("playing")}}},disableReadAloud:function(b){var a=this;console.log(b);if(b!=null){a.showArticleTools(b);b.readAloudMode=false;b.ttsToggle.removeCls("playing")}},playArticleText:function(){var a=this;var d=a.getArticlecarousel();var c=d.getActiveItem();if(!a.isPuzzleOrComic(c)){readAloud.type="ARTICLE";a.setPopoverTooltipText("Stop");switch(readAloud.status){case"STOPPED":case"PLAYING":window.speechSynthesis.cancel();a.read(a.getArticleText());break;case"PAUSED":readAloud.status="PLAYING";if(Ext.browser.is.Chrome){if(window.speechSynthesis.paused){window.speechSynthesis.resume()}else{var b=readAloud.offset;a.stopReading();readAloud.offset=b;a.read(a.getArticleText())}}else{window.speechSynthesis.resume()}break}}},setPopoverTooltipText:function(c){var a=this;var b=a.getReaderarticlepopover();if(b!=null&&b.tooltip!=null){b.tooltip.setHtml(c)}},getArticleText:function(){var d=this;var h=d.getArticlecarousel();if(h!=null){var f=h.getActiveItem();if(f!=null){var b=f.element.down("iframe.articleiframe")}}var g="";if(b!=null){var a=b.dom.contentDocument;if(window.getSelection){g=a.getSelection().toString()}else{if(a.selection&&a.selection.type!="Control"){g=a.selection.createRange().text}}if(g.trim().length>0){return g}else{if(d.getArticlecarousel().getActiveItem().articleText){g=d.getArticlecarousel().getActiveItem().articleText.replace("NEXT IMAGE<img","<img").replace("PREVIOUS IMAGE<img","<img").replace(">Image</div>","></div>");return g}else{if(d.getArticlecarousel().getActiveItem().article){var f=d.getCurrentArticle();var e=f.body;var c=document.createElement("textarea");c.innerHTML=e;var e=c.value;g=f.headline+". "+f.subHeadline+". "+f.byline+". "+e;return g;delete c}else{if(d.getArticlecarousel().getActiveItem().initialConfig.page.headline!=null){var f=d.getArticlecarousel().getActiveItem().initialConfig.page;g=f.headline+". "+f.subHeadline+". "+f.byline+". "+f.body;return g}else{d.stopArticleTTS(toggle,alticon)}}}}}},read:function(d){var c=this;if(d!=null){d=d.split("'").join("\u2018").replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/\s\s+/g," ").trim();if(!d.startsWith("<<Error>>")){if(d.length>200&&(Ext.os.is.Android)){sentences=d.split(". ");for(i=0;i<sentences.length;i++){sentence=sentences[i];audio=new SpeechSynthesisUtterance(sentence);audio.lang="en-US";if(navigator.appVersion.indexOf("Edge")==-1){audio.voice=c.getVoice(window.speechSynthesis,"en-US")}if(navigator.appVersion.indexOf("Edge")==-1&&Ext.browser.is.Chrome){audio.rate=0.6}else{audio.rate=0.8}if(i==sentences.length-1){audio.onend=function(){c.stopReading()}}setTimeout(function(){readAloud.utterance=audio;window.speechSynthesis.speak(audio)},0);readAloud.status="PLAYING";readAloud.text=d}}else{if(Ext.browser.is.Chrome){readAloud.offset=0;var b=new SpeechSynthesisUtterance(d);if(navigator.appVersion.indexOf("Edge")==-1){b.voice=c.getVoice(window.speechSynthesis,"en-US")}b.rate=0.7;readAloud.status="PLAYING";readAloud.text=d;c.chunkSpeechUtterance(b,function(){c.stopReading()}),function(){c.stopReading()}}else{var b=new SpeechSynthesisUtterance();b.text=d;b.lang="en-US";if(navigator.appVersion.indexOf("Edge")==-1){b.voice=c.getVoice(window.speechSynthesis,"en-US")}if(settings.tts!=null&&settings.tts.rate!=null){b.rate=parseFloat(settings.tts.rate)}else{if(navigator.appVersion.indexOf("Edge")==-1&&Ext.browser.is.Chrome){b.rate=0.6}else{b.rate=0.8}}if(settings.tts!=null&&settings.tts.pitch!=null){b.pitch=parseFloat(settings.tts.pitch)}b.onend=function(){c.stopReading()};b.onerror=function(f){c.stopReading()};if(Ext.os.is.iOS){var a=window.speechSynthesis.getVoices();if(a.length==0){a=c.iOsVoices}b.lang="en-US";b.voice=c.getVoice(b,"en-US");b.voice=jQuery.grep(a,function(e){return e.lang==b.lang})[0]}setTimeout(function(){console.log(b);window.speechSynthesis.speak(b)},0);readAloud.status="PLAYING";readAloud.text=d}}}}},chunkSpeechUtterance:function(d,g){var c=this;var b;var h=(readAloud&&readAloud.offset!==undefined?d.text.substring(readAloud.offset):d.text);h.trim();if(d!=null&&d.voice!=null&&d.voice.voiceURI!=null&&d.voice.voiceURI=="native"){b=d;b.text=h;b.addEventListener("end",function(){g()})}else{var j=120;var k=new RegExp("^[\\s\\S]{"+Math.floor(j/2)+","+j+"}[.!?,]{1}|^[\\s\\S]{1,"+j+"}$|^[\\s\\S]{1,"+j+"} ");var a=h.match(k);if(a[0]===undefined||a[0].length<2){if(g!=null){g();readAloud.offset=0}return}var f=a[0];if(f.startsWith(". ")){b=new SpeechSynthesisUtterance(f.replace(". ","  "))}else{b=new SpeechSynthesisUtterance(f)}b.rate=d.rate;b.voice=d.voice;b.lang=d.lang;var e;for(e in d){if(d.hasOwnProperty(e)&&e!=="text"){b[e]=d[e]}}b.addEventListener("end",function(){readAloud.offset=readAloud.offset||0;readAloud.offset+=f.length-1;if(readAloud!="STOPPED"){c.chunkSpeechUtterance(d,g)}})}console.log(b);setTimeout(function(){if(readAloud.status=="STOPPED"){c.stopReading()}else{readAloud.utterance=b;window.speechSynthesis.speak(b)}},0)},getVoice:function(b,e){var c=this;if(b.getVoices!=null){var a=b.getVoices();var d=null;for(i=0;i<a.length;i++){if(a[i].lang==e){d=a[i];break}}if(d==null){d=a[0]}return d}else{return null}},pauseArticleText:function(){var a=this;readAloud.type="ARTICLE";readAloud.status="PAUSED";console.log("PAUSE ARTICLE TEXT");window.speechSynthesis.pause()},restartArticleText:function(){var a=this;console.log("restart");a.stopReading()},stopReading:function(){var a=this;window.speechSynthesis.cancel();a.setPopoverTooltipText("Play");readAloud.status="STOPPED";if(readAloud.controls!=null&&readAloud.controls.playBtn!=null){readAloud.controls.playBtn.addCls("playReadAloud");if(readAloud.controls.type=="play-stop"){readAloud.controls.playBtn.removeCls("stopReadAloud")}else{readAloud.controls.playBtn.removeCls("pauseReadAloud")}}},clearReadAloudIframeSelection:function(a){var d=this;if(a!=null){}else{var g=d.getArticlecarousel();if(g!=null){var e=g.getActiveItem();if(e!=null){var c=e.element.down("iframe")}}}var f="";if(c!=null){var b=c.dom.contentDocument;if(b.selection){b.selection.empty()}else{if(window.getSelection){b.getSelection().removeAllRanges()}}}},readAloudInstructions:function(b){var f=this;var e="Press the play button to read the article.<br />Alternatively, highlight<br /> the text you wish to be read";if(language!=null&&language.articlePopover!=null&&language.articlePopover.readAloudMessage!=null){e=language.articlePopover.readAloudMessage}var a="Close";if(language!=null&&language.close!=null){a=language.close}var g="Read Aloud Mode";if(language!=null&&language.menu!=null&&language.menu.readAloud!=null){g=language.menu.readAloud}var d=new InfinityMobile.view.Overlay({html:'<div class="highlightClose pointerCursor" style="color:rgb(69, 145, 184);position:absolute;top:0px;right:0px;font-size:11px;display:inline-flex;"><div style="padding:3px">'+a+'</div><img  src="../assets/article view/article-close-btn.png" style="width:15px;height:15px;margin:5px;"></div><span style="font-weight:bold;">'+g+"</span><br />"+e,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000,textAlign:"center",lineHeight:1.8},padding:15,zIndex:2147483647,cls:"copy-alert font15"});var c=d.getModal();if(c!=null){c.setZIndex(2147483646)}d.hide=function(){d.addCls("hideAlert");$(d.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert");setTimeout(function(){d.destroy()},1000)};Ext.Viewport.add(d);var h=$(d.element.dom).find(".highlightClose");if(h[0]!=null){h[0].onclick=function(){d.hide()};h[0].addEventListener("touchstart",function(){d.hide()})}f.setupHighlightListener()},setupHighlightListener:function(){var b=this;var a=b.getReaderarticlepopover();if(a!=null){b.hideArticleTools(a);a.readAloudControls.show()}},hideArticleTools:function(a){var b=this;if(a!=null){a.topBarTranslate.hide();a.copyButton.hide();a.topBarPrint.hide();a.topBarSelectText.hide()}},showArticleTools:function(a){if(a!=null){if(!Ext.os.is.iOS){a.topBarTranslate.show()}a.copyButton.show();a.topBarPrint.show();a.topBarSelectText.show();a.readAloudControls.hide()}},readAloudDisable:function(){var b=this;var a="Read Aloud Mode Disabled";if(language!=null&&language.articlePopover!=null&&language.articlePopover.readAloudDisabled!=null){a=language.articlePopover.readAloudDisabled}b.disableMessage(a)},disableMessage:function(c){var b=new InfinityMobile.view.Overlay({html:c,style:{backgroundColor:"#fff",color:"#000",zIndex:211111111111111100000,textAlign:"center",lineHeight:1.8},padding:15,zIndex:1e+21,cls:"copy-alert font15"});var a=b.getModal();if(a!=null){a.setZIndex(2147483640)}Ext.Viewport.add(b);setTimeout(function(){b.addCls("hideAlert");if(b.element!=null){$(b.element.dom).closest(".x-center").next(".x-mask").addClass("hideAlert")}},1000);setTimeout(function(){b.destroy()},2000)},stopArticleText:function(){var a=this;a.stopReading()},settingsLoaded:function(){var a=typeof settings==="object"&&settings!=null&&Object.keys(settings).length>0;if(a){this.flippAdvertSetting=this.getFlippAdvertSetting()}},getFlippAdvertSetting:function(){var b={enabled:false};var a="articlepopover" in settings&&typeof settings.articlepopover==="object"&&settings.articlepopover!=null;a=a&&"flippAdvert" in settings.articlepopover&&typeof settings.articlepopover.flippAdvert==="object"&&settings.articlepopover.flippAdvert!=null;if(!a){return b}var e=settings.articlepopover.flippAdvert;b.enabled=e.enabled!=null&&e.enabled.toLowerCase()==="true";if(b.enabled){var d=(e.publisherIdentity!=null&&!!e.publisherIdentity)?e.publisherIdentity:null;if(!!d){var c=d.split("|");b.publisherName=c[0]||null;b.publisherSiteId=c[1]||null;b.publisherZoneId=(e.publisherZoneId!=null&&!!e.publisherZoneId)?e.publisherZoneId:null;if(b.publisherName==null||b.publisherSiteId==null||b.publisherZoneId==null){lippAdSetting.enabled=false}}b.headerText=(e.headerText!=null&&!!e.headerText)?e.headerText:"Featured Local Savings"}return b}},0,0,0,0,0,0,[InfinityMobile.controller,"MediaController"],0));(Ext.cmd.derive("InfinityMobile.controller.DataCaptureController",Ext.app.Controller,{config:{refs:{main:"main",datacaptureform:"datacaptureform",articlescontainer:"articlescontainer"},control:{main:{checkDataCapture:"checkDataCapture",createDataCapture:"createDataCapture"},datacapture:{submitDataCapture:"submitDataCapture"},datacaptureform:{sendData:"sendData",closeDataCapture:"closeDataCapture"}}},init:function(){var a=this},createDataCapture:function(){var c=this;if(settings.reader.dataCapture!=null){try{var b=localStorage.getItem("datacapture"+publicationguid)}catch(a){var b=null}if(b==null){dataCaptureFunc=function(){if(Ext.os.is.Phone){var d=Ext.create("InfinityMobile.view.phone.DataCaptureForm",{logo:settings.reader.dataCapture.logo,welcomeText:settings.reader.dataCapture.welcomeText,settings:settings.reader.dataCapture})}else{var d=Ext.create("InfinityMobile.view.DataCaptureForm",{logo:settings.reader.dataCapture.logo,welcomeText:settings.reader.dataCapture.welcomeText,settings:settings.reader.dataCapture})}console.log("DATA CAPTURE");console.log(d);Ext.Viewport.add(d)};if(Ext.getStore("LanguageStore")==null){console.log("language undefined");Ext.getStore("LanguageStore").on({load:function(){console.log("store loaded");dataCaptureFunc()}})}else{dataCaptureFunc()}}}},closeDataCapture:function(b){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().element.dom.style.visibility=""}},sendData:function(c,d){var b=this;var a="{";if(d.firstname!=null){a+='"firstname":"'+d.firstname+'",'}if(d.surname!=null){a+='"surname":"'+d.surname+'",'}if(d.email!=null){a+='"email":"'+d.email+'",'}if(d.houseNo!=null){a+='"houseNo":"'+d.houseNo+'",'}if(d.address!=null){a+='"address":"'+d.address+'",'}if(d.postcode!=null){a+='"postcode":"'+d.postcode+'",'}if(d.telephone!=null){a+='"telephone":"'+d.telephone+'",'}if(d.keepMeUpdated!=null){a+='"keepMeUpdated":"true",'}a+="}";$.post("../dataCapture.aspx",{dataCaptureJsonStr:btoa(a.substring(0,a.length-2)+"}"),pubid:publicationguid},function(f){try{localStorage.setItem("datacapture"+publicationguid,"true")}catch(e){}});if(b.getArticlescontainer()!=null){b.getArticlescontainer().element.dom.style.visibility=""}},checkDataCapture:function(){var a=this;if(settings.reader.dataCapture!=null){}},submitDataCapture:function(b){var c=this;try{localStorage.setItem("datacapture","submitted")}catch(a){}Ext.Viewport.remove(b)}},0,0,0,0,0,0,[InfinityMobile.controller,"DataCaptureController"],0));(Ext.cmd.derive("InfinityMobile.controller.PrintController",Ext.app.Controller,{config:{refs:{main:"main",printmenu:"printmenu",printItem:"printitem",articlescontainer:"articlescontainer",carousel:"infinitecarousel2d",articleCarousel:"articlecarousel"},control:{main:{loadPrintMenu:"loadPrintMenu"},printmenu:{loadPages:"loadPages",close:"closePrint",selectAll:"selectAll",selectNone:"selectNone",print:"print",enableArticlesContainer:"enableArticlesContainer"},printItem:{toggleCheckBox:"toggleCheckBox"},readerpuzzlepopoveritem:{puzzlePrintMobile:"puzzlePrintInternal"}}},init:function(){var b=this;canResize=true;if(currentProfile!="desktop"||Ext.browser.is.Firefox){b.internalPrint=false;var a=window.matchMedia("print");a.addListener(function(c){if(c.matches){canResize=false;if(b.internalPrint==false){b.browserPrint()}}else{canResize=true;b.internalPrint=false;var d=$(".printContainer")[0];if(!Ext.os.is.Android){d.innerHTML=""}}})}},browserPrint:function(){var c=this;var e=mainPanel.getActiveItem();if(e.config.viewType!=null&&e.config.viewType=="reader"){c.pagePrint(false)}else{if(!Ext.os.is.Android){var b=c.getArticleCarousel();var d=b.getActiveItem();var a=d.config.page;if(a.description.indexOf("Puzzles")!=-1||a.description.indexOf("Comics")!=-1){c.puzzlePrint(d,false)}else{c.articlePrint(d,false)}}}},loadPrintMenu:function(){var b=this;b.disableArticlesContainer();b.hideArticlesContainer();if(Ext.os.is.Desktop){var a=Ext.create("InfinityMobile.view.desktop.PrintMenu",{})}else{var a=Ext.create("InfinityMobile.view.PrintMenu",{})}Ext.Viewport.add(a);a.show()},hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}},loadPages:function(a,j){var g=this;var e=Ext.getStore("EditionFlatplan");g.pages=e.data.items[0].raw.pageGroups;for(var d=0;d<g.pages.length;d++){var h=g.pages[d].pages[0];if(h.type=="page"){var b=h.origPageNum!=null?h.origPageNum:h.pageNum;var f=h.pageIndex;var c=Ext.create("InfinityMobile.view.ReaderPrintItem",{editionGuid:editionguid,pageNo:b,pageIndex:f});j.add(c)}}},closePrint:function(a){a.hide()},selectAll:function(c){var e=this;var a=e.getAllPrintItems(c);for(var d=0;d<a.length;d++){var b=a[d];e.checkCheckBox(b)}},selectNone:function(c){var e=this;var a=e.getAllPrintItems(c);for(var d=0;d<a.length;d++){var b=a[d];e.uncheckCheckBox(b)}},getAllPrintItems:function(a){return a.printItemsContainer.getItems().items},print:function(c){var g=this;var f=g.getAllPrintItems(c);var h=[];for(var e in f){if(g.getCheckedStatus(f[e])){h[h.length]=f[e]}}if(h.length>0){var d="print.aspx?edid="+editionguid+"&type=pages&pages=";var b="";for(var a in h){b+=h[a]._pageNo+","}if(b[b.length]==","){b=b.substring(0,b.length-1)}d+=b;window.open(d)}},toggleCheckBox:function(a,b){var c=this;if(c.getCheckedStatus(a)){c.uncheckCheckBox(a)}else{c.checkCheckBox(a)}},getCheckedStatus:function(a){return a.editionLabelCheckBox.isChecked()},checkCheckBox:function(a){a.editionLabelCheckBox.check()},uncheckCheckBox:function(a){a.editionLabelCheckBox.uncheck()},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},articlePrintInternal:function(a){var b=this;b.internalPrint=true;b.articlePrint(a,true)},articlePrint:function(f,e){var g=this;var d=g.getArticleCarousel();var b="phoneArticle";if(currentProfile=="tablet"){b="tabletArticle"}var a="<div class='"+b+"'>"+d.getActiveItem().content.getHtml()+"</div>";var c="<style>.articleContentHtml5{font-size:"+fontEm+"px !important}</style>"+a;c=c.replace(/<div*[\sa-zA-Z=\"\'\-0-9:;]* class=[\"\']mpuAdvert[\"\']\s?><\/div>/g,"").replace(/<div\sid\=[\"\']ext-readerarticlepopoveritem-[0-9]*advert[\"\'][a-zA-z0-9\-\=\:\;\s\'\"]*><\/div>/g,"");g.printHtmlAndroid(c,e)},puzzlePrintInternal:function(b){var a=this;a.internalPrint=true;a.puzzlePrint(b,true)},puzzlePrint:function(e,a){var b=this;var d=e.printImage.dom.src;if(d!=null){d=d.replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com")}var c="<img class='puzzleImage' src='"+d+"' />";c="<img src='"+d+"' style='position:absolute;width:100%;height:100%;object-fit: contain;' />";b.printHtmlAndroid(c,a)},pagePrint:function(e){var g=this;var f=g.getCarousel();var j=(f._pageNumber);var c=editionFlatplanData.pageGroups;var h=c[j].pages[0];var a="";if(g.returnOrientation()=="landscape"&&f._mode=="double"&&j>0){if(j%2==0){var b=j-1;var d=c[b].pages[0];a="<div style='position:absolute;width:100%;height:100%'>"+g.printPageHtml(d)+"</div>";a+="<div style='position:absolute;width:100%;height:100%;top:100%'>"+g.printPageHtml(h)+"</div>"}else{var b=j+1;var d=c[b].pages[0];a="<div style='position:absolute;width:100%;height:100%'>"+g.printPageHtml(h)+"</div>";a+="<div style='position:absolute;width:100%;height:100%;top:100%'>"+g.printPageHtml(d)+"</div>"}}else{a=g.printPageHtml(h)}g.printHtmlAndroid(a,e)},printPageHtml:function(l){var g=this;var f="";if(l.tileImage!=null){var b=l.tileImage[0];if(b.width/b.height>window.innerWidth/window.innerHeight){var h="bottom:50%";var a="0%;";var e=0;var m="object-position: 100% 0;";for(var d=0;d<2;d++){for(var c=0;c<2;c++){var k=l.tileImage[e].src;f+="<img src='"+k+"' style='position:absolute;"+h+";left:"+a+"width:50%;height:auto;object-fit: contain;"+m+"' />";e++;h="top:50%"}h="bottom:50%";a="50%;";m="object-position: 0 0;"}}else{var h="0";var a="right:50%;";var e=0;var m="object-position: 100% 0;";for(var d=0;d<2;d++){for(var c=0;c<2;c++){var k=l.tileImage[e].src;f+="<img src='"+k+"' style='position:absolute;top:"+h+";"+a+"width:auto;height:50%;object-fit: contain;"+m+"' />";e++;h="50%"}h="0%";a="left:50%;";m="object-position: 0 0;"}}}else{if(l.image!=null){var k=l.image;if(l.pageNum>1){if(l.image.indexOf("pages.cdn.pagesuite.com")!=-1){k="http://pages.mobile.cdn.pagesuite.com/images/"+g.retrievePageGuid(l)+"/tablet.jpg"}}f+="<img src='"+k+"' style='position:absolute;width:100%;height:100%;object-fit: contain' />"}}return f},retrievePageGuid:function(a){return a.image.split("/")[5]},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}return a},printHtmlAndroid:function(d,b){var e=this;var c=$(".printContainer")[0];if(d!=null){d=d.replace("http://origin.misc.pagesuite.com","https://misc.pagesuite.com")}c.innerHTML=d;if(Ext.os.is.Android&&currentProfile=="phone"){var a=$(c).find(".articleContentHtml5")[0];if(a!=null){$(a).addClass("printAndroid")}}if(b){window.print()}}},0,0,0,0,0,0,[InfinityMobile.controller,"PrintController"],0));(Ext.cmd.derive("InfinityMobile.controller.ClippingController",Ext.app.Controller,{config:{refs:{main:"main",clippingbox:"clippingbox",clippingarea:"clippingarea",clippingmenu:"clippingmenu",readerCarousel:"infinitecarousel2d",reader:"reader",readerpageviewer:"readerpageviewer",clippingmenudeleteprompt:"clippingmenudeleteprompt",clippingoptionsmenu:"clippingoptionsmenu",articlescontainer:"articlescontainer",extratopbar:"extratopbar"},control:{main:{createClipping:"createClippingBox"},clippingbox:{createClipping:"createClipping"},clippingmenu:{DeleteClippings:"DeleteClippings"},clippingmenudeleteprompt:{DeleteClippings:"DeleteClippings",deleteItem:"deleteItem"},clippingarea:{createClip:"createClip",resetClippingArea:"resetClippingArea",enableArticlesContainer:"enableArticlesContainer"},clippingprompt:{createClippingBox:"createClippingBox"},readerpageviewer:{resizeClipping:"resizeClipping"},infinitecarousel:{resizeClipping:"resizeClipping"},clippingitems:{deleteItem:"deleteItem"},clippingoptionsmenu:{enableArticlesContainer:"enableArticlesContainer",close:"close"}}},init:function(){var a=this;a.clippings=[];a.shareClippings=[];a.clippingsWidth=[];a.clippingsHeight=[]},close:function(b){var a=this;window.onkeydown=a.keyDownFunction;b.destroy()},createClippingBox:function(){var j=this;var d;var l=j.getReaderCarousel();var b=l.getActiveItem();var e=j.getReader();var c=j.getReaderpageviewer();j.disableArticlesContainer();try{var k=localStorage.getItem("clippingPrompt"+publicationguid)}catch(g){var k=null}j.hideArticlesContainer();if(k!=null){if(Ext.os.is.Desktop){var a=Ext.create("InfinityMobile.view.ClippingArea",{readerActiveItem:b,reader:e})}else{var a=Ext.create("InfinityMobile.view.tablet.ClippingArea",{readerActiveItem:b,reader:e})}Ext.Viewport.add(a);a.show();if(Ext.os.is.Desktop){if(settings.newsday!=null){if(settings.newsday.extraTopBar=="true"){var h=j.getExtratopbar();if(h!=null){h.setZIndex(0)}}}}}else{if(Ext.os.is.Phone){var f=Ext.create("InfinityMobile.view.phone.clippingPrompt",{readerActiveItem:b,reader:e})}else{var f=Ext.create("InfinityMobile.view.clippingPrompt",{readerActiveItem:b,reader:e})}}if(currentProfile=="desktop"){j.keyDownFunction=window.onkeydown;window.onkeydown=null}},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},createClipping:function(m){var h=this;var k=document.getElementById("clipper");var l=m.x;var j=m.y;var a=0;var d=m.readerActiveItem;var f=m.reader;var e=d.zoomDiv.dom.style.transform;var o=e.substring(e.indexOf("scale3d(")+8,e.length-4).split(",");var n=(h.naturalW/d.imagetoload.clientWidth);var g=(h.naturalH/d.imagetoload.clientHeight);if(l!=0&&j!=0){if(document.getElementById("slider").value==1){if(d._mode=="double"){l=m.x-((f.element.dom.clientWidth/2)-d.imagetoload.clientWidth);a=d._pageNo;if(m.x>(f.element.dom.clientWidth/2)){l-=d.imagetoload.clientWidth;a=d._pageNo+1}l=(l*n);if(f.element.dom.clientHeight-40<d.mediaDiv.dom.clientHeight){j=m.y-40+d.getScrollable().getScroller().position.y}else{j=m.y-40;var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.ticker!=null){j=j-(((f.element.dom.clientHeight-80)-d.imagetoload.clientHeight)/2)}else{j=j-(((f.element.dom.clientHeight-40)-d.imagetoload.clientHeight)/2)}}j=j*g}else{l=m.x-(((f.element.dom.clientWidth)-d.imagetoload.clientWidth)/2);l=l*n;a=d._pageNo+1;if(f.element.dom.clientHeight-40<d.mediaDiv.dom.clientHeight){j=m.y-40+d.getScrollable().getScroller().position.y}else{j=m.y-40;var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.ticker!=null){j=j-(((f.element.dom.clientHeight-80)-d.imagetoload.clientHeight)/2)}else{j=j-(((f.element.dom.clientHeight-40)-d.imagetoload.clientHeight)/2)}}j=j*g}a=flatPlanData.reversePageMapper[a];var b="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+a+"&x="+Math.floor(l)+"&y="+Math.floor(j)+"&h="+Math.floor(k.offsetHeight*(h.naturalH/d.imagetoload.clientHeight))+"&w="+Math.floor(k.offsetWidth*(h.naturalW/d.imagetoload.clientWidth))}else{a=d._pageNo;if(m.x>=d.imagetoload.clientWidth){}else{}var b="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+a+"&x="+Math.floor(l)+"&y="+Math.floor(j)+"&h="+Math.floor(k.offsetHeight*(h.naturalH/d.imagetoload.clientHeight)/document.getElementById("slider").value)+"&w="+Math.floor(k.offsetWidth*(h.naturalW/d.imagetoload.clientWidth)/document.getElementById("slider").value)}}h.clippings[h.clippings.length]=b;h.clippingMenu();h.clipper=null;m.destroy()},mapPosition:function(h,g,j,d){var f=this;var b=(h);var a=(g);var e=b+d.getScrollable().getScroller().position.x;var c=a+d.getScrollable().getScroller().position.y;f.zoomPointX=((e)/(j));f.zoomPointY=((c)/(j));f.offsetX=(b-f.zoomPointX);f.offsetY=(a-f.zoomPointY);f.offsetScrollerX=f.offsetX+d.getScrollable().getScroller().position.x;f.offsetScrollerY=f.offsetY+d.getScrollable().getScroller().position.y;f.translateX+=f.offsetScrollerX;f.translateY+=f.offsetScrollerY},clippingMenu:function(){var a=this;if(Ext.os.is.Phone){var b=Ext.create("InfinityMobile.view.phone.ClippingOptionsMenu",{images:a.clippings,shareImages:a.shareClippings,widths:a.clippingsWidth,heights:a.clippingsHeight});Ext.Viewport.add(b);b.show()}else{if(Ext.os.is.Desktop){var b=Ext.create("InfinityMobile.view.desktop.ClippingOptionsMenu",{images:a.clippings,shareImages:a.shareClippings,widths:a.clippingsWidth,heights:a.clippingsHeight})}else{if($(document).height()<700||$(document).width()<700){var b=Ext.create("InfinityMobile.view.phone.ClippingOptionsMenu",{images:a.clippings,shareImages:a.shareClippings,widths:a.clippingsWidth,heights:a.clippingsHeight});Ext.Viewport.add(b);b.show()}else{var b=Ext.create("InfinityMobile.view.ClippingOptionsMenu",{images:a.clippings,shareImages:a.shareClippings,widths:a.clippingsWidth,heights:a.clippingsHeight})}}}},DeleteClippings:function(e,f,b){var d=this;for(var c=0;c<f.length;c++){for(var a=0;a<d.clippings.length;a++){if(f[c]==d.clippings[a]){d.clippings.splice(a,1);break}}}e.updateImages(d.clippings)},createClip:function(f,e,g,d,a){var b=this;var c=b.getReaderCarousel();if(Ext.os.is.Desktop){if(c._mode=="single"){b.clippingSinglePage(f,e,g,d,a)}else{b.clippingDoublePage(f,e,g,d,a)}}else{if(b.returnOrientation()=="portrait"){b.createClipPortrait(f,e,g,d,a)}else{if(c._mode=="single"){b.createClipPortrait(f,e,g,d,a)}else{b.createClipLandscape(f,e,g,d,a)}}}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},createClipPortrait:function(e,r,k,q,u){var C=this;var B=true;var o=k.image;var j=k.landscapeimage;var s=o;if(s.clientWidth==0){s=j}var d=s.naturalWidth;var c=s.naturalHeight;var g=$(s).offset();var E=k._pageNo+1;if(k.scale==1){var D=c/$(s).height();if(k.scroller.position.y>0){var t=k.scroller.position.y}else{var t=0}var m=parseInt(((parseFloat(e)+5)-g.left+k.scroller.position.x)*D);var l=parseInt(((parseFloat(r)+5)-g.top+k.scroller.position.y-t)*D);var A=parseInt(($(q.element.dom).height()-10)*D);var n=parseInt(($(q.element.dom).width()-10)*D);if(m<0||m+n>k.initialImageWidth*D||l<0||l+A>k.initialImageHeight*D){B=false}else{var f="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+E+"&x="+m+"&y="+l+"&h="+A+"&w="+n+"&nw="+d+"&nh="+c}}else{if(k.scroller.position.y>0){var t=40}else{var t=40}if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){t-=40}}var p=k.scale;var z=k.translateX*p;var b=parseFloat((k.scroller.position.x)+parseFloat(e));var D=c/($(s).height()*p);var a=parseFloat(k.scroller.position.y+parseFloat(r)-t);var m=parseInt(((b+5)-z)*D);var l=parseInt(((a+5))*D);var A=parseInt(($(q.element.dom).height()-10)*D);var n=parseInt(($(q.element.dom).width()-10)*D);if(m<0||m+n>(k.initialImageWidth*p)*D||l<0||l+A>(k.initialImageHeight*p)*D){B=false}else{var f="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+E+"&x="+m+"&y="+l+"&h="+A+"&w="+n+"&nw="+d+"&nh="+c}}if(B){$.ajax({url:f,beforeSend:function(){Ext.Viewport.setMasked({xtype:"loadmask",zIndex:99999999,message:language.clippings.clippingSpinner})}}).done(function(h){Ext.Viewport.setMasked(false);console.log(h.Status);if(h.Status=="success"){C.clippings[C.clippings.length]=h.Value;C.clippingsWidth[C.clippingsWidth.length]=n;C.clippingsHeight[C.clippingsHeight.length]=A;u.selfDestruct();C.clippingMenu()}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}})}else{var v=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(v);v.show()}},createClipLandscape:function(f,r,l,q,u){var I=this;var D=false;if($(l.image).width()==0||l.image.stayHidden){var j=false}else{var j=true;var k=$(l.image).offset()}if($(l.landscapeimage).width()==0||l.landscapeimage.stayHidden){var A=false}else{var A=true;var G=$(l.landscapeimage).offset()}var t;if(G==null){t=$(l.portraitMediaDiv).offset().left+$(l.portraitMediaDiv).width()}else{t=$(l.landscapeimage).offset().left}if(j){if(l.scale==1){if((parseFloat(f)+5)>=k.left&&(parseFloat(f)+5)<=t){var J=l.image.pageNumber;var d=l.image.naturalWidth;var c=l.image.naturalHeight;var H=d/$(l.image).width();var F=c/$(l.image).height();if(l.scroller.position.y>0){var s=l.scroller.position.y}else{var s=0}var n=parseInt(((parseFloat(f)+5)-k.left+l.scroller.position.x)*H);var m=parseInt(((parseFloat(r)+5)-k.top+l.scroller.position.y-s)*F);var B=parseInt(($(q.element.dom).height()-10)*H);var o=parseInt(($(q.element.dom).width()-10)*F);if(n<0||m<0||m+B>$(l.portraitMediaDiv).height()*F){D=false}else{D=true;var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+J+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}}else{var p=l.scale;var z=l.translateX*p;var b=parseFloat((l.scroller.position.x)+parseFloat(f));var e=($(l.image).width()*p)+z;if(b+5>=z&&b+5<=e){var J=l.image.pageNumber;var d=l.image.naturalWidth;var c=l.image.naturalHeight;var s=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){s-=40}}var H=d/($(l.image).width()*p);var F=c/($(l.image).height()*p);var a=parseFloat(l.scroller.position.y+parseFloat(r)-s);var n=parseInt(((b+5)-z)*H);var m=parseInt(((a+5))*F);var B=parseInt(($(q.element.dom).height()-10)*H);var o=parseInt(($(q.element.dom).width()-10)*F);if(n<0||m<0||m+B>($(l.landscapeimage).height()*p)*F){D=false}else{D=true;var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+J+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}}}if(A){if(l.scale==1){if((parseFloat(f)+5)>=G.left&&(parseFloat(f)+5)<=G.left+$(l.landscapeimage).width()){var J=l.landscapeimage.pageNumber;var d=l.landscapeimage.naturalWidth;var c=l.landscapeimage.naturalHeight;var H=d/$(l.landscapeimage).width();var F=c/$(l.landscapeimage).height();if(l.scroller.position.y>0){var s=l.scroller.position.y}else{var s=0}var n=parseInt(((parseFloat(f)+5)-G.left+l.scroller.position.x)*H);var m=parseInt(((parseFloat(r)+5)-G.top+l.scroller.position.y-s)*F);var B=parseInt(($(q.element.dom).height()-10)*H);var o=parseInt(($(q.element.dom).width()-10)*F);if(n<0||n+o>$(l.landscapeimage).width()*H||m<0||m+B>$(l.landscapeimage).height()*F){D=false}else{D=true;var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+J+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}}else{var p=l.scale;var E=(l.translateX+$(l.landscapeimage).width())*p;var b=parseFloat((l.scroller.position.x)+parseFloat(f));var e=E+($(l.landscapeimage).width()*p);if(b+5>=E&&b+5<=e){var J=l.landscapeimage.pageNumber;var d=l.landscapeimage.naturalWidth;var c=l.landscapeimage.naturalHeight;var s=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){s-=40}}var H=d/($(l.landscapeimage).width()*p);var F=c/($(l.landscapeimage).height()*p);var a=parseFloat(l.scroller.position.y+parseFloat(r)-s);var C=$(l.landscapeimage).height()*p;var n=parseInt(((b+5)-E)*H);var m=parseInt(((a+5))*F);var B=parseInt(($(q.element.dom).height()-10)*H);var o=parseInt(($(q.element.dom).width()-10)*F);if(n+o>($(l.landscapeimage).width()*p)*F||m<0||m+B>($(l.landscapeimage).height()*p)*F){D=false}else{D=true;var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+J+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}}}if(D){$.ajax({url:g,beforeSend:function(){Ext.Viewport.setMasked({xtype:"loadmask",zIndex:99999999,message:language.clippings.clippingSpinner})}}).done(function(h){Ext.Viewport.setMasked(false);console.log(h.Status);if(h.Status=="success"){I.clippings[I.clippings.length]=h.Value;I.clippingsWidth[I.clippingsWidth.length]=o;I.clippingsHeight[I.clippingsHeight.length]=B;u.selfDestruct();I.clippingMenu()}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}})}else{var v=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(v);v.show()}},createClipSingle:function(f,r,l,q,u){var J=this;var j=true;var A=true;if(l.rightSide.element.dom.style.visibility=="hidden"){A=false}else{j=false}var E=true;if(j){var k=$(l.leftSideImg).offset();k.top=k.top;if(k.top<0){k.top=0}var B=J.getReaderCarousel();var s=40;if(B.getActiveItem().zoomMode=="fill"&&$("#slider").val()<=1){s=0}else{if(B.getActiveItem().zoomMode=="fit"&&$("#slider").val()<=1){s=0}else{s=40}}var K=flatPlanData.reversePageMapper[l.leftSideImageContainer.pageNo];var d=l.leftSideImg.naturalWidth;var c=l.leftSideImg.naturalHeight;if($("#slider").val()<=1){var I=d/l.leftSideWidth;var H=c/l.leftSideHeight;if(l.zoomMode=="fill"){if(l.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){}else{s+=40}}else{s+=40}if(typeof isTribReader!="undefined"&&isTribReader){s+=20}}}var n=parseInt(((parseFloat(f)+5)-k.left+l.scroller.position.x)*I);var m=parseInt(((parseFloat(r)+5)-k.top+l.scroller.position.y-s)*H);var C=parseInt(($(q.element.dom).height()-10)*I);var o=parseInt(($(q.element.dom).width()-10)*H);if(n<0||n+o>l.leftSideWidth*I||m<0||m+C>l.leftSideHeight*H){E=false;l.failedClipping()}else{var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+K+"&x="+n+"&y="+m+"&h="+C+"&w="+o+"&nw="+d+"&nh="+c}}else{var p=$("#slider").val();if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){s-=40}}if(typeof isTribReader!="undefined"&&isTribReader){s+=20}var z=l.initialTranslateX*p;var b=parseFloat((l.scroller.position.x)+parseFloat(f));var e=z+(l.width*p);var I=d/(l.leftSideWidth*p);var H=c/(l.leftSideHeight*p);var a=parseFloat(l.scroller.position.y+parseFloat(r)-s);var t=l.leftSideHeight*p;var n=parseInt(((b+5)-z)*I);var m=parseInt(((a+5))*I);var C=parseInt(($(q.element.dom).height()-10)*I);var o=parseInt(($(q.element.dom).width()-10)*I);if(n<0||n+o>(l.leftSideWidth*p)*I||m<0||m+C>(l.leftSideHeight*p)*I){E=false}else{var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+K+"&x="+n+"&y="+m+"&h="+C+"&w="+o+"&nw="+d+"&nh="+c}}}else{if(A){var G=$(l.rightSideImg).offset();G.top=G.top;if(G.top<0){G.top=0}var s=40;var B=J.getReaderCarousel();if(B.getActiveItem().zoomMode=="fill"&&$("#slider").val()<=1){s=0}else{if(B.getActiveItem().zoomMode=="fit"&&$("#slider").val()<=1){s=0}else{s=40}}var K=flatPlanData.reversePageMapper[l.rightSideImageContainer.pageNo];var d=l.rightSideImg.naturalWidth;var c=l.rightSideImg.naturalHeight;if($("#slider").val()<=1){var I=d/l.width;var H=c/l.height;if(l.zoomMode=="fill"){if(l.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){}else{s+=40}}else{s+=40}}}var n=parseInt(((parseFloat(f)+5)-G.left+l.scroller.position.x)*I);var m=parseInt(((parseFloat(r)+5)-G.top+l.scroller.position.y-s)*I);var C=parseInt(($(q.element.dom).height()-10)*I);var o=parseInt(($(q.element.dom).width()-10)*I);if(n<0||n+o>l.width*I||m<0||m+C>l.height*I){E=false}else{var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+K+"&x="+n+"&y="+m+"&h="+C+"&w="+o+"&nw="+d+"&nh="+c}}else{var p=$("#slider").val();var F=l.initialTranslateX*p;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){s-=40}}var b=parseFloat((l.scroller.position.x)+parseFloat(f));var e=F+(l.width*p);var I=d/(l.width*p);var H=c/(l.height*p);var a=parseFloat(l.scroller.position.y+parseFloat(r)-s);var D=l.height*p;var n=parseInt(((b+5)-F)*I);var m=parseInt(((a+5))*I);var C=parseInt(($(q.element.dom).height()-10)*I);var o=parseInt(($(q.element.dom).width()-10)*I);if(n<0||n+o>(l.width*p)*I||m<0||m+C>(l.height*p)*I){E=false}else{var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+K+"&x="+n+"&y="+m+"&h="+C+"&w="+o+"&nw="+d+"&nh="+c}}}}if(E){$.ajax({url:g,beforeSend:function(){Ext.Viewport.setMasked({xtype:"loadmask",zIndex:99999999,message:language.clippings.clippingSpinner})}}).done(function(h){Ext.Viewport.setMasked(false);console.log(h);if(h.Status=="success"){J.clippings[J.clippings.length]=h.Value;J.clippingsWidth[J.clippingsWidth.length]=o;J.clippingsHeight[J.clippingsHeight.length]=C;u.selfDestruct();J.clippingMenu()}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}})}else{var v=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(v);v.show()}},createClipDouble:function(f,r,l,q,u){var I=this;var j=true;var A=true;if(l.leftPage==null){j=false}if(l.rightPage==null){A=false}if(j){var k=$(l.leftSideImg).offset();k.top=k.top;if(k.top<0){k.top=0}}if(A){var G=$(l.rightSideImg).offset();G.top=G.top;if(G.top<0){G.top=0}}var t;if(G!=null){t=G.left}else{t=k.left+$(l.leftSideImg).width()}var D=true;if(j){if($("#slider").val()<=1){if((parseFloat(f)+5)>=k.left&&(parseFloat(f)+5)<=t){var J=flatPlanData.reversePageMapper[l.leftSideImageContainer.pageNo];var d=l.leftSideImg.naturalWidth;var c=l.leftSideImg.naturalHeight;var H=d/l.width;var F=c/l.height;if(l.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){var s=0}else{var s=40}}else{var s=40}}else{var s=0}var n=parseInt(((parseFloat(f)+5)-k.left+l.scroller.position.x)*H);var m=parseInt(((parseFloat(r)+5)-k.top+l.scroller.position.y-s)*H);var B=parseInt(($(q.element.dom).height()-10)*H);var o=parseInt(($(q.element.dom).width()-10)*H);if(n<0||m<0||m+B>l.height*H){D=false}else{D=true;var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+J+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}else{D=false}}else{var p=$("#slider").val();var z=l.initialTranslateX*p;var b=parseFloat((l.scroller.position.x)+parseFloat(f));var e=(l.width*p)+z;if(b+5>=z&&b+5<=e){var J=flatPlanData.reversePageMapper[l.leftSideImageContainer.pageNo];var d=l.leftSideImg.naturalWidth;var c=l.leftSideImg.naturalHeight;var H=d/(l.width*p);var F=c/(l.height*p);var a=parseFloat(l.scroller.position.y+parseFloat(r));var C=l.height*p;var s=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){s-=40}}var n=parseInt(((b+5)-z)*H);var m=parseInt(((a+5)-s)*H);var B=parseInt(($(q.element.dom).height()-10)*H);var o=parseInt(($(q.element.dom).width()-10)*H);if(n<0||m<0||m+B>(l.height*p)*H){D=false}else{D=true;var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+J+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}else{D=false}}}if(A){if($("#slider").val()<=1){if((parseFloat(f)+5)>=G.left&&(parseFloat(f)+5)<=G.left+l.width){var J=flatPlanData.reversePageMapper[l.rightSideImageContainer.pageNo];var d=l.rightSideImg.naturalWidth;var c=l.rightSideImg.naturalHeight;var H=d/l.width;var F=c/l.height;if(l.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){var s=0}else{var s=40}}else{var s=40}}else{var s=0}var n=parseInt(((parseFloat(f)+5)-G.left+l.scroller.position.x)*H);var m=parseInt(((parseFloat(r)+5)-G.top+l.scroller.position.y-s)*H);var B=parseInt(($(q.element.dom).height()-10)*H);var o=parseInt(($(q.element.dom).width()-10)*H);if((n<0&&!j)||n+o>l.width*H||m<0||m+B>l.height*H){D=false}else{D=true;var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+J+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}else{if(!j){D=false}}}else{var p=$("#slider").val();var E=(l.initialTranslateX+l.width)*p;var b=parseFloat((l.scroller.position.x)+parseFloat(f));var e=E+(l.width*p);if(b+5>=E&&b+5<=e){var J=flatPlanData.reversePageMapper[l.rightSideImageContainer.pageNo];var d=l.rightSideImg.naturalWidth;var c=l.rightSideImg.naturalHeight;var H=d/(l.width*p);var F=c/(l.height*p);var a=parseFloat(l.scroller.position.y+parseFloat(r));var C=l.height*p;var s=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){s-=40}}var n=parseInt(((b+5)-E)*H);var m=parseInt(((a+5)-s)*H);var B=parseInt(($(q.element.dom).height()-10)*H);var o=parseInt(($(q.element.dom).width()-10)*H);if(n+o>(l.width*p)*H||m<0||m+B>(l.height*p)*H){D=false}else{D=true;var g="http://clippings.pagesuite.com/create_clipping.aspx?eid="+editionguid+"&pnum="+J+"&x="+n+"&y="+m+"&h="+B+"&w="+o+"&nw="+d+"&nh="+c}}else{if(!j){D=false}}}}if(D){$.ajax({url:g,beforeSend:function(){Ext.Viewport.setMasked({xtype:"loadmask",zIndex:99999999,message:language.clippings.clippingSpinner})}}).done(function(h){Ext.Viewport.setMasked(false);console.log(h.Status);if(h.Status=="success"){I.clippings[I.clippings.length]=h.Value;I.clippingsWidth[I.clippingsWidth.length]=o;I.clippingsHeight[I.clippingsHeight.length]=B;u.selfDestruct();I.clippingMenu()}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}})}else{var v=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(v);v.show()}},resizeClipping:function(){var a=this;if(a.getClippingarea()!=null){a.getClippingarea().resize()}},resetClippingArea:function(b){var c=b.readerActiveItem;var a=b.reader;b.selfDestruct();if(Ext.os.is.Desktop){var d=Ext.create("InfinityMobile.view.ClippingArea",{readerActiveItem:c,reader:a})}else{var d=Ext.create("InfinityMobile.view.tablet.ClippingArea",{readerActiveItem:c,reader:a})}Ext.Viewport.add(d);d.show()},deleteItem:function(d){var c=this;var e=c.getClippingoptionsmenu();var a=c.getClippingoptionsmenu().clippingsContainer;var b=a.innerItems.indexOf(d);a.innerItems[b].destroy();e.images.splice(b,1)},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}},hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}},clippingSinglePage:function(e,j,f,a,c){var h=this;var g=true;var b=true;if(f.xtype!="readeradvertpageviewer"){if(f.rightSide.element.dom.style.visibility=="hidden"){b=false}else{g=false}var d=true;if(g){h.clipSideDesktop("single","left",e,j,f,a,c,f.leftSideImg,f.leftSideImageContainer,f.leftSideWidth,f.leftSideHeight)}else{h.clipSideDesktop("single","right",e,j,f,a,c,f.rightSideImg,f.rightSideImageContainer,f.rightSideWidth,f.rightSideHeight)}}},clippingDoublePage:function(d,l,g,k,n){var u=this;var e=true;var q=true;if(g.leftPage==null||g.config.leftPage.type=="sectionpage"){e=false}if(g.rightPage==null||g.config.rightPage.type=="sectionpage"){q=false}if(e){var f=$(g.leftSideImg).offset();f.top=f.top;if(f.top<0){f.top=0}}if(q){var t=$(g.rightSideImg).offset();t.top=t.top;if(t.top<0){t.top=0}}var m;if(t!=null){m=t.left}else{m=f.left+$(g.leftSideImg).width()}var h=false;var r=true;if(e){if($("#slider").val()<=1){if((parseFloat(d)+5)>=f.left&&(parseFloat(d)+5)<=m){var b="double";if(g.config.rightPage==""||g.config.rightPage.type=="sectionpage"){b="single"}u.clipSideDesktop(b,"left",d,l,g,k,n,g.leftSideImg,g.leftSideImageContainer,g.leftSideWidth,g.leftSideHeight)}else{h=true}}else{var j=$("#slider").val();var p=g.initialTranslateX*j;var a=parseFloat((g.scroller.position.x)+parseFloat(d));var c=(g.width*j)+p;if(a+5>=p&&a+5<=c){u.clipDoubleZoomed("left",d,l,g,k,n,g.leftSideImg,g.leftSideImageContainer,g.leftSideWidth,g.leftSideHeight,p,a)}else{if(!q){var o=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(o);o.show()}else{h=true}}}}if(q){if($("#slider").val()<=1){if((parseFloat(d)+5)>=t.left&&(parseFloat(d)+5)<=t.left+g.width){var b="double";if(g.config.leftPage.type=="sectionpage"){b="single"}u.clipSideDesktop(b,"right",d,l,g,k,n,g.rightSideImg,g.rightSideImageContainer,g.rightSideWidth,g.rightSideHeight)}else{if(!e){var o=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(o);o.show()}else{if(h){var o=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(o);o.show()}}}}else{var j=$("#slider").val();var s=(g.initialTranslateX+g.width)*j;var a=parseFloat((g.scroller.position.x)+parseFloat(d));var c=s+(g.width*j);if(a+5>=s&&a+5<=c){u.clipDoubleZoomed("right",d,l,g,k,n,g.rightSideImg,g.rightSideImageContainer,g.rightSideWidth,g.rightSideHeight,s,a)}else{if(!e){var o=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(o);o.show()}else{if(h){var o=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(o);o.show()}}}}}if(h&&!q){var o=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(o);o.show()}},clipSideDesktop:function(j,e,l,u,o,t,z,d,J,b,E){var K=this;var G=true;var m=$(d).offset();m.top=m.top;if(m.top<0){m.top=0}var v=40;var B=K.getReaderCarousel();if(B.getActiveItem().zoomMode=="fill"&&$("#slider").val()<=1){v=0}else{if(B.getActiveItem().zoomMode=="fit"&&$("#slider").val()<=1){v=0}else{v=40}}pageNo=flatPlanData.pageGroups[J.pageNo-1+pageOffset]!=null?flatPlanData.pageGroups[J.pageNo-1+pageOffset].pages[0].origPageNum:pageNo;var g=d.naturalWidth;var f=d.naturalHeight;if($("#slider").val()<=1){var I=g/b;var H=f/E;if(o.zoomMode=="fill"){if(o.scroller.position.y>0){if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar!="true"){v+=40}}else{v+=40}if(typeof isTribReader!="undefined"&&isTribReader){v+=20}}}var q=parseInt(((parseFloat(l)+5)-m.left+o.scroller.position.x)*I);var p=parseInt(((parseFloat(u)+5)-m.top+o.scroller.position.y-v)*H);var C=parseInt(($(t.element.dom).height()-10)*I);var r=parseInt(($(t.element.dom).width()-10)*H);if(j=="single"){if(q<0||q+r>b*I||p<0||p+C>E*H){G=false}}else{if(e=="left"){if(q<0||p<0||p+C>E*I){G=false}}else{if(q<0||p<0||p+C>E*I||q+r>b*I){G=false}}}}else{var s=$("#slider").val();if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){v-=40}}var n=0;if(typeof isTribReader!="undefined"&&isTribReader){v+=20;n+=150}var F=o.initialTranslateX*s+n;var c=parseFloat((o.scroller.position.x)+parseFloat(l));var k=F+(b*s);var I=g/(b*s);var H=f/(E*s);var a=parseFloat(o.scroller.position.y+parseFloat(u)-v);var D=E*s;var q=parseInt(((c+5)-F)*I);var p=parseInt(((a+5))*I);var C=parseInt(($(t.element.dom).height()-10)*I);var r=parseInt(($(t.element.dom).width()-10)*I);if(q<0||q+r>(b*s)*I||p<0||p+C>(E*s)*I){G=false}}if(G){K.getClipping(pageNo,q,p,C,r,g,f,z)}else{var A=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(A);A.show()}},clipDoubleZoomed:function(e,j,s,l,r,u,c,F,b,A,B,d){var G=this;var C=true;var H=flatPlanData.reversePageMapper[F.pageNo];var p=flatPlanData.pageGroups!=null&&flatPlanData.pageGroups[F.pageNo-1]!=null&&flatPlanData.pageGroups[F.pageNo-1].pages[0].advertsAdded!=null?flatPlanData.pageGroups[F.pageNo-1].pages[0].advertsAdded:0;H-=p;var q=$("#slider").val();var g=c.naturalWidth;var f=c.naturalHeight;var E=g/(b*q);var D=f/(A*q);var a=parseFloat(l.scroller.position.y+parseFloat(s));var t=40;if(settings.topbar.toggleTopBar!=null){if(settings.topbar.toggleTopBar=="true"){t-=40}}var k=0;if(typeof isTribReader!="undefined"&&isTribReader){t+=20;k+=150}var n=parseInt(((d+5)-B-k)*E);var m=parseInt(((a+5)-t)*E);var z=parseInt(($(r.element.dom).height()-10)*E);var o=parseInt(($(r.element.dom).width()-10)*E);if(e=="left"){if(n<0||m<0||m+z>(A*q)*E){C=false}}else{if(n<0||m<0||m+z>(A*q)*E||n+o>((b*q)*E)){C=false}}if(C){G.getClipping(H,n,m,z,o,g,f,u)}else{var v=Ext.create("InfinityMobile.view.clippingError");Ext.Viewport.add(v);v.show()}},getClipping:function(a,j,g,d,l,e,k,b){var f=this;var c="http://clippings.pagesuite.com";if(location.protocol=="https:"){c="https://integrations.pagesuite.com"}$.ajax({url:c+"/create_clipping.aspx?eid="+editionguid+"&pnum="+a+"&x="+j+"&y="+g+"&h="+d+"&w="+l+"&nw="+e+"&nh="+k,beforeSend:function(){Ext.Viewport.setMasked({xtype:"loadmask",zIndex:99999999,message:language.clippings.clippingSpinner})}}).done(function(h){Ext.Viewport.setMasked(false);console.log(h);if(h.Status=="success"){f.clippings[f.clippings.length]=h.Value!=null?h.Value.replace("http://media.cdn.pagesuite.com","https://media.pagesuite.com"):h.Value;f.shareClippings[f.shareClippings.length]=c+"/clipping.aspx?url="+encodeURIComponent(h.Value);f.clippingsWidth[f.clippingsWidth.length]=l;f.clippingsHeight[f.clippingsHeight.length]=d;b.selfDestruct();f.clippingMenu()}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:language.errorMsg})}})}},0,0,0,0,0,0,[InfinityMobile.controller,"ClippingController"],0));(Ext.cmd.derive("InfinityMobile.controller.ArticleController",Ext.app.Controller,{config:{refs:{articlereader:"articlereader",articlereaderitemlrg:"articlereaderitemlrg",articlereaderitemsmall:"articlereaderitemsmall",articlereaderitemmedwide:"articlereaderitemmedwide",articlereaderitemmedtall:"articlereaderitemmedtall",articlereaderitemmedwidetall:"articlereaderitemmedwidetall",articlereaderitemtopstories:"articlereaderitemtopstories",articleview:"articleview",articlereadersectionbtn:"articlereadersectionbtn",articlereaderlivenewsbtn:"articlereaderlivenewsbtn",articlereadertopbarbtn:"articlereadertopbarbtn",articlereadertoggleviewoptions:"articlereadertoggleviewoptions",articlereadermenu:"articlereadermenu",articlescontainer:"articlescontainer",reader:"infinitecarousel2d",articlescontainer:"articlescontainer",articlereaderpanelcontainer:"articlereaderpanelcontainer",howtoarticlescontainer:"howtoarticlescontainer",howtoreader:"howtoreader",livenewsticker:"livenewsticker",layoutview:"layoutview"},control:{articlereader:{initialized:"readerInitialize"},articlereaderitemlrg:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articlereaderitemsmall:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articlereaderitemmedwide:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articlereaderitemmedtall:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articlereaderitemmedwidetall:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},articleview:{initializeArticlePopover:"initializeArticlePopover"},articlereaderitemtopstories:{tileTapped:"tileTapped"},articlereadersectionbtn:{loadSection:"loadSection"},articlereaderlivenewsbtn:{liveNewsTiles:"liveNewsTiles"},articlereadertopbarbtn:{toolbarMenu:"toolbarMenu",toggleReaderOptions:"toggleReaderOptions"},articlereadertoggleviewoptions:{replicaPaperView:"replicaPaperView",dynamicView:"dynamicView"},articleview:{initializeLivePopover:"initializeLivePopover",liveNext:"liveNext",livePrevious:"livePrevious"},livenewsticker:{liveNewsTickerArticle:"liveNewsTickerArticle"},readerpageviewer:{resizeArticlesBrowser:"resizeArticlesBrowser"},infinitecarousel2d:{resizeDynamicArticles:"resizeDynamicArticles"},infinitecarousel:{resizeDynamicArticles:"resizeDynamicArticles"},articlescontainer:{expandArticles:"expandArticles"},articlereaderitemphone:{showArticlePopover:"showArticlePopover",tileTapped:"tileTapped",liveArticleClick:"liveArticleClick"},howtoarticlescontainer:{howToArticlesInit:"howToArticlesInit"},howtoreader:{howToReaderInit:"howToReaderInit"}}},init:function(){var b=this;articleMode="dynamic";var c=Ext.getStore("ArticleStore");c.on({load:"setArticles",scope:this});var a=Ext.getStore("SettingStore");a.on({load:"setSections",scope:this});b.loaded=false},setSections:function(a){var b=this;b.settings=a.data.items[0].raw;b.sections=[];if(a.data.items[0].raw.bookmarks!=null){b.sections=a.data.items[0].raw.bookmarks.bookmark;b.sortSections()}},sortSections:function(){var d=this;var b;for(var c=0;c<d.sections.length;c++){var e=d.sections[c];for(var a=0;a<d.sections.length;a++){if(parseFloat(e.pageNumber)<parseFloat(d.sections[a].pageNumber)){b=d.sections[c];d.sections[c]=d.sections[a];d.sections[a]=b}}}},setArticles:function(a){var b=this;b.setArticleStoreDictionary(a);b.articles=[];b.mediaStore=Ext.getStore("MediaStore");b.mediaStore.on({load:function(z){var e=true;if(settings.newsday!=null){e=false}if(e){var o=z.data.items[0].raw.media.article;var w="";var h=0;for(var A=0;A<o.length;A++){for(var q=0;q<a.data.items[0].raw.articles.length;q++){if(o[A].file==a.data.items[0].raw.articles[q].guid){var m=JSON.parse(JSON.stringify(a.data.items[0].raw.articles[q]));var t=true;for(var p=0;p<b.articles.length;p++){if(b.articles[p].guid==m.guid){h++;t=false;break}}if(t){m.config={};m.config.articleIndex=o[A].uniquearticleindex;var s=/<p[^>]*>/g;var v="";var C=[];while((match1=s.exec(m.body))!=null){C[C.length]=match1.index}s=/<\/p/g;var c=[];while((match=s.exec(m.body))!=null){c[c.length]=match.index}s=/<p[^>]*>/g;for(var A=0;A<C.length;A++){var v=m.body.substring(C[A],c[A]).replace(s,"");if(v.length>0){m.shortStory=v;break}else{var r=/\n|([^\r\n.!?]+([.!?]+|$))/gim;var j=[];while((match2=r.exec(m.body))!=null){if(j.length<2){j[j.length]=match2.index}else{break}}if(j[1]>0){m.shortStory=m.body.substring(0,j[1])}else{m.shortStory=""}}}if(m.shortStory==null){var r=/\n|([^\r\n.!?]+([.!?]+|$))/gim;var j=[];while((match2=r.exec(m.body))!=null){if(j.length<2){j[j.length]=match2.index}else{break}}if(j[1]>0){m.shortStory=m.body.substring(0,j[1])}else{m.shortStory=""}}b.articles.push(m);w=m.guid;break}}}}for(var q=0;q<b.articles.length;q++){var g=/style=["'][^\"]*["']/g;var d=b.articles[q].body.match(g);if(d!=null){for(var A=0;A<d.length;A++){if(d[A].indexOf("font-size")!=-1){var l=d[A].indexOf("font-size");var f=0;for(var p=l;p<d[A].length;p++){if(d[A][p]==";"){f=p;break}}}var B=d[A].substring(0,l)+d[A].substring(f,d[A].length);b.articles[q].body=b.articles[q].body.replace(d[A],B);d[A]=B;if(d[A].indexOf("line-height")!=-1){var n=d[A].indexOf("line-height");var D=0;for(var p=n;p<d[A].length;p++){if(d[A][p]==";"){D=p;break}}}var u=d[A].substring(0,n)+d[A].substring(D,d[A].length);b.articles[q].body=b.articles[q].body.replace(d[A],u)}}var k=/<p/g;while((pTagMatch=k.exec(b.articles[q].body))!=null){var l=pTagMatch.index;b.articles[q].body=b.articles[q].body.substring(0,l)+"<p class='articleText' "+b.articles[q].body.substring(l+2,b.articles[q].body.length)}}try{if(localStorage.getItem("bodyFontSize"+publicationguid)==null){localStorage.setItem("bodyFontSize"+publicationguid,"16")}}catch(E){}try{if(localStorage.getItem("headlineFontSize"+publicationguid)==null){localStorage.setItem("headlineFontSize"+publicationguid,"32")}}catch(E){}try{if(localStorage.getItem("subheadlineFontSize"+publicationguid)==null){localStorage.setItem("subheadlineFontSize"+publicationguid,"20")}}catch(E){}try{if(localStorage.getItem("bylineFontSize"+publicationguid)==null){localStorage.setItem("bylineFontSize"+publicationguid,"18")}}catch(E){}try{if(localStorage.getItem("sectionFontSize"+publicationguid)==null){localStorage.setItem("sectionFontSize"+publicationguid,"18")}}catch(E){}}}})},setArticleStoreDictionary:function(b){var d=this;b.allArticles={};var a=b.data.items[0].raw.articles;for(var c=0;c<a.length;c++){var e=a[c];b.allArticles[e.guid]=e}},getArticles:function(){var a=this;return a.articles},getSectionsWithArticles:function(){var c=this;var d=0;for(var b=0;b<c.sections.length;b++){for(var a=0;a<c.articles.length;a++){if(c.sections[b+1]!=null){if(parseFloat(c.sections[b].pageNumber)<=parseFloat(c.articles[a].pageNumber)&&parseFloat(c.sections[b+1].pageNumber)>parseFloat(c.articles[a].pageNumber)){d++;break}}else{if(parseFloat(c.sections[b].pageNumber)<=parseFloat(c.articles[a].pageNumber)){d++;break}}}}return d},findArticle:function(a){var c=this;for(var b=0;b<c.articles.length;b++){if(a==c.articles[b].guid){return c.articles[b];break}}return null},readerInitialize:function(c,b){var a=this;if(Ext.os.is.Phone){a.articleReaderLoadPhone(c,b)}else{a.articleReaderLoad(c,b)}},articleReaderLoadPhone:function(k,m){var y=this;articleMode="dynamic";if(y.getArticlescontainer()!=null){y.getArticlescontainer().destroy()}k.content.removeAll();var s=k.content;var w;var d=true;if(m!=1){var q=Ext.create("InfinityMobile.view.ArticleReaderTopBarBtn",{imageUrl:"../assets/dynamicarticles/dynamic-mode-ic-white@2x.png",left:0,width:60,height:25,top:8,type:"btn",action:"toggleReaderOptions",tooltipText:"Toggle View"});var c=Ext.create("InfinityMobile.view.ArticleReaderTopBarBtn",{imageUrl:y.settings.topbar.logo,left:60,width:120,height:32,top:4,type:"logo"});k.toolBar.add(c);k.toolBar.add(q);y.loadSectionButtons(k)}for(var o=0;o<y.articles.length;o++){y.articles[o].sections=[];for(var t=0;t<y.sections.length;t++){if(y.articles[o].pageNumber>=y.sections[t].page){y.articles[o].sections[0]=y.sections[t].name.toUpperCase()}}}if(y.sections[0]!=null){y.firstSection=y.sections[0].name.toUpperCase();y.loadSection(y.sections[0].name.toUpperCase());setTimeout(function(){k.loadReaderPhone()},800)}else{y.firstSection=language.dynamicArticles.all;var d=true;var s=y.articleReader.content;var w;var r;var t=0;if(y.settings.dynamic.weather==null){}else{if(y.settings.dynamic.weather.url.length>0){var l=Ext.create("InfinityMobile.view.phone.ArticleReaderItemTopStories",{expandAnim:"expandTopStory 0.2s forwards",shrinkAnim:"shrinkTopStory 0.2s ease-out",articles:[]});y.articleReader.content.add(l)}}var a=y.articles;while(t<a.length){if(d){r=Ext.create("InfinityMobile.view.phone.ArticleReaderPanelContainer");var w=Ext.create("InfinityMobile.view.phone.ArticleReaderItemContainer");if(a.length>(t)){var v=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[t],articleIndex:t});w.add(v)}if(a.length>(t+1)){var p=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:50%;",article:a[t+1],articleIndex:t+1});w.add(p)}if(a.length>(t+2)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:0px;",article:a[t+2],articleIndex:t+2});w.add(n)}if(a.length>(t+3)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:50%;",article:a[t+3],articleIndex:t+3});w.add(n)}if(a.length>(t+4)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:0px;",article:a[t+4],articleIndex:t+4});w.add(n)}if(a.length>(t+5)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:50%;",article:a[t+5],articleIndex:t+5});w.add(n)}t+=6;if(t<a.length){d=false;r.add(w);if(y.settings.dynamic.adverts!=null){if(y.settings.dynamic.adverts.bannerAd!=null){var b=Ext.create("InfinityMobile.view.phone.ArticleReaderBannerAd",{style:"height:200px;width:100%;"});r.add(b)}}}else{r.add(w);var f=w.items.length;if(f%2==1){f+=1}var u=f*100;r.element.dom.style.height=u+"px"}}else{var w=Ext.create("InfinityMobile.view.phone.ArticleReaderItemContainer");if(a.length>(t)){var v=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[t],articleIndex:t});w.add(v)}if(a.length>(t+1)){var p=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:50%;",article:a[t+1],articleIndex:t+1});w.add(p)}if(a.length>(t+2)){var n=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:0px;",article:a[t+2],articleIndex:t+2});w.add(n)}if(a.length>(t+3)){var j=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:50%;",article:a[t+3],articleIndex:t+3});w.add(j)}if(a.length>(t+4)){var g=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:0px;",article:a[t+4],articleIndex:t+4});w.add(g)}if(a.length>(t+5)){var e=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:50%;",article:a[t+5],articleIndex:t+5});w.add(e)}t+=6;d=true;r.add(w);if(t>=a.length){var f=w.items.length;if(f%2==1){f+=1}var u=f*100;if(y.settings.dynamic.adverts!=null){if(y.settings.dynamic.adverts.bannerAd!=null){u+=650}else{u+=600}}else{u+=600}r.element.dom.style.height=u+"px"}}if(d){y.articleReader.content.add(r);if(y.articleReader.content.getScrollable()!=null){y.articleReader.content.getScrollable().getScroller().scrollTo(0,0)}else{y.articleReader.scollDesktop.scrollLeft=0}}}}},articleReaderLoad:function(g,m){var E=this;articleMode="dynamic";if(E.getArticlescontainer()!=null){E.getArticlescontainer().destroy()}g.content.removeAll();var w=true;var v=g.content;var C;if(m!=1){var s=Ext.create("InfinityMobile.view.ArticleReaderTopBarBtn",{imageUrl:"../assets/dynamicarticles/dynamic-mode-ic-white@2x.png",left:0,width:60,height:25,top:8,type:"btn",action:"toggleReaderOptions",tooltipText:"Toggle View"});var c=Ext.create("InfinityMobile.view.ArticleReaderTopBarBtn",{imageUrl:E.settings.topbar.logo,left:60,width:120,height:32,top:4,type:"logo"});g.toolBar.add(c);g.toolBar.add(s);E.loadLiveNews(g);E.loadSectionButtons(g)}for(var o=0;o<E.articles.length;o++){E.articles[o].sections=[];for(var A=0;A<E.sections.length;A++){if(E.articles[o].pageNumber>=E.sections[A].page){E.articles[o].sections[0]=E.sections[A].name.toUpperCase()}}}if($(document).height()>768&&(Ext.os.is.Desktop||currentProfile=="largetablet")){E.tileMode="large";E.currentSection=language.dynamicArticles.all;var t;var A=0;while(A<E.articles.length){if(Ext.os.is.Desktop||Ext.os.is.Tablet){if(w){t=Ext.create("InfinityMobile.view.desktop.ArticleReaderPanelContainer");C=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(E.articles.length>(A)){if(A!=0||(E.getSectionsWithArticles()<2&&E.settings.dynamic.weather==null)){var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemLrg",{expandAnim:"expandTopStory 0.2s ease-in",shrinkAnim:"shrinkTopStory 0.2s ease-out",style:"position:absolute;top:0px;left;0px;",article:E.articles[A],articleIndex:A});C.add(k)}else{if(E.getSectionsWithArticles()<2&&(E.settings.dynamic.weather==null||E.settings.dynamic.weather.url.length==0)){var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemLrg",{expandAnim:"expandTopStory 0.2s ease-in",shrinkAnim:"shrinkTopStory 0.2s ease-out",style:"position:absolute;top:0px;left;0px;",article:E.articles[A],articleIndex:A});C.add(k)}else{var b=[];A-=1;for(var o=0;o<E.sections.length;o++){for(var l=0;l<E.articles.length;l++){if(E.sections[o].pageNumber<=E.articles[l].pageNumber){b[b.length]=E.articles[l];break}}}if(b.length==0){b[0]=E.articles[0];A+=1}var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemTopStories",{expandAnim:"expandTopStory 0.2s forwards",shrinkAnim:"shrinkTopStory 0.2s ease-out",style:"position:absolute;top:0px;left;0px;",articles:b});C.add(k)}}}if(E.articles.length>(A+1)){if(E.settings.dynamic.adverts!=null){if(E.settings.dynamic.adverts.bannerAd!=null){var p=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:E.articles[A+1],articleIndex:A+1})}else{var p=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:E.articles[A+1],articleIndex:A+1})}C.add(p)}else{var p=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:E.articles[A+1],articleIndex:A+1});C.add(p)}}if(E.articles.length>(A+2)){if(E.settings.dynamic.adverts!=null){if(E.settings.dynamic.adverts.bannerAd!=null){var n=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col2LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:E.articles[A+2],articleIndex:A+2})}else{var n=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col2LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:E.articles[A+2],articleIndex:A+2})}C.add(n)}else{var n=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col2LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:E.articles[A+2],articleIndex:A+2});C.add(n)}}if(E.articles.length>(A+3)){if(E.settings.dynamic.adverts!=null){if(E.settings.dynamic.adverts.bannerAd!=null){var j=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col3LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:E.articles[A+3],articleIndex:A+3})}else{var j=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col3LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:E.articles[A+3],articleIndex:A+3})}C.add(j)}else{var j=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col3LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:E.articles[A+3],articleIndex:A+3});C.add(j)}}if(E.articles.length>=(A+4)){if(E.settings.dynamic.adverts!=null){if(E.settings.dynamic.adverts.bannerAd!=null){var a=Ext.create("InfinityMobile.view.desktop.ArticleReaderBannerAd",{style:"position:absolute;top:90%;height:100%;width:100%;",height:"15%",settings:E.settings.dynamic.adverts.bannerAd});C.add(a)}}}A+=4;if(A<E.articles.length){w=false;t.add(C)}else{t.add(C);$(t.element.dom).css("width","768px")}}else{C=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(E.articles.length>A){var r=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow1Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow1Col1Right 0.2s ease-out",style:"position:absolute;top:0px;left:0px;",article:E.articles[A],articleIndex:A});C.add(r)}if(E.articles.length>(A+1)){var p=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedWide",{expandAnim:"expandRow1Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow1Col2Right 0.2s ease-out",style:"position:absolute;top:0px;left:256px;",article:E.articles[A+1],articleIndex:A+1});C.add(p)}if(E.articles.length>(A+2)){var n=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col1Right 0.2s ease-out",style:"position:absolute;top:30%;left:0px;",article:E.articles[A+2],articleIndex:A+2});C.add(n)}if(E.articles.length>(A+3)){var j=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col2Right 0.2s ease-out",style:"position:absolute;top:30%;left:256px;",article:E.articles[A+3],articleIndex:A+3});C.add(j)}if(E.articles.length>(A+4)){var f=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col3Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col3Right 0.2s ease-out",style:"position:absolute;top:30%;left:512px;",article:E.articles[A+4],articleIndex:A+4});C.add(f)}if(E.articles.length>(A+5)){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow3Col1Right 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:E.articles[A+5],articleIndex:A+5});C.add(e)}if(E.articles.length>(A+6)){var d=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedWideTall",{expandAnim:"expandRow3Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow3Col2Right 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:E.articles[A+6],articleIndex:A+6});C.add(d)}t.add(C);A+=7;w=true}}if(w){var u;var z;var D;if(E.settings.dynamic.adverts!=null){if(E.settings.dynamic.adverts.interstitial!=null&&A<E.articles.length){var B=$(document).height()-120;var q=B*0.8;var u=((q*0.3)*2)+(q*0.45)-10;z=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitialContainer");D=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitial",{adHeight:u,settings:E.settings.dynamic.adverts.interstitial})}}g.content.add(t);if(D!=null&&z!=null){z.add(D);g.content.add(z)}}else{}}}else{E.tileMode="small";E.currentSection=language.dynamicArticles.all;E.buildTilesSmall(E.articles,language.dynamicArticles.all)}if(Ext.os.is.Desktop){if(Ext.browser.is.IE){setTimeout(function(){var h=0;var x=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(t in x){h+=$(x[t].element.dom).width()+10}var y=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(interstitial in y){h+=$(y[interstitial].element.dom).width()+5}if(settings.dynamic.rss==null){E.articleReader.content.element.down(".x-container").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}else{E.articleReader.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}},100)}E.dynamicKeyControls(g)}},dynamicKeyControls:function(b){var a=this;window.onkeydown=function(c){if(currentProfile=="desktop"&&!Ext.browser.is.IE){if(c.keyCode==39){if(b.scrollDesktop.scrollLeft+120<b.scrollDesktop.scrollWidth){b.scrollDesktop.scrollLeft=b.scrollDesktop.scrollLeft+120}else{b.scrollDesktop.scrollLeft=b.scrollDesktop.scrollWidth}}else{if(c.keyCode==37){if(b.scrollDesktop.scrollLeft-120>0){b.scrollDesktop.scrollLeft=b.scrollDesktop.scrollLeft-120}else{b.scrollDesktop.scrollLeft=0}}}}else{if(c.keyCode==39){if(b.content.getScrollable().getScroller().position.x+120<b.content.getScrollable().getScroller().maxPosition.x){b.content.getScrollable().getScroller().scrollTo(b.content.getScrollable().getScroller().position.x+120)}else{b.content.getScrollable().getScroller().scrollTo(b.content.getScrollable().getScroller().maxPosition.x)}}else{if(c.keyCode==37){if(b.content.getScrollable().getScroller().position.x-120>0){b.content.getScrollable().getScroller().scrollTo(b.content.getScrollable().getScroller().position.x-120)}else{b.content.getScrollable().getScroller().scrollTo(0)}}}}};window.onkeyup=""},loadLiveNews:function(e){var c=this;if(c.settings.dynamic.rss!=null){if(c.settings.dynamic.rss.url!=null){if(c.settings.dynamic.rss.url.length>0){var a=Ext.create("Ext.Container",{docked:"top",height:40,width:"100%",style:"background-color:#EEEEEE;"});var b=Ext.create("Ext.Container",{left:0,top:0,height:40,padding:"0 10",style:"background-color:#B4272C;text-align:center;color:white;",html:'<p  style="position:relative;top:20px;transform:translateY(-50%);-ms-transform:translateY(-50%);-moz-transform:translateY(-50%);-webkit-transform:translateY(-50%);font-family:Open Sans, sans-serif;font-size:14px;font-weight:bold;">'+language.dynamicArticles.liveNews+"</p>"});var d=Ext.create("InfinityMobile.view.liveNewsTicker",{url:c.settings.dynamic.rss.url});a.add(b);a.add(d);e.content.add(a)}}}},loadSectionButtons:function(k){var m=this;m.articleReader=k;if(!m.loaded){var j=this;var p=Ext.create("Ext.Container",{docked:"top",height:40,padding:5,width:"100%",style:"border-bottom: 1px solid #929292;text-align:center;"});if(Ext.os.is.Desktop){var a=Ext.create("Ext.Container",{height:40,scrollable:{direction:"horizontal",indicators:false,directionLock:true},layout:{type:"hbox",pack:"middle"}})}else{if(Ext.os.is.Tablet||Ext.os.is.Phone){var a=Ext.create("Ext.Container",{scrollable:{direction:"horizontal",indicators:false,directionLock:true},height:40,layout:{type:"hbox"}})}}m.buttons=[];if(settings.dynamic.rss!=null){if(settings.dynamic.rss.url!=null){if(settings.dynamic.rss.url.length>0){var f=Ext.create("InfinityMobile.view.ArticleReaderLiveNewsBtn",{width:120,height:40,section:language.dynamicArticles.liveNews});if(a!=null){a.add(f);m.buttons[m.buttons.length]=f}}}}if(!Ext.os.is.phone){var g=Ext.create("InfinityMobile.view.ArticleReaderSectionBtn",{section:language.dynamicArticles.all,width:60,height:40});a.add(g);m.buttons[m.buttons.length]=g}else{if(m.sections.length==0){var g=Ext.create("InfinityMobile.view.ArticleReaderSectionBtn",{section:language.dynamicArticles.all,width:60,height:40});a.add(g);m.buttons[m.buttons.length]=g}}for(var h=0;h<m.sections.length;h++){var n=false;for(var o=0;o<m.articles.length;o++){if(m.sections[h+1]!=null){if(parseFloat(m.sections[h].pageNumber)<=parseFloat(m.articles[o].pageNumber)&&parseFloat(m.sections[h+1].pageNumber)>parseFloat(m.articles[o].pageNumber)){n=true;break}}else{if(parseFloat(m.sections[h].pageNumber)<=parseFloat(m.articles[o].pageNumber)){n=true;break}}}if(m.sections[h].name.length==0){n=false}if(n){var e=document.createElement("canvas");var l=e.getContext("2d");l.font="14px Arial";var b=l.measureText(m.sections[h].name.toUpperCase()).width*1.2;var d=Ext.create("InfinityMobile.view.ArticleReaderSectionBtn",{section:m.sections[h].name.toUpperCase(),width:b,height:40});a.add(d);m.buttons[m.buttons.length]=d}}p.add(a);k.content.add(p);m.loaded=true}},liveNewsTiles:function(){var a=this;if(a.settings.dynamic.rss!=null){if(a.settings.dynamic.rss.url!=null){a.currentSection=language.dynamicArticles.liveNews;$.ajax({url:"../../rssWrapper.aspx?base64url="+encodeURIComponent(btoa(a.settings.dynamic.rss.url)),dataType:"json",success:function(d){if(d.feed&&d.feed.entries){var c=[];$.each(d.feed.entries,function(f,g){c.push(g)});a.articleReader.content.removeAll();for(var b=0;b<a.buttons.length;b++){if(a.buttons[b].section==language.dynamicArticles.liveNews){a.buttons[b].element.down("span").dom.style.color="#b22930"}else{a.buttons[b].element.dom.style.color="#929292"}}if(Ext.os.is.Phone){a.buildTiles(c,language.dynamicArticles.liveNews)}else{if($(document).height()>768&&(Ext.os.is.Desktop||currentProfile=="largetablet")){a.buildTiles(c,language.dynamicArticles.liveNews)}else{a.buildTilesSmall(c,language.dynamicArticles.liveNews)}}}}})}}},buildTilesSmall:function(a,d){var t=this;if(d==language.dynamicArticles.liveNews){var g={};for(var o=0;o<a.length;o++){a[o].sections=[];a[o].sections[0]=d;a[o].headline=a[o].title;a[o].body=a[o].content;a[o].subHeadline="";a[o].byline=a[o].author;if(a[o].images!=null){}else{if(a[o].mediaGroups!=null){if(a[o].mediaGroups[0].contents!=null){if(a[o].mediaGroups[0].contents[0].thumbnails!=null){var e=[{url:a[o].mediaGroups[0].contents[0].thumbnails[0].url}];a[o].images=e;a[o].images[0].url="image_resize.aspx?w=700&url="+a[o].images[0].url}else{if(a[o].mediaGroups[0].contents[0].url!=null){var e=[{url:a[o].mediaGroups[0].contents[0].url}];a[o].images=e;a[o].images[0].url="image_resize.aspx?w=700&url="+a[o].images[0].url}else{a[o].images=[]}}}else{a[o].images=[]}}else{a[o].images=[]}}a[o].live=true;a[o].url=a[o].link;a[o].config={};a[o].config.articleIndex=o}t.liveArticles=a}var m=true;var l=t.articleReader.content;var r;var j;var o=0;while(o<a.length){if(Ext.os.is.Desktop||Ext.os.is.Tablet){if(m){j=Ext.create("InfinityMobile.view.desktop.ArticleReaderPanelContainer");r=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(settings.dynamic.weather!=null&&o==0&&d==language.dynamicArticles.all){if(settings.dynamic.weather.url!=null){if(settings.dynamic.weather.url.length>0){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWeatherContainer",{expandAnim:"expandSmallViewTopLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopLeft 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",weather:settings.dynamic.weather.url});r.add(q);o--}else{if(a.length>o){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWide",{expandAnim:"expandSmallViewTopLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopLeft 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[o],articleIndex:o,bannerAdCheck:"true"});r.add(q)}}}else{if(a.length>o){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWide",{expandAnim:"expandSmallViewTopLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopLeft 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[o],articleIndex:o,bannerAdCheck:"true"});r.add(q)}}}else{if(a.length>o){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWide",{expandAnim:"expandSmallViewTopLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopLeft 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[o],articleIndex:o,bannerAdCheck:"true"});r.add(q)}}if(a.length>(o+1)){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewTopRight 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopRight 0.2s ease-out",style:"position:absolute;top:0%;left:512px;",article:a[o+1],articleIndex:o+1,bannerAdCheck:"true"});r.add(q)}var c=true;if(settings.dynamic.adverts!=null){if(settings.dynamic.adverts.bannerAd!=null){var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderBannerAd",{style:"position:absolute;top:72.5%;height:100%;width:100%;",height:"32.5%",settings:settings.dynamic.adverts.bannerAd});r.add(b);c=false;o-=2}}if(c){if(a.length>(o+2)){if(a[o+2]!=null){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileMed",{expandAnim:"expandSmallViewBottomLeft 0.2s ease-in",shrinkAnim:"shrinkSmallViewBottomLeft 0.2s ease-out",style:"position:absolute;top:52.5%;left:0px;",article:a[o+2],articleIndex:o+2});r.add(q)}}if(a.length>(o+3)){if(a[o+3]!=null){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileMed",{expandAnim:"expandSmallViewBottomRight 0.2s ease-in",shrinkAnim:"shrinkSmallViewBottomRight 0.2s ease-out",style:"position:absolute;top:52.5%;left:384px;",article:a[o+3],articleIndex:o+3});r.add(q)}}}o+=4;if(o<a.length){m=false;j.add(r)}else{j.add(r);$(j.element.dom).css("width","768px")}}else{r=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(a.length>o){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewTop1 0.2s ease-in",shrinkAnim:"shrinkSmallViewTop1 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[o],articleIndex:o});r.add(q)}if(a.length>o+1){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewTop2 0.2s ease-in",shrinkAnim:"shrinkSmallViewTop2 0.2s ease-out",style:"position:absolute;top:0%;left:256px;",article:a[o+1],articleIndex:o+1});r.add(q)}if(a.length>o+2){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewTopRight 0.2s ease-in",shrinkAnim:"shrinkSmallViewTopRight 0.2s ease-out",style:"position:absolute;top:0%;left:512px;",article:a[o+2],articleIndex:o+2});r.add(q)}if(a.length>o+3){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileSmall",{expandAnim:"expandSmallViewBottom1 0.2s ease-in",shrinkAnim:"shrinkSmallViewBottom1 0.2s ease-out",style:"position:absolute;top:52.5%;left:0px;",article:a[o+3],articleIndex:o+3});r.add(q)}if(a.length>o+4){var q=Ext.create("InfinityMobile.view.desktop.SmallViewTileWide",{expandAnim:"expandSmallViewBottom2 0.2s ease-in",shrinkAnim:"shrinkSmallViewBottom2 0.2s ease-out",style:"position:absolute;top:52.5%;left:256px;",article:a[o+4],articleIndex:o+4});r.add(q)}j.add(r);o+=5;m=true}}if(m){var n;var s;if(t.settings.dynamic.adverts!=null){if(t.settings.dynamic.adverts.interstitial!=null&&o<a.length){var p=$(document).height()-120;var f=p*0.8;var k=((f*0.3)*2)+(f*0.45)-10;n=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitialContainer");s=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitial",{adHeight:k,settings:t.settings.dynamic.adverts.interstitial})}}t.articleReader.content.add(j);if(s!=null&&n!=null){n.add(s);t.articleReader.content.add(n)}}else{}if(currentProfile=="desktop"){if(Ext.browser.is.IE){setTimeout(function(){var h=0;var u=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(j in u){h+=$(u[j].element.dom).width()+10}var v=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(interstitial in v){h+=$(v[interstitial].element.dom).width()+5}if(settings.dynamic.rss==null){t.articleReader.content.element.down(".x-container").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}else{t.articleReader.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}},100)}if(t.articleReader.scrollDesktop!=null){t.articleReader.scrollDesktop.scrollLeft=0}}else{if(t.articleReader.content.getScrollable()!=null){t.articleReader.content.getScrollable().getScroller().scrollTo(0)}}}},buildTilesPhone:function(a,d){var v=this;if(d==language.dynamicArticles.liveNews){var o={};for(var r=0;r<a.length;r++){a[r].sections=[];a[r].sections[0]=d;a[r].headline=a[r].title;a[r].body=a[r].content;a[r].subHeadline="";a[r].byline=a[r].author;if(a[r].images!=null){}else{if(a[r].mediaGroups!=null){if(a[r].mediaGroups[0].contents!=null){if(a[r].mediaGroups[0].contents[0].thumbnails!=null){var n=[{url:a[r].mediaGroups[0].contents[0].thumbnails[0].url}];a[r].images=n;a[r].images[0].url="image_resize.aspx?w=700&url="+a[r].images[0].url}else{if(a[r].mediaGroups[0].contents[0].url!=null){var n=[{url:a[r].mediaGroups[0].contents[0].url}];a[r].images=n;a[r].images[0].url="image_resize.aspx?w=700&url="+a[r].images[0].url}else{a[r].images=[]}}}else{a[r].images=[]}}else{a[r].images=[]}}a[r].live=true;a[r].url=a[r].link;a[r].config={};a[r].config.articleIndex=r}v.liveArticles=a}if(v.firstSection==d){if(v.settings.dynamic.weather==null){}else{var k=Ext.create("InfinityMobile.view.phone.ArticleReaderItemTopStories",{expandAnim:"expandTopStory 0.2s forwards",shrinkAnim:"shrinkTopStory 0.2s ease-out",articles:[]});v.articleReader.content.add(k)}}var c=true;var q=v.articleReader.content;var u;var p;var r=0;while(r<a.length){if(c){p=Ext.create("InfinityMobile.view.phone.ArticleReaderPanelContainer");var u=Ext.create("InfinityMobile.view.phone.ArticleReaderItemContainer");if(a.length>(r)){var t=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[r],articleIndex:r});u.add(t)}if(a.length>(r+1)){var m=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:50%;",article:a[r+1],articleIndex:r+1});u.add(m)}if(a.length>(r+2)){var l=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:0px;",article:a[r+2],articleIndex:r+2});u.add(l)}if(a.length>(r+3)){var l=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:50%;",article:a[r+3],articleIndex:r+3});u.add(l)}if(a.length>(r+4)){var l=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:0px;",article:a[r+4],articleIndex:r+4});u.add(l)}if(a.length>(r+5)){var l=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:50%;",article:a[r+5],articleIndex:r+5});u.add(l)}r+=6;if(r<a.length){c=false;p.add(u);if(v.settings.dynamic.adverts!=null){if(v.settings.dynamic.adverts.bannerAd!=null){var b=Ext.create("InfinityMobile.view.phone.ArticleReaderBannerAd",{style:"height:200px;width:100%;"});p.add(b)}}}else{p.add(u);var f=u.items.length;if(f%2==1){f+=1}var s=f*100;p.element.dom.style.height=s+"px"}}else{var u=Ext.create("InfinityMobile.view.phone.ArticleReaderItemContainer");if(a.length>(r)){var t=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:0px;",article:a[r],articleIndex:r});u.add(t)}if(a.length>(r+1)){var m=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:0%;left:50%;",article:a[r+1],articleIndex:r+1});u.add(m)}if(a.length>(r+2)){var l=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:0px;",article:a[r+2],articleIndex:r+2});u.add(l)}if(a.length>(r+3)){var j=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:200px;left:50%;",article:a[r+3],articleIndex:r+3});u.add(j)}if(a.length>(r+4)){var g=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:0px;",article:a[r+4],articleIndex:r+4});u.add(g)}if(a.length>(r+5)){var e=Ext.create("InfinityMobile.view.phone.ArticleReaderItemPhone",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:400px;left:50%;",article:a[r+5],articleIndex:r+5});u.add(e)}r+=6;c=true;p.add(u);if(r>=a.length){var f=u.items.length;if(f%2==1){f+=1}var s=f*100;if(v.settings.dynamic.adverts!=null){if(v.settings.dynamic.adverts.bannerAd!=null){s+=650}else{s+=600}}else{s+=600}p.element.dom.style.height=s+"px"}}if(c){v.articleReader.content.add(p);v.articleReader.content.getScrollable().getScroller().scrollTo(0,0)}}setTimeout(function(){v.articleReader.loadReaderPhone()},200)},buildTiles:function(a,d){var z=this;if(d==language.dynamicArticles.liveNews){var p={};for(var v=0;v<a.length;v++){a[v].sections=[];a[v].sections[0]=d;a[v].headline=a[v].title;a[v].body=a[v].content;a[v].subHeadline="";a[v].byline=a[v].author;if(a[v].images!=null){}else{if(a[v].mediaGroups!=null){if(a[v].mediaGroups[0].contents!=null){if(a[v].mediaGroups[0].contents[0].thumbnails!=null){var n=[{url:a[v].mediaGroups[0].contents[0].thumbnails[0].url}];a[v].images=n;a[v].images[0].url="image_resize.aspx?w=700&url="+a[v].images[0].url}else{if(a[v].mediaGroups[0].contents[0].url!=null){var n=[{url:a[v].mediaGroups[0].contents[0].url}];a[v].images=n;a[v].images[0].url="image_resize.aspx?w=700&url="+a[v].images[0].url}else{a[v].images=[]}}}else{a[v].images=[]}}else{a[v].images=[]}}a[v].live=true;a[v].url=a[v].link;a[v].config={};a[v].config.articleIndex=v}z.liveArticles=a}var t=true;var s=z.articleReader.content;var x;var q;var v=0;while(v<a.length){if(Ext.os.is.Desktop||Ext.os.is.Tablet){if(t){q=Ext.create("InfinityMobile.view.desktop.ArticleReaderPanelContainer");x=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(a.length>(v)){var j=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemLrg",{expandAnim:"expandTopStory 0.2s ease-in",shrinkAnim:"shrinkTopStory 0.2s ease-out",style:"position:absolute;top:0px;left;0px;",article:a[v],articleIndex:v});x.add(j)}if(a.length>(v+1)){if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.bannerAd!=null){var l=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col1LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:a[v+1],articleIndex:v+1})}else{var l=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:a[v+1],articleIndex:v+1})}x.add(l)}else{var l=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col1LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:a[v+1],articleIndex:v+1});x.add(l)}}if(a.length>(v+2)){if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.bannerAd!=null){var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col2LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:a[v+2],articleIndex:v+2})}else{var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col2LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:a[v+2],articleIndex:v+2})}x.add(k)}else{var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col2LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col2LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:a[v+2],articleIndex:v+2});x.add(k)}}if(a.length>(v+3)){if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.bannerAd!=null){var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow3Col3LeftSmall 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftSmall 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:a[v+3],articleIndex:v+3})}else{var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col3LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:a[v+3],articleIndex:v+3})}x.add(g)}else{var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col3LeftMed 0.2s ease-in",shrinkAnim:"shrinkRow3Col3LeftMed 0.2s ease-out",style:"position:absolute;top:60%;left:512px;",article:a[v+3],articleIndex:v+3});x.add(g)}}if(a.length>(v+4)){if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.bannerAd!=null){var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderBannerAd",{height:"15%",style:"position:absolute;top:90%;height:100%;width:100%;",settings:z.settings.dynamic.adverts.bannerAd});x.add(b)}}}v+=4;if(v<a.length){t=false;q.add(x)}else{q.add(x);$(q.element.dom).css("width","768px")}}else{x=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemContainer");if(a.length>v){var o=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow1Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow1Col1Right 0.2s ease-out",style:"position:absolute;top:0px;left:0px;",article:a[v],articleIndex:v});x.add(o)}if(a.length>(v+1)){var l=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedWide",{expandAnim:"expandRow1Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow1Col2Right 0.2s ease-out",style:"position:absolute;top:0px;left:256px;",article:a[v+1],articleIndex:v+1});x.add(l)}if(a.length>(v+2)){var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col1Right 0.2s ease-out",style:"position:absolute;top:30%;left:0px;",article:a[v+2],articleIndex:v+2});x.add(k)}if(a.length>(v+3)){var g=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col2Right 0.2s ease-out",style:"position:absolute;top:30%;left:256px;",article:a[v+3],articleIndex:v+3});x.add(g)}if(a.length>(v+4)){var f=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemSmall",{expandAnim:"expandRow2Col3Right 0.2s ease-in",shrinkAnim:"shrinkRow2Col3Right 0.2s ease-out",style:"position:absolute;top:30%;left:512px;",article:a[v+4],articleIndex:v+4});x.add(f)}if(a.length>(v+5)){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedTall",{expandAnim:"expandRow3Col1Right 0.2s ease-in",shrinkAnim:"shrinkRow3Col1Right 0.2s ease-out",style:"position:absolute;top:60%;left:0px;",article:a[v+5],articleIndex:v+5});x.add(e)}if(a.length>(v+6)){var c=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemMedWideTall",{expandAnim:"expandRow3Col2Right 0.2s ease-in",shrinkAnim:"shrinkRow3Col2Right 0.2s ease-out",style:"position:absolute;top:60%;left:256px;",article:a[v+6],articleIndex:v+6});x.add(c)}q.add(x);v+=7;t=true}}if(t){var u;var y;if(z.settings.dynamic.adverts!=null){if(z.settings.dynamic.adverts.interstitial!=null&&v<a.length){var w=$(document).height()-120;var m=w*0.8;var r=((m*0.3)*2)+(m*0.45)-10;u=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitialContainer");y=Ext.create("InfinityMobile.view.desktop.DynamicArticlesInterstitial",{adHeight:r,settings:z.settings.dynamic.adverts.interstitial})}}z.articleReader.content.add(q);if(y!=null&&u!=null){u.add(y);z.articleReader.content.add(u)}}else{}if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){if(Ext.browser.is.IE){setTimeout(function(){var h=0;var A=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(q in A){h+=$(A[q].element.dom).width()+10}var B=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(interstitial in B){h+=$(B[interstitial].element.dom).width()+5}if(settings.dynamic.rss==null){z.articleReader.content.element.down(".x-container").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}else{z.articleReader.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=h+"px"}},100)}z.articleReader.scrollDesktop.scrollLeft=0}else{z.articleReader.content.getScrollable().getScroller().scrollTo(0)}}},loadSection:function(g){var f=this;var b=true;f.currentSection=g;var c="";switch(g){case language.dynamicArticles.all:if(Ext.os.is.Phone){f.articleReaderLoadPhone(f.articleReader,1)}else{f.articleReaderLoad(f.articleReader,1)}if(f.articleReader.content.getScrollable()!=null){f.articleReader.content.getScrollable().getScroller().scrollTo(0,0)}b=false;for(var a=0;a<f.buttons.length;a++){if(f.buttons[a].section==language.dynamicArticles.all){f.buttons[a].element.dom.style.color="#b22930"}else{if(f.buttons[a].section==language.dynamicArticles.liveNews){f.buttons[a].element.down("span").dom.style.color="#929292"}else{f.buttons[a].element.dom.style.color="#929292"}}}break}if(b){var e=[];for(var d=0;d<f.articles.length;d++){for(var a=0;a<f.articles[d].sections.length;a++){if(f.articles[d].sections[a]==g){e[e.length]=f.articles[d];break}}}for(var a=0;a<f.buttons.length;a++){if(f.buttons[a].section==g){f.buttons[a].element.dom.style.color="#b22930"}else{if(f.buttons[a].section==language.dynamicArticles.liveNews){f.buttons[a].element.down("span").dom.style.color="#929292"}else{f.buttons[a].element.dom.style.color="#929292"}}}f.articleReader.content.removeAll();if(e.length>0){f.displayedArticles=e;if(Ext.os.is.Phone){f.buildTilesPhone(e,g)}else{if($(document).height()>768&&(Ext.os.is.Desktop||currentProfile=="largetablet")){f.buildTiles(e,c)}else{f.buildTilesSmall(e,c)}}}else{f.noTiles(g)}}},noTiles:function(b){var a=this},showArticlePopover:function(b,c){var d=this;var a=b.config.articleIndex;var g=5;var f="InfinityMobile.view.tablet.ReaderArticlePopover";switch(currentProfile){case"phone":f="InfinityMobile.view.phone.ReaderArticlePopover";break;case"tablet":f="InfinityMobile.view.tablet.ReaderArticlePopover";break;case"desktop":f="InfinityMobile.view.desktop.ReaderArticlePopover";break;default:f="InfinityMobile.view.tablet.ReaderArticlePopover";break}var e=Ext.create(f,{articleguid:c,articleIndex:a,articleReader:true})},initializeArticlePopover:function(c){var d=this;var a=this;var f=Ext.create("Ext.Carousel",{width:"100%",height:"100%",indicator:false,initialize:function(){var g=this;g.on("activeitemchange","handleItemChange",this)},handleItemChange:function(m,j,l,g){var h=this;if(l!=null){if(j.pos>l.pos){if(h.currentSection!=null){var k=Ext.create("InfinityMobile.view.desktop.ArticlePopoverItemDynamic",{articleGuid:a.displayedArticles[j.pos+2].guid,pos:j.pos+2});h.add(k)}else{var k=Ext.create("InfinityMobile.view.desktop.ArticlePopoverItemDynamic",{articleGuid:a.articles[j.pos+2].guid,pos:j.pos+2});h.add(k)}}else{h.removeAt(2);if(h.currentSection!=null){var k=Ext.create("InfinityMobile.view.desktop.ArticlePopoverItemDynamic",{articleGuid:a.displayedArticles[j.pos-2].guid,pos:j.pos-2});h.insert(0,k)}else{var k=Ext.create("InfinityMobile.view.desktop.ArticlePopoverItemDynamic",{articleGuid:a.articles[j.pos-2].guid,pos:j.pos-2});h.insert(0,k)}}}}});if(d.currentSection!=null){for(var b=0;b<d.displayedArticles.length;b++){var e=Ext.create("InfinityMobile.view.desktop.ArticlePopoverItemDynamic",{articleGuid:d.displayedArticles[b].guid,pos:b});f.add(e)}c.content.add(f);c.articleText.setHtml("Article "+((c.config.articleIndex)+1)+" / "+d.displayedArticles.length);c.topBarFrame.dom.src="../socialsharearticle.aspx?url="+encodeURIComponent(window.location.href)+"&article="+encodeURIComponent(d.displayedArticles[c.config.articleIndex].description)}else{for(var b=c.config.articleIndex-1;b<c.config.articleIndex+2;b++){var e=Ext.create("InfinityMobile.view.desktop.ArticlePopoverItemDynamic",{articleGuid:d.articles[b].guid,pos:b});f.add(e)}c.content.add(f);f.next();c.articleText.setHtml("Article "+((c.config.articleIndex)+1)+" / "+d.articles.length);c.topBarFrame.dom.src="../socialsharearticle.aspx?url="+encodeURIComponent(window.location.href)+"&article="+encodeURIComponent(d.articles[c.config.articleIndex].description)}},tileTapped:function(e){var g=this;var b=e.element.dom.offsetParent.offsetParent.offsetParent.offsetParent;var a=e.element.dom.offsetParent.offsetParent;if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){var f=g.articleReader.scrollDesktop.scrollLeft}else{var d=g.articleReader.content.getScrollable().getScroller();var f=d.position.x}var h=b.offsetLeft+a.offsetLeft;var c;var j;if(h>f){j="left"}else{j="right"}},toolbarMenu:function(){var a=this;var c=a.getArticlereadermenu();if(c==null){var b="InfinityMobile.view.desktop.ArticleReaderMenu";switch(currentProfile){case"phone":b="InfinityMobile.view.desktop.ArticleReaderMenu";break;case"tablet":default:b="InfinityMobile.view.desktop.ArticleReaderMenu";break}c=Ext.create(b,{});Ext.Viewport.add(c);c.show()}else{if(c.isHidden()){c.show()}else{c.hide()}}},toggleReaderOptions:function(){var b=this;var a=b.getArticlereadertoggleviewoptions();if(a==null){a=Ext.create("InfinityMobile.view.ArticleReaderToggleViewOptions",{left:0,top:0});Ext.Viewport.add(a);a.show()}else{if(a.isHidden()){a.show()}else{a.hide()}}},replicaPaperView:function(j){var g=this;articleMode="replica";g.loaded=false;g.getArticlereadertoggleviewoptions().destroy();var c=g.articleReader.config.orientation;g.articleReader.destroy();g.articleReader=null;mainPanel.setActiveItem(0);if(g.getLivenewsticker()!=null){g.getLivenewsticker().show();g.getLivenewsticker().loadTicker()}var a=g.getReader();a.fireEvent("pagechange",a);if(Ext.os.is.Desktop){g.getReader().onResize()}else{if(g.returnOrientation()!=c){g.getReader().onResize()}}if(!Ext.os.is.Phone){g.getApplication().getController("PageTurnController").setupKeys();g.articles=g.getApplication().getController("ArticleController").getArticles();if(g.articles.length>0){var e=Ext.getStore("SettingStore");var b=0;if(e.data.items[0].raw.RSSTicker!=null){b=40}var h=[];if(e.data.items[0].raw.bookmarks!=null){h=e.data.items[0].raw.bookmarks.bookmark}if(Ext.os.is.Phone){var d=Ext.create("InfinityMobile.view.phone.ArticlesContainer",{articles:g.articles,sections:h})}else{if(Ext.os.is.Desktop){var f=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){f=false}}if(f){var d=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle"})}else{var d=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle"})}}else{var d=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle"})}}Ext.Viewport.add(d);d.show()}else{if(Ext.os.is.Desktop){var f=true;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer!=null){f=false}}if(f){var d=Ext.create("InfinityMobile.view.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle",bottom:b})}else{var d=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle",bottom:b})}}else{var d=Ext.create("InfinityMobile.view.tablet.ArticlesContainer",{articles:g.articles,sections:h,mode:"toggle",bottom:b})}Ext.Viewport.add(d);d.show()}}},dynamicView:function(a){var b=this;if(b.articleReader!=null){if(Ext.os.is.Phone){b.articleReaderLoadPhone(b.articleReader,1)}else{b.articleReaderLoad(b.articleReader,1)}}else{var c="InfinityMobile.view.ArticleReader";var d=Ext.create(c,{orientation:b.returnOrientation()});mainPanel.add(d);mainPanel.setActiveItem(d)}if(a!=null){a.hide()}},readerarticlehide:function(){var a=this;a.dynamicKeyControls(a.articleReader)},liveArticleClick:function(e,b){var c=this;var c=this;var d=c.getArticleview();if(d!=null){d.destroy()}var a=e.config.articleIndex;var g=5;var f="InfinityMobile.view.tablet.ReaderArticlePopover";switch(currentProfile){case"phone":f="InfinityMobile.view.phone.ReaderArticlePopover";break;case"tablet":f="InfinityMobile.view.tablet.ReaderArticlePopover";break;case"desktop":f="InfinityMobile.view.desktop.ReaderArticlePopover";break;default:f="InfinityMobile.view.tablet.ReaderArticlePopover";break}if(b.length==null){var e=Ext.create(f,{mediaController:c,isLive:"true",articleIndex:a})}else{var e=Ext.create(f,{mediaController:c,isLive:"true",articleIndex:a,articles:b})}if(!Ext.os.is.Desktop){if(articleMode=="dynamic"){mainPanel.add(e);mainPanel.setActiveItem(e)}else{mainPanel.add(e);mainPanel.setActiveItem(e)}}},initializeLivePopover:function(d,c){var e=this;var b=d.content;if(c.length==null){var f=e.liveArticles}else{var f=c}var a=d.config.articleIndex;e.articleCarousel=Ext.create("InfinityMobile.view.ArticleCarousel",{width:"100%",height:"100%",pageNumber:a,data:f,pageTemplate:function(j,k,h){if(Ext.os.is.Desktop){return Ext.create("InfinityMobile.view.desktop.ReaderLiveArticlePopoverItem",{pageNo:k,page:h[k]})}else{return Ext.create("InfinityMobile.view.ReaderLiveArticlePopoverItem",{pageNo:k,page:h[k]})}}});b.add(e.articleCarousel);var g=f[a];d.articleText.setHtml("Article "+((a)+1)+" / "+f.length);if(!Ext.os.is.Phone){e.getApplication().getController("MediaController").articleLoadShare(d,g)}if(trackOmniture=="True"){trackArticle(g.page,g.description)}e.articleKeyControl();e.articleCarousel.on({hide:function(){e.dynamicKeyControls()}})},liveNext:function(a){a.items.items[1].items.items[0].next(0)},livePrevious:function(a){a.items.items[1].items.items[0].previous()},articleKeyControl:function(){var b=this;var a=b.getArticleview();window.onkeyup=function(c){if($("#slider").val()==1){if(c.keyCode==39){a.items.items[1].items.items[0].next(0)}else{if(c.keyCode==37){a.items.items[1].items.items[0].previous()}}}};window.onkeydown=function(c){if(c.keyCode===38){a.items.items[1].items.items[0].getActiveItem().content.element.dom.scrollTop-=20}if(c.keyCode===40){a.items.items[1].items.items[0].getActiveItem().content.element.dom.scrollTop+=20}}},liveNewsTickerArticle:function(b,a){var c=this;c.liveArticleClick(b[a],b)},resizeArticlesBrowser:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().resizeOb()}},resizeDynamicArticles:function(){var c=this;var d=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(container in d){if(d[container].onResize!=null){d[container].onResize()}}if(!Ext.os.is.Phone){var d=Ext.ComponentQuery.query(".articlereaderpanelcontainer");if(d.length>0){if($(document).height()>768){if(c.tileMode=="small"){if(c.currentSection==language.dynamicArticles.liveNews){c.liveNewsTiles()}else{c.loadSection(c.currentSection)}c.tileMode="large"}}else{if(c.tileMode=="large"){if(c.currentSection==language.dynamicArticles.liveNews){c.liveNewsTiles()}else{c.loadSection(c.currentSection)}c.tileMode="small"}}}}if(!Ext.os.is.Phone){var e=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(container in e){e[container].onResize()}var b=Ext.ComponentQuery.query(".dynamicarticlesinterstitial");for(ad in b){b[ad].onResize()}}var a=Ext.ComponentQuery.query(".articlereaderitemweathertile");for(tile in a){a[tile].onResize()}if(Ext.os.is.Phone){var a=Ext.ComponentQuery.query(".articlereaderbannerad");for(tile in a){a[tile].onResizeFn()}}if(!Ext.os.is.Phone){var a=Ext.ComponentQuery.query(".articlereaderitemmedtall");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemmedwidetall");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemsmall");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemlrg");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemtopstoryitem");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".articlereaderitemmedwide");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".smallviewtilesmall");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".smallviewtilemed");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".smallviewtilewide");for(tile in a){a[tile].resize()}a=Ext.ComponentQuery.query(".smallviewtileweather");for(tile in a){a[tile].resize()}}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},expandArticles:function(){var a=this;if(a.getLivenewsticker()!=null){a.getLivenewsticker().hide()}a.dynamicView()},howToArticlesInit:function(b){var a=this;if(a.getArticles().length==0){b.setHtml(language.howToUse.browseNoArticleDesc)}},howToReaderInit:function(a){var b=this;if(b.getArticles().length==0){a.hide()}}},0,0,0,0,0,0,[InfinityMobile.controller,"ArticleController"],0));(Ext.cmd.derive("InfinityMobile.controller.PdfController",Ext.app.Controller,{config:{refs:{readerpageviewer:"readerpageviewer",infiniteCarousel:"infinitecarousel2d"},control:{readerpageviewer:{renderPDF:"processPDF",activeItemCheck:"activeItemCheck"},infiniteCarousel:{pausePDF:"pausePage",resumePDF:"resumePage"}}},init:function(){var b=this;pdfRenderQueue=[];b.isBusy=false;b.isPaused=false;b.blocked=false;b.currentRenderPage=null;PDFJS.isPaused=false;PDFJS.workerSrc="resources/js/pdf/pdf.worker.js";b.firstEverRender=true;if(!Ext.browser.is.Chrome){b.firstEverRender=false}var a=Ext.getStore("SettingStore");a.on({load:"initPDFSettings",scope:this,delay:10})},initPDFSettings:function(){if(settings.page.pdfEnableWorker!=null&&settings.page.pdfEnableWorker=="true"){PDFJS.disableWorker=false}else{PDFJS.disableWorker=true}if(settings.page.pdfDisableFontFace!=null&&settings.page.pdfDisableFontFace=="true"){if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){PDFJS.disableFontFace=true}}},getPDFRenderQueue:function(){return pdfRenderQueue},addToQueue:function(f,d,h,e,j,k,c){var g=this;var a={page:f,pageNumber:h,imagePageNumber:e,renderContext:d,callback:j,cancelCallback:k,resetCallback:c};var b=g.getPDFRenderQueue();b.push(a)},insertToQueue:function(g,d,j,e,k,l,c,f){var h=this;var a={page:g,pageNumber:j,imagePageNumber:e,renderContext:d,callback:k,cancelCallback:l,resetCallback:c};var b=h.getPDFRenderQueue();b.splice(f,0,a)},checkExistingPageInQueue:function(e,d){var g=this;var c=-1;var b=g.getPDFRenderQueue();if(b.length>0){for(var f=0;f<b.length;f++){var a=b[f];if(a.pageNumber==e&&a.imagePageNumber==d){return f}}}return c},removeFromQueue:function(c){var b=this;var a=pdfRenderQueue.indexOf(c);if(a>-1){pdfRenderQueue.splice(a,1)}},checkQueue:function(){var b=this;var a=b.getPDFRenderQueue();if(a.length>0){var c=b.selectClosestPage(a);b.removeFromQueue(c);b.tryRenderPDF(c.page,c.renderContext,c.pageNumber,c.imagePageNumber,c.callback,c.cancelCallback,c.resetCallback)}},isOnCurrentPage:function(h){var g=this;var j=[];var f=g.getInfiniteCarousel();var c=f.getPageNumber()+1;j.push(c);if(f.returnOrientation()=="landscape"&&f.getMode()=="double"){var a;if(c%2==1){a=c-1}else{a=c+1}j.push(a)}if(currentProfile=="largetablet"){var e=Math.min(c,a);var d=Math.max(c,a);j.push(e-1);j.push(d+1);if(f.returnOrientation()=="landscape"&&f.getMode()=="double"){j.push(e-2);j.push(d+2)}}var b=h;if(!(f.returnOrientation()=="landscape"&&f.getMode()=="double")){b=flatPlanData.reversePageMapper[h]}if(f.returnOrientation()=="portrait"){b=b-pageOffset}if(j.indexOf(b)!=-1){return true}else{return false}},selectClosestPage:function(a){var g=this;var e=g.getInfiniteCarousel();var c=e.getPageNumber()+1;var k=Math.abs(a[0].pageNumber-c);var h=a[0];if(k!=0&&a.length>1){for(var d=1;d<a.length;d++){var b=a[d];var j=b.pageNumber;if(c==j){return b}var f=Math.abs(c-j);if(f<k){k=f;h=b}}}return h},processPDF:function(e,c,g,d,h,j,b){var f=this;var a=f.getPDFRenderQueue();if(!f.isBusy&&!f.isPaused&&!PDFJS.isPaused&&a.length==0){f.renderPDF(e,c,g,d,h,j,b)}else{f.addToQueue(e,c,g,d,h,j,b)}},tryRenderPDF:function(f,d,b,a,h,c,g){var e=this;if(!e.isBusy&&!e.isPaused&&!PDFJS.isPaused){e.renderPDF(f,d,b,a,h,c,g)}else{e.addToQueue(f,d,b,a,h,c,g)}},renderPDF:function(f,d,b,a,h,c,g){var e=this;if(e.isOnCurrentPage(a)&&e.checkExistingPageInQueue(b,a)==-1){e.isBusy=true;e.currentRenderPage=f.render(d);e.currentRenderPage.page=f;e.currentRenderPage.pageNumber=b;e.currentRenderPage.imagePageNumber=a;e.currentRenderPage.renderContext=d;e.currentRenderPage.callback=h;e.currentRenderPage.cancelCallback=c;e.currentRenderPage.resetCallback=g;e.currentRenderPage.then(function(){e.hideBackgroundImage();e.isBusy=false;if(e.checkExistingPageInQueue(b,a)==-1){h()}e.checkQueue()},function(j){if(j=="cancelled"){e.isBusy=false;c()}})}else{e.checkQueue()}},setupCanvas:function(b){var e=this;var d=b.canvasContext;var a=d.canvas;a.style.visibility="hidden";if(a.dpi>1){a.width=a.pageWidth*a.dpi;a.height=a.pageHeight*a.dpi;a.style.width=a.pageWidth+"px";a.style.height=a.pageHeight+"px";try{d._transformMatrix=[a.dpi,0,0,a.dpi,0,0];d.setTransform(1,0,0,1,0,0);d.scale(a.dpi,a.dpi)}catch(c){a.width=a.pageWidth;a.height=a.pageHeight;a.style.width=a.pageWidth+"px";a.style.height=a.pageHeight+"px"}}else{a.width=a.pageWidth;a.height=a.pageHeight;a.style.width=a.pageWidth+"px";a.style.height=a.pageHeight+"px"}},isAnotherPageRequestInQueue:function(){var a=this},pausePage:function(){var a=this;a.isPaused=true;if(a.isBusy){secondStart=new Date().getTime()/1000;a.currentRenderPage.cancel()}},resumePage:function(){var a=this;a.isPaused=false;a.checkQueue()},activeItemCheck:function(b){var a=this;if(b==a.getInfiniteCarousel().getActiveItem()){b.initialTranslateX=0;b.initialTranslateY=0;b.leftSideImageLoad(true);b.rightSideImageLoad(true);b.resetZoom()}else{b.toggleDPS(b.mode)}},hideBackgroundImage:function(){var b=this;var c=b.getInfiniteCarousel();var a=Ext.getStore("SettingStore");if(c._zoomMode=="fill"){}}},0,0,0,0,0,0,[InfinityMobile.controller,"PdfController"],0));(Ext.cmd.derive("InfinityMobile.controller.PageTurnController",Ext.app.Controller,{config:{refs:{pagecontainer2:"readerpageviewer",infinitecarousel:"infinitecarousel2d",navbutton:"navbutton",bannerAd:"readerbannerad"},control:{pagecontainer2:{returnPageRight:"returnPageRight",finishTurnRight:"finishTurnRight",returnPageLeft:"returnPageLeft",finishTurnLeft:"finishTurnLeft",returnPageBottomRight:"returnPageBottomRight",finishTurnBottomRight:"finishTurnBottomRight",returnPageBottomLeft:"returnPageBottomLeft",finishTurnBottomLeft:"finishTurnBottomLeft",autoTurnRight:"autoTurnRight",autoTurnLeft:"autoTurnLeft",autoTurnBottomRight:"autoTurnBottomRight",autoTurnBottomLeft:"autoTurnBottomLeft",setupKeys:"setupKeys",goRight:"goRight",goLeft:"goLeft",killBannerAd:"killBannerAd"},navbutton:{autoTurnRight:"goRight",autoTurnLeft:"goLeft"}}},init:function(){var c=this;var d=c.getInfinitecarousel();var b=$(document).width();var a=$(document).height();pixelMove=b*0.01;c.turning=false;if(Ext.browser.is.IE){flipSound=new Audio("resources/audio/pageTurnShort.mp3")}else{flipSound=new Audio("resources/audio/pageTurnShort.wav")}if(typeof flipSound!="undefined"&&flipSound!=null){flipSound.onended=function(){flipSound.pause();if(typeof flipSound!="undefined"&&!isNaN(flipSound.duration)){flipSound.currentTime=0}}}c.setupKeys()},isFullscreenAdInView:function(){var c=this;if(settings.reader.interstitial!=null&&settings.reader.interstitial.dfpType=="fullscreen"){var d=$("body").children("div[draggable='false']");if(d.length>1){for(var b=0;b<d.length;b++){if(d[b].style!=null){var a=d[b].style.display;if(a!="none"){return true}else{return false}}}}}else{return false}},setupKeys:function(){var a=this;window.onkeydown=function(c){var b=a.getInfinitecarousel();var d=b.getActiveItem();if(Ext.browser.is.Firefox&&c.keyCode==9){c.preventDefault()}if($("#slider").val()<=1){console.log(d);if(c.keyCode==39&&d!=null&&(d.config.nextPage!=null&&d.config.nextPage!="")){if(!a.isFullscreenAdInView()){a.goRight()}}if(c.keyCode==37&&d!=null&&(d.config.nextPage!=null&&d.config.nextPage!="")){if(!a.isFullscreenAdInView()){a.goLeft()}}if(c.keyCode===38){if(d.getScrollable().getScroller().position.y-30>0){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().position.y-30);if(d.zoomMode!="fit"){a.getApplication().getController("ReaderController").showTop();if(d.getScrollable().getScroller().position.y-30<d.getScrollable().getScroller().maxPosition.y){a.getApplication().getController("ReaderController").showBottom()}else{a.getApplication().getController("ReaderController").hideBottom()}}}else{d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,0);if(d.zoomMode!="fit"){a.getApplication().getController("ReaderController").hideTop();a.getApplication().getController("ReaderController").showBottom()}}}if(c.keyCode===40){if(d.getScrollable().getScroller().position.y+30<d.getScrollable().getScroller().maxPosition.y){if(d.zoomMode!="fit"){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().position.y+30);a.getApplication().getController("ReaderController").showBottom();if(d.getScrollable().getScroller().position.y+30>0){a.getApplication().getController("ReaderController").showTop()}else{a.getApplication().getController("ReaderController").hideTop()}}}else{d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().maxPosition.y);if(d.zoomMode!="fit"){a.getApplication().getController("ReaderController").hideBottom();a.getApplication().getController("ReaderController").showTop()}}}}else{c.stopImmediatePropagation();if(c.keyCode==39){if(d.getScrollable().getScroller().position.x+30<d.getScrollable().getScroller().maxPosition.x){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x+30)}else{d.getScroller().scrollTo(d.getScrollable().getScroller().maxPosition.x)}}else{if(c.keyCode==37){if(d.getScrollable().getScroller().position.x-30>0){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x-30)}else{d.getScrollable().getScroller().scrollTo(0)}}else{if(c.keyCode===38){if(d.getScrollable().getScroller().position.y-30>0){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().position.y-30)}else{d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,0)}}else{if(c.keyCode===40){if(d.getScrollable().getScroller().position.y+30<d.getScrollable().getScroller().maxPosition.y){d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().position.y+30)}else{d.getScrollable().getScroller().scrollTo(d.getScrollable().getScroller().position.x,d.getScrollable().getScroller().maxPosition.y)}}}}}}}},goRight:function(a){var b=this;b.killBannerAd();var c=b.getInfinitecarousel();if(currentProfile=="desktop"){if(c._mode=="double"){var d=c.getActiveItem();if(!b.checkSectionPageNext(d)&&d.id.indexOf("ext-readeradvertpageviewer")==-1){b.animateRight(d)}else{b.nonAnimateRight(c)}}else{b.nonAnimateRight(c)}}else{b.nonAnimateRight(c)}},killBannerAd:function(){var b=this;if(currentProfile=="desktop"&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.refresh!=null&&settings.reader.bannerAd.refresh=="true"){if(!(settings.topbar.hideTopbarOnFullscreen&&isFullscreen)){var a=b.getBannerAd();if(a!=null){a.destroyAdvert()}}}},checkSectionPageNext:function(a){if(a.config.nextPage==null||a.config.nextPage.type=="sectionpage"||a.config.nextPage.type=="advert"){return true}return false},animateRight:function(b){var a=this;if(b.diffX==null){b.diffX=($(b.topRight.element.dom).offset().left+$(b.topRight.element.dom)[0].getBoundingClientRect().width)-width}if(b.diffY==null){b.diffY=$(b.topRight.element.dom).offset().top}$(b.rightSideDiv).css("transform-origin","0% 0% 0px");$(b.rightSideImageContainer).css("transform-origin","0% 0% 0px");$(b.rightNextPage).css("transform-origin","0% 0% 0px");$(b.rightSideDiv).css("bottom","");$(b.rightSideImageContainer).css("top","0%");$(b.rightSideImageContainer).css("bottom","");$(b.rightSideImageContainer).css("left","0%");$(b.rightNextPage).css("top","0%");$(b.rightNextPage).css("bottom","");$(b.rightNextPage).css("left","0% ");$(b.rightSideGradient).css("transform-origin","0% 0% 0px");$(b.rightSideGradient).css("top","0%");$(b.rightSideGradient).css("bottom","");$(b.rightSideGradient).css("left","0% ");$(b.rightSideGradient).css("z-index","11");b.rightSide.element.dom.style.zIndex="8";b.leftSide.element.dom.style.zIndex="8";b.pauseFlashingLinks();b.leftSideMediaDiv.style.visibility="hidden";b.rightSideMediaDiv.style.visibility="hidden";if(b.topRight.element.dom.style.visibility!="hidden"){a.autoTurnRight(b)}},nonAnimateRight:function(a){a.next()},goLeft:function(a){var b=this;b.killBannerAd();var c=b.getInfinitecarousel();if(currentProfile=="desktop"){if(c._mode=="double"){var d=c.getActiveItem();if(!b.checkSectionPagePrevious(d)&&d.id.indexOf("ext-readeradvertpageviewer")==-1){b.animateLeft(d)}else{b.nonAnimateLeft(c)}}else{b.nonAnimateLeft(c)}}else{b.nonAnimateLeft(c)}},checkSectionPagePrevious:function(a){if(a.config.previousPage==null||a.config.previousPage.type=="sectionpage"||a.config.previousPage.type=="advert"){return true}return false},animateLeft:function(b){var a=this;if(b.diffX==null){b.diffX=-$(b.topLeft.element.dom).offset().left}if(b.diffY==null){b.diffY=$(b.topLeft.element.dom).offset().top}$(b.leftSideDiv).css("transform-origin","100% 0% 0px");$(b.leftSideImageContainer).css("transform-origin","100% 0% 0px");$(b.leftPrevPage).css("transform-origin","100% 0% 0px");$(b.leftSideGradient).css("transform-origin","100% 0% 0px");$(b.leftSideDiv).css("bottom","");$(b.leftSideImageContainer).css("top","0%");$(b.leftSideImageContainer).css("bottom","");$(b.leftSideImageContainer).css("right","0%");$(b.leftPrevPage).css("top","0%");$(b.leftPrevPage).css("bottom","");$(b.leftPrevPage).css("right","0% ");$(b.leftSideGradient).css("top","0%");$(b.leftSideGradient).css("bottom","");$(b.leftSideGradient).css("right","0% ");$(b.leftSideGradient).css("z-index","11");b.rightSide.element.dom.style.zIndex="8";b.mouseDown=false;b.leftSide.element.dom.style.zIndex="8";b.pauseFlashingLinks();b.leftSideMediaDiv.style.visibility="hidden";b.rightSideMediaDiv.style.visibility="hidden";if(b.topLeft.element.dom.style.visibility!="hidden"){a.autoTurnLeft(b)}},nonAnimateLeft:function(a){a.previous()},checkTurnRight:function(){var a=this},checkTurnLeft:function(){var a=this},returnPageRight:function(c,a){var b=this;if(!b.turning){b.turning=true;b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX<($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset){c.pageX+=pixelMove}else{e=true}if(c.pageY>1+a.diffY){c.pageY-=pixelMove}else{d=true}if(c.pageY<1+a.diffY){c.pageY=1+a.diffY}if(c.pageX>($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset){c.pageX=($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset}if(e&&d){clearInterval(b.timer);setTimeout(function(){b.turning=false},30);var f=b.getInfinitecarousel().getActiveItem();f.rightSideGradient.style.visibility="hidden";f.leftSideGradient.style.visibility="hidden";$(f.leftSideDiv).css("overflow","visible");$(f.rightSideDiv).css("overflow","visible");$(f.leftSideDiv).css("transform","");$(f.rightSideDiv).css("transform","");$(f.leftSideImageContainer).css("transform","");$(f.rightSideImageContainer).css("transform","");f.leftSideMediaDiv.style.visibility="";f.rightSideMediaDiv.style.visibility="";f.rightSide.element.dom.style.zIndex="8";f.leftSide.element.dom.style.zIndex="8";$(f.rightSideNextPageContainer).css("transform","");$(f.rightNextPage).css("visibility","hidden");if(!Ext.browser.is.IE){if(f.element.dom.parentElement!=null){f.element.dom.parentElement.parentElement.style.overflow="hidden"}}f.mouseDown=false}else{a.drag(c)}},10)}},finishTurnRight:function(c,a){var b=this;clearInterval(b.timer);if(!b.turning){b.turning=true;if(settings.reader.disablePageTurnSound!="true"&&typeof flipSound!="undefined"){flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX>1+a.diffX){c.pageX-=pixelMove}else{e=true}if(c.pageY>1+a.diffY){c.pageY-=pixelMove}else{d=true}if(c.pageX<1+a.diffX){c.pageX=1+a.diffX}if(c.pageY<1+a.diffY){c.pageY=1+a.diffY}if(e&&d){clearInterval(b.timer);b.timer=null}else{a.drag(c)}if(b.timer==null){b.getInfinitecarousel().getActiveItem().mouseDown=false;setTimeout(function(){b.completeTurnRight()},30)}},10)}},returnPageLeft:function(c,a){var b=this;if(!b.turning){b.turning=true;b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX>1+(a.diffX*-1)){c.pageX-=pixelMove}else{e=true}if(c.pageY>a.diffY-1){c.pageY-=pixelMove}else{d=true}if(c.pageX<1+(a.diffX*-1)){c.pageX=1+(a.diffX*-1)}if(c.pageY<a.diffY-1){c.pageY=a.diffY-1}if(e&&d){clearInterval(b.timer);setTimeout(function(){b.turning=false},30);b.getInfinitecarousel().getActiveItem().mouseDown=false;var f=b.getInfinitecarousel().getActiveItem();f.rightSideGradient.style.visibility="hidden";f.leftSideGradient.style.visibility="hidden";$(f.leftSideDiv).css("overflow","visible");$(f.rightSideDiv).css("overflow","visible");$(f.leftSideDiv).css("transform","");$(f.rightSideDiv).css("transform","");$(f.leftSideImageContainer).css("transform","");$(f.rightSideImageContainer).css("transform","");f.leftSideMediaDiv.style.visibility="";f.rightSideMediaDiv.style.visibility="";f.rightSide.element.dom.style.zIndex="8";f.leftSide.element.dom.style.zIndex="8";$(f.leftSidePrevPageContainer).css("transform","");$(f.leftPrevPage).css("visibility","hidden");if(!Ext.browser.is.IE){if(f.element.dom.parentElement!=null){f.element.dom.parentElement.parentElement.style.overflow="hidden"}}}else{a.dragLeft(c)}},10)}},finishTurnLeft:function(c,a){var b=this;clearInterval(b.timer);if(!b.turning){b.turning=true;if(settings.reader.disablePageTurnSound!="true"&&typeof flipSound!="undefined"){flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX<($(a.element.dom).width()/2)+a.width){c.pageX+=pixelMove}else{e=true}if(c.pageY>1+a.diffY){c.pageY-=pixelMove}else{d=true}if(e&&d){clearInterval(b.timer);b.timer=null}if(c.pageX<($(a.element.dom).width()/2)+a.width){c.pageX=($(a.element.dom).width()/2)+a.width}if(c.pageY<1+a.diffY){c.pageY=1+a.diffY}a.dragLeft(c);if(b.timer==null){b.getInfinitecarousel().getActiveItem().mouseDown=false;setTimeout(function(){b.completeTurnLeft()},15)}},10)}},returnPageBottomRight:function(c,a){var b=this;if(!b.turning){b.turning=true;b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX<($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset){c.pageX+=pixelMove}else{e=true}if(c.pageY<$(a.element.dom).height()+a.diffY){c.pageY+=pixelMove}else{d=true}if(c.pageX>($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset){c.pageX=($(a.element.dom).width()/2)+a.width-1+a.wrapAdOffset}if(c.pageY>$(a.element.dom).height()+a.diffY){c.pageY=$(a.element.dom).height()+a.diffY}if(e&&d){clearInterval(b.timer);setTimeout(function(){b.turning=false},30);b.getInfinitecarousel().getActiveItem().mouseDown=false;var f=b.getInfinitecarousel().getActiveItem();f.rightSideGradient.style.visibility="hidden";f.leftSideGradient.style.visibility="hidden";$(b.leftSideDiv).css("overflow","visible");$(b.rightSideDiv).css("overflow","visible");f.leftSideMediaDiv.style.visibility="";f.rightSideMediaDiv.style.visibility="";f.rightSide.element.dom.style.zIndex="8";f.leftSide.element.dom.style.zIndex="8";$(f.rightNextPage).css("visibility","hidden");if(!Ext.browser.is.IE){if(f.element.dom.parentElement!=null){f.element.dom.parentElement.parentElement.style.overflow="hidden"}}}else{a.dragBottomRight(c)}},10)}},finishTurnBottomRight:function(c,a){var b=this;clearInterval(b.timer);if(!b.turning){b.turning=true;if(settings.reader.disablePageTurnSound!="true"&&typeof flipSound!="undefined"){flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX>1+(a.diffX*-1)){c.pageX-=pixelMove}else{e=true}if(c.pageY<a.height+a.diffY){c.pageY+=pixelMove}else{d=true}if(e&&d){clearInterval(b.timer);b.timer=null}if(c.pageX<1+(a.diffX*-1)){c.pageX=1+(a.diffX*-1)}if(c.pageY>a.height+a.diffY){c.pageY=a.height+a.diffY}a.dragBottomRight(c);if(b.timer==null){b.getInfinitecarousel().getActiveItem().mouseDown=false;setTimeout(function(){b.completeTurnRight()},30)}},15)}},returnPageBottomLeft:function(c,a){var b=this;b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX>1+(a.diffX*-1)){c.pageX-=pixelMove}else{e=true}if(c.pageY<$(a.element.dom).height()+a.diffY){c.pageY+=pixelMove}else{d=true}if(c.pageX<1+(a.diffX*-1)){c.pageX=1+(a.diffX*-1)}if(c.pageY>$(a.element.dom).height()+(a.diffY*2)){c.pageY=$(a.element.dom).height()+(a.diffY*2)}if(e&&d){clearInterval(b.timer);setTimeout(function(){b.turning=false},30);b.getInfinitecarousel().getActiveItem().mouseDown=false;var f=b.getInfinitecarousel().getActiveItem();f.rightSideGradient.style.visibility="hidden";f.leftSideGradient.style.visibility="hidden";$(b.leftSideDiv).css("overflow","visible");$(b.rightSideDiv).css("overflow","visible");f.leftSideMediaDiv.style.visibility="";f.rightSideMediaDiv.style.visibility="";f.rightSide.element.dom.style.zIndex="8";f.leftSide.element.dom.style.zIndex="8";$(f.leftPrevPage).css("visibility","hidden");if(!Ext.browser.is.IE){if(f.element.dom.parentElement!=null){f.element.dom.parentElement.parentElement.style.overflow="hidden"}}}else{a.dragBottomLeft(c)}},10)},finishTurnBottomLeft:function(c,a){var b=this;clearInterval(b.timer);if(!b.turning){b.turning=true;if(settings.reader.disablePageTurnSound!="true"&&typeof flipSound!="undefined"){flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}b.timer=setInterval(function(){b.turning=true;var e=false;var d=false;if(c.pageX<($(a.element.dom).width()/2)+a.width){c.pageX+=pixelMove}else{e=true}if(c.pageY<a.height+a.diffY){c.pageY+=pixelMove}else{d=true}if(e&&d){clearInterval(b.timer);b.timer=null}if(c.pageX>($(a.element.dom).width()/2)+a.width){c.pageX=($(a.element.dom).width()/2)+a.width}if(c.pageY>a.height+a.diffY){c.pageY=a.height+a.diffY}a.dragBottomLeft(c);if(b.timer==null){b.getInfinitecarousel().getActiveItem().mouseDown=false;setTimeout(function(){b.completeTurnLeft()},15)}},15)}},playSound:function(){var a=this;if(typeof flipSound!="undefined"){if(settings.reader.disablePageTurnSound!=null&&settings.reader.disablePageTurnSound=="true"){return}flipSound.pause();if(!isNaN(flipSound.duration)){flipSound.currentTime=0}flipSound.play()}},autoTurnRight:function(a){var h=this;if(a==null){a=h.getInfinitecarousel().getActiveItem()}if(!h.turning&&a.topRight.element.dom.style.visibility!="hidden"){h.turning=true;h.getApplication().getController("PdfController").pausePage();h.playSound();var l=[];var k=[];a.startDrag();if($(a.element.dom).width()+a.diffX-1>0){l[0]=$(a.element.dom).width()+a.diffX-1}else{l[0]=$(a.element.dom).width()}k[0]=a.diffY;l[15]=($(a.element.dom).width()/2);k[15]=($(a.element.dom).height()/2);l[30]=-a.diffX+1;k[30]=a.diffY+1;var e=l[0]-l[15];var d=e/15;var c=k[15]-k[0];var b=c/15;for(var f=1;f<15;f++){l[f]=l[f-1]-d;k[f]=k[f-1]+b}for(var j=16;j<30;j++){l[j]=l[j-1]-d;k[j]=k[j-1]-b}var g=0;h.timer=setInterval(function(){var m={};m.pageX=l[g];m.pageY=k[g];a.drag(m);if(g==30){clearInterval(h.timer);h.timer=null;h.getInfinitecarousel().getActiveItem().mouseDown=false;setTimeout(function(){h.completeTurnRight()},30)}g++},15)}},completeTurnRight:function(){var b=this;b.turning=false;var a=b.getInfinitecarousel().getActiveItem();$(a.leftSideDiv).css("transform","");$(a.leftSideImageContainer).css("transform","");$(a.leftPrevPage).css("transform","");$(a.leftPrevPage).css("visibility","hidden");$(a.rightSideDiv).css("transform","");$(a.rightSideImageContainer).css("transform","");$(a.rightNextPage).css("transform","");$(a.rightNextPage).css("visibility","hidden");a.rightSideGradient.style.visibility="hidden";a.leftSideGradient.style.visibility="hidden";$(a.leftSideDiv).css("overflow","visible");$(a.rightSideDiv).css("overflow","visible");a.leftSideMediaDiv.style.visibility="";a.rightSideMediaDiv.style.visibility="";a.rightSide.element.dom.style.zIndex="8";a.leftSide.element.dom.style.zIndex="8";b.getInfinitecarousel().next();a.playCssAnimations();$(a.rightSideNextPageContainer).css("display","none");$(a.leftSidePrevPageContainer).css("display","none");if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}setTimeout(function(){if(!b.turning){b.getApplication().getController("PdfController").resumePage()}},300)},autoTurnLeft:function(a){var h=this;if(a==null){a=h.getInfinitecarousel().getActiveItem()}if(!h.turning&&a.topLeft.element.dom.style.visibility!="hidden"){h.turning=true;h.getApplication().getController("PdfController").pausePage();h.playSound();var l=[];var k=[];a.startDragLeft();l[0]=-a.diffX;k[0]=a.diffY;l[15]=($(a.element.dom).width()/2);k[15]=($(a.element.dom).height()/2);l[30]=$(a.element.dom).width()+a.diffX+150;k[30]=a.diffY-1;var e=l[15]-l[0];var d=e/15;var c=k[15]-k[0];var b=c/15;for(var f=1;f<15;f++){l[f]=l[f-1]+d;k[f]=k[f-1]+b}for(var j=16;j<30;j++){l[j]=l[j-1]+d;k[j]=k[j-1]-b}var g=0;h.timer=setInterval(function(){var m={};m.pageX=l[g];m.pageY=k[g];a.dragLeft(m);if(g==30){clearInterval(h.timer);h.timer=null;h.getInfinitecarousel().getActiveItem().mouseDown=false;setTimeout(function(){h.completeTurnLeft()},15)}g++},15)}},completeTurnLeft:function(){var b=this;var a=b.getInfinitecarousel().getActiveItem();$(a.rightSideDiv).css("transform","");$(a.rightSideImageContainer).css("transform","");$(a.rightNextPage).css("transform","");$(a.rightNextPage).css("visibility","hidden");$(a.leftSideDiv).css("transform","");$(a.leftSideImageContainer).css("transform","");$(a.leftPrevPage).css("transform","");$(a.leftPrevPage).css("visibility","hidden");a.rightSideGradient.style.visibility="hidden";a.leftSideGradient.style.visibility="hidden";$(a.leftSideDiv).css("overflow","visible");$(a.rightSideDiv).css("overflow","visible");b.turning=false;a.leftSideMediaDiv.style.visibility="";a.rightSideMediaDiv.style.visibility="";a.rightSide.element.dom.style.zIndex="8";a.leftSide.element.dom.style.zIndex="8";b.getInfinitecarousel().previous();a.playCssAnimations();$(a.rightSideNextPageContainer).css("display","none");$(a.leftSidePrevPageContainer).css("display","none");if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}setTimeout(function(){if(!b.turning){b.getApplication().getController("PdfController").resumePage()}},300)},autoTurnBottomRight:function(a){var h=this;if(!h.turning&&a.bottomRight.element.dom.style.visibility!="hidden"){h.getApplication().getController("PdfController").pausePage();h.turning=true;h.playSound();var l=[];var k=[];l[0]=$(a.element.dom).width()-1;k[0]=a.height+a.diffY-1;l[15]=($(a.element.dom).width()/2);k[15]=(a.height/2);l[30]=0;k[30]=a.height+a.diffY;var e=l[0]-l[15];var d=e/15;var c=k[0]-k[15];var b=c/15;for(var f=1;f<15;f++){l[f]=l[f-1]-d;k[f]=k[f-1]-b}for(var j=16;j<30;j++){l[j]=l[j-1]-d;k[j]=k[j-1]+b}a.startDragBottomRight();var g=0;h.timer=setInterval(function(){var m={};m.pageX=l[g];m.pageY=k[g];a.dragBottomRight(m);if(g==30){clearInterval(h.timer);h.timer=null;h.getInfinitecarousel().getActiveItem().mouseDown=false;setTimeout(function(){h.completeTurnBottomRight()},30)}g++},15)}},completeTurnBottomRight:function(){var b=this;var a=b.getInfinitecarousel().getActiveItem();$(a.leftSideDiv).css("transform","");$(a.leftSideDiv).css("top",0);$(a.leftSideDiv).css("bottom","");$(a.leftSideImageContainer).css("transform","");$(a.leftSideImageContainer).css("top",0);$(a.leftSideImageContainer).css("bottom","");$(a.leftPrevPage).css("transform","");$(a.leftPrevPage).css("visibility","hidden");$(a.rightSideDiv).css("transform","");$(a.rightSideDiv).css("top",0);$(a.rightSideDiv).css("bottom","");$(a.rightSideImageContainer).css("transform","");$(a.rightSideImageContainer).css("top",0);$(a.rightSideImageContainer).css("bottom","");$(a.rightNextPage).css("transform","");$(a.rightNextPage).css("visibility","hidden");a.rightSideGradient.style.visibility="hidden";a.leftSideGradient.style.visibility="hidden";$(a.leftSideDiv).css("overflow","visible");$(a.rightSideDiv).css("overflow","visible");a.bottomRight.element.dom.style.visibility="visible";a.leftSideMediaDiv.style.visibility="";a.rightSideMediaDiv.style.visibility="";a.rightSide.element.dom.style.zIndex="8";a.leftSide.element.dom.style.zIndex="8";setTimeout(function(){a.bottomRightTapped=false},100);b.turning=false;$(a.rightSideNextPageContainer).css("display","none");$(a.leftSidePrevPageContainer).css("display","none");if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}b.getInfinitecarousel().next();a.playCssAnimations();setTimeout(function(){if(!b.turning){b.getApplication().getController("PdfController").resumePage()}},300)},autoTurnBottomLeft:function(a){var h=this;if(!h.turning&&a.bottomLeft.element.dom.style.visibility!="hidden"){h.turning=true;h.playSound();var l=[];var k=[];l[0]=-a.diffX;k[0]=a.height+a.diffY;l[15]=($(a.element.dom).width()/2);k[15]=($(a.element.dom).height()/2);l[30]=$(a.element.dom).width()+a.diffX;k[30]=a.height+a.diffY;a.startDragBottomLeft();var e=l[15]-l[0];var d=e/15;var c=k[0]-k[15];var b=c/15;for(var f=1;f<15;f++){l[f]=l[f-1]+d;k[f]=k[f-1]-b}for(var j=16;j<30;j++){l[j]=l[j-1]+d;k[j]=k[j-1]+b}var g=0;h.timer=setInterval(function(){var m={};m.pageX=l[g];m.pageY=k[g];a.dragBottomLeft(m);if(g==30){clearInterval(h.timer);h.timer=null;h.getInfinitecarousel().getActiveItem().mouseDown=false;setTimeout(function(){h.completeTurnBottomLeft()},30)}g++},15)}},completeTurnBottomLeft:function(){var b=this;var a=b.getInfinitecarousel().getActiveItem();$(a.rightSideDiv).css("transform","");$(a.rightSideDiv).css("top",0);$(a.rightSideDiv).css("bottom","");$(a.rightSideImageContainer).css("transform","");$(a.rightSideImageContainer).css("top",0);$(a.rightSideImageContainer).css("bottom","");$(a.rightNextPage).css("transform","");$(a.rightNextPage).css("visibility","hidden");$(a.leftSideDiv).css("transform","");$(a.leftSideDiv).css("top",0);$(a.leftSideDiv).css("bottom","");$(a.leftSideImageContainer).css("transform","");$(a.leftSideImageContainer).css("top",0);$(a.leftSideImageContainer).css("bottom","");$(a.leftPrevPage).css("transform","");$(a.leftPrevPage).css("visibility","hidden");a.rightSideGradient.style.visibility="hidden";a.leftSideGradient.style.visibility="hidden";$(a.leftSideDiv).css("overflow","visible");$(a.rightSideDiv).css("overflow","visible");b.turning=false;a.leftSideMediaDiv.style.visibility="";a.rightSideMediaDiv.style.visibility="";a.rightSide.element.dom.style.zIndex="8";a.leftSide.element.dom.style.zIndex="8";b.getInfinitecarousel().previous();a.playCssAnimations();$(a.rightSideNextPageContainer).css("display","none");$(a.leftSidePrevPageContainer).css("display","none");if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}setTimeout(function(){a.bottomLeftTapped=false},100);setTimeout(function(){if(!b.turning){b.getApplication().getController("PdfController").resumePage()}},300)}},0,0,0,0,0,0,[InfinityMobile.controller,"PageTurnController"],0));(Ext.cmd.derive("InfinityMobile.controller.PushController",Ext.app.Controller,{config:{refs:{main:"main"},control:{main:{initializepush:"initialisePush"}}},init:function(){var a=this;a.isPushEnabled=false},initialisePush:function(){var a=this;a.createManifest();if("serviceWorker" in navigator){}else{console.warn("Service workers aren't supported in this browser.")}},createManifest:function(){var a=this;a.manifest=document.createElement("link");$(a.manifest).attr("rel","manifest");$(a.manifest).attr("href","get_manifest_json.aspx?pubid="+publicationguid);document.head.appendChild(a.manifest)},intialiseState:function(){var a=this;if(!("showNotification" in ServiceWorkerRegistration.prototype)){console.warn("Notifications aren't supported");return}if(Notification.permission==="denied"){console.warn("The user has blocked notifications");return}if(!("PushManager" in window)){console.warn("Push messaging isn't suported");return}},subscribe:function(){var a=this;navigator.serviceWorker.ready.then((function(c){pushManager=c.pushManager;var b={pubid:publicationguid,pub:publicationName};navigator.serviceWorker.controller.postMessage(b);c.pushManager.getSubscription().then(function(d){c.pushManager.subscribe({userVisibleOnly:true}).then(function(e){a.isPushEnabled=true;return a.sendSubscriptionToServer(e)})})}))},unsubscribe:function(){var a=this;navigator.serviceWorker.ready.then(function(b){b.pushManager.getSubscription().then(function(c){})})},sendSubscriptionToServer:function(c){var b=this;var a={publicationguid:publicationguid,token:c.endpoint.substring(c.endpoint.indexOf("send/")+5,c.endpoint.length),udid:udid};$.ajax({type:"POST",url:"../register_device.aspx?debug=true",dataType:"json",data:JSON.stringify(a),success:function(d){}})}},0,0,0,0,0,0,[InfinityMobile.controller,"PushController"],0));(Ext.cmd.derive("InfinityMobile.controller.BookmarkController",Ext.app.Controller,{config:{refs:{main:"main",bookmarkContainer:"readerbookmark",bookmarkitem:"bookmarkitem",carousel:"infinitecarousel2d",articlescontainer:"articlescontainer"},control:{main:{bookmark:"showBookmarks"},bookmarkContainer:{close:"closeBookmarks",loadBookmarks:"loadBookmarks",addBookmark:"addBookmark",enableArticlesContainer:"enableArticlesContainer"},bookmarkitem:{loadPage:"loadBookmarkPage",deleteBookmark:"deleteBookmark"}}},init:function(){var a=this},showBookmarks:function(){var b=this;b.disableArticlesContainer();b.hideArticlesContainer();var c="InfinityMobile.view.tablet.ReaderBookmark";switch(currentProfile){case"phone":c="InfinityMobile.view.phone.ReaderBookmark";break;case"desktop":c="InfinityMobile.view.desktop.ReaderBookmark";break;case"tablet":default:c="InfinityMobile.view.tablet.ReaderBookmark";break}var a=Ext.create(c,{});Ext.Viewport.add(a);a.show()},hideArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().hide()}},loadBookmarks:function(b){var d=this;d.bookmarksJson=d.retrieveBookmarks();for(var c=0;c<d.bookmarksJson.length;c++){var a=d.bookmarksJson[c];d.addBookmarkItem(b,a)}},addBookmarkItem:function(b,c){var d=this;var a=Ext.create("InfinityMobile.view.BookmarkItem",{bookmarkItem:c});b.bookmarksContainer.add(a)},retrieveBookmarks:function(){var c=this;var b=[];try{if(localStorage.getItem("bookmarks"+editionguid)!=null){b=JSON.parse(localStorage.getItem("bookmarks"+editionguid))}}catch(a){}return b},setBookmarks:function(){var b=this;try{localStorage.setItem("bookmarks"+editionguid,JSON.stringify(b.bookmarksJson))}catch(a){}},addBookmark:function(h){var f=this;var g=h.addBookmarkTextBox;var j=f.retrievePageNumber();var c=f.getCarousel();if(typeof isTribReader!="undefined"&&isTribReader==true){if(f.getCarousel()._mode=="double"){j=editionFlatplanData.reversePageMapper[parseInt(j)]}j=flatPlanData.pageMapper[j];j=flatPlanData.pageGroups[j-1+pageOffset].pages[0].origPageNum}if(c.getActiveItem().xtype!="readeradvertpageviewer"){if(g.value!=""){var e=h.bookmarksContainer.getItems().items;var k=true;for(var b=0;b<e.length;b++){if(g.value==e[b].bookmarkItem.name){k=false}}if(k){var d={name:g.value,pageNumber:j};f.bookmarksJson.push(d);f.setBookmarks();f.addBookmarkItem(h,d);f.trackBookmarks("bookmarkAdded",d);f.resetTextBox(g)}else{f.setTextBoxValidation(g)}}else{f.setTextBoxValidation(g)}}else{var a=Ext.create("InfinityMobile.view.ReaderMessagePrompt",{message:language.bookmarks.bookmarkInvalidPage});Ext.Viewport.add(a);a.show()}},trackBookmarks:function(a,b){if(typeof trackReaderEvent!="undefined"){trackReaderEvent(a,b)}},removeBookmarkItem:function(a){var b=this;b.bookmarksJson.splice(a,1);b.setBookmarks()},setTextBoxValidation:function(b){var a=this;b.style.border="1px solid red"},resetTextBox:function(b){var a=this;b.style.border="";b.value=""},retrievePageNumber:function(){var c=this;var a=c.getCarousel();var b=(a._pageNumber+1);return b},loadBookmarkPage:function(e){var d=this;var b=e.bookmarkItem.pageNumber-1;b=flatPlanData.pdfPages!=null&&flatPlanData.pdfPages[b]!=null?flatPlanData.pdfPages[b].pages[0].pageNum-1:b;var a=d.getCarousel();var c=d.getBookmarkContainer();a.jumpToPage(b);d.closeBookmarks(c)},deleteBookmark:function(c){var d=this;var a=c.parent;var b=a.getItems().items.indexOf(c);d.removeBookmarkItem(b);a.remove(c)},closeBookmarks:function(a){var b=this;a.hide()},disableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().disableEvents()}},enableArticlesContainer:function(){var a=this;if(a.getArticlescontainer()!=null){a.getArticlescontainer().enableEvents()}}},0,0,0,0,0,0,[InfinityMobile.controller,"BookmarkController"],0));(Ext.cmd.derive("InfinityMobile.controller.TrackingController",Ext.app.Controller,{config:{refs:{main:"#rootPanel"},control:{main:{initTracking:"initTracking"}}},initTracking:function(){if(typeof(ReplicaAnalyticsDataLayer)!=="undefined"){this.replicaAnalyticsDataLayer=new ReplicaAnalyticsDataLayer(publicationName,publicationguid,null);this.trackEditionLoad()}},trackEditionLoad:function(){if(typeof trackReaderEvent!="undefined"){trackReaderEvent("editionLoad",{"edition-id":editionguid,"pub-id":publicationguid,"edition-name":editionName,"pub-name":publicationName,"edition-date":editionDate,"is-downloaded":false})}}},0,0,0,0,0,0,[InfinityMobile.controller,"TrackingController"],0));(Ext.cmd.derive("InfinityMobile.view.phone.StoryWindowPreferences",Ext.Container,{config:{id:"archivecontainer",width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"toolbar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{id:"toolbarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",layout:"vbox",width:"100%",flex:1,style:"background-color:white;border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em",scrollable:{direction:"vertical"},items:[{itemId:"containerText",margin:20,html:"If you turn this setting off, you will always return to the last page of the paper you viewed."},{itemId:"toggleSetting",padding:"20 20",margin:"0 0 40 0",width:"100%",style:"background-color:#eeeeee;position:relative;",html:"<div style=\"max-width:90%;\" >Return to page featuring last story viewed: </div><input class='pointerCursor' type='checkbox' style='margin-left:5px;position:absolute;right:20px;top:50%;transform:translate3d(0px, -50%, 0px);width:15px;height:15px;' class=\"pointerCursor\" onclick='if(this.checked){ this.checked = false; } else{ this.checked = true }' ></input>"}]}]},initialize:function(){var b=this;var a=b.getComponent("toolbar");b.toolbarClose=a.getComponent("toolbarClose");b.bodyContainer=b.getComponent("bodyContainer");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 1)"});b.title=a.getComponent("title");b.title.setHtml("Window Story Preferences");b.setToggleListener();b.setCloseListener();b.checkCurrentSetting()},setCloseListener:function(){var b=this;b.toolbarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolbarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.destroy()},setToggleListener:function(){var a=this;a.toggle=a.bodyContainer.getComponent("toggleSetting");a.toggle.element.on({tap:a.toggleCheck,scope:a})},toggleCheck:function(){var b=this;var d=$(b.toggle.element.dom).find("input");if(d.length>0){var c=d[0];if(c.checked){c.checked=false;try{localStorage.setItem("returnToPage"+publicationguid,"false")}catch(a){}}else{c.checked=true;try{localStorage.setItem("returnToPage"+publicationguid,"true")}catch(a){}}}},checkCurrentSetting:function(){var c=this;try{var b=localStorage.getItem("returnToPage"+publicationguid);var e=$(c.toggle.element.dom).find("input");if(b!=null&&e.length>0){var d=e[0];if(b=="true"){d.checked=true}else{if(b=="false"){d.checked=false}}}}catch(a){}}},0,["storywindowpreferences"],["component","container","storywindowpreferences"],{component:true,container:true,storywindowpreferences:true},["widget.storywindowpreferences"],0,[InfinityMobile.view.phone,"StoryWindowPreferences"],0));(Ext.cmd.derive("InfinityMobile.view.phone.DataCaptureForm",Ext.Container,{config:{height:"100%",width:"100%",fullscreen:true,modal:true,centered:true,style:"background-color:white;",scrollable:{direction:"vertical"},layout:{type:"vbox",packed:"middle"},items:[{itemId:"brandingLogo",height:120,width:"calc(100% - 10px)",margin:"20 10 20 10"},{itemId:"welcomeMsg",padding:"10 20 10 20",style:"text-align:center;"},{itemId:"form",padding:"20 20 20 20",defaults:{margin:"10 0 10 0"},items:[{itemId:"firstname",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="First Name"/>'},{itemId:"surname",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Last Name"/>'},{itemId:"email",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Email Address*"/>'},{itemId:"houseNo",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="House No/Name"/>'},{itemId:"address",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Address"/>'},{itemId:"postcode",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Postcode"/>'},{itemId:"telephone",width:"100%",height:50,html:'<input type="text" style="padding:20px 10px 20px 10px;height:40px;width:100%;" placeholder="Telephone No"/>'},{itemId:"required",html:"* Required Field",style:"font-size:12px;"},{itemId:"termsCheckbox",html:"<input type='checkbox' style:'height:10px;'/><label style='padding-left:5px;font-size:14px;'></label><a style='padding-left:5px;font-size:14px;'></a>"},{itemId:"updatedCheckbox",html:"<input type='checkbox' style:'height:10px;'/><label style='padding-left:5px;font-size:14px;'>Keep me updated on the latest news</label>"},{itemId:"errorMsg",hidden:true,html:"*Please make sure the required fields above are completed.",style:"color:red;"}]},{itemId:"buttonContainer",width:"calc(100%-10px)",height:180,layout:{type:"vbox",pack:"middle"},padding:"10 20 10 20",defaults:{margin:"10 0 10 0"},items:[{itemId:"registerBtn",height:60,width:"calc(100%-10px)",style:"text-align:center;vertical-align: middle;line-height:60px;",html:"<p>Register</p>"},{itemId:"skipBtn",height:60,width:"100%",style:"text-align:center;color:rgb(155, 155, 155);background-color:rgb(229, 229, 229;vertical-align:middle;line-height:60px;",html:"Skip"}]}]},initialize:function(){var a=this;if(a.config.logo!=null){a.logo=a.config.logo}if(a.config.welcomeText!=null){a.welcomeText=a.config.welcomeText}if(a.config.settings!=null){a.settings=a.config.settings}a.brandingLogo=a.getComponent("brandingLogo");a.welcomeTextArea=a.getComponent("welcomeMsg");a.form=a.getComponent("form");a.buttonContainer=a.getComponent("buttonContainer");a.registerBtn=a.buttonContainer.getComponent("registerBtn");a.skipBtn=a.buttonContainer.getComponent("skipBtn");a.errorMsg=a.form.getComponent("errorMsg");a.termsCheck=a.form.getComponent("termsCheckbox");a.brandingLogo.setStyle({backgroundImage:"url("+a.logo+")",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"});a.welcomeTextArea.setHtml(language.dataCapture.containerText);a.setupFormFields();a.setupTouchDevices();a.registerBtn.element.on({tap:a.register,scope:a});a.registerBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.skipBtn.element.on({tap:function(){this.fireEvent("closeDataCapture",this);this.destroy()},scope:a})},setupTouchDevices:function(){var a=this;var b=function(){this.focus()};a.firstname.element.on({tap:b});a.surname.element.on({tap:b});a.email.element.on({tap:b});a.houseNo.element.on({tap:b});a.address.element.on({tap:b});a.postcode.element.on({tap:b});a.telephone.element.on({tap:b});a.updatedCheckbox.element.on({tap:b});a.termsCheck.element.on({tap:b})},setupFormFields:function(){var a=this;a.firstname=a.form.getComponent("firstname");a.surname=a.form.getComponent("surname");a.email=a.form.getComponent("email");a.houseNo=a.form.getComponent("houseNo");a.address=a.form.getComponent("address");a.postcode=a.form.getComponent("postcode");a.telephone=a.form.getComponent("telephone");a.updatedCheckbox=a.form.getComponent("updatedCheckbox");a.hasTerms=false;$(a.email.element.down("input").dom).attr("placeholder",language.dataCapture.email+"*");a.requiredText=a.form.getComponent("required");a.requiredText.setHtml(language.dataCapture.required);if(a.settings.firstname!=null){if(a.settings.firstname.hasFirstname!=null){if(a.settings.firstname.required=="true"){$(a.firstname.element.down("input").dom).attr("placeholder",language.dataCapture.firstName+"*");a.firstname.required=true}else{$(a.firstname.element.down("input").dom).attr("placeholder",language.dataCapture.firstName);a.firstname.required=false}}else{a.firstname.hide()}}else{a.firstname.hide()}if(a.settings.surname!=null){if(a.settings.surname.hasSurname!=null){if(a.settings.surname.required=="true"){$(a.surname.element.down("input").dom).attr("placeholder",language.dataCapture.lastName+"*");a.surname.required=true}else{$(a.surname.element.down("input").dom).attr("placeholder",language.dataCapture.lastName);a.surname.required=false}}else{a.surname.hide()}}else{a.surname.hide()}if(a.settings.houseNo!=null){if(a.settings.houseNo.hasHouseNo!=null){if(a.settings.houseNo.required=="true"){$(a.houseNo.element.down("input").dom).attr("placeholder",language.dataCapture.houseNo+"*");a.houseNo.required=true}else{$(a.houseNo.element.down("input").dom).attr("placeholder",language.dataCapture.houseNo);a.houseNo.required=false}}else{a.houseNo.hide()}}else{a.houseNo.hide()}if(a.settings.address!=null){if(a.settings.address.hasAddress!=null){if(a.settings.address.required=="true"){$(a.address.element.down("input").dom).attr("placeholder",language.dataCapture.address+"*");a.address.required=true}else{a.address.required=false;$(a.address.element.down("input").dom).attr("placeholder",language.dataCapture.address)}}else{a.address.hide()}}else{a.address.hide()}if(a.settings.postcode!=null){if(a.settings.postcode.hasPostcode!=null){if(a.settings.postcode.required=="true"){$(a.postcode.element.down("input").dom).attr("placeholder",language.dataCapture.postCode+"*");a.postcode.required=true}else{$(a.postcode.element.down("input").dom).attr("placeholder",language.dataCapture.postCode);a.postcode.required=false}}else{a.postcode.hide()}}else{a.postcode.hide()}if(a.settings.telephone!=null){if(a.settings.telephone.hasTelephone!=null){if(a.settings.telephone.required=="true"){$(a.telephone.element.down("input").dom).attr("placeholder",language.dataCapture.telephone+"*");a.telephone.required=true}else{$(a.telephone.element.down("input").dom).attr("placeholder",language.dataCapture.telephone);a.telephone.required=false}}else{a.telephone.hide()}}else{a.telephone.hide()}if(a.settings.hasOptIn=="true"){a.updatedCheckbox.element.down("label").dom.innerHTML=language.dataCapture.optIn}else{a.updatedCheckbox.hide()}if(a.settings.terms!=null){a.hasTerms=true;if(a.settings.terms.termsUrl!=null){a.termsCheck.element.down("a").dom.href=a.settings.terms.termsUrl;a.termsCheck.element.down("a").dom.innerHTML=language.dataCapture.terms}else{a.termsCheck.element.down("label").dom.innerHTML=language.dataCapture.terms}}else{a.termsCheck.hide()}a.registerBtn.setHtml(language.register);if(a.settings.showSkip!="true"){a.skipBtn.hide()}else{a.skipBtn.setHtml(language.skip)}},register:function(){var t=this;var d=false;var l={};var q=null;var k=null;var p=null;var h=null;var e=null;var u=null;var s=null;var f=t.firstname.element.down("input").dom;var n=t.surname.element.down("input").dom;var r=t.email.element.down("input").dom;var c=t.houseNo.element.down("input").dom;var a=t.address.element.down("input").dom;var b=t.postcode.element.down("input").dom;var m=t.telephone.element.down("input").dom;var o=t.updatedCheckbox.element.down("input");var j=t.termsCheck.element.down("input");if(t.firstname.required){if(f.value.length==0){f.style.border="1px solid red";d=true}else{l.firstname=f.value;f.style.border=""}}else{if(f.value.length>0){l.firstname=f.value}}if(t.surname.required){if(n.value.length==0){n.style.border="1px solid red";d=true}else{l.surname=n.value;n.style.border=""}}else{if(n.value.length>0){l.surname=n.value}}if(t.validateEmail(r.value)){if(r.value.length==0){r.style.border="1px solid red";d=true}else{l.email=r.value;r.style.border=""}}else{r.style.border="1px solid red";d=true}if(t.houseNo.required){if(c.value.length==0){c.style.border="1px solid red";d=true}else{l.houseNo=c.value;c.style.border=""}}else{if(c.value.length>0){l.houseNo=c.value}}if(t.address.required){if(a.value.length==0){a.style.border="1px solid red";d=true}else{l.address=a.value;a.style.border=""}}else{if(a.value.length>0){l.houseNo=a.value}}if(t.postcode.required){if(b.value.length==0){b.style.border="1px solid red";d=true}else{l.postcode=b.value;b.style.border=""}}else{if(b.value.length>0){l.postcode=b.value}}if(t.telephone.required){if(m.value.length==0){m.style.border="1px solid red";d=true}else{l.telephone=m.value;m.style.border=""}}else{if(m.value.length>0){l.postcode=m.value}}if(!t.updatedCheckbox.isHidden()){if(o.is(":checked")){l.keepMeUpdated="true"}}var g=true;if(!t.termsCheck.isHidden()){if(j.dom.checked){g=true}else{g=false}}if(d||!g){t.errorMsg.show()}else{t.fireEvent("sendData",t,l);t.destroy()}console.log(l)},validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}},0,["datacaptureform"],["component","container","datacaptureform"],{component:true,container:true,datacaptureform:true},["widget.datacaptureform"],0,[InfinityMobile.view.phone,"DataCaptureForm"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemWeatherTile",Ext.Container,{config:{cls:"articlereaderitemweathertile",style:"float:left;z-index:6;background-color:#9fb0b9;",layout:"hbox",items:[{itemId:"title",layout:"vbox",flex:1,items:[{html:"<p class='.thirteen' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;padding:20px 0px 0px 20px;'>WEATHER</p>"},{itemId:"location"},{itemId:"desc"}]},{itemId:"temp",flex:1,items:[{itemId:"tempDisplay",centered:true}]},{itemId:"toggle",layout:"vbox",padding:20,flex:1,items:[{itemId:"toggleContainer",layout:{type:"hbox",pack:"center",align:"middle"},flex:1,items:[{html:"<p style='color:white;font-size:13px;padding-right:5px;padding-top:0.2em;'>&deg;C</p>"},{cls:"toggle",itemId:"toggleField",xtype:"togglefield",style:"background:transparent;"},{html:"<p style='color:white;font-size:13px;padding-left:5px;padding-top:0.2em;'>&deg;F</p>"}]},{itemId:"weatherIcon",flex:5}]}]},initialize:function(){var d=this;Ext.Container.prototype.initialize.apply(this,arguments);if(d.config.articleIndex!=null){d.articleIndex=d.config.articleIndex}if(d.config.weather!=null){d.weather=d.config.weather}if(d.config.carousel!=null){d.carousel=d.config.carousel}if(d.config.title!=null){d.title=d.config.title}var e=d.getComponent("title");var h=e.getComponent("location");var j=e.getComponent("desc");d.tempDisplay=d.getComponent("temp").getComponent("tempDisplay");var c=d.getComponent("toggle");d.toggle=c.getComponent("toggleContainer").getComponent("toggleField");var a=c.getComponent("weatherIcon");d.currentUnit="C";h.setHtml("<p class='twentyFour' style='color:white;font-family:Open Sans, sans-serif;font-size:24px;font-weight:bold;padding:5px 0px 0px 20px;'>"+d.title.substring(0,d.title.indexOf(","))+"</p>");var f=d.weather[0].content.split(",");d.tempC=f[0].substring(f[0].indexOf(":")+2,f[0].indexOf("C"));d.tempF=f[0].substring(f[0].indexOf("(")+1,f[0].indexOf("F"));var g=d.weather[0].title.split(",");var b=g[0].split(":");j.setHtml("<p class='twentyFour' style='color:white;font-family:Open Sans, sans-serif;font-size:20px;font-weight:normal;padding:5px 0px 0px 20px;'>"+b[1]+"</p>");d.tempDisplay.setHtml("<p style='color:white;font-family:Open Sans, sans-serif;font-size:28px;font-weight:normal;'>"+d.tempC+"C</p>");switch(b[1].trim().toLowerCase()){case"light cloud":var k="../assets/weather/white-cloud-ic.png";break;case"white cloud":var k="../assets/weather/white-cloud-ic.png";break;case"heavy rain":var k="../assets/weather/rain-ic.png";break;case"light rain":var k="../assets/weather/rain-ic.png";break;case"light rain shower":var k="../assets/weather/rain-ic.png";break;case"heavy rain shower":var k="../assets/weather/rain-ic.png";break;case"sunny intervals":var k="../assets/weather/sun-cloud-ic.png";break;case"thick cloud":var k="../assets/weather/black-cloud-ic.png";break;case"sunny":var k="../assets/weather/sun-ic.png";break;case"clear sky":var k="../assets/weather/sun-ic.png";break}if(b[1].trim().indexOf("Thunder")!=-1){var k="../assets/weather/thunder-ic.png"}if(b[1].trim().indexOf("Ice")!=-1){var k="../assets/weather/ice-ic.png"}if(b[1].trim().indexOf("Snow")!=-1){var k="../assets/weather/snow-cloud-ic.png"}a.setStyle({backgroundImage:"url('"+k+"')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});d.toggle.on({change:function(m){var l=this;if(l.currentUnit=="C"){l.tempDisplay.setHtml("<p style='color:white;font-family:Open Sans, sans-serif;font-size:28px;font-weight:normal;'>"+l.tempF+"F</p>");l.currentUnit="F"}else{l.tempDisplay.setHtml("<p style='color:white;font-family:Open Sans, sans-serif;font-size:28px;font-weight:normal;'>"+l.tempC+"C</p>");l.currentUnit="C"}},scope:d})},onResize:function(){var a=this;a.onResizeFn()}},0,["articlereaderitemweathertile"],["component","container","articlereaderitemweathertile"],{component:true,container:true,articlereaderitemweathertile:true},["widget.articlereaderitemweathertile"],0,[InfinityMobile.view.phone,"ArticleReaderItemWeatherTile"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderBannerAd",Ext.Panel,{config:{style:"padding:0px:overflow:none;",width:"100%",height:50,items:[{itemId:"advert",cls:"advert"}]},initialize:function(){var b=this;b.advertContainer=b.getComponent("advert");var a=settings.dynamic.adverts.bannerAd;if(a!=null){if(a.type!="image"){b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";var c=($(document).width()-20-320)/2;b.advertContainer.setHtml("<div id='"+b.advertDivID+"' style='width:734px;height:95px;margin-left:"+c+"px;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.on("painted",b.loadAdvert,b,{delay:10,single:true});b.on("resize",b.onResizeFn,b)}else{b.advertContainer.setHtml("<div style='width:100%;height:100%;text-align:center;margin:auto;'><img style='height:50px;margin-left:5px;margin-right:5px;width:320px;' src='"+a.url+"' /></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.on("painted",b.loadAdvert,b,{delay:10,single:true});b.on("resize",b.onResizeFn,b)}}else{b.advertContainer.setHtml("<div style='width:100%;height:100%;text-align:center;margin:auto;'><img style='height:50px;margin-left:5px;margin-right:5px;width:320px;' src='"+a.url+"' /></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.on("painted",b.loadAdvert,b,{delay:10,single:true});b.on("resize",b.onResizeFn,b)}},loadAdvert:function(){var a=this;googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("320"),parseInt("50")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})},onResizeFn:function(a){var d=this;if(d.advertDiv!=null){if(d.advertDiv.down("iframe")!=null){var c=d.advertDiv.down("iframe").dom;var b=c.contentDocument||c.contentWindow.document;var f=document.createElement("script");f.innerHTML='setTimeout(function(){ document.addEventListener("touchmove", function (e) { e.preventDefault(); }); }, 500)';b.addEventListener("touchmove",function(g){g.preventDefault()});b.body.appendChild(f);var e=($(document).width()-20-320)/2;$(d.advertDiv.dom).css("margin-left",e+"px");d.advertDiv.dom.addEventListener("touchmove",function(g){g.preventDefault()})}}}},0,["articlereaderbannerad"],["component","container","panel","articlereaderbannerad"],{component:true,container:true,panel:true,articlereaderbannerad:true},["widget.articlereaderbannerad"],0,[InfinityMobile.view.phone,"ArticleReaderBannerAd"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemTopStoryItem",Ext.Panel,{config:{style:"float:left;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:0,top:0,left:0,right:0,cls:"backgroundImage aspectfill"},{itemId:"title",style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold",bottom:5,top:5,left:5,right:5,height:"100%",padding:10}]},initialize:function(){var a=this;a.article=a.config.article;a.expand=false;if(a.config.articleIndex!=null){a.articleIndex=a.config.articleIndex}if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setStyle("height:100%;");a.height=100;a.timer;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.background="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;left:0px;right;0px;top:0px;bottom:0px;");c.titleContainer.element.dom.style.height="";c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.titleContainer.setHtml("<div style='position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;'>"+c.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;'>"+c.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;>"+c.article.byline+"</p></div>")},setNoImage:function(){var c=this;c.titleContainer.resetFloating();c.titleContainer.setStyle("background-color:#EEEEEE; color:black;");var b="";if(c.article.sections.length>1){for(var a=0;a<c.article.sections.length;a++){b+=c.article.sections[a]+"/"}b=b.substring(0,b.length-1)}else{if(c.article.sections[0]!=null){b=c.article.sections[0]}}var d=Ext.create("Ext.Container",{itemId:"title",html:"<p style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+b+"</p><p style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+c.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+c.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;>"+c.article.byline+"</p>"});c.titleContainer.add(d);if(c.article.body.indexOf("<p>")!=-1){c.article.body=c.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}c.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",flex:1,width:"100%",html:c.article.body,style:"overflow:hidden;font-size:12px;font-weight:normal;font-family:Open Sans, sans-serif;z-index:16;padding:5px;",padding:5,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},onTap:function(){var d=this;var b=d.parent.parent.element;var c=false;if(c){d.fireEvent("articleClick",d.article,d.article.guid)}else{if(!d.hasImage){if(d.titleContainer.getComponent("articleBody")!=null){if(d.titleContainer.getComponent("articleBody").isHidden()){d.titleContainer.getComponent("articleBody").show()}else{d.titleContainer.getComponent("articleBody").hide()}}}clearInterval(d.timer);if(!d.expand){d.fireEvent("tileTapped",d);d.titleContainer.setScrollable(true);d.titleContainer.getScrollable().getScroller().setDirectionLock(true);if(d.titleContainer.getComponent("title")!=null){if(d.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){d.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="18px"}if(d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="32px"}if(d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="20px"}if(d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="18px"}}if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(d.hasImage){d.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292;z-index:16;",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(b.dom.scrollHeight*0.6),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+d.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+d.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+d.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+d.article.body+"</p>"}]});d.imageContainer.hide();d.titleContainer.hide();d.articlePop.getComponent("image").element.dom.style.background="url('"+d.firstImage.url+"')";d.add(d.articlePop);d.articlePop.getComponent("title").element.dom.style.position="relative";d.articlePop.getComponent("title").element.down("div").dom.style.width="758px";d.articlePop.getScrollable().getScroller().on({scroll:function(j){var h=d.articlePop.getComponent("image").element.dom.style.height.substring(0,d.articlePop.getComponent("image").element.dom.style.height.length-2);var g=d.articlePop.getScrollable().getScroller().position.y;var f=d.articlePop.getComponent("image").element.dom.style.height.substring(0,d.articlePop.getComponent("image").element.dom.style.height.length-2);if(((h-g)/f)>0){d.articlePop.getComponent("image").element.dom.style.top=(g)+"px";d.articlePop.getComponent("image").element.dom.style.opacity=((h-g)/f)}}})}else{var a=d.titleContainer.getScrollable().getScroller();console.log(d.titleContainer);d.titleContainer.element.dom.style.zIndex=14}d.element.dom.style.position="absolute";d.element.dom.style.left="0px",d.element.dom.style.top="0px";b.dom.style.zIndex=8;d.expand=true;b.dom.style.animation=d.expandAnim;d.element.dom.style.animationFillMode="forwards"}else{if(d.titleContainer.getComponent("title")!=null){d.titleContainer.setScrollable(false);if(d.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){d.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){d.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}if(d.hasImage){if(d.articlePop!=null){d.articlePop.destroy()}d.imageContainer.show();d.titleContainer.show()}else{if(d.titleContainer.getComponent("articleBody")!=null){d.titleContainer.getComponent("articleBody").hide()}}d.expand=false;b.dom.style.animation=d.shrinkAnim}}},liveTap:function(){var a=this;window.open(a.article.url)},testFunc:function(){console.log("TEST")}},0,["articlereaderitemtopstoryitem"],["component","container","panel","articlereaderitemtopstoryitem"],{component:true,container:true,panel:true,articlereaderitemtopstoryitem:true},["widget.articlereaderitemtopstoryitem"],0,[InfinityMobile.view.phone,"ArticleReaderItemTopStoryItem"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemPhone",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;z-index:7;overflow:hidden;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;overflow:hidden;",height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setHeight(200);a.setWidth("50%");a.height=200;a.width=$(a.element.dom).width();a.x=a.element.dom.style.left.substring(0,a.element.dom.style.left.length-2);a.y=a.element.dom.style.top.substring(0,a.element.dom.style.top.length-1);a.top=a.y;a.left=a.x;a.timer;a.timer2;a.timer3;a.timer4;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.setBackgroundImage()}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},loadImage:function(){var a=this;if(a.hasImage){if(!a.imageLoaded){if(a.firstImage.url.indexOf("image_resize.aspx")==-1){a.imageContainer.element.dom.style.background="url('image_resize.aspx?w=400&url="+a.firstImage.url+"')"}else{a.imageContainer.element.dom.style.background="url('"+a.firstImage.url+"')"}a.imageContainer.element.dom.style.backgroundSize="cover";a.imageContainer.element.dom.style.backgroundPosition="50% 0%";a.imageContainer.element.dom.style.backgroundColor="gray";a.imageLoaded=true}}},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.imageLoaded=false;c.firstImage=a[0];c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.titleContainer.setHtml("<div style='position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:semibold;'>"+c.article.headline+"</p></div>")},setNoImage:function(){var b=this;b.hasImage=false;b.titleContainer.resetFloating();b.titleContainer.setStyle("background-color:#EEEEEE; color:black;");b.sectionStr="";if(b.article.sections.length>1){for(var a=0;a<b.article.sections.length;a++){b.sectionStr+=b.article.sections[a]+"/"}b.sectionStr=b.sectionStr.substring(0,sectionStr.length-1)}else{if(b.article.sections[0]!=null){b.sectionStr=b.article.sections[0]}}var c=Ext.create("Ext.Container",{itemId:"title",html:"<p style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+b.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:semibold;padding-top:5px;padding-bottom:5px;overflow:hidden;'>"+b.article.headline+"</p>"});b.titleContainer.add(c);if(b.article.body!=null){if(b.article.body.indexOf("<p>")!=-1){b.article.body=b.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}b.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",flex:1,width:"100%",html:b.article.body,style:"overflow:hidden;font-size:12px;font-weight:normal;font-family:Open Sans, sans-serif;padding-bottom:5px;",padding:5,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},onTap:function(){var c=this;var b=true;if(b&&c.sectionStr.indexOf("LIVE NEWS")==-1){c.fireEvent("articleClick",c.article,c.article.guid)}else{if(b&&c.sectionStr.indexOf("LIVE NEWS")!=1){c.fireEvent("liveArticleClick",c.article)}else{if(!c.hasImage){if(c.titleContainer.getComponent("articleBody").isHidden()){c.titleContainer.getComponent("articleBody").show()}else{c.titleContainer.getComponent("articleBody").hide()}}clearInterval(c.timer);clearInterval(c.timer2);clearInterval(c.timer3);clearInterval(c.timer);if(!c.expand){c.fireEvent("tileTapped",c);c.titleContainer.setScrollable(true);c.titleContainer.getScrollable().getScroller().setDirectionLock(true);if(c.titleContainer.getComponent("title")!=null){if(c.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){c.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="18px"}if(c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="32px"}if(c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="20px"}if(c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="18px"}}if(c.article.body.indexOf("<p>")!=-1){c.article.body=c.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(c.hasImage){c.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(c.imageContainer.element.dom.scrollHeight*2.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+c.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+c.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+c.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+c.article.body+"</p>"}]});c.imageContainer.hide();c.titleContainer.hide();c.articlePop.getComponent("image").element.dom.style.background="url('"+c.firstImage.url+"')";c.add(c.articlePop);c.articlePop.getComponent("title").element.dom.style.position="relative";c.articlePop.getComponent("title").element.down("div").dom.style.width="758px";c.articlePop.getScrollable().getScroller().on({scroll:function(h){var g=c.articlePop.getComponent("image").element.dom.style.height.substring(0,c.articlePop.getComponent("image").element.dom.style.height.length-2);var f=c.articlePop.getScrollable().getScroller().position.y;var d=c.articlePop.getComponent("image").element.dom.style.height.substring(0,c.articlePop.getComponent("image").element.dom.style.height.length-2);if(((g-f)/d)>0){c.articlePop.getComponent("image").element.dom.style.top=(f)+"px";c.articlePop.getComponent("image").element.dom.style.opacity=((g-f)/d)}}})}else{var a=c.titleContainer.getScrollable().getScroller();a.container.dom.offsetParent.style.zIndex=14}c.element.dom.style.position="absolute";c.element.dom.style.zIndex=10;c.expand=true;c.element.dom.style.mozAnimation=c.expandAnim;c.element.dom.style.animation=c.expandAnim;c.element.dom.style.animationFillMode="forwards"}else{if(c.titleContainer.getComponent("title")!=null){c.titleContainer.setScrollable(false);if(c.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){c.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){c.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}if(c.hasImage){c.articlePop.destroy();c.imageContainer.show();c.titleContainer.show()}c.expand=false;c.element.dom.style.animation=c.shrinkAnim;c.element.dom.style.zIndex=6}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemphone"],["component","container","panel","articlereaderitemphone"],{component:true,container:true,panel:true,articlereaderitemphone:true},["widget.articlereaderitemphone"],0,[InfinityMobile.view.phone,"ArticleReaderItemPhone"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemTopStories",Ext.Container,{config:{width:"100%",style:"float:left;z-index:6;background-color:white;",items:[{itemId:"carousel",xtype:"carousel",top:5,bottom:5,left:5,right:5,margin:10,direction:"horizontal",style:"z-index:6;"}]},initialize:function(){var d=this;Ext.Container.prototype.initialize.apply(this,arguments);d.carousel=d.getComponent("carousel");if(d.config.articles!=null){d.articles=d.config.articles}if(d.config.expandAnim!=null){d.expandAnim=d.config.expandAnim}d.setHeight(150);d.objects=[];for(var c=0;c<d.articles.length;c++){var a=Ext.create("InfinityMobile.view.phone.ArticleReaderItemTopStoryItem",{style:"position:absolute;top:0px;left;0px;height:100%;",article:d.articles[c],articleIndex:c,expandAnim:d.expandAnim});d.objects[d.objects.length]=a;d.carousel.add(a)}var f=[];var e;var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.dynamic.weather!=null){if(b.data.items[0].raw.dynamic.weather.url!=null){$.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&q="+encodeURIComponent(b.data.items[0].raw.dynamic.weather.url),dataType:"json",success:function(g){$.each(g.responseData.feed.entries,function(j,k){f[f.length]=k;e=g.responseData.feed.title.substring(g.responseData.feed.title.indexOf("for")+4,g.responseData.feed.title.length)});var h=Ext.create("InfinityMobile.view.phone.ArticleReaderItemWeatherTile",{weather:f,title:e,articleIndex:d.objects.length,carousel:d,expandAnim:d.expandAnim});d.objects[d.objects.length]=h;d.carousel.add(h)}})}}},handleItemChange:function(){var a=this}},0,["articlereaderitemtopstories"],["component","container","articlereaderitemtopstories"],{component:true,container:true,articlereaderitemtopstories:true},["widget.articlereaderitemtopstories"],0,[InfinityMobile.view.phone,"ArticleReaderItemTopStories"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderItemContainer",Ext.Container,{config:{width:"calc(100%)",height:600}},0,["articlereaderitemcontainer"],["component","container","articlereaderitemcontainer"],{component:true,container:true,articlereaderitemcontainer:true},["widget.articlereaderitemcontainer"],0,[InfinityMobile.view.phone,"ArticleReaderItemContainer"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleReaderPanelContainer",Ext.Container,{config:{cls:"articlereaderpanelcontainer",layout:{type:"vbox"},style:"margin: 10px;"},initialize:function(){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.dynamic.adverts!=null){if(a.data.items[0].raw.dynamic.adverts.hasBannerAd=="true"){b.setHeight(1250)}else{b.setHeight(1180)}}else{b.setHeight(1180)}}},0,["articlereaderpanelcontainer"],["component","container","articlereaderpanelcontainer"],{component:true,container:true,articlereaderpanelcontainer:true},["widget.articlereaderpanelcontainer"],0,[InfinityMobile.view.phone,"ArticleReaderPanelContainer"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ClippingOptionsMenu",Ext.Container,{config:{id:"clippingmenu",width:"100%",height:"100%",style:"background:white !important;",layout:"vbox",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{id:"clippingOptionsToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,scrollable:{direction:"vertical"},items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0",html:"<p style='font-size:14px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><p style='font-size:10px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p>"},{id:"clippingsContainer",itemId:"clippingsContainer",style:"border: 1px solid #e6e6e6;",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:140,height:140,margin:"7 8 16 7",cls:"archiveitemphone"}},{itemId:"buttonsContainer",layout:"hbox",height:60,items:[{itemId:"previewBtn",flex:1,cls:"btn",margin:"15 5 5 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/preview-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Preview",margin:5,style:"color:white;font-size:10pt;"}]},{itemId:"downloadBtn",flex:1,cls:"btn",margin:"15 0 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/downloads-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Save",margin:5,style:"color:white;font-size:10pt;"}]}]},{itemId:"printButtonContainer",layout:"hbox",height:50,items:[{itemId:"printBtn",cls:"btn",flex:1,margin:"5 0 5 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/print-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Print",margin:5,style:"color:white;font-size:11pt;text-align:center;"}]}]},{itemId:"shareButtonContainer",layout:"hbox",height:60,items:[{itemId:"shareBtn",cls:"btn",flex:2,margin:"5 0 15 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/share-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Share",margin:5,style:"color:white;font-size:11pt;"}]}]}]}]},initialize:function(){var b=this;b.clippingsToolbar=b.getComponent("clippingOptionsToolBar");b.clippingsToolbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.closeBtn=b.clippingsToolbar.getComponent("clippingOptionsToolBarClose");b.clippingsBody=b.getComponent("clippingOptionsBodyContainer");b.clippingsContainer=b.clippingsBody.getComponent("clippingsContainer");b.buttonsContainer=b.clippingsBody.getComponent("buttonsContainer");b.shareButtonContainer=b.clippingsBody.getComponent("shareButtonContainer");b.previewBtn=b.buttonsContainer.getComponent("previewBtn");b.downloadBtn=b.buttonsContainer.getComponent("downloadBtn");b.shareBtn=b.shareButtonContainer.getComponent("shareBtn");b.printButtonContainer=b.clippingsBody.getComponent("printButtonContainer");b.printBtn=b.printButtonContainer.getComponent("printBtn");b.title=b.clippingsToolbar.getComponent("title");b.title.setHtml(language.clippings.clippingsOptions);b.clippingOptionsContainerText=b.clippingsBody.getComponent("clippingOptionsContainerText");b.clippingOptionsContainerText.setHtml("<p style='font-size:16px;'>"+language.clippings.ClippingsOptionsText+"</p><br /><p style='font-size:12px;color:#444444'>"+language.clippings.clippingsPleaseNote+"</p>");b.previewBtn.getComponent("Preview").setHtml(language.clippings.preview);b.downloadBtn.getComponent("Save").setHtml(language.clippings.save);b.shareBtn.getComponent("Share").setHtml(language.clippings.share);b.printBtn.getComponent("Print").setHtml(language.clippings.print);b.previewBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.downloadBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.printBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.shareBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.closeBtn.element.on("tap",function(){b.destroy()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeBtn.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}if(b.config.images!=null){b.images=b.config.images}if(b.config.widths!=null){b.widths=b.config.widths}if(b.config.heights!=null){b.heights=b.config.heights}b.addThumbnails();b.previewBtn.element.on({tap:b.preview,scope:b});b.downloadBtn.element.on({tap:b.download,scope:b});b.shareBtn.element.on({tap:b.shareTap,scope:b});b.printBtn.element.on({tap:b.print,scope:b})},preview:function(){var d=this;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c=true;break}}if(c){var a=Ext.create("InfinityMobile.view.ClippingMenuPreview",{images:d.images,clippingMenu:d})}else{d.promptUser(language.clippings.selectClippings)}},download:function(){var f=this;var c=false;var e=document.createEvent("MouseEvents");var d=null;var a=false;for(var b=0;b<f.images.length;b++){if(f.clippingsContainer.innerItems[b].clicked){if(!c){d=document.createElement("a");d.target="_blank";d.href=f.images[b];d.download="clipping"+b+".jpg";e.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);c=true}else{a=true;break}}}if(a){f.promptUser(language.clippings.selectOneClipping)}else{if(d!=null){d.dispatchEvent(e)}}if(!c){f.promptUser(language.clippings.selectClippings)}},print:function(){var e=this;var f=false;var d="";for(var c=0;c<e.images.length;c++){var b=e.images[c];if(e.clippingsContainer.innerItems[c].clicked){if(!f){f=true}d+="<div style='width:100%; height:100%; position:relative'>";d+="<img src='"+b+"' style='height:auto;width:auto;max-height:100%;max-width:100%;' />";d+="</div>"}}if(f){var a=Ext.create("InfinityMobile.view.PrintPreview",{doc:d,imgCheck:true});Ext.Viewport.add(a);a.show()}else{e.promptUser(language.clippings.selectClippings)}},shareTap:function(){var d=this;d.shareBtn.removeAll();d.shareBtn.element.dom.style.backgroundColor="#e6e6e6";var b=[{itemId:"email",width:30,height:30,style:'background-image:url("resources/images/reader icons/mail.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"facebook",width:30,height:30,style:'background-image:url("resources/images/reader icons/facebook.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"twitter",width:30,height:30,style:'background-image:url("resources/images/reader icons/twitter.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"linkedin",width:30,height:30,style:'background-image:url("resources/images/reader icons/linkedin.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"google",width:30,height:30,style:'background-image:url("resources/images/reader icons/Google.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"pinterest",width:30,height:30,style:'background-image:url("resources/images/reader icons/pinterest.png");background-size:contain;background-position:center;background-repeat:no-repeat;'}];d.shareBtn.add(b);var a=Ext.getStore("SettingStore");d.emailBtn=d.shareBtn.getComponent("email");d.facebookBtn=d.shareBtn.getComponent("facebook");d.twitterBtn=d.shareBtn.getComponent("twitter");d.linkedinBtn=d.shareBtn.getComponent("linkedin");d.googleBtn=d.shareBtn.getComponent("google");d.pinterestBtn=d.shareBtn.getComponent("pinterest");var c=a.data.items[0].raw.sharing;if(c.allSharing[0]==null){d.emailBtn.hide()}else{d.emailBtn.element.on({tap:d.emailShare,scope:d})}if(c.allSharing[1]==null){d.facebookBtn.hide()}else{d.facebookBtn.element.on({tap:d.facebookShare,scope:d})}if(c.allSharing[2]==null){d.twitterBtn.hide()}else{d.twitterBtn.element.on({tap:d.twitterShare,scope:d})}if(c.allSharing[3]==null){d.linkedinBtn.hide()}else{d.linkedinBtn.element.on({tap:d.linkedinShare,scope:d})}if(c.allSharing[4]==null){d.googleBtn.hide()}else{d.googleBtn.element.on({tap:d.googleShare,scope:d})}if(c.allSharing[5]==null){d.pinterestBtn.hide()}else{d.pinterestBtn.element.on({tap:d.pinterestShare,scope:d})}},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingItems",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingsContainer.add(c);c.show()}},promptUser:function(b){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:b})},emailShare:function(){var d=this;var e=false;var a="mailto:?subject="+encodeURIComponent("Clippings from "+publicationName)+"&body=";var c="To view a clipping, please select one of the links below:\n";for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c+=d.images[b]+" \n";e=true}}if(e){window.location.href=a+encodeURIComponent(c)}else{d.promptUser(language.clippings.selectClippings)}},facebookShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=encodeURIComponent(d.images[b]);c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://www.facebook.com/sharer/sharer.php?m2w&u="+a+"&title=Clipping from "+publicationName)}else{d.promptUser(e)}},twitterShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.images[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://twitter.com/intent/tweet?text=Clipping from "+publicationName+" - "+a)}else{d.promptUser(e)}},linkedinShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.images[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://www.linkedin.com/shareArticle?mini=true&url="+a+"&title=Clipping from "+publicationName)}else{d.promptUser(e)}},googleShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.images[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("https://plus.google.com/share?url="+a)}else{d.promptUser(e)}},pinterestShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.images[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://pinterest.com/pin/create/bookmarklet/?media="+a+"&is_video=false&description=Clipping from "+publicationName)}else{d.promptUser(e)}}},0,["clippingoptionsmenu"],["component","container","clippingoptionsmenu"],{component:true,container:true,clippingoptionsmenu:true},["widget.clippingoptionsmenu"],0,[InfinityMobile.view.phone,"ClippingOptionsMenu"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ClippingArea",Ext.Panel,{config:{modal:true,hideOnMaskTap:true,fullscreen:true,style:"position:absolute;top:-100%;",items:[{itemId:"backgroundTop",layout:"hbox"},{itemId:"clipArea",layout:{type:"hbox",align:"stretch"},height:"auto",width:"200%",items:[{itemId:"clipBox",html:'<div class="clipper" style="display:none;position:relative;top:0px;width:30px;overflow:auto;height:30px;border:4px solid rgb(69, 143, 187);"><div class="ui-resizable-handle ui-resizable-se se-handle" ></div></div>'},{itemId:"backgroundRight",flex:1,style:"background-color:rgba(0, 0, 0, 0.5)"}]},{itemId:"backgroundBottom",items:[{itemId:"controlPanel",width:120,height:40,style:{backgroundColor:"rgba(0,0,0,0.7)",borderRadius:"5px",position:"absolute",margin:"5px 0px 5px 0px",zIndex:"999"},hidden:true,layout:"hbox",items:[{itemId:"cancel",width:40,height:40,style:{backgroundImage:'url("resources/images/reader icons/close-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}},{itemId:"reset",height:40,width:40,style:{backgroundImage:'url("resources/images/reader icons/refresh-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}},{itemId:"confirm",height:40,width:40,style:{backgroundImage:'url("resources/images/reader icons/tick-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}}]}]},{itemId:"backgroundLeft"}]},initialize:function(){var b=this;var a=b.getComponent("clipArea");b.clipBox=a.getComponent("clipBox");b.top=b.getComponent("backgroundTop");b.top.setHtml("<div style='position:relative;width:"+$(document).width()*2+"px;height:"+$(document).height()+"px;background-color:rgba(0, 0, 0, 0.5)'></div>");b.left=b.getComponent("backgroundLeft");b.left.setHtml("<div style='position:absolute;left:-200%;top:0%;width:"+$(document).width()*2+"px;height:"+$(document).height()*2.5+"px;background-color:rgba(0, 0, 0, 0.5)'></div>");b.bottom=b.getComponent("backgroundBottom");b.bottom.setHtml("<div style='position:relative;width:"+$(document).width()*2+"px;height:"+$(document).height()*2+"px;background-color:rgba(0, 0, 0, 0.5)'></div>");b.controlPanel=b.getComponent("backgroundBottom").getComponent("controlPanel");b.cancel=b.controlPanel.getComponent("cancel");b.reset=b.controlPanel.getComponent("reset");b.confirm=b.controlPanel.getComponent("confirm");b.origDocH=$(document).height();b.origDocW=$(document).width();if(Ext.os.is.Phone){b.controlPanel.setHeight(30);b.controlPanel.setWidth(90);b.cancel.setHeight(30);b.cancel.setWidth(30);b.reset.setHeight(30);b.reset.setWidth(30);b.confirm.setHeight(30);b.confirm.setWidth(30)}if(b.config.reader!=null){b.reader=b.config.reader}if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}b.confirm.element.on({tap:b.keyPress,scope:b});b.cancel.element.on({tap:b.selfDestruct,scope:b});b.reset.element.on({tap:b.resize,scope:b});b.element.on({dragstart:function(c){c.stopPropagation()},drag:function(c){c.stopPropagation()},dragend:function(c){c.stopPropagation()}});b.clipperDrawn=false;b.element.dom.addEventListener("touchstart",function(c){b.mouseDown(c)});b.element.dom.addEventListener("touchend",function(c){b.mouseUp(c)});b.draggableHandle=b.element.down(".ui-resizable-handle");b.draggableHandle.dom.style.width="50px";b.draggableHandle.dom.style.height="50px";b.draggableHandle.dom.addEventListener("touchstart",function(c){c.stopPropagation();var l=c.changedTouches[0].clientX;var j=c.changedTouches[0].clientY;var d=$(".clipper").width();var k=$(".clipper").height();var e="";switch(b.getPrefix().css){case"-webkit-":e=b.element.dom.style.webkitTransform;break;case"-ms-":e=b.element.dom.style.msTransform;break;default:e=b.element.dom.style.transform;break}var h=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var g=h[0].substring(0,h[0].indexOf("p"));var f=h[1].substring(0,h[1].indexOf("p"));b.move=function(q){q.stopPropagation();q.preventDefault();if(q.changedTouches[0].clientX>parseFloat(g)){var m=d+q.changedTouches[0].clientX-l;var p=g}else{var p=q.changedTouches[0].clientX;var m=parseFloat(g)-q.changedTouches[0].clientX}if(q.changedTouches[0].clientY>parseFloat(f)){var n=k+q.changedTouches[0].clientY-j;var o=f}else{var o=q.changedTouches[0].clientY;var n=parseFloat(f)-q.changedTouches[0].clientY}b.element.dom.style.transform="translate3d("+p+"px, "+(o)+"px, 0px)";b.element.dom.style.webkitTransform="translate3d("+p+"px, "+(o)+"px, 0px)";b.element.dom.style.mozTransform="translate3d("+p+"px, "+(o)+"px, 0px)";b.element.dom.style.msTransform="translate3d("+p+"px, "+(o)+"px, 0px)";$(".clipper").css("height",n);$(".clipper").css("width",m);if(b.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-o-50)){if(m-$(b.controlPanel.element.dom).width()>=0){$(b.controlPanel.element.dom).css("transform","translate3d("+(m-($(b.controlPanel.element.dom).width()+$(b.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-o-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translate3d("+(m-($(b.controlPanel.element.dom).width()+$(b.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-o-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-moz-transform","translate3d("+(m-($(b.controlPanel.element.dom).width()+$(b.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-o-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-ms-transform","translate3d("+(m-($(b.controlPanel.element.dom).width()+$(b.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-o-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(b.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-o-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-o-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-o-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-o-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if(m-$(b.controlPanel.element.dom).width()>=0){$(b.controlPanel.element.dom).css("transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)")}else{$(b.controlPanel.element.dom).css("transform","translateX(0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}};document.addEventListener("touchmove",b.move)});b.draggableHandle.dom.addEventListener("touchend",function(c){document.removeEventListener("touchstart",null)})},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},bannerAdCheck:function(){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.reader.bannerAd!=null){b.element.dom.style.top="calc(-100% - 110px)"}},fillCheck:function(){var b=this;if(b.readerActiveItem.zoomMode=="fill"){var a=($(b.reader.element.dom).height()/b.readerActiveItem.height)*100;b.element.dom.style.top="calc(-"+a+"% + "+b.readerActiveItem.scroller.position.y+"px)"}},zoomCheck:function(){var b=this;if($("#slider").val()>1){var a=($(b.reader.element.dom).height()/(b.readerActiveItem.height*$("#slider").val()))*100;b.element.dom.style.top="calc(-"+a+"% + "+b.readerActiveItem.scroller.position.y+"px)";b.element.dom.style.left=b.readerActiveItem.scroller.position.x+"px";b.leftBackground.dom.style.left="-"+(($(document).width()*2))+"px"}},keyPress:function(){var a=this;var e="";switch(a.getPrefix().css){case"-webkit-":e=a.element.dom.style.webkitTransform;break;case"-ms-":e=a.element.dom.style.msTransform;break;default:e=a.element.dom.style.transform;break}var d=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var c=d[0].substring(0,d[0].indexOf("p"));var b=d[1].substring(0,d[1].indexOf("p"));a.fireEvent("createClip",c,b,a.readerActiveItem,a.clipBox,a)},mouseDown:function(g){var d=this;g.preventDefault();if(!d.clipperDrawn){d.element.dom.style.transform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.webkitTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.mozTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.msTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";$(".clipper").css("display","");d.controlPanel.show();var k=g.changedTouches[0].clientX;var j=g.changedTouches[0].clientY;d.clipperDrawn=true;d.move=function(p){p.stopPropagation();p.preventDefault();var o;var n;if(p.changedTouches[0].clientX>k){var l=p.changedTouches[0].clientX-k;var n=k}else{var l=k-p.changedTouches[0].clientX;var n=p.changedTouches[0].clientX}if(p.changedTouches[0].clientY>j){var m=p.changedTouches[0].clientY-j;var o=j}else{var m=j-p.changedTouches[0].clientY;var o=p.changedTouches[0].clientY}d.element.dom.style.transform="translate3d("+n+"px, "+(o)+"px, 0px)";d.element.dom.style.webkitTransform="translate3d("+n+"px, "+(o)+"px, 0px)";d.element.dom.style.mozTransform="translate3d("+n+"px, "+(o)+"px, 0px)";d.element.dom.style.msTransform="translate3d("+n+"px, "+(o)+"px, 0px)";$(".clipper").css("height",m);$(".clipper").css("width",l);if(d.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-o-50)){if(l-$(d.controlPanel.element.dom).width()>=0){$(d.controlPanel.element.dom).css("transform","translate3d("+(l-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-o-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translate3d("+(l-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-o-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-moz-transform","translate3d("+(l-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-o-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d("+(l-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-o-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(d.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-o-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-o-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-o-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-o-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if(l-$(d.controlPanel.element.dom).width()>=0){$(d.controlPanel.element.dom).css("transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)")}else{$(d.controlPanel.element.dom).css("transform","translateX(0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}};document.addEventListener("touchmove",d.move)}else{var c="";switch(d.getPrefix().css){case"-webkit-":c=d.element.dom.style.webkitTransform;break;case"-ms-":c=d.element.dom.style.msTransform;break;default:c=d.element.dom.style.transform;break}var e=c.substring(c.indexOf("(")+1,c.indexOf(")")).split(",");var h=parseFloat(e[0].substring(0,e[0].indexOf("p")));var f=parseFloat(e[1].substring(0,e[1].indexOf("p")));var b=g.changedTouches[0].clientX;var a=g.changedTouches[0].clientY;d.move=function(n){n.preventDefault();var p=b-n.changedTouches[0].clientX;var o=a-n.changedTouches[0].clientY;var m=h-p;var l=f-o;if(m<0){m=0}if(l<0){l=0}if(m>$(document).width()-$(d.clipBox.element.dom).width()){m=$(document).width()-$(d.clipBox.element.dom).width()}if(l>$(document).height()-$(d.clipBox.element.dom).height()){l=$(document).height()-$(d.clipBox.element.dom).height()}d.element.dom.style.transform="translate3d("+m+"px, "+(l)+"px, 0px)";d.element.dom.style.webkitTransform="translate3d("+m+"px, "+(l)+"px, 0px)";d.element.dom.style.mozTransform="translate3d("+m+"px, "+(l)+"px, 0px)";d.element.dom.style.msTransform="translate3d("+m+"px, "+(l)+"px, 0px)";if(d.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-l-50)){if($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width()>=0){$(d.controlPanel.element.dom).css("transform","translate3d("+($(d.clipBox.element.dom).width()-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translate3d("+($(d.clipBox.element.dom).width()-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-moz-transform","translate3d("+($(d.clipBox.element.dom).width()-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d("+($(d.clipBox.element.dom).width()-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(d.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if($(d.clipBox.element.dom).width()-150>=0){$(d.controlPanel.element.dom).css("transform","translateX("+($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX("+($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX("+($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX("+($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width())+"px)")}else{$(d.controlPanel.element.dom).css("transform","translateX(0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}};document.addEventListener("touchmove",d.move)}},mouseUp:function(b){var a=this;b.preventDefault();document.removeEventListener("touchmove",a.move)},selfDestruct:function(){var a=this;window.onkeypress=null;if(!Ext.os.is.Phone){a.fireEvent("enableArticlesContainer")}Ext.Viewport.remove(a);a.destroy()},resize:function(){var a=this;a.fireEvent("resetClippingArea",a)}},0,["clippingarea"],["component","container","panel","clippingarea"],{component:true,container:true,panel:true,clippingarea:true},["widget.clippingarea"],0,[InfinityMobile.view.tablet,"ClippingArea"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ClippingArea",Ext.Panel,{config:{modal:true,hideOnMaskTap:true,fullscreen:true,style:"position:absolute;top:-100%;",items:[{itemId:"backgroundTop",layout:"hbox",items:[{itemId:"clipBtn",hidden:false,height:30,width:60,html:"Clip"},{itemId:"resetBtn",hidden:false,height:30,width:60,html:"Reset"},{itemId:"cancelBtn",hidden:false,height:30,width:60,html:"Cancel"}]},{itemId:"clipArea",layout:{type:"hbox",align:"stretch"},height:"auto",width:"200%",items:[{itemId:"clipBox",html:'<div class="clipper" style="display:none;position:relative;top:0px;width:30px;overflow:auto;height:30px;border:4px solid rgb(69, 143, 187);"><div class="ui-resizable-handle ui-resizable-se se-handle" ></div></div>'},{itemId:"backgroundRight",flex:1,style:"background-color:rgba(0, 0, 0, 0.5)"}]},{itemId:"backgroundBottom"},{itemId:"backgroundLeft"}]},initialize:function(){var b=this;var a=b.getComponent("clipArea");b.clipBox=a.getComponent("clipBox");b.top=b.getComponent("backgroundTop");b.top.setHtml("<div style='position:relative;width:"+$(document).width()*2+"px;height:"+$(document).height()+"px;background-color:rgba(0, 0, 0, 0.5)'></div>");b.left=b.getComponent("backgroundLeft");b.left.setHtml("<div style='position:absolute;left:-200%;top:0%;width:"+$(document).width()*2+"px;height:"+$(document).height()*2.5+"px;background-color:rgba(0, 0, 0, 0.5)'></div>");b.bottom=b.getComponent("backgroundBottom");b.bottom.setHtml("<div style='position:relative;width:"+$(document).width()*2+"px;height:"+$(document).height()*2+"px;background-color:rgba(0, 0, 0, 0.5)'></div>");b.clipBtn=b.getComponent("backgroundTop").getComponent("clipBtn");b.clipBtn.setStyle("background-color:rgb(69, 143, 187);color:white;position:absolute;top:"+($(document).height()-40)+"px;z-index:1000;padding:5px;font-size:15px;left:0%;text-align:center;");b.resetBtn=b.getComponent("backgroundTop").getComponent("resetBtn");b.resetBtn.setStyle("background-color:rgb(69, 143, 187);color:white;position:absolute;top:"+($(document).height()-40)+"px;z-index:1000;padding:5px;font-size:15px;left:70px;text-align:center;");b.cancelBtn=b.getComponent("backgroundTop").getComponent("cancelBtn");b.cancelBtn.setStyle("background-color:rgb(69, 143, 187);color:white;position:absolute;top:"+($(document).height()-40)+"px;z-index:1000;padding:5px;font-size:15px;left: 140px;text-align:center;");b.origDocH=$(document).height();b.origDocW=$(document).width();if(b.config.reader!=null){b.reader=b.config.reader}if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}b.clipBtn.element.on({tap:b.keyPress,scope:b});b.cancelBtn.element.on({tap:b.selfDestruct,scope:b});b.resetBtn.element.on({tap:b.resize,scope:b});b.element.on({dragstart:function(c){c.stopPropagation()},drag:function(c){c.stopPropagation()},dragend:function(c){c.stopPropagation()}});b.clipperDrawn=false;b.element.dom.addEventListener("touchstart",function(c){b.mouseDown(c)});b.element.dom.addEventListener("touchend",function(c){b.mouseUp(c)});b.draggableHandle=b.element.down(".ui-resizable-handle");b.draggableHandle.dom.style.width="50px";b.draggableHandle.dom.style.height="50px";b.draggableHandle.dom.addEventListener("touchstart",function(c){c.stopPropagation();var l=c.changedTouches[0].clientX;var j=c.changedTouches[0].clientY;var d=$(".clipper").width();var k=$(".clipper").height();var e=b.element.dom.style.transform;var h=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var g=h[0].substring(0,h[0].indexOf("p"));var f=h[1].substring(0,h[1].indexOf("p"));b.move=function(q){q.stopPropagation();q.preventDefault();if(q.changedTouches[0].clientX>parseFloat(g)){var m=d+q.changedTouches[0].clientX-l;var p=g}else{var p=q.changedTouches[0].clientX;var m=parseFloat(g)-q.changedTouches[0].clientX}if(q.changedTouches[0].clientY>parseFloat(f)){var n=k+q.changedTouches[0].clientY-j;var o=f}else{var o=q.changedTouches[0].clientY;var n=parseFloat(f)-q.changedTouches[0].clientY}b.element.dom.style.transform="translate3d("+p+"px, "+(o)+"px, 0px)";$(".clipper").css("height",n);$(".clipper").css("width",m)};document.addEventListener("touchmove",b.move)});b.draggableHandle.dom.addEventListener("touchend",function(c){document.removeEventListener("touchstart",null)})},bannerAdCheck:function(){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.reader.bannerAd!=null){b.element.dom.style.top="calc(-100% - 110px)"}},fillCheck:function(){var b=this;if(b.readerActiveItem.zoomMode=="fill"){var a=($(b.reader.element.dom).height()/b.readerActiveItem.height)*100;b.element.dom.style.top="calc(-"+a+"% + "+b.readerActiveItem.scroller.position.y+"px)"}},zoomCheck:function(){var b=this;if($("#slider").val()>1){var a=($(b.reader.element.dom).height()/(b.readerActiveItem.height*$("#slider").val()))*100;b.element.dom.style.top="calc(-"+a+"% + "+b.readerActiveItem.scroller.position.y+"px)";b.element.dom.style.left=b.readerActiveItem.scroller.position.x+"px";b.leftBackground.dom.style.left="-"+(($(document).width()*2))+"px"}},keyPress:function(){var a=this;var e=a.element.dom.style.transform;var d=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var c=d[0].substring(0,d[0].indexOf("p"));var b=d[1].substring(0,d[1].indexOf("p"));a.fireEvent("createClip",c,b,a.readerActiveItem,a.clipBox,a)},mouseDown:function(g){var d=this;g.preventDefault();if(!d.clipperDrawn){d.element.dom.style.transform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";$(".clipper").css("display","");var k=g.changedTouches[0].clientX;var j=g.changedTouches[0].clientY;d.clipperDrawn=true;d.move=function(p){p.stopPropagation();p.preventDefault();var o;var n;if(p.changedTouches[0].clientX>k){var l=p.changedTouches[0].clientX-k;var n=k}else{var l=k-p.changedTouches[0].clientX;var n=p.changedTouches[0].clientX}if(p.changedTouches[0].clientY>j){var m=p.changedTouches[0].clientY-j;var o=j}else{var m=j-p.changedTouches[0].clientY;var o=p.changedTouches[0].clientY}d.element.dom.style.transform="translate3d("+n+"px, "+(o)+"px, 0px)";$(".clipper").css("height",m);$(".clipper").css("width",l)};document.addEventListener("touchmove",d.move)}else{var c=d.element.dom.style.transform;var e=c.substring(c.indexOf("(")+1,c.indexOf(")")).split(",");var h=parseFloat(e[0].substring(0,e[0].indexOf("p")));var f=parseFloat(e[1].substring(0,e[1].indexOf("p")));var b=g.changedTouches[0].clientX;var a=g.changedTouches[0].clientY;d.move=function(n){n.preventDefault();var p=b-n.changedTouches[0].clientX;var o=a-n.changedTouches[0].clientY;var m=h-p;var l=f-o;d.element.dom.style.transform="translate3d("+m+"px, "+(l)+"px, 0px)"};document.addEventListener("touchmove",d.move)}},mouseUp:function(b){var a=this;b.preventDefault();document.removeEventListener("touchmove",a.move)},selfDestruct:function(){var a=this;window.onkeypress=null;Ext.Viewport.remove(a);a.destroy()},resize:function(){var a=this;a.fireEvent("resetClippingArea",a)}},0,["clippingarea"],["component","container","panel","clippingarea"],{component:true,container:true,panel:true,clippingarea:true},["widget.clippingarea"],0,[InfinityMobile.view.phone,"ClippingArea"],0));(Ext.cmd.derive("InfinityMobile.view.phone.clippingPrompt",Ext.Container,{config:{modal:true,centered:true,width:"80%",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingPromptToolBar",height:40,items:[{itemId:"clippingTitle",top:10,left:10,html:"Create Clipping"}]},{id:"clippingPromptBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingPromptContainerText",margin:"0 0 20px 0"},{itemId:"buttonArea",padding:"20",layout:"hbox",items:[{itemId:"checkbox",flex:1,html:"<input class='check' type='checkbox' ><label style='font-size:8px;padding:5px;'>Don't show again.</label></input>"},{itemId:"button",flex:1,html:"Ok",style:"text-align:center;margin: 5px;border-style:solid;height:30px;width:120px;"}]}]}]},initialize:function(){var b=this;var a=b.getComponent("clippingPromptToolBar");b.clippingTitle=a.getComponent("clippingTitle");b.clippingTitle.setHtml(language.clippings.createClipping);a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.clippingPromptBody=b.getComponent("clippingPromptBodyContainer");b.buttonArea=b.clippingPromptBody.getComponent("buttonArea");b.button=b.buttonArea.getComponent("button");b.checkbox=b.buttonArea.getComponent("checkbox").element.down(".check");b.bodyText=b.clippingPromptBody.getComponent("clippingPromptContainerText");if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}if(b.config.reader!=null){b.reader=b.config.reader}b.buttonArea.getComponent("checkbox").element.on({tap:function(){var c=$(this.element.dom).find("input");if(c.length>0){if(c[0].checked){c[0].checked=false}else{c[0].checked=true}}},scope:b.buttonArea.getComponent("checkbox")});b.setupText();b.button.element.on({tap:b.okay,scope:b});b.button.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});if(settings.newsday){b.element.dom.style.borderRadius=""}},okay:function(){var b=this;console.log(b.checkbox.dom.checked);if(b.checkbox.dom.checked){try{localStorage.setItem("clippingPrompt"+publicationguid,"set")}catch(a){}}if(Ext.os.is.Desktop){var c=Ext.create("InfinityMobile.view.ClippingArea",{readerActiveItem:b.readerActiveItem,reader:b.reader})}else{var c=Ext.create("InfinityMobile.view.tablet.ClippingArea",{readerActiveItem:b.readerActiveItem,reader:b.reader})}Ext.Viewport.add(c);c.show();b.destroy()},setupText:function(){var a=this;a.bodyText.setHtml(language.clippings.clippingsHelperMobile+"<br /><br />"+language.clippings.clippingsExplainMobile);a.buttonArea.element.down("label").dom.innerHTML=language.clippings.clippingsDontShow;a.button.setHtml(language.ok)}},0,["clippingprompt"],["component","container","clippingprompt"],{component:true,container:true,clippingprompt:true},["widget.clippingprompt"],0,[InfinityMobile.view.phone,"clippingPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ClippingOptions",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>Clipping Options</b>"},{id:"clippingOptionsToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0",html:"<p style='font-size:12px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><br /><p style='font-size:10px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p>"},{itemId:"clippingScroller",height:"180px",layout:"hbox",scrollable:{direction:"horizontal"}},{itemId:"options",items:[{itemId:"ButtonsDiv"},{itemId:"EmailDiv"}]}]}]},initialize:function(){var a=this;a.toolbar=a.getComponent("clippingOptionsToolBar");a.closeBtn=a.toolbar.getComponent("clippingOptionsToolBarClose");a.bodyContainer=a.getComponent("clippingOptionsBodyContainer");a.clippingScroller=a.bodyContainer.getComponent("clippingScroller");a.options=a.bodyContainer.getComponent("options");if(a.config.images!=null){a.images=a.config.images}if(a.config.widths!=null){a.widths=a.config.widths}if(a.config.heights!=null){a.heights=a.config.heights}a.addThumbnails();a.closeBtn.element.on("tap",function(){a.destroy()});a.options.getComponent("ButtonsDiv").setHtml('<div style="width:100%;background-color:white;padding:10px;height:70px;text-align:center;"><input type="button" onclick="parent.download()" style="margin: 1px;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:30%;color:white;" type="button" value="Download" /><input type="button" onclick="parent.preview()" value="Preview" style="margin:1px;border-style:solid;font-size:12px;height:30px;margin-color:#E6E6E6;background-color:#E6E6E6;border-color:#e6e6e6;width:30%;" type="button" /><input type="button" onclick="parent.deleteClip()"  style="margin:1px;border-style:solid;font-size:12px;height:30px;margin-color:#e6e6e6;background-color:#e6e6e6;border-color:#e6e6e6;width:30%;" type="button" value="Delete" /></div>');deleteClip=function(){var c=[];var b=false;for(var d=0;d<a.clippingScroller.innerItems.length;d++){if(a.clippingScroller.innerItems[d].clicked){c[c.length]=a.images[d];b=true}}if(b){prompt=Ext.create("InfinityMobile.view.ClippingMenuDeletePrompt",{deleteClippings:c,menu:a})}else{a.promptUser()}};preview=function(){var d=false;for(var c=0;c<a.images.length;c++){if(a.clippingScroller.innerItems[c].clicked){d=true;break}}if(d){var b=Ext.create("InfinityMobile.view.ClippingMenuPreview",{images:a.images,clippingMenu:a})}else{a.promptUser()}};email=function(){if(document.getElementById("emailTxt").value!=""){var d=false;var b="mailto:"+document.getElementById("emailTxt").value+"?subject='"+document.getElementById("subjectTxt").value+"'&body='"+document.getElementById("messageTxt").value+"<br /><br />";for(var c=0;c<a.images.length;c++){if(a.clippingScroller.innerItems[c].clicked){b+="<img src='"+a.images[c]+"' /><br /><br />";d=true}}if(d){b+="'";window.location.href=b}else{a.promptUser()}}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuEmailPrompt")}};download=function(){var c=false;for(var b=0;b<a.clippingScroller.innerItems.length;b++){if(a.clippingScroller.innerItems[b].clicked){window.open(a.images[b]);c=true}}if(!c){a.promptUser()}}},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingMenuThumb",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingScroller.add(c);c.show()}},promptUser:function(){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt")},updateImages:function(a){var b=this;b.images=a;b.clippingScroller.removeAll(true);b.addThumbnails()}},0,["clippingoptions"],["component","container","clippingoptions"],{component:true,container:true,clippingoptions:true},["widget.clippingoptions"],0,[InfinityMobile.view.phone,"ClippingOptions"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleSectionItem",Ext.Container,{config:{height:"100%",width:250,layout:"vbox",style:"border:5px solid transparent;",items:[{itemId:"bodyContainer1",height:200,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;"}]},initialize:function(){var a=this;a.body1=a.getComponent("bodyContainer1");a.body2=a.getComponent("bodyContainer2");if(a.config.article1!=null){a.article1=a.config.article1}if(a.config.article2!=null){a.article2=a.config.article2}if(a.config.container!=null){a.container=a.config.container}a.loadArticles();a.body1.element.on({tap:a.body1Tap,scope:a})},loadArticles:function(){var a=this;a.body1.setHtml("<div style='line-height:20px;overflow:hidden;height:180px;'><b style='font-size:18px !important;'>"+a.article1.headline+"</b><br /><br />"+a.article1.shortStory+"</div>")},returnBodyText:function(f){var e=this;var g="";var d=0;var a=200;for(var c=0;c<f.length;c++){if(d+f[c].innerHTML.length<a){g+="<p>"+f[c].innerHTML+"</p>"}else{var b=a-d;g+="<p>"+f[c].innerHTML.substring(0,b)+"...</p>";break}}return g},body1Tap:function(){var a=this;console.log("ARTICLE TOP TAP");a.fireEvent("jumpToPage",a.article1.pageNumber-1);a.fireEvent("articleClick",a.article1,a.article1.guid);a.container.destroy()}},0,["articlesectionitem"],["component","container","articlesectionitem"],{component:true,container:true,articlesectionitem:true},["widget.articlesectionitem"],0,[InfinityMobile.view.phone,"ArticleSectionItem"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticleSectionItemImg",Ext.Container,{config:{height:"100%",width:280,layout:"vbox",style:"border:5px solid transparent;",items:[{itemId:"image",height:125,style:"border:5px solid transparent;"},{itemId:"bodyContainer",height:75,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;"}]},initialize:function(){var a=this;a.image=a.getComponent("image");a.bodyContainer=a.getComponent("bodyContainer");if(a.config.article!=null){a.article=a.config.article}if(a.config.container!=null){a.container=a.config.container}a.loadArticle();a.element.on({tap:a.onTap,scope:a})},loadArticle:function(){var b=this;$(b.image.element.dom).css("background","url(image_resize.aspx?w=350&url="+b.article.images[0].url+")");$(b.image.element.dom).css("background-repeat","no-repeat");$(b.image.element.dom).css("background-position","center");$(b.image.element.dom).css("background-size","cover");var a=document.createElement("div");a.innerHTML=b.article.body;b.bodyContainer.setHtml("<div style='line-height:20px;oveflow:hidden;' ><b style='font-size:18px !important;'>"+b.article.headline+"</b></div>")},onTap:function(){var a=this;console.log("TAP IMAGE ARTICLE");a.fireEvent("jumpToPage",a.article.pageNumber-1);a.fireEvent("articleClick",a.article,a.article.guid);a.container.destroy()}},0,["articlesectionitemimg"],["component","container","articlesectionitemimg"],{component:true,container:true,articlesectionitemimg:true},["widget.articlesectionitemimg"],0,[InfinityMobile.view.phone,"ArticleSectionItemImg"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticlesSectionContainer",Ext.Container,{config:{height:250,layout:"vbox",style:"margin-left:15px solid transparent !important;margin-right:15px solid transparent !important;",items:[{itemId:"sectionTitle",height:40,style:"background-color:black;opacity:0.95;color:white;font-size:18px;font-weight:bold;"},{itemId:"sectionBody",height:360,layout:"hbox",style:"background-color:rgba(0,0,0,0.8);"}]},initialize:function(){var a=this;a.title=a.getComponent("sectionTitle");a.sectionBody=a.getComponent("sectionBody");if(a.config.section!=null){a.section=a.config.section}if(a.config.articles!=null){a.articles=a.config.articles}if(a.config.container!=null){a.container=a.config.container}a.title.setHtml("<p style='padding:12px;'>"+a.section.name+"</p>");a.loadArticles()},loadArticles:function(){var b=this;for(var a=0;a<b.articles.length;a++){if(b.articles[a].images.length>0){var c=Ext.create("InfinityMobile.view.phone.ArticleSectionItemImg",{article:b.articles[a],container:b.container});b.sectionBody.add(c)}else{var c=Ext.create("InfinityMobile.view.phone.ArticleSectionItem",{article1:b.articles[a],container:b.container});b.sectionBody.add(c)}}}},0,["articlesectioncontainer"],["component","container","articlesectioncontainer"],{component:true,container:true,articlesectioncontainer:true},["widget.articlesectioncontainer"],0,[InfinityMobile.view.phone,"ArticlesSectionContainer"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ArticlesContainer",Ext.Container,{config:{width:"100%",height:440,zIndex:100000,bottom:-40,items:[{itemId:"sectionToolbar",width:"100%",height:40,top:0,layout:"hbox",style:"background-color:rgba(0,0,0,0.8);border-bottom:1px solid gray;overflow:hidden;",items:[{itemId:"sectionArea",height:40,width:"100%",layout:"hbox",style:"overflow:hidden;"},{itemId:"expandBtn",cls:"pointerCursor",height:40,width:"40px",right:40,style:'border-left:1px solid gray;background-image:url("resources/images/reader icons/expand ic.png");background-size:60% 50%;background-repeat:no-repeat;background-position:center;'},{itemId:"closeBtn",cls:"pointerCursor",height:40,width:"40px",right:0,style:'border-left:1px solid gray;background-image:url("resources/images/reader icons/close btn.png");background-size:60% 50%;background-repeat:no-repeat;background-position:center;'}]},{itemId:"con",layout:"hbox",top:40,style:"background-color:rgba(0,0,0,0.8);",width:"100%",height:"360px",scrollable:{direction:"horizontal"}}]},initialize:function(){var a=this;a.sectionIndex=null;a.sectionToolbar=a.getComponent("sectionToolbar");a.sectionArea=a.sectionToolbar.getComponent("sectionArea");a.closeBtn=a.sectionToolbar.getComponent("closeBtn");a.expandBtn=a.sectionToolbar.getComponent("expandBtn");a.contentArea=a.getComponent("con");a.pagesHeight=180;a.scrollType="senchaScroller";a.offset=0;if(a.config.articles!=null){a.articles=a.config.articles}if(a.config.sections!=null){a.sections=a.config.sections}if(a.config.mode!=null){a.mode=a.config.mode}a.checkMode();a.sortSections();if(a.articles.length>0&&settings.articles!=null){a.display="articles";a.loadContainer()}else{a.display="articles";a.mode="start"}a.getComponent("con").getScrollable().getScroller().on({scroll:a.onScroll,scope:a});a.element.on({hide:a.hideMe,scope:a});if(Ext.os.is.Tablet){a.tabletMode()}a.closeBtn.element.on({tap:a.hide,scope:a});a.expandBtn.element.on({tap:a.expand,scope:a});if(a.sectionArea.getScrollable()==null){a.sectionArea.setScrollable({direction:"horizontal"})}Ext.Viewport.on("orientationchange",function(){a.resizeOb()})},sortSections:function(){var d=this;var f=[];var b;for(var c=0;c<d.sections.length;c++){var e=d.sections[c];for(var a=0;a<d.sections.length;a++){if(parseFloat(e.pageNumber)<parseFloat(d.sections[a].pageNumber)){b=d.sections[c];d.sections[c]=d.sections[a];d.sections[a]=b}}}},tabletMode:function(){var b=this;var d=0;if(b.display=="articles"){var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.dynamic!=null){var c=80;b.expandBtn.show()}else{var c=40;b.expandBtn.hide()}b.sectionArea.setWidth($(document).width()-c-d)}else{b.sectionArea.setWidth($(document).width()-40-d)}if(b.sectionArea.getScrollable()==null){b.sectionArea.setScrollable({direction:"horizontal"})}},checkMode:function(){var a=this;if(a.mode=="toggle"){a.element.dom.style.transform="translate3d(0px, 400px, 0px)";a.element.dom.style.mozTransform="translate3d(0px, 400px, 0px)";a.element.dom.style.webkitTransform="translate3d(0px, 400px, 0px)";a.element.dom.style.msTransform="translate3d(0px, 400px, 0px)"}},loadContainer:function(){var e=this;if(e.sections.length>0){var g=[];if(e.sections[0].pageNumber>1){e.sections.unshift({page:1,pageNumber:1,name:""})}for(var c=0;c<e.sections.length;c++){var d=[];var b=parseInt(e.sections[c].page);for(var a=0;a<e.articles.length;a++){if(e.sections[c+1]!=null){if(e.articles[a].pageNumber>=b&&e.articles[a].pageNumber<parseInt(e.sections[c+1].page)){d.push(e.articles[a])}}else{if(e.articles[a].pageNumber>=b){d.push(e.articles[a])}}}if(d.length>0){var f=Ext.create("InfinityMobile.view.ArticlesSectionContainer",{section:e.sections[c],articles:d,container:e});e.getComponent("con").add(f)}}}else{var f=Ext.create("InfinityMobile.view.ArticlesSectionContainer",{section:"All",articles:e.articles,container:e});e.getComponent("con").add(f)}},loadSectionsBtns:function(){var g=this;g.sectionArea.removeAll();var f=0;for(var d=0;d<g.sections.length;d++){if(d==0){var b="white"}else{var b="gray"}if(g.articles.length>0){var e=[];var c=parseInt(g.sections[d].page);for(var a=0;a<g.articles.length;a++){if(g.sections[d+1]!=null){if(g.articles[a].pageNumber>=c&&g.articles[a].pageNumber<parseInt(g.sections[d+1].page)){e.push(g.articles[a])}}else{if(g.articles[a].pageNumber>=c){e.push(g.articles[a])}}}if(e.length>0){var h=Ext.create("Ext.Container",{cls:"browserBtn",height:40,html:g.sections[d].name.trim(),style:"color:"+b+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:f,articleContainer:g});g.sectionArea.add(h);h.element.on({tap:function(){g.sectionTap(this,this.config.articleContainer)},painted:function(){var k=this.config.articleContainer;var j=k.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(j)},scope:h});f+=1}}else{if(g.sections.length>0){var h=Ext.create("Ext.Panel",{cls:"browserBtn",height:40,html:g.sections[d].name.trim(),style:"color:"+b+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:f,articleContainer:g});g.sectionArea.add(h);h.element.on({tap:function(){g.sectionTap(this,this.config.articleContainer)},painted:function(){var k=this.config.articleContainer;var j=k.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(j)},scope:h});f+=1}}}},loadSectionBtnsPages:function(){var d=this;d.sectionArea.removeAll();var c=0;for(var b=0;b<d.sections.length;b++){if(b==0){var a="white"}else{var a="gray"}var e=Ext.create("Ext.Panel",{cls:"browserBtn",height:40,html:d.sections[b].name.trim(),style:"color:"+a+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:c,articleContainer:d});d.sectionArea.add(e);e.element.on({tap:function(){console.log(this.config.articleContainer);d.sectionTap(this,this.config.articleContainer)},painted:function(){var g=this.config.articleContainer;var f=g.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(f)},scope:e});c+=1}},onScroll:function(n){var o=this;if(o.mode=="articles"){if(n.position.x>0){var m=0;var j;for(var k=0;k<o.getComponent("con").items.items.length;k++){var f=o.getComponent("con").items.items[k].element.dom.offsetLeft;if(o.getComponent("con").items.items[k+1]!=null){var a=o.getComponent("con").items.items[k+1].element.dom.offsetLeft;if(n.position.x>=f&&parseInt(n.position.x)<parseInt(a)){m=k;j=f;break}}else{m=k;j=f;break}}var l=0;for(var k=m;k<o.getComponent("con").items.items.length;k++){if(n.position.x+$(document).width()>=parseFloat(o.getComponent("con").items.items[k].element.dom.offsetLeft)){l=k}}for(var k=0;k<o.getComponent("con").items.items.length;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","gray")}}for(var k=m;k<=l;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","white")}}var q=o.contentArea.getItems().items;for(var k=m;k<=l;k++){var c=q[k].items.items[0].items.items;for(var p=0;p<c.length;p++){if((n.position.x-350<=c[p].element.dom.offsetLeft&&n.position.x+$(document).width()>=c[p].element.dom.offsetLeft)||c[p].element.dom.offsetLeft==0){if(c[p].loadImage!=null){c[p].loadImage()}}}}}else{m=0;var l=0;for(var k=m;k<o.getComponent("con").items.items.length;k++){if(n.position.x+$(document).width()>=parseFloat(o.getComponent("con").items.items[k].element.dom.offsetLeft)){l=k}}for(var k=0;k<o.getComponent("con").items.items.length;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","gray")}}for(var k=m;k<=l;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","white")}}}}else{if(o.mode=="pages"){if(n.position.x>0){var m=0;var g=[];for(var k=0;k<o.sectionArea.getItems().length;k++){var h=o.getComponent("con").items.items[0].items.items[o.sections[k].page-1];if(h!=null){g[k]=h.element.dom.offsetLeft}}for(var k=0;k<=g.length;k++){if(g[k+1]!=null){if(parseInt(n.position.x)>=parseInt(g[k])&&parseInt(n.position.x)<parseInt(g[k+1])){m=k;break}}else{m=k;break}}var l=0;for(var k=m;k<g.length;k++){if(n.position.x+$(document).width()>=parseFloat(g[k])){l=k}}for(var k=0;k<o.sectionArea.items.items.length;k++){var d=o.sectionArea.items.items[k];$(d.element.dom).css("color","gray")}for(var k=m;k<=l;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","white")}}var b=o.contentArea.getItems().items[0].innerItems;for(var k=0;k<b.length;k++){if((n.position.x<=b[k].element.dom.offsetLeft&&n.position.x+$(document).width()>=b[k].element.dom.offsetLeft)||b[k].element.dom.offsetLeft==0){if(b[k].loadImage!=null){b[k].loadImage()}}}}else{m=0;var l=0;var g=[];for(var k=0;k<o.sections.length;k++){var h=o.getComponent("con").items.items[0].items.items[o.sections[k].page];if(h!=null){g[k]=h.element.dom.offsetLeft}}for(var k=m;k<g.length;k++){if(n.position.x+$(document).width()>=parseFloat(g[k]-150)){l=k}}for(var k=0;k<o.sectionArea.items.items.length;k++){var d=o.sectionArea.items.items[k];$(d.element.dom).css("color","gray")}for(var k=m;k<=l;k++){var d=o.sectionArea.items.items[k];if(d!=null){$(d.element.dom).css("color","white")}}}}}},articleTabTap:function(l){var k=this;if(l!=null){l.stopPropagation()}if(k.display=="pages"){k.getComponent("con").removeAll();k.loadContainer()}var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.dynamic!=null){var d=80;k.expandBtn.show()}else{var d=40;k.expandBtn.hide()}k.sectionArea.setWidth($(document).width()-d);k.display="articles";k.getComponent("con").getScrollable().getScroller().scrollTo(1);var h=0;var g=0;for(var f=h;f<k.getComponent("con").items.items.length;f++){if($(document).width()>=parseFloat(k.getComponent("con").items.items[f].element.dom.offsetLeft)){g=f}}if(k.sections>0){for(var f=0;f<k.getComponent("con").items.items.length;f++){var b=k.sectionArea.items.items[f];$(b.element.dom).css("color","gray")}for(var f=h;f<=g;f++){var b=k.sectionArea.items.items[f];if(b!=null){$(b.element.dom).css("color","white")}}}var n=k.contentArea.getItems().items;for(var f=h;f<=g;f++){if(n[f]!=null){var a=n[f].items.items[0].items.items;if(a!=null){for(var m=0;m<a.length;m++){if((0<=a[m].element.dom.offsetLeft&&$(document).width()>=a[m].element.dom.offsetLeft)||a[m].element.dom.offsetLeft==0){if(a[m].loadImage!=null){a[m].loadImage()}}}}}}if(k.mode=="toggle"){try{switch(k.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toggleToArticle { 0%{ -webkit-transform:translate3d(0px, 400px, 0px); } 100%{ -webkit-transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.webkitAnimation="toggleToArticle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes toggleToArticle { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.animation="toggleToArticle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes toggleToArticle { 0%{ -moz-transform:translate3d(0px, 400px, 0px); } 100%{ -moz-transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.mozAnimation="toggleToArticle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toggleToArticle { 0%{ -ms-transform:translate3d(0px, 400px, 0px); } 100%{ -ms-transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.msAnimation="toggleToArticle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes toggleToArticle { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.animation="toggleToArticle 0.5s forwards";break}k.mode="articles";$(k.articleTabText.dom).attr("class","pageArticleTab");$(k.pagesTabText.dom).attr("class","");if(Ext.os.is.Desktop){window.onkeydown=null}k.setModal({style:"opacity:0;"});k.setHideOnMaskTap(true)}catch(j){}}else{if(k.mode=="pages"){try{k.mode="articles";switch(k.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToArticle { 0%{ -webkit-transform:translate3d(0px, 160px, 0px); } 100%{ -webkit-transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.webkitAnimation="pagesToArticle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes pagesToArticle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.animation="pagesToArticle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes pagesToArticle { 0%{ -moz-transform:translate3d(0px, 160px, 0px); } 100%{ -moz-transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.mozAnimation="pagesToArticle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToArticle { 0%{ -ms-transform:translate3d(0px, 160px, 0px); } 100%{ -ms-transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.msAnimation="pagesToArticle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToArticle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);k.element.dom.style.animation="pagesToArticle 0.5s forwards"}$(k.articleTabText.dom).attr("class","pageArticleTab");$(k.pagesTabText.dom).attr("class","");if(Ext.os.is.Desktop){window.onkeydown=null}k.setModal({style:"opacity:0;"});k.setHideOnMaskTap(true)}catch(j){}}else{if(k.mode=="articles"){try{switch(k.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articleToToggle { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.webkitAnimation="articleToToggle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.animation="articleToToggle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes articleToToggle { 0%{ -moz-transform:translate3d(0px, 0px, 0px); } 100%{ -moz-transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.mozAnimation="articleToToggle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articleToToggle { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.msAnimation="articleToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.animation="articleToToggle 0.5s forwards";break}k.mode="toggle";$(k.articleTabText.dom).attr("class","");$(k.pagesTabText.dom).attr("class","");k.setHideOnMaskTap(false);k.setModal(false);if(Ext.os.is.Desktop){if(k.keyDownFunc!=null){window.onkeydown=k.keyDownFunc}}}catch(j){}}}}k.loadSectionsBtns()},pagesTabTap:function(l){var k=this;if(l!=null){l.stopPropagation()}console.log(k.mode);if(k.display=="articles"){k.getComponent("con").removeAll();var a=Ext.create("InfinityMobile.view.ReaderPages",{articlesContainer:k});k.getComponent("con").add(a);k.getComponent("con").setScrollable({direction:"horizontal"});k.getComponent("con").setPadding(10,10,10,10);a.element.on({painted:function(){this.config.articlesContainer.pagesHeight=this.items.items[0].element.down("img").dom.clientHeight},scope:a})}k.expandBtn.hide();var f=(k.pagesHeight);k.sectionArea.setWidth($(document).width()-40);k.display="pages";index=0;var h=0;var c=[];for(var g=0;g<k.sections.length;g++){var d=k.getComponent("con").items.items[0].items.items[k.sections[g].page];if(d!=null){c[g]=d.element.dom.offsetLeft}}for(var g=index;g<c.length;g++){if($(document).width()>=parseFloat(c[g]-150)){h=g}}if(k.sections>0){for(var g=0;g<k.sectionArea.items.items.length;g++){var b=k.sectionArea.items.items[g];$(b.element.dom).css("color","gray")}for(var g=index;g<=h;g++){var b=k.sectionArea.items.items[g];if(b!=null){$(b.element.dom).css("color","white")}}}setTimeout(function(){var e=k.contentArea.getItems().items[0].innerItems;for(var m=0;m<e.length;m++){if((0<=e[m].element.dom.offsetLeft&&$(document).width()>=e[m].element.dom.offsetLeft)){e[m].loadImage()}}},200);if(k.mode=="toggle"||k.mode=="start"){try{switch(k.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toggleToPages { 0%{ -webkit-transform:translate3d(0px, 400px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.webkitAnimation="toggleToPages 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes toggleToPages { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.animation="toggleToPages 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes toggleToPages { 0%{ -moz-transform:translate3d(0px, 400px, 0px); } 100%{ -moz-transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.mozAnimation="toggleToPages 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toggleToPages { 0%{ -ms-transform:translate3d(0px, 400px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.msAnimation="toggleToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes toggleToPages { 0%{ transform:translate3d(0px, 400px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.animation="toggleToPages 0.5s forwards";break}k.mode="pages";$(k.pagesTabText.dom).attr("class","pageArticleTab");$(k.articleTabText.dom).attr("class","");if(Ext.os.is.Desktop){window.onkeydown=null}k.setModal({style:"opacity:0;"});k.setHideOnMaskTap(true)}catch(j){}}else{if(k.mode=="articles"){try{switch(k.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articlesToPages { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.webkitAnimation="articlesToPages 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.animation="articlesToPages 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes articlesToPages { 0%{ -moz-transform:translate3d(0px, 0px, 0px); } 100%{ -moz-transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.mozAnimation="articlesToPages 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articlesToPages { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.msAnimation="articlesToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);k.element.dom.style.animation="articlesToPages 0.5s forwards";break}k.mode="pages";$(k.pagesTabText.dom).attr("class","pageArticleTab");$(k.articleTabText.dom).attr("class","");if(Ext.os.is.Desktop){window.onkeydown=null}k.setModal({style:"opacity:0;"});k.setHideOnMaskTap(true)}catch(j){}}else{if(k.mode=="pages"){try{switch(k.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToToggle { 0%{ -webkit-transform:translate3d(0px, 160px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.webkitAnimation="pagesToToggle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.animation="pagesToToggle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes pagesToToggle { 0%{ -moz-transform:translate3d(0px, 160px, 0px); } 100%{ -moz-transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.mozAnimation="pagesToToggle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToToggle { 0%{ -ms-transform:translate3d(0px, 160px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.msAnimation="pagesToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);k.element.dom.style.animation="pagesToToggle 0.5s forwards";break}k.mode="toggle";$(k.pagesTabText.dom).attr("class","");$(k.articleTabText.dom).attr("class","");k.setHideOnMaskTap(false);k.setModal(false);if(Ext.os.is.Desktop){if(k.keyDownFunc!=null){window.onkeydown=k.keyDownFunc}}}catch(j){}}else{if(k.mode=="start"){k.mode="toggle"}}}}Ext.Viewport.on("orientationchange",function(){k.fireEvent("checkActivePageInBrowser",k)});k.fireEvent("checkActivePageInBrowser",k);k.loadSectionBtnsPages()},setModalTap:function(){var a=this;a.getModal().element.on({tap:a.hideMe,scope:a})},hideMe:function(){var a=this;a.element.dom.style.visibility="hidden"},hide:function(){var a=this;if(a.mode=="articles"){try{switch(a.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articleToToggle { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.webkitAnimation="articleToToggle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.animation="articleToToggle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes articleToToggle { 0%{ -moz-transform:translate3d(0px, 0px, 0px); } 100%{ -moz-transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.mozAnimation="articleToToggle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articleToToggle { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.msAnimation="articleToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.animation="articleToToggle 0.5s forwards";break}a.mode="toggle";$(a.articleTabText.dom).attr("class","");$(a.pagesTabText.dom).attr("class","");a.setHideOnMaskTap(false);a.setModal(false);if(Ext.os.is.Desktop){if(a.keyDownFunc!=null){window.onkeydown=a.keyDownFunc}}}catch(b){}}else{try{switch(a.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToToggle { 0%{ -webkit-transform:translate3d(0px, 200px, 0px); } 100%{ -webkit-transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.webkitAnimation="pagesToToggle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 200px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.animation="pagesToToggle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes pagesToToggle { 0%{ -moz-transform:translate3d(0px, 200px, 0px); } 100%{ -moz-transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.mozAnimation="pagesToToggle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToToggle { 0%{ -ms-transform:translate3d(0px, 200px, 0px); } 100%{ -ms-transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.msAnimation="pagesToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 200px, 0px); } 100%{ transform:translate3d(0px, 400px, 0px); } }",0);a.element.dom.style.animation="pagesToToggle 0.5s forwards";break}a.mode="toggle";$(a.pagesTabText.dom).attr("class","");$(a.articleTabText.dom).attr("class","");a.setHideOnMaskTap(false);a.setModal(false);if(Ext.os.is.Desktop){if(a.keyDownFunc!=null){window.onkeydown=a.keyDownFunc}}}catch(b){}}},sectionTap:function(b,c){if(c.mode=="articles"){var d=c.getComponent("con").items.items[b.config.position+c.offset].element.dom.offsetLeft;if(d>c.getComponent("con").getScrollable().getScroller().maxPosition.x){d=c.getComponent("con").getScrollable().getScroller().maxPosition.x}c.getComponent("con").getScrollable().getScroller().scrollTo(d+1)}else{if(c.mode=="pages"){console.log(b);var a=c.sections[b.config.position].page;var d=c.getComponent("con").items.items[0].items.items[a-1].element.dom.offsetLeft;if(d>c.getComponent("con").getScrollable().getScroller().maxPosition.x){d=c.getComponent("con").getScrollable().getScroller().maxPosition.x+150}c.getComponent("con").getScrollable().getScroller().scrollTo(d)}}},resizeOb:function(){var b=this;if(b.mode=="pages"){b.sectionArea.element.dom.style.width=($(document).width()-40)+"px"}else{var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.dynamic!=null){var c=80;b.expandBtn.show()}else{var c=40;b.expandBtn.hide()}b.sectionArea.element.dom.style.width=($(document).width()-c)+"px"}},expand:function(b){var a=this;b.stopPropagation();a.fireEvent("expandArticles")},disableEvents:function(){var a=this;a.element.dom.style.pointerEvents="none"},enableEvents:function(){var a=this;a.element.dom.style.pointerEvents=""},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}}},0,["articlescontainer"],["component","container","articlescontainer"],{component:true,container:true,articlescontainer:true},["widget.articlescontainer"],0,[InfinityMobile.view.tablet,"ArticlesContainer"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticlesContainer",Ext.Container,{config:{width:"100%",height:"250px",bottom:0,modal:{style:"opacity:0;"},hideOnMaskTap:true,layout:"hbox",scrollable:{direction:"horizontal"}},initialize:function(){var a=this;a.sectionIndex=null;if(a.config.articles!=null){a.articles=a.config.articles}if(a.config.sections!=null){a.sections=a.config.sections}a.loadContainer();a.getScrollable().getScroller().on({scroll:a.onScroll,scope:a})},loadContainer:function(){var e=this;for(var c=0;c<e.sections.length;c++){var d=[];var b=parseInt(e.sections[c].page);for(var a=b;a<e.articles.length;a++){if(e.sections[c+1]!=null){if(e.articles[a].pageNumber>=b&&e.articles[a].pageNumber<parseInt(e.sections[c+1].page)){d.push(e.articles[a])}}else{if(e.articles[a].pageNumber>=b){d.push(e.articles[a])}}}if(d.length>0){var f=Ext.create("InfinityMobile.view.phone.ArticlesSectionContainer",{section:e.sections[c],articles:d,container:e});e.add(f)}}},onScroll:function(h){var j=this;if(h.position.x>0){var g=0;var d;for(var f=0;f<j.items.items.length;f++){var c=j.items.items[f].element.dom.offsetLeft;if(j.items.items[f+1]!=null){var a=j.items.items[f+1].element.dom.offsetLeft;if(h.position.x>=c&&parseInt(h.position.x)<parseInt(a)){g=f;d=c;break}}else{g=f;d=c;break}}var k=j.items.items[g];var b=h.position.x-d;var l=k.title.element.down("div").down("div").down("p");$(l.dom).css("transform","translate3d("+b+"px, 0px, 0px)")}else{var k=j.items.items[0];var l=k.title.element.down("div").down("div").down("p");$(l.dom).css("transform","")}}},0,["articlescontainer"],["component","container","articlescontainer"],{component:true,container:true,articlescontainer:true},["widget.articlescontainer"],0,[InfinityMobile.view.phone,"ArticlesContainer"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.SplashScreen",Ext.Panel,{config:{id:"splashscreen",layout:{type:"vbox",align:"center",pack:"middle"},width:"100%",height:"100%",style:"background-color:#1e1e1e;",items:[{style:"text-align:center",html:'<img src="resources/images/tablet-loading-logo.png" style="max-width:75%" />'},{style:"text-align:center",html:'<div style="background-image:url(resources/images/loading.gif); background-repeat:no-repeat; background-size:contain"><img src="resources/images/loading-graphic.png" style="height:60px; margin:5px 10px 5px 15px" /></div>'}]}},0,["splashscreen"],["component","container","panel","splashscreen"],{component:true,container:true,panel:true,splashscreen:true},["widget.splashscreen"],0,[InfinityMobile.view.tablet,"SplashScreen"],0));(Ext.cmd.derive("InfinityMobile.view.phone.SplashScreen",Ext.Panel,{config:{id:"splashscreen",layout:{type:"vbox",align:"center",pack:"middle"},width:"100%",height:"100%",style:"background-color:#1e1e1e;",items:[{style:"text-align:center",html:'<img src="resources/images/mobile-loading-logo.png" style="max-width:75%" />'},{style:"text-align:center",html:'<div style="background-image:url(resources/images/loading.gif); background-repeat:no-repeat; background-size:contain"><img src="resources/images/loading-graphic.png" style="height:40px; margin:5px 10px 5px 13px" /></div>'}]}},0,["splashscreen"],["component","container","panel","splashscreen"],{component:true,container:true,panel:true,splashscreen:true},["widget.splashscreen"],0,[InfinityMobile.view.phone,"SplashScreen"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderHelper",Ext.Container,{config:{width:"100%",height:"100%",top:0,left:0,layout:"vbox",items:[{height:40},{itemId:"container",style:"background-color:rgba(0, 0, 0, 0.7)",flex:1,cls:"backgroundImage fillwidth",layout:{type:"vbox",align:"center"},items:[{itemId:"continueButton",cls:"helpertabletButton",width:"100%",style:"text-align:center"}]}]},initialize:function(){var a=this;a.container=a.getComponent("container");a.continueButton=a.container.getComponent("continueButton");a.setImages();a.continueListener()},setImages:function(){var b=this;var c="http://html5.pagesuite.com/desktop/stage/resources/images/helper-portrait-overlay-tablet.png";var a="http://html5.pagesuite.com/desktop/stage/resources/images/helper-landscape-overlay-tablet.png";if(settings.reader.helperScreen!=null){if(settings.reader.helperScreen.portrait!=null){c=settings.reader.helperScreen.portrait}if(settings.reader.helperScreen.landscape!=null){a=settings.reader.helperScreen.landscape}}b.container.setHtml("<img class='portraitOnly' src='"+c+"' style='width:100%' /><img class='landscapeOnly' src='"+a+"' style='width:100%' />")},continueListener:function(){var b=this;var c=true;if(settings.newsday!=null){if(settings.newsday.articleHelper=="true"){c=false;b.continueButton.setHeight(35);b.continueButton.setStyle({textAlign:"center"});b.continueButton.setLayout({type:"hbox",pack:"center",align:"middle"});var d=Ext.create("Ext.Container",{html:"Next >"});var a=Ext.create("Ext.Container",{width:200,height:"100%",style:"background-color:#4591b8; color: white;",layout:{type:"hbox",pack:"center",align:"middle"}});a.add(d);b.continueButton.add(a);b.continueButton.element.on("tap",function(){b.fireEvent("articleHelper",b)})}}if(c){b.continueButton.setHtml("<img src='resources/images/tablet-overlay-btn.png' style='width:200px' />");b.continueButton.element.on("tap",function(){b.fireEvent("close",b)})}}},0,["readerhelper"],["component","container","readerhelper"],{component:true,container:true,readerhelper:true},["widget.readerhelper"],0,[InfinityMobile.view.tablet,"ReaderHelper"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderHelper",Ext.Container,{config:{width:"100%",height:"100%",top:0,left:0,layout:"vbox",items:[{height:40},{itemId:"container",style:"background-color:rgba(230, 230, 230, 0.9)",flex:1,scrollable:{direction:"vertical",directionLock:true},items:[{itemId:"nextButton",cls:"helperphoneButton",html:"<div style='width:100%; text-align:center'><img src='resources/images/mobile-btn1.png' style='width:120px;' /></div>"},{itemId:"continueButton",cls:"helperphoneButton",hidden:true,html:"<div style='width:100%; text-align:center'><img src='resources/images/mobile-btn2.png' style='width:120px;' /></div>"}]}]},initialize:function(){var a=this;a.container=a.getComponent("container");a.nextButton=a.container.getComponent("nextButton");a.continueButton=a.container.getComponent("continueButton");a.setImages();a.nextListener();a.continueListener()},setImages:function(){var b=this;var c="http://html5.pagesuite.com/desktop/stage/resources/images/branding/helper-portrait-overlay-tablet.png";var a="http://html5.pagesuite.com/desktop/stage/resources/images/branding/helper-landscape-overlay-tablet.png";if(settings.reader.helperScreen!=null){if(settings.reader.helperScreen.portrait!=null){c=settings.reader.helperScreen.portrait}if(settings.reader.helperScreen.landscape!=null){a=settings.reader.helperScreen.landscape}}b.container.setHtml("<img class='portraitOnly' src='"+c+"' style='width:100%' /><img class='landscapeOnly' src='"+a+"' style='width:100%' />")},nextListener:function(){var a=this;a.nextButton.element.on("tap",function(){a.fireEvent("next",a)})},continueListener:function(){var a=this;var b=true;if(settings.newsday!=null){if(settings.newsday.articleHelper=="true"){b=false;a.continueButton.setHtml("<div style='width:100%; text-align:center'><img src='resources/images/mobile-btn1.png' style='width:150px;' /></div>");a.continueButton.element.on("tap",function(){a.fireEvent("articleHelper",a)})}}if(b){a.continueButton.setHtml("<div style='width:100%; text-align:center'><img src='resources/images/mobile-btn2.png' style='width:150px;' /></div>");a.continueButton.element.on("tap",function(){a.fireEvent("close",a)})}}},0,["readerhelper"],["component","container","readerhelper"],{component:true,container:true,readerhelper:true},["widget.readerhelper"],0,[InfinityMobile.view.phone,"ReaderHelper"],0));(Ext.cmd.derive("InfinityMobile.view.Overlay",Ext.Panel,{config:{modal:true,hideOnMaskTap:true,centered:true},hide:function(){var a=this;Ext.Panel.prototype.hide.apply(this,arguments);if(a.isSearch==null){Ext.Viewport.remove(a,true)}}},0,["overlay"],["component","container","panel","overlay"],{component:true,container:true,panel:true,overlay:true},["widget.overlay"],0,[InfinityMobile.view,"Overlay"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuItem",Ext.Container,{config:{style:"font-size:14px;color:#cccccc;cursor:pointer",icon:"",text:""},initialize:function(){var a=this;if(a.config.id!=null){a.id=a.config.id}if(a.config.clickType!=null){}a.setupText(a.getText());a.element.on({tap:"onTap",scope:a})},setupText:function(b){var a=this;if(b!=null){switch(b.toLowerCase()){case"edition options":a.setHtml(language.menu.editionOptions);break;case"archive":a.setHtml(language.archive.archive);break;case"download":a.setHtml(language.download.download);break;case"bookmarks":a.setHtml(language.bookmarks.bookmarks);break;case"create clipping":a.setHtml(language.clippings.createClipping);break;case"print":a.setHtml(language.print.print);break;case"sections":if(a.id!="menuSectionsBtn"){a.setHtml(language.menu.sections)}else{a.setHtml(a.getText())}break;case"supplements":a.setHtml(language.menu.supplements);break;case"quick links":a.setHtml(language.menu.quickLinks);break;case"privacy":a.setHtml(language.menu.privacy!=null?language.menu.privacy:"PRIVACY");break;case"info":a.setHtml(language.menu.info);break;case"how to use":a.setHtml(language.howToUse.howToUse);break;case"contact us":a.setHtml(language.menu.contactUs);break;case"user options":a.setHtml(language.menu.userOptions);break;case"logout":a.setHtml(language.menu.logout);break;case"zones":if(a.id!="menuZonesBtn"){a.setHtml(language.menu.zones)}else{a.setHtml(a.getText())}break;case"articles":a.setHtml(language.articlesContainer.articles);break;case"pages":a.setHtml(language.articlesContainer.pages);break;case"terms and conditions":a.setHtml(language.menu.terms);break;case"my account":a.setHtml(language.menu.myAccount);break;case"search":a.setHtml(language.search.search);break;default:a.setHtml(a.getText());break}}},onTap:function(b){var a=this;if(a.config.clickType==null||a.config.clickType=="cls"){if(a.config.cls!=null){a.fireEvent(a.config.cls,a,"")}else{a.fireEvent(a.id,a,"")}}else{a.fireEvent(a.id,a,"")}b.stopPropagation()}},0,["readermenuitem"],["component","container","readermenuitem"],{component:true,container:true,readermenuitem:true},["widget.readermenuitem"],0,[InfinityMobile.view,"ReaderMenuItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuTTS",Ext.Container,{config:{defaults:{width:30,height:30,margin:"0 15 0 0"},items:[{itemId:"TTSicon",status:"STOPPED"}]},initialize:function(){var a=this;a.ttsicon=a.getComponent("TTSicon");if(ttsFlag.status=="PLAYING"){a.ttsicon.addCls("playing")}if(window.SpeechSynthesisUtterance===undefined||settings.tts===undefined||currentProfile=="desktop"){a.hide();a.setHeight(0)}else{a.setTtsToggleListener()}if(settings.newsday!=null&&settings.newsday.menuShareItemSize!=null){a.setDefaults({width:settings.newsday.menuShareItemSize+"px",height:settings.newsday.menuShareItemSize+"px",margin:"0 15 0 0"})}if(settings.newsday!=null&&settings.newsday.useFontAwesome=="true"){a.ttsicon.setHtml('<span class="fa fa-volume-up fa-lg pointerCursor" aria-hidden="true" stlye="color:white;margin:8px;"></span>')}else{a.ttsicon.setStyle({backgroundImage:'url("resources/images/reader%20icons/speech-ic-wht2.png")',backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"})}},setTtsToggleListener:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined){a.ttsicon.element.on({tap:function(){switch(ttsFlag.status){case"STOPPED":case"FINISHED":a.fireEvent("playArticleTTS",ttsFlag,a.ttsicon);break;case"PAUSED":a.fireEvent("resumeArticleTTS",ttsFlag,a.ttsicon);break;case"PLAYING":a.fireEvent("pauseArticleTTS",ttsFlag,a.ttsicon);break;default:a.fireEvent("stopArticleTTS",ttsFlag,a.ttsicon)}}})}}},0,["readermenutts"],["component","container","readermenutts"],{component:true,container:true,readermenutts:true},["widget.readermenutts"],0,[InfinityMobile.view,"ReaderMenuTTS"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuShare",Ext.Container,{config:{defaults:{width:30,height:30,margin:"0 15 15 0"}},initialize:function(){var a=this;if(settings.newsday!=null){if(settings.newsday.menuShareItemSize!=null){a.setDefaults({width:settings.newsday.menuShareItemSize+"px",height:settings.newsday.menuShareItemSize+"px",margin:"0 15 15 0"})}}},shareLoaded:function(){var c=document.getElementById("social").contentWindow.document.getElementsByTagName("a");var e=document.getElementById("social").contentDocument.getElementsByTagName("div");var k=[];var a=false;var g=false;var j=true;var f=false;var b=true;var h=true;document.getElementById("social").style.maxHeight="";e[3].onclick=(function(){window.location.href="http://mailto:?body="+window.location});if(a){e[3].style.display="none"}for(var d=0;d<c.length;d++){if(c[d].href.indexOf("facebook")!=-1){k[0]=c[d].href;c[d].onclick=(function(){window.open(k[0])});if(g){c[d].style.display="none"}}else{if(c[d].href.indexOf("google")!=-1){k[1]=c[d].href;c[d].onclick=(function(){window.open(k[1])});if(j){c[d].style.display="none"}}else{if(c[d].href.indexOf("twitter")!=-1){k[2]=c[d].href;c[d].onclick=(function(){window.open(k[2])});if(f){c[d].style.display="none"}}else{if(c[d].href.indexOf("pinterest")!=-1){k[3]=c[d].href;c[d].onclick=(function(){window.open(k[3])});if(b){c[d].style.display="none"}}else{if(c[d].href.indexOf("linkedin")!=-1){k[4]=c[d].href;c[d].onclick=(function(){window.open(k[4])});if(h){c[d].style.display="none"}}else{k[5]="mailto:?body="+window.location}}}}}}for(var d=0;d<c.length;d++){if(c[d].href.indexOf("facebook")!=-1){c[d].onclick=(function(){window.open(k[0])});if(g){c[d].style.display="none"}}else{if(c[d].href.indexOf("google")!=-1){c[d].onclick=(function(){window.open(k[1])});if(j){c[d].style.display="none"}}else{if(c[d].href.indexOf("twitter")!=-1){c[d].onclick=(function(){window.open(k[2])});if(f){c[d].style.display="none"}}else{if(c[d].href.indexOf("pinterest")!=-1){c[d].onclick=(function(){window.open(k[3])});if(b){c[d].style.display="none"}}else{if(c[d].href.indexOf("linkedin")!=-1){c[d].onclick=(function(){window.open(k[4])});if(h){c[d].style.display="none"}}else{c[5].onclick=(function(){window.location.href=k[5]})}}}}}c[d].href=""}}},0,["readermenushare"],["component","container","readermenushare"],{component:true,container:true,readermenushare:true},["widget.readermenushare"],0,[InfinityMobile.view,"ReaderMenuShare"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuSponsor",Ext.Container,{config:{style:"font-size:14px;color:#cccccc;cursor:pointer",height:50,width:"100%"},initialize:function(){var a=this;if(settings.menu.sponsor!=null){switch(settings.menu.sponsor.type){case"url":a.setupUrlAdvert();break}}},setupUrlAdvert:function(){var f=this;var b=settings.menu.sponsor.url;if(b!=null&&b.length>0){var a=50;var d=320;var e=settings.menu.sponsor;if(e.size!=null){try{d=e.size.split(",")[0];a=e.size.split(",")[1]}catch(c){console.error("[ReaderMenuSponsor]:\n",c)}}var g="pubid="+publicationguid+"&h="+a+"&w="+d+"&pnum=1&elemid="+encodeURIComponent(f.getId())+"&menu=true";b+=b.indexOf("?")==-1?"?"+g:"&"+g;f.setHeight(parseInt(a));f.setHtml("<iframe src='"+b+"' scrolling='no' style='width:"+d+"px;height:"+a+"px;border:none;'></iframe>")}else{this.hide()}}},0,["readermenusponsor"],["component","container","readermenusponsor"],{component:true,container:true,readermenusponsor:true},["widget.readermenusponsor"],0,[InfinityMobile.view,"ReaderMenuSponsor"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderMenu",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px)",right:0,top:40,items:[{itemId:"menuLayout",cls:"mainMenu",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",scrollable:{direction:"vertical",directionLock:true},items:[{itemId:"menuHeader",html:"Menu",margin:0,height:40,style:"background-color:#2c2f32; color:#ffffff",padding:"10 15 10 15",items:[{itemId:"menuHeaderClose",cls:"pointerCursor",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{id:"menuEditionOptions",cls:"menuSectionHeader menuEditionOptions",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",padding:"10 15 10 15",text:"EDITION OPTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/minimise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"editionOptionsSection",cls:"menuSectionContent menuEditionOptions",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15},minimized:false,items:[{id:"menuPages",cls:"menuItem menuPages",clickType:"id",xtype:"readermenuitem",text:"Pages"},{id:"menuArchive",cls:"menuItem menuArchive",clickType:"id",xtype:"readermenuitem",text:"Archive"},{id:"menuArticles",xtype:"readermenuitem",text:"Articles"},{id:"menuDynamicArticles",cls:"menuItem menuDynamicArticles",clickType:"id",xtype:"readermenuitem",text:"Advanced"},{id:"menuDownload",cls:"menuItem menuDownload",clickType:"id",xtype:"readermenuitem",text:"Download"},{id:"menuSearch",cls:"menuItem menuSearch",clickType:"id",xtype:"readermenuitem",text:"Search"},{id:"menuBookmarks",cls:"menuItem menuBookmarks",clickType:"id",xtype:"readermenuitem",text:"Bookmarks"},{id:"menuCreateClipping",cls:"menuItem menuCreateClipping",clickType:"id",xtype:"readermenuitem",text:"Create Clipping"},{id:"menuPrint",cls:"menuItem menuPrint",clickType:"id",xtype:"readermenuitem",text:"Print"},{id:"menuTTS",cls:"menuItem menuSharing",xtype:"readermenutts",layout:"vbox"},{id:"menuSharing",cls:"menuItem menuSharing",xtype:"readermenushare",layout:"vbox"}]},{itemId:"sponsorEdition",xtype:"readermenusponsor"},{id:"menuSections",cls:"menuSectionHeader menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"SECTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSectionsContainer",cls:"menuSectionContent menuSections",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuSupplements",cls:"menuSectionHeader menuSupplements",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"SUPPLEMENTS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSupplementsContainer",cls:"menuSectionContent menuSupplements",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuZones",cls:"menuSectionHeader menuZones",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"ZONES",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuZonesContainer",cls:"menuSectionContent menuZones",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuQuickLinks",cls:"menuSectionHeader menuQuickLinks",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"QUICK LINKS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuQuickLinksContainer",cls:"menuSectionContent menuQuickLinks",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuInfo",cls:"menuSectionHeader menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"INFO",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuInfoContainer",cls:"menuSectionContent menuInfo",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuHowToUse",xtype:"readermenuitem",cls:"menuItem menuHowToUse",clickType:"id",text:"How to use"},{id:"menuHelp",xtype:"readermenuitem",cls:"menuItem menuHelp",clickType:"id",text:"Contact Us"},{id:"menuTerms",cls:"menuItem menuTerms",clickType:"id",xtype:"readermenuitem",text:"Terms and Conditions"},{id:"menuStoryPref",cls:"menuItem menuStoryPref",clickType:"id",xtype:"readermenuitem",text:"Story Window Preferences"}]},{id:"menuUserOp",cls:"menuSectionHeader menuUserOp",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"USER OPTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuUserContainer",cls:"menuSectionContent menuUserOp",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuAccount",xtype:"readermenuitem",cls:"menuItem menuAccount",clickType:"id",text:"My Account"},{id:"menuUser",xtype:"readermenuitem",cls:"menuItem menuUser",clickType:"id",text:"Logout"}]},{id:"menuPrivacy",cls:"menuSectionHeader menuPrivacy",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"PRIVACY",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuPrivacyContainer",cls:"menuSectionContent menuPrivacyContainer",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:false}]}]},initialize:function(){var b=this;var a=Ext.getStore("SettingStore");if(b.config.direction!=null){b.direction=b.config.direction}if(b.direction=="left"){b.setRight("");b.setLeft(0);b.setZIndex(999999)}b.menuLayout=b.getComponent("menuLayout");b.menuLayout.setStyle("background-color:#"+settings.menu.background+";");b.menuLayout.getComponent("editionOptionsSection").getComponent("menuDynamicArticles").hide();b.menuHeader=b.menuLayout.getComponent("menuHeader");b.menuHeaderClose=b.menuHeader.getComponent("menuHeaderClose");b.checkArchive();b.checkDownload();b.checkClipping();b.checkPrint();b.checkBookmarks();b.checkHowToUse();b.checkHelp();b.checkLogout();b.checkTerms();b.checkSearch();b.checkPagesContainer();b.checkArticlesContainer();b.checkMenuHeader();b.checkStoryWindowPrefs();b.sharingContainer=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuSharing");b.sectionsHeaderContainer=b.menuLayout.getComponent("menuSections");b.sectionsContainer=b.menuLayout.getComponent("menuSectionsContainer");b.supplementsHeaderContainer=b.menuLayout.getComponent("menuSupplements");b.supplementsContainer=b.menuLayout.getComponent("menuSupplementsContainer");b.zonesHeaderContainer=b.menuLayout.getComponent("menuZones");b.zonesContainer=b.menuLayout.getComponent("menuZonesContainer");b.quickLinksHeaderContainer=b.menuLayout.getComponent("menuQuickLinks");b.quickLinksContainer=b.menuLayout.getComponent("menuQuickLinksContainer");b.privacyHeader=b.menuLayout.getComponent("menuPrivacy");b.privacyContainer=b.menuLayout.getComponent("menuPrivacyContainer");b.sponsorEdition=b.menuLayout.getComponent("sponsorEdition");b.sponsorSetup();b.loadShare();b.loadSections();b.loadSupplements();b.loadZones();b.loadQuickLinks();b.loadPrivacy();b.setupHeaders();b.fireEvent("disableArticlesContainer");b.fireEvent("hideArticlesContainer")},checkStoryWindowPrefs:function(){var a=this;a.menuStoryPref=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuStoryPref");if(settings.newsday==null){a.menuStoryPref.hide()}},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){a.fireEvent("close")})},checkMenuHeader:function(){var a=this;if(settings.newsday!=null){a.setTop(0);a.setStyle({height:"100%"});a.setCloseListener()}else{a.menuHeader.hide()}},checkPagesContainer:function(){var b=this;b.pagesBtn=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPages");var a=true;if(settings.newsday!=null){a=false}if(a){if(Ext.os.is.Desktop){b.pagesBtn.hide()}}},checkArticlesContainer:function(){var c=this;c.articlesBtn=c.menuLayout.getComponent("editionOptionsSection").getComponent("menuArticles");var a=false;if(Ext.os.is.Desktop){c.articlesBtn.hide();a=true}if(settings.newsday!=null){c.articlesBtn.hide();a=true}if(!a){if(settings.hideArticleBtn!=null){c.articlesBtn.hide()}else{var b=InfinityMobile.app.getController("ArticleController").getArticles();if(b==null||b.length==0){c.articlesBtn.hide()}}}},checkSearch:function(){var a=this;a.searchBtn=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSearch");if(Ext.os.is.Desktop){a.searchBtn.hide()}else{if(settings.newsday!=null){if(settings.newsday.menuSearch=="false"){a.searchBtn.hide()}}else{a.searchBtn.hide()}}},setupHeaders:function(){var b=this;b.editionOptionsHeaderContainer=b.menuLayout.getComponent("menuEditionOptions");var c=language.menu.editionOptions.toUpperCase();b.editionOptionsHeaderContainer.setHtml(c);b.editionOptionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.editionOptionsHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("editionOptionsSection"),b.editionOptionsHeaderContainer)},scope:b});if(!b.menuLayout.getComponent("editionOptionsSection").config.minimized){b.calculateSectionHeight(b.menuLayout.getComponent("editionOptionsSection"))}b.sectionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.sectionsHeaderContainer.element.on({tap:function(){b.headerTap(b.sectionsContainer,b.sectionsHeaderContainer)},scope:b});b.supplementsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.supplementsHeaderContainer.element.on({tap:function(){b.headerTap(b.supplementsContainer,b.supplementsHeaderContainer)},scope:b});b.zonesHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.zonesHeaderContainer.element.on({tap:function(){b.headerTap(b.zonesContainer,b.zonesHeaderContainer)},scope:b});b.quickLinksHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.quickLinksHeaderContainer.element.on({tap:function(){b.headerTap(b.quickLinksContainer,b.quickLinksHeaderContainer)},scope:b});b.privacyHeader.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.privacyHeader.element.on({tap:function(){b.headerTap(b.privacyContainer,b.privacyHeader)},scope:b});if(!b.privacyContainer.config.minimized){b.privacyHeader.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/minimise-menu-option.png')";b.calculateSectionHeight(b.privacyContainer)}b.menuInfoHeaderContainer=b.menuLayout.getComponent("menuInfo");var a=language.menu.info.toUpperCase();b.menuInfoHeaderContainer.setHtml(a);b.menuInfoHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.menuInfoHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuInfoContainer"),b.menuLayout.getComponent("menuInfo"))},scope:b});b.menuUserHeaderContainer=b.menuLayout.getComponent("menuUserOp");b.menuUserHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.menuUserHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuUserContainer"),b.menuLayout.getComponent("menuUserOp"))},scope:b});if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){if(b.editionOptionsHeaderContainer!=null){b.editionOptionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.editionOptionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}if(b.sectionsHeaderContainer!=null){b.sectionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.sectionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.supplementsHeaderContainer!=null){b.supplementsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.supplementsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.zonesHeaderContainer!=null){b.zonesHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.zonesHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.quickLinksHeaderContainer!=null){b.quickLinksHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.quickLinksHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuInfoHeaderContainer!=null){b.menuInfoHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuInfoHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuUserHeaderContainer!=null){b.menuUserHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuUserHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}}},calculateSectionHeight:function(d){var b=this;for(var a=0;a<d.items.items.length;a++){var c=d.items.items[a];if(!c.getHidden()){height+=parseFloat($(c.element.dom).height())}}d.element.dom.style.maxHeight=height+"px"},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},headerTap:function(f,g){var d=this;if(f.config.minimized){var b=0;f.setDefaults({padding:"15px 0px 15px 0px"});for(var c=0;c<f.items.items.length;c++){var e=f.items.items[c];if(!e.getHidden()){console.log(parseFloat($(e.element.dom).height()));b+=parseFloat($(e.element.dom).height())}}f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.element.dom.style.maxHeight=b+"px";setTimeout(function(){var h=d.menuLayout.getScrollable().getScroller();var k=g.element.dom;var j=h.maxPosition.y,l=(k.offsetTop>j)?j:k.offsetTop;h.scrollTo(0,l,true)},420);var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/minimise-menu-option.png')"}f.config.minimized=false}else{f.setDefaults({padding:"0px 0px 0px 0px"});f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.setStyle({maxHeight:"0px"});var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/maximise-menu-option.png')"}f.config.minimized=true}},checkPages:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPages");if(settings.menu.hidePages!=null){if(settings.menu.hidePages){a.hide()}}else{if(settings.menu.pagesText!=null){}}},checkArchive:function(){var d=this;var b=d.menuLayout.getComponent("editionOptionsSection").getComponent("menuArchive");if(settings.menu.hideArchive!=null){if(settings.menu.hideArchive){b.hide()}}else{if(settings.menu.archiveText!=null){var a=Ext.getStore("ArchiveStore");var c=[];if(a.data.items[0]!=null){if(a.data.items[0].raw.editions!=null){c=a.data.items[0].raw.editions.edition;if(c.length==0){b.hide()}else{if(Object.prototype.toString.call(c)==="[object Object]"){if(c["@name"]==editionName){}}}}}}}},checkDownload:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuDownload");if(settings.menu.hideDownload!=null){if(settings.menu.hideDownload){a.hide()}}else{if(settings.menu.downloadText!=null){}}},checkClipping:function(){var a=this;var b=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuCreateClipping");if(settings.menu.hideClipping!=null){b.hide()}else{}},checkArticles:function(){var c=this;var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.hideArticleBtn!=null){c.menuLayout.getComponent("editionOptionsSection").getComponent("menuArticles").hide()}else{var a=InfinityMobile.app.getController("ArticleController").getArticles();if(a==null||a.length==0){c.menuLayout.getComponent("editionOptionsSection").getComponent("menuArticles").hide()}}},checkPrint:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPrint");if(!Ext.os.is.Desktop){a.hide()}else{if(settings.menu.hidePrint!=null){if(settings.menu.hidePrint){a.hide()}}else{if(settings.menu.printText!=null){}}}},checkBookmarks:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuBookmarks");if(settings.bookmarks==null){a.hide()}else{if(settings.menu.bookmarkText!=null){}}},checkHowToUse:function(){var b=this;var a=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuHowToUse");if(settings.menu.hideHowToUse!=null){if(settings.menu.hideHowToUse){a.hide()}}else{if(settings.menu.howToUseText!=null){}}},checkHelp:function(){var b=this;var a=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuHelp")},loadShare:function(){var a=this;a.fireEvent("loadShare",a)},loadSections:function(){var a=this;a.fireEvent("loadSections",a,a.sectionsContainer,a.sectionsHeaderContainer)},loadSupplements:function(){var a=this;a.fireEvent("loadSupplements",a,a.supplementsContainer,a.supplementsHeaderContainer)},loadZones:function(){var a=this;a.fireEvent("loadZones",a,a.zonesContainer,a.zonesHeaderContainer)},loadQuickLinks:function(){var a=this;a.fireEvent("loadQuickLinks",a,a.quickLinksContainer,a.quickLinksHeaderContainer)},loadPrivacy:function(){var a=this;a.fireEvent("loadPrivacy",a,a.privacyContainer,a.privacyHeader)},checkWhatsNewBanner:function(){var b=this;var a=b.whatsNewContainer.element.down(".bannerIcon").dom;if(localStorage.getItem("versionwhatsnew"+version.replace(/g./g,"_"))!=null){a.style.display="none"}},sponsorSetup:function(){var f=this;if(settings.menu.sponsor!=null){var d=320;var e=settings.menu.sponsor;if(e.size!=null){try{d=e.size.split(",")[0]}catch(c){console.error("[ReaderMenu]:\n",c)}}if(e.position!=null){switch(e.position.toLowerCase()){case"sections":var a=f.sponsorEdition;var b=f.findItemIndex(f.sectionsContainer)+1;f.menuLayout.insert(b,a)}}f.setWidth(parseInt(d))}else{f.sponsorEdition.hide()}},findItemIndex:function(e){var b=-1;var a=this.menuLayout.getItems().items;for(var d=0;d<a.length;d++){var c=a[d];if(c.getId()==e.getId()){b=d;break}}return b},checkLogout:function(){var a=this;if(loggedIn.toLowerCase()!="true"){a.menuLayout.getComponent("menuUserContainer").hide();a.menuLayout.getComponent("menuUserOp").hide()}},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)},checkTerms:function(){var a=this;a.menuTerms=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuTerms");if(settings.menu.terms==null){a.menuTerms.hide()}}},0,["readermenu"],["component","container","panel","overlay","readermenu"],{component:true,container:true,panel:true,overlay:true,readermenu:true},["widget.readermenu"],0,[InfinityMobile.view.tablet,"ReaderMenu"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderMenu",InfinityMobile.view.Overlay,{config:{width:"100%",layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:100%",right:0,top:0,height:"100%",items:[{itemId:"menuLayout",cls:"mainMenu",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{margin:15},scrollable:{direction:"vertical",directionLock:true},items:[{itemId:"menuHeader",html:"Menu",margin:0,height:40,style:"background-color:#2c2f32; color:#ffffff",padding:"10 15 10 15",items:[{itemId:"menuHeaderClose",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{id:"menuEditionOptions",cls:"menuSectionHeader menuEditionOptions",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"EDITION OPTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/minimise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"editionOptionsSection",cls:"menuSectionContent menuEditionOptions",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15},minimized:false,items:[{id:"menuPages",cls:"menuItem menuPages",clickType:"id",xtype:"readermenuitem",text:"Pages"},{id:"menuArticles",cls:"menuItem menuArticles",clickType:"id",xtype:"readermenuitem",text:"Articles"},{id:"menuArchive",cls:"menuItem menuArchive",clickType:"id",xtype:"readermenuitem",text:"Archive"},{id:"menuDownload",cls:"menuItem menuDownload",clickType:"id",xtype:"readermenuitem",text:"Download"},{id:"menuSearch",cls:"menuItem menuSearch",clickType:"id",xtype:"readermenuitem",text:"Search"},{id:"menuBookmarks",cls:"menuItem menuBookmarks",clickType:"id",xtype:"readermenuitem",text:"Bookmarks"},{id:"menuCreateClipping",cls:"menuItem menuCreateClipping",clickType:"id",xtype:"readermenuitem",text:"Create Clipping"},{id:"menuTTS",cls:"menuItem menuSharing",xtype:"readermenutts",layout:"vbox"},{id:"menuSharing",cls:"menuItem menuSharing",margin:0,xtype:"readermenushare"}]},{id:"sponsorEdition",style:"background-color:rgb(80, 80, 80);font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;cursor:pointer",margin:0,padding:"10 15 10 15",height:40,width:"100%",html:"<img style='height:20px;width:auto;' src='http://humanrobotinteraction.org/2015/wp-content/uploads/2015/01/Honda-logo.png' />",url:"http://www.honda.co.uk/",items:[{html:"SPONSORED",style:"font-size:10px;",top:5,right:5}]},{id:"menuSections",cls:"menuSectionHeader menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"SECTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSectionsContainer",cls:"menuSectionContent menuSections",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuSupplements",cls:"menuSectionHeader menuSupplements",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"SUPPLEMENTS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuSupplementsContainer",cls:"menuSectionContent menuSupplements",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuZones",cls:"menuSectionHeader menuZones",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",margin:"0 0 0 0",padding:"10 15 10 15",text:"ZONES",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuZonesContainer",cls:"menuSectionContent menuZones",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuQuickLinks",cls:"menuSectionHeader menuQuickLinks",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"QUICK LINKS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuQuickLinksContainer",cls:"menuSectionContent menuQuickLinks",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true},{id:"menuInfo",cls:"menuSectionHeader menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"INFO",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuInfoContainer",cls:"menuSectionContent menuInfo",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuHowToUse",xtype:"readermenuitem",cls:"menuItem menuHowToUse",text:"How to use"},{id:"menuHelp",xtype:"readermenuitem",cls:"menuItem menuHelp",text:"Contact Us"},{id:"menuTerms",xtype:"readermenuitem",cls:"menuItem menuTerms",text:"Terms and Conditions"},{id:"menuStoryPref",cls:"menuItem menuStoryPref",clickType:"id",xtype:"readermenuitem",text:"Story Window Preferences"}]},{id:"menuUserOp",cls:"menuSectionHeader menuUserOp",xtype:"readermenuitem",margin:0,style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray",padding:"10 15 10 15",text:"USER OPTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuUserContainer",cls:"menuSectionContent menuUserOp",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;max-height:0px;",minimized:true,items:[{id:"menuAccount",xtype:"readermenuitem",text:"My Account"},{id:"menuUser",xtype:"readermenuitem",text:"Logout"}]},{id:"sponsorInfo",style:"background-color:rgb(80, 80, 80);font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;cursor:pointer ",padding:"10 15 10 15",margin:0,height:40,width:"100%",html:"<img style='height:20px;width:auto;' src='http://humanrobotinteraction.org/2015/wp-content/uploads/2015/01/Honda-logo.png' />",url:"http://www.honda.co.uk/",items:[{html:"SPONSORED",style:"font-size:10px;",top:5,right:5}]}]}]},initialize:function(){var b=this;b.menuLayout=b.getComponent("menuLayout");b.menuLayout.setStyle("background-color:#"+settings.menu.background+";");var c=b.menuLayout.getComponent("menuHeader");b.menuHeaderClose=c.getComponent("menuHeaderClose");var a=Ext.getStore("SettingStore");b.setCloseListener();b.checkPages();b.checkArchive();b.checkDownload();b.checkClipping();b.checkArticles();b.checkBookmarks();b.checkHowToUse();b.checkHelp();b.checkLogout();b.checkTerms();b.checkSearch();b.checkStoryWindowPrefs();b.sharingContainer=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuSharing");b.sectionsHeaderContainer=b.menuLayout.getComponent("menuSections");b.sectionsContainer=b.menuLayout.getComponent("menuSectionsContainer");b.supplementsHeaderContainer=b.menuLayout.getComponent("menuSupplements");b.supplementsContainer=b.menuLayout.getComponent("menuSupplementsContainer");b.zonesHeaderContainer=b.menuLayout.getComponent("menuZones");b.zonesContainer=b.menuLayout.getComponent("menuZonesContainer");b.quickLinksHeaderContainer=b.menuLayout.getComponent("menuQuickLinks");b.quickLinksContainer=b.menuLayout.getComponent("menuQuickLinksContainer");b.sponsorEdition=b.menuLayout.getComponent("sponsorEdition");b.sponsorInfo=b.menuLayout.getComponent("sponsorInfo");b.sponsorSetup();b.loadShare();b.loadSections();b.loadSupplements();b.loadQuickLinks();b.loadZones();b.setupHeaders()},checkStoryWindowPrefs:function(){var a=this;a.menuStoryPref=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuStoryPref");if(settings.newsday==null){a.menuStoryPref.hide()}},checkSearch:function(){var a=this;a.searchBtn=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuSearch");if(settings.newsday!=null){if(settings.newsday.menuSearch=="false"){a.searchBtn.hide()}}else{a.searchBtn.hide()}},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){a.fireEvent("close")})},setupHeaders:function(){var b=this;b.editionOptionsHeaderContainer=b.menuLayout.getComponent("menuEditionOptions");var c=language.menu.editionOptions.toUpperCase();b.editionOptionsHeaderContainer.setHtml(c);b.editionOptionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.editionOptionsHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("editionOptionsSection"),b.editionOptionsHeaderContainer)},scope:b});if(!b.menuLayout.getComponent("editionOptionsSection").config.minimized){b.calculateSectionHeight(b.menuLayout.getComponent("editionOptionsSection"))}b.sectionsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.sectionsHeaderContainer.element.on({tap:function(){b.headerTap(b.sectionsContainer,b.sectionsHeaderContainer)},scope:b});b.supplementsHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.supplementsHeaderContainer.element.on({tap:function(){b.headerTap(b.supplementsContainer,b.supplementsHeaderContainer)},scope:b});b.zonesHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.zonesHeaderContainer.element.on({tap:function(){b.headerTap(b.zonesContainer,b.zonesHeaderContainer)},scope:b});b.quickLinksHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.quickLinksHeaderContainer.element.on({tap:function(){b.headerTap(b.quickLinksContainer,b.quickLinksHeaderContainer)},scope:b});b.menuInfoHeaderContainer=b.menuLayout.getComponent("menuInfo");var a=language.menu.info.toUpperCase();b.menuInfoHeaderContainer.setHtml(a);b.menuInfoHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.menuInfoHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuInfoContainer"),b.menuLayout.getComponent("menuInfo"))},scope:b});b.menuUserHeaderContainer=b.menuLayout.getComponent("menuUserOp");b.menuUserHeaderContainer.setStyle("background-color:#"+settings.menu.headerBackground+";font-size:14px;color:#cccccc");b.menuUserHeaderContainer.element.on({tap:function(){b.headerTap(b.menuLayout.getComponent("menuUserContainer"),b.menuLayout.getComponent("menuUserOp"))},scope:b});if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){if(b.editionOptionsHeaderContainer!=null){b.editionOptionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.editionOptionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}if(b.sectionsHeaderContainer!=null){b.sectionsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.sectionsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.supplementsHeaderContainer!=null){b.supplementsHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.supplementsHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.zonesHeaderContainer!=null){b.zonesHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.zonesHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.quickLinksHeaderContainer!=null){b.quickLinksHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.quickLinksHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuInfoHeaderContainer!=null){b.menuInfoHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuInfoHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}if(b.menuUserHeaderContainer!=null){b.menuUserHeaderContainer.getComponent("toggleSection").element.dom.style.background="";b.menuUserHeaderContainer.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}}},calculateSectionHeight:function(d){var b=this;for(var a=0;a<d.items.items.length;a++){var c=d.items.items[a];if(!c.getHidden()){height+=parseFloat($(c.element.dom).height())}}d.element.dom.style.maxHeight=height+"px"},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},headerTap:function(f,g){var d=this;if(f.config.minimized){var b=0;f.setDefaults({padding:"15px 0px 15px 0px"});for(var c=0;c<f.items.items.length;c++){var e=f.items.items[c];if(!e.getHidden()){console.log(parseFloat($(e.element.dom).height()));b+=parseFloat($(e.element.dom).height())}}f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.element.dom.style.maxHeight=b+"px";setTimeout(function(){var h=d.menuLayout.getScrollable().getScroller();var k=g.element.dom;var j=h.maxPosition.y,l=(k.offsetTop>j)?j:k.offsetTop;h.scrollTo(0,l,true)},420);var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-minus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/minimise-menu-option.png')"}f.config.minimized=false}else{f.setDefaults({padding:"0px 0px 0px 0px"});f.setStyle({webkitTransition:"all 0.4s ease",mozTransition:"all 0.4s ease",transition:"all 0.4s ease"});f.setStyle({maxHeight:"0px"});var a=true;if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){a=false;g.getComponent("toggleSection").setHtml('<i class="fa fa-plus pointerCursor" aria-hidden="true"></i>')}}if(a){g.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/maximise-menu-option.png')"}f.config.minimized=true}},checkPages:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPages");if(settings.menu.hidePages!=null){if(settings.menu.hidePages){a.hide()}}else{if(settings.menu.pagesText!=null){}}},checkArchive:function(){var d=this;var b=d.menuLayout.getComponent("editionOptionsSection").getComponent("menuArchive");if(settings.menu.hideArchive!=null){if(settings.menu.hideArchive){b.hide()}}else{if(settings.menu.archiveText!=null){var a=Ext.getStore("ArchiveStore");var c=[];if(a.data.items[0]!=null){if(a.data.items[0].raw.editions!=null){c=a.data.items[0].raw.editions.edition;if(c.length==0){b.hide()}else{if(Object.prototype.toString.call(c)==="[object Object]"){if(c["@name"]==editionName){b.hide()}}}}}}}},checkDownload:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuDownload");if(settings.menu.hideDownload!=null){if(settings.menu.hideDownload){a.hide()}}else{if(settings.menu.downloadText!=null){}}},checkClipping:function(){var a=this;var b=a.menuLayout.getComponent("editionOptionsSection").getComponent("menuCreateClipping");if(settings.menu.hideClipping!=null){b.hide()}else{}},checkArticles:function(){var b=this;if(settings.hideArticleBtn!=null){b.menuLayout.getComponent("editionOptionsSection").getComponent("menuArticles").hide()}else{var a=InfinityMobile.app.getController("ArticleController").getArticles();if(a==null||a.length==0||settings.dynamic==null){b.menuLayout.getComponent("editionOptionsSection").getComponent("menuArticles").hide()}else{}}},checkPrint:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuPrint");if(!Ext.os.is.Desktop){a.hide()}else{if(settings.menu.hidePrint!=null){if(settings.menu.hidePrint){a.hide()}}else{if(settings.menu.printText!=null){}}}},checkBookmarks:function(){var b=this;var a=b.menuLayout.getComponent("editionOptionsSection").getComponent("menuBookmarks");if(settings.bookmarks==null){a.hide()}else{if(settings.menu.bookmarkText!=null){}}},checkHowToUse:function(){var b=this;var a=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuHowToUse");if(settings.menu.hideHowToUse!=null){if(settings.menu.hideHowToUse){a.hide()}}else{if(settings.menu.howToUseText!=null){}}},checkHelp:function(){var b=this;var a=b.menuLayout.getComponent("menuInfoContainer").getComponent("menuHelp")},loadShare:function(){var a=this;a.fireEvent("loadShare",a)},loadSections:function(){var a=this;a.fireEvent("loadSections",a,a.sectionsContainer,a.sectionsHeaderContainer)},loadSupplements:function(){var a=this;a.fireEvent("loadSupplements",a,a.supplementsContainer,a.supplementsHeaderContainer)},loadQuickLinks:function(){var a=this;a.fireEvent("loadQuickLinks",a,a.quickLinksContainer,a.quickLinksHeaderContainer)},loadZones:function(){var a=this;a.fireEvent("loadZones",a,a.zonesContainer,a.zonesHeaderContainer)},checkWhatsNewBanner:function(){var c=this;var a=c.whatsNewContainer.element.down(".bannerIcon").dom;try{if(localStorage.getItem("versionwhatsnew"+version.replace(/g./g,"_"))!=null){a.style.display="none"}}catch(b){}},sponsorSetup:function(){var a=this;if(settings.menu.sponsor==null){a.sponsorEdition.hide();a.sponsorInfo.hide()}else{if(a.sponsorEdition!=null){a.sponsorEdition.setHtml("<img style='height:20px;width:auto;' src='"+settings.menu.sponsor.image+"' />");a.sponsorEdition.url=settings.menu.sponsor.link;if(settings.menu.sponsor.link!=null&&settings.menu.sponsor.link.length>0){a.sponsorEdition.element.on({tap:function(){var b=this;window.open(b.url)},scope:a.sponsorEdition})}}if(a.sponsorInfo!=null){a.sponsorInfo.setHtml("<img style='height:20px;width:auto;' src='"+settings.menu.sponsor.image+"' />");a.sponsorInfo.url=settings.menu.sponsor.link;if(settings.menu.sponsor.link!=null&&settings.menu.sponsor.link.length>0){a.sponsorInfo.element.on({tap:function(){var b=this;window.open(b.url)},scope:a.sponsorInfo})}}}},checkLogout:function(){var a=this;if(loggedIn.toLowerCase()!="true"){a.menuLayout.getComponent("menuUserContainer").hide();a.menuLayout.getComponent("menuUserOp").hide()}},checkTerms:function(){var a=this;a.menuTerms=a.menuLayout.getComponent("menuInfoContainer").getComponent("menuTerms");if(settings.menu.terms==null){a.menuTerms.hide()}}},0,["readermenu"],["component","container","panel","overlay","readermenu"],{component:true,container:true,panel:true,overlay:true,readermenu:true},["widget.readermenu"],0,[InfinityMobile.view.phone,"ReaderMenu"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderMenuSection",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px)",right:0,top:40,items:[{itemId:"sectionitemscontainer",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{padding:15},items:[{id:"menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc",margin:"0 0 15 0",padding:"5 15 5 15",text:"SECTIONS"}]}]},initialize:function(){var a=this;a.sectionItemsContainer=a.getComponent("sectionitemscontainer");a.fireEvent("initialized",a)}},0,["readermenusection"],["component","container","panel","overlay","readermenusection"],{component:true,container:true,panel:true,overlay:true,readermenusection:true},["widget.readermenusection"],0,[InfinityMobile.view.tablet,"ReaderMenuSection"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderMenuSection",InfinityMobile.view.Overlay,{config:{width:"100%",layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:100%",right:0,top:0,items:[{itemId:"menuHeader",html:"Menu",margin:0,height:40,style:"background-color:#2c2f32; color:#ffffff",padding:"10 15 10 15",items:[{itemId:"menuHeaderClose",right:0,top:0,height:40,width:40,padding:10,html:"<img src='../assets/Menu/close-btn-white.png' style='width:20px' />"}]},{itemId:"sectionitemscontainer",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{padding:15},items:[{id:"menuSections",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc",margin:"0 0 15 0",padding:"5 15 5 15",text:"SECTIONS"}]}]},initialize:function(){var a=this;a.sectionItemsContainer=a.getComponent("sectionitemscontainer");var b=a.getComponent("menuHeader");a.menuHeaderClose=b.getComponent("menuHeaderClose");a.setCloseListener();a.fireEvent("initialized",a)},setCloseListener:function(){var a=this;a.menuHeaderClose.element.on("tap",function(){a.hide()})},backtapped:function(){var a=this;a.fireEvent("back",a)}},0,["readermenusection"],["component","container","panel","overlay","readermenusection"],{component:true,container:true,panel:true,overlay:true,readermenusection:true},["widget.readermenusection"],0,[InfinityMobile.view.phone,"ReaderMenuSection"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArchiveSelector",Ext.Panel,{config:{height:60,padding:"0 10px",layout:{type:"vbox",align:"center"},items:[{itemId:"selectEdition",style:"font-size:11pt;",html:"Select edition:",width:"100%"},{height:10},{itemId:"container",width:"100%",layout:"hbox",items:[{style:"font-size:11pt;",html:"<div class='selectBox'><select id='yearDropDown'></select></div>"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='monthDropDown'></select></div>"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='dayDropDown'></select></div>"},{width:10},{itemId:"change",height:25,cls:"pointerCursor",style:"font-size:11pt;position:relative;",html:'<span style="position:absolute;bottom:0px;text-decoration:underline;">Change</span>'}]}]},initialize:function(){var c=this;c.datePickerYear=c.element.down("#yearDropDown").dom;c.datePickerMonth=c.element.down("#monthDropDown").dom;c.datePickerDay=c.element.down("#dayDropDown").dom;c.container=c.getComponent("container");c.changeBtn=c.container.getComponent("change");var b=c.hexToRgb(settings.topbar.backgroundColor);if(settings.topbar!=null){c.setStyle({backgroundColor:"rgba("+b.r+","+b.g+","+b.b+",0.9)",color:"#"+settings.topbar.color})}c.changeBtn.element.on({tap:c.changeEdition,scope:c});var a=settings.dateSelector.oldestEdition.split("/");c.earliestDate=new Date(a[2],a[1],a[0]);c.on({painted:function(){c.populateYearDropDown();c.datePickerYear.selectedIndex=c.datePickerYear.options.length-1;c.populateMonthDropDown();c.datePickerMonth.selectedIndex=c.datePickerMonth.options.length-1;c.populateDayDropDown();c.datePickerDay.selectedIndex=c.datePickerDay.options.length-1}});c.setTodaysDate()},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},populateYearDropDown:function(){var c=this;var a=new Date();for(var b=c.earliestDate.getFullYear();b<=a.getFullYear();b++){c.addOption(c.datePickerYear,b,b)}c.datePickerYear.onchange=function(){c.populateMonthDropDown();c.populateDayDropDown()}},populateMonthDropDown:function(){var g=this;var f=g.datePickerMonth.options[g.datePickerMonth.selectedIndex];var b=0;var h=12;var d=new Date();g.datePickerMonth.options.length=0;if(g.datePickerYear.options[g.datePickerYear.selectedIndex].value==d.getFullYear()){h=d.getMonth()+1}if(g.datePickerYear.options[g.datePickerYear.selectedIndex].value==g.earliestDate.getFullYear()){b=g.earliestDate.getMonth()-1}for(var e=b;e<h;e++){var c="Jan";switch(e){case 0:c="Jan";break;case 1:c="Feb";break;case 2:c="Mar";break;case 3:c="Apr";break;case 4:c="May";break;case 5:c="Jun";break;case 6:c="Jul";break;case 7:c="Aug";break;case 8:c="Sep";break;case 9:c="Oct";break;case 10:c="Nov";break;case 11:c="Dec";break}g.addOption(g.datePickerMonth,c,e+1)}g.datePickerMonth.onchange=function(){g.populateDayDropDown()};if(f!=null){for(var a=0;a<g.datePickerMonth.options.length;a++){if(g.datePickerMonth.options[a].value==f.value){g.datePickerMonth.selectedIndex=a;break}}}},populateDayDropDown:function(){var e=this;var b=e.datePickerDay.options[e.datePickerDay.selectedIndex];e.datePickerDay.options.length=0;var c=new Date();var f=32;switch(e.datePickerMonth.options[e.datePickerMonth.selectedIndex].innerHTML){case"Jan":case"Mar":case"May":case"Jul":case"Aug":case"Oct":case"Dec":f=32;break;case"Apr":case"Jun":case"Sep":case"Nov":f=31;break;case"Feb":if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value%4==0){f=30}else{f=29}break}var g=1;if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value==e.earliestDate.getFullYear()&&e.datePickerMonth.options[e.datePickerMonth.selectedIndex].value==e.earliestDate.getMonth()){g=e.earliestDate.getDate()}if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value==c.getFullYear()&&e.datePickerMonth.options[e.datePickerMonth.selectedIndex].value==c.getMonth()+1){f=c.getDate()+1}for(var d=g;d<f;d++){e.addOption(e.datePickerDay,d.toString(),d.toString())}if(b!=null){for(var a=0;a<e.datePickerDay.options.length;a++){if(e.datePickerDay.options[a].value==b.value){e.datePickerDay.selectedIndex=a;break}}}},addOption:function(a,d,c){var b=document.createElement("option");b.text=d;b.value=c;a.add(b)},setTodaysDate:function(){var a=this;a.todaysDate=new Date().yyyymmdd();var b=a.todaysDate.split("-");a.todayDateYear=b[0];a.todayDateMonth=b[1].toString();if(a.todayDateMonth.toString().startsWith("0")){a.todayDateMonth=a.todayDateMonth.replace("0","")}a.todayDateDay=b[2];if(a.todayDateDay.startsWith("0")){a.todayDateDay=a.todayDateDay.replace("0","")}a.datePickerYear.value=a.todayDateYear;a.datePickerMonth.value=a.todayDateMonth;a.datePickerDay.value=a.todayDateDay;a.formatDate()},formatDate:function(a,d,b){var c=this;c.trimDayToMonth();if(b==c.todayDateYear){c.trimMonthToCurrent();if(d==c.todayDateYear){c.trimDayToCurrent()}}},trimMonthToCurrent:function(){var a=this},trimDayToMonth:function(d,b){var c=this;switch(d){case"4":case"6":case"9":case"11":c.trimDays(30);break;case"2":var a=28;if(parseInt(b)%4==0){a=29}c.trimDay(a);break;default:break}},trimDayToCurrent:function(){var a=this;a.trimDay(parseInt(a.todayDateDay))},trimDay:function(a){},changeEdition:function(){var a=this;window.location.href="../get_edition_by_date.aspx?pubid="+publicationguid+"&year="+a.datePickerYear.options[a.datePickerYear.selectedIndex].value+"&month="+a.datePickerMonth.options[a.datePickerMonth.selectedIndex].value+"&day="+a.datePickerDay.options[a.datePickerDay.selectedIndex].value}},0,["archiveselector"],["component","container","panel","archiveselector"],{component:true,container:true,panel:true,archiveselector:true},["widget.archiveselector"],0,[InfinityMobile.view.phone,"ArchiveSelector"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderArchive",InfinityMobile.view.Overlay,{config:{id:"archivecontainer",height:"100%",width:"100%",style:"padding:0px;max-height:700px;max-width:700px;",items:[{id:"archiveToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{id:"archiveToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"archiveBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"archiveSelector",xtype:"archiveselector",style:"background-color:transparent;color:black;"},{itemId:"archiveContainerText",margin:"0 0 20px 0"},{itemId:"archiveMonthContainerHorizontal",layout:"hbox",items:[{html:"<img src='https://media.pagesuite.com/psapps/images/default/LeftArrow_Icon.png' style='width:20px' />"},{itemId:"archiveMonthsContainer",height:30,flex:1,layout:"hbox",margin:"0 15px 0 15px",padding:"0 0 10px 0",monthdirection:"horizontal",scrollable:{direction:"horizontal",directionLock:true},defaults:{width:100,height:20,margin:"0 20px 0 0",padding:0,style:"font-weight:bold",type:"shortDate"},items:[]},{html:"<img src='https://media.pagesuite.com/psapps/images/default/RightArrow_Icon.png' style='width:20px' />"}]},{layout:"hbox",height:560,itemId:"archiveItemsGlobalContainer",items:[{itemId:"archiveMonthsContainer",width:180,height:"100%",monthdirection:"vertical",scrollable:{direction:"vertical",directionLock:true}},{id:"archiveItemsContainer",height:560,flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:145,margin:"0 8 16 7",cls:"archiveitemphone"}}]}]}]},initialize:function(){var g=this;var c=g.getComponent("archiveToolBar");g.archiveToolBarClose=c.getComponent("archiveToolBarClose");c.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});g.title=c.getComponent("title");g.title.setHtml(language.archive.archive);var j=g.getComponent("archiveBodyContainer");g.archiveContainerText=j.getComponent("archiveContainerText");g.archiveContainerText.setHtml(language.archive.archiveContainerText);g.archiveSelector=j.getComponent("archiveSelector");var d=j.getComponent("archiveItemsGlobalContainer");g.archiveItemsContainer=d.getComponent("archiveItemsContainer");var h=j.getComponent("archiveMonthContainerHorizontal");var f=h.getComponent("archiveMonthsContainer");var e=d.getComponent("archiveMonthsContainer");var a=e;if(settings.menu.archiveUsesTabs!=null){if(settings.menu.archiveMonthDirection.toLowerCase()!=null&&settings.menu.archiveMonthDirection.toLowerCase()=="horizontal"){a=f}}if(a==f){e.hide()}else{h.hide()}g.archiveMonthsContainer=a;if(settings.tracking!=null){var b=settings.tracking.trackingType;if(b=="DA"){trackDaPageView("Archive","Digital Edition")}}g.setCloseListener();if(settings.newsday!=null){c.element.dom.style.borderTopLeftRadius="";c.element.dom.style.borderTopRightRadius="";g.setStyle({borderRadius:"0px"});g.element.down("div").dom.style.borderRadius="0px";g.archiveSelector.setStyle({backgroundColor:"transparent"});g.archiveSelector.element.dom.style.color="";g.archiveSelector.setMargin("0 0 10px 0");g.archiveSelector.setPadding(0);g.archiveSelector.element.on("tap",function(){g.archiveSelector.focus()});d.setHeight(520);g.archiveItemsContainer.setHeight(520)}else{g.archiveSelector.hide()}g.fireEvent("initialized",g)},setCloseListener:function(){var b=this;b.archiveToolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.archiveToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)},hideMonthContainer:function(){var a=this;console.log("HIDING MONTH CONTAINER");a.archiveMonthsContainer.hide()},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["readerarchive"],["component","container","panel","overlay","readerarchive"],{component:true,container:true,panel:true,overlay:true,readerarchive:true},["widget.readerarchive"],0,[InfinityMobile.view.tablet,"ReaderArchive"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderArchive",InfinityMobile.view.Overlay,{config:{id:"archivecontainer",width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"archiveToolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{id:"archiveToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"archiveBodyContainer",padding:"20",layout:"vbox",flex:1,style:"font-size:15px",items:[{itemId:"archiveContainerText"},{height:20},{itemId:"archiveMonthContainer",layout:"hbox",items:[{style:"position:absolute; left:5px",html:"<img src='https://media.pagesuite.com/psapps/images/default/LeftArrow_Icon.png' style='width:20px' />"},{style:"position:absolute; right:5px",html:"<img src='https://media.pagesuite.com/psapps/images/default/RightArrow_Icon.png' style='width:20px' />"},{itemId:"archiveMonthsContainer",height:30,flex:1,layout:"hbox",margin:"0 15px 0 15px",padding:"0 0 10px 0",monthdirection:"horizontal",scrollable:{direction:"horizontal",directionLock:true},defaults:{width:90,height:20,margin:"0 20px 0 0",padding:0,style:"font-weight:bold",type:"shortDate"},items:[]}]},{id:"archiveItemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{cls:"archiveitemphone"}}]}]},initialize:function(){var c=this;var a=c.getComponent("archiveToolBar");c.archiveToolBarClose=a.getComponent("archiveToolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});c.title=a.getComponent("title");c.title.setHtml(language.archive.archive);var b=c.getComponent("archiveBodyContainer");c.archiveContainerText=b.getComponent("archiveContainerText");c.archiveContainerText.setHtml(language.archive.archiveContainerText);c.archiveItemsContainer=b.getComponent("archiveItemsContainer");c.archiveMonthContainer=b.getComponent("archiveMonthContainer");c.archiveMonthsContainer=c.archiveMonthContainer.getComponent("archiveMonthsContainer");if(settings.tracking!=null){var d=settings.tracking.trackingType;if(d=="DA"){trackDaPageView("Archive","Digital Edition")}}if(settings.newsday!=null){a.element.dom.style.borderTopLeftRadius="";a.element.dom.style.borderTopRightRadius="";c.setStyle({borderRadius:"0px"});c.element.down("div").dom.style.borderRadius="0px";c.archiveSelector=Ext.create("InfinityMobile.view.phone.ArchiveSelector",{});c.archiveSelector.setStyle({backgroundColor:"transparent"});c.archiveSelector.element.dom.style.color="";c.archiveSelector.setMargin("0 0 10px 0");c.archiveSelector.setPadding(0);c.archiveSelector.element.on("tap",function(){c.archiveSelector.focus()});b.insert(0,c.archiveSelector)}else{c.archiveSelector.hide()}c.setCloseListener();c.fireEvent("initialized",c)},setCloseListener:function(){var b=this;b.archiveToolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.archiveToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)},hideMonthContainer:function(){var a=this;console.log("HIDING MONTH CONTAINER");a.archiveMonthContainer.hide()}},0,["readerarchive"],["component","container","panel","overlay","readerarchive"],{component:true,container:true,panel:true,overlay:true,readerarchive:true},["widget.readerarchive"],0,[InfinityMobile.view.phone,"ReaderArchive"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderSearch",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;",zindex:3,layout:"vbox",searchTerm:"",cls:"searchOverlay",items:[{itemId:"seachToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{id:"searchToolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"searchBar",height:40,padding:5,items:[{id:"searchTerm",xtype:"textfield",height:30,clearIcon:false,style:"color:red; font-size:12px;",width:"100%"},{id:"searchButton",cls:"pointerCursor",html:"<img src='../assets/search/grey-search-ic.png' style='width:20px; height:20px' />",right:10,top:10}]},{itemId:"searchButtonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:60,style:"z-index:1",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"searchCurrentEdition",cls:"pointerCursor btn",width:150,style:"background-color:#458fbb;color:#ffffff",items:[{itemId:"btnText"}]},{width:25},{itemId:"searchAllEditions",cls:"pointerCursor btn",width:150,style:"background-color:#458fbb;color:#ffffff",items:[{itemId:"btnText"}]},{width:25},{itemId:"showSearchDate",cls:"pointerCursor btn",width:150,style:"background-color:#458fbb;color:#ffffff",items:[{itemId:"btn",width:150,height:40,layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"btnText"}]},{itemId:"searchDateContainer",top:45,cls:"searchDate hidden",layout:"vbox",padding:10,items:[{itemId:"startDateText"},{itemId:"startDate",html:"<input type='date' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"endDateText"},{itemId:"endDate",html:"<input type='date' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"searchDate",cls:"pointerCursor btn",width:150,height:40,style:"background-color:#458fbb;color:#ffffff",layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"btnText"}]}]}]}]},{itemId:"searchResults",layout:"vbox",flex:1}]},initialize:function(){var d=this;d.isSearch=true;d.searchTerm=d._searchTerm;d.searchType="e";var c=d.getComponent("seachToolBar");d.searchToolBarClose=c.getComponent("searchToolBarClose");c.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var g=d.getComponent("searchBar");g.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});d.searchTermBox=g.getComponent("searchTerm");d.searchTermButton=g.getComponent("searchButton");d.searchResultsContainer=d.getComponent("searchResults");var e=d.getComponent("searchButtonsContainer");d.searchCurrentEdition=e.getComponent("searchCurrentEdition");d.searchAllEditions=e.getComponent("searchAllEditions");d.showSearchDate=e.getComponent("showSearchDate");d.dateButton=d.showSearchDate.getComponent("btn");d.showSearchDateButton=d.dateButton.getComponent("btnText");d.searchDateContainer=d.showSearchDate.getComponent("searchDateContainer");var b=d.searchDateContainer.getComponent("startDate");d.startDate=b.element.down("input");var f=d.searchDateContainer.getComponent("endDate");d.endDate=f.element.down("input");b.element.on({tap:function(){var h=this;h.startDate.focus()},scope:d});f.element.on({tap:function(){var h=this;h.endDate.focus()},scope:d});d.searchDate=d.searchDateContainer.getComponent("searchDate");d.title=c.getComponent("title");d.title.setHtml(language.search.search);d.searchTermBox.setPlaceHolder(language.search.enterKeyword);d.searchCurrentEdition.getComponent("btnText").setHtml(language.search.currentEdition);d.searchAllEditions.getComponent("btnText").setHtml(language.search.allEditions);d.dateButton.getComponent("btnText").setHtml(language.search.date);d.searchDateContainer.getComponent("startDateText").setHtml(language.search.startDate);d.searchDateContainer.getComponent("endDateText").setHtml(language.search.endDate);d.searchDate.getComponent("btnText").setHtml(language.search.search);d.setInitialSearchTerm();d.setCloseListener();d.setTextListener();d.setButtonListener();d.setSearchButtons();if(!Ext.os.is.Desktop){d.searchTermBox.element.on("tap",function(){if(navigator.userAgent.toLowerCase().indexOf("silk")!=-1){this.down("input").dom.focus()}if(this.dom.focus!=null){this.dom.focus()}})}else{if(navigator.maxTouchPoints){d.searchTermBox.element.on("tap",function(){var h=$(this.dom).find("input");if(h.length>0){$(h[0]).focus()}})}$(d.searchResultsContainer.element.dom).css("overflow-y","scroll");if(Ext.os.is.Desktop){var a="true";if(settings.menu.searchDisableDateTextFields!=null){a=settings.menu.searchDisableDateTextFields}d.on("painted",function(){var k=$(d.showSearchDate.element.dom).find("input");if(k.length==2){k[0].type="text";k[1].type="text";var h="yy-mm-dd";if(typeof isTribReader!="undefined"){if(isTribReader){h="mm-dd-yy";var j=new Date();k[0].value=(j.getMonth()+1)+"-"+j.getDate()+"-"+j.getFullYear();k[1].value=(j.getMonth()+1)+"-"+j.getDate()+"-"+j.getFullYear()}}$(k[0]).datepicker({dateFormat:h,beforeShow:function(l){if(a=="true"){l.disabled=true}},onClose:function(l){if(a=="true"){if(this!=null){this.disabled=false}}}});$(k[1]).datepicker({dateFormat:h,beforeShow:function(l){if(a=="true"){l.disabled=true}},onClose:function(l){if(a=="true"){if(this!=null){this.disabled=false}}}})}})}}if(settings.newsday!=null){c.element.dom.style.borderTopLeftRadius="";c.element.dom.style.borderTopRightRadius="";d.setStyle({borderRadius:"0px"});d.element.down("div").dom.style.borderRadius="0px"}d.search()},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},setInitialSearchTerm:function(){var a=this;a.searchTermBox.setValue(a.searchTerm)},setCloseListener:function(){var b=this;b.searchToolBarClose.element.on("tap",function(){if(currentProfile=="desktop"){window.onkeydown=b.keyDownFunction}b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.searchToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setTextListener:function(){var a=this;a.searchTermBox.on("change",function(){a.search()})},setButtonListener:function(){var a=this},setSearchButtons:function(){var a=this;a.searchCurrentEdition.element.on("tap",function(){a.fireEvent("searchCurrentEdition")});a.searchAllEditions.element.on("tap",function(){a.fireEvent("searchAllEditions")});a.dateButton.element.on("tap",function(){a.fireEvent("showSearchDate")});a.searchDate.element.on("tap",function(b){a.fireEvent("searchDate");b.stopPropagation()});a.searchCurrentEdition.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.searchAllEditions.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.showSearchDate.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.searchDate.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},close:function(){var a=this;a.fireEvent("close",a)},search:function(){var a=this;a.searchTerm=a.searchTermBox.getValue();if(a.searchTerm!=""){a.fireEvent("search")}},hide:function(){var a=this;if(currentProfile=="desktop"){window.onkeydown=a.keyDownFunction}a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)},show:function(){var a=this;if(currentProfile=="desktop"){a.handleKeyDown()}InfinityMobile.view.Overlay.prototype.show.apply(this,arguments)},destroy:function(){}},0,["search"],["component","container","panel","overlay","search"],{component:true,container:true,panel:true,overlay:true,search:true},["widget.search"],0,[InfinityMobile.view.tablet,"ReaderSearch"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderSearch",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px",zindex:3,layout:"vbox",searchTerm:"",items:[{id:"seachToolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{id:"searchToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"searchBar",height:40,padding:5,items:[{id:"searchTerm",xtype:"textfield",height:30,clearIcon:false,style:"color:red; font-size:12px;"},{id:"searchButton",html:"<img src='../assets/search/grey-search-ic.png' style='width:20px; height:20px' />",right:10,top:10}]},{itemId:"searchButtonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:40,style:"z-index:1",defaults:{height:30,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"searchCurrentEdition",cls:"btn",flex:1,style:"font-size:14px",items:[{itemId:"btnText"}]},{width:10},{itemId:"searchAllEditions",cls:"btn",flex:1,style:"font-size:14px",items:[{itemId:"btnText"}]},{width:10},{itemId:"showSearchDate",cls:"btn",flex:1,style:"font-size:14px",items:[{itemId:"btn",width:"100%",height:"100%",layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"btnText"}]},{itemId:"searchDateContainer",top:35,right:0,cls:"searchDate hidden",layout:"vbox",padding:10,items:[{itemId:"startDateText"},{itemId:"startDate",html:"<input type='date' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"endDateText"},{itemId:"endDate",html:"<input type='date' value='"+new Date().toDateInputValue()+"' />"},{height:20},{itemId:"searchDate",cls:"btn",height:30,layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"btnText"}]}]}]}]},{id:"searchResults",layout:"vbox",flex:1,scrollable:{direction:"vertical",directionLock:true}}]},initialize:function(){var c=this;c.isSearch=true;c.searchTerm=c._searchTerm;c.searchType="e";var b=c.getComponent("seachToolBar");c.searchToolBarClose=b.getComponent("searchToolBarClose");b.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var f=c.getComponent("searchBar");f.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});c.searchTermBox=f.getComponent("searchTerm");c.searchTermButton=f.getComponent("searchButton");c.searchResultsContainer=c.getComponent("searchResults");var d=c.getComponent("searchButtonsContainer");c.searchCurrentEdition=d.getComponent("searchCurrentEdition");c.searchAllEditions=d.getComponent("searchAllEditions");c.showSearchDate=d.getComponent("showSearchDate");c.dateButton=c.showSearchDate.getComponent("btn");c.showSearchDateButton=c.dateButton.getComponent("btnText");c.searchDateContainer=c.showSearchDate.getComponent("searchDateContainer");var a=c.searchDateContainer.getComponent("startDate");c.startDate=a.element.down("input");var e=c.searchDateContainer.getComponent("endDate");c.endDate=e.element.down("input");a.element.on({tap:function(){var g=this;g.startDate.focus()},scope:c});e.element.on({tap:function(){var g=this;g.endDate.focus()},scope:c});c.searchDate=c.searchDateContainer.getComponent("searchDate");c.title=b.getComponent("title");c.title.setHtml(language.search.search);c.searchTermBox.setPlaceHolder(language.search.enterKeyword);c.searchCurrentEdition.getComponent("btnText").setHtml(language.search.currentEdition);c.searchAllEditions.getComponent("btnText").setHtml(language.search.allEditions);c.dateButton.getComponent("btnText").setHtml(language.search.date);c.searchDateContainer.getComponent("startDateText").setHtml(language.search.startDate);c.searchDateContainer.getComponent("endDateText").setHtml(language.search.endDate);c.searchDate.getComponent("btnText").setHtml(language.search.search);c.setInitialSearchTerm();c.setCloseListener();c.setTextListener();c.setButtonListener();c.setSearchButtons();if(!Ext.os.is.Desktop){c.searchTermBox.element.on("tap",function(){this.focus()})}c.search()},setInitialSearchTerm:function(){var a=this;a.searchTermBox.setValue(a.searchTerm)},setCloseListener:function(){var b=this;b.searchToolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.searchToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setTextListener:function(){var a=this;a.searchTermBox.on("change",function(){a.search()})},setButtonListener:function(){var a=this},setSearchButtons:function(){var a=this;a.searchCurrentEdition.element.on("tap",function(){a.fireEvent("searchCurrentEdition")});a.searchAllEditions.element.on("tap",function(){a.fireEvent("searchAllEditions")});a.dateButton.element.on("tap",function(){a.fireEvent("showSearchDate")});a.searchDate.element.on("tap",function(b){a.fireEvent("searchDate");b.stopPropagation()});a.searchCurrentEdition.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.searchAllEditions.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.showSearchDate.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.searchDate.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},close:function(){var a=this;a.fireEvent("close",a)},search:function(){var a=this;a.searchTerm=a.searchTermBox.getValue();if(a.searchTerm!=""){a.fireEvent("search")}}},0,["search"],["component","container","panel","overlay","search"],{component:true,container:true,panel:true,overlay:true,search:true},["widget.search"],0,[InfinityMobile.view.phone,"ReaderSearch"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderDownload",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;",zindex:3,layout:"vbox",searchTerm:"",items:[{itemId:"downloadToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"downloadToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"downloadBody",flex:1,padding:25,layout:"vbox",items:[{itemId:"bodyText"},{itemId:"downloadButtonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"downloadSelectAll",cls:"btn",width:150,items:[{itemId:"btnText"}]},{width:25},{itemId:"downloadSelectNone",cls:"btn",width:150,items:[{itemId:"btnText"}]},{width:25},{itemId:"download",cls:"btn",width:150,items:[{itemId:"btnText"}]}]},{itemId:"downloadItems",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:150,height:200,style:"overflow:hidden;",margin:"0 6 10 6"}}]}]},initialize:function(){var c=this;var e=c.getComponent("downloadToolBar");c.downloadToolBarClose=e.getComponent("downloadToolBarClose");e.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var b=c.getComponent("downloadBody");var a=b.getComponent("downloadButtonsContainer");c.downloadSelectAll=a.getComponent("downloadSelectAll");c.downloadSelectNone=a.getComponent("downloadSelectNone");c.download=a.getComponent("download");c.title=e.getComponent("title");c.title.setHtml(language.download.download);c.bodyContent=b.getComponent("bodyText");c.bodyContent.setHtml(language.download.downloadContainerText);c.downloadSelectAll.getComponent("btnText").setHtml(language.download.downloadSelectAll);c.downloadSelectNone.getComponent("btnText").setHtml(language.download.downloadSelectNone);c.download.getComponent("btnText").setHtml(language.download.download);c.downloadSelectAll.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.downloadSelectNone.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.download.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.setCloseListener();c.setDownloadAllListener();c.setDownloadNoneListener();c.setDownloadListener();if(settings.tracking!=null){var d=settings.tracking.trackingType;if(d=="DA"){trackDaPageView("Downloads","Digital Edition")}}c.downloadItemsContainer=b.getComponent("downloadItems");c.loadPages();if(settings.newsday!=null){e.element.dom.style.borderTopLeftRadius="";e.element.dom.style.borderTopRightRadius="";c.setStyle({borderRadius:"0px"});c.element.down("div").dom.style.borderRadius="0px"}},setCloseListener:function(){var b=this;b.downloadToolBarClose.element.on("tap",function(){b.fireEvent("close",b)});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.downloadToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setDownloadAllListener:function(){var a=this;a.downloadSelectAll.element.on("tap",function(){a.fireEvent("selectAll",a)})},setDownloadNoneListener:function(){var a=this;a.downloadSelectNone.element.on("tap",function(){a.fireEvent("selectNone",a)})},setDownloadListener:function(){var a=this;a.download.element.on("tap",function(){a.fireEvent("download",a)})},loadPages:function(){var a=this;a.fireEvent("loadPages",a,a.downloadItemsContainer)},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["download"],["component","container","panel","overlay","download"],{component:true,container:true,panel:true,overlay:true,download:true},["widget.download"],0,[InfinityMobile.view.tablet,"ReaderDownload"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderDownload",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px",zindex:3,layout:"vbox",searchTerm:"",items:[{itemId:"downloadToolBar",height:40,style:"",items:[{itemId:"title",top:10,left:15},{itemId:"downloadToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"downloadBody",flex:1,padding:15,layout:"vbox",items:[{itemId:"bodyText",style:"font-size:15px"},{itemId:"downloadButtonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:70,style:"font-size:15px",defaults:{height:30,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"downloadSelectAll",cls:"btn",flex:1,items:[{itemId:"btnText"}]},{width:10},{itemId:"downloadSelectNone",cls:"btn",flex:1,items:[{itemId:"btnText"}]},{width:10},{itemId:"download",cls:"btn",flex:1,items:[{itemId:"btnText"}]}]},{itemId:"downloadItems",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{cls:"archiveitemphone"}}]}]},initialize:function(){var c=this;var e=c.getComponent("downloadToolBar");c.downloadToolBarClose=e.getComponent("downloadToolBarClose");e.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var b=c.getComponent("downloadBody");var a=b.getComponent("downloadButtonsContainer");c.downloadSelectAll=a.getComponent("downloadSelectAll");c.downloadSelectNone=a.getComponent("downloadSelectNone");c.download=a.getComponent("download");c.title=e.getComponent("title");c.title.setHtml(language.download.download);c.bodyContent=b.getComponent("bodyText");c.bodyContent.setHtml(language.download.downloadContainerText);c.downloadSelectAll.getComponent("btnText").setHtml(language.download.downloadSelectAll);c.downloadSelectNone.getComponent("btnText").setHtml(language.download.downloadSelectNone);c.download.getComponent("btnText").setHtml(language.download.download);c.downloadSelectAll.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.downloadSelectNone.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.download.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.setCloseListener();c.setDownloadAllListener();c.setDownloadNoneListener();c.setDownloadListener();if(settings.tracking!=null){var d=settings.tracking.trackingType;if(d=="DA"){trackDaPageView("Downloads","Digital Edition")}}c.downloadItemsContainer=b.getComponent("downloadItems");c.loadPages()},setCloseListener:function(){var b=this;b.downloadToolBarClose.element.on("tap",function(){b.fireEvent("close",b)});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.downloadToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setDownloadAllListener:function(){var a=this;a.downloadSelectAll.element.on("tap",function(){a.fireEvent("selectAll",a)})},setDownloadNoneListener:function(){var a=this;a.downloadSelectNone.element.on("tap",function(){a.fireEvent("selectNone",a)})},setDownloadListener:function(){var a=this;a.download.element.on("tap",function(){a.fireEvent("download",a)})},loadPages:function(){var a=this;a.fireEvent("loadPages",a,a.downloadItemsContainer)}},0,["download"],["component","container","panel","overlay","download"],{component:true,container:true,panel:true,overlay:true,download:true},["widget.download"],0,[InfinityMobile.view.phone,"ReaderDownload"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderArticlePopover",Ext.Container,{config:{style:"padding:0px; border-radius:0px; background-color:white;",articleguid:"a3d9d9eb-36b5-46b6-94ee-31978e22dc78",fullscreen:true,layout:"vbox",zIndex:9999999,items:[{itemId:"topBar",height:50,layout:"hbox",padding:"10px 20px 0px 20px",style:"background-color:white;",items:[{itemId:"topBarShare",xtype:"readermenushare",layout:"hbox"},{width:10},{itemId:"textControl",html:'<div class="textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:30px;height:30px;margin-right:15px;" src="../assets/article%20view/Text_Increase_Icon.png" ontouchstart="increaseText()" onclick="increaseText()"><img style="cursor:hand;cursor:pointer;width:30px;height:30px;" src="../assets/article%20view/Text_Decrease_Icon.png" ontouchstart="decreaseText()" onclick="decreaseText()"></div>'},{itemId:"ttsControl",baseCls:"ttsToggle",status:"STOPPED"},{itemId:"closeButton",top:0,right:0,padding:"10px 20px 10px 20px",style:"color:#4291b6",layout:{type:"hbox",align:"center"},items:[{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:"Close"},{width:10},{height:26,html:'<img src="../assets/article view/article-close-btn.png" style="width:26px;" />'}]}]},{itemId:"content",flex:1,cls:"innerhtmlfullheight"},{itemId:"bottomNav",cls:"articleFooter",height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",align:"center"},items:[{itemId:"previousArticleButton",width:150,padding:"10 0 0 20",height:"100%",layout:"hbox",items:[{itemId:"prev",html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{html:"Previous Article",padding:"0 0 0 5"}]},{flex:1},{itemId:"articleText",html:"Article X / Y"},{flex:1},{itemId:"nextArticleButton",width:150,padding:"10 20 0 0",height:"100%",layout:{type:"hbox",pack:"end"},items:[{html:"Next Article",padding:"0 5 0 0"},{itemId:"next",html:"<img style='height:20px' src='../assets/article view/right-article-arrow.png' />"}]}]}]},initialize:function(){var b=this;b.highlightMode=false;b.content=b.getComponent("content");var d=b.getComponent("topBar");b.topBarShare=d.getComponent("topBarShare");b.closeButton=d.getComponent("closeButton");b.closeTxt=b.closeButton.getComponent("closeTxt");b.closeTxt.setHtml(language.close);b.setCloseButtonListener();b.ttsToggle=d.getComponent("ttsControl");if(window.SpeechSynthesisUtterance===undefined||settings.tts===undefined){b.ttsToggle.hide()}var c=b.getComponent("bottomNav");b.previousArticleButton=c.getComponent("previousArticleButton");b.nextArticleButton=c.getComponent("nextArticleButton");b.articleText=c.getComponent("articleText");b.topBarTextControls=d.getComponent("textControl");b.setNextButtonListener();b.setPreviousButtonListener();b.setTtsToggleListener();b.on({hide:function(){if(settings.tts!=null&&window.SpeechSynthesisUtterance!=undefined){b.fireEvent("hidden",b.ttsToggle)}},painted:function(){if(settings.tts!=null&&window.SpeechSynthesisUtterance!=undefined){b.fireEvent("opened")}}});if(b.articleReader!=null){b.fireEvent("initializeArticlePopover",b);b.ttsToggle.hide()}else{if(b.config.isLive==null){b.fireEvent("initialized",b)}else{if(b.config.articles==null){b.fireEvent("initializeLivePopover",b);b.ttsToggle.hide()}else{b.fireEvent("initializeLivePopover",b,b.config.articles)}}}b.orientation=b.returnOrientation();if(settings.reader.hideArticleControls!=null){if(settings.reader.hideArticleControls.toLowerCase()=="true"){b.topBarShare.hide();b.topBarTextControls.hide();c.hide()}}if(settings.newsday!=null){b.addCls("popUp");if(settings.newsday.useFontAwesome=="true"){b.prevIcon=b.previousArticleButton.getComponent("prev");if(b.prevIcon!=null){b.prevIcon.setHtml('<i class="fa fa-angle-left fa-lg" style="position:relative;top:-1px;margin:2px;" aria-hidden="true"></i>')}b.nextIcon=b.nextArticleButton.getComponent("next");if(b.nextIcon!=null){b.nextIcon.setHtml('<i class="fa fa-angle-right fa-lg" style="position:relative;top:-1px;margin:2px;" aria-hidden="true"></i>')}}if(settings.newsday.useNewsdayPopover!=null){if(settings.newsday.useNewsdayPopover=="true"){var a=b.hexToRgb(settings.topbar.backgroundColor);if(settings.topbar.backgroundColor!=null){d.setStyle({backgroundColor:"rgba("+a.r+","+a.g+","+a.b+",0.9)"})}b.closeButton.removeAll();var e=Ext.create("Ext.Container",{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:'<img src="resources/images/article-close-btn-white.png" style="width:26px;" />'});b.closeButton.add(e);b.closeButton.setPadding("10px 7px 10px 7px");if(settings.topbar.color!=null){b.closeButton.setStyle({color:"#"+settings.topbar.color})}b.closeButton.setPadding("12px 16px");d.insert(0,b.closeButton);d.setPadding("5px 0px 0px 0px")}}if(settings.newsday.hideShareIcons!=null){if(settings.newsday.hideShareIcons=="true"){b.topBarShare.removeAll();b.topBarTextControls.hide()}}}},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},setArticleWidth:function(){var b=this;var a=Math.min(screen.width,screen.height);b.setWidth(a)},setTtsToggleListener:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined){a.ttsToggle.element.on({tap:function(){switch(a.ttsToggle.status){case"STOPPED":case"FINISHED":a.fireEvent("playArticleTTS",a.ttsToggle,"na");break;case"PAUSED":a.fireEvent("resumeArticleTTS",a.ttsToggle,"na");break;case"PLAYING":a.fireEvent("pauseArticleTTS",a.ttsToggle,"na");break;default:a.fireEvent("stopArticleTTS",a.ttsToggle,"na")}}})}},setCloseButtonListener:function(){var a=this;a.closeButton.element.on({tap:"tap",scope:this})},setPreviousButtonListener:function(){var a=this;a.previousArticleButton.element.on("tap",function(){a.fireEvent("previous")})},setNextButtonListener:function(){var a=this;a.nextArticleButton.element.on("tap",function(){a.fireEvent("next")})},tap:function(){var a=this;if(a.returnOrientation!=a.orientation){a.fireEvent("closeAndReset",a,a.returnOrientation())}else{a.fireEvent("close",a)}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a}},0,["articleview"],["component","container","articleview"],{component:true,container:true,articleview:true},["widget.articleview"],0,[InfinityMobile.view.tablet,"ReaderArticlePopover"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderArticlePopover",Ext.Container,{config:{fullscreen:true,style:"padding:0px; border-radius:0px; background-color:white;",layout:"vbox",articleguid:"a3d9d9eb-36b5-46b6-94ee-31978e22dc78",items:[{itemId:"topBar",height:48,layout:"hbox",padding:"8px 0 0 0",style:"background-color:white;",items:[{width:10},{itemId:"topBarShare",html:'<div class="textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:28px;height:28px;" src="../assets/article%20view/share-ic-blk.png"></div>'},{width:10},{itemId:"textControl",html:'<div class="textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text_Increase_Icon.png" ontouchstart="increaseText()" onclick="increaseText()">&nbsp;&nbsp;<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text_Decrease_Icon.png" ontouchstart="decreaseText()" onclick="decreaseText()"></div>'},{itemId:"ttsControl",baseCls:"ttsToggle",status:"STOPPED"},{itemId:"inappTranslate",baseCls:"inappTranslate",cls:"spain"},{itemId:"closeButton",top:0,right:0,padding:"10px 20px 10px 20px",style:"color:#4291b6",layout:{type:"hbox",align:"center"},items:[{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:"Close"},{width:10},{height:26,html:'<img src="../assets/article view/article-close-btn.png" style="width:26px;" />'}]}]},{itemId:"content",flex:1,cls:"innerhtmlfullheight"},{itemId:"bottomNav",cls:"articleFooter",height:40,style:"background-color:#dfe0df; color: #4591B8; font-size:15px",layout:{type:"hbox",align:"center"},items:[{itemId:"previousArticleButton",flex:1,padding:"0 0 0 5",height:"100%",layout:{type:"hbox",align:"center"},items:[{itemId:"prev",height:20,html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{html:"Previous",padding:"0 0 0 5"}]},{width:10},{itemId:"articleText",padding:"0 0 0 0",html:"Article X / Y"},{width:10},{itemId:"nextArticleButton",flex:1,padding:"0 5 0 0",height:"100%",layout:{type:"hbox",pack:"end",align:"center"},items:[{html:"Next",padding:"0 5 0 0"},{itemId:"next",height:20,html:"<img style='height:20px;' src='../assets/article view/right-article-arrow.png' />"}]}]}]},initialize:function(){var b=this;Ext.Container.prototype.initialize.apply(this,arguments);b.highlightMode=false;b.content=b.getComponent("content");console.log(b.mediaController);var d=b.getComponent("topBar");b.topBarShare=d.getComponent("topBarShare");b.topBarFrame=b.topBarShare.element.down("iframe");b.topBarTextControls=d.getComponent("textControl");b.closeButton=d.getComponent("closeButton");b.closeTxt=b.closeButton.getComponent("closeTxt");b.closeTxt.setHtml(language.close);b.setCloseButtonListener();b.ttsToggle=d.getComponent("ttsControl");if(window.SpeechSynthesisUtterance===undefined||settings.tts===undefined){b.ttsToggle.hide()}b.inappTrans=b.getComponent("topBar").getComponent("inappTranslate");b.inappTrans.hide();var c=b.getComponent("bottomNav");b.previousArticleButton=c.getComponent("previousArticleButton");b.nextArticleButton=c.getComponent("nextArticleButton");b.articleText=c.getComponent("articleText");b.setNextButtonListener();b.setPreviousButtonListener();b.topBarShare.element.on({tap:b.share,scope:b});b.setTtsToggleListener();b.on({hide:function(){if(settings.tts!=null&&window.SpeechSynthesisUtterance!=undefined){b.fireEvent("hidden",b.ttsToggle)}},painted:function(){if(settings.tts!=null&&window.SpeechSynthesisUtterance!=undefined){b.fireEvent("opened")}}});if(b.articleReader!=null){b.fireEvent("initializeArticlePopover",b);b.ttsToggle.hide()}else{if(b.config.isLive==null){b.fireEvent("initialized",b)}else{if(b.config.articles==null){b.fireEvent("initializeLivePopover",b);b.ttsToggle.hide()}else{b.fireEvent("initializeLivePopover",b,b.config.articles)}}}b.orientation=b.returnOrientation();if(settings.reader.hideArticleControls!=null){if(settings.reader.hideArticleControls.toLowerCase()=="true"){b.topBarShare.hide();b.topBarTextControls.hide();c.hide()}}if(settings.newsday!=null){b.addCls("popUp");if(settings.newsday.useFontAwesome=="true"){b.prevIcon=b.previousArticleButton.getComponent("prev");if(b.prevIcon!=null){b.prevIcon.setHtml('<i class="fa fa-angle-left fa-lg" style="position:relative;top:-1px;margin:2px;" aria-hidden="true"></i>')}b.nextIcon=b.nextArticleButton.getComponent("next");if(b.nextIcon!=null){b.nextIcon.setHtml('<i class="fa fa-angle-right fa-lg" style="position:relative;top:-1px;margin:2px;" aria-hidden="true"></i>')}}if(settings.newsday.useNewsdayPopover!=null){if(settings.newsday.useNewsdayPopover=="true"){var a=b.hexToRgb(settings.topbar.backgroundColor);if(settings.topbar.backgroundColor!=null){d.setStyle({backgroundColor:"rgba("+a.r+","+a.g+","+a.b+",0.9)"})}b.closeButton.removeAll();var e=Ext.create("Ext.Container",{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:'<img src="resources/images/article-close-btn-white.png" style="width:26px;" />'});b.closeButton.add(e);b.closeButton.setPadding("5px 7px 10px 7px");if(settings.topbar.color!=null){b.closeButton.setStyle({color:"#"+settings.topbar.color})}b.closeButton.setPadding("12px 10px");d.insert(0,b.closeButton)}}if(settings.newsday.hideShareIcons!=null){if(settings.newsday.hideShareIcons=="true"){b.topBarShare.hide();b.topBarTextControls.hide()}}}},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},setArticleWidth:function(){var b=this;var a=Math.min(screen.width,screen.height);b.setWidth(a)},setCloseButtonListener:function(){var a=this;a.closeButton.element.on({tap:"tap",scope:this})},onBeforeUnload:function(){alert("back button")},setPreviousButtonListener:function(){var a=this;a.previousArticleButton.element.on("tap",function(){a.fireEvent("previous")})},setNextButtonListener:function(){var a=this;a.nextArticleButton.element.on("tap",function(){a.fireEvent("next")})},setAppTranslateListener:function(){var a=this;a.inappTrans.element.on({tap:function(){a.fireEvent("translate",a.inappTrans)}})},tap:function(){var a=this;if(a.returnOrientation!=a.orientation){a.fireEvent("closeAndReset",a,a.returnOrientation())}else{a.fireEvent("close",a)}},setShareListener:function(){},share:function(){var a=this;a.fireEvent("sharepopup",a)},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},setTtsToggleListener:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined){a.ttsToggle.element.on({tap:function(){switch(a.ttsToggle.status){case"STOPPED":case"FINISHED":a.fireEvent("playArticleTTS",a.ttsToggle,"na");break;case"PAUSED":a.fireEvent("resumeArticleTTS",a.ttsToggle,"na");break;case"PLAYING":a.fireEvent("pauseArticleTTS",a.ttsToggle,"na");break;default:a.fireEvent("stopArticleTTS",a.ttsToggle,"na")}}})}}},0,["articleview"],["component","container","articleview"],{component:true,container:true,articleview:true},["widget.articleview"],0,[InfinityMobile.view.phone,"ReaderArticlePopover"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderWhatsNew",InfinityMobile.view.Overlay,{config:{width:700,height:700,style:"padding:0px;",layout:"vbox",items:[{itemId:"toolbar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>What's New</b>"},{itemId:"toolbarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",flex:1,margin:20,layout:"vbox",scrollable:{direction:"vertical",directionLock:true},items:[{html:"<iframe src='whatsnew.html' style='width:100%; border:none; pointer-events: none;' onload='javascript:resizeIframe(this);' />"}]}]},initialize:function(){var e=this;var d=e.getComponent("toolbar");e.toolbarClose=d.getComponent("toolbarClose");e.bodyContainer=e.getComponent("bodyContainer");try{localStorage.setItem("versionwhatsnew"+version.replace(/g./g,"_"),"read")}catch(b){}var c=document.getElementsByClassName("bannerIcon");for(var a=0;a<c.length;a++){c[a].style.display="none"}e.setCloseListener();e.fireEvent("initialized",e)},setCloseListener:function(){var a=this;a.toolbarClose.element.on("tap",function(){a.hide()})}},0,["whatsnew"],["component","container","panel","overlay","whatsnew"],{component:true,container:true,panel:true,overlay:true,whatsnew:true},["widget.whatsnew"],0,[InfinityMobile.view.tablet,"ReaderWhatsNew"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderWhatsNew",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{itemId:"toolbar",height:40,style:";border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>What's New</b>"},{itemId:"toolbarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",flex:1,margin:20,layout:"vbox",scrollable:{direction:"vertical",directionLock:true},items:[{html:"<iframe src='whatsnew.html' style='width:100%; border:none; pointer-events: none;' onload='javascript:resizeIframe(this);' />"}]}]},initialize:function(){var e=this;var d=e.getComponent("toolbar");e.toolbarClose=d.getComponent("toolbarClose");d.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});e.bodyContainer=e.getComponent("bodyContainer");try{localStorage.setItem("versionwhatsnew"+version.replace(/g./g,"_"),"read")}catch(b){}var c=document.getElementsByClassName("bannerIcon");for(var a=0;a<c.length;a++){console.log("FOUND BANNER ICON");c[a].style.display="none"}e.setCloseListener();e.fireEvent("initialized",e)},setCloseListener:function(){var a=this;a.toolbarClose.element.on("tap",function(){a.hide()})}},0,["whatsnew"],["component","container","panel","overlay","whatsnew"],{component:true,container:true,panel:true,overlay:true,whatsnew:true},["widget.whatsnew"],0,[InfinityMobile.view.phone,"ReaderWhatsNew"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.Interstitial",Ext.Container,{config:{fullscreen:true,modal:true,hideOnMaskTap:true,centered:true,layout:"vbox",cls:"innerhtmlfullheight",style:"padding:0px",items:[{itemId:"advertContainer",items:[{itemId:"advertisementText",height:30,width:"100%",html:"ADVERTISEMENT",style:"color:white;text-align:center;"},{itemId:"advert",cls:"advert",layout:"fit"}]}]},initialize:function(){var f=this;f.advertContainer=f.getComponent("advertContainer").getComponent("advert");f.advertText=f.getComponent("advertContainer").getComponent("advertisementText");if(currentProfile=="desktop"){f.setUpDesktopCloseBtn()}else{f.setUpTabletCloseBtn()}f.handleKeyDown();f.setUpCloseListener();var e=settings.reader.interstitial;switch(e.type.toLowerCase()){case"dfp":f.setupDfpAdverts(e);break;case"url":if(Ext.os.is.Desktop){var c=settings.reader.interstitial.landscapeUrl;f.advertContainer.setHtml("<iframe width='768' height='576' style='border:none;' scrolling='no' src='"+c+"' />")}else{f.advertContainer.setHtml("<iframe class='interstitialportrait' width='576' height='768' style='border:none;' scrolling='no' src='"+settings.reader.interstitial.portraitUrl+"'> </iframe><iframe class='interstitiallandscape' width='768' height='576' style='border:none;' scrolling='no' src='"+settings.reader.interstitial.landscapeUrl+"' />")}break;case"image":f.advertDivID=f.id+"advert";if(Ext.os.is.Desktop){f.removeCls("interstitialoverlaytablet");f.setCls("x-container x-panel x-sized interstitialoverlaydesktop innerhtmlfullheight x-floating x-fullscreen");f.setWidth(768);f.setHeight(576);var a=576;var d=768;f.advertContainer.setHeight("100%");f.advertContainer.setWidth("100%");f.advertContainer.setHtml("<div id='"+f.advertDivID+"' style='height:"+a+"px;width:"+d+"px;background-image:url("+e.url+");background-repeat:no-repeat;background-size:contain;background-position:center;'></div>");if(e.link!=null){if(e.link.length>0){f.advertContainer.addCls("pointerCursor");f.advertContainer.element.on({tap:function(){window.open(e.link,"_blank")}})}}}else{if(f.returnOrientation()=="portrait"){f.setHeight(768);f.setWidth(576);var a=768;var d=576}else{f.setWidth(768);f.setHeight(576);var a=576;var d=768}f.advertContainer.setHeight("100%");f.advertContainer.setWidth("100%");if(e.portraitUrl!=null){var b=e.portraitUrl}else{var b=e.url}f.advertContainer.setHtml("<div class='interstitialportrait' id='"+f.advertDivID+"' style='height:"+Math.max(d,a)+"px;width:"+Math.min(d,a)+"px;background-image:url("+b+");background-repeat:no-repeat;background-size:contain;background-position:center;'></div><div class='interstitiallandscape' id='"+f.advertDivID+"' style='height:"+Math.min(d,a)+"px;width:"+Math.max(d,a)+"px;background-image:url("+e.url+");background-repeat:no-repeat;background-size:contain;background-position:center;'></div>");if(e.link!=null){if(e.link.length>0){f.advertContainer.addCls("pointerCursor");f.advertContainer.element.on({tap:function(){window.open(e.link,"_blank")}})}}}break}},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;if(settings.reader.interstitial.dfpType!="fullscreen"){window.onkeydown=null}},setUpCloseListener:function(){var a=this;if(!(settings.reader.interstitial.type=="dfp"&&settings.reader.interstitial.dfpType=="fullscreen")){a.closeBtn.element.on({tap:"closetap",scope:a})}},setUpTabletCloseBtn:function(){var a=this;a.addCls("interstitialoverlaytablet");a.closeBtn=Ext.create("Ext.Container",{id:"closebtn",top:0,right:-30,width:100,height:100,padding:"10 10 50 50",items:[{html:'<img src="../assets/interstitial/interstitial-close-btn.png" style="width:40px;height:40px" />'}],cls:"backgroundImage"});a.add(a.closeBtn)},setUpDesktopCloseBtn:function(){var a=this;if(!(settings.reader.interstitial.type=="dfp"&&settings.reader.interstitial.dfpType=="fullscreen")){if($(document).height()>=642){a.closeBtn=Ext.create("Ext.Container",{top:0,right:0,layout:"hbox",items:[{html:"Close",style:"color:white;font-size:14px;padding-top:2px;padding-right:2px;"},{html:'<img src="resources/images/reader icons/close-white.png" style="width:16px;height:14px" />'}]})}else{a.closeBtn=Ext.create("Ext.Container",{id:"closebtn",top:-10,right:-10,width:100,height:100,padding:"10 10 50 50",items:[{html:'<img src="../assets/interstitial/interstitial-close-btn.png" style="width:40px;height:40px" />'}],cls:"backgroundImage"})}a.add(a.closeBtn)}else{a.advertText.hide()}},setupDfpAdverts:function(a){var b=this;b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";var c="height:100%;";if(settings.reader.interstitial.dfpType=="fullscreen"){c="position:absolute;top:0;left:0;";b.setModal(false)}b.advertContainer.setHtml("<div id='"+b.advertDivID+"' style='"+c+"'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.on("painted",b.loadAdvert,b,{delay:10,single:true})},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},onResizeFn:function(b){var g=this;if(g.advertDiv!=null){if(g.advertDiv.down("iframe")!=null){var d=g.advertDiv.down("iframe").dom;var c=d.contentDocument||d.contentWindow.document;d.onload=function(){var h=document.createElement("script");h.innerHTML='document.addEventListener("touchmove", function (e) { e.preventDefault(); });';c.body.appendChild(h);g.advertDiv.dom.addEventListener("touchmove",function(j){j.preventDefault()})};if(g.advertDiv.dom.style.webkitTransformOrigin==""){g.advertDiv.dom.style.webkitTransformOrigin="0px 0px";g.advertDiv.dom.style.webkitTransform="scale3d(0.75, 0.75, 1)"}}}var f=settings.reader.interstitial;if(f.type.toLowerCase()=="image"){if(g.returnOrientation()=="portrait"){g.setHeight(768);g.setWidth(576);var a=768;var e=576}else{g.setWidth(768);g.setHeight(576);var a=576;var e=768}}g.remove(g.closeBtn);if(Ext.os.is.Tablet){g.closeBtn=Ext.create("Ext.Container",{id:"closebtn",top:-30,right:-30,width:100,height:100,padding:"10 10 50 50",items:[{html:'<img src="../assets/interstitial/interstitial-close-btn.png" style="width:40px;height:40px" />'}],cls:"backgroundImage"})}else{if($(document).height()>=642){g.closeBtn=Ext.create("Ext.Container",{top:-30,right:0,layout:"hbox",items:[{html:"Close",style:"color:white;font-size:14px;padding-top:2px;padding-right:2px;"},{html:'<img src="resources/images/reader icons/close-white.png" style="width:16px;height:14px" />'}]})}else{g.closeBtn=Ext.create("Ext.Container",{id:"closebtn",top:-10,right:-10,width:100,height:100,padding:"10 10 50 50",items:[{html:'<img src="../assets/interstitial/interstitial-close-btn.png" style="width:40px;height:40px" />'}],cls:"backgroundImage"})}}g.add(g.closeBtn);g.closeBtn.element.on({tap:"closetap",scope:g})},loadAdvert:function(){var a=this;if(settings.reader.interstitial.dfpType=="fullscreen"){googletag.cmd.push(function(){googletag.cmd.push(function(){var b=googletag.defineOutOfPageSlot("/"+a.networkCode+"/"+a.adUnit,a.advertDivID);b.addService(googletag.pubads().updateCorrelator());a.setInterstitialTargeting(settings.reader.interstitial.targeting);googletag.pubads().collapseEmptyDivs();googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})})}else{googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("768"),parseInt("1024")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)});a.iframe=$(a.element.dom).find("iframe")[0];if(a.iframe!=null){a.iframe.onload=function(){a.thisFrameContent=a.iframe.contentDocument||a.iframe.contentWindow.document;a.getIframeDimensions(a.iframe,a.thisFrameContent)};Ext.Viewport.on({resize:a.resizeUrlAdvert,scope:a})}}},setInterstitialTargeting:function(a){var g=this;if(a!=null&&a!=""){var h=a.split("|");for(var c in h){var e=h[c];var j=e.split("*");if(j.length==2){var m=j[0];var l=j[1];if(l.indexOf("{{VAR=")>=0){var d=l.replace("{{VAR=","").replace("}}","");var n=d.split(".");var b=window;for(var k in n){var f=n[k];if(b[f]!=null){l=b[f];b=l}else{console.log("Error: "+j[1]+" does not exist");l="";break}}}if(m!=null&&m!=""&&l!=null&&l!=""){googletag.pubads().setTargeting(m,l)}}}}},resizeUrlAdvert:function(){var a=this;a.getIframeDimensions(a.iframe,a.thisFrameContent)},getIframeDimensions:function(e,c){var f=this;var d=$(c).width();var a=$(c).height()+30;var g=1;if(a>$(window).height()-20){var h=a;a=$(window).height()-20;g=a/h}if(d*g>$(window).width()-40){var b=d;d=$(window).width()-40;g=d/b}f.setIframeDimensions(e,g)},setIframeDimensions:function(a,c){var b=this;if(Ext.browser.is.Chrome){b.element.dom.style.webkitTransformOrigin="50% "+((30*c))+"px 0px";b.element.dom.style.mozTransformOrigin="50% "+((30*c))+"0px 0px";b.element.dom.style.msTransformOrigin="50% "+((30*c))+"px 0px";b.element.dom.style.transformOrigin="50% "+((30*c))+"px 0px"}b.element.dom.style.webkitTransform="scale3d("+c+", "+c+", 1)";b.element.dom.style.mozTransform="scale3d("+c+", "+c+", 1)";b.element.dom.style.msTransform="scale3d("+c+", "+c+", 1)";b.element.dom.style.transform="scale3d("+c+", "+c+", 1)"},closetap:function(){var a=this;if(Ext.os.is.Desktop){window.onkeydown=a.keyDownFunction}a.fireEvent("closeInterstitial",a);a.hide()},hide:function(){var a=this;if(Ext.os.is.Desktop){window.onkeydown=a.keyDownFunction}Ext.Container.prototype.hide.apply(this,arguments);Ext.Viewport.remove(a,true)}},0,["interstitial"],["component","container","interstitial"],{component:true,container:true,interstitial:true},["widget.interstitial"],0,[InfinityMobile.view.tablet,"Interstitial"],0));(Ext.cmd.derive("InfinityMobile.view.phone.Interstitial",InfinityMobile.view.Overlay,{config:{fullscreen:true,cls:"interstitialoverlayphone",layout:"fit",style:"padding:0px;max-height:100%",items:[{itemId:"advertLand",cls:"advert",layout:"fit"}]},initialize:function(){var e=this;e.advertContainer=e.getComponent("advertLand");e.advertContainerPortrait=e.getComponent("advertPortrait");var f=Ext.create("Ext.Container",{id:"closebtn",top:0,right:0,width:100,height:100,padding:"10 10 50 50",items:[{html:'<img src="../assets/interstitial/interstitial-close-btn.png" style="width:40px;height:40px" />'}],cls:"backgroundImage"});e.add(f);var d=settings.reader.interstitial;if(d.type.toLowerCase()=="url"){e.advertContainer.setHtml("<iframe class='interstitialportrait' width='320' height='480' style='border:none;' scrolling='no' src='"+settings.reader.interstitial.portraitUrl+"'> </iframe><iframe class='interstitiallandscape' width='480' height='320' style='border:none;' scrolling='no' src='"+settings.reader.interstitial.landscapeUrl+"' />")}else{if(d.type.toLowerCase()=="image"){e.advertDivID=e.id+"advert";if(e.returnOrientation()=="portrait"){e.setHeight(480);e.setWidth(320);var a=480;var c=320}else{e.setWidth(480);e.setHeight(320);var a=320;var c=480}e.advertContainer.setHeight("100%");e.advertContainer.setWidth("100%");if(d.portraitUrl!=null){var b=d.portraitUrl}else{var b=d.url}e.advertContainer.setHtml("<div class='interstitialportrait' id='"+e.advertDivID+"' style='height:"+Math.max(c,a)+"px;width:"+Math.min(c,a)+"px;background-image:url("+b+");background-repeat:no-repeat;background-size:contain;background-position:center;'></div><div class='interstitiallandscape' id='"+e.advertDivID+"' style='height:"+Math.min(c,a)+"px;width:"+Math.max(c,a)+"px;background-image:url("+d.url+");background-repeat:no-repeat;background-size:cover;background-position:center;'></div>");if(d.link!=null){if(d.link.length>0){e.advertContainer.addCls("pointerCursor");e.advertContainer.element.on({tap:function(){window.open(d.link,"_blank")}})}}f.element.on({tap:"closetap",scope:e})}else{e.networkCode=d.networkCode;e.adUnit=d.adUnit;e.advertDivID=e.id+"advert";e.advertContainer.setHtml("<div id='"+e.advertDivID+"' style='height:100%;'></div>");e.advertDiv=e.element.down("#"+e.advertDivID);f.element.on({tap:"closetap",scope:e});e.on("painted",e.loadAdvert,e,{delay:10,single:true})}}Ext.Viewport.on("orientationchange",e.onResizeFn,e)},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},onResizeFn:function(b){var g=this;if(g.advertDiv!=null){if(g.advertDiv.down("iframe")!=null){var d=g.advertDiv.down("iframe").dom;var c=d.contentDocument||d.contentWindow.document;d.onload=function(){var h=document.createElement("script");h.innerHTML='document.addEventListener("touchmove", function (e) { e.preventDefault(); });';c.body.appendChild(h);g.advertDiv.dom.addEventListener("touchmove",function(j){j.preventDefault()})}}}var f=settings.reader.interstitial;if(f.type.toLowerCase()=="image"){if(g.returnOrientation()=="portrait"){g.setHeight(480);g.setWidth(320);var a=480;var e=320}else{g.setWidth(480);g.setHeight(320);var a=320;var e=480}}},loadAdvert:function(){var a=this;googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("320"),parseInt("480")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})},closetap:function(){var a=this;a.fireEvent("closeInterstitial",a);a.hide()},hide:function(){var a=this;InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments);Ext.Viewport.remove(a,true)}},0,["interstitial"],["component","container","panel","overlay","interstitial"],{component:true,container:true,panel:true,overlay:true,interstitial:true},["widget.interstitial"],0,[InfinityMobile.view.phone,"Interstitial"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticlePopoverAd",Ext.Panel,{config:{style:"padding:0px",items:[{itemId:"advert",cls:"advert"}]},initialize:function(){var b=this;b.advertContainer=b.getComponent("advert");var a=settings.reader.interstitial;b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";b.advertContainer.setHtml("<div id='"+b.advertDivID+"' style='width:320px;height:70px;margin:auto;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.on("painted",b.loadAdvert,b,{delay:10,single:true});b.on("resize",b.onResizeFn,b)},loadAdvert:function(){var a=this;console.log("Loading Ad 320x50");googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("320"),parseInt("50")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})},onResizeFn:function(a){var d=this;if(d.advertDiv!=null){if(d.advertDiv.down("iframe")!=null){var c=d.advertDiv.down("iframe").dom;var b=c.contentDocument||c.contentWindow.document;var e=document.createElement("script");e.innerHTML='setTimeout(function(){ document.addEventListener("touchmove", function (e) { e.preventDefault(); }); }, 500)';b.addEventListener("touchmove",function(f){f.preventDefault()});b.body.appendChild(e);d.advertDiv.dom.addEventListener("touchmove",function(f){f.preventDefault()})}}}},0,["articlePopoverAd"],["component","container","panel","articlePopoverAd"],{component:true,container:true,panel:true,articlePopoverAd:true},["widget.articlePopoverAd"],0,[InfinityMobile.view.phone,"ArticlePopoverAd"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ArticlePopoverInterstitial",Ext.Panel,{config:{style:"padding:0px",items:[{itemId:"advert",cls:"advert"}]},initialize:function(){var b=this;b.destroyed=false;b.advertTimeout=1000;b.loaded=false;b.advertContainer=b.getComponent("advert");var a=settings.newsday.articlePopoverInterstitial;if(a!=null){b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";b.advertContainer.setHtml("<div id='"+b.advertDivID+"' class='interstitialAdvertTablet' style='text-align:center;width:100%;height:100%;margin-left:0;margin-right:0;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.advertDiv.dom.style.visibility="hidden";b.on("painted",b.loadAdvert,b,{delay:10,single:true});b.on("resize",b.onResizeFn,b)}},frameTouchStart:function(b){var a=this;a.articleCarousel=a.returnArticleCarousel();a.articleCarousel.frameDragStart(b)},frameTouchMove:function(b){var a=this;a.articleCarousel.frameDrag(b)},frameTouchEnd:function(b){var a=this;a.articleCarousel.frameDragEnd(b)},returnArticleCarousel:function(){var a=this;return a.parent},loadAdvert:function(){var a=this;if(!a.loaded){setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("768"),parseInt("1024")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)});a.setTouchEvents();a.onResizeFn(a);a.advertDiv.dom.style.visibility=""}},a.advertTimeout)}a.loaded=true},setTouchEvents:function(){var b=this;if(b.advertDiv.down("iframe")!=null){var a=b.advertDiv.down("iframe").dom;a.onload=function(){var c=a.contentDocument||a.contentWindow.document;c.addEventListener("touchstart",function(d){b.frameTouchStart(d)});c.addEventListener("touchmove",function(d){b.frameTouchMove(d);d.preventDefault()});c.addEventListener("touchend",function(d){b.frameTouchEnd(d)})}}},onResizeFn:function(){var b=this;if(b.advertDiv.down("iframe")!=null){var a=b.advertDiv.down("iframe").dom;b.fireEvent("scaleInterstitial",a,b.advertDiv.dom,b)}},destroy:function(){var a=this;a.destroyed=true;Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["articlePopoverInterstitial"],["component","container","panel","articlePopoverInterstitial"],{component:true,container:true,panel:true,articlePopoverInterstitial:true},["widget.articlePopoverInterstitial"],0,[InfinityMobile.view.tablet,"ArticlePopoverInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ArticlePopoverInterstitial",Ext.Panel,{config:{style:"padding:0px",items:[{itemId:"advert",cls:"advert"}]},initialize:function(){var b=this;b.destroyed=false;b.advertTimeout=1000;b.loaded=false;b.advertContainer=b.getComponent("advert");var a=settings.newsday.articlePopoverInterstitial;if(a!=null){b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";b.advertContainer.setHtml("<div id='"+b.advertDivID+"' class='interstitialAdvertPhone' style='text-align:center;width:100%;height:100%;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.advertDiv.dom.style.visibility="hidden";b.on("painted",b.loadAdvert,b,{delay:10,single:true});b.on("resize",b.onResizeFn,b)}},loadAdvert:function(){var a=this;if(!a.loaded){setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("320"),parseInt("480")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)});a.onResizeFn(a);a.advertDiv.dom.style.visibility=""}},a.advertTimeout)}a.loaded=true},onResizeFn:function(a){var c=this;if(c.advertDiv.down("iframe")!=null){var b=c.advertDiv.down("iframe").dom;b.onload=function(){var d=b.contentDocument||b.contentWindow.document;d.addEventListener("touchstart",function(f){c.frameTouchStart(f)});d.addEventListener("touchmove",function(f){c.frameTouchMove(f);f.preventDefault()});d.addEventListener("touchend",function(f){c.frameTouchEnd(f)})};c.fireEvent("scaleInterstitial",b,c.advertDiv.dom,c)}},frameTouchStart:function(b){var a=this;a.articleCarousel=a.returnArticleCarousel();a.articleCarousel.frameDragStart(b)},frameTouchMove:function(b){var a=this;a.articleCarousel.frameDrag(b)},frameTouchEnd:function(b){var a=this;a.articleCarousel.frameDragEnd(b)},returnArticleCarousel:function(){var a=this;return a.parent},destroy:function(){var a=this;a.destroyed=true;Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["articlePopoverInterstitial"],["component","container","panel","articlePopoverInterstitial"],{component:true,container:true,panel:true,articlePopoverInterstitial:true},["widget.articlePopoverInterstitial"],0,[InfinityMobile.view.phone,"ArticlePopoverInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderSharePopup",Ext.Container,{config:{fullscreen:true,modal:true,centered:true,height:"100%;",width:"100%;",style:"background-color:white;width:100%;height:100%;",layout:"vbox",items:[{itemId:"titleBar",style:"",html:"<div style='width:100%;padding:5px;'>Share</div>",items:[{itemId:"ToolBarClose",top:5,right:5,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"sharebtns",width:"100%",flex:1}]},initialize:function(){var b=this;var a=b.getComponent("titleBar");b.toolbarClose=a.getComponent("ToolBarClose");b.setCloseButtonListener();a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});if(b.config.url!=null){b.url=b.config.url}if(b.config.icon!=null){b.icon=b.config.icon}if(b.config.articleguid!=null){b.articleguid=b.config.articleguid}b.shareBtnsContainer=b.getComponent("sharebtns");b.loadShareButtons()},setCloseButtonListener:function(){var b=this;b.toolbarClose.element.on("tap",function(){b.destroy()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolbarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},loadShareButtons:function(){var a=this;a.fireEvent("loadShareIcons",a)},setButtons:function(){var c=this;if($(document).height()>$(document).width()){var a="phoneShareBtn";var b="margin-top:10%";c.getComponent("sharebtns").setScrollable("vertical")}else{var a="phoneShareBtnLand";var b="margin-left:5%;margin-top:2.5%;";c.getComponent("sharebtns").setScrollable("horizontal")}c.getComponent("sharebtns").setHtml("<div class='"+a+"' onclick='parent.socialShare(\"facebook\")' style='"+b+";background-image:url(../../readerassets/social/facebook-icon.png);background-color:#3b5998;'></div><div class='"+a+"' onclick='parent.socialShare(\"twitter\")' style='background-image:url(../../readerassets/social/twitter-icon.png);background-color:#00aced;'></div><div class='"+a+"' onclick='parent.socialShare(\"google\")' style='background-image:url(../../readerassets/social/googleplus-icon.png);background-color:#dd4b39;'></div><div class='"+a+"' onclick='parent.socialShare(\"pinterest\")' style='background-image:url(../../readerassets/social/pinterest-icon.png);background-color:#cb2027;'></div><div class='"+a+"' onclick='parent.socialShare(\"linkedin\")' style='background-image:url(../../readerassets/social/linkedin-icon.png);background-color:#007bb5;'></div><div class='"+a+"' onclick='parent.socialShare(\"email\")' style='background-image:url(../../readerassets/social/email-ic-white.png);background-color:#929292;'></div>");c.getComponent("titleBar").getComponent("ToolBarClose").element.on("tap",function(){c.destroy()});socialShare=function(e){var d=article._page.description.replace(/&apos;/g,"'");switch(e){case"facebook":var f=window.open("http://www.facebook.com/sharer/sharer.php?m2w&u="+encodeURIComponent(window.location)+"&title="+d,"_blank");break;case"twitter":window.open("http://twitter.com/intent/tweet?text="+d+" - "+window.location);break;case"google":window.open("https://plus.google.com/share?url="+window.location);break;case"pinterest":window.open("http://pinterest.com/pin/create/bookmarklet/?media=http://edition.pagesuite-professional.co.uk/get_image.aspx?w=300&"+c.getURLmedia()+"&url="+window.location+"&is_video=false&description="+d);break;case"linkedin":window.open("http://www.linkedin.com/shareArticle?mini=true&url="+window.location+"&title="+d);break;case"email":var g="mailto:?body="+d+" - "+window.location;window.location.href=g;break}}},getURLmedia:function(){if(window.location.href.indexOf("pubid")!=-1){var a=window.location.href.indexOf("pubid");var b=window.location.href.substring(a+6,window.location.length);var c=b.split("&");return"pubid="+c[0]}else{if(window.location.href.indexOf("edid")!=-1){var a=window.location.href.indexOf("edid");var b=window.location.href.substring(a+5,window.location.length);var c=b.split("&");return"edid="+c[0]}}},handleChange:function(){var a=this;a.setButtons()}},0,["sharepopup"],["component","container","sharepopup"],{component:true,container:true,sharepopup:true},["widget.sharepopup"],0,[InfinityMobile.view.phone,"ReaderSharePopup"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderSharePopupItem",Ext.Container,{config:{margin:20,cls:"sharepopupitem",layout:{type:"vbox",align:"center",pack:"middle"},items:[{itemId:"iconImage",width:40,height:40}]},initialize:function(){var a=this;a.message="";a.url=encodeURIComponent(window.location.href);if(a.config.message!=null){a.message=a.config.message}if(a.config.url!=null){a.url=a.config.url}if(a.config.articleguid!=null){a.articleguid=a.config.articleguid}if(a.config.color!=null){a.color=a.config.color;a.setColor()}if(a.config.icon!=null){a.icon=a.config.icon;a.iconImage=a.getComponent("iconImage");a.setIcon()}if(a.config.articleLink!=null){a.articleLink=a.config.articleLink;a.setArticleLink()}},setColor:function(){var a=this;a.setStyle({backgroundColor:a.color})},setIcon:function(){var a=this;a.iconImage.setHtml("<img src='"+a.icon+"' style='width:100%' />")},setArticleLink:function(){var a=this;a.element.on("tap",function(){var b=a.articleLink.replace("{0}",a.url).replace("{1}",a.message);b=b.replace(/&apos;/g,"'");if(b.indexOf("mailto:")!=-1){var c="http://html5.pagesuite.com/infinity/article_share.aspx?guid=";a.fireEvent("emailArticleShare",b,c)}else{window.open(b)}})}},0,["sharepopupitem"],["component","container","sharepopupitem"],{component:true,container:true,sharepopupitem:true},["widget.sharepopupitem"],0,[InfinityMobile.view.phone,"ReaderSharePopupItem"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderBannerAd",Ext.Container,{config:{width:"100%",cls:"reader-banner-ad",height:110,padding:10,style:"transition: height 1s;",layout:{type:"hbox",align:"center",pack:"middle"}},initialize:function(){var a=this;a.canLoadDFPAdvert=false;a.loadDFPAdvertOnPainted=false;a.bannerAd=a.getComponent("bannerAd");a.position=settings.reader.bannerAd.position;a.on("painted",a.setCanLoadDFPAdvert,a,{delay:10,single:true})},setTargeting:function(a){var b=this;b.targeting=a},setCanLoadDFPAdvert:function(){var a=this;a.canLoadDFPAdvert=true;if(a.loadDFPAdvertOnPainted){a.loadDFPAdvert()}},loadAdvert:function(a,d){var c=this;if(c.getItems().items.length>0){c.destroyAdvert()}c.add({itemId:"bannerAd",cls:"readerBannerAd"});c.bannerAd=c.getComponent("bannerAd");if(settings.reader.bannerAd!=null){var b=settings.reader.bannerAd.type.toLowerCase();switch(b){case"dfp":default:c.setDFPAdvert();break;case"image":c.setImageAdvert();break;case"url":c.setUrlAdvert(a,d);break}}},destroyAdvert:function(){var a=this;a.removeAll(true,true)},destroyAdvert2:function(){var a=this},refreshAdvert:function(){var a=this},setDFPAdvert:function(){var b=this;b.networkCode=settings.reader.bannerAd.networkCode;b.adUnit=settings.reader.bannerAd.adUnit;b.advertDivID=b.bannerAd.id+"advert";if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){b.setUpToggleableBanner();b.bannerAdHolder.setHtml("<div id='"+b.advertDivID+"' style=''></div>");b.advertDiv=b.bannerAdHolder.element.down("#"+b.advertDivID);b.loadDFPAdvertOnPainted=true}else{b.bannerAd.setHtml("<div id='"+b.advertDivID+"' style=''></div>");b.advertDiv=b.element.down("#"+b.advertDivID)}var a=false;b.advertDiv.dom.style.height="90px";b.advertDiv.dom.onclick=function(c){b.advertDiv.dom.style.transition="0.8s ease all";if(a){b.advertDiv.dom.style.height="90px";a=false}else{b.advertDiv.dom.style.height="315px";a=true}};if(b.setCanLoadDFPAdvert()){b.loadDFPAdvert()}else{b.loadDFPAdvertOnPainted=true}},loadDFPAdvert:function(){var b=this;var a="top-banner";if(b.targeting!=null){a=b.targeting}googletag.cmd.push(function(){b.adslot=googletag.defineSlot("/"+b.networkCode+"/"+b.adUnit,[parseInt("728"),parseInt("90")],b.advertDivID).addService(googletag.pubads()).setTargeting("pos","1");googletag.pubads().setTargeting("ptype",["sf"]);googletag.enableServices();googletag.display(b.advertDivID)})},setImageAdvert:function(){var b=this;var a=b.bannerAd;if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){b.setUpToggleableBanner();a=b.bannerAdHolder}a.setHtml("<img src='"+settings.reader.bannerAd.url+"' />");a.element.on("tap",function(){window.open(settings.reader.bannerAd.link)})},setUrlAdvert:function(a,e){var d=this;var b=settings.reader.bannerAd.url;var f="edid="+editionguid+"&pubid="+publicationguid+"&pnum="+a+"&w=728&h=90&elemid="+encodeURIComponent(d.getId())+(!!e&&e.trim()!=""?"&section="+encodeURIComponent(e):"");if(b.indexOf("?")==-1){b+="?"+f}else{b+="&"+f}if(settings.reader.bannerAd.canBeClosed!=null&&settings.reader.bannerAd.canBeClosed=="true"){d.setUpToggleableBanner();d.bannerAdHolder.setHtml("<iframe width='728' height='95' style='border:none;overflow:hidden' src='"+b+"' />")}else{d.bannerAd.setHtml("<iframe width='728' height='95' style='border:none;overflow:hidden' src='"+b+"' />")}if(settings.reader.bannerAd.isBannerExpandable=="true"){var c=d.element.down("iframe").dom;c.onload=function(){var g=$(d.bannerAdHolder.element.dom).find(".x-innerhtml")[1];if(g!=null){var j=g.children[1];if(j!=null){d.bannerAdHolder.element.dom.style.transition="1s ease all";var h=j.children[3];if(h!=null){h.style.position="relative";h.style.transform="translateY(-22px)"}}}}}},setUpToggleableBanner:function(){var a=this;var b=-30;if(a.position=="top"){b=0}a.bannerAdHolder=Ext.create("Ext.Container",{style:"display:block; position:relative",items:[{id:"bannerCloseBtn",html:'<div style="height:30px;background:rgba(0,0,0,0.8);position:absolute;right:0;top:'+b+'px;cursor:pointer"><img style="max-width: 100%" src="resources/images/btnAdClose.png"></div>'}]});a.add(a.bannerAdHolder);a.closeBtn=a.bannerAdHolder.getComponent("bannerCloseBtn");a.setupCloseButton()},setupCloseButton:function(a){var b=this;b.closeBtn.element.on("tap",function(){console.log("TAP");b.fireEvent("bannerAdClose",b)});if(settings.reader.bannerAd.canBeClosed!="true"||b.config.advertType=="article"){b.closeBtn.hide()}}},0,["readerbannerad"],["component","container","readerbannerad"],{component:true,container:true,readerbannerad:true},["widget.readerbannerad"],0,[InfinityMobile.view.tablet,"ReaderBannerAd"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderBannerAd",Ext.Container,{config:{style:"text-align:center",width:"100%",padding:"5px 0 5px 0",height:60,layout:{type:"hbox",align:"center",pack:"middle"}},initialize:function(){var a=this;a.canLoadDFPAdvert=false;a.loadDFPAdvertOnPainted=false;a.on("painted",a.setCanLoadDFPAdvert,a,{delay:10,single:true})},loadAdvert:function(){var b=this;if(b.getItems().items.length>0){b.destroyAdvert()}b.add({itemId:"bannerAd"});b.bannerAd=b.getComponent("bannerAd");if(settings.reader.bannerAd!=null){var a=settings.reader.bannerAd.type.toLowerCase();switch(a){case"dfp":default:b.setDFPAdvert();break;case"image":b.setImageAdvert();break;case"url":b.setUrlAdvert();break}}},destroyAdvert:function(){var a=this;a.removeAll(true)},setCanLoadDFPAdvert:function(){var a=this;a.canLoadDFPAdvert=true;if(a.loadDFPAdvertOnPainted){a.loadDFPAdvert()}},setDFPAdvert:function(){var b=this;var a=b.getComponent("bannerAd");b.networkCode=settings.reader.bannerAd.networkCode;b.adUnit=settings.reader.bannerAd.adUnit;b.advertDivID=b.bannerAd.id+"advert";a.setHtml("<div id='"+b.advertDivID+"' style='height:50px;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);if(b.setCanLoadDFPAdvert()){b.loadDFPAdvert()}else{b.loadDFPAdvertOnPainted=true}},loadDFPAdvert:function(){var a=this;googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("320"),parseInt("50")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})},setImageAdvert:function(){var b=this;var a=b.getComponent("bannerAd");a.setHtml("<img src='"+settings.reader.bannerAd.url+"' style='height:50px' />");a.element.on("tap",function(){window.open(settings.reader.bannerAd.link)})},setUrlAdvert:function(){var c=this;var b=c.getComponent("bannerAd");var a=settings.reader.bannerAd.url;b.setHtml("<iframe width='320' height='30' style='border:none;' scrolling='no' src='"+a+"' />")}},0,["readerbannerad"],["component","container","readerbannerad"],{component:true,container:true,readerbannerad:true},["widget.readerbannerad"],0,[InfinityMobile.view.phone,"ReaderBannerAd"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderBookmark",InfinityMobile.view.Overlay,{config:{itemId:"bookmarkcontainer",width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;",layout:"vbox",items:[{itemId:"bookmarkToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"bookmarkToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"bookmarkBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"bookmarkHelperText"},{itemId:"bookmarkAddContainer",layout:{type:"hbox",align:"stretch",pack:"middle"},height:35,margin:"10px 0",items:[{flex:1,itemId:"textInput",html:"<input class='bookmarkName' type='text' placeholder='Name' style='width:100%; height:35px; padding-left:10px' />"},{width:20},{itemId:"bookmarkAddButton",width:150,cls:"btn",layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"btnText"}]}]},{itemId:"bookmarksContainer",flex:1,scrollable:{direction:"vertical"},defaults:{width:200,margin:10}}]}]},initialize:function(){var c=this;var b=c.getComponent("bookmarkToolBar");b.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});c.closeButton=b.getComponent("bookmarkToolBarClose");c.setCloseButtonListener();var d=c.getComponent("bookmarkBodyContainer");c.helperTextContainer=d.getComponent("bookmarkHelperText");var a=d.getComponent("bookmarkAddContainer");console.log(a);c.addBookmarkTextBox=a.element.down(".bookmarkName").dom;c.addBookmarkButton=a.getComponent("bookmarkAddButton");c.title=b.getComponent("title");c.title.setHtml(language.bookmarks.bookmarks);c.helperTextContainer.setHtml(language.bookmarks.bookmarksContainerText);c.inputPanel=a.getComponent("textInput");c.input=c.inputPanel.element.down(".bookmarkName").dom;$(c.input).attr("placeholder",language.bookmarks.name);c.addBookmarkButton.getComponent("btnText").setHtml(language.bookmarks.add);c.setAddButtonListener();c.bookmarksContainer=d.getComponent("bookmarksContainer");if(!Ext.os.is.Desktop){a.element.down(".bookmarkName").on("tap",function(){this.focus()})}c.addBookmarkButton.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});if(settings.newsday!=null){b.element.dom.style.borderTopLeftRadius="";b.element.dom.style.borderTopRightRadius="";c.setStyle({borderRadius:"0px"});c.element.down("div").dom.style.borderRadius="0px"}c.fireEvent("loadBookmarks",c)},setCloseButtonListener:function(){var b=this;b.closeButton.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeButton.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setAddButtonListener:function(){var a=this;console.log(a.addBookmarkButton);a.addBookmarkButton.element.on("tap",function(){a.fireEvent("addBookmark",a)})},close:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["readerbookmark"],["component","container","panel","overlay","readerbookmark"],{component:true,container:true,panel:true,overlay:true,readerbookmark:true},["widget.readerbookmark"],0,[InfinityMobile.view.tablet,"ReaderBookmark"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderBookmark",InfinityMobile.view.Overlay,{config:{id:"bookmarkcontainer",width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{id:"bookmarkToolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{id:"bookmarkToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"bookmarkBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"bookmarkHelperText"},{itemId:"bookmarkAddContainer",layout:{type:"hbox",align:"stretch",pack:"middle"},height:35,margin:"10px 0",items:[{flex:1,itemId:"textInput",html:"<input class='bookmarkName' type='text' placeholder='' style='width:100%; height:35px; padding-left:10px' />"},{width:20},{itemId:"bookmarkAddButton",width:150,cls:"btn",layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"btnText"}]}]},{itemId:"bookmarksContainer",flex:1,scrollable:{direction:"vertical"},defaults:{cls:"bookmarkitemphone",margin:10}}]}]},initialize:function(){var c=this;var b=c.getComponent("bookmarkToolBar");b.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});c.closeButton=b.getComponent("bookmarkToolBarClose");c.setCloseButtonListener();var d=c.getComponent("bookmarkBodyContainer");c.helperTextContainer=d.getComponent("bookmarkHelperText");var a=d.getComponent("bookmarkAddContainer");c.addBookmarkTextBox=a.element.down(".bookmarkName").dom;c.addBookmarkButton=a.getComponent("bookmarkAddButton");c.title=b.getComponent("title");c.title.setHtml(language.bookmarks.bookmarks);c.helperTextContainer.setHtml(language.bookmarks.bookmarksContainerText);c.inputPanel=a.getComponent("textInput");c.input=c.inputPanel.element.down(".bookmarkName").dom;$(c.input).attr("placeholder",language.bookmarks.name);c.addBookmarkButton.getComponent("btnText").setHtml(language.bookmarks.add);c.setAddButtonListener();c.bookmarksContainer=d.getComponent("bookmarksContainer");if(!Ext.os.is.Desktop){a.element.down(".bookmarkName").on("tap",function(){this.focus()})}c.addBookmarkButton.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.fireEvent("loadBookmarks",c)},setCloseButtonListener:function(){var b=this;b.closeButton.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeButton.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setAddButtonListener:function(){var a=this;a.addBookmarkButton.element.on("tap",function(){a.fireEvent("addBookmark",a)})},close:function(){var a=this;a.fireEvent("close",a)}},0,["readerbookmark"],["component","container","panel","overlay","readerbookmark"],{component:true,container:true,panel:true,overlay:true,readerbookmark:true},["widget.readerbookmark"],0,[InfinityMobile.view.phone,"ReaderBookmark"],0));(Ext.cmd.derive("InfinityMobile.view.phone.readerTerms",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:"100%",height:"100%",style:"background-color:white;padding:0px;",fullscreen:true,items:[{id:"toolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{id:"ToolBarClose",top:8,right:8,html:"<img class='pointerCursor' src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"body",width:"100%"}]},initialize:function(){var b=this;b.topbar=b.getComponent("toolBar");b.title=b.topbar.getComponent("title");b.close=b.topbar.getComponent("ToolBarClose");b.bodyContainer=b.getComponent("body");b.topbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.element.on({painted:function(){if(settings.menu.terms.url!=null){if(settings.menu.terms.url.length>0){$.ajax({url:"../get_terms_of_service.aspx?url="+encodeURIComponent(settings.menu.terms.url),async:false,success:function(d){b.bodyContainer.setHtml(d);b.bodyContainer.setHeight($(b.element.dom).height()-40);b.bodyContainer.setScrollable(true)},error:function(){b.destroy()}})}}},scope:b});var c=function(){$.ajax({url:"../get_terms_of_service.aspx?url="+encodeURIComponent(settings.menu.terms.url),async:false,success:function(d){b.bodyContainer.setHtml(d);b.bodyContainer.setHeight($(b.element.dom).height()-40);b.bodyContainer.setScrollable(true)}})};Ext.Viewport.on({orientationchange:c});b.title.setHtml(language.menu.terms);b.close.element.on({tap:function(){Ext.Viewport.removeListener("orientationchange",c);b.destroy()}});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.close.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}}},0,["readerTerms"],["component","container","readerTerms"],{component:true,container:true,readerTerms:true},["widget.readerTerms"],0,[InfinityMobile.view.phone,"readerTerms"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.SectionListOverlay",InfinityMobile.view.Overlay,{config:{height:"100%",width:"100%",style:"padding:0px;max-height:700px;width:700px;",layout:"vbox",items:[{itemId:"toolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"toolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},style:"overflow-y:scroll",defaults:{width:145,margin:"0 8 16 7"}}]}]},initialize:function(){var b=this;var a=b.getComponent("toolBar");b.toolBarClose=a.getComponent("toolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var c=b.getComponent("bodyContainer");b.itemsContainer=c.getComponent("itemsContainer");b.title=a.getComponent("title");b.title.setHtml(language.sectionList.sectionList);b.setCloseListener();if(settings.newsday!=null){a.element.dom.style.borderTopLeftRadius="";a.element.dom.style.borderTopRightRadius="";b.setStyle({borderRadius:"0px"});b.element.down("div").dom.style.borderRadius="0px"}b.fireEvent("initialized",b,b.itemsContainer)},setCloseListener:function(){var b=this;b.toolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;a.fireEvent("enableArticlesContainer",a);InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["sectionlistoverlay"],["component","container","panel","overlay","sectionlistoverlay"],{component:true,container:true,panel:true,overlay:true,sectionlistoverlay:true},["widget.sectionlistoverlay"],0,[InfinityMobile.view.tablet,"SectionListOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.phone.SectionListOverlay",InfinityMobile.view.Overlay,{config:{height:"100%",width:"100%",style:"padding:0px;",layout:"vbox",items:[{itemId:"toolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{itemId:"toolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},style:"overflow-y:scroll",defaults:{width:145,margin:"0 8 16 7"}}]}]},initialize:function(){var b=this;var a=b.getComponent("toolBar");b.toolBarClose=a.getComponent("toolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var c=b.getComponent("bodyContainer");b.itemsContainer=c.getComponent("itemsContainer");b.title=a.getComponent("title");b.title.setHtml(language.sectionList.sectionList);b.setCloseListener();b.fireEvent("initialized",b,b.itemsContainer)},setCloseListener:function(){var b=this;b.toolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)}},0,["sectionlistoverlay"],["component","container","panel","overlay","sectionlistoverlay"],{component:true,container:true,panel:true,overlay:true,sectionlistoverlay:true},["widget.sectionlistoverlay"],0,[InfinityMobile.view.phone,"SectionListOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ZonesOverlay",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px;max-height:700px;max-width:700px;min-height:412px;",layout:"vbox",items:[{itemId:"toolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em; font-weight:bold",items:[{itemId:"title",top:10,left:10},{itemId:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:150,margin:"0 8 16 7"}}]}]},initialize:function(){var b=this;var a=b.getComponent("toolBar");b.toolBarClose=a.getComponent("toolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.bodyContainer=b.getComponent("bodyContainer");b.itemsContainer=b.bodyContainer.getComponent("itemsContainer");b.title=a.getComponent("title");if(b.isUpper(language.menu.zones)){b.title.setHtml(language.menu.zones[0].toUpperCase()+language.menu.zones.substring(1,language.menu.zones.length).toLowerCase())}else{b.title.setHtml(language.menu.zones)}b.setCloseListener();b.fireEvent("initialized",b,b.itemsContainer)},isUpper:function(d){var b=this;var c=true;for(var a=0;a<d.length;a++){if(d[a]==d[a].toLowerCase()){c=false}}return c},setHeightOfContainer:function(){var g=this;var e=$(g.itemsContainer.element.dom).height();var j=$(g.itemsContainer.element.dom).width();var b=g.itemsContainer.getItems().items;var k=0;var f=0;var a=0;for(var d in b){f+=$(b[d].element.dom).width();if(a<$(b[d].element.dom).height()){a=$(b[d].element.dom).height()}}k=Math.ceil(f/j);g.setHeight((k*a)+100);if(k==1){var c=0;for(var d in b){c+=$(b[d].element.dom).width()}if(c<700){g.setWidth(c+80)}}g.element.dom.style.visibility="visible"},setCloseListener:function(){var b=this;b.toolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)}},0,["zonesoverlay"],["component","container","panel","overlay","zonesoverlay"],{component:true,container:true,panel:true,overlay:true,zonesoverlay:true},["widget.zonesoverlay"],0,[InfinityMobile.view.tablet,"ZonesOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ZonesOverlay",InfinityMobile.view.Overlay,{config:{width:"100%",height:"100%",style:"padding:0px;",layout:"vbox",items:[{itemId:"toolBar",height:40,style:"",items:[{itemId:"title",top:10,left:10},{itemId:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:150,margin:"0 8 16 7"}}]}]},initialize:function(){var b=this;var a=b.getComponent("toolBar");b.toolBarClose=a.getComponent("toolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.bodyContainer=b.getComponent("bodyContainer");b.itemsContainer=b.bodyContainer.getComponent("itemsContainer");b.title=a.getComponent("title");if(b.isUpper(language.menu.zones)){b.title.setHtml(language.menu.zones[0].toUpperCase()+language.menu.zones.substring(1,language.menu.zones.length).toLowerCase())}else{b.title.setHtml(language.menu.zones)}b.setCloseListener();b.fireEvent("initialized",b,b.itemsContainer)},isUpper:function(d){var b=this;var c=true;for(var a=0;a<d.length;a++){if(d[a]==d[a].toLowerCase()){c=false}}return c},setHeightOfContainer:function(){var g=this;var e=$(g.itemsContainer.element.dom).height();var j=$(g.itemsContainer.element.dom).width();var b=g.itemsContainer.getItems().items;var k=0;var f=0;var a=0;for(var d in b){f+=$(b[d].element.dom).width();if(a<$(b[d].element.dom).height()){a=$(b[d].element.dom).height()}}k=Math.ceil(f/j);g.setHeight((k*a)+100);if(k==1){var c=0;for(var d in b){c+=$(b[d].element.dom).width()}if(c<700){g.setWidth(c+80)}}g.element.dom.style.visibility="visible"},setCloseListener:function(){var b=this;b.toolBarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)}},0,["zonesoverlay"],["component","container","panel","overlay","zonesoverlay"],{component:true,container:true,panel:true,overlay:true,zonesoverlay:true},["widget.zonesoverlay"],0,[InfinityMobile.view.phone,"ZonesOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderArticlePopoverItem",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",article:null,cls:"loading",style:"background-color:white",layout:"card",items:[{itemId:"content",flex:1,padding:"0 0 10px 0"},{itemId:"mediaHuis",hidden:true,flex:1},{itemId:"contentIframe",layout:"fit",height:"100%"}]},initialize:function(){var c=this;c.painted=false;c.mode="html";c.destroyed=false;c.advertTimeout=1500;c.content=c.getComponent("content");c.contentIframe=c.getComponent("contentIframe");c.setContentStyle();if((c.config.highlightMode!=null&&c.config.highlightMode==true)||(c.config.readAloudMode!=null&&c.config.readAloudMode)){c.mode="frame";c.setActiveItem(c.contentIframe)}c.popoverType="article";if(InfinityMobile.app.getController("MediaController").currentLang){c.lang=InfinityMobile.app.getController("MediaController").currentLang}if(settings.reader.iframePopover!=null&&settings.reader.iframePopover=="true"){c.intializeForIframe()}else{if(c.getArticle()!=null){c.article=c.getArticle();c.removeInlineStyling();if(settings.newsday!=null&&settings.newsday.useNewsdayTemplate!=null&&settings.newsday.useNewsdayTemplate=="true"){var b=true;c.initializeInlineNewsday()}else{var b=false;c.initializeInline()}if((navigator.maxTouchPoints)){c.content.setScrollable({direction:"vertical",directionLock:true})}else{c.element.down(".x-container").dom.style.overflowY="scroll"}}else{var a=InfinityMobile.app.application.getController("MediaController").flippAdvertSetting;if(!!a&&a.enabled){c.addCls("has-flipp")}c.initializeForWeb();if(c.xtype=="readerpuzzlepopoveritem"&&!!a&&a.enabled){c.element.down(".x-inner").dom.style.overflowY="scroll"}else{c.element.down(".x-container").dom.style.overflow="hidden"}}}},getArticleTemplate:function(){var a=this;var b=a.getPage();if(b.guid!=null){$.ajax({url:"https://edition.pagesuite.com/popovers/dynamic_article_popover.aspx?source=html5&guid="+b.guid,success:function(c){a.removeSpinner();var d=$(c.body);$(".clContent_Header",d).remove().html();$(".clContent_Footer",d).remove().html();$(".clContent_Body",d).css("top","0px");$(".clContent_Body",d).css("bottom","0px");$(".clContent_Body",d).css("padding","0px 5px");$(".clContent_Body_Headline ",d).addClass("font35");$(".clContent_Body_SubHeadline ",d).addClass("font25");$(".clContent_Body_Byline ",d).addClass("font15");$(".clContent_Body_Body  ",d).addClass("font13");$(d).load(function(){if($(".contentImages",a.element.dom).length>0){$("img",a.element.dom).load(function(){setText(a.element.dom)});a.setUpImageControls()}else{setText(a.element.dom)}if($("#DFP_BANNER",d)[0]!=null){}});$(a.element.dom).append($(d))}})}},setUpImageControls:function(){var c=this;var a=$(".clRightArrow",c.element.dom);var g=$(".clRightArrowText",c.element.dom);var f=$(".clLeftArrow",c.element.dom);var b=$(".clLeftArrowText",c.element.dom);var d=function(){var j=$(".contentImage",c.element.dom).length;var k=0;for(var h=0;h<j;h++){if($(".contentImage",c.element.dom)[h].style.display=="block"){k=h;break}}if(k+1<j){$(".contentImage",c.element.dom)[k].style.display="none";$(".contentImage",c.element.dom)[k+1].style.display="block"}};var e=function(){var j=$(".contentImage",c.element.dom).length;var k=0;for(var h=0;h<j;h++){if($(".contentImage",c.element.dom)[h].style.display=="block"){k=h;break}}if(k-1>=0){$(".contentImage",c.element.dom)[k].style.display="none";$(".contentImage",c.element.dom)[k-1].style.display="block"}};$(".contentImage",c.element.dom).css("transition","all ease 0.5s");a[0].addEventListener("touchstart",d);g[0].addEventListener("touchstart",d);f[0].addEventListener("touchstart",e);b[0].addEventListener("touchstart",e);a[0].onclick=d;g[0].onclick=d;f[0].onclick=e;b[0].onclick=e},removeInlineStyling:function(){var j=this;var l=/style=["'][^\"]*["']/g;var e=j.article.body.match(l);if(e!=null){for(var d=0;d<e.length;d++){if(e[d].indexOf("font-size")!=-1){var g=e[d].indexOf("font-size");var f=0;for(var k=g;k<e[d].length;k++){if(e[d][k]==";"){f=k;break}}}var c=e[d].substring(0,g)+e[d].substring(f,e[d].length);j.article.body=j.article.body.replace(e[d],c);e[d]=c;if(e[d].indexOf("line-height")!=-1){var b=e[d].indexOf("line-height");var h=0;for(var k=b;k<e[d].length;k++){if(e[d][k]==";"){h=k;break}}}var a=e[d].substring(0,b)+e[d].substring(h,e[d].length);j.article.body=j.article.body.replace(e[d],a)}}},initializeInlineNewsday:function(){var e=this;var g="<div class='container'><div class='content'><div class='articleContent'><{{LABEL}}><div class='contenthead font35'><{{HEAD}}></div><{{HEADDECK}}><{{IMAGE}}><div style='margin-bottom:15px;min-height:25px;'><{{BYLINE}}><div class='bylinecontainer' ><{{TEXTCONTROLS}}></div></div><hr /><div class='contentbody'><{{REVIEWBOX}}><div style='position:relative;' ><{{MPU}}><{{BODY}}></div><{{NEWSBOX}}></div><{{BANNERAD}}></div></div></div>";if(e.article.label!=null){g=g.replace("<{{LABEL}}>",'<div class="label labeldesktop" >'+e.article.label+"</div>")}else{g=g.replace("<{{LABEL}}>","")}g=g.replace("<{{HEAD}}>",e.article.headline);g=g.replace("<{{HEADDECK}}>",'<div class="contentdeck font25">'+e.article.subHeadline+"</div>");g=e.newsdayByline(g);if(e.article.reviewBox.trim().length>0){var c="";if(e.article.label=="REVIEWS"){c='<p><span class="BOLD">REVIEW</span></p>'}g=g.replace("<{{REVIEWBOX}}>","<div class='reviewbox' >"+c+e.article.reviewBox+"</div>")}else{g=g.replace("<{{REVIEWBOX}}>","")}g=g.replace("<{{BODY}}>",e.article.body);if(e.article.newsBox.trim().length>0){g=g.replace("<{{NEWSBOX}}>","<div class='newsbox' >"+e.article.newsBox+"</div>")}else{g=g.replace("<{{NEWSBOX}}>","")}g=g.replace("<{{TEXTCONTROLS}}>",'<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="resources/images/increase-text-size_newsday.png" ontouchstart="increaseTextNewsday()" onclick="increaseTextNewsday()">&nbsp;&nbsp;<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="resources/images/decrease-text-size_newsday.png" ontouchstart="decreaseTextNewsday()" onclick="decreaseTextNewsday()"></div>');var a=settings.newsday.articleCubeAd;if(a!=null){if(a.networkCode!=null&&a.adUnit!=null){e.networkCodeMpu=a.networkCode;e.adUnitMpu=a.adUnit;e.advertDivIDMpu=e.id+"mpu";g=g.replace("<{{MPU}}>",'<div id="'+e.advertDivIDMpu+'" class="mpuAdvert" ></div>')}}else{g=g.replace("<{{MPU}}>","")}var f=settings.newsday.articleBannderAd;if(f!=null){if(f.networkCode!=null&&f.adUnit!=null){e.networkCode=f.networkCode;e.adUnit=f.adUnit;e.advertDivID=e.id+"advert";g=g.replace("<{{BANNERAD}}>","<div id='"+e.advertDivID+"' style='width:728px;height:110px;margin:auto;'></div>")}}var d=e.initializeInlineImagesNewsday();g=g.replace("<{{IMAGE}}>",d);e.content.setHtml(g);e.removeSpinner();e.on("painted",function(){e.setImages();e.fireEvent("fillPrintContainer",e)},e,{});e.hasVideo=false;e.hasLink=false;e.hasGallery=false;var b=$(e.element.dom).find(".articleImg")[0];if(b!=null){b.onload=function(){if(e.element!=null){var l=$(e.element.dom).find(".galleryicon")[0];$(l).css("visibility","visible");$(l).click(function(){e.viewGallery()});l.addEventListener("touchstart",function(){e.viewGallery()})}if(e.article.media!=null){if(e.article.media.length>0){for(var j in e.article.media){if(e.article.media[j].type=="OVIDEO"){var k=$(e.element.dom).find(".articlevideoicon")[0];$(k).css("display","inline");e.oVideo=e.article.media[j];if(!e.hasVideo){$(k).click(function(){e.viewOVideo(e.oVideo)});k.addEventListener("touchstart",function(){e.viewOVideo(e.oVideo)});e.hasVideo=true}}if(e.article.media[j].type=="OLINK"){if(e.element!=null){var h=$(e.element.dom).find(".linkicon")[0];$(h).css("display","inline");e.oLink=e.article.media[j].url;if(!e.hasLink){$(h).click(function(){e.openOLink(e.oLink)});h.addEventListener("touchstart",function(){e.openOLink(e.oLink)});e.hasLink=true}}}if(e.article.media[j].type=="OGALLERY"){var h=$(e.element.dom).find(".ogalleryicon")[0];$(h).css("display","inline");e.oGallery=e.article.media[j];if(!e.hasGallery){$(h).click(function(){e.openOGallery(e.oGallery)});h.addEventListener("touchstart",function(){e.openOGallery(e.oGallery)});e.hasGallery=true}}}}}}}setNewsdayText(e.content.element.dom)},newsdayByline:function(c){var d=this;var e="";if(d.article.byline.length>0){e="<div class=\"contentbyline font15\">By <span class='bylinespan'>"+d.article.byline+"</span>";if(d.validateEmail(d.article.reporterEmail)){e=e.replace("<span class='bylinespan'>","<span class='bylinespan pointerCursor' ontouchstart='window.location.href = \"mailto:"+d.article.reporterEmail+"?subject="+encodeURIComponent(d.article.headline)+"\";' onclick='window.location.href = \"mailto:"+d.article.reporterEmail+"?subject="+encodeURIComponent(d.article.headline)+"\";'>")}else{e=e.replace("<span class='bylinespan'>","<span>")}if(d.article.reporters!=null){for(var b in d.article.reporters){var a="";if(b==d.article.reporters.length-1){a+=" and <span class='bylinespan'>"+d.article.reporters[b].name+"<span>"}else{a+=", <span class='bylinespan'>"+d.article.reporters[b].name+"<span>"}if(d.validateEmail(d.article.reporters[b].email)){a=a.replace("<span class='bylinespan'>","<span class='bylinespan pointerCursor' ontouchstart='window.location.href = \"mailto:"+d.article.reporters[b].email+"?subject="+encodeURIComponent(d.article.headline)+"\";' onclick='window.location.href = \"mailto:"+d.article.reporters[b].email+"?subject="+encodeURIComponent(d.article.headline)+"\";'>")}else{a=a.replace("<span class='bylinespan'>","<span>")}e+=a}}e+="</div>"}c=c.replace("<{{BYLINE}}>",e);return c},validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},viewGallery:function(){var a=this;a.fireEvent("galleryClickFromArticle",a,a.article.images,a.article)},viewOVideo:function(c){var b=this;var a=c.url;if(a.indexOf("http://")==-1){a="http://"+a}b.fireEvent("ovideoclicked",b,a)},openOLink:function(a){var b=this;window.open(a);b.fireEvent("trackOLink",b,a,b.article)},openOGallery:function(a){var b=this;b.fireEvent("galleryClick",b,a.url)},loadAdvert:function(){var a=this;setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("728"),parseInt("90")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})}},a.advertTimeout)},loadAdvertMpu:function(){var a=this;if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.type=="dfp"){setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){a.dfpAdvertMpuSlot=googletag.defineSlot("/"+a.networkCodeMpu+"/"+a.adUnitMpu,[parseInt("300"),parseInt("250")],a.advertDivIDMpu);googletag.pubads().enableSingleRequest();a.dfpAdvertMpuSlot.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivIDMpu)})}},a.advertTimeout)}},destoryAdvertMpuSlot:function(){var a=this;if(a.dfpAdvertMpuSlot!=null&&typeof googletag!="undefined"){googletag.destroySlots([a.dfpAdvertMpuSlot])}},initializeInline:function(){var b=this;var d="<div class='container'><div class='content'><div class='articleContent'><div class='contentHead font35'><{{HEAD}}></div><{{HEADDECK}}><{{IMAGE}}><br /><{{BYLINE}}><br /><div class='contentBody font15'><{{BODY}}></div></div></div></div>";d=d.replace("<{{HEAD}}>",b.article.headline);d=d.replace("<{{HEADDECK}}>",'<div class="contentDeck font25">'+b.article.subHeadline+"</div>");d=d.replace("<{{BYLINE}}>",'<div class="contentByline font15">'+b.article.byline+"</div>");d=d.replace("<{{BODY}}>",b.article.body);var a=b.initializeInlineImages();d=d.replace("<{{IMAGE}}>",a);b.content.setHtml(d);b.removeSpinner();b.on("painted",function(){b.setImages();b.fireEvent("fillPrintContainer",b)},b,{});if(settings.reader.popupAdvert!=null){if(settings.reader.popupAdvert.position!=null){if(settings.reader.popupAdvert.position=="bottom"){switch(currentProfile){case"phone":var c=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var c=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var c=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{padding:"10px 0 0 0"});break}b.add(c);c.show()}}}b.createShortStory(b.article);b.on("painted",function(){var e=$(b.element.dom).find(".fullscreengalleryicon");if(e!=null&&e.length>0){$(e).click(function(){b.createFullscreenGallery(b.article)});e[0].addEventListener("touchstart",function(){b.createFullscreenGallery(b.article)})}})},createShortStory:function(g){var h="";var f=/<p[^>]*>/g;var b=[];while((match1=f.exec(g.body))!=null){b[b.length]=match1.index}f=/<\/p/g;var e=[];while((match=f.exec(g.body))!=null){e[e.length]=match.index}f=/<p[^>]*>/g;for(var d=0;d<b.length;d++){var h=g.body.substring(b[d],e[d]).replace(f,"");if(h.length>0){g.shortStory=h;break}else{var a=/\n|([^\r\n.!?]+([.!?]+|$))/gim;var c=[];while((match2=a.exec(g.body))!=null){if(c.length<2){c[c.length]=match2.index}else{break}}if(c[1]>0){g.shortStory=g.body.substring(0,c[1])}else{g.shortStory=""}}}if(g.shortStory==null){var a=/\n|([^\r\n.!?]+([.!?]+|$))/gim;var c=[];while((match2=a.exec(g.body))!=null){if(c.length<2){c[c.length]=match2.index}else{break}}if(c[1]>0){g.shortStory=g.body.substring(0,c[1])}else{g.shortStory=""}}},createFullscreenGallery:function(d){var b=this;var a=[];for(image in d.images){a.push({url:d.images[image].url})}if(Ext.os.is.Desktop){var e="InfinityMobile.view.desktop.ImageGallery"}else{var e="InfinityMobile.view.tablet.ImageGallery"}var c=Ext.create(e,{images:a,article:d,dynamicview:false,zIndex:99999999});Ext.Viewport.add(c);c.show()},initializeInlineImagesNewsday:function(){var d=this;var g=d.article.images;var a="";if(g.length>0){var b="<div class=\"contentImage imagecontainerblack\"><div class=\"imageandiconscontainer\"><div class=\"iconscontainer\" ><div class='articlevideoicon pointerCursor'></div><div class='linkicon pointerCursor' ></div><div class='ogalleryicon pointerCursor' ></div><div class='galleryicon pointerCursor' ></div></div><img class='articleImg' src=\"{{imageurl}}\" alt=\"\" /></div>{{imagecaption}}</div>";var c="";var e=g[0];var f="";if(e.credit!=null){if(e.credit.trim().length>0){f=" ("+e.credit+")"}}c+=b.replace("{{imageurl}}",e.url).replace("{{imagecaption}}",'<div class="contentcaption captionlineheight font13">'+e.caption+f+"</div>");a=c}return a},initializeInlineImages:function(){var g=this;var h=g.article.images;var j="";if(h.length>0){var d="<div class=\"contentImages\" style='position:relative;'><div style='position:absolute;top:0px;right:0px;z-index:1;'><div class='fullscreengalleryicon pointerCursor' ></div></div>{{imagescontent}}</div>";var e='<div class="contentImage"><img src="{{imageurl}}" alt="" />{{imagecaption}}</div>';var a="";for(var f=0;f<h.length;f++){var b=h[f];a+=e.replace("{{imageurl}}",b.url).replace("{{imagecaption}}",'<div class="contentCaption font13">'+b.caption+"</div>")}var c='<div class="imageControls"><a href="javascript:void(0)" class="previousImage">PREVIOUS IMAGE<img class="imgPreviousImage" src="https://edition.pagesuite.com/tribune/left-image-arrow.png" alt="" /></a><div class="imageCount">Image</div><a href="javascript:void(0)" class="nextImage">NEXT IMAGE<img class="imgNextImage" src="https://edition.pagesuite.com/tribune/right-image-arrow.png" alt="" /></a></div>';a+=c;j=d.replace("{{imagescontent}}",a)}return j},checkLanguage:function(){var e=this;var a=navigator.language.substring(0,2);try{var d=localStorage.getItem("checkLanguage"+publicationguid)}catch(c){var d=null}if(d==null){if(settings.reader.language!="en"){e.sourceLanguage="en";e.targetLanguage=settings.reader.language;return false}}else{if(d!="false"){var b=d;if(b!=settings.reader.language){e.sourceLanguage=settings.reader.language;e.targetLanguage=b;return false}}else{if(settings.reader.language!="en"){e.sourceLanguage="en";e.targetLanguage=settings.reader.language;return false}}}return true},initializeLanguage:function(){var a=this;a.on("painted",a.getLanguageContent,a,{delay:10,single:true})},getLanguageContent:function(){var a=this},initializeForWeb:function(){var a=this;if(a.getPage()!=null){if(a.getPage().file==a.getPage().guid){a.popoverType="guid"}a.articleguid=a.getPage().file}a.on("painted",a.getContent,a,{delay:10,single:true})},setContentStyle:function(){var a=this;if(currentProfile=="tablet"){a.content.setPadding("0 20px 0 20px")}},getContent:function(){var e=this;var a=e.articleguid;e.painted=true;e.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");if(typeof isTribReader!="undefined"&&isTribReader&&(e.lang=="es"||e.lang=="en")){var c="&lang="+e.lang}else{var c=""}var f="";if(settings.reader.popupAdvert!=null){if(settings.reader.popupAdvert.position!=null){f+="&aposition="+settings.reader.popupAdvert.position}if(settings.reader.popupAdvert.type!=null){if(settings.reader.popupAdvert.type=="dfp"){f+="&adtype="+settings.reader.popupAdvert.type+"|"+e.id+"advert"}else{f+="&atype="+settings.reader.popupAdvert.type}}}var b="";if(typeof latestLM!="undefined"){b="&lm="+latestLM}var d="../article.aspx?articleguid="+a+"&html5="+currentProfile+f+b;if(e.popoverType=="guid"){e.content.element.dom.style.overflowY="";d="../article.aspx?guid="+a+"&html5="+currentProfile+f+b}$.ajax({crossDomain:true,type:"GET",contentType:"text/html",async:true,url:d,success:function(o){var p=Ext.getStore("SettingStore");if(settings.reader.popupAdvert!=null){var r=settings.reader.popupAdvert;switch(r.type.toLowerCase()){case"dfp":s=e.setupDfpAdvertContent(s);break;case"image":s=e.setupImageAdvertContent(s);break;case"url":s=e.setupUrlAdvertContent(s);break}}var s=o;var l=s.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(l){s=l[1]}e.articleText=s;s+="<script>setText()<\/script>";s=s.replace("<{{navbar}}>","");var q=false;if(settings.reader.popupAdvert!=null){var r=settings.reader.popupAdvert;switch(r.type.toLowerCase()){case"dfp":s=e.setupDfpAdvertContent(s);break;case"image":s=e.setupImageAdvertContent(s);break;case"url":s=e.setupUrlAdvertContent(s);q=true;break}}if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.customClass!=null){var v=settings.reader.popupAdvertMpu;switch(v.type.toLowerCase()){case"dfp":s=e.setupDfpAdvertContentMpu(s);break}}var h=e.returnFlippHtml();s+=h;s=s.replace(/http:\/\/digitaledition.courant.com/g,"https://edition.pagesuite.com");e.removeSpinner();e.unmask();e.content.setHtml(s);e.content.setPadding("0px");e.setupFullscreenGallery(s);if(q){var g=e.content.element.down(".container");if(g!=null){g.dom.style.height="auto"}if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){var j=e.content.element.down(".x-innerhtml");if(j!=null){j.dom.style.overflowY="auto"}}}if(settings.reader.popupAdvert!=null&&settings.reader.popupAdvert.type=="dfp"){e.loadAdvert()}if(settings.reader.popupAdvertMpu!=null){if(settings.reader.popupAdvertMpu.customClass==null){var v=settings.reader.popupAdvertMpu;switch(v.type.toLowerCase()){case"dfp":e.setUpMpuInline();break}}if(e.parent.getActiveItem()==e){e.loadAdvertMpu()}}if(e.mode=="frame"){e.setFrame()}else{if(e.parent.getActiveItem()==e){e.runFlipp()}}e.setImages();if(e.content.element!=null){setText(e.content.element.dom)}e.setStyle({visibility:"inherit"});e.fireEvent("fillPrintContainer",e);if($(e.element.dom).find(".DS-storyimage__link")!=null){if($(e.element.dom).find(".DS-storyimage__link")[0]!=null){var t=$(e.element.dom).find(".DS-storyimage__link")[0];var n=$(t).find("img")[0];var u=t.parentElement;e.imgUrl=$(t).attr("href");t.remove();u.appendChild(n);$(n).addClass("pointerCursor");n.onclick=function(){e.mediaHuisImgClick()}}}if(typeof isTribReader!="undefined"){if(isTribReader){var k=$(e.element.dom).find(".articleContentHtml5");if(k.length>0){$(k[0]).css("padding-right","25px");$(k[0]).css("padding-left","25px")}}}e.content.element.on({scope:e.content,delegate:"a",tap:function(m){if(typeof m.target=="string"){if(!Ext.os.is.Desktop){window.location.href=m.target}mainPanel.fireEvent("trackArticleLinkClick",{url:m.target,pageNum:e.config.page.page,articleNumber:e.config.pageNo})}else{mainPanel.fireEvent("trackArticleLinkClick",{url:m.target.href,pageNum:e.config.page.page,articleNumber:e.config.pageNo})}}})}})},returnFlippHtml:function(){var c=this;var a=InfinityMobile.app.application.getController("MediaController").flippAdvertSetting;var d=a.enabled;var b=d?'<div id="flipp-div-'+c.id+'"><div class="flipp-ux-header" style="display: none; text-align: center; margin: 20px 0px; color: gray;"><a>'+a.headerText+"</a></div></div>":"";console.log("[FLIPP] Adding flipp-div-"+c.id+" to the DOM");return b},runFlipp:function(){var a=InfinityMobile.app.application.getController("MediaController").flippAdvertSetting;if(!!a&&a.enabled&&!this.hasSetupFlippOnArticle&&!!document.querySelector("#flipp-div-"+this.id)){var c=this;var b=undefined;window.flippxp=window.flippxp||{run:[]};console.log("[FLIPP] Registering flipp-div-"+c.id+" with flippxp");window.flippxp.run.push(function(){window.flippxp.registerSlot("#flipp-div-"+c.id,a.publisherName,a.publisherSiteId,[a.publisherZoneId],{userKey:b,dwellExpandable:true,experienceLimit:1,rootElement:".x-inner"})});this.hasSetupFlippOnArticle=true}},setupFullscreenGallery:function(e){var g=this;if(settings.articlepopover!=null&&settings.articlepopover.enablePopoverImageGallery=="true"){var d=$(g.element.dom).find(".contentImages")[0];if(d!=null){var j=document.createElement("div");j.className="fullscreengalleryicon pointerCursor";d.style.position="relative";d.appendChild(j);var h=g.getArticleImages(d);var a="";var b=$(g.element.dom).find(".contentHead")[0];if(b!=null){a=b.innerText}var f={headline:a,images:h};$(j).click(function(){g.createFullscreenGallery(f)});if(navigator.maxTouchPoints!=null){var c;j.addEventListener("touchstart",function(k){c=k.timeStamp});j.addEventListener("touchend",function(k){if(k.timeStamp-c<200){g.createFullscreenGallery(f)}})}}}},getArticleImages:function(e){var d=this;var g=$(e).find(".contentImage");var a=[];for(var c=0;c<g.length;c++){var f=g[c];var h=$(f).find("img")[0];if(h!=null){var b={url:h.src,caption:f.innerText};a.push(b)}}return a},createFullscreenGallery:function(d){var b=this;var a=[];for(image in d.images){a.push({url:d.images[image].url})}if(Ext.os.is.Desktop){var e="InfinityMobile.view.desktop.ImageGallery"}else{var e="InfinityMobile.view.tablet.ImageGallery"}var c=Ext.create(e,{images:a,article:d,dynamicview:false,zIndex:99999999});Ext.Viewport.add(c);c.show()},setupUrlAdvertContent:function(g){var e=this;var b=settings.reader.popupAdvert;var d="728";var a="90";if(currentProfile=="phone"){d="320";a="50"}if(b!=null&&b.url!=null&&b.position!=null&&g!=null){var c=b.url;e.advertDivID=e.id+"advert";var f=e.returnSection(e.config.page!=null?e.config.page.page:null);var h="edid="+editionguid+"&pubid="+publicationguid+"&pnum=1&w="+d+"&h="+a+"&article=true&elemid="+encodeURIComponent(e.advertDivID)+(!!f&&f.trim()!=""?"&section="+encodeURIComponent(f):"");if(c.indexOf("?")==-1){c+="?"+h}else{c+="&"+h}setTimeout(function(){if(!e.destroyed){var j=$(e.element.dom).find(".advertIframe");if(j[0]!=null){$(j[0]).attr("id",e.advertDivID);$(j[0]).attr("src",c)}}},e.advertTimeout);g=g.replace("articleContentHtml5","articleContentHtml5 articleNoScroll");return g}else{return g}},returnSection:function(a){var e=this;if(a==null){return null}var h=settings.bookmarks.bookmark;var f=null;if(h!=null&&h.length>0){for(var c in h){var b=parseInt(h[c].pageNumber);if(h[c].start!=null){b=h[c].start}var g=h[parseInt(c)+1];var d=null;if(g!=null){d=g.pageNumber;if(g.start!=null){d=g.start}}if(parseInt(a)>=b&&(d==null||parseInt(a)<parseInt(d))){f=h[c].name;break}}}return f},setupDfpAdvertContent:function(c){var b=this;var a=settings.reader.popupAdvert;if(a.networkCode!=null&&a.adUnit){b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"]>","g");c=c.replace(d,"<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:auto;'>")}else{if(a.position!=null&&a.position=="top"){c="<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:auto;'></div>"+c;c=c.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}else{c=c+"<div id='"+b.advertDivID+"' style='width:728px;height:110px;margin:auto;'></div>";c=c.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}}b.on("painted",function(){b.loadAdvert()})}return c},setupDfpAdvertContentMpu:function(c){var b=this;var a=settings.reader.popupAdvertMpu;if(a.networkCode!=null&&a.adUnit){b.networkCodeMpu=a.networkCode;b.adUnitMpu=a.adUnit;b.advertDivIDMpu=b.id+"mpu";if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"]>","g");c=c.replace(d,'<div id="'+b.advertDivIDMpu+"\" class='mpuAdvert' >")}b.on("painted",function(){b.loadAdvert()})}return c},setUpMpuInline:function(){var c=this;var b=$(c.element.dom).find(".contentBody")[0];if(b!=null){var a=settings.reader.popupAdvertMpu;c.networkCodeMpu=a.networkCode;c.adUnitMpu=a.adUnit;c.advertDivIDMpu=c.id+"mpu";b.innerHTML='<div id="'+c.advertDivIDMpu+"\" class='mpuAdvert' ></div>"+b.innerHTML}},setupImageAdvertContent:function(e){var d=this;var b=settings.reader.popupAdvert;d.advertDivID=d.id+"advert";if(b.url!=null){var a="";var c="";if(b.link!=null&&b.link.trim().length>0){a="cursor:pointer;";c="onclick=\"window.open('"+b.link+'\');" ontouchstart="this.start = event.timeStamp" ontouchend="if(event.timeStamp - this.start < 75){window.open(\''+b.link+"');}\"";console.log(c)}if(b.customClass!=null&&b.customClass.trim().length>0){var f=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+b.customClass+"[\\'\\\"]>","g");e=e.replace(f,"<div "+c+" id='"+d.advertDivID+"' style='"+a+'width:728px;height:110px;margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' >")}else{if(b.position!=null&&b.position=="top"){e="<div "+c+" id='"+d.advertDivID+"' style='"+a+"width:728px;height:110px;margin:auto;'></div>"+e;e=e.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}else{e=e+"<div "+c+" id='"+d.advertDivID+"' style='"+a+"width:728px;height:110px;margin:auto;'></div>";e=e.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}}}return e},mediaHuisImgClick:function(){var a=this;if(a.imgUrl!=null){a.content.hide();a.mediaHuis=a.getComponent("mediaHuis");a.mediaHuis.setHtml('<iframe style="height:100%;width:100%;border:none;" src="'+a.imgUrl+'" />');a.mediaHuis.show()}},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var r=this;var k=1;var o=1;var n=r.id;if(currentProfile=="tablet"){var h=$("#"+n+" img").get(0);if(h!=null){if(h.naturalWidth==0){h.onload=function(){var t=this;if(t.naturalWidth<(screen.width/2)){var u=$("#"+n+" .articleContent")[0];u.className="articleContent float"}}}}}if($("#"+n+" .contentImage").size()>1){if(currentProfile=="phone"){if(typeof isTribReader!="undefined"&&isTribReader&&(r.lang&&r.lang=="es")){$("#"+n+" .nextImage")[0].childNodes[0].textContent="ANTERIOR";$("#"+n+" .previousImage")[0].childNodes[0].textContent="SIGUIENTE"}else{$("#"+n+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+n+" .previousImage")[0].childNodes[0].textContent="PREVIOUS"}}else{if(typeof isTribReader!="undefined"&&isTribReader&&(r.lang&&r.lang=="es")){$("#"+n+" .nextImage")[0].childNodes[0].textContent="ANTERIOR IMAGEN";$("#"+n+" .previousImage")[0].childNodes[0].textContent="SIGUIENTE IMAGEN"}}if(currentProfile!="phone"&&language!=null&&language.articlePopover!=null&&language.articlePopover.nextImage!=null&&language.articlePopover.previousImage!=null){$("#"+n+" .nextImage")[0].childNodes[0].textContent=language.articlePopover.nextImage;$("#"+n+" .previousImage")[0].childNodes[0].textContent=language.articlePopover.previousImage}o=$("#"+n+" .contentImage").size();if(o>1){if(settings.reader.galleryMpu!=null&&settings.reader.galleryMpu.type=="dfp"&&settings.reader.galleryMpu.networkCode!=null&&settings.reader.galleryMpu.adUnit!=null){var a=2;var l=settings.reader.galleryMpu;if(l.swipeCount!=null&&!isNaN(l.swipeCount)){a=parseInt(l.swipeCount)}var c=Math.floor(o/a);for(var m=0;m<c;m++){try{var f=document.createElement("div");f.id="pg_advert"+m+r.id;f.style.height="250px";f.className="contentImage galleryAdvert";f.style.display="none";var e=$("#"+n+" .contentImages")[0].childNodes[(a)+(a*m)+(m)];e.parentNode.insertBefore(f,e);var d=l.networkCode;var g=l.adUnit;gptadslots.push(googletag.defineSlot("/"+d+"/"+g,[[300,250]],"pg_advert"+m+r.id).addService(googletag.pubads().updateCorrelator()));if(l.targeting!=null){var p=l.targeting.split("|");for(var j in p){if(p[m].indexOf("*")!=-1){var s=p[j].split("*");googletag.pubads().setTargeting(s[0],s[1])}}}}catch(q){}}}$("#"+n+" .contentImage:gt(0)").hide();$("#"+n+" .previousImage").hide();b()}else{if(o==1){$("#"+n+" .imageControls").hide()}}$("#"+n+" .nextImage").click(function(){var u=$("#"+n+" .contentImage:visible");var t=$("#"+n+" .contentImage:visible").next();u.hide();var v=false;if(t[0].className.indexOf("galleryAdvert")!=-1){googletag.pubads().updateCorrelator();googletag.enableServices();googletag.cmd.push(function(){googletag.display(t[0].id)});$("#"+n+" .imageCount").text("Advertisement");v=true}else{k++}if(!v){b()}t.fadeIn();$("#"+n+" .previousImage").show();if(t.is("#"+n+" .contentImage:last")){$("#"+n+" .nextImage").hide()}});$("#"+n+" .previousImage").click(function(){var u=$("#"+n+" .contentImage:visible");var t=$("#"+n+" .contentImage:visible").prev();u.hide();var v=false;if(t[0].className.indexOf("galleryAdvert")!=-1){googletag.pubads().updateCorrelator();googletag.cmd.push(function(){googletag.display(t[0].id)});$("#"+n+" .imageCount").text("Advertisement");v=true}if(u[0].className.indexOf("galleryAdvert")==-1){k--}if(!v){b()}t.fadeIn();$("#"+n+" .nextImage").show();if(t.is("#"+n+" .contentImage:first")){$("#"+n+" .previousImage").hide()}})}else{$("#"+n+" .imageControls").hide()}function b(){if(typeof isTribReader!="undefined"&&isTribReader&&(r.lang&&r.lang=="es")){var t="Imagen "+k.toString()+" de "+o.toString()}else{var t="Image "+k.toString()+" of "+o.toString()}if(language!=null&&language.image!=null&&language.of!=null){var t=language.image+" "+k.toString()+" "+language.of+" "+o.toString()}$("#"+n+" .imageCount").text(t)}},intializeForIframe:function(){var a=this;if(a.getPage()!=null){if(a.getPage().file==a.getPage().guid){a.popoverType="guid"}a.articleguid=a.getPage().file}a.on("painted",a.getIframeContent,a,{delay:10,single:true})},getIframeContent:function(){var d=this;var a=d.articleguid;d.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");var c="../article_popover_for_iframe.aspx?guid="+a+"&html5="+currentProfile;if(d.popoverType=="guid"){d.content.element.dom.style.overflowY="";c="../article_popover_for_iframe.aspx?guid="+a+"&html5="+currentProfile}d.content.setHtml('<iframe style="border:none;width:100%;height:100%;" class="iframePopover" src="'+c+'" />');var b=$(d.content.element.dom).find(".iframePopover")[0];b.onload=function(){d.removeSpinner();if(b.contentWindow.SetPlatformType!=null){b.contentWindow.SetPlatformType("web")}}},destroy:function(){var a=this;a.destroyed=true;Ext.Container.prototype.destroy.apply(this,arguments)},setFrame:function(){var a=this;a.mode=="frame";a.setIframeContent()},toggleToTextMode:function(){var a=this;if(a.mode=="html"){if(a.painted){a.setIframeContent()}a.setActiveItem(a.contentIframe);a.mode="frame"}else{if(a.parent.getActiveItem()==a){a.loadAdvertMpu()}a.setActiveItem(a.content);a.mode="html"}},setIframeContent:function(){var k=this;if(k.contentIframe.getHtml()==null){k.contentIframe.setHtml("<iframe class=\"articleiframe\" style='width:100%; height:100%; border:none; -ms-user-select:text; user-select:text;'></iframe>");var f=k.contentIframe.element.down("iframe").dom;var m="phoneArticle";if(currentProfile=="tablet"){m="tabletArticle"}console.log(k.content);var c="<div class='"+m+"'>"+k.content.element.dom.innerHTML+'</div><script>setImages("'+currentProfile+'");<\/script>';var j=settings.reader.popupAdvert;if(j!=null&&j.url!=null&&j.position!=null){var d="728";var n="90";if(currentProfile=="phone"){d="320";n="50"}var b=j.url;var a="edid="+editionguid+"&pubid="+publicationguid+"&pnum=1&w="+d+"&h="+n+"&article=true";if(b.indexOf("?")==-1){b+="?"+a}else{b+="&"+a}setTimeout(function(){if(!k.destroyed){var o=$(k.iframe.document).find(".advertIframe");if(o[0]!=null&&(o[0].src==null||o[0].src=="")){$(o[0]).attr("src",b)}}},k.advertTimeout)}var l="<script>cols[i].style.fontSize = font35Size;<\/script>";var h="<style>body { margin:0 } p { margin:0; padding:0; } .articleContentHtml5 { padding: 0 25px; height: 100% !important; font-size:"+fontEm+"px } .imageControls{ display:none !important; } .contentImage { display:block !important; }</style><script>function setText() {}<\/script><script>function updateText(fontsize) { document.getElementsByClassName('articleContentHtml5')[0].style.fontSize = fontsize + 'px' }<\/script>";var g="<html><head>{{HEAD}}</head><body>{{BODY}}</body></html>";var e="<link rel='stylesheet' type='text/css' href='resources/css/article.css'><\/script><script src=\"resources/js/articleGallery.js\"><\/script>"+h;g=g.replace("{{HEAD}}",e);g=g.replace("{{BODY}}",c);k.iframe=f.contentWindow?f.contentWindow:(f.contentDocument.document?f.contentDocument.document:f.contentDocument);g=k.checkIframeAdvert(g);console.log(k.content.getHtml());k.iframe.document.write(g);if(k.parent.getActiveItem()==k){k.loadIframeAdvertMpu()}}},checkIframeAdvert:function(c){var b=this;var a=c;if(typeof settings!="undefined"&&settings.reader!=null){if(settings.reader.popupAdvert!=null){a=b.setupIframeAdvert(settings.reader.popupAdvert,a)}if(settings.reader.popupAdvertMpu!=null){a=b.setupIframeMpuAdvert(settings.reader.popupAdvertMpu,a)}return a}},setupIframeMpuAdvert:function(c,a){var b=this;switch(c.type){case"dfp":return b.setupDfpIframeMpuAdvert(c,a);break;default:return a;break}},setupIframeAdvert:function(b,c){var a=this;switch(b.type){case"dfp":return a.setupDfpIframeAdvert(b,c);break;default:return c}},setupDfpIframeMpuAdvert:function(f,c){var e=this;if(c!=null){var g=c;e.advertIframeDivIDMpu=e.advertDivIDMpu+"-iframe";g=g.replace(e.advertDivIDMpu,e.advertIframeDivIDMpu);var b="";if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.targeting!=null&&settings.reader.popupAdvertMpu.targeting.length>0){b="var targets = '"+settings.reader.popupAdvertMpu.targeting+'\'.split("|");for (var i in targets) {var thisTarget = targets[i];var values = thisTarget.split("*");if (values != null && values.length >= 2) {values[1] = values[1].replace("{{PAGE}", \''+e.page.page+"').replace(\"{{SECTION}}\", '"+e.section+"');adSlot1.setTargeting(values[0], values[1]);}}"}var d="";var a=e.returnGoogletagString();if(g.indexOf(a)==-1){d=a}g=d+"<script>window.loadAdvertMpu = function(){\ngoogletag.cmd.push(function () {\nvar adSlot1 = googletag.defineSlot('/"+e.networkCodeMpu+"/"+e.adUnitMpu+"', [parseInt('300'), parseInt('250')],'"+e.advertIframeDivIDMpu+"');\nadSlot1.addService(googletag.pubads().updateCorrelator());"+b+"googletag.enableServices();\n});\ngoogletag.cmd.push(function () {\ngoogletag.display('"+e.advertIframeDivIDMpu+"');\n});\n} <\/script>"+g;return g}},setupDfpIframeAdvert:function(d,e){var c=this;var a=e;if(a!=null){var f=a;c.advertIframeDivId=c.advertDivID+"-iframe";f=f.replace(c.advertDivID,c.advertIframeDivId);var b="";if(settings.reader.popupAdvert!=null&&settings.reader.popupAdvert.targeting!=null&&settings.reader.popupAdvert.targeting.length>0){b="var targets = '"+settings.reader.popupAdvert.targeting+'\'.split("|");for (var i in targets) {var thisTarget = targets[i];var values = thisTarget.split("*");if (values != null && values.length >= 2) {values[1] = values[1].replace("{{PAGE}", \''+c.page.page+"').replace(\"{{SECTION}}\", '"+c.section+"');adSlot1.setTargeting(values[0], values[1]);}}"}f=c.returnGoogletagString()+"<script>window.loadAdvert = function(){\ngoogletag.cmd.push(function () {\nvar adSlot1 = googletag.defineSlot('/"+c.networkCode+"/"+c.adUnit+"', [parseInt('728'), parseInt('90')],'"+c.advertIframeDivId+"');\nadSlot1.addService(googletag.pubads().updateCorrelator());"+b+"googletag.enableServices();\n});\ngoogletag.cmd.push(function () {\ngoogletag.display('"+c.advertIframeDivId+"');\n});\n} <\/script>"+f;return f}},returnGoogletagString:function(){return'<script>var googletag = googletag || {};googletag.cmd = googletag.cmd || [];(function () {var gads = document.createElement("script");gads.async = true; gads.type = "text/javascript"; var useSSL = "https:" == document.location.protocol;gads.src = (useSSL ? "https:" : "http:") + "//www.googletagservices.com/tag/js/gpt.js"; var node = document.getElementsByTagName("script")[0];node.parentNode.insertBefore(gads, node);})();<\/script >'},loadIframeAdvertMpu:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvertMpu!=null){switch(settings.reader.popupAdvertMpu.type){case"dfp":a.loadIframeDfpAdvertMpu();break}}},loadIframeAdvert:function(){var a=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.popupAdvert!=null){switch(settings.reader.popupAdvert.type){case"dfp":a.loadIframeDfpAdvert();break}}},loadIframeDfpAdvertMpu:function(){var a=this;setTimeout(function(){if(!a.destroyed){if(a.iframe!=null&&a.iframe.loadAdvertMpu!=null){a.iframe.loadAdvertMpu()}}},a.advertTimeout)},loadIframeDfpAdvert:function(){var a=this;setTimeout(function(){if(!a.destroyed){if(a.iframe!=null&&a.iframe.loadAdvert!=null){a.iframe.loadAdvert()}}},a.advertTimeout)},translateArticle:function(b){var a=this;if(a.getPage()!=null){if(a.getPage().file==a.getPage().guid){a.popoverType="guid"}a.articleguid=a.getPage().file}a.language=b;a.getContentLang()},getContentLang:function(){var c=this;var a=c.articleguid;c.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");var b="http://edition.pagesuite.com/tribune/article_popover_phil.aspx?guid="+a+"&html5="+currentProfile+"&lang=es";if(c.popoverType=="guid"){c.content.element.dom.style.overflowY="";b="http://edition.pagesuite.com/tribune/article_popover_phil.aspx?guid="+a+"&html5="+currentProfile+"&lang=es"}$.ajax({crossDomain:true,type:"GET",contentType:"text/html",async:true,url:b,success:function(h){var j=Ext.getStore("SettingStore");if(j.data.items[0].raw.reader.popupAdvert!=null){var k=j.data.items[0].raw.reader.popupAdvert.position;if(k=="top"){switch(currentProfile){case"phone":var l=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var l=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var l=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break}c.add(l);l.show()}}var n=h;var e=n.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(e){n=e[1]}c.articleText=n;n+="<script>setText()<\/script>";c.removeSpinner();c.content.setHtml(n);c.content.setPadding("0px");c.setImages();if(c.content.element!=null){setText(c.content.element.dom)}c.setStyle({visibility:"inherit"});if(j.data.items[0].raw.reader.popupAdvert!=null){if(k=="bottom"){switch(currentProfile){case"phone":var g=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{padding:"10px 0 0 0"});break}c.add(g);g.show()}}if($(c.element.dom).find(".DS-storyimage__link")!=null){if($(c.element.dom).find(".DS-storyimage__link")[0]!=null){var o=$(c.element.dom).find(".DS-storyimage__link")[0];var f=$(o).find("img")[0];var p=o.parentElement;c.imgUrl=$(o).attr("href");o.remove();p.appendChild(f);$(f).addClass("pointerCursor");f.onclick=function(){c.mediaHuisImgClick()}}}if(typeof isTribReader!="undefined"){if(isTribReader){var d=$(c.element.dom).find(".articleContentHtml5");if(d.length>0){$(d[0]).css("padding-right","25px");$(d[0]).css("padding-left","25px")}}}c.content.element.on({scope:c.content,delegate:"a",tap:function(m){if(!Ext.os.is.Desktop){window.location.href=m.target}}})}})}},0,["readerarticlepopoveritem"],["component","container","readerarticlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true},["widget.readerarticlepopoveritem"],0,[InfinityMobile.view.desktop,"ReaderArticlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArticlePopoverItem",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",article:null,cls:"loading",style:"background-color:white",layout:"vbox",items:[{itemId:"content",flex:1,scrollable:{direction:"vertical",directionLock:true}}]},initialize:function(){var b=this;b.destroyed=false;b.advertTimeout=2000;b.content=b.getComponent("content");b.setContentStyle();b.popoverType="article";b.mode="html";if(b.config.highlightMode!=null&&b.config.highlightMode==true){b.mode="frame";b.contentCard.setActiveItem(b.contentIframe)}if(InfinityMobile.app.getController("MediaController").currentLang){b.lang=InfinityMobile.app.getController("MediaController").currentLang}if(settings.reader.iframePopover!=null&&settings.reader.iframePopover=="true"){b.intializeForIframe()}else{if(b.getArticle()!=null){b.article=b.getArticle();if(settings.newsday!=null&&settings.newsday.useNewsdayTemplate!=null&&settings.newsday.useNewsdayTemplate=="true"){var a=true;b.initializeInlineNewsday()}else{var a=false;b.initializeInline()}}else{b.initializeForWeb()}}},initializeInlineNewsday:function(){var v=this;var a="<div class='container'><div><div class='textcontent'><{{LABEL}}><div class='contenthead font35'><{{HEAD}}></div><{{HEADDECK}}><div class='articleContent'><{{IMAGE}}><div class='bylineContainer' style='margin-bottom:15px;min-height:25px;'><{{BYLINE}}><div class='bylinecontainer' ><{{TEXTCONTROLS}}></div><hr /><div class='contentbody'><{{REVIEWBOX}}><div class=\"pcontent\" style='position:relative;' ><{{MPU}}><{{BODY}}></div><{{NEWSBOX}}></div><{{BANNERAD}}></div></div></div></div>";if(v.article.label!=null){a=a.replace("<{{LABEL}}>",'<div class="label" >'+v.article.label+"</div>")}else{a=a.replace("<{{LABEL}}>","")}a=a.replace("<{{HEAD}}>",v.article.headline);a=a.replace("<{{HEADDECK}}>",'<div class="contentdeck font25">'+v.article.subHeadline+"</div>");a=v.newsdayByline(a);if(v.article.reviewBox.trim().length>0){a=a.replace("<{{REVIEWBOX}}>","<div class='reviewbox' >"+v.article.reviewBox+"</div>")}else{a=a.replace("<{{REVIEWBOX}}>","")}a=a.replace("<{{BODY}}>",v.article.body);if(v.article.newsBox.trim().length>0){a=a.replace("<{{NEWSBOX}}>","<div class='newsbox' >"+v.article.newsBox+"</div>")}else{a=a.replace("<{{NEWSBOX}}>","")}a=a.replace("<{{TEXTCONTROLS}}>",'<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="resources/images/increase-text-size_newsday.png" ontouchstart="increaseTextNewsday()" onclick="increaseTextNewsday()">&nbsp;&nbsp;<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="resources/images/decrease-text-size_newsday.png" ontouchstart="decreaseTextNewsday()" onclick="decreaseTextNewsday()"></div>');var u=settings.newsday.articleCubeAd;if(u!=null&&currentProfile!="phone"){if(u.networkCode!=null&&u.adUnit!=null){v.networkCodeMpu=u.networkCode;v.adUnitMpu=u.adUnit;v.advertDivIDMpu=v.id+"mpu";var c="mpuAdvert";if(currentProfile=="phone"){c="mpuPhone"}a=a.replace("<{{MPU}}>",'<div id="'+v.advertDivIDMpu+'" class="'+c+'" ></div>')}}else{a=a.replace("<{{MPU}}>","")}var q=settings.newsday.articleBannderAd;if(q!=null){if(q.networkCode!=null&&q.adUnit!=null){v.networkCode=q.networkCode;v.adUnit=q.adUnit;v.advertDivID=v.id+"advert";var l=728;var r=110;if(currentProfile=="phone"){l=320;r=70}a=a.replace("<{{BANNERAD}}>","<div id='"+v.advertDivID+"' style='width:"+l+"px;height:"+r+"px;margin:auto;'></div>")}}else{a=a.replace("<{{BANNERAD}}>","")}var s=v.initializeInlineImagesNewsday();a=a.replace("<{{IMAGE}}>",s);v.content.setHtml(a);var u=settings.newsday.articleCubeAd;if(u!=null&&currentProfile=="phone"){if(u.networkCode!=null&&u.adUnit!=null){v.networkCodeMpu=u.networkCode;v.adUnitMpu=u.adUnit;v.advertDivIDMpu=v.id+"mpu";var c="mpuPhone";var b=$(v.content.element.dom).find(".pcontent")[0];var k=b.getElementsByTagName("p");if(k.length>0){var j=b;var n=document.createElement("div");n.id=v.advertDivIDMpu;n.className=c;var g;if(k.length>4){g=k[3];j.insertBefore(n,g)}else{g=k[k.length-1];j.appendChild(n)}}}}var t=$(v.content.element.dom).find(".x-scroll-scroller")[0];if(t!=null){$(t).addClass("customscroller")}if(currentProfile=="phone"){var o=$(v.element.dom).find(".bylineContainer")[0];$(o).css("margin-bottom","");var f=$(v.element.dom).find(".bylineContainerNewsday")[0];$(f).removeClass("bylineContainerNewsday")}v.removeSpinner();v.on("painted",function(){v.setImages();if(Ext.os.is.Android){v.fireEvent("fillPrintContainer",v)}},v,{});v.hasVideo=false;v.hasLink=false;v.hasGallery=false;var x=$(v.element.dom).find(".articleImg")[0];if(x!=null){var m=$(v.element.dom).find(".galleryicon")[0];$(m).css("visibility","visible");$(m).click(function(){v.viewGallery()});m.addEventListener("touchstart",function(){v.viewGallery()});if(v.article.media!=null){if(v.article.media.length>0){for(var p in v.article.media){if(v.article.media[p].type=="OVIDEO"){var e=$(v.element.dom).find(".articlevideoicon")[0];$(e).css("display","inline");v.oVideo=v.article.media[p];if(!v.hasVideo){$(e).click(function(){v.viewOVideo(v.oVideo)});e.addEventListener("touchstart",function(){v.viewOVideo(v.oVideo)})}v.hasVideo=true}if(v.article.media[p].type=="OLINK"){var d=$(v.element.dom).find(".linkicon")[0];$(d).css("display","inline");v.oLink=v.article.media[p].url;if(!v.hasLink){$(d).click(function(){v.openOLink(v.oLink)});d.addEventListener("touchstart",function(){v.openOLink(v.oLink)});v.hasLink=true}}if(v.article.media[p].type=="OGALLERY"){var d=$(v.element.dom).find(".ogalleryicon")[0];$(d).css("display","inline");v.oGallery=v.article.media[p];if(!v.hasGallery){$(d).click(function(){v.openOGallery(v.oGallery)});d.addEventListener("touchstart",function(){v.openOGallery(v.oGallery)});v.hasGallery=true}}}}}}setNewsdayText(v.content.element.dom);v.content.element.on({scope:v.content,delegate:"a",tap:function(w){var h=$(w.target).attr("href");if(!h.startsWith("http://")&&!h.startsWith("https://")&&!h.startsWith("mailto:")&&!h.startsWith("tel:")){h="http://"+h}window.location.href=h}})},newsdayByline:function(c){var d=this;var e="";if(d.article.byline.length>0){e="<div class=\"contentbyline font15\">By <span class='bylinespan'>"+d.article.byline+"</span>";if(d.validateEmail(d.article.reporterEmail)){e=e.replace("<span class='bylinespan'>","<span class='bylinespan pointerCursor' ontouchstart='window.location.href = \"mailto:"+d.article.reporterEmail+"?subject="+encodeURIComponent(d.article.headline)+"\";' onclick='window.location.href = \"mailto:"+d.article.reporterEmail+"?subject="+encodeURIComponent(d.article.headline)+"\";'>")}else{e=e.replace("<span class='bylinespan'>","<span>")}if(d.article.reporters!=null){for(var b in d.article.reporters){var a="";if(b==d.article.reporters.length-1){a+=" and <span class='bylinespan'>"+d.article.reporters[b].name+"<span>"}else{a+=", <span class='bylinespan'>"+d.article.reporters[b].name+"<span>"}if(d.validateEmail(d.article.reporters[b].email)){a=a.replace("<span class='bylinespan'>","<span class='bylinespan pointerCursor' ontouchstart='window.location.href = \"mailto:"+d.article.reporters[b].email+"?subject="+encodeURIComponent(d.article.headline)+"\";' onclick='window.location.href = \"mailto:"+d.article.reporters[b].email+"?subject="+encodeURIComponent(d.article.headline)+"\";'>")}else{a=a.replace("<span class='bylinespan'>","<span>")}e+=a}}e+="</div>"}c=c.replace("<{{BYLINE}}>",e);return c},validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},viewGallery:function(){var a=this;a.fireEvent("galleryClickFromArticle",a,a.article.images,a.article)},viewOVideo:function(c){var b=this;var a=c.url;if(a.indexOf("http://")==-1){a="http://"+a}b.fireEvent("ovideoclicked",b,a)},openOLink:function(a){var b=this;window.open(a);b.fireEvent("trackOLink",b,a,b.article)},openOGallery:function(a){var b=this;b.fireEvent("galleryClick",b,a.url)},loadAdvert:function(){var a=this;setTimeout(function(){if(!a.destroyed){var b=728;var c=90;if(currentProfile=="phone"){b=320;c=50}googletag.cmd.push(function(){var d=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[b,c],a.advertDivID);d.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})}},a.advertTimeout)},loadAdvertMpu:function(){var a=this;setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCodeMpu+"/"+a.adUnitMpu,[parseInt("300"),parseInt("250")],a.advertDivIDMpu);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivIDMpu)})}},a.advertTimeout)},initializeInline:function(){var b=this;var c="<div class='container'><div class='content'><div class='articleContent'><div class='contentHead font35'><{{HEAD}}></div><{{HEADDECK}}><{{IMAGE}}><br /><{{BYLINE}}><br /><div class='contentBody font15'><{{BODY}}></div></div></div></div>";c=c.replace("<{{HEAD}}>",b.article.headline);c=c.replace("<{{HEADDECK}}>",'<div class="contentDeck font25">'+b.article.subHeadline+"</div>");c=c.replace("<{{BYLINE}}>",'<div class="contentByline font15">'+b.article.byline+"</div>");c=c.replace("<{{BODY}}>",b.article.body);var a=b.initializeInlineImages();c=c.replace("<{{IMAGE}}>",a);b.content.setHtml(c);b.removeSpinner();b.on("painted",function(){b.setImages();if(Ext.os.is.Android){b.fireEvent("fillPrintContainer",b)}},b,{});b.on("painted",function(){var d=$(b.element.dom).find(".fullscreengalleryicon");if(d!=null&&d.length>0){$(d).click(function(){b.createFullscreenGallery(b.article)});d[0].addEventListener("touchstart",function(){b.createFullscreenGallery(b.article)})}})},createFullscreenGallery:function(d){var b=this;var a=[];for(image in d.images){a.push({url:d.images[image].url})}if(Ext.os.is.Desktop){var e="InfinityMobile.view.desktop.ImageGallery"}else{var e="InfinityMobile.view.tablet.ImageGallery"}var c=Ext.create(e,{images:a,article:d,dynamicview:false,zIndex:99999999});Ext.Viewport.add(c);c.show()},speak:function(c,d){var b=this;var a=new SpeechSynthesisUtterance();c=c.replace("'","\u2019");a.text=c;a.voice=speechSynthesis.getVoices()[0];a.lang="en-US";a.rate=1;a.pitch=1;a.onend=function(){if(d){b.callback()}};a.onerror=function(f){if(d){b.callback(f)}};speechSynthesis.speak(a)},callback:function(a){var b=this;if(a){console.log(a)}else{console.log("endspeech")}},getArticleTemplate:function(){var a=this;var b=a.getPage();if(b.guid!=null){$.ajax({url:"http://edition.pagesuite.com/popovers/dynamic_article_popover.aspx?source=html5&guid="+b.guid,success:function(c){a.removeSpinner();a.content.setHtml(c.body);$(".clContent_Header",a.content.element.dom).remove().html();$(".clContent_Footer",a.content.element.dom).remove().html();$(".clContent_Body",a.content.element.dom).css("top","0px");$(".clContent_Body",a.content.element.dom).css("bottom","0px");$(".clContent_Body",a.content.element.dom).css("padding","0px 5px");$(".clContent_Body_Headline ",a.content.element.dom).addClass("font35");$(".clContent_Body_SubHeadline ",a.content.element.dom).addClass("font25");$(".clContent_Body_Byline ",a.content.element.dom).addClass("font15");$(".clContent_Body_Body  ",a.content.element.dom).addClass("font13");$(".clContent",a.content.element.dom).css("overflow","visible");$(".clContent_Body",a.content.element.dom).css("overflow","visible");$(".clContent_Body",a.content.element.dom).css("position","relative");if($(".contentImages",a.content.element.dom).length>0){$("img",a.content.element.dom).load(function(){setText(a.content.element.dom)});a.setUpImageControls()}else{setText(a.content.element.dom)}}})}},setContentHeight:function(){var b=this;if(b.content.element!=null){var a=$(".clContent_Body_Headline ",b.content.element.dom).height()+$(".clContent_Body_SubHeadline ",b.content.element.dom).height()+$(".clContent_Body_Byline ",b.content.element.dom).height()+$(".contentImages",b.content.element.dom).height()+$(".clContent_Body_Body  ",b.content.element.dom).height();if($(".contentImages",b.content.element.dom).length>0){a+=100}$(".clContent",b.content.element.dom).css("height",a+"px")}},setUpImageControls:function(){var c=this;var a=$(".clRightArrow",c.content.element.dom);var g=$(".clRightArrowText",c.content.element.dom);var f=$(".clLeftArrow",c.content.element.dom);var b=$(".clLeftArrowText",c.content.element.dom);var d=function(){var j=$(".contentImage",c.content.element.dom).length;var k=0;for(var h=0;h<j;h++){if($(".contentImage",c.content.element.dom)[h].style.display=="block"){k=h;break}}if(k+1<j){$(".contentImage",c.content.element.dom)[k].style.display="none";$(".contentImage",c.content.element.dom)[k+1].style.display="block"}};var e=function(){var j=$(".contentImage",c.content.element.dom).length;var k=0;for(var h=0;h<j;h++){if($(".contentImage",c.content.element.dom)[h].style.display=="block"){k=h;break}}if(k-1>=0){$(".contentImage",c.content.element.dom)[k].style.display="none";$(".contentImage",c.content.element.dom)[k-1].style.display="block"}};$(".contentImage",c.content.element.dom).css("transition","all ease 0.5s");a[0].addEventListener("touchstart",d);g[0].addEventListener("touchstart",d);f[0].addEventListener("touchstart",e);b[0].addEventListener("touchstart",e)},initializeInlineImagesNewsday:function(){var d=this;var g=d.article.images;var a="";if(g.length>0){var b="<div class=\"contentImage imagecontainerblack\"><div class=\"imageandiconscontainer\"><div class=\"iconscontainer\" ><div class='articlevideoicon pointerCursor'></div><div class='linkicon pointerCursor' ></div><div class='ogalleryicon pointerCursor' ></div><div class='galleryicon pointerCursor' ></div></div><img class='articleImg' src=\"{{imageurl}}\" alt=\"\" /></div>{{imagecaption}}</div>";var c="";var e=g[0];var f="";if(e.credit!=null){if(e.credit.trim().length>0){f=" ("+e.credit+")"}}c+=b.replace("{{imageurl}}",e.url).replace("{{imagecaption}}",'<div class="contentcaption captionlineheight font13">'+e.caption+f+"</div>");a=c}return a},initializeInlineImages:function(){var g=this;var h=g.article.images;var j="";if(h.length>0){var d="<div class=\"contentImages\" style='position:relative;'><div style='position:absolute;top:0px;right:0px;z-index:1;'><div class='fullscreengalleryicon pointerCursor' ></div></div>{{imagescontent}}</div>";var e='<div class="contentImage"><img src="{{imageurl}}" alt="" />{{imagecaption}}</div>';var a="";for(var f=0;f<h.length;f++){var b=h[f];a+=e.replace("{{imageurl}}",b.url).replace("{{imagecaption}}",'<div class="contentCaption font13">'+b.caption+"</div>")}var c='<div class="imageControls"><a href="javascript:void(0)" class="previousImage">PREVIOUS IMAGE<img class="imgPreviousImage" src="https://edition.pagesuite.com/tribune/left-image-arrow.png" alt="" /></a><div class="imageCount">Image</div><a href="javascript:void(0)" class="nextImage">NEXT IMAGE<img class="imgNextImage" src="https://edition.pagesuite.com/tribune/right-image-arrow.png" alt="" /></a></div>';a+=c;j=d.replace("{{imagescontent}}",a)}return j},checkLanguage:function(){var e=this;var a=navigator.language.substring(0,2);try{var d=localStorage.getItem("checkLanguage"+publicationguid)}catch(c){var d=null}if(d==null){if(settings.reader.language!="en"){e.sourceLanguage="en";e.targetLanguage=settings.reader.language;return false}}else{if(d!="false"){var b=d;if(b!=settings.reader.language){e.sourceLanguage=settings.reader.language;e.targetLanguage=b;return false}}else{if(settings.reader.language!="en"){e.sourceLanguage="en";e.targetLanguage=settings.reader.language;return false}}}return true},initializeLanguage:function(){var a=this;a.on("painted",a.getLanguageContent,a,{delay:10,single:true})},getLanguageContent:function(){var a=this},initializeForWeb:function(){var a=this;if(a.getPage()!=null){if(a.getPage().file==a.getPage().guid){a.popoverType="guid"}a.articleguid=a.getPage().file}a.on("painted",a.getContent,a,{delay:10,single:true})},setContentStyle:function(){var a=this;if(currentProfile=="tablet"){}},getContent:function(){var c=this;var a=c.articleguid;c.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");if((typeof isTribReader!="undefined"&&isTribReader==true)&&(c.lang=="es"||c.lang=="en")){var d="&lang="+c.lang}else{var d=""}var b="../article_popover.aspx?articleguid="+a+"&html5="+currentProfile+d;if(c.popoverType=="guid"){b="../article_popover.aspx?guid="+a+"&html5="+currentProfile+d}$.ajax({crossDomain:true,type:"GET",contentType:"text/html",async:true,url:b,success:function(l){var h=Ext.getStore("SettingStore");var g=l;var f=g.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(f){g=f[1]}g+="<script>setText()<\/script>";if(settings.reader.popupAdvert!=null){var e=settings.reader.popupAdvert;switch(e.type.toLowerCase()){case"dfp":g=c.setupDfpAdvertContent(g);break;case"image":g=c.setupImageAdvertContent(g);break}}if(settings.reader.popupAdvertMpu!=null&&settings.reader.popupAdvertMpu.customClass!=null){var j=settings.reader.popupAdvertMpu;switch(j.type.toLowerCase()){case"dfp":g=c.setupDfpAdvertContentMpu(g);break}}g=g.replace(/http:\/\/digitaledition.courant.com/g,"https://edition.pagesuite.com");c.removeSpinner();c.unmask();c.content.setHtml(g);if(c.mode=="frame"){c.setFrame()}if(settings.reader.popupAdvert!=null){c.loadAdvert()}if(settings.reader.popupAdvertMpu!=null){if(settings.reader.popupAdvertMpu.customClass==null){switch(j.type.toLowerCase()){case"dfp":c.setUpMpuInline();break}}c.loadAdvertMpu()}c.setImages();if(c.element!=null){c.printImage=c.element.down(".printImage")}if(c.content.element!=null){setText(c.content.element.dom)}c.setStyle({visibility:"inherit"});if(Ext.os.is.Android){c.fireEvent("fillPrintContainer",c)}if(c.xtype=="readerpuzzlepopoveritem"){if(Ext.browser.is.IE){var k=$(c.content.element.dom).find(".contentImage")[0];if(k!=null){var n=$(k).find("img")[0];if(n!=null){n.onload=function(){var m=$(n).height();var o=$(c.content.element.dom).find(".x-innerhtml")[0];if(o!=null){o.style.height=m+"px"}}}}}}c.content.element.on({scope:c.content,delegate:"a",tap:function(m){if(!Ext.os.is.Desktop){window.location.href=m.target}}})}})},setupDfpAdvertContent:function(d){var c=this;var b="width:728px;height:110px;";switch(currentProfile){case"phone":b="width:320px;height:70px;";break;default:b="width:728px;height:110px;";break}var a=settings.reader.popupAdvert;if(a.networkCode!=null&&a.adUnit){c.networkCode=a.networkCode;c.adUnit=a.adUnit;c.advertDivID=c.id+"advert";if(a.customClass!=null&&a.customClass.trim().length>0){var e=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"]>","g");d=d.replace(e,"<div id='"+c.advertDivID+"' style='"+b+"margin:auto;'>")}else{if(a.position!=null&&a.position=="top"){d="<div id='"+c.advertDivID+"' style='"+b+"margin:auto;'></div>"+d;d=d.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}else{d=d+"<div id='"+c.advertDivID+"' style='"+b+"margin:auto;'></div>";d=d.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}}}return d},setupDfpAdvertContentMpu:function(c){var b=this;var a=settings.reader.popupAdvertMpu;if(a.networkCode!=null&&a.adUnit){b.networkCodeMpu=a.networkCode;b.adUnitMpu=a.adUnit;b.advertDivIDMpu=b.id+"mpu";if(a.customClass!=null&&a.customClass.trim().length>0){var d=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+a.customClass+"[\\'\\\"]>","g");c=c.replace(d,'<div id="'+b.advertDivIDMpu+'" style="float:none;margin:auto;" class=\'mpuAdvert\' >')}b.on("painted",function(){b.loadAdvert()})}return c},setUpMpuInline:function(){var c=this;var b=$(c.element.dom).find(".contentBody")[0];if(b!=null){var a=settings.reader.popupAdvertMpu;c.networkCodeMpu=a.networkCode;c.adUnitMpu=a.adUnit;c.advertDivIDMpu=c.id+"mpu";b.innerHTML='<div id="'+c.advertDivIDMpu+"\" class='mpuAdvert' ></div>"+b.innerHTML}},setupImageAdvertContent:function(f){var e=this;var b=settings.reader.popupAdvert;e.advertDivID=e.id+"advert";var d="width:728px;height:110px;";switch(currentProfile){case"phone":d="width:320px;height:70px;";break;default:d="width:728px;height:110px;";break}if(b.url!=null){var a="";var c="";if(b.link!=null&&b.link.trim().length>0){a="cursor:pointer;";c="onclick=\"window.open('"+b.link+'\');" ontouchstart="this.start = event.timeStamp" ontouchend="if(event.timeStamp - this.start < 75){window.open(\''+b.link+"');}\""}if(b.customClass!=null&&b.customClass.trim().length>0){var g=new RegExp("<div[\\sa-zA-Z0-9\\'\\\"=\\-\\_]*class=[\\'\\\"]"+b.customClass+"[\\'\\\"]>","g");f=f.replace(g,"<div "+c+" id='"+e.advertDivID+"' style='"+a+d+'margin:auto;background-image:url("'+b.url+"\");background-size:contain;background-position:center;background-repeat:no-repeat;' >")}else{if(b.position!=null&&b.position=="top"){f="<div "+c+" id='"+e.advertDivID+"' style='"+a+d+";margin:auto;'></div>"+f;f=f.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}else{f=f+"<div "+c+" id='"+e.advertDivID+"' style='"+a+d+"margin:auto;'></div>";f=f.replace("articleContentHtml5","articleContentHtml5 articleNoScroll")}}}return f},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var g=this;var d=1;var c=1;var b=g.id;if(currentProfile=="tablet"){var f=$("#"+b+" img").get(0);if(f!=null){h(f)}}if($("#"+b+" .contentImage").size()>1){if(currentProfile=="phone"){if((typeof isTribReader!="undefined"&&isTribReader==true)&&(g.lang&&g.lang=="es")){$("#"+b+" .nextImage")[0].childNodes[0].textContent="ANTERIOR";$("#"+b+" .previousImage")[0].childNodes[0].textContent="SIGUIENTE"}else{$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREVIOUS"}}else{if((typeof isTribReader!="undefined"&&isTribReader==true)&&(g.lang&&g.lang=="es")){$("#"+b+" .nextImage")[0].childNodes[0].textContent="ANTERIOR IMAGEN";$("#"+b+" .previousImage")[0].childNodes[0].textContent="SIGUIENTE IMAGEN"}}c=$("#"+b+" .contentImage").size();if(c>1){$("#"+b+" .contentImage:gt(0)").hide();$("#"+b+" .previousImage").hide();a()}else{if(c==1){$("#"+b+" .imageControls").hide()}}$("#"+b+" .nextImage").on("click touchstart",function(){var l=$("#"+b+" .contentImage:visible");var j=$("#"+b+" .contentImage:visible").next();var k=$(j[0]).find("img:first").get(0);e(k);l.hide();d++;a();j.fadeIn();$("#"+b+" .previousImage").show();if(j.is("#"+b+" .contentImage:last")){$("#"+b+" .nextImage").hide()}});$("#"+b+" .previousImage").on("click touchstart",function(){var l=$("#"+b+" .contentImage:visible");var j=$("#"+b+" .contentImage:visible").prev();var k=$(j[0]).find("img:first").get(0);e(k);l.hide();d--;a();j.fadeIn();$("#"+b+" .nextImage").show();if(j.is("#"+b+" .contentImage:first")){$("#"+b+" .previousImage").hide()}})}else{$("#"+b+" .imageControls").hide()}function a(){if((typeof isTribReader!="undefined"&&isTribReader==true)&&(g.lang&&g.lang=="es")){var j="Imagen "+d.toString()+" de "+c.toString()}else{var j="Image "+d.toString()+" of "+c.toString();$("#"+b+" .imageCount").text(j)}}function h(k){if(k.naturalWidth==0){k.onload=function(){var l=this;if(l.naturalWidth<(screen.width/2)){var m=$("#"+b+" .articleContent")[0];m.className="articleContent float";if(l.naturalWidth>200){if($("#"+b+" .nextImage")[0]!=null){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT"}if($("#"+b+" .previousImage")[0]!=null){$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREV"}}else{if($("#"+b+" .nextImage")[0]!=null){$("#"+b+" .nextImage")[0].childNodes[0].textContent=""}if($("#"+b+" .previousImage")[0]!=null){$("#"+b+" .previousImage")[0].childNodes[0].textContent=""}}l.parentNode.style.width=Math.max(l.naturalWidth,250)+"px"}}}else{if(k.naturalWidth<(screen.width/2)){var j=$("#"+b+" .articleContent")[0];j.className="articleContent float";if(k.naturalWidth>200){if($("#"+b+" .nextImage")[0]!=null){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT"}if($("#"+b+" .previousImage")[0]!=null){$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREV"}}else{if($("#"+b+" .nextImage")[0]!=null){$("#"+b+" .nextImage")[0].childNodes[0].textContent=""}if($("#"+b+" .previousImage")[0]!=null){$("#"+b+" .previousImage")[0].childNodes[0].textContent=""}}k.parentNode.style.width=Math.max(k.naturalWidth,250)+"px"}}}function e(j){if(j.naturalWidth==0){j.onload=function(){var k=this;if(k.naturalWidth<(screen.width/2)){if(k.naturalWidth>200){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREV"}else{$("#"+b+" .nextImage")[0].childNodes[0].textContent="";$("#"+b+" .previousImage")[0].childNodes[0].textContent=""}k.parentNode.style.width=Math.max(k.naturalWidth,250)+"px"}}}else{if(j.naturalWidth<(screen.width/2)){if(j.naturalWidth>200){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREV"}else{$("#"+b+" .nextImage")[0].childNodes[0].textContent="";$("#"+b+" .previousImage")[0].childNodes[0].textContent=""}j.parentNode.style.width=Math.max(j.naturalWidth,250)+"px"}}}},intializeForIframe:function(){var a=this;if(a.getPage()!=null){if(a.getPage().file==a.getPage().guid){a.popoverType="guid"}a.articleguid=a.getPage().file}a.on("painted",a.getIframeContent,a,{delay:10,single:true})},getIframeContent:function(){var d=this;var a=d.articleguid;d.addCls("DS-layout-detail DS-modus-replica DS-is-online miller-loaded");var c="../article_popover.aspx?articleguid="+a+"&html5="+currentProfile;if(d.popoverType=="guid"){d.content.element.dom.style.overflowY="";c="../article_popover.aspx?guid="+a+"&html5="+currentProfile}d.content.setScrollable("none");d.content.setHtml('<div class=\'iframeWrapper\' style=\'position:absolute; width:100%; height:100%; overflow-y:scroll; -webkit-overflow-scrolling:touch;\'><iframe style="border:none;width:100%; height:100%" class="iframePopover" src="'+c+'" /></div>');var b=$(d.content.element.dom).find(".iframePopover")[0];b.onload=function(){d.removeSpinner();if(b.contentWindow.SetPlatformType!=null){b.contentWindow.SetPlatformType("web")}}},destroy:function(){var a=this;a.destroyed=true;Ext.Container.prototype.destroy.apply(this,arguments)}},0,["readerarticlepopoveritem"],["component","container","readerarticlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true},["widget.readerarticlepopoveritem"],0,[InfinityMobile.view,"ReaderArticlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderPuzzlePopoverItem",InfinityMobile.view.ReaderArticlePopoverItem,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",layout:"vbox",items:[{itemId:"content",flex:1,layout:"card",items:[{scrollable:{direction:"vertical",directionLock:true},itemId:"contentHtml"}]},{itemId:"bottomBar",cls:"bottomBar",height:60,style:"font-size: 14px;",layout:{type:"hbox",pack:"middle",align:"center"},items:[{itemId:"archive",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='https://editionn.pagesuite.com/tribune/archive-ic.png' style='height:32px' />"},{width:5},{html:"Archive"}]},{width:10},{itemId:"print",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='https://edition.pagesuite.com/tribune/print-icon.png' style='height:32px' />"},{width:5},{html:"Print"}]},{width:10},{itemId:"share",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{itemId:"shareText",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='https://edition.pagesuite.com/tribune/share-ic.png' style='height:32px' />"},{width:5},{html:"Share"}]},{itemId:"shareFrame",hidden:true,layout:{type:"hbox",pack:"middle",align:"center"}}]},{itemId:"interactivemargin",width:10},{itemId:"interactive",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='https://edition.pagesuite.com/tribune/interactive-ic.png' style='height:32px' />"},{width:5},{html:"Interactive Version"}]}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderArticlePopoverItem.prototype.initialize.apply(this,arguments);a.bottomBar=a.getComponent("bottomBar");a.archiveButton=a.bottomBar.getComponent("archive");a.printButton=a.bottomBar.getComponent("print");a.shareButton=a.bottomBar.getComponent("share");a.shareText=a.shareButton.getComponent("shareText");a.shareFrame=a.shareButton.getComponent("shareFrame");a.interactiveMargin=a.bottomBar.getComponent("interactivemargin");a.interactiveButton=a.bottomBar.getComponent("interactive");a.setArchiveListener();a.setPrintListener();a.setShareListener();a.setInteractiveListener();a.setUpShare();a.checkInteractive()},setUpShare:function(){var e=this;var f="http://"+window.location.hostname+"/infinity/article_share.aspx?guid="+e.articleguid;var d="Check out today's Hartford Courant digital edition";var a=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"https://edition.pagesuite.com/html5/desktop/assets/article%20view/email-ic.png",linkUrl:"mailto:?body={0}",pageUrl:f,message:d,height:30,width:30});e.shareFrame.add(a);var c=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"https://edition.pagesuite.com/html5/desktop/assets/article%20view/facebook-ic.png",linkUrl:"http://www.facebook.com/sharer/sharer.php?m2w&u={0}",pageUrl:f,message:d,height:30,width:30});e.shareFrame.add(c);var b=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"https://edition.pagesuite.com/html5/desktop/assets/article%20view/twitter-ic.png",linkUrl:"http://twitter.com/intent/tweet?text={0}",pageUrl:f,message:d,height:30,width:30});e.shareFrame.add(b)},setArchiveListener:function(){var a=this;a.archiveButton.element.on("tap",function(){a.fireEvent("puzzleArchive",a)})},setPrintListener:function(){var a=this;a.printButton.element.on("tap",function(){a.fireEvent("puzzlePrint",a)})},setShareListener:function(){var a=this;a.shareButton.element.on("tap",function(){a.fireEvent("puzzleShare",a)})},setInteractiveListener:function(){var a=this;a.interactiveButton.element.on("tap",function(){a.fireEvent("puzzleInteractive",a)})},checkInteractive:function(){var a=this;if(a.getPage().title!="Interactive Puzzle"){a.interactiveMargin.setHidden(true);a.interactiveButton.setHidden(true)}}},0,["readerpuzzlepopoveritem"],["component","container","readerarticlepopoveritem","readerpuzzlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true,readerpuzzlepopoveritem:true},["widget.readerpuzzlepopoveritem"],0,[InfinityMobile.view.tablet,"ReaderPuzzlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.phone.ReaderPuzzlePopoverItem",InfinityMobile.view.ReaderArticlePopoverItem,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",layout:"vbox",items:[{itemId:"content",flex:1,layout:"card",items:[{scrollable:{direction:"vertical",directionLock:true},itemId:"contentHtml"}]},{itemId:"bottomBar",cls:"bottomBar",height:60,style:"font-size: 12px;",layout:{type:"hbox",pack:"middle",align:"center"},items:[{flex:1},{itemId:"archive",width:90,height:30,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/archive-ic.png' style='height:20px' />"},{width:5},{html:"Archive"}]},{flex:1},{itemId:"print",width:90,height:30,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/print-icon.png' style='height:20px' />"},{width:5},{html:"Print"}]},{itemId:"interactivemargin",flex:1},{itemId:"interactive",width:90,height:30,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='http://digitaledition.courant.com/tribune/interactive-ic.png' style='height:20px' />"},{width:5},{html:"Interactive"}]},{flex:1}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderArticlePopoverItem.prototype.initialize.apply(this,arguments);a.bottomBar=a.getComponent("bottomBar");a.archiveButton=a.bottomBar.getComponent("archive");a.printButton=a.bottomBar.getComponent("print");a.interactiveMargin=a.bottomBar.getComponent("interactivemargin");a.interactiveButton=a.bottomBar.getComponent("interactive");a.setArchiveListener();a.setPrintListener();a.setInteractiveListener();a.checkInteractive()},setArchiveListener:function(){var a=this;a.archiveButton.element.on("tap",function(){a.fireEvent("puzzleArchive",a)})},setPrintListener:function(){var a=this;a.printButton.element.on("tap",function(){a.fireEvent("puzzlePrintMobile",a)})},setShareListener:function(){var a=this;a.shareButton.element.on("tap",function(){a.fireEvent("puzzleShare",a)})},setInteractiveListener:function(){var a=this;a.interactiveButton.element.on("tap",function(){a.fireEvent("puzzleInteractive",a)})},checkInteractive:function(){var a=this;if(a.getPage().title!="Interactive Puzzle"){a.interactiveMargin.setHidden(true);a.interactiveButton.setHidden(true)}}},0,["readerpuzzlepopoveritem"],["component","container","readerarticlepopoveritem","readerpuzzlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true,readerpuzzlepopoveritem:true},["widget.readerpuzzlepopoveritem"],0,[InfinityMobile.view.phone,"ReaderPuzzlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.profile.phone",Ext.app.Profile,{config:{name:"phone",views:["StoryWindowPreferences","DataCaptureForm","ArticleReaderItemWeatherTile","ArticleReaderBannerAd","ArticleReaderItemTopStoryItem","ArticleReaderItemPhone","ArticleReaderItemTopStories","ArticleReaderItemContainer","ArticleReaderPanelContainer","ClippingOptionsMenu","ClippingArea","clippingPrompt","ClippingOptions","ArticleSectionItem","ArticleSectionItemImg","ArticlesSectionContainer","ArticlesContainer","SplashScreen","ReaderHelper","ReaderMenu","ReaderMenuSection","ReaderArchive","ReaderSearch","ReaderDownload","ReaderArticlePopover","ReaderWhatsNew","Interstitial","ArticlePopoverAd","ArticlePopoverInterstitial","ReaderSharePopup","ReaderSharePopupItem","ReaderBannerAd","ReaderBookmark","readerTerms","SectionListOverlay","ZonesOverlay","ReaderPuzzlePopoverItem","ArchiveSelector"]},viewport:{autoMaximize:true},isActive:function(){var b=Ext.os.is.Phone;var c=navigator.userAgent;var d=/Kindle/i.test(c)||/Silk/i.test(c)||/KFTT/i.test(c)||/KFOT/i.test(c)||/KFJWA/i.test(c)||/KFJWI/i.test(c)||/KFSOWI/i.test(c)||/KFTHWA/i.test(c)||/KFTHWI/i.test(c)||/KFAPWA/i.test(c)||/KFAPWI/i.test(c);if(d){b=true}if(Ext.os.is.Android){if(navigator.userAgent.search(/mobile/i)==-1){var a=Math.min(screen.height,screen.width);if(a>720){b=false}else{b=true}}}return b}},0,0,0,0,0,0,[InfinityMobile.profile,"phone"],0));(Ext.cmd.derive("InfinityMobile.profile.largetablet",Ext.app.Profile,{config:{name:"largetablet"},isActive:function(){var b=false;if(Ext.os.is.Tablet){var a=Math.min(screen.height,screen.width);if(a>800){b=true}}return b}},0,0,0,0,0,0,[InfinityMobile.profile,"largetablet"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ArticlePopoverAd",Ext.Container,{config:{width:"100%",height:110,padding:10,layout:{type:"hbox",align:"center",pack:"middle"}},initialize:function(){var a=this;a.canLoadDFPAdvert=false;a.loadDFPAdvertOnPainted=false;a.bannerAd=a.getComponent("bannerAd");a.on("painted",a.loadAdvert,a,{delay:10,single:true})},setCanLoadDFPAdvert:function(){var a=this;a.canLoadDFPAdvert=true;if(a.loadDFPAdvertOnPainted){a.loadDFPAdvert()}},loadAdvert:function(){var b=this;if(b.getItems().items.length>0){b.destroyAdvert()}b.add({itemId:"bannerAd"});b.bannerAd=b.getComponent("bannerAd");if(settings.reader.bannerAd!=null){var a=settings.reader.bannerAd.type.toLowerCase();switch(a){case"dfp":default:b.setDFPAdvert();break;case"image":b.setImageAdvert();break;case"url":b.setUrlAdvert();break}}},destroyAdvert:function(){var a=this;a.removeAll(true)},setDFPAdvert:function(){var a=this;a.networkCode=settings.reader.popupAdvert.networkCode;a.adUnit=settings.reader.popupAdvert.adUnit;a.advertDivID=a.bannerAd.id+"advert";a.bannerAd.setHtml("<div id='"+a.advertDivID+"' style='height:90px;'></div>");a.advertDiv=a.element.down("#"+a.advertDivID);if(a.setCanLoadDFPAdvert()){a.loadDFPAdvert()}else{a.loadDFPAdvertOnPainted=true}},loadDFPAdvert:function(){var a=this;googletag.cmd.push(function(){googletag.defineSlot("/30709998/eedition.dhbusinessledger.com",[300,250],"divMPU").addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display("divMPU")})},setImageAdvert:function(){var a=this;a.bannerAd.setHtml("<img src='"+settings.reader.popupAdvert.url+"' />");a.bannerAd.element.on("tap",function(){window.open(settings.reader.popupAdvert.link)})},setUrlAdvert:function(){var b=this;var a=settings.reader.popupAdvert.url;b.bannerAd.setHtml("<iframe width='728' height='90' style='border:none' src='"+a+"' />")}},0,["readerbannerad"],["component","container","readerbannerad"],{component:true,container:true,readerbannerad:true},["widget.readerbannerad"],0,[InfinityMobile.view.tablet,"ArticlePopoverAd"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ImageGallery",Ext.Container,{config:{modal:true,fullscreen:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:20,baseCls:"dynamicgallery",items:[{itemId:"portrait",height:"100%",width:"100%",layout:"vbox",items:[{itemId:"closeBtnRow",height:50,width:"100%",items:[{itemId:"closeBtn",cls:"pointerCursor",right:0,top:0,margin:10,height:25,width:25,style:{backgroundImage:"url('resources/images/reader icons/close-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}]},{itemId:"imageCarousel",height:"40%",width:"100%",xtype:"carousel",style:"background-color:rgb(75,75,75)"},{itemId:"galleryCounterPanel",width:"100%",height:50,layout:"hbox",items:[{itemId:"previous",height:30,width:30,margin:10,cls:"pointerCursor"},{itemId:"counterPanel",height:"100%",layout:{type:"hbox",pack:"center"},style:{color:"white"},items:[{itemId:"cameraIcon",height:30,width:30,margin:10,style:{backgroundImage:"url('resources/images/reader icons/photo-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},{itemId:"counter",height:50,layout:{type:"vbox",pack:"center"},items:[{itemId:"text"}]}]},{itemId:"next",width:30,height:30,margin:10,cls:"pointerCursor"}]},{itemId:"galleryInfo",width:"100%",padding:10,layout:"vbox",scrollable:{direction:"vertical",indicators:false},style:{color:"white"},items:[{itemId:"title",style:{fontSize:"25px",fontWeight:"bold"},margin:"10 0"},{itemId:"caption",style:{fontSize:"14px"},margin:"10 0"}]},{itemId:"imageScroller",scrollable:{direction:"horizontal"},height:150,width:"100%",layout:"hbox",padding:10}]},{itemId:"landscape",height:"100%",width:"100%",layout:"vbox",items:[{itemId:"closeBtnRow",height:50,width:"100%",items:[{itemId:"counterPanel",height:"100%",layout:{type:"hbox",pack:"center"},style:{color:"white"},items:[{itemId:"cameraIcon",height:30,width:30,margin:10,style:{backgroundImage:"url('resources/images/reader icons/photo-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},{itemId:"counter",height:50,layout:{type:"vbox",pack:"center"},items:[{itemId:"text"}]}]},{itemId:"closeBtn",cls:"pointerCursor",right:0,top:0,margin:10,height:25,width:25,style:{backgroundImage:"url('resources/images/reader icons/close-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}]},{itemId:"galleryPanel",layout:"hbox",width:"100%",items:[{itemId:"previous",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"},{itemId:"imageCarousel",xtype:"carousel",height:"100%",style:"background-color:rgb(75,75,75)"},{itemId:"next",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"}]},{height:50,width:"100%"},{itemId:"imageScroller",scrollable:{direction:"horizontal"},height:150,width:"100%",layout:"hbox",padding:10,style:{backgroundColor:"rgba(0,0,0,0.7)"}}]}]},initialize:function(){var b=this;if(b.config.article!=null){b.article=b.config.article}if(b.config.images!=null){b.images=b.config.images}if(b.config.dynamicview!=null){b.dynamicview=b.config.dynamicview}if(b.dynamicview||b.dynamicview==null){b.setCentered(true)}b.portraitImagesLoaded=false;b.landscapeImagesLoaded=false;b.portrait=b.getComponent("portrait");b.landscape=b.getComponent("landscape");b.porGalleryInfo=b.portrait.getComponent("galleryInfo");b.porImageCarousel=b.portrait.getComponent("imageCarousel");b.porGalleryCounterPanel=b.portrait.getComponent("galleryCounterPanel");b.porImageScroller=b.portrait.getComponent("imageScroller");b.title=b.porGalleryInfo.getComponent("title");b.caption=b.porGalleryInfo.getComponent("caption");b.title.setHtml(b.article.headline);b.porCounterPanel=b.porGalleryCounterPanel.getComponent("counterPanel");b.porCounter=b.porCounterPanel.getComponent("counter");b.landCloseBtnRow=b.landscape.getComponent("closeBtnRow");b.landCounterPanel=b.landCloseBtnRow.getComponent("counterPanel");b.landCounter=b.landCounterPanel.getComponent("counter");b.landGalleryPanel=b.landscape.getComponent("galleryPanel");b.landImageCarousel=b.landGalleryPanel.getComponent("imageCarousel");b.landImageScroller=b.landscape.getComponent("imageScroller");b.porImageCarousel.on({activeitemchange:b.handleItemChange,scope:b});b.landImageCarousel.on({activeitemchange:b.handleItemChange,scope:b});b.scrollerHidden=true;b.landImageCarousel.element.on({tap:b.toggleScroller,scope:b});if(!b.portraitImagesLoaded){for(var a in b.images){var c=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:b.images[a],position:a});b.porImageCarousel.add(c);var d=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:b.images[a].url,carousel:b.porImageCarousel,index:a,style:{transition:"all ease 0.5s"}});if(a==0){d.element.dom.style.border="2px solid white"}b.porImageScroller.add(d)}b.portraitImagesLoaded=true}if(!b.landscapeImagesLoaded){for(var a in b.images){var c=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:b.images[a],position:a});b.landImageCarousel.add(c);var d=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:b.images[a].url,carousel:b.landImageCarousel,index:a,style:{transition:"all ease 0.5s"}});if(a==0){d.element.dom.style.border="2px solid white"}b.landImageScroller.add(d)}b.landscapeImagesLoaded=true}if(b.returnOrientation()=="portrait"){b.portraitSetup()}else{b.landscapeSetup()}Ext.Viewport.on({orientationchange:function(){var e=this;console.log("ROTATED");if(e.returnOrientation()=="portrait"){e.portraitSetup()}else{e.landscapeSetup()}},scope:b});b.on({painted:function(){b.fireEvent("galleryVisible")},destroy:function(){b.fireEvent("galleryInvisible")}})},handleItemChange:function(b,d,a){var c=this;if(c.images!=null){c.porCounter.setHtml((parseFloat(d.position)+1)+" of "+c.images.length);c.landCounter.setHtml((parseFloat(d.position)+1)+" of "+c.images.length);c.caption.setHtml("");if(c.article.images[d.position].caption!=null){if(c.article.images[d.position].caption.trim().length>0){c.caption.setHtml(c.article.images[d.position].caption)}else{if(c.article.shortStory!=null){c.caption.setHtml(c.article.shortStory)}}}else{if(c.article.shortStory!=null){c.caption.setHtml(c.article.shortStory)}}}if(c.porImageScroller.getItems().items[d.position]!=null){c.porImageScroller.getItems().items[d.position].element.dom.style.border="2px solid white";c.porImageCarousel.setActiveItem(parseFloat(d.position))}if(a!=null){if(c.porImageScroller.getItems().items[a.position]!=null){c.porImageScroller.getItems().items[a.position].element.dom.style.border=""}}if(c.landImageScroller.getItems().items[d.position]!=null){c.landImageScroller.getItems().items[d.position].element.dom.style.border="2px solid white";c.landImageCarousel.setActiveItem(parseFloat(d.position))}if(a!=null){if(c.landImageScroller.getItems().items[a.position]!=null){c.landImageScroller.getItems().items[a.position].element.dom.style.border=""}}},portraitSetup:function(){var a=this;a.landscape.hide();a.portrait.show();a.closeBtnRow=a.portrait.getComponent("closeBtnRow");a.closeBtn=a.closeBtnRow.getComponent("closeBtn");a.closeBtn.element.on({tap:function(){var b=this;b.destroy()},scope:a});a.previousBtn=a.porGalleryCounterPanel.getComponent("previous");a.previousBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-back-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.nextBtn=a.porGalleryCounterPanel.getComponent("next");a.nextBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-next-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.previousBtn.element.on({tap:a.previous,scope:a});a.nextBtn.element.on({tap:a.next,scope:a});a.portraitPainted()},portraitPainted:function(){var a=this;a.porGalleryInfo.setHeight($(document).height()-($(document).height()*0.4)-250);a.porCounterPanel.setWidth($(document).width()-100)},landscapeSetup:function(){var a=this;a.landscape.show();a.portrait.hide();a.closeBtn=a.landCloseBtnRow.getComponent("closeBtn");a.previousBtn=a.landGalleryPanel.getComponent("previous");a.previousBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-back-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.nextBtn=a.landGalleryPanel.getComponent("next");a.nextBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-next-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.previousBtn.element.on({tap:a.previous,scope:a});a.nextBtn.element.on({tap:a.next,scope:a});a.closeBtn.element.on({tap:function(){var b=this;b.destroy()},scope:a});a.landscapePainted()},toggleScroller:function(){var a=this;console.log("TAPPED");if(a.scrollerHidden){document.styleSheets[0].insertRule("@keyframes toolbarHide { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, -150px, 0px); } }",0);a.landImageScroller.element.dom.style.animation="toolbarHide 0.3s forwards";a.scrollerHidden=false}else{document.styleSheets[0].insertRule("@keyframes toolbarRaise { 0%{ transform:translate3d(0px, -150px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);a.landImageScroller.element.dom.style.animation="toolbarRaise 0.3s forwards";a.scrollerHidden=true}},landscapePainted:function(){var a=this;a.landImageCarousel.setHeight($(document).height()-100);a.nextBtn.setHeight($(document).height()-100);a.previousBtn.setHeight($(document).height()-100);a.landImageCarousel.setWidth($(document).width()-100)},next:function(){var a=this;if(a.returnOrientation()=="portrait"){a.porImageCarousel.next()}else{a.landImageCarousel.next()}},previous:function(){var a=this;if(a.returnOrientation()=="portrait"){a.porImageCarousel.previous()}else{a.landImageCarousel.previous()}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}}},0,["dynamicimagegallery"],["component","container","dynamicimagegallery"],{component:true,container:true,dynamicimagegallery:true},["widget.dynamicimagegallery"],0,[InfinityMobile.view.tablet,"ImageGallery"],0));(Ext.cmd.derive("InfinityMobile.view.tablet.ReaderOGallery",Ext.Container,{config:{fullscreen:true,modal:true,style:"background-color:black;",height:"100%",width:"100%",zIndex:99999999,layout:{type:"vbox"},items:[{itemId:"content",flex:1,width:"100%",layout:{type:"vbox"},items:[{itemId:"closeBtn",right:10,top:10,width:40,height:40,cls:"backgroundImage pointerCursor",style:"background-image:url('resources/images/article-close-btn-white.png');background-size:contain;"},{itemId:"images",directionLock:true,flex:6,width:"100%",style:"background-color:black;"},{itemId:"caption",width:"100%",style:"background-color:#333333;color:white;padding: 10px;max-height:200px;min-height:40px;",flex:1,scrollable:{directionLock:true,direction:"vertical"}}]},{itemId:"navBar",docked:"bottom",height:40,width:"100%",layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"prev",width:25,style:"text-align:center",html:'<i class="fa fa-angle-left fa-lg" aria-hidden="true"></i>'},{itemId:"counter",margin:"0px 20px 0px 20px"},{itemId:"next",width:25,style:"text-align:center",html:'<i class="fa fa-angle-right fa-lg" aria-hidden="true"></i>'}]}]},initialize:function(){var d=this;d.content=d.getComponent("content");d.navBar=d.getComponent("navBar");d.navBar.setStyle({backgroundColor:"#"+settings.topbar.backgroundColor,color:"#"+settings.topbar.color});if(d.config.article!=null){d.article=d.config.article}d.previousBtn=d.navBar.getComponent("prev");d.nextBtn=d.navBar.getComponent("next");d.counter=d.navBar.getComponent("counter");if(d.config.url!=null){d.url=d.config.url;d.captions=[];d.content.getComponent("closeBtn").element.on({tap:"close",scope:d});var g=Ext.create("InfinityMobile.view.ReaderOGalleryLoading",{});if(d.url.indexOf("http://")!=-1){var b=d.url.substring(7,d.url.length)}else{b=d.url}b="../../Newsday/getatex.aspx?url=http://www.newsday.com/iosfeeds/"+b+"?device=tablet&_dc=1445010088130&limit=25";$.ajax({type:"GET",url:b,data:{get_param:"value"},dataType:"json",complete:function(){g.destroy()},success:function(k){var h=[];for(var j=0;j<k.content.images.length;j++){var m={imageUrl:k.content.images[j].image_path,pageNo:j,config:{pageNo:j}};d.captions[j]=k.content.images[j].caption;h[h.length]=m}d.counter.setHtml("1 of "+d.captions.length);d.setupCarousel(h);d.itemChange(d.carousel);d.data=k;var l="1 of "+d.captions.length;d.fireEvent("ogalleryinitialized",d,k,l)}})}else{if(d.config.images!=null){d.images=d.config.images;d.captions=[];d.content.getComponent("closeBtn").element.on({tap:"close",scope:d});var g=Ext.create("InfinityMobile.view.ReaderOGalleryLoading",{});var a=[];for(var c=0;c<d.images.length;c++){var e={imageUrl:d.images[c].url,pageNo:c,config:{pageNo:c}};a[a.length]=e;var f="";if(d.images[c].credit!=null){if(d.images[c].credit.trim().length>0){f=" ("+d.images[c].credit+")"}}d.captions[c]=d.images[c].caption+f}g.destroy();d.counter.setHtml("1 of "+d.captions.length);d.setupCarousel(a);d.on("painted",function(){d.itemChange(d.carousel)})}}d.previousBtn.element.on({tap:function(){d=this;d.carousel.previous()},scope:d});d.nextBtn.element.on({tap:function(){d=this;d.carousel.next()},scope:d})},close:function(){var a=this;a.fireEvent("closeOGallery",a)},setupCarousel:function(a){var b=this;b.carousel=Ext.create("InfinityMobile.view.ImageCarousel",{width:"100%",height:"100%",data:a,pageNo:1,pageTemplate:function(d,f,c){var e=Ext.create("InfinityMobile.view.ReaderOGalleryItem",{imageUrl:d.imageUrl,pageNo:d.pageNo});return e}});b.content.getComponent("images").add(b.carousel);b.carousel.on({activeitemchange:"itemChange",scope:b})},itemChange:function(c,l,b,h){var k=this;k.index=k.carousel.getActiveItem().getPageNo();if(k.captions[k.index]!=null&&k.captions[k.index].trim().length>0){k.content.getComponent("caption").setHtml("<div class=\"captionText\" style='width:100%;color:white;padding:10px;'><p>"+k.captions[k.index]+"</p></div>");k.content.getComponent("caption").show()}else{k.content.getComponent("caption").hide()}var d=$(k.element.dom).find(".captionText");if(d.length>0){var j=$(d[0]).height();if(j>120){k.content.getComponent("caption").setHeight(140)}else{k.content.getComponent("caption").setHeight(j+20)}}k.content.getComponent("caption").getScrollable().getScroller().scrollTo(0,0);k.counter.setHtml((c.getActiveItem().getPageNo()+1)+" of "+k.captions.length);var g=(c.getActiveItem().getPageNo()+1)+" of "+k.captions.length;if(k.url!=null){if(k.data!=null){k.fireEvent("ogalleryinitialized",k,k.data,g)}}else{var a=k.article.byline;if(k.article.reporters!=null&&k.article.reporters.length>0){for(var f in k.article.reporters){a+=", "+k.article.reporters[f].name}}var e={author:a,contentTitle:k.article.headline,contentType:"photolist"};k.fireEvent("ogalleryinitializedArticle",k,e,g)}}},0,["readerogallery"],["component","container","readerogallery"],{component:true,container:true,readerogallery:true},["widget.readerogallery"],0,[InfinityMobile.view.tablet,"ReaderOGallery"],0));(Ext.cmd.derive("InfinityMobile.profile.tablet",Ext.app.Profile,{config:{name:"tablet",views:["SplashScreen","ReaderHelper","ReaderMenu","ReaderMenuSection","ReaderArchive","ReaderSearch","ReaderDownload","ReaderArticlePopover","ReaderWhatsNew","Interstitial","ArticlePopoverAd","ArticlePopoverInterstitial","ReaderBannerAd","ReaderBookmark","ClippingArea","ImageGallery","SectionListOverlay","ZonesOverlay","ArticlesContainer","ReaderPuzzlePopoverItem","ReaderOGallery"]},isActive:function(){return Ext.os.is.Tablet}},0,0,0,0,0,0,[InfinityMobile.profile,"tablet"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderSpecialSupplements",InfinityMobile.view.Overlay,{config:{id:"supplementscontainer",width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{itemId:"toolBar",height:40,style:"background-color:#e6e6e6",items:[{top:10,left:10,html:"<b>Special Supplements</b>"},{id:"toolBarClose",top:8,right:8,cls:"pointerCursor",html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"bodyContainer",padding:"20",layout:"vbox",flex:1,style:"font-size:15px",items:[{itemId:"itemsContainer",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:150,margin:"0 8 16 7",cls:"archiveitemphone"}}]}]},initialize:function(){var b=this;var a=b.getComponent("toolBar");b.toolBarClose=a.getComponent("toolBarClose");var c=b.getComponent("bodyContainer");b.itemsContainer=c.getComponent("itemsContainer");b.setCloseListener();b.fireEvent("showSupplements",b)},setCloseListener:function(){var a=this;a.toolBarClose.element.on("tap",function(){a.close()})},close:function(){var a=this;a.fireEvent("close",a)}},0,["readerspecialsupplements"],["component","container","panel","overlay","readerspecialsupplements"],{component:true,container:true,panel:true,overlay:true,readerspecialsupplements:true},["widget.readerspecialsupplements"],0,[InfinityMobile.view.desktop,"ReaderSpecialSupplements"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderMenu",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px)",right:0,top:40,items:[{itemId:"menuLayout",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{margin:15},scrollable:{direction:"vertical",directionLock:true},items:[{id:"menuShare",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"EDITION OPTIONS",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/minimise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"editionOptionsSection",style:"overflow:hidden;",margin:"0 0 0 0",layout:"vbox",defaults:{padding:15},minimized:false,items:[{id:"menuArchive",xtype:"readermenuitem",text:"Archive"},{id:"menuDownload",xtype:"readermenuitem",text:"Download"},{id:"menuSharing",xtype:"readermenushare"}]},{itemId:"menuQuickLinksContainer",layout:"vbox",margin:0,defaults:{padding:15}},{id:"menuInfo",xtype:"readermenuitem",style:"background-color:#2c2f32;font-size:14px;color:#cccccc;border-bottom:0.5px solid gray;",margin:"0 0 0 0",padding:"10 15 10 15",text:"INFO",items:[{itemId:"toggleSection",right:15,height:16,width:16,top:10,style:"background-image:url('resources/images/reader icons/maximise-menu-option.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"menuInfoContainer",layout:"vbox",margin:0,defaults:{padding:15},style:"overflow:hidden;",minimized:true,height:0,items:[{id:"menuHelp",xtype:"readermenuitem",text:"Contact Us"}]}]}]},initialize:function(){var f=this;var b=Ext.getStore("SettingStore");var e=f.getComponent("menuLayout");f.sharingContainer=e.getComponent("editionOptionsSection").getComponent("menuSharing");if(b.data.items[0].raw.menu.hideArchive!=null){if(b.data.items[0].raw.menu.hideArchive){var d=e.getComponent("editionOptionsSection").getComponent("menuArchive");d.hide()}}else{if(b.data.items[0].raw.menu.archiveText!=null){var d=e.getComponent("editionOptionsSection").getComponent("menuArchive");d.setHtml(b.data.items[0].raw.menu.archiveText)}}if(b.data.items[0].raw.menu.hideDownload!=null){if(b.data.items[0].raw.menu.hideDownload){var a=e.getComponent("editionOptionsSection").getComponent("menuDownload");a.hide()}}else{if(b.data.items[0].raw.menu.downloadText!=null){var a=e.getComponent("editionOptionsSection").getComponent("menuDownload");a.setHtml(b.data.items[0].raw.menu.downloadText)}}if(settings.menu.hideSharing!=null){var c=e.getComponent("editionOptionsSection").getComponent("menuSharing");c.hide()}f.loadShare();e.getComponent("menuShare").element.on({tap:function(){f.headerTap(e.getComponent("editionOptionsSection"),e.getComponent("menuShare"))},scope:f});e.getComponent("menuInfo").element.on({tap:function(){f.headerTap(e.getComponent("menuInfoContainer"),e.getComponent("menuInfo"))},scope:f})},headerTap:function(c,d){if(c.minimized){var a=0;c.setDefaults({padding:"15px 0px 15px 0px"});for(var b=0;b<c.items.items.length;b++){a+=parseFloat($(c.items.items[b].element.dom).height())}document.styleSheets[0].insertRule("@keyframes openHeader"+c.getId()+" { 0%{ height:0px; } 100%{ height: "+a+"px; } }",0);c.element.dom.style.animation="openHeader"+c.getId()+" 1s forwards";c.minimized=false;d.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/minimise-menu-option.png')"}else{c.setDefaults({padding:"0px 0px 0px 0px"});document.styleSheets[0].insertRule("@keyframes closeHeader"+c.getId()+" { 0%{ height:"+$(c.element.dom).height()+"px; } 100%{ height: 0px; } }",0);c.element.dom.style.animation="closeHeader"+c.getId()+" 1s forwards";c.minimized=true;d.getComponent("toggleSection").element.dom.style.backgroundImage="url('resources/images/reader icons/maximise-menu-option.png')"}},checkWhatsNewBanner:function(){var c=this;var a=c.whatsNewContainer.element.down(".bannerIcon").dom;try{if(localStorage.getItem("versionwhatsnew"+version.replace(/g./g,"_"))!=null){a.style.display="none"}}catch(b){}},loadShare:function(){var a=this;a.fireEvent("loadShare",a)}},0,["articlereadermenu"],["component","container","panel","overlay","articlereadermenu"],{component:true,container:true,panel:true,overlay:true,articlereadermenu:true},["widget.articlereadermenu"],0,[InfinityMobile.view.desktop,"ArticleReaderMenu"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemInterstitialContainer",Ext.Container,{config:{cls:"articlereaderiteminterstitialcontainer",layout:{type:"hbox"},style:"margin: 50px;display:inline;"},initialize:function(){var a=this;a.setStyle("height:"+($(document).height()-120)+"px;")},onResize:function(){var a=this;if(a!=null){a.setStyle("height:"+($(document).height()-120)+"px;")}}},0,["articlereaderiteminterstitialcontainer"],["component","container","articlereaderiteminterstitialcontainer"],{component:true,container:true,articlereaderiteminterstitialcontainer:true},["widget.articlereaderiteminterstitialcontainer"],0,[InfinityMobile.view.desktop,"ArticleReaderItemInterstitialContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemInterstitial",Ext.Panel,{config:{style:"padding:5px",cls:"articlereaderiteminterstitial",items:[{itemId:"advert",cls:"advert"}]},initialize:function(){var c=this;Ext.Panel.prototype.initialize.apply(this,arguments);c.advertContainer=c.getComponent("advert");var a=settings.reader.interstitial;if(c.config.settings!=null){c.settings=c.config.settings}if(settings.dynamic.adverts.interstitial.type=="url"){var b=settings.dynamic.adverts.interstitial.url;c.advertContainer.setHtml("<iframe width='768' height='576' style='border:none;' scrolling='no' src='"+b+"' />")}else{if(c.settings.type=="dfp"){c.networkCode=c.settings.networkCode;c.adUnit=c.settings.adUnit;c.advertDivID=c.id+"advert";if(c.config.adHeight!=null){c.adHeight=c.config.adHeight}var d=(c.adHeight/1024);c.element.dom.style.width=(728*d+50)+"px";c.advertContainer.setHtml("<div id='"+c.advertDivID+"' style='margin-left:0;margin-right:0;pointer-events:none;-ms-transform-origin-x:0;-ms-transform-origin-y:0;-moz-transform-origin-x:0px; -moz-transform-origin-y:0px;-webkit-transform-origin-x:0;-webkit-transform-origin-y:0;-moz-transform:scale3d("+d+","+d+",1);-webkit-transform:scale3d("+d+","+d+",1);-ms-transform:scale3d("+d+","+d+",1);transform-origin:0px 0px;'></div>");c.advertDiv=c.element.down("#"+c.advertDivID);c.on("painted",c.loadAdvert,c,{delay:1000,single:true});c.on("resize",c.onResizeFn,c);c.onResizeFn=function(){var e=($(document).height()-120-100)/1024;c.element.dom.style.width=(728*e+50)+"px";c.advertContainer.element.dom.firstChild.firstChild.firstChild.style.webkitTransform="scale3d("+e+","+e+",1)";c.advertContainer.element.dom.firstChild.firstChild.firstChild.style.msTransform="scale3d("+e+","+e+",1)";c.advertContainer.element.dom.firstChild.firstChild.firstChild.style.mozTransform="scale3d("+e+","+e+",1)";c.advertContainer.element.dom.firstChild.firstChild.firstChild.style.transform="scale3d("+e+","+e+",1)"}}else{if(c.config.adHeight!=null){c.adHeight=c.config.adHeight}var d=(c.adHeight/1024);c.element.dom.style.width=(728*d+50)+"px";c.advertContainer.setHtml("<div style='text-align:center;margin:auto;'><img class='advertImg' style='margin-left:5px;margin-right:5px;pointer-events:none;-webkit-transform-origin-x:0;-webkit-transform-origin-y:0;-webkit-transform:scale3d("+d*0.5+","+d*0.5+",1);-moz-transform-origin:0px 0px;-moz-transform:scale3d("+d*0.5+","+d*0.5+",1);-ms-transform-origin-x:0;-ms-transform-origin-y:0;-ms-transform:scale3d("+d*0.5+","+d*0.5+",1);transform-origin:0px 0px;' src='"+c.settings.url+"' /></div>");c.on("painted",c.loadAdvert,c,{delay:10,single:true});c.onResizeFn=function(){c.element.dom.style.width=(728*scale+50)+"px";c.advertContainer.element.dom.firstChild.firstChild.firstChild.firstChild.style.webkitTransform="scale3d("+scale*0.5+","+scale*0.5+",1)";c.advertContainer.element.dom.firstChild.firstChild.firstChild.firstChild.style.msTransform="scale3d("+scale*0.5+","+scale*0.5+",1)";c.advertContainer.element.dom.firstChild.firstChild.firstChild.firstChild.style.mozTransform="scale3d("+scale*0.5+","+scale*0.5+",1)";c.advertContainer.element.dom.firstChild.firstChild.firstChild.firstChild.style.transform="scale3d("+scale*0.5+","+scale*0.5+",1)"}}}},loadAdvert:function(){var a=this;googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("768"),parseInt("1024")],a.advertDivID);b.addService(googletag.pubads());googletag.pubads().addEventListener("slotRenderEnded",function(c){console.log("AD LOADED");console.log(c.slot==b);if(c.slot==b){if(c.isEmpty){a.hide()}}});googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})},onResize:function(){var a=this;a.onResizeFn()}},0,["articlereaderiteminterstitial"],["component","container","panel","articlereaderiteminterstitial"],{component:true,container:true,panel:true,articlereaderiteminterstitial:true},["widget.articlereaderiteminterstitial"],0,[InfinityMobile.view.desktop,"ArticleReaderItemInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemWeatherTile",Ext.Container,{config:{cls:"articlereaderitemweathertile",style:"float:left;z-index:6;background-color:#90A4B0;",layout:"vbox",items:[{itemId:"title",layout:"vbox",style:"position:absolute;top:0px;left:0px;z-index:10;",items:[{html:"<p class='.thirteen' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;padding:20px 0px 0px 20px;'>WEATHER</p>"},{itemId:"location"},{html:"<p class='ten' style='color:white;font-family:Open Sans, sans-serif;font-size:10px;font-weight:normal;padding:5px 0px 0px 20px;'>Source: BBC Weather</p>"}]},{itemId:"toggle",layout:"hbox",padding:20,style:"position:absolute;top:0px;right:0px;z-index:10;",items:[{html:"<p style='color:white;font-size:13px;padding-right:5px;padding-top:0.2em;'>&deg;C</p>"},{cls:"toggle",itemId:"toggleField",xtype:"togglefield",style:"background:transparent;"},{html:"<p style='color:white;font-size:13px;padding-left:5px;padding-top:0.2em;'>&deg;F</p>"}]},{itemId:"weather",width:"100%",layout:"hbox"},{itemId:"extraDetails",width:"100%",layout:"hbox"}]},initialize:function(){var v=this;Ext.Container.prototype.initialize.apply(this,arguments);if(v.config.articleIndex!=null){v.articleIndex=v.config.articleIndex}if(v.config.weather!=null){v.weather=v.config.weather}if(v.config.carousel!=null){v.carousel=v.config.carousel}if(v.config.title!=null){v.title=v.config.title}var j=v.getComponent("title");var a=j.getComponent("location");var h=v.getComponent("weather");var n=v.getComponent("toggle");v.toggle=n.getComponent("toggleField");v.extra=v.getComponent("extraDetails");v.expand=false;v.element.on({tap:"onTap",scope:v});a.setHtml("<p class='twentyFour' style='color:white;font-family:Open Sans, sans-serif;font-size:24px;font-weight:normal;padding:5px 0px 0px 20px;'>"+v.title+"</p>");var m=[];var l=[];var k=[];var f=[];var c=[];for(var p=0;p<v.weather.length;p++){var o=v.weather[p].content.split(",");m[p]=o[0].substring(o[0].indexOf(":")+2,o[0].indexOf("C"));l[p]=o[0].substring(o[0].indexOf("(")+1,o[0].indexOf("F"));k[p]=o[1].substring(o[1].indexOf(":")+2,o[1].indexOf("C"));f[p]=o[1].substring(o[1].indexOf("(")+1,o[1].indexOf("F"));var x=v.weather[p].title.split(",");if(p==0){var t="Today";var r="background-color:#91a4af;text-align:center;overflow-hidden;"}else{var t=x[0].substring(0,3);var r="background-color:#9fb0b9;text-align:center;overflow:hidden;"}var s=x[0].split(":");switch(s[1].trim().toLowerCase()){case"light cloud":var w="../assets/weather/white-cloud-ic.png";break;case"white cloud":var w="../assets/weather/white-cloud-ic.png";break;case"heavy rain":var w="../assets/weather/rain-ic.png";break;case"light rain":var w="../assets/weather/rain-ic.png";break;case"light rain shower":var w="../assets/weather/rain-ic.png";break;case"heavy rain shower":var w="../assets/weather/rain-ic.png";break;case"sunny intervals":var w="../assets/weather/sun-cloud-ic.png";break;case"thick cloud":var w="../assets/weather/black-cloud-ic.png";break;case"sunny":var w="../assets/weather/sun-ic.png";break;case"clear sky":var w="../assets/weather/sun-ic.png";break}if(s[1].trim().indexOf("Thunder")!=-1){var w="../assets/weather/thunder-ic.png"}if(s[1].trim().indexOf("Ice")!=-1){var w="../assets/weather/ice-ic.png"}if(s[1].trim().indexOf("Snow")!=-1){var w="../assets/weather/snow-cloud-ic.png"}if(!parseInt(k[p].substring(0,k[p].length-1))){k[p]=""}else{k[p]+="C"}if(!parseInt(f[p].substring(0,k[p].length-1))){f[p]=""}else{f[p]+="F"}c[p]=Ext.create("Ext.Container",{itemId:"panel"+p,layout:"vbox",width:256,height:v.carousel.element.dom.clientHeight,style:r,items:[{height:"25%"},{html:"<div style='text-align:center;'><p class='twentyFour' style='color:white;font-family:Open Sans, sans-serif;font-size:24px;font-weight:normal;padding:10px;'>"+t+"</p></div>"},{width:"100%",height:"20%",style:"background-image:url('"+w+"');background-position:center;background-repeat:no-repeat;background-size:contain;"},{html:"<div  style='text-align:center;'><p class='thirteen' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;'>"+s[1]+"</p></div>"},{itemId:"temp",html:"<div  style='text-align:center;'><p class='fifty' style='color:white;font-family:Open Sans, sans-serif;font-size:50px;font-weight:normal;padding-top:5px;'>"+m[p]+"C</p></div>"},{itemId:"minTemp",html:"<div  style='text-align:center;'><p class='eighteen' style='color:#e1e1e1;font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;'>"+k[p]+"</p></div>"}]});h.add(c[p])}var b=o[9].split(":");v.sunrise=Ext.create("Ext.Container",{itemId:"sunrise",layout:"vbox",height:(v.carousel.element.dom.clientHeight*0.5),width:256,style:"text-align:center;",items:[{height:"20%"},{width:"100%",height:"20%",style:"background-image:url('../assets/weather/sunrise-ic.png');background-position:center;background-repeat:no-repeat;background-size:contain;"},{html:"<div style='text-align:center;'><p class='eighteen' style='color:white;font-family:Open Sans, sans-serif;font-size:18px;;padding:5px;'>"+o[8]+"</p></div>"},{html:"<div style='text-align:center;'><p class='eighteen' style='color:white;font-family:Open Sans, sans-serif;font-size:18px;;padding:5px;'>"+o[9]+"</p></div>"},{cls:"windDirection",width:"100%",height:"40%",style:"background-image:url('../assets/weather/wind-speed-ic.png');background-position:center;background-repeat:no-repeat;background-size:contain;",html:"<div style='text-align:center;'><p style='width:256px;transform:translate(-1.5%, 42%);height:"+(v.carousel.element.dom.clientHeight*0.5)*0.4+"px;top:45%;left:45%;color:#91a4af;font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;'>"+o[3].substring(o[3].indexOf(":")+2,o[3].indexOf("m"))+"</p></div>"}]});v.extra.add(v.sunrise);var u=o[6].split(":");var e=o[5].split(":");var q=o[4].split(":");var d=o[7].split(":");var g=Ext.create("Ext.Container",{itemId:"weatherDetails",layout:"vbox",width:512,style:"text-align:center",height:(v.carousel.element.dom.clientHeight*0.5),items:[{height:"20%"},{width:350,style:"position:relative;left:50%;transform:translateX(-50%);",html:"<div style='text-align:center;'><span class='eighteen' style='color:white;font-family:Open Sans, sans-serif;font-size:18px;float:left;padding:5px;'>Humidity</span><span style='color:white;font-family:Open Sans, sans-serif;font-size:18px;float:right;padding:5px;' class='eighteen'>"+u[1]+"</span></div>"},{width:350,style:"position:relative;left:50%;transform:translateX(-50%);",html:"<div style='text-align:center;border-bottom:1px solid white;'><span class='eighteen' style='color:white;font-family:Open Sans, sans-serif;font-size:18px;float:left;padding:5px;'>Pressure (millibars)</span><span style='color:white;font-family:Open Sans, sans-serif;font-size:18px;float:right;padding:5px;' class='eighteen'>"+e[1]+"</span></div>"},{width:350,style:"position:relative;left:50%;transform:translateX(-50%);",html:"<div style='text-align:center;border-bottom:1px solid white;'><span class='eighteen' style='color:white;font-family:Open Sans, sans-serif;font-size:18px;float:left;padding:5px;'>Visibility</span><span style='color:white;font-family:Open Sans, sans-serif;font-size:18px;float:right;padding:5px;' class='eighteen'>"+q[1]+"</span></div>"},{width:350,style:"position:relative;left:50%;transform:translateX(-50%);",html:"<div style='text-align:center;border-bottom:1px solid white;'><span class='eighteen' style='color:white;font-family:Open Sans, sans-serif;font-size:18px;float:left;padding:5px;'>UV Risk</span><span style='color:white;font-family:Open Sans, sans-serif;font-size:18px;float:right;padding:5px;' class='eighteen'>"+d[1]+"</span></div>"}]});v.extra.add(g);v.onResizeFn=function(){for(var z=0;z<3;z++){var y=h.getComponent("panel"+z);if(!v.expand){y.element.dom.style.height=(v.carousel.element.dom.clientHeight)+"px"}else{y.element.dom.style.height=(v.carousel.element.dom.clientHeight*0.57)+"px"}}};v.toggle.on({change:function(){if(v.toggle.getValue()==0){for(var y=0;y<c.length;y++){c[y].getComponent("temp").setHtml("<div style='text-align:center;'><p class='fifty' style='color:white;font-family:Open Sans, sans-serif;font-size:50px;font-weight:normal;padding-top:5px;'>"+m[y]+"C</p></div>");c[y].getComponent("minTemp").setHtml("<div style='text-align:center;'><p class='eighteen' style='color:#e1e1e1;font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;'>"+k[y]+"</p></div>")}}else{for(var y=0;y<c.length;y++){c[y].getComponent("temp").setHtml("<div style='text-align:center;'><p class='fifty'  style='color:white;font-family:Open Sans, sans-serif;font-size:50px;font-weight:normal;padding-top:5px;'>"+l[y]+"F</p></div>");c[y].getComponent("minTemp").setHtml("<div style='text-align:center;'><p class='eighteen' style='color:#e1e1e1;font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;'>"+f[y]+"</p></div>")}}}});v.toggle.element.on({tap:function(y){y.stopPropagation()}})},onTap:function(){var b=this;var a=b.parent.parent.element;clearInterval(b.timer);if(!b.expand){b.expand=true;b.extra.show();b.fireEvent("tileTapped",b);b.element.dom.style.position="absolute";b.element.dom.style.left="0px",b.element.dom.style.top="0px";a.dom.style.zIndex=8;b.timer=setInterval(function(){if(b.height<105){b.expand=true;b.height+=5;a.dom.style.height=b.height+"%"}else{b.height=105;clearInterval(b.timer);a.dom.style.height=b.height+"%"}},5)}else{b.expand=false;b.extra.hide();b.timer=setInterval(function(){if(b.height>60){b.expand=false;b.height-=5;a.dom.style.height=b.height+"%"}else{b.height=60;a.dom.style.height=b.height+"%";clearInterval(b.timer)}},5)}},onResize:function(){var a=this;a.onResizeFn()}},0,["articlereaderitemweathertile"],["component","container","articlereaderitemweathertile"],{component:true,container:true,articlereaderitemweathertile:true},["widget.articlereaderitemweathertile"],0,[InfinityMobile.view.desktop,"ArticleReaderItemWeatherTile"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemTopStoryItem",Ext.Panel,{config:{style:"float:left;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:0,top:0,left:0,right:0,cls:"backgroundImage aspectfill"},{itemId:"title",style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold",bottom:0,top:0,left:0,right:0,height:"100%",padding:10}]},initialize:function(){var a=this;a.article=a.config.article;a.expand=false;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;a.hasImage=false;if(a.config.articleIndex!=null){a.articleIndex=a.config.articleIndex}if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setStyle("height:100%;");a.height=100;a.timer;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.setBackgroundImage();a.hasImage=true}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;left:0px;right;0px;top:0px;bottom:0px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";c.imageAspect=false;if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;'>"+c.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;'>"+c.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;>"+c.article.byline+"</p></div>");c.image=new Image();c.image.src=c.firstImage.url;c.image.onload=function(){var g=c.image.naturalWidth/c.image.naturalHeight;var e=$(c.element.dom).width()/$(c.element.dom).height();if(g<1.25&&e>1.25){c.imageAspect=true;var f=$(c.element.dom).height()/c.image.naturalHeight;var d=c.image.naturalWidth*f;if(d>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}}},setNoImage:function(){var e=this;e.titleContainer.resetFloating();e.titleContainer.setStyle("background-color:#EEEEEE; color:black;");var d="";if(e.article.sections.length>1){for(var c=0;c<e.article.sections.length;c++){d+=e.article.sections[c]+"/"}d=d.substring(0,d.length-1)}else{if(e.article.sections[0]!=null){d=e.article.sections[0]}}if(e.article.shortStory!=null){var a=e.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}var f=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+e.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+e.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+e.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});f.element.on({painted:function(){if(!e.paintedTitle){var g=0;if(f.element.down(".sectionText")!=null){g+=f.element.down(".sectionText").dom.clientHeight}if(f.element.down(".headlineText")!=null){g+=f.element.down(".headlineText").dom.clientHeight}if(f.element.down(".subheadlineText")!=null){g+=f.element.down(".subheadlineText").dom.clientHeight}if(f.element.down(".bylineText")!=null){g+=f.element.down(".bylineText").dom.clientHeight}var h=$(this.element.dom).height()-g;f.element.down(".shortStory").dom.style.maxHeight=(h-(h%14)-26)+"px";if(f.element.down(".bylineText")!=null){if(f.element.down(".bylineText").dom.clientHeight+f.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){f.element.down(".bylineText").dom.style.visibility="hidden";e.bylineHidden=true}}if(f.element.down(".subheadlineText")!=null){if(f.element.down(".subheadlineText").dom.clientHeight+f.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){f.element.down(".subheadlineText").dom.style.visibility="hidden";e.subheadlineHidden=true}}e.paintedTitle=true}},scope:e});e.titleContainer.add(f);if(e.article.body!=null){if(e.article.body.indexOf("<p>")!=-1){e.article.body=e.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}e.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:e.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;z-index:16;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var e=this;var h=e.titleContainer.getComponent("title");if(h!=null){var a=h.element.down(".sectionText").dom.clientHeight+h.element.down(".headlineText").dom.clientHeight+h.element.down(".subheadlineText").dom.clientHeight+h.element.down(".bylineText").dom.clientHeight;var c=$(this.element.dom).height()-a;h.element.down(".shortStory").dom.style.maxHeight=(c-(c%14)-26)+"px";if(parseFloat(h.element.down(".bylineText").dom.clientHeight)+parseFloat(h.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".bylineText").dom.style.visibility="hidden";e.bylineHidden=true}else{h.element.down(".bylineText").dom.style.visibility="";e.bylineHidden=false}if(parseFloat(h.element.down(".subheadlineText").dom.clientHeight)+parseFloat(h.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".subheadlineText").dom.style.visibility="hidden";e.subheadlineHidden=true}else{h.element.down(".subheadlineText").dom.style.visibility="";e.subheadlineHidden=false}}if(e.hasImage){var g=e.image.naturalWidth/e.image.naturalHeight;var d=$(e.element.dom).width()/$(e.element.dom).height();if(g<1.3&&d>1.25){e.imageAspect=true;var f=$(e.element.dom).height()/e.image.naturalHeight;var b=e.image.naturalWidth*f;if(b>$(e.element.dom).width()/2){e.imageContainer.element.dom.style.backgroundSize="50%";e.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{e.imageContainer.element.dom.style.backgroundSize=" auto 100%";e.imageContainer.element.dom.style.backgroundPosition="0% 0%"}e.titleContainer.element.down(".tileText").dom.style.bottom="";e.titleContainer.element.down(".tileText").dom.style.top="50%";e.titleContainer.element.down(".tileText").dom.style.left="55%";e.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}else{e.imageAspect=false;e.imageContainer.element.dom.style.backgroundSize="cover";e.imageContainer.element.dom.style.backgroundPosition="50% 0%";e.imageContainer.element.dom.style.backgroundColor="gray";e.titleContainer.element.down(".tileText").dom.style.bottom="10px";e.titleContainer.element.down(".tileText").dom.style.top="";e.titleContainer.element.down(".tileText").dom.style.left="10px";e.titleContainer.element.down(".tileText").dom.style.transform=""}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var m=this;var p=m.parent.parent.element;var n=m.titleContainer.getComponent("title");var q=false;if(q){m.fireEvent("articleClick",m.article,m.article.guid)}else{if(!m.hasImage&&!m.expand){if(m.titleContainer.getComponent("articleBody")!=null){if(m.titleContainer.getComponent("articleBody").isHidden()){m.titleContainer.getComponent("articleBody").show()}else{m.titleContainer.getComponent("articleBody").hide()}}}clearInterval(m.timer);if(!m.expand){m.fireEvent("tileTapped",m);m.titleContainer.setPadding(40);if(m.titleContainer.getComponent("title")!=null){var h=m.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=m.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var l=localStorage.getItem("headlineFontSize"+publicationguid)}else{var l=32}$(".headline").css("font-size",l+"px")}var k=m.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=m.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(m.article.body.indexOf("<p>")!=-1){m.article.body=m.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(m.hasImage){m.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292;z-index:16;",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(p.dom.scrollHeight),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+m.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+m.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+m.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+m.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+m.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var r=m.articlePop.getComponent("title").element.down("div");r.dom.style.padding="40px";m.sharingImage=m.articlePop.getComponent("title").getComponent("sharing");m.setupSharing(true);m.sharingImage.show();m.imageContainer.hide();m.titleContainer.hide();m.articlePop.getComponent("image").element.dom.style.background="url('"+m.firstImage.url+"')";if(m.imageAspect){m.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";m.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{m.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";m.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}m.add(m.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var l=localStorage.getItem("headlineFontSize"+publicationguid)}else{var l=32}$(".headline").css("font-size",l+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");m.articlePop.getComponent("title").element.dom.style.position="relative";m.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){m.articlePop.setScrollable(false);m.desktopScroll=m.element.down(".x-scroll-view");if(m.desktopScroll!=null){m.desktopScroll.dom.style.overflowY="scroll";m.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(m.desktopScroll.down(".x-scroll-container")!=null){$(m.element.dom).on("animationend",function(){m.desktopScroll.down(".x-scroll-container").dom.style.height=(m.articlePop.items.items[0].element.dom.clientHeight+m.articlePop.items.items[1].element.dom.clientHeight+40)+"px"})}}m.stopPropFunction=function(s){s.stopPropagation()};m.element.dom.onmousewheel=m.stopPropFunction;m.element.dom.addEventListener("DOMMouseScroll",m.stopPropFunction)}}else{m.articlePop.getScrollable().getScroller().on({scroll:function(v){var u=m.articlePop.getComponent("image").element.dom.style.height.substring(0,m.articlePop.getComponent("image").element.dom.style.height.length-2);var t=m.articlePop.getScrollable().getScroller().position.y;var s=m.articlePop.getComponent("image").element.dom.style.height.substring(0,m.articlePop.getComponent("image").element.dom.style.height.length-2);if(((u-t)/s)>0){m.articlePop.getComponent("image").element.dom.style.top=(t)+"px";m.articlePop.getComponent("image").element.dom.style.opacity=((u-t)/s)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){m.titleContainer.setScrollable(false);m.desktopScroll=m.element.down(".x-scroll-view");if(m.desktopScroll!=null){m.desktopScroll.dom.style.overflowY="scroll";m.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(m.desktopScroll.down(".x-scroll-container")!=null){$(m.element.dom).on("animationend",function(){if(m.desktopScroll.down(".x-scroll-indicator-dark")!=null){m.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}m.desktopScroll.down(".x-scroll-container").dom.style.height=(m.titleContainer.items.items[0].element.dom.clientHeight+m.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}m.stopPropFunction=function(s){s.stopPropagation()};m.element.dom.onmousewheel=m.stopPropFunction;m.element.dom.addEventListener("DOMMouseScroll",m.stopPropFunction)}}else{m.titleContainer.setScrollable(true);m.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=m.titleContainer.getScrollable().getScroller()}m.titleContainer.element.dom.style.zIndex=14;if(m.sharingContainer=m.titleContainer.getComponent("title")!=null){m.sharingContainer=m.titleContainer.getComponent("title").getComponent("sharing");m.sharingContainer.show();m.setupSharing(false);m.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none"}if(m.bylineHidden){console.log(m.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(m.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}m.element.dom.style.position="absolute";m.element.dom.style.left="0px",m.element.dom.style.top="0px";p.dom.style.zIndex=8;m.expand=true;p.dom.style.animation=m.expandAnim;m.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1){if(m.hasImage){m.titleContainer.setPadding(10);if(m.sharingImage!=null){m.sharingImage.hide()}if(m.sharingContainer!=null){if(m.sharingContainer.hide!=null){m.sharingContainer.hide()}}if(m.titleContainer.getComponent("title")!=null){m.titleContainer.setScrollable(false);if(m.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){m.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}if(m.articlePop!=null){m.articlePop.destroy()}m.imageContainer.show();m.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(m.desktopScroll!=null){if(m.desktopScroll.dom!=null){m.desktopScroll.dom.style.overflowY=""}m.element.dom.onmousewheel=null;m.element.dom.removeEventListener("DOMMouseScroll",m.stopPropFunction)}}m.expand=false;p.dom.style.animation=m.shrinkAnim;setTimeout(function(){m.element.dom.style.zIndex=4},300)}else{m.titleContainer.setPadding(10);if(m.sharingImage!=null){m.sharingImage.hide()}if(m.sharingContainer!=null){if(m.sharingContainer.hide!=null){m.sharingContainer.hide()}}if(m.titleContainer.getComponent("title")!=null){m.titleContainer.setScrollable(false);if(m.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){m.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){m.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var b=m.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=m.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=m.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=m.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(m.desktopScroll!=null){m.desktopScroll.dom.style.overflowY="";m.element.dom.onmousewheel=null;m.element.dom.removeEventListener("DOMMouseScroll",m.stopPropFunction);if(Ext.browser.is.IE){m.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}if(m.titleContainer.getComponent("title")!=null){m.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display=""}if(m.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(m.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(m.titleContainer.getComponent("articleBody")!=null){if(m.titleContainer.getComponent("articleBody").isHidden()){m.titleContainer.getComponent("articleBody").show()}else{m.titleContainer.getComponent("articleBody").hide()}}m.expand=false;p.dom.style.animation=m.shrinkAnim;setTimeout(function(){m.element.dom.style.zIndex=4},300)}}}}},liveTap:function(){var a=this;window.open(a.article.url)},setupTextSize:function(){var h=this;if(h.expand){if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var j=localStorage.getItem("headlineFontSize"+publicationguid)}else{var j=32}$(".headline").css("font-size",j+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var f=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var f=20}$(".subheadline").css("font-size",f+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px")}else{if(!h.hasImage){if(h.element!=null){var b=h.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var g=h.element.down(".subheadline");if(g!=null){$(g.dom).attr("class","subheadlineText")}var e=h.element.down(".byline");if(e!=null){$(e.dom).attr("class","bylineText")}var k=h.element.down(".section");if(k!=null){$(k.dom).attr("class","sectionText")}}}}},testFunc:function(){console.log("TEST")}},0,["articlereaderitemtopstoryitem"],["component","container","panel","articlereaderitemtopstoryitem"],{component:true,container:true,panel:true,articlereaderitemtopstoryitem:true},["widget.articlereaderitemtopstoryitem"],0,[InfinityMobile.view.desktop,"ArticleReaderItemTopStoryItem"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemTopStories",Ext.Container,{config:{width:"768px",style:"float:left;z-index:6;background-color:black;",items:[{itemId:"leftBtn",width:30,height:66.6,style:"background-image:url('../assets/nav/left-arrow.png');position:absolute;left:5px;top:50%;transform:translateY(-50%);background-size:contain;background-repeat:no-repeat;z-index:7;"},{itemId:"carousel",xtype:"carousel",top:5,bottom:5,left:5,right:5,style:"z-index:6;"},{itemId:"rightBtn",width:30,height:66.6,style:"background-image:url('../assets/nav/right-arrow.png');position:absolute;right:5px;top:50%;transform:translateY(-50%);background-size:contain;background-repeat:no-repeat;z-index:7;"}]},initialize:function(){var d=this;Ext.Container.prototype.initialize.apply(this,arguments);d.leftBtn=d.getComponent("leftBtn");d.rightBtn=d.getComponent("rightBtn");d.carousel=d.getComponent("carousel");if(d.config.articles!=null){d.articles=d.config.articles}if(d.config.expandAnim!=null){d.expandAnim=d.config.expandAnim}d.setStyle("height:60%;");d.carousel.element.on({drag:function(g){g.stopPropagation()},dragend:function(g){g.stopPropagation()}});d.leftBtn.element.on({tap:"leftScroll",scope:d});d.rightBtn.element.on({tap:"rightScroll",scope:d});d.objects=[];for(var c=0;c<d.articles.length;c++){var a=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemTopStoryItem",{style:"position:absolute;top:0px;left;0px;height:100%;",article:d.articles[c],articleIndex:c,expandAnim:d.expandAnim});d.objects[d.objects.length]=a;d.carousel.add(a)}var f=[];var e;var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.dynamic.weather!=null){if(b.data.items[0].raw.dynamic.weather.url!=null){if(b.data.items[0].raw.dynamic.weather.url.length>0){$.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&q="+encodeURIComponent(b.data.items[0].raw.dynamic.weather.url),dataType:"json",success:function(g){$.each(g.responseData.feed.entries,function(j,k){f[f.length]=k;e=g.responseData.feed.title.substring(g.responseData.feed.title.indexOf("for")+4,g.responseData.feed.title.length)});var h=Ext.create("InfinityMobile.view.desktop.ArticleReaderItemWeatherTile",{weather:f,title:e,articleIndex:d.objects.length,carousel:d,expandAnim:d.expandAnim});d.objects[d.objects.length]=h;if(f!=null){d.carousel.add(h)}}})}}}d.timer;d.timer=setInterval(function(){if(d.carousel.getActiveItem().articleIndex==d.objects.length-1){d.carousel.setActiveItem(0)}else{d.carousel.next()}},5000);d.carousel.on("activeitemchange","handleItemChange",this);d.carousel.element.on("tap","onTap",this)},leftScroll:function(){var a=this;a.carousel.previous()},rightScroll:function(){var a=this;a.carousel.next()},handleItemChange:function(){var b=this;if(b.objects!=null){for(var a=0;a<b.objects.length;a++){b.objects[a].setupTextSize()}}},onTap:function(f){var d=this;var c=false;if(c){if(d.carousel.getActiveItem().weather!=null){if(d.timer!=null){clearInterval(d.timer);d.timer=null;d.rightBtn.hide();d.leftBtn.hide()}else{d.rightBtn.show();d.leftBtn.show();d.timer=setInterval(function(){if(d.carousel.getActiveItem().articleIndex==d.articles.length){d.carousel.setActiveItem(0)}else{d.carousel.next()}},5000)}}}else{if(d.timer!=null){clearInterval(d.timer);d.timer=null;var a=d.carousel.getItems();for(var b=0;b<d.objects.length;b++){if(d.objects[b].articleIndex!=d.carousel.getActiveItem().articleIndex){d.objects[b].onTap(f);d.rightBtn.hide();d.leftBtn.hide();d.fireEvent("tileTapped",d)}}}else{for(var b=0;b<d.objects.length;b++){if(d.objects[b].articleIndex!=d.carousel.getActiveItem().articleIndex){d.objects[b].onTap(f);d.rightBtn.show();d.leftBtn.show()}}d.timer=setInterval(function(){if(d.carousel.getActiveItem().articleIndex==d.articles.length){d.carousel.setActiveItem(0)}else{d.carousel.next()}},5000)}}}},0,["articlereaderitemtopstories"],["component","container","articlereaderitemtopstories"],{component:true,container:true,articlereaderitemtopstories:true},["widget.articlereaderitemtopstories"],0,[InfinityMobile.view.desktop,"ArticleReaderItemTopStories"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticlePopoverItemDynamic",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",style:"background-color:white",layout:"vbox",items:[{itemId:"content",flex:1,padding:"0 0 10px 0",style:"overflow-y:scroll;"}]},initialize:function(){var a=this;a.content=a.getComponent("content");Ext.Container.prototype.initialize.apply(this,arguments);a.getContent()},setContentStyle:function(){var a=this;if(currentProfile=="tablet"){a.content.setPadding("0 20px 0 20px")}},getContent:function(){var b=this;var a=b.articleGuid;console.log(a);$.ajax({crossDomain:true,type:"GET",contentType:"text/html",async:true,url:"../article_popover.aspx?articleguid="+a+"&html5="+currentProfile,success:function(f){var e=Ext.getStore("SettingStore");if(e.data.items[0].raw.reader.popupAdvert!=null){var j=e.data.items[0].raw.reader.popupAdvert.position;if(j=="top"){switch(currentProfile){case"phone":var g=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break}b.add(g);g.show()}}var d=f;var c=d.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(c){d=c[1]}d+="<script>setText()<\/script>";b.removeSpinner();b.content.setHtml(d);b.setImages();if(b.content.element!=null){setText(b.content.element.dom)}b.setStyle({visibility:"inherit"});if(e.data.items[0].raw.reader.popupAdvert!=null){if(j=="bottom"){switch(currentProfile){case"phone":var h=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var h=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var h=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{padding:"10px 0 0 0"});break}b.add(h);h.show()}}}})},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var f=this;var d=1;var c=1;var b=f.id;if(currentProfile=="tablet"){var e=$("#"+b+" img").get(0);if(e!=null){if(e.naturalWidth==0){e.onload=function(){var g=this;if(g.naturalWidth<(screen.width/2)){var h=$("#"+b+" .articleContent")[0];h.className="articleContent float"}}}}}if($("#"+b+" .contentImage").size()>1){if(currentProfile=="phone"){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREVIOUS"}c=$("#"+b+" .contentImage").size();if(c>1){$("#"+b+" .contentImage:gt(0)").hide();$("#"+b+" .previousImage").hide();a()}else{if(c==1){$("#"+b+" .imageControls").hide()}}$("#"+b+" .nextImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").next();h.hide();d++;a();g.fadeIn();$("#"+b+" .previousImage").show();if(g.is("#"+b+" .contentImage:last")){$("#"+b+" .nextImage").hide()}});$("#"+b+" .previousImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").prev();h.hide();d--;a();g.fadeIn();$("#"+b+" .nextImage").show();if(g.is("#"+b+" .contentImage:first")){$("#"+b+" .previousImage").hide()}})}else{$("#"+b+" .imageControls").hide()}function a(){var g="Image "+d.toString()+" of "+c.toString();$("#"+b+" .imageCount").text(g)}}},0,["readerarticlepopoveritemdynamic"],["component","container","readerarticlepopoveritemdynamic"],{component:true,container:true,readerarticlepopoveritemdynamic:true},["widget.readerarticlepopoveritemdynamic"],0,[InfinityMobile.view.desktop,"ArticlePopoverItemDynamic"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemMedWideTall",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;",height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setStyle("height:45%;overflow:hidden;width:512px;");a.height=45;a.width=512;a.x=a.element.dom.style.left.substring(0,a.element.dom.style.left.length-2);a.y=a.element.dom.style.top.substring(0,a.element.dom.style.top.length-1);a.top=a.y;a.left=a.x;a.timer;a.timer2;a.timer3;a.timer4;a.section=a.getComponent("section");a.height=a.element.dom.clientHeight;if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";c.imageAspect=false;if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;'>"+c.article.headline+"</p></div>");c.image=new Image();c.image.src=c.firstImage.url;c.image.onload=function(){var g=c.image.naturalWidth/c.image.naturalHeight;if(c.element!=null){var e=$(c.element.dom).width()/$(c.element.dom).height();if(g<1.2&&e>1.25){c.imageAspect=true;var f=$(c.element.dom).height()/c.image.naturalHeight;var d=c.image.naturalWidth*f;if(d>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}}};if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}},setNoImage:function(){var d=this;d.titleContainer.resetFloating();d.titleContainer.setStyle("background-color:#EEEEEE; color:black;");d.hasImage=false;d.sectionStr="";if(d.article.sections.length>1){for(var c=0;c<d.article.sections.length;c++){d.sectionStr+=d.article.sections[c]+"/"}d.sectionStr=d.sectionStr.substring(0,d.sectionStr.length-1)}else{if(d.article.sections[0]!=null){d.sectionStr=d.article.sections[0]}}if(d.article.shortStory!=null){var a=d.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(d.sectionStr=="LIVE NEWS"){if(d.article.link!=null){if(d.article.link.length>0){d.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+d.article.link+"\")' onclick='window.open(\""+d.article.link+"\")'>Click here to view full story</p>"}}}var e=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+d.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+d.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});e.element.on({painted:function(){if(!d.paintedTitle){var f=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var g=$(this.element.dom).height()-f;e.element.down(".shortStory").dom.style.maxHeight=(g-(g%14)-26)+"px";if(e.element.down(".bylineText").dom.clientHeight+e.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true}if(e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadline=true}d.paintedTitle=true}},scope:d});d.titleContainer.add(e);if(d.article.body!=null){if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}d.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:d.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var e=this;var h=e.titleContainer.getComponent("title");if(h!=null){var a=h.element.down(".sectionText").dom.clientHeight+h.element.down(".headlineText").dom.clientHeight+h.element.down(".subheadlineText").dom.clientHeight+h.element.down(".bylineText").dom.clientHeight;var c=$(this.element.dom).height()-a;h.element.down(".shortStory").dom.style.maxHeight=(c-(c%14)-26)+"px";if(parseFloat(h.element.down(".bylineText").dom.clientHeight)+parseFloat(h.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".bylineText").dom.style.visibility="hidden";e.bylineHidden=true}else{h.element.down(".bylineText").dom.style.visibility="";e.bylineHidden=false}if(parseFloat(h.element.down(".subheadlineText").dom.clientHeight)+parseFloat(h.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".subheadlineText").dom.style.visibility="hidden";e.subheadline=true}else{h.element.down(".subheadlineText").dom.style.visibility="";e.subheadlineHidden=false}}if(e.hasImage){var g=e.image.naturalWidth/e.image.naturalHeight;var d=$(e.element.dom).width()/$(e.element.dom).height();if(g<1.2&&d>1.25){e.imageAspect=true;var f=$(e.element.dom).height()/e.image.naturalHeight;var b=e.image.naturalWidth*f;if(b>$(e.element.dom).width()/2){e.imageContainer.element.dom.style.backgroundSize="50%";e.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{e.imageContainer.element.dom.style.backgroundSize=" auto 100%";e.imageContainer.element.dom.style.backgroundPosition="0% 0%"}e.titleContainer.element.down(".tileText").dom.style.bottom="";e.titleContainer.element.down(".tileText").dom.style.top="50%";e.titleContainer.element.down(".tileText").dom.style.left="55%";e.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}else{e.imageAspect=false;e.imageContainer.element.dom.style.backgroundSize="cover";e.imageContainer.element.dom.style.backgroundPosition="50% 0%";e.imageContainer.element.dom.style.backgroundColor="gray";e.titleContainer.element.down(".tileText").dom.style.bottom="10px";e.titleContainer.element.down(".tileText").dom.style.top="";e.titleContainer.element.down(".tileText").dom.style.left="10px";e.titleContainer.element.down(".tileText").dom.style.transform=""}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var l=this;var n=l.titleContainer.getComponent("title");var p=false;if(p&&l.sectionStr.indexOf("LIVE NEWS")==-1){l.fireEvent("articleClick",l.article,l.article.guid)}else{if(p&&l.sectionStr.indexOf("LIVE NEWS")!=1){l.fireEvent("liveArticleClick",l.article)}else{if(!l.hasImage&&!l.expand){if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}}clearInterval(l.timer);clearInterval(l.timer2);clearInterval(l.timer3);clearInterval(l.timer);if(!l.expand){l.fireEvent("tileTapped",l);l.titleContainer.setPadding(40);if(l.titleContainer.getComponent("title")!=null){var h=l.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=l.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px")}var k=l.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=l.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(l.article.body.indexOf("<p>")!=-1){l.article.body=l.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(l.hasImage){l.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(l.imageContainer.element.dom.scrollHeight*1.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+l.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+l.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+l.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+l.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+l.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var q=l.articlePop.getComponent("title").element.down("div");q.dom.style.padding="40px";l.sharingImage=l.articlePop.getComponent("title").getComponent("sharing");l.setupSharing(true);l.sharingImage.show();l.imageContainer.hide();l.titleContainer.hide();l.articlePop.getComponent("image").element.dom.style.background="url('"+l.firstImage.url+"')";if(l.imageAspect){l.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{l.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}l.add(l.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");l.articlePop.getComponent("title").element.dom.style.position="relative";l.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.articlePop.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.articlePop.items.items[0]!=null&&l.articlePop.items.items[1]!=null){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.articlePop.items.items[0].element.dom.clientHeight+l.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.articlePop.getScrollable().getScroller().on({scroll:function(u){var t=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);var s=l.articlePop.getScrollable().getScroller().position.y;var r=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);if(((t-s)/r)>0){l.articlePop.getComponent("image").element.dom.style.top=(s)+"px";l.articlePop.getComponent("image").element.dom.style.opacity=((t-s)/r)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.titleContainer.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.desktopScroll.down(".x-scroll-indicator-dark")!=null){l.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.titleContainer.items.items[0].element.dom.clientHeight+l.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.titleContainer.setScrollable(true);l.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=l.titleContainer.getScrollable().getScroller();f.container.dom.offsetParent.style.zIndex=14}l.sharingContainer=l.titleContainer.getComponent("title").getComponent("sharing");l.sharingContainer.show();l.setupSharing(false);l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(l.bylineHidden){console.log(l.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}l.element.dom.style.zIndex=10;l.expand=true;l.element.dom.style.animation=l.expandAnim;l.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1&&j.target.className.indexOf("fullStoryLink")==-1){if(l.hasImage){l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}l.articlePop.destroy();l.imageContainer.show();l.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction)}}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}else{l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var b=l.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=l.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=l.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=l.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="";l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction);if(Ext.browser.is.IE){l.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(l.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemmedwidetall"],["component","container","panel","articlereaderitemmedwidetall"],{component:true,container:true,panel:true,articlereaderitemmedwidetall:true},["widget.articlereaderitemmedwidetall"],0,[InfinityMobile.view.desktop,"ArticleReaderItemMedWideTall"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemMedTall",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;",height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setStyle("height:45%;overflow:hidden;width:256px;");a.height=45;a.width=256;a.x=a.element.dom.style.left.substring(0,a.element.dom.style.left.length-2);a.y=a.element.dom.style.top.substring(0,a.element.dom.style.top.length-1);a.top=a.y;a.left=a.x;a.timer;a.timer2;a.timer3;a.timer4;a.section=a.getComponent("section");a.height=a.element.dom.clientHeight;if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}c.titleContainer.setHtml("<div style='position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;'>"+c.article.headline+"</p></div>")},setNoImage:function(){var d=this;d.titleContainer.resetFloating();d.titleContainer.setStyle("background-color:#EEEEEE; color:black;");d.hasImage=false;d.sectionStr="";if(d.article.sections.length>1){for(var c=0;c<d.article.sections.length;c++){d.sectionStr+=d.article.sections[c]+"/"}d.sectionStr=d.sectionStr.substring(0,d.sectionStr.length-1)}else{if(d.article.sections[0]!=null){d.sectionStr=d.article.sections[0]}}if(d.article.shortStory!=null){var a=d.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(d.sectionStr=="LIVE NEWS"){if(d.article.link!=null){if(d.article.link.length>0){d.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+d.article.link+"\")' onclick='window.open(\""+d.article.link+"\")'>Click here to view full story</p>"}}}var e=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+d.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+d.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});e.element.on({painted:function(){if(!d.paintedTitle){var f=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var g=$(this.element.dom).height()-f;e.element.down(".shortStory").dom.style.maxHeight=(g-(g%14)-26)+"px";if(e.element.down(".bylineText").dom.clientHeight+e.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true}if(e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadline=true}d.paintedTitle=true}},scope:d});d.titleContainer.add(e);if(d.article.body!=null){if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}d.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:d.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var c=this;var d=c.titleContainer.getComponent("title");if(d!=null){var a=d.element.down(".sectionText").dom.clientHeight+d.element.down(".headlineText").dom.clientHeight+d.element.down(".subheadlineText").dom.clientHeight+d.element.down(".bylineText").dom.clientHeight;var b=$(this.element.dom).height()-a;d.element.down(".shortStory").dom.style.maxHeight=(b-(b%14)-26)+"px";if(parseFloat(d.element.down(".bylineText").dom.clientHeight)+parseFloat(d.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){d.element.down(".bylineText").dom.style.visibility="hidden";c.bylineHidden=true}else{d.element.down(".bylineText").dom.style.visibility="";c.bylineHidden=false}if(parseFloat(d.element.down(".subheadlineText").dom.clientHeight)+parseFloat(d.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){d.element.down(".subheadlineText").dom.style.visibility="hidden";c.subheadline=true}else{d.element.down(".subheadlineText").dom.style.visibility="";c.subheadlineHidden=false}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var l=this;var n=l.titleContainer.getComponent("title");var p=false;if(p&&l.sectionStr.indexOf("LIVE NEWS")==-1){l.fireEvent("articleClick",l.article,l.article.guid)}else{if(p&&l.sectionStr.indexOf("LIVE NEWS")!=1){l.fireEvent("liveArticleClick",l.article)}else{if(!l.hasImage&&!l.expand){if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}}clearInterval(l.timer);clearInterval(l.timer2);clearInterval(l.timer3);clearInterval(l.timer);if(!l.expand){l.fireEvent("tileTapped",l);l.titleContainer.setPadding(40);if(l.titleContainer.getComponent("title")!=null){var h=l.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=l.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px")}var k=l.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=l.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(l.article.body.indexOf("<p>")!=-1){l.article.body=l.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(l.hasImage){l.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(l.imageContainer.element.dom.scrollHeight*1.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+l.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+l.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+l.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+l.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+l.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var q=l.articlePop.getComponent("title").element.down("div");q.dom.style.padding="40px";l.sharingImage=l.articlePop.getComponent("title").getComponent("sharing");l.setupSharing(true);l.sharingImage.show();l.imageContainer.hide();l.titleContainer.hide();l.articlePop.getComponent("image").element.dom.style.background="url('"+l.firstImage.url+"')";l.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%";l.add(l.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");l.articlePop.getComponent("title").element.dom.style.position="relative";l.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.articlePop.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.articlePop.items.items[0]!=null&&l.articlePop.items.items[1]!=null){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.articlePop.items.items[0].element.dom.clientHeight+l.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.articlePop.getScrollable().getScroller().on({scroll:function(u){var t=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);var s=l.articlePop.getScrollable().getScroller().position.y;var r=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);if(((t-s)/r)>0){l.articlePop.getComponent("image").element.dom.style.top=(s)+"px";l.articlePop.getComponent("image").element.dom.style.opacity=((t-s)/r)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.titleContainer.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.desktopScroll.down(".x-scroll-indicator-dark")!=null){l.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.titleContainer.items.items[0].element.dom.clientHeight+l.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.titleContainer.setScrollable(true);l.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=l.titleContainer.getScrollable().getScroller();f.container.dom.offsetParent.style.zIndex=14}l.sharingContainer=l.titleContainer.getComponent("title").getComponent("sharing");l.sharingContainer.show();l.setupSharing(false);l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(l.bylineHidden){console.log(l.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}l.element.dom.style.zIndex=8;l.expand=true;l.element.dom.style.animation=l.expandAnim;l.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1&&j.target.className.indexOf("fullStoryLink")==-1){if(l.hasImage){l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}l.articlePop.destroy();l.imageContainer.show();l.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction)}}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}else{l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var b=l.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=l.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=l.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=l.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="";l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction);if(Ext.browser.is.IE){l.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(l.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemmedtall"],["component","container","panel","articlereaderitemmedtall"],{component:true,container:true,panel:true,articlereaderitemmedtall:true},["widget.articlereaderitemmedtall"],0,[InfinityMobile.view.desktop,"ArticleReaderItemMedTall"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemMedWide",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;",height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setStyle("height:30%;overflow:hidden;width:512px;");a.height=30;a.width=512;a.x=a.element.dom.style.left.substring(0,a.element.dom.style.left.length-2);a.y=a.element.dom.style.top.substring(0,a.element.dom.style.top.length-1);a.top=a.y;a.left=a.x;a.timer;a.timer2;a.timer3;a.timer4;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";c.imageAspect=false;if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;'>"+c.article.headline+"</p></div>");c.image=new Image();c.image.src=c.firstImage.url;c.image.onload=function(){var g=c.image.naturalWidth/c.image.naturalHeight;if(c.element!=null){var e=$(c.element.dom).width()/$(c.element.dom).height();if(g<1.2&&e>1.25){c.imageAspect=true;var f=$(c.element.dom).height()/c.image.naturalHeight;var d=c.image.naturalWidth*f;if(d>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}}};if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}},setNoImage:function(){var d=this;d.titleContainer.resetFloating();d.titleContainer.setStyle("background-color:#EEEEEE; color:black;");d.sectionStr="";if(d.article.sections.length>1){for(var c=0;c<d.article.sections.length;c++){d.sectionStr+=d.article.sections[c]+"/"}d.sectionStr=d.sectionStr.substring(0,sectionStr.length-1)}else{if(d.article.sections[0]!=null){d.sectionStr=d.article.sections[0]}}if(d.article.shortStory!=null){var a=d.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(d.sectionStr=="LIVE NEWS"){if(d.article.link!=null){if(d.article.link.length>0){d.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+d.article.link+"\")' onclick='window.open(\""+d.article.link+"\")'>Click here to view full story</p>"}}}var e=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+d.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+d.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});e.element.on({painted:function(){if(!d.paintedTitle){var f=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var g=$(this.element.dom).height()-f;e.element.down(".shortStory").dom.style.maxHeight=(g-(g%14)-26)+"px";if(e.element.down(".bylineText").dom.clientHeight+e.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true}if(e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadlineHidden=true}d.paintedTitle=true}},scope:d});d.titleContainer.add(e);if(d.article.body!=null){if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}d.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:d.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var e=this;var h=e.titleContainer.getComponent("title");if(h!=null){var a=h.element.down(".sectionText").dom.clientHeight+h.element.down(".headlineText").dom.clientHeight+h.element.down(".subheadlineText").dom.clientHeight+h.element.down(".bylineText").dom.clientHeight;var c=$(this.element.dom).height()-a;h.element.down(".shortStory").dom.style.maxHeight=(c-(c%14)-26)+"px";if(parseFloat(h.element.down(".bylineText").dom.clientHeight)+parseFloat(h.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".bylineText").dom.style.visibility="hidden";e.bylineHidden=true}else{h.element.down(".bylineText").dom.style.visibility="";e.bylineHidden=false}if(parseFloat(h.element.down(".subheadlineText").dom.clientHeight)+parseFloat(h.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".subheadlineText").dom.style.visibility="hidden";e.subheadlineHidden=true}else{h.element.down(".subheadlineText").dom.style.visibility="";e.subheadlineHidden=false}}if(e.hasImage){var g=e.image.naturalWidth/e.image.naturalHeight;var d=$(e.element.dom).width()/$(e.element.dom).height();if(g<1.2&&d>1.25){e.imageAspect=true;var f=$(e.element.dom).height()/e.image.naturalHeight;var b=e.image.naturalWidth*f;if(b>$(e.element.dom).width()/2){e.imageContainer.element.dom.style.backgroundSize="50%";e.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{e.imageContainer.element.dom.style.backgroundSize=" auto 100%";e.imageContainer.element.dom.style.backgroundPosition="0% 0%"}e.titleContainer.element.down(".tileText").dom.style.bottom="";e.titleContainer.element.down(".tileText").dom.style.top="50%";e.titleContainer.element.down(".tileText").dom.style.left="55%";e.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}else{e.imageAspect=false;e.imageContainer.element.dom.style.backgroundSize="cover";e.imageContainer.element.dom.style.backgroundPosition="50% 0%";e.imageContainer.element.dom.style.backgroundColor="gray";e.titleContainer.element.down(".tileText").dom.style.bottom="10px";e.titleContainer.element.down(".tileText").dom.style.top="";e.titleContainer.element.down(".tileText").dom.style.left="10px";e.titleContainer.element.down(".tileText").dom.style.transform=""}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var l=this;var p=false;var n=l.titleContainer.getComponent("title");if(p&&l.sectionStr.indexOf("LIVE NEWS")==-1){l.fireEvent("articleClick",l.article,l.article.guid)}else{if(p&&l.sectionStr.indexOf("LIVE NEWS")!=1){l.fireEvent("liveArticleClick",l.article)}else{if(!l.hasImage&&!l.expand){if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}}clearInterval(l.timer);clearInterval(l.timer2);clearInterval(l.timer3);clearInterval(l.timer);if(!l.expand){l.fireEvent("tileTapped",l);l.titleContainer.setPadding(40);if(l.titleContainer.getComponent("title")!=null){var h=l.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=l.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px")}var k=l.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=l.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(l.article.body.indexOf("<p>")!=-1){l.article.body=l.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(l.hasImage){l.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(l.imageContainer.element.dom.scrollHeight*1.5),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+l.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+l.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+l.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+l.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+l.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var q=l.articlePop.getComponent("title").element.down("div");q.dom.style.padding="40px";l.sharingImage=l.articlePop.getComponent("title").getComponent("sharing");l.setupSharing(true);l.sharingImage.show();l.imageContainer.hide();l.titleContainer.hide();l.articlePop.getComponent("image").element.dom.style.background="url('"+l.firstImage.url+"')";if(l.imageAspect){l.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{l.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}l.add(l.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");l.articlePop.getComponent("title").element.dom.style.position="relative";l.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.articlePop.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.articlePop.items.items[0]!=null&&l.articlePop.items.items[1]!=null){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.articlePop.items.items[0].element.dom.clientHeight+l.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.articlePop.getScrollable().getScroller().on({scroll:function(u){var t=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);var s=l.articlePop.getScrollable().getScroller().position.y;var r=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);if(((t-s)/r)>0){l.articlePop.getComponent("image").element.dom.style.top=(s)+"px";l.articlePop.getComponent("image").element.dom.style.opacity=((t-s)/r)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.titleContainer.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.desktopScroll.down(".x-scroll-indicator-dark")!=null){l.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.titleContainer.items.items[0].element.dom.clientHeight+l.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.titleContainer.setScrollable(true);l.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=l.titleContainer.getScrollable().getScroller();f.container.dom.offsetParent.style.zIndex=14}l.sharingContainer=l.titleContainer.getComponent("title").getComponent("sharing");l.sharingContainer.show();l.setupSharing(false);l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(l.bylineHidden){console.log(l.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}l.element.dom.style.zIndex=10;l.expand=true;l.element.dom.style.animation=l.expandAnim;l.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1&&j.target.className.indexOf("fullStoryLink")==-1){if(l.hasImage){l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}l.articlePop.destroy();l.imageContainer.show();l.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction)}}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}else{l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var b=l.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=l.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=l.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=l.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="";l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction);if(Ext.browser.is.IE){l.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(l.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemmedwide"],["component","container","panel","articlereaderitemmedwide"],{component:true,container:true,panel:true,articlereaderitemmedwide:true},["widget.articlereaderitemmedwide"],0,[InfinityMobile.view.desktop,"ArticleReaderItemMedWide"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderBannerAd",Ext.Panel,{config:{style:"padding:0px:overflow:none;",width:"100%",items:[{itemId:"advert",cls:"advert",style:"position:absolute;top:50%;left:50%;transform:translate3d(-50%, -50%, 0px);"}]},initialize:function(){var c=this;c.advertContainer=c.getComponent("advert");var a=settings.reader.interstitial;if(c.config.settings!=null){c.settings=c.config.settings}if(c.settings.type=="url"){var b=settings.dynamic.adverts.bannerAd.url;c.advertContainer.setHtml("<iframe width='728' height='90' style='border:none;' scrolling='no' src='"+b+"' />")}else{if(c.settings.type=="dfp"){c.networkCode=c.settings.networkCode;c.adUnit=c.settings.adUnit;c.advertDivID=c.id+"advert";c.advertContainer.setHtml("<div id='"+c.advertDivID+"' style='width:734px;height:95px;margin:auto;'></div>");c.advertDiv=c.element.down("#"+c.advertDivID);c.on("painted",c.loadAdvert,c,{delay:10,single:true});c.on("resize",c.onResizeFn,c)}else{c.advertContainer.setHtml("<div style='width:100%;height:100%;text-align:center;margin:auto;'><img style='height:100%;margin-left:5px;margin-right:5px;' src='"+c.settings.url+"' /></div>");c.advertDiv=c.element.down("#"+c.advertDivID);c.on("painted",c.loadAdvert,c,{delay:10,single:true});c.on("resize",c.onResizeFn,c)}}},loadAdvert:function(){var a=this;googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("728"),parseInt("90")],a.advertDivID);b.addService(googletag.pubads());googletag.pubads().addEventListener("slotRenderEnded",function(c){if(c.slot==b){if(c.isEmpty){a.hide()}else{if($(a.element.dom).height()<90){a.advertContainer.element.dom.style.top="0%";a.advertContainer.element.dom.style.transform="translate3d(-50%, 0px, 0px)"}}}});googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})},onResizeFn:function(a){var d=this;if(d.advertDiv!=null){if(d.advertDiv.down("iframe")!=null){var c=d.advertDiv.down("iframe").dom;var b=c.contentDocument||c.contentWindow.document;var e=document.createElement("script");e.innerHTML='setTimeout(function(){ document.addEventListener("touchmove", function (e) { e.preventDefault(); }); }, 500)';b.addEventListener("touchmove",function(f){f.preventDefault()});b.body.appendChild(e);d.advertDiv.dom.addEventListener("touchmove",function(f){f.preventDefault()})}}if($(d.element.dom).height()<90){d.advertContainer.element.dom.style.top="0%";d.advertContainer.element.dom.style.transform="translate3d(-50%, 0px, 0px)"}else{d.advertContainer.element.dom.style.top="50%";d.advertContainer.element.dom.style.transform="translate3d(-50%, -50%, 0px)"}}},0,["articlereaderbannerad"],["component","container","panel","articlereaderbannerad"],{component:true,container:true,panel:true,articlereaderbannerad:true},["widget.articlereaderbannerad"],0,[InfinityMobile.view.desktop,"ArticleReaderBannerAd"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemContainer",Ext.Container,{config:{height:"80%",width:768}},0,["articlereaderitemcontainer"],["component","container","articlereaderitemcontainer"],{component:true,container:true,articlereaderitemcontainer:true},["widget.articlereaderitemcontainer"],0,[InfinityMobile.view.desktop,"ArticleReaderItemContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemSmall",Ext.Panel,{config:{padding:5,style:"float:left;background-color:white;z-index:7;overflow:hidden;height:30% !important;width: 256px !important",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,padding:10,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;",height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.imageContainer=a.getComponent("image");a.titleContainer=a.getComponent("title");a.setStyle("height:30%;width:256px;");a.height=30;a.width=256;a.x=a.element.dom.style.left.substring(0,a.element.dom.style.left.length-2);a.y=a.element.dom.style.top.substring(0,a.element.dom.style.top.length-1);a.top=a.y;a.left=a.x;a.timer;a.timer2;a.timer3;a.timer4;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.background="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;overflow:hidden;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}c.titleContainer.setHtml("<div style='position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:semibold;'>"+c.article.headline+"</p></div>")},setNoImage:function(){var d=this;d.titleContainer.resetFloating();d.titleContainer.setStyle("background-color:#EEEEEE; color:black;overflow:hidden;");d.sectionStr="";if(d.article.sections.length>1){for(var c=0;c<d.article.sections.length;c++){d.sectionStr+=d.article.sections[c]+"/"}d.sectionStr=d.sectionStr.substring(0,sectionStr.length-1)}else{if(d.article.sections[0]!=null){d.sectionStr=d.article.sections[0]}}if(d.article.shortStory!=null){var a=d.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(d.sectionStr=="LIVE NEWS"){if(d.article.link!=null){if(d.article.link.length>0){d.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+d.article.link+"\")' onclick='window.open(\""+d.article.link+"\")'>Click here to view full story</p>"}}}var e=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;'>"+d.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;margin-bottom:5px;'>"+d.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px !important;font-weight:normal !important;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});e.element.on({painted:function(){if(!d.paintedTitle){var f=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var g=$(this.element.dom).height()-f;var h=(g-(g%14)-26);if(h<0){h=0}e.element.down(".shortStory").dom.style.maxHeight=h+"px";if(e.element.down(".bylineText").dom.clientHeight+e.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true;console.log(d.bylineHidden)}if(e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadlineHidden=true}d.paintedTitle=true}},scope:d});d.titleContainer.add(e);if(d.article.body!=null){if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}d.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",flex:1,width:"100%",html:d.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;padding-bottom:5px;",hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var d=this;var e=d.titleContainer.getComponent("title");if(e!=null){var a=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var b=$(this.element.dom).height()-a;var c=(b-(b%14)-26);if(c<0){c=0}e.element.down(".shortStory").dom.style.maxHeight=c+"px";if(parseFloat(e.element.down(".bylineText").dom.clientHeight)+parseFloat(e.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true}else{e.element.down(".bylineText").dom.style.visibility="";d.bylineHidden=false}if(parseFloat(e.element.down(".subheadlineText").dom.clientHeight)+parseFloat(e.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadlineHidden=true}else{e.element.down(".subheadlineText").dom.style.visibility="";d.subheadlineHidden=false}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var l=this;var p=false;var n=l.titleContainer.getComponent("title");if(p&&l.sectionStr.indexOf("LIVE NEWS")==-1){l.fireEvent("articleClick",l.article,l.article.guid)}else{if(p&&l.sectionStr.indexOf("LIVE NEWS")!=1){l.fireEvent("liveArticleClick",l.article)}else{if(!l.hasImage&&!l.expand){if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}}clearInterval(l.timer);clearInterval(l.timer2);clearInterval(l.timer3);clearInterval(l.timer);if(!l.expand){l.fireEvent("tileTapped",l);l.titleContainer.setPadding(40);if(l.titleContainer.getComponent("title")!=null){var h=l.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=l.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px")}var k=l.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=l.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(l.article.body.indexOf("<p>")!=-1){l.article.body=l.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(l.hasImage){l.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(l.imageContainer.element.dom.scrollHeight*2.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+l.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+l.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+l.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+l.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-weight:normal;'>"+l.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var q=l.articlePop.getComponent("title").element.down("div");q.dom.style.padding="40px";l.sharingImage=l.articlePop.getComponent("title").getComponent("sharing");l.setupSharing(true);l.sharingImage.show();l.imageContainer.hide();l.titleContainer.hide();l.articlePop.getComponent("image").element.dom.style.background="url('"+l.firstImage.url+"')";l.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%";l.add(l.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");l.articlePop.getComponent("title").element.dom.style.position="relative";l.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.articlePop.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.articlePop.items.items[0]!=null&&l.articlePop.items.items[1]!=null){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.articlePop.items.items[0].element.dom.clientHeight+l.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.articlePop.getScrollable().getScroller().on({scroll:function(u){var t=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);var s=l.articlePop.getScrollable().getScroller().position.y;var r=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);if(((t-s)/r)>0){l.articlePop.getComponent("image").element.dom.style.top=(s)+"px";l.articlePop.getComponent("image").element.dom.style.opacity=((t-s)/r)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.titleContainer.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.titleContainer.items.items[0].element.dom.clientHeight+l.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.titleContainer.setScrollable(true);l.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=l.titleContainer.getScrollable().getScroller();f.container.dom.offsetParent.style.zIndex=14}l.sharingContainer=l.titleContainer.getComponent("title").getComponent("sharing");l.sharingContainer.show();l.setupSharing(false);l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(l.bylineHidden){console.log(l.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}l.element.dom.style.position="absolute";l.element.dom.style.zIndex=10;l.expand=true;l.element.dom.style.mozAnimation=l.expandAnim;l.element.dom.style.animation=l.expandAnim;l.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1&&j.target.className.indexOf("fullStoryLink")==-1){if(l.hasImage){l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}l.articlePop.destroy();l.imageContainer.show();l.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction)}}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}else{l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}var b=l.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=l.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=l.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=l.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="";l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction);if(Ext.browser.is.IE){l.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(l.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemsmall"],["component","container","panel","articlereaderitemsmall"],{component:true,container:true,panel:true,articlereaderitemsmall:true},["widget.articlereaderitemsmall"],0,[InfinityMobile.view.desktop,"ArticleReaderItemSmall"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderItemLrg",Ext.Panel,{config:{padding:5,style:"float:left;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold",padding:10,height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.expand=false;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;a.imageContainer=a.getComponent("image");if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.titleContainer=a.getComponent("title");a.setStyle("height:60%;width:768px;overflow:hidden;");a.height=60;a.timer;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";c.imageAspect=false;if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;'>"+c.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;'>"+c.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;>"+c.article.byline+"</p></div>");c.image=new Image();c.image.src=c.firstImage.url;c.image.onload=function(){var g=c.image.naturalWidth/c.image.naturalHeight;if(c.element!=null){var e=$(c.element.dom).width()/$(c.element.dom).height();if(g<1.3&&e>1.25){c.imageAspect=true;var f=$(c.element.dom).height()/c.image.naturalHeight;var d=c.image.naturalWidth*f;if(d>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}}};if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}},setNoImage:function(){var d=this;d.titleContainer.resetFloating();d.titleContainer.setStyle("background-color:#EEEEEE; color:black;");d.sectionStr="";if(d.article.sections.length>1){for(var c=0;c<d.article.sections.length;c++){d.sectionStr+=d.article.sections[c]+"/"}d.sectionStr=d.sectionStr.substring(0,sectionStr.length-1)}else{if(d.article.sections[0]!=null){d.sectionStr=d.article.sections[0]}}if(d.article.shortStory!=null){var a=d.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(d.sectionStr=="LIVE NEWS"){if(d.article.link!=null){if(d.article.link.length>0){d.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+d.article.link+"\")' onclick='window.open(\""+d.article.link+"\")'>Click here to view full story</p>"}}}var e=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+d.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+d.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});e.element.on({painted:function(){if(!d.paintedTitle){var f=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var g=$(this.element.dom).height()-f;e.element.down(".shortStory").dom.style.maxHeight=(g-(g%14)-26)+"px";if(e.element.down(".bylineText").dom.clientHeight+e.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true}if(e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadline=true}d.paintedTitle=true}},scope:d});d.titleContainer.add(e);if(d.article.body!=null){if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}d.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",width:"100%",html:d.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",flex:1,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var e=this;var h=e.titleContainer.getComponent("title");if(h!=null){var a=h.element.down(".sectionText").dom.clientHeight+h.element.down(".headlineText").dom.clientHeight+h.element.down(".subheadlineText").dom.clientHeight+h.element.down(".bylineText").dom.clientHeight;var c=$(this.element.dom).height()-a;h.element.down(".shortStory").dom.style.maxHeight=(c-(c%14)-26)+"px";if(parseFloat(h.element.down(".bylineText").dom.clientHeight)+parseFloat(h.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".bylineText").dom.style.visibility="hidden";e.bylineHidden=true}else{h.element.down(".bylineText").dom.style.visibility="";e.bylineHidden=false}if(parseFloat(h.element.down(".subheadlineText").dom.clientHeight)+parseFloat(h.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){h.element.down(".subheadlineText").dom.style.visibility="hidden";e.subheadlineHidden=true}else{h.element.down(".subheadlineText").dom.style.visibility="";e.subheadlineHidden=false}}if(e.hasImage){var g=e.image.naturalWidth/e.image.naturalHeight;var d=$(e.element.dom).width()/$(e.element.dom).height();if(g<1.3&&d>1.25){e.imageAspect=true;var f=$(e.element.dom).height()/e.image.naturalHeight;var b=e.image.naturalWidth*f;if(b>$(e.element.dom).width()/2){e.imageContainer.element.dom.style.backgroundSize="50%";e.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{e.imageContainer.element.dom.style.backgroundSize=" auto 100%";e.imageContainer.element.dom.style.backgroundPosition="0% 0%"}e.titleContainer.element.down(".tileText").dom.style.bottom="";e.titleContainer.element.down(".tileText").dom.style.top="50%";e.titleContainer.element.down(".tileText").dom.style.left="55%";e.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}else{e.imageAspect=false;e.imageContainer.element.dom.style.backgroundSize="cover";e.imageContainer.element.dom.style.backgroundPosition="50% 0%";e.imageContainer.element.dom.style.backgroundColor="gray";e.titleContainer.element.down(".tileText").dom.style.bottom="10px";e.titleContainer.element.down(".tileText").dom.style.top="";e.titleContainer.element.down(".tileText").dom.style.left="10px";e.titleContainer.element.down(".tileText").dom.style.transform=""}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var l=this;var n=l.titleContainer.getComponent("title");var p=false;if(p&&l.sectionStr.indexOf("LIVE NEWS")==-1){l.fireEvent("articleClick",l.article,l.article.guid)}else{if(p&&l.sectionStr.indexOf("LIVE NEWS")!=1){l.fireEvent("liveArticleClick",l.article)}else{if(!l.hasImage&&!l.expand){if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}}clearInterval(l.timer);if(!l.expand){l.fireEvent("tileTapped",l);l.titleContainer.setPadding(40);if(l.titleContainer.getComponent("title")!=null){var h=l.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=l.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px")}var k=l.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=l.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(l.article.body.indexOf("<p>")!=-1){l.article.body=l.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(l.hasImage){l.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(l.imageContainer.element.dom.scrollHeight*1.2),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+l.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+l.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+l.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+l.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+l.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var q=l.articlePop.getComponent("title").element.down("div");q.dom.style.padding="40px";l.sharingImage=l.articlePop.getComponent("title").getComponent("sharing");l.setupSharing(true);l.sharingImage.show();l.imageContainer.hide();l.titleContainer.hide();l.articlePop.getComponent("image").element.dom.style.background="url('"+l.firstImage.url+"')";if(l.imageAspect){l.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{l.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}l.add(l.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");l.articlePop.getComponent("title").element.dom.style.position="relative";l.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.articlePop.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.articlePop.items.items[0]!=null&&l.articlePop.items.items[1]!=null){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.articlePop.items.items[0].element.dom.clientHeight+l.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.articlePop.getScrollable().getScroller().on({scroll:function(u){var t=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);var s=l.articlePop.getScrollable().getScroller().position.y;var r=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);if(((t-s)/r)>0){l.articlePop.getComponent("image").element.dom.style.top=(s)+"px";l.articlePop.getComponent("image").element.dom.style.opacity=((t-s)/r)}}})}}else{if(currentProfile=="desktop"&&settings.dynamic.articleBehaviour=="scrollbar"){l.titleContainer.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.desktopScroll.down(".x-scroll-indicator-dark")!=null){l.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.titleContainer.items.items[0].element.dom.clientHeight+l.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.titleContainer.setScrollable(true);l.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=l.titleContainer.getScrollable().getScroller();f.container.dom.offsetParent.style.zIndex=14}l.sharingContainer=l.titleContainer.getComponent("title").getComponent("sharing");l.sharingContainer.show();l.setupSharing(false);l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(l.bylineHidden){console.log(l.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}l.element.dom.style.position="absolute";l.element.dom.style.left="0px",l.element.dom.style.top="0px";l.element.dom.style.zIndex=8;l.expand=true;l.element.dom.style.animation=l.expandAnim;l.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1&&j.target.className.indexOf("fullStoryLink")==-1){if(l.hasImage){l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}l.articlePop.destroy();l.imageContainer.show();l.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction)}}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}else{l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){1;l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var b=l.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=l.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=l.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=l.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="";l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction);if(Ext.browser.is.IE){l.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(l.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["articlereaderitemlrg"],["component","container","panel","articlereaderitemlrg"],{component:true,container:true,panel:true,articlereaderitemlrg:true},["widget.articlereaderitemlrg"],0,[InfinityMobile.view.desktop,"ArticleReaderItemLrg"],0));(Ext.cmd.derive("InfinityMobile.view.ReadAloudControls",Ext.Container,{config:{style:"border-radius:10px;display:inline-block !important;",height:38,width:116,margin:"-3 0 0 10",items:[{itemId:"controlPanel",height:"100%",width:"100%",layout:{type:"hbox"},style:"padding:3%;",items:[{cls:"audioControl",itemId:"play",height:"100%",width:35,style:"background-size:70% 70%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;",isPlaying:false},{width:"5%",height:"100%"},{width:"5%",height:"100%"},{cls:"audioControl",itemId:"restart",height:"100%",width:"30%",style:'background:url("resources/images/stop-ic.png") black;background-size:80% 80%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;'}]}]},initialize:function(){var a=this;if(a.config.target!=null){a.target=a.config.target}a.controlPanel=a.getComponent("controlPanel");a.playBtn=a.controlPanel.getComponent("play");a.playBtn.addCls("playReadAloud");a.restartBtn=a.controlPanel.getComponent("restart");a.setPosition();a.setButtonListeners()},setPosition:function(){var a=this;if(a.target!=null){}},setButtonListeners:function(){var a=this;a.restartBtn.hide();a.setWidth(35);a.type="play-stop";a.playBtn.element.on({tap:a.play,scope:a});a.restartBtn.element.on({tap:a.restart,scope:a})},play:function(b){var a=this;b.preventDefault();readAloud.controls=a;if(readAloud.status=="PLAYING"){if(a.type=="play-stop"){a.fireEvent("stopArticleText",a);a.playBtn.removeCls("stopReadAloud")}else{a.fireEvent("pauseArticleText",a);a.playBtn.removeCls("pauseReadAloud")}a.playBtn.addCls("playReadAloud")}else{a.fireEvent("playArticleText",a);if(a.type=="play-stop"){a.playBtn.addCls("stopReadAloud")}else{a.playBtn.addCls("pauseReadAloud")}a.playBtn.removeCls("playReadAloud")}},pause:function(){var a=this;readAloud.controls=a;a.fireEvent("pauseArticleText",a)},restart:function(b){var a=this;b.preventDefault();readAloud.controls=a;a.fireEvent("restartArticleText",a)}},0,["readaloudcontrols"],["component","container","readaloudcontrols"],{component:true,container:true,readaloudcontrols:true},["widget.readaloudcontrols"],0,[InfinityMobile.view,"ReadAloudControls"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderArticlePopover",Ext.Container,{config:{style:"padding:0px; border-radius:0px; background-color:white;",articleguid:"a3d9d9eb-36b5-46b6-94ee-31978e22dc78",fullscreen:true,modal:true,centered:true,hideOnMaskTap:true,height:"80%",width:"80%",maxHeight:768,maxWidth:1024,layout:"vbox",zIndex:20,items:[{itemId:"tooltiptool",cls:"tooltiptoolbar",style:"z-index:10000",hidden:true},{itemId:"topBar",height:50,layout:"hbox",padding:"10px 20px 0px 20px",items:[{itemId:"topBarShare",xtype:"readermenushare",layout:"hbox"},{itemId:"copyButton",cls:"topBarCopyButton",baseCls:"copyButton",text:"Copy Article"},{itemId:"topBarSelectText",cls:"topBarSelectText",html:'<div class="textSizeHtml5"><img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text-highlight-ic.png" ></div>',hidden:true,text:"Article Highlight Mode"},{width:10},{layout:"hbox",itemId:"interactiveContent",hidden:true,items:[{itemId:"topBarComic",html:'<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/comics-ic.png">',text:"Comics",margin:"0 10 0 0"},{itemId:"topBarPuzzle",html:'<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/puzzle-ic.png">',text:"Puzzles",margin:"0 10 0 0"},{itemId:"topBarSections",html:'<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/sections-ic-black.png">',hidden:true}]},{itemId:"topBarPrint",html:'<img style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="https://edition.pagesuite.com/tribune/print-icon.png" />',text:"Print"},{width:10},{itemId:"textControls",html:'<div class="textSizeHtml5"><img class="textIncrease" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text_Increase_Icon.png" ontouchstart="increaseText()" onclick="increaseText()">&nbsp;&nbsp;<img class="textDecrease" style="cursor:hand;cursor:pointer;width:32px;height:32px;" src="../assets/article%20view/Text_Decrease_Icon.png" ontouchstart="decreaseText()" onclick="decreaseText()"></div>'},{width:10},{itemId:"topBarTranslate",cls:"topBarTranslate pointerCursor",html:'<div class="textSizeHtml5"><span style="top: -8px;position: relative;margin: 8px;color: rgb(66, 145, 182);">Translate</span><img style="cursor:hand;cursor:pointer;width:28px;height:28px;margin-top:2px;" src="../assets/article view/Spain.png"></div>',right:125,padding:6,hidden:true},{itemId:"inappTranslate",baseCls:"inappTranslate",cls:"spain"},{itemId:"ttsControl",baseCls:"ttsToggle",status:"STOPPED"},{itemId:"readAloudControls",xtype:"readaloudcontrols",hidden:true},{itemId:"closeButton",cls:"pointerCursor",top:0,right:0,padding:"10px 20px 10px 20px",style:"color:#4291b6",layout:{type:"hbox",align:"center"},items:[{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:"Close"},{width:10},{height:26,html:'<img src="../assets/article view/article-close-btn.png" style="width:26px;" />'}]}]},{itemId:"content",flex:1,cls:"innerhtmlfullheight",padding:"0px 20px 0px 20px"},{itemId:"bottomNav",cls:"articleFooter",height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",align:"center"},items:[{itemId:"previousArticleButton",width:155,padding:"10 0 0 20",height:"100%",layout:"hbox",cls:"pointerCursor",items:[{itemId:"prev",html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{itemId:"previousTxt",style:"white-space:nowrap;",html:"Previous Article",padding:"0 0 0 5"}]},{flex:1},{itemId:"articleText",html:"Article X / Y"},{flex:1},{itemId:"nextArticleButton",padding:"10 20 0 0",height:"100%",layout:{type:"hbox",pack:"end"},cls:"pointerCursor",items:[{itemId:"nextTxt",html:"Next Article",padding:"0 5 0 0",style:"white-space:nowrap;"},{itemId:"next",html:"<img style='height:20px' src='../assets/article view/right-article-arrow.png' />"}]}]}]},initialize:function(){var d=this;d.highlightMode=false;if(d.config.hasComics!=null){d.hasComics=d.config.hasComics}if(d.config.hasPuzzles!=null){d.hasPuzzles=d.config.hasPuzzles}d.content=d.getComponent("content");var f=d.getComponent("topBar");d.topBarShare=f.getComponent("topBarShare");d.topBarFrame=d.topBarShare.element.down("iframe");d.topBarPrint=f.getComponent("topBarPrint");d.topBarTextControls=f.getComponent("textControls");d.closeButton=f.getComponent("closeButton");d.closeTxt=d.closeButton.getComponent("closeTxt");d.closeTxt.setHtml(language.close);d.setCloseButtonListener();var e=d.getComponent("bottomNav");d.previousArticleButton=e.getComponent("previousArticleButton");d.previousTxt=d.previousArticleButton.getComponent("previousTxt");var a="Previous";if(language!=null&&language.articlePopover!=null&&language.articlePopover.previousArticle!=null){a=language.articlePopover.previousArticle}d.previousTxt.setHtml(a);d.nextArticleButton=e.getComponent("nextArticleButton");d.nextTxt=d.nextArticleButton.getComponent("nextTxt");var c="Next";if(language!=null&&language.articlePopover!=null&&language.articlePopover.nextArticle!=null){c=language.articlePopover.nextArticle}d.nextTxt.setHtml(c);d.articleText=e.getComponent("articleText");d.ttsToggle=f.getComponent("ttsControl");d.copyButton=d.getComponent("topBar").getComponent("copyButton");d.readAloudControls=f.getComponent("readAloudControls");if(window.SpeechSynthesisUtterance!=undefined&&typeof isTribReader!="undefined"&&isTribReader){}else{if(window.SpeechSynthesisUtterance===undefined||settings.tts===undefined){d.ttsToggle.hide()}}d.inappTrans=d.getComponent("topBar").getComponent("inappTranslate");d.inappTrans.hide();if(typeof isTribReader!="undefined"){if(!isTribReader){d.copyButton.hide()}else{d.setCopyButtonListener()}}else{d.copyButton.hide()}d.setPrintListener();d.setNextButtonListener();d.setPreviousButtonListener();d.setTtsToggleListener();d.topBarSelectText=f.getComponent("topBarSelectText");d.topBarSelectText.element.on("tap",function(){d.fireEvent("selectTextMode",d)});d.on({hide:function(){if(window.speechSynthesis!=undefined&&(typeof isTribReader!=undefined&&isTribReader)){d.fireEvent("hidden",d.ttsToggle)}},painted:function(){if(settings.tts!=null&&window.SpeechSynthesisUtterance!=undefined){d.fireEvent("opened")}}});if(d.articleReader!=null){d.fireEvent("initializeArticlePopover",d);d.ttsToggle.hide()}else{if(d.config.isLive==null){d.fireEvent("initialized",d)}else{if(d.config.articles==null){d.fireEvent("initializeLivePopover",d);d.ttsToggle.hide()}else{d.fireEvent("initializeLivePopover",d,d.config.articles)}}}if(settings.reader.hideArticleControls!=null){if(settings.reader.hideArticleControls.toLowerCase()=="true"){d.topBarShare.hide();d.topBarTextControls.hide();e.hide();d.topBarPrint.hide()}}if(settings.newsday!=null){d.addCls("popUp");d.topBarPrint.hide();if(settings.newsday.useFontAwesome=="true"){d.prevIcon=d.previousArticleButton.getComponent("prev");if(d.prevIcon!=null){d.prevIcon.setHtml('<i class="fa fa-angle-left fa-lg" style="position:relative;top:-2px;margin:2px;" aria-hidden="true"></i>')}d.nextIcon=d.nextArticleButton.getComponent("next");if(d.nextIcon!=null){d.nextIcon.setHtml('<i class="fa fa-angle-right fa-lg" style="position:relative;top:-2px;margin:2px;" aria-hidden="true"></i>')}}if(settings.newsday.useNewsdayPopover!=null){if(settings.newsday.useNewsdayPopover=="true"){var b=d.hexToRgb(settings.topbar.backgroundColor);if(settings.topbar.backgroundColor!=null){f.setStyle({backgroundColor:"rgba("+b.r+","+b.g+","+b.b+",0.9)"})}d.closeButton.removeAll();var g=Ext.create("Ext.Container",{itemId:"closeTxt",cls:"articleClose",style:"font-size:18px",html:'<img src="resources/images/article-close-btn-white.png" style="width:26px;" />'});d.closeButton.add(g);if(settings.topbar.color!=null){d.closeButton.setStyle({color:"#"+settings.topbar.color})}d.closeButton.setPadding("12px 16px");f.insert(0,d.closeButton);f.setPadding("5px 0px 0px 0px")}}if(settings.newsday.hideShareIcons!=null){if(settings.newsday.hideShareIcons=="true"){d.topBarShare.removeAll();d.topBarTextControls.hide()}}}d.interactiveContent=f.getComponent("interactiveContent");if(typeof isTribReader!="undefined"){if(isTribReader){d.content.setPadding(0);d.interactiveContent.show();d.topBarComic=d.interactiveContent.getComponent("topBarComic");d.topBarPuzzle=d.interactiveContent.getComponent("topBarPuzzle");d.topBarSections=d.interactiveContent.getComponent("topBarSections");d.setComicPuzzleListener();d.topBarSelectText.show();d.topBarTranslate=f.getComponent("topBarTranslate");d.topBarTranslate.show();d.setTranslateListener()}}d.setTooltips();d.adjustModal()},adjustModal:function(){var a=this;a.getModal().setZIndex(9999998);a.setZIndex(9999999)},setTranslateListener:function(){var b=this;var a='<div class="textSizeHtml5"><span style="top: -8px;position: relative;margin: 8px;color: rgb(66, 145, 182);">'+language.articlePopover.translate+'</span><img class="translate-flag tflag" src="../assets/article view/Spain.png"><img class="nant-flag tflag" style="display:none;" src="../assets/article view/mexican_flag_icon.png"></div>';b.topBarTranslate.setHtml(a);b.topBarTranslate.element.on({tap:function(c){c.stopPropagation();b.fireEvent("translateArticle",b)}})},setComicPuzzleListener:function(){var a=this;if(a.hasComics){a.topBarComic.element.on("tap",function(b){b.preventDefault();a.fireEvent("jumpToComics",a)})}else{a.topBarComic.hide()}if(a.hasPuzzles){a.topBarPuzzle.element.on("tap",function(b){b.preventDefault();a.fireEvent("jumpToPuzzles",a)})}else{a.topBarPuzzle.hide()}a.topBarSections.element.on("tap",function(b){b.preventDefault();a.fireEvent("sectionPopup",a,a.topBarSections)})},setPrintListener:function(){var a=this;a.topBarPrint.element.on("tap",function(){a.fireEvent("print")})},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},setArticleWidth:function(){var b=this;var a=Math.min(screen.width,screen.height);b.setWidth(a)},setCloseButtonListener:function(){var a=this;a.closeButton.element.on({tap:"tap",scope:this})},setTtsToggleListener:function(){var a=this;if(window.SpeechSynthesisUtterance!=undefined){a.ttsToggle.element.on({tap:function(){a.fireEvent("readAloudMode",a);a.setTooltips()}})}},setCopyButtonListener:function(){var a=this;a.copyButton.element.on({tap:function(){a.fireEvent("copyToClipboard")}})},setPreviousButtonListener:function(){var a=this;if(a.config.isLive!=null){a.previousArticleButton.element.on("tap",function(){a.fireEvent("livePrevious",a)})}else{a.previousArticleButton.element.on("tap",function(){a.fireEvent("previous")})}},setNextButtonListener:function(){var a=this;if(a.config.isLive!=null){a.nextArticleButton.element.on("tap",function(){a.fireEvent("liveNext",a)})}else{a.nextArticleButton.element.on("tap",function(){a.fireEvent("next")})}},setAppTranslateListener:function(){var a=this;a.inappTrans.element.on({tap:function(){a.fireEvent("translate",a.inappTrans)}})},tap:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;a.tap()},setTooltips:function(){var b=this;b.tooltip=b.getComponent("tooltiptool");b.topBarShare.on("painted",function(){var g=b.topBarShare.getItems().items;for(var e in g){var f=g[e].type;f=f[0].toUpperCase()+f.substring(1,f.length);b.setupTooltipMouseFunctions(g[e].element.dom,f,true)}});b.setupTooltipMouseFunctions(b.copyButton.element.dom,language.articlePopover.copyTool,false);b.setupTooltipMouseFunctions(b.topBarSelectText.element.dom,language.articlePopover.highlightedTextMode,false);if(b.topBarComic!=null){b.setupTooltipMouseFunctions(b.topBarComic.element.dom,"Comics",false)}if(b.topBarPuzzle!=null){b.setupTooltipMouseFunctions(b.topBarPuzzle.element.dom,"Puzzles",false)}b.setupTooltipMouseFunctions(b.topBarPrint.element.dom,language.print.print,false);var d=$(b.topBarTextControls.element.dom).find(".textIncrease")[0];if(d!=null){b.setupTooltipMouseFunctions(d,language.articlePopover.enlargeText,false)}var c=$(b.topBarTextControls.element.dom).find(".textDecrease")[0];if(c!=null){b.setupTooltipMouseFunctions(c,language.articlePopover.reduceText,false)}b.setupTooltipMouseFunctions(b.ttsToggle.element.dom,language.menu.readAloud,false);var a=b.readAloudControls;if(a!=null){a.element.dom.onmouseover=function(){if(readAloud.status=="PLAYING"){b.tooltip.setHtml(language.articlePopover.stop);b.tooltip.show();b.tooltipShare()}else{b.tooltip.setHtml(language.articlePopover.play);b.tooltip.show();b.tooltipShare()}};a.element.dom.onmouseout=function(){b.tooltip.setHtml("");b.tooltip.hide();b.element.dom.onmousemove=null}}},setupTooltipMouseFunctions:function(c,d,b){var a=this;if(b){c.onmouseover=function(){a.tooltip.setHtml(d);a.tooltip.show();a.tooltipShare()};c.onmouseout=function(){a.tooltip.setHtml("");a.tooltip.hide();a.element.dom.onmousemove=null}}else{c.onmouseover=function(){a.tooltip.setHtml(d);a.tooltip.show();a.tooltipShare()};c.onmouseout=function(){a.tooltip.setHtml("");a.tooltip.hide();a.element.dom.onmousemove=null}}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(b.layerX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(b.layerX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(b.layerX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},tooltipShare:function(){var a=this;a.element.dom.onmousemove=(function(b){var c=b.pageX-$(a.element.dom).offset().left;a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(c+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(c+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(c+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},hide:function(){var a=this;if(window.speechSynthesis!=undefined&&(typeof isTribReader!=undefined&&isTribReader)){a.fireEvent("hidden",a.ttsToggle)}a.tap();a.destroy()}},0,["articleview"],["component","container","articleview"],{component:true,container:true,articleview:true},["widget.articleview"],0,[InfinityMobile.view.desktop,"ReaderArticlePopover"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticlePopoverInterstitial",Ext.Panel,{config:{style:"padding:0px",items:[{itemId:"advert",cls:"advert"}]},initialize:function(){var b=this;b.destroyed=false;b.advertTimeout=1000;b.advertContainer=b.getComponent("advert");var a=settings.newsday.articlePopoverInterstitial;if(a!=null){b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";b.advertContainer.setHtml("<div id='"+b.advertDivID+"' style='text-align:center;width:90%;height:100%;margin-left:5%;margin-right:5%;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.advertDiv.dom.style.visibility="hidden";b.on("painted",b.loadAdvert,b,{delay:10,single:true});b.on("resize",b.onResizeFn,b)}else{if(settings.newsday!=null){if(settings.newsday.adUnit!=null&&settings.newsday.networkCode!=null){a=settings.newsday;b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.advertDivID=b.id+"advert";b.advertContainer.setHtml("<div id='"+b.advertDivID+"' style='width:90%;height:100%;margin-left:5%;margin-right:5%;pointer-events:none;'></div>");b.advertDiv=b.element.down("#"+b.advertDivID);b.on("painted",b.loadAdvert,b,{delay:10,single:true});b.on("resize",b.onResizeFn,b)}}}},loadAdvert:function(){var a=this;setTimeout(function(){if(!a.destroyed){googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("768"),parseInt("1024")],a.advertDivID);b.addService(googletag.pubads());googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)});a.onResizeFn(a);a.advertDiv.dom.style.visibility=""}},a.advertTimeout)},onResizeFn:function(a){var d=this;if(d.advertDiv.down("iframe")!=null){var c=d.advertDiv.down("iframe").dom;var b=c.contentDocument||c.contentWindow.document;var g=document.createElement("script");g.innerHTML='setTimeout(function(){ document.addEventListener("touchmove", function (e) { e.preventDefault(); }); }, 500)';try{b.addEventListener("touchmove",function(h){h.preventDefault()});b.body.appendChild(g);d.advertDiv.dom.addEventListener("touchmove",function(h){h.preventDefault()})}catch(f){}d.fireEvent("scaleInterstitial",c,d.advertDiv.dom)}},destroy:function(){var a=this;a.destroyed=true;Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["articlePopoverInterstitial"],["component","container","panel","articlePopoverInterstitial"],{component:true,container:true,panel:true,articlePopoverInterstitial:true},["widget.articlePopoverInterstitial"],0,[InfinityMobile.view.desktop,"ArticlePopoverInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.DesktopPageViewer",Ext.Panel,{config:{height:"100%",width:"100%",scrollable:"both",maxScale:3,mode:"double",zoomMode:"fit",maxZoomWidth:3500,items:[{itemId:"scrollerDiv",items:[{itemId:"zoomDiv",style:"visibility: hidden",items:[{itemId:"hiddenLeft",left:"0%",top:0,height:"100%",width:"50%",style:"visibility:hidden;",html:"<img id='hiddenLeftImg' src='' style='position:absolute;'/><div class='hiddenGradientLeft' style='position:absolute;right:0%;' ></div>"},{itemId:"leftSide",left:0,top:0,height:"100%",width:"50%",html:"<div class='leftSideDiv' style='position:absolute;top:0%;right:0%;transform-origin:100% 0% 0px;z-index:10000' ><div class='leftPreviousPageContainer' style='z-index:10;position:absolute;transform-origin:100% 0% 0px;visibility:hidden;right:0%;top0%;'><div class='leftSideGradient' style='position:absolute'></div><img class='leftPrevPage' style='position:absolute;' /></div><div class='leftSideImgContainer' style='position:absolute;top:0%;right:0%;'><img class='leftSideImg' style='display:block;' /><div class='mediaDiv'></div><div class='tileDiv'><canvas id='tileCanvas' /></div><div class='tileDiv2'><canvas id='tileCanvas2' /></div></div></div>"},{itemId:"hiddenRight",left:"50%",top:0,height:"100%",width:"50%",style:"visibility:hidden;",html:"<img id='hiddenRightImg' src='' style='position:absolute;' /><div class='hiddenGradientRight' style='position:absolute;' ></div>"},{itemId:"rightSide",left:"50%",top:0,height:"100%",width:"50%",html:"<div class='rightSideDiv' style='position:absolute;top:0%;left:0%;transform-origin:0% 0% 0px;' ><div class='rightNextPageContainer' style='z-index:10;position:absolute;transform-origin:0% 0% 0px;visibility:hidden;' ><div class='rightSideGradient' style='position:absolute;'></div><img class='rightNextPage' style='position:absolute;' /></div><div class='rightSideImgContainer' style='position:absolute;'><img class='rightSideImg' style='display:block;' /><div class='mediaDiv'></div><div class='tileDiv'><canvas id='tileCanvas' /></div><div class='tileDiv2'><canvas id='tileCanvas2' /></div></div></div>"},{itemId:"overflowMediaDiv",left:0,top:0,hidden:true,height:"100%",width:"50%"}]},{itemId:"tooltip",style:"position:absolute !important;left:0px;top:0px;",left:0,top:0,width:0,height:0,hidden:true}]},{cls:"cornerPoint",itemId:"topRight",style:"width:60px;height:60px;position:absolute;right:0%;top:0%;z-index:100001;visibility:visible;overflow:hidden;",html:"<img class='gifRight' loop='false' />"},{cls:"cornerPoint",itemId:"topLeft",style:"width:60px;height:60px;position:absolute;left:0%;top:0%;z-index:100001;visibility:visible;overflow:hidden",html:"<img class='gifLeft' loop='false' />"},{cls:"cornerPoint",itemId:"bottomRight",style:"width:60px;height:60px;position:absolute;right:0%;bottom:0%;z-index:100001;visibility:visible;overflow:hidden;",html:"<img class='gifBottomRight' loop='false' />"},{cls:"cornerPoint",itemId:"bottomLeft",style:"width:60px;height:60px;position:absolute;left:0%;bottom:0%;z-index:100001;visibility:visible;overflow:hidden;",html:"<img class='gifBottomLeft' loop='false' />"}]},beforeInitialize:function(){var a=this;a.isinitialized=false;a.isPageRendered=false;a.hasTiled=false;a.leftThumbnailLoaded=false;a.rightThumbnailLoaded=false;a.scale=1;a.zoomMode=a.config.zoomMode;a.mode=a.config.mode;a.scaledCanvas=false;a.zoomTileInterval=null;a.canDoubleTap=true},initialize:function(){var b=this;var a=Ext.getStore("SettingStore");b.advertCounter=0;b.readerPaddingY=0;b.readerPaddingX=0;b.wrapAdOffset=0;b.topPadding=0;var c=false;if(typeof isTribReader!="undefined"){if(isTribReader){c=true}}if(c||window.settings.reader.enableReaderPadding=="true"){b.wrapAdOffset=150;b.topPadding=20}if(window.settings.reader.wrapAd!=null){b.wrapAdOffset=180}b.audioObjects=[];b.mp4Objects=[];b.topRight=b.getComponent("topRight");b.topLeft=b.getComponent("topLeft");b.bottomRight=b.getComponent("bottomRight");b.bottomLeft=b.getComponent("bottomLeft");b.zoomLevel="none";b.scrollerDivContainer=b.getComponent("scrollerDiv");b.scrollerDiv=b.scrollerDivContainer.element;b.scrollerDiv.addListener({scope:b,doubletap:b.onDoubleTap,pinchstart:b.onPinchStart,pinch:b.onPinch,pinchend:b.onPinchEnd});b.zoomDivContainer=b.scrollerDivContainer.getComponent("zoomDiv");b.zoomDiv=b.zoomDivContainer.element;b.rightSide=b.zoomDivContainer.getComponent("rightSide");b.leftSide=b.zoomDivContainer.getComponent("leftSide");b.hiddenRight=b.zoomDivContainer.getComponent("hiddenRight");b.hiddenLeft=b.zoomDivContainer.getComponent("hiddenLeft");b.overflowMediaDiv=b.zoomDivContainer.getComponent("overflowMediaDiv");b.tooltip=b.scrollerDivContainer.getComponent("tooltip");b.scroller=b.getScrollable().getScroller();b.scroller.setDisabled(true);b.scroller.on({scrollstart:b.onScrollStart,scroll:function(f){var d=this;if(f.position.y<0){if(d.rightSideNextPageContainer!=null){d.rightSideNextPageContainer.style.display="none"}if(d.leftSideNextPageContainer!=null){d.leftSideNextPageContainer.style.display="none"}}else{if(d.rightSideNextPageContainer!=null){d.rightSideNextPageContainer.style.display=""}if(d.leftSideNextPageContainer!=null){d.leftSideNextPageContainer.style.display=""}}},scrollend:b.scrollEnd,scope:b});b.zoomDiv.on({touchend:b.onTouchEnd,scope:b});b.setupPages();b.on("painted",b.pagePainted,b,{delay:10,single:true});b.topRight.element.addListener({dragstart:"startDrag",drag:"drag",dragend:"endDrag",scope:b});b.topRight.element.on("tap",function(d){if(d!=null){d.stopPropagation()}b.fireEvent("killBannerAd",b);if(b.diffX==null){b.diffX=($(b.topRight.element.dom).offset().left+$(b.topRight.element.dom)[0].getBoundingClientRect().width)-$(b.element.dom).width()}if(b.diffY==null){b.diffY=$(b.topRight.element.dom).offset().top}$(b.rightSideDiv).css("transform-origin","0% 0% 0px");$(b.rightSideImg).css("transform-origin","0% 0% 0px");$(b.rightNextPage).css("transform-origin","0% 0% 0px");$(b.rightSideGradient).css("transform-origin","0% 0% 0px");$(b.rightSideDiv).css("bottom","");$(b.rightSideImg).css("top","0%");$(b.rightSideImg).css("bottom","");$(b.rightSideImg).css("left","0%");$(b.rightNextPage).css("top","0%");$(b.rightNextPage).css("bottom","");$(b.rightNextPage).css("left","0% ");$(b.rightSideGradient).css("top","0%");$(b.rightSideGradient).css("bottom","");$(b.rightSideGradient).css("left","0% ");$(b.rightSideGradient).css("z-index","11");b.rightSide.element.dom.style.zIndex="10";b.leftSide.element.dom.style.zIndex="8";$(b.gifRight).css("visibility","hidden");b.fireEvent("autoTurnRight",b)});b.enter=false;b.mouseDown=false;b.topRight.element.dom.onmouseenter=function(f){if(!b.mouseDown){if(b.timer!=null){clearInterval(b.timer);b.timer=null}$(b.gifRight).css("visibility","visible");$(b.gifRight).attr("src","resources/images/cornerpeel_00010.png");var d=60;if((navigator.maxTouchPoints)){d=70}$(b.gifRight).css("transform","translate3d("+d+"px, "+d+"px, 0px)");b.timer=setInterval(function(){d--;$(b.gifRight).css("transform","translate3d("+d+"px, "+-d+"px, 0px)");if(d==0){clearInterval(b.timer);b.timer=null}},5);b.mouseDown=false}};b.topRight.element.dom.onmouseleave=function(f){if(!b.mouseDown){if(b.timer!=null){clearInterval(b.timer);b.timer=null}if(!Ext.browser.is.IE){$(b.gifRight).attr("src","resources/images/cornerpeel_00010.png")}var d=0;b.timer=setInterval(function(){d++;$(b.gifRight).css("transform","translate3d("+d+"px, "+-d+"px, 0px)");var e=60;if((navigator.maxTouchPoints)){e=70}if(d==e){clearInterval(b.timer);b.timer=null}},5);b.mouseDown=false}};b.topLeft.element.addListener({dragstart:"startDragLeft",drag:"dragLeft",dragend:"endDragLeft",scope:b});b.topLeft.element.on("tap",function(d){if(d!=null){d.stopPropagation()}b.fireEvent("killBannerAd",b);if(b.diffX==null){b.diffX=($(b.topRight.element.dom).offset().left+$(b.topRight.element.dom)[0].getBoundingClientRect().width)-$(b.element.dom).width()}if(b.diffY==null){b.diffY=$(b.topRight.element.dom).offset().top}$(b.leftSideDiv).css("transform-origin","100% 0% 0px");$(b.leftSideImg).css("transform-origin","100% 0% 0px");$(b.leftPrevPage).css("transform-origin","100% 0% 0px");$(b.leftSideGradient).css("transform-origin","100% 0% 0px");$(b.leftSideDiv).css("bottom","");$(b.leftSideImg).css("top","0%");$(b.leftSideImg).css("bottom","");$(b.leftSideImg).css("right","0%");$(b.leftPrevPage).css("top","0%");$(b.leftPrevPage).css("bottom","");$(b.leftPrevPage).css("right","0% ");$(b.leftSideGradient).css("top","0%");$(b.leftSideGradient).css("bottom","");$(b.leftSideGradient).css("right","0% ");$(b.leftSideGradient).css("z-index","11");b.rightSide.element.dom.style.zIndex="8";b.leftSide.element.dom.style.zIndex="10";$(b.gifLeft).css("visibility","hidden");b.fireEvent("autoTurnLeft",b)});b.topLeft.element.dom.onmouseenter=function(f){if(!b.mouseDown){if(b.timer!=null){clearInterval(b.timer);b.timer=null}$(b.gifLeft).attr("src","resources/images/cornerpeel_00010.png");$(b.gifLeft).css("visibility","visible");var d=60;if((navigator.maxTouchPoints)){d=70}$(b.gifLeft).css("transform","translate3d("+d+"px, "+d+"px, 0px)");b.timer=setInterval(function(){d--;$(b.gifLeft).css("transform","rotate(270deg) scale3d(1, 1, 1) translate3d("+d+"px, "+-d+"px, 0px)");if(d==0){clearInterval(b.timer);b.timer=null}},5);b.mouseDown=false}};b.topLeft.element.dom.onmouseleave=function(f){if(!b.mouseDown){if(b.timer!=null){clearInterval(b.timer);b.timer=null}if(!Ext.browser.is.IE){$(b.gifRight).attr("src","resources/images/cornerpeel_00010.png")}var d=0;b.timer=setInterval(function(){d++;$(b.gifLeft).css("transform","rotate(270deg) scale3d(1, 1, 1) translate3d("+d+"px, "+-d+"px, 0px)");var e=60;if((navigator.maxTouchPoints)){e=70}if(d==e){clearInterval(b.timer);b.timer=null}},5);b.mouseDown=false}};b.bottomRight.element.addListener({dragstart:"startDragBottomRight",drag:"dragBottomRight",dragend:"endDragBottomRight",scope:b});b.bottomRightTapped=false;b.bottomRight.element.on("tap",function(d){if(d!=null){d.stopPropagation()}b.fireEvent("killBannerAd",b);if(!b.bottomRightTapped){b.bottomRightTapped=true;if(b.diffX==null){b.diffX=($(b.topRight.element.dom).offset().left+$(b.topRight.element.dom)[0].getBoundingClientRect().width)-$(b.element.dom).width()}if(b.diffY==null){b.diffY=$(b.topRight.element.dom).offset().top}$(b.rightSideDiv).css("transform-origin","0% 100% 0px");$(b.rightSideDiv).css("top","");$(b.rightSideDiv).css("bottom",-b.height);$(b.rightSideImageContainer).css("transform-origin","0% 100% 0px");$(b.rightSideImageContainer).css("top","");$(b.rightSideImageContainer).css("bottom","0%");$(b.rightSideImageContainer).css("left","0%");$(b.rightNextPage).css("transform-origin","0% 100% 0px");$(b.rightNextPage).css("top","");$(b.rightNextPage).css("bottom","0%");$(b.rightNextPage).css("left","0% ");$(b.rightSideGradient).css("transform-origin","0% 100% 0px");$(b.rightSideGradient).css("top","");$(b.rightSideGradient).css("bottom","0%");$(b.rightSideGradient).css("left","0% ");$(b.rightSideGradient).css("z-index","11");b.rightSide.element.dom.style.zIndex="10";b.leftSide.element.dom.style.zIndex="8";$(b.gifBottomRight).css("visibility","hidden");b.fireEvent("autoTurnBottomRight",b)}});b.bottomLeft.element.addListener({dragstart:"startDragBottomLeft",drag:"dragBottomLeft",dragend:"endDragBottomLeft",scope:b});b.bottomRight.element.dom.onmouseenter=function(f){if(!b.mouseDown){if(b.timer!=null){clearInterval(b.timer);b.timer=null}$(b.gifBottomRight).attr("src","resources/images/cornerpeel_00010.png");$(b.gifBottomRight).css("visibility","visible");var d=60;if((navigator.maxTouchPoints)){d=70}$(b.gifBottomRight).css("transform","translate3d("+d+"px, "+d+"px, 0px)");b.timer=setInterval(function(){d--;$(b.gifBottomRight).css("transform","rotate(90deg) translate3d("+d+"px, "+-d+"px, 0px)");if(d==0){clearInterval(b.timer);b.timer=null}},5);b.mouseDown=false}},b.bottomRight.element.dom.onmouseleave=function(f){if(!b.mouseDown){if(b.timer!=null){clearInterval(b.timer);b.timer=null}var d=0;b.timer=setInterval(function(){d++;if(!Ext.browser.is.IE){$(b.gifBottomRight).attr("src","resources/images/cornerpeel_00010.png")}$(b.gifBottomRight).css("transform","rotate(90deg) translate3d("+d+"px, "+-d+"px, 0px)");var e=60;if((navigator.maxTouchPoints)){e=70}if(d==e){clearInterval(b.timer);b.timer=null}},5);b.mouseDown=false}};b.bottomLeftTapped=false;b.bottomLeft.element.on("tap",function(d){if(d!=null){d.stopPropagation()}b.fireEvent("killBannerAd",b);if(!b.bottomLeftTapped){b.bottomLeftTapped=true;if(b.diffX==null){b.diffX=($(b.topRight.element.dom).offset().left+$(b.topRight.element.dom)[0].getBoundingClientRect().width)-$(b.element.dom).width()}if(b.diffY==null){b.diffY=$(b.topRight.element.dom).offset().top}$(b.leftSideDiv).css("transform-origin","100% 100% 0px");$(b.leftSideImageContainer).css("transform-origin","100% 100% 0px");$(b.leftPrevPage).css("transform-origin","100% 100% 0px");$(b.leftSideGradient).css("transform-origin","100% 100% 0px");$(b.leftSideDiv).css("top","");$(b.leftSideDiv).css("bottom",-b.height);$(b.leftSideImageContainer).css("top","");$(b.leftSideImageContainer).css("bottom","0%");$(b.leftSideImageContainer).css("right","0%");$(b.leftPrevPage).css("top","");$(b.leftPrevPage).css("bottom","0%");$(b.leftPrevPage).css("right","0% ");$(b.leftSideGradient).css("top","");$(b.leftSideGradient).css("bottom","0%");$(b.leftSideGradient).css("right","0% ");$(b.leftSideGradient).css("z-index","11");b.rightSide.element.dom.style.zIndex="8";b.leftSide.element.dom.style.zIndex="10";$(b.gifBottomLeft).css("visibility","hidden");b.fireEvent("autoTurnBottomLeft",b)}});b.bottomLeft.element.dom.onmouseenter=function(f){if(!b.mouseDown){if(b.timer!=null){clearInterval(b.timer);b.timer=null}$(b.gifBottomLeft).attr("src","resources/images/cornerpeel_00010.png");$(b.gifBottomLeft).css("visibility","visible");var d=60;if((navigator.maxTouchPoints)){d=70}$(b.gifBottomLeft).css("transform","translate3d("+d+"px, "+d+"px, 0px)");b.timer=setInterval(function(){d--;$(b.gifBottomLeft).css("transform","rotate(180deg) translate3d("+d+"px, "+-d+"px, 0px)");if(d==0){clearInterval(b.timer);b.timer=null}},5);b.mouseDown=false}};b.bottomLeft.element.dom.onmouseleave=function(f){if(!b.mouseDown){if(b.timer!=null){clearInterval(b.timer);b.timer=null}if(!Ext.browser.is.IE){$(b.gifBottomLeft).attr("src","resources/images/cornerpeel_00010.png")}var d=0;b.timer=setInterval(function(){d++;$(b.gifBottomLeft).css("transform","rotate(180deg) translate3d("+d+"px, "+-d+"px, 0px)");var e=60;if((navigator.maxTouchPoints)){e=70}if(d==e){clearInterval(b.timer);b.timer=null}},5);b.mouseDown=false}};if(b.zoomMode=="fill"){b.topRight.hide();b.topLeft.hide();b.bottomRight.hide();b.bottomLeft.hide();b.element.dom.onmousewheel=(function(d){if(b.scroller.maxPosition.y>0){if(d.wheelDelta>0){if(b.scroller.position.y-120>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-120);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(b.scroller.position.y+120<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+120);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}}});b.element.dom.addEventListener("DOMMouseScroll",function(d){if(b.zoomMode=="fill"&&b.scroller.maxPosition.y>0){if(d.detail<=0){if(b.scroller.position.y-60>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-60);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(b.scroller.position.y+60<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+60);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}}})}else{b.toggleZoomMode("fit")}b.pauseFlashingLinks();if((navigator.maxTouchPoints)){$(b.topRight.element.dom).css("height","70px");$(b.topRight.element.dom).css("width","70px");$(b.topLeft.element.dom).css("height","70px");$(b.topLeft.element.dom).css("width","70px");$(b.bottomRight.element.dom).css("height","70px");$(b.bottomRight.element.dom).css("width","70px");$(b.bottomLeft.element.dom).css("height","70px");$(b.bottomLeft.element.dom).css("width","70px")}b.isinitialized=true},setupPages:function(){var b=this;b.rightPageObject=b.config.rightPage;b.rightPage=b.config.rightPage.image;b.leftPageObject=b.config.leftPage;b.leftPage=b.config.leftPage.image;b.prevPageObject=b.config.previousPage;b.prevPage=b.config.previousPage.image;b.hiddenLeftPageObject=b.config.hiddenLeftPage;b.hiddenLeftPage=b.config.hiddenLeftPage.image;b.nextPageObject=b.config.nextPage;b.nextPage=b.config.nextPage.image;b.hiddenRightPageObject=b.config.hiddenRightPage;b.hiddenRightPage=b.config.hiddenRightPage.image;b.initialTranslateX=0;b.initialTranslateY=0;b.offsetX=0;b.offsetY=0;b.activeCanvas=1;b.rightSideDiv=b.rightSide.element.down(".rightSideDiv").dom;b.rightSideNextPageContainer=b.rightSide.element.down(".rightNextPageContainer").dom;b.rightSideGradient=b.rightSide.element.down(".rightSideGradient").dom;b.rightNextPage=b.rightSide.element.down(".rightNextPage").dom;b.rightSideImageContainer=b.rightSide.element.down(".rightSideImgContainer").dom;b.rightSideImg=b.rightSide.element.down(".rightSideImg").dom;b.rightSideMediaDiv=b.rightSide.element.down(".mediaDiv").dom;b.rightSideTileDiv=b.rightSide.element.down(".tileDiv").dom;b.rightSideTileDiv2=b.rightSide.element.down(".tileDiv2").dom;b.rightSideTileCanvas=b.rightSide.element.down("canvas").dom;b.rightSideTileCanvas2=$(b.rightSideTileDiv2).find("canvas")[0];b.rightSideImageContainer.image=b.rightSideImg;b.rightSideImageContainer.mediaDiv=b.rightSideMediaDiv;b.rightSideImageContainer.tileDiv=b.rightSideTileDiv;b.rightSideImageContainer.tileDiv2=b.rightSideTileDiv2;b.rightSideImageContainer.tileCanvas=b.rightSideTileCanvas;b.rightSideImageContainer.tileCanvas2=b.rightSideTileCanvas2;b.rightSideImageContainer.activeCanvas=1;var a=b.getPageNo()+1;if(a%2==1){b.rightSideImageContainer.pageNo=a}else{b.rightSideImageContainer.pageNo=(a+1)}b.hiddenRightImg=b.hiddenRight.element.dom.children[0].children[0].children[0];b.hiddenRightGradient=b.hiddenRight.element.dom.children[0].children[0].children[1];b.leftSideDiv=b.leftSide.element.down(".leftSideDiv").dom;b.leftSidePrevPageContainer=b.leftSide.element.down(".leftPreviousPageContainer").dom;b.leftSideGradient=b.leftSide.element.down(".leftSideGradient").dom;b.leftPrevPage=b.leftSide.element.down(".leftPrevPage").dom;b.leftSideImageContainer=b.leftSide.element.down(".leftSideImgContainer").dom;b.leftSideImg=b.leftSide.element.down(".leftSideImg").dom;b.leftSideMediaDiv=b.leftSide.element.down(".mediaDiv").dom;b.leftSideTileDiv=b.leftSide.element.down(".tileDiv").dom;b.leftSideTileDiv2=b.leftSide.element.down(".tileDiv2").dom;b.leftSideTileCanvas=b.leftSide.element.down("canvas").dom;b.leftSideTileCanvas2=$(b.leftSideTileDiv2).find("canvas")[0];b.leftSideImageContainer.image=b.leftSideImg;b.leftSideImageContainer.mediaDiv=b.leftSideMediaDiv;b.leftSideImageContainer.tileDiv=b.leftSideTileDiv;b.leftSideImageContainer.tileDiv2=b.leftSideTileDiv2;b.leftSideImageContainer.tileCanvas=b.leftSideTileCanvas;b.leftSideImageContainer.tileCanvas2=b.leftSideTileCanvas2;b.leftSideImageContainer.activeCanvas=1;var a=b.getPageNo()+1;if(a%2==1){b.leftSideImageContainer.pageNo=(a-1)}else{b.leftSideImageContainer.pageNo=a}b.hiddenLeftImg=b.hiddenLeft.element.dom.children[0].children[0].children[0];b.hiddenLeftGradient=b.hiddenLeft.element.dom.children[0].children[0].children[1];b.checkPageMode(b.mode)},returnAdvertOffset:function(c){var b=this;var d=0;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var e=settings.reader.interstitialPageFlow;var a=editionFlatplanData.pageGroups[c-1];if(a!=null&&a.pages[0]!=null){if(!isNaN(a.pages[0].advertsAdded)){d=a.pages[0].advertsAdded}}}return d},pagePainted:function(){var a=this;if(a.element!=null){a.setPageWidth();if(settings.leftSideAd!=null&&a.config.leftPage.type=="leftHandAd"&&(a.config.leftPage.adType=="dfp"||a.config.leftPage.adType=="url")){a.rightSidePainted()}else{a.leftSidePainted();if(a.rightPage!=null){a.rightSidePainted()}else{a.rightSide.element.dom.style.zIndex="8"}}if(settings.reader.wrapAd!=null){if(settings.reader.wrapAd.hideLeftWrapperOnFirstPage!=null){if(settings.reader.wrapAd.hideLeftWrapperOnFirstPage=="true"){a.fireEvent("checkWrapAd",a)}}}a.playCssAnimations()}},setPageWidth:function(){var a=this;a.pageWidth=a.element.dom.clientWidth;a.pageHeight=a.element.dom.clientHeight},leftSidePainted:function(){var b=this;var a=false;$(b.leftSideImg).attr("src",b.getImageUrl(b.leftPage,b.leftPageObject));$(b.leftPrevPage).attr("src",b.getImageUrl(b.prevPage,b.prevPageObject));b.leftSideImg.type=b.config.leftPage.type;if(b.prevPage==null){b.topLeft.element.dom.style.visibility="hidden";b.bottomLeft.element.dom.style.visibility="hidden"}else{if(b.mode=="double"&&b.config.previousPage.type=="page"){b.topLeft.element.dom.style.visibility=""}}console.log(b.config.previousPage);if(b.hiddenLeftPage!=null){if(b.hiddenLeftPage.trim().length>0){$(b.hiddenLeftImg).css("display","none");$(b.hiddenLeftImg).attr("src",b.getImageUrl(b.hiddenLeftPage,b.hiddenLeftPageObject))}else{$(b.hiddenLeftImg).css("visibility","hidden")}}else{$(b.hiddenLeftImg).css("visibility","hidden")}$(b.leftSideImg).css("visibility","hidden");$(b.leftPrevPage).css("display","none");$(b.leftSidePrevPageContainer).css("display","none");$(b.leftSidePrevPageContainer).css("background-color","white");b.leftPrevPage.onload=function(){$(b.leftPrevPage).css("display","");$(b.leftSidePrevPageContainer).css("background-color","");$(b.leftSidePrevPageContainer).css("display","")};b.leftSideImg.onload=function(){if(b.config.leftPage.type!="sectionpage"){b.leftSideImageLoad()}if(b.config.rightPage.type=="sectionpage"){b.rightSideImageLoad()}if(b.mode=="single"){var c=b.returnActiveImageContainer();if(c!=null&&c.className.indexOf("leftSideImgContainer")!=-1){$(b.leftSideImg).css("visibility","")}else{$(b.leftSideImg).css("visibility","hidden")}}else{$(b.leftSideImg).css("visibility","")}if(a){$(b.hiddenLeftImg).css("display","")}else{b.hiddenLeftImg.onload=function(){$(b.hiddenLeftImg).css("display","")}}};b.hiddenLeftImg.onload=function(){a=true};if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1){b.leftSide.setZIndex(9)}else{b.leftSide.element.dom.style.zIndex="8"}if(b.config.leftPage.type=="leftHandAd"){if(settings.leftSideAd.link!=null){b.leftSideMediaDiv.onclick=function(){window.open(settings.leftSideAd.link,"_blank")};b.leftSideMediaDiv.addEventListener("touchstart",function(){window.open(settings.leftSideAd.link,"_blank")});$(b.leftSideMediaDiv).addClass("pointerCursor")}}},getImageUrl:function(b,c){var a=this;if(b!=null){if(settings.page.useMobileFullJpg){return"http://pages.mobile.cdn.pagesuite.com/images/"+c.guid+"/full.jpg"}else{if(settings.page.highResImage){return b.replace("page.jpg","largepage.jpg")}}}else{if(c.type=="leftHandAd"&&c.adType=="dfp"){a.setupDfpLeftSideAdvert()}}return b},setupDfpLeftSideAdvert:function(){var a=this;a.leftSideImg.style.width="";a.leftSideImg.style.height="";a.leftSideImg.src="";a.advertDiv=document.createElement("div");a.advertDiv.id=a.id+a.advertCounter+"leftSideAd";a.advertDiv.style.verticalAlign="middle";a.leftSideImageContainer.style.display="inline-block";a.leftSideImageContainer.style.height="100%";a.leftSideImageContainer.style.width="";a.leftSideImageContainer.appendChild(a.advertDiv);if(Ext.browser.is.IE){a.leftSideImageContainer.style.top="-30px"}a.setDfp();a.advertCounter++},setDfp:function(){var d=this;if(d.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([d.adSlot1])}var b="1024";var a="768";if(settings.leftSideAd.adSizes!=null){var c=settings.leftSideAd.adSizes.split(",");if(c!=null&&c.length==2){a=c[0];b=c[1]}}googletag.cmd.push(function(){try{d.adSlot1=googletag.defineSlot("/"+settings.leftSideAd.networkcode+"/"+settings.leftSideAd.adunit,[parseInt(a),parseInt(b)],d.advertDiv.id);d.adSlot1.addService(googletag.pubads());googletag.pubads().addEventListener("slotRenderEnded",function(g){if(g.slot==d.adSlot1){d.leftHandAdLoaded=!g.isEmpty;d.resizeDfp()}});googletag.enableServices()}catch(f){console.log(f)}});googletag.cmd.push(function(){googletag.display(d.advertDiv.id)});var e=$(d.leftSideImageContainer).find("iframe");if(e[0]!=null){d.iframe=e[0];d.thisFrameContent=d.iframe.contentDocument||d.iframe.contentWindow.document;d.resizeDfp()}},resizeDfp:function(){var f=this;var e=f.height;var b=f.width;var c=1024;var a=768;if(settings.leftSideAd.adSizes!=null){var d=settings.leftSideAd.adSizes.split(",");if(d!=null&&d.length==2){c=d[1];a=d[0]}}var g=1;if(c>e){g=e/c}if(a*g>b){g=b/a}f.applyAdvertScale(g)},applyAdvertScale:function(b){var a=this;if(a.advertDiv!=null){a.advertDiv.style.transformOrigin="100% 0%";a.advertDiv.style.transform="scale3d("+b+", "+b+", 1)"}},leftSideImageLoad:function(b){var c=this;if(c.element!=null){if(c.leftPage!=null){var a=c.isActivePage(c.leftSideImageContainer,c.rightSideImageContainer);if(c.zoomMode=="fit"){c.leftSideImageFit()}else{c.leftSideImageFill();c.setUpPageTurnForImageFill()}if(a){c.pageLoaded(c.leftSideImageContainer)}c.leftThumbnailLoaded=true;c.fireEvent("leftThumbnailLoaded");if(c.config.leftPage.type=="sectionpage"){$(c.leftSideImg).addClass("pointerCursor");c.setupSectionTap(c.leftSideImg,function(){c.fireEvent("goLeft")});c.leftSideMediaDiv.style.display="none"}}}},leftSideImageFit:function(){var e=this;var b=e.isActivePage(e.leftSideImageContainer,e.rightSideImageContainer);e.naturalWidth=$(e.leftSideImg)[0].naturalWidth;e.naturalHeight=$(e.leftSideImg)[0].naturalHeight;var f=e.naturalWidth/e.naturalHeight;e.leftSideHeight=e.height=$(e.element.dom).height()-e.readerPaddingY;e.leftSideWidth=e.width=e.height*f;var d=$(e.element.dom).width()/2-e.readerPaddingX;if(e.mode=="single"){d=$(e.element.dom).width()}if(e.config.leftPage.type=="sectionpage"){}if(e.width<d){e.leftSideImageContainer.initialImageWidth=e.width;e.leftSideImageContainer.initialImageHeight=e.height;e.initialTranslateY=e.readerPaddingY;e.leftSideImageContainer.style.width=e.width+"px";if(e.config.leftPage.type!="sectionpage"){$(e.leftSideImg).css("height",e.height)}$(e.leftSideImg).css("width",e.width);$(e.leftSidePrevPageContainer).css("height",e.height);$(e.leftSidePrevPageContainer).css("width",e.width);$(e.leftPrevPage).css("height",e.height+"px");$(e.leftPrevPage).css("width",(e.width)+"px");$(e.leftSideImg).css("transform-origin","100% 0% 0px");$(e.hiddenLeftImg).css("height",e.height);$(e.hiddenLeftImg).css("width",e.width);$(e.hiddenLeftGradient).css("height",e.height);$(e.hiddenLeftGradient).css("width",e.width);$(e.leftSideImageContainer).css("height","");var c=(e.height*e.height)+(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2))*(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));c=Math.sqrt(c);$(e.leftSideDiv).css("height",c+"px");$(e.leftSideDiv).css("width",c+"px");$(e.topLeft.element.dom).css("top",e.top+e.readerPaddingY);$(e.topLeft.element.dom).css("left",($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));$(e.bottomLeft.element.dom).css("left",($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));$(e.hiddenLeftImg).css("left",0);if(b){if(e.mode=="single"){e.initialTranslateX=((d)-e.width)/2;e.rightSide.element.dom.style.visibility="hidden";e.leftSide.element.dom.style.visibility="visible";$(e.rightSideImg).css("z-index","1")}else{e.initialTranslateX=(($(e.element.dom).width()/2)-e.width)}}}else{var f=e.naturalHeight/e.naturalWidth;e.leftSideWidth=e.width=d;e.leftSideHeight=e.height=e.width*f;e.leftSideImageContainer.initialImageWidth=e.width;e.leftSideImageContainer.initialImageHeight=e.height;e.leftSideImageContainer.style.width=e.width+"px";$(e.leftSideImg).css("height",e.height);$(e.leftSideImg).css("width",e.width);$(e.leftSidePrevPageContainer).css("height",e.height);$(e.leftSidePrevPageContainer).css("width",e.width);$(e.leftPrevPage).css("height",e.height);$(e.leftPrevPage).css("width",e.width);$(e.hiddenLeftImg).css("height",e.height);$(e.hiddenLeftImg).css("width",e.width);$(e.hiddenLeftGradient).css("height",e.height);$(e.hiddenLeftGradient).css("width",e.width);var c=(e.height*e.height)+(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2))*(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));c=Math.sqrt(c);$(e.leftSideDiv).css("height",c+"px");$(e.leftSideDiv).css("width",c+"px");if(e.config.leftPage.type!="sectionpage"){e.top=($(e.element.dom).height()-e.height)/2}if(b){e.initialTranslateY=e.top;if(typeof isTribReader!="undefined"&&isTribReader==true){}}$(e.topLeft.element.dom).css("top",e.top+e.readerPaddingY);$(e.topLeft.element.dom).css("left",($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));$(e.bottomLeft.element.dom).css("left",($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));$(e.bottomLeft.element.dom).css("bottom",e.top)}if(e.config.leftPage.type=="sectionpage"){$(e.leftSideImageContainer).css("height","");$(e.leftSideImg).css("height","");$(e.leftSideImageContainer).css("width",$(e.rightSideImageContainer).width());$(e.leftSideImg).css("width",$(e.rightSideImageContainer).width());e.topLeft.hide();e.bottomLeft.hide()}var g=60;if((navigator.maxTouchPoints)){g=70}e.gifLeft=e.topLeft.element.down("img").dom;$(e.gifLeft).css("width",g);$(e.gifLeft).css("height",g);$(e.gifLeft).css("transform","rotate(180deg) scale3d(1, 1, 1) translate3d("+g+"px, "+g+"px, 0px)");e.gifBottomLeft=e.bottomLeft.element.down("img").dom;$(e.gifBottomLeft).css("width",g);$(e.gifBottomLeft).css("height",g);$(e.gifBottomLeft).css("transform","scale3d(-1, 1, 1) translate3d("+g+"px, "+g+"px, 0px)")},failedClipping:function(){console.log(this)},leftSideImageFill:function(){var e=this;var b=e.isActivePage(e.leftSideImageContainer,e.rightSideImageContainer);e.naturalWidth=$(e.leftSideImg)[0].naturalWidth;e.naturalHeight=$(e.leftSideImg)[0].naturalHeight;var f=e.naturalHeight/e.naturalWidth;var d=$(e.element.dom).width()/2-e.readerPaddingX;if(e.mode=="single"){d=$(e.element.dom).width()-(e.readerPaddingX*2);if(b){$(e.rightSideImg).css("z-index","1")}}e.leftSideWidth=e.width=Math.min(d,2000);e.leftSideHeight=e.height=(e.width*f)+e.readerPaddingY;$(e.leftSideImg).css("width",e.width);$(e.leftSideImg).css("height",e.height-e.readerPaddingY);$(e.leftSideImageContainer).css("height",e.height-e.readerPaddingY);$(e.leftSideImageContainer).css("width",e.width);$(e.leftSideDiv).css("width",e.width);$(e.leftSideDiv).css("height",e.height-e.readerPaddingY);e.leftSideImageContainer.initialImageWidth=e.width;e.leftSideImageContainer.initialImageHeight=e.height-e.readerPaddingY;e.initialTranslateY=e.readerPaddingY;e.initialTranslateX=((d)-e.width)/2+e.readerPaddingX;$(e.leftSideImg).css("height",e.height-e.readerPaddingY);$(e.leftSideImg).css("width",e.width);$(e.leftSidePrevPageContainer).css("height",e.height-e.readerPaddingY);$(e.leftSidePrevPageContainer).css("width",e.width);$(e.leftPrevPage).css("height",e.height-e.readerPaddingY);$(e.leftPrevPage).css("width",e.width);$(e.hiddenLeftImg).css("height",e.height-e.readerPaddingY);$(e.hiddenLeftImg).css("width",e.width);$(e.hiddenLeftGradient).css("height",e.height-e.readerPaddingY);$(e.hiddenLeftGradient).css("width",e.width);var c=(e.height*e.height)+(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2))*(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));c=Math.sqrt(c);$(e.leftSideDiv).css("height",c+"px");$(e.leftSideDiv).css("width",c+"px");e.scroller.setDisabled(false);if(e.scroller.maxPosition.x==0){e.scroller.setDirection("vertical")}e.scroller.setDirectionLock(true);var g=60;if((navigator.maxTouchPoints)){g=70}e.gifLeft=e.topLeft.element.down("img").dom;$(e.gifLeft).css("width",g);$(e.gifLeft).css("height",g);$(e.gifLeft).css("transform","rotate(180deg) scale3d(1, 1, 1) translate3d("+g+"px, "+g+"px, 0px)");if(e.config.leftPage.type=="sectionpage"){e.scroller.maxPosition.y=$(e.rightSideImg).height()-($(document).height()-$(e.rightSideImg).offset().top)}else{if(e.config.rightPage.type=="sectionpage"){e.scroller.maxPosition.y=$(e.leftSideImg).height()-($(document).height()-$(e.leftSideImg).offset().top)}}},rightSidePainted:function(){var b=this;var a=false;if(!Ext.browser.is.IE){if(b.element.dom.parentElement!=null){b.element.dom.parentElement.parentElement.style.overflow="hidden"}}b.top=0;$(b.rightSideImg).css("visibility","hidden");$(b.rightNextPage).css("display","none");$(b.rightSideNextPageContainer).css("display","none");$(b.rightSideNextPageContainer).css("background-color","white");b.rightNextPage.onload=function(){$(b.rightNextPage).css("display","");$(b.rightSideNextPageContainer).css("background-color","")};b.rightSideImg.onload=function(){if(b.config.rightPage.type!="sectionpage"){b.rightSideImageLoad()}if(b.config.leftPage.type=="sectionpage"){b.leftSideImageLoad()}$(b.rightSideImg).css("visibility","");if(a){$(b.hiddenRightImg).css("display","")}else{if(b.hiddenRightImg!=null){b.hiddenRightImg.onload=function(){$(b.hiddenRightImg).css("display","")}}}if(settings.leftSideAd!=null&&b.config.leftPage!=null&&b.config.leftPage.type=="leftHandAd"&&(b.config.leftPage.adType=="dfp"||b.config.leftPage.adType=="url")){b.leftSidePainted()}};b.hiddenRightImg.onload=function(){a=true};var c=60;if((navigator.maxTouchPoints)){c=70}b.gifRight=b.topRight.element.down("img").dom;b.gifBottomRight=b.bottomRight.element.down("img").dom;$(b.gifRight).css("width",c);$(b.gifRight).css("height",c);$(b.gifBottomRight).css("width",c);$(b.gifBottomRight).css("height",c);$(b.gifRight).css("transform","translate3d("+c+"px, "+c+"px, 0px)");$(b.gifBottomRight).css("transform","translate3d("+c+"px, "+c+"px, 0px)");$(b.rightSideImg).attr("src",b.getImageUrl(b.rightPage,b.rightPageObject));$(b.rightSideImg).css("position","absolute");$(b.rightNextPage).attr("src",b.getImageUrl(b.nextPage,b.nextPageObject));b.rightSideImg.type=b.config.rightPage.type;if(b.nextPage==null){b.topRight.element.dom.style.visibility="hidden";b.bottomRight.element.dom.style.visibility="hidden"}if(b.hiddenRightPage!=null){if(b.hiddenRightPage.length>0){$(b.hiddenRightImg).css("display","none");$(b.hiddenRightImg).attr("src",b.getImageUrl(b.hiddenRightPage,b.hiddenRightPageObject))}else{$(b.hiddenRightImg).css("visibility","hidden")}}else{$(b.hiddenRightImg).css("visibility","hidden")}$(b.rightSideImageContainer).css("transform-origin","0% 0% 0px");b.rightSide.element.dom.style.zIndex="8"},rightSideImageLoad:function(b){var c=this;if(c.element!=null){if(c.rightPage!=null){var a=c.isActivePage(c.rightSideImageContainer,c.leftSideImageContainer);if(c.zoomMode=="fit"){c.rightSideImageFit()}else{c.rightSideImageFill();c.setUpPageTurnForImageFill()}if(a){c.pageLoaded(c.rightSideImageContainer)}c.rightThumbnailLoaded=true;c.fireEvent("rightThumbnailLoaded");if(c.config.rightPage.type=="sectionpage"){$(c.rightSideImg).addClass("pointerCursor");$(c.rightSideImg).css("z-index","99999");c.setupSectionTap(c.rightSideImg,function(){c.fireEvent("goRight")})}}}},rightSideImageFit:function(){var e=this;var b=e.isActivePage(e.rightSideImageContainer,e.leftSideImageContainer);e.naturalWidth=$(e.rightSideImg)[0].naturalWidth;e.naturalHeight=$(e.rightSideImg)[0].naturalHeight;var f=e.naturalWidth/e.naturalHeight;e.rightSideHeight=e.height=$(e.element.dom).height()-e.readerPaddingY;e.rightSideWidth=e.width=e.height*f;if(e.config.rightPage.type=="sectionpage"){if(e.leftSideImg!=null){e.width=$(e.leftSideImg).width()}e.topRight.hide();e.bottomRight.hide()}var d=$(e.element.dom).width()/2-e.readerPaddingX;if(e.mode=="single"){d=$(e.element.dom).width()}if(e.width<d){e.rightSideImageContainer.initialImageWidth=e.width;e.rightSideImageContainer.initialImageHeight=e.height;e.initialTranslateY=e.readerPaddingY;if(e.config.rightPage.type!="sectionpage"){$(e.rightSideImg).css("height",e.height)}else{$(e.rightSideImg).css("height","")}$(e.rightSideImg).css("width",e.width);$(e.rightSideImageContainer).css("height",e.height);$(e.rightSideImageContainer).css("width",e.width);$(e.rightSideNextPageContainer).css("height",e.height);$(e.rightSideNextPageContainer).css("width",e.width);$(e.rightNextPage).css("height",e.height);$(e.rightNextPage).css("width",e.width);$(e.hiddenRightImg).css("height",e.height);$(e.hiddenRightImg).css("width",e.width);$(e.hiddenRightGradient).css("height",e.height);$(e.hiddenRightGradient).css("width",e.width);var c=(e.height*e.height)+(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2))*(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));c=Math.sqrt(c);$(e.rightSideDiv).css("height",c+"px");$(e.rightSideDiv).css("width",c+"px");$(e.topRight.element.dom).css("top",e.top+e.readerPaddingY);$(e.topRight.element.dom).css("right",($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));$(e.bottomRight.element.dom).css("right",($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));if(b){if(e.mode=="single"){e.initialTranslateX=((d)-e.width)/2;e.rightSide.element.dom.style.visibility="visible";e.leftSide.element.dom.style.visibility="hidden"}else{e.initialTranslateX=(($(e.element.dom).width()/2)-e.width)}}}else{var f=e.naturalHeight/e.naturalWidth;e.rightSideWidth=e.width=d;e.rightSideHeight=e.height=e.width*f;e.rightSideImageContainer.initialImageWidth=e.width;e.rightSideImageContainer.initialImageHeight=e.height;$(e.rightSideImg).css("height",e.height);$(e.rightSideImg).css("width",e.width);$(e.rightSideImageContainer).css("height",e.height);$(e.rightSideImageContainer).css("width",e.width);$(e.rightSideNextPageContainer).css("height",e.height);$(e.rightSideNextPageContainer).css("width",e.width);$(e.rightNextPage).css("height",e.height);$(e.rightNextPage).css("width",e.width);$(e.hiddenRightImg).css("height",e.height);$(e.hiddenRightImg).css("width",e.width);$(e.hiddenRightGradient).css("height",e.height);$(e.hiddenRightGradient).css("width",e.width);var c=(e.height*e.height)+(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2))*(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));c=Math.sqrt(c);$(e.rightSideDiv).css("height",c+"px");$(e.rightSideDiv).css("width",c+"px");if(e.config.rightPage.type!="sectionpage"){e.top=($(e.element.dom).height()-e.height)/2}if(b){e.initialTranslateY=e.top;if(typeof isTribReader!="undefined"&&isTribReader==true){}}$(e.topRight.element.dom).css("top",e.top+e.readerPaddingY);$(e.topRight.element.dom).css("right",($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));$(e.bottomRight.element.dom).css("right",($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));$(e.bottomRight.element.dom).css("bottom",e.top)}if(e.config.leftPage.type=="sectionpage"){$(e.leftSideImageContainer).css("height","");$(e.leftSideImageContainer).css("width",e.width);$(e.leftSideImg).css("width",e.width)}},rightSideImageFill:function(){var e=this;var b=e.isActivePage(e.rightSideImageContainer,e.leftSideImageContainer);e.naturalWidth=$(e.rightSideImg)[0].naturalWidth;e.naturalHeight=$(e.rightSideImg)[0].naturalHeight;var f=e.naturalHeight/e.naturalWidth;var d=$(e.element.dom).width()/2-e.readerPaddingX;if(e.mode=="single"){d=$(e.element.dom).width()-(e.readerPaddingX*2)}e.rightSideWidth=e.width=Math.min(d,2000);e.rightSideHeight=e.height=(e.width*f)+e.readerPaddingY;$(e.rightSideImg).css("width",e.width);$(e.rightSideImg).css("height",e.height-e.readerPaddingY);$(e.rightSideImageContainer).css("height",e.height-e.readerPaddingY);$(e.rightSideImageContainer).css("width",e.width);$(e.rightSideDiv).css("width",e.width);$(e.rightSideDiv).css("height",e.height-e.readerPaddingY);e.rightSideImageContainer.initialImageWidth=e.width;e.rightSideImageContainer.initialImageHeight=e.height-e.readerPaddingY;e.initialTranslateY=e.readerPaddingY;e.initialTranslateX=((d)-e.width)/2+e.readerPaddingX;$(e.rightSideImageContainer).css("height",e.height-e.readerPaddingY);$(e.rightSideImageContainer).css("width",e.width);$(e.rightSideNextPageContainer).css("height",e.height-e.readerPaddingY);$(e.rightSideNextPageContainer).css("width",e.width);$(e.rightNextPage).css("height",e.height-e.readerPaddingY);$(e.rightNextPage).css("width",e.width);$(e.hiddenRightImg).css("height",e.height-e.readerPaddingY);$(e.hiddenRightImg).css("width",e.width);$(e.hiddenRightGradient).css("height",e.height-e.readerPaddingY);$(e.hiddenRightGradient).css("width",e.width);var c=(e.height*e.height)+(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2))*(e.width-($(e.element.dom).width())-e.width-($(e.element.dom).width()/2));c=Math.sqrt(c);$(e.rightSideDiv).css("height",c+"px");$(e.rightSideDiv).css("width",c+"px");e.scroller.setDisabled(false);if(e.scroller.maxPosition.x==0){e.scroller.setDirection("vertical")}e.scroller.setDirectionLock(true);if(e.config.rightPage.type=="sectionpage"){e.scroller.maxPosition.y=$(e.leftSideImg).height()-($(document).height()-$(e.leftSideImg).offset().top);e.topRight.hide();e.bottomRight.hide()}else{if(e.config.leftPage.type=="sectionpage"){e.scroller.maxPosition.y=$(e.rightSideImg).height()-($(document).height()-$(e.rightSideImg).offset().top)}}},pageLoaded:function(a){var b=this;b.imagePageHeight=a.initialImageHeight;b.imageNaturalHeight=a.image.naturalHeight;b.zoomDivContainer.setStyle("visibility:visible");var c=(b.getMaxZoomWidth()/a.initialImageWidth);var d=Math.max(1,c);b.setMaxScale(d);$("#slider").attr("max",d);if(Ext.browser.is.IE&&b.zoomMode=="fit"){b.scrollerDiv.dom.style.height=($(b.returnActiveImageContainer()).height()+(b.initialTranslateY*2))+"px"}b.isPageRendered=true;b.resetPage()},isActivePage:function(b,d){var a=this;var c=false;if(b!=null&&d!=null){if(b.image.type=="sectionpage"){c=false}else{if(d.image.type=="sectionpage"){c=true}else{if(b.pageNo==(a.getPageNo()+1)||d.image.type==null){c=true}}}}else{if(b!=null&&d==null){c=true}}return c},returnActiveImageContainer:function(){var b=this;var a=b.rightSideImageContainer;if(b.leftSideImageContainer.pageNo==(b.getPageNo()+1)||b.rightPage==null){a=b.leftSideImageContainer}if(a.image.type=="sectionpage"){if(b.rightSideImg.type=="sectionpage"){a=b.leftSideImageContainer}else{a=b.rightSideImageContainer}}return a},getImageContainer:function(a){var b=this;if(b.rightSideImageContainer.pageNo==a){return b.rightSideImageContainer}else{if(b.leftSideImageContainer.pageNo==a){return b.leftSideImageContainer}}return null},getThumbnail:function(c,b){var a=this;var d="";if(b.image!=null){d=b.image;if(b.pageNum>1){if(b.image.indexOf("pages.cdn.pagesuite.com")!=-1){d="http://pages.mobile.cdn.pagesuite.com/images/"+a.retrievePageGuid(b)+"/tablet.jpg"}}}c.src=d},completePDFLoaded:function(b){var a=this;if(a.isinitialized&&!a.hasTiled){mainPanel.fireEvent("removeSplash");a.loadPDFs(b);a.tryRenderMedia(true)}else{}},tryRenderMedia:function(b){var c=this;if(b&&!c.renderedMedia){var a=c.image;var d=c.landscapeimage;c.loadMediaImage(c.rightSideImageContainer,c.rightSideMediaDiv);c.loadMediaImage(c.leftSideImageContainer,c.leftSideMediaDiv);c.renderedMedia=true}},loadPDFs:function(d){var b=this;var a=true;if(settings.page.ignorePDFOnFit!=null){var c=b.returnImageRatio();if(c<1){a=false}}if(a){b.leftSideImageContainer.tileDiv.style.display="";b.rightSideImageContainer.tileDiv.style.display="";b.leftSideImageContainer.tileDiv2.style.display="";b.rightSideImageContainer.tileDiv2.style.display="";if(b.leftThumbnailLoaded){b.loadPDF(b.leftSideImageContainer,b.leftSideImg,d)}else{b.on("leftThumbnailLoaded",function(){b.loadPDF(b.leftSideImageContainer,b.leftSideImg,d)})}if(b.rightThumbnailLoaded){b.loadPDF(b.rightSideImageContainer,b.rightSideImg,d)}else{b.on("rightThumbnailLoaded",function(){b.loadPDF(b.rightSideImageContainer,b.rightSideImg,d)})}}else{b.leftSideImageContainer.tileDiv.style.display="none";b.rightSideImageContainer.tileDiv.style.display="none";b.leftSideImageContainer.tileDiv2.style.display="none";b.rightSideImageContainer.tileDiv2.style.display="none"}},loadPDF:function(b,e,f){var c=this;if(b.pageNo>0&&c.imageVisible(e)){if(e!=null){if(e.src.indexOf("pages.mobile.cdn.pagesuite.com")!=-1||e.src.indexOf("pages.cdn.pagesuite.com")!=-1||e.src.indexOf("pages.pagesuite.com")!=-1||e.src.indexOf("pagesn.pagesuite.com")!=-1){var d={tiled:false,pageNumber:b.pageNo,pdfPage:null};b.tilePDF=d;var a=c.returnEditionPage(b);if(a.pdfPage!=null){c.setUpTiledPDFPage(a.pdfPage,b)}else{if(a.pdf!=""){c.requestPage(a,b)}}}else{}}else{}}else{}},imageVisible:function(c){var b=this;var a=true;return a},returnEditionPage:function(c){var d=this;var b=editionFlatplanData.pageGroups;if(c.pageNo>0){var a=b[(c.pageNo-1)+pageOffset].pages[0];return a}return null},requestPage:function(a,b){var c=this;if(a.pdfRequest!=null){a.pdfRequest.then(function(d){if(d.pdfInfo.numPages>0){d.getPage(1).then(function(e){c.setUpTiledPDFPage(e,b)})}})}},getCanvases:function(b){var c=this;var a={activeCanvas:b.tileCanvas,nonActiveCanvas:b.tileCanvas2};if(b.activeCanvas==2){a.activeCanvas=b.tileCanvas2;a.nonActiveCanvas=b.tileCanvas}return a},setUpTiledPDFPage:function(j,o,e){var n=this;if(!o.togglingDPS){if(o.activeCanvas==1){o.activeCanvas=2}else{o.activeCanvas=1}}else{o.togglingDPS=false}var h=n.getCanvases(o);var b=h.activeCanvas;var l=h.nonActiveCanvas;if(typeof b!=undefined&&b!=null){n.setUpCanvas(o,b,j);var g=j.pageInfo.view[2]-j.pageInfo.view[0];var m=o.initialImageWidth;var f=(m*n.scale)/g;var k=j.getViewport(f);if(!!window.renderOptions&&window.renderOptions.disableCanvasAlpha){var a=b.getContext("2d",{alpha:false})}else{var a=b.getContext("2d")}var d={canvasContext:a,viewport:k};b.style.visibility="hidden";var p=function(){var r=n.imagetoload;clearTimeout(b.timeout);b.style.animationName="fadeIn";b.style.animationDuration="0.25s";b.style.visibility="visible";l.timeout=setTimeout(function(){l.style.visibility="hidden"},250);n.hasTiled=true};var q=function(){n.loadPDF(o)};var c=function(){n.pdfsLoaded=false;n.hasLoaded=false};if(!n.checkHighResImage(a,f)){n.fireEvent("renderPDF",j,d,n.getPageNo(),o.pageNo,p,q,c)}}},checkHighResImage:function(a,c){var b=this;devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;var d=b.returnImageRatio();if(settings.page.ignorePDFOnFit!=null&&d<1){return true}else{if(devicePixelRatio<=2&&backingStoreRatio<=1&&b.zoomMode=="fit"&&b.scale<=1&&settings.page.highResImage!=null){return true}else{return false}}},returnImageRatio:function(){var c=this;var b=c.imagePageHeight*c.scale;var a=window.devicePixelRatio;if(a<1){a=1}var d=c.imageNaturalHeight/a;return b/d},setUpCanvas:function(h,d,f){var g=this;if(g.element!=null){var b=h.initialImageWidth;var k=h.initialImageHeight;if(h.activeCanvas==1){h.tileDiv.style.width="100%";h.tileDiv.style.height="100%";h.tileDiv.style.top=0+"px";h.tileDiv.style.left=0+"px";h.tileDiv.style.webkitTransform="scale3d("+(1/g.scale)+","+(1/g.scale)+",1)";h.tileDiv.style.MozTransform="scale("+(1/g.scale)+","+(1/g.scale)+")";h.tileDiv.style.msTransform="scale3d("+(1/g.scale)+","+(1/g.scale)+",1)"}else{h.tileDiv2.style.width="100%";h.tileDiv2.style.height="100%";h.tileDiv2.style.top=0+"px";h.tileDiv2.style.left=0+"px";h.tileDiv2.style.webkitTransform="scale3d("+(1/g.scale)+","+(1/g.scale)+",1)";h.tileDiv2.style.MozTransform="scale("+(1/g.scale)+","+(1/g.scale)+")";h.tileDiv2.style.msTransform="scale3d("+(1/g.scale)+","+(1/g.scale)+",1)"}if(!!window.renderOptions&&window.renderOptions.disableCanvasAlpha){var c=d.getContext("2d",{alpha:false})}else{var c=d.getContext("2d")}devicePixelRatio=parseInt(window.devicePixelRatio)||1,backingStoreRatio=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;if(devicePixelRatio<1){devicePixelRatio=1}ratio=devicePixelRatio/backingStoreRatio;if(Ext.browser.is.Chrome&&g.getMaxScale()>2&&g.getMaxScale()/2<g.scale){ratio=1}h.tileDiv.style.display="";h.tileDiv2.style.display="";var a=1/ratio;if(a!=1){c.setTransform(a/2,0,0,a/2,0,0)}if(typeof auto==="undefined"){auto=true}if(auto&&devicePixelRatio!==backingStoreRatio){var e=(b*g.scale);var j=(k*g.scale);d.width=e*ratio;d.height=j*ratio;d.style.width=e+"px";d.style.height=j+"px";c._transformMatrix=[ratio,0,0,ratio,0,0];c.setTransform(1,0,0,1,0,0);c.scale(ratio,ratio);g.scaledCanvas=true}else{d.width=b*g.scale;d.height=k*g.scale;d.style.width=(b*g.scale)+"px";d.style.height=(k*g.scale)+"px"}d.desx=(g.scroller.position.x*-1);d.desxland=d.desx+(g.initialImageWidth*g.scale);d.desy=(g.scroller.position.y*-1);d.desw=parseInt(g.initialImageWidth*g.scale);d.desh=parseInt(g.initialImageHeight*g.scale)}},loadMediaImage:function(c,e){var d=this;var a=c.pageNo;if(d.canLoadMedia(a)){var b=flatPlanData.pageGroups[a-1+pageOffset].pages[0].pageNum;d.fireEvent("loadMedia",d,b,e)}d.mediaLoaded=true},canLoadMedia:function(a){var c=this;if(flatPlanData.pageGroups[a-1+pageOffset]!=null){var b=flatPlanData.pageGroups[a-1+pageOffset].pages[0];if(b.type!="page"){return false}return true}else{return false}},onZoomStart:function(f,a){var g=this;var c=(g.pageWidth/2);var b=(g.pageHeight/2);var e=c+g.scroller.position.x;var d=b+g.scroller.position.y;var k=g.returnActiveImageContainer();var j=(k.initialImageHeight)*g.scale;var h=0;if(j>$(g.element.dom).height()&&g.zoomMode=="fit"&&!Ext.browser.is.Firefox){h=g.initialTranslateY}g.zoomPointX=((e)/(g.scale));g.zoomPointY=((d)/(g.scale))+h;g.offsetX=(c-g.zoomPointX);g.offsetY=(b-g.zoomPointY);g.offsetScrollerX=g.offsetX+g.scroller.position.x;g.offsetScrollerY=(g.offsetY+g.scroller.position.y);g.initializeTouch(g.zoomPointX,g.zoomPointY);g.translateX+=g.offsetScrollerX;g.translateY+=g.offsetScrollerY;g.applyTransform(g.scale)},onZoom:function(c,b){var a=this;a.currentScale=b.dom.valueAsNumber;a.applyTransform(a.currentScale)},onZoomEnd:function(c,b){var a=this;if(a.currentScale<=1){a.resetPage();a.finishZoom(false);if(a.zoomMode=="fit"&&a.mode=="double"){a.showNavButtons()}else{a.hideNavButtons()}}else{a.scale=a.currentScale;a.finishZoom(false);a.hideNavButtons()}if(a.zoomTileInterval!=null){clearInterval(a.zoomTileInterval)}a.zoomTileInterval=setInterval(function(){a.zoomTile(a)},500)},zoomTile:function(a){clearInterval(a.zoomTileInterval);a.startTiling()},zoomOnPoint:function(b,a){var c=this;if(settings.reader.doubleTapFullZoom!=null&&settings.reader.doubleTapFullZoom!="true"){if(c.scale<c.getMaxScale()/2){c.initializeTouch(b,a);c.scale=c.getMaxScale()/2;c.zoomLevel="mid";if(document.getElementById("slider")!=null){document.getElementById("slider").value=c.getMaxScale()/2;c.hideNavButtons()}}else{if(c.scale<c.getMaxScale()){b=(c.scroller.position.x+event.pageX)/c.scale;a=(c.scroller.position.y+event.pageY)/c.scale;c.initializeTouch(b,a);c.scale=c.getMaxScale();c.zoomLevel="full";if(document.getElementById("slider")!=null){document.getElementById("slider").value=c.getMaxScale();c.hideNavButtons()}}else{c.zoomLevel="none";c.doubleTapReset()}}}else{if(c.scale==1){c.initializeTouch(b,a);c.scale=c.getMaxScale();if(document.getElementById("slider")!=null){document.getElementById("slider").value=c.getMaxScale();c.hideNavButtons()}}else{c.doubleTapReset()}}},doubleTapReset:function(){var a=this;a.resetPage();if(a.zoomMode=="fit"&&a.mode=="double"){a.showNavButtons()}else{a.hideNavButtons()}},onDoubleTap:function(c){var b=this;if(b.canDoubleTap){b.canDoubleTap=false;var a=b.scroller.position;b.zoomPosition=b.scroller.position;b.zoomPointX=(c.pageX-(b.wrapAdOffset)+b.scroller.position.x)/b.scale;b.zoomPointY=(c.pageY-(b.topPadding)+b.scroller.position.y)/b.scale;var f=b.scroller.position.y/b.scroller.maxPosition.y;var e=(b.pageWidth/2);var d=(b.pageHeight/2);b.offsetY=(c.pageY-b.zoomPointY);if(b.mode=="double"&&b.leftPage==null){var g=(b.pageWidth/2);if(b.zoomPointX<g){b.canDoubleTap=true;return}}else{if(b.mode=="double"&&b.rightPage==null){var g=(b.pageWidth/2);if(b.zoomPointX>g){b.canDoubleTap=true;return}}}b.zoomOnPoint(b.zoomPointX,b.zoomPointY);b.finishZoom(true);setTimeout(function(){b.canDoubleTap=true},500)}},resetPage:function(){var c=this;var d=c.returnActiveImageContainer();var b=d.clientWidth;var a=d.clientHeight;var e=(b*2);if(c.mode=="single"){e=b}c.zoomDiv.dom.style.width=e+"px";c.zoomDiv.dom.style.height=a+"px";c.translateX=c.initialTranslateX;c.translateY=c.initialTranslateY;c.scale=1;c.applyTransform(c.scale);if(document.getElementById("slider")!=null){document.getElementById("slider").value=1}},initializeTouch:function(b,a){var c=this;c.elementTouchX=b-c.translateX;c.elementTouchY=a-c.translateY;c.setOrigin(c.elementTouchX,c.elementTouchY)},setOrigin:function(a,c){var b=this;b.zoomDiv.dom.style.webkitTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.MozTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.msTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.transformOrigin=a+"px "+c+"px"},applyTransform:function(b){var a=this;a.zoomDiv.dom.style.webkitTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.MozTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.msTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.transform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.webkitBackfaceVisibility="hidden";a.zoomDiv.dom.style.webkitPerspective="1000";a.zoomDiv.dom.style.backfaceVisibility="hidden";a.zoomDiv.dom.style.perspective="1000"},finishZoom:function(a){var b=this;if(b.scale<=1){b.fireEvent("hideNavButtons");b.resetZoom(true);b.element.dom.style.overflow="visible"}else{b.fireEvent("showNavButtons");b.setZoom(a);b.element.dom.style.overflow="hidden"}},resetZoom:function(n){var m=this;if(m.rightSideMediaDiv!=null){if(m.rightSideMediaDiv.children.length>0){for(var g=0;g<m.rightSideMediaDiv.children.length;g++){try{var o=m.rightSideMediaDiv.children[g].children[0].children[0].children[0].children[0].children[0];if(o.className=="tool-tip"){o.style.fontSize="12px";o.style.padding="5px";o.style.border="2px solid white";o.style.borderRadius="5px"}}catch(j){}}}}if(m.leftSideMediaDiv!=null){if(m.leftSideMediaDiv.children.length>0){for(var g=0;g<m.leftSideMediaDiv.children.length;g++){try{var o=m.leftSideMediaDiv.children[g].children[0].children[0].children[0].children[0].children[0];if(o.className=="tool-tip"){o.style.fontSize="12px";o.style.padding="5px";o.style.border="2px solid white";o.style.borderRadius="5px"}}catch(j){}}}}m.scrollerDiv.dom.style.width="";if(m.zoomMode=="fit"){if(Ext.browser.is.IE){m.scrollerDiv.dom.style.height=($(m.returnActiveImageContainer()).height()+(m.initialTranslateY*2))+"px"}else{m.scrollerDiv.dom.style.height=""}}else{if(m.mode=="single"){m.scrollerDiv.dom.style.height=$(m.returnActiveImageContainer()).height()+"px"}else{if(m.config.rightPage.type!="sectionpage"&&m.config.leftPage.type!="sectionpage"){var a=Math.max(m.leftSideImg.clientHeight,m.rightSideImg.clientHeight);m.scrollerDiv.dom.style.height=a+"px"}else{m.scrollerDiv.dom.style.height=$(m.returnActiveImageContainer()).height()+"px"}}}if(m.zoomMode=="fit"){m.scrollTo(0,0)}else{var h=m.zoomPointX-m.initialTranslateX;var f=m.zoomPointY-m.initialTranslateY;var l=h*m.scale;var k=f*m.scale;var c=l-m.zoomPointX+m.offsetX;var b=k-m.zoomPointY-m.offsetY;if(m.mode=="single"){m.translateX=m.initialTranslateX}m.translateY=m.initialTranslateY;var d=m.offsetY;m.offsetX=0;m.offsetY=0;b=Math.max(m.scroller.minPosition.y,b);m.scroller.refresh(m.scroller);b=Math.min(m.scroller.maxPosition.y,b);m.scroller.scrollTo(0,b)}if(m.zoomMode=="fill"){m.scroller.setDisabled(false);m.scroller.setDirection("vertical");m.scroller.setDirectionLock(true);m.fireEvent("fillMode",m);if(m.mode=="double"){if(m.config.rightPage.type=="sectionpage"){$(m.topRight.element.dom).css("display","none")}else{$(m.topRight.element.dom).css("display","")}if(m.config.leftPage.type=="sectionpage"){$(m.topLeft.element.dom).css("display","none")}else{$(m.topLeft.element.dom).css("display","")}}}else{m.scroller.setDisabled(true);m.fireEvent("fitMode");if(m.config.rightPage.type=="sectionpage"){}if(m.config.leftPage.type=="sectionpage"){$(m.leftSideImg).css("height","")}}m.offsetX=0;m.offsetY=0;m.scroller.position.x=0;m.zoomDiv.dom.style.position="absolute";m.zoomDiv.dom.style.left="";m.hiddenLeft.element.dom.style.left="";if(m.zoomMode=="fit"){m.fireEvent("fitMode")}else{m.fireEvent("fillMode")}if(settings.leftSideAd!=null&&m.config.leftPage.type=="leftHandAd"&&m.config.leftPage.adType=="dfp"){if(m.isinitialized){m.resizeDfp()}}m.startTiling()},setZoom:function(a){var u=this;currentPageDebug=this;if(u.rightSideMediaDiv!=null){if(u.rightSideMediaDiv.children.length>0){for(var o=0;o<u.rightSideMediaDiv.children.length;o++){try{var f=u.rightSideMediaDiv.children[o].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/u.scale)+"px";f.style.padding=(5/u.scale)+"px";f.style.border=(2/u.scale)+"px solid white";f.style.borderRadius=(5/u.scale)+"px";f.style.backfaceVisibility="hidden"}}catch(q){}}}}if(u.leftSideMediaDiv!=null){if(u.leftSideMediaDiv.children.length>0){for(var o=0;o<u.leftSideMediaDiv.children.length;o++){try{var f=u.leftSideMediaDiv.children[o].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/u.scale)+"px";f.style.padding=(5/u.scale)+"px";f.style.border=(2/u.scale)+"px solid white";f.style.borderRadius=(5/u.scale)+"px";f.style.backfaceVisibility="hidden"}}catch(q){}}}}var t=u.returnActiveImageContainer();u.zoomDiv.dom.style.width=(100/u.scale)+"%";var c=(t.initialImageWidth)*u.scale*2;var h=(u.pageWidth*u.scale);if(u.mode=="single"){c=(t.initialImageWidth)*u.scale}var l=(t.initialImageHeight)*u.scale;var b=(u.pageHeight*u.scale);var v=Math.max(c,h);var s=Math.max(l,b);u.scrollerDiv.dom.style.width=v+"px";u.scrollerDiv.dom.style.height=s+"px";u.setOrigin(0,0);var d=true;u.zoomDiv.dom.style.position="absolute";u.zoomDiv.dom.style.left="";if(u.mode=="single"){u.translateX=u.initialTranslateX*u.scale;u.translateY=u.initialTranslateY*u.scale;u.offsetX=(u.offsetX*-1)+(u.initialTranslateX*u.scale);u.offsetY=(u.offsetY)+(u.initialTranslateY*u.scale)}else{u.translateX=0;u.translateY=u.initialTranslateY*u.scale;u.offsetX=(u.offsetX*-1)+(u.initialTranslateX*u.scale);u.offsetY=((u.offsetY*-1)+(u.initialTranslateY*u.scale))*-1}u.applyTransform(u.scale);u.scroller.setDisabled(false);u.scroller.setDirection("both");var m=u.zoomPointX-u.initialTranslateX;var j=u.zoomPointY-u.initialTranslateY;var r=m*u.scale;var p=j*u.scale;var n=r-u.zoomPointX+u.offsetX;var k=p-u.zoomPointY-u.offsetY;if(u.mode=="single"){u.translateX=u.initialTranslateX}u.translateY=u.initialTranslateY;var g=u.offsetY;u.offsetX=0;u.offsetY=0;if(Ext.browser.is.Firefox){if(u.scrollerDiv.setScrollable!=null){u.scrollerDiv.setScrollable({direction:"both"});u.scrollerDiv.getScrollable().getScroller().scrollTo(n,k)}else{if(u.zoomMode=="fit"){u.scroller.maxPosition.x=h-$(u.element.dom).width();u.scroller.maxPosition.y=b-$(u.element.dom).height();if(k<=0){k=0}else{if(k>=b-$(u.element.dom).height()){k=b-$(u.element.dom).height()}}if(n<=0){n=0}else{if(n>=h-$(u.element.dom).width()){n=h-$(u.element.dom).width()}}}else{u.scroller.maxPosition.x=h-$(u.element.dom).width();u.scroller.maxPosition.y=l-$(u.element.dom).height();if(k<=0){k=0}else{if(k>=l-$(u.element.dom).height()){k=l-$(u.element.dom).height()}}if(n<=0){n=0}else{if(n>=h-$(u.element.dom).width()){n=h-$(u.element.dom).width()}}}u.scroller.getMaxPosition()}}else{u.scrollerDiv.dom.style.height=(l)+"px";if(u.zoomMode=="fit"){u.resetTop(l);k-=(u.translateY)*u.scale}}u.scroller.scrollTo(n,k);if(a){u.startTiling()}},resetTop:function(a){var b=this;var c=0;if(a<$(b.element.dom).height()){c=($(b.element.dom).height()-a)/2}b.zoomDiv.dom.style.transform="translate3d("+(b.translateX*b.scale)+"px, "+c+"px, 0) scale3d("+b.scale+","+b.scale+",1)"},scrollTo:function(a,c){var b=this;b.scroller.scrollTo(a,c)},hideNavButtons:function(){var a=this;a.topRight.setHidden(true);a.topLeft.setHidden(true);a.bottomRight.setHidden(true);a.bottomLeft.setHidden(true)},showNavButtons:function(){var a=this;a.topRight.setHidden(false);a.topLeft.setHidden(false);a.bottomRight.setHidden(false);a.bottomLeft.setHidden(false)},startTiling:function(){var a=this;a.loadPDFs()},toggleDPS:function(c,a){var b=this;b.checkPageMode(c);b.rightSideImageContainer.togglingDPS=true;b.leftSideImageContainer.togglingDPS=true;b.initialTranslateX=0;b.initialTranslateY=0;b.fireEvent("checkAudioOnToggle",b);b.resetZoom()},checkPageMode:function(b){var a=this;if(b=="double"){a.toggleDPSDouble()}else{a.toggleDPSSingle()}},toggleDPSDouble:function(){var c=this;c.mode="double";c.leftSide.element.dom.style.visibility="visible";$(c.leftSideImg).css("visibility","");c.leftSide.element.dom.style.right="0%";c.leftSide.setWidth("50%");c.leftSideDiv.style.left="";c.leftSideImageContainer.style.left="";c.rightSide.element.dom.style.visibility="visible";$(c.rightSideImg).css("visibility","");c.rightSide.element.dom.style.left="50%";c.rightSide.setWidth("50%");c.rightSideDiv.style.left="";c.rightSideImageContainer.style.left="";var a=c.getPageNo();a=flatPlanData.pageMapper[a+1];c.rightSide.setLeft("50%");c.hiddenRight.setHidden(false);c.hiddenLeft.setHidden(false);if(a+pageOffset==0){c.leftSide.element.dom.style.visibility="hidden"}else{if(a==2){c.hiddenLeftImg.style.visibility="hidden"}}c.rightSide.element.down("canvas").show();c.leftSide.element.down("canvas").show();var b=Ext.getStore("SettingStore");if(c.zoomMode=="fill"){c.setUpPageTurnForImageFill()}else{c.hiddenRight.show();c.hiddenLeft.show();c.showNavButtons();c.fireEvent("setupKeys");$(c.topRight.element.dom).css("top",c.top);$(c.topRight.element.dom).css("right",($(c.element.dom).width())-c.width-($(c.element.dom).width()/2))}if(b.leftSideAd!=null&&c.config.leftPage.type=="leftHandAd"&&c.config.leftPage.adType=="dfp"){if(c.isinitialized){c.resizeDfp()}}},toggleDPSSingle:function(){var g=this;g.mode="single";var c=g.leftSide;var f=g.leftSideDiv;var k=g.leftSideImageContainer;var h=g.rightSide;var b=g.rightSideDiv;var e=g.rightSideImageContainer;var a=g.getPageNo();if(a==-1){a=0}a=flatPlanData.reversePageMapper[a+1];var d=g.getPageNo()+1;var j=g.returnAdvertOffset(d+pageOffset);if((a+j)%2==0){c=g.rightSide;f=g.rightSideDiv;k=g.rightSideImageContainer;h=g.leftSide;b=g.leftSideDiv;e=g.leftSideImageContainer;g.rightSide.element.down("canvas").hide()}else{g.leftSide.element.down("canvas").hide()}c.element.dom.style.visibility="hidden";h.element.dom.style.left="0%";if(g.returnActiveImageContainer().className.indexOf("leftSideImgContainer")!=-1){$(g.leftSideImg).css("visibility","")}else{$(g.leftSideImg).css("visibility","hidden")}b.style.left="0%";e.style.left="0%";g.rightSide.setLeft(0);g.hiddenRight.setHidden(true);g.hiddenLeft.setHidden(true);g.hideNavButtons()},toggleDPSNonActive:function(c,b){var a=this;a.toggleDPSPageNumber(c,b);if(!a.needToReloadPage()){a.toggleDPS(c)}else{a.hasTiled=false;a.reloadPage(c)}},toggleDPSPageNumber:function(g,f){var e=this;var a=e.returnReverseMappedPageNumber(e.getPageNo());var c=e.returnReverseMappedPageNumber(f.getPageNo());var b=a-c;var d=0;if(g=="double"){if(flatPlanData.bookmarks!=null){if(flatPlanData.bookmarks.indexOf(c+2)!=-1&&b>0){d=0}else{if(flatPlanData.bookmarks.indexOf(c+1)!=-1&&b<0){d=0}else{d=b}}}else{d=b}}else{d=parseInt(b/-2)}e.adjustPageNo(d,g)},returnMappedPageNumber:function(a){return(flatPlanData.pageMapper[a-1]+1)},returnReverseMappedPageNumber:function(a){var b=this;var c=flatPlanData.pageGroups.length-pageOffset;return(flatPlanData.reversePageMapper[Math.min(c,a+1)]-1)},needToReloadPage:function(){var c=this;var b=c.getPageNo()+1;var a=c.rightSideImageContainer.pageNo;var d=c.leftSideImageContainer.pageNo;if(b==a||b==d){return false}return true},reloadPage:function(b){var a=this;a.mode=b;a.leftThumbnailLoaded=false;a.rightThumbnailLoaded=false;if(settings.leftSideAd!=null&&a.config.leftPage!=null&&a.config.leftPage.type=="leftHandAd"&&a.config.leftPage.adType=="dfp"){a.destroyDfpLeftHandAd()}a.disableTiling();a.asignPages();a.setupPages();if(a.isPageRendered){a.pagePainted();if(a.mode!="single"&&a.zoomMode!="fill"){a.finishZoom(true)}}},destroyDfpLeftHandAd:function(){var a=this;var b=a.advertDiv;if(b!=null){$(a.advertDiv).remove();if(a.adSlot1!=null&&typeof googletag!="undefined"){googletag.destroySlots([a.adSlot1])}delete a.advertDiv}},asignPages:function(){var n=this;var l=editionFlatplanData.pageGroups;var h=n.getPageNo()+1+pageOffset;var e="";var a="";var k="";var c="";var o="";var r="";var g=n.getPageNo()+1;var q=n.returnAdvertOffset(g);if((parseInt(h)+parseInt(0))%2==pageOffset){h++}h--;h=Math.max(0,parseInt(h));var m=h;if(m<=(l.length-1)){c=l[(m)].pages[0]}var j=(h-1);if(j>=0){k=l[j].pages[0]}var b=(h-2);if(b>=0){a=l[b].pages[0]}var d=(h-3);if(d>=0){e=l[d].pages[0]}var p=(h+1);if(p<=(l.length-1)){o=l[(p)].pages[0]}var f=(h+2);if(f<=(l.length-1)){r=l[(f)].pages[0]}n.config.rightPage=c;n.config.leftPage=k;n.config.previousPage=a;n.config.hiddenLeftPage=e;n.config.nextPage=o;n.config.hiddenRightPage=r},setInitialVariables:function(){var a=this;a.initialTranslateX=200;a.initialTranslateY=0},toggleZoomMode:function(c){var b=this;b.zoomMode=c;if(b.zoomMode=="fit"){b.fireEvent("fitMode");if(b.mode=="double"){b.hiddenRight.show();b.hiddenLeft.show();b.showNavButtons();b.fireEvent("setupKeys");$(b.topRight.element.dom).css("top",b.top);$(b.topRight.element.dom).css("right",($(b.element.dom).width())-b.width-($(b.element.dom).width()/2))}else{b.fireEvent("setupKeys");b.hideNavButtons()}b.element.dom.onmousewheel=(function(d){if(b.scale>1){if(d.wheelDelta>0){if(b.scroller.position.y-120>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-120);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(b.scroller.position.y+120<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+120);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}}});b.element.dom.addEventListener("DOMMouseScroll",function(d){if(b.scale>1){if(d.detail<=0){if(b.scroller.position.y-60>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-60);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(d.detail>=0){if(b.scroller.position.y+60<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+60);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}}}})}else{b.hideNavButtons();b.fireEvent("fillMode");b.fireEvent("keyControls");b.element.dom.onmousewheel=(function(d){if(b.scroller.maxPosition.y>0){if(d.wheelDelta>0){if(b.scroller.position.y-120>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-120);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(b.scroller.position.y+120<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+120);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}}});b.element.dom.addEventListener("DOMMouseScroll",function(d){if(b.scroller.maxPosition.y>0){if(d.detail<=0){if(b.scroller.position.y-60>0){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y-60);b.fireEvent("showTop");b.fireEvent("showBottom")}else{b.scroller.scrollTo(b.scroller.position.x,0);b.fireEvent("hideTop");b.fireEvent("showBottom")}}else{if(b.scroller.position.y+60<b.scroller.maxPosition.y){b.scroller.scrollTo(b.scroller.position.x,b.scroller.position.y+60);b.fireEvent("showBottom");b.fireEvent("showTop")}else{b.scroller.scrollTo(b.scroller.position.x,b.scroller.maxPosition.y);b.fireEvent("hideBottom");b.fireEvent("showTop")}}}});if(b.mode=="double"){b.setUpPageTurnForImageFill();if(b.config.rightPage.type=="sectionpage"){b.topRight.hide();b.bottomRight.hide()}}}b.initialTranslateX=0;b.initialTranslateY=0;b.rightSideImageContainer.togglingDPS=true;b.leftSideImageContainer.togglingDPS=true;if(b.isPageRendered){b.leftSideImageLoad();b.rightSideImageLoad();b.resetZoom();$(b.rightSideDiv).css("transform","");$(b.rightSideImageContainer).css("transform","")}if(Ext.browser.is.Firefox&&b.zoomMode=="fill"){var a=b.returnActiveImageContainer().clientHeight;b.scroller.maxPosition.y=a-b.getScrollable()._indicators.y._length}if(settings.leftSideAd!=null&&b.config.leftPage.type=="leftHandAd"&&b.config.leftPage.adType=="dfp"){if(b.isinitialized){b.resizeDfp()}}},setUpPageTurnForImageFill:function(){var a=this;if(a.mode=="double"){a.topRight.setHidden(false);a.topLeft.setHidden(false);a.topRight.element.dom.style.visible="visible";a.topLeft.element.dom.style.visible="visible";if(a.config.rightPage.type=="sectionpage"){a.topRight.setHidden(true);a.bottomRight.setHidden(true)}if(a.config.leftPage.type=="sectionpage"){a.topLeft.setHidden(true);a.bottomLeft.setHidden(true)}}$(a.topRight.element.dom).css("top","0px");$(a.topRight.element.dom).css("right",0+a.readerPaddingX);$(a.topLeft.element.dom).css("top","0px");$(a.topLeft.element.dom).css("left",0+a.readerPaddingX)},getPageNo:function(){return this.config.pageNo},adjustPageNo:function(c,d){var b=this;var e=flatPlanData.pageGroups.length-1-pageOffset;var a=Math.min(e,Math.max(0,(b.config.pageNo+c)));console.log("adjusting",a);b.config.pageNo=a},startDrag:function(d){var c=this;if(d!=null){if(d.stopPropagation!=null){d.stopPropagation()}}$(c.rightSideNextPageContainer).css("display","");$(c.leftSidePrevPageContainer).css("display","");if(c.zoomMode=="fit"){c.addCls("desktoppageviewer")}c.hiddenRight.setStyle("visibility:visible;");c.leftPrevPage.style.visibility="hidden";c.pauseFlashingLinks();InfinityMobile.app.getController("PdfController").pausePage();$(c.rightSideDiv).css("transform-origin","0% 0% 0px");$(c.rightSideImageContainer).css("transform-origin","0% 0% 0px");$(c.rightSideNextPageContainer).css("transform-origin","0% 0% 0px");$(c.rightSideGradient).css("transform-origin","0% 0% 0px");$(c.rightSideDiv).css("transform","");$(c.rightSideImageContainer).css("transform","");$(c.rightSideNextPageContainer).css("transform","");$(c.rightSideGradient).css("transform","");$(c.rightSideDiv).css("bottom","");$(c.rightSideImageContainer).css("top","0%");$(c.rightSideImageContainer).css("bottom","");$(c.rightSideImageContainer).css("left","0%");$(c.rightSideNextPageContainer).css("visibility","hidden");$(c.rightSideNextPageContainer).css("overflow","hidden");$(c.rightSideNextPageContainer).css("top","0%");$(c.rightSideNextPageContainer).css("bottom","");$(c.rightSideNextPageContainer).css("left","0% ");$(c.rightSideGradient).css("top","0%");$(c.rightSideGradient).css("bottom","");$(c.rightSideGradient).css("left","0% ");$(c.rightSideGradient).css("visibility","hidden");$(c.rightSideGradient).css("z-index","11");c.rightSide.element.dom.style.zIndex="10";c.leftSide.element.dom.style.zIndex="8";c.rightSide.setZIndex(10);c.leftSide.setZIndex(8);c.leftSideMediaDiv.style.visibility="hidden";c.rightSideMediaDiv.style.visibility="hidden";var a=270;var b=0.3;$(c.rightSideGradient).css("background","-webkit-linear-gradient("+a+"deg,  rgba(0,0,0,"+b+") "+(((b*100)*0.9))+"%, rgba(76,76,76,0) 100%)");$(c.rightSideGradient).css("height","70px");$(c.rightSideGradient).css("width",$(c.rightSideDiv).width());$(c.gifRight).css("visibility","hidden");$(c.rightSideDiv).css("overflow","hidden");c.diffX=($(c.topRight.element.dom).offset().left+$(c.topRight.element.dom)[0].getBoundingClientRect().width)-$(c.element.dom).width()-c.wrapAdOffset;c.diffY=$(c.topRight.element.dom).offset().top;if(!Ext.browser.is.IE){if(c.element.dom.parentElement!=null&&settings.reader.wrapAd==null){c.element.dom.parentElement.parentElement.style.overflowY="visible"}}c.addCls("disableIframe")},startDragLeft:function(d){var c=this;if(d!=null){if(d.stopPropagation!=null){d.stopPropagation()}}$(c.rightSideNextPageContainer).css("display","");$(c.leftSidePrevPageContainer).css("display","");if(c.zoomMode=="fit"){c.addCls("desktoppageviewer")}c.hiddenLeft.setStyle("visibility:visible;");c.rightNextPage.style.visibility="hidden";c.pauseFlashingLinks();InfinityMobile.app.getController("PdfController").pausePage();$(c.leftSideDiv).css("transform-origin","100% 0% 0px");$(c.leftSideImageContainer).css("transform-origin","100% 0% 0px");$(c.leftSidePrevPageContainer).css("transform-origin","100% 0% 0px");$(c.leftSideGradient).css("transform-origin","100% 0% 0px");$(c.leftSideDiv).css("transform","");$(c.leftSideImageContainer).css("transform","");$(c.leftSidePrevPageContainer).css("transform","");$(c.leftSideGradient).css("transform","");$(c.leftSideDiv).css("bottom","");$(c.leftSideImageContainer).css("top","0%");$(c.leftSideImageContainer).css("bottom","");$(c.leftSideImageContainer).css("right","0%");$(c.leftSidePrevPageContainer).css("visibility","hidden");$(c.leftSidePrevPageContainer).css("overflow","hidden");$(c.leftSidePrevPageContainer).css("top","0%");$(c.leftSidePrevPageContainer).css("bottom","");$(c.leftSidePrevPageContainer).css("right","0% ");$(c.leftSideGradient).css("top","0%");$(c.leftSideGradient).css("bottom","");$(c.leftSideGradient).css("right","0% ");$(c.leftSideGradient).css("visibility","hidden");$(c.leftSideGradient).css("z-index","11");c.rightSide.element.dom.style.zIndex="8";c.leftSide.element.dom.style.zIndex="10";c.rightSide.setZIndex(8);c.leftSide.setZIndex(10);c.leftSideMediaDiv.style.visibility="hidden";c.rightSideMediaDiv.style.visibility="hidden";var a=270;var b=0.3;$(c.leftSideGradient).css("background","-webkit-linear-gradient("+a+"deg,  rgba(0,0,0,"+b+") "+(((b*100)*0.9))+"%, rgba(76,76,76,0) 100%)");$(c.leftSideGradient).css("height","70px");$(c.leftSideGradient).css("width",$(c.leftSideDiv).width());$(c.gifLeft).css("visibility","hidden");$(c.leftSideDiv).css("overflow","hidden");c.diffX=$(c.topLeft.element.dom).offset().left*-1+c.wrapAdOffset;c.diffY=$(c.topLeft.element.dom).offset().top;if(!Ext.browser.is.IE){if(c.element.dom.parentElement!=null&&settings.reader.wrapAd==null){c.element.dom.parentElement.parentElement.style.overflow="visible"}}c.addCls("disableIframe")},startDragBottomRight:function(d){var c=this;if(c.zoomMode=="fit"){c.addCls("desktoppageviewer")}$(c.rightSideNextPageContainer).css("display","");$(c.leftSidePrevPageContainer).css("display","");c.hiddenRight.setStyle("visibility:visible;");c.pauseFlashingLinks();InfinityMobile.app.getController("PdfController").pausePage();$(c.rightSideDiv).css("transform-origin","0% 100% 0px");$(c.rightSideImageContainer).css("transform-origin","0% 100% 0px");$(c.rightSideNextPageContainer).css("transform-origin","0% 100% 0px");$(c.rightSideGradient).css("transform-origin","0% 100% 0px");$(c.rightSideDiv).css("transform","");$(c.rightSideImageContainer).css("transform","");$(c.rightSideNextPageContainer).css("transform","");$(c.rightSideGradient).css("transform","");$(c.rightSideDiv).css("top","");$(c.rightSideDiv).css("bottom",0);$(c.rightSideImageContainer).css("top","");$(c.rightSideImageContainer).css("bottom","0%");$(c.rightSideImageContainer).css("left","0%");$(c.rightSideNextPageContainer).css("visibility","hidden");$(c.rightSideNextPageContainer).css("overflow","hidden");$(c.rightSideNextPageContainer).css("top","");$(c.rightSideNextPageContainer).css("bottom","0%");$(c.rightSideNextPageContainer).css("left","0% ");$(c.rightSideGradient).css("top","");$(c.rightSideGradient).css("bottom","0%");$(c.rightSideGradient).css("left","0% ");$(c.rightSideGradient).css("visibility","hidden");$(c.rightSideGradient).css("z-index","11");c.rightSide.element.dom.style.zIndex="10";c.leftSide.element.dom.style.zIndex="8";c.rightSide.setZIndex(10);c.leftSide.setZIndex(8);c.leftSideMediaDiv.style.visibility="hidden";c.rightSideMediaDiv.style.visibility="hidden";var a=90;var b=0.3;$(c.rightSideGradient).css("background","-webkit-linear-gradient("+a+"deg,  rgba(0,0,0,"+b+") "+(((b*100)*0.9))+"%, rgba(76,76,76,0) 100%)");$(c.rightSideGradient).css("height","70px");$(c.rightSideGradient).css("width",$(c.rightSideDiv).width());$(c.gifBottomRight).css("visibility","hidden");$(c.rightSideDiv).css("overflow","hidden");c.diffX=($(c.topRight.element.dom).offset().left+$(c.topRight.element.dom)[0].getBoundingClientRect().width)-$(c.element.dom).width()-c.wrapAdOffset;c.diffY=$(c.topRight.element.dom).offset().top;if(!Ext.browser.is.IE){if(c.element.dom.parentElement!=null&&settings.reader.wrapAd==null){c.element.dom.parentElement.parentElement.style.overflow="visible"}}c.addCls("disableIframe")},startDragBottomLeft:function(d){var c=this;if(c.zoomMode=="fit"){c.addCls("desktoppageviewer")}$(c.rightSideNextPageContainer).css("display","");$(c.leftSidePrevPageContainer).css("display","");c.hiddenLeft.setStyle("visibility:visible;");c.pauseFlashingLinks();InfinityMobile.app.getController("PdfController").pausePage();$(c.leftSideDiv).css("transform-origin","100% 100% 0px");$(c.leftSideImageContainer).css("transform-origin","100% 100% 0px");$(c.leftSidePrevPageContainer).css("transform-origin","100% 100% 0px");$(c.leftSideGradient).css("transform-origin","100% 100% 0px");$(c.leftSideDiv).css("transform","");$(c.leftSideImageContainer).css("transform","");$(c.leftSidePrevPageContainer).css("transform","");$(c.leftSideGradient).css("transform","");$(c.leftSideDiv).css("top","");$(c.leftSideDiv).css("bottom",0);$(c.leftSideImageContainer).css("top","");$(c.leftSideImageContainer).css("bottom","0%");$(c.leftSideImageContainer).css("right","0%");$(c.leftSidePrevPageContainer).css("visibility","hidden");$(c.leftSidePrevPageContainer).css("overflow","hidden");$(c.leftSidePrevPageContainer).css("top","");$(c.leftSidePrevPageContainer).css("bottom","0%");$(c.leftSidePrevPageContainer).css("right","0% ");$(c.leftSideGradient).css("top","");$(c.leftSideGradient).css("bottom","0%");$(c.leftSideGradient).css("right","0% ");$(c.leftSideGradient).css("visibility","hidden");$(c.leftSideGradient).css("z-index","11");c.rightSide.element.dom.style.zIndex="8";c.leftSide.element.dom.style.zIndex="10";c.rightSide.setZIndex(8);c.leftSide.setZIndex(10);c.leftSideMediaDiv.style.visibility="hidden";c.rightSideMediaDiv.style.visibility="hidden";var a=90;var b=0.3;$(c.leftSideGradient).css("background","-webkit-linear-gradient("+a+"deg,  rgba(0,0,0,"+b+") "+(((b*100)*0.9))+"%, rgba(76,76,76,0) 100%)");$(c.leftSideGradient).css("height","70px");$(c.leftSideGradient).css("width",$(c.leftSideDiv).width());$(c.gifBottomLeft).css("visibility","hidden");$(c.leftSideDiv).css("overflow","hidden");c.diffX=$(c.bottomLeft.element.dom).offset().left*-1+c.wrapAdOffset;c.diffY=$(c.topLeft.element.dom).offset().top;if(!Ext.browser.is.IE){if(c.element.dom.parentElement!=null&&settings.reader.wrapAd==null){c.element.dom.parentElement.parentElement.style.overflow="visible"}}c.addCls("disableIframe")},drag:function(A){var G=this;if(A!=null){if(A.stopPropagation!=null){A.stopPropagation()}}G.mouseDown=true;G.rightSide.element.dom.style.zIndex=10;G.leftSide.element.dom.style.zIndex=8;var l=$(G.element.dom).width();var k=0;var h=(((A.pageX-G.diffX-G.wrapAdOffset)+l)/2);var g=(((A.pageY-G.diffY)+k)/2);var t=Math.atan2(g-k,h-l);var z=t*114.6;var E=Math.sin(t);var D=Math.sin(t-(Math.PI/2));var f=h-E*g/D+G.diffX;var c=k;var s=l+G.diffX;var q=g+D*(l-h)/E;var x=t*(180/Math.PI)+180;if(f>$(G.element.dom).width()/2&&A.pageY>G.diffY&&A.pageX<$(G.element.dom).width()+G.diffX+G.wrapAdOffset){var w=true}else{if(A.pageY>G.diffY){var F=A.pageX-($(G.element.dom).width()/2)-G.wrapAdOffset;var C=A.pageY-G.diffY;var u=F*F+C*C;var j=Math.atan2(C,F);var r=($(G.element.dom).width()/2)+Math.cos(j)*G.rightSideWidth;var p=G.diffY+Math.sin(j)*G.width;var l=$(G.element.dom).width();var k=0;var h=(((r-G.diffX)+l)/2);var g=(((p-G.diffY)+k)/2);var t=Math.atan2(g-k,h-l);var z=t*114.6;var E=Math.sin(t);var D=Math.sin(t-(Math.PI/2));var f=h-E*g/D+G.diffX;var c=k;var s=l+G.diffX;var q=g+D*(l-h)/E;var x=t*(180/Math.PI)+180;var w=true}else{if(A.pageX>-G.diffX+G.wrapAdOffset){h=(((A.pageX-G.diffX-G.wrapAdOffset)+l)/2);g=((0+k)/2);t=Math.atan2(g-k,h-l);z=t*114.6;E=Math.sin(t);D=Math.sin(t-(Math.PI/2));f=h-E*g/D+G.diffX;c=k;s=l+G.diffX;q=g+D*(l-h)/E;x=t*(180/Math.PI)+180;var w=true}}}if(w){adj=(l)-(f-G.diffX);opp=q;hyp=(adj*adj)+(opp*opp);hyp=Math.sqrt(hyp);trigAngle=Math.acos(adj/hyp);trigAngle=trigAngle*(180/Math.PI);var v=G.returnOffset(f-(($(G.element.dom).width())/2),trigAngle);$(G.rightSideDiv).css("transform","translate3d("+v.x+"px, "+(v.y*-1)+"px, 0px) rotate("+trigAngle+"deg)");$(G.rightSideImageContainer).css("transform","rotate("+(trigAngle*-1)+"deg) translate3d("+(v.x*-1)+"px, "+(v.y)+"px, 0px) ");nextPageRotateAngle=((z)-trigAngle);nextPageCosAngle=(90-(nextPageRotateAngle-180));newExtraLength=Math.tan(nextPageCosAngle/(180/Math.PI))*v.y;$(G.rightSideNextPageContainer).css("transform","rotate("+nextPageRotateAngle+"deg) translate3d("+((adj+newExtraLength)*-1)+"px, "+(v.y)+"px, 0px)");$(G.rightSideGradient).css("transform","translate3d("+((adj+newExtraLength))+"px, "+(v.y*-1)+"px, 0px) rotate("+(nextPageRotateAngle*-1)+"deg) ");var n=s-f;var d=c-q;var m=d/n;var o=m*f*-1;if(q>G.height){var y=(-(G.height/2)-o)/m}else{var y=(-(q/2)-o)/m}var B=(((y)-($(G.element.dom).width()/2))/($(G.element.dom).width()/2))}if(G.rightSideNextPageContainer.style.visibility!="visible"){G.rightSideNextPageContainer.style.visibility="visible"}if(G.rightNextPage.style.visibility!="visible"){G.rightNextPage.style.visibility="visible"}if(G.rightSideGradient.style.visibility!="visible"){G.rightSideGradient.style.visibility="visible"}},dragLeft:function(A){var G=this;if(A!=null){if(A.stopPropagation!=null){A.stopPropagation()}}G.mouseDown=true;G.rightSide.element.dom.style.zIndex=8;G.leftSide.element.dom.style.zIndex=10;var l=0;var k=0;var h=((A.pageX+G.diffX-G.wrapAdOffset)+l)/2;var g=((A.pageY-G.diffY)+k)/2;var t=Math.atan2(g-k,h-l);var z=t*114.6;var E=Math.sin(t);var C=Math.sin(t-(Math.PI/2));var f=h+E*(k-g)/C-G.diffX;var c=k;var s=l-G.diffX;if(E!=0){var q=g+C*(l-h)/E}else{var q=0}if(f<$(G.element.dom).width()/2&&A.pageY>=G.diffY&&A.pageX>-G.diffX+G.wrapAdOffset){var w=true}else{if(A.pageY>=G.diffY){var F=A.pageX-($(G.element.dom).width()/2)-G.wrapAdOffset;var D=A.pageY-G.diffY;var u=F*F+D*D;var j=Math.atan2(D,F);var r=($(G.element.dom).width()/2)+Math.cos(j)*G.width;var p=G.diffY+Math.sin(j)*G.width;h=((r+G.diffX)+l)/2;g=((p-G.diffY)+k)/2;t=Math.atan2(g-k,h-l);z=t*114.6;E=Math.sin(t);C=Math.sin(t-(Math.PI/2));f=h+E*(k-g)/C-G.diffX;c=k;s=l-G.diffX;q=g+C*(l-h)/E;var w=true}else{if(A.pageX<$(G.element.dom).width()+G.diffX+G.wrapAdOffset){h=((A.pageX+G.diffX-G.wrapAdOffset)+l)/2;g=(0.1+k)/2;t=Math.atan2(g-k,h-l);z=t*114.6;E=Math.sin(t);C=Math.sin(t-(Math.PI/2));f=h+E*(k-g)/C-G.diffX;c=k;s=l-G.diffX;q=g+C*(l-h)/E;var w=true}}}if(w){adj=f+G.diffX;opp=q;hyp=(adj*adj)+(opp*opp);hyp=Math.sqrt(hyp);trigAngle=Math.acos(adj/hyp);trigAngle=trigAngle*(180/Math.PI);edge1XOffset=f-($(G.element.dom).width()/2);var v=G.returnOffset((edge1XOffset),trigAngle*-1);$(G.leftSideDiv).css("transform","translate3d("+(v.x)+"px, "+(v.y*-1)+"px, 0px) rotate("+(trigAngle*-1)+"deg)");$(G.leftSideImageContainer).css("transform","rotate("+(trigAngle)+"deg) translate3d("+(v.x*-1)+"px, "+(v.y)+"px, 0px) ");nextPageRotateAngle=((z)-(trigAngle*-1));nextPageCosAngle=(90-(nextPageRotateAngle-180));newExtraLength=Math.tan(nextPageCosAngle/(180/Math.PI))*(v.y*-1);$(G.leftSidePrevPageContainer).css("transform","rotate("+(nextPageRotateAngle)+"deg) translate3d("+((adj+newExtraLength))+"px, "+(v.y)+"px, 0px)");$(G.leftSideGradient).css("transform","translate3d("+((adj+newExtraLength)*-1)+"px, "+(v.y*-1)+"px, 0px) rotate("+(nextPageRotateAngle*-1)+"deg) ");var x=t*(180/Math.PI);var n=s-f;var d=c-q;var m=d/n;var o=m*f;if(q>G.height){var y=((G.height/2)-o)/m*-1}else{var y=((q/2)-o)/m*-1}var B=1-(((y))/($(G.element.dom).width()/2))}if(G.leftSidePrevPageContainer.style.visibility!="visible"){G.leftSidePrevPageContainer.style.visibility="visible"}if(G.leftPrevPage.style.visibility!="visible"){G.leftPrevPage.style.visibility="visible"}if(G.leftSideGradient.style.visibility!="visible"){G.leftSideGradient.style.visibility="visible"}},dragBottomRight:function(B){var H=this;H.mouseDown=true;H.rightSide.element.dom.style.zIndex=10;H.leftSide.element.dom.style.zIndex=8;var l=$(H.element.dom).width();var k=H.height;var h=((B.pageX-H.diffX-H.wrapAdOffset)+l)/2;var g=((B.pageY-H.diffY)+k)/2;var t=Math.atan2(g-k,h-l);var A=t*114.6;var F=Math.sin(t+(Math.PI/2));var D=Math.sin(t);var f=h-D*(k-g)/F+H.diffX;var c=k;var s=l+H.diffX;var q=g-F*(l-h)/D;if(f>$(H.element.dom).width()/2&&B.pageY<=H.height+H.diffY&&B.pageX<$(H.element.dom).width()+H.diffX+H.wrapAdOffset){var w=true}else{if(B.pageY<=H.height+H.diffY){var G=B.pageX-($(H.element.dom).width()/2)-H.wrapAdOffset;var E=B.pageY-(H.height+H.diffY);var u=G*G+E*E;var j=Math.atan2(E,G);var r=($(H.element.dom).width()/2)+Math.cos(j)*H.width;var p=(H.height+H.diffY)+Math.sin(j)*H.width;h=((r-H.diffX)+l)/2;g=((p-H.diffY)+k)/2;t=Math.atan2(g-k,h-l);A=t*114.6;F=Math.sin(t+(Math.PI/2));D=Math.sin(t);f=h-D*(k-g)/F+H.diffX;c=k;s=l+H.diffX;q=g-F*(l-h)/D;var w=true}else{if(B.pageX>-H.diffX+H.wrapAdOffset){h=((B.pageX-H.diffX-H.wrapAdOffset)+l)/2;g=((H.height-0.1)+k)/2;t=Math.atan2(g-k,h-l);A=t*114.6;F=Math.sin(t+(Math.PI/2));D=Math.sin(t);f=h-D*(k-g)/F+H.diffX;c=k;s=l+H.diffX;q=g-F*(l-h)/D;var w=true}}}if(w){adj=(l)-(f-H.diffX);opp=H.height-q;hyp=(adj*adj)+(opp*opp);hyp=Math.sqrt(hyp);trigAngle=Math.acos(adj/hyp);trigAngle=trigAngle*(180/Math.PI);edge1XOffset=f-($(H.element.dom).width()/2);var v=H.returnOffset((edge1XOffset),trigAngle*-1);$(H.rightSideDiv).css("transform","translate3d("+(v.x)+"px, "+((v.y*-1))+"px, 0px) rotate("+(trigAngle*-1)+"deg)");$(H.rightSideImageContainer).css("transform","rotate("+(trigAngle)+"deg) translate3d("+(v.x*-1)+"px, "+(v.y)+"px, 0px) ");nextPageRotateAngle=((A)-(trigAngle*-1));nextPageCosAngle=(90-(nextPageRotateAngle-180));newExtraLength=Math.tan(nextPageCosAngle/(180/Math.PI))*(v.y);$(H.rightSideNextPageContainer).css("transform","rotate("+nextPageRotateAngle+"deg) translate3d("+((adj+newExtraLength)*-1)+"px, "+(v.y)+"px, 0px)");$(H.rightSideGradient).css("transform","translate3d("+((adj+newExtraLength))+"px, "+(v.y*-1)+"px, 0px) rotate("+(nextPageRotateAngle*-1)+"deg) ");var x=t*(180/Math.PI)+180;var n=s-f;var d=c-q;var m=d/n;var o=(-H.height-(m*f))*-1;if(q<0){var y=((H.height/2)-o)/m*-1}else{var z=((H.height-q)/2)+q;var y=(z-o)/m*-1}var C=(((y)-($(H.element.dom).width()/2))/($(H.element.dom).width()/2))}if(H.rightSideNextPageContainer.style.visibility!="visible"){H.rightSideNextPageContainer.style.visibility="visible"}if(H.rightNextPage.style.visibility!="visible"){H.rightNextPage.style.visibility="visible"}if(H.rightSideGradient.style.visibility!="visible"){H.rightSideGradient.style.visibility="visible"}},dragBottomLeft:function(B){var H=this;H.mouseDown=true;H.rightSide.element.dom.style.zIndex=8;H.leftSide.element.dom.style.zIndex=10;var l=0;var k=H.height;var h=((B.pageX+H.diffX-H.wrapAdOffset)+l)/2;var g=((B.pageY-H.diffY)+k)/2;var t=Math.atan2(g-k,h-l);var A=t*114.6;var F=Math.sin(t);var D=Math.sin(t-(Math.PI/2));var f=h+F*(k-g)/D-H.diffX;var c=k;var s=l-H.diffX;var q=g+D*(l-h)/F;if(f<$(H.element.dom).width()/2&&B.pageY<=H.height+H.diffY&&B.pageX>-H.diffX+H.wrapAdOffset){var w=true}else{if(B.pageY<=H.height+H.diffY){var G=B.pageX-($(H.element.dom).width()/2)-H.wrapAdOffset;var E=B.pageY-(H.height+H.diffY);var u=G*G+E*E;var j=Math.atan2(E,G);var r=($(H.element.dom).width()/2)+Math.cos(j)*H.width;var p=(H.height+H.diffY)+Math.sin(j)*H.width;h=((r+H.diffX)+l)/2;g=((p-H.diffY)+k)/2;t=Math.atan2(g-k,h-l);A=t*114.6;F=Math.sin(t);D=Math.sin(t-(Math.PI/2));f=h+F*(k-g)/D-H.diffX;c=k;s=l-H.diffX;q=g+D*(l-h)/F;var w=true}else{if(B.pageX<$(H.element.dom).width()+H.diffX+H.wrapAdOffset){h=((B.pageX+H.diffX-H.wrapAdOffset)+l)/2;g=((H.height-0.1)+k)/2;t=Math.atan2(g-k,h-l);A=t*114.6;F=Math.sin(t);D=Math.sin(t-(Math.PI/2));f=h+F*(k-g)/D-H.diffX;c=k;s=l-H.diffX;q=g+D*(l-h)/F;var w=true}}}if(w){adj=f+H.diffX;opp=H.height-q;hyp=(adj*adj)+(opp*opp);hyp=Math.sqrt(hyp);trigAngle=Math.acos(adj/hyp);trigAngle=trigAngle*(180/Math.PI);edge1XOffset=f-($(H.element.dom).width()/2);var v=H.returnOffset((edge1XOffset),trigAngle);$(H.leftSideDiv).css("transform","translate3d("+(v.x)+"px, "+((v.y*-1))+"px, 0px) rotate("+(trigAngle)+"deg)");$(H.leftSideImageContainer).css("transform","rotate("+(trigAngle*-1)+"deg) translate3d("+(v.x*-1)+"px, "+(v.y)+"px, 0px) ");nextPageRotateAngle=((A)-(trigAngle));nextPageCosAngle=(90-(nextPageRotateAngle-180));newExtraLength=Math.tan(nextPageCosAngle/(180/Math.PI))*(v.y*-1);$(H.leftSidePrevPageContainer).css("transform","rotate("+(nextPageRotateAngle)+"deg) translate3d("+((adj+newExtraLength))+"px, "+(v.y)+"px, 0px)");$(H.leftSideGradient).css("transform","translate3d("+((adj+newExtraLength)*-1)+"px, "+(v.y*-1)+"px, 0px) rotate("+(nextPageRotateAngle*-1)+"deg) ");var x=t*(180/Math.PI);var n=s-f;var d=c-q;var m=d/n;var o=(-H.height-(m*f))*-1;if(q<0){var y=((H.height/2)-o)/m*-1}else{var z=((H.height-q)/2)+q;var y=(z-o)/m*-1}var C=1-(((y))/($(H.element.dom).width()/2))}if(H.leftSidePrevPageContainer.style.visibility!="visible"){H.leftSidePrevPageContainer.style.visibility="visible"}if(H.leftPrevPage.style.visibility!="visible"){H.leftPrevPage.style.visibility="visible"}if(H.leftSideGradient.style.visibility!="visible"){H.leftSideGradient.style.visibility="visible"}},endDrag:function(b){var a=this;if(b!=null){if(b.stopPropagation!=null){b.stopPropagation()}}a.removeCls("desktoppageviewer");a.topRight.element.dom.style.transform="";a.playCssAnimations();if(b.pageX>=($(a.element.dom).width()/2)+a.wrapAdOffset){a.fireEvent("returnPageRight",b,a)}else{a.fireEvent("finishTurnRight",b,a)}if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}a.removeCls("disableIframe")},endDragLeft:function(b){var a=this;if(b!=null){if(b.stopPropagation!=null){b.stopPropagation()}}a.removeCls("desktoppageviewer");a.topLeft.element.dom.style.transform="";a.playCssAnimations();if(b.pageX<=($(a.element.dom).width()/2)+a.wrapAdOffset){a.fireEvent("returnPageLeft",b,a)}else{a.fireEvent("finishTurnLeft",b,a)}if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}a.removeCls("disableIframe")},endDragBottomRight:function(b){var a=this;a.removeCls("desktoppageviewer");a.bottomRight.element.dom.style.transform="";a.playCssAnimations();if(b.pageX>=($(a.element.dom).width()/2)+a.wrapAdOffset){a.fireEvent("returnPageBottomRight",b,a)}else{a.fireEvent("finishTurnBottomRight",b,a)}if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}a.removeCls("disableIframe")},endDragBottomLeft:function(b){var a=this;a.removeCls("desktoppageviewer");a.bottomLeft.element.dom.style.transform="";a.playCssAnimations();if(b.pageX<=($(a.element.dom).width()/2)+a.wrapAdOffset){a.fireEvent("returnPageBottomLeft",b,a)}else{a.fireEvent("finishTurnBottomLeft",b,a)}if(!Ext.browser.is.IE){if(a.element.dom.parentElement!=null){a.element.dom.parentElement.parentElement.style.overflow="hidden"}}a.removeCls("disableIframe")},returnOffset:function(a,f){var d=this;var c=d.toRadians(f);var b=(Math.sin(c)*a);var e={x:(Math.sin(c)*b),y:(Math.cos(c)*b)};return e},toRadians:function(a){return a*(Math.PI/180)},pageResize:function(e){var f=this;if(!videoFull){if(f.isPageRendered){var c=$(f.rightSideImg).width();var d=$(f.rightSideImg).height();var j=c/d;if($(f.element.dom).height()*j<$(f.element.dom).width()/2){f.height=$(f.element.dom).height();f.width=f.height*j;$(f.rightSideDiv).css("bottom","");$(f.rightSideTileCanvas).css("height",f.height);$(f.rightSideTileCanvas).css("width",f.width);$(f.rightSideTileCanvas).attr("height",f.height);$(f.rightSideTileCanvas).attr("width",f.width);$(f.rightSideImg).css("height",f.height);$(f.rightSideImg).css("width",f.width);$(f.rightSideImageContainer).css("height",f.height);$(f.rightSideImageContainer).css("width",f.width);$(f.rightNextPage).css("height",f.height);$(f.rightNextPage).css("width",f.width);$(f.hiddenRightImg).css("height",f.height);$(f.hiddenRightImg).css("width",f.width);$(f.hiddenRightGradient).css("height",f.height);$(f.hiddenRightGradient).css("width",f.width);var b=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));b=Math.sqrt(b);$(f.rightSideDiv).css("height",b+"px");$(f.rightSideDiv).css("width",b+"px");f.top=0;f.initialTranslateY=f.top;$(f.rightSideDiv).css("top","");$(f.hiddenRightImg).css("top",f.top);$(f.topRight.element.dom).css("top",f.top+f.readerPaddingY);$(f.topRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("bottom",f.top);f.initialImageWidth=f.width;f.initialImageHeight=f.height}else{j=d/c;f.width=$(f.element.dom).width()/2;f.height=f.width*j;$(f.rightSideDiv).css("bottom","");$(f.rightSideTileCanvas).css("height",f.height);$(f.rightSideTileCanvas).css("width",f.width);$(f.rightSideTileCanvas).attr("height",f.height);$(f.rightSideTileCanvas).attr("width",f.width);$(f.rightSideImg).css("height",f.height);$(f.rightSideImg).css("width",f.width);$(f.rightSideImageContainer).css("height",f.height);$(f.rightSideImageContainer).css("width",f.width);$(f.rightNextPage).css("height",f.height);$(f.rightNextPage).css("width",f.width);$(f.hiddenRightImg).css("height",f.height);$(f.hiddenRightImg).css("width",f.width);$(f.hiddenRightGradient).css("height",f.height);$(f.hiddenRightGradient).css("width",f.width);var b=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));b=Math.sqrt(b);$(f.rightSideDiv).css("height",b+"px");$(f.rightSideDiv).css("width",b+"px");f.top=($(f.element.dom).height()-f.height)/2;f.initialTranslateY=f.top;$(f.topRight.element.dom).css("top",f.top+f.readerPaddingY);$(f.topRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("right",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomRight.element.dom).css("bottom",f.top);$(f.hiddenRightImg).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));f.initialImageWidth=f.width;f.initialImageHeight=f.height}var g=$(f.leftSideImg).attr("src");if(g==null){g=""}else{g=g.length}c=$(f.leftSideImg).width();d=$(f.leftSideImg).height();j=c/d;if($(f.element.dom).height()*j<$(f.element.dom).width()/2&&g>0){f.height=$(f.element.dom).height();f.width=f.height*j;$(f.leftSideDiv).css("bottom","");$(f.leftSideImg).css("height",f.height);$(f.leftSideImg).css("width",f.width);$(f.leftSideTileCanvas).css("height",f.height);$(f.leftSideTileCanvas).css("width",f.width);$(f.leftPrevPage).css("height",f.height+"px");$(f.leftPrevPage).css("width",(f.width)+"px");$(f.leftSideImg).css("transform-origin","100% 0% 0px");$(f.hiddenLeftImg).css("height",f.height);$(f.hiddenLeftImg).css("width",f.width);$(f.hiddenLeftGradient).css("height",f.height);$(f.hiddenLeftGradient).css("width",f.width);var b=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));b=Math.sqrt(b);$(f.leftSideDiv).css("height",b+"px");$(f.leftSideDiv).css("width",b+"px");f.top=0;f.initialTranslateY=f.top;$(f.leftSideDiv).css("top",f.top);$(f.hiddenLeftImg).css("top",f.top);$(f.topLeft.element.dom).css("top",f.top+f.readerPaddingY);$(f.topLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.hiddenLeftImg).css("left",0);$(f.bottomLeft.element.dom).css("bottom",f.top);f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height}else{if(g>0){j=d/c;f.width=$(f.element.dom).width()/2;f.height=f.width*j;$(f.leftSideDiv).css("bottom","");$(f.leftSideImg).css("height",f.height);$(f.leftSideImg).css("width",f.width);$(f.leftSideTileCanvas).css("height",f.height);$(f.leftSideTileCanvas).css("width",f.width);$(f.leftPrevPage).css("height",f.height);$(f.leftPrevPage).css("width",f.width);$(f.hiddenLeftImg).css("height",f.height);$(f.hiddenLeftImg).css("width",f.width);$(f.hiddenLeftGradient).css("height",f.height);$(f.hiddenLeftGradient).css("width",f.width);var b=(f.height*f.height)+(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2))*(f.width-($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));b=Math.sqrt(b);$(f.leftSideDiv).css("height",b+"px");$(f.leftSideDiv).css("width",b+"px");f.top=($(f.element.dom).height()-f.height)/2;$(f.topLeft.element.dom).css("top",f.top+f.readerPaddingY);$(f.topLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("left",($(f.element.dom).width())-f.width-($(f.element.dom).width()/2));$(f.bottomLeft.element.dom).css("bottom",f.top);f.top=0;$(f.leftSideDiv).css("top",f.top);$(f.hiddenLeftImg).css("top",f.top);$(f.hiddenLeftImg).css("left",0);f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height}}pixelMove=$(f.element.dom).width()*0.01;$(f.rightSideDiv).css("transform","");$(f.rightSideImageContainer).css("transform","");$(f.rightNextPage).css("transform","");$(f.rightNextPage).css("visibility","hidden");$(f.leftSideDiv).css("transform","");$(f.leftSideImageContainer).css("transform","");$(f.leftSideImageContainer).css("bottom","");$(f.rightSideImageContainer).css("bottom","");$(f.rightNextPage).css("bottom","");$(f.leftPrevPage).css("bottom","");$(f.leftPrevPage).css("transform","");$(f.leftPrevPage).css("visibility","hidden");if(f.rightSideImageContainer!=null){f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height}else{f.rightSideImageContainer=f.rightSide.element.down(".rightSideImgContainer").dom;f.rightSideImageContainer.initialImageWidth=f.width;f.rightSideImageContainer.initialImageHeight=f.height}if(f.leftSideImageContainer!=null){f.leftSideImageContainer.initialImageWidth=f.width;f.leftSideImageContainer.initialImageHeight=f.height}else{f.leftSideImageContainer=f.leftSide.element.down(".leftSideImgContainer").dom;f.leftSideImageContainer.initialImageWidth=f.width;f.leftSideImageContainer.initialImageHeight=f.height}f.initialTranslateX=(($(f.element.dom).width()/2)-f.width);f.setPageWidth();if(f.scale>1){f.resetPage();f.finishZoom(false);if(f.zoomMode=="fit"&&f.mode=="double"){f.showNavButtons()}else{f.hideNavButtons()}}f.fireEvent("activeItemCheck",f)}if(settings.leftSideAd!=null&&f.config.leftPage.type=="leftHandAd"&&f.config.leftPage.adType=="dfp"){f.resizeDfp()}f.fireEvent("resizeClipping");f.fireEvent("resizeArticlesBrowser")}},disableTiling:function(){var a=this;a.leftSideTileCanvas.width=0;a.leftSideTileCanvas.height=0;a.leftSideTileCanvas2.width=0;a.leftSideTileCanvas2.height=0;a.rightSideTileCanvas.width=0;a.rightSideTileCanvas.height=0;a.rightSideTileCanvas2.width=0;a.rightSideTileCanvas2.height=0},destroy:function(){var a=this;a.isinitialized=false;a.element.dom.innerHTML="";a.disableTiling();if(settings.leftSideAd!=null&&a.config.leftPage!=null&&a.config.leftPage.type=="leftHandAd"&&a.config.leftPage.adType=="dfp"){a.destroyDfpLeftHandAd()}delete a.leftSideTileCanvas;delete a.rightSideTileCanvas;delete a.scroller;delete a.scrollerDivContainer;delete a.scrollerDiv;delete a.zoomDivContainer;delete a.zoomDiv;delete a.tileDiv;delete a.rightNextPage;delete a.rightSideDiv;delete a.rightSideGradient;delete a.rightSideImageContainer;delete a.rightSideImg;delete a.rightSideMediaDiv;delete a.rightSideTileDiv;delete a.leftPrevPage;delete a.leftSideDiv;delete a.leftSideGradient;delete a.leftSideImageContainer;delete a.leftSideImg;delete a.leftSideMediaDiv;delete a.leftSideTileDiv;delete a.hiddenLeftGradient;delete a.hiddenLeftImg;delete a.hiddenRightGradient;delete a.hiddenRightImg;delete a.rightSide;delete a.leftSide;delete a.hiddenRight;delete a.hiddenLeft;delete a.topRight;delete a.topLeft;delete a.bottomRight;delete a.bottomLeft;delete a.previousPage;Ext.Panel.prototype.destroy.apply(this,arguments);delete a},hoverRight:function(){var a=this;a.rightSide.element.dom.style.zIndex="10";a.leftSide.element.dom.style.zIndex="8"},hoverLeft:function(){var a=this;a.rightSide.element.dom.style.zIndex="8";a.leftSide.element.dom.style.zIndex="10"},scrollEnd:function(){var a=this;if(a.scroller.position.y<=0){a.fireEvent("hideTop")}else{a.fireEvent("showTop")}if(a.scroller.position.y>=a.scroller.maxPosition.y){a.fireEvent("hideBottom")}else{a.fireEvent("showBottom")}Ext.Viewport.removeCls("scrolling-page")},onPinchStart:function(d){var c=this;c.disableTiling();c.startDistance=d.distance;var f=((d.touches[0].pageX+d.touches[1].pageX)/2);var e=((d.touches[0].pageY+d.touches[1].pageY)/2);var b=f+c.scroller.position.x;var a=e+c.scroller.position.y;c.zoomPointX=((b)/(c.scale));c.zoomPointY=((a)/(c.scale));c.offsetX=(f-c.zoomPointX);c.offsetY=(e-c.zoomPointY);c.offsetScrollerX=c.offsetX+c.scroller.position.x;c.offsetScrollerY=c.offsetY+c.scroller.position.y;c.initializeTouch(c.zoomPointX,c.zoomPointY);c.translateX+=c.offsetScrollerX;c.translateY+=c.offsetScrollerY;c.applyTransform(c.scale)},onPinch:function(b){var a=this;if(a.dontPinch==true){return}a.currentScale=Math.min(((b.distance/a.startDistance)*a.scale),a.getMaxScale());a.applyTransform(a.currentScale);$("#slider").val(a.currentScale)},onPinchEnd:function(b){var a=this;$("#slider").val(a.currentScale);if(a.currentScale<=1){a.resetPage();a.finishZoom(true);a.showNavButtons()}else{a.scale=a.currentScale;a.finishZoom(true);a.hideNavButtons()}},pauseFlashingLinks:function(){var b=this;for(var a=0;a<b.leftSideMediaDiv.children.length;a++){$(b.leftSideMediaDiv.children[a]).css("animation-play-state","paused")}for(var a=0;a<b.rightSideMediaDiv.children.length;a++){$(b.rightSideMediaDiv.children[a]).css("animation-play-state","paused")}},playCssAnimations:function(){var b=this;if(b.leftSideMediaDiv!=null){for(var a=0;a<b.leftSideMediaDiv.children.length;a++){$(b.leftSideMediaDiv.children[a]).css("animation-play-state","running")}}if(b.rightSideMediaDiv!=null){for(var a=0;a<b.rightSideMediaDiv.children.length;a++){$(b.rightSideMediaDiv.children[a]).css("animation-play-state","running")}}},pauseVideos:function(){var e=this;if(e.rightSideMediaDiv!=null){for(var b=0;b<e.rightSideMediaDiv.children.length;b++){if(e.rightSideMediaDiv.children[b].className.indexOf("readerVideo")!=-1){var d=e.rightSideMediaDiv.children[b];$(e.element.dom).removeClass("disableIframe");if(d.className.indexOf("mp4Video")!=-1){var c=d.getElementsByTagName("iframe")[0];c.contentDocument.getElementsByTagName("video")[0].pause()}else{if(d.className.indexOf("youtubeVideo")!=-1){var c=d.getElementsByTagName("iframe")[0];if(YT.get(c.id)!=null){YT.get(c.id).pauseVideo()}}else{if(d.className.indexOf("vimeoVideo")!=-1){var c=d.getElementsByClassName("vimeoPlayer")[0];c.contentWindow.postMessage({method:"pause",value:""},"*")}}}}}}if(e.leftSideMediaDiv!=null){for(var b=0;b<e.leftSideMediaDiv.children.length;b++){if(e.leftSideMediaDiv.children[b].className.indexOf("readerVideo")!=-1){var d=e.leftSideMediaDiv.children[b];$(e.element.dom).removeClass("disableIframe");if(d.className.indexOf("mp4Video")!=-1){var c=d.getElementsByTagName("iframe")[0];c.contentDocument.getElementsByTagName("video")[0].pause()}else{if(d.className.indexOf("youtubeVideo")!=-1){var c=d.getElementsByTagName("iframe")[0];if(YT.get(c.id)!=null){YT.get(c.id).pauseVideo()}}else{if(d.className.indexOf("vimeoVideo")!=-1){var c=d.getElementsByClassName("vimeoPlayer")[0];c.contentWindow.postMessage({method:"pause",value:""},"*")}}}}}}if(!e.overflowMediaDiv.isHidden()){if(e.overflowMediaDiv.element!=null){var a=e.overflowMediaDiv.element.dom.getElementsByClassName("mp4Video");for(var b=0;b<a.length;b++){var c=a[b].getElementsByTagName("iframe")[0];c.contentDocument.getElementsByTagName("video")[0].pause()}var g=e.overflowMediaDiv.element.dom.getElementsByClassName("youtubeVideo");for(var b=0;b<g.length;b++){var c=g[b].getElementsByTagName("iframe")[0];YT.get(c.id).pauseVideo()}var f=e.overflowMediaDiv.element.dom.getElementsByClassName("vimeoVideo");for(var b=0;b<f.length;b++){var c=f[b].getElementsByClassName("vimeoPlayer")[0];c.contentWindow.postMessage({method:"pause",value:""},"*")}}}},onScrollStart:function(){var a=this;Ext.Viewport.addCls("scrolling-page")},onTouchEnd:function(){Ext.Viewport.removeCls("scrolling-page")},setupSectionTap:function(g,d){var k=this;var c=10;var a=5;var j=250;var h=false;var n;var l;var b;var f=null;var e=function(o){if(f!=null){clearTimeout(f);f=null;h=false}else{h=true}if(o.pageX!=null&&o.pageY!=null){n=o.pageX;l=o.pageY}else{if(o.changedTouches!=null&&o.changedTouches.length>0){var p=o.changedTouches[0];n=p.pageX;l=p.pageY}}b=o.timeStamp};var m=function(s){if(s.pageX!=null&&s.pageY!=null){var q=s.pageX;var p=s.pageY}else{if(s.changedTouches!=null&&s.changedTouches.length>0){var u=s.changedTouches[0];var q=u.pageX;var p=u.pageY}}var r=Math.sqrt((Math.pow(n-q,2))+(Math.pow(l-p,2)));var o=s.timeStamp;var t=o-b;if(r<=a&&t>=c){f=setTimeout(function(){if(h){d()}clearTimeout(f);f=null},j)}};g.onmousedown=e;g.addEventListener("touchstart",e);g.onmouseup=m;g.addEventListener("touchend",m)}},0,["readerpageviewer"],["component","container","panel","readerpageviewer"],{component:true,container:true,panel:true,readerpageviewer:true},["widget.readerpageviewer"],0,[InfinityMobile.view.desktop,"DesktopPageViewer"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutView",Ext.Container,{config:{ignorePosition:false,cls:"toolbar"},initialize:function(){var a=this;a.json=a.config.json;a.parentContainer=a.config.parentContainer;a.layoutViewStyle();a.checkDPS();var b=Ext.create("Ext.Container",{itemId:"tooltip",style:"position:absolute !important;"});a.add(b);if(a.json.events.onTouch!=null&&Ext.os.is.Desktop){a.element.dom.style.cursor="pointer";switch(a.json.events.onTouch[0].action){case"openReaderMenu":b.setHtml('<div style="position:absolute;" class="tooltip">Menu</div>');a.tooltipLeft(15);break;case"search":b.setHtml('<div style="position:absolute;" class="tooltip">Search</div>');a.tooltipRight();break;case"right":b.setHtml('<div style="position:absolute;" class="tooltip">Next Page</div>');a.tooltipRight();break;case"left":b.setHtml('<div style="position:absolute;" class="tooltip">Previous Page</div>');a.tooltipRight();break;case"dps mode off":b.setHtml('<div style="position:absolute;" class="tooltip">Single Page</div>');a.tooltipRight("dps");break;case"dps mode on":b.setHtml('<div style="position:absolute;" class="tooltip">Double Page</div>');a.tooltipRight("dps");break;case"FirstPage":b.setHtml('<div style="position:absolute;" class="tooltip">First Page</div>');a.tooltipRight();break;case"LastPage":b.setHtml('<div style="position:absolute;" class="tooltip">Last Page</div>');a.tooltipRight();break}}if(Ext.os.is.Desktop&&a.json.globalID=="ZoomBar"){a.innerElement.dom.style.cursor="pointer"}},tooltipRight:function(b){var a=this;a.element.dom.onmousemove=(function(c){if(b=="dps"){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-35)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-35)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-35)+"px, 0) scale3d("+1+","+1+",1)"}else{a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(c.offsetX+15)+"px, "+(c.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"}})},tooltipLeft:function(a){var b=this;b.element.dom.onmousemove=(function(c){b.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(c.offsetX-50)+"px, "+(c.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";b.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(c.offsetX-50)+"px, "+(c.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";b.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(c.offsetX-50)+"px, "+(c.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},layoutViewStyle:function(d){var c=this;var a="";if(c.json.portraitOnly!=null){a="#"+c.id+" { ";a+=c.layoutViewStyleOrientation(c.json,"portrait");a+="}"}else{a="@media screen and (orientation: portrait) { ";a+="#"+c.id+" { ";a+=c.layoutViewStyleOrientation(c.json,"portrait");a+="}";a+="}";a+="@media screen and (orientation: landscape) { ";a+="#"+c.id+" { ";a+=c.layoutViewStyleOrientation(c.json,"landscape");a+="}";a+="}"}var b=document.createElement("style");if(b.styleSheet){b.styleSheet.cssText=a}else{b.appendChild(document.createTextNode(a))}document.body.appendChild(b)},layoutViewStyleOrientation:function(m,d,a){var k=this;var m=k.json;var c=true;var l="";if(d=="portrait"){if(m.showOnPortrait==false){l+="display: none;";c=false}}if(d=="landscape"){if(m.showOnLandscape==false){l+="display:none;";c=false}}if(c){l+=k.layoutViewPosition(m,d);var e=m.position[d];var b=k.getState(m,"backgroundColor",d,a);var h=k.getState(m,"opacity",d,a);var g=k.getState(m,"objectOpacity",d,a);var f="0px";if(k.getState(m,"cornerRadius",d,a)!=null){f=k.getState(m,"cornerRadius",a)+"px"}var j=k.getState(m,"justification",d);l+="background-color: rgba("+hexToRgb(b)+", "+h+");";l+="opacity: "+g+";";l+="border-radius: "+f+";";l+="border-left: "+k.addBorder(m,d,"left")+";";l+="border-right: "+k.addBorder(m,d,"right")+";";l+="border-top: "+k.addBorder(m,d,"top")+";";l+="border-bottom: "+k.addBorder(m,d,"bottom")+";";l+="text-align: "+j+";";l+="z-index: 1;"}return l},layoutViewPosition:function(q,d){var u=this;var k=q.anchors[d];var v=q.position[d];var l="";var s=v.x;var r=v.y;var e=v.width;var c=v.height;var f=768;var b=1024;var j=u.json;if(u.parentContainer!=null){j=u.parentContainer.json}f=j.position[d].width;b=j.position[d].height;var n=window.innerWidth;var h=window.innerHeight;l+="position: absolute;";if(k.anchorLeft||k.anchorRight||k.anchorWidth){if(!k.anchorLeft&&!k.anchorRight&&!k.anchorWidth){var a=s/f*100;l+="left: "+a+"%;";l+="width: "+e+"px;"}else{if(!k.anchorLeft&&!k.anchorRight&&k.anchorWidth){var a=s/f*100;var o=e/f*100;l+="left: "+a+"%;";l+="width: "+o+"%;"}else{if(!k.anchorLeft&&k.anchorRight&&!k.anchorWidth){var t=s+e;l+="right: "+(f-t)+"px;";l+="width: "+e+"px;"}else{if(!k.anchorLeft&&k.anchorRight&&k.anchorWidth){var t=s+e;var o=e/f*100;l+="right: "+(f-t)+"px;";l+="width: "+o+"%;"}else{if(k.anchorLeft&&!k.anchorRight&&!k.anchorWidth){l+="left: "+s+"px;";l+="width: "+e+"px;"}else{if(k.anchorLeft&&!k.anchorRight&&k.anchorWidth){var o=e/f*100;l+="left: "+s+"px;";l+="width: "+o+"%;"}else{if(k.anchorLeft&&k.anchorRight){l+="left:"+s+"px;";var t=s+e;l+="width:calc(100% - "+s+"px - "+(f-t)+"px);"}}}}}}}}if(k.anchorTop||k.anchorBottom||k.anchorHeight){if(!k.anchorTop&&!k.anchorBottom&&!k.anchorHeight){var g=r/b*100;l+="top: "+g+"%;";l+="height: "+c+"px;"}else{if(!k.anchorTop&&!k.anchorBottom&&k.anchorHeight){var g=r/b*100;var m=c/b*100;l+="top: "+g+"%;";l+="height: "+m+"%;"}else{if(!k.anchorTop&&k.anchorBottom&&!k.anchorHeight){var p=r+e;l+="top: "+(b-p)+"px;";l+="height: "+c+"px;"}else{if(!k.anchorTop&&k.anchorBottom&&k.anchorHeight){var p=r+e;var m=c/b*100;l+="top: "+(b-p)+"px;";l+="height: "+m+"%;"}else{if(k.anchorTop&&!k.anchorBottom&&!k.anchorHeight){l+="top:"+r+"px;";l+="height:"+c+"px;"}else{if(k.anchorTop&&!k.anchorBottom&&k.anchorHeight){var m=c/b*100;l+="top:"+r+"px;";l+="height:"+m+"%;"}else{if(k.anchorTop&&k.anchorBottom){l+="top:"+r+"px;";var p=r+c;l+="height:calc(100% - "+r+"px - "+(b-p)+"px);"}}}}}}}}return l},addBorder:function(c,b,a){return c.borders[b][a].width+" "+c.borders[b][a].type+" "+c.borders[b][a].color},getState:function(c,d,a,b){if(b==null){b="default"}if(c.states.length==1){return c.states[0].bindings[d]}else{var e=null;$.each(c.states,function(f,g){if(g.name==b){if(e==null){e=g}if(g.orientation.landscape==true&&a=="landscape"){e=g}if(g.orientation.portrait==true&&a=="portrait"){e=g}}});if(e.bindings[d]==undefined){return c.states[0].bindings[d]}else{return e.bindings[d]}}},updateState:function(c){var b=this;var d=b.items.items[0];var a=b.getState(b.json,"url","landscape",c);d.setSrc(a)},checkDPS:function(){var b=this;if(b.json.globalID=="SinglePageToggle"||b.json.globalID=="DoublePageToggle"){var a=settings.reader;if(a.toggleDPS=="true"||a.toggleDPS=="True"){if(a.defaultPageMode=="double"){b.updateState("selected")}}}}},0,["layoutview"],["component","container","layoutview"],{component:true,container:true,layoutview:true},["widget.layoutview"],0,[InfinityMobile.view,"LayoutView"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.LayoutToolBarIconView",InfinityMobile.view.LayoutView,{config:{width:30,height:40,style:"background-size: contain; background-repeat: no-repeat; background-position: center; cursor:pointer",items:[{itemId:"tooltip",cls:"tooltiptoolbar",style:"z-index:10000"}]},initialize:function(){var a=this;if(a.config.setting!=null){a.setting=a.config.setting;a.iconUrl=a.config.iconUrl;a.loadIcon()}else{if(a.config.iconUrl!=null){a.iconUrl=a.config.iconUrl;a.loadIcon()}}if(a.config.event!=null){a.event=a.config.event;a.setupEvent()}a.tooltip=a.getComponent("tooltip");a.tooltip.hide();a.element.dom.onmouseover=function(){if(a.tooltip.isHidden()){}};a.element.dom.onmouseout=function(){if(!a.tooltip.isHidden()){}}},loadTooltip:function(){var a=this;console.log(settings);if(a.setting=="fullscreenicon"){a.tooltip.setHtml("Fullscreen");a.tooltipRight()}else{if(a.setting=="fitpageicon"){a.tooltip.setHtml("Page Fit");a.tooltipRight()}else{if(a.setting=="fillpageicon"){a.tooltip.setHtml("Page Fill");a.tooltipRight()}else{if(a.setting=="singlepageicon"){a.tooltip.setHtml("Single Page");a.tooltipRight()}else{if(a.setting=="doublepageicon"){a.tooltip.setHtml("Double Page");a.tooltipRight()}else{if(a.setting=="firsticon"){a.tooltip.setHtml("First Page");a.tooltipRight()}else{if(a.setting=="previousicon"){a.tooltip.setHtml("Previous Page");a.tooltipRight()}else{if(a.setting=="nexticon"){a.tooltip.setHtml("Next Page");a.tooltipRight()}else{if(a.setting=="lasticon"){a.tooltip.setHtml("Last Page");a.tooltipRight()}else{if(a.setting=="menuicon"){a.tooltip.setHtml("Menu");a.tooltipLeft()}else{if(a.setting=="searchicon"){a.tooltip.setHtml("Search");a.tooltipRight()}else{if(a.setting=="shareicon"){a.tooltip.setHtml("Share");a.tooltipRight()}else{if(a.setting=="archiveicon"){if(settings.menu.archiveText==null){a.tooltip.setHtml("Archive")}else{a.tooltip.setHtml(settings.menu.archiveText)}a.tooltipRight()}else{if(a.setting=="downloadicon"){if(settings.menu.downloadText==null){a.tooltip.setHtml("Download")}else{a.tooltip.setHtml(settings.menu.downloadText)}a.tooltipRight()}else{if(a.setting=="bookmarksicon"){if(settings.menu.bookmarkText==null){a.tooltip.setHtml("Bookmarks")}else{a.tooltip.setHtml(settings.menu.bookmarkText)}a.tooltipRight()}else{if(a.setting=="printicon"){if(settings.menu.printText==null){a.tooltip.setHtml("Print")}else{a.tooltip.setHtml(settings.menu.printText)}a.tooltipRight()}else{if(a.setting=="clippingicon"){if(settings.menu.clippingText==null){a.tooltip.setHtml("Create Clipping")}else{a.tooltip.setHtml(settings.menu.clippingText)}a.tooltipRight()}else{if(a.setting=="infoicon"){if(settings.menu.howToUseText==null){a.tooltip.setHtml("How To Use")}else{a.tooltip.setHtml(settings.menu.howToUseText)}a.tooltipRight()}else{a.tooltip.hide();a.setWidth("100%");console.log("-------------------- LOGO -------------------")}}}}}}}}}}}}}}}}}}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},tooltipLeft:function(){var a=this;a.element.dom.onmousemove=(function(b){if(b.target.className.indexOf("tooltiptoolbar")==-1){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX-50)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX-50)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX-50)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"}})},loadIcon:function(){var b=this;var a="";if(b.iconUrl!=null){a=b.iconUrl}else{a=settings.topbar[b.setting]}if(b.setting=="archiveicon"){if(settings.newsday!=null){if(settings.newsday.archiveIcon!=null){if(settings.newsday.archiveIcon.length>0){a=settings.newsday.archiveIcon}}}}if(b.setting=="sectionlisticon"){if(settings.newsday!=null){if(settings.newsday.sectionsIcon!=null){if(settings.newsday.sectionsIcon.length>0){a=settings.newsday.sectionsIcon;b.setWidth(70)}}}}if(b.setting=="zonesicon"){if(settings.newsday!=null){if(settings.newsday.zonesIcon!=null){if(settings.newsday.zonesIcon.length>0){a=settings.newsday.zonesIcon;b.setWidth(50)}}}}if(b.setting=="firsticon"){if(settings.newsday!=null){if(settings.newsday.firstPageIcon!=null){if(settings.newsday.firstPageIcon.length>0){a=settings.newsday.firstPageIcon}}}}if(b.setting=="previousicon"){if(settings.newsday!=null){if(settings.newsday.prevPageIcon!=null){if(settings.newsday.prevPageIcon.length>0){a=settings.newsday.prevPageIcon}}}}if(b.setting=="nexticon"){if(settings.newsday!=null){if(settings.newsday.nextPageIcon!=null){if(settings.newsday.nextPageIcon.length>0){a=settings.newsday.nextPageIcon}}}}if(b.setting=="lasticon"){if(settings.newsday!=null){if(settings.newsday.lastPageIcon!=null){if(settings.newsday.lastPageIcon.length>0){a=settings.newsday.lastPageIcon}}}}if(a!=""){b.setStyle({backgroundImage:"url("+a+")"})}},setupEvent:function(){var a=this;if(a.event!="toolbarShare"){a.element.on("tap",function(){if(typeof trackReaderEvent!="undefined"){}mainPanel.fireEvent(a.event,a)})}}},0,["layouttoolbaricon"],["component","container","layoutview","layouttoolbaricon"],{component:true,container:true,layoutview:true,layouttoolbaricon:true},["widget.layouttoolbaricon"],0,[InfinityMobile.view.desktop,"LayoutToolBarIconView"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderZoomSlider",Ext.Container,{config:{style:"color:white;display:inline-block;max-width: 90px;",items:[{itemId:"sliderContainer",layout:"hbox",width:"100%",height:"100%",items:[{itemId:"zoomOut",cls:"zoomBtn",width:20,height:24,left:0,style:"background-image:url(../assets/zoomSlider/decrease-ic.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"zoomSlider",flex:4},{itemId:"zoomIn",cls:"zoomBtn",width:20,height:24,right:0,style:"background-image:url(../assets/zoomSlider/increase-ic.png);background-size:contain;background-position:center;background-repeat:no-repeat;"}]},{itemId:"tooltipZoomIn",cls:"tooltip",hidden:true,style:"z-index:10000"},{itemId:"tooltipZoomOut",cls:"tooltip",hidden:true,style:"z-index:10000"}]},initialize:function(){var c=this;if(c.config.json!=null){Ext.Container.prototype.initialize.apply(this,arguments)}var a=InfinityMobile.app.getController("LayoutController");var b=Ext.getStore("SettingStore");var e="2px";var d="0px";c.sliderContainer=c.getComponent("sliderContainer");c.slider=c.sliderContainer.getComponent("zoomSlider");c.zoomOutBtn=c.sliderContainer.getComponent("zoomOut");c.zoomInBtn=c.sliderContainer.getComponent("zoomIn");c.slider.setHtml('<div style:"text-align:center;color:white;"><input id="slider" type="range" min="1" max="'+settings.page.maxZoomLevel+'" step="0.01" style="background:none;cursor:pointer;z-index:5;position:absolute;left:17.5%;top:'+e+";margin-top:"+d+';width:65%;" value="1"/></div>');c.firstTap=false;c.sliderElement=c.element.down("input");if(Ext.browser.name!="IE"){$(c.sliderElement.dom).mouseup(function(){if(!c.firstTap){c.firstTap=true;c.zooming()}c.zooming();c.zoomEnd()});c.sliderElement.dom.addEventListener("touchend",function(){if(!c.firstTap){c.firstTap=true;c.zooming()}c.zooming();c.zoomEnd()});c.sliderElement.dom.oninput=function(){c.zooming()}}else{$(c.sliderElement.dom).mouseup(function(){if(!c.firstTap){c.firstTap=true;c.zooming()}c.zooming();c.zoomEnd()});c.sliderElement.dom.addEventListener("touchend",function(){if(!c.firstTap){c.firstTap=true;c.zooming()}c.zooming();c.zoomEnd()});c.sliderElement.dom.onchange=function(){c.zooming()}}c.startedZoom=false;clear=function(){clearInterval(c.timer)};zoom=function(){if(c.sliderElement.dom.value<c.sliderElement.dom.max){c.sliderElement.dom.stepUp();c.sliderElement.dom.stepUp();c.sliderElement.dom.stepUp();c.zoom()}};zoomHold=function(f){if(c.sliderElement.dom.value<c.sliderElement.dom.max){c.timer=setInterval(zoom,10);if(f!=null){f.stopPropagation();f.preventDefault();window.oncontextmenu=function(){return false}}}};zoomOutHold=function(f){if(c.sliderElement.dom.value>1){c.timer=setInterval(zoomOut,10);if(f!=null){f.stopPropagation();f.preventDefault();window.oncontextmenu=function(){return false}}}};zoomStopHold=function(){clearInterval(c.timer);c.zoomEnd();window.oncontextmenu=function(){return true}};zoomOut=function(){if(c.sliderElement.dom.value>1){c.sliderElement.dom.stepDown();c.sliderElement.dom.stepDown();c.sliderElement.dom.stepDown();c.zoom()}};c.zoomInBtn.canTap=true;c.zoomInBtn.element.on({tap:function(){if(c.zoomInBtn.canTap){c.zoomInBtn.canTap=false;var f=(parseFloat(c.sliderElement.dom.max)-1)/4;if(parseFloat(c.sliderElement.dom.max)>f){if(parseFloat(c.sliderElement.dom.value)+parseFloat(f)<=parseFloat(c.sliderElement.dom.max)){c.sliderElement.dom.value=parseFloat(c.sliderElement.dom.value)+parseFloat(f);c.zoom()}else{c.sliderElement.dom.value=parseFloat(c.sliderElement.dom.max-0.01);c.zoom()}c.zoomEnd()}setTimeout(function(){c.zoomInBtn.canTap=true},300)}}});c.zoomOutBtn.canTap=true;c.zoomOutBtn.element.on({tap:function(){if(c.zoomOutBtn.canTap){c.zoomOutBtn.canTap=false;var f=((parseFloat(c.sliderElement.dom.max)-1)/4);if(parseFloat(c.sliderElement.dom.value)>1){if(parseFloat(c.sliderElement.dom.value)-f>=1){c.sliderElement.dom.value=parseFloat(c.sliderElement.dom.value)-parseFloat(f);c.zoom()}else{c.sliderElement.dom.value=1;c.zoom()}c.zoomEnd()}setTimeout(function(){c.zoomOutBtn.canTap=true},300)}}});Ext.Viewport.on({resize:c.onResize,scope:c})},onResize:function(){var a=this;if($("#slider").width()>$(a.element.dom).width()-30){a.zoomInBtn.setWidth(10);a.zoomOutBtn.setWidth(10)}else{if($("#slider").width()>$(a.element.dom).width()-40){a.zoomInBtn.setWidth(14);a.zoomOutBtn.setWidth(14)}else{if($(a.element.dom).width()*0.65<=$(a.element.dom).width()-40){$("#slider").show();a.zoomInBtn.setWidth(20);a.zoomOutBtn.setWidth(20)}}}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.tooltipZoomIn.element.dom.style.webkitTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomIn.element.dom.style.MozTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomIn.element.dom.style.msTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},zoom:function(){var a=this;a.fireEvent("zoomStart",a,a.sliderElement.dom.value);a.startedZoom=true;a.fireEvent("zoom",a,a.sliderElement)},zooming:function(){var a=this;if(!a.startedZoom){a.fireEvent("zoomStart",a,a.sliderElement.dom.value);a.startedZoom=true}else{a.fireEvent("zoom",a,a.sliderElement)}},zoomEnd:function(){var a=this;if(a.sliderElement.dom.value==1){a.fireEvent("zoomEnd",a,a.sliderElement)}else{a.fireEvent("zoomEnd",a,a.sliderElement)}a.startedZoom=false}},0,["zoomSlider"],["component","container","zoomSlider"],{component:true,container:true,zoomSlider:true},["widget.zoomSlider"],0,[InfinityMobile.view,"ReaderZoomSlider"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.LayoutToolBarToggleIconView",InfinityMobile.view.desktop.LayoutToolBarIconView,{config:{},initialize:function(){var a=this;if(a.config.toggleGroup!=null){a.toggleGroup=a.config.toggleGroup;a.fireEvent("addToggleGroup",a,a.toggleGroup)}a.currentState="";if(a.config.selectedSetting!=null){a.selectedSetting=a.config.selectedSetting}else{if(a.config.iconSelectedUrl){a.iconSelectedUrl=a.config.iconSelectedUrl}}InfinityMobile.view.desktop.LayoutToolBarIconView.prototype.initialize.call(this)},setupEvent:function(){var a=this;a.element.on("tap",function(){a.toggleState();mainPanel.fireEvent(a.event,a)})},toggleState:function(){var a=this;if(a.toggleGroup!=null){a.fireEvent("toggleGroupState",a,a.toggleGroup)}},updateState:function(b){var a=this;if(b!=a.currentState){a.currentState=b;switch(a.currentState){case"selected":a.loadSelectedIcon();break;case"":default:a.loadIcon();break}}},loadSelectedIcon:function(){var b=this;var a="";if(b.iconSelectedUrl!=null){a=b.iconSelectedUrl}else{a=settings.topbar[b.selectedSetting]}if(a!=""){b.setStyle({backgroundImage:"url("+a+")"})}}},0,["layouttoolbartoggleicon"],["component","container","layoutview","layouttoolbaricon","layouttoolbartoggleicon"],{component:true,container:true,layoutview:true,layouttoolbaricon:true,layouttoolbartoggleicon:true},["widget.layouttoolbartoggleicon"],0,[InfinityMobile.view.desktop,"LayoutToolBarToggleIconView"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.LayoutToolBarView",InfinityMobile.view.LayoutView,{config:{padding:8,layout:{type:"hbox"},items:[{itemId:"tooltiptool",cls:"tooltiptoolbar",style:"z-index:10000"},{flex:1,itemId:"viewOptions",layout:"hbox",style:"overflow:hidden;",defaults:{margin:"0 10px 0 0"},items:[{id:"toolbarIcon",cls:"toolbarIcon",defaults:{width:"100%",height:"100%",left:0,top:0},items:[{cls:"toolbarIconLarge",itemId:"toolbarIconLarge",style:"background-position: left center; background-size: contain; background-repeat: no-repeat;"},{cls:"toolbarIconSmall",itemId:"toolbarIconSmall",style:"background-position: left center; background-size: contain; background-repeat: no-repeat;"}]},{itemId:"toolbarReaderViewModes",width:0,style:"background-color:green"},{itemId:"fullscreenIcon",xtype:"layouttoolbaricon",setting:"fullscreenicon",event:"fullscreenMode",height:24},{cls:"toolbarZoomBar",itemId:"toolbarZoomBar",xtype:"zoomSlider",height:24},{itemId:"zoomFit",xtype:"layouttoolbartoggleicon",toggleGroup:"zoom",setting:"fitpageicon",selectedSetting:"fitpageselectedicon",event:"zoomModeFit",height:24},{itemId:"zoomFill",xtype:"layouttoolbartoggleicon",toggleGroup:"zoom",setting:"fillpageicon",selectedSetting:"fillpageselectedicon",event:"zoomModeFill",height:24},{itemId:"dpsSingle",xtype:"layouttoolbartoggleicon",toggleGroup:"dps",setting:"singlepageicon",selectedSetting:"singlepageselectedicon",event:"dpsModeOff",height:24},{itemId:"dpsDouble",xtype:"layouttoolbartoggleicon",toggleGroup:"dps",setting:"doublepageicon",selectedSetting:"doublepageselectedicon",event:"dpsModeOn",height:24}]},{width:275,style:"border-left: 1px solid #e1e1e1; border-right: 1px solid #e1e1e1; margin-top:-8px; margin-bottom:-8px",layout:"hbox",padding:"0 10px 0 10px",itemId:"readerPageControlContainer",items:[{itemId:"firstPageIcon",xtype:"layouttoolbaricon",setting:"firsticon",event:"readerFirst"},{itemId:"previousPageIcon",xtype:"layouttoolbaricon",setting:"previousicon",event:"readerLeft"},{flex:1,padding:"12px 0 0 0",style:"text-align:center; font-size:16px; cursor:pointer",html:"32 / 64",id:"1ab7241b-dac9-0eb5-d6f8-14ea7114913c",itemId:"readerPageNumberContainer"},{itemId:"nextPageIcon",xtype:"layouttoolbaricon",setting:"nexticon",event:"readerRight"},{itemId:"lastPageIcon",xtype:"layouttoolbaricon",setting:"lasticon",event:"readerLast"}]},{itemId:"iconsContainer",cls:"toolbarRightContainer",flex:1,style:"overflow:hidden",defaults:{margin:"0 10px 0 10px",style:"float:right; background-size: contain; background-repeat: no-repeat; background-position: center; cursor:pointer;",height:24},items:[{xtype:"layouttoolbaricon",setting:"menuicon",event:"openReaderMenu",itemId:"menuicon"},{xtype:"layouttoolbaricon",setting:"zonesicon",event:"toolbarZones",itemId:"menuZones",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"sectionlisticon",event:"toolbarSectionList",itemId:"menuSectionList",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"searchicon",event:"toolbarSearch",itemId:"menuSearch"},{xtype:"layouttoolbaricon",setting:"shareicon",event:"toolbarShare",itemId:"menuShare",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"archiveicon",event:"toolbarArchive",itemId:"menuArchive",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"downloadicon",event:"toolbarDownload",itemId:"menuDownload",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"bookmarksicon",event:"toolbarBookmarks",itemId:"menuBookmarks",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"printicon",event:"toolbarPrint",itemId:"menuPrint",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"clippingicon",event:"toolbarClipping",itemId:"menuClipping",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"infoicon",event:"toolbarInfo",itemId:"menuInfo",cls:"toolbarIconRight"},{xtype:"layouttoolbaricon",setting:"infoicon",iconUrl:"resources/images/reader%20icons/speech-ic-wht2.png",event:"toggleTTS",itemId:"menuTTS",status:"STOPPED",cls:"toolbarIconRight"}]}]},initialize:function(){var b=this;var a="#ffffff";if(settings.topbar.color!=null){a="#"+settings.topbar.color.replace("#","")}b.setStyle({color:a});var c=b.getComponent("viewOptions");b.topBarIconContainer=c.getComponent("toolbarIcon");b.topBarIconLarge=b.topBarIconContainer.getComponent("toolbarIconLarge");b.topBarIconSmall=b.topBarIconContainer.getComponent("toolbarIconSmall");b.setUpTopBarIcon();b.ttsToggle=b.getComponent("iconsContainer").getComponent("menuTTS");if(window.SpeechSynthesisUtterance===undefined||settings.tts===undefined){b.ttsToggle.hide()}b.setTtsToggleListener();if(settings.newsday!=null){if(settings.newsday.extraTopBar=="true"){b.topBarIconContainer.hide()}}InfinityMobile.view.LayoutView.prototype.initialize.apply(this,arguments);b.dpsSingle=c.getComponent("dpsSingle");b.dpsDouble=c.getComponent("dpsDouble");b.setDPS();b.zoomFit=c.getComponent("zoomFit");b.zoomFill=c.getComponent("zoomFill");b.setZoom();b.readerPageControlContainer=b.getComponent("readerPageControlContainer");b.readerPageNumberContainer=b.readerPageControlContainer.getComponent("readerPageNumberContainer");b.setPageNumber();b.setIcons();b.setShare();b.setHowTo();b.setupZoomSlider(c);b.setupTooltips();if(settings.newsday!=null){if(settings.newsday.menuDirection=="left"){b.menuIcon.hide()}}},setupTooltips:function(){var a=this;a.tooltip=a.getComponent("tooltiptool");a.fullscreenIcon=a.getComponent("viewOptions").getComponent("fullscreenIcon");a.firstPageIcon=a.readerPageControlContainer.getComponent("firstPageIcon");a.previousPageIcon=a.readerPageControlContainer.getComponent("previousPageIcon");a.nextPageIcon=a.readerPageControlContainer.getComponent("nextPageIcon");a.lastPageIcon=a.readerPageControlContainer.getComponent("lastPageIcon");$(a.tooltip.element.dom).css("visibility","hidden");var b=settings.topbar.toolTips;a.topBarIconContainer.element.dom.onmouseover=function(){a.tooltip.setHtml(publicationName);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.topBarIconContainer.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.fullscreenIcon.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.fullscreen);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.fullscreenIcon.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.zoomFit.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.pageFit);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.zoomFit.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.zoomFill.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.pageFill);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.zoomFill.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.dpsSingle.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.singlePage);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.dpsSingle.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.dpsDouble.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.doublePage);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.dpsDouble.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.firstPageIcon.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.firstPage);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.firstPageIcon.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.previousPageIcon.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.previousPage);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.previousPageIcon.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.nextPageIcon.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.nextPage);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.nextPageIcon.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.lastPageIcon.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.lastPage);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.lastPageIcon.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuInfo.element.dom.onmouseover=function(){a.tooltip.setHtml(language.howToUse.howToUse);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuInfo.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuClipping.element.dom.onmouseover=function(){a.tooltip.setHtml(language.clippings.createClipping);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuClipping.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuPrint.element.dom.onmouseover=function(){a.tooltip.setHtml(language.print.print);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuPrint.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuBookmarks.element.dom.onmouseover=function(){a.tooltip.setHtml(language.bookmarks.bookmarks);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuBookmarks.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuDownload.element.dom.onmouseover=function(){a.tooltip.setHtml(language.download.download);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuDownload.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuArchive.element.dom.onmouseover=function(){a.tooltip.setHtml(language.archive.archive);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuArchive.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuShare.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.share);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuShare.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuSearch.element.dom.onmouseover=function(){a.tooltip.setHtml(language.search.search);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuSearch.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuIcon.element.dom.onmouseover=function(){a.tooltip.setHtml(language.menu.menu);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuIcon.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.zoomContainer.zoomInBtn.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.zoomIn);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.zoomContainer.zoomInBtn.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.zoomContainer.zoomOutBtn.element.dom.onmouseover=function(){a.tooltip.setHtml(language.topbar.zoomOut);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.zoomContainer.zoomOutBtn.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuZones.element.dom.onmouseover=function(){a.tooltip.setHtml(language.menu.zones.capitalizeFirst());a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuZones.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuSectionList.element.dom.onmouseover=function(){a.tooltip.setHtml(language.sectionList.sectionList);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.menuSectionList.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")},a.ttsToggle.element.dom.onmouseover=function(){a.tooltip.setHtml(language.menu.readAloud);a.tooltipLeft();$(a.tooltip.element.dom).css("visibility","")};a.ttsToggle.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},tooltipLeft:function(){var a=this;a.element.dom.onmousemove=(function(b){if(b.target.className.indexOf("tooltiptoolbar")==-1){a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(b.clientX-$(a.getComponent("tooltiptool").element.dom).width()-25)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(b.clientX-$(a.getComponent("tooltiptool").element.dom).width()-25)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(b.clientX-$(a.getComponent("tooltiptool").element.dom).width()-25)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"}})},setupZoomSlider:function(b){var a=this;a.zoomContainer=b.getComponent("toolbarZoomBar");if(Ext.browser.is.Chrome){if(navigator.appVersion.indexOf("Edge")!=-1){a.zoomContainer.element.dom.style.top="0%"}else{}}else{a.zoomContainer.element.dom.style.top="0%"}},setUpTopBarIcon:function(){var b=this;var a=settings.topbar;b.topBarIconLarge.setStyle({backgroundImage:"url("+a.logo+")"});if(a.smallLogo!=null){var c=a.smallLogo;b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconSmall.setStyle({backgroundImage:"url("+c+")"})}else{b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconSmall.setStyle({backgroundImage:"url("+a.logo+")"})}b.topBarIconContainer.element.on("tap",function(){if(settings.topbar.logoUrl!=null){window.open(settings.topbar.logoUrl,"_blank")}else{mainPanel.fireEvent("readerFirst")}})},setDPS:function(){var b=this;var a=settings.reader;if(a.toggleDPS=="True"||a.toggleDPS=="true"){if(a.defaultPageMode=="double"){b.dpsDouble.updateState("selected")}else{b.dpsSingle.updateState("selected")}}else{b.dpsSingle.setHidden(true);b.dpsDouble.setHidden(true)}},setZoom:function(){var b=this;var a=settings.reader;if(a.zoomMode=="fit"){b.zoomFit.updateState("selected")}else{b.zoomFill.updateState("selected")}},setPageNumber:function(){var a=this;a.readerPageNumberContainer.element.on("tap",function(){mainPanel.fireEvent("pageNumber",this)})},setShare:function(){var a=this;a.menuShare.element.on("tap",function(){mainPanel.fireEvent("toolbarShare",this)})},setHowTo:function(){var a=this;a.menuInfo.element.on({tap:a.howToTap,scope:a})},howToTap:function(){mainPanel.fireEvent("toolbarHowTo",this.menuShare,this.readerPageNumberContainer,this.fullscreenIcon,this.menuIcon,this.dpsSingle)},setIcons:function(){var c=this;c.iconsContainer=c.getComponent("iconsContainer");c.menuIcon=c.iconsContainer.getComponent("menuicon");c.menuSearch=c.iconsContainer.getComponent("menuSearch");c.menuShare=c.iconsContainer.getComponent("menuShare");c.menuArchive=c.iconsContainer.getComponent("menuArchive");c.menuDownload=c.iconsContainer.getComponent("menuDownload");c.menuBookmarks=c.iconsContainer.getComponent("menuBookmarks");c.menuPrint=c.iconsContainer.getComponent("menuPrint");c.menuClipping=c.iconsContainer.getComponent("menuClipping");c.menuInfo=c.iconsContainer.getComponent("menuInfo");c.menuZones=c.iconsContainer.getComponent("menuZones");c.menuSectionList=c.iconsContainer.getComponent("menuSectionList");if(settings.clippings==null){c.menuClipping.hide()}if(settings.sharing==null){c.menuShare.hide()}if(settings.menu==null){c.menuIcon.hide();c.menuArchive.hide();c.menuDownload.hide();c.menuBookmarks.hide();c.menuPrint.hide()}else{if(settings.menu.hideArchive!=null){c.menuArchive.hide()}else{var a=Ext.getStore("ArchiveStore");var b=[];if(a.data.items[0]!=null){if(a.data.items[0].raw.editions!=null){b=a.data.items[0].raw.editions.edition;if(b.length==0){c.menuArchive.hide()}else{if(Object.prototype.toString.call(b)==="[object Object]"){if(b["@name"]==editionName){}}}}}}if(settings.menu.hideDownload!=null){c.menuDownload.hide()}if(settings.menu.hidePrint!=null){c.menuPrint.hide()}if(settings.menu.hideBookmarks!=null){c.menuBookmarks.hide()}}if(settings.bookmarks.bookmark.length==0){c.menuSectionList.hide()}if(settings.menu.zones==null||settings.zones.zone.length==0||settings.newsday!=null){c.menuZones.hide()}},capitalize:function(a){return a.replace(/(?:^|\s)\S/g,function(b){return b.toUpperCase()})},setTtsToggleListener:function(){var a=this;if(a.ttsToggle.config.status!=null){a.ttsToggle.status=a.ttsToggle.config.status}if(window.SpeechSynthesisUtterance!=undefined){a.ttsToggle.element.on({tap:function(){switch(a.ttsToggle.status){case"STOPPED":case"FINISHED":a.fireEvent("playArticleTTS",a.ttsToggle,"na");break;case"PAUSED":a.fireEvent("resumeArticleTTS",a.ttsToggle,"na");break;case"PLAYING":a.fireEvent("pauseArticleTTS",a.ttsToggle,"na");break;default:a.fireEvent("stopArticleTTS",a.ttsToggle,"na")}}})}}},0,["layouttoolbar"],["component","container","layoutview","layouttoolbar"],{component:true,container:true,layoutview:true,layouttoolbar:true},["widget.layouttoolbar"],0,[InfinityMobile.view.desktop,"LayoutToolBarView"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderToolbarShareMenu",Ext.Container,{config:{modal:true,width:0,height:40,hideOnMaskTap:true,style:"background:black;display:inline;",items:[{itemId:"menuSharing",xtype:"readermenushare",layout:"hbox",defaults:{margin:5}}]},initialize:function(){var a=this;a.loaded=false;a.sharingContainer=a.getComponent("menuSharing");a.loadShare();a.element.on({painted:function(){this.loaded=true},scope:a})},loadShare:function(){var a=this;if(settings.newsday!=null){a.addCls("shareOverlay")}a.fireEvent("loadShare",a)},hide:function(){var a=this;if(a.loaded){a.fireEvent("shareMenuClose");Ext.Container.prototype.hide.apply(this,arguments)}}},0,["readertoolbarsharemenu"],["component","container","readertoolbarsharemenu"],{component:true,container:true,readertoolbarsharemenu:true},["widget.readertoolbarsharemenu"],0,[InfinityMobile.view.desktop,"ReaderToolbarShareMenu"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToViewOptions",Ext.Container,{config:{height:50,width:0,modal:{opacity:0},cls:"how-to-item how-to-view-options",items:[{itemId:"graphic",width:270,height:165,left:-100,top:-30,style:"background-image:url(resources/images/howTo/full_screen_icon.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",cls:"howtoview-explainationTitle",style:"color:white;text-align:center;font-size:18px;",left:10,width:200,top:140},{itemId:"explainationText",cls:"howtoview-explainationText",style:"color:white;text-align:center;font-size:14px;",left:10,width:200,top:160}]},initialize:function(){var a=this;a.getModal().setStyle({opacity:0});a.explainationTitle=a.getComponent("explainationTitle");a.explainationText=a.getComponent("explainationText");a.explainationTitle.setHtml(language.howToUse.viewOptionsTitle);a.explainationText.setHtml(language.howToUse.viewOptionsDesc);if(typeof settings!="undefined"&&settings.reader!=null&&(settings.reader.toggleDPS!="true"&&settings.reader.toggleDPS!="True")){a.explainationTitle.setLeft(-25);a.explainationText.setLeft(-25)}a.setupResizeListener()},setStartingLeftValues:function(){var a=this;if((typeof settings!="undefined"&&settings.reader!=null&&(settings.reader.toggleDPS=="true"||settings.reader.toggleDPS=="True"))&&a.returnOrientation()=="landscape"){a.explainationTitle.setLeft(10);a.explainationText.setLeft(10)}else{a.explainationTitle.setLeft(-25);a.explainationText.setLeft(-25)}},setupResizeListener:function(){var a=this;a.resizeListener=function(){if(a.resizeTimeout!=null){clearTimeout(a.resizeTimeout)}a.resizeTimeout=setTimeout(function(){if(a.returnOrientation()=="portrait"){a.explainationTitle.setLeft(-25);a.explainationText.setLeft(-25)}else{a.setStartingLeftValues()}},250)};$(window).on("resize",a.resizeListener)},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(currentProfile=="desktop"){if(window.innerWidth>window.innerHeight){a="landscape"}else{a="portrait"}}}return a},destroy:function(){$(window).off("resize",this.resizeListener);Ext.Container.prototype.destroy.apply(this,arguments)}},0,["howtoeditionoptions"],["component","container","howtoeditionoptions"],{component:true,container:true,howtoeditionoptions:true},["widget.howtoeditionoptions"],0,[InfinityMobile.view.desktop,"HowToViewOptions"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToEditionOptions",Ext.Container,{config:{height:50,cls:"how-to-item how-to-edition-options",width:0,modal:true,items:[{itemId:"graphic",width:270,height:165,right:-70,top:-30,style:"background-image:url(resources/images/howTo/edition-options2.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",style:"color:white;text-align:center;font-size:18px;white-space:nowrap;",left:-240,width:200,top:140},{itemId:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:-240,width:200,top:160}]},initialize:function(){var a=this;a.explainationTitle=a.getComponent("explainationTitle");a.explainationText=a.getComponent("explainationText");a.explainationTitle.setHtml(language.howToUse.editionOptionsTitle);a.explainationText.setHtml(language.howToUse.editionOptionsDesc)}},0,["howtoeditionoptions"],["component","container","howtoeditionoptions"],{component:true,container:true,howtoeditionoptions:true},["widget.howtoeditionoptions"],0,[InfinityMobile.view.desktop,"HowToEditionOptions"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToPageControl",Ext.Container,{config:{height:50,width:0,modal:{opacity:0},cls:"how-to-item",items:[{itemId:"graphic",width:270,height:160,right:-112,top:-38,style:"background-image:url(resources/images/howTo/navigate-pages2.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",style:"color:white;text-align:center;font-size:18px;",left:-185,width:200,top:135},{itemId:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:-185,width:200,top:155}]},initialize:function(){var a=this;console.log(a);a.getModal().setStyle({opacity:0});a.explainationTitle=a.getComponent("explainationTitle");a.explainationText=a.getComponent("explainationText");a.explainationTitle.setHtml(language.howToUse.navPagesTitle);a.explainationText.setHtml(language.howToUse.navPagesDesc)}},0,["howtoeditionoptions"],["component","container","howtoeditionoptions"],{component:true,container:true,howtoeditionoptions:true},["widget.howtoeditionoptions"],0,[InfinityMobile.view.desktop,"HowToPageControl"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToReader",Ext.Container,{config:{height:200,width:700,modal:{opacity:0},centered:true,layout:{type:"hbox",pack:"middle"},cls:"how-to-item",items:[{itemId:"touchscreenHowTo",width:250,height:200,style:"background-image:url(resources/images/howTo/touch-screen-friendly.png);background-position:center;background-repeat:no-repeat;",items:[{itemId:"explainationTitle",style:"color:white;text-align:center;font-size:18px;",left:30,width:200,top:130,hidden:true},{itemId:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:30,width:200,top:150,hidden:true}]},{itemId:"articleHowTo",width:250,height:200,style:"background-image:url(resources/images/howTo/article-popouts.png);background-position:center;background-repeat:no-repeat;",items:[{itemId:"explainationTitle",style:"color:white;text-align:center;font-size:18px;",left:30,width:200,top:130,hidden:true},{itemId:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:30,width:200,top:150,hidden:true}]}]},initialize:function(){var b=this;b.getModal().setStyle({opacity:0});b.articleHowTo=b.getComponent("articleHowTo");b.articleTitle=b.articleHowTo.getComponent("explainationTitle");b.articleDesc=b.articleHowTo.getComponent("explainationText");b.touchscreenHowTo=b.getComponent("touchscreenHowTo");b.touchscreenTitle=b.touchscreenHowTo.getComponent("explainationTitle");b.touchscreenDesc=b.touchscreenHowTo.getComponent("explainationText");b.articleTitle.setHtml(language.howToUse.articleTitle);b.articleDesc.setHtml(language.howToUse.articleDesc);b.touchscreenTitle.setHtml(language.howToUse.touchscreenTitle);var a=language.howToUse.touchscreenDesc;if(settings.newsday!=null){a=a.replace("Optimised","Optimized")}b.touchscreenDesc.setHtml(a);b.fireEvent("howToReaderInit",b.articleHowTo);b.on({painted:function(){var d=typeof settings!="undefined"&&settings.reader!=null&&settings.reader.bannerAd!=null&&settings.reader.bannerAd.position=="top"?170:0;var c=document.getElementsByClassName("reader-banner-ad");if(d!=0&&(c!=null&&c.length>0)){b.element.dom.style.marginTop=d+"px"}if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1||Ext.browser.is.Safari){b.touchscreenDesc.setTop(150+$(b.touchscreenTitle.element.dom).height())}else{b.touchscreenDesc.setTop(130+$(b.touchscreenTitle.element.dom).height())}b.touchscreenDesc.show();b.touchscreenTitle.show();if(Ext.browser.is.IE||navigator.appVersion.indexOf("Edge")!=-1||Ext.browser.is.Safari){b.articleDesc.setTop(150+$(b.articleTitle.element.dom).height())}else{b.articleDesc.setTop(130+$(b.articleTitle.element.dom).height())}b.articleDesc.show();b.articleTitle.show()},scope:b})}},0,["howtoreader"],["component","container","howtoreader"],{component:true,container:true,howtoreader:true},["widget.howtoreader"],0,[InfinityMobile.view.desktop,"HowToReader"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.DynamicArticlesInterstitialContainer",Ext.Container,{config:{margin:"50 0 0 0"},initialize:function(){var a=this;a.setStyle("height:"+($(document).height()-120)+"px;")},onResize:function(){var a=this;if(a!=null){a.setStyle("height:"+($(document).height()-120)+"px;")}}},0,["dynamicarticlesinterstitialcontainer"],["component","container","dynamicarticlesinterstitialcontainer"],{component:true,container:true,dynamicarticlesinterstitialcontainer:true},["widget.dynamicarticlesinterstitialcontainer"],0,[InfinityMobile.view.desktop,"DynamicArticlesInterstitialContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.DynamicArticlesInterstitial",Ext.Container,{config:{style:"padding:5px 0px 0px 0px",cls:"articlereaderiteminterstitial",items:[{itemId:"advert",cls:"advert"}]},initialize:function(){var d=this;Ext.Container.prototype.initialize.apply(this,arguments);d.advertContainer=d.getComponent("advert");var a=settings.reader.interstitial;if(d.config.settings!=null){d.settings=d.config.settings}if(settings.dynamic.adverts.interstitial.type=="url"){var b=settings.dynamic.adverts.interstitial.url;d.advertContainer.setHtml("<iframe width='728' height='1024' style='border:none;' scrolling='no' src='"+b+"' />");d.advertContainer.element.down("iframe").dom.style.transformOrigin="0px 0px";d.onResizeFn=function(){var k=$(document).height()-120;var l=k*0.8;var j=((l*0.3)*2)+(l*0.45)-10;var m=(j)/1024;if(m>1){m=1}d.element.dom.style.width=(728*m)+"px";d.advertContainer.element.down("iframe").dom.style.webkitTransform="scale3d("+m+","+m+",1)";console.log(d.advertContainer.element.down("iframe").dom.style)};d.onResizeFn()}else{if(d.settings.type=="dfp"){d.networkCode=d.settings.networkCode;d.adUnit=d.settings.adUnit;d.advertDivID=d.id+"advert";if(d.config.adHeight!=null){d.adHeight=d.config.adHeight}var e=(d.adHeight/1024);if(e>1){e=1}d.element.dom.style.width=(728*e+50)+"px";d.advertContainer.setHtml("<div id='"+d.advertDivID+"' style='pointer-events:none;margin-left:0;margin-right:0;-ms-transform-origin-x:0;-ms-transform-origin-y:0;-moz-transform-origin-x:0px;-moz-transform-origin-y:0px;-webkit-transform-origin-x:0;-webkit-transform-origin-y:0;-moz-transform:scale3d("+e+","+e+",1);-webkit-transform:scale3d("+e+","+e+",1);-ms-transform:scale3d("+e+","+e+",1);transform-origin:0px 0px;'></div>");d.advertDiv=d.element.down("#"+d.advertDivID);d.on("painted",d.loadAdvert,d,{delay:1000,single:true});d.on("resize",d.onResizeFn,d);d.onResizeFn=function(){var k=$(document).height()-120;var l=k*0.8;var j=((l*0.3)*2)+(l*0.45)-10;var m=(j)/1024;if(m>1){m=1}d.element.dom.style.width=(728*m+50)+"px";d.advertContainer.element.dom.firstChild.firstChild.firstChild.style.webkitTransform="scale3d("+m+","+m+",1)";d.advertContainer.element.dom.firstChild.firstChild.firstChild.style.msTransform="scale3d("+m+","+m+",1)";d.advertContainer.element.dom.firstChild.firstChild.firstChild.style.mozTransform="scale3d("+m+","+m+",1)";d.advertContainer.element.dom.firstChild.firstChild.firstChild.style.transform="scale3d("+m+","+m+",1)"}}else{var g=new Image();g.src=d.settings.url;g.style.height=d.adHeight+"px";d.advertContainer.setHtml("<div style='margin:auto;'>"+g.outerHTML+"</div>");console.log(d.settings);if(d.settings.link!=null){var c=$(d.advertContainer.element.dom).find("img")[0];if(c!=null){$(c).addClass("pointerCursor");c.onclick=function(){window.open(d.settings.link,"_blank")};var f;c.addEventListener("touchstart",function(h){f=h.timeStamp});c.addEventListener("touchend",function(h){if(h.timeStamp-f<60){window.open(d.settings.link,"_blank")}})}}d.onResizeFn=function(){var k=$(d.advertContainer.element.dom).find("img")[0];if(k!=null){var l=$(document).height()-120;var m=l*0.8;var j=((m*0.3)*2)+(m*0.45)-10;k.style.height=j+"px"}}}}},loadAdvert:function(){var a=this;googletag.cmd.push(function(){var b=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt("768"),parseInt("1024")],a.advertDivID);b.addService(googletag.pubads());googletag.pubads().addEventListener("slotRenderEnded",function(c){if(c.slot==b){if(c.isEmpty){a.hide()}}});googletag.enableServices()});googletag.cmd.push(function(){googletag.display(a.advertDivID)})},onResize:function(){var a=this;a.onResizeFn()}},0,["dynamicarticlesinterstitial"],["component","container","dynamicarticlesinterstitial"],{component:true,container:true,dynamicarticlesinterstitial:true},["widget.dynamicarticlesinterstitial"],0,[InfinityMobile.view.desktop,"DynamicArticlesInterstitial"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToMenuIcon",Ext.Container,{config:{height:50,width:0,modal:{opacity:0},cls:"how-to-item",items:[{itemId:"graphic",width:270,height:300,right:-90,top:-30,style:"background-image:url(resources/images/howTo/menu-options2.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",html:"Main Menu",style:"color:white;text-align:center;font-size:18px;",left:-200,width:200,top:275},{itemId:"explainationText",html:"Use the menu to access a full list of options and sections for the edition",style:"color:white;text-align:center;font-size:14px;",left:-200,width:200,top:295}]},initialize:function(){var a=this;a.getModal().setStyle({opacity:0});a.explainationTitle=a.getComponent("explainationTitle");a.explainationText=a.getComponent("explainationText");a.explainationTitle.setHtml(language.howToUse.mainMenuTitle);a.explainationText.setHtml(language.howToUse.mainMenuDesc)}},0,["howtomenuicon"],["component","container","howtomenuicon"],{component:true,container:true,howtomenuicon:true},["widget.howtomenuicon"],0,[InfinityMobile.view.desktop,"HowToMenuIcon"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToArticlesContainer",Ext.Container,{config:{height:50,width:0,modal:{opacity:0},cls:"how-to-item howToArticlesContainer",items:[{itemId:"graphic",width:270,height:235,left:20,bottom:-15,style:"background-image:url(resources/images/howTo/browse-content.png);background-size:contain;background-position:center;background-repeat:no-repeat;"},{itemId:"explainationTitle",style:"color:white;text-align:center;font-size:18px;",left:165,width:200,bottom:145},{itemId:"explainationText",style:"color:white;text-align:center;font-size:14px;",left:165,width:200,top:-95}]},initialize:function(){var a=this;a.getModal().setStyle({opacity:0});a.explainationTitle=a.getComponent("explainationTitle");a.explainationText=a.getComponent("explainationText");a.explainationTitle.setHtml(language.howToUse.browseTitle);a.explainationText.setHtml(language.howToUse.browseDesc);a.fireEvent("howToArticlesInit",a.explainationText)}},0,["howtoarticlescontainer"],["component","container","howtoarticlescontainer"],{component:true,container:true,howtoarticlescontainer:true},["widget.howtoarticlescontainer"],0,[InfinityMobile.view.desktop,"HowToArticlesContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileWide",Ext.Panel,{config:{padding:5,style:"float:left;z-index:6;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;overflow:hidden;",padding:10,height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.expand=false;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;a.imageContainer=a.getComponent("image");if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.titleContainer=a.getComponent("title");a.setStyle("height:52.5%;width:512px;overflow:hidden;");a.height=52.5;a.imageHeight=1.6;if(a.config.bannerAdCheck!=null){if(a.config.bannerAdCheck=="true"){if(settings.dynamic.adverts!=null){if(settings.dynamic.adverts.bannerAd!=null){a.setStyle("height:72.5%;width:512px;overflow:hidden;");a.height=72.5;a.expandAnim="expandSmallViewTopLeftBanner 0.2s ease-in";a.shrinkAnim="shrinkSmallViewTopLeftBanner 0.2s ease-in";a.imageHeight=1.2}}}}a.timer;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.imageAspect=false;c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.headlineTextSize=28;c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p class='sectionText' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;'>"+c.article.headline+"</p></div>");c.image=new Image();c.image.src=c.firstImage.url;c.image.onload=function(){var f=c.image.naturalWidth/c.image.naturalHeight;if(f<1){c.imageAspect=true;var e=$(c.element.dom).height()/c.image.naturalHeight;var d=c.image.naturalWidth*e;if(d>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}};c.titleContainer.element.on({painted:function(){if(!c.paintedTitle){var e=false;while(!e){var d=c.titleContainer.element.down(".sectionText").dom.clientHeight+c.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(d>$(c.element.dom).height()){c.headlineTextSize=c.headlineTextSize-4;$(c.titleContainer.element.down(".headlineText").dom).css("font-size",c.headlineTextSize+"px")}else{e=true;break}}c.paintedTitle=true}},scope:c});if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}},setNoImage:function(){var d=this;d.titleContainer.resetFloating();d.titleContainer.setStyle("background-color:#EEEEEE; color:black;");d.sectionStr="";if(d.article.sections.length>1){for(var c=0;c<d.article.sections.length;c++){d.sectionStr+=d.article.sections[c]+"/"}d.sectionStr=d.sectionStr.substring(0,sectionStr.length-1)}else{if(d.article.sections[0]!=null){d.sectionStr=d.article.sections[0]}}if(d.article.shortStory!=null){var a=d.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(d.sectionStr=="LIVE NEWS"){if(d.article.link!=null){if(d.article.link.length>0){d.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+d.article.link+"\")' onclick='window.open(\""+d.article.link+"\")'>Click here to view full story</p>"}}}d.headlineTextSize=28;var e=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+d.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+d.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});e.element.on({painted:function(){if(!d.paintedTitle){var f=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var j=$(this.element.dom).height()-f;e.element.down(".shortStory").dom.style.maxHeight=(j-(j%14)-26)+"px";if(e.element.down(".bylineText").dom.clientHeight+e.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true}if(e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadline=true}var h=false;while(!h){var g=d.titleContainer.element.down(".sectionText").dom.clientHeight+d.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(g>$(d.element.dom).height()){d.headlineTextSize=d.headlineTextSize-4;$(d.titleContainer.element.down(".headlineText").dom).css("font-size",d.headlineTextSize+"px")}else{h=true;break}}d.paintedTitle=true}},scope:d});d.titleContainer.add(e);if(d.article.body!=null){if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}d.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",width:"100%",html:d.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",padding:5,flex:1,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var f=this;var g=f.titleContainer.getComponent("title");var c=false;var e=false;while(!e){if(f.titleContainer.element.down(".sectionText")!=null||f.titleContainer.element.down(".headlineText")){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(b>$(f.element.dom).height()){f.headlineTextSize=f.headlineTextSize-4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",f.headlineTextSize+"px")}else{c=true;e=true;break}}else{e=true}}if(f.hasImage){if(c){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;while(c){if(b<$(f.element.dom).height()){if(f.headlineTextSize+4<=20){f.headlineTextSize+=4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize)+"px");b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20}else{c=false;break}}else{$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize-4)+"px");c=false;break}}}}else{if(c){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;while(c){if(b<$(f.element.dom).height()){if(f.headlineTextSize+4<=28){f.headlineTextSize+=4;console.log(f.headlineTextSize);$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize)+"px");b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20}else{c=false;break}}else{$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize-4)+"px");f.headlineTextSize-=4;c=false;break}}}}if(g!=null){var j=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var h=$(this.element.dom).height()-j;g.element.down(".shortStory").dom.style.maxHeight=(h-(h%14)-26)+"px";if(parseFloat(g.element.down(".bylineText").dom.clientHeight)+parseFloat(g.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}else{g.element.down(".bylineText").dom.style.visibility="";f.bylineHidden=false}if(parseFloat(g.element.down(".subheadlineText").dom.clientHeight)+parseFloat(g.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadlineHidden=true}else{g.element.down(".subheadlineText").dom.style.visibility="";f.subheadlineHidden=false}}if(f.hasImage){if(f.imageAspect){var d=$(f.element.dom).height()/f.image.naturalHeight;var a=f.image.naturalWidth*d;if(a>$(f.element.dom).width()/2){f.imageContainer.element.dom.style.backgroundSize="50%";f.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{f.imageContainer.element.dom.style.backgroundSize=" auto 100%";f.imageContainer.element.dom.style.backgroundPosition="0% 0%"}}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var l=this;var n=l.titleContainer.getComponent("title");var p=false;if(p&&l.sectionStr.indexOf("LIVE NEWS")==-1){l.fireEvent("articleClick",l.article,l.article.guid)}else{if(p&&l.sectionStr.indexOf("LIVE NEWS")!=1){l.fireEvent("liveArticleClick",l.article)}else{if(!l.hasImage&&!l.expand){if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}}clearInterval(l.timer);if(!l.expand){l.fireEvent("tileTapped",l);l.titleContainer.setPadding(40);if(l.titleContainer.getComponent("title")!=null){var h=l.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=l.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px")}var k=l.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=l.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(l.article.body.indexOf("<p>")!=-1){l.article.body=l.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(l.hasImage){l.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(l.imageContainer.element.dom.scrollHeight*l.imageHeight),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+l.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+l.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+l.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+l.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+l.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var q=l.articlePop.getComponent("title").element.down("div");q.dom.style.padding="40px";l.sharingImage=l.articlePop.getComponent("title").getComponent("sharing");l.setupSharing(true);l.sharingImage.show();l.imageContainer.hide();l.titleContainer.hide();l.articlePop.getComponent("image").element.dom.style.backgroundImage="url('"+l.firstImage.url+"')";if(l.imageAspect){l.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{l.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}l.add(l.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");l.articlePop.getComponent("title").element.dom.style.position="relative";l.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){l.articlePop.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.articlePop.items.items[0].element.dom.clientHeight+l.articlePop.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.articlePop.getScrollable().getScroller().on({scroll:function(u){var t=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);var s=l.articlePop.getScrollable().getScroller().position.y;var r=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);if(((t-s)/r)>0){l.articlePop.getComponent("image").element.dom.style.top=(s)+"px";l.articlePop.getComponent("image").element.dom.style.opacity=((t-s)/r)}}})}}else{if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){l.titleContainer.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.desktopScroll.down(".x-scroll-indicator-dark")!=null){l.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.titleContainer.items.items[0].element.dom.clientHeight+l.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.titleContainer.setScrollable(true);l.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=l.titleContainer.getScrollable().getScroller();f.container.dom.offsetParent.style.zIndex=14}l.sharingContainer=l.titleContainer.getComponent("title").getComponent("sharing");l.sharingContainer.show();l.setupSharing(false);l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(l.bylineHidden){console.log(l.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}l.element.dom.style.position="absolute";l.element.dom.style.zIndex=8;l.expand=true;l.element.dom.style.animation=l.expandAnim;l.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1&&j.target.className.indexOf("fullStoryLink")==-1){if(l.hasImage){l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}l.articlePop.destroy();l.imageContainer.show();l.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction)}}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}else{l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var b=l.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=l.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=l.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=l.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="";l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction);if(Ext.browser.is.IE){l.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(l.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["smallviewtilewide"],["component","container","panel","smallviewtilewide"],{component:true,container:true,panel:true,smallviewtilewide:true},["widget.smallviewtilewide"],0,[InfinityMobile.view.desktop,"SmallViewTileWide"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileSmall",Ext.Panel,{config:{padding:5,style:"float:left;z-index:6 !important;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;overflow:hidden;",padding:10,height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.expand=false;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;a.imageContainer=a.getComponent("image");if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.titleContainer=a.getComponent("title");a.setStyle("height:52.5%;width:256px;overflow:hidden;");a.height=52.5;a.imageHeight=1.6;if(a.config.bannerAdCheck!=null){if(a.config.bannerAdCheck=="true"){if(settings.dynamic.adverts!=null){if(settings.dynamic.adverts.bannerAd!=null){a.setStyle("height:72.5%;width:256px;overflow:hidden;");a.height=72.5;a.expandAnim="expandSmallViewTopRightBanner 0.2s ease-in";a.shrinkAnim="shrinkSmallViewTopRightBanner 0.2s ease-in";a.imageHeight=1.2}}}}a.timer;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.headlineTextSize=28;c.titleContainer.setHtml("<div style='position:absolute;bottom:10px;right:10px;left:10px;' ><p class='sectionText' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;'>"+c.article.headline+"</p></div>");c.titleContainer.element.on({painted:function(){if(!c.paintedTitle){var e=false;while(!e){var d=c.titleContainer.element.down(".sectionText").dom.clientHeight+c.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(d>$(c.element.dom).height()){c.headlineTextSize=c.headlineTextSize-4;$(c.titleContainer.element.down(".headlineText").dom).css("font-size",c.headlineTextSize+"px")}else{e=true;break}}c.paintedTitle=true}},scope:c});if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}},setNoImage:function(){var d=this;d.titleContainer.resetFloating();d.titleContainer.setStyle("background-color:#EEEEEE; color:black;");d.hasImage=false;d.sectionStr="";if(d.article.sections.length>1){for(var c=0;c<d.article.sections.length;c++){d.sectionStr+=d.article.sections[c]+"/"}d.sectionStr=d.sectionStr.substring(0,sectionStr.length-1)}else{if(d.article.sections[0]!=null){d.sectionStr=d.article.sections[0]}}if(d.article.shortStory!=null){var a=d.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(d.sectionStr=="LIVE NEWS"){if(d.article.link!=null){if(d.article.link.length>0){d.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+d.article.link+"\")' onclick='window.open(\""+d.article.link+"\")'>Click here to view full story</p>"}}}var e=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+d.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+d.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});d.headlineTextSize=28;e.element.on({painted:function(){if(!d.paintedTitle){var f=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var j=$(this.element.dom).height()-f;e.element.down(".shortStory").dom.style.maxHeight=(j-(j%14)-26)+"px";if(e.element.down(".bylineText").dom.clientHeight+e.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true}if(e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadline=true}var h=false;while(!h){var g=d.titleContainer.element.down(".sectionText").dom.clientHeight+d.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(g>$(d.element.dom).height()){d.headlineTextSize=d.headlineTextSize-4;$(d.titleContainer.element.down(".headlineText").dom).css("font-size",d.headlineTextSize+"px")}else{h=true;break}}d.paintedTitle=true}},scope:d});d.titleContainer.add(e);if(d.article.body!=null){if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}d.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",width:"100%",html:d.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",padding:5,flex:1,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var f=this;var g=f.titleContainer.getComponent("title");var b=false;var d=false;while(!d){if(f.titleContainer.element.down(".sectionText")!=null||f.titleContainer.element.down(".headlineText")){var c=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(c>$(f.element.dom).height()){f.headlineTextSize=f.headlineTextSize-4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",f.headlineTextSize+"px")}else{b=true;d=true;break}}else{d=true}}if(f.hasImage){if(b){var c=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;while(b){if(c<$(f.element.dom).height()){if(f.headlineTextSize+4<=20){f.headlineTextSize+=4;console.log(f.headlineTextSize);$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize)+"px");c=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20}else{b=false;break}}else{$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize-4)+"px");f.headlineTextSize-=4;b=false;break}}}}else{if(b){var c=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;while(b){if(c<$(f.element.dom).height()){if(f.headlineTextSize+4<=28){f.headlineTextSize+=4;console.log(f.headlineTextSize);$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize)+"px");c=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20}else{b=false;break}}else{$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize-4)+"px");f.headlineTextSize-=4;b=false;break}}}}if(g!=null){var a=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var e=$(this.element.dom).height()-a;g.element.down(".shortStory").dom.style.maxHeight=(e-(e%14)-26)+"px";if(parseFloat(g.element.down(".bylineText").dom.clientHeight)+parseFloat(g.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}else{g.element.down(".bylineText").dom.style.visibility="";f.bylineHidden=false}if(parseFloat(g.element.down(".subheadlineText").dom.clientHeight)+parseFloat(g.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadlineHidden=true}else{g.element.down(".subheadlineText").dom.style.visibility="";f.subheadlineHidden=false}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var l=this;var n=l.titleContainer.getComponent("title");var p=false;if(p&&l.sectionStr.indexOf("LIVE NEWS")==-1){l.fireEvent("articleClick",l.article,l.article.guid)}else{if(p&&l.sectionStr.indexOf("LIVE NEWS")!=1){l.fireEvent("liveArticleClick",l.article)}else{if(!l.hasImage&&!l.expand){if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}}clearInterval(l.timer);if(!l.expand){l.fireEvent("tileTapped",l);l.titleContainer.setPadding(40);if(l.titleContainer.getComponent("title")!=null){var h=l.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=l.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px")}var k=l.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=l.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(l.article.body.indexOf("<p>")!=-1){l.article.body=l.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(l.hasImage){l.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(l.imageContainer.element.dom.scrollHeight*l.imageHeight),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+l.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+l.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+l.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+l.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+l.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var q=l.articlePop.getComponent("title").element.down("div");q.dom.style.padding="40px";l.sharingImage=l.articlePop.getComponent("title").getComponent("sharing");l.setupSharing(true);l.sharingImage.show();l.imageContainer.hide();l.titleContainer.hide();l.articlePop.getComponent("image").element.dom.style.background="url('"+l.firstImage.url+"')";l.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%";l.add(l.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");l.articlePop.getComponent("title").element.dom.style.position="relative";l.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){l.articlePop.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.articlePop.items.items[0].element.dom.clientHeight+l.articlePop.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.articlePop.getScrollable().getScroller().on({scroll:function(u){var t=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);var s=l.articlePop.getScrollable().getScroller().position.y;var r=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);if(((t-s)/r)>0){l.articlePop.getComponent("image").element.dom.style.top=(s)+"px";l.articlePop.getComponent("image").element.dom.style.opacity=((t-s)/r)}}})}}else{if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){l.titleContainer.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.desktopScroll.down(".x-scroll-indicator-dark")!=null){l.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.titleContainer.items.items[0].element.dom.clientHeight+l.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.titleContainer.setScrollable(true);l.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=l.titleContainer.getScrollable().getScroller();f.container.dom.offsetParent.style.zIndex=14}l.sharingContainer=l.titleContainer.getComponent("title").getComponent("sharing");l.sharingContainer.show();l.setupSharing(false);l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(l.bylineHidden){console.log(l.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}l.element.dom.style.position="absolute";l.element.dom.style.zIndex=8;l.expand=true;l.element.dom.style.animation=l.expandAnim;l.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1&&j.target.className.indexOf("fullStoryLink")==-1){if(l.hasImage){l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}l.articlePop.destroy();l.imageContainer.show();l.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction)}}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}else{l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var b=l.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=l.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=l.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=l.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="";l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction);if(Ext.browser.is.IE){l.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(l.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["smallviewtilesmall"],["component","container","panel","smallviewtilesmall"],{component:true,container:true,panel:true,smallviewtilesmall:true},["widget.smallviewtilesmall"],0,[InfinityMobile.view.desktop,"SmallViewTileSmall"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileMed",Ext.Panel,{config:{padding:5,style:"float:left;z-index:6 !important;",layout:"vbox",items:[{itemId:"image",bottom:5,top:5,left:5,right:5,cls:"backgroundImage aspectfill"},{itemId:"title",bottom:5,top:5,left:5,right:5,style:"background-color:rgba(0,0,0,0.5); color:white; font-size:20px; font-weight:bold;overflow:hidden;",padding:10,height:"100%"}]},initialize:function(){var a=this;a.article=a.config.article;a.expand=false;a.bylineHidden=false;a.subheadlineHidden=false;a.paintedTitle=false;a.imageContainer=a.getComponent("image");if(a.config.expandAnim!=null){a.expandAnim=a.config.expandAnim}if(a.config.shrinkAnim!=null){a.shrinkAnim=a.config.shrinkAnim}a.titleContainer=a.getComponent("title");a.setStyle("height:52.5%;width:384px;overflow:hidden;");a.height=52.5;a.timer;a.section=a.getComponent("section");if(a.article.images!=null){if(a.article.images.length>0){a.on("painted",a.setBackgroundImage,a,{delay:10,single:true})}else{a.setNoImage()}}else{a.setNoImage()}a.element.on({tap:"onTap",scope:a})},setBackgroundImage:function(){var c=this;var a=c.article.images;c.hasImage=true;c.firstImage=a[0];c.imageContainer.element.dom.style.backgroundImage="url('"+c.firstImage.url+"')";c.titleContainer.setStyle("color:white;padding:5px;");c.titleContainer.element.dom.style.height="";c.titleContainer.element.dom.style.height="";c.imageContainer.element.dom.style.backgroundSize="cover";c.imageContainer.element.dom.style.backgroundPosition="50% 0%";c.imageContainer.element.dom.style.backgroundColor="gray";c.imageAspect=false;c.sectionStr="";if(c.article.sections.length>1){for(var b=0;b<c.article.sections.length;b++){c.sectionStr+=c.article.sections[b]+"/"}c.sectionStr=c.sectionStr.substring(0,c.sectionStr.length-1)}else{if(c.article.sections[0]!=null){c.sectionStr=c.article.sections[0]}}c.headlineTextSize=28;c.titleContainer.setHtml("<div class='tileText' style='word-wrap:break-word;position:absolute;bottom:10px;right:10px;left:10px;' ><p  class='sectionText' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+c.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;'>"+c.article.headline+"</p><p style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;'>"+c.article.subHeadline+"</p><p style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;>"+c.article.byline+"</p></div>");var d=new Image();d.src=c.firstImage.url;d.onload=function(){var g=d.naturalWidth/d.naturalHeight;if(g<1){c.imageAspect=true;var f=$(c.element.dom).height()/c.image.naturalHeight;var e=c.image.naturalWidth*f;if(e>$(c.element.dom).width()/2){c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{c.imageContainer.element.dom.style.backgroundSize=" auto 100%";c.imageContainer.element.dom.style.backgroundPosition="0% 0%"}c.imageContainer.element.dom.style.backgroundSize="50%";c.imageContainer.element.dom.style.backgroundPosition="0% 50%";c.titleContainer.element.down(".tileText").dom.style.bottom="";c.titleContainer.element.down(".tileText").dom.style.top="50%";c.titleContainer.element.down(".tileText").dom.style.left="55%";c.titleContainer.element.down(".tileText").dom.style.transform="translate(0%, -50%)"}};if(c.sectionStr=="LIVE NEWS"){if(c.article.link!=null){if(c.article.link.length>0){c.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+c.article.link+"\")' onclick='window.open(\""+c.article.link+"\")'>Click here to view full story</p>"}}}c.titleContainer.element.on({painted:function(){if(!c.paintedTitle){var f=false;while(!f){var e=c.titleContainer.element.down(".sectionText").dom.clientHeight+c.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(e>$(c.element.dom).height()){c.headlineTextSize=c.headlineTextSize-4;$(c.titleContainer.element.down(".headlineText").dom).css("font-size",c.headlineTextSize+"px")}else{f=true;break}}c.paintedTitle=true}},scope:c})},setNoImage:function(){var d=this;d.titleContainer.resetFloating();d.titleContainer.setStyle("background-color:#EEEEEE; color:black;");d.sectionStr="";if(d.article.sections.length>1){for(var c=0;c<d.article.sections.length;c++){d.sectionStr+=d.article.sections[c]+"/"}d.sectionStr=d.sectionStr.substring(0,sectionStr.length-1)}else{if(d.article.sections[0]!=null){d.sectionStr=d.article.sections[0]}}if(d.article.shortStory!=null){var a=d.article.shortStory.replace("<div></div>","");if(a==null){a=""}}else{var a=""}if(d.sectionStr=="LIVE NEWS"){if(d.article.link!=null){if(d.article.link.length>0){d.article.body+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+d.article.link+"\")' onclick='window.open(\""+d.article.link+"\")'>Click here to view full story</p>"}}}var e=Ext.create("Ext.Container",{itemId:"title",html:"<p class='sectionText' style='color:#B2272A;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;'>"+d.sectionStr+"</p><p class='headlineText' style='font-family:Open Sans, sans-serif;font-size:28px;font-weight:semibold;padding-top:5px;padding-bottom:5px;'>"+d.article.headline+"</p><p class='subheadlineText' style='font-family:Open Sans, sans-serif;font-size:14px;font-weight:semibold;padding-bottom:5px;'>"+d.article.subHeadline+"</p><p class='bylineText' style='font-family:Open Sans, sans-serif;font-size:13px;font-weight:normal;padding-bottom:5px;'>"+d.article.byline+"</p><p class='shortStory' style='font-family:Open Sans, sans-serif;font-size:12px;font-weight:normal;'>"+a+"</p>",items:[{itemId:"sharing",top:-20,right:0,defaults:{style:"float:right;",height:30,width:30}}]});d.headlineTextSize=28;e.element.on({painted:function(){if(!d.paintedTitle){var f=e.element.down(".sectionText").dom.clientHeight+e.element.down(".headlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".bylineText").dom.clientHeight;var j=$(this.element.dom).height()-f;e.element.down(".shortStory").dom.style.maxHeight=(j-(j%14)-26)+"px";if(e.element.down(".bylineText").dom.clientHeight+e.element.down(".bylineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".bylineText").dom.style.visibility="hidden";d.bylineHidden=true}if(e.element.down(".subheadlineText").dom.clientHeight+e.element.down(".subheadlineText").dom.offsetTop>=$(this.element.dom).height()-20){e.element.down(".subheadlineText").dom.style.visibility="hidden";d.subheadline=true}var h=false;while(!h){var g=d.titleContainer.element.down(".sectionText").dom.clientHeight+d.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(g>$(d.element.dom).height()){d.headlineTextSize=d.headlineTextSize-4;$(d.titleContainer.element.down(".headlineText").dom).css("font-size",d.headlineTextSize+"px")}else{h=true;break}}d.paintedTitle=true}},scope:d});d.titleContainer.add(e);if(d.article.body!=null){if(d.article.body.indexOf("<p>")!=-1){d.article.body=d.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}}if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}d.titleContainer.add(Ext.create("Ext.Container",{itemId:"articleBody",cls:"articleText",width:"100%",html:d.article.body,style:"overflow:hidden;font-size:"+b+"px;font-weight:normal;font-family:Open Sans, sans-serif;",padding:5,flex:1,hidden:true,overflow:"hidden",layout:{type:"vbox"}}))},resize:function(){var f=this;var g=f.titleContainer.getComponent("title");var c=false;var e=false;while(!e){if(f.titleContainer.element.down(".sectionText")!=null||f.titleContainer.element.down(".headlineText")){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;if(b>$(f.element.dom).height()){f.headlineTextSize=f.headlineTextSize-4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",f.headlineTextSize+"px")}else{c=true;e=true;break}}else{e=true}}if(f.hasImage){if(c){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;while(c){if(b<$(f.element.dom).height()){if(f.headlineTextSize+4<=20){f.headlineTextSize+=4;$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize)+"px");b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20}else{c=false;break}}else{$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize-4)+"px");c=false;break}}}}else{if(c){var b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20;while(c){if(b<$(f.element.dom).height()){if(f.headlineTextSize+4<=28){f.headlineTextSize+=4;console.log(f.headlineTextSize);$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize)+"px");b=f.titleContainer.element.down(".sectionText").dom.clientHeight+f.titleContainer.element.down(".headlineText").dom.clientHeight+20}else{c=false;break}}else{$(f.titleContainer.element.down(".headlineText").dom).css("font-size",(f.headlineTextSize-4)+"px");f.headlineTextSize-=4;c=false;break}}}}if(g!=null){var j=g.element.down(".sectionText").dom.clientHeight+g.element.down(".headlineText").dom.clientHeight+g.element.down(".subheadlineText").dom.clientHeight+g.element.down(".bylineText").dom.clientHeight;var h=$(this.element.dom).height()-j;g.element.down(".shortStory").dom.style.maxHeight=(h-(h%14)-26)+"px";if(parseFloat(g.element.down(".bylineText").dom.clientHeight)+parseFloat(g.element.down(".bylineText").dom.offsetTop)>=$(this.element.dom).height()-20){g.element.down(".bylineText").dom.style.visibility="hidden";f.bylineHidden=true}else{g.element.down(".bylineText").dom.style.visibility="";f.bylineHidden=false}if(parseFloat(g.element.down(".subheadlineText").dom.clientHeight)+parseFloat(g.element.down(".subheadlineText").dom.offsetTop)>=$(this.element.dom).height()-20){g.element.down(".subheadlineText").dom.style.visibility="hidden";f.subheadlineHidden=true}else{g.element.down(".subheadlineText").dom.style.visibility="";f.subheadlineHidden=false}}if(f.hasImage){if(f.imageAspect){var d=$(f.element.dom).height()/f.image.naturalHeight;var a=f.image.naturalWidth*d;if(a>$(f.element.dom).width()/2){f.imageContainer.element.dom.style.backgroundSize="50%";f.imageContainer.element.dom.style.backgroundPosition="0% 50%"}else{f.imageContainer.element.dom.style.backgroundSize=" auto 100%";f.imageContainer.element.dom.style.backgroundPosition="0% 0%"}}}},setupSharing:function(f){var h=this;if(f){h.sharingImage.removeAll()}else{h.sharingContainer.removeAll()}var d=Ext.getStore("SettingStore");var a=d.data.items[0].raw.sharing;if(h.hasImage){var e=Ext.create("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",{padding:5,images:h.article.images,article:h.article});h.sharingImage.add(e);var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"white",tile:h});h.sharingImage.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"white",tile:h});h.sharingImage.add(k)}else{var b=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"decrease",color:"black",tile:h});h.sharingContainer.add(b);var k=Ext.create("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",{type:"increase",color:"black",tile:h});h.sharingContainer.add(k)}if(a.pinterest!=null){if(f){var j=a.pinterest.icon;var c=h.sharingImage}else{var j=a.pinterest.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.pinterest.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.googlePlus!=null){if(f){var j=a.googlePlus.icon;var c=h.sharingImage}else{var j=a.googlePlus.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.googlePlus.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.linkedIn!=null){if(f){var j=a.linkedIn.icon;var c=h.sharingImage}else{var j=a.linkedIn.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.linkedIn.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.twitter!=null){if(f){var j=a.twitter.icon;var c=h.sharingImage}else{var j=a.twitter.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.twitter.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.facebook!=null){if(f){var j=a.facebook.icon;var c=h.sharingImage}else{var j=a.facebook.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.facebook.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}if(a.email!=null){if(f){var j=a.email.icon;var c=h.sharingImage}else{var j=a.email.iconDark;var c=h.sharingContainer}var g=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:j,link:a.email.link,message:h.article.headline,padding:3,cls:"articleViewBtn"});c.add(g)}},onTap:function(j){var l=this;var n=l.titleContainer.getComponent("title");var p=false;if(p&&l.sectionStr.indexOf("LIVE NEWS")==-1){l.fireEvent("articleClick",l.article,l.article.guid)}else{if(p&&l.sectionStr.indexOf("LIVE NEWS")!=1){l.fireEvent("liveArticleClick",l.article)}else{if(!l.hasImage&&!l.expand){if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}}clearInterval(l.timer);if(!l.expand){l.fireEvent("tileTapped",l);l.titleContainer.setPadding(40);if(l.titleContainer.getComponent("title")!=null){var h=l.element.down(".bylineText");if(h!=null){$(h.dom).attr("class","byline");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px")}var b=l.element.down(".headlineText");if(b!=null){$(b.dom).attr("class","headline");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px")}var k=l.element.down(".subheadlineText");if(k!=null){$(k.dom).attr("class","subheadline");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px")}var o=l.element.down(".sectionText");if(o!=null){$(o.dom).attr("class","section");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px")}}if(l.article.body.indexOf("<p>")!=-1){l.article.body=l.article.body.replace(/<p>/g,"<p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;margin-bottom:8px;'>")}if(l.hasImage){l.articlePop=Ext.create("Ext.Container",{height:"100%",width:"100%",style:"background-color:#929292",overflow:"scroll",layout:{type:"vbox"},scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"image",width:"100%",height:(l.imageContainer.element.dom.scrollHeight*1.6),cls:"backgroundImage aspectfill"},{itemId:"title",width:"100%",style:"color:white;background-color:#929292",height:"auto",padding:5,html:"<p class='section' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:bold;'>"+l.sectionStr+"</p><p class='headline' style='font-family:Open Sans, sans-serif;font-size:32px;font-weight:bold;padding-top:5px;padding-bottom:5px;'>"+l.article.headline+"</p><p class='subheadline' style='font-family:Open Sans, sans-serif;font-size:20px;font-weight:bold;padding-bottom:5px;'>"+l.article.subHeadline+"</p><p class='byline' style='font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-bottom:5px;>"+l.article.byline+"</p><p style='font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;'>"+l.article.body+"</p>",items:[{itemId:"sharing",top:20,right:40,defaults:{style:"float:right;",height:30,width:30}}]}]});var q=l.articlePop.getComponent("title").element.down("div");q.dom.style.padding="40px";l.sharingImage=l.articlePop.getComponent("title").getComponent("sharing");l.setupSharing(true);l.sharingImage.show();l.imageContainer.hide();l.titleContainer.hide();l.articlePop.getComponent("image").element.dom.style.backgroundImage="url('"+l.firstImage.url+"')";if(l.imageAspect){l.articlePop.getComponent("image").element.dom.style.backgroundSize="contain";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="center"}else{l.articlePop.getComponent("image").element.dom.style.backgroundSize="cover";l.articlePop.getComponent("image").element.dom.style.backgroundPosition="50% 0%"}l.add(l.articlePop);if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var a=localStorage.getItem("bodyFontSize"+publicationguid)}else{var a=16}$(".articleText").css("font-size",a+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}$(".byline").css("font-size",d+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var m=localStorage.getItem("headlineFontSize"+publicationguid)}else{var m=32}$(".headline").css("font-size",m+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var g=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var g=20}$(".subheadline").css("font-size",g+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}$(".section").css("font-size",c+"px");l.articlePop.getComponent("title").element.dom.style.position="relative";l.articlePop.getComponent("title").element.down("div").dom.style.width="758px";if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){l.articlePop.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.articlePop.items.items[0].element.dom.clientHeight+l.articlePop.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.articlePop.getScrollable().getScroller().on({scroll:function(u){var t=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);var s=l.articlePop.getScrollable().getScroller().position.y;var r=l.articlePop.getComponent("image").element.dom.style.height.substring(0,l.articlePop.getComponent("image").element.dom.style.height.length-2);if(((t-s)/r)>0){l.articlePop.getComponent("image").element.dom.style.top=(s)+"px";l.articlePop.getComponent("image").element.dom.style.opacity=((t-s)/r)}}})}}else{if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){l.titleContainer.setScrollable(false);l.desktopScroll=l.element.down(".x-scroll-view");if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="scroll";l.desktopScroll.dom.style.zIndex="14";if(Ext.browser.is.IE){if(l.desktopScroll.down(".x-scroll-container")!=null){$(l.element.dom).on("animationend",function(){if(l.desktopScroll.down(".x-scroll-indicator-dark")!=null){l.desktopScroll.down(".x-scroll-indicator-dark").dom.style.display="none"}l.desktopScroll.down(".x-scroll-container").dom.style.height=(l.titleContainer.items.items[0].element.dom.clientHeight+l.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"})}}l.stopPropFunction=function(r){r.stopPropagation()};l.element.dom.onmousewheel=l.stopPropFunction;l.element.dom.addEventListener("DOMMouseScroll",l.stopPropFunction)}}else{l.titleContainer.setScrollable(true);l.titleContainer.getScrollable().getScroller().setDirectionLock(true);var f=l.titleContainer.getScrollable().getScroller();f.container.dom.offsetParent.style.zIndex=14}l.sharingContainer=l.titleContainer.getComponent("title").getComponent("sharing");l.sharingContainer.show();l.setupSharing(false);l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="none";if(l.bylineHidden){console.log(l.bylineHidden);n.element.down(".bylineText").dom.style.visibility=""}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility=""}}l.element.dom.style.position="absolute";l.element.dom.style.zIndex=8;l.expand=true;l.element.dom.style.animation=l.expandAnim;l.element.dom.style.animationFillMode="forwards"}else{if(j.target.className.indexOf("x-scroll-view")==-1&&j.target.className.indexOf("fullStoryLink")==-1){if(l.hasImage){l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="20px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}l.articlePop.destroy();l.imageContainer.show();l.titleContainer.show();if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction)}}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}else{l.titleContainer.setPadding(10);if(l.sharingImage!=null){l.sharingImage.hide()}if(l.sharingContainer!=null){l.sharingContainer.hide()}if(l.titleContainer.getComponent("title")!=null){l.titleContainer.setScrollable(false);if(l.titleContainer.getComponent("title").innerHtmlElement.down("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").dom.style.fontSize="13px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").dom.style.fontSize="28px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").dom.style.fontSize="14px"}if(l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p")!=null){l.titleContainer.getComponent("title").innerHtmlElement.down("p").next("p").next("p").next("p").dom.style.fontSize="13px"}}var b=l.element.down(".headline");if(b!=null){$(b.dom).attr("class","headlineText")}var k=l.element.down(".subheadline");if(k!=null){$(k.dom).attr("class","subheadlineText")}var h=l.element.down(".byline");if(h!=null){$(h.dom).attr("class","bylineText")}var o=l.element.down(".section");if(o!=null){$(o.dom).attr("class","sectionText")}if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(l.desktopScroll!=null){l.desktopScroll.dom.style.overflowY="";l.element.dom.onmousewheel=null;l.element.dom.removeEventListener("DOMMouseScroll",l.stopPropFunction);if(Ext.browser.is.IE){l.desktopScroll.down(".x-scroll-container").dom.style.height=""}}}l.titleContainer.getComponent("title").element.down(".shortStory").dom.style.display="";if(l.bylineHidden){n.element.down(".bylineText").dom.style.visibility="hidden"}if(l.subheadlineHidden){n.element.down(".subheadlineText").dom.style.visibility="hidden"}if(l.titleContainer.getComponent("articleBody").isHidden()){l.titleContainer.getComponent("articleBody").show()}else{l.titleContainer.getComponent("articleBody").hide()}l.expand=false;l.element.dom.style.animation=l.shrinkAnim;setTimeout(function(){l.element.dom.style.zIndex=4},300)}}}}}},liveTap:function(){var a=this;window.open(a.article.url)}},0,["smallviewtilemed"],["component","container","panel","smallviewtilemed"],{component:true,container:true,panel:true,smallviewtilemed:true},["widget.smallviewtilemed"],0,[InfinityMobile.view.desktop,"SmallViewTileMed"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileWeather",Ext.Container,{config:{cls:"articlereaderitemweathertile",height:"100%",width:"100%",style:"float:left;z-index:3;background-color:#90A4B0;overflow:hidden;",items:[{itemId:"title",layout:"vbox",style:"position:absolute;top:0px;left:0px;z-index:10;",items:[{html:"<p class='.thirteen' style='color:white;font-family:Open Sans, sans-serif;font-size:13px;font-weight:bold;padding:20px 0px 0px 20px;'>WEATHER</p>"},{itemId:"location"},{html:"<p class='ten' style='color:white;font-family:Open Sans, sans-serif;font-size:10px;font-weight:normal;padding:5px 0px 0px 20px;'>Source: BBC Weather</p>"}]},{itemId:"toggle",layout:"hbox",padding:20,style:"position:absolute;top:0px;right:0px;z-index:10;",items:[{html:"<p style='color:white;font-size:13px;padding-right:5px;padding-top:0.2em;'>&deg;C</p>"},{cls:"toggle",itemId:"toggleField",xtype:"togglefield",style:"background:transparent;"},{html:"<p style='color:white;font-size:13px;padding-left:5px;padding-top:0.2em;'>&deg;F</p>"}]},{itemId:"weather",width:"100%",layout:"hbox"}]},initialize:function(){var l=this;if(l.config.weather!=null){l.weather=l.config.weather}if(l.config.title!=null){l.title=l.config.title}var n=l.getComponent("title");var q=n.getComponent("location");var p=l.getComponent("weather");var k=l.getComponent("toggle");l.toggle=k.getComponent("toggleField");l.currentUnit="C";q.setHtml("<p class='twentyFour' style='color:white;font-family:Open Sans, sans-serif;font-size:24px;font-weight:normal;padding:5px 0px 0px 20px;'>"+l.title+"</p>");var f=[];var d=[];var e=[];var b=[];var j=[];for(var g=0;g<l.weather.length;g++){var m=l.weather[g].content.split(",");f[g]=m[0].substring(m[0].indexOf(":")+2,m[0].indexOf("C"));d[g]=m[0].substring(m[0].indexOf("(")+1,m[0].indexOf("F"));e[g]=m[1].substring(m[1].indexOf(":")+2,m[1].indexOf("C"));b[g]=m[1].substring(m[1].indexOf("(")+1,m[1].indexOf("F"));var o=l.weather[g].title.split(",");if(g==0){var c="Today";var a="background-color:#91a4af;text-align:center;overflow-hidden;"}else{var c=o[0].substring(0,3);var a="background-color:#9fb0b9;text-align:center;overflow:hidden;"}var h=o[0].split(":");console.log(h[1].trim());switch(h[1].trim().toLowerCase()){case"light cloud":var r="../assets/weather/white-cloud-ic.png";break;case"white cloud":var r="../assets/weather/white-cloud-ic.png";break;case"heavy rain":var r="../assets/weather/rain-ic.png";break;case"light rain":var r="../assets/weather/rain-ic.png";break;case"light rain shower":var r="../assets/weather/rain-ic.png";break;case"heavy rain shower":var r="../assets/weather/rain-ic.png";break;case"sunny intervals":var r="../assets/weather/sun-cloud-ic.png";break;case"thick cloud":var r="../assets/weather/black-cloud-ic.png";break;case"sunny":var r="../assets/weather/sun-ic.png";break;case"clear sky":var r="../assets/weather/sun-ic.png";break}if(h[1].trim().indexOf("Thunder")!=-1){var r="../assets/weather/thunder-ic.png"}if(h[1].trim().indexOf("Ice")!=-1){var r="../assets/weather/ice-ic.png"}if(h[1].trim().indexOf("Snow")!=-1){var r="../assets/weather/snow-cloud-ic.png"}if(!parseInt(e[g].substring(0,e[g].length-1))){e[g]=""}else{e[g]+="C"}if(!parseInt(b[g].substring(0,e[g].length-1))){b[g]=""}else{b[g]+="F"}j[g]=Ext.create("Ext.Container",{itemId:"panel"+g,layout:"vbox",width:"33.33333%",height:$(l.element.dom).height()*4,style:a,items:[{height:75},{html:"<div style='text-align:center;'><p class='twentyFour' style='color:white;font-family:Open Sans, sans-serif;font-size:16px;font-weight:normal;padding:10px;'>"+c+"</p></div>"},{width:"100%",height:"15%",style:"background-image:url('"+r+"');background-position:center;background-repeat:no-repeat;background-size:contain;"},{html:"<div  style='text-align:center;'><p class='thirteen' style='color:white;font-family:Open Sans, sans-serif;font-size:11px;font-weight:normal;'>"+h[1]+"</p></div>"},{itemId:"temp",html:"<div  style='text-align:center;'><p class='fifty' style='color:white;font-family:Open Sans, sans-serif;font-size:15px;font-weight:normal;padding-top:5px;'>"+f[g]+"C</p></div>"}]});p.add(j[g])}l.element.on({painted:function(){l.height=$(l.element.dom).height()},scope:l});l.toggle.on({change:function(){if(l.toggle.getValue()==0){for(var s=0;s<j.length;s++){if(j[s].getComponent("temp")!=null){j[s].getComponent("temp").setHtml("<div style='text-align:center;'><p class='fifty' style='color:white;font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-top:5px;'>"+f[s]+"C</p></div>")}if(j[s].getComponent("minTemp")!=null){j[s].getComponent("minTemp").setHtml("<div style='text-align:center;'><p class='eighteen' style='color:#e1e1e1;font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;'>"+e[s]+"</p></div>")}}}else{for(var s=0;s<j.length;s++){if(j[s].getComponent("temp")!=null){j[s].getComponent("temp").setHtml("<div style='text-align:center;'><p class='fifty'  style='color:white;font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;padding-top:5px;'>"+d[s]+"F</p></div>")}if(j[s].getComponent("minTemp")!=null){j[s].getComponent("minTemp").setHtml("<div style='text-align:center;'><p class='eighteen' style='color:#e1e1e1;font-family:Open Sans, sans-serif;font-size:18px;font-weight:normal;'>"+b[s]+"</p></div>")}}}}})},resize:function(){var a=this;console.log(a.height);if($(a.element.dom).height()>a.height){console.log("LARGER");a.height=$(a.element.dom).height()}else{console.log("SMALLER");a.height=$(a.element.dom).height()}}},0,["smallviewtileweather"],["component","container","smallviewtileweather"],{component:true,container:true,smallviewtileweather:true},["widget.smallviewtileweather"],0,[InfinityMobile.view.desktop,"SmallViewTileWeather"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SmallViewTileWeatherContainer",Ext.Panel,{config:{style:"float:left;z-index:6;padding:5px;",layout:"vbox"},initialize:function(){var a=this;a.expand=false;if(a.config.weather!=null){a.weather=a.config.weather}a.setStyle("height:52.5%;width:512px;overflow:hidden;padding:5px;");a.height=52.5;if(settings.dynamic.adverts!=null){if(settings.dynamic.adverts.bannerAd!=null){a.setStyle("height:72.5%;width:512px;overflow:hidden;padding:5px;");a.height=72.5}}a.setWeatherTile()},setWeatherTile:function(){var a=this;var c=[];var b;$.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&q="+encodeURIComponent(a.weather),dataType:"json",success:function(d){$.each(d.responseData.feed.entries,function(f,g){c[c.length]=g;b=d.responseData.feed.title.substring(d.responseData.feed.title.indexOf("for")+4,d.responseData.feed.title.length)});var e=Ext.create("InfinityMobile.view.desktop.SmallViewTileWeather",{weather:c,title:b,expandAnim:"expandSmallViewTopLeft 0.2s ease-in"});a.add(e)}})}},0,["smallviewtileweathercontainer"],["component","container","panel","smallviewtileweathercontainer"],{component:true,container:true,panel:true,smallviewtileweathercontainer:true},["widget.smallviewtileweathercontainer"],0,[InfinityMobile.view.desktop,"SmallViewTileWeatherContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SectionListOverlay",InfinityMobile.view.Overlay,{config:{width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{itemId:"toolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",padding:"20",layout:"vbox",flex:1,items:[{id:"itemsContainer",flex:1,defaults:{width:145,margin:"0 8 16 7"}}]}]},initialize:function(){var b=this;var a=b.getComponent("toolBar");b.toolBarClose=a.getComponent("toolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var c=b.getComponent("bodyContainer");b.itemsContainer=c.getComponent("itemsContainer");b.title=a.getComponent("title");b.title.setHtml(language.sectionList.sectionList);b.handleKeyDown();b.setCloseListener();if(navigator.maxTouchPoints){b.itemsContainer.setScrollable({direction:"vertical",directionLock:true})}else{b.itemsContainer.setStyle({overflowY:"scroll"})}if(settings.newsday!=null){a.element.dom.style.borderTopLeftRadius="";a.element.dom.style.borderTopRightRadius="";b.setStyle({borderRadius:"0px"});b.element.down("div").dom.style.borderRadius="0px"}b.fireEvent("initialized",b,b.itemsContainer)},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},setCloseListener:function(){var b=this;b.toolBarClose.element.on("tap",function(){window.onkeydown=b.keyDownFunction;b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer",a);InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["sectionlistoverlay"],["component","container","panel","overlay","sectionlistoverlay"],{component:true,container:true,panel:true,overlay:true,sectionlistoverlay:true},["widget.sectionlistoverlay"],0,[InfinityMobile.view.desktop,"SectionListOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.SectionListOverlayItem",Ext.Container,{config:{height:40,style:"float:left;border:1px solid grey; overflow:hidden",cls:"sectionlistitem",height:175,items:[{itemId:"itemLabel",cls:"thumbInfo",bottom:0,width:"100%",padding:"5 0 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initialize:function(){var a=this;if(a.config.sectionListText!=null){a.sectionListText=a.config.sectionListText;a.setText()}if(a.config.sectionListPageNumber!=null){a.sectionListPageNumber=a.config.sectionListPageNumber;a.setImage();a.setClickEvent()}},setText:function(){var a=this;a.editionPageLabel=a.getComponent("itemLabel");a.editionPageLabel.setHtml(a.sectionListText)},setImage:function(){var b=this;var a="";if(typeof latestLM!="undefined"){a="&lm="+latestLM}var c="https://edition.pagesuite-professional.co.uk//get_image.aspx?w=280&eid="+editionguid+"&pnum="+b.sectionListPageNumber+a;b.setHtml("<img style='width:100%' src='"+c+"' />")},setClickEvent:function(){var a=this;a.element.on("tap",function(){a.fireEvent("sectionListPage",a,a.sectionListPageNumber)})}},0,["sectionlistoverlayitem"],["component","container","sectionlistoverlayitem"],{component:true,container:true,sectionlistoverlayitem:true},["widget.sectionlistoverlayitem"],0,[InfinityMobile.view.desktop,"SectionListOverlayItem"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ZonesOverlay",InfinityMobile.view.Overlay,{config:{style:"padding:0px;",zindex:3,layout:"vbox",items:[{itemId:"toolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em;",items:[{itemId:"title",top:10,left:10},{itemId:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"bodyContainer",padding:25,items:[{id:"itemsContainer",style:"text-align:center;overflow-y:auto;max-height:75vh;max-width:700px; min-height:200px;",defaults:{width:150,height:175,margin:"0 8 16 7",style:"float:left;"}}]}]},initialize:function(){var b=this;var a=b.getComponent("toolBar");b.toolBarClose=a.getComponent("toolBarClose");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.bodyContainer=b.getComponent("bodyContainer");b.itemsContainer=b.bodyContainer.getComponent("itemsContainer");b.title=a.getComponent("title");if(b.isUpper(language.menu.zones)){b.title.setHtml(language.menu.zones[0].toUpperCase()+language.menu.zones.substring(1,language.menu.zones.length).toLowerCase())}else{b.title.setHtml(language.menu.zones)}b.handleKeyDown();b.setCloseListener();b.fireEvent("initialized",b,b.itemsContainer);if(settings.newsday!=null){toolbar.element.dom.style.borderTopLeftRadius="";toolbar.element.dom.style.borderTopRightRadius="";b.setStyle({borderRadius:"0px"});b.element.down("div").dom.style.borderRadius="0px"}if(navigator.maxTouchPoints){b.itemsContainer.element.dom.style.webkitOverlowScrolling="touch"}},isUpper:function(d){var b=this;var c=true;for(var a=0;a<d.length;a++){if(d[a]==d[a].toLowerCase()){c=false}}return c},setWidthOfContainer:function(){var c=this;var f=40;var e=145+f;var a=0;var b=c.itemsContainer.getItems().items;var d=b.length/4;if(d>1){a=e*4}else{a=e*b.length}c.setWidth(a);c.element.dom.style.visibility="visible"},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},setCloseListener:function(){var b=this;b.toolBarClose.element.on("tap",function(){window.onkeydown=b.keyDownFunction;b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["zonesoverlay"],["component","container","panel","overlay","zonesoverlay"],{component:true,container:true,panel:true,overlay:true,zonesoverlay:true},["widget.zonesoverlay"],0,[InfinityMobile.view.desktop,"ZonesOverlay"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ZonesOverlayItem",Ext.Container,{config:{style:"float:left;border:1px solid grey; overflow:hidden",cls:"sectionlistitem",items:[{itemId:"itemLabel",cls:"thumbInfo",bottom:0,width:"100%",padding:"5 0 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initialize:function(){var a=this;if(a.config.zoneItem!=null){a.zoneItem=a.config.zoneItem;a.setText();a.setImage();a.setClickEvent()}},setText:function(){var a=this;a.editionPageLabel=a.getComponent("itemLabel");a.editionPageLabel.setHtml(a.zoneItem.name)},setImage:function(){var a=this;var c="";if(a.zoneItem.editionGuid!=null&&a.zoneItem.editionGuid!=""){c="&eid="+a.zoneItem.editionGuid}else{c="&pbid="+a.zoneItem.guid}var b="https://edition.pagesuite-professional.co.uk//get_image.aspx?w=280&"+c;a.setHtml("<img style='width:100%' src='"+b+"' />")},setClickEvent:function(){var a=this;a.element.on("tap",function(){a.fireEvent("zoneEdition",a,a.zoneItem.editionGuid,a.zoneItem.guid)})}},0,["zonesoverlayitem"],["component","container","zonesoverlayitem"],{component:true,container:true,zonesoverlayitem:true},["widget.zonesoverlayitem"],0,[InfinityMobile.view.desktop,"ZonesOverlayItem"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderArchive",InfinityMobile.view.Overlay,{config:{id:"archivecontainer",width:700,height:"100%",style:"padding:0px;max-height:700px;",items:[{id:"archiveToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{id:"archiveToolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"archiveBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"archiveContainerText",margin:"0 0 20px 0"},{itemId:"archiveMonthContainerHorizontal",layout:"hbox",items:[{html:"<img src='https://media.pagesuite.com/psapps/images/default/LeftArrow_Icon.png' style='width:20px' />"},{itemId:"archiveMonthsContainer",height:30,flex:1,layout:"hbox",margin:"0 15px 0 15px",padding:"0 0 10px 0",monthdirection:"horizontal",scrollable:{direction:"horizontal",directionLock:true},defaults:{width:100,height:20,margin:"0 20px 0 0",padding:0,style:"font-weight:bold",type:"shortDate"},items:[]},{html:"<img src='https://media.pagesuite.com/psapps/images/default/RightArrow_Icon.png' style='width:20px' />"}]},{layout:"hbox",itemId:"archiveItemsGlobalContainer",items:[{itemId:"archiveMonthsContainer",width:180,height:"100%",monthdirection:"vertical",style:"overflow-y:scroll"},{id:"archiveItemsContainer",flex:1,defaults:{width:145,margin:"0 8 16 7",cls:"archiveitemphone pointerCursor"}}]}]}]},initialize:function(){var g=this;var c=g.getComponent("archiveToolBar");g.archiveToolBarClose=c.getComponent("archiveToolBarClose");c.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});g.title=c.getComponent("title");g.title.setHtml(language.archive.archive);var j=g.getComponent("archiveBodyContainer");g.archiveContainerText=j.getComponent("archiveContainerText");g.archiveContainerText.setHtml(language.archive.archiveContainerText);var d=j.getComponent("archiveItemsGlobalContainer");g.archiveItemsContainer=d.getComponent("archiveItemsContainer");var h=j.getComponent("archiveMonthContainerHorizontal");var f=h.getComponent("archiveMonthsContainer");var e=d.getComponent("archiveMonthsContainer");var a=e;if(settings.menu.archiveUsesTabs!=null){if(settings.menu.archiveMonthDirection.toLowerCase()!=null&&settings.menu.archiveMonthDirection.toLowerCase()=="horizontal"){a=f}if(settings.menu.archiveMonthDirection!=null){if(settings.menu.archiveMonthDirection=="Vertical"){g.archiveItemsContainer.setDefaults({width:135,margin:"0 8 16 7",cls:"archiveitemphone pointerCursor"})}}}if(a==f){e.hide()}else{h.hide()}g.archiveMonthsContainer=a;if(settings.tracking!=null){var b=settings.tracking.trackingType;if(b=="DA"){trackDaPageView("Archive","Digital Edition")}}g.handleKeyDown();g.setCloseListener();g.fireEvent("initialized",g);g.archiveItemsContainer.element.down(".x-inner").dom.style.width="100%";g.archiveItemsContainer.element.down(".x-inner").dom.style.display="inline";g.archiveItemsContainer.element.dom.style.overflowY="scroll";g.resizeFunc=function(){if($(g.element.dom).height>=700){d.element.dom.style.height="560px";g.archiveItemsContainer.element.dom.style.height="560px"}else{if(settings.menu.archiveUsesTabs!=null){if(settings.menu.archiveMonthDirection!=null){if(settings.menu.archiveMonthDirection=="Vertical"){d.element.dom.style.height=($(g.element.dom).height()-$(g.archiveContainerText.element.dom).height()-$(h.element.dom).height()-80)+"px";g.archiveItemsContainer.element.dom.style.height=($(g.element.dom).height()-$(g.archiveContainerText.element.dom).height()-$(h.element.dom).height()-80)+"px"}else{d.element.dom.style.height=($(g.element.dom).height()-$(g.archiveContainerText.element.dom).height()-80)+"px";g.archiveItemsContainer.element.dom.style.height=($(g.element.dom).height()-$(g.archiveContainerText.element.dom).height()-80)+"px"}}else{d.element.dom.style.height=($(g.element.dom).height()-$(g.archiveContainerText.element.dom).height()-80)+"px";g.archiveItemsContainer.element.dom.style.height=($(g.element.dom).height()-$(g.archiveContainerText.element.dom).height()-80)+"px"}}else{d.element.dom.style.height=($(g.element.dom).height()-$(g.archiveContainerText.element.dom).height()-80)+"px";g.archiveItemsContainer.element.dom.style.height=($(g.element.dom).height()-$(g.archiveContainerText.element.dom).height()-80)+"px"}}};g.on({painted:g.resizeFunc});Ext.Viewport.on({resize:g.resizeFunc});if(settings.newsday!=null){c.element.dom.style.borderTopLeftRadius="";c.element.dom.style.borderTopRightRadius="";g.setStyle({borderRadius:"0px"});g.element.down("div").dom.style.borderRadius="0px"}},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},setCloseListener:function(){var b=this;b.archiveToolBarClose.element.on("tap",function(){window.onkeydown=b.keyDownFunction;b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.archiveToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.fireEvent("close",a)},hideMonthContainer:function(){var a=this;console.log("HIDING MONTH CONTAINER");a.archiveMonthsContainer.hide()},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["readerarchive"],["component","container","panel","overlay","readerarchive"],{component:true,container:true,panel:true,overlay:true,readerarchive:true},["widget.readerarchive"],0,[InfinityMobile.view.desktop,"ReaderArchive"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderDownload",InfinityMobile.view.Overlay,{config:{width:700,height:"100%",style:"padding:0px;max-height:700px;",zindex:3,layout:"vbox",searchTerm:"",items:[{itemId:"downloadToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"downloadToolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"downloadBody",flex:1,padding:25,layout:"vbox",items:[{itemId:"bodyText"},{itemId:"downloadButtonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"downloadSelectAll",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]},{width:25},{itemId:"downloadSelectNone",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]},{width:25},{itemId:"download",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]}]},{itemId:"downloadItems",flex:1,defaults:{width:145,margin:"0 6 10 6"}}]}]},initialize:function(){var c=this;var e=c.getComponent("downloadToolBar");c.downloadToolBarClose=e.getComponent("downloadToolBarClose");e.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var b=c.getComponent("downloadBody");var a=b.getComponent("downloadButtonsContainer");c.downloadSelectAll=a.getComponent("downloadSelectAll");c.downloadSelectNone=a.getComponent("downloadSelectNone");c.download=a.getComponent("download");c.title=e.getComponent("title");c.title.setHtml(language.download.download);c.bodyContent=b.getComponent("bodyText");c.bodyContent.setHtml(language.download.downloadContainerText);c.downloadSelectAll.getComponent("btnText").setHtml(language.download.downloadSelectAll);c.downloadSelectNone.getComponent("btnText").setHtml(language.download.downloadSelectNone);c.download.getComponent("btnText").setHtml(language.download.download);c.downloadSelectAll.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.downloadSelectNone.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.download.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.handleKeyDown();c.setCloseListener();c.setDownloadAllListener();c.setDownloadNoneListener();c.setDownloadListener();if(settings.tracking!=null){var d=settings.tracking.trackingType;if(d=="DA"){trackDaPageView("Downloads","Digital Edition")}}c.downloadItemsContainer=b.getComponent("downloadItems");c.loadPages();c.downloadItemsContainer.element.down(".x-inner").dom.style.width="100%";c.downloadItemsContainer.element.down(".x-inner").dom.style.display="inline";c.downloadItemsContainer.element.dom.style.overflowY="scroll";c.downloadItemsContainer.element.dom.style.overflowX="hidden";if(settings.newsday!=null){e.element.dom.style.borderTopLeftRadius="";e.element.dom.style.borderTopRightRadius="";c.setStyle({borderRadius:"0px"});c.element.down("div").dom.style.borderRadius="0px"}},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},setCloseListener:function(){var b=this;b.downloadToolBarClose.element.on("tap",function(){window.onkeydown=b.keyDownFunction;b.fireEvent("close",b)});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.downloadToolBarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setDownloadAllListener:function(){var a=this;a.downloadSelectAll.element.on("tap",function(){a.fireEvent("selectAll",a)})},setDownloadNoneListener:function(){var a=this;a.downloadSelectNone.element.on("tap",function(){a.fireEvent("selectNone",a)})},setDownloadListener:function(){var a=this;a.download.element.on("tap",function(){a.fireEvent("download",a)})},loadPages:function(){var a=this;a.fireEvent("loadPages",a,a.downloadItemsContainer)},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["download"],["component","container","panel","overlay","download"],{component:true,container:true,panel:true,overlay:true,download:true},["widget.download"],0,[InfinityMobile.view.desktop,"ReaderDownload"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderBookmark",InfinityMobile.view.Overlay,{config:{itemId:"bookmarkcontainer",width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{itemId:"bookmarkToolBar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"bookmarkToolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"bookmarkBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"bookmarkHelperText"},{itemId:"bookmarkAddContainer",layout:{type:"hbox",align:"stretch",pack:"middle"},height:35,margin:"10px 0",items:[{flex:1,itemId:"textInput",html:"<input class='bookmarkName' type='text' placeholder='' style='width:100%; height:35px; padding-left:10px' />"},{width:20},{itemId:"bookmarkAddButton",cls:"pointerCursor btn",width:150,layout:{type:"hbox",align:"middle",pack:"center"},items:[{itemId:"btnText"}]}]},{itemId:"bookmarksContainer",flex:1,defaults:{width:194,margin:10}}]}]},initialize:function(){var c=this;var b=c.getComponent("bookmarkToolBar");b.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});c.handleKeyDown();c.closeButton=b.getComponent("bookmarkToolBarClose");c.setCloseButtonListener();var d=c.getComponent("bookmarkBodyContainer");c.helperTextContainer=d.getComponent("bookmarkHelperText");var a=d.getComponent("bookmarkAddContainer");c.addBookmarkTextBox=a.element.down(".bookmarkName").dom;c.addBookmarkButton=a.getComponent("bookmarkAddButton");if(c.addBookmarkTextBox!=null){c.addBookmarkTextBox.addEventListener("touchstart",function(){try{c.addBookmarkTextBox.focus()}catch(e){console.error("[ReaderBookmark]: Error Caught\n",e)}})}c.title=b.getComponent("title");c.title.setHtml(language.bookmarks.bookmarks);c.helperTextContainer.setHtml(language.bookmarks.bookmarksContainerText);c.inputPanel=a.getComponent("textInput");c.input=c.inputPanel.element.down(".bookmarkName").dom;$(c.input).attr("placeholder",language.bookmarks.name);c.addBookmarkButton.getComponent("btnText").setHtml(language.bookmarks.add);c.setAddButtonListener();c.bookmarksContainer=d.getComponent("bookmarksContainer");a.element.down(".bookmarkName").on("tap",function(){if(this.focus!=null){this.focus()}});c.addBookmarkButton.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});c.fireEvent("loadBookmarks",c);c.bookmarksContainer.element.down(".x-inner").dom.style.width="100%";c.bookmarksContainer.element.down(".x-inner").dom.style.display="inline";c.bookmarksContainer.element.dom.style.overflowY="scroll";if(settings.newsday!=null){b.element.dom.style.borderTopLeftRadius="";b.element.dom.style.borderTopRightRadius="";c.setStyle({borderRadius:"0px"});c.element.down("div").dom.style.borderRadius="0px"}},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},setCloseButtonListener:function(){var b=this;b.closeButton.element.on("tap",function(){window.onkeydown=b.keyDownFunction;b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeButton.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setAddButtonListener:function(){var a=this;console.log(a.addBookmarkButton);a.addBookmarkButton.element.on("tap",function(){a.fireEvent("addBookmark",a)})},close:function(){var a=this;a.fireEvent("close",a)},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["readerbookmark"],["component","container","panel","overlay","readerbookmark"],{component:true,container:true,panel:true,overlay:true,readerbookmark:true},["widget.readerbookmark"],0,[InfinityMobile.view.desktop,"ReaderBookmark"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.PrintMenu",InfinityMobile.view.Overlay,{config:{width:700,height:"100%",style:"padding:0px;max-height:700px;",layout:"vbox",items:[{itemId:"toolbar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"toolbarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"body",flex:1,padding:25,layout:"vbox",items:[{itemId:"desc"},{itemId:"buttonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"selectAll",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]},{width:25},{itemId:"selectNone",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]},{width:25},{itemId:"print",cls:"pointerCursor btn",width:150,items:[{itemId:"btnText"}]}]},{itemId:"printItems",flex:1,defaults:{width:145,margin:"0 6 10 6"}}]}]},initialize:function(){var d=this;var c=d.getComponent("toolbar");d.toolbarClose=c.getComponent("toolbarClose");c.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var a=d.getComponent("body");var b=a.getComponent("buttonsContainer");d.selectAll=b.getComponent("selectAll");d.selectNone=b.getComponent("selectNone");d.print=b.getComponent("print");d.handleKeyDown();d.setCloseListener();d.setSelectAllListener();d.setSelectNoneListener();d.setPrintListener();d.title=c.getComponent("title");d.title.setHtml(language.print.print);d.desc=a.getComponent("desc");d.desc.setHtml(language.print.printContainerText);d.selectAll.getComponent("btnText").setHtml(language.print.selectAll);d.selectNone.getComponent("btnText").setHtml(language.print.printSelectNone);d.print.getComponent("btnText").setHtml(language.print.print);d.printItemsContainer=a.getComponent("printItems");d.loadPages();d.printItemsContainer.element.down(".x-inner").dom.style.width="100%";d.printItemsContainer.element.down(".x-inner").dom.style.display="inline";d.printItemsContainer.element.dom.style.overflowY="scroll";d.printItemsContainer.element.dom.style.overflowX="hidden";if(settings.newsday!=null){c.element.dom.style.borderTopLeftRadius="";c.element.dom.style.borderTopRightRadius="";d.setStyle({borderRadius:"0px"});d.element.down("div").dom.style.borderRadius="0px"}},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},setCloseListener:function(){var b=this;b.toolbarClose.element.on("tap",function(){window.onkeydown=b.keyDownFunction;b.fireEvent("close",b)});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolbarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},setSelectAllListener:function(){var a=this;a.selectAll.element.on("tap",function(){a.fireEvent("selectAll",a)});a.selectAll.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},setSelectNoneListener:function(){var a=this;a.selectNone.element.on("tap",function(){a.fireEvent("selectNone",a)});a.selectNone.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},setPrintListener:function(){var a=this;a.print.element.on("tap",function(){a.fireEvent("print",a)});a.print.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},loadPages:function(){var a=this;a.fireEvent("loadPages",a,a.printItemsContainer)},hide:function(){var a=this;window.onkeydown=a.keyDownFunction;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["printmenu"],["component","container","panel","overlay","printmenu"],{component:true,container:true,panel:true,overlay:true,printmenu:true},["widget.printmenu"],0,[InfinityMobile.view.desktop,"PrintMenu"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ClippingOptionsMenu",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:700,height:"100%",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;max-height:650px;",fullscreen:true,zIndex:999998,items:[{id:"clippingOptionsToolBar",height:40,items:[{itemId:"title",top:10,left:10},{id:"clippingOptionsToolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0"},{itemId:"clippingsContainer",style:"border: 1px solid #e6e6e6;max-height:400px;",defaults:{width:198,height:150,margin:"7 8 16 7",cls:"archiveitemphone pointerCursor"}},{itemId:"buttonsContainer",layout:"hbox",height:60,items:[{itemId:"previewBtn",flex:1,cls:"pointerCursor btn",margin:"15 5 5 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/preview-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Preview",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"downloadBtn",flex:1,cls:"pointerCursor btn",margin:"15 5 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/downloads-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Save",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"printBtn",flex:1,cls:"pointerCursor btn",margin:"15 5 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/print-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Print",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"shareBtn",flex:2,cls:"pointerCursor btn",margin:"15 0 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/share-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Share",margin:5,style:"font-size:11pt;"}]}]}]}]},initialize:function(){var b=this;b.clippingsToolbar=b.getComponent("clippingOptionsToolBar");b.clippingsToolbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.closeBtn=b.clippingsToolbar.getComponent("clippingOptionsToolBarClose");b.clippingsBody=b.getComponent("clippingOptionsBodyContainer");b.clippingsContainer=b.clippingsBody.getComponent("clippingsContainer");b.buttonsContainer=b.clippingsBody.getComponent("buttonsContainer");b.previewBtn=b.buttonsContainer.getComponent("previewBtn");b.downloadBtn=b.buttonsContainer.getComponent("downloadBtn");b.printBtn=b.buttonsContainer.getComponent("printBtn");b.shareBtn=b.buttonsContainer.getComponent("shareBtn");b.title=b.clippingsToolbar.getComponent("title");b.title.setHtml(language.clippings.clippingsOptions);b.clippingOptionsContainerText=b.clippingsBody.getComponent("clippingOptionsContainerText");b.clippingOptionsContainerText.setHtml("<p style='font-size:16px;'>"+language.clippings.ClippingsOptionsText+"</p><br /><p style='font-size:12px;color:#444444'>"+language.clippings.clippingsPleaseNote+"</p>");b.previewBtn.getComponent("Preview").setHtml(language.clippings.preview);b.downloadBtn.getComponent("Save").setHtml(language.clippings.save);b.printBtn.getComponent("Print").setHtml(language.clippings.print);b.shareBtn.getComponent("Share").setHtml(language.clippings.share);b.previewBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.downloadBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.printBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.shareBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.closeBtn.element.on("tap",function(){b.fireEvent("close",b)});if(b.config.images!=null){b.images=b.config.images}if(b.config.shareImages!=null){b.shareImages=b.config.shareImages}if(b.config.widths!=null){b.widths=b.config.widths}if(b.config.heights!=null){b.heights=b.config.heights}b.addThumbnails();b.previewBtn.element.on({tap:b.preview,scope:b});b.downloadBtn.element.on({tap:b.download,scope:b});b.printBtn.element.on({tap:b.print,scope:b});b.shareBtn.element.on({tap:b.shareTap,scope:b});if(!Ext.os.is.Desktop){b.printBtn.hide()}b.clippingsContainer.element.down(".x-inner").dom.style.width="100%";b.clippingsContainer.element.down(".x-inner").dom.style.display="inline";b.clippingsContainer.element.dom.style.overflowY="scroll";b.resizeFunc=function(){if($(b.element.dom).height>=650){b.clippingsContainer.element.dom.style.height="400px"}else{b.clippingsContainer.element.dom.style.height=($(b.element.dom).height()-80-$(b.clippingOptionsContainerText.element.dom).height()-$(b.buttonsContainer.element.dom).height())+"px"}};b.on({painted:b.resizeFunc});Ext.Viewport.on({resize:b.resizeFunc});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeBtn.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}b.element.dom.style.borderRadius=""}},setupImageUrls:function(){var b=this;for(var a in b.images){if(b.images[a].indexOf("clippings.pagesuite.com")==-1){b.images[a]="http://clippings.pagesuite.com/clipping.aspx?b64url="+btoa(b.images[a])}}},preview:function(){var d=this;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c=true;break}}if(c){var a=Ext.create("InfinityMobile.view.ClippingMenuPreview",{images:d.images,clippingMenu:d})}else{d.promptUser(language.clippings.selectClippings)}},download:function(){var h=this;var k=false;if(Ext.os.is.Desktop&&!Ext.browser.is.Safari){for(var e=0;e<h.images.length;e++){if(h.clippingsContainer.innerItems[e].clicked){if(Ext.browser.is.IE){try{var d=document.createElement("canvas");var l=d.getContext("2d");var f=new Image();f.src="../get_clipping_download.aspx?b64Url="+encodeURIComponent(btoa(h.images[e]));f.onload=function(){d.height=this.naturalHeight;d.width=this.naturalWidth;l.drawImage(this,0,0);var m=d.msToBlob();window.navigator.msSaveBlob(m,"clipping"+e+".jpg")}}catch(g){console.log(g)}k=true}else{var j=document.createElement("a");j.target="_blank";var b=h.images[e];if(Ext.browser.is.Firefox){b="../get_clipping_download.aspx?b64Url="+encodeURIComponent(btoa(h.images[e]))}else{if(Ext.browser.is.Safari){b="../get_clipping_download.aspx?b64Url="+encodeURIComponent(btoa(h.images[e]))+"&attachmentHeader=true"}}j.href=b;j.download="clipping"+e+".jpg";var a=document.createEvent("MouseEvents");a.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);j.dispatchEvent(a);k=true}}}}else{var a=document.createEvent("MouseEvents");var j=null;var c=false;for(var e=0;e<h.images.length;e++){if(h.clippingsContainer.innerItems[e].clicked){if(!k){j=document.createElement("a");j.target="_blank";var b=h.images[e];if(Ext.browser.is.Safari&&currentProfile=="desktop"){b="../get_clipping_download.aspx?b64Url="+encodeURIComponent(btoa(h.images[e]))+"&attachmentHeader=true"}j.href=b;j.download="clipping"+e+".jpg";a.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);k=true}else{c=true;break}}}if(c){h.promptUser(language.clippings.selectOneClipping)}else{if(j!=null){j.dispatchEvent(a)}}}if(!k){h.promptUser(language.clippings.selectClippings)}},print:function(){var h=this;if(Ext.os.is.Desktop){var e=false;var g=[];for(var f=0;f<h.images.length;f++){var j=h.images[f];if(h.clippingsContainer.innerItems[f].clicked){if(!e){e=true}g[g.length]=j}}if(e){var d="print.aspx?edid="+editionguid+"&type=clipping&clippingurls=";var b="";for(var k in g){b+=encodeURIComponent(g[k])+","}if(b[b.length]==","){b=b.substring(0,b.length-1)}d+=b;window.open(d)}else{h.promptUser(language.clippings.selectClippings)}}else{var e=false;var c="";for(var f=0;f<h.images.length;f++){var j=h.images[f];if(h.clippingsContainer.innerItems[f].clicked){if(!e){e=true}c+="<div style='width:100%; height:100%; position:relative'>";c+="<img src='"+j+"' style='height:auto;width:auto;max-height:100%;max-width:100%;' />";c+="</div>"}}if(e){var a=Ext.create("InfinityMobile.view.PrintPreview",{doc:c,imgCheck:true});Ext.Viewport.add(a);a.show()}else{h.promptUser(language.clippings.selectClippings)}}},shareTap:function(){var d=this;d.shareBtn.removeAll();d.shareBtn.element.dom.style.backgroundColor="#e6e6e6";$(d.shareBtn.element.dom).removeClass("pointerCursor");var b=[{itemId:"email",width:30,height:30,cls:"pointerCursor",style:'background-image:url("resources/images/reader icons/mail.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"facebook",width:30,height:30,cls:"pointerCursor",style:'background-image:url("resources/images/reader icons/facebook.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"twitter",width:30,height:30,cls:"pointerCursor",style:'background-image:url("resources/images/reader icons/twitter.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"linkedin",width:30,height:30,cls:"pointerCursor",style:'background-image:url("resources/images/reader icons/linkedin.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"google",width:30,height:30,cls:"pointerCursor",style:'background-image:url("resources/images/reader icons/Google.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"pinterest",width:30,height:30,cls:"pointerCursor",style:'background-image:url("resources/images/reader icons/pinterest.png");background-size:contain;background-position:center;background-repeat:no-repeat;'}];d.shareBtn.add(b);var a=Ext.getStore("SettingStore");d.emailBtn=d.shareBtn.getComponent("email");d.facebookBtn=d.shareBtn.getComponent("facebook");d.twitterBtn=d.shareBtn.getComponent("twitter");d.linkedinBtn=d.shareBtn.getComponent("linkedin");d.googleBtn=d.shareBtn.getComponent("google");d.pinterestBtn=d.shareBtn.getComponent("pinterest");var c=a.data.items[0].raw.sharing;if(c.allSharing[0]==null){d.emailBtn.hide()}else{d.emailBtn.element.on({tap:d.emailShare,scope:d})}if(c.allSharing[1]==null){d.facebookBtn.hide()}else{d.facebookBtn.element.on({tap:d.facebookShare,scope:d})}if(c.allSharing[2]==null){d.twitterBtn.hide()}else{d.twitterBtn.element.on({tap:d.twitterShare,scope:d})}if(c.allSharing[3]==null){d.linkedinBtn.hide()}else{d.linkedinBtn.element.on({tap:d.linkedinShare,scope:d})}if(c.allSharing[4]==null){d.googleBtn.hide()}else{d.googleBtn.element.on({tap:d.googleShare,scope:d})}if(c.allSharing[5]==null){d.pinterestBtn.hide()}else{d.pinterestBtn.element.on({tap:d.pinterestShare,scope:d})}},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingItems",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingsContainer.add(c);c.show()}},promptUser:function(b){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:b})},emailShare:function(){var d=this;var e=false;var a="mailto:?subject="+encodeURIComponent("Clippings from "+publicationName)+"&body=";var c="To view a clipping, please select one of the links below:\n";for(var b=0;b<d.shareImages.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c+=d.shareImages[b]+" \n";e=true}}if(e){window.location.href=a+encodeURIComponent(c)}else{d.promptUser(language.clippings.selectClippings)}},facebookShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.shareImages.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=encodeURIComponent(d.shareImages[b]);c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://www.facebook.com/sharer/sharer.php?m2w&u="+a+"&title=Clipping from "+publicationName)}else{d.promptUser(e)}},twitterShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.shareImages.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.shareImages[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://twitter.com/intent/tweet?text=Clipping from "+publicationName+" - "+a)}else{d.promptUser(e)}},linkedinShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.shareImages.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.shareImages[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://www.linkedin.com/shareArticle?mini=true&url="+a+"&title=Clipping from "+publicationName)}else{d.promptUser(e)}},googleShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.shareImages.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.shareImages[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("https://plus.google.com/share?url="+a)}else{d.promptUser(e)}},pinterestShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.shareImages.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.shareImages[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://pinterest.com/pin/create/bookmarklet/?media="+a+"&is_video=false&description=Clipping from "+publicationName)}else{d.promptUser(e)}},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");a.fireEvent("close",a);Ext.Container.prototype.hide.apply(this,arguments)}},0,["clippingoptionsmenu"],["component","container","clippingoptionsmenu"],{component:true,container:true,clippingoptionsmenu:true},["widget.clippingoptionsmenu"],0,[InfinityMobile.view.desktop,"ClippingOptionsMenu"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderFullscreenGalleryIcon",Ext.Container,{config:{cls:"articleViewBtn",style:"float:left"},initialize:function(){var a=this;if(a.config.images!=null){a.images=a.config.images}if(a.config.article!=null){a.article=a.config.article}a.setHtml("<img src='resources/images/reader icons/expand-gallery-icon.png' style='width:100%; height:auto;' />");a.element.on({tap:function(d){d.stopPropagation();var b=[];for(image in a.images){b.push({url:a.images[image].url})}if(Ext.os.is.Desktop){var f="InfinityMobile.view.desktop.ImageGallery"}else{var f="InfinityMobile.view.tablet.ImageGallery"}var c=Ext.create(f,{images:b,article:a.article});Ext.Viewport.add(c)},scope:a})}},0,["fullscreengalleryicon"],["component","container","fullscreengalleryicon"],{component:true,container:true,fullscreengalleryicon:true},["widget.fullscreengalleryicon"],0,[InfinityMobile.view.desktop,"ArticleReaderFullscreenGalleryIcon"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderTextSizeIcon",Ext.Container,{config:{cls:"articleViewBtn",style:"float:left"},initialize:function(){var a=this;if(a.config.type!=null){a.type=a.config.type}if(a.config.color!=null){a.color=a.config.color}if(a.config.tile!=null){a.tile=a.config.tile}if(a.type=="increase"){if(a.color=="white"){a.setHtml("<img src='resources/images/reader icons/Text_Increase_Icon-white.png' style='width:100%; height:auto;' />")}else{a.setHtml("<img src='resources/images/reader icons/Text_Increase_Icon.png' style='width:100%; height:auto;' />")}}else{if(a.type=="decrease"){if(a.color=="white"){a.setHtml("<img src='resources/images/reader icons/Text_Decrease_Icon-white.png' style='width:100%; height:auto;' />")}else{a.setHtml("<img src='resources/images/reader icons/Text_Decrease_Icon.png' style='width:100%; height:auto;' />")}}}a.element.on({tap:function(c){var b=this;c.stopPropagation();if(b.type=="increase"){b.increaseSize()}else{b.decreaseSize()}},scope:a})},increaseSize:function(){var f=this;if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}b=parseInt(b)+2;if(b<=66){localStorage.setItem("bodyFontSize"+publicationguid,b);$(".articleText").css("font-size",b+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var a=localStorage.getItem("headlineFontSize"+publicationguid)}else{var a=32}a=parseInt(a)+2;localStorage.setItem("headlineFontSize"+publicationguid,a);$(".headline").css("font-size",a+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var e=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var e=20}e=parseInt(e)+2;localStorage.setItem("subheadlineFontSize"+publicationguid,e);$(".subheadline").css("font-size",e+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}d=parseInt(d)+2;localStorage.setItem("bylineFontSize"+publicationguid,d);$(".byline").css("font-size",d+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}c=parseInt(c)+2;localStorage.setItem("sectionFontSize"+publicationguid,c);$(".section").css("font-size",c+"px");if(Ext.browser.is.IE){if(f.tile.hasImage){if(f.tile.articlePop.items.items[0]!=null&&f.tile.articlePop.items.items[1]!=null){f.tile.desktopScroll.down(".x-scroll-container").dom.style.height=(f.tile.articlePop.items.items[0].element.dom.clientHeight+f.tile.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}}else{f.tile.desktopScroll.down(".x-scroll-container").dom.style.height=(f.tile.titleContainer.items.items[0].element.dom.clientHeight+f.tile.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"}}}},decreaseSize:function(){var f=this;if(localStorage.getItem("bodyFontSize"+publicationguid)!=null){var b=localStorage.getItem("bodyFontSize"+publicationguid)}else{var b=16}b=parseInt(b)-2;if(b>=8){localStorage.setItem("bodyFontSize"+publicationguid,b);$(".articleText").css("font-size",b+"px");if(localStorage.getItem("headlineFontSize"+publicationguid)!=null){var a=localStorage.getItem("headlineFontSize"+publicationguid)}else{var a=32}a=parseInt(a)-2;localStorage.setItem("headlineFontSize"+publicationguid,a);$(".headline").css("font-size",a+"px");if(localStorage.getItem("subheadlineFontSize"+publicationguid)!=null){var e=localStorage.getItem("subheadlineFontSize"+publicationguid)}else{var e=20}e=parseInt(e)-2;localStorage.setItem("subheadlineFontSize"+publicationguid,e);$(".subheadline").css("font-size",e+"px");if(localStorage.getItem("bylineFontSize"+publicationguid)!=null){var d=localStorage.getItem("bylineFontSize"+publicationguid)}else{var d=18}d=parseInt(d)-2;localStorage.setItem("bylineFontSize"+publicationguid,d);$(".byline").css("font-size",d+"px");if(localStorage.getItem("sectionFontSize"+publicationguid)!=null){var c=localStorage.getItem("sectionFontSize"+publicationguid)}else{var c=18}c=parseInt(c)-2;localStorage.setItem("sectionFontSize"+publicationguid,c);$(".section").css("font-size",c+"px");if(Ext.browser.is.IE){if(f.tile.hasImage){if(f.tile.articlePop.items.items[0]!=null&&f.tile.articlePop.items.items[1]!=null){f.tile.desktopScroll.down(".x-scroll-container").dom.style.height=(f.tile.articlePop.items.items[0].element.dom.clientHeight+f.tile.articlePop.items.items[1].element.dom.clientHeight+40)+"px"}}else{f.tile.desktopScroll.down(".x-scroll-container").dom.style.height=(f.tile.titleContainer.items.items[0].element.dom.clientHeight+f.tile.titleContainer.items.items[1].element.dom.clientHeight+40)+"px"}}}}},0,["articlereadertextsizeicon"],["component","container","articlereadertextsizeicon"],{component:true,container:true,articlereadertextsizeicon:true},["widget.articlereadertextsizeicon"],0,[InfinityMobile.view.desktop,"ArticleReaderTextSizeIcon"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ImageGallery",Ext.Container,{config:{modal:true,fullscreen:true,centered:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:20,layout:"vbox",items:[{itemId:"topPanel",layout:"hbox",flex:5,items:[{itemId:"image",flex:3,layout:"hbox",items:[{itemId:"previous",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"},{itemId:"imageCarousel",flex:1,height:"100%",style:"background-color:rgb(75,75,75)"},{itemId:"next",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"}]},{itemId:"galleryContent",flex:1,layout:"vbox",items:[{itemId:"closeBtnRow",width:"100%",height:50,items:[{itemId:"closeBtn",cls:"pointerCursor",right:0,top:0,margin:10,height:25,width:25,style:{backgroundImage:"url('resources/images/reader icons/close-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}]},{itemId:"galleryCounter",height:50,margin:"10 0",width:"100%",layout:"hbox",style:{color:"white",fontSize:"20px",fontWeight:"bold"},items:[{itemId:"cameraIcon",height:30,width:30,margin:10,style:{backgroundImage:"url('resources/images/reader icons/photo-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},{itemId:"counter",height:50,layout:{type:"vbox",pack:"center"},items:[{itemId:"text"}]}]},{itemId:"galleryInfo",width:"100%",layout:"vbox",scrollable:{direction:"vertical",indicators:false},style:{color:"white"},items:[{itemId:"title",style:{fontSize:"40px",fontWeight:"bold"},margin:"10 0"},{itemId:"caption",style:{fontSize:"14px"},margin:"10 0"}]}]}]},{itemId:"imageScroller",flex:1,width:"100%",layout:"hbox",padding:10,scrollable:{direction:"horizontal"}}]},initialize:function(){var a=this;if(a.config.article!=null){a.article=a.config.article}if(a.config.images!=null){a.images=a.config.images}a.imageLength=a.images.length;a.topPanel=a.getComponent("topPanel");a.image=a.topPanel.getComponent("image");a.previousBtn=a.image.getComponent("previous");a.previousBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-back-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.nextBtn=a.image.getComponent("next");a.nextBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-next-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.previousBtn.element.on({tap:a.previous,scope:a});a.nextBtn.element.on({tap:a.next,scope:a});a.galleryContent=a.topPanel.getComponent("galleryContent");a.galleryCounterPanel=a.galleryContent.getComponent("galleryCounter");a.counter=a.galleryCounterPanel.getComponent("counter");a.counterText=a.counter.getComponent("text");a.closeBtnRow=a.galleryContent.getComponent("closeBtnRow");a.closeBtn=a.closeBtnRow.getComponent("closeBtn");a.closeBtn.element.on({tap:function(){mainPanel.fireEvent("trackImageGalleryClose");this.destroy()},scope:a});a.imageScroller=a.getComponent("imageScroller");a.galleryInfo=a.galleryContent.getComponent("galleryInfo");a.title=a.galleryInfo.getComponent("title");a.title.setHtml(a.article.headline);a.caption=a.galleryInfo.getComponent("caption");Ext.Viewport.on({resize:a.resizeGallery,scope:a});a.on({painted:function(){a.fireEvent("galleryVisible");mainPanel.fireEvent("trackImageGalleryOpen");a.imageCarousel=a.image.getComponent("imageCarousel");a.title.setHtml(a.article.headline);a.galleryInfo.setWidth($(a.galleryInfo.element.dom).width()-50);a.setupCarousel();a.setupThumbnails();a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10);a.handleItemChange(a.carousel)},scope:a,destroy:function(){a.fireEvent("galleryInvisible")}})},handleItemChange:function(e){var d=this;var b=(e._pageNumber);if(d.images!=null){var g=0;for(var c=0;c<b;c++){var a=d.images[c];if(a!=null&&a.type=="advert"){g++}}var f=e.getActiveItem();if(f.type=="advert"){d.counter.setHtml("Advertisement");if(f.adType=="dfp"){f.loadDfp()}}else{d.counter.setHtml((parseFloat(b)+1-g)+" of "+d.imageLength)}d.caption.setHtml("");if(d.article!=null){if(d.article.images[b-g].caption!=null){if(d.article.images[b-g].caption.trim().length>0){var h="";if(d.article.images[b-g].credit!=null){if(d.article.images[b-g].credit.trim().length>0){h=" ("+d.article.images[b-g].credit+")"}}if(f.type=="advert"){d.caption.setHtml("")}else{d.caption.setHtml(d.article.images[b-g].caption+h)}}else{if(d.article.shortStory!=null){d.caption.setHtml(d.article.shortStory)}}}else{if(d.article.shortStory!=null){d.caption.setHtml(d.article.shortStory)}}if(f.type=="advert"){d.setSelectedImage(d.images.length)}else{d.setSelectedImage(b-g)}}else{if(d.images[b].caption!=null){if(d.images[b].caption.trim().length>0){d.caption.setHtml(d.images[b].caption)}else{d.caption.setHtml("")}}d.setSelectedImage(b-g)}}mainPanel.fireEvent("trackImageChange")},setSelectedImage:function(a){var d=this;var c=d.imageScroller.getItems().items;for(var b=0;b<c.length;b++){if(c[b].element.dom.style.border!=""){c[b].element.dom.style.border=""}}if(c[a]!=null){c[a].element.dom.style.border="2px solid white"}},next:function(){var a=this;a.carousel.next()},previous:function(){var a=this;a.carousel.previous()},resizeGalleryChrome:function(){var a=this;a.galleryInfo.setWidth("calc(100% - 10px)");a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10)},resizeGallery:function(){var a=this;a.carousel.onSizeChange();a.galleryInfo.setWidth("calc(100% - 10px)");a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10)},setupCarousel:function(){var a=this;a.checkAdverts();a.carousel=Ext.create("InfinityMobile.view.ImageCarousel",{width:"100%",height:"100%",data:a.images,pageNo:1,pageTemplate:function(c,e,b){if(c!=null){if(c.type=="advert"){return Ext.create("InfinityMobile.view.ReaderImageGalleryAdvert",{type:"advert",pageNo:e})}else{var d=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:c,position:parseInt(c.index),pageNo:e});return d}}}});a.carousel.onDragStart=function(){};a.imageCarousel.add(a.carousel);a.carousel.on({activeitemchange:a.handleItemChange,scope:a})},checkAdverts:function(){var h=this;if(settings.reader.galleryMpu!=null&&settings.reader.galleryMpu.type=="dfp"&&settings.reader.galleryMpu.networkCode!=null&&settings.reader.galleryMpu.adUnit!=null){var a=2;var e=h.images.length;var g=settings.reader.galleryMpu;if(g.swipeCount!=null&&!isNaN(g.swipeCount)){a=parseInt(g.swipeCount)}var b=Math.floor(e/a);for(var d=0;d<b;d++){var c=(a)+(a*d)+(d);var f={type:"advert"};h.images.splice(c,0,f)}}},setupThumbnails:function(){var b=this;for(var a in b.images){if(b.images[a].type!="advert"){var c=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:b.images[a].url,carousel:b.carousel,index:a,style:{transition:"all ease 0.5s"}});if(a==0){c.element.dom.style.border="2px solid white"}b.imageScroller.add(c)}}}},0,["dynamicimagegallery"],["component","container","dynamicimagegallery"],{component:true,container:true,dynamicimagegallery:true},["widget.dynamicimagegallery"],0,[InfinityMobile.view.desktop,"ImageGallery"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArchiveSelector",Ext.Panel,{config:{height:40,padding:"0 10px",layout:{type:"hbox",align:"center"},items:[{itemId:"selectEdition",style:"font-size:11pt;",html:"Select edition:"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='yearDropDown'></select></div>"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='monthDropDown'></select></div>"},{width:10},{style:"font-size:11pt;",html:"<div class='selectBox'><select id='dayDropDown'></select></div>"},{width:10},{itemId:"change",cls:"pointerCursor",style:"text-decoration:underline;font-size:11pt;",html:"Change"}]},initialize:function(){var c=this;c.datePickerYear=c.element.down("#yearDropDown").dom;c.datePickerMonth=c.element.down("#monthDropDown").dom;c.datePickerDay=c.element.down("#dayDropDown").dom;c.changeBtn=c.getComponent("change");var b=c.hexToRgb(settings.topbar.backgroundColor);if(settings.topbar!=null){c.setStyle({backgroundColor:"rgba("+b.r+","+b.g+","+b.b+",0.9)",color:"#"+settings.topbar.color})}c.changeBtn.element.on({tap:c.changeEdition,scope:c});var a=settings.dateSelector.oldestEdition.split("/");c.earliestDate=new Date(a[2],a[1],a[0]);c.on({painted:function(){c.populateYearDropDown();c.datePickerYear.selectedIndex=c.datePickerYear.options.length-1;c.populateMonthDropDown();c.datePickerMonth.selectedIndex=c.datePickerMonth.options.length-1;c.populateDayDropDown();c.datePickerDay.selectedIndex=c.datePickerDay.options.length-1}});c.setTodaysDate()},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},populateYearDropDown:function(){var c=this;var a=new Date();for(var b=c.earliestDate.getFullYear();b<=a.getFullYear();b++){c.addOption(c.datePickerYear,b,b)}c.datePickerYear.onchange=function(){c.populateMonthDropDown();c.populateDayDropDown()}},populateMonthDropDown:function(){var g=this;var f=g.datePickerMonth.options[g.datePickerMonth.selectedIndex];var b=0;var h=12;var d=new Date();g.datePickerMonth.options.length=0;if(g.datePickerYear.options[g.datePickerYear.selectedIndex].value==d.getFullYear()){h=d.getMonth()+1}if(g.datePickerYear.options[g.datePickerYear.selectedIndex].value==g.earliestDate.getFullYear()){b=g.earliestDate.getMonth()-1}for(var e=b;e<h;e++){var c="Jan";switch(e){case 0:c="Jan";break;case 1:c="Feb";break;case 2:c="Mar";break;case 3:c="Apr";break;case 4:c="May";break;case 5:c="Jun";break;case 6:c="Jul";break;case 7:c="Aug";break;case 8:c="Sep";break;case 9:c="Oct";break;case 10:c="Nov";break;case 11:c="Dec";break}g.addOption(g.datePickerMonth,c,e+1)}g.datePickerMonth.onchange=function(){g.populateDayDropDown()};if(f!=null){for(var a=0;a<g.datePickerMonth.options.length;a++){if(g.datePickerMonth.options[a].value==f.value){g.datePickerMonth.selectedIndex=a;break}}}},populateDayDropDown:function(){var e=this;var b=e.datePickerDay.options[e.datePickerDay.selectedIndex];e.datePickerDay.options.length=0;var c=new Date();var f=32;switch(e.datePickerMonth.options[e.datePickerMonth.selectedIndex].innerHTML){case"Jan":case"Mar":case"May":case"Jul":case"Aug":case"Oct":case"Dec":f=32;break;case"Apr":case"Jun":case"Sep":case"Nov":f=31;break;case"Feb":if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value%4==0){f=30}else{f=29}break}var g=1;if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value==e.earliestDate.getFullYear()&&e.datePickerMonth.options[e.datePickerMonth.selectedIndex].value==e.earliestDate.getMonth()){g=e.earliestDate.getDate()}if(e.datePickerYear.options[e.datePickerYear.selectedIndex].value==c.getFullYear()&&e.datePickerMonth.options[e.datePickerMonth.selectedIndex].value==c.getMonth()+1){f=c.getDate()+1}for(var d=g;d<f;d++){e.addOption(e.datePickerDay,d.toString(),d.toString())}if(b!=null){for(var a=0;a<e.datePickerDay.options.length;a++){if(e.datePickerDay.options[a].value==b.value){e.datePickerDay.selectedIndex=a;break}}}},addOption:function(a,d,c){var b=document.createElement("option");b.text=d;b.value=c;a.add(b)},setTodaysDate:function(){var a=this;a.todaysDate=new Date().yyyymmdd();var b=a.todaysDate.split("-");a.todayDateYear=b[0];a.todayDateMonth=b[1].toString();if(a.todayDateMonth.toString().startsWith("0")){a.todayDateMonth=a.todayDateMonth.replace("0","")}a.todayDateDay=b[2];if(a.todayDateDay.startsWith("0")){a.todayDateDay=a.todayDateDay.replace("0","")}a.datePickerYear.value=a.todayDateYear;a.datePickerMonth.value=a.todayDateMonth;a.datePickerDay.value=a.todayDateDay;a.formatDate()},formatDate:function(a,d,b){var c=this;c.trimDayToMonth();if(b==c.todayDateYear){c.trimMonthToCurrent();if(d==c.todayDateYear){c.trimDayToCurrent()}}},trimMonthToCurrent:function(){var a=this},trimDayToMonth:function(d,b){var c=this;switch(d){case"4":case"6":case"9":case"11":c.trimDays(30);break;case"2":var a=28;if(parseInt(b)%4==0){a=29}c.trimDay(a);break;default:break}},trimDayToCurrent:function(){var a=this;a.trimDay(parseInt(a.todayDateDay))},trimDay:function(a){},changeEdition:function(){var a=this;window.location.href="../get_edition_by_date.aspx?pubid="+publicationguid+"&year="+a.datePickerYear.options[a.datePickerYear.selectedIndex].value+"&month="+a.datePickerMonth.options[a.datePickerMonth.selectedIndex].value+"&day="+a.datePickerDay.options[a.datePickerDay.selectedIndex].value}},0,["archiveselector"],["component","container","panel","archiveselector"],{component:true,container:true,panel:true,archiveselector:true},["widget.archiveselector"],0,[InfinityMobile.view.desktop,"ArchiveSelector"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.readerTerms",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:700,style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"toolBar",height:40,items:[{itemId:"title",top:10,left:10},{id:"ToolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img class='pointerCursor' src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"body",width:"100%",height:"100%",style:"max-height:600px;"}]},initialize:function(){var b=this;b.topbar=b.getComponent("toolBar");b.title=b.topbar.getComponent("title");b.close=b.topbar.getComponent("ToolBarClose");b.bodyContainer=b.getComponent("body");b.topbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});if(settings.menu.terms.url!=null){if(settings.menu.terms.url.length>0){$.ajax({url:"../get_terms_of_service.aspx?url="+encodeURIComponent(settings.menu.terms.url),async:false,success:function(c){b.bodyContainer.setHtml(c);if(Ext.os.is.Desktop){b.bodyContainer.element.dom.style.overflowY="scroll"}else{b.bodyContainer.setScrollable(true)}},error:function(){b.destroy()}})}}b.title.setHtml(language.menu.terms);b.close.element.on({tap:function(){b.destroy()}});if(settings.newsday!=null){b.element.dom.style.borderRadius="0px";if(currentProfile=="largetablet"||currentProfile=="tablet"){b.bodyContainer.setHeight("200px")}if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.close.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}}},0,["readerTerms"],["component","container","readerTerms"],{component:true,container:true,readerTerms:true},["widget.readerTerms"],0,[InfinityMobile.view.desktop,"readerTerms"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderFree",Ext.Container,{config:{width:"100%",height:"100%",top:0,left:0,layout:"vbox",items:[{height:40},{itemId:"container",style:"background-color:rgba(200, 200, 200, 0.9); font-size:28px;",flex:1,layout:{type:"vbox",align:"center",pack:"middle"},items:[{itemId:"content",width:700,height:650,layout:{type:"vbox",align:"center"},defaults:{margin:"15px 0 15px 0"},items:[{height:100,width:"100%",style:'background-image:url("resources/images/branding/logo_black.png"); background-repeat:no-repeat; background-size:contain; background-position:center'},{itemId:"freeTrialText"},{itemId:"actionContainer",height:250,margin:"15px 0",layout:"hbox",items:[{itemId:"logInContainer",width:300,height:250,style:"background-color:white; text-align:center",padding:20,layout:"vbox",items:[{margin:"20px 0 0 0",style:"font-size:20px; font-weight:bold",html:"SUBSCRIBERS"},{margin:"20px 0 0 0",style:"font-size:20px;",html:"Enjoy Unlimited Access as part of your subscription"},{itemId:"logInButton",margin:"30px 0 0 0",width:"100%",height:50,style:"line-height:50px; color:white; font-size:20px; text-align:center; background-color: rgb(25, 153, 206);",html:"Log In Now"}]},{width:20},{itemId:"trialContainer",width:300,height:250,style:"background-color:white; text-align:center",padding:20,layout:"vbox",items:[{margin:"20px 0 0 0",style:"font-size:20px; font-weight:bold",html:"NEW USERS"},{itemId:"trialText",margin:"20px 0 0 0",style:"font-size:20px;",html:"Read 30 pages free each month"},{itemId:"trialButton",margin:"30px 0 0 0",width:"100%",height:50,style:"line-height:50px; color:white; font-size:20px; text-align:center; background-color: rgb(25, 153, 206);",html:"Start Your Trial"}]}]},{itemId:"freeText",style:"text-align:center",html:"<span style='color:#1999ce;' id='subscribeEvent'>Subscribe</span> now for unlimited access<br />Already a subscriber? <span style='color:#1999ce;' id='loginEvent'>Log In</span>"}]}]}]},initialize:function(){var a=this;a.container=a.getComponent("container");a.content=a.container.getComponent("content");a.actionContainer=a.content.getComponent("actionContainer");a.freeTrialText=a.content.getComponent("freeTrialText");a.freeTrialText.setHtml(freeTrialText);a.freeText=a.content.getComponent("freeText");if(typeof changeFreeText!="undefined"&&changeFreeText!=null&&changeFreeText!=""){a.freeText.setHtml(changeFreeText)}a.loginContainer=a.actionContainer.getComponent("logInContainer");a.loginButton=a.loginContainer.getComponent("logInButton");a.trialContainer=a.actionContainer.getComponent("trialContainer");a.trialButton=a.trialContainer.getComponent("trialButton");a.trialText=a.trialContainer.getComponent("trialText");a.subscribeButton=a.element.down("#subscribeEvent");if(typeof trialText!="undefined"){a.trialText.setHtml(trialText)}a.continueListener();a.subscribeListener();a.loginListener()},continueListener:function(){var a=this;if(a.trialButton!=null){a.trialButton.element.on("tap",function(){a.fireEvent("close",a)})}},subscribeListener:function(){var a=this;if(a.subscribeButton!=null){a.subscribeButton.on("tap",function(){a.fireEvent("subscribe",a)})}},loginListener:function(){var a=this;if(a.loginButton!=null){a.loginButton.element.on("tap",function(){a.fireEvent("login",a)})}}},0,["readerfree"],["component","container","readerfree"],{component:true,container:true,readerfree:true},["widget.readerfree"],0,[InfinityMobile.view.desktop,"ReaderFree"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderPuzzlePopoverItem",InfinityMobile.view.desktop.ReaderArticlePopoverItem,{config:{mediaObject:"",pageNo:"",page:"",height:"100%",cls:"readerpuzzle",layout:"vbox",style:"overflow-y:auto;",items:[{itemId:"content",layout:"card",items:[{itemId:"contentHtml"}]},{itemId:"bottomBar",cls:"bottomBar",height:60,style:"font-size: 14px;min-height:60px;",layout:{type:"hbox",pack:"middle",align:"center"},items:[{itemId:"archive",cls:"pointerCursor",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='https://edition.pagesuite.com/tribune/archive-ic.png' style='height:32px' />"},{width:5},{html:"Archive"}]},{width:10},{itemId:"print",cls:"pointerCursor",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='https://edition.pagesuite.com/tribune/print-icon.png' style='height:32px' />"},{width:5},{html:"Print"}]},{width:10},{itemId:"share",cls:"pointerCursor",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{itemId:"shareText",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='https://edition.pagesuite.com/tribune/share-ic.png' style='height:32px' />"},{width:5},{html:"Share"}]},{itemId:"shareFrame",hidden:true,layout:{type:"hbox",pack:"middle",align:"center"}}]},{itemId:"interactivemargin",width:10},{itemId:"interactive",width:170,height:40,style:"background-color:#dfe0df; color: #4591B8",layout:{type:"hbox",pack:"middle",align:"center"},items:[{html:"<img src='https://edition.pagesuite.com/tribune/interactive-ic.png' style='height:32px' />"},{width:5},{html:"Interactive Version"}]}]}]},initialize:function(){var b=this;InfinityMobile.view.desktop.ReaderArticlePopoverItem.prototype.initialize.apply(this,arguments);b.bottomBar=b.getComponent("bottomBar");var a=InfinityMobile.app.application.getController("MediaController").flippAdvertSetting;var c=a.enabled;if(c){b.bottomBar.setDocked("bottom")}b.archiveButton=b.bottomBar.getComponent("archive");b.printButton=b.bottomBar.getComponent("print");b.shareButton=b.bottomBar.getComponent("share");b.shareText=b.shareButton.getComponent("shareText");b.shareFrame=b.shareButton.getComponent("shareFrame");b.interactiveMargin=b.bottomBar.getComponent("interactivemargin");b.interactiveButton=b.bottomBar.getComponent("interactive");b.setArchiveListener();b.setPrintListener();b.setShareListener();b.setInteractiveListener();b.setUpShare();b.checkInteractive();if(typeof isTribReader!="undefined"){if(isTribReader){b.setPadding("0px 25px")}}b.on({painted:function(){}})},setUpShare:function(){var d=this;var e="http://"+window.location.hostname+"/infinity/article_share.aspx?guid="+d.articleguid;message=d.config.page.description;var a=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"https://edition.pagesuite.com/html5/desktop/assets/article%20view/email-ic.png",link:"mailto:?message={0}&subject={1}",url:e,message:message,height:30,width:30,type:"email"});d.shareFrame.add(a);var c=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"https://edition.pagesuite.com/html5/desktop/assets/article%20view/facebook-ic.png",link:"http://www.facebook.com/sharer/sharer.php?u={0}&title={1}",url:e,message:message,height:30,width:30});d.shareFrame.add(c);var b=Ext.create("InfinityMobile.view.ReaderMenuShareItem",{icon:"https://edition.pagesuite.com/html5/desktop/assets/article%20view/twitter-ic.png",link:"http://twitter.com/intent/tweet?status={0} - {1}",url:e,message:message,height:30,width:30});d.shareFrame.add(b)},setArchiveListener:function(){var a=this;a.archiveButton.element.on("tap",function(){a.fireEvent("puzzleArchive",a)})},setPrintListener:function(){var a=this;a.printButton.element.on("tap",function(){a.fireEvent("puzzlePrint",a)})},setShareListener:function(){var a=this;a.shareButton.element.on("tap",function(){a.fireEvent("puzzleShare",a)})},setInteractiveListener:function(){var a=this;a.interactiveButton.element.on("tap",function(){a.fireEvent("puzzleInteractive",a)})},checkInteractive:function(){var a=this;if(a.getPage().title!="Interactive Puzzle"){a.interactiveMargin.setHidden(true);a.interactiveButton.setHidden(true)}}},0,["readerpuzzlepopoveritem"],["component","container","readerarticlepopoveritem","readerpuzzlepopoveritem"],{component:true,container:true,readerarticlepopoveritem:true,readerpuzzlepopoveritem:true},["widget.readerpuzzlepopoveritem"],0,[InfinityMobile.view.desktop,"ReaderPuzzlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderPuzzleArchive",Ext.Container,{config:{layout:"vbox",height:"100%",cls:"puzzleArchive",items:[{itemId:"topbar",height:40,style:"color: #4591B8",layout:{type:"hbox",align:"center"},items:[{itemId:"back",cls:"pointerCursor",width:150,padding:"10 0 0 20",height:"100%",layout:"hbox",style:"font-size:18px",items:[{html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{html:"Back",padding:"0 0 0 5"}]},{itemId:"title",flex:1,style:"text-align:center; font-size:22px; font-weight:bold; color:black",html:"Archive"},{width:150}]},{itemId:"containerScroll",style:"overflow-y:scroll;",items:[{itemId:"container",style:"overflow-y:auto;",defaults:{cls:"puzzlearchiveitem"}}]},{itemId:"archiveControl",bottom:0,width:"100%",height:40,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"previous",style:"color:#4591B8",html:"Previous",cls:"pointerCursor",zIndex:6,flex:1,left:0,top:20},{itemId:"pages",style:"color:#4591B8;text-align:center;",top:20,width:"100%",layout:{type:"hbox",pack:"center",align:"middle"}},{itemId:"next",style:"color:#4591B8",html:"Next",flex:1,right:0,top:20,cls:"pointerCursor"}]}]},initialize:function(){var a=this;var b=a.getComponent("topbar");a.backButton=b.getComponent("back");a.archiveControl=a.getComponent("archiveControl");a.containerScroll=a.getComponent("containerScroll");a.container=a.getComponent("containerScroll").getComponent("container");a.setBackListener();a.config.puzzleArchiveParent.bottomBar.hide();a.setHeight($(a.config.puzzleArchiveParent.element.dom).height());a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height=$(a.config.puzzleArchiveParent.element.dom).height()+"px";a.containerScroll.setHeight($(a.element.dom).height()-80);a.resizeFunction=function(){a.setHeight($(a.config.puzzleArchiveParent.element.dom).height());a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height=$(a.config.puzzleArchiveParent.element.dom).height()+"px";a.containerScroll.setHeight($(a.element.dom).height()-80)};Ext.Viewport.on({resize:a.resizeFunction});a.location=0;a.pagesControl=a.archiveControl.getComponent("pages");a.previous=a.archiveControl.getComponent("previous");a.next=a.archiveControl.getComponent("next");a.next.element.on({tap:function(){a.fireEvent("archiveNextPage",a)}});a.previous.element.on({tap:function(){a.fireEvent("archivePreviousPage",a)}});a.fireEvent("initialized",a)},setBackListener:function(){var a=this;a.backButton.element.on("tap",function(){a.config.puzzleArchiveParent.bottomBar.show();a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height="";Ext.Viewport.removeListener("resize",a.resizeFunction);a.fireEvent("back",a)})}},0,["readerpuzzlearchive"],["component","container","readerpuzzlearchive"],{component:true,container:true,readerpuzzlearchive:true},["widget.readerpuzzlearchive"],0,[InfinityMobile.view.desktop,"ReaderPuzzleArchive"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ExtraTopBar",Ext.Container,{config:{height:40,width:"100%",padding:8,zIndex:2,layout:{type:"hbox"},defaults:{margin:"0 10px 0 10px",style:"float:right; background-size: contain; background-repeat: no-repeat; background-position: center; cursor:pointer;",height:24},items:[{itemId:"tooltiptool",cls:"tooltiptoolbar",style:"z-index:10000",margin:0,height:""},{xtype:"layouttoolbaricon",setting:"menuicon",event:"openReaderMenu",itemId:"menuicon"},{itemId:"toolbarIcon",cls:"toolbarIcon",defaults:{width:"100%",height:"100%",left:0,top:0},items:[{cls:"toolbarIconLarge",itemId:"toolbarIconLarge",style:"background-position: left center; background-size: contain; background-repeat: no-repeat;"},{cls:"toolbarIconSmall",itemId:"toolbarIconSmall",style:"background-position: left center; background-size: contain; background-repeat: no-repeat;"}]}]},initialize:function(){var b=this;if(b.config.topBarColor!=null){b.topBarColor=b.config.topBarColor}var a=b.hexToRgb(b.topBarColor);b.setStyle({backgroundColor:"rgba("+a.r+","+a.g+","+a.b+",0.9)"});b.setupIcons();b.setupTooltips()},setupTooltips:function(){var a=this;a.tooltip=a.getComponent("tooltiptool");$(a.tooltip.element.dom).css("visibility","hidden");a.topBarIconContainer.element.dom.onmouseover=function(){a.tooltip.setHtml(publicationName);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.topBarIconContainer.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")};a.menuIcon.element.dom.onmouseover=function(){a.tooltip.setHtml(language.menu.menu);a.tooltipRight();$(a.tooltip.element.dom).css("visibility","")};a.menuIcon.element.dom.onmouseout=function(){$(a.tooltip.element.dom).css("visibility","hidden")}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltiptool").element.dom.style.webkitTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.MozTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltiptool").element.dom.style.msTransform="translate3d("+(b.clientX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},setupIcons:function(){var a=this;a.menuIcon=a.getComponent("menuicon");if(settings.newsday.menuDirection!="left"){a.menuIcon.hide()}a.setupLogo();a.archiveSelector=Ext.create("InfinityMobile.view.desktop.ArchiveSelector",{});a.add(a.archiveSelector);a.archiveSelector.setStyle({backgroundColor:""});if(settings.newsday!=null){if(settings.newsday.weatherIcon!=null){if(settings.newsday.weatherIcon.length>0){a.weatherPlaceholder=Ext.create("Ext.Container",{right:18,height:40,width:60,style:'background-image:url("'+settings.newsday.weatherIcon+'");background-position:center;background-size:contain;background-repeat:no-repeat;'});a.add(a.weatherPlaceholder)}}}},setupLogo:function(){var b=this;b.topBarIconContainer=b.getComponent("toolbarIcon");b.topBarIconLarge=b.topBarIconContainer.getComponent("toolbarIconLarge");b.topBarIconSmall=b.topBarIconContainer.getComponent("toolbarIconSmall");var a=settings.topbar;b.topBarIconLarge.setStyle({backgroundImage:"url("+a.logo+")"});if(a.smallLogo!=null){var c=a.smallLogo;b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconSmall.setStyle({backgroundImage:"url("+c+")"})}else{b.topBarIconContainer.addCls("hasSmallLogo");b.topBarIconSmall.setStyle({backgroundImage:"url("+a.logo+")"})}b.topBarIconContainer.element.on("tap",function(){if(settings.topbar.logoUrl!=null){window.open(settings.topbar.logoUrl,"_blank")}else{mainPanel.fireEvent("readerFirst")}})},hexToRgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}},0,["extratopbar"],["component","container","extratopbar"],{component:true,container:true,extratopbar:true},["widget.extratopbar"],0,[InfinityMobile.view.desktop,"ExtraTopBar"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderOGallery",Ext.Container,{config:{modal:true,fullscreen:true,centered:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:99999999,layout:"vbox",items:[{itemId:"topPanel",layout:"hbox",flex:5,items:[{itemId:"image",flex:3,layout:"hbox",height:"100%",items:[{itemId:"previous",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"},{itemId:"imageCarousel",height:"100%",flex:1,style:"background-color:rgb(75,75,75)"},{itemId:"next",width:30,height:"100%",margin:"0 10 0 10",cls:"pointerCursor"}]},{itemId:"galleryContent",flex:1,layout:"vbox",items:[{itemId:"closeBtnRow",width:"100%",height:50,items:[{itemId:"closeBtn",cls:"pointerCursor",right:0,top:0,margin:10,height:25,width:25,style:{backgroundImage:"url('resources/images/article-close-btn-white.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}]},{itemId:"galleryCounter",height:60,margin:"10 0",width:"100%",layout:"hbox",style:{color:"white",fontSize:"20px",fontWeight:"bold"},items:[{itemId:"cameraIcon",height:30,width:30,margin:10,style:{backgroundImage:"url('resources/images/reader icons/photo-ic.png')",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},{itemId:"counter",height:50,layout:{type:"vbox",pack:"center"},items:[{itemId:"text"}]}]},{itemId:"galleryInfo",cls:"galleryInfo",width:"100%",layout:"vbox",padding:10,style:{color:"white",overflowY:"auto"},items:[{itemId:"title",width:"100%",style:{fontSize:"40px",fontWeight:"bold"},margin:"10 0"},{itemId:"caption",flex:1,width:"100%",style:{fontSize:"14px"},margin:"10 0"}]}]}]},{itemId:"imageScroller",flex:1,width:"100%",layout:"hbox",padding:10,scrollable:{direction:"horizontal"}}]},initialize:function(){var a=this;if(a.config.article!=null){a.article=a.config.article}if(a.config.images!=null){a.images=a.config.images}if(a.config.url!=null){a.url=a.config.url}a.topPanel=a.getComponent("topPanel");a.image=a.topPanel.getComponent("image");a.previousBtn=a.image.getComponent("previous");a.previousBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-back-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.nextBtn=a.image.getComponent("next");a.nextBtn.setStyle({backgroundImage:"url('resources/images/reader icons/gallery-next-ic.png')",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"});a.previousBtn.element.on({tap:a.previous,scope:a});a.nextBtn.element.on({tap:a.next,scope:a});a.galleryContent=a.topPanel.getComponent("galleryContent");a.galleryCounterPanel=a.galleryContent.getComponent("galleryCounter");a.counter=a.galleryCounterPanel.getComponent("counter");a.counterText=a.counter.getComponent("text");a.closeBtnRow=a.galleryContent.getComponent("closeBtnRow");a.closeBtn=a.closeBtnRow.getComponent("closeBtn");a.closeBtn.element.on({tap:function(){a.fireEvent("closeOGallery",a)},scope:a});a.imageScroller=a.getComponent("imageScroller");a.galleryInfo=a.galleryContent.getComponent("galleryInfo");if(navigator.appVersion.indexOf("Edge")!=-1){a.galleryInfo.setStyle({overflowY:"scroll"})}a.title=a.galleryInfo.getComponent("title");if(Ext.browser.is.IE){a.title.setStyle({flexShrink:0})}a.caption=a.galleryInfo.getComponent("caption");if(Ext.browser.is.Chrome){Ext.Viewport.on({resize:a.resizeGalleryChrome,scope:a})}else{Ext.Viewport.on({resize:a.resizeGallery,scope:a})}a.imageCarousel=a.image.getComponent("imageCarousel");a.on({painted:function(){if(a.url!=null){if(a.url.indexOf("http://")!=-1){var b=a.url.substring(7,a.url.length)}else{b=a.url}b="../../Newsday/getatex.aspx?url=http://www.newsday.com/iosfeeds/"+b+"?device=desktop&_dc=1445010088130&limit=25";$.ajax({type:"GET",url:b,data:{get_param:"value"},dataType:"json",success:function(d){a.title.setHtml(d.content.name);a.images=[];for(var c in d.content.images){a.images[c]={url:d.content.images[c].image_path,caption:d.content.images[c].caption,index:c}}a.setupCarousel();a.setupThumbnails();if(a.images[0].caption.trim().length>0){var f="";if(a.images[0].credit!=null){if(a.images[0].credit.trim().length>0){f=" ("+a.images[0].credit+")"}}a.caption.setHtml(a.images[0].caption+f)}a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10);a.handleItemChange(a.carousel);a.data=d;var e="1 of "+a.images.length;a.fireEvent("ogalleryinitialized",a,d,e)}})}else{a.title.setHtml(a.article.headline);a.setupCarousel();a.setupThumbnails();a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10);a.handleItemChange(a.carousel)}},scope:a})},setupThumbnails:function(){var b=this;for(var a in b.images){var c=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{cls:"pointerCursor",url:b.images[a].url,carousel:b.carousel,index:a,style:{transition:"all ease 0.5s"}});if(a==0){c.element.dom.style.border="2px solid white"}b.imageScroller.add(c)}},setupGalleryInfo:function(){},handleItemChange:function(g){var d=this;var a=(g._pageNumber);if(d.images!=null){d.counter.setHtml((parseFloat(a)+1)+" of "+d.images.length);d.caption.setHtml("");if(d.article!=null){if(d.article.images[a].caption!=null){if(d.article.images[a].caption.trim().length>0){var h="";if(d.article.images[a].credit!=null){if(d.article.images[a].credit.trim().length>0){h=" ("+d.article.images[a].credit+")"}}d.caption.setHtml(d.article.images[a].caption+h)}else{if(d.article.shortStory!=null){d.caption.setHtml(d.article.shortStory)}}}else{if(d.article.shortStory!=null){d.caption.setHtml(d.article.shortStory)}}d.setSelectedImage(a)}else{if(d.images[a].caption!=null){if(d.images[a].caption.trim().length>0){d.caption.setHtml(d.images[a].caption)}else{d.caption.setHtml("")}}d.setSelectedImage(a)}}var f=(parseFloat(a)+1)+" of "+d.images.length;if(d.url!=null){if(d.data!=null){d.fireEvent("ogalleryinitialized",d,d.data,f)}}else{var c=d.article.byline;if(d.article.reporters!=null&&d.article.reporters.length>0){for(var b in d.article.reporters){c+=", "+d.article.reporters[b].name}}var e={author:c,contentTitle:d.article.headline,contentType:"photolist"};d.fireEvent("ogalleryinitializedArticle",d,e,f)}},setSelectedImage:function(b){var f=this;var e=f.imageScroller.getItems().items;for(var d=0;d<e.length;d++){if(e[d].element.dom.style.border!=""){e[d].element.dom.style.border=""}}e[b].element.dom.style.border="2px solid white";var c=e[b].element.dom.offsetLeft-10;var a=f.imageScroller.getScrollable().getScroller();if(c<=0){a.scrollTo(0)}else{if(c>=a.maxPosition.x){a.scrollTo(a.maxPosition.x)}else{a.scrollTo(c)}}},next:function(){var a=this;a.carousel.next()},previous:function(){var a=this;a.carousel.previous()},resizeGalleryChrome:function(){var a=this;a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10)},resizeGallery:function(){var a=this;a.carousel.onSizeChange();a.galleryInfo.setHeight($(a.galleryContent.element.dom).height()-$(a.closeBtnRow.element.dom).height()-$(a.galleryCounterPanel.element.dom).height()-10)},setupCarousel:function(){var a=this;a.carousel=Ext.create("InfinityMobile.view.ImageCarousel",{width:"100%",height:"100%",data:a.images,pageNo:1,pageTemplate:function(c,e,b){if(c!=null){var d=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:c,position:parseInt(c.index),pageNo:e});return d}}});a.imageCarousel.add(a.carousel);a.carousel.on({activeitemchange:a.handleItemChange,scope:a})}},0,["readerogallery"],["component","container","readerogallery"],{component:true,container:true,readerogallery:true},["widget.readerogallery"],0,[InfinityMobile.view.desktop,"ReaderOGallery"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.LightboxLink",Ext.Container,{config:{style:"padding:0px; border-radius:0px; background-color:white;",cls:"innerhtmlfullheight",modal:true,centered:true,hideOnMaskTap:true,height:1000,width:1000,maxHeight:"80%",maxWidth:"80%",layout:"vbox",zIndex:20,items:[{itemId:"topBar",height:40,layout:"hbox",items:[{itemId:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{flex:1,itemId:"content"}]},initialize:function(){var a=this;a.topBar=a.getComponent("topBar");a.topBar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});a.closeButton=a.topBar.getComponent("toolBarClose");a.setCloseButtonListenter();a.content=a.getComponent("content");if(a.config.mediaObject!=null){a.mediaObject=a.config.mediaObject;a.loadMediaObject()}},setCloseButtonListenter:function(){var a=this;a.closeButton.element.on("tap",function(){a.hide()})},loadMediaObject:function(){var b=this;if(b.mediaObject.url!=null){var a=b.mediaObject.url;b.content.setHtml("<iframe src='"+a+"' width='100%' height='100%' style='border:none' onload='' ></iframe>")}}},0,["lightboxlink"],["component","container","lightboxlink"],{component:true,container:true,lightboxlink:true},["widget.lightboxlink"],0,[InfinityMobile.view.desktop,"LightboxLink"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.HowToDPS",Ext.Container,{config:{height:50,width:0,cls:"howto-dps how-to-item",modal:{opacity:0},items:[{itemid:"graphic2",cls:"dps-howto",width:270,height:165,left:-141,top:-30,style:"background-image:url(resources/images/howto/double_page_icon.png);background-size:contain;background-position:center;background-repeat:no-repeat;"}]},initialize:function(){var a=this;a.getModal().setStyle({opacity:0})}},0,["howtoeditionoptions"],["component","container","howtoeditionoptions"],{component:true,container:true,howtoeditionoptions:true},["widget.howtoeditionoptions"],0,[InfinityMobile.view.desktop,"HowToDPS"],0));(Ext.cmd.derive("InfinityMobile.profile.desktop",Ext.app.Profile,{config:{name:"desktop",views:["ReaderSpecialSupplements","ArticleReaderMenu","ArticleReaderItemInterstitialContainer","ArticleReaderItemInterstitial","ArticleReaderItemWeatherTile","ArticleReaderItemTopStoryItem","ArticleReaderItemTopStories","ArticlePopoverItemDynamic","ArticleReaderItemMedWideTall","ArticleReaderItemMedTall","ArticleReaderItemMedWide","ArticleReaderBannerAd","ArticleReaderItemContainer","ArticleReaderItemSmall","ArticleReaderItemLrg","ReaderArticlePopover","ArticlePopoverInterstitial","ReaderArticlePopoverItem","DesktopPageViewer","LayoutToolBarView","LayoutToolBarIconView","LayoutToolBarToggleIconView","ReaderToolbarShareMenu","HowToEditionOptions","HowToPageControl","HowToViewOptions","HowToReader","DynamicArticlesInterstitialContainer","DynamicArticlesInterstitial","HowToMenuIcon","HowToArticlesContainer","SmallViewTileWide","SmallViewTileSmall","SmallViewTileMed","SmallViewTileWeather","SmallViewTileWeatherContainer","SectionListOverlay","SectionListOverlayItem","ZonesOverlay","ZonesOverlayItem","ReaderArchive","ReaderDownload","ReaderBookmark","PrintMenu","ClippingOptionsMenu","ArticleReaderFullscreenGalleryIcon","ArticleReaderTextSizeIcon","ImageGallery","ArchiveSelector","readerTerms","ReaderFree","ReaderPuzzlePopoverItem","ReaderPuzzleArchive","ExtraTopBar","ReaderOGallery","LightboxLink","HowToDPS"]},viewport:{autoMaximize:true},isActive:function(){return Ext.os.is.Desktop},launch:function(){}},0,0,0,0,0,0,[InfinityMobile.profile,"desktop"],0));(Ext.cmd.derive("InfinityMobile.view.CustomCheckbox",Ext.Container,{config:{checked:false,height:30,width:30,html:'<i class="fa fa-check" aria-hidden="true"></i>',style:"font-size:25px;"},initialize:function(){var a=this;a.checked=a.config.checked;a.element.on("tap",a.onTap)},isChecked:function(){return this.checked},check:function(){this.checked=true;this.addCls("checkbox-checked")},uncheck:function(){this.checked=false;this.removeCls("checkbox-checked")}},0,["customcheckbox"],["component","container","customcheckbox"],{component:true,container:true,customcheckbox:true},["widget.customcheckbox"],0,[InfinityMobile.view,"CustomCheckbox"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderView",InfinityMobile.view.LayoutView,{config:{layout:"vbox",items:[{itemId:"mainContainer",layout:"hbox",flex:1,items:[{itemId:"leftPadding",width:180},{itemId:"readerContainer",flex:1,style:"position:relative;overflow-x:hidden;overflow-y:visible;"},{itemId:"rightPadding",width:180}]},{itemId:"bottomContainer",height:110}]},initialize:function(){var a=this;InfinityMobile.view.LayoutView.prototype.initialize.apply(this,arguments);a.mainContainer=a.getComponent("mainContainer");a.leftPadding=a.mainContainer.getComponent("leftPadding");a.readerContainer=a.mainContainer.getComponent("readerContainer");a.rightPadding=a.mainContainer.getComponent("rightPadding");a.bottomContainer=a.getComponent("bottomContainer");if(settings.reader.wrapAd==null){a.leftPadding.hide();a.rightPadding.hide()}else{a.setupWrapAdPadding()}},setupWrapAdPadding:function(){var a=this;if((typeof isTribReader!="undefined"&&isTribReader==true)||settings.reader.enableReaderPadding=="true"){a.leftPadding.element.dom.style.padding="10px 0px";a.rightPadding.element.dom.style.padding="10px 0px"}}},0,["readerview"],["component","container","layoutview","readerview"],{component:true,container:true,layoutview:true,readerview:true},["widget.readerview"],0,[InfinityMobile.view,"ReaderView"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSpecialSupplementsItem",Ext.Container,{config:{style:"float:left;border:1px solid grey",editionGuid:"",editionName:"",items:[{itemId:"archiveItemLabel",bottom:0,width:"100%",padding:"5 0 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initialize:function(){var a=this;a.publicationGuid=a.config.publicationGuid;a.publicationName=a.config.publicationName;a.editionGuid=a.config.editionGuid;a.editionLabel=a.getComponent("archiveItemLabel");var b="https://edition.pagesuite-professional.co.uk//get_image.aspx?w=280&eid="+a.editionGuid;a.setHtml("<img class=\"pointerCursor\" style='width:100%' src='"+b+"' />");a.editionLabel.setHtml(a.publicationName);a.addCls("pointerCursor");if(a.config.type==null){a.element.on({tap:"onTap",scope:a})}else{if(a.config.type=="zones"){a.element.on({tap:function(){window.location.href="default.aspx?pubid="+a.publicationGuid}})}}},onTap:function(){var a=this;window.open("default.aspx?pubid="+a.publicationGuid+"&edid="+a.editionGuid)}},0,["specialsupplementsitem"],["component","container","specialsupplementsitem"],{component:true,container:true,specialsupplementsitem:true},["widget.specialsupplementsitem"],0,[InfinityMobile.view,"ReaderSpecialSupplementsItem"],0));(Ext.cmd.derive("InfinityMobile.view.StoryWindowPreferences",Ext.Container,{config:{id:"archivecontainer",modal:true,fullscreen:true,centered:true,width:700,style:"padding:0px;max-height:700px;",items:[{id:"toolbar",height:40,items:[{itemId:"title",top:10,left:10},{id:"toolbarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"bodyContainer",layout:"vbox",flex:1,style:"background-color:white;",items:[{itemId:"containerText",margin:20,html:"If you turn this setting off, you will always return to the last page of the paper you viewed."},{itemId:"toggleSetting",padding:"20 20",margin:"0 0 40 0",style:"background-color:#eeeeee;",html:"Return to page featuring last story viewed: <input class='pointerCursor' type='checkbox' style='margin-left:5px;top:2px;float:right;width:15px;height:15px;' class=\"pointerCursor\" onclick='if(this.checked){ this.checked = false; } else{ this.checked = true }' ></input>"}]}]},initialize:function(){var b=this;var a=b.getComponent("toolbar");b.toolbarClose=a.getComponent("toolbarClose");b.bodyContainer=b.getComponent("bodyContainer");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 1)"});b.title=a.getComponent("title");b.title.setHtml("Window Story Preferences");b.setToggleListener();b.setCloseListener();b.checkCurrentSetting()},setCloseListener:function(){var b=this;b.toolbarClose.element.on("tap",function(){b.close()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.toolbarClose.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}}},close:function(){var a=this;a.destroy()},setToggleListener:function(){var a=this;a.toggle=a.bodyContainer.getComponent("toggleSetting");a.toggle.element.on({tap:a.toggleCheck,scope:a})},toggleCheck:function(){var b=this;var d=$(b.toggle.element.dom).find("input");if(d.length>0){var c=d[0];if(c.checked){c.checked=false;try{localStorage.setItem("returnToPage"+publicationguid,"false")}catch(a){}}else{c.checked=true;try{localStorage.setItem("returnToPage"+publicationguid,"true")}catch(a){}}}},checkCurrentSetting:function(){var c=this;try{var b=localStorage.getItem("returnToPage"+publicationguid);var e=$(c.toggle.element.dom).find("input");if(b!=null&&e.length>0){var d=e[0];if(b=="true"){d.checked=true}else{if(b=="false"){d.checked=false}}}}catch(a){}}},0,["storywindowpreferences"],["component","container","storywindowpreferences"],{component:true,container:true,storywindowpreferences:true},["widget.storywindowpreferences"],0,[InfinityMobile.view,"StoryWindowPreferences"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPuzzleArchive",Ext.Container,{config:{layout:"vbox",height:"100%",cls:"puzzleArchive",items:[{itemId:"topbar",height:40,style:"color: #4591B8",layout:{type:"hbox",align:"center"},items:[{itemId:"back",cls:"pointerCursor",width:150,padding:"10 0 0 20",height:"100%",layout:"hbox",style:"font-size:18px",items:[{html:"<img style='height:20px' src='../assets/article view/left-article-arrow.png' />"},{html:"Back",padding:"0 0 0 5"}]},{itemId:"title",flex:1,style:"text-align:center; font-size:22px; font-weight:bold; color:black",html:"Archive"},{width:150}]},{itemId:"containerScroll",flex:1,scrollable:{direction:"vertical",directionLock:true,indicators:false},items:[{itemId:"container",flex:1,defaults:{cls:"puzzlearchiveitem"}}]},{itemId:"archiveControl",bottom:0,width:"100%",height:40,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"previous",style:"color:#4591B8",html:"Previous",cls:"pointerCursor",zIndex:6,flex:1,left:0,top:20},{itemId:"pages",style:"color:#4591B8;text-align:center;",top:20,width:"100%",layout:{type:"hbox",pack:"center",align:"middle"}},{itemId:"next",style:"color:#4591B8",html:"Next",flex:1,right:0,top:20,cls:"pointerCursor"}]}]},initialize:function(){var a=this;var b=a.getComponent("topbar");a.backButton=b.getComponent("back");a.archiveControl=a.getComponent("archiveControl");a.containerScroll=a.getComponent("containerScroll");a.container=a.getComponent("containerScroll").getComponent("container");a.setBackListener();a.config.puzzleArchiveParent.bottomBar.hide();a.setHeight($(a.config.puzzleArchiveParent.element.dom).height());a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height=$(a.config.puzzleArchiveParent.element.dom).height()+"px";a.containerScroll.setHeight($(a.element.dom).height()-80);a.resizeFunction=function(){a.setHeight($(a.config.puzzleArchiveParent.element.dom).height());a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height=$(a.config.puzzleArchiveParent.element.dom).height()+"px";a.containerScroll.setHeight($(a.element.dom).height()-80)};Ext.Viewport.on({resize:a.resizeFunction});a.location=0;a.pagesControl=a.archiveControl.getComponent("pages");a.previous=a.archiveControl.getComponent("previous");a.next=a.archiveControl.getComponent("next");a.next.element.on({tap:function(){a.fireEvent("archiveNextPage",a)}});a.previous.element.on({tap:function(){a.fireEvent("archivePreviousPage",a)}});a.fireEvent("initialized",a)},setBackListener:function(){var a=this;a.backButton.element.on("tap",function(){a.config.puzzleArchiveParent.bottomBar.show();a.config.puzzleArchiveParent.element.down(".x-innerhtml").dom.style.height="";Ext.Viewport.removeListener("resize",a.resizeFunction);a.fireEvent("back",a)})}},0,["readerpuzzlearchive"],["component","container","readerpuzzlearchive"],{component:true,container:true,readerpuzzlearchive:true},["widget.readerpuzzlearchive"],0,[InfinityMobile.view,"ReaderPuzzleArchive"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSectionPopupItem",Ext.Container,{config:{style:"font-size:14px;color:#cccccc;border-bottom:1px solid #e1e1e1;",height:50,padding:"15px 5px",width:"100%",cls:"pointerCursor",name:"",pageNumber:""},initialize:function(){var a=this;a.name=a._name;a.pageNumber=a._pageNumber;if(a.config.type!=null){a.type=a.config.type}if(a.config.articleIndex!=null){a.articleIndex=a.config.articleIndex}a.setHtml(a.name);a.element.on({tap:"onTap",scope:a})},onTap:function(b){var a=this;b.stopPropagation();a.fireEvent("jumpToSectionPage",a.articleIndex)}},0,["readersectionpopupitem"],["component","container","readersectionpopupitem"],{component:true,container:true,readersectionpopupitem:true},["widget.readersectionpopupitem"],0,[InfinityMobile.view,"ReaderSectionPopupItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSectionPopup",Ext.Container,{config:{width:200,height:300,layout:"hbox",style:"transition:all 0.5s ease;background-color:rgba(30,30,30,0.9);transform:translateX(40%);max-height:0px;overflow:hidden;",modal:{cls:"transparentMask sectionpopupmask"},cls:"sectionpopup",centered:true,hideOnMaskTap:true,items:[{layout:"vbox",itemId:"sectionbtns",width:"100%",flex:1,items:[{itemId:"sectionsHeader",width:"100%",height:30,padding:5,style:"background-color:#e1e1e1;",html:"Sections",items:[{itemId:"closeBtn",padding:7,top:0,right:0,html:'<img class="pointerCursor" src="../assets/reader icons/close-btn-black.png" style="height:15px;" />'}]},{itemId:"sectionsContainer",flex:1,style:"overflow-y:auto",width:"100%"}]}]},initialize:function(){var a=this;a.sectionBtns=a.getComponent("sectionbtns");a.sectionsHeader=a.sectionBtns.getComponent("sectionsHeader");a.closeBtn=a.sectionsHeader.getComponent("closeBtn");a.sectionsContainer=a.sectionBtns.getComponent("sectionsContainer");a.closeBtn.element.on("tap",function(){a.hide()});if(navigator.maxTouchPoints){$(a.sectionsContainer.element.dom).css("overflow-y","");a.sectionsContainer.setScrollable({direction:"vertical"})}a.on("painted",function(){a.setZIndex(9999);a.getModal().setZIndex(9998);a.fireEvent("loadSectionsPopup",a,a.sectionsContainer);a.element.dom.style.maxHeight="300px"})},hide:function(){var a=this;a.element.dom.style.maxHeight="0px";setTimeout(function(){a.destroy()},500)}},0,["sectionpopup"],["component","container","sectionpopup"],{component:true,container:true,sectionpopup:true},["widget.sectionpopup"],0,[InfinityMobile.view,"ReaderSectionPopup"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderEdgeBrowserPopup",InfinityMobile.view.Overlay,{config:{width:300,height:450,style:"padding:0px",layout:"vbox",hideOnMaskTap:false,items:[{itemId:"languageToolBar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>Microsoft Edge</b>"},{itemId:"downloadToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"languageContent",layout:"vbox",padding:20,flex:1,items:[{flex:1,html:'We have noticed that you\'re using Microsoft Edge. If you are using a touchscreen device, please make sure you enable touch events to make use of the touch features on the reader.<br /><br />To achieve this, open a new tab and type "about:flags", scroll down to the "Touch" section and select "Always on" or "Only on when a touchscreen is detected" for "Enable touch events". '},{itemId:"languageButtonsContainer",height:40,layout:"hbox",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"updateButton",flex:1,style:"background-color:#458fbb; color:white",items:[{html:"Ok"}]}]}]}]},initialize:function(){var d=this;console.log("INITIALIZE");var b=d.getComponent("languageToolBar");d.closeButton=b.getComponent("downloadToolBarClose");var a=d.getComponent("languageContent");var c=a.getComponent("languageButtonsContainer");d.updateButton=c.getComponent("updateButton");d.cancelButton=c.getComponent("cancelButton");d.setCloseListener();d.setUpdateListener()},setCloseListener:function(){var a=this;a.closeButton.element.on("tap",function(){a.destroy();try{localStorage.setItem("edgePrompt"+publicationguid,"true")}catch(b){}})},setUpdateListener:function(){var a=this;a.updateButton.element.on("tap",function(){a.destroy();try{localStorage.setItem("edgePrompt"+publicationguid,"true")}catch(b){}})}},0,["readeredgebrowser"],["component","container","panel","overlay","readeredgebrowser"],{component:true,container:true,panel:true,overlay:true,readeredgebrowser:true},["widget.readeredgebrowser"],0,[InfinityMobile.view,"ReaderEdgeBrowserPopup"],0));(Ext.cmd.derive("InfinityMobile.view.BackgroundWrapAdItem",Ext.Container,{config:{width:160,margin:10,zIndex:10000,cls:"pointerCursor wrap-ad",items:[{itemId:"adContainer"}]},initialize:function(){var a=this;if(a.config.side!=null){a.side=a.config.side}if(a.config.bottom!=null){a.bottom=a.config.bottom}if(a.side=="left"){a.addCls("leftWrapper")}else{if(a.side=="right"){a.addCls("rightWrapper")}}if(a.config.pageNo!=null){a.pageNo=a.config.pageNo}a.setAdvert(a.pageNo);if(settings.reader.wrapAd.hideWrapperOnPortrait!=null){if(settings.reader.wrapAd.hideWrapperOnPortrait=="true"){if($(window).width()/$(window).height()<=1.4){a.addCls("hideWrapper")}Ext.Viewport.on("resize",function(){a.fireEvent("resizeWrapAds",a)})}}},setAdvert:function(c){var b=this;var a=settings.reader.wrapAd.type;switch(a){case"image":b.setupImageAdvert();break;case"dfp":b.setupDfpAdvert();break;case"url":b.setupUrlAdvert(c);break}},destroyAdvert:function(){var a=this;a.removeAll(true,true)},setupUrlAdvert:function(a){var c=this;c.advertDivId=c.id+"wrapadvert";var b="";if(settings.reader.wrapAd.url!=null){b=settings.reader.wrapAd.url}if(b.indexOf("?")==-1){b+="?side="+c.side+"&pubid="+publicationguid+"&pnum="+a}else{b+="&side="+c.side+"&pubid="+publicationguid+"&pnum="+a}c.setHtml("<iframe id='"+c.advertDivId+"' style='border:none;width:160px;height:600px;float:"+c.side+";' src='"+b+"' scrolling='no'></iframe>");c.on("painted",c.loadUrlAdvert,c,{delay:10,single:true})},loadUrlAdvert:function(){var b=this;var a=$(b.element.dom).find("iframe");b.resizeAdvert();Ext.Viewport.on({resize:b.resizeAdvert,scope:b})},setupDfpAdvert:function(){var a=this;a.networkCode=settings.reader.wrapAd.networkCode;a.adUnit=settings.reader.wrapAd.adUnit;a.advertDivID=a.id+"wrapadvert";if(settings.reader.wrapAd.dfpAdType=="skyscraper"){a.adWidth="160";a.adHeight="600"}else{a.adWidth="300";a.adHeight="250"}a.setHtml("<div id='"+a.advertDivID+"'  ></div>");a.on("painted",a.loadDfpAdvert,a,{delay:10,single:true});Ext.Viewport.on({resize:a.resizeAdvert,scope:a})},loadDfpAdvert:function(){var a=this;googletag.cmd.push(function(){a.adslot=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[parseInt(a.adWidth),parseInt(a.adHeight)],a.advertDivID).addService(googletag.pubads().updateCorrelator());googletag.enableServices();googletag.display(a.advertDivID)});a.resizeAdvert()},resizeAdvert:function(){var c=this;var b=$(c.element.dom).find("iframe");if(b[0]!=null){var f=$("#"+c.advertDivID)[0];var a=b[0].contentDocument;var e=c.element.dom.offsetParent;var d=1;if(settings.reader.wrapAd.type=="dfp"){if(settings.reader.wrapAd.dfpAdType=="skyscraper"){if($(a).height()>$(e).height()-40){d=($(e).height()-40)/$(a).height()}}else{if($(a).width()>$(e).width()-20){d=($(e).width()-20)/$(a).width()}}}else{if(settings.reader.wrapAd.type=="url"){if($(a).height()>$(e).height()-40){d=($(e).height()-40)/$(a).height()}}}c.applyTransform(f,d)}},applyTransform:function(c,b){var a=this;if(settings.reader.wrapAd.dfpAdType=="skyscraper"){a.element.dom.style.transformOrigin="50% 100%"}else{if(a.side=="left"){a.element.dom.style.transformOrigin="0% 100%"}else{a.element.dom.style.transformOrigin="100% 100%"}}a.element.dom.style.transform="scale3d("+b+", "+b+", 1)"},setupImageAdvert:function(){var a=this;if(a.side=="left"){a.img=settings.reader.wrapAd.leftSideImage;a.url=settings.reader.wrapAd.leftSideLink}else{a.img=settings.reader.wrapAd.rightSideImage;a.url=settings.reader.wrapAd.rightSideLink}a.setStyle({backgroundImage:"url("+a.img+")",backgroundPosition:"bottom center",backgroundSize:"contain",backgroundRepeat:"no-repeat",height:"calc(100% - "+(a.bottom+50)+"px)"});a.element.on({tap:a.imgTap,scope:a})},imgTap:function(){var a=this;window.open(a.url)}},0,["backgroundwrapaditem"],["component","container","backgroundwrapaditem"],{component:true,container:true,backgroundwrapaditem:true},["widget.backgroundwrapaditem"],0,[InfinityMobile.view,"BackgroundWrapAdItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPagesItem",Ext.Panel,{config:{style:"text-align:center;",cls:"reader-pages-item"},initialize:function(){var b=this;if(b.config.imgSrc!=null){b.imgSrc=b.config.imgSrc}b.img=b.element.down("img").dom;if(!Ext.os.is.Phone){var a=Ext.getStore("SettingStore").data.items[0].raw;if(a.topbar.smallLogo!=null){var c=a.topbar.smallLogo}else{var c=a.topbar.logo}b.img.src=c;b.img.style.maxWidth="140px";b.img.style.maxHeight="180px";b.img.style.width="";b.imgLoaded=false}else{b.img.src=b.imgSrc}},loadImage:function(){var b=this;if(!b.imgLoaded){var a="";if(typeof latestLM!="undefined"){a="&lm="+latestLM}b.img.src=b.imgSrc+a;b.img.onload=function(){b.img.style.maxWidth="";b.img.style.maxHeight="";b.img.style.width="140px"};b.imgLoaded=true}}},0,["readerpagesitem"],["component","container","panel","readerpagesitem"],{component:true,container:true,panel:true,readerpagesitem:true},["widget.readerpagesitem"],0,[InfinityMobile.view,"ReaderPagesItem"],0));(Ext.cmd.derive("InfinityMobile.view.PrintPreview",Ext.Container,{config:{height:"0px",width:"0%",modal:true,fullscreen:true,hideOnMaskTap:true,centered:true,style:"border-radius:10px",zIndex:11111},initialize:function(){var c=this;c.delayImage=800;if(c.config.delayImages!=null){c.delayImage=c.config.delayImages}if(c.config.imgCheck!=null){c.imgCheck=c.config.imgCheck}else{c.imgCheck=false}var a="0px";var b="0px";if(Ext.os.is.Android){a=$(document).height()+"px";b=$(document).width();$(c.element.dom).css("visibility","hidden")}if(!Ext.os.is.Desktop){c.setLeft(0)}c.setHtml("<iframe id='printIframe' name='printIframe' style='height:"+a+";width:"+b+";border:none;' ></iframe>");c.element.on({painted:function(){var e=this;var d=document.getElementById("printIframe");e.iframe=d.contentWindow?d.contentWindow:(d.contentDocument.document?d.contentDocument.document:d.contentDocument);e.iframe.document.write(e.config.doc);e.print()},scope:c})},print:function(){var b=this;b.iframe.focus();if(b.imgCheck&&!Ext.browser.is.Firefox){var a=$(b.iframe.document).find("img");var c=1000+(a.length*b.delayImage);Ext.Viewport.setMasked({xtype:"loadmask",message:"Loading"});setTimeout(function(){Ext.Viewport.setMasked(false);if(Ext.browser.is.IE){b.iframe.document.execCommand("print",false,null);b.hide()}else{if(Ext.os.is.Android){$(b.element.dom).css("visibility","visible")}b.iframe.print();if(Ext.os.is.Desktop){b.hide()}else{$(b.element.dom).css("visibility","hidden")}}},c)}else{if(Ext.browser.is.IE){b.iframe.document.execCommand("print",false,null);b.hide()}else{b.iframe.print();b.hide()}}},hide:function(){var a=this;a.destroy()}},0,["printpreview"],["component","container","printpreview"],{component:true,container:true,printpreview:true},["widget.printpreview"],0,[InfinityMobile.view,"PrintPreview"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingLoad",Ext.Container,{config:{fullscreen:true,modal:true,items:[{itemID:"container",centered:true,height:150,width:150,layout:"vbox",defaults:{margin:10},style:{backgroundColor:"rgba(0,0,0,0.7)",borderRadius:"5px"},items:[{flex:2,style:{backgroundImage:"url('resources/images/loading.gif')",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"}},{flex:1,style:{color:"white",textAlign:"center"},html:"Clipping"}]}]}},0,["clippingload"],["component","container","clippingload"],{component:true,container:true,clippingload:true},["widget.clippingload"],0,[InfinityMobile.view,"ClippingLoad"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingOptionsMenu",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:700,style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,items:[{itemId:"title",top:10,left:10},{id:"clippingOptionsToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0",html:"<p style='font-size:16px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><p style='font-size:12px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p>"},{itemId:"clippingsContainer",style:"border: 1px solid #e6e6e6;",height:400,scrollable:{direction:"vertical",directionLock:true},defaults:{width:203,height:150,margin:"7 8 16 7",cls:"archiveitemphone"}},{itemId:"buttonsContainer",layout:"hbox",height:60,items:[{itemId:"previewBtn",flex:1,cls:"btn",margin:"15 5 5 0",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/preview-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Preview",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"downloadBtn",flex:1,cls:"btn",margin:"15 5 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/downloads-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Save",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"printBtn",flex:1,cls:"btn",margin:"15 5 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/print-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Print",margin:5,style:"font-size:11pt;text-align:center;"}]},{itemId:"shareBtn",flex:2,cls:"btn",margin:"15 0 5 5",padding:5,layout:{type:"hbox",pack:"center",align:"middle"},items:[{height:30,width:30,style:'background-image:url("resources/images/reader icons/share-white.png");background-size:contain;background-position:center;background-repeat;no-repeat;'},{itemId:"Share",margin:5,style:"font-size:11pt;"}]}]}]}]},initialize:function(){var b=this;b.clippingsToolbar=b.getComponent("clippingOptionsToolBar");b.clippingsToolbar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.closeBtn=b.clippingsToolbar.getComponent("clippingOptionsToolBarClose");b.clippingsBody=b.getComponent("clippingOptionsBodyContainer");b.clippingsContainer=b.clippingsBody.getComponent("clippingsContainer");b.buttonsContainer=b.clippingsBody.getComponent("buttonsContainer");b.previewBtn=b.buttonsContainer.getComponent("previewBtn");b.downloadBtn=b.buttonsContainer.getComponent("downloadBtn");b.printBtn=b.buttonsContainer.getComponent("printBtn");b.shareBtn=b.buttonsContainer.getComponent("shareBtn");b.title=b.clippingsToolbar.getComponent("title");b.title.setHtml(language.clippings.clippingsOptions);b.clippingOptionsContainerText=b.clippingsBody.getComponent("clippingOptionsContainerText");b.clippingOptionsContainerText.setHtml("<p style='font-size:16px;'>"+language.clippings.ClippingsOptionsText+"</p><br /><p style='font-size:12px;color:#444444'>"+language.clippings.clippingsPleaseNote+"</p>");b.previewBtn.getComponent("Preview").setHtml(language.clippings.preview);b.downloadBtn.getComponent("Save").setHtml(language.clippings.save);b.printBtn.getComponent("Print").setHtml(language.clippings.print);b.shareBtn.getComponent("Share").setHtml(language.clippings.share);b.previewBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.downloadBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.printBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.shareBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});b.closeBtn.element.on("tap",function(){b.destroy()});if(settings.newsday!=null){if(settings.newsday.whiteCloseIcon=="true"){var a=$(b.closeBtn.element.dom).find("img");if(a.length>0){a[0].src="resources/images/article-close-btn-white.png"}}b.element.dom.style.borderRadius=""}if(b.config.images!=null){b.images=b.config.images}if(b.config.widths!=null){b.widths=b.config.widths}if(b.config.heights!=null){b.heights=b.config.heights}b.addThumbnails();b.previewBtn.element.on({tap:b.preview,scope:b});b.downloadBtn.element.on({tap:b.download,scope:b});b.printBtn.element.on({tap:b.print,scope:b});b.shareBtn.element.on({tap:b.shareTap,scope:b});if(!Ext.os.is.Desktop){}},preview:function(){var d=this;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c=true;break}}if(c){var a=Ext.create("InfinityMobile.view.ClippingMenuPreview",{images:d.images,clippingMenu:d})}else{d.promptUser(language.clippings.selectClippings)}},download:function(){var f=this;var c=false;if(Ext.os.is.Desktop){for(var b=0;b<f.images.length;b++){if(f.clippingsContainer.innerItems[b].clicked){var e=document.createElement("a");e.target="_blank";e.href=f.images[b];e.download="clipping"+b+".jpg";var d=document.createEvent("MouseEvents");d.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);e.dispatchEvent(d);c=true}}}else{var d=document.createEvent("MouseEvents");var e=null;var a=false;for(var b=0;b<f.images.length;b++){if(f.clippingsContainer.innerItems[b].clicked){if(!c){e=document.createElement("a");e.target="_blank";e.href=f.images[b];e.download="clipping"+b+".jpg";d.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);c=true}else{a=true;break}}}if(a){f.promptUser(language.clippings.selectOneClipping)}else{if(e!=null){e.dispatchEvent(d)}}}if(!c){f.promptUser(language.clippings.selectClippings)}},print:function(){var e=this;var f=false;var d="";for(var c=0;c<e.images.length;c++){var b=e.images[c];if(e.clippingsContainer.innerItems[c].clicked){if(!f){f=true}d+="<div style='width:100%; height:100%; position:relative'>";d+="<img src='"+b+"' style='height:auto;width:auto;max-height:100%;max-width:100%;' />";d+="</div>"}}if(f){var a=Ext.create("InfinityMobile.view.PrintPreview",{imgCheck:true,doc:d});Ext.Viewport.add(a);a.show()}else{e.promptUser(language.clippings.selectClippings)}},shareTap:function(){var d=this;d.shareBtn.removeAll();d.shareBtn.element.dom.style.backgroundColor="#e6e6e6";var b=[{itemId:"email",width:30,height:30,style:'background-image:url("resources/images/reader icons/mail.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"facebook",width:30,height:30,style:'background-image:url("resources/images/reader icons/facebook.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"twitter",width:30,height:30,style:'background-image:url("resources/images/reader icons/twitter.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"linkedin",width:30,height:30,style:'background-image:url("resources/images/reader icons/linkedin.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"google",width:30,height:30,style:'background-image:url("resources/images/reader icons/Google.png");background-size:contain;background-position:center;background-repeat:no-repeat;'},{itemId:"pinterest",width:30,height:30,style:'background-image:url("resources/images/reader icons/pinterest.png");background-size:contain;background-position:center;background-repeat:no-repeat;'}];d.shareBtn.add(b);var a=Ext.getStore("SettingStore");d.emailBtn=d.shareBtn.getComponent("email");d.facebookBtn=d.shareBtn.getComponent("facebook");d.twitterBtn=d.shareBtn.getComponent("twitter");d.linkedinBtn=d.shareBtn.getComponent("linkedin");d.googleBtn=d.shareBtn.getComponent("google");d.pinterestBtn=d.shareBtn.getComponent("pinterest");var c=a.data.items[0].raw.sharing;if(c.allSharing[0]==null){d.emailBtn.hide()}else{d.emailBtn.element.on({tap:d.emailShare,scope:d})}if(c.allSharing[1]==null){d.facebookBtn.hide()}else{d.facebookBtn.element.on({tap:d.facebookShare,scope:d})}if(c.allSharing[2]==null){d.twitterBtn.hide()}else{d.twitterBtn.element.on({tap:d.twitterShare,scope:d})}if(c.allSharing[3]==null){d.linkedinBtn.hide()}else{d.linkedinBtn.element.on({tap:d.linkedinShare,scope:d})}if(c.allSharing[4]==null){d.googleBtn.hide()}else{d.googleBtn.element.on({tap:d.googleShare,scope:d})}if(c.allSharing[5]==null){d.pinterestBtn.hide()}else{d.pinterestBtn.element.on({tap:d.pinterestShare,scope:d})}},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingItems",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingsContainer.add(c);c.show()}},promptUser:function(b){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt",{message:b})},emailShare:function(){var d=this;var e=false;var a="mailto:?subject="+encodeURIComponent("Clippings from "+publicationName)+"&body=";var c="To view a clipping, please select one of the links below:\n";for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){c+=d.images[b]+" \n";e=true}}if(e){window.location.href=a+encodeURIComponent(c)}else{d.promptUser(language.clippings.selectClippings)}},facebookShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=encodeURIComponent(d.images[b]);c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://www.facebook.com/sharer/sharer.php?m2w&u="+a+"&title=Clipping from "+publicationName)}else{d.promptUser(e)}},twitterShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.images[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://twitter.com/intent/tweet?text=Clipping from "+publicationName+" - "+a)}else{d.promptUser(e)}},linkedinShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.images[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://www.linkedin.com/shareArticle?mini=true&url="+a+"&title=Clipping from "+publicationName)}else{d.promptUser(e)}},googleShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.images[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("https://plus.google.com/share?url="+a)}else{d.promptUser(e)}},pinterestShare:function(){var d=this;var a="";var e=null;var c=false;for(var b=0;b<d.images.length;b++){if(d.clippingsContainer.innerItems[b].clicked){if(!c){a=d.images[b];c=true}else{c=false;e=language.clippings.selectOneClipping;break}}}if(c){window.open("http://pinterest.com/pin/create/bookmarklet/?media="+a+"&is_video=false&description=Clipping from "+publicationName)}else{d.promptUser(e)}},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");Ext.Container.prototype.hide.apply(this,arguments)}},0,["clippingoptionsmenu"],["component","container","clippingoptionsmenu"],{component:true,container:true,clippingoptionsmenu:true},["widget.clippingoptionsmenu"],0,[InfinityMobile.view,"ClippingOptionsMenu"],0));(Ext.cmd.derive("InfinityMobile.view.liveNewsTicker",Ext.Container,{config:{padding:"5px"},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.url!=null){a.url=a.config.url}a.str="";setTimeout(function(){loadTicker=function(){$.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q="+encodeURIComponent(a.url),dataType:"json",success:function(d){if(d.responseData.feed&&d.responseData.feed.entries){a.articles=[];$.each(d.responseData.feed.entries,function(g,h){a.str+="<span class='tickerLink' style='font-family:Open Sans, sans-serif;font-size:14px;color:black;' ontouchstart='parent.Click("+(a.articles.length)+")' onclick='parent.Click("+(a.articles.length)+")'>"+h.title+"</span>  &nbsp&nbsp&#9899&nbsp&nbsp  ";a.articles[a.articles.length]=h})}for(var c=0;c<a.articles.length;c++){a.articles[c].sections=[];a.articles[c].sections[0]="LIVE NEWS";a.articles[c].headline=a.articles[c].title;a.articles[c].body=a.articles[c].content;a.articles[c].subHeadline="";a.articles[c].byline=a.articles[c].author;if(a.articles[c].images!=null){var b={url:a.articles[c].images};a.articles[c].images=b}else{if(a.articles[c].mediaGroups!=null){if(a.articles[c].mediaGroups[0].contents!=null){if(a.articles[c].mediaGroups[0].contents[0].thumbnails!=null){var b=[{url:a.articles[c].mediaGroups[0].contents[0].thumbnails[0].url}];a.articles[c].images=b}else{if(a.articles[c].mediaGroups[0].contents[0].url!=null){var b=[{url:a.articles[c].mediaGroups[0].contents[0].url}];a.articles[c].images=b}}}}else{a.articles[c].images=[]}}a.articles[c].live=true;a.articles[c].url=a.articles[c].link;a.articles[c].config={};a.articles[c].config.articleIndex=c}Click=function(e){a.fireEvent("liveNewsTickerArticle",a.articles,e)};a.str=a.str.substring(0,a.str.length-18);a.setHtml('<p class="marqueeLive">'+a.str+"</p>");if(a.elememt!=null){a.element.dom.style.color="black";a.element.dom.style.overflow="hidden"}try{document.styleSheets[0].insertRule("@keyframes marqueeLive {0% { text-indent:100% ;} 100% {text-indent:-"+a.element.dom.children[0].scrollWidth+"px}}",0);if(window.navigator.appName=="Netscape"||window.navigator.appName=="Microsoft Internet Explorer"){a.element.dom.style.animation="marqueeLive 80s linear infinite;"}a.element.down(".marquee").dom.style.display="none";a.element.down(".marquee").dom.offsetHeight;a.element.down(".marquee").dom.style.display="block"}catch(f){console.log(f)}}})};loadTicker();setInterval(loadTicker,180000)},3000)}},0,["livenewsticker"],["component","container","livenewsticker"],{component:true,container:true,livenewsticker:true},["widget.livenewsticker"],0,[InfinityMobile.view,"liveNewsTicker"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderTicker",Ext.Container,{config:{height:40,padding:"5px",style:"background-color:black;color:white;",zIndex:10000000,cls:"tickerLive"},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.url!=null){a.url=a.config.url}if(a.config.num!=null){a.num=a.config.num}a.ruleAdded=false;a.str="";setTimeout(function(){a.loadTicker=function(){$.ajax({url:"../../rssWrapper.aspx?base64url="+encodeURIComponent(btoa(a.url)),dataType:"json",success:function(d){if(d.responseData!=null&&d.responseData.feed&&d.responseData.feed.entries){a.articles=[];a.str="";$.each(d.responseData.feed.entries,function(g,h){a.str+="<span class='tickerLink' style='font-family:Open Sans, sans-serif;font-size:14px;color:white;' ontouchstart='parent.Click("+(a.articles.length)+")' onclick='parent.Click("+(a.articles.length)+")'>"+h.title+"</span>  &nbsp&nbsp&#9899&nbsp&nbsp  ";a.articles[a.articles.length]=h})}for(var c=0;c<a.articles.length;c++){a.articles[c].sections=[];a.articles[c].sections[0]="LIVE NEWS";a.articles[c].headline=a.articles[c].title;a.articles[c].body=a.articles[c].content;a.articles[c].subHeadline="";a.articles[c].byline=a.articles[c].author;if(a.articles[c].images!=null){var b={url:a.articles[c].images};a.articles[c].images=b}else{if(a.articles[c].mediaGroups!=null){if(a.articles[c].mediaGroups[0].contents!=null){if(a.articles[c].mediaGroups[0].contents[0].thumbnails!=null){var b=[{url:a.articles[c].mediaGroups[0].contents[0].thumbnails[0].url}];a.articles[c].images=b}else{if(a.articles[c].mediaGroups[0].contents[0].url!=null){var b=[{url:a.articles[c].mediaGroups[0].contents[0].url}];a.articles[c].images=b}}}}else{a.articles[c].images=[]}}a.articles[c].live=true;a.articles[c].url=a.articles[c].link;a.articles[c].config={};a.articles[c].config.articleIndex=c}Click=function(e){a.fireEvent("liveNewsTickerArticle",a.articles,e)};a.str=a.str.substring(0,a.str.length-18);a.setHtml('<p class="marquee">'+a.str+"</p>");if(a.elememt!=null){a.element.dom.style.color="black";a.element.dom.style.overflow="hidden"}try{document.styleSheets[0].insertRule("@keyframes marqueeAnim {0% { text-indent:100%;} 100% {text-indent:-"+a.element.dom.children[0].scrollWidth+"px}}",0);if(window.navigator.appName=="Netscape"||window.navigator.appName=="Microsoft Internet Explorer"){a.element.dom.style.animation="marqueeAnim 80s linear infinite;";a.element.dom.style.animationDelay="5s"}a.element.down(".marquee").dom.style.display="none";a.element.down(".marquee").dom.offsetHeight;a.element.down(".marquee").dom.style.display="block"}catch(f){console.log(f)}}})};a.loadTicker();setInterval(a.loadTicker,180000)},3000)}},0,["livenewsticker"],["component","container","livenewsticker"],{component:true,container:true,livenewsticker:true},["widget.livenewsticker"],0,[InfinityMobile.view,"ReaderTicker"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMediaObject",Ext.Container,{config:{baseCls:"mediaObject",mediaObject:""},beforeInitialize:function(){var a=this;a.styleString=""},initialize:function(){var b=this;b.mediaObject=b.getMediaObject();b.setMediaObjectStyle();if(b.mediaObject.animType!=null&&b.mediaObject.animType!=""){b.setAnimations()}if(b.mediaObject.isTrigger=="true"){var a=b.mediaObject.url.replace("http://","");if(a.length>0){b.addCls("pointerCursor");b.element.on("tap",function(){b.fireEvent("triggerMedia",a)})}}},setAnimations:function(){var a=this;a.appearDelay=1000*parseFloat(a.mediaObject.delayTime);a.removeDelay=1000*parseFloat(a.mediaObject.removeDelay);a.duration=parseFloat(a.mediaObject.duration);a.durationMili=a.duration*1000;if(a.mediaObject.appear!="TRIGGER"){a.element.dom.style.visibility=""}if(a.mediaObject.appear=="DELAY"){a.element.dom.style.opacity="0";setTimeout(function(){a.appearAnim()},a.appearDelay)}else{if(a.mediaObject.animType!="NONE"&&a.mediaObject.appear!="TRIGGER"){a.appearAnim();a.appearDelay=0}else{if(a.mediaObject.appear=="TRIGGER"){}}}if(a.mediaObject.remove=="CLICKED"){a.element.on({tap:a.removeAnim,scope:a})}},setMediaObjectStyle:function(){var b=this;var a="";a="position:absolute;";a+="top:"+b.mediaObject.y+"%;";a+="left:"+b.mediaObject.x+"%;";a+="width:"+b.mediaObject.width+"%;";a+="height:"+b.mediaObject.height+"%;";a+="z-index:"+b.mediaObject.depthIndex+";";var d=hexToRgb(b.mediaObject.backgroundColor);var c=b.mediaObject.backgroundAlpha;if(b.mediaObject.backgroundAlpha!=""){if(b.mediaObject.backgroundAlpha>1){c=(b.mediaObject.backgroundAlpha/100)}}else{c=0}a+="background:rgba("+d+","+c+");";b.element.dom.style.border="none";if(b.mediaObject.showBorder){a+="border:1px solid #"+b.mediaObject.borderColor+";"}b.styleString+=a;b.setStyle(b.styleString)},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},appearAnim:function(){var a=this;if(a.mediaObject.animType!=null){switch(a.mediaObject.animType.toLowerCase()){case"fade":a.fadeInAnim();break;case"fly":a.flyInAnim();break;case"bounce":a.bounceInAnim();break;case"elastic":a.elasticIn();break;default:a.element.dom.style.opacity=1}}if(a.mediaObject.remove=="AFTER"){a.afterDuration=a.removeDelay+a.durationMili;setTimeout(function(){a.removeAnim()},parseFloat(a.afterDuration))}},fadeInAnim:function(){var a=this;switch(a.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.webkitAnimation="fadeIn "+a.mediaObject.duration+"s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.animation="fadeIn "+a.mediaObject.duration+"s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.mozAnimation="fadeIn "+a.mediaObject.duration+"s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.msAnimation="fadeIn "+a.mediaObject.duration+"s forwards";break;default:document.styleSheets[0].insertRule("@keyframes fadeIn { 0%{ opacity:0; } 100%{ opacity:1; } }",0);a.element.dom.style.animation="fadeIn "+a.mediaObject.duration+"s forwards";break}},flyInAnim:function(){var b=this;var c="LEFT";var a="flyInLeft";if(b.mediaObject.entryDir!=null&&b.mediaObject.entryDir!=""&&b.mediaObject.entryDir!="NONE"){c=b.mediaObject.entryDir}switch(c){case"LEFT":a="flyInLeft";break;case"TOP":a="flyInTop";break;case"RIGHT":a="flyInRight";break;case"BOTTOM":a="flyInBottom";break}switch(b.getPrefix().css){case"-webkit-":b.element.dom.style.webkitAnimation=a+" "+b.duration+"s forwards";break;case"-moz-":if(Ext.os.is.Desktop){b.element.dom.style.animation=a+" "+b.duration+"s 0s forwards"}else{b.element.dom.style.mozAnimation=a+" "+b.duration+"s forwards"}break;case"-ms-":b.element.dom.style.msAnimation=a+" "+b.duration+"s forwards";break;default:b.element.dom.style.animation=a+" "+b.duration+"s forwards"}},bounceInAnim:function(){var c=this;var a=c.element.dom.style.left;if(a.indexOf("%")!=-1){a=parseFloat(a.substring(0,a.length-1))-30;a=a+"%"}var d=c.element.dom.style.left;if(d.indexOf("%")!=-1){d=parseFloat(d.substring(0,d.length-1))-15;d=d+"%"}var b=c.element.dom.style.left;if(b.indexOf("%")!=-1){b=parseFloat(b.substring(0,b.length-1))-7;b=b+"%"}var e=c.element.dom.style.left;if(e.indexOf("%")!=-1){e=parseFloat(e.substring(0,e.length-1))-2;e=e+"%"}switch(c.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes bounceIn { 0%{ -webkit-transform:translate3d(-300%,0px,0px);opacity:0.2; } 30%{ -webkit-transform:translate3d(0%,0px,0px);opacity:1; }  50%{ -webkit-transform:translate3d("+a+",0px,0px);opacity:1; }  65%{ -webkit-transform:translate3d(0%,0px,0px);opacity:1; }  75%{ -webkit-transform:translate3d("+d+",0px,0px);opacity:1; }  87%{ -webkit-transform:translate3d(0%,0px,0px);opacity:1; }  92%{ -webkit-transform:translate3d("+b+",0px,0px);opacity:1; } 95%{ -webkit-transform:translate3d(0%,0px,0px);opacity:1; } 97%{ -webkit-transform:translate3d("+e+",0px,0px);opacity:1; } 100%{ opacity:1; } }",0);c.element.dom.style.webkitAnimation="bounceIn "+c.mediaObject.duration+"s linear forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes bounceIn { 0%{ transform:translate3d(-300%,0px,0px);opacity:0.2; } 30%{ transform:translate3d(0%,0px,0px);opacity:1; }  50%{ transform:translate3d("+a+",0px,0px);opacity:1; }  65%{ transform:translate3d(0%,0px,0px);opacity:1; }  75%{ transform:translate3d("+d+",0px,0px);opacity:1; }  87%{ transform:translate3d(0%,0px,0px);opacity:1; }  92%{ transform:translate3d("+b+",0px,0px);opacity:1; } 95%{ transform:translate3d(0%,0px,0px);opacity:1; } 97%{ transform:translate3d("+e+",0px,0px);opacity:1; } 100%{ opacity:1; } }",0);c.element.dom.style.animation="bounceIn "+c.mediaObject.duration+"s linear forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes bounceIn { 0%{ -moz-transform:translate3d(-300%,0px,0px);opacity:0.2; } 30%{ -moz-transform:translate3d(0%,0px,0px);opacity:1; }  50%{ -moz-transform:translate3d("+a+",0px,0px);opacity:1; }  65%{ -moz-transform:translate3d(0%,0px,0px);opacity:1; }  75%{ -moz-transform:translate3d("+d+",0px,0px);opacity:1; }  87%{ -moz-transform:translate3d(0%,0px,0px);opacity:1; }  92%{ -moz-transform:translate3d("+b+",0px,0px);opacity:1; } 95%{ -moz-transform:translate3d(0%,0px,0px);opacity:1; } 97%{ -moz-transform:translate3d("+e+",0px,0px);opacity:1; } 100%{ opacity:1; } }",0);c.element.dom.style.mozAnimation="bounceIn "+c.mediaObject.duration+"s linear forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes bounceIn { 0%{ -ms-transform:translate3d(-300%,0px,0px);opacity:0.2; } 30%{ -ms-transform:translate3d(0%,0px,0px);opacity:1; }  50%{ -ms-transform:translate3d("+a+",0px,0px);opacity:1; }  65%{ -ms-transform:translate3d(0%,0px,0px);opacity:1; }  75%{ -ms-transform:translate3d("+d+",0px,0px);opacity:1; }  87%{ -ms-transform:translate3d(0%,0px,0px);opacity:1; }  92%{ -ms-transform:translate3d("+b+",0px,0px);opacity:1; } 95%{ -ms-transform:translate3d(0%,0px,0px);opacity:1; } 97%{ -ms-transform:translate3d("+e+",0px,0px);opacity:1; } 100%{ opacity:1; } }",0);c.element.dom.style.msAnimation="bounceIn "+c.mediaObject.duration+"s linear forwards";break;default:document.styleSheets[0].insertRule("@keyframes bounceIn { 0%{ transform:translate3d(-300%,0px,0px);opacity:0.2; } 30%{ transform:translate3d(0%,0px,0px);opacity:1; }  50%{ transform:translate3d("+a+",0px,0px);opacity:1; }  65%{ transform:translate3d(0%,0px,0px);opacity:1; }  75%{ transform:translate3d("+d+",0px,0px);opacity:1; }  87%{ transform:translate3d(0%,0px,0px);opacity:1; }  92%{ transform:translate3d("+b+",0px,0px);opacity:1; } 95%{ transform:translate3d(0%,0px,0px);opacity:1; } 97%{ transform:translate3d("+e+",0px,0px);opacity:1; } 100%{ opacity:1; } }",0);c.element.dom.style.animation="bounceIn "+c.mediaObject.duration+"s linear forwards"}},elasticIn:function(){var e=this;var h=e.element.dom.style.left;if(h.indexOf("%")!=-1){h=parseFloat(h.substring(0,h.length))-150;h=h+"%"}var f=e.element.dom.style.left;if(f.indexOf("%")!=-1){f=parseFloat(f.substring(0,f.length))+75;f=f+"%"}var b=e.element.dom.style.left;if(b.indexOf("%")!=-1){b=parseFloat(b.substring(0,b.length))-50;b=b+"%"}var g=e.element.dom.style.left;if(g.indexOf("%")!=-1){g=parseFloat(g.substring(0,g.length))+50;g=g+"%"}var c=e.element.dom.style.left;if(c.indexOf("%")!=-1){c=parseFloat(c.substring(0,c.length))-25;c=c+"%"}var j=e.element.dom.style.left;if(j.indexOf("%")!=-1){j=parseFloat(j.substring(0,j.length))+25;j=j+"%"}var d=e.element.dom.style.left;if(d.indexOf("%")!=-1){d=parseFloat(d.substring(0,d.length))-12;d=d+"%"}var a=e.element.dom.style.left;if(a.indexOf("%")!=-1){a=parseFloat(a.substring(0,a.length))+12;a=a+"%"}switch(e.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes elasticIn { 0%{-webkit-transform:translate3d(-300%,0px,0px);opacity:1;} 12%{-webkit-transform:translate3d("+f+",0px,0px);opacity:1;} 25%{-webkit-transform:translate3d("+b+",0px,0px);opacity:1;} 37%{-webkit-transform:translate3d("+g+",0px,0px);opacity:1;} 50%{-webkit-transform:translate3d("+c+",0px,0px);opacity:1;} 62%{-webkit-transform:translate3d("+j+",0px,0px);opacity:1;} 75%{ -webkit-transform:translate3d("+d+",0px,0px);opacity:1;} 87%{ -webkit-transform:translate3d("+a+",0px,0px);opacity:1;} 100%{-webkit-transform:translate3d(0%,0px,0px);opacity:1;} }",0);e.element.dom.style.webkitAnimation="elasticIn "+e.mediaObject.duration+"s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes elasticIn { 0%{transform:translate3d(-300%,0px,0px);opacity:1;} 12%{transform:translate3d("+f+",0px,0px);opacity:1;} 25%{transform:translate3d("+b+",0px,0px);opacity:1;} 37%{transform:translate3d("+g+",0px,0px);opacity:1;} 50%{transform:translate3d("+c+",0px,0px);opacity:1;} 62%{transform:translate3d("+j+",0px,0px);opacity:1;} 75%{ transform:translate3d("+d+",0px,0px);opacity:1;} 87%{ transform:translate3d("+a+",0px,0px);opacity:1;} 100%{transform:translate3d(0%,0px,0px);opacity:1;} }",0);e.element.dom.style.animation="elasticIn "+e.mediaObject.duration+"s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes elasticIn { 0%{-moz-transform:translate3d(-300%,0px,0px);opacity:1;} 12%{-moz-transform:translate3d("+f+",0px,0px);opacity:1;} 25%{-moz-transform:translate3d("+b+",0px,0px);opacity:1;} 37%{-moz-transform:translate3d("+g+",0px,0px);opacity:1;} 50%{-moz-transform:translate3d("+c+",0px,0px);opacity:1;} 62%{-moz-transform:translate3d("+j+",0px,0px);opacity:1;} 75%{ -moz-transform:translate3d("+d+",0px,0px);opacity:1;} 87%{ -moz-transform:translate3d("+a+",0px,0px);opacity:1;} 100%{-moz-transform:translate3d(0%,0px,0px);opacity:1;} }",0);e.element.dom.style.mozAnimation="elasticIn "+e.mediaObject.duration+"s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes elasticIn { 0%{-ms-transform:translate3d(-300%,0px,0px);opacity:1;} 12%{-ms-transform:translate3d("+f+",0px,0px);opacity:1;} 25%{-ms-transform:translate3d("+b+",0px,0px);opacity:1;} 37%{-ms-transform:translate3d("+g+",0px,0px);opacity:1;} 50%{-ms-transform:translate3d("+c+",0px,0px);opacity:1;} 62%{-ms-transform:translate3d("+j+",0px,0px);opacity:1;} 75%{ -ms-transform:translate3d("+d+",0px,0px);opacity:1;} 87%{ -ms-transform:translate3d("+a+",0px,0px);opacity:1;} 100%{-ms-transform:translate3d(0%,0px,0px);opacity:1;} }",0);e.element.dom.style.msAnimation="elasticIn "+e.mediaObject.duration+"s forwards";break;default:document.styleSheets[0].insertRule("@keyframes elasticIn { 0%{transform:translate3d(-300%,0px,0px);opacity:1;} 12%{transform:translate3d("+f+",0px,0px);opacity:1;} 25%{transform:translate3d("+b+",0px,0px);opacity:1;} 37%{transform:translate3d("+g+",0px,0px);opacity:1;} 50%{transform:translate3d("+c+",0px,0px);opacity:1;} 62%{transform:translate3d("+j+",0px,0px);opacity:1;} 75%{ transform:translate3d("+d+",0px,0px);opacity:1;} 87%{ transform:translate3d("+a+",0px,0px);opacity:1;} 100%{transform:translate3d(0%,0px,0px);opacity:1;} }",0);e.element.dom.style.animation="elasticIn "+e.mediaObject.duration+"s forwards"}},removeAnim:function(){var a=this;switch(a.mediaObject.removeType.toLowerCase()){case"fade":a.fadeOutAnim();break;case"fly":a.flyOutAnim();break;default:a.hide();break}},flyOutAnim:function(){var b=this;var c="LEFT";var a="flyOutLeft";if(b.mediaObject.entryDir!=null&&b.mediaObject.entryDir!=""&&b.mediaObject.entryDir!="NONE"){c=b.mediaObject.entryDir}switch(c){case"LEFT":a="flyOutLeft";break;case"TOP":a="flyOutTop";break;case"RIGHT":a="flyOutRight";break;case"BOTTOM":a="flyOutBottom";break}switch(b.getPrefix().css){case"-webkit-":b.element.dom.style.webkitAnimation=a+" "+b.duration+"s forwards";break;case"-moz-":if(Ext.os.is.Desktop){b.element.dom.style.animation=a+" "+b.duration+"s forwards"}else{b.element.dom.style.mozAnimation=a+" "+b.duration+"s forwards"}break;case"-ms-":b.element.dom.style.msAnimation=a+" "+b.duration+"s forwards";break;default:b.element.dom.style.animation=a+" "+b.duration+"s forwards";break}setTimeout(function(){b.hide()},b.durationMili)},fadeOutAnim:function(){var a=this;switch(a.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.webkitAnimation="fadeOut "+a.mediaObject.duration+"s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.animation="fadeOut "+a.mediaObject.duration+"s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.mozAnimation="fadeOut "+a.mediaObject.duration+"s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.msAnimation="fadeOut "+a.mediaObject.duration+"s forwards";break;default:document.styleSheets[0].insertRule("@keyframes fadeOut { 0%{ opacity:1; } 100%{ opacity:0; } }",0);a.element.dom.style.animation="fadeOut "+a.mediaObject.duration+"s forwards";break}},setupFlash:function(){var d=this;if(d.mediaObject.flash=="true"||d.mediaObject.flash){var c=hexToRgb(d.mediaObject.backgroundColor);var e=d.mediaObject.backgroundAlpha;var b="infinite";var a=true;if(d.mediaObject.flashOnce=="true"&&d.mediaObject.backgroundAlpha==0){a=false;b=(d.mediaObject.flashSpeed*2)+"s"}else{if(d.mediaObject.flashOnce=="true"){b=(d.mediaObject.flashSpeed*2)+"s forwards"}}switch(d.getPrefix().css){case"-webkit-":d.styleString+="-webkit-animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";";break;case"-moz-":if(Ext.os.is.Desktop){d.styleString+="animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";"}else{d.styleString+="-moz-animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";"}break;case"-ms-":d.styleString+="-ms-animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";";break;default:d.styleString+="animation: flash "+(d.mediaObject.flashSpeed*2)+"s "+b+";";break}}}},0,["readermediaobject"],["component","container","readermediaobject"],{component:true,container:true,readermediaobject:true},["widget.readermediaobject"],0,[InfinityMobile.view,"ReaderMediaObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderAudioMediaObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",style:"border-radius:10px;display:inline-block !important;",height:"100%",width:"100%",items:[{itemId:"controlPanel",height:"100%",width:"100%",style:"padding:3%;",items:[{cls:"audioControl",itemId:"play",height:"100%",width:"30%",style:'background:url("resources/images/play-ic.png") black;background-size:80% 80%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;',isPlaying:false},{width:"5%",height:"100%"},{cls:"audioControl",itemId:"stop",height:"100%",width:"30%",style:'background:url("resources/images/back-to-start-ic.png") black;background-size:80% 80%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;'},{width:"5%",height:"100%"},{cls:"audioControl",itemId:"mute",height:"100%",width:"30%",style:'background:url("resources/images/unmute-ic.png") black;background-size:80% 80%;background-position:center;background-repeat:no-repeat;border-radius:10px;display:inline-block !important;'}]},{itemId:"closeBtn",right:10,top:-25,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backgroundImage",style:'background-image:url("../assets/article view/article-close-btn.png");background-size:contain;'}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.controlPanel=a.getComponent("controlPanel");a.playBtn=a.controlPanel.getComponent("play");a.stopBtn=a.controlPanel.getComponent("stop");a.muteBtn=a.controlPanel.getComponent("mute");a.loadSound();if(a.config.page!=null){a.page=a.config.page}a.playBtn.element.on({tap:a.playSound,scope:a});a.stopBtn.element.on({tap:a.stopSound,scope:a});a.muteBtn.element.on({tap:a.muteSound,scope:a});a.getComponent("closeBtn").element.on("tap",function(){a.stopSound();a.hide()});if(a.mediaObject.remove!="CLOSEBTN"){a.getComponent("closeBtn").hide()}if(Ext.os.is.Desktop){if(a.mediaObject.autoPlay=="true"){a.fireEvent("checkActivePage",a)}}a.audioFile.onpause=function(){a.playBtn.isPlaying=false;a.playBtn.element.dom.style.background="url('resources/images/play-ic.png') 50% 50% / 80% 80% no-repeat black"}},loadSound:function(){var b=this;b.fileGuid=b.mediaObject.file;var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);var d="http://source.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+".mp3";b.audioFile=new Audio(d)},playSound:function(){var a=this;if(!a.playBtn.isPlaying){a.fireEvent("playAudio",a);a.playBtn.isPlaying=true;a.playBtn.element.dom.style.background="url('resources/images/pause-ic.png') 50% 50% / 80% 80% no-repeat black"}else{a.fireEvent("pauseAudio",a);a.playBtn.isPlaying=false;a.playBtn.element.dom.style.background="url('resources/images/play-ic.png') 50% 50% / 80% 80% no-repeat black"}},stopSound:function(){var a=this;a.audioFile.pause();a.audioFile.currentTime=0;a.playBtn.isPlaying=false;a.playBtn.element.dom.style.background="url('resources/images/play-ic.png') 50% 50% / 80% 80% no-repeat black"},muteSound:function(){var a=this;if(a.audioFile.muted==true){a.audioFile.muted=false;a.muteBtn.element.dom.style.background="url('resources/images/unmute-ic.png') 50% 50% / 80% 80% no-repeat black"}else{a.audioFile.muted=true;a.muteBtn.element.dom.style.background="url('resources/images/mute-ic.png') 50% 50% / 80% 80% no-repeat black"}}},0,["readeraudiomediaobject"],["component","container","readermediaobject","readeraudiomediaobject"],{component:true,container:true,readermediaobject:true,readeraudiomediaobject:true},["widget.readeraudiomediaobject"],0,[InfinityMobile.view,"ReaderAudioMediaObject"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleSectionItemImg",Ext.Container,{config:{height:"100%",width:350,layout:"vbox",style:"border:5px solid transparent;",items:[{itemId:"image",height:160,style:"border:5px solid transparent;"},{itemId:"bodyContainer",height:190,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;"}]},initialize:function(){var a=this;a.image=a.getComponent("image");a.bodyContainer=a.getComponent("bodyContainer");if(a.config.article!=null){a.article=a.config.article}if(a.config.container!=null){a.container=a.config.container}a.loadArticle();a.element.on({tap:a.onTap,scope:a});a.imageLoaded=false},loadImage:function(){var b=this;var a="cover";if(settings.reader.thumbnailImageMode!=null){if(settings.reader.thumbnailImageMode=="fit"){a="contain"}}if(!b.imageLoaded){if(b.article.images[0]!=null){b.article.images[0].url=b.article.images[0].url.replace(/ /g,"%20")}$(b.image.element.dom).css("background-image","url(image_resize.aspx?w=350&url="+b.article.images[0].url+")");$(b.image.element.dom).css("background-size",a);$(b.image.element.dom).css("background-position","center");$(b.image.element.dom).css("background-repeat","no-repeat");$(b.image.element.dom).css("background-color","gray");$(b.image.element.dom).css("border","");if(a=="contain"){b.imageDummy=new Image();b.imageDummy.src=b.article.images[0].url;b.imageDummy.onload=function(){var c=b.imageDummy.naturalWidth/b.imageDummy.naturalHeight;if(c>1.75){$(b.image.element.dom).css("background-size","cover");$(b.image.element.dom).css("background-position","50% 0%")}}}b.imageLoaded=true}},loadArticle:function(){var d=this;var c=Ext.getStore("SettingStore").data.items[0].raw;if(c.topbar.smallLogo!=null){var e=c.topbar.smallLogo;var f=true}else{var e=c.topbar.logo;var f=false}if(c.topbar.backgroundColor!=null){var a="#"+c.topbar.backgroundColor}else{var a="transparent"}$(d.image.element.dom).css("background","url('"+e+"')");$(d.image.element.dom).css("background-repeat","no-repeat");$(d.image.element.dom).css("background-position","center");if(!f){$(d.image.element.dom).css("background-size","contain")}$(d.image.element.dom).css("background-color","gray");var b=document.createElement("div");b.innerHTML=d.article.body;d.bodyContainer.setHtml("<div class='articleItem' style='line-height:20px;oveflow:hidden;' ><b style='font-size:18px !important;'>"+d.article.headline+"</b><br />"+d.article.shortStory+"</div>")},onTap:function(){var a=this;console.log("TAP IMAGE ARTICLE");a.fireEvent("jumpToPage",a.article.pageNumber-1);a.fireEvent("articleClick",a.article,a.article.guid);a.container.articleTabTap()}},0,["articlesectionitemimg"],["component","container","articlesectionitemimg"],{component:true,container:true,articlesectionitemimg:true},["widget.articlesectionitemimg"],0,[InfinityMobile.view,"ArticleSectionItemImg"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleSectionItem",Ext.Container,{config:{height:"100%",width:350,layout:"vbox",style:"border:5px solid transparent;",items:[{itemId:"bodyContainer1",height:180,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;"},{itemId:"bodyContainer2",height:170,style:"color:white;font-size:15px;border:5px solid transparent;overflow:hidden;"}]},initialize:function(){var a=this;a.body1=a.getComponent("bodyContainer1");a.body2=a.getComponent("bodyContainer2");if(a.config.article1!=null){a.article1=a.config.article1}if(a.config.article2!=null){a.article2=a.config.article2}if(a.config.container!=null){a.container=a.config.container}a.loadArticles();a.body1.element.on({tap:a.body1Tap,scope:a});a.body2.element.on({tap:a.body2Tap,scope:a})},loadArticles:function(){var a=this;a.body1.setHtml("<div class='articleItem1' style='line-height:20px;overflow:hidden;height:140px;'><b style='font-size:18px !important;'>"+a.article1.headline+"</b><br />"+a.article1.shortStory+"</div>");if(a.article2!=null){a.body2.setHtml("<div class='articleItem2' style='line-height:20px;overflow:hidden;height:140px;'><b style='font-size:18px !important;'>"+a.article2.headline+"</b><br />"+a.article2.shortStory+"</div>")}},returnBodyText:function(f){var e=this;var g="";var d=0;var a=200;for(var c=0;c<f.length;c++){if(d+f[c].innerHTML.length<a){g+="<p>"+f[c].innerHTML+"</p>"}else{var b=a-d;g+="<p>"+f[c].innerHTML.substring(0,b)+"...</p>";break}}return g},body1Tap:function(){var a=this;console.log("ARTICLE TOP TAP");a.fireEvent("jumpToPage",a.article1.pageNumber-1);a.fireEvent("articleClick",a.article1,a.article1.guid);a.container.articleTabTap()},body2Tap:function(){var a=this;if(a.article2!=null){console.log("ARTICLE BOTTOM TAP");a.fireEvent("jumpToPage",a.article2.pageNumber-1);a.fireEvent("articleClick",a.article2,a.article2.guid);a.container.articleTabTap()}}},0,["articlesectionitem"],["component","container","articlesectionitem"],{component:true,container:true,articlesectionitem:true},["widget.articlesectionitem"],0,[InfinityMobile.view,"ArticleSectionItem"],0));(Ext.cmd.derive("InfinityMobile.view.ArticlesSectionContainer",Ext.Container,{config:{height:400,layout:"vbox",style:"margin-left:15px solid transparent !important;margin-right:15px solid transparent !important;",items:[{itemId:"sectionBody",height:360,layout:"hbox"}]},initialize:function(){var a=this;a.sectionBody=a.getComponent("sectionBody");if(a.config.section!=null){a.section=a.config.section}if(a.config.articles!=null){a.articles=a.config.articles}if(a.config.container!=null){a.container=a.config.container}a.loadArticles()},loadArticles:function(){var d=this;for(var c=0;c<d.articles.length;c++){if(d.articles[c].images.length>0){var e=Ext.create("InfinityMobile.view.ArticleSectionItemImg",{article:d.articles[c],container:d.container});d.sectionBody.add(e)}else{var a=false;if(d.articles[c+1]!=null){if(d.articles[c+1].images.length>0){var b=null}else{var b=d.articles[c+1];a=true}}else{var b=null}var e=Ext.create("InfinityMobile.view.ArticleSectionItem",{article1:d.articles[c],article2:b,container:d.container});d.sectionBody.add(e);if(a){c++}}}}},0,["articlesectioncontainer"],["component","container","articlesectioncontainer"],{component:true,container:true,articlesectioncontainer:true},["widget.articlesectioncontainer"],0,[InfinityMobile.view,"ArticlesSectionContainer"],0));(Ext.cmd.derive("InfinityMobile.view.ArticlesContainer",Ext.Container,{config:{width:"100%",height:440,zIndex:100000,bottom:-40,items:[{itemId:"tab",cls:"pagesTab",height:40,left:0,top:-40,style:"background-color:rgba(0,0,0,0.8);border-top-right-radius:10px;color: white;",layout:"hbox",items:[{cls:"browserBtn",itemId:"pages",padding:12,height:40,style:"min-width:100px;text-align:center;font-size:11pt;"},{cls:"browserBtn",itemId:"articles",padding:12,height:40,style:"min-width:100px;text-align:center;font-size:11pt;"}]},{itemId:"sectionToolbar",width:"100%",height:40,top:0,layout:"hbox",cls:"section-toolbar",style:"background-color:rgba(0,0,0,0.8);border-bottom:1px solid gray;overflow:hidden;",items:[{itemId:"previousBtn",height:40,width:40,style:'border-right:1px solid gray;background-size:60% 50%;background-repeat:no-repeat;background-position:center;background-image:url("../assets/reader icons/back.png");',cls:"pointerCursor"},{itemId:"sectionArea",height:40,width:"100%",layout:"hbox",style:"overflow:hidden;"},{itemId:"nextBtn",height:40,width:40,right:80,style:'border-left:1px solid gray;background-size:60% 50%;background-repeat:no-repeat;background-position:center;background-image:url("../assets/reader icons/next.png");',cls:"pointerCursor"},{itemId:"expandBtn",cls:"pointerCursor",height:40,width:"40px",right:40,style:'border-left:1px solid gray;background-image:url("resources/images/reader icons/expand ic.png");background-size:60% 50%;background-repeat:no-repeat;background-position:center;'},{itemId:"closeBtn",cls:"pointerCursor",height:40,width:"40px",right:0,style:'border-left:1px solid gray;background-image:url("resources/images/reader icons/close btn.png");background-size:60% 50%;background-repeat:no-repeat;background-position:center;'}]},{itemId:"con",cls:"articles-pages-container",layout:"hbox",top:40,style:"background-color:rgba(0,0,0,0.8);",width:"100%",height:"370px"}]},initialize:function(){var b=this;b.sectionIndex=null;var a=false;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer=="true"){a=true}}b.articlesHeight=400;b.tab=b.getComponent("tab");b.pagesTab=b.tab.getComponent("pages");b.pagesTabText=b.pagesTab.element.down("p");b.articleTabText=b.tab.getComponent("articles").element.down("p");b.pagesTab=b.tab.getComponent("pages");b.articleTab=b.tab.getComponent("articles");b.sectionToolbar=b.getComponent("sectionToolbar");b.sectionArea=b.sectionToolbar.getComponent("sectionArea");b.closeBtn=b.sectionToolbar.getComponent("closeBtn");b.expandBtn=b.sectionToolbar.getComponent("expandBtn");b.nextBtn=b.sectionToolbar.getComponent("nextBtn");b.previousBtn=b.sectionToolbar.getComponent("previousBtn");b.contentArea=b.getComponent("con");if(b.config.articles!=null){b.articles=b.config.articles}if(b.config.sections!=null){b.sections=b.config.sections}if(b.config.mode!=null){b.mode=b.config.mode}b.setupBrowser();var c=((navigator.maxTouchPoints)?true:false);if(Ext.browser.is.Firefox&&!c){setTimeout(function(){var d=$(b.contentArea.element.dom).jScrollPane();b.scrollApi=d.data("jsp");$(b.contentArea.element.dom).bind("jsp-scroll-x",function(e,f){b.firefoxScrolling(f)});$(b.contentArea.element.dom).on("DOMMouseScroll",function(e){if(e.originalEvent.detail){b.scrollApi.scrollByX(e.originalEvent.detail*15)}})},1000)}},firefoxScrolling:function(c){var b=this;var a={position:{x:c}};b.onScroll(a)},setupBrowser:function(){var a=this;a.checkPages();a.pagesHeight=180;a.scrollType=a.setUpScrolling();a.offset=0;a.checkMode();a.sortSections();a.checkArticles();a.checkScroller();a.setupTabListeners();a.setUpSectionNavigation();a.deviceSetup()},deviceSetup:function(){var a=this;a.keyDownFunc=window.onkeydown},setUpSectionNavigation:function(){var a=this;if(a.sections.length>1){a.nextBtn.element.on({tap:a.nextSection,scope:a});a.previousBtn.element.on({tap:a.previousSection,scope:a})}else{a.nextBtn.hide();a.previousBtn.hide()}},getActiveSection:function(){var d=this;var c=d.sectionArea.items.items;var a={};for(var b in c){if(c[b].config.isActive==true){a.pos=c[b].config.position;a.sectionBtn=c[b];break}}return a},nextSection:function(){var g=this;var b=g.getActiveSection();var f=g.sectionArea.items.items;var e=parseInt(b.pos)+1;if(e<f.length){var d=f[e];g.sectionTap(d,g);var h=d.element.dom.offsetLeft;var a=g.sectionArea.getScrollable().getScroller();var c=a.position.x}},previousSection:function(){var e=this;var b=e.getActiveSection();var d=e.sectionArea.items.items;var a=parseInt(b.pos)-1;if(a<0){a=0}var c=d[a];e.sectionTap(c,e)},scrollSectionsArea:function(k,h){var e=this;if(k!=null){var b=k.element.dom.offsetLeft;var g=e.sectionArea.getScrollable();if(g!=null&&g.getScroller()!=null){var d=g.getScroller();var c=d.position.x;if(h=="back"){if(c+40>b){var a=Math.max(b-10,0);d.scrollTo(a)}}else{if(h=="next"){var l=$(k.element.dom).width()+b;var j=($(document).width()-120);if(j+c<l){var f=(l+10)-j;var a=Math.min(f,d.maxPosition.x);d.scrollTo(a)}}}}}},setupTabListeners:function(){var a=this;a.articleTab.element.on({tap:a.articleTabTap,scope:a});a.pagesTab.element.on({tap:a.pagesTabTap,scope:a});a.element.on({hide:a.hideMe,scope:a});a.closeBtn.element.on({tap:a.hide,scope:a});a.expandBtn.element.on({tap:a.expand,scope:a})},checkScroller:function(){var a=this;if(!Ext.browser.is.Firefox){if(a.scrollType=="senchaScroller"){a.getComponent("con").getScrollable().getScroller().on({scroll:a.onScroll,scope:a})}}if(a.sectionArea.getScrollable()==null){a.sectionArea.setScrollable({direction:"horizontal"})}},checkPages:function(){var a=this;if(settings.menu!=null&&settings.menu.hidePages!=null){a.pagesTab.hide()}else{a.pagesTab.setHtml(language.articlesContainer.pages)}},checkArticles:function(){var a=this;if(a.articles.length>0&&settings.articles!=null){a.display="articles";a.articleTab.setHtml(language.articlesContainer.articles);a.loadContainer()}else{a.display="articles";a.mode="start";a.pagesTabTap();a.articleTab.hide()}},setUpScrolling:function(){var a=this;if(currentProfile=="desktop"){if(navigator.maxTouchPoints){a.contentArea.setScrollable({direction:"horizontal"});return"senchaScroller"}else{a.contentArea.element.dom.style.overflowX="auto";a.contentArea.element.dom.style.overflowY="hidden";a.articlesHeight=410;a.setBottom(-30);a.contentArea.element.dom.style.transition="0.1s ease all";if(!Ext.browser.is.Firefox){$(a.contentArea.element.dom).on({scroll:function(b){a.onDesktopScroll(b)}})}a.element.dom.onmousewheel=function(b){if(b.wheelDelta<0){if(a.contentArea.element.dom.scrollLeft+80<=a.contentArea.element.dom.scrollWidth){a.contentArea.element.dom.scrollLeft+=80}else{a.contentArea.element.dom.scrollLeft=a.contentArea.element.dom.scrollWidth}}else{if(a.contentArea.element.dom.scrollLeft-80>=0){a.contentArea.element.dom.scrollLeft-=80}else{a.contentArea.element.dom.scrollLeft=0}}};if(Ext.browser.is.Firefox){a.element.dom.addEventListener("DOMMouseScroll",function(b){if(b.detail>0){if(a.contentArea.element.dom.scrollLeft+80<=a.contentArea.element.dom.scrollWidth){a.contentArea.element.dom.scrollLeft+=80}else{a.contentArea.element.dom.scrollLeft=a.contentArea.element.dom.scrollWidth}}else{if(a.contentArea.element.dom.scrollLeft-80>=0){a.contentArea.element.dom.scrollLeft-=80}else{a.contentArea.element.dom.scrollLeft=0}}})}return"desktopScroller"}}else{a.contentArea.setScrollable({direction:"horizontal"});return"senchaScroller"}},sortSections:function(){var d=this;var f=[];var b;for(var c=0;c<d.sections.length;c++){var e=d.sections[c];for(var a=0;a<d.sections.length;a++){if(parseFloat(e.pageNumber)<parseFloat(d.sections[a].pageNumber)){b=d.sections[c];d.sections[c]=d.sections[a];d.sections[a]=b}}}},checkMode:function(){var a=this;if(a.mode=="toggle"){a.element.dom.style.transform="translate3d(0px, "+a.articlesHeight+"px, 0px)";a.element.dom.style.mozTransform="translate3d(0px, "+a.articlesHeight+"px, 0px)";a.element.dom.style.webkitTransform="translate3d(0px, "+a.articlesHeight+"px, 0px)";a.element.dom.style.msTransform="translate3d(0px, "+a.articlesHeight+"px, 0px)"}},loadContainer:function(){var e=this;if(e.sections.length>0){var g=[];if(e.sections[0].pageNumber>1){e.sections.unshift({page:1,pageNumber:1,name:""})}for(var c=0;c<e.sections.length;c++){var d=[];var b=parseInt(e.sections[c].page);for(var a=0;a<e.articles.length;a++){if(e.sections[c+1]!=null){if(e.articles[a].pageNumber>=b&&e.articles[a].pageNumber<parseInt(e.sections[c+1].page)){d.push(e.articles[a])}}else{if(e.articles[a].pageNumber>=b){d.push(e.articles[a])}}}if(d.length>0){var f=Ext.create("InfinityMobile.view.ArticlesSectionContainer",{section:e.sections[c],articles:d,container:e});e.getComponent("con").add(f)}}}else{var f=Ext.create("InfinityMobile.view.ArticlesSectionContainer",{section:"All",articles:e.articles,container:e});e.getComponent("con").add(f)}},loadSectionsBtns:function(){var g=this;g.sectionArea.removeAll();var e=0;for(var d=0;d<g.sections.length;d++){if(d==0){var b="white";var j=true}else{var b="gray";var j=false}if(g.articles.length>0){var c=[];var f=parseInt(g.sections[d].page);for(var h=0;h<g.articles.length;h++){if(g.sections[d+1]!=null){if(g.articles[h].pageNumber>=f&&g.articles[h].pageNumber<parseInt(g.sections[d+1].page)){c.push(g.articles[h])}}else{if(g.articles[h].pageNumber>=f){c.push(g.articles[h])}}}if(c.length>0){var a=Ext.create("Ext.Container",{cls:"browserBtn",height:40,html:g.sections[d].name.trim(),style:"color:"+b+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:e,articleContainer:g,isActive:j});g.sectionArea.add(a);a.element.on({tap:function(){g.sectionTap(this,this.config.articleContainer)},painted:function(){var l=this.config.articleContainer;var k=l.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(k)},scope:a});e+=1}}else{if(g.sections.length>0){var a=Ext.create("Ext.Panel",{cls:"browserBtn",height:40,html:g.sections[d].name.trim(),style:"color:"+b+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:e,articleContainer:g,isActive:j});g.sectionArea.add(a);a.element.on({tap:function(){g.sectionTap(this,this.config.articleContainer)},painted:function(){var l=this.config.articleContainer;var k=l.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(k)},scope:a});e+=1}}}},setActiveSections:function(b,h){var d=this;var f=d.getActiveSection();for(var c=0;c<d.sectionArea.items.items.length;c++){var g=d.sectionArea.items.items[c];if(g!=null){$(g.element.dom).css("color","gray");g.config.isActive=false}}for(var c=b;c<=h;c++){var g=d.sectionArea.items.items[c];if(g!=null){$(g.element.dom).css("color","white");g.config.isActive=true}}var a=d.getActiveSection();var e="back";if(a.pos>f.pos){e="next"}d.scrollSectionsArea(a.sectionBtn,e)},loadSectionBtnsPages:function(){var e=this;e.sectionArea.removeAll();var d=0;for(var b=0;b<e.sections.length;b++){if(b==0){var a="white";var c=true}else{var a="gray";var c=false}var f=Ext.create("Ext.Panel",{cls:"browserBtn",height:40,html:e.sections[b].name.trim(),style:"color:"+a+";font-size:18px;font-weight:bold;margin:10px;white-space:nowrap;",position:d,articleContainer:e,isActive:c});e.sectionArea.add(f);f.element.on({tap:function(){e.sectionTap(this,this.config.articleContainer)},painted:function(){var h=this.config.articleContainer;var g=h.sectionArea.items.items[this.config.position].element.down("div").down("div").dom.clientWidth;this.setWidth(g)},scope:f});d+=1}},onDesktopScroll:function(m){var n=this;if(n.mode=="articles"){if(n.contentArea.element.dom.scrollLeft>0){var l=0;var h;for(var j=0;j<n.getComponent("con").items.items.length;j++){var d=n.getComponent("con").items.items[j].element.dom.offsetLeft;if(n.getComponent("con").items.items[j+1]!=null){var a=n.getComponent("con").items.items[j+1].element.dom.offsetLeft;if(n.contentArea.element.dom.scrollLeft>=d&&parseInt(n.contentArea.element.dom.scrollLeft)<parseInt(a)){l=j;h=d;break}}else{l=j;h=d;break}}var k=0;for(var j=l;j<n.getComponent("con").items.items.length;j++){if(n.contentArea.element.dom.scrollLeft+$(document).width()>=parseFloat(n.getComponent("con").items.items[j].element.dom.offsetLeft)){k=j}}n.setActiveSections(l,k);var p=n.contentArea.getItems().items;for(var j=l;j<=k;j++){var c=p[j].items.items[0].items.items;for(var o=0;o<c.length;o++){if((n.contentArea.element.dom.scrollLeft-350<=c[o].element.dom.offsetLeft&&n.contentArea.element.dom.scrollLeft+$(document).width()>=c[o].element.dom.offsetLeft)||c[o].element.dom.offsetLeft==0){if(c[o].loadImage!=null){c[o].loadImage()}}}}}else{l=0;var k=0;for(var j=l;j<n.getComponent("con").items.items.length;j++){if(n.contentArea.element.dom.scrollLeft+$(document).width()>=parseFloat(n.getComponent("con").items.items[j].element.dom.offsetLeft)){k=j}}n.setActiveSections(l,k)}}else{if(n.mode=="pages"){if(n.contentArea.element.dom.scrollLeft>0){var l=0;var f=[];for(var j=0;j<n.sectionArea.getItems().length;j++){var g=n.getComponent("con").items.items[0].items.items[n.sections[j].page-1];if(g!=null){f[j]=g.element.dom.offsetLeft}}for(var j=0;j<=f.length;j++){if(f[j+1]!=null){if(parseInt(n.contentArea.element.dom.scrollLeft)>=parseInt(f[j])&&parseInt(n.contentArea.element.dom.scrollLeft)<parseInt(f[j+1])){l=j;break}}else{l=j;break}}var k=0;for(var j=l;j<f.length;j++){if(n.contentArea.element.dom.scrollLeft+$(document).width()>=parseFloat(f[j])){k=j}}n.setActiveSections(l,k);var b=n.contentArea.getItems().items[0].innerItems;for(var j=0;j<b.length;j++){if((n.contentArea.element.dom.scrollLeft<=b[j].element.dom.offsetLeft&&n.contentArea.element.dom.scrollLeft+$(document).width()>=b[j].element.dom.offsetLeft)||b[j].element.dom.offsetLeft==0){if(b[j].loadImage!=null){b[j].loadImage()}}}}else{l=0;var k=0;var f=[];for(var j=0;j<n.sections.length;j++){var g=n.getComponent("con").items.items[0].items.items[n.sections[j].page];if(g!=null){f[j]=g.element.dom.offsetLeft}}for(var j=l;j<f.length;j++){if(n.contentArea.element.dom.scrollLeft+$(document).width()>=parseFloat(f[j]-150)){k=j}}n.setActiveSections(l,k)}}}},onScroll:function(m){var n=this;if(n.mode=="articles"){if(m.position.x>0){var l=0;var h;for(var j=0;j<n.getComponent("con").items.items.length;j++){var d=n.getComponent("con").items.items[j].element.dom.offsetLeft;if(n.getComponent("con").items.items[j+1]!=null){var a=n.getComponent("con").items.items[j+1].element.dom.offsetLeft;if(m.position.x>=d&&parseInt(m.position.x)<parseInt(a)){l=j;h=d;break}}else{l=j;h=d;break}}var k=0;for(var j=l;j<n.getComponent("con").items.items.length;j++){if(m.position.x+$(document).width()>=parseFloat(n.getComponent("con").items.items[j].element.dom.offsetLeft)){k=j}}n.setActiveSections(l,k);var p=n.contentArea.getItems().items;for(var j=l;j<=k;j++){var c=p[j].items.items[0].items.items;for(var o=0;o<c.length;o++){if((m.position.x-350<=c[o].element.dom.offsetLeft&&m.position.x+$(document).width()>=c[o].element.dom.offsetLeft)||c[o].element.dom.offsetLeft==0){if(c[o].loadImage!=null){c[o].loadImage()}}}}}else{l=0;var k=0;for(var j=l;j<n.getComponent("con").items.items.length;j++){if(m.position.x+$(document).width()>=parseFloat(n.getComponent("con").items.items[j].element.dom.offsetLeft)){k=j}}n.setActiveSections(l,k)}}else{if(n.mode=="pages"){if(m.position.x>0){var l=0;var f=[];for(var j=0;j<n.sectionArea.getItems().length;j++){var g=n.getComponent("con").items.items[0].items.items[n.sections[j].page-1];if(g!=null){f[j]=g.element.dom.offsetLeft}}for(var j=0;j<=f.length;j++){if(f[j+1]!=null){if(parseInt(m.position.x)>=parseInt(f[j])&&parseInt(m.position.x)<parseInt(f[j+1])){l=j;break}}else{l=j;break}}var k=0;for(var j=l;j<f.length;j++){if(m.position.x+$(document).width()>=parseFloat(f[j])){k=j}}n.setActiveSections(l,k);var b=n.contentArea.getItems().items[0].innerItems;for(var j=0;j<b.length;j++){if((m.position.x<=b[j].element.dom.offsetLeft&&m.position.x+$(document).width()>=b[j].element.dom.offsetLeft)||b[j].element.dom.offsetLeft==0){if(b[j].loadImage!=null){b[j].loadImage()}}}}else{l=0;var k=0;var f=[];for(var j=0;j<n.sections.length;j++){var g=n.getComponent("con").items.items[0].items.items[n.sections[j].page];if(g!=null){f[j]=g.element.dom.offsetLeft}}for(var j=l;j<f.length;j++){if(m.position.x+$(document).width()>=parseFloat(f[j]-150)){k=j}}n.setActiveSections(l,k)}}}},articleTabTap:function(k){var j=this;if(k!=null){k.stopPropagation()}if(j.display=="pages"){j.getComponent("con").removeAll();j.loadContainer()}var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.dynamic!=null){var c=80;j.expandBtn.show();j.nextBtn.setRight(80)}else{var c=40;j.expandBtn.hide();j.nextBtn.setRight(40)}j.sectionArea.setWidth($(document).width()-c);j.display="articles";if(j.scrollType=="senchaScroller"){j.getComponent("con").getScrollable().getScroller().scrollTo(1)}else{j.contentArea.setHeight(370)}var g=0;var f=0;for(var d=g;d<j.getComponent("con").items.items.length;d++){if($(document).width()>=parseFloat(j.getComponent("con").items.items[d].element.dom.offsetLeft)){f=d}}j.setActiveSections(g,f);var m=j.contentArea.getItems().items;for(var d=g;d<=f;d++){if(m[d]!=null){var a=m[d].items.items[0].items.items;if(a!=null){for(var l=0;l<a.length;l++){if((0<=a[l].element.dom.offsetLeft&&$(document).width()>=a[l].element.dom.offsetLeft)||a[l].element.dom.offsetLeft==0){if(a[l].loadImage!=null){a[l].loadImage()}}}}}}if(j.mode=="toggle"){try{switch(j.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toggleToArticle { 0%{ -webkit-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ -webkit-transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.webkitAnimation="toggleToArticle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes toggleToArticle { 0%{ transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.animation="toggleToArticle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes toggleToArticle { 0%{ -moz-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ -moz-transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.mozAnimation="toggleToArticle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toggleToArticle { 0%{ -ms-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ -ms-transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.msAnimation="toggleToArticle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes toggleToArticle { 0%{ transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.animation="toggleToArticle 0.5s forwards";break}j.mode="articles";$(j.articleTabText.dom).attr("class","pageArticleTab");$(j.pagesTabText.dom).attr("class","");if(Ext.os.is.Desktop){window.onkeydown=null}j.setModal({style:"opacity:0;"});j.setHideOnMaskTap(true)}catch(h){}}else{if(j.mode=="pages"){try{j.mode="articles";switch(j.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToArticle { 0%{ -webkit-transform:translate3d(0px, 160px, 0px); } 100%{ -webkit-transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.webkitAnimation="pagesToArticle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes pagesToArticle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.animation="pagesToArticle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes pagesToArticle { 0%{ -moz-transform:translate3d(0px, 160px, 0px); } 100%{ -moz-transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.mozAnimation="pagesToArticle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToArticle { 0%{ -ms-transform:translate3d(0px, 160px, 0px); } 100%{ -ms-transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.msAnimation="pagesToArticle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToArticle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);j.element.dom.style.animation="pagesToArticle 0.5s forwards"}$(j.articleTabText.dom).attr("class","pageArticleTab");$(j.pagesTabText.dom).attr("class","");if(Ext.os.is.Desktop){window.onkeydown=null}j.setModal({style:"opacity:0;"});j.setHideOnMaskTap(true)}catch(h){}}else{if(j.mode=="articles"){try{switch(j.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articleToToggle { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.webkitAnimation="articleToToggle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.animation="articleToToggle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes articleToToggle { 0%{ -moz-transform:translate3d(0px, 0px, 0px); } 100%{ -moz-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.mozAnimation="articleToToggle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articleToToggle { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.msAnimation="articleToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.animation="articleToToggle 0.5s forwards";break}j.mode="toggle";$(j.articleTabText.dom).attr("class","");$(j.pagesTabText.dom).attr("class","");j.setHideOnMaskTap(false);j.setModal(false);if(Ext.os.is.Desktop){if(j.keyDownFunc!=null){window.onkeydown=j.keyDownFunc}}}catch(h){}}}}j.loadSectionsBtns()},pagesTabTap:function(k){var j=this;if(k!=null){k.stopPropagation()}if(j.display=="articles"){j.getComponent("con").removeAll();var a=Ext.create("InfinityMobile.view.ReaderPages",{articlesContainer:j});j.getComponent("con").add(a);if(j.scrollType=="senchaScroller"){j.getComponent("con").setScrollable({direction:"horizontal"})}else{j.contentArea.setHeight(210)}j.getComponent("con").setPadding(10,10,10,10);a.element.on({painted:function(){this.config.articlesContainer.pagesHeight=this.items.items[0].element.down("img").dom.clientHeight},scope:a})}j.expandBtn.hide();j.nextBtn.setRight(40);var d=(j.pagesHeight);j.sectionArea.setWidth($(document).width()-120);j.display="pages";index=0;var g=0;var b=[];for(var f=0;f<j.sections.length;f++){var c=j.getComponent("con").items.items[0].items.items[j.sections[f].page];if(c!=null){b[f]=c.element.dom.offsetLeft}}for(var f=index;f<b.length;f++){if($(document).width()>=parseFloat(b[f]-150)){g=f}}if(j.sections>0){j.setActiveSections(index,g)}setTimeout(function(){var e=j.contentArea.getItems().items[0].innerItems;for(var l=0;l<e.length;l++){if((0<=e[l].element.dom.offsetLeft&&$(document).width()>=e[l].element.dom.offsetLeft)){e[l].loadImage()}}},200);if(j.mode=="toggle"){try{switch(j.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toggleToPages { 0%{ -webkit-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.webkitAnimation="toggleToPages 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes toggleToPages { 0%{ transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.animation="toggleToPages 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes toggleToPages { 0%{ -moz-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ -moz-transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.mozAnimation="toggleToPages 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toggleToPages { 0%{ -ms-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.msAnimation="toggleToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes toggleToPages { 0%{ transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.animation="toggleToPages 0.5s forwards";break}j.mode="pages";$(j.pagesTabText.dom).attr("class","pageArticleTab");$(j.articleTabText.dom).attr("class","");if(Ext.os.is.Desktop){window.onkeydown=null}j.setModal({style:"opacity:0;"});j.setHideOnMaskTap(true)}catch(h){}}else{if(j.mode=="articles"){try{switch(j.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articlesToPages { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.webkitAnimation="articlesToPages 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.animation="articlesToPages 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes articlesToPages { 0%{ -moz-transform:translate3d(0px, 0px, 0px); } 100%{ -moz-transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.mozAnimation="articlesToPages 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articlesToPages { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.msAnimation="articlesToPages 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articlesToPages { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 160px, 0px); } }",0);j.element.dom.style.animation="articlesToPages 0.5s forwards";break}j.mode="pages";$(j.pagesTabText.dom).attr("class","pageArticleTab");$(j.articleTabText.dom).attr("class","");if(Ext.os.is.Desktop){window.onkeydown=null}j.setModal({style:"opacity:0;"});j.setHideOnMaskTap(true)}catch(h){}}else{if(j.mode=="pages"){try{switch(j.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToToggle { 0%{ -webkit-transform:translate3d(0px, 160px, 0px); } 100%{ -webkit-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.webkitAnimation="pagesToToggle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.animation="pagesToToggle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes pagesToToggle { 0%{ -moz-transform:translate3d(0px, 160px, 0px); } 100%{ -moz-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.mozAnimation="pagesToToggle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToToggle { 0%{ -ms-transform:translate3d(0px, 160px, 0px); } 100%{ -ms-transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.msAnimation="pagesToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 160px, 0px); } 100%{ transform:translate3d(0px, "+j.articlesHeight+"px, 0px); } }",0);j.element.dom.style.animation="pagesToToggle 0.5s forwards";break}j.mode="toggle";$(j.pagesTabText.dom).attr("class","");$(j.articleTabText.dom).attr("class","");j.setHideOnMaskTap(false);j.setModal(false);if(Ext.os.is.Desktop){if(j.keyDownFunc!=null){window.onkeydown=j.keyDownFunc}}}catch(h){}}else{if(j.mode=="start"){j.mode="toggle"}}}}j.fireEvent("checkActivePageInBrowser",j);j.loadSectionBtnsPages()},setModalTap:function(){var a=this;a.getModal().element.on({tap:a.hideMe,scope:a})},hideMe:function(){var a=this;a.element.dom.style.visibility="hidden"},hide:function(){var b=this;var a=false;if(settings.newsday!=null){if(settings.newsday.customArticlesContainer=="true"){a=true}}if(!a){if(b.mode=="articles"){try{switch(b.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes articleToToggle { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.webkitAnimation="articleToToggle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.animation="articleToToggle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes articleToToggle { 0%{ -moz-transform:translate3d(0px, 0px, 0px); } 100%{ -moz-transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.mozAnimation="articleToToggle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes articleToToggle { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.msAnimation="articleToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes articleToToggle { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.animation="articleToToggle 0.5s forwards";break}b.mode="toggle";$(b.articleTabText.dom).attr("class","");$(b.pagesTabText.dom).attr("class","");b.setHideOnMaskTap(false);b.setModal(false);if(Ext.os.is.Desktop){if(b.keyDownFunc!=null){window.onkeydown=b.keyDownFunc}}}catch(c){}}else{try{switch(b.getPrefix().css){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes pagesToToggle { 0%{ -webkit-transform:translate3d(0px, 200px, 0px); } 100%{ -webkit-transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.webkitAnimation="pagesToToggle 0.5s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 200px, 0px); } 100%{ transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.animation="pagesToToggle 0.5s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes pagesToToggle { 0%{ -moz-transform:translate3d(0px, 200px, 0px); } 100%{ -moz-transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.mozAnimation="pagesToToggle 0.5s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes pagesToToggle { 0%{ -ms-transform:translate3d(0px, 200px, 0px); } 100%{ -ms-transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.msAnimation="pagesToToggle 0.5s forwards";break;default:document.styleSheets[0].insertRule("@keyframes pagesToToggle { 0%{ transform:translate3d(0px, 200px, 0px); } 100%{ transform:translate3d(0px, "+b.articlesHeight+"px, 0px); } }",0);b.element.dom.style.animation="pagesToToggle 0.5s forwards";break}b.mode="toggle";$(b.pagesTabText.dom).attr("class","");$(b.articleTabText.dom).attr("class","");b.setHideOnMaskTap(false);b.setModal(false);if(Ext.os.is.Desktop){if(b.keyDownFunc!=null){window.onkeydown=b.keyDownFunc}}}catch(c){}}}else{b.setStyle({bottom:"165px",width:"40px"});b.content.setStyle({maxWidth:"0%"});b.sectionToolbar.setStyle({maxWidth:"0%"});b.setHideOnMaskTap(false);b.setModal(false);b.mode="toggle"}},sectionTap:function(b,c){if(Ext.browser.is.Firefox){if(c.mode=="articles"){var d=c.getComponent("con").items.items[b.config.position+c.offset].element.dom.offsetLeft;c.scrollApi.scrollToX(d+1)}else{if(c.mode=="pages"){var a=c.sections[b.config.position].page;var d=c.getComponent("con").items.items[0].items.items[a-1].element.dom.offsetLeft;c.scrollApi.scrollToX(d+1)}}}else{if(c.scrollType=="senchaScroller"){if(c.mode=="articles"){var d=c.getComponent("con").items.items[b.config.position+c.offset].element.dom.offsetLeft;if(d>c.getComponent("con").getScrollable().getScroller().maxPosition.x){d=c.getComponent("con").getScrollable().getScroller().maxPosition.x}c.getComponent("con").getScrollable().getScroller().scrollTo(d+1)}else{if(c.mode=="pages"){var a=c.sections[b.config.position].page;var d=c.getComponent("con").items.items[0].items.items[a-1].element.dom.offsetLeft;if(d>c.getComponent("con").getScrollable().getScroller().maxPosition.x){d=c.getComponent("con").getScrollable().getScroller().maxPosition.x+150}c.getComponent("con").getScrollable().getScroller().scrollTo(d)}}}else{if(c.mode=="articles"){var d=c.getComponent("con").items.items[b.config.position+c.offset].element.dom.offsetLeft;if(d>c.contentArea.element.dom.scrollWidth){d=c.contentArea.element.dom.scrollWidth}c.contentArea.element.dom.scrollLeft=parseFloat(d+1)}else{if(c.mode=="pages"){var a=c.sections[b.config.position].page;var d=c.getComponent("con").items.items[0].items.items[a-1].element.dom.offsetLeft;if(d>c.contentArea.element.dom.scrollWidth){d=c.contentArea.element.dom.scrollWidth+150}c.contentArea.element.dom.scrollLeft=d}}}}},resizeOb:function(){var b=this;if(Ext.browser.is.Firefox){b.contentArea.element.dom.style.width=$(document).width()+"px";var f=$(b.contentArea.element.dom).children().first();if(f!=null){$(f).css("width",$(window).width()+"px");b.scrollApi.reinitialise();var e=f.children().first()[0];if(e!=null){e.style.top="0px"}var d=b.scrollApi.getContentPositionX();b.onScroll({position:{x:d+1}})}}else{if(b.scrollType=="senchaScroller"){var d=b.getComponent("con").getScrollable().getScroller().position.x}else{var d=b.contentArea.element.dom.scrollLeft}b.onScroll({position:{x:d+1}})}if(b.mode=="pages"){b.sectionArea.element.dom.style.width=($(document).width()-120)+"px"}else{var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.dynamic!=null){var c=160;b.expandBtn.show()}else{var c=120;b.expandBtn.hide()}b.sectionArea.element.dom.style.width=($(document).width()-c)+"px"}},expand:function(b){var a=this;b.stopPropagation();a.fireEvent("expandArticles")},disableEvents:function(){var a=this;a.element.dom.style.pointerEvents="none"},enableEvents:function(){var a=this;a.element.dom.style.pointerEvents=""},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},pagesTabTapNewsday:function(g){var f=this;if(g!=null){g.stopPropagation()}if(f.display=="articles"){f.getComponent("con").removeAll();var a=Ext.create("InfinityMobile.view.ReaderPages",{articlesContainer:f});f.getComponent("con").add(a);f.getComponent("con").setScrollable({direction:"horizontal"});f.getComponent("con").setPadding(10,10,10,10);a.element.on({painted:function(){this.config.articlesContainer.pagesHeight=this.items.items[0].element.down("img").dom.clientHeight},scope:a})}f.expandBtn.hide();var b=(f.pagesHeight);f.sectionArea.setWidth($(document).width()-80);f.display="pages";index=0;var h=0;var e=[];for(var d=0;d<f.sections.length;d++){var c=f.getComponent("con").items.items[0].items.items[f.sections[d].page];if(c!=null){e[d]=c.element.dom.offsetLeft}}for(var d=index;d<e.length;d++){if($(document).width()>=parseFloat(e[d]-150)){h=d}}if(f.sections>0){f.setActiveSections(index,h)}setTimeout(function(){var j=f.contentArea.getItems().items[0].innerItems;for(var k=0;k<j.length;k++){if((0<=j[k].element.dom.offsetLeft&&$(document).width()>=j[k].element.dom.offsetLeft)){j[k].loadImage()}}},200);if(f.mode=="toggle"){f.content.setStyle({maxWidth:"100%"});f.sectionToolbar.setStyle({maxWidth:"100%"});f.setStyle({bottom:"180px",width:"calc(100% - 40px)"});f.mode="pages";if(Ext.os.is.Desktop){window.onkeydown=null}f.setHideOnMaskTap(true)}else{if(f.mode=="articles"){f.content.setStyle({maxWidth:"100%"});f.sectionToolbar.setStyle({maxWidth:"100%"});f.setStyle({bottom:"180px",width:"calc(100% - 40px)"});f.mode="pages";if(Ext.os.is.Desktop){window.onkeydown=null}f.setHideOnMaskTap(true)}else{if(f.mode=="pages"){f.content.setStyle({maxWidth:"0%"});f.sectionToolbar.setStyle({maxWidth:"0%"});f.setStyle({bottom:"165px",width:"40px"});f.mode="toggle";f.setHideOnMaskTap(false);if(Ext.os.is.Desktop){if(f.keyDownFunc!=null){window.onkeydown=f.keyDownFunc}}}else{if(f.mode=="start"){f.mode="toggle"}}}}f.loadSectionBtnsPages()},articleTabTapNewsday:function(h){var g=this;if(h!=null){h.stopPropagation()}if(g.display=="pages"){g.getComponent("con").removeAll();g.loadContainer()}var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.dynamic!=null){var c=80;g.expandBtn.show()}else{var c=40;g.expandBtn.hide()}g.sectionArea.setWidth($(document).width()-c-40);g.display="articles";if(g.scrollType=="senchaScroller"){g.getComponent("con").getScrollable().getScroller().scrollTo(1)}var f=0;var e=0;for(var d=f;d<g.getComponent("con").items.items.length;d++){if($(document).width()>=parseFloat(g.getComponent("con").items.items[d].element.dom.offsetLeft)){e=d}}if(g.sections>0){g.setActiveSections(f,e)}var k=g.contentArea.getItems().items;for(var d=f;d<=e;d++){if(k[d]!=null){var a=k[d].items.items[0].items.items;if(a!=null){for(var j=0;j<a.length;j++){if((0<=a[j].element.dom.offsetLeft&&$(document).width()>=a[j].element.dom.offsetLeft)||a[j].element.dom.offsetLeft==0){if(a[j].loadImage!=null){a[j].loadImage()}}}}}}if(g.mode=="toggle"){g.content.setStyle({maxWidth:"100%"});g.sectionToolbar.setStyle({maxWidth:"100%"});g.setStyle({bottom:"340px",width:"calc(100% - 40px)"});g.mode="articles";if(Ext.os.is.Desktop){window.onkeydown=null}g.setModal({style:"opacity:0;"});g.setHideOnMaskTap(true)}else{if(g.mode=="pages"){g.content.setStyle({maxWidth:"100%"});g.sectionToolbar.setStyle({maxWidth:"100%"});g.setStyle({bottom:"340px",width:"calc(100% - 40px)"});g.mode="articles";if(Ext.os.is.Desktop){window.onkeydown=null}g.setModal({style:"opacity:0;"});g.setHideOnMaskTap(true)}else{if(g.mode=="articles"){g.content.setStyle({maxWidth:"0%"});g.sectionToolbar.setStyle({maxWidth:"0%"});g.setStyle({bottom:"165px",width:"40px"});g.mode="toggle";g.setHideOnMaskTap(false);g.setModal(false);if(Ext.os.is.Desktop){if(g.keyDownFunc!=null){window.onkeydown=g.keyDownFunc}}}}}g.loadSectionsBtns()}},0,["articlescontainer"],["component","container","articlescontainer"],{component:true,container:true,articlescontainer:true},["widget.articlescontainer"],0,[InfinityMobile.view,"ArticlesContainer"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingOptions",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:"60%",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"clippingOptionsToolBar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>Clipping Options</b>"},{id:"clippingOptionsToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{id:"clippingOptionsBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingOptionsContainerText",margin:"0 0 20px 0",html:"<p style='font-size:12px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><br /><p style='font-size:10px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p>"},{itemId:"clippingScroller",height:"180px",layout:"hbox",scrollable:{direction:"horizontal"}},{itemId:"options",items:[{itemId:"ButtonsDiv"},{itemId:"EmailDiv"}]}]}]},initialize:function(){var a=this;a.toolbar=a.getComponent("clippingOptionsToolBar");a.closeBtn=a.toolbar.getComponent("clippingOptionsToolBarClose");a.bodyContainer=a.getComponent("clippingOptionsBodyContainer");a.clippingScroller=a.bodyContainer.getComponent("clippingScroller");a.options=a.bodyContainer.getComponent("options");if(a.config.images!=null){a.images=a.config.images}if(a.config.widths!=null){a.widths=a.config.widths}if(a.config.heights!=null){a.heights=a.config.heights}a.addThumbnails();a.closeBtn.element.on("tap",function(){a.destroy()});a.options.getComponent("ButtonsDiv").setHtml('<div style="width:100%;background-color:white;padding:10px;height:70px;"><input type="button" onclick="parent.download()" style="margin: 5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" value="Download" /><input type="button" onclick="parent.preview()" value="Preview" style="margin:5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#E6E6E6;background-color:#E6E6E6;border-color:#e6e6e6;width:120px;" type="button" /><input type="button" onclick="parent.deleteClip()"  style="margin:5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#e6e6e6;background-color:#e6e6e6;border-color:#e6e6e6;width:120px;" type="button" value="Delete" /></div>');a.options.getComponent("EmailDiv").setHtml('<div style="height:210px;width:100%;background-color:white;padding:10px;"><div><div style="font-size:12px;width:40%;float:left;padding:10px;"><form>Recipient email address:<br /><input id="emailTxt" style="width:90%" type="textfield" /><br /><br />Subject:<br /><input id="subjectTxt" style="width:90%" type="textfield" /></form></div><div style="font-size:12px;float:right;width:50%;padding:10px;"><form>Message:<br /><textarea id="messageTxt" style="resize:none;width:90%;" rows="4" ></textarea></form></div></div><div style="padding:10px;float:right;"><input type="button" onclick="parent.email()" value="Send" style="margin: 5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" /></div></div>');deleteClip=function(){var c=[];var b=false;for(var d=0;d<a.clippingScroller.innerItems.length;d++){if(a.clippingScroller.innerItems[d].clicked){c[c.length]=a.images[d];b=true}}if(b){prompt=Ext.create("InfinityMobile.view.ClippingMenuDeletePrompt",{deleteClippings:c,menu:a})}else{a.promptUser()}};preview=function(){var d=false;for(var c=0;c<a.images.length;c++){if(a.clippingScroller.innerItems[c].clicked){d=true;break}}if(d){var b=Ext.create("InfinityMobile.view.ClippingMenuPreview",{images:a.images,clippingMenu:a})}else{a.promptUser()}};email=function(){if(document.getElementById("emailTxt").value!=""){var d=false;var b="mailto:"+document.getElementById("emailTxt").value+"?subject='"+document.getElementById("subjectTxt").value+"'&body='"+document.getElementById("messageTxt").value+"<br /><br />";for(var c=0;c<a.images.length;c++){if(a.clippingScroller.innerItems[c].clicked){b+="<img src='"+a.images[c]+"' /><br /><br />";d=true}}if(d){b+="'";window.location.href=b}else{a.promptUser()}}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuEmailPrompt")}};download=function(){var c=false;for(var b=0;b<a.clippingScroller.innerItems.length;b++){if(a.clippingScroller.innerItems[b].clicked){window.open(a.images[b]);c=true}}if(!c){a.promptUser()}}},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingMenuThumb",{image:b.images[a],imgWidth:b.widths[a],imgHeight:b.heights[a],clicked:false});b.clippingScroller.add(c);c.show()}},promptUser:function(){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt")},updateImages:function(a){var b=this;b.images=a;b.clippingScroller.removeAll(true);b.addThumbnails()}},0,["clippingoptions"],["component","container","clippingoptions"],{component:true,container:true,clippingoptions:true},["widget.clippingoptions"],0,[InfinityMobile.view,"ClippingOptions"],0));(Ext.cmd.derive("InfinityMobile.view.clippingPrompt",Ext.Container,{config:{modal:true,centered:true,width:"400px",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,zIndex:999998,items:[{id:"clippingPromptToolBar",height:40,items:[{itemId:"clippingTitle",top:10,left:10}]},{id:"clippingPromptBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingPromptContainerText",margin:"0 0 20px 0"},{itemId:"buttonArea",padding:"20",layout:"hbox",items:[{itemId:"checkbox",flex:1,html:"<input class='check' type='checkbox' ><label style='font-size:10px;padding:5px;'></label></input>"},{itemId:"button",flex:1,cls:"pointerCursor btn",style:"text-align:center;margin: 5px;border-style:solid;height:30px;",layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"btnText",margin:5,style:"font-size:11pt;"}]}]}]}]},initialize:function(){var b=this;var a=b.getComponent("clippingPromptToolBar");a.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});b.clippingPromptBody=b.getComponent("clippingPromptBodyContainer");b.buttonArea=b.clippingPromptBody.getComponent("buttonArea");b.button=b.buttonArea.getComponent("button");b.checkbox=b.buttonArea.getComponent("checkbox").element.down(".check");b.bodyText=b.clippingPromptBody.getComponent("clippingPromptContainerText");b.clippingPromptToolBar=b.getComponent("clippingPromptToolBar");b.clippingTitle=b.clippingPromptToolBar.getComponent("clippingTitle");b.clippingTitle.setHtml(language.clippings.createClipping);if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}if(b.config.reader!=null){b.reader=b.config.reader}b.setupText();b.button.element.on({tap:b.okay,scope:b});b.button.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});if(Ext.os.is.Desktop){if(navigator.maxTouchPoints){b.buttonArea.getComponent("checkbox").element.on({tap:function(d){var c=$(this.element.dom).find("input");if(c.length>0){if(c[0].checked){c[0].checked=false}else{c[0].checked=true}}},scope:b.buttonArea.getComponent("checkbox")})}}if(settings.newsday){b.element.dom.style.borderRadius=""}},okay:function(){var b=this;console.log(b.checkbox.dom.checked);if(b.checkbox.dom.checked){try{localStorage.setItem("clippingPrompt"+publicationguid,"set")}catch(a){}b.fireEvent("createClippingBox")}else{if(Ext.os.is.Desktop){var d=Ext.create("InfinityMobile.view.ClippingArea",{readerActiveItem:b.readerActiveItem,reader:b.reader})}else{var d=Ext.create("InfinityMobile.view.tablet.ClippingArea",{readerActiveItem:b.readerActiveItem,reader:b.reader})}Ext.Viewport.add(d);d.show();if(Ext.os.is.Desktop){if(settings.newsday!=null){if(settings.newsday.extraTopBar=="true"){var c=InfinityMobile.app.getController("ClippingController").getExtratopbar();if(c!=null){c.setZIndex(0)}}}}}b.destroy()},setupText:function(){var a=this;if(Ext.os.is.Desktop){a.bodyText.setHtml(language.clippings.clippingsHelper+"<br /><br />"+language.clippings.clippingsExplain)}else{a.bodyText.setHtml(language.clippings.clippingsHelperMobile+"<br /><br />"+language.clippings.clippingsExplainMobile)}a.buttonArea.element.down("label").dom.innerHTML=language.clippings.clippingsDontShow;a.button.getComponent("btnText").setHtml(language.ok)}},0,["clippingprompt"],["component","container","clippingprompt"],{component:true,container:true,clippingprompt:true},["widget.clippingprompt"],0,[InfinityMobile.view,"clippingPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingBox",Ext.Container,{config:{height:"1px",width:"100px",fullscreen:true,draggable:{direction:"both",constraint:null},style:"zIndex:10;"},initialize:function(){var a=this;a.readerActiveItem=a.config.readerActiveItem;a.reader=a.config.reader;a.x=0;a.y=0;cancel=function(){mediaController.clipper=null;a.destroy()};save=function(){console.log("SAVE!");a.fireEvent("createClipping",a)};a.setHtml('<div id="clipper" style="box-shadow:10px 10px 10px #000000;left:0px;top:0px;width:30px;resize:both;overflow:auto;height:30px;border:2px solid red;"></div><div><input style="background-color:#1e1e1e;color:white;border-color:#1e1e1e;font-size:12px;padding-right:5px;padding-left:5px;" type="button" onclick="parent.save()" value="Clip"></input><input style="background-color:#1e1e1e;color:white;border-color:#1e1e1e;font-size:12px;padding-left:5px;padding-right:5px;" type="button" onclick="parent.cancel()" value="Cancel"></input></div>');a.click={x:0,y:0};a.element.addListener({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragFinished",scope:a})},onDragStart:function(b){var a=this;b.stopPropagation();a.click.x=b.clientX;a.click.y=b.clientY},onDrag:function(b){var a=this;b.stopPropagation()},onDragFinished:function(g){var c=this;g.stopPropagation();var h=c.readerActiveItem;if(document.getElementById("slider").value==1){if(h._mode=="double"){c.x=g.pageX-g.event.offsetX;c.y=g.pageY-g.event.offsetY}else{c.x=g.pageX-g.event.offsetX;c.y=g.pageY-g.event.offsetY}}else{if(h._mode=="double"){c.x=g.pageX-g.event.offsetX;c.y=g.pageY-g.event.offsetY;var f=c.x;var d=c.y;var b=f+h.scroller.position.x;var a=d+h.scroller.position.y;c.x=((b)/(document.getElementById("slider").value));c.y=((a)/(document.getElementById("slider").value))}else{c.x=g.pageX-g.event.offsetX;c.y=g.pageY-g.event.offsetY}}}},0,["clippingbox"],["component","container","clippingbox"],{component:true,container:true,clippingbox:true},["widget.clippingbox"],0,[InfinityMobile.view,"ClippingBox"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLiveAdvertObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",items:[{itemId:"closeBtn",right:0,top:0,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backgroundImage",style:'background-image:url("../assets/article view/article-close-btn.png")'}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(a.config.mediaObject!=null){a.mediaObject=a.config.mediaObject}a.setHtml("<iframe style='height:100%;width:100%;' src='"+a.mediaObject.url+"' ></iframe>");a.closeBtn=a.getComponent("closeBtn");a.closeBtn.element.on("tap",function(){a.hide()})}},0,["readerliveadvertobject"],["component","container","readermediaobject","readerliveadvertobject"],{component:true,container:true,readermediaobject:true,readerliveadvertobject:true},["widget.readerliveadvertobject"],0,[InfinityMobile.view,"ReaderLiveAdvertObject"],0));(Ext.cmd.derive("InfinityMobile.view.LeftSideAdvertCover",Ext.Container,{config:{height:"100%",width:"100%",top:0,style:"display:block !important;",cls:"leftsidead",items:[{itemId:"tooltip",style:"position:absolute !important;"}]},initialize:function(){var a=this;if(a.config.url!=null){a.url=a.config.url}if(a.config.imageUrl!=null){a.imageUrl=a.config.imageUrl}if(a.config.title!=null){a.title=a.config.title}if(a.config.text!=null){a.text=a.config.text}if(a.url!=null){a.element.on("tap",function(){window.open(a.url)})}a.element.on({painted:function(){a.setWidth($(a.element.dom.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode).width());a.setHeight($(a.element.dom.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode).height())},scope:a});a.element.dom.style.backgroundImage="url('"+a.imageUrl+"')";a.element.dom.style.backgroundSize="cover";a.element.dom.style.backgroundRepeat="no-repeat";var c="";if(a.title!=null){c="<span style='font-weight:bold;'>"+a.title+"</span><br />"}var b="";if(a.text!=null){b=a.text}if(a.title!=null||a.text!=null){a.setMediaLinkStyle();a.getComponent("tooltip").setHtml('<div style="position:absolute;" class="adTooltip">'+c+b+"</div>")}},setMediaLinkStyle:function(){var a=this;a.element.dom.onmousemove=(function(b){if(b.clientX<($(document).width()/2)){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)"}else{a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)"}})}},0,["leftsideadvertcover"],["component","container","leftsideadvertcover"],{component:true,container:true,leftsideadvertcover:true},["widget.leftsideadvertcover"],0,[InfinityMobile.view,"LeftSideAdvertCover"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLiveArticlePopoverItem",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",style:"background-color:white",layout:"vbox",items:[{itemId:"content",flex:1,padding:"0 0 10px 0",scrollable:{direction:"vertical",directionLock:true}}]},initialize:function(){var a=this;a.content=a.getComponent("content");a.setContentStyle();console.log("Content Styled");a.on("painted",a.getContent,a,{delay:10,single:true})},setContentStyle:function(){var a=this;if(currentProfile=="tablet"){a.content.setPadding("0 20px 0 20px")}},getContent:function(){var j=this;console.log("PAINTED");var e=Ext.getStore("SettingStore");if(e.data.items[0].raw.reader.popupAdvert!=null){var f=e.data.items[0].raw.reader.popupAdvert.position;if(f=="top"){switch(currentProfile){case"phone":var g=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break}j.add(g);g.show()}}var k="";if(j.getPage().headdeck!=null){k="<div class='contentDeck font25'></div><br />"}var b="";if(j.getPage().images!=null){b="<div class='contentImages' >";for(var d=0;d<j.getPage().images.length;d++){b+="<div class='contentImage'><img src='"+j.getPage().images[d].url+"' /></div>"}b+="</div><br />"}var h="<div class='contentHead font35' >"+j.getPage().headline+"</div><br />"+k+b+"<div class='contentByline font15'>"+j.getPage().byline+"</div><br /><div class='contentBody font15'>"+j.getPage().content+"</div><br />";var a=h.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(a){h=a[1]}h+="<script>setText()<\/script>";j.removeSpinner();j.content.setHtml(h);j.setImages();if(j.content.element!=null){setText(j.content.element.dom)}j.setStyle({visibility:"inherit"});if(e.data.items[0].raw.reader.popupAdvert!=null){if(f=="bottom"){switch(currentProfile){case"phone":var c=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var c=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var c=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{padding:"10px 0 0 0"});break}j.add(c);c.show()}}},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var f=this;var d=1;var c=1;var b=f.id;if(currentProfile=="tablet"){var e=$("#"+b+" img").get(0);if(e!=null){if(e.naturalWidth==0){e.onload=function(){var g=this;if(g.naturalWidth<(screen.width/2)){var h=$("#"+b+" .articleContent")[0];h.className="articleContent float"}}}}}if($("#"+b+" .contentImage").size()>1){if(currentProfile=="phone"){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREVIOUS"}c=$("#"+b+" .contentImage").size();if(c>1){$("#"+b+" .contentImage:gt(0)").hide();$("#"+b+" .previousImage").hide();a()}else{if(c==1){$("#"+b+" .imageControls").hide()}}$("#"+b+" .nextImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").next();h.hide();d++;a();g.fadeIn();$("#"+b+" .previousImage").show();if(g.is("#"+b+" .contentImage:last")){$("#"+b+" .nextImage").hide()}});$("#"+b+" .previousImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").prev();h.hide();d--;a();g.fadeIn();$("#"+b+" .nextImage").show();if(g.is("#"+b+" .contentImage:first")){$("#"+b+" .previousImage").hide()}})}else{$("#"+b+" .imageControls").hide()}function a(){var g="Image "+d.toString()+" of "+c.toString();$("#"+b+" .imageCount").text(g)}}},0,["readerlivearticlepopoveritemtablet"],["component","container","readerlivearticlepopoveritemtablet"],{component:true,container:true,readerlivearticlepopoveritemtablet:true},["widget.readerlivearticlepopoveritemtablet"],0,[InfinityMobile.view,"ReaderLiveArticlePopoverItem"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReader",Ext.Panel,{showToolBar:true,config:{fullscreen:true,layout:{type:"vbox"},items:[{itemId:"topBar",height:40,style:"background-color:#1e1e1e;z-index:4;"},{itemId:"content",layout:{type:"hbox"},flex:1}]},initialize:function(){var b=this;var c=b.getComponent("topBar");b.toolBar=c;b.content=b.getComponent("content");b.hasPainted=false;if(Ext.os.is.Phone){b.content.setLayout({type:"vbox"});b.content.setScrollable({direction:"vertical",directionLock:true})}$(b.toolBar.element.dom).css("background-color","#"+settings.topbar.backgroundColor);if(settings.dynamic.articleBehaviour=="device"){if("ontouchstart" in window||navigator.msMaxTouchPoints){settings.dynamic.articleBehaviour="momentum"}else{settings.dynamic.articleBehaviour="scrollbar"}}b.element.on({painted:function(){var e=this;if(!e.hasPainted){e.fireEvent("initialized",e);mainPanel.fireEvent("removeSplash");if(Ext.os.is.Desktop&&settings.dynamic.articleBehaviour=="scrollbar"){if(settings.dynamic.rss==null){e.scrollDesktop=e.content.element.down(".x-container").next("div").dom}else{e.scrollDesktop=e.content.element.down(".x-container").next("div").next("div").dom}e.scrollDesktop.style.overflowX="scroll";if(Ext.browser.is.IE){e.content.setScrollable(false);e.scrollDesktop.style.overflowX="";if(settings.dynamic.rss==null){e.scrollDesktop=e.content.element.down(".x-container").next("div").down(".x-scroll-view").dom}else{e.scrollDesktop=e.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").dom}e.scrollDesktop.style.overflowX="scroll";var d=0;var f=Ext.ComponentQuery.query(".articlereaderpanelcontainer");for(container in f){d+=$(f[container].element.dom).width()+10}var g=Ext.ComponentQuery.query(".dynamicarticlesinterstitialcontainer");for(interstitial in g){d+=$(g[interstitial].element.dom).width()+5}if(settings.dynamic.rss==null){e.content.element.down(".x-container").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=d+"px"}else{e.content.element.down(".x-container").next("div").next("div").down(".x-scroll-view").down(".x-scroll-container").dom.style.width=d+"px"}}e.element.dom.onmousewheel=(function(h){if(h.wheelDelta>0){if(e.scrollDesktop.scrollLeft-120>0){e.scrollDesktop.scrollLeft=e.scrollDesktop.scrollLeft-120}else{e.scrollDesktop.scrollLeft=0}}else{if(e.scrollDesktop.scrollLeft+120<e.scrollDesktop.scrollWidth){e.scrollDesktop.scrollLeft=e.scrollDesktop.scrollLeft+120}else{e.scrollDesktop.scrollLeft=e.scrollDesktop.scrollWidth}}});e.element.dom.addEventListener("DOMMouseScroll",function(h){if(h.detail<0){if(e.scrollDesktop.scrollLeft-120>0){e.scrollDesktop.scrollLeft=e.scrollDesktop.scrollLeft-120}else{e.scrollDesktop.scrollLeft=0}}else{if(e.scrollDesktop.scrollLeft+120<e.scrollDesktop.scrollWidth){e.scrollDesktop.scrollLeft=e.scrollDesktop.scrollLeft+120}else{e.scrollDesktop.scrollLeft=e.scrollDesktop.scrollWidth}}})}else{if(!Ext.os.is.Phone){e.content.setScrollable({direction:"horizontal",directionLock:true})}e.element.dom.onmousewheel=(function(h){if(h.wheelDelta>0){if(e.content.getScrollable().getScroller().position.x-120>0){e.content.getScrollable().getScroller().scrollTo(e.content.getScrollable().getScroller().position.x-120)}else{e.content.getScrollable().getScroller().scrollTo(0)}}else{if(e.content.getScrollable().getScroller().position.x+120<e.content.getScrollable().getScroller().maxPosition.x){e.content.getScrollable().getScroller().scrollTo(e.content.getScrollable().getScroller().position.x+120)}else{e.content.getScrollable().getScroller().scrollTo(e.content.getScrollable().getScroller().maxPosition.x)}}});e.element.dom.addEventListener("DOMMouseScroll",function(h){if(h.detail<0){if(e.content.getScrollable().getScroller().position.x-120>0){e.content.getScrollable().getScroller().scrollTo(e.content.getScrollable().getScroller().position.x-120)}else{e.content.getScrollable().getScroller().scrollTo(0)}}else{if(e.content.getScrollable().getScroller().position.x+120<e.content.getScrollable().getScroller().maxPosition.x){e.content.getScrollable().getScroller().scrollTo(e.content.getScrollable().getScroller().position.x+120)}else{e.content.getScrollable().getScroller().scrollTo(e.content.getScrollable().getScroller().maxPosition.x)}}})}e.hasPainted=true}},scope:b});if(Ext.os.is.Phone){b.content.getScrollable().getScroller().on({scroll:function(d){b.loadPhoneImages(d)},scope:b});var a={position:{y:0}};b.on("painted",function(){b.loadPhoneImages(a)})}},loadPhoneImages:function(f){var h=this;var l=h.content.getItems().items;for(var c=0;c<l.length;c++){if(l[c].id.indexOf("articlereaderpanelcontainer")!=-1){var g=l[c].getItems().items;var a=l[c].element.dom.offsetTop;for(var n=0;n<g.length;n++){if(g[n].id.indexOf("articlereaderitemcontainer")!=-1){var b=g[n].getItems().items;var m=g[n].element.dom.offsetTop;for(var k=0;k<b.length;k++){var d=b[k].element.dom.offsetTop;var j=a+m+d;if((f.position.y<=j&&f.position.y+$(document).height()>=j)||j==0){b[k].loadImage()}}}}}}},loadReaderPhone:function(){var f=this;var j=f.content.getItems().items;for(var c=0;c<j.length;c++){if(j[c].id.indexOf("articlereaderpanelcontainer")!=-1){var e=j[c].getItems().items;var a=j[c].element.dom.offsetTop;for(var l=0;l<e.length;l++){if(e[l].id.indexOf("articlereaderitemcontainer")!=-1){var b=e[l].getItems().items;var k=e[l].element.dom.offsetTop;for(var h=0;h<b.length;h++){var d=b[h].element.dom.offsetTop;var g=a+k+d;if((0<=g&&$(document).height()>=g)||g==0){b[h].loadImage()}}}}}}}},0,["articlereader"],["component","container","panel","articlereader"],{component:true,container:true,panel:true,articlereader:true},["widget.articlereader"],0,[InfinityMobile.view,"ArticleReader"],0));(Ext.cmd.derive("InfinityMobile.view.NavButton",Ext.Container,{config:{cls:"pointerCursor",width:45,height:100},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.direction!=null){a.direction=a.config.direction}if(!Ext.browser.is.Firefox){a.setShowAnimation("fade");a.setHideAnimation("fadeOut")}a.duration=30;a.timer=null;a.touchTimer=null;a.isTouch=false;if(Ext.os.is.Desktop){a.element.on("touchstart",function(d){d.stopPropagation();var f=InfinityMobile.app.getController("ReaderController").getZoomValue();if(a.direction=="left"){if(f<=1){var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode=="fill"){var b=true}else{var b=false}a.fireEvent("autoTurnLeft",b)}else{a.timer=setInterval(function(){a.fireEvent("scrollLeft")},a.duration)}}else{if(a.direction=="right"){if(f<=1){var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode=="fill"){var b=true}else{var b=false}a.fireEvent("autoTurnRight",b)}else{a.timer=setInterval(function(){a.fireEvent("scrollRight")},a.duration)}}else{if(a.direction=="up"){a.timer=setInterval(function(){a.fireEvent("scrollUp")},a.duration)}else{a.timer=setInterval(function(){a.fireEvent("scrollDown")},a.duration)}}}});a.element.on("touchend",function(b){b.stopPropagation();clearInterval(a.timer);a.timer=null});a.element.on("touchleave",function(b){b.stopPropagation();clearInterval(a.timer);a.timer=null})}else{a.element.dom.addEventListener("touchleave",function(){clearInterval(a.timer);a.timer=null});a.element.dom.addEventListener("touchstart",function(d){d.stopPropagation();var f=InfinityMobile.app.getController("ReaderController").getZoomValue();if(a.direction=="left"){if(f<=1){var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode=="fill"){var b=true}else{var b=false}a.fireEvent("autoTurnLeft",b)}else{a.timer=setInterval(function(){a.fireEvent("scrollLeft")},a.duration)}}else{if(a.direction=="right"){if(f<=1){var c=Ext.getStore("SettingStore");if(c.data.items[0].raw.reader.zoomMode=="fill"){var b=true}else{var b=false}a.fireEvent("autoTurnRight",b)}else{a.timer=setInterval(function(){a.fireEvent("scrollRight")},a.duration)}}else{if(a.direction=="up"){a.timer=setInterval(function(){a.fireEvent("scrollUp")},a.duration)}else{a.timer=setInterval(function(){a.fireEvent("scrollDown")},a.duration)}}}});a.element.dom.addEventListener("touchend",function(){clearInterval(a.timer);a.timer=null})}}},0,["navbutton"],["component","container","navbutton"],{component:true,container:true,navbutton:true},["widget.navbutton"],0,[InfinityMobile.view,"NavButton"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuEmailPrompt",Ext.Container,{config:{modal:true,centered:true,width:"30%",style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true},initialize:function(){var a=this;a.setHtml('<div style=\'text-align:center;padding:5px;\'><p style=\'font-size:12px;\'>You must enter a recipient email address!</p></div><div style=\'text-align:center;\'><input type="button" class="btn" onclick="parent.ok()" style="margin: 5px;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" value="Ok" /></div>');ok=function(){a.destroy()}}},0,["clippingmenuemailprompt"],["component","container","clippingmenuemailprompt"],{component:true,container:true,clippingmenuemailprompt:true},["widget.clippingmenuemailprompt"],0,[InfinityMobile.view,"ClippingMenuEmailPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuPreview",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,height:"100%",width:"100%",fullscreen:true,style:"background-color:#000000",zIndex:999999,items:[{itemId:"close",right:5,top:5,height:40,width:40,style:'background-image:url("resources/images/reader icons/close btn.png");background-size:contain;background-position:center;background-repeat:no-repeat;cursor:pointer;'},{itemId:"carousel",xtype:"carousel",ui:"light",height:"100%",width:"100%"}]},initialize:function(){var b=this;Ext.Container.prototype.initialize.apply(this,arguments);if(b.config.images!=null){b.images=b.config.images}if(b.config.clippingMenu!=null){b.clippingMenu=b.config.clippingMenu}for(var a=0;a<b.images.length;a++){if(b.clippingMenu.clippingsContainer.innerItems[a].clicked){var c=Ext.create("Ext.Container",{style:{maxHeight:($(document).height()-80),maxWidth:($(document).width()-80),padding:"10px",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)",webkitTransform:"translate(-50%,-50%)",mozTransform:"translate(-50%,-50%)",msTransform:"translate(-50%,-50%)",backgroundImage:"url('"+b.images[a]+"')",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"}});b.getComponent("carousel").add(c)}}b.getComponent("close").element.on({tap:function(){b.destroy()},scope:b})}},0,["clippingmenupreview"],["component","container","clippingmenupreview"],{component:true,container:true,clippingmenupreview:true},["widget.clippingmenupreview"],0,[InfinityMobile.view,"ClippingMenuPreview"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuPrompt",Ext.Container,{config:{modal:true,centered:true,width:300,style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true,zIndex:9999999},initialize:function(){var a=this;if(a.config.message!=null){var b=a.config.message}else{var b=language.clippings.selectClippings}a.setHtml("<div style='text-align:center;padding:5px;'><p style='font-size:12px;'>"+b+'</p></div><div style=\'text-align:center;\'><input type="button" class="btn" onclick="parent.ok()" ontouchstart="parent.ok()" style="-webkit-appearance:none;margin: 5px;border-style:solid;font-size:12px;height:30px;margin-color:#'+settings.reader.buttonColour+";background-color:#"+settings.reader.buttonColour+";border-color:#"+settings.reader.buttonColour+";width:120px;color:#"+settings.reader.buttonTextColour+';border-radius:0px;" type="button" value="'+language.ok+'" /></div>');ok=function(){a.destroy()};if(settings.newsday!=null){a.element.dom.style.borderRadius=""}}},0,["clippingmenuprompt"],["component","container","clippingmenuprompt"],{component:true,container:true,clippingmenuprompt:true},["widget.clippingmenuprompt"],0,[InfinityMobile.view,"ClippingMenuPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuDeletePrompt",Ext.Container,{config:{modal:true,centered:true,width:300,style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true,zIndex:9999999},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.deleteClippings!=null){a.deleteClippings=a.config.deleteClippings}if(a.config.menu!=null){a.menu=a.config.menu}if(a.config.item!=null){a.item=a.config.item}a.setHtml("<div style='text-align:center;'><p style='font-size:12px;'>"+language.clippings.deleteClippings+'</p></div><div style=\'text-align:center;\'><input class="pointerCursor" type="button" class="btn" ontouchstart="parent.yes()" onclick="parent.yes()" style="margin: 5px;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" value="'+language.yes+'" /><input class="pointerCursor" type="button" class="btn" ontouchstart="parent.no()" onclick="parent.no()" style="margin: 5px;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" value="'+language.no+'" /></div>');yes=function(){a.deleteItems(a.deleteClippings);a.destroy()};no=function(){a.destroy()};if(settings.newsday!=null){a.element.dom.style.borderRadius=""}},deleteItems:function(b){var a=this;a.fireEvent("deleteItem",a.item)}},0,["clippingmenudeleteprompt"],["component","container","clippingmenudeleteprompt"],{component:true,container:true,clippingmenudeleteprompt:true},["widget.clippingmenudeleteprompt"],0,[InfinityMobile.view,"ClippingMenuDeletePrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuThumb",Ext.Panel,{config:{height:"180px"},initialize:function(){var a=this;Ext.Panel.prototype.initialize.apply(this,arguments);if(a.config.image!=null){a.image=a.config.image}if(a.config.clicked!=null){a.clicked=a.config.clicked}if(a.config.imgWidth!=null){a.imgWidth=a.config.imgWidth}if(a.config.imgHeight!=null){a.imgHeight=a.config.imgHeight}var b=150/a.imgHeight;a.setHtml("<img src='"+a.image+"' class='readerPage' style='height:150px;width:"+(a.imgWidth*b)+"px;'  />");a.thumb=a.element.down("div").down("div").down("img");a.setWidth(a.imgWidth*b);a.setStyle("padding:5px;background:url(resources/images/articleloading.gif;background-position:center;background-repeat:no-repeat;background-size:container;");a.thumb.dom.onload=function(){a.element.dom.style.background="";if(!a.clicked){a.element.down("img").dom.style.border="4px solid white"}};a.element.on("tap",function(){if(a.clicked){a.element.down("img").dom.style.border="4px solid white";a.clicked=false}else{a.element.down("img").dom.style.border="4px solid #458FBB";a.clicked=true}})}},0,["clippingmenuthumb"],["component","container","panel","clippingmenuthumb"],{component:true,container:true,panel:true,clippingmenuthumb:true},["widget.clippingmenuthumb"],0,[InfinityMobile.view,"ClippingMenuThumb"],0));(Ext.cmd.derive("InfinityMobile.view.StickyNote",Ext.Container,{draggable:{direction:"both",constraint:null},config:{height:"1px",width:"1px",style:"position:absolute;top:0px;left0px;",items:[{itemId:"textF"}]},initialize:function(){var b=this;if(b.textData==null){b.textData=""}console.log(b);console.log("Position");console.log(b.xAxis+"     "+b.yAxis);if(b.xAxis==null){var c=0}if(b.yAxis==null){var a=0}this.setHtml('<textarea id="note" style="font-size:8pt;background-color:yellow;" onkeyup="parent.typing()" onkeydown="parent.stopTyping()" rows="5" cols="15">'+b.textData+"</textarea>");b.timer;b.done=1000;typing=function(){clearTimeout(b.timer);b.timer=setTimeout(doneTyping,b.done)};stopTyping=function(){clearTimeout(b.timer)};doneTyping=function(){console.log("PageNo");console.log(document.getElementById("note"));if(b.x==null){var d=0}else{var d=b.x}if(b.y==null){var f=0}else{var f=b.y}var e='{"x":'+d+',"y":'+f+', "text":"'+document.getElementById("note").value+'", "page":'+b.pageNo+"}"};b.element.on("drag",function(d){d.stopPropagation();b.x=d.pageX;b.y=d.pageY});b.element.on("dragstart",function(d){d.stopPropagation()});b.element.on("dragend",function(g){g.stopPropagation();console.log(g);b.x=g.pageX-g.event.offsetX;b.y=g.pageY-g.event.offsetY;var f='{"x":'+b.x+',"y":'+b.y+', "text":"'+document.getElementById("note").value+'", "page":'+b.pageNo+', "docWidth":'+$(document).width()+', "docHeight":'+$(document).height()+"}";try{localStorage.setItem("note"+b.pageNo,f)}catch(d){console.log(d)}});b.element.dom.offsetTop=0;b.element.dom.offsetLeft=0}},0,0,["component","container"],{component:true,container:true},0,0,[InfinityMobile.view,"StickyNote"],0));(Ext.cmd.derive("InfinityMobile.view.PrintMenu",InfinityMobile.view.Overlay,{config:{width:700,height:700,style:"padding:0px",layout:"vbox",items:[{itemId:"toolbar",height:40,style:"border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{itemId:"title",top:10,left:10},{itemId:"toolbarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"body",flex:1,padding:25,layout:"vbox",items:[{itemId:"desc"},{itemId:"buttonsContainer",layout:{type:"hbox",pack:"center",align:"middle"},height:100,defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"selectAll",cls:"pointerCursor",width:150,items:[{itemId:"btnText"}]},{width:25},{itemId:"selectNone",cls:"pointerCursor",width:150,items:[{itemID:"btnText"}]},{width:25},{itemId:"print",cls:"pointerCursor",width:150,items:[{itemId:"btnText"}]}]},{itemId:"printItems",flex:1,scrollable:{direction:"vertical",directionLock:true},defaults:{width:150,margin:"0 6 10 6"}}]}]},initialize:function(){var d=this;var c=d.getComponent("toolbar");d.toolbarClose=c.getComponent("toolbarClose");c.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});var a=d.getComponent("body");var b=a.getComponent("buttonsContainer");d.selectAll=b.getComponent("selectAll");d.selectNone=b.getComponent("selectNone");d.print=b.getComponent("print");d.title=c.getComponent("title");d.title.setHtml(language.print.print);d.desc=a.getComponent("desc");d.desc.setHtml(language.print.printContainerText);d.selectAll.getComponent("btnText").setHtml(language.print.selectAll);d.selectNone.getComponent("btnText").setHtml(language.print.printSelectNone);d.print.getComponent("btnText").setHtml(language.print.print);d.setCloseListener();d.setSelectAllListener();d.setSelectNoneListener();d.setPrintListener();d.printItemsContainer=a.getComponent("printItems");d.loadPages()},setCloseListener:function(){var a=this;a.toolbarClose.element.on("tap",function(){a.fireEvent("close",a)})},setSelectAllListener:function(){var a=this;a.selectAll.element.on("tap",function(){a.fireEvent("selectAll",a)});a.selectAll.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"})},setSelectNoneListener:function(){var a=this;a.selectNone.element.on("tap",function(){a.fireEvent("selectNone",a)})},setPrintListener:function(){var a=this;a.print.element.on("tap",function(){a.fireEvent("print",a)})},loadPages:function(){var a=this;a.fireEvent("loadPages",a,a.printItemsContainer)},hide:function(){var a=this;a.fireEvent("enableArticlesContainer");InfinityMobile.view.Overlay.prototype.hide.apply(this,arguments)}},0,["printmenu"],["component","container","panel","overlay","printmenu"],{component:true,container:true,panel:true,overlay:true,printmenu:true},["widget.printmenu"],0,[InfinityMobile.view,"PrintMenu"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderAudioObject",InfinityMobile.view.ReaderMediaObject,{config:{items:[{itemId:"closeBtn",right:0,top:-25,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backImage",style:'background-size:contain;background-image:url("../assets/article view/article-close-btn.png");'}]}],mediaObject:""},initialize:function(){var b=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);b.fileGuid=b.mediaObject.file;var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);console.log(b);var d="http://source.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+".mp3";b.setHtml('<audio controls ><source src="'+d+'" type="audio/mpeg"></audio>');b.setHeight(0);b.getComponent("closeBtn").element.on("tap",function(){b.hide()})}},0,0,["component","container","readermediaobject"],{component:true,container:true,readermediaobject:true},0,0,[InfinityMobile.view,"ReaderAudioObject"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutZoomSlider",InfinityMobile.view.LayoutView,{config:{style:"color:white;top:25%;display:inline-block;",items:[{itemId:"tooltipZoomIn",cls:"tooltip",hidden:true,style:"z-index:10000"},{itemId:"tooltipZoomOut",cls:"tooltip",hidden:true,style:"z-index:10000"}]},initialize:function(){var c=this;if(c.config.json!=null){InfinityMobile.view.LayoutView.prototype.initialize.apply(this,arguments)}var a=InfinityMobile.app.getController("LayoutController");var b=Ext.getStore("SettingStore");var d="15%";c.setHtml('<img id="zoomout" style="position:absolute;left:0px;top:25%;width:15px;" src="../assets/zoomSlider/decrease-ic.png" onmouseleave="parent.clear()" touchcancel="parent.clear(event)" touchleave="parent.clear(event)" onmouseup="parent.zoomStopHold()" touchend="parent.zoomStopHold(event)" onmousedown="parent.zoomOutHold()" touchstart="parent.zoomOutHoldevent()" /><div style:"text-align:center;color:white;"><input id="slider" type="range" min="1" max="'+settings.page.maxZoomLevel+'" step="0.01" style="background:none;cursor:pointer;z-index:5;position:absolute;left:15%;top:'+d+';width:70%;" value="1"/></div><img id="zoomin" style="position:absolute;right:0px;top:25%;width:15px;" src="../assets/zoomSlider/increase-ic.png" onmouseleave="parent.clear()" touchleave="parent.clear(event)" ontouchleave="parent.clear()" onmouseup="parent.zoomStopHold()" ontouchend="parent.zoomStopHold(event)" onmousedown="parent.zoomHold()" ontouchstart="parent.zoomHold(event)" />');c.sliderElement=c.element.down("input");if(Ext.browser.name!="IE"){c.sliderElement.on({scope:c,input:"zooming",change:"zoomimg",tap:"zoom"});c.sliderElement.dom.onmouseup=(function(){c.zoomEnd()})}else{c.sliderElement.on({scope:c,change:"zoom",dragend:"zoomEnd",tap:"zooming"})}c.startedZoom=false;clear=function(){clearInterval(c.timer)};zoom=function(){c.sliderElement.dom.stepUp();c.zoom()};zoomHold=function(f){zoom();c.timer=setInterval(zoom,10);if(f!=null){f.stopPropagation();f.preventDefault();window.oncontextmenu=function(){return false}}};zoomOutHold=function(f){zoomOut();c.timer=setInterval(zoomOut,10);if(f!=null){f.stopPropagation();f.preventDefault();window.oncontextmenu=function(){return false}}};zoomStopHold=function(){clearInterval(c.timer);c.zoomEnd()};zoomOut=function(){c.sliderElement.dom.stepDown();c.zoom()};c.tooltipZoomIn=c.getComponent("tooltipZoomIn");c.tooltipZoomOut=c.getComponent("tooltipZoomOut");c.tooltipZoomIn.setHtml("Zoom In");c.tooltipZoomOut.setHtml("Zoom Out");c.tooltipRight();c.element.on({painted:function(){$("#zoomin").mouseover(function(){c.tooltipZoomIn.show()});$("#zoomin").mouseout(function(){c.tooltipZoomIn.hide()});$("#zoomout").mouseover(function(){c.tooltipZoomOut.show()});$("#zoomout").mouseout(function(){c.tooltipZoomOut.hide()})},scope:c})},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.tooltipZoomIn.element.dom.style.webkitTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomIn.element.dom.style.MozTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomIn.element.dom.style.msTransform="translate3d("+(b.offsetX+$(a.element.dom).width())+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.tooltipZoomOut.element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},zoom:function(){var a=this;if(!a.startedZoom){a.fireEvent("zoomStart",a,a.sliderElement.dom.value);a.startedZoom=true}else{a.fireEvent("zoom",a,a.sliderElement)}},zooming:function(){var a=this;if(!a.startedZoom){a.fireEvent("zoomStart",a,a.sliderElement.dom.value);a.startedZoom=true}else{a.fireEvent("zoom",a,a.sliderElement)}},zoomEnd:function(){var a=this;if(a.sliderElement.dom.value==1){a.fireEvent("zoomEnd",a,a.sliderElement)}else{a.fireEvent("zoomEnd",a,a.sliderElement)}a.startedZoom=false}},0,["zoomslider"],["component","container","layoutview","zoomslider"],{component:true,container:true,layoutview:true,zoomslider:true},["widget.zoomslider"],0,[InfinityMobile.view,"LayoutZoomSlider"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenuImageScroller",Ext.Container,{config:{flex:1,itemId:"scrollerContainer",scrollable:"horizontal",indicator:false,layout:"hbox"}},0,["clippingmenuimagescroller"],["component","container","clippingmenuimagescroller"],{component:true,container:true,clippingmenuimagescroller:true},["widget.clippingmenuimagescroller"],0,[InfinityMobile.view,"ClippingMenuImageScroller"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingMenu",Ext.Container,{config:{modal:true,hideOnMaskTap:true,centered:true,width:"60%",height:"wrap",fullscreen:true,items:[{itemId:"header",items:[{itemId:"title",items:[{id:"clippingToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"description",html:"<div style='background-color:white;border: 1px solid black;border-top:none;border-bottom:none;padding:10px;'><p style='font-size:12px;'>To download or email your clipping(s), simply select one or more and click the relevant button. To view a clipping at a bigger size, select the thumbnail(s) and then click the 'Preview' button.<p><br /><br /><p style='font-size:10px;color:#444444'>Please note: Once you close your browser or exit the session, your clippings library will be cleared.</p></div>"}]},{itemId:"clipping",xtype:"clippingmenuimagescroller",height:"180px",layout:"hbox",width:"100%",style:"background-color:red;padding:10px;border: 1px solid black;border-top:none;border-bottom:none;"},{itemId:"options",style:"background-color:white;height:wrap;",items:[{itemId:"ButtonsDiv"},{itemId:"EmailDiv"}]}]},initialize:function(){var a=this;var b=a;if(a.config.images!=null){a.images=a.config.images}a.getComponent("header").getComponent("title").getComponent("clippingToolBarClose").element.on("tap",function(){a.destroy()});a.getComponent("header").getComponent("title").setHtml('<div style="background-color:#E6E6E6;padding-top:10px;padding-left:5px;padding-right:5px;padding-bottom:10px;border:1px solid black;border-bottom:none;border-top-left-radius:5px;border-top-right-radius:5px;"><h1 style="font-size:16px;">Clipping Options</h1></div>');a.addThumbnails();a.getComponent("options").getComponent("ButtonsDiv").setHtml('<div style="width:100%;background-color:white;padding:10px;height:70px;border: 1px solid black;border-top:none;border-bottom:none;"><input type="button" onclick="parent.download()" style="margin: 5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" value="Download" /><input type="button" onclick="parent.preview()" value="Preview" style="margin:5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#E6E6E6;background-color:#E6E6E6;border-color:#e6e6e6;width:120px;" type="button" /><input type="button" onclick="parent.deleteClip()"  style="margin:5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#e6e6e6;background-color:#e6e6e6;border-color:#e6e6e6;width:120px;" type="button" value="Delete" /></div>');a.getComponent("options").getComponent("EmailDiv").setHtml('<div style="height:210px;width:100%;background-color:white;padding:10px;border: 1px solid black;border-top:none;border-bottom:none;border-bottom-left-radius:5px;border-bottom-right-radius:5px;"><div><div style="font-size:12px;width:40%;float:left;padding:10px;"><form>Recipient email address:<br /><input id="emailTxt" style="width:90%" type="textfield" /><br /><br />Subject:<br /><input id="subjectTxt" style="width:90%" type="textfield" /></form></div><div style="font-size:12px;float:right;width:50%;padding:10px;"><form>Message:<br /><textarea id="messageTxt" style="resize:none;width:90%;" rows="4" ></textarea></form></div></div><div style="padding:10px;float:right;"><input type="button" onclick="parent.email()" value="Send" style="margin: 5px;float:right;border-style:solid;font-size:12px;height:30px;margin-color:#458FBB;background-color:#458FBB;border-color:#458FBB;width:120px;color:white;" type="button" /></div></div>');download=function(){var d=false;for(var c=0;c<a.getComponent("clipping").innerItems.length;c++){if(a.getComponent("clipping").innerItems[c].clicked){window.open(a.images[c]);d=true}}if(!d){a.promptUser()}};deleteClip=function(){var d=[];var c=false;for(var e=0;e<a.getComponent("clipping").innerItems.length;e++){if(a.getComponent("clipping").innerItems[e].clicked){d[d.length]=a.images[e];c=true}}if(c){prompt=Ext.create("InfinityMobile.view.ClippingMenuDeletePrompt",{deleteClippings:d,menu:a})}else{b.promptUser()}};preview=function(){var e=false;for(var d=0;d<b.images.length;d++){if(b.getComponent("clipping").innerItems[d].clicked){e=true;break}}if(e){var c=Ext.create("InfinityMobile.view.ClippingMenuPreview",{images:b.images,clippingMenu:b})}else{b.promptUser()}};email=function(){if(document.getElementById("emailTxt").value!=""){var e=false;var c="mailto:"+document.getElementById("emailTxt").value+"?subject='"+document.getElementById("subjectTxt").value+"'&body='"+document.getElementById("messageTxt").value+"<br /><br />";for(var d=0;d<b.images.length;d++){if(b.getComponent("clipping").innerItems[d].clicked){c+="<img src='"+a.images[d]+"' /><br /><br />";e=true}}if(e){c+="'";window.location.href=c}else{a.promptUser()}}else{prompt=Ext.create("InfinityMobile.view.ClippingMenuEmailPrompt")}}},addThumbnails:function(){var b=this;for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ClippingMenuThumb",{image:b.images[a],clicked:false});b.getComponent("clipping").add(c);c.show()}},deleteItems:function(b){var a=this;a.fireEvent("DeleteClippings",a,b)},promptUser:function(){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuPrompt")},updateImages:function(a){var b=this;b.images=a;b.getComponent("clipping").removeAll(true);b.addThumbnails();console.log(b.getComponent("clipping"))}},0,["clippingmenu"],["component","container","clippingmenu"],{component:true,container:true,clippingmenu:true},["widget.clippingmenu"],0,[InfinityMobile.view,"ClippingMenu"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLanguagePopup",InfinityMobile.view.Overlay,{config:{width:300,height:300,style:"padding:0px",layout:"vbox",hideOnMaskTap:false,items:[{itemId:"languageToolBar",height:40,style:"background-color:#e6e6e6;border-top-left-radius:0.3em;border-top-right-radius:0.3em",items:[{top:10,left:10,html:"<b>Language</b>"},{itemId:"downloadToolBarClose",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"languageContent",layout:"vbox",padding:20,flex:1,items:[{flex:1,html:"We have noticed your Browser Language is different to the language of your publication. Would you like us to update the text to match your Browser Language."},{itemId:"languageButtonsContainer",height:40,layout:"hbox",defaults:{height:40,layout:{type:"hbox",align:"middle",pack:"center"}},items:[{itemId:"updateButton",flex:1,style:"background-color:#458fbb; color:white",items:[{html:"Update"}]},{width:20},{itemId:"cancelButton",flex:1,style:"background-color:#458fbb; color:white",items:[{html:"Cancel"}]}]}]}]},initialize:function(){var d=this;console.log("INITIALIZE");var b=d.getComponent("languageToolBar");d.closeButton=b.getComponent("downloadToolBarClose");var a=d.getComponent("languageContent");var c=a.getComponent("languageButtonsContainer");d.updateButton=c.getComponent("updateButton");d.cancelButton=c.getComponent("cancelButton");d.setCancelListener();d.setUpdateListener()},setCancelListener:function(){var a=this;a.closeButton.element.on("tap",function(){a.fireEvent("cancel",a)});a.cancelButton.element.on("tap",function(){a.fireEvent("cancel",a)})},setUpdateListener:function(){var a=this;a.updateButton.element.on("tap",function(){a.fireEvent("update")})}},0,["readerlanguage"],["component","container","panel","overlay","readerlanguage"],{component:true,container:true,panel:true,overlay:true,readerlanguage:true},["widget.readerlanguage"],0,[InfinityMobile.view,"ReaderLanguagePopup"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOLinkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",html:'<img class="newsdayObject" style="height100%;width:100%;" src="../assets/newsday/link.jpg" />'},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.dom.style.background="none";a.element.on({tap:"onTap",scope:a})},onTap:function(){var c=this;var b=c.mediaObject.url;window.open(b);if(typeof trackReaderEvent!="undefined"){var a=c.mediaObject.page;var d=InfinityMobile.app.getController("MediaController").getSectionName(a);trackReaderEvent("link",{url:b,pageNum:a,section:d})}}},0,["readerolinkobject"],["component","container","readermediaobject","readerolinkobject"],{component:true,container:true,readermediaobject:true,readerolinkobject:true},["widget.readerolinkobject"],0,[InfinityMobile.view,"ReaderOLinkObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOVideo",Ext.Container,{config:{fullscreen:true,modal:true,style:"background-color:black;",height:"100%",width:"100%",layout:"vbox",zIndex:99999999,items:[{itemId:"closeBtn",right:10,top:10,width:40,height:40,cls:"backgroundImage pointerCursor",style:"background-image:url('resources/images/article-close-btn-white.png');background-size:contain;"},{itemId:"videoArea",flex:1,layout:"vbox",items:[{itemId:"video",style:"background-color:black;",flex:2},{itemId:"caption",width:"100%",style:"background-color:#333333;color:white;padding: 10px;",docked:"bottom",flex:1}]}]},initialize:function(){var b=this;if(b.config.url!=null){b.url=b.config.url;b.getComponent("closeBtn").element.on({tap:"close",scope:b});var c=Ext.create("Ext.Panel",{config:{modal:true,height:"100%",width:"100%",centered:true},initialize:function(){this.setHtml('<img src="../assets/newsday/newsdayloadinglogo.png" />');this.element.dom.style.textAlign="center";this.element.dom.style.position="absolute";this.element.dom.style.top="50%";this.element.dom.style.transform="translateY(-50%)"}});c.show();if(b.url.indexOf("http://")!=-1){var a=b.url.substring(7,b.url.length);a="../../Newsday/getatex.aspx?url=http://www.newsday.com/iosfeeds/"+a+"?device=ipad2&_dc=1445010088130&limit=25";$.ajax({type:"GET",url:a,data:{get_param:"value"},dataType:"json",complete:function(){},success:function(e){var f="video.aspx?url="+e.content.mp4+"&newsday=true";b.videoArea=b.getComponent("videoArea");b.video=b.videoArea.getComponent("video");b.video.setHtml("<iframe id='newsdayVideo' onload='parent.onload()'  allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' src='"+f+"' width='100%' height='100%' frameborder='0' scrolling='no' />");var d=$(b.videoArea.element.dom).find(".x-innerhtml")[0];$(d).css("height","100%");b.getComponent("videoArea").getComponent("caption").setHtml("<div style='width:100%;color:white;padding:10px;'><p>"+e.content.caption+"</p></div>");onload=function(){c.destroy()};videoplay=function(){console.log("play")};b.fireEvent("ovideoinitialized",b,e)},error:function(){c.destroy();b.fireEvent("oVideoError",b)}})}}},close:function(){var a=this;a.fireEvent("closeOVideo",a)}},0,["readerovideo"],["component","container","readerovideo"],{component:true,container:true,readerovideo:true},["widget.readerovideo"],0,[InfinityMobile.view,"ReaderOVideo"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOGallery",Ext.Container,{config:{fullscreen:true,modal:true,style:"background-color:black;",height:"100%",width:"100%",zIndex:99999999,layout:{type:"vbox"},items:[{itemId:"content",flex:1,width:"100%",layout:{type:"hbox"},items:[{itemId:"closeBtn",right:10,top:10,width:40,height:40,cls:"backgroundImage pointerCursor",style:"background-image:url('resources/images/article-close-btn-white.png');background-size:contain;"},{itemId:"images",directionLock:true,height:"100%",width:"100%",style:"background-color:black;"},{itemId:"caption",bottom:0,width:"100%",style:"background-color:black;opacity:0.8;color:white;padding: 10px;max-height:200px;",hidden:true,flex:1,scrollable:{directionLock:true,direction:"vertical"}}]},{itemId:"navBar",docked:"bottom",height:40,width:"100%",layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"prev",width:25,style:"text-align:center",html:'<i class="fa fa-angle-left fa-lg" aria-hidden="true"></i>'},{itemId:"counter",margin:"0px 20px 0px 20px"},{itemId:"next",width:25,style:"text-align:center",html:'<i class="fa fa-angle-right fa-lg" aria-hidden="true"></i>'},{itemId:"captionIcon",cls:"captionicon",right:0,padding:10,html:'<i class="fa fa-info-circle fa-lg" aria-hidden="true"></i>'}]}]},initialize:function(){var k=this;k.content=k.getComponent("content");k.navBar=k.getComponent("navBar");k.navBar.setStyle({backgroundColor:"#"+settings.topbar.backgroundColor,color:"#"+settings.topbar.color});if(k.config.article!=null){k.article=k.config.article}k.captionIcon=k.navBar.getComponent("captionIcon");k.captionIcon.element.on({tap:k.caption,scope:k});k.previousBtn=k.navBar.getComponent("prev");k.nextBtn=k.navBar.getComponent("next");k.counter=k.navBar.getComponent("counter");if(k.config.url!=null){k.url=k.config.url;k.captions=[];k.content.getComponent("closeBtn").element.on({tap:"close",scope:k});var b=Ext.create("InfinityMobile.view.ReaderOGalleryLoading",{});if(k.url.indexOf("http://")!=-1){var c=k.url.substring(7,k.url.length)}else{c=k.url}c="../../Newsday/getatex.aspx?url=http://www.newsday.com/iosfeeds/"+c+"?device=phone&_dc=1445010088130&limit=25";$.ajax({type:"GET",url:c,data:{get_param:"value"},dataType:"json",complete:function(){b.destroy()},success:function(n){var l=[];for(var m=0;m<n.content.images.length;m++){var p={imageUrl:n.content.images[m].image_path,pageNo:m,config:{pageNo:m}};k.captions[m]=n.content.images[m].caption;l[l.length]=p}k.counter.setHtml("1 of "+k.captions.length);if(k.captions[0]!=null){if(k.captions[0].trim().length>0){k.captionIcon.show()}else{k.captionIcon.hide()}}else{k.captionIcon.hide()}k.setupCarousel(l);k.data=n;var o="1 of "+k.captions.length;k.fireEvent("ogalleryinitialized",k,n,o)}})}else{if(k.config.images!=null){k.images=k.config.images;k.captions=[];k.content.getComponent("closeBtn").element.on({tap:"close",scope:k});var b=Ext.create("InfinityMobile.view.ReaderOGalleryLoading",{});var d=[];for(var h=0;h<k.images.length;h++){var f={imageUrl:k.images[h].url,pageNo:h,config:{pageNo:h}};d[d.length]=f;var e="";if(k.images[h].credit!=null){if(k.images[h].credit.trim().length>0){e=" ("+k.images[h].credit+")"}}k.captions[h]=k.images[h].caption+e}b.destroy();k.counter.setHtml("1 of "+k.captions.length);if(k.captions[0]!=null){if(k.captions[0].trim().length>0){k.captionIcon.show()}else{k.captionIcon.hide()}}else{k.captionIcon.hide()}k.setupCarousel(d);var j="1 of "+k.captions.length;var a=k.article.byline;if(k.article.reporters!=null&&k.article.reporters.length>0){for(var h in k.article.reporters){a+=", "+k.article.reporters[h].name}}var g={author:a,contentTitle:k.article.headline,contentType:"photolist"};k.fireEvent("ogalleryinitializedArticle",k,g,j)}}k.previousBtn.element.on({tap:function(){k=this;k.carousel.previous()},scope:k});k.nextBtn.element.on({tap:function(){k=this;k.carousel.next()},scope:k})},close:function(){var a=this;a.fireEvent("closeOGallery",a)},caption:function(){var b=this;if(b.content.getComponent("caption").isHidden()){b.index=b.carousel.getActiveItem().getPageNo();if(b.captions[b.index].length>0){b.content.getComponent("caption").setHtml("<div style='width:100%;color:white;padding:10px;'><p>"+b.captions[b.index]+"</p></div>");b.content.getComponent("caption").show();var a=$(b.content.getComponent("caption").element.down(".x-innerhtml").dom).height();if(a>120){b.content.getComponent("caption").setHeight(140)}else{b.content.getComponent("caption").setHeight(a+20)}b.content.getComponent("caption").getScrollable().getScroller().scrollTo(0,0)}}else{b.content.getComponent("caption").hide()}},itemChange:function(c,k,b,g){var j=this;j.index=j.carousel.getActiveItem().getPageNo();if(!j.content.getComponent("caption").isHidden()){j.content.getComponent("caption").setHtml("<div style='width:100%;color:white;padding:10px;'><p>"+j.captions[j.index]+"</p></div>");var h=$(j.content.getComponent("caption").element.down(".x-innerhtml").dom).height();if(h>120){j.content.getComponent("caption").setHeight(140)}else{j.content.getComponent("caption").setHeight(h+20)}j.content.getComponent("caption").getScrollable().getScroller().scrollTo(0,0)}if(j.captions[j.index]!=null){if(j.captions[j.index].trim().length>0){j.captionIcon.show()}else{j.captionIcon.hide()}}else{j.captionIcon.hide()}j.counter.setHtml((c.getActiveItem().getPageNo()+1)+" of "+j.captions.length);var f=(c.getActiveItem().getPageNo()+1)+" of "+j.captions.length;if(j.url!=null){if(j.data!=null){j.fireEvent("ogalleryinitialized",j,j.data,f)}}else{var a=j.article.byline;if(j.article.reporters!=null&&j.article.reporters.length>0){for(var e in j.article.reporters){a+=", "+j.article.reporters[e].name}}var d={author:a,contentTitle:j.article.headline,contentType:"photolist"};j.fireEvent("ogalleryinitializedArticle",j,d,f)}},setupCarousel:function(a){var b=this;b.carousel=Ext.create("InfinityMobile.view.ImageCarousel",{width:"100%",height:"100%",data:a,pageNo:1,pageTemplate:function(d,f,c){var e=Ext.create("InfinityMobile.view.ReaderOGalleryItem",{imageUrl:d.imageUrl,pageNo:d.pageNo});e.element.on({tap:b.caption,scope:b});return e}});b.content.getComponent("images").add(b.carousel);b.carousel.on({activeitemchange:"itemChange",scope:b})}},0,["readerogallery"],["component","container","readerogallery"],{component:true,container:true,readerogallery:true},["widget.readerogallery"],0,[InfinityMobile.view,"ReaderOGallery"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOGalleryItem",Ext.Container,{config:{pageNo:0},initialize:function(){var a=this;if(a.config.imageUrl!=null){a.imageUrl=a.config.imageUrl;if(a.config.pos!=null){a.pos=a.config.pos}this.element.dom.style.height="100%";this.element.dom.style.width="100%";this.element.dom.style.backgroundImage="url("+a.imageUrl+")";this.element.dom.style.backgroundSize="contain";this.element.dom.style.backgroundPosition="center";this.element.dom.style.backgroundRepeat="no-repeat"}}},0,["readerogalleryitem"],["component","container","readerogalleryitem"],{component:true,container:true,readerogalleryitem:true},["widget.readerogalleryitem"],0,[InfinityMobile.view,"ReaderOGalleryItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOGalleryLoading",Ext.Container,{config:{modal:true,fullscreen:true,centered:true,zIndex:999999999},initialize:function(){var a=this;a.loadingLogo="../assets/newsday/newsdayloadinglogo.png";if(a.config.loadingLogo!=null){a.loadingLogo=a.config.loadingLogo}this.element.dom.style.height="100%";this.element.dom.style.width="100%";this.element.dom.style.backgroundImage="url("+a.loadingLogo+")";this.element.dom.style.backgroundSize="150px 150px";this.element.dom.style.backgroundPosition="center";this.element.dom.style.backgroundRepeat="no-repeat"}},0,["readerogalleryloading"],["component","container","readerogalleryloading"],{component:true,container:true,readerogalleryloading:true},["widget.readerogalleryloading"],0,[InfinityMobile.view,"ReaderOGalleryLoading"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOVideoObject",InfinityMobile.view.ReaderMediaObject,{config:{html:'<img class="newsdayObject" style="height100%;width:100%;" src="../assets/newsday/watch_video.jpg" />'},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.dom.style.background="none";a.element.on({tap:a.onTap,scope:a})},onTap:function(){var b=this;var a=b.mediaObject.url;b.fireEvent("ovideoclicked",b,a)}},0,["readerovideoobject"],["component","container","readermediaobject","readerovideoobject"],{component:true,container:true,readermediaobject:true,readerovideoobject:true},["widget.readerovideoobject"],0,[InfinityMobile.view,"ReaderOVideoObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderOGalleryObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",html:'<img class="newsdayObject" style="height100%;width:100%;" src="../assets/newsday/view_gallery.jpg" />'},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.dom.style.background="none";a.element.on({tap:"onTap",scope:a})},onTap:function(){var b=this;var a=b.mediaObject.url;b.fireEvent("galleryClick",b,a)}},0,["readerogalleryobject"],["component","container","readermediaobject","readerogalleryobject"],{component:true,container:true,readermediaobject:true,readerogalleryobject:true},["widget.readerogalleryobject"],0,[InfinityMobile.view,"ReaderOGalleryObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderVideoLinkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",style:"background-color:black;text-align:center;overflow:hidden",cls:"readerLightbox",layout:"vbox",padding:"25%"},initialize:function(){var c=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);var d=hexToRgb("000000");c.element.dom.style.background="rgba("+d+","+0+")";var b="";if(c.mediaObject.param2!=null){if(c.mediaObject.param2.length>0){var a=c.mediaObject.param2.split("|");if(a.length>1){b=a[1]}else{b="Play Video"}}else{b="Play Video"}}else{b="Play Video"}c.element.on({tap:"onTap",scope:c})},onTap:function(){var a=this;if(a.mediaObject.url=="http://LIGHTBOX"||a.mediaObject.param3=="LIGHTBOX"){a.fireEvent("lightbox",a,a.mediaObject,"video")}}},0,["readervideolinkobject"],["component","container","readermediaobject","readervideolinkobject"],{component:true,container:true,readermediaobject:true,readervideolinkobject:true},["widget.readervideolinkobject"],0,[InfinityMobile.view,"ReaderVideoLinkObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLightbox",Ext.Container,{config:{modal:true,centered:true,hideOnMaskTap:true,height:1000,width:1000,maxHeight:"80%",maxWidth:"80%",layout:"vbox",items:[{itemId:"topBar",height:40,layout:"hbox",items:[{id:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{itemId:"content",flex:1,cls:"innerhtmlfullheight",style:"background-color:white"}]},initialize:function(){var a=this;if(currentProfile!="desktop"){a.setWidth("100%");a.setHeight("100%");a.setMaxWidth("100%");a.setMaxHeight("100%")}a.topBar=a.getComponent("topBar");a.topBar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});a.closeButton=a.topBar.getComponent("toolBarClose");a.setCloseButtonListenter();a.mediaObject=a.config.mediaObject;a.mediaType=a.config.mediaType;Ext.Container.prototype.initialize.apply(this,arguments);a.content=a.getComponent("content");if(a.mediaType=="image"){a.setImageContent()}else{if(a.mediaType=="video"){a.setVideoContent()}}},setCloseButtonListenter:function(){var a=this;a.closeButton.element.on("tap",function(){a.close()})},setImageContent:function(){var b=this;b.fileGuid=b.mediaObject.file;var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);b.imageurl="http://pages.cdn.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+".jpg";b.setStyle({maxHeight:"80%",maxWidth:"80%"});b.content.setHtml("<img src='"+b.imageurl+"' style='width:100%;height:100%' />")},setVideoContent:function(){var a=this;if(a.mediaObject!=""){if(a.mediaObject.url.indexOf("http://www.youtube.com/watch")!=-1){a.initializeYoutube()}else{if(a.mediaObject.url.indexOf("http://")!=-1){a.initialiseVimeo()}else{if(a.mediaObject.file!=""){a.initializeMP4()}}}}},initializeMP4:function(){var b=this;b.fileGuid=b.mediaObject.file;var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);b.videoUrl="http://source.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+".mp4";videoUrl="video.aspx?guid="+b.fileGuid;b.setHtml("<iframe allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' src='"+videoUrl+"' width='100%' height='100%'  frameborder='0' scrolling='no' />");videoplay=function(){b.videoPlayListener()}},initializeYoutube:function(){var b=this;b.youtubeCode=b.mediaObject.url.substr(b.mediaObject.url.length-11);var a="http://www.youtube.com/embed/"+b.youtubeCode;b.content.setHtml("<iframe onload='parent.youtubeplay()' src='"+a+"?enablejsapi=1' width='100%' height='100%' frameborder='0' id='"+a+"'/>");youtubeplay=function(){var c=new YT.Player(document.getElementById(a),{events:{onStateChange:b.onPlayerStateChange}})}},videoPlayListener:function(){var b=this;var a=Ext.getStore("SettingStore");console.log(b);if(a.data.items[0].raw.tracking!=null){var c=a.data.items[0].raw.tracking.trackingType;if(c=="GA"){ga("set","page","/"+b.mediaObject.page);ga("send","pageview");ga("send","event","MP4","play",b.mediaObject.name,b.mediaObject.page)}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})},onPlayerStateChange:function(c){var b=this;if(c.data==1){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.tracking!=null){var d=a.data.items[0].raw.tracking.trackingType;if(d=="GA"){ga("set","page","/"+b.startpageNumber);ga("send","pageview");ga("send","event","Youtube","play",c.target.getVideoData().title,b.startpageNumber)}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}},close:function(){var a=this;a.destroy()},fadeIn:function(){var a=this;Ext.Anim.run(a.content,"fade",{out:false,duration:3000,autoClear:true})},fadeOut:function(){var a=this;Ext.Anim.run(a,"fade",{out:true,duration:3000,autoClear:true,after:function(){Ext.Viewport.remove(a)}})}},0,["readerlightbox"],["component","container","readerlightbox"],{component:true,container:true,readerlightbox:true},["widget.readerlightbox"],0,[InfinityMobile.view,"ReaderLightbox"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageLinkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"readerLightbox",items:[{itemId:"tooltip",style:"position:absolute !important;"}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.element.on({tap:"onTap",scope:a});if(a.mediaObject!=""){a.getComponent("tooltip").setHtml('<div style="position:absolute;" class="tool-tip">Click here</div>');a.element.dom.onmousemove=(function(b){if(b.clientX<($(document).width()/2)){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)"}else{a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX-(a.getComponent("tooltip").element.dom.scrollWidth+15))+"px, "+(b.offsetY-15)+"px, 0) scale3d("+1+","+1+",1)"}})}},onTap:function(){var a=this;if(a.mediaObject.url=="http://LIGHTBOX"){a.fireEvent("lightbox",a,a.mediaObject,"image")}}},0,["readerimagelinkobject"],["component","container","readermediaobject","readerimagelinkobject"],{component:true,container:true,readermediaobject:true,readerimagelinkobject:true},["widget.readerimagelinkobject"],0,[InfinityMobile.view,"ReaderImageLinkObject"],0));(Ext.cmd.derive("InfinityMobile.view.Note",Ext.Container,{height:"1px",width:"1px",fullscreen:true,draggable:{direction:"both",constraint:null},config:{items:[{itemId:"textF"}]},initialize:function(){var b=this;if(b.textData==null){b.textData=""}console.log("Position");console.log(b.xAxis+"     "+b.yAxis);if(b.xAxis==null){var c=0}if(b.yAxis==null){var a=0}this.getComponent("textF").setHtml('<textarea id="note" style="font-size:8pt;background-color:yellow;position:absolute;left:'+b.xAxis+"px;top:"+b.yAxis+'px;" onkeyup="parent.typing()" onkeydown="parent.stopTyping()" rows="5" cols="15">'+b.textData+"</textarea>");b.timer;b.done=1000;typing=function(){clearTimeout(b.timer);b.timer=setTimeout(doneTyping,b.done)};stopTyping=function(){clearTimeout(b.timer)};doneTyping=function(){console.log("PageNo");console.log(document.getElementById("note"));if(b.x==null){var d=0}else{var d=b.x}if(b.y==null){var h=0}else{var h=b.y}var f='{"x":'+d+',"y":'+h+', "text":"'+document.getElementById("note").value+'", "page":'+b.pageNo+"}";try{localStorage.setItem("note"+b.pageNo,f)}catch(g){console.log(g)}};b.element.on("drag",function(d){d.stopPropagation();b.x=d.pageX;b.y=d.pageY});b.element.on("dragstart",function(d){d.stopPropagation()});b.element.on("dragend",function(g){g.stopPropagation();console.log(g);b.x=g.pageX-g.event.offsetX;b.y=g.pageY-g.event.offsetY;var f='{"x":'+b.x+',"y":'+b.y+', "text":"'+document.getElementById("note").value+'", "page":'+b.pageNo+', "docWidth":'+$(document).width()+', "docHeight":'+$(document).height()+"}";try{localStorage.setItem("note"+b.pageNo,f)}catch(d){console.log(d)}})}},0,0,["component","container"],{component:true,container:true},0,0,[InfinityMobile.view,"Note"],0));(Ext.cmd.derive("InfinityMobile.view.Main",Ext.Panel,{config:{layout:"card",pageNo:""},loadArticle:function(a){var b=this;console.log("Loading Article!");b.fireEvent("loadArticle",a)},loadReader:function(b,d,a){var c=this;c.fireEvent("loadReader",b,d,a)},loadFlashReader:function(c,a){var b=this;b.fireEvent("loadFlashReader",c,a)},cacheLatestEdition:function(a){var b=this;var c="/api/get_editions.aspx?appplatformid="+a+"&uuid=E08BA9CA-2D5E-475B-91C5-D6D9D367F4CF";$.ajax({crossDomain:true,type:"GET",async:false,data:{base64Url:$.base64.encode(c)},url:"../API/binary_proxy.aspx",success:function(e){if(e!=null&&e.Data.length>0){var d=e.Data[0];b.fireEvent("cacheLatestEdition",b,a,d.publicationguid,d.editionguid)}}});b.fireEvent("CacheLatestEdition",b)},loadView:function(a){var b=this;b.fireEvent("loadViewController",b,a)},loadModalView:function(b){var a=this;a.fireEvent("loadModalView",b)},removeView:function(){var a=this;a.fireEvent("removeView")}},0,["main"],["component","container","panel","main"],{component:true,container:true,panel:true,main:true},["widget.main"],0,[InfinityMobile.view,"Main"],0));(Ext.cmd.derive("InfinityMobile.view.Reader",Ext.Panel,{showToolBar:true,config:{fullscreen:true,layout:"vbox",showToolBar:true,style:"transition: .4s ease-out;"},beforeInitialize:function(){var a=this;a.element.on({singletap:"onTap",scope:this})},initialize:function(){var a=this;a.fireEvent("ready",a);if(window.SpeechSynthesisUtterance!=undefined){window.speechSynthesis.cancel();$(window).unload(function(){window.speechSynthesis.cancel();readAloud.status="STOPPED"});window.document.addEventListener("visibilitychange",function(b){window.speechSynthesis.cancel();readAloud.status="STOPPED"})}},onTap:function(){var a=this;a.fireEvent("readertap",a)}},0,["reader"],["component","container","panel","reader"],{component:true,container:true,panel:true,reader:true},["widget.reader"],0,[InfinityMobile.view,"Reader"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderToolbar",Ext.Toolbar,{beforeInitialize:function(){var a=this;a.element.on({tap:"onTap",scope:this})},config:{cls:"toolbar",items:[{xtype:"button",text:"Back",action:"toolbarback"},{xtype:"container",flex:1},{xtype:"button",text:"<",action:"toolbarprevious"},{xtype:"textfield",id:"toolbarpages",placeHolder:"1 / 76",width:"105px"},{xtype:"button",text:">",action:"toolbarnext"},{xtype:"container",flex:1},{xtype:"button",text:"Menu",action:"toolbarmenu"},{itemId:"tooltip",html:'<div style="position:absolute;" class="tool-tip"></div>'}]},onTap:function(a){a.stopPropagation()}},0,["readertoolbar"],["component","container","toolbar","readertoolbar"],{component:true,container:true,toolbar:true,readertoolbar:true},["widget.readertoolbar"],0,[InfinityMobile.view,"ReaderToolbar"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderToolbarBottom",Ext.Container,{beforeInitialize:function(){var a=this;a.element.on({tap:"onTap",scope:this})},config:{style:"background-color:rgba(0, 0, 0, 0.7) !important; padding:8px; padding-top:26px; padding-bottom:0",layout:"vbox",items:[{itemId:"toolbarClose",height:26,width:75,right:-8,top:-26,padding:"0 8px 0 0",style:"font-family:arial;color:#cccccc",layout:{type:"hbox",align:"center",pack:"right"},items:[{itemId:"closeTxt",html:"Close",height:18,style:"font-size:16px;margin-right:5px"},{height:18,html:"<img src='../assets/article view/article-close-btn.png' style='width:16px' />"}]},{flex:1,itemId:"scrollerContainer",scrollable:"horizontal"}]},initialize:function(){var a=this;a.fireEvent("initialized",a);a.setStyle("background-color:rgba(0,0,0,0.7);");a.toolbarClose=a.getComponent("toolbarClose");a.closeTxt=a.toolbarClose.getComponent("closeTxt");a.closeTxt.setHtml(language.close);a.scrollerContainer=a.getComponent("scrollerContainer");a.scroller=a.scrollerContainer.getScrollable();a.scroller.on({scroll:function(b){console.log(a.scrollerContainer.getItems())},scope:a});a.setCloseEvent()},setCloseEvent:function(){var a=this;a.toolbarClose.element.on("tap",function(){a.fireEvent("close",a)})},onTap:function(a){a.stopPropagation()}},0,["readertoolbarbottom"],["component","container","readertoolbarbottom"],{component:true,container:true,readertoolbarbottom:true},["widget.readertoolbarbottom"],0,[InfinityMobile.view,"ReaderToolbarBottom"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPages",Ext.Container,{initialize:function(){var a=this;a.fireEvent("initialized",a)},config:{id:"pagescontainer",layout:"hbox",height:"100%",defaults:{width:150}}},0,["readerpages"],["component","container","readerpages"],{component:true,container:true,readerpages:true},["widget.readerpages"],0,[InfinityMobile.view,"ReaderPages"],0));(Ext.cmd.derive("InfinityMobile.view.Blocker",Ext.Container,{config:{top:0,left:0,width:"100%",height:"100%",layout:"fit",style:"background:rgba(0, 0, 0, 0.75)"}},0,["blocker"],["component","container","blocker"],{component:true,container:true,blocker:true},["widget.blocker"],0,[InfinityMobile.view,"Blocker"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuClose",Ext.Container,{config:{html:"Close",style:"color:white; margin-bottom:25px"},initialize:function(){var a=this;a.element.on({tap:"onTap",scope:a})},onTap:function(b){var a=this;a.parent.fireEvent("close",a);b.stopPropagation()}},0,["readermenuclose"],["component","container","readermenuclose"],{component:true,container:true,readermenuclose:true},["widget.readermenuclose"],0,[InfinityMobile.view,"ReaderMenuClose"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuSection",InfinityMobile.view.Overlay,{config:{width:250,layout:"vbox",style:"background-color:#1e1e1e;padding:0; border-radius:0; height:calc(100% - 40px)",right:0,top:40,items:[{itemId:"sectionitemscontainer",style:"background-color:#1e1e1e;",layout:"vbox",height:"100%",defaults:{padding:15,style:"color:#ffffff"},items:[{style:"color:#cccccc; font-size:14px",id:"sectionitemback",html:"<img src='../assets/menu/menu-arrow-left-ic.png' style='height:13px; margin-right:10px' />BACK"}]}]},initialize:function(){var a=this;a.sectionItemsContainer=a.getComponent("sectionitemscontainer");a.sectionitemback=a.sectionItemsContainer.getComponent("sectionitemback");a.sectionitemback.element.on({tap:"backtapped",scope:a});a.fireEvent("initialized",a)},backtapped:function(){var a=this;a.fireEvent("back",a)}},0,["readermenusection"],["component","container","panel","overlay","readermenusection"],{component:true,container:true,panel:true,overlay:true,readermenusection:true},["widget.readermenusection"],0,[InfinityMobile.view,"ReaderMenuSection"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuSectionItem",Ext.Container,{config:{style:"font-size:14px;color:#cccccc;cursor:pointer",name:"",pageNumber:""},initialize:function(){var a=this;a.name=a._name;a.pageNumber=a._pageNumber;a.setHtml(a.name);if(settings.newsday!=null){a.addCls("menuItem")}a.element.on({tap:"onTap",scope:a})},onTap:function(b){var a=this;a.fireEvent("sectionclick",a);b.stopPropagation()}},0,["readermenusectionitem"],["component","container","readermenusectionitem"],{component:true,container:true,readermenusectionitem:true},["widget.readermenusectionitem"],0,[InfinityMobile.view,"ReaderMenuSectionItem"],0));(Ext.cmd.derive("InfinityMobile.view.InfiniteCarousel",Ext.Carousel,{initialize:function(){var a=this;Ext.carousel.Carousel.prototype.initialize.call(this);a.on("activeitemchange","handleItemChange",this);a._visiblePages=Math.min(a._visiblePages,a.getData().length);a.setCards();a.setOrientationChange();a.canChangeOrientation=true;a.element.onBefore("touchstart","beforeTap",this);a.element.onAfter("touchend","beforeTouchEnd",this)},config:{indicator:false,data:false,pageNumber:0,skipActiveItemChange:true,pageTemplate:false,visiblePages:3,directionLock:true,landscapePageIncrement:1,mode:"double"},setPageTemplate:function(a){this.pageTemplate=a},setCards:function(){var e=this;if(Ext.os.is.Desktop){e.setStyle("background-color:#e1e1e1;")}if(e._mode=="single"){e._landscapePageIncrement=1}e._skipActiveItemChange=true;var c=1;if(e.returnOrientation()=="landscape"){c=e.getLandscapePageIncrement()}if(e._pageNumber==0){for(var b=0;b<e._visiblePages;b++){var d=Math.min((b*c),(e.getData().length-1));e.add(e.createCard(e.getData()[d],d,e.getData()))}e.setActiveItem(0)}else{if(e._pageNumber==(e.getData().length-1-pageOffset)){for(var b=(e._pageNumber-2);b<e.getData().length;b++){e.add(e.createCard(e.getData()[b],b,e.getData()))}e.setActiveItem(2)}else{if(c==2){var a=0;for(var b=(e._pageNumber-(1*c));b<(e._pageNumber+(2*c));b+=c){if(b>=0){e.add(e.createCard(e.getData()[b],b,e.getData(),a));a++}}}else{for(var b=(e._pageNumber-(1*c));b<(e._pageNumber+(2*c));b+=c){e.add(e.createCard(e.getData()[b],b,e.getData()))}}e.setActiveItem(1)}}e._skipActiveItemChange=false},handleItemChange:function(h,g,d,e){var f=this;var f=this;var j=1;if(f.returnOrientation()=="landscape"){j=f.getLandscapePageIncrement()}if(!f._skipActiveItemChange){if(g.getPageNo()>d.getPageNo()){var c=Math.max(d.getPageNo(),0);var b=1;var a=Math.max(g.getPageNo(),0);if(f.getData().length%2==1&&a==f.getData().length-2&&f._mode=="double"&&f.returnOrientation()=="landscape"){b=2}if(c==0||g.getPageNo()>=(f.getData().length-b-pageOffset)){}else{f.addCardToFront(h,h.getItems().items[0],j)}f._pageNumber+=j;f._pageNumber=Math.min(f._pageNumber,(f.getData().length-1-pageOffset))}else{var a=Math.max(g.getPageNo(),0);if(a==0||d.getPageNo()>=(f.getData().length-1-pageOffset)){if(a==0&&d.getPageNo()==1&&f._mode=="double"&&f.returnOrientation()=="landscape"&&f.getData().length>3){d.setPageNo(2);d.mappedPageNumber=flatPlanData.reversePageMapper[3]-1;d.imagetoload=d.landscapeimage;d.portraitTileImage=d.landscapeTileImage;h.getItems().items[2].setPageNo(4);h.getItems().items[2].mappedPageNumber=flatPlanData.reversePageMapper[5]-1;h.getItems().items[2].imagetoload=h.getItems().items[2].landscapeimage;h.getItems().items[2].portraitTileImage=h.getItems().items[2].landscapeTileImage}if(d.getPageNo()>=(f.getData().length-1-pageOffset)&&a%2==0&&d.getPageNo()>=(f.getData().length-1-pageOffset)&&(f.getData().length-pageOffset)%2==0){j=1}}else{if(d.getPageNo()==(f.getData().length-2-pageOffset)&&f.getData().length-pageOffset%2==1&&f._mode=="double"&&f.returnOrientation()=="landscape"){f.addCardToFront(h,h.getItems().items[pageOffset],0)}f.addCardToBack(h,h.getItems().items[2],j)}f._pageNumber-=j;f._pageNumber=Math.max(f._pageNumber,0)}}if(d!=null){if(d.pauseVideos!=null){d.pauseVideos()}}},updateItemCSS:function(f,d){var e=this;var a=f.getItems().items;for(var c=0;c<a.length;c++){var b=a[c];if(b._itemId!=d._itemId){b.setCls("")}}d.setCls("selecteditem")},createCard:function(f,b,a,c){var e=this;var d;if(!e.pageTemplate){d={pageNo:b,html:"Page: "+b}}else{d=e.pageTemplate(f,b,a)}return d},addCardToFront:function(f,c,b){var d=this;c._skipActiveItemChange=true;f.remove(c,true);var a=1;if(d.returnOrientation()=="landscape"){a=d.getLandscapePageIncrement()}var e=(d._pageNumber+b+a);e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createCard(d.getData()[e],e,d.getData()))},addCardToBack:function(f,a,c){var d=this;var b=1;if(d.returnOrientation()=="landscape"){b=d.getLandscapePageIncrement()}a._skipActiveItemChange=true;f.remove(a,true);var e=(d._pageNumber-c-b);e=Math.max(e,0);f.insert(0,d.createCard(d.getData()[e],e,d.getData()))},jumpToFirst:function(){this.jumpToPage(0)},jumpToLast:function(){this.jumpToPage((this.getData().length-1))},jumpToPage:function(b){var c=this;if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){b=(this.getData().length-b)-1}var a=b;var a=Math.max(a,(this.getData().length-1));a=Math.min(a,0);if(b!=c._pageNumber){if(c._mode=="single"||c.returnOrientation()=="portrait"){if(b==(c._pageNumber+1)){c.next()}else{if(b==(c._pageNumber-1)){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}else{if(b==(c._pageNumber+2)){c.next()}else{if(b==(c._pageNumber-2)){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}}},setOrientationChange:function(){var a=this;var b=(function(){var c=0;return function(e,d){clearTimeout(c);c=setTimeout(e,d)}})();if(Ext.os.is.Desktop){$(window).on("resize",function(){b(function(){a.onResize()},250)})}else{if(Ext.os.is.Android){$(window).on("resize",function(){setTimeout(function(){a.onResize()},0)})}else{Ext.Viewport.on("orientationchange",function(d,f,e,c){a.onResize()})}}},isDPS:function(){var a=this;return(a.returnOrientation()=="landscape"&&a._mode=="double")},onResize:function(){var e=this;e.onSizeChange();e.fireEvent("resizeArticleController");e.fireEvent("resizeDynamicArticles");e.fireEvent("resizeClipping");if(e.element.dom.clientWidth!=0){var d=e.getActiveItem();if(d.onResize!=null){d.onResize()}var a=e.getItems().items;for(var b=0;b<a.length;b++){var c=a[b];if(c.getPageNo()!=d.getPageNo()){var c=a[b];if(c.onResize!=null){c.onResize()}}}}e.fireEvent("updatePageNumber",e)},disableTiling:function(){var b=this;if(b.element.dom.clientWidth!=0){var a=b.getActiveItem();a.stopTiling();setTimeout(function(){var c=b.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo()!=a.getPageNo()){var e=c[d];e.stopTiling()}}},100)}},enableTiling:function(){var b=this;if(b.element.dom.clientWidth!=0){var a=b.getActiveItem();a.setTiling();setTimeout(function(){var c=b.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo()!=a.getPageNo()){var e=c[d];e.setTiling()}}},100)}},toggleDPS:function(){var b=this;if(b._mode=="single"){b._mode="double";b.setLandscapePageIncrement(2)}else{b._mode="single";b.setLandscapePageIncrement(1)}var a=b.getActiveItem();a.toggleDPS();setTimeout(function(){var c=b.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo()!=a.getPageNo()){var e=c[d];e.toggleDPS()}}},100);b.fireEvent("updatePageNumber",b)},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},beforeTap:function(){var a=this;PDFJS.isPaused=true},beforeTouchEnd:function(){var a=this;PDFJS.isPaused=false;a.fireEvent("resumePDF",a)}},0,["infinitecarousel"],["component","container","carousel","infinitecarousel"],{component:true,container:true,carousel:true,infinitecarousel:true},["widget.infinitecarousel"],0,[InfinityMobile.view,"InfiniteCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.PDFInfiniteCarousel",Ext.Carousel,{initialize:function(){var a=this;Ext.carousel.Carousel.prototype.initialize.call(this);a.on("activeitemchange","handleItemChange",this);a.disable();a._visiblePages=Math.min(a._visiblePages,a.getData().length);a.setCards();a.setOrientationChange()},updateVisibility:function(){var c=this;var a=c.carouselItems;for(var b=0;b<a.length;b++){if(a[b].element.dom.style.transform=="translate3d(0px, 0px, 0px)"){a[b].element.dom.style.visibility="visible"}else{a[b].element.dom.style.visibility="hidden"}}},config:{indicator:false,data:false,pageNumber:0,skipActiveItemChange:true,pageTemplate:false,visiblePages:3,directionLock:true,landscapePageIncrement:1,mode:"double",zoomMode:"fit",cls:"pdfinfinitecarousel fit"},setPageTemplate:function(a){this.pageTemplate=a},setCards:function(){var f=this;if(f._mode=="single"){f._landscapePageIncrement=1}f._skipActiveItemChange=true;var d=f._landscapePageIncrement;var a=f.returnMappedPageNumber(f._pageNumber);if(f._pageNumber==0){for(var c=0;c<f._visiblePages;c++){var e=Math.min((c*d),(f.getData().length-1-pageOffset));f.add(f.createCard(f.getData()[e],e,f.getData()))}f.setActiveItem(0)}else{if(a==(f.getData().length-1-pageOffset)){if(f._mode=="single"){for(var c=0;c<3;c++){var h=f._pageNumber-2+c;f.add(f.createCard(f.getData()[h],h,f.getData()))}f.setActiveItem(2)}else{for(var c=0;c<3;c++){var h=f._pageNumber-4+(2*c);f.add(f.createCard(f.getData()[h],h,f.getData()))}f.setActiveItem(2)}}else{if(d==2){var b=0;for(var c=(f._pageNumber-(1*d));c<(f._pageNumber+(2*d));c+=d){var g=Math.max(c,0);g=Math.min(c,(f.getData().length-1));g=Math.max(0,g);f.add(f.createCard(f.getData()[g],g,f.getData(),b));b++}}else{for(var c=(f._pageNumber-(1*d));c<(f._pageNumber+(2*d));c+=d){f.add(f.createCard(f.getData()[c],c,f.getData()))}}f.setActiveItem(1)}}f._skipActiveItemChange=false},handleItemChange:function(j,h,c,f){var g=this;var k=g.getLandscapePageIncrement();if(!g._skipActiveItemChange){for(var e=0;e<j.carouselItems.length;e++){if(j.carouselItems[e].element.dom.style.transform=="translate3d(0px, 0px, 0px)"){j.carouselItems[e].element.dom.style.zIndex="10002"}else{j.carouselItems[e].element.dom.style.zIndex="10000"}}var b=h.getPageNo();var a=c.getPageNo();if(b>a){if(a==0||b==(g.getData().length-1-pageOffset)){}else{g.addCardToFront(j,j.getItems().items[0],k)}g._pageNumber+=k;g._pageNumber=Math.min(g._pageNumber,(g.getData().length-1-pageOffset))}else{if(b==0||a==(g.getData().length-1-pageOffset)){}else{g.addCardToBack(j,j.getItems().items[2],k)}g._pageNumber-=k;g._pageNumber=Math.max(g._pageNumber,0)}}if(g._mode=="double"){if(settings.reader.wrapAd!=null){if(settings.reader.wrapAd.hideLeftWrapperOnFirstPage!=null){if(settings.reader.wrapAd.hideLeftWrapperOnFirstPage=="true"){if(g.getActiveItem().getPageNo()==0){var d=document.getElementsByClassName("leftWrapper");if(d!=null){d[0].style.display="none"}}else{if($(window).width()/$(window).height()<=1.4){var d=document.getElementsByClassName("leftWrapper");if(d!=null){d[0].style.display="none"}}else{var d=document.getElementsByClassName("leftWrapper");if(d!=null){d[0].style.display="inline"}}}}else{var d=document.getElementsByClassName("leftWrapper");if(d!=null){d[0].style.display="inline"}}}}}if(c!=null){if(c.pauseVideos!=null){c.pauseVideos()}}g.fireEvent("pagechange",g)},returnMappedPageNumber:function(a){var b=this;if(b.returnOrientation()=="landscape"&&b._mode=="double"){return a}return(flatPlanData.pageMapper[a+1]-1)},returnReverseMappedPageNumber:function(a){var b=this;if(b.returnOrientation()=="landscape"&&b._mode=="double"){return(flatPlanData.pageMapper[parseInt(a)+1]-1)}return a},createCard:function(h,a,b,f){var j=this;var c=false;a=j.returnMappedPageNumber(a);try{var k=b[a].pages[0];a=k.pageIndex-1}catch(g){c=true}var d;if(!j.pageTemplate&&!c){d={pageNo:a,html:"Page: "+a}}else{d=j.pageTemplate(k,a,b)}return d},createAdvertCard:function(a){card=Ext.create("InfinityMobile.view.AdvertPageViewer",{pageNo:a.pageNum});return card},addCardToFront:function(f,c,b){var d=this;c._skipActiveItemChange=true;f.remove(c,true);var a=d.getLandscapePageIncrement();var e=Math.min((d._pageNumber+b+a),d.getData().length-1-pageOffset);e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createCard(d.getData()[e],e,d.getData()))},addCardToBack:function(f,a,c){var d=this;var b=d.getLandscapePageIncrement();a._skipActiveItemChange=true;f.remove(a,true);var e=(d._pageNumber-c-b);e=Math.max(e,0);f.insert(0,d.createCard(d.getData()[e],e,d.getData()))},jumpToFirst:function(){this.jumpToPage(0)},jumpToLast:function(){var a=(this.getData().length-1-pageOffset);a=flatPlanData.reversePageMapper[a+1]-1;this.jumpToPage(a)},jumpToPage:function(b){var c=this;b=c.returnReverseMappedPageNumber(b);if(!isNaN(b)){if((settings.reader.reverse!=null&&settings.reader.reverse=="true")||(settings.reader.startAtLastPage!=null&&settings.reader.startAtLastPage=="true")){}var a=b;var a=Math.max(a,(this.getData().length-1));a=Math.min(a,0);if(b!=c._pageNumber){if(c._mode=="single"){if(b==(c._pageNumber+1)){c.next()}else{if(b==(c._pageNumber-1)){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}else{if(b==(c._pageNumber+2)){c.next()}else{if(b==(c._pageNumber-2)){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}}}},setOrientationChange:function(){var a=this;var b=(function(){var c=0;return function(e,d){clearTimeout(c);c=setTimeout(e,d)}})();if(Ext.os.is.Desktop){$(window).on("resize",function(){b(function(){a.onResize()},250)})}else{if(Ext.os.is.Android){$(window).on("resize",function(){setTimeout(function(){a.onResize()},0)})}else{Ext.Viewport.on("orientationchange","onResize",a)}}},isDPS:function(){var a=this;return(a.returnOrientation()=="landscape"&&a._mode=="double")},onResize:function(){var b=this;b.onSizeChange();b.fireEvent("resizeDynamicArticles");if(b.element.dom.clientWidth!=0){var a=b.getActiveItem();a.pageResize(true);setTimeout(function(){var c=b.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo()!=a.getPageNo()){var e=c[d];e.pageResize(false)}}},1000)}},disableTiling:function(){var b=this;if(b.element.dom.clientWidth!=0){var a=b.getActiveItem();setTimeout(function(){var c=b.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo!=null){if(e.getPageNo()!=a.getPageNo()){var e=c[d]}}}},1000)}},enableTiling:function(){var b=this;if(b.element.dom.clientWidth!=0){var a=b.getActiveItem();setTimeout(function(){var c=b.getItems().items;for(var d=0;d<c.length;d++){var e=c[d];if(e.getPageNo!=null){if(e.getPageNo()!=a.getPageNo()){var e=c[d]}}}},1000)}},toggleDPS:function(){var f=this;if(f._mode=="single"){f._mode="double";f._pageNumber=flatPlanData.pageMapper[f._pageNumber+1]-1;f.setLandscapePageIncrement(2);if(f._zoomMode=="fit"){if(settings.reader.wrapAd!=null){if(settings.reader.wrapAd.hideLeftWrapperOnFirstPage!=null){if(settings.reader.wrapAd.hideLeftWrapperOnFirstPage=="true"){if(f.getActiveItem().getPageNo()==0){var g=document.getElementsByClassName("leftWrapper");if(g!=null){g[0].style.display="none"}}}else{var g=document.getElementsByClassName("leftWrapper");if(g!=null){g[0].style.display="inline"}}}else{var g=document.getElementsByClassName("leftWrapper");if(g!=null){g[0].style.display="inline"}}var c=document.getElementsByClassName("rightWrapper");if(c!=null){c[0].style.display="inline"}}}}else{f._mode="single";f._pageNumber=flatPlanData.reversePageMapper[f._pageNumber+1]-1;f.setLandscapePageIncrement(1);if(f._zoomMode=="fit"){var g=document.getElementsByClassName("leftWrapper");if(g[0]!=null){g[0].style.display="inline"}var c=document.getElementsByClassName("rightWrapper");if(c[0]!=null){c[0].style.display="inline"}}}var e=f.getActiveItem();e.toggleDPS(f._mode);var a=f.getItems().items;for(var b=0;b<a.length;b++){var d=a[b];if(d.getPageNo()!=e.getPageNo()){d.toggleDPSNonActive(f._mode,e)}}f.checkAdvertReplacement();f.fireEvent("updatePageNumber",f)},checkAdvertReplacement:function(){var b=this;if(typeof settings!="undefined"&&settings.reader!=null&&settings.reader.interstitialPageFlow!=null){var a=b.getItems().items;if(a[0]!=null&&a[0].id.indexOf("readeradvertpageviewer")>=0){b.replaceFirstCard(b,a[0],1)}else{if(a[2]!=null&&a[2].id.indexOf("readeradvertpageviewer")>=0){b.replaceLastCard(b,a[2],1)}}b.checkAdvertPlacement()}},checkAdvertPlacement:function(){var g=this;var d=g.getItems().items;console.log(g,d);var f=g.getLandscapePageIncrement();var e=1;var a=(g._pageNumber+e+f)-1;a=Math.min(parseInt(a),(g.getData().length-1));var b=g.getData()[a].pages[0];var h=(g._pageNumber-e-f)+1;h=Math.max(h,0);var c=g.getData()[h].pages[0];g.checkPageReplacement(c,d[0],function(){d[0]._skipActiveItemChange=true;g.remove(d[0],true);g.insert(0,g.createCard(g.getData()[h],h,g.getData()))});g.checkPageReplacement(b,d[2],function(){d[2]._skipActiveItemChange=true;g.remove(d[2],true);g.add(g.createCard(g.getData()[a],a,g.getData()))})},checkPageReplacement:function(b,a,c){console.log(b.type,a.type);if(b.type=="advert"&&a.xtype.indexOf("readeradvertpageviewer")==-1&&typeof c==="function"){c()}},replaceLastCard:function(f,a,c){var d=this;a._skipActiveItemChange=true;f.remove(a,true);var b=d.getLandscapePageIncrement();var e=(d._pageNumber+c+b)-1;e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createCard(d.getData()[e],e,d.getData()))},replaceFirstCard:function(f,c,b){var d=this;var a=d.getLandscapePageIncrement();c._skipActiveItemChange=true;f.remove(c,true);var e=(d._pageNumber-b-a)+1;e=Math.max(e,0);f.insert(0,d.createCard(d.getData()[e],e,d.getData()))},toggleZoomMode:function(){var e=this;if(e._zoomMode=="fit"){e._zoomMode="fill";e.setCls("pdfinfinitecarousel fill")}else{e._zoomMode="fit";e.setCls("pdfinfinitecarousel fit")}e.onSizeChange();var d=e.getActiveItem();d.toggleZoomMode(e._zoomMode);var a=e.getItems().items;for(var b=0;b<a.length;b++){var c=a[b];if(c.getPageNo()!=d.getPageNo()){var c=a[b];c.toggleZoomMode(e._zoomMode)}}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){a="landscape"}}return a},onDragStart:function(){var a=this},onDrag:function(a){},onDragEnd:function(){var a=this},next:function(){var a=this;a.setActiveItem(a.activeIndex+1)},previous:function(){var a=this;a.setActiveItem(a.activeIndex-1)}},0,["infinitecarousel2d"],["component","container","carousel","infinitecarousel2d"],{component:true,container:true,carousel:true,infinitecarousel2d:true},["widget.infinitecarousel2d"],0,[InfinityMobile.view,"PDFInfiniteCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.2DInfiniteCarousel",InfinityMobile.view.InfiniteCarousel,{config:{direction:"horizontal",pageXPath:""},initialize:function(){var a=this;InfinityMobile.view.InfiniteCarousel.prototype.initialize.call(this);if(a.config.backgroundColor!=null){a.element.dom.style.background="#"+a.config.backgroundColor}a._zoomMode=a.config.zoomMode},createCard:function(h,c,e,d){var f=this;var b=f.getPageXPath();var a=h[b];if(a.length>1){var g=Ext.create("InfinityMobile.view.InfiniteCarousel",{direction:"vertical",data:a,pageTemplate:f.pageTemplate,pageNo:c});return g}else{return InfinityMobile.view.InfiniteCarousel.prototype.createCard.call(this,a[0],c,e,d)}},handleItemChange:function(e,c,d,a){var b=this;InfinityMobile.view.InfiniteCarousel.prototype.handleItemChange.apply(this,arguments);b.fireEvent("pagechange",b)}},0,["infinitecarousel2d"],["component","container","carousel","infinitecarousel","infinitecarousel2d"],{component:true,container:true,carousel:true,infinitecarousel:true,infinitecarousel2d:true},["widget.infinitecarousel2d"],0,[InfinityMobile.view,"2DInfiniteCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPageViewer",Ext.Container,{config:{pageNo:"",page:false,previousPage:"",nextPage:"",style:"overflow:hidden",html:'<figure><div class="scrollerDiv"><div class="zoomDiv"><img style="visibility:hidden;vertical-align:middle" /><img style="visibility:hidden;vertical-align:middle" /><div class="mediaDiv"><div class="portrait"></div><div class="landscape"></div></div><div class="tileDiv" ><div class="portrait"><canvas /></div><div class="landscape"><canvas /></div></div></div></div></figure>',maxScale:3,scrollable:"both",editionGuid:"",cls:"readerpage animate",mode:"double"},beforeInitialize:function(){var a=this;a.isinitialized=false;a.mediaLoaded=false;a.thumbnailLoaded=false;a.usesCanvas=true;if(settings.page.maxZoomLevel!=null){a.setMaxScale(parseInt(settings.page.maxZoomLevel))}a.zoomMode=settings.reader.zoomMode},initialize:function(){var a=this;a.zoomLevel="none";a.on("painted",a.initializePage,a,{delay:10,single:true});a.mp4Objects=[];a.scroller=a.getScrollable().getScroller();a.scroller.setDisabled(true);a.figure=a.element.down("figure");a.scrollerDiv=a.figure.down("div");a.zoomDiv=a.scrollerDiv.down("div");a.image=a.zoomDiv.down("img").dom;a.landscapeimage=a.zoomDiv.down("img").next("img").dom;a.mediaDiv=a.zoomDiv.down("div");a.portraitMediaDiv=a.mediaDiv.down("div").dom;a.landscapeMediaDiv=a.mediaDiv.down("div").next("div").dom;a.portraitMediaDiv.style.zIndex=10;a.landscapeMediaDiv.style.zIndex=8;a.tileDiv=a.element.down(".tileDiv");a.tileCanvas=a.tileDiv.down("canvas").dom;a.element.addListener({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragFinished",scope:a});a.scrollerDiv.addListener({scope:a,doubletap:a.onDoubleTap,pinchstart:a.onPinchStart,pinch:a.onPinch,pinchend:a.onPinchEnd});a.scroller.on({scope:a,scrollend:a.onScrollEnd})},initializePage:function(){var b=this;b.canvasInitialized=false;b.canTile=false;b.hasLoaded=false;b.orientation=b.returnOrientation();var a=b.getPageNo();if(b.returnOrientation=="landscape"){a=a-pageOffset}if(a%2==0){b.imagetoload=b.landscapeimage;b.landscapeimage.onload=function(){b.imageLoaded(this,"landscape")}}else{b.imagetoload=b.image;b.image.onload=function(){b.imageLoaded(this,"portrait")}}b.setUpImages();b.isinitialized=true},setUpImagesCSS:function(){var a=this;a.image.className="";a.landscapeimage.className="";a.portraitMediaDiv.className="";a.landscapeMediaDiv.className="";if((a.getPageNo()%2)==0){a.landscapeimage.portraitshow=true;a.image.portraitshow=false;a.image.className=a.returnLandscapeImageType();a.portraitMediaDiv.className=a.returnLandscapeImageType();if(a.getPreviousPage()==""){a.image.stayHidden=true}}else{a.image.portraitshow=true;a.landscapeimage.portraitshow=false;a.landscapeimage.className=a.returnLandscapeImageType();a.landscapeMediaDiv.className=a.returnLandscapeImageType();if(a.getNextPage()==""){a.landscapeimage.stayHidden=true}}},setUpImagesURL:function(){var a=this;if(((a.getPageNo())%2)==0){a.landscapeimage.pageNumber=a.getPage().pageIndex;a.getThumbnail(a.landscapeimage,a.getPage());if(a.getPreviousPage()!=""&&a.getPreviousPage().pageIndex!=-1){a.image.pageNumber=a.getPage().pageIndex-1;a.getThumbnail(a.image,a.getPreviousPage())}else{if(a.getPreviousPage()==""){a.image.pageNumber=0;a.getThumbnail(a.image,a.getPage())}else{a.image.pageNumber=-1;a.getThumbnail(a.image,a.getPreviousPage())}}}else{a.image.pageNumber=a.getPage().pageIndex;a.getThumbnail(a.image,a.getPage());if(a.getNextPage()!=""&&a.getNextPage().pageIndex!=-1){a.landscapeimage.pageNumber=a.getPage().pageIndex+1;a.getThumbnail(a.landscapeimage,a.getNextPage())}else{if(a.getNextPage()==""){a.landscapeimage.pageNumber=0;a.getThumbnail(a.landscapeimage,a.getPage())}else{a.landscapeimage.pageNumber=-1;a.getThumbnail(a.landscapeimage,a.getNextPage())}}}},setUpImages:function(){var a=this;a.setUpImagesCSS();a.setUpImagesURL()},returnLandscapeImageType:function(){var a=this;if(a._mode=="single"){return"singlepagelandscapeimage"}return"landscapeimage"},getThumbnail:function(c,b){var a=this;var d="";if(b.image!=null){d=b.image}c.src=d;c.type=b.type},imageLoaded:function(d){var b=this;var a=b.image;var c=b.landscapeimage;if(b.element!=null){b.layoutImages(d,a,c);b.resetPage();b.resetZoom();b.loadMediaImage("portrait",a);b.loadMediaImage("landscape",c);b.thumbnailLoaded=true;b.fireEvent("thumbnailLoaded")}},layoutImages:function(h,c,e){var d=this;var b=d.returnOrientation();if(h.clientWidth==0){if(c.clientWidth!=0){h=c}else{h=e}}d.pageWidth=d.element.dom.clientWidth;d.pageHeight=d.element.dom.clientHeight;d.imageWidth=h.naturalWidth;d.imageHeight=h.naturalHeight;d.imagePageWidth=d.pageWidth;d.imagePageHeight=d.pageHeight;d.initialTranslateX=0;d.initialTranslateY=0;if(b=="landscape"&&d._mode=="double"){d.layoutImagesDoublePageMode(c,e)}else{d.layoutImagesSinglePageMode(c,e)}if(h.clientWidth!=0&&h.pageNumber!=-1){d.initialImageWidth=h.clientWidth;d.initialImageHeight=h.clientHeight}else{if(c.clientWidth!=0&&c.pageNumber!=-1){if(c.clientWidth%2==1){d.initialImageWidth=c.clientWidth-0.5}else{d.initialImageWidth=c.clientWidth}if(c.clientHeight%2==1){d.initialImageWidth=c.clientHeight-0.5}else{d.initialImageWidth=c.clientHeight}}else{if(e.clientWidth!=0&&e.pageNumber!=-1){if(e.clientWidth%2==1){d.initialImageWidth=e.clientWidth-0.5}else{d.initialImageWidth=e.clientWidth}if(e.clientHeight%2==1){d.initialImageWidth=e.clientHeight-0.5}else{d.initialImageWidth=e.clientHeight}}}}if(d.initialImageHeight<d.imagePageHeight){var g=(d.imagePageHeight-d.initialImageHeight)/2;d.initialTranslateY=g}d.offsetX=0;d.offsetY=0;if(c.stayHidden==null){c.style.visibility="inherit"}else{c.style.visibility="hidden"}if(e.stayHidden==null){e.style.visibility="inherit"}else{e.style.visibility="hidden"}var f=d.portraitMediaDiv;var a=d.landscapeMediaDiv;f.style.height=a.style.height=parseInt(d.initialImageHeight)+"px";f.style.width=a.style.width=parseInt(d.initialImageWidth)+"px"},layoutImagesDoublePageMode:function(c,e){var d=this;d.imagePageWidth=(d.pageWidth/2);d.widthRatio=d.imagePageWidth/d.imageWidth;d.heightRatio=d.imagePageHeight/d.imageHeight;d.scale=1;if(d.zoomMode=="fit"&&d.widthRatio>d.heightRatio){c.style.height=d.imagePageHeight+"px";c.style.width="auto";e.style.height=c.style.height;e.style.width=c.style.width;var b=Math.max(c.clientWidth,e.clientWidth);if(c.type=="leftHandAd"){c.style.height="";c.style.width="";e.style.height="";e.style.width="";e.style.height=d.imagePageHeight+"px";e.style.width="auto";c.style.height="auto";c.style.width=$(e).width()+"px";var a=((e.clientWidth-c.clientWidth)/2);if(a>0||a<0){c.style.marginLeft=a+"px";c.style.marginRight=(a-1)+"px"}d.initialTranslateX=($(document).width()-($(e).width()*2))/2}else{d.initialTranslateX=((d.pageWidth-((b*2)*d.scale))/2)}}else{c.style.width=d.imagePageWidth+"px";c.style.height="auto";e.style.width=c.style.width;e.style.height=c.style.height;if(c.type=="leftHandAd"){if(c.clientHeight>e.clientHeight){c.style.width="auto";c.style.height=e.clientHeight+"px";var a=((e.clientWidth-c.clientWidth)/2);if(a>0){c.style.marginLeft=a+"px";c.style.marginRight=(a-1)+"px"}}}}},layoutImagesSinglePageMode:function(a,c){var b=this;b.widthRatio=b.imagePageWidth/b.imageWidth;b.heightRatio=b.imagePageHeight/b.imageHeight;b.scale=1;if(b.zoomMode=="fit"&&b.widthRatio>b.heightRatio){a.style.height=b.imagePageHeight+"px";a.style.width="auto";c.style.height=a.style.height;c.style.width=a.style.width;b.initialTranslateX=((b.pageWidth-(b.zoomDiv.dom.clientWidth*b.scale))/2)}else{a.style.width=b.imagePageWidth+"px";a.style.height="auto";c.style.width=a.style.width;c.style.height=a.style.height}},completeImageLoaded:function(c){var a=this;mainPanel.fireEvent("removeSplash");if(a.isinitialized){var b=a.imagetoload;if(a.thumbnailLoaded){a.loadTileImages(c)}else{a.on("thumbnailLoaded",function(){a.loadTileImages(c)})}}else{a.on("thumbnailLoaded",function(){a.loadTileImages(function(){})});c()}},loadTileImages:function(e){var b=this;if(!b.hasLoaded){var d=b.imagetoload;var a=b.image;var c=b.landscapeimage;if(d.pageNumber==a.pageNumber){b.loadTileImage(a,function(){b.loadTileImage(c,function(){b.hasLoaded=true;b.canTile=true;e()})})}else{b.loadTileImage(c,function(){b.loadTileImage(a,function(){b.hasLoaded=true;b.canTile=true;e()})})}}else{e()}},loadTileImage:function(b,j){var f=this;if(f.isinitialized){if(b.pageNumber>0){if(b.src.indexOf("pages.mobile.cdn.pagesuite.com")!=-1||b.src.indexOf("pages.cdn.pagesuite.com")!=-1){if(b.tiled==null){b.largecached=false;var c={tiled:false,pageNumber:b.pageNumber,portraitshow:b.portraitshow,imageparts:[]};if(b.portraitshow){f.portraitTileImage=c}else{f.landscapeTileImage=c}if(c.pageNumber>=1){var h=f.checkDataForTileImage(b);if(h){if(h.largecached){b.largecached=true}f.setUpTiledImage(c,h.tileImage);j()}else{var d=f.retrievePageGuidImage(b);var g=settings.page;var a=g.lowres;var e=function(){j()};f.requestPage(a,b,c,f.loadedTileImage,false,e)}}}else{j()}}else{j()}}else{j()}}},loadLargeTileImage:function(e){var d=this;if(e.pageNumber>=1){if(e.src.indexOf("pages.mobile.cdn.pagesuite.com")!=-1||e.src.indexOf("pages.cdn.pagesuite.com")!=-1){if(!e.largecached){var c={tiled:false,pageNumber:e.pageNumber,portraitshow:e.portraitshow,imageparts:[]};var a=settings.page;var b=a.highres;d.requestPage(b,e,c,d.loadedTileImage,true,function(){})}}}},requestPage:function(b,c,d,k,l,j){var g=this;var e=g.retrievePageGuidImage(c);var f="http://pages.cdn.pagesuite.com/";if(window.location.protocol=="https:"){f="https://s3-eu-west-1.amazonaws.com/origin.pages.cdn.pagesuite.com/"}var a=f+e[0]+"/"+e[1]+"/"+e+"/tile/page_90_"+b+".json";var h=g.returnEditionPage(c);if(h.request==null||l){h.request=$.ajax({crossDomain:true,type:"GET",contentType:"application/json",async:true,cache:true,url:a,success:function(m){k(g,c,d,m,l,j);$(h.request).trigger("loaded")},error:function(m){if(m.statusText!="abort"){var n="https://tile.html5.pagesuite-professional.co.uk/get_image_jpg_tile.aspx?pguid="+e+"&dpi="+b;$.ajax({crossDomain:true,type:"GET",contentType:"application/json",async:true,cache:true,url:n,success:function(o){k(g,c,d,o,l,j);$(h.request).trigger("loaded")}})}}});activerequest={page:h}}else{$(h.request).on("loaded",function(){g.setUpTiledImage(d,h.tileImage);j()})}},loadedTileImage:function(g,h,b,f,a,e){var d=g;var c=d.createImagesArray(f);d.setCache(h,c,a);d.setUpTiledImage(b,c);if(h.portraitshow){d.portraitTileImage=b}else{d.landscapeTileImage=b}e()},createImagesArray:function(e){var c=this;var d=[];for(var b=0;b<e.images.length;b++){var f=document.createElement("img");var a=e.images[b];f.src=a.url;f.startX=a.startX;f.startY=a.startY;f.width=a.width;f.height=a.height;d.push(f)}return d},setCache:function(e,d,a){var c=this;var b=editionFlatplanData.pageGroups;if(e.pageNumber>=1){editionFlatplanData.pageGroups[(e.pageNumber-1)].pages[0].tileImage=d;editionFlatplanData.pageGroups[(e.pageNumber-1)].pages[0].cached=true;if(a){e.largecached=true;editionFlatplanData.pageGroups[(e.pageNumber-1)].pages[0].largecached=true}}},retrievePageGuid:function(c){var b=c.image.split("/");var a=b[b.length-2];return a},retrievePageGuidImage:function(f){var e=this;var c=editionFlatplanData.pageGroups;if(f.pageNumber>=1){var a=c[(f.pageNumber-1)].pages[0];var d=a.image.split("/");var b=d[d.length-2];return b}return""},returnEditionPage:function(d){var c=this;var b=editionFlatplanData.pageGroups;if(d.pageNumber>=1){var a=b[(d.pageNumber-1)].pages[0];return a}return null},checkDataForTileImage:function(d){var c=this;var b=editionFlatplanData.pageGroups;if(d.pageNumber>=1){var a=b[(d.pageNumber-1)].pages[0];if(a.tileImage!=null){return a}}return false},setUpTiledImage:function(b,e){var d=this;var c=e;if(!d.canvasInitialized){d.setUpCanvas()}for(var a=0;a<c.length;a++){var g=c[a];if(g.naturalWidth!=0){if(!(d.returnOrientation()=="portrait"&&!b.portraitshow)){var f=function(h){setTimeout(function(){d.tilePageImage(h,b)},100)};f(g)}}else{$(g).load(function(){if(!(d.returnOrientation()=="portrait"&&!b.portraitshow)){d.tilePageImage(this,b)}})}}b.imageparts=c;b.tiled=true},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},toggleDPS:function(){var a=this;a.disableTiling();if(a._mode=="double"){a._mode="single"}else{a._mode="double"}a.adjustPageOnToggleDPS();a.resetPage();a.resetZoom();if(Ext.os.is.Phone){a.fireEvent("checkPagesBrowser")}},adjustPageOnToggleDPS:function(){var d=this;var b=d.image;var e=d.landscapeimage;var h=d.parent.getActiveItem();var g=d.getPageNo();var a=g-h.getPageNo();if(d.image.pageNumber==-1||d.landscapeimage.pageNumber==-1&&(a==1||a==-1)){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}if(a==0){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}else{if(a>0){if(d._mode=="single"){if(a%2==1){if(a==1){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}else{var f=a-2;var c=g-f;d.setPageNo(c)}}else{var f=a/2;var c=g-f;d.setPageNo(c)}}else{var c=g+a;d.setPageNo(c)}}else{if(d._mode=="single"){if(a%2==-1){if(a==-1){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}else{var f=a+1;var c=g-f;d.setPageNo(c)}}else{var f=a/2;var c=g-f;d.setPageNo(c)}}else{var c=Math.max(0,(g+a));d.setPageNo(c)}}}d.parent.returnPage=d.parent.config.returnPage;d.setPage(d.parent.returnPage(d.getPageNo(),false));d.setPreviousPage(d.parent.returnPage(d.getPageNo()-1,true));d.setNextPage(d.parent.returnPage(d.getPageNo()+1,true));d.resetImages()},resetImages:function(){var a=this;a.image.src="";a.landscapeimage.src="";if(a.portraitTileImage!=null){a.portraitTileImage.src="";a.portraitTileImage.tiled=false}if(a.landscapeTileImage!=null){a.landscapeTileImage.src="";a.landscapeTileImage.tiled=false}if(a.isinitialized){a.setUpImages()}a.mediaLoaded=false;a.thumbnailLoaded=false;a.hasLoaded=false;a.completeImageLoaded(function(){})},onResize:function(b){var a=this;var c=0;if(a.returnOrientation()!=a.orientation){a.orientation=a.returnOrientation();a.disableTiling();a.adjustPageOnResize();a.resetPage();a.resetZoom();a.fireEvent("resizeClipping");if(Ext.os.is.Phone){a.fireEvent("checkPagesBrowser")}}},adjustPageOnResize:function(){var d=this;var b=d.image;var e=d.landscapeimage;if(d._mode=="single"){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}if(d.image.pageNumber==-1||d.landscapeimage.pageNumber==-1&&(a==1||a==-1)){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}var h=d.parent.getActiveItem();var g=d.getPageNo();var a=g-h.getPageNo();if(a==0){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}else{if(a>0){if(d.returnOrientation()=="portrait"){if(a%2==1){if(a==1){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}else{var f=a-2;var c=g-f;d.setPageNo(c)}}else{var f=a/2;var c=g-f;d.setPageNo(c)}}else{var c=g+a;d.setPageNo(c)}}else{if(d.returnOrientation()=="portrait"){if(a%2==-1){if(a==-1){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return}else{var f=a+1;var c=g-f;d.setPageNo(c)}}else{var f=a/2;var c=g-f;d.setPageNo(c)}}else{var c=g+a;d.setPageNo(c)}}}d.parent.returnPage=d.parent.config.returnPage;d.setPage(d.parent.returnPage(d.getPageNo()));d.setPreviousPage(d.parent.returnPage(d.getPageNo()-1));d.setNextPage(d.parent.returnPage(d.getPageNo()+1));d.resetImages()},onDragStart:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDrag:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDragFinished:function(c){var b=this;var a=b.scroller.position;b.zoomPosition=b.scroller.position;if(b.scale>1){c.stopPropagation()}},onDoubleTap:function(c){var b=this;var a=b.scroller.position;b.zoomPosition=b.scroller.position;b.zoomPointX=c.pageX;b.zoomPointY=c.pageY-40+b.scroller.position.y;if(settings.reader.doubleTapFullZoom!=null){if(settings.reader.doubleTapFullZoom=="true"){if(b.scale==1){b.initializeTouch(b.zoomPointX,b.zoomPointY);b.scale=b.getMaxScale();if(document.getElementById("slider")!=null){document.getElementById("slider").value=b.getMaxScale();b.hideNavButtons();b.fireEvent("hideWrapAds")}}else{b.resetPage();b.fireEvent("showWrapAds");if(b.zoomMode=="fit"&&b.mode=="double"){b.showNavButtons()}else{b.hideNavButtons()}}}else{if(b.scale<b.getMaxScale()/2){b.initializeTouch(b.zoomPointX,b.zoomPointY);b.scale=b.getMaxScale()/2;b.zoomLevel="mid";if(document.getElementById("slider")!=null){document.getElementById("slider").value=b.getMaxScale()/2;b.hideNavButtons();b.fireEvent("hideWrapAds")}}else{if(b.scale<b.getMaxScale()){b.zoomPointX=(b.scroller.position.x+c.pageX)/b.scale;b.zoomPointY=(b.scroller.position.y+c.pageY)/b.scale;b.initializeTouch(b.zoomPointX,b.zoomPointY);b.scale=b.getMaxScale();b.zoomLevel="full";if(document.getElementById("slider")!=null){document.getElementById("slider").value=b.getMaxScale();b.hideNavButtons();b.fireEvent("hideWrapAds")}}else{b.zoomLevel="none";b.resetPage();b.fireEvent("showWrapAds");if(b.zoomMode=="fit"&&b.mode=="double"){b.showNavButtons()}else{b.hideNavButtons()}}}}}else{if(b.scale==1){b.initializeTouch(b.zoomPointX,b.zoomPointY);b.scale=b.getMaxScale();if(document.getElementById("slider")!=null){document.getElementById("slider").value=b.getMaxScale();b.hideNavButtons();b.fireEvent("hideWrapAds")}}else{b.resetPage();b.fireEvent("showWrapAds");if(b.zoomMode=="fit"&&b.mode=="double"){b.showNavButtons()}else{b.hideNavButtons()}}}b.finishZoom()},onPinchStart:function(d){var c=this;c.disableTiling();c.startDistance=d.distance;var f=((d.touches[0].pageX+d.touches[1].pageX)/2);var e=((d.touches[0].pageY+d.touches[1].pageY)/2);var b=f+c.scroller.position.x;var a=e+c.scroller.position.y;c.zoomPointX=((b)/(c.scale));c.zoomPointY=((a)/(c.scale));c.offsetX=(f-c.zoomPointX);c.offsetY=(e-c.zoomPointY);c.offsetScrollerX=c.offsetX+c.scroller.position.x;c.offsetScrollerY=c.offsetY+c.scroller.position.y;c.initializeTouch(c.zoomPointX,c.zoomPointY);c.translateX+=c.offsetScrollerX;c.translateY+=c.offsetScrollerY;c.applyTransform(c.scale)},onPinch:function(b){var a=this;if(a.dontPinch==true){return}a.currentScale=Math.min(((b.distance/a.startDistance)*a.scale),a.getMaxScale());a.applyTransform(a.currentScale)},onPinchEnd:function(b){var a=this;if(a.currentScale<=1){a.resetPage();a.finishZoom()}else{a.scale=a.currentScale;a.finishZoom()}},onZoomStart:function(g,d){var c=this;console.log(c);console.log(c.zoomDiv);c.scale=d;var f=(c.pageWidth/2);var e=(c.pageHeight/2);var b=f+c.scroller.position.x;var a=e+c.scroller.position.y;c.zoomPointX=((b)/(c.scale));c.zoomPointY=((a)/(c.scale));c.offsetX=0;c.offsetY=0;c.offsetScrollerX=c.offsetX+c.scroller.position.x;c.offsetScrollerY=c.offsetY+c.scroller.position.y;c.initializeTouch(c.zoomPointX,c.zoomPointY);c.translateX+=c.offsetScrollerX;c.translateY+=c.offsetScrollerY;c.applyTransform(c.scale)},onZoom:function(c,b){var a=this;a.currentScale=b.dom.valueAsNumber;a.applyTransform(a.currentScale)},onZoomEnd:function(c,b){var a=this;if(a.currentScale<=1){a.resetPage();a.finishZoom()}else{a.scale=a.currentScale;a.finishZoom()}},onChange:function(e,c,b){var d=this;d.currentScale=e;if(d.currentScale<=1){d.resetPage();d.finishZoom()}else{d.scale=d.currentScale;d.sliderZoom();var a=d.scroller.position;d.zoomPosition=d.scroller.position}},resetPage:function(){var a=this;a.translateX=a.initialTranslateX;a.translateY=a.initialTranslateY;a.scale=1;a.applyTransform(a.scale);if(document.getElementById("slider")!=null){document.getElementById("slider").value=1}},initializeTouch:function(b,a){var c=this;c.elementTouchX=b-c.translateX;c.elementTouchY=a-c.translateY;c.setOrigin(c.elementTouchX,c.elementTouchY)},setOrigin:function(a,c){var b=this;b.zoomDiv.dom.style.webkitTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.MozTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.msTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.transformOrigin=a+"px "+c+"px"},applyTranslate:function(b){var a=this;a.zoomDiv.dom.style.webkitTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)";a.zoomDiv.dom.style.MozTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)";a.zoomDiv.dom.style.msTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)"},applyTransform:function(b){var a=this;a.zoomDiv.dom.style.webkitTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.MozTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.msTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)"},finishZoom:function(){var a=this;if(a.scale==1){a.resetZoom()}else{a.setZoom()}},sliderZoom:function(){var d=this;console.log(d);if(d.mediaDiv.dom.children[0].children.length>0){for(var c=0;c<d.mediaDiv.dom.children[0].children.length;c++){try{var f=d.mediaDiv.dom.children[0].children[c].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/d.scale)+"px";f.style.padding=(5/d.scale)+"px"}}catch(g){}}}if(d.mediaDiv.dom.children[1].children.length>0){for(var c=0;c<d.mediaDiv.dom.children[1].children.length;c++){try{var f=d.mediaDiv.dom.children[1].children[c].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/d.scale)+"px";f.style.padding=(5/d.scale)+"px"}}catch(g){}}}d.scrollerDiv.dom.style.width=((d.initialImageWidth+(d.initialTranslateX/2))*d.scale)+"px";if(d.returnOrientation()=="landscape"&&d._mode=="double"){d.scrollerDiv.dom.style.width=((d.initialImageWidth+d.initialTranslateX)*d.scale*2)+"px"}d.scrollerDiv.dom.style.height=((d.initialImageHeight+d.initialTranslateY)*d.scale)+"px";console.log(d.scrollerDiv);d.setOrigin(0,0);d.translateX=d.initialTranslateX;d.translateY=d.initialTranslateY;d.applyTransform(d.scale);d.scroller.setDisabled(false);d.scroller.setDirection("both");var b=d.elementTouchX*d.scale;var j=b-d.zoomPointX-d.offsetX;var a=d.elementTouchY*d.scale;var h=a-d.zoomPointY-d.offsetY;d.scroller.scrollTo(j,h);if(d.canTile){d.startTiling()}d.loadLargeTileImage(d.image);d.loadLargeTileImage(d.landscapeimage)},setZoom:function(){var d=this;if(d.mediaDiv.dom.children[0].children.length>0){for(var c=0;c<d.mediaDiv.dom.children[0].children.length;c++){try{var f=d.mediaDiv.dom.children[0].children[c].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/d.scale)+"px";f.style.padding=(5/d.scale)+"px"}}catch(g){}}}if(d.mediaDiv.dom.children[1].children.length>0){for(var c=0;c<d.mediaDiv.dom.children[1].children.length;c++){try{var f=d.mediaDiv.dom.children[1].children[c].children[0].children[0].children[0].children[0].children[0];if(f.className=="tool-tip"){f.style.fontSize=(12/d.scale)+"px";f.style.padding=(5/d.scale)+"px"}}catch(g){}}}d.scrollerDiv.dom.style.width=((d.initialImageWidth)*d.scale)+"px";if(d.returnOrientation()=="landscape"&&d._mode=="double"){d.scrollerDiv.dom.style.width=((d.initialImageWidth)*d.scale*2)+"px"}d.scrollerDiv.dom.style.height=(d.initialImageHeight*d.scale)+"px";d.setOrigin(0,0);d.translateX=0;d.translateY=0;d.applyTransform(d.scale);d.scroller.setDisabled(false);d.scroller.setDirection("both");var b=d.elementTouchX*d.scale;var a=d.elementTouchY*d.scale;var j=b-d.zoomPointX-d.offsetX;var h=a-d.zoomPointY-d.offsetY;d.scroller.scrollTo(j,h);if(d.canTile){d.startTiling()}d.loadLargeTileImage(d.image);d.loadLargeTileImage(d.landscapeimage)},resetZoom:function(){var b=this;if(b.mediaDiv.dom.children[0].children.length>0){for(var a=0;a<b.mediaDiv.dom.children[0].children.length;a++){try{var c=b.mediaDiv.dom.children[0].children[a].children[0].children[0].children[0].children[0].children[0];if(c.className=="tool-tip"){c.style.fontSize="12px";c.style.padding="5px"}}catch(d){}}}if(b.mediaDiv.dom.children[1].children.length>0){for(var a=0;a<b.mediaDiv.dom.children[1].children.length;a++){try{var c=b.mediaDiv.dom.children[1].children[a].children[0].children[0].children[0].children[0].children[0];if(c.className=="tool-tip"){c.style.fontSize="12px";c.style.padding="5px"}}catch(d){}}}b.scrollerDiv.dom.style.width="";b.scrollerDiv.dom.style.height="";b.scrollTo(0,0);if(b.zoomMode=="fill"){b.scroller.setDisabled(false);b.scroller.setDirection("vertical");b.scroller.setDirectionLock(true)}else{b.scroller.setDisabled(true)}b.scroller.position.x=0;if(b.canTile){b.startTiling()}},stopTiling:function(){var a=this;a.disableTiling();a.canTile=false},setTiling:function(){var a=this;a.canTile=true;a.resetZoom()},enableScroller:function(){var a=this;if(a.scroller.getDisabled()&&a.scroller.manuallyDisabled!=null&&a.scroller.manuallyDisabled==true){a.scroller.setDisabled(false);a.scroller.manuallyDisabled=false}},scrollTo:function(a,c){var b=this;b.scroller.scrollTo(a,c)},onScrollEnd:function(){var a=this;a.startTiling()},startTiling:function(){var a=this;if(a.canTile){a.setUpCanvas(a.portraitTileImage);a.tryTilePageImage(a.portraitTileImage);if(a.returnOrientation()=="landscape"){a.tryTilePageImage(a.landscapeTileImage)}}},setUpCanvas:function(){var e=this;e.canvasInitialized=true;if(e.element!=null){var d=Math.min(e.pageWidth,e.scrollerDiv.dom.clientWidth);var a=Math.min(e.pageHeight,e.scrollerDiv.dom.clientHeight);e.tileDiv.dom.style.width=d+"px";e.tileDiv.dom.style.height=a+"px";e.tileDiv.dom.style.top=(e.scroller.position.y/e.scale)+"px";e.tileDiv.dom.style.left=(e.scroller.position.x/e.scale)+"px";e.tileDiv.dom.style.webkitTransform="scale3d("+(1/e.scale)+","+(1/e.scale)+",1)";e.tileDiv.dom.style.MozTransform="scale("+(1/e.scale)+","+(1/e.scale)+")";e.tileDiv.dom.style.msTransform="scale3d("+(1/e.scale)+","+(1/e.scale)+",1)";var c=e.tileCanvas.getContext("2d");devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1,ratio=devicePixelRatio/backingStoreRatio;if(typeof auto==="undefined"){auto=true}if(auto&&devicePixelRatio!==backingStoreRatio){var b=d;var f=a;e.tileCanvas.width=b*ratio;e.tileCanvas.height=f*ratio;e.tileCanvas.style.width=b+"px";e.tileCanvas.style.height=f+"px";c.scale(ratio,ratio)}else{e.tileCanvas.width=d;e.tileCanvas.height=a;e.tileCanvas.style.width=d+"px";e.tileCanvas.style.height=a+"px"}e.tileCanvas.desx=(e.scroller.position.x*-1);e.tileCanvas.desxland=e.tileCanvas.desx+(e.initialImageWidth*e.scale);e.tileCanvas.desy=(e.scroller.position.y*-1);e.tileCanvas.desw=parseInt(e.initialImageWidth*e.scale);e.tileCanvas.desh=parseInt(e.initialImageHeight*e.scale)}},tryTilePageImage:function(d){var c=this;if(d!=null){for(var b=0;b<d.imageparts.length;b++){var a=d.imageparts[b];a.pageNumber=d.pageNumber;if(d.tiled){c.tilePageImage(a,d)}else{a.onload=function(){d.tiled=true;c.tilePageImage(this)}}}}},tilePageImage:function(c,a){var b=this;if(b.usesCanvas){b.tilePageImageCanvas(c,a)}else{(b.tilePageImageNonCanvas(c,a))}},tilePageImageCanvas:function(d,n){var k=this;if(k.tileCanvas!=null){var a=k.tileCanvas.getContext("2d");var o=d.naturalWidth*2;var h=d.naturalHeight*2;var c=d.startX/o;var m=d.startY/h;var b=d.naturalWidth;var l=d.naturalHeight;var g=k.tileCanvas.desx;g=g+(k.tileCanvas.desw*c);var f=k.tileCanvas.desy;f=f+(k.tileCanvas.desh*m);if(k.returnOrientation()=="landscape"){if(k._mode=="double"){if((n.pageNumber-pageOffset)%2==1){g=k.tileCanvas.desxland+(k.tileCanvas.desw*c)}}}var j=k.tileCanvas.desw/2;var e=k.tileCanvas.desh/2;if(k.returnOrientation()=="landscape"&&k._mode=="single"&&n.pageNumber!=(k.getPageNo()+1)){}else{a.drawImage(d,0,0,b,l,g,f,j,e)}}},tilePageImageNonCanvas:function(d,b){var c=this;if(c.returnOrientation()=="landscape"&&c._mode=="single"&&b.pageNumber!=(c.getPageNo()+1)){return}else{var a=0;if(d.startX==0){if(d.startY==0){a=0}else{a=2}}else{if(d.startY==0){a=1}else{a=3}}var e=c.tileDivImage.children[a];e.appendChild(d);console.log(c.tileDivImage.children[a]);console.log(d.startX,d.startY)}},disableTiling:function(){var a=this;a.tileCanvas.width=0;a.tileCanvas.height=0},destroy:function(){var a=this;a.isinitialized=false;a.element.dom.innerHTML="";delete a.figure;delete a.scrollerDiv;delete a.zoomDiv;delete a.image;delete a.landscapeimage;delete a.tileDiv;a.tileCanvas.width=0;a.tileCanvas.height=0;delete a.tileCanvas;delete a.portraitTileImage;delete a.landscapeTileImage;Ext.Container.prototype.destroy.apply(this,arguments);delete a},loadMediaImage:function(b,e){var c=this;var a=c.image.pageNumber;var d=c.portraitMediaDiv;if(b=="landscape"){a=c.landscapeimage.pageNumber;d=c.landscapeMediaDiv}c.fireEvent("loadMedia",c,a-pageOffset,d);c.mediaLoaded=true},returnMediaContainer:function(a){var b=this;if(a==b.image.pageNumber){return b.portraitMediaDiv}else{if(a==b.landscapeimage.pageNumber){return b.landscapeMediaDiv}}return null},hideNavButtons:function(){var a=this},showNavButtons:function(){var a=this},pauseVideos:function(){var d=this;if(d.portraitMediaDiv!=null){for(var a=0;a<d.portraitMediaDiv.children.length;a++){if(d.portraitMediaDiv.children[a].className.indexOf("readerVideo")!=-1){var c=d.portraitMediaDiv.children[a];if(d.element!=null){$(d.element.dom).removeClass("disableIframe")}if(c.className.indexOf("mp4Video")!=-1){var b=c.getElementsByTagName("iframe")[0];if(b.contentDocument){b.contentDocument.getElementsByTagName("video")[0].pause()}}else{if(c.className.indexOf("youtubeVideo")!=-1){var b=c.getElementsByTagName("iframe")[0];YT.get(b.id).pauseVideo()}else{if(c.className.indexOf("vimeoVideo")!=-1){var b=c.getElementsByClassName("vimeoPlayer")[0];b.contentWindow.postMessage({method:"pause",value:""},"*")}}}}}}if(d.landscapeMediaDiv!=null){for(var a=0;a<d.landscapeMediaDiv.children.length;a++){if(d.landscapeMediaDiv.children[a].className.indexOf("readerVideo")!=-1){var c=d.landscapeMediaDiv.children[a];$(d.element.dom).removeClass("disableIframe");if(c.className.indexOf("mp4Video")!=-1){var b=c.getElementsByTagName("iframe")[0];b.contentDocument.getElementsByTagName("video")[0].pause()}else{if(c.className.indexOf("youtubeVideo")!=-1){var b=c.getElementsByTagName("iframe")[0];b.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}else{if(c.className.indexOf("vimeoVideo")!=-1){var b=c.getElementsByClassName("vimeoPlayer")[0];b.contentWindow.postMessage({method:"pause",value:""},"*")}}}}}}}},0,["readerpageviewer"],["component","container","readerpageviewer"],{component:true,container:true,readerpageviewer:true},["widget.readerpageviewer"],0,[InfinityMobile.view,"ReaderPageViewer"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPageViewerPDF",Ext.Container,{config:{pageNo:"",page:false,previousPage:"",nextPage:"",style:"overflow:hidden",html:'<figure><div class="scrollerDiv"><div class="zoomDiv" ><img style="visibility:hidden;vertical-align:middle" /><img style="visibility:hidden;vertical-align:middle" /><div class="mediaDiv"><div class="portrait"></div><div class="landscape"></div></div><div class="tileDiv" ><div class="portrait"><canvas /></div><div class="landscape"><canvas /></div></div></div></div></figure>',maxScale:3,scrollable:"both",editionGuid:"",cls:"readerpage animate",mode:"double"},beforeInitialize:function(){var a=this;a.isinitialized=false;a.mediaLoaded=false;a.thumbnailLoaded=false;a.pdfsLoaded=false;a.usesCanvas=true;a.canTile=false;a.zoomMode=settings.reader.zoomMode},initialize:function(){var a=this;a.zoomLevel="none";a.on("painted",a.initializePage,a,{delay:10,single:true});a.scroller=a.getScrollable().getScroller();a.scroller.setDisabled(true);a.figure=a.element.down("figure");a.scrollerDiv=a.figure.down("div");a.zoomDiv=a.scrollerDiv.down("div");a.image=a.zoomDiv.down("img").dom;a.landscapeimage=a.zoomDiv.down("img").next("img").dom;a.mediaDiv=a.zoomDiv.down("div");a.portraitMediaDiv=a.mediaDiv.down("div").dom;a.landscapeMediaDiv=a.mediaDiv.down("div").next("div").dom;a.tileDiv=a.element.down(".tileDiv");a.portraitTileDiv=a.tileDiv.down(".portrait");a.image.tileCanvas=a.portraitTileDiv.down("canvas").dom;a.landscapeTileDiv=a.tileDiv.down(".landscape");a.landscapeimage.tileCanvas=a.landscapeTileDiv.down("canvas").dom;a.element.addListener({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragFinished",scope:a});a.scrollerDiv.addListener({scope:a,doubletap:a.onDoubleTap,pinchstart:a.onPinchStart,pinch:a.onPinch,pinchend:a.onPinchEnd});a.scroller.on({scope:a,scrollend:a.onScrollEnd})},initializePage:function(){var a=this;if(a.getPageNo()%2==0){a.imagetoload=a.landscapeimage;a.slaveimage=a.image;if(a.landscapeimage!=null){a.landscapeimage.onload=function(){a.imageLoaded(this,"landscape")}}}else{a.imagetoload=a.image;a.slaveimage=a.landscapeimage;if(a.image!=null){a.image.onload=function(){a.imageLoaded(this,"portrait")}}}a.setUpImages();a.isinitialized=true},setUpImagesCSS:function(){var a=this;a.image.className="";a.landscapeimage.className="";a.portraitMediaDiv.className="";a.landscapeMediaDiv.className="";a.portraitTileDiv.dom.className="";a.landscapeTileDiv.dom.className="";if((a.getPageNo()%2)==0){a.landscapeimage.portraitshow=true;a.image.portraitshow=false;a.image.className=a.returnLandscapeImageType();a.portraitMediaDiv.className=a.returnLandscapeImageType();a.portraitTileDiv.dom.className=a.returnLandscapeImageType();if(a.getPreviousPage()==""){a.image.stayHidden=true}}else{a.image.portraitshow=true;a.landscapeimage.portraitshow=false;a.landscapeimage.className=a.returnLandscapeImageType();a.landscapeMediaDiv.className=a.returnLandscapeImageType();a.landscapeTileDiv.dom.className=a.returnLandscapeImageType();if(a.getNextPage()==""){a.landscapeimage.stayHidden=true}}},setUpImagesURL:function(){var a=this;if((a.getPageNo()%2)==0){a.landscapeimage.pageNumber=a.getPage().pageIndex;a.getThumbnail(a.landscapeimage,a.getPage());if(a.getPreviousPage()!=""&&a.getPreviousPage().pageIndex!=-1){a.image.pageNumber=a.getPage().pageIndex-1;a.getThumbnail(a.image,a.getPreviousPage())}else{if(a.getPreviousPage()==""){a.image.pageNumber=0;a.getThumbnail(a.image,a.getPage())}else{a.image.pageNumber=-1;a.getThumbnail(a.image,a.getPreviousPage())}}}else{a.image.pageNumber=a.getPage().pageIndex;a.getThumbnail(a.image,a.getPage());if(a.getNextPage()!=""&&a.getNextPage().pageIndex!=-1){a.landscapeimage.pageNumber=a.getPage().pageIndex+1;a.getThumbnail(a.landscapeimage,a.getNextPage())}else{if(a.getNextPage()==""){a.landscapeimage.pageNumber=0;a.getThumbnail(a.landscapeimage,a.getPage())}else{a.landscapeimage.pageNumber=-1;a.getThumbnail(a.landscapeimage,a.getNextPage())}}}},setUpImages:function(){var a=this;a.setUpImagesCSS();a.setUpImagesURL()},returnLandscapeImageType:function(){var a=this;if(a._mode=="single"){return"singlepagelandscapeimage"}return"landscapeimage"},getThumbnail:function(c,b){var a=this;var d="";if(b.image!=null){d=b.image;if(b.pageNum>1){if(b.image.indexOf("pages.cdn.pagesuite.com")!=-1){d="http://pages.mobile.cdn.pagesuite.com/images/"+a.retrievePageGuid(b)+"/tablet.jpg"}}}c.src=d;c.type=b.type},retrievePageGuid:function(a){return a.image.split("/")[5]},imageLoaded:function(d){var b=this;var a=b.image;var c=b.landscapeimage;if(b.element!=null){b.layoutImages(d,a,c);b.resetPage();b.resetZoom();b.loadMediaImage("portrait",a);b.loadMediaImage("landscape",c);b.thumbnailLoaded=true;b.fireEvent("thumbnailLoaded")}},layoutImages:function(f,h,j){var k=this;var b=k.returnOrientation();f=k.imagetoload;if(f.clientWidth==0){f=k.slaveimage}k.pageWidth=k.element.dom.clientWidth;k.pageHeight=k.element.dom.clientHeight;k.imageWidth=f.naturalWidth;k.imageHeight=f.naturalHeight;k.imagePageWidth=k.pageWidth;k.imagePageHeight=k.pageHeight;k.initialTranslateX=0;k.initialTranslateY=0;if(b=="landscape"&&k._mode=="double"){k.layoutImagesDoublePageMode(h,j)}else{k.layoutImagesSinglePageMode(h,j)}if(f.clientWidth!=0&&f.pageNumber!=-1){k.initialImageWidth=f.clientWidth;k.initialImageHeight=f.clientHeight}else{if(h.clientWidth!=0&&h.pageNumber!=-1){if(h.clientWidth%2==1){k.initialImageWidth=h.clientWidth-0.5}else{k.initialImageWidth=h.clientWidth}if(h.clientHeight%2==1){k.initialImageWidth=h.clientHeight-0.5}else{k.initialImageWidth=h.clientHeight}}else{if(j.clientWidth!=0&&j.pageNumber!=-1){if(j.clientWidth%2==1){k.initialImageWidth=j.clientWidth-0.5}else{k.initialImageWidth=j.clientWidth}if(j.clientHeight%2==1){k.initialImageWidth=j.clientHeight-0.5}else{k.initialImageWidth=j.clientHeight}}}}if(k.initialImageHeight<k.imagePageHeight){var a=(k.imagePageHeight-k.initialImageHeight)/2;k.initialTranslateY=a}k.offsetX=0;k.offsetY=0;if(h.stayHidden==null){h.style.visibility="inherit"}else{h.style.visibility="hidden"}if(j.stayHidden==null){j.style.visibility="inherit"}else{j.style.visibility="hidden"}var c=k.portraitMediaDiv;var g=k.landscapeMediaDiv;var e=k.portraitTileDiv;var d=k.landscapeTileDiv;c.style.height=g.style.height=parseInt(k.initialImageHeight)+"px";c.style.width=g.style.width=parseInt(k.initialImageWidth)+"px"},layoutImagesDoublePageMode:function(c,e){var d=this;d.imagePageWidth=(d.pageWidth/2);d.widthRatio=d.imagePageWidth/d.imageWidth;d.heightRatio=d.imagePageHeight/d.imageHeight;d.scale=1;if(d.zoomMode=="fit"&&d.widthRatio>d.heightRatio){c.style.height=d.imagePageHeight+"px";c.style.width="auto";e.style.height=c.style.height;e.style.width=c.style.width;var b=Math.max(c.clientWidth,e.clientWidth);if(c.type=="leftHandAd"){var a=((e.clientWidth-c.clientWidth)/2);if(a>0){c.style.marginLeft=a+"px";c.style.marginRight=(a-1)+"px"}}d.initialTranslateX=((d.pageWidth-((b*2)*d.scale))/2)}else{c.style.width=d.imagePageWidth+"px";c.style.height="auto";e.style.width=c.style.width;e.style.height=c.style.height;if(c.type=="leftHandAd"){if(c.clientHeight>e.clientHeight){c.style.width="auto";c.style.height=e.clientHeight+"px";var a=((e.clientWidth-c.clientWidth)/2);if(a>0){c.style.marginLeft=a+"px";c.style.marginRight=(a-1)+"px"}}}}},layoutImagesSinglePageMode:function(a,c){var b=this;b.widthRatio=b.imagePageWidth/b.imageWidth;b.heightRatio=b.imagePageHeight/b.imageHeight;b.scale=1;if(b.zoomMode=="fit"&&b.widthRatio>b.heightRatio){a.style.height=b.imagePageHeight+"px";a.style.width="auto";c.style.height=a.style.height;c.style.width=a.style.width;b.initialTranslateX=((b.pageWidth-(b.zoomDiv.dom.clientWidth*b.scale))/2)}else{a.style.width=b.imagePageWidth+"px";a.style.height="auto";c.style.width=a.style.width;c.style.height=a.style.height}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},completePDFLoaded:function(b){var a=this;mainPanel.fireEvent("removeSplash");if(a.isinitialized&&!a.pdfsLoaded){if(a.thumbnailLoaded){a.loadPDFs()}else{a.on("thumbnailLoaded",function(){a.loadPDFs()})}}else{a.on("thumbnailLoaded",function(){a.loadPDFs()})}a.pdfsLoaded=true},loadPDFs:function(){var b=this;if(!b.hasLoaded){var d=b.imagetoload;var a=b.image;var c=b.landscapeimage;if(d.pageNumber==a.pageNumber){b.loadPDF(c);b.loadPDF(a);b.hasLoaded=true;b.canTile=true}else{b.loadPDF(a);b.loadPDF(c);b.hasLoaded=true;b.canTile=true}}},loadPDF:function(d){var b=this;if(d.pageNumber>0&&b.imageVisible(d)){if(d.src.indexOf("pages.mobile.cdn.pagesuite.com")!=-1||d.src.indexOf("pages.cdn.pagesuite.com")!=-1){var c={tiled:false,pageNumber:d.pageNumber,portraitshow:d.portraitshow,pdfPage:null};if(d.portraitshow){b.portraitTilePDF=c}else{b.landscapeTilePDF=c}var a=b.returnEditionPage(d);if(a.pdfPage!=null){b.setUpTiledPDFPage(a.pdfPage,d)}else{if(a.pdfRequest!=null){b.requestPage(a,d)}else{b.pdfsLoaded=false;b.hasLoaded=false;mainPanel.fireEvent("removeSplash")}}}}},imageVisible:function(c){var b=this;var a=true;if((b._mode=="single"||b.returnOrientation()=="portrait")&&(c.className=="singlepagelandscapeimage"||c.className=="landscapeimage")){a=false}return a},returnEditionPage:function(d){var c=this;var b=editionFlatplanData.pageGroups;if(d.pageNumber>=1){var a=b[(d.pageNumber-1)].pages[0];return a}console.log(b);return null},requestPage:function(a,c){var b=this;a.pdfRequest.then(function(d){if(d.pdfInfo.numPages>0){d.getPage(1).then(function(e){b.setUpTiledPDFPage(e,c)})}})},setUpTiledPDFPage:function(g,l){var k=this;var b=l.tileCanvas;k.setUpCanvas(b);var f=g.pageInfo.view[2];var m=k.initialImageWidth;var e=(m*k.scale)/f;var h=g.getViewport(e);var j=h.height;h.transform[4]=b.canvasPDFOffsetX*-1;h.transform[5]=j-b.canvasPDFOffsetY;var a=b.getContext("2d");var d={canvasContext:a,viewport:h,isCancelled:false};b.style.visibility="hidden";var n=function(){b.style.visibility="visible";k.hasTiled=true};var o=function(){k.loadPDF(l)};var c=function(){k.pdfsLoaded=false;k.hasLoaded=false};k.fireEvent("renderPDF",g,d,l.pageNumber,n,o,c)},toggleDPS:function(){var a=this;a.disableTiling();if(a._mode=="double"){a._mode="single"}else{a._mode="double"}if(a.adjustPageOnToggleDPS()){a.resetPage();a.resetZoom()}},adjustPageOnToggleDPS:function(){var d=this;var b=d.image;var e=d.landscapeimage;var h=d.parent.getActiveItem();var g=d.getPageNo();var a=g-h.getPageNo();if(d.image.pageNumber==-1||d.landscapeimage.pageNumber==-1&&(a==1||a==-1)){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}if(a==0){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}else{if(a>0){if(d._mode=="single"){if(a%2==1){if(a==1){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}else{var f=a-2;var c=g-f;d.setPageNo(c)}}else{var f=a/2;var c=g-f;d.setPageNo(c)}}else{var c=g+a;d.setPageNo(c)}}else{if(d._mode=="single"){if(a%2==-1){if(a==-1){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}else{var f=a+1;var c=g-f;d.setPageNo(c)}}else{var f=a/2;var c=g-f;d.setPageNo(c)}}else{var c=Math.max(0,(g+a));d.setPageNo(c)}}}d.parent.returnPage=d.parent.config.returnPage;d.setPage(d.parent.returnPage(d.getPageNo(),false));d.setPreviousPage(d.parent.returnPage(d.getPageNo()-1,true));d.setNextPage(d.parent.returnPage(d.getPageNo()+1,true));d.resetImages();return false},resetImages:function(){var a=this;a.image.src="";a.landscapeimage.src="";if(a.portraitTileImage!=null){a.portraitTileImage.src="";a.portraitTileImage.tiled=false}if(a.landscapeTileImage!=null){a.landscapeTileImage.src="";a.landscapeTileImage.tiled=false}if(a.isinitialized){a.setUpImages()}a.mediaLoaded=false;a.thumbnailLoaded=false;a.hasLoaded=false},onResize:function(b){var a=this;a.disableTiling();a.fireEvent("resizeArticlesBrowser");if(a.adjustPageOnResize()){a.resetPage();a.resetZoom()}},adjustPageOnResize:function(){var d=this;var b=d.image;var e=d.landscapeimage;if(d._mode=="single"){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}if(d.image.pageNumber==-1||d.landscapeimage.pageNumber==-1&&(a==1||a==-1)){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}var h=d.parent.getActiveItem();var g=d.getPageNo();var a=g-h.getPageNo();if(a==0){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}else{if(a>0){if(d.returnOrientation()=="portrait"){if(a%2==1){if(a==1){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}else{var f=a-2;var c=g-f;d.setPageNo(c)}}else{var f=a/2;var c=g-f;d.setPageNo(c)}}else{var c=g+a;d.setPageNo(c)}}else{if(d.returnOrientation()=="portrait"){if(a%2==-1){if(a==-1){if(d.isinitialized){d.setUpImagesCSS();d.layoutImages(d.imagetoload,d.image,d.landscapeimage)}return true}else{var f=a+1;var c=g-f;d.setPageNo(c)}}else{var f=a/2;var c=g-f;d.setPageNo(c)}}else{var c=g+a;d.setPageNo(c)}}}d.parent.returnPage=d.parent.config.returnPage;d.setPage(d.parent.returnPage(d.getPageNo()));d.setPreviousPage(d.parent.returnPage(d.getPageNo()-1));d.setNextPage(d.parent.returnPage(d.getPageNo()+1));d.resetImages();return false},onDragStart:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDrag:function(b){var a=this;if(a.scale>1){b.stopPropagation()}},onDragFinished:function(c){var b=this;var a=b.scroller.position;b.zoomPosition=b.scroller.position;if(b.scale>1){c.stopPropagation()}},onDoubleTap:function(c){var b=this;var a=b.scroller.position;b.zoomPosition=b.scroller.position;b.zoomPointX=c.pageX;b.zoomPointY=c.pageY+b.scroller.position.y;if(settings.reader.doubleTapFullZoom!=null){if(settings.reader.doubleTapFullZoom=="true"){if(b.scale==1){b.initializeTouch(b.zoomPointX,b.zoomPointY);b.scale=b.getMaxScale();if(document.getElementById("slider")!=null){document.getElementById("slider").value=b.getMaxScale();b.hideNavButtons();b.fireEvent("hideWrapAds")}}else{b.resetPage();b.fireEvent("showWrapAds");if(b.zoomMode=="fit"&&b.mode=="double"){b.showNavButtons()}else{b.hideNavButtons()}}}else{if(mme.scale<b.getMaxScale()/2){b.initializeTouch(b.zoomPointX,b.zoomPointY);b.scale=b.getMaxScale()/2;b.zoomLevel="mid";if(document.getElementById("slider")!=null){document.getElementById("slider").value=b.getMaxScale()/2;b.hideNavButtons();b.fireEvent("hideWrapAds")}}else{if(b.scale<b.getMaxScale()){b.zoomPointX=(b.scroller.position.x+c.pageX)/b.scale;b.zoomPointY=(b.scroller.position.y+c.pageY)/b.scale;b.initializeTouch(b.zoomPointX,b.zoomPointY);b.scale=b.getMaxScale();b.zoomLevel="full";if(document.getElementById("slider")!=null){document.getElementById("slider").value=b.getMaxScale();b.hideNavButtons();b.fireEvent("hideWrapAds")}}else{b.zoomLevel="none";b.resetPage();b.fireEvent("showWrapAds");if(b.zoomMode=="fit"&&b.mode=="double"){b.showNavButtons()}else{b.hideNavButtons()}}}}}else{if(b.scale==1){b.initializeTouch(b.zoomPointX,b.zoomPointY);b.scale=b.getMaxScale();if(document.getElementById("slider")!=null){document.getElementById("slider").value=b.getMaxScale();b.hideNavButtons();b.fireEvent("hideWrapAds")}}else{b.resetPage();b.fireEvent("showWrapAds");if(b.zoomMode=="fit"&&b.mode=="double"){b.showNavButtons()}else{b.hideNavButtons()}}}b.finishZoom()},onPinchStart:function(d){var c=this;c.disableTiling();c.startDistance=d.distance;var f=((d.touches[0].pageX+d.touches[1].pageX)/2);var e=((d.touches[0].pageY+d.touches[1].pageY)/2);var b=f+c.scroller.position.x;var a=e+c.scroller.position.y;c.zoomPointX=((b)/(c.scale));c.zoomPointY=((a)/(c.scale));c.offsetX=(f-c.zoomPointX);c.offsetY=(e-c.zoomPointY);c.offsetScrollerX=c.offsetX+c.scroller.position.x;c.offsetScrollerY=c.offsetY+c.scroller.position.y;c.initializeTouch(c.zoomPointX,c.zoomPointY);c.translateX+=c.offsetScrollerX;c.translateY+=c.offsetScrollerY;c.applyTransform(c.scale);c.fireEvent("hideWrapAds")},onPinch:function(b){var a=this;if(a.dontPinch==true){return}a.currentScale=Math.min(((b.distance/a.startDistance)*a.scale),a.getMaxScale());a.applyTransform(a.currentScale)},onPinchEnd:function(b){var a=this;if(a.currentScale<=1){a.resetPage();a.finishZoom();a.showNavButtons();a.fireEvent("showWrapAds")}else{a.scale=a.currentScale;a.finishZoom();a.hideNavButtons();a.fireEvent("hideWrapAds")}},onZoomStart:function(g,d){var c=this;c.scale=d;var f=(c.pageWidth/2);var e=(c.pageHeight/2);var b=f+c.scroller.position.x;var a=e+c.scroller.position.y;c.zoomPointX=((b)/(c.scale));c.zoomPointY=((a)/(c.scale));c.offsetX=0;c.offsetY=0;c.offsetScrollerX=c.offsetX+c.scroller.position.x;c.offsetScrollerY=c.offsetY+c.scroller.position.y;c.initializeTouch(c.zoomPointX,c.zoomPointY);c.translateX+=c.offsetScrollerX;c.translateY+=c.offsetScrollerY;c.applyTransform(c.scale);c.fireEvent("hideWrapAds")},onZoom:function(c,b){var a=this;a.currentScale=b.dom.valueAsNumber;a.applyTransform(a.currentScale)},onZoomEnd:function(c,b){var a=this;if(a.currentScale<=1){a.resetPage();a.finishZoom();a.showNavButtons();a.fireEvent("showWrapAds")}else{a.scale=a.currentScale;a.finishZoom();a.hideNavButtons();a.fireEvent("hideWrapAds")}},onChange:function(e,c,b){var d=this;d.currentScale=e;if(d.currentScale<=1){d.resetPage();d.finishZoom();d.showNavButtons()}else{d.scale=d.currentScale;d.sliderZoom();var a=d.scroller.position;d.zoomPosition=d.scroller.position;d.hideNavButtons()}},resetPage:function(){var a=this;a.translateX=a.initialTranslateX;a.translateY=a.initialTranslateY;a.scale=1;a.showNavButtons();a.applyTransform(a.scale);if(document.getElementById("slider")!=null){document.getElementById("slider").value=1}},initializeTouch:function(b,a){var c=this;c.elementTouchX=b-c.translateX;c.elementTouchY=a-c.translateY;c.setOrigin(c.elementTouchX,c.elementTouchY)},setOrigin:function(a,c){var b=this;b.zoomDiv.dom.style.webkitTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.MozTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.msTransformOrigin=a+"px "+c+"px";b.zoomDiv.dom.style.transformOrigin=a+"px "+c+"px"},applyTranslate:function(b){var a=this;a.zoomDiv.dom.style.webkitTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)";a.zoomDiv.dom.style.MozTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)";a.zoomDiv.dom.style.msTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+4+","+4+",1)"},applyTransform:function(b){var a=this;a.zoomDiv.dom.style.webkitTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.MozTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)";a.zoomDiv.dom.style.msTransform="translate3d("+a.translateX+"px, "+a.translateY+"px, 0) scale3d("+b+","+b+",1)"},finishZoom:function(){var a=this;if(a.scale==1){a.resetZoom();a.fireEvent("showNavButtons")}else{a.setZoom();a.fireEvent("hideNavButtons")}},setZoom:function(){var c=this;c.scrollerDiv.dom.style.width=((c.initialImageWidth)*c.scale)+"px";if(c.returnOrientation()=="landscape"&&c._mode=="double"){c.scrollerDiv.dom.style.width=((c.initialImageWidth)*c.scale*2)+"px"}c.scrollerDiv.dom.style.height=(c.initialImageHeight*c.scale)+"px";c.setOrigin(0,0);c.translateX=0;c.translateY=0;c.applyTransform(c.scale);c.scroller.setDisabled(false);c.scroller.setDirection("both");var b=c.elementTouchX*c.scale;var a=c.elementTouchY*c.scale;var e=b-c.zoomPointX-c.offsetX;var d=a-c.zoomPointY-c.offsetY;c.scroller.scrollTo(e,d);c.startTiling()},resetZoom:function(){var b=this;if(b.mediaDiv.dom.children[0].children.length>0){for(var a=0;a<b.mediaDiv.dom.children[0].children.length;a++){try{var c=b.mediaDiv.dom.children[0].children[a].children[0].children[0].children[0].children[0].children[0];if(c.className=="tool-tip"){c.style.fontSize="12px";c.style.padding="5px"}}catch(d){}}}if(b.mediaDiv.dom.children[1].children.length>0){for(var a=0;a<b.mediaDiv.dom.children[1].children.length;a++){try{var c=b.mediaDiv.dom.children[1].children[a].children[0].children[0].children[0].children[0].children[0];if(c.className=="tool-tip"){c.style.fontSize="12px";c.style.padding="5px"}}catch(d){}}}b.scrollerDiv.dom.style.width="";b.scrollerDiv.dom.style.height="";b.scrollTo(0,0);if(b.zoomMode=="fill"){b.scroller.setDisabled(false);b.scroller.setDirection("vertical");b.scroller.setDirectionLock(true)}else{b.scroller.setDisabled(true)}b.scroller.position.x=0;b.startTiling()},setPDFContainers:function(){var h=this;var b=h.portraitTileDiv;var a=h.landscapeTileDiv;var k=((h.initialImageWidth*h.scale)-h.scroller.position.x);var c=Math.min(h.pageWidth,k);c=Math.max(0,c);var e=c;var f=h.image;if(f.type=="leftHandAd"){c=(f.clientWidth*h.scale)-h.scroller.position.x;c=Math.max(0,c)}var j=h.scroller.position.x;var g=j;if(h.returnOrientation()=="landscape"&&h._mode=="double"){e=(h.pageWidth-c);g=Math.max(0,(h.scroller.position.x-(h.initialImageWidth*h.scale)))}var d=h.scroller.position.y;b.dom.style.width=c+"px";b.dom.canvasWidth=c;b.dom.canvasOffsetX=j;b.dom.canvasOffsetY=d;a.dom.style.width=e+"px";a.dom.canvasWidth=e;a.dom.canvasOffsetX=g;a.dom.canvasOffsetY=d},stopTiling:function(){var a=this;a.disableTiling();a.canTile=false},setTiling:function(){var a=this;a.canTile=true;a.resetZoom()},enableScroller:function(){var a=this;if(a.scroller.getDisabled()&&a.scroller.manuallyDisabled!=null&&a.scroller.manuallyDisabled==true){a.scroller.setDisabled(false);a.scroller.manuallyDisabled=false}},scrollTo:function(a,c){var b=this;b.scroller.scrollTo(a,c)},onScrollEnd:function(){var a=this;if(Ext.os.is.Tablet){if(a.scroller.position.y<=0){a.fireEvent("hideTop")}else{a.fireEvent("showTop")}if(a.scroller.position.y>=a.scroller.maxPosition.y){a.fireEvent("hideBottom")}else{a.fireEvent("showBottom")}}a.startTiling()},startTiling:function(){var b=this;b.setPDFContainers();if(b.canTile){var a=b.image;var c=b.landscapeimage;b.loadPDF(a);b.loadPDF(c)}},setUpCanvas:function(d){var f=this;if(f.element!=null){var b=Math.min(d.parentNode.canvasWidth);var k=Math.min(f.pageHeight,f.initialImageHeight*f.scale);f.tileDiv.dom.style.width="300%";f.tileDiv.dom.style.height="300%";d.canvasPDFOffsetX=d.parentNode.canvasOffsetX;d.canvasPDFOffsetY=d.parentNode.canvasOffsetY;var h=f.scroller.position.x/f.scale;var g=f.scroller.position.y/f.scale;f.tileDiv.dom.style.top=g+"px";f.tileDiv.dom.style.left=h+"px";f.tileDiv.dom.style.webkitTransform="scale3d("+(1/f.scale)+","+(1/f.scale)+",1)";f.tileDiv.dom.style.MozTransform="scale("+(1/f.scale)+","+(1/f.scale)+")";f.tileDiv.dom.style.msTransform="scale3d("+(1/f.scale)+","+(1/f.scale)+",1)";var c=d.getContext("2d");devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1,ratio=devicePixelRatio/backingStoreRatio;var a=1/ratio;if(a!=1){c.setTransform(a,0,0,a,0,0)}if(typeof auto==="undefined"){auto=true}var e=b;var j=k;d.width=e*ratio;d.height=j*ratio;d.style.width=e+"px";d.style.height=j+"px";c._transformMatrix=[ratio,0,0,ratio,0,0];c.setTransform(1,0,0,1,0,0);c.scale(ratio,ratio);d.desx=(f.scroller.position.x*-1);d.desxland=d.desx+(f.initialImageWidth*f.scale);d.desy=(f.scroller.position.y*-1);d.desw=parseInt(f.initialImageWidth*f.scale);d.desh=parseInt(f.initialImageHeight*f.scale)}},disableTiling:function(){var a=this;a.image.tileCanvas.width=0;a.image.tileCanvas.height=0;a.landscapeimage.tileCanvas.width=0;a.landscapeimage.tileCanvas.height=0},destroy:function(){var a=this;a.isinitialized=false;a.element.dom.innerHTML="";a.image.tileCanvas.width=0;a.image.tileCanvas.height=0;a.landscapeimage.tileCanvas.width=0;a.landscapeimage.tileCanvas.height=0;delete a.figure;delete a.scrollerDiv;delete a.zoomDiv;delete a.image;delete a.landscapeimage;delete a.tileDiv;delete a.tileCanvas;delete a.portraitTileImage;delete a.landscapeTileImage;Ext.Container.prototype.destroy.apply(this,arguments);delete a},loadMediaImage:function(b,e){var c=this;var a=c.image.pageNumber;var d=c.portraitMediaDiv;if(b=="landscape"){a=c.landscapeimage.pageNumber;d=c.landscapeMediaDiv}a=a-pageOffset;if(a!=0){c.fireEvent("loadMedia",c,a,d)}c.mediaLoaded=true},returnMediaContainer:function(a){var b=this;if(a==b.image.pageNumber){return b.portraitMediaDiv}else{if(a==b.landscapeimage.pageNumber){return b.landscapeMediaDiv}}return null},hideNavButtons:function(){var a=this},showNavButtons:function(){var a=this},pauseVideos:function(){var d=this;if(d.portraitMediaDiv!=null){for(var a=0;a<d.portraitMediaDiv.children.length;a++){if(d.portraitMediaDiv.children[a].className.indexOf("readerVideo")!=-1){var c=d.portraitMediaDiv.children[a];$(d.element.dom).removeClass("disableIframe");if(c.className.indexOf("mp4Video")!=-1){var b=c.getElementsByTagName("iframe")[0];b.contentDocument.getElementsByTagName("video")[0].pause()}else{if(c.className.indexOf("youtubeVideo")!=-1){var b=c.getElementsByTagName("iframe")[0];YT.get(b.id).pauseVideo()}else{if(c.className.indexOf("vimeoVideo")!=-1){var b=c.getElementsByClassName("vimeoPlayer")[0];b.contentWindow.postMessage({method:"pause",value:""},"*")}}}}}}if(d.landscapeMediaDiv!=null){for(var a=0;a<d.landscapeMediaDiv.children.length;a++){if(d.landscapeMediaDiv.children[a].className.indexOf("readerVideo")!=-1){var c=d.landscapeMediaDiv.children[a];$(d.element.dom).removeClass("disableIframe");if(c.className.indexOf("mp4Video")!=-1){var b=c.getElementsByTagName("iframe")[0];b.contentDocument.getElementsByTagName("video")[0].pause()}else{if(c.className.indexOf("youtubeVideo")!=-1){var b=c.getElementsByTagName("iframe")[0];YT.get(b.id).pauseVideo()}else{if(c.className.indexOf("vimeoVideo")!=-1){var b=c.getElementsByClassName("vimeoPlayer")[0];b.contentWindow.postMessage({method:"pause",value:""},"*")}}}}}}}},0,["readerpageviewer"],["component","container","readerpageviewer"],{component:true,container:true,readerpageviewer:true},["widget.readerpageviewer"],0,[InfinityMobile.view,"ReaderPageViewerPDF"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutViewController",InfinityMobile.view.LayoutView,{config:{pageNo:""},initialize:function(){var a=this;InfinityMobile.view.LayoutView.prototype.initialize.apply(this,arguments);if(a.json!=null){a.loadViewController()}},layoutViewStyleOrientation:function(b,a,e){var d=this;var c="";if(a=="portrait"){c=b.portraitBackgroundImage}else{c=b.landscapeBackgroundImage}var f=InfinityMobile.view.LayoutView.prototype.layoutViewStyleOrientation.apply(this,arguments);if(c!=""){f+="background-image: url('"+c+"');"}return f},loadViewController:function(){var a=this;a.fireEvent("loadViewController",a)},loadViewByID:function(d){var c=this;c.removeAll(true);var b=c.element.dom.clientWidth;var a=c.element.dom.clientHeight;$.ajax({crossDomain:true,type:"GET",contentType:"application/json; charset=utf-8",async:false,url:"../../API/get_sub_project.aspx?fonts=false&width="+b+"&height="+a+"&viewid="+d+"&topbarheight="+topBarHeight+"&appplatid="+applicatiionPlatformID+"&uuid=E08BA9CA-2D5E-475B-91C5-D6D9D367F4CF",success:function(e){c.json=e;c.loadViewController()}})}},0,["layoutviewcontroller"],["component","container","layoutview","layoutviewcontroller"],{component:true,container:true,layoutview:true,layoutviewcontroller:true},["widget.layoutviewcontroller"],0,[InfinityMobile.view,"LayoutViewController"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutTextView",InfinityMobile.view.LayoutView,{initialize:function(){var b=this;InfinityMobile.view.LayoutView.prototype.initialize.apply(this,arguments);var a=b.getState(b.json,"elipsis",Ext.Viewport.orientation);if(a==null||a==true){b.on("painted",b.initializePage,b,{delay:10,single:true})}},layoutViewStyleOrientation:function(b,a,e){var d=this;var f=InfinityMobile.view.LayoutView.prototype.layoutViewStyleOrientation.apply(this,arguments);var c=d.getState(b,"textColor",a,e);f+="color:"+c+";";return f},initializePage:function(){var a=this;a.thisLabel=a.items.items[0];a.thisLabelDom=a.thisLabel.element;a.actualLabel=a.thisLabelDom.down("div");a.textNodes=a.actualLabel.dom.cloneNode(true).childNodes},runEllipsis:function(){var a=this;a.labelHeight=a.actualLabel.dom.clientHeight;a.actualLabel.dom.style.height="auto";var b=a.actualLabel.dom.clientHeight;if(b>a.labelHeight){a.ellipsis(a.actualLabel)}a.actualLabel.dom.style.height=a.labelHeight+"px";a.element.dom.style.visibility="inherit"},ellipsis:function(b){var e=this;b.dom.innerHTML="";var a=e.labelHeight;for(var d=0;d<e.textNodes.length;d++){var c=e.textNodes[d].cloneNode(true);b.dom.appendChild(c);if(e.actualLabel.dom.clientHeight>a){var f=c.textContent.split(" ");c.textContent="";for(var d=0;d<f.length;d++){c.textContent+=f[d]+" ";if(e.actualLabel.dom.clientHeight>a){c.textContent=c.textContent.substring(0,c.textContent.length-(f[d].length+5))+"...";break}}}}},ellipsisWord:function(a,b){}},0,["layouttextview"],["component","container","layoutview","layouttextview"],{component:true,container:true,layoutview:true,layouttextview:true},["widget.layouttextview"],0,[InfinityMobile.view,"LayoutTextView"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderSearchItem",Ext.Container,{config:{height:160,style:"background-color:white; border-bottom:1px solid #ececec",layout:"hbox",pageNumber:"",name:"",editionGuid:"",textString:"",searchType:"",items:[{itemId:"searchItemImage",width:125,margin:15,style:"border:1px solid #f0f0f0"},{itemId:"searchItemDescription",flex:1,margin:"35 15 35 15"}]},initialize:function(){var a=this;a.searchItemImage=a.getComponent("searchItemImage");a.searchItemDescription=a.getComponent("searchItemDescription");a.pageNumber=a._pageNumber;a.name=a._name;a.editionGuid=a._editionGuid;a.textString=a._textString;a.searchType=a._searchType;if(a.textString==null){a.textString=""}a.element.on({tap:"onTap",scope:a});a.on("painted",a.initializePage,a,{delay:10,single:true})},onTap:function(b){var a=this;a.fireEvent("click",a)},initializePage:function(){var b=this;var a="https://edition.pagesuite-professional.co.uk/get_image.aspx?h=125&eid="+b.editionGuid+"&pnum="+b.pageNumber;var c="";if(b.searchType=="e"){c="<div style='font-size:16px'><b>Page "+b.pageNumber+"</b></div><br /><div style='font-size:14px'>"+b.textString+"</div>"}else{c="<div style='font-size:16px'><b>"+b.name+" Page "+b.pageNumber+"</b></div><br /><div style='font-size:14px'>"+b.textString+"</div>"}if(currentProfile=="phone"){b.searchItemDescription.setMargin("15 15 15 15");c=c.replace("<br />","");b.searchItemDescription.addCls("fadeSearchItem")}b.searchItemDescription.setHtml(c);b.showImage()},showImage:function(){var e=this;var d=e.element.dom.offsetTop;var c=e.parent;var b=c.element.dom.clientHeight;var g=c.element.dom;var f=g.scrollTop;if(d<parseFloat(b)+parseFloat(f)||currentProfile=="desktop"){if(e.searchItemImage.getHtml()==null){var a="https://edition.pagesuite-professional.co.uk/get_image.aspx?w=250&eid="+e.editionGuid+"&pnum="+e.pageNumber;e.searchItemImage.setHtml("<div style='height:127px; overflow:hidden'><img style='width:100%' src='"+a+"' /></div>")}}}},0,["searchItem"],["component","container","searchItem"],{component:true,container:true,searchItem:true},["widget.searchItem"],0,[InfinityMobile.view,"ReaderSearchItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArchiveItem",Ext.Container,{config:{style:"float:left;border:1px solid grey; overflow:hidden",editionGuid:"",editionName:"",height:175,items:[{itemId:"archiveItemLabel",cls:"thumbInfo",bottom:0,height:30,width:"100%",padding:"5 0 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; text-align:center; border-radius:5px"}]},initialize:function(){var a=this;a.editionGuid=a._editionGuid;a.editionName=a._editionName;a.editionLabel=a.getComponent("archiveItemLabel");var b="https://edition.pagesuite-professional.co.uk//get_image.aspx?w=280&eid="+a.editionGuid;a.setHtml("<img style='width:100%' src='"+b+"' />");a.editionLabel.setHtml(a.editionName);a.element.on({tap:"onTap",scope:a})},onTap:function(){var b=this;var a="";if(qs.localhost!=null&&qs.localhost=="true"){a="&localhost=true"}window.location.href="default.aspx?&edid="+b.editionGuid+a}},0,["archiveItem"],["component","container","archiveItem"],{component:true,container:true,archiveItem:true},["widget.archiveItem"],0,[InfinityMobile.view,"ReaderArchiveItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderAnimationObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"readeranimationobject"},initialize:function(){var a=this;a.isHTML5=false;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(a.mediaObject!=""){if(a.mediaObject.hasHTML5!=null){a.isHTML5=a.mediaObject.hasHTML5}a.setAnimation()}},setAnimation:function(){var d=this;var f=d.mediaObject.file;var c=f.charAt(0);var b=f.charAt(1);var a="../get_animation.aspx?guid="+f+"&html5="+d.isHTML5;var e="<div class='mediaFrameContainer'><iframe class='mediaFrame' src='"+a+"' style='border:none;width:100%;height:100%;visibility:hidden' /></div>";d.setHtml(e);d.frameElementContainer=d.element.down(".mediaFrameContainer").dom;d.frameElementContainer.style.width="100%";d.frameElementContainer.style.height="100%";d.frameElement=d.element.down(".mediaFrame").dom;d.frameElement.onload=function(){d.setFrameDimensions()}},setFrameDimensions:function(){var d=this;var b=d.frameElement.contentWindow.document.body;var c=b.scrollWidth;var f=b.scrollHeight;if(d.isHTML5){d.frameElement.style.width=c+"px";d.frameElement.style.height=f+"px";var e=d.element.dom.clientWidth;var a=e/c;d.frameElementContainer.style.webkitTransformOrigin="0 0";d.frameElementContainer.style.webkitTransform="translate3d(0, 0, 0) scale3d("+a+","+a+",1)";d.frameElementContainer.style.MozTransformOrigin="0 0";d.frameElementContainer.style.MozTransform="translate3d(0, 0, 0) scale3d("+a+","+a+",1)";d.frameElementContainer.style.msTransformOrigin="0 0";d.frameElementContainer.style.msTransform="translate3d(0, 0, 0) scale3d("+a+","+a+",1)";d.frameElementContainer.style.transformOrigin="0 0";d.frameElementContainer.style.transform="translate3d(0, 0, 0) scale3d("+a+","+a+",1)"}d.frameElement.style.visibility="visible"}},0,["readeranimationobject"],["component","container","readermediaobject","readeranimationobject"],{component:true,container:true,readermediaobject:true,readeranimationobject:true},["widget.readeranimationobject"],0,[InfinityMobile.view,"ReaderAnimationObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderLinkObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"readerLink",items:[{itemId:"tooltip",style:"position:absolute !important;"}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(a.mediaObject!=""){a.setMediaLinkStyle()}if(Ext.os.is.Desktop){if(a.config.leftSideOverflow!=null){if(a.config.leftSideOverflow){a.mediaObject.x=100+a.mediaObject.x;a.setMediaObjectStyle()}}}},setMediaObjectStyle:function(){var a=this;a.mediaObject.showBorder=false;a.setupFlash();InfinityMobile.view.ReaderMediaObject.prototype.setMediaObjectStyle.apply(this,arguments)},setMediaLinkStyle:function(){var a=this;if(Ext.os.is.Desktop){if(a.config.disableToolTip==null||!a.config.disableToolTip){if(a.mediaObject.description.length==0){a.mediaObject.description=a.mediaObject.url}a.element.dom.onmouseenter=function(){a.fireEvent("setupArticleTooltip",a.mediaObject.description)};a.element.dom.onmouseleave=function(){a.fireEvent("hideArticleTooltip",a)};a.element.dom.onmousemove=function(b){a.fireEvent("updateArticleTooltipPosition",b)}}}if(a.mediaObject.url!=null){if(a.mediaObject.param1!=null&&a.mediaObject.param1=="POPUPURL"){a.element.on({tap:"onPopupTap",scope:a})}else{a.element.on({tap:"onTap",scope:a})}}},onTap:function(){var c=this;var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.tracking!=null){var d=b.data.items[0].raw.tracking.trackingType;if(d=="GA"){ga("send","event","Open URL","click",c.mediaObject.url,c.mediaObject.pageNumber)}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}var a="mo";if(c.mediaObject.param1!=null&&c.mediaObject.param1=="LINKOBJECT"){a="ll"}if(typeof trackReports!="undefined"){if(trackReports.toLowerCase()=="true"){$.ajax({crossDomain:true,type:"GET",async:true,url:"https://reports.pagesuite-professional.co.uk/track.aspx?html5=true&link="+a+"_"+c.mediaObject.guid})}}c.fireEvent("linkClick",c,c.mediaObject.url)},onPopupTap:function(){var a=this;a.fireEvent("popupLink",a,a.mediaObject)}},0,["readerlinkobject"],["component","container","readermediaobject","readerlinkobject"],{component:true,container:true,readermediaobject:true,readerlinkobject:true},["widget.readerlinkobject"],0,[InfinityMobile.view,"ReaderLinkObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArticleObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"readerArticle"},initialize:function(){var a=this;a.article=null;if(a.config.article!=null){a.article=a.config.article}InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(a.mediaObject!=""){a.setMediaLinkStyle()}},setMediaLinkStyle:function(){var b=this;if(currentProfile=="desktop"){b.add({itemId:"tooltip",style:"position:absolute !important;"});var a=b.mediaObject.description;if(b.article!=null){a=b.article.headline}if(b.mediaObject.description.trim().length>0){b.element.dom.onmouseenter=function(){b.fireEvent("setupArticleTooltip",a)};b.element.dom.onmouseleave=function(){b.fireEvent("hideArticleTooltip",b)};$("body").on("touchstart",function(){b.fireEvent("hideArticleTooltip",b)});b.element.dom.onmousemove=function(c){b.fireEvent("updateArticleTooltipPosition",c)}}}if(b.mediaObject.guid!=null){b.element.on({singletap:"onTap",scope:b})}},onTap:function(){var a=this;a.fireEvent("articleClick",a,a.mediaObject.guid)}},0,["readerarticleobject"],["component","container","readermediaobject","readerarticleobject"],{component:true,container:true,readermediaobject:true,readerarticleobject:true},["widget.readerarticleobject"],0,[InfinityMobile.view,"ReaderArticleObject"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleCarousel",Ext.Carousel,{initialize:function(){var a=this;Ext.carousel.Carousel.prototype.initialize.call(this);a.on("activeitemchange","handleItemChange",this);a.destroyed=false;a._visiblePages=Math.min(a._visiblePages,a.getData().length);a.setCards();a.setOrientationChange();if(settings.reader.disableArticleCarousel!=null){if(settings.reader.disableArticleCarousel=="true"){a.locked=true;a.onDragOrig=a.onDrag;a.onDrag=function(b){if(!this.locked){this.onDragOrig(b)}}}}a.showAdAt=5},config:{indicator:false,data:false,pageNumber:0,skipActiveItemChange:true,pageTemplate:false,visiblePages:3,directionLock:true,landscapePageIncrement:1,mode:"single"},destroy:function(){var a=this;a.destroyed=true;Ext.carousel.Carousel.prototype.destroy.apply(this,arguments)},setPageTemplate:function(a){this.pageTemplate=a},setCards:function(){var j=this;j._skipActiveItemChange=true;var k=1;if(j._pageNumber==0){for(var e=0;e<j._visiblePages;e++){var b=(e*k);j.add(j.createCard(j.getData()[b],b,j.getData()))}j.setActiveItem(0)}else{if(j._pageNumber==(j.getData().length-1)){for(var e=(j._pageNumber-2);e<j.getData().length;e++){j.add(j.createCard(j.getData()[e],e,j.getData()))}j.setActiveItem(2)}else{var f=j._pageNumber;var a=j.createCard(j.getData()[f],f,j.getData());j.add(a);var c=j._pageNumber-(1*k);var d=j.createCard(j.getData()[c],c,j.getData());j.insert(0,d);var h=parseInt(j._pageNumber)+(1*k);var g=j.createCard(j.getData()[h],h,j.getData());j.add(g);j.setActiveItem(1)}}j.articleNo=j.getActiveItem()._pageNo;j._skipActiveItemChange=false},handleItemChange:function(f,d,e,a){var c=this;var b=1;if(!c._skipActiveItemChange){if(d.config.pageNo>e.config.pageNo){if(e.config.pageNo==0||d.config.pageNo==(c.getData().length-1)){}else{c.addCardToFront(f,f.getItems().items[0],b)}c._pageNumber+=b;c._pageNumber=Math.min(c._pageNumber,(c.getData().length-1))}else{if(d.config.pageNo<e.config.pageNo){if(d.config.pageNo==0||e.config.pageNo==(c.getData().length-1)){}else{c.addCardToBack(c,f.getItems().items[2],b)}c._pageNumber-=b;c._pageNumber=Math.max(c._pageNumber,0)}else{if(e.config.addTo=="front"){c.addCardToFront(f,f.getItems().items[0],b)}else{if(e.config.addTo=="back"){c.addCardToBack(f,f.getItems().items[2],0)}}}}}c.fireEvent("pagechange",c,d,e)},updateItemCSS:function(f,d){var e=this;var a=f.getItems().items;for(var c=0;c<a.length;c++){var b=a[c];if(b._itemId!=d._itemId){b.setCls("")}}d.setCls("selecteditem")},createCard:function(f,b,a,c){var e=this;var d;if(!e.pageTemplate){d={pageNo:b,html:"Page: "+b}}else{d=e.pageTemplate(f,b,a)}if(d.content!=null){setText(d.content.element.dom)}else{}return d},addCardToFront:function(f,c,b){var d=this;c._skipActiveItemChange=true;f.remove(c,true);var a=1;var e=(d._pageNumber+b+a);e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createCard(d.getData()[e],e,d.getData()))},addInterstitialToFront:function(f,c,b){var d=this;c._skipActiveItemChange=true;f.remove(c,true);var a=1;var e=(d._pageNumber+b+a);e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createInterstitial(d.getData()[e],e,d.getData(),"front"))},addInterstitialToBack:function(f,a,c){var d=this;var b=1;if(a!=null){a._skipActiveItemChange=true;f.remove(a,true);var e=(d._pageNumber-c-b);e=Math.max(e,0);f.insert(0,d.createInterstitial(d.getData()[e],e,d.getData(),"back"))}},createInterstitial:function(f,b,a,c){var e=this;var g="InfinityMobile.view.desktop.ArticlePopoverInterstitial";switch(currentProfile){case"phone":g="InfinityMobile.view.phone.ArticlePopoverInterstitial";break;case"tablet":g="InfinityMobile.view.tablet.ArticlePopoverInterstitial";break}var d=Ext.create(g,{_pageNo:b,pageNo:b,addTo:c,isAdvert:true});return d},addCardToBack:function(f,a,c){var d=this;var b=1;if(a!=null){a._skipActiveItemChange=true;f.remove(a,true);var e=(d._pageNumber-c-b);e=Math.max(e,0);f.insert(0,d.createCard(d.getData()[e],e,d.getData()))}},jumpToFirst:function(){this.jumpToPage(0)},jumpToLast:function(){this.jumpToPage((this.getData().length-1))},jumpToPage:function(b){var c=this;var a=b;var a=Math.max(a,(this.getData().length-1));a=Math.min(a,0);if(b!=c._pageNumber){if(b==(c._pageNumber+1)){c.next()}else{if(b==(c._pageNumber-1)){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}},injectInterstitial:function(c,a){var d=this;var e="InfinityMobile.view.desktop.ArticlePopoverInterstitial";switch(currentProfile){case"phone":e="InfinityMobile.view.phone.ArticlePopoverInterstitial";break;case"tablet":e="InfinityMobile.view.tablet.ArticlePopoverInterstitial";break}var b=Ext.create(e,{pageNo:a,isAdvert:true});if(c=="next"){d.insert(2,b)}else{if(c=="previous"){d.insert(0,b)}}},frameDragStart:function(f){var d=this.getDirection(),b=f.changedTouches[0].screenX,a=f.changedTouches[0].pageY,c=this.getDirectionLock();this.isDragging=true;this.startXPointFrame=b;this.getTranslatable().stopAnimation();this.dragStartOffset=this.offset;this.dragDirection=0},frameDrag:function(b){var c=b.changedTouches[0].screenX;var a=c-this.startXPointFrame;this.setOffset(a)},frameDragEnd:function(k){this.frameDrag(k);var a=Ext.Date.now(),j=this.itemLength,g=j/2,f=this.offset,n=this.getActiveIndex(),c=this.getMaxItemIndex(),h=0,m=f-this.flickStartOffset,b=a-this.flickStartTime,l=this.getIndicator(),d;if(h===0){if(n<c&&f<-g){h=-1}else{if(n>0&&f>g){h=1}}}this.animationDirection=h;this.setOffsetAnimated(h*j)},setOrientationChange:function(){var a=this;var b=(function(){var c=0;return function(e,d){clearTimeout(c);c=setTimeout(e,d)}})();if(Ext.os.is.Desktop){$(window).on("resize",function(){b(function(){a.onResize()},250)})}else{if(Ext.os.is.Android){$(window).on("resize",function(){setTimeout(function(){a.onResize()},0)})}else{Ext.Viewport.on("orientationchange",function(d,f,e,c){if(parseFloat(iOSVersion())>11){setTimeout(function(){a.onResize()},400)}else{a.onResize()}},a)}}},onResize:function(){var a=this;if(!a.carouselDestroyed){a.onSizeChange()}}},0,["articlecarousel"],["component","container","carousel","articlecarousel"],{component:true,container:true,carousel:true,articlecarousel:true},["widget.articlecarousel"],0,[InfinityMobile.view,"ArticleCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderVideoObject",InfinityMobile.view.ReaderMediaObject,{config:{items:[{itemId:"closeBtn",right:0,top:0,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backImage",style:'background-image:url("../assets/article view/article-close-btn.png");background-repeat:no-repeat;background-size:contain;background-position:center;'}]}],mediaObject:"",cls:"readerVideo"},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);if(a.mediaObject!=""){if(a.mediaObject.url.indexOf("http://www.youtube.com/watch")!=-1){a.initializeYoutube();a.videoType="youtube"}else{if(a.mediaObject.url.indexOf("http://")!=-1&&$.isNumeric(a.mediaObject.url.replace("http://",""))){a.initialiseVimeo();a.videoType="vimeo"}else{if(a.mediaObject.file!=""){a.initialiseMP4();a.videoType="mp4"}}}}a.mediaType="video";a.closeBtn=a.getComponent("closeBtn");a.closeBtn.element.on({tap:function(){var c=this;if(c.mediaObject.remove=="CLOSEBTN"){if(c.videoType=="mp4"){c.video.pause()}else{if(c.videoType=="youtube"){if(c.ytplayer!=null){c.ytplayer.pauseVideo()}else{c.youtubeFrame.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}}else{if(c.videoType=="vimeo"){var b=c.element.dom.getElementsByClassName("vimeoPlayer")[0];b.contentWindow.postMessage({method:"pause",value:""},"*")}}}c.removeAnim()}else{if(c.videoType=="mp4"){c.video.pause()}else{if(c.videoType=="youtube"){if(c.ytplayer!=null){c.ytplayer.pauseVideo()}else{c.youtubeFrame.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}}else{if(c.videoType=="vimeo"){var b=c.element.dom.getElementsByClassName("vimeoPlayer")[0];b.contentWindow.postMessage({method:"pause",value:""},"*")}}}c.hide()}},scope:a});if(a.mediaObject.remove!="CLOSEBTN"){a.closeBtn.hide()}a.mp4FirstPlay=false;if(Ext.os.is.Desktop){if(a.config.leftSideOverflow!=null){if(a.config.leftSideOverflow){a.mediaObject.x=100+a.mediaObject.x;a.setMediaObjectStyle()}}}$(a.element.dom.getElementsByClassName("x-innerhtml")[1]).css("height","100%");$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(b){b.stopPropagation();if(document.webkitFullscreenElement!=null){if(document.webkitFullscreenElement.tagName=="IFRAME"){videoFull=true}}else{if(document.mozFullScreenElement!=null){if(document.mozFullScreenElement.tagName=="IFRAME"){videoFull=true}}else{if(document.fullscreenElement!=null){if(document.fullscreenElement.tagName=="IFRAME"){videoFull=true}}else{videoFull=false}}}})},initializeYoutube:function(){var d=this;d.youtubeCode=d.mediaObject.url.substr(d.mediaObject.url.length-11);var c="http://www.youtube.com/embed/"+d.youtubeCode;var b="";if(d.mediaObject.autoPlay!=null&&d.mediaObject.autoPlay=="true"&&d.mediaObject.appear!="TRIGGER"){}var a="";if(d.mediaObject.param6.length>0){if(d.mediaObject.param6.indexOf("rel")!=-1){a=d.mediaObject.param6;if(a.indexOf("&")==-1){a="&"+a}}}d.addCls("youtubeVideo");d.setHtml("<iframe onload='parent.youtubeplay()' src='"+c+"?enablejsapi=1"+b+a+"' width='100%' height='100%' frameborder='0' id='"+c+"' allowfullscreen/>");d.youtubeFrame=d.element.down("iframe").dom;youtubeplay=function(){d.ytplayer=new YT.Player(document.getElementById(c),{events:{onStateChange:d.onPlayerStateChange,onReady:function(){if(Ext.os.is.Desktop){if(d.mediaObject.autoPlay=="true"&&d.mediaObject.appear!="TRIGGER"){d.fireEvent("checkActivePageVideo",d)}}}}})}},onPlayerStateChange:function(c){var b=this;if(c.data==1){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.tracking!=null){var d=a.data.items[0].raw.tracking.trackingType;if(d=="GA"){ga("set","page","/"+b.startpageNumber);ga("send",{hitType:"pageview",title:publicationName+" - "+editionName});ga("send","event","Youtube","play",c.target.getVideoData().title,b.startpageNumber)}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}},initialiseVimeo:function(){var b=this;b.vimeoId=b.mediaObject.url.substr(7-b.mediaObject.url.length);b.addCls("vimeoVideo");var c="//player.vimeo.com/video/"+b.vimeoId;b.setHtml("<iframe class='vimeoPlayer' src='"+c+"?api=1&amp;player_id="+c+"' allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' width='100%' height='100%' frameborder='0' id='"+c+"'/>");var a=b.element.dom.getElementsByClassName("vimeoPlayer")[0]},initialiseMP4:function(){var b=this;b.fileGuid=b.mediaObject.file;var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);var d="http://source.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+".mp4";b.addCls("mp4Video");openLink=function(){if(b.mediaObject.url.length>0&&b.mediaObject.url.indexOf("http://")!=-1){if(Ext.os.is.Desktop){window.open(b.mediaObject.url)}else{if(!b.mp4FirstPlay){window.open(b.mediaObject.url);b.mp4FirstPlay=true}}}};d="video.aspx?guid="+b.fileGuid;b.setHtml("<iframe allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' src='"+d+"' width='100%' height='100%' frameborder='0' scrolling='no' />");b.element.down("iframe").dom.onload=function(){if(this.contentDocument!=null){this.contentDocument.getElementsByTagName("video")[0].onclick=openLink;this.contentDocument.getElementsByTagName("video")[0].addEventListener("touchstart",openLink)}b.video=this.contentDocument.getElementsByTagName("video")[0];if(Ext.os.is.Desktop){if(b.mediaObject.autoPlay=="true"&&b.mediaObject.appear!="TRIGGER"){b.fireEvent("checkActivePageVideo",b)}}};videoplay=function(){b.videoPlayListener()}},videoPlayListener:function(){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.tracking!=null){var c=a.data.items[0].raw.tracking.trackingType;if(c=="GA"){ga("set","page","/"+b.mediaObject.page);ga("send",{hitType:"pageview",title:publicationName+" - "+editionName});ga("send","event","MP4","play",b.mediaObject.name,b.mediaObject.page)}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})},createCustomControls:function(){var a=this;a.videoControls=Ext.create("InfinityMobile.view.ReaderVideoObjectControls",{video:a.video});a.add(a.videoControls)},setVideoListeners:function(){var a=this;$(a.video).on("loadedmetadata",function(){a.fireEvent("videoloaded",a)});$(a.video).on("timeupdate",function(){a.fireEvent("timeupdated",a)})},playVideo:function(){var a=this;switch(a.videoType){case"youtube":a.ytplayer.playVideo();break;case"vimeo":break;case"mp4":a.video.play();break}}},0,["readervideo"],["component","container","readermediaobject","readervideo"],{component:true,container:true,readermediaobject:true,readervideo:true},["widget.readervideo"],0,[InfinityMobile.view,"ReaderVideoObject"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderVideoObjectControls",Ext.Container,{config:{cls:"readercontrols",layout:{type:"hbox",align:"center"},bottom:-20,style:"background-color:rgba(0, 0, 0, 0.5)",padding:7,width:"100%",height:40,html:"<div class='playbutton play'></div><div class='togglebox'><div class='currentTime'>0:00</div><div class='timeBar'></div><div class='totalTime'>0:00</div></div><div class='fullscreenbutton'></div>"},initialize:function(){var a=this;a.video=a.config.video;a.playButton=a.element.down(".playbutton");a.togglebox=a.element.down(".togglebox");a.fullscreenButton=a.element.down(".fullscreenbutton");a.currentTime=a.element.down(".currentTime");a.totalTime=a.element.down(".totalTime");a.setPlayListener();a.fullscreenButtonListener()},setPlayListener:function(){var a=this;a.playButton.on("tap",function(){a.fireEvent("videoplay",a,this,a.video)})},fullscreenButtonListener:function(){var a=this;a.fullscreenButton.on("tap",function(){a.fireEvent("videofullscreen",a,a.video)})}},0,["readervideocontrols"],["component","container","readervideocontrols"],{component:true,container:true,readervideocontrols:true},["widget.readervideocontrols"],0,[InfinityMobile.view,"ReaderVideoObjectControls"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageObject",InfinityMobile.view.ReaderMediaObject,{config:{mediaObject:"",cls:"backgroundImage",items:[{itemId:"closeBtn",right:0,top:0,height:25,style:"background-color:#e1e1e1",html:"<div style='margin-right:28px; margin-left:5px; padding-top:5px; font-size:12px'>Close</div>",items:[{top:2,right:5,width:20,height:20,cls:"backImage",style:'background-image:url("../assets/article view/article-close-btn.png")'}]}]},initialize:function(){var a=this;InfinityMobile.view.ReaderMediaObject.prototype.initialize.apply(this,arguments);a.setImage();a.setLinks();if(Ext.os.is.Desktop){a.checkUrl()}a.closeBtn=a.getComponent("closeBtn");if(Ext.os.is.Desktop){if(a.config.leftSideOverflow!=null){if(a.config.leftSideOverflow){a.mediaObject.x=100+a.mediaObject.x;a.setMediaObjectStyle()}}}a.closeBtn.element.on({tap:function(c){c.stopPropagation();var b=this;if(b.mediaObject.remove=="CLOSEBTN"){b.removeAnim()}else{b.hide()}},scope:a});if(a.mediaObject.remove!="CLOSEBTN"){a.closeBtn.hide()}},setImage:function(){var b=this;b.fileGuid=b.mediaObject.file;if(b.fileGuid!=null){var c=b.fileGuid.substr(0,1);var a=b.fileGuid.substr(1,1);var d=".jpg";if(b.mediaObject.fileType!=null){switch(b.mediaObject.fileType){case"image/gif":d=".gif";break;case"image/png":d=".png";break;default:break}}b.imageurl="http://pages.cdn.pagesuite.com/media/"+c+"/"+a+"/"+b.fileGuid+d;b.setHtml("<div class='backImage' style='width:100%;height:100%;background:url("+b.imageurl+")'></div>")}},setLinks:function(){var a=this;a.imageClickUrl=a.mediaObject.url;if(a.imageClickUrl!=null&&a.imageClickUrl!=""&&a.imageClickUrl!="NONE"&&a.imageClickUrl!="http://"&&a.mediaObject.isTrigger=="false"){a.element.on("tap",function(b){window.open(a.imageClickUrl)})}},setFullScreenButtonListener:function(){var a=this;a.fullscreenButton.element.on("tap",function(){a.fireEvent("fullscreenImage",a);var b=Ext.getStore("SettingStore");if(b.data.items[0].raw.tracking!=null){var c=b.data.items[0].raw.tracking.trackingType;if(c=="GA"){ga("send","pageview")}else{$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackOmniture.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})}}$.ajax({crossDomain:true,type:"POST",contentType:"application/json; charset=utf-8",async:true,data:"pageview",url:"../trackPageSuite.aspx?pubid="+publicationguid+"&device="+device+"&width="+width+"&height="+height+"&landscapeWidth="+landscapeWidth+"&landscapeHeight="+landscapeHeight})})},checkUrl:function(){var a=this;if(a.mediaObject.description!=null){if(a.mediaObject.description.length>0&&a.mediaObject.description!="NONE"){a.addCls("pointerCursor");a.element.dom.onmouseenter=function(){a.fireEvent("setupArticleTooltip",a.mediaObject.description)};a.element.dom.onmouseleave=function(){a.fireEvent("hideArticleTooltip",a)};a.element.dom.onmousemove=function(b){a.fireEvent("updateArticleTooltipPosition",b)}}else{if(a.mediaObject.url!=null&&a.mediaObject.isTrigger=="false"){if(a.mediaObject.url.length>0&&a.mediaObject.url!="NONE"){a.addCls("pointerCursor");a.element.dom.onmouseenter=function(){a.fireEvent("setupArticleTooltip",a.mediaObject.url)};a.element.dom.onmouseleave=function(){a.fireEvent("hideArticleTooltip",a)};a.element.dom.onmousemove=function(b){a.fireEvent("updateArticleTooltipPosition",b)}}}}}else{if(a.mediaObject.url!=null){if(a.mediaObject.url.length>0&&a.mediaObject.url!="NONE"){a.addCls("pointerCursor");a.element.dom.onmouseenter=function(){a.fireEvent("setupArticleTooltip",a.mediaObject.url)};a.element.dom.onmouseleave=function(){a.fireEvent("hideArticleTooltip",a)};a.element.dom.onmousemove=function(b){a.fireEvent("updateArticleTooltipPosition",b)}}}}}},0,["readerimage"],["component","container","readermediaobject","readerimage"],{component:true,container:true,readermediaobject:true,readerimage:true},["widget.readerimage"],0,[InfinityMobile.view,"ReaderImageObject"],0));(Ext.cmd.derive("InfinityMobile.view.PageRestriction",Ext.Container,{config:{style:"background-color:#FFFFFF;border: 2px solid black;border-radius:5px;",width:"500px",height:"wrap",fullscreen:true,modal:true,centered:true,hideOnMaskTap:true,items:[{itemId:"title",items:[{id:"Close",cls:"pointerCursor",top:4,right:4,html:"<img src='../assets/article view/article-close-btn.png' onclick='parent.onClose()' ontouchstart='parent.onClose()' style='width:24px; height:24px' />"}]},{itemId:"image",style:"text-align:center"},{itemId:"textArea"},{itemId:"BtnArea",style:"width:100%;",padding:10,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"register",cls:"pointerCursor",style:"padding:5px 10px;text-align:center;"}]}]},initialize:function(){var b=this;var e=b.getComponent("title");var d=b.getComponent("textArea");var a=b.getComponent("BtnArea");b.image=b.getComponent("image");var c=e.getComponent("Close");if(Ext.os.is.Phone){b.setWidth("90%")}b.btn=a.getComponent("register");b.btn.setHtml(language.register);if(settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.logo!=null){if(settings.subscription.pageRestriction.logo.length>0){b.image.setHtml('<img style="max-width:100%" src="'+settings.subscription.pageRestriction.logo+'" />');b.image.setPadding(20)}}if(settings.subscription.pageRestriction.title!=null){e.setHtml("<div style='padding:5px;border-top-left-radius:5px;border-top-right-radius:5px;' >"+settings.subscription.pageRestriction.title+"</div>")}else{e.setHtml("<div style='padding:5px;border-top-left-radius:5px;border-top-right-radius:5px;' >Please Subscribe</div>")}e.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});if(settings.subscription.pageRestriction.desc!=null){d.setHtml("<div style'padding:10px;'><p style='padding:10px;text-align:center;font-size:10pt;padding-bottom:10px;'>"+settings.subscription.pageRestriction.desc+"</p></div>")}else{d.setHtml("<div style'padding:10px;'><p style='padding:10px;text-align:center;font-size:10pt;padding-bottom:10px;'>Register now to gain access to the full digital edition! You'll be able to continue browsing through all of the pages of the magazine, and access all of the digital content.</p></div>")}d.element.on({scope:d,delegate:"a",tap:function(f){if(!Ext.os.is.Desktop){if(Ext.browser.is.Safari){window.location.href=f.target}}}})}register=function(){if(settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.redirectUrl!=null){window.open(settings.subscription.pageRestriction.redirectUrl,"_blank")}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}};b.btn.element.on("tap",register);b.btn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});onClose=function(f){b.hide()}}},0,["pagerestriction"],["component","container","pagerestriction"],{component:true,container:true,pagerestriction:true},["widget.pagerestriction"],0,[InfinityMobile.view,"PageRestriction"],0));(Ext.cmd.derive("InfinityMobile.view.FullscreenPrompt",Ext.Container,{config:{style:"background-color:#FFFFFF;border: 2px solid black;border-radius:5px;",width:"500px",height:"wrap",fullscreen:true,modal:true,centered:true,hideOnMaskTap:true,items:[{itemId:"title",items:[{id:"Close",cls:"pointerCursor",top:4,right:4,html:"<img src='../assets/article view/article-close-btn.png' onclick='parent.onClose()' ontouchstart='parent.onClose()' style='width:24px; height:24px' />"}]},{itemId:"textArea"},{itemId:"BtnArea",style:"width:100%;",padding:10,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"yesbtn",cls:"pointerCursor",style:"padding:5px 10px;text-align:center;"},{itemId:"nobtn",cls:"pointerCursor",style:"padding:5px 10px;text-align:center;"}]}]},initialize:function(){var b=this;var e=b.getComponent("title");var d=b.getComponent("textArea");var a=b.getComponent("BtnArea");b.image=b.getComponent("image");var c=e.getComponent("Close");if(Ext.os.is.Phone){b.setWidth("90%")}b.ybtn=a.getComponent("yesbtn");b.nbtn=a.getComponent("nobtn");b.ybtn.setHtml(language.yes);b.nbtn.setHtml(language.no);if(settings.fullscreenPrompt!=null){if(settings.fullscreenPrompt.title!=null){e.setHtml("<div style='padding:5px;border-top-left-radius:5px;border-top-right-radius:5px;' >"+settings.fullscreenPrompt.title+"</div>")}else{e.setHtml("<div style='padding:5px;border-top-left-radius:5px;border-top-right-radius:5px;' >Fullscreen Mode</div>")}e.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});if(settings.fullscreenPrompt.message!=null){d.setHtml("<div style'padding:10px;'><p style='padding:10px;text-align:center;font-size:10pt;padding-bottom:10px;'>"+settings.fullscreenPrompt.message+"</p></div>")}else{d.setHtml("<div style'padding:10px;'><p style='padding:10px;text-align:center;font-size:10pt;padding-bottom:10px;'>Would you like to start in fullscreen mode?</p></div>")}d.element.on({scope:d,delegate:"a",tap:function(f){if(!Ext.os.is.Desktop){if(Ext.browser.is.Safari){window.location.href=f.target}}}})}register=function(){if(settings.subscription.pageRestriction!=null){if(settings.subscription.pageRestriction.redirectUrl!=null){window.open(settings.subscription.pageRestriction.redirectUrl,"_blank")}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}}else{window.open("http://subscriber.pagesuite-professional.co.uk/subscribe.aspx?source=4&eid="+editionguid,"_blank")}};b.ybtn.element.on("tap",function(){console.log("rawr");b.fireEvent("launchfullscreen");console.log("oooh");b.hide()});b.nbtn.element.on("tap",function(){b.hide()});b.ybtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)",marginRight:"10px"});b.nbtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)",marginLeft:"10px"});onClose=function(f){b.hide()}}},0,["fullscreenprompt"],["component","container","fullscreenprompt"],{component:true,container:true,fullscreenprompt:true},["widget.fullscreenprompt"],0,[InfinityMobile.view,"FullscreenPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArchiveMonthItem",Ext.Container,{config:{padding:10,style:"border-bottom:1px solid black"},initialize:function(){var b=this;if(b.config.month!=null){b.month=b.config.month;b.monthDirection=b.config.monthDirection;var a=b.month;if(b.monthDirection=="horizontal"){a=b.setUpHorizontal(a)}else{a=b.setUpVertical(a)}b.setHtml(a);b.element.on({tap:"onTap",scope:b})}},setUpHorizontal:function(b){var e=this;var a=b.split(" ")[0];a=e.checkTranslation(a);var c=b.split(" ")[1];var d=a.substring(0,3);b=d+" - "+c;e.setWidth(100);return b},setUpVertical:function(b){var d=this;var a=b.split(" ")[0];var c=b.split(" ")[1];a=d.checkTranslation(a);monthString=a+" "+c;return monthString},onTap:function(){var a=this;a.fireEvent("changeMonth",a)},checkTranslation:function(a){var b=this;if(language.months!=null&&language.months[a.toLowerCase()]!=null){a=language.months[a.toLowerCase()]}return a}},0,["archiveMonthItem"],["component","container","archiveMonthItem"],{component:true,container:true,archiveMonthItem:true},["widget.archiveMonthItem"],0,[InfinityMobile.view,"ReaderArchiveMonthItem"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderTopBarBtn",Ext.Container,{config:{cls:"toolbar"},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.imageUrl!=null){a.imageUrl=a.config.imageUrl}if(a.config.type!=null){a.type=a.config.type}if(a.config.action!=null){a.action=a.config.action}if(a.config.tooltipText!=null){a.tooltipText=a.config.tooltipText}if(a.type=="btn"){a.setStyle("background-position:50% 50%;background-repeat:no-repeat;background-size:contain;cursor:pointer;")}else{if(a.type=="logo"){a.setStyle("background-position:0% 50%;background-repeat:no-repeat;background-size:contain;cursor:pointer;")}}a.element.dom.style.backgroundImage="url('"+a.imageUrl+"')";a.element.on({tap:function(b){b.stopPropagation();a.fireEvent(a.action,a)}});if(a.tooltipText!=null){}},tooltipRight:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX+15)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})},tooltipLeft:function(){var a=this;a.element.dom.onmousemove=(function(b){a.getComponent("tooltip").element.dom.style.webkitTransform="translate3d("+(b.offsetX-50)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.MozTransform="translate3d("+(b.offsetX-50)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)";a.getComponent("tooltip").element.dom.style.msTransform="translate3d("+(b.offsetX-50)+"px, "+(b.offsetY-5)+"px, 0) scale3d("+1+","+1+",1)"})}},0,["articlereadertopbarbtn"],["component","container","articlereadertopbarbtn"],{component:true,container:true,articlereadertopbarbtn:true},["widget.articlereadertopbarbtn"],0,[InfinityMobile.view,"ArticleReaderTopBarBtn"],0));(Ext.cmd.derive("InfinityMobile.view.BookmarkItem",Ext.Container,{config:{style:"float:left;",layout:"vbox",cls:"pointerCursor",items:[{maxHeight:250,style:"overflow:hidden",itemId:"bookmarkImage",html:"<img style='width:100%' />"},{itemId:"bookmarkText",cls:"thumbInfo",bottom:0,padding:5,width:"100%",style:"background-color:rgba(0, 0, 0, 0.5); color:white",html:"Page -1"},{itemId:"bookmarkDelete",top:5,right:5,width:30,height:30,padding:5,style:"background-color:rgba(0, 0, 0, 0.5); color:white",html:"<img style='width:20px; height:20px' src='../assets/article view/article-close-btn.png' />"}]},initialize:function(){var a=this;if(a.config.bookmarkItem!=null){a.bookmarkItem=a.config.bookmarkItem;a.loadBookmark();a.setPageDelete();a.setPageClick()}},loadBookmark:function(){var b=this;b.bookmarkImageContainer=b.getComponent("bookmarkImage");b.bookmarkImage=b.bookmarkImageContainer.element.down("img").dom;var a="";if(typeof latestLM!="undefined"){a="&lm="+latestLM}b.bookmarkImage.src="https://edition.pagesuite-professional.co.uk/get_image.aspx?w=280&eid="+editionguid+"&pnum="+(b.bookmarkItem.pageNumber)+a;b.bookmarkTextContainer=b.getComponent("bookmarkText");b.bookmarkTextContainer.setHtml(b.bookmarkItem.name)},setPageDelete:function(){var a=this;a.bookmarkDelete=a.getComponent("bookmarkDelete");a.bookmarkDelete.element.on("tap",function(b){b.stopPropagation();a.fireEvent("deleteBookmark",a)})},setPageClick:function(){var a=this;a.element.on("tap",function(){a.fireEvent("loadPage",a)})}},0,["bookmarkitem"],["component","container","bookmarkitem"],{component:true,container:true,bookmarkitem:true},["widget.bookmarkitem"],0,[InfinityMobile.view,"BookmarkItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMenuShareItem",Ext.Container,{config:{cls:"readermenushareitem shareItems pointerCursor",style:"float:left"},initialize:function(){var b=this;b.message="";if(b.config.pnum!=null){b.pnum=b.config.pnum}var a=window.location.href.substring(0,window.location.href.indexOf("?"));if(b.pnum!=null){b.url=encodeURIComponent(a+"?pnum="+b.pnum+"&edid="+editionguid)}else{b.url=encodeURIComponent(a+"?edid="+editionguid)}if(b.config.message!=null){b.message=b.config.message}if(b.config.url!=null){b.url=b.config.url}if(b.config.icon!=null){b.icon=b.config.icon;b.loadIcon()}b.type="";if(b.config.type!=null){b.type=b.config.type}if(b.config.link!=null){b.link=b.config.link;b.setLink()}if(b.config.menu!=null){b.menu=b.config.menu}if(b.config.toolbar!=null){b.toolbar=b.config.toolbar}if(settings.newsday!=null){if(settings.newsday.useFontAwesome=="true"){if(b.menu!=null){switch(b.type){case"email":b.setHtml('<i class="fa fa-envelope fa-lg pointerCursor" aria-hidden="true"></i>');break;case"facebook":b.setHtml('<i class="fa fa-facebook-official fa-lg pointerCursor" aria-hidden="true"></i>');break;case"twitter":b.setHtml('<i class="fa fa-twitter fa-lg pointerCursor" aria-hidden="true"></i>');break;case"googlePlus":b.setHtml('<i class="fa fa-google-plus fa-lg pointerCursor" aria-hidden="true"></i>');break;case"pinterest":b.setHtml('<i class="fa fa-pinterest fa-lg pointerCursor" aria-hidden="true"></i>')}}if(b.toolbar!=null){b.setStyle({backgroundColor:"transparent"});switch(b.type){case"email":b.setHtml('<i class="fa fa-envelope fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break;case"facebook":b.setHtml('<i class="fa fa-facebook-official fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break;case"twitter":b.setHtml('<i class="fa fa-twitter fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break;case"googlePlus":b.setHtml('<i class="fa fa-google-plus fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break;case"pinterest":b.setHtml('<i class="fa fa-pinterest fa-lg pointerCursor" aria-hidden="true" style="color:white;margin:8px;" ></i>');break}}}}},loadIcon:function(){var a=this;a.setHtml("<img src='"+a.icon+"' style='width:100%; height:auto;' />")},setLink:function(){var a=this;a.element.on("tap",function(d){d.stopPropagation();var c=a.link.replace("{0}",a.url).replace("{1}",a.message);c=c.replace("message=","body=");c=c.replace(/&apos;/g,"'");if(settings.tracking!=null&&settings.tracking.trackingType=="DA"){trackDaEvent("Share via "+a.type,"Social")}if(c.indexOf("mailto:")!=-1){window.location.href=c;if(typeof trackReaderEvent!="undefined"){var f={pageNum:a.pnum,description:a.message,socialType:a.type,shareType:a.config.isArticle?"article":"edition"};if(a.config.articleItem!=null){var b=a.config.articleItem;f.articleGuid=b.config.page.file;f.headline=b.config.page.description;f.author=b.config.page.byline;f.articleNumber=b.config.pageNo;f.pageNum=b.config.page.page}trackReaderEvent("email",f)}}else{window.open(c);if(typeof trackReaderEvent!="undefined"){if(c.indexOf("facebook")!=-1){a.type="facebook"}else{if(c.indexOf("twitter")!=-1){a.type="twitter"}else{if(c.indexOf("google")!=-1){a.type="google+"}else{if(c.indexOf("linkedin")!=-1){a.type="linkedin"}else{if(c.indexOf("pinterest")!=-1){a.type="pinterest"}}}}}var f={pageNum:a.pnum,description:a.message,socialType:a.type};f.shareType=a.config.isArticle?"article":"edition";if(a.config.articleItem!=null){var b=a.config.articleItem;f.articleGuid=b.config.page.file;f.headline=b.config.page.description;f.author=b.config.page.byline;f.articleNumber=b.config.pageNo;f.pageNum=b.config.page.page}trackReaderEvent("social",f)}}})},updateMessage:function(b){var a=this;a.message=b},updateUrl:function(a){var b=this;b.url=a}},0,["readermenushareitem"],["component","container","readermenushareitem"],{component:true,container:true,readermenushareitem:true},["widget.readermenushareitem"],0,[InfinityMobile.view,"ReaderMenuShareItem"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingArea",Ext.Panel,{config:{fullscreen:true,zIndex:999999,style:"position:absolute;top:-100%;display:inline-block;",items:[{itemId:"backgroundTop",html:"<div style='position:relative;width:"+$(document).width()*2+"px;height:"+$(document).height()+"px;background-color:rgba(0, 0, 0, 0.5)'></div>"},{itemId:"clipArea",layout:{type:"hbox",align:"stretch"},height:"auto",width:"200%",items:[{itemId:"clipBox",html:'<div class="clipper" style="display:none;position:relative;top:0px;width:30px;overflow:auto;height:30px;border:4px solid rgb(69, 143, 187);"><div class="ui-resizable-handle ui-resizable-se se-handle" ></div></div>'},{itemId:"backgroundRight",flex:1,style:"background-color:rgba(0, 0, 0, 0.5)"}]},{itemId:"backgroundBottom",html:"<div style='position:relative;width:"+$(document).width()*2+"px;height:"+$(document).height()*2+"px;background-color:rgba(0, 0, 0, 0.5)'></div>",items:[{itemId:"controlPanel",width:150,height:50,style:{backgroundColor:"rgba(0,0,0,0.7)",borderRadius:"5px",position:"absolute",margin:"5px 0px 5px 0px",zIndex:"999"},hidden:true,layout:"hbox",items:[{itemId:"cancel",width:50,height:50,style:{backgroundImage:'url("resources/images/reader icons/close-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}},{itemId:"reset",height:50,width:50,style:{backgroundImage:'url("resources/images/reader icons/refresh-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}},{itemId:"confirm",height:50,width:50,style:{backgroundImage:'url("resources/images/reader icons/tick-white.png")',backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"5px",zIndex:"10000"}}]}]},{itemId:"backgroundLeft",html:"<div style='position:absolute;left:-200%;top:0%;width:"+$(document).width()*2+"px;height:"+$(document).height()*3+"px;background-color:rgba(0, 0, 0, 0.5)'></div>"}]},initialize:function(){var b=this;var a=b.getComponent("clipArea");b.clipBox=a.getComponent("clipBox");b.leftBackground=b.getComponent("backgroundLeft").element.down("div").down("div").down("div");b.top=b.getComponent("backgroundTop").element.down("div").down("div").down("div");b.left=b.getComponent("backgroundLeft").element.down("div").down("div").down("div");b.bottom=b.getComponent("backgroundBottom").element.down("div").down("div").down("div");b.origDocH=$(document).height();b.origDocW=$(document).width();b.controlPanel=b.getComponent("backgroundBottom").getComponent("controlPanel");b.cancel=b.controlPanel.getComponent("cancel");b.reset=b.controlPanel.getComponent("reset");b.confirm=b.controlPanel.getComponent("confirm");b.confirm.element.on({tap:b.keyPress,scope:b});b.confirm.addCls("pointerCursor");b.cancel.element.on({tap:b.selfDestruct,scope:b});b.cancel.addCls("pointerCursor");b.reset.element.on({tap:b.resize,scope:b});b.reset.addCls("pointerCursor");if(b.config.reader!=null){b.reader=b.config.reader}if(b.config.readerActiveItem!=null){b.readerActiveItem=b.config.readerActiveItem}b.element.on({dragstart:function(c){c.stopPropagation()},drag:function(c){c.stopPropagation()},dragend:function(c){c.stopPropagation()}});window.onkeypress=function(c){if(c.keyCode==13){b.keyPress()}else{if(c.keyCode==0||c.keyCode==32){b.selfDestruct()}}};b.clipperDrawn=false;b.element.dom.onmousedown=function(c){b.mouseDown(c)};b.element.dom.onmouseup=function(c){b.mouseUp(c)};b.element.dom.addEventListener("touchstart",function(c){b.mouseDownTouch(c)});b.element.dom.addEventListener("touchend",function(c){b.mouseUp(c)});b.draggableHandle=b.element.down(".ui-resizable-handle");b.draggableHandle.dom.addEventListener("touchstart",function(c){c.stopPropagation();var l=c.changedTouches[0].clientX;var j=c.changedTouches[0].clientY;var d=$(".clipper").width();var k=$(".clipper").height();var e="";switch(b.getPrefix().css){case"-webkit-":e=b.element.dom.style.webkitTransform;break;case"-ms-":e=b.element.dom.style.msTransform;break;default:e=b.element.dom.style.transform;break}var h=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var g=h[0].substring(0,h[0].indexOf("p"));var f=h[1].substring(0,h[1].indexOf("p"));b.move=function(r){r.stopPropagation();r.preventDefault();if(r.changedTouches[0].clientX>parseFloat(g)){var m=d+r.changedTouches[0].clientX-l;var q=g}else{var q=r.changedTouches[0].clientX;var m=parseFloat(g)-r.changedTouches[0].clientX}if(r.changedTouches[0].clientY>parseFloat(f)){var o=k+r.changedTouches[0].clientY-j;var p=f}else{var p=r.changedTouches[0].clientY;var o=parseFloat(f)-r.changedTouches[0].clientY}b.element.dom.style.transform="translate3d("+q+"px, "+(p)+"px, 0px)";b.element.dom.style.webkitTransform="translate3d("+q+"px, "+(p)+"px, 0px)";b.element.dom.style.mozTransform="translate3d("+q+"px, "+(p)+"px, 0px)";b.element.dom.style.msTransform="translate3d("+q+"px, "+(p)+"px, 0px)";$(".clipper").css("height",o);$(".clipper").css("width",m);if(Ext.browser.is.Chrome){if(b.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-p-50)){if(m-$(b.controlPanel.element.dom).width()>=0){$(b.controlPanel.element.dom).css("transform","translate3d("+(m-($(b.controlPanel.element.dom).width()+$(b.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-p-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translate3d("+(m-($(b.controlPanel.element.dom).width()+$(b.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-p-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-moz-transform","translate3d("+(m-($(b.controlPanel.element.dom).width()+$(b.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-p-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-ms-transform","translate3d("+(m-($(b.controlPanel.element.dom).width()+$(b.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-p-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(b.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-p-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-p-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-p-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-p-$(b.controlPanel.element.dom).height()-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if(m-$(b.controlPanel.element.dom).width()>=0){$(b.controlPanel.element.dom).css("transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)")}else{$(b.controlPanel.element.dom).css("transform","translateX(0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}else{var n=b.controlPanel.element.dom.getBoundingClientRect().top;var s=$(window).height()-50;if(n>=s){$(b.controlPanel.element.dom).css("-moz-transform","translate3d(0px,-50px,0px)");$(b.controlPanel.element.dom).css("-ms-transform","translate3d(0px,-50px,0px)");$(b.controlPanel.element.dom).css("transform","translate3d(0px,-50px,0px)")}else{if(m-$(b.controlPanel.element.dom).width()>=0){$(b.controlPanel.element.dom).css("transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)")}else{$(b.controlPanel.element.dom).css("transform","translateX(0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}};document.addEventListener("touchmove",b.move)});b.draggableHandle.dom.addEventListener("touchend",function(c){document.removeEventListener("touchstart",null)});b.draggableHandle.dom.onmousedown=function(c){c.stopPropagation();var l=c.clientX;var j=c.clientY;var d=$(".clipper").width();var k=$(".clipper").height();var e="";switch(b.getPrefix().css){case"-webkit-":e=b.element.dom.style.webkitTransform;break;case"-ms-":e=b.element.dom.style.msTransform;break;default:e=b.element.dom.style.transform;break}var h=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var g=h[0].substring(0,h[0].indexOf("p"));var f=h[1].substring(0,h[1].indexOf("p"));document.onmousemove=function(r){r.stopPropagation();if(r.clientX>parseFloat(g)){var m=d+r.clientX-l;var q=g}else{var q=r.clientX;var m=parseFloat(g)-r.clientX}if(r.clientY>parseFloat(f)){var o=k+r.clientY-j;var p=f}else{var p=r.clientY;var o=parseFloat(f)-r.clientY}b.element.dom.style.transform="translate3d("+q+"px, "+(p)+"px, 0px)";b.element.dom.style.webkitTransform="translate3d("+q+"px, "+(p)+"px, 0px)";b.element.dom.style.mozTransform="translate3d("+q+"px, "+(p)+"px, 0px)";b.element.dom.style.msTransform="translate3d("+q+"px, "+(p)+"px, 0px)";$(".clipper").css("height",o);$(".clipper").css("width",m);if(Ext.browser.is.Chrome){if(b.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-p-50)){if(m-150>=0){$(b.controlPanel.element.dom).css("transform","translate3d("+(m-180)+"px, "+(($(document).height()*2)-p-50-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translate3d("+(m-180)+"px, "+(($(document).height()*2)-p-50-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-moz-transform","translate3d("+(m-180)+"px, "+(($(document).height()*2)-p-50-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-ms-transform","translate3d("+(m-180)+"px, "+(($(document).height()*2)-p-50-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(b.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-p-50-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-p-50-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-p-50-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(b.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-p-50-b.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if(m-150>=0){$(b.controlPanel.element.dom).css("transform","translateX("+(m-150)+"px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX("+(m-150)+"px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX("+(m-150)+"px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX("+(m-150)+"px)")}else{$(b.controlPanel.element.dom).css("transform","translateX(0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}else{var n=b.controlPanel.element.dom.getBoundingClientRect().top;var s=$(window).height()-50;if(n>=s){$(b.controlPanel.element.dom).css("-moz-transform","translate3d(0px,-50px,0px)");$(b.controlPanel.element.dom).css("-ms-transform","translate3d(0px,-50px,0px)");$(b.controlPanel.element.dom).css("transform","translate3d(0px,-50px,0px)")}else{if(m-$(b.controlPanel.element.dom).width()>=0){$(b.controlPanel.element.dom).css("transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX("+(m-$(b.controlPanel.element.dom).width())+"px)")}else{$(b.controlPanel.element.dom).css("transform","translateX(0px)");$(b.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(b.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}}};b.draggableHandle.dom.onmouseup=function(c){document.onmousemove=null};b.element.on("painted",function(){b.top.dom.style.width=($(document).width()*2)+"px";b.top.dom.style.height=$(document).height()+"px";b.left.dom.style.width=($("#ext-viewport")[0].getBoundingClientRect().width*2)+"px";b.left.dom.style.height=($(document).height()*3)+"px";b.bottom.dom.style.width=($(document).width()*2)+"px";b.bottom.dom.style.height=$(document).height()+"px";b.setStyle("");b.setStyle("position:absolute;top:-"+$(document).height()+"px;")})},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}},bannerAdCheck:function(){var b=this;var a=Ext.getStore("SettingStore");if(a.data.items[0].raw.reader.bannerAd!=null){b.element.dom.style.top="calc(-100% - 110px)"}},fillCheck:function(){var b=this;if(b.readerActiveItem.zoomMode=="fill"){var a=($(b.reader.element.dom).height()/b.readerActiveItem.height)*100;b.element.dom.style.top="calc(-"+a+"% + "+b.readerActiveItem.scroller.position.y+"px)"}},zoomCheck:function(){var b=this;if($("#slider").val()>1){var a=($(b.reader.element.dom).height()/(b.readerActiveItem.height*$("#slider").val()))*100;b.element.dom.style.top="calc(-"+a+"% + "+b.readerActiveItem.scroller.position.y+"px)";b.element.dom.style.left=b.readerActiveItem.scroller.position.x+"px";b.leftBackground.dom.style.left="-"+(($("#ext-viewport")[0].getBoundingClientRect().width*2))+"px"}},keyPress:function(){var a=this;var e="";switch(a.getPrefix().css){case"-webkit-":e=a.element.dom.style.webkitTransform;break;case"-ms-":e=a.element.dom.style.msTransform;break;default:e=a.element.dom.style.transform;break}var d=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",");var c=d[0].substring(0,d[0].indexOf("p"));var b=d[1].substring(0,d[1].indexOf("p"));if(Ext.os.is.Desktop){if(settings.newsday!=null){if(settings.newsday.extraTopBar=="true"){var f=InfinityMobile.app.getController("ClippingController").getExtratopbar();if(f!=null){f.setZIndex(2)}}}}a.fireEvent("createClip",c,b,a.readerActiveItem,a.clipBox,a)},mouseDownTouch:function(g){var d=this;g.preventDefault();if(!d.clipperDrawn){d.element.dom.style.transform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.webkitTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.mozTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";d.element.dom.style.msTransform="translate3d("+g.changedTouches[0].clientX+"px, "+(g.changedTouches[0].clientY)+"px, 0px)";$(".clipper").css("display","");d.controlPanel.show();var k=g.changedTouches[0].clientX;var j=g.changedTouches[0].clientY;d.clipperDrawn=true;d.move=function(q){q.stopPropagation();q.preventDefault();var p;var o;if(q.changedTouches[0].clientX>k){var l=q.changedTouches[0].clientX-k;var o=k}else{var l=k-q.changedTouches[0].clientX;var o=q.changedTouches[0].clientX}if(q.changedTouches[0].clientY>j){var n=q.changedTouches[0].clientY-j;var p=j}else{var n=j-q.changedTouches[0].clientY;var p=q.changedTouches[0].clientY}d.element.dom.style.transform="translate3d("+o+"px, "+(p)+"px, 0px)";d.element.dom.style.webkitTransform="translate3d("+o+"px, "+(p)+"px, 0px)";d.element.dom.style.mozTransform="translate3d("+o+"px, "+(p)+"px, 0px)";d.element.dom.style.msTransform="translate3d("+o+"px, "+(p)+"px, 0px)";$(".clipper").css("height",n);$(".clipper").css("width",l);if(Ext.browser.is.Chrome){if(d.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-p-50)){if(l-$(d.controlPanel.element.dom).width()>=0){$(d.controlPanel.element.dom).css("transform","translate3d("+(l-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-p-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translate3d("+(l-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-p-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-moz-transform","translate3d("+(l-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-p-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d("+(l-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-p-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(d.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-p-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-p-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-p-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-p-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if(l-$(d.controlPanel.element.dom).width()>=0){$(d.controlPanel.element.dom).css("transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)")}else{$(d.controlPanel.element.dom).css("transform","translateX(0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}else{var m=d.controlPanel.element.dom.getBoundingClientRect().top;var r=$(window).height()-50;if(m>=r){$(d.controlPanel.element.dom).css("-moz-transform","translate3d(0px,-50px,0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d(0px,-50px,0px)");$(d.controlPanel.element.dom).css("transform","translate3d(0px,-50px,0px)")}else{if(l-$(d.controlPanel.element.dom).width()>=0){$(d.controlPanel.element.dom).css("transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX("+(l-$(d.controlPanel.element.dom).width())+"px)")}else{$(d.controlPanel.element.dom).css("transform","translateX(0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}};document.addEventListener("touchmove",d.move)}else{var c="";switch(d.getPrefix().css){case"-webkit-":c=d.element.dom.style.webkitTransform;break;case"-ms-":c=d.element.dom.style.msTransform;break;default:c=d.element.dom.style.transform;break}var e=c.substring(c.indexOf("(")+1,c.indexOf(")")).split(",");var h=parseFloat(e[0].substring(0,e[0].indexOf("p")));var f=parseFloat(e[1].substring(0,e[1].indexOf("p")));var b=g.changedTouches[0].clientX;var a=g.changedTouches[0].clientY;d.move=function(n){n.preventDefault();var p=b-n.changedTouches[0].clientX;var o=a-n.changedTouches[0].clientY;var m=h-p;var l=f-o;if(m<0){m=0}if(l<0){l=0}if(m>$(document).width()-$(d.clipBox.element.dom).width()){m=$(document).width()-$(d.clipBox.element.dom).width()}if(l>$(document).height()-$(d.clipBox.element.dom).height()){l=$(document).height()-$(d.clipBox.element.dom).height()}d.element.dom.style.transform="translate3d("+m+"px, "+(l)+"px, 0px)";d.element.dom.style.webkitTransform="translate3d("+m+"px, "+(l)+"px, 0px)";d.element.dom.style.mozTransform="translate3d("+m+"px, "+(l)+"px, 0px)";d.element.dom.style.msTransform="translate3d("+m+"px, "+(l)+"px, 0px)";if(d.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-l-50)){if($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width()>=0){$(d.controlPanel.element.dom).css("transform","translate3d("+($(d.clipBox.element.dom).width()-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translate3d("+($(d.clipBox.element.dom).width()-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-moz-transform","translate3d("+($(d.clipBox.element.dom).width()-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d("+($(d.clipBox.element.dom).width()-($(d.controlPanel.element.dom).width()+$(d.confirm.element.dom).width()))+"px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(d.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(d.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-l-$(d.controlPanel.element.dom).height()-d.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if($(d.clipBox.element.dom).width()-150>=0){$(d.controlPanel.element.dom).css("transform","translateX("+($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX("+($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX("+($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width())+"px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX("+($(d.clipBox.element.dom).width()-$(d.controlPanel.element.dom).width())+"px)")}else{$(d.controlPanel.element.dom).css("transform","translateX(0px)");$(d.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(d.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}};document.addEventListener("touchmove",d.move)}},mouseDown:function(f){var e=this;if(!e.clipperDrawn){e.element.dom.style.transform="translate3d("+f.clientX+"px, "+(f.clientY)+"px, 0px)";e.element.dom.style.webkitTransform="translate3d("+f.clientX+"px, "+(f.clientY)+"px, 0px)";e.element.dom.style.mozTransform="translate3d("+f.clientX+"px, "+(f.clientY)+"px, 0px)";e.element.dom.style.msTransform="translate3d("+f.clientX+"px, "+(f.clientY)+"px, 0px)";$(".clipper").css("display","");var d=f.clientX;var c=f.clientY;e.clipperDrawn=true;e.controlPanel.show();document.onmousemove=function(o){o.stopPropagation();var n;var m;if(o.clientX>d){var j=o.clientX-d;var m=d}else{var j=d-o.clientX;var m=o.clientX}if(o.clientY>c){var l=o.clientY-c;var n=c}else{var l=c-o.clientY;var n=o.clientY}e.element.dom.style.transform="translate3d("+m+"px, "+(n)+"px, 0px)";e.element.dom.style.webkitTransform="translate3d("+m+"px, "+(n)+"px, 0px)";e.element.dom.style.mozTransform="translate3d("+m+"px, "+(n)+"px, 0px)";e.element.dom.style.msTransform="translate3d("+m+"px, "+(n)+"px, 0px)";$(".clipper").css("height",l);$(".clipper").css("width",j);if(Ext.browser.is.Chrome){if(e.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-n-50)){if(j-150>=0){$(e.controlPanel.element.dom).css("transform","translate3d("+(j-180)+"px, "+(($(document).height()*2)-n-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-webkit-transform","translate3d("+(j-180)+"px, "+(($(document).height()*2)-n-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-moz-transform","translate3d("+(j-180)+"px, "+(($(document).height()*2)-n-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-ms-transform","translate3d("+(j-180)+"px, "+(($(document).height()*2)-n-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(e.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-n-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-n-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-n-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-n-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if(j-150>=0){$(e.controlPanel.element.dom).css("transform","translateX("+(j-150)+"px)");$(e.controlPanel.element.dom).css("-webkit-transform","translateX("+(j-150)+"px)");$(e.controlPanel.element.dom).css("-moz-transform","translateX("+(j-150)+"px)");$(e.controlPanel.element.dom).css("-ms-transform","translateX("+(j-150)+"px)")}else{$(e.controlPanel.element.dom).css("transform","translateX(0px)");$(e.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(e.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(e.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}else{var k=e.controlPanel.element.dom.getBoundingClientRect().top;var p=$(window).height()-50;if(k>=p){$(e.controlPanel.element.dom).css("-moz-transform","translate3d(0px,-50px,0px)");$(e.controlPanel.element.dom).css("-ms-transform","translate3d(0px,-50px,0px)");$(e.controlPanel.element.dom).css("transform","translate3d(0px,-50px,0px)")}else{if($(e.clipBox.element.dom).width()-150>=0){$(e.controlPanel.element.dom).css("transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("-webkit-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("-moz-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("-ms-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)")}else{$(e.controlPanel.element.dom).css("transform","translateX(0px)");$(e.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(e.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(e.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}}}else{if(f.target.id!="se-handle"){console.log("move");var g="";switch(e.getPrefix().css){case"-webkit-":g=e.element.dom.style.webkitTransform;break;case"-ms-":g=e.element.dom.style.msTransform;break;default:g=e.element.dom.style.transform;break}var b=g.substring(g.indexOf("(")+1,g.indexOf(")")).split(",");var a=parseFloat(b[0].substring(0,b[0].indexOf("p")));var h=parseFloat(b[1].substring(0,b[1].indexOf("p")));document.onmousemove=function(m){var p=f.clientX-m.clientX;var n=f.clientY-m.clientY;var l=a-p;var j=h-n;if(l<0){l=0}if(j<0){j=0}if(l>$(document).width()-$(e.clipBox.element.dom).width()){l=$(document).width()-$(e.clipBox.element.dom).width()}if(j>$(window).height()-$(e.clipBox.element.dom).height()){j=$(window).height()-$(e.clipBox.element.dom).height()}$(e.element.dom).css("-webkit-transform","translate3d("+l+"px, "+(j)+"px, 0px)");$(e.element.dom).css("-moz-transform","translate3d("+l+"px, "+(j)+"px, 0px)");$(e.element.dom).css("-ms-transform","translate3d("+l+"px, "+(j)+"px, 0px)");$(e.element.dom).css("transform","translate3d("+l+"px, "+(j)+"px, 0px)");if(Ext.browser.is.Chrome){if(e.controlPanel.element.dom.offsetTop>=(($(document).height()*2)-j-50)){if($(e.clipBox.element.dom).width()-150>=0){$(e.controlPanel.element.dom).css("transform","translate3d("+($(e.clipBox.element.dom).width()-180)+"px, "+(($(document).height()*2)-j-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-webkit-transform","translate3d("+($(e.clipBox.element.dom).width()-180)+"px, "+(($(document).height()*2)-j-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-moz-transform","translate3d("+($(e.clipBox.element.dom).width()-180)+"px, "+(($(document).height()*2)-j-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-ms-transform","translate3d("+($(e.clipBox.element.dom).width()-180)+"px, "+(($(document).height()*2)-j-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}else{$(e.controlPanel.element.dom).css("transform","translate3d(0px, "+(($(document).height()*2)-j-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-webkit-transform","translate3d(0px, "+(($(document).height()*2)-j-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-moz-transform","translate3d(0px, "+(($(document).height()*2)-j-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)");$(e.controlPanel.element.dom).css("-ms-transform","translate3d(0px, "+(($(document).height()*2)-j-50-e.getComponent("backgroundBottom").element.dom.offsetTop)+"px, 0px)")}}else{if($(e.clipBox.element.dom).width()-150>=0){$(e.controlPanel.element.dom).css("transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("-webkit-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("-moz-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("-ms-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)")}else{$(e.controlPanel.element.dom).css("transform","translateX(0px)");$(e.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(e.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(e.controlPanel.element.dom).css("-ms-transform","translateX(0px)")}}}else{var k=e.clipBox.element.dom.getBoundingClientRect().top;var o=$(window).height()-$(e.clipBox.element.dom).height()-50;if(k>=o){$(e.controlPanel.element.dom).css("-webkit-transform","translate3d(0px,-50px,0px)");$(e.controlPanel.element.dom).css("-moz-transform","translate3d(0px,-50px,0px)");$(e.controlPanel.element.dom).css("-ms-transform","translate3d(0px,-50px,0px)");$(e.controlPanel.element.dom).css("transform","translate3d(0px,-50px,0px)")}else{if($(e.clipBox.element.dom).width()-150>=0){$(e.controlPanel.element.dom).css("-webkit-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("-moz-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("-ms-transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)");$(e.controlPanel.element.dom).css("transform","translateX("+($(e.clipBox.element.dom).width()-150)+"px)")}else{$(e.controlPanel.element.dom).css("-webkit-transform","translateX(0px)");$(e.controlPanel.element.dom).css("-moz-transform","translateX(0px)");$(e.controlPanel.element.dom).css("-ms-transform","translateX(0px)");$(e.controlPanel.element.dom).css("transform","translateX(0px)")}}}}}else{}}},mouseUp:function(b){var a=this;document.onmousemove=null;document.removeEventListener("touchmove",a.move)},selfDestruct:function(){var a=this;window.onkeypress=null;if(!Ext.os.is.Phone){a.fireEvent("enableArticlesContainer")}if(Ext.os.is.Desktop){if(settings.newsday!=null){if(settings.newsday.extraTopBar=="true"){var b=InfinityMobile.app.getController("ClippingController").getExtratopbar();if(b!=null){b.setZIndex(2)}}}}Ext.Viewport.remove(a);a.destroy()},resize:function(){var a=this;a.fireEvent("resetClippingArea",a)}},0,["clippingarea"],["component","container","panel","clippingarea"],{component:true,container:true,panel:true,clippingarea:true},["widget.clippingarea"],0,[InfinityMobile.view,"ClippingArea"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageGallery",Ext.Carousel,{config:{modal:true,fullscreen:true,centered:true,height:"100%",width:"100%",style:"background-color:black;",zIndex:20,items:[{itemId:"close",right:10,top:10,width:30,height:30,cls:"backgroundImage",style:"background-image:url('../assets/article view/article-close-btn.png');background-position:center;background-size:center;background-repeat:no-repeat;"}]},initialize:function(){var b=this;b.closeBtn=b.getComponent("close");if(b.config.images!=null){b.images=b.config.images}b.closeBtn.element.on({tap:function(){var d=this;d.destroy()},scope:b});for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ReaderImageGalleryItem",{image:b.images[a]});b.add(c)}if(b.images.length>1){b.toolbarHidden=false}else{b.toolbarHidden=true}b.setUpNavigator();b.element.on({tap:b.showNavigator,scope:b})},setUpNavigator:function(){var b=this;b.bottomToolbar=Ext.create("InfinityMobile.view.ReaderToolbarBottom",{itemId:"bottomtoolbar",bottom:0,width:"100%",height:190});b.add(b.bottomToolbar);if(b.toolbarHidden){b.bottomToolbar.element.dom.style.transform="translate3d(0px, 190px, 0px)"}else{b.bottomToolbar.element.dom.style.transform="translate3d(0px, 0px, 0px)"}b.bottomToolbar.scrollerContainer.setLayout({type:"hbox"});for(var a=0;a<b.images.length;a++){var c=Ext.create("InfinityMobile.view.ReaderImageGalleryThumb",{url:b.images[a].url,carousel:b,index:a});b.bottomToolbar.scrollerContainer.add(c)}b.bottomToolbar.scrollerContainer.element.on({drag:function(d){d.stopPropagation()},dragstart:function(d){d.stopPropagation()},dragend:function(d){d.stopPropagation()},scope:b});b.bottomToolbar.getComponent("toolbarClose").element.on({tap:function(){var d=this;if(d.toolbarHidden){d.toolbarHidden=false}else{d.toolbarHidden=true}},scope:b})},showNavigator:function(){var a=this;var b=a.getPrefix().css;if(a.toolbarHidden){if(a.bottomToolbar.isHidden()){a.bottomToolbar.show()}switch(b){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toolbarRaise { 0%{ -webkit-transform:translate3d(0px, 190px, 0px); } 100%{ -webkit-transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.webkitAnimation="toolbarRaise 0.3s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes toolbarRaise { 0%{ transform:translate3d(0px, 190px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.animation="toolbarRaise 0.3s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes toolbarRaise { 0%{ -moz-transform:translate3d(0px, 190px, 0px); } 100%{ -moz-transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.mozAnimation="toolbarRaise 0.3s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toolbarRaise { 0%{ -ms-transform:translate3d(0px, 190px, 0px); } 100%{ -ms-transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.msAnimation="toolbarRaise 0.3s forwards";default:document.styleSheets[0].insertRule("@keyframes toolbarRaise { 0%{ transform:translate3d(0px, 190px, 0px); } 100%{ transform:translate3d(0px, 0px, 0px); } }",0);a.bottomToolbar.element.dom.style.animation="toolbarRaise 0.3s forwards"}a.toolbarHidden=false}else{if(a.bottomToolbar.isHidden()){a.bottomToolbar.show()}switch(b){case"-webkit-":document.styleSheets[0].insertRule("@-webkit-keyframes toolbarHide { 0%{ -webkit-transform:translate3d(0px, 0px, 0px); } 100%{ -webkit-transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.webkitAnimation="toolbarHide 0.3s forwards";break;case"-moz-":if(Ext.os.is.Desktop){document.styleSheets[0].insertRule("@keyframes toolbarHide { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.animation="toolbarHide 0.3s forwards"}else{document.styleSheets[0].insertRule("@-moz-keyframes toolbarHide { 0%{ -moz-transform:translate3d(0px, 0px, 0px); } 100%{ -moz-transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.mozAnimation="toolbarHide 0.3s forwards"}break;case"-ms-":document.styleSheets[0].insertRule("@-ms-keyframes toolbarHide { 0%{ -ms-transform:translate3d(0px, 0px, 0px); } 100%{ -ms-transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.msAnimation="toolbarHide 0.3s forwards";default:document.styleSheets[0].insertRule("@keyframes toolbarHide { 0%{ transform:translate3d(0px, 0px, 0px); } 100%{ transform:translate3d(0px, 190px, 0px); } }",0);a.bottomToolbar.element.dom.style.animation="toolbarHide 0.3s forwards"}a.toolbarHidden=true}},getPrefix:function(){var a=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||(a.OLink===""&&["","o"]))[1];return{lowercase:pre,css:"-"+pre+"-",js:pre[0].toUpperCase()+pre.substr(1)}}},0,["readerimagegallery"],["component","container","carousel","readerimagegallery"],{component:true,container:true,carousel:true,readerimagegallery:true},["widget.readerimagegallery"],0,[InfinityMobile.view,"ReaderImageGallery"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageGalleryItem",Ext.Container,{config:{height:"100%",width:"100%",pageNo:0},initialize:function(){var a=this;if(a.config.image!=null){a.image=a.config.image}if(a.image!=null){a.image.url=a.image.url.replace(/ /g,"%20")}if(a.config.position!=null){a.position=a.config.position}a.setStyle({backgroundImage:"url("+a.image.url+")",backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat"})}},0,["readerimagegalleryitem"],["component","container","readerimagegalleryitem"],{component:true,container:true,readerimagegalleryitem:true},["widget.readerimagegalleryitem"],0,[InfinityMobile.view,"ReaderImageGalleryItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPuzzleArchiveItem",Ext.Container,{config:{layout:"vbox",items:[{itemId:"image",height:150},{itemId:"text",style:"text-align:center; font-size:18px; font-weight:bold"}]},initialize:function(){var a=this;a.imageContainer=a.getComponent("image");a.textContainer=a.getComponent("text");a.image=a.config.image;a.text=a.config.text;a.imageContainer.setHtml("<div class='backImage' style='height:100%;background:url("+a.image+")'></div>");a.textContainer.setHtml(a.text);a.setClickListener()},setClickListener:function(){var a=this;a.element.on("tap",function(){a.fireEvent("loadPuzzleItem",a)})}},0,["readerpuzzlearchiveitem"],["component","container","readerpuzzlearchiveitem"],{component:true,container:true,readerpuzzlearchiveitem:true},["widget.readerpuzzlearchiveitem"],0,[InfinityMobile.view,"ReaderPuzzleArchiveItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArchivePageButton",Ext.Container,{config:{cls:"pointerCursor",margin:"0px 5px"},initialize:function(){var a=this;if(a.config.pageNo!=null){a.pageNo=a.config.pageNo}if(a.config.puzzleArchive!=null){a.puzzleArchive=a.config.puzzleArchive}a.setHtml("<span>"+a.pageNo+"</span>");if(a.pageNo==1){a.element.dom.style.color="black"}a.element.on({tap:function(){a.puzzleArchive.fireEvent("archivePageChange",a.puzzleArchive,a.pageNo)}})},selected:function(){var a=this;a.element.dom.style.color="black"},unselected:function(){var a=this;a.element.dom.style.color=""}},0,["readerarchivepagebutton"],["component","container","readerarchivepagebutton"],{component:true,container:true,readerarchivepagebutton:true},["widget.readerarchivepagebutton"],0,[InfinityMobile.view,"ReaderArchivePageButton"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderArticleHelper",Ext.Container,{config:{width:"100%",height:"100%",top:0,left:0,layout:{type:"vbox",pack:"center",align:"middle"},hideMaskOnTap:false,style:"color:white;",items:[{itemId:"space",height:40},{flex:1,width:"100%",layout:{type:"vbox",pack:"center",align:"middle"},itemId:"outerCounter",style:"background-color:rgba(0,0,0,0.7);",items:[{itemId:"headingBar",width:"100%",top:0,style:"font-size:30px;text-align:center;color:black;background-color:rgba(218,218,218,0.6);",padding:10,layout:{type:"hbox",pack:"center",align:"middle"},items:[{itemId:"heading",style:"max-width:500px;",html:"There's a new way to view stories in today's paper"}]},{flex:1},{itemId:"container",width:"100%",style:"max-width:500px;max-height:700px;",layout:{type:"vbox",pack:"center",align:"middle"},defaults:{margin:"20 0"},items:[{itemId:"description",layout:{type:"vbox",pack:"center",align:"middle"},items:[{itemId:"icon",layout:{type:"vbox",pack:"center",align:"middle"},margin:"10 0",items:[{height:40,width:40,style:"background-image:url('resources/images/howTo/touch-screen-friendly.png');background-position:center;background-size:contain;background-repeat:no-repeat;"}]},{itemId:"tapDesc",style:"font-size:20px;text-align:center;font-weight:bold;max-width:400px;",html:"Tap any story on any page to read it in a mobile-friendly format. Tap 'X' to return to the digital paper or swipe to the next story"}]},{itemId:"toggleSettingArea",layout:{type:"vbox",pack:"center",align:"middle"},items:[{itemId:"toggleDesc",style:"font-size:18px;text-align:center;max-width:500px;",html:"Going back to the paper? You can return to the page containing the story you just read or to the last page you viewed. Toggle your preference below",margin:"10 0"},{itemId:"toggle",cls:"pointerCursor",style:"font-size:18px;text-align:center;max-width:600px;",html:"Return to page featuring last story viewed: <input class='pointerCursor' type='checkbox' checked=\"true\" style='margin-left:5px;top:2px;position:relative;width:15px;height:15px;' onclick='if(this.checked){ this.checked = false; } else{ this.checked = true }' ></input>"}]},{itemId:"continueContainer",layout:{type:"hbox",pack:"center"},items:[{itemId:"continueBtn",cls:"pointerCursor btn",height:35,style:"background-color:#4591b8; color: white;",padding:"5 30 5 30",layout:{type:"vbox",pack:"center",align:"middle"},items:[{html:"Continue to paper"}]}]}]},{flex:1}]}]},initialize:function(){var a=this;a.space=a.getComponent("space");a.outerContainer=a.getComponent("outerCounter");a.headingBar=a.outerContainer.getComponent("headingBar");a.heading=a.headingBar.getComponent("heading");a.container=a.outerContainer.getComponent("container");a.desc=a.container.getComponent("description");a.tapDesc=a.desc.getComponent("tapDesc");a.toggleSettingArea=a.container.getComponent("toggleSettingArea");a.toggleDesc=a.toggleSettingArea.getComponent("toggleDesc");a.toggle=a.toggleSettingArea.getComponent("toggle");a.continueContainer=a.container.getComponent("continueContainer");a.continueBtn=a.continueContainer.getComponent("continueBtn");a.setupListeners();a.setupCurrentValue();if(Ext.os.is.Desktop){a.tapDesc.setHtml("Tap any story on any page to read it in a desktop-friendly format. Tap 'X' to return to the digital paper or swipe to the next story");a.setDesktopFontSize()}if(Ext.os.is.Phone){a.setPhoneFontSize();Ext.Viewport.on("orientationchange",function(){a.setPhoneFontSize()})}},returnOrientation:function(){var a=Ext.Viewport.getOrientation();if(Ext.os.is.Android){if(screen.width>screen.height){a="landscape"}else{a="portrait"}}else{if(Ext.os.is.Desktop){if($(document).width()>$(document).height()){a="landscape"}else{a="portrait"}}}return a},setupListeners:function(){var a=this;a.toggle.element.on({tap:a.toggleCheck,scope:a});a.continueBtn.element.on({tap:a.continueToPaper,scope:a})},setupCurrentValue:function(){var b=this;try{if(localStorage.getItem("returnToPage"+publicationguid)!=null){var e=$(b.toggle.element.dom).find("input");if(e.length>0){var d=e[0];var c=true;if(localStorage.getItem("returnToPage"+publicationguid)=="false"){c=false}d.checked=c}}}catch(a){}},setDesktopFontSize:function(){var a=this;a.container.setStyle({maxWidth:"700px"});a.space.hide()},setPhoneFontSize:function(){var a=this;if(a.isDestroyed==null){a.container.setHeight("100%");a.container.setScrollable({direction:"vertical"});$(a.container.element.dom).css("max-width","");$(a.tapDesc.element.dom).css("max-width","");$(a.toggleDesc.element.dom).css("max-width","");$(a.toggle.element.dom).css("max-width","");a.desc.setMargin("25 0 0 0");a.toggleSettingArea.setMargin("0 0 0 0");a.heading.setStyle({fontSize:"18px"});a.tapDesc.setStyle({fontSize:"14px"});a.toggleDesc.setStyle({fontSize:"12px"});a.toggle.setStyle({fontSize:"12px"});a.continueContainer.setStyle({fontSize:"12px"});a.container.setPadding(5)}},continueToPaper:function(){var b=this;var d=$(b.toggle.element.dom).find("input");if(d.length>0){var c=d[0];if(c.checked){try{localStorage.setItem("returnToPage"+publicationguid,"true")}catch(a){}}else{try{localStorage.setItem("returnToPage"+publicationguid,"false")}catch(a){}}}b.fireEvent("close",b)},toggleCheck:function(){var a=this;var c=$(a.toggle.element.dom).find("input");if(c.length>0){var b=c[0];if(b.checked){b.checked=false}else{b.checked=true}}}},0,["articlehelper"],["component","container","articlehelper"],{component:true,container:true,articlehelper:true},["widget.articlehelper"],0,[InfinityMobile.view,"ReaderArticleHelper"],0));(Ext.cmd.derive("InfinityMobile.view.LightboxLink",Ext.Container,{config:{style:"padding:0px; border-radius:0px; background-color:white;",cls:"innerhtmlfullheight",height:"100%",width:"100%",layout:"vbox",zIndex:20,items:[{itemId:"topBar",height:40,layout:"hbox",items:[{id:"toolBarClose",cls:"pointerCursor",top:8,right:8,html:"<img src='../assets/article view/article-close-btn.png' style='width:24px; height:24px' />"}]},{flex:1,itemId:"content"}]},initialize:function(){var a=this;a.topBar=a.getComponent("topBar");a.topBar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});a.closeButton=a.topBar.getComponent("toolBarClose");a.setCloseButtonListenter();a.content=a.getComponent("content");if(a.config.mediaObject!=null){a.mediaObject=a.config.mediaObject;a.loadMediaObject()}},setCloseButtonListenter:function(){var a=this;a.closeButton.element.on("tap",function(){a.fireEvent("close",a)})},loadMediaObject:function(){var b=this;if(b.mediaObject.url!=null){var a=b.mediaObject.url;b.content.setHtml('<div class=\'iframeWrapper\' style=\'position:absolute; width:100%; height:100%; overflow-y:scroll; -webkit-overflow-scrolling:touch;\'><iframe style="border:none;width:100%; height:100%" class="iframePopover" src="'+a+'" /></div>')}}},0,["lightboxlink"],["component","container","lightboxlink"],{component:true,container:true,lightboxlink:true},["widget.lightboxlink"],0,[InfinityMobile.view,"LightboxLink"],0));(Ext.cmd.derive("InfinityMobile.view.ClippingItems",Ext.Container,{config:{items:[{itemId:"deleteBtn",right:0,top:0,height:20,width:20,style:"background-image:url('resources/images/reader icons/close btn.png');background-size:contain;background-position:center;background-repeat:no-repeat;background-color:rgba(0,0,0,0.7);",hidden:true}]},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.image!=null){a.image=a.config.image}if(a.config.clicked!=null){a.clicked=a.config.clicked}a.deleteBtn=a.getComponent("deleteBtn");if(Ext.os.is.Phone){a.deleteBtn.setHeight(30);a.deleteBtn.setWidth(30)}a.setStyle({"float":"left",border:"1px solid gray",backgroundImage:"url('"+a.image+"')",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"});a.element.on("tap",function(){if(a.clicked){a.element.dom.style.border="1px solid gray";a.clicked=false;a.deleteBtn.hide()}else{a.element.dom.style.border="4px solid #458FBB";a.clicked=true;a.deleteBtn.show()}});a.deleteBtn.element.on({tap:a.deleteItem,scope:a});a.addCls("pointerCursor")},deleteItem:function(){var a=this;prompt=Ext.create("InfinityMobile.view.ClippingMenuDeletePrompt",{item:a})}},0,["clippingitems"],["component","container","clippingitems"],{component:true,container:true,clippingitems:true},["widget.clippingitems"],0,[InfinityMobile.view,"ClippingItems"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPrintItem",Ext.Container,{config:{style:"float:left;border:1px solid grey;overflow:hidden;",editionGuid:"2193eb4d-6dcd-42bf-a8bf-8c7ce0e0eecf",pageNo:1,pageIndex:1,height:175,cls:"pointerCursor",items:[{itemId:"printItemLabel",bottom:0,height:30,width:"100%",padding:"5 0 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; border-radius:5px; padding-left:7px",items:[{itemId:"printItemCheckBox",xtype:"customcheckbox",right:30,top:2}]}]},initialize:function(){var c=this;var d=c.getEditionGuid();var a=c.getPageNo();var b="";if(typeof latestLM!="undefined"){b="&lm="+latestLM}var e="https://edition.pagesuite-professional.co.uk/get_image.aspx?w=280&eid="+d+"&pnum="+a+b;c.setHtml("<img style='width:100%' src='"+e+"' />");c.editionLabel=c.getComponent("printItemLabel");c.editionLabelCheckBox=c.editionLabel.getComponent("printItemCheckBox");if(Ext.browser.is.Firefox){c.editionLabelCheckBox.setRight(5)}c.editionLabel.setHtml(language.page+" "+a);if(settings.newsday!=null){c.addCls("thumbInfo");c.editionLabel.setStyle({borderRadius:"0px"})}if(!Ext.browser.is.Firefox){c.editionLabelCheckBox.setWidth(0)}c.setClickListener()},setClickListener:function(){var a=this;a.element.on("tap",function(){a.fireEvent("toggleCheckBox",a,a.editionLabelCheckBox)})}},0,["printitem"],["component","container","printitem"],{component:true,container:true,printitem:true},["widget.printitem"],0,[InfinityMobile.view,"ReaderPrintItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderDownloadItem",Ext.Container,{config:{style:"float:left;border:1px solid grey;overflow:hidden",editionGuid:"2193eb4d-6dcd-42bf-a8bf-8c7ce0e0eecf",pageNo:1,pageIndex:1,cls:"pointerCursor",height:175,items:[{itemId:"downloadItemLabel",bottom:0,height:30,width:"100%",padding:"5 0 0 0",style:"background-color:rgba(0,0,0,0.7); color:white; border-radius:5px; padding-left:7px",items:[{itemId:"downloadItemCheckBox",xtype:"customcheckbox",right:30,top:2}]}]},initialize:function(){var d=this;var e=d.getEditionGuid();var b=d.getPageNo();var a=d.getPageIndex();var c="";if(typeof latestLM!="undefined"){c="&lm="+latestLM}var f="https://edition.pagesuite-professional.co.uk/get_image.aspx?w=280&eid="+e+"&pnum="+b+c;d.setHtml("<img style='width:100%' src='"+f+"' />");d.editionLabel=d.getComponent("downloadItemLabel");d.editionLabelCheckBox=d.editionLabel.getComponent("downloadItemCheckBox");if(Ext.browser.is.Firefox){d.editionLabelCheckBox.setRight(5)}d.editionLabel.setHtml(language.page+" "+b);if(settings.newsday!=null){d.addCls("thumbInfo");d.editionLabel.setStyle({borderRadius:"0px"})}if(!Ext.browser.is.Firefox){d.editionLabelCheckBox.setWidth(0)}d.setClickListener()},setClickListener:function(){var a=this;if(Ext.browser.is.IE){if(navigator.maxTouchPoints){a.element.on("tap",function(){a.fireEvent("toggleCheckBox",a,a.editionLabelCheckBox)})}else{a.element.dom.onclick=function(){a.fireEvent("toggleCheckBox",a,a.editionLabelCheckBox)}}}else{a.element.on("tap",function(){a.fireEvent("toggleCheckBox",a,a.editionLabelCheckBox)})}}},0,["downloaditem"],["component","container","downloaditem"],{component:true,container:true,downloaditem:true},["widget.downloaditem"],0,[InfinityMobile.view,"ReaderDownloadItem"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageGalleryAdvert",Ext.Container,{config:{height:"100%",width:"100%",pageNo:"",type:""},initialize:function(){var a=this;a.setupVars();a.setupAdvert()},setupVars:function(){var a=this;if(a.config.type!=null){a.type=a.config.type}},setupAdvert:function(){var b=this;if(settings.reader.galleryMpu!=null&&settings.reader.galleryMpu.type=="dfp"&&settings.reader.galleryMpu.networkCode!=null&&settings.reader.galleryMpu.adUnit!=null){}var a=settings.reader.galleryMpu;b.adType=a.type;if(a!=null){switch(a.type){case"dfp":default:b.networkCode=a.networkCode;b.adUnit=a.adUnit;b.targeting=a.targeting;b.setupDfp();break}}},setupDfp:function(){var a=this;if(a.networkCode!=null&&a.adUnit!=null){a.advertId="ig_advert"+a.id;a.setHtml("<div class='gallery-ad-container'><div id='"+a.advertId+"' class='fg-gallery-mpu'></div></div>");gptadslots.push(googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,[[300,250]],a.advertId).addService(googletag.pubads().updateCorrelator()));if(a.targeting!=null){a.setTargeting(a.targeting)}}},setTargeting:function(a){var g=this;if(a!=null&&a!=""){var h=a.split("|");for(var c in h){var e=h[c];var j=e.split("*");if(j.length==2){var m=j[0];var l=j[1];if(l.indexOf("{{VAR=")>=0){var d=l.replace("{{VAR=","").replace("}}","");var n=d.split(".");var b=window;for(var k in n){var f=n[k];if(b[f]!=null){l=b[f];b=l}else{console.log("Error: "+j[1]+" does not exist");l="";break}}}if(m!=null&&m!=""&&l!=null&&l!=""){googletag.pubads().setTargeting(m,l)}}}}},loadDfp:function(){var a=this;googletag.enableServices();googletag.cmd.push(function(){googletag.display(a.advertId)})}},0,["readerimagegalleryadvert"],["component","container","readerimagegalleryadvert"],{component:true,container:true,readerimagegalleryadvert:true},["widget.readerimagegalleryadvert"],0,[InfinityMobile.view,"ReaderImageGalleryAdvert"],0));(Ext.cmd.derive("InfinityMobile.view.AdvertPageViewer",Ext.Panel,{config:{height:"100%",width:"100%",pageNo:"",items:[{itemId:"advert"}]},beforeInitialize:function(){var a=this;a.setLayout({type:"hbox",pack:"center",align:"middle"})},initialize:function(){this.setupVars();this.setAdvertHtml(this.advertType)},setupVars:function(){var d=this;d.advertId=this.id+"advert";if(d.config.advertType!=null){d.advertType=d.config.advertType}if(d.config.networkCode!=null){d.networkCode=d.config.networkCode}if(d.config.adUnit!=null){d.adUnit=d.config.adUnit}if(d.config.advertSize!=null){d.advertSize=[];var a=d.config.advertSize.split("|");if(a){for(var c=0;c<a.length;c++){var b=a[c].split(",");if(b!=null&&b.length==2){d.advertSize.push([parseInt(b[0]),parseInt(b[1])])}}}}if(d.config.adUrl!=null){d.adUrl=d.config.adUrl}if(d.config.adLink!=null){d.adLink=d.config.adLink}if(d.config.targeting!=null){d.targeting=d.config.targeting}d.advertComponent=d.getComponent("advert");d.scale=1},setAdvertHtml:function(a){var b=this;switch(a){case"dfp":b.setupDfpAdvert();break;case"image":b.setupImageAdvert();break;case"url":b.setupUrlAdvert();break}b.hasHtmlSetup=true},setupDfpAdvert:function(){var a=this;a.advertComponent.setHtml("<div id='"+a.advertId+"' class='page-flow-advert'></div>");if(typeof googletag!="undefined"&&googletag!=null&&googletag.pubads!=null){googletag.pubads().addEventListener("slotRenderEnded",function(b){if(!b.isEmpty){if(a.adslot==b.slot){a.loadedSize=b.size;a.resizeAdvert();a.setDfpTouchEventListeners()}}else{if(a.adslot==b.slot){a.setDfpTouchEventListeners()}}})}else{}},setupDfpTargetting:function(){},setupUrlAdvert:function(){var a=this;a.on("painted",function(){a.advertComponent.setHeight("100%");a.advertComponent.setWidth("100%");var b=a.advertComponent.element.dom.getElementsByClassName("x-innerhtml")[0];if(b!=null){b.style.height="100%";b.style.width="100%"}});a.advertComponent.setHtml("<iframe id='"+a.advertId+"' class='page-flow-advert' style='position:relative;width:100%; height:100%;border:none;' src='"+a.adUrl+"'></iframe>")},setupImageAdvert:function(){var a=this;a.on("painted",function(){a.advertComponent.setHeight("100%");a.advertComponent.setWidth("100%");var b=a.advertComponent.element.dom.getElementsByClassName("x-innerhtml")[0];if(b!=null){b.style.height="100%";b.style.width="100%"}});a.advertComponent.setHtml("<div id='"+a.advertId+"' class='page-flow-advert' style='position:relative;width:100%; height:100%;cursor: pointer;background:url(\""+a.adUrl+"\");background-size:contain;background-repeat:no-repeat;background-position:center;'></div>");a.advertComponent.element.on("tap",function(){window.open(a.adLink,"_blank")})},loadAdvert:function(){var a=this;switch(a.advertType){case"dfp":a.loadDfpAdvert();break;case"image":case"url":break}},loadDfpAdvert:function(){var a=this;if(googletag!=null){if(a.hasLoaded){googletag.pubads().refresh([a.adslot])}else{googletag.cmd.push(function(){console.log(a.advertSize);a.adslot=googletag.defineSlot("/"+a.networkCode+"/"+a.adUnit,a.advertSize,a.advertId).addService(googletag.pubads().updateCorrelator());if(a.targeting!=null&&a.targeting.length>0){var b=a.targeting.split("|");for(var d in b){var e=b[d];var c=e.split("*");if(c!=null&&c.length>=2){a.adslot.setTargeting(c[0],c[1])}}}googletag.enableServices();googletag.display(a.advertId);a.hasLoaded=true})}}},refreshAdvert:function(){},pageResize:function(){var a=this;a.resizeAdvert()},onResize:function(){var a=this;a.resizeAdvert()},resizeAdvert:function(){var e=this;var c=e.advertComponent.element.dom.clientHeight;var a=e.advertComponent.element.dom.clientWidth;var d=e.element.dom.clientHeight;var b=e.element.dom.clientWidth;var f=e.getScale(c,d);var h=e.getScale(a,b);var g=e.returnTranslate(f,h);f>h?e.applyTransform(h,g):e.applyTransform(f,g)},returnTranslate:function(a,b){var s=this;var u=a>b?b:a;var d=a>b?"width":"height";var j=s.advertComponent.element.dom;var h=s.element.dom;var g=0;var e=0;try{var v=s.loadedSize!=null&&s.loadedSize.length==2?s.loadedSize[1]:s.advertSize[0][1];var r=s.loadedSize!=null&&s.loadedSize.length==2?s.loadedSize[0]:s.advertSize[0][0];if((u*j.clientWidth)<h.clientWidth&&v>h.clientHeight){var f=h.clientWidth;var m=(r*a);var q=(f-m)/2;var l=Math.max(0,(f-r))/2;g=q-l}if((u*j.clientHeight)<h.clientHeight&&r>h.clientWidth){var n=h.clientHeight;var t=(v*u);var p=(n-t)/2;var c=Ext.browser.is.IE?s.advertComponent.element.dom.offsetTop:0;var k=(Math.max(0,(n-v))/2)+c;e=p-k}else{if(Ext.browser.is.IE){e=(u*j.clientHeight)<h.clientHeight?0:Math.abs(s.advertComponent.element.dom.offsetTop)}}}catch(o){console.error("[AdvertPageViewer]:\n",o)}return"translate3d("+g+"px, "+e+"px, 0)"},getScale:function(a,b){return Math.min(1,b/a)},applyTransform:function(e,d){var a=this;var c=d+" scale3d("+e+", "+e+", 1)";var b="0 0";if(Ext.browser.is.Firefox){c="scale3d("+e+", "+e+", 1)";a.advertComponent.setStyle({"-webkit-transform":c,"-moz-transform":c,"-ms-transform":c,transform:c})}else{a.advertComponent.setStyle({"-webkit-transform":c,"-moz-transform":c,"-ms-transform":c,transform:c,"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"transform-origin":b})}},setDfpTouchEventListeners:function(){var e=this;var d=e.advertComponent.element.down("iframe");if(d!=null&&d.dom!=null){try{var c=d.dom;var a=c.contentDocument;e.info={y:0,previous:{y:0},previousTime:{y:0}};a.addEventListener("touchstart",function(f){e.dragStart(f)},{passive:false});a.addEventListener("touchmove",function(f){e.drag(f)},{passive:false});a.addEventListener("touchend",function(f){e.dragEnd(f)},{passive:false})}catch(b){console.error("ERROR: Unable to setup touch listeners for advert",b)}}},dragStart:function(b){var a=this;var d=b.changedTouches[0].screenX;var c=b.changedTouches[0].screenY;a.startX=d;a.startY=c;b.absDeltaX=1;b.absDeltaY=0;b.deltaX=1;b.deltaY=0;a.info.time=b.timeStamp;a.parent.onDragStart(b)},drag:function(b){var a=this;var d=b.changedTouches[0].screenX-a.startX;var c=b.changedTouches[0].screenY-a.startY;b.absDeltaX=d;b.absDeltaY=c;b.deltaX=d;b.deltaY=c;a.info.time=b.timeStamp;a.info.previous.x=a.info.x;a.info.previousTime.x=a.info.time;a.info.x=b.deltaX;a.parent.onDrag(b)},dragEnd:function(c){var a=this;var f=c.changedTouches[0].screenX-a.startX;var d=c.changedTouches[0].screenY-a.startY;c.absDeltaX=f;c.absDeltaY=d;c.deltaX=f;c.deltaY=d;a.info.time=c.timeStamp;var b=a.info.time-a.info.previousTime.x;c.flick={velocity:{}};if(b>0){c.flick.velocity.x=(a.info.x-a.info.previous.x)/b;c.flick.velocity.y=0}a.parent.onDragEnd(c)},getPageNo:function(){return this.config.pageNo},toggleZoomMode:function(){},toggleDPS:function(){},toggleDPSNonActive:function(){},completeImageLoaded:function(){},completePDFLoaded:function(){},stopTiling:function(){},destroy:function(){if(typeof googletag!="undefined"&&googletag.destroySlots!=null){googletag.destroySlots([this.adslot])}Ext.Panel.prototype.destroy.apply(this,arguments)}},0,["readeradvertpageviewer"],["component","container","panel","readeradvertpageviewer"],{component:true,container:true,panel:true,readeradvertpageviewer:true},["widget.readeradvertpageviewer"],0,[InfinityMobile.view,"AdvertPageViewer"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderMessagePrompt",Ext.Container,{config:{modal:{zIndex:999999998},centered:true,width:300,style:"background-color:white;border:1px solid black;border-radius:5px;padding:5px;",fullscreen:true,zIndex:999999999},initialize:function(){var a=this;a.setupVars();a.setupPrompt(a.message)},setupVars:function(){var a=this;if(a.config.message!=null){a.message=a.config.message}},setupPrompt:function(b){var a=this;a.setHtml("<div style='text-align:center;padding:10px;'><p style=''>"+b+'</p></div><div style=\'text-align:center;\'><input type="button" class="btn pointerCursor" onclick="parent.ok()" ontouchend="parent.ok()" style="-webkit-appearance:none;margin: 5px;border-style:solid;font-size:12px;height:30px;margin-color:#'+settings.reader.buttonColour+";background-color:#"+settings.reader.buttonColour+";border-color:#"+settings.reader.buttonColour+";width:120px;color:#"+settings.reader.buttonTextColour+';border-radius:0px;" type="button" value="'+language.ok+'" /></div>');ok=function(){setTimeout(function(){a.destroy()},100)}}},0,["readerMessagePrompt"],["component","container","readerMessagePrompt"],{component:true,container:true,readerMessagePrompt:true},["widget.readerMessagePrompt"],0,[InfinityMobile.view,"ReaderMessagePrompt"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPageNumber",Ext.Container,{config:{width:200,height:60,modal:true,hideOnMaskTap:true,padding:5,layout:"hbox",style:"background-color:black; border: 1px solid white",items:[{itemId:"pageNumberTextContainer",flex:1,height:48,style:"background-color:white",html:"<input type='number' style='border:none; width: 100%; height:100%; font-size: 32px; padding:5px;' />"},{width:5},{itemId:"pageNumberGo",width:48,height:48,padding:"10px 0",style:"border: 1px solid white; font-size: 24px; color:white; text-align:center; cursor: pointer",html:"GO"}]},initialize:function(){var a=this;a.loaded=false;a.fireEvent("hideArticlesContainer");a.pageNumberTextContainer=a.getComponent("pageNumberTextContainer");a.pageNumberTextBox=a.pageNumberTextContainer.element.down("input").dom;a.pageNumberTextBox.addEventListener("touchstart",function(){a.pageNumberTextBox.focus()});a.initialiseFriendlyTextBox();a.pageNumberGoButton=a.getComponent("pageNumberGo");a.pageNumberGoButton.setHtml(language.go.toUpperCase());a.setGoListener();a.element.on({painted:function(){this.loaded=true},scope:a})},initialiseTextBox:function(){var a=this;if(a.config.maxValue!=null){a.maxValue=a.config.maxValue;a.pageNumberTextBox.setAttribute("max",a.maxValue)}a.minValue=1;a.pageNumberTextBox.setAttribute("min",a.minValue);if(a.config.currentPageNumber!=null){a.currentPageNumber=a.config.currentPageNumber;a.pageNumberTextBox.value=a.currentPageNumber;a.setOnChangeListener()}},initialiseFriendlyTextBox:function(){var b=this;b.pageNumberTextBox.type="text";b.currentPageNumber=b.config.currentPageNumber;var a=flatPlanData.pageGroups[b.currentPageNumber-1+pageOffset].pages[0];b.pageNumberTextBox.value=a.pageName;b.maxValue=b.config.maxValue;b.pageNumberTextBox.maxValue=b.maxValue;b.setOnChangeListener()},setOnChangeListener:function(){var a=this;$(a.pageNumberTextBox).keyup(function(b){if(b.keyCode==13){a.fireEvent("jumpToPage",a)}})},setGoListener:function(){var a=this;a.pageNumberGoButton.element.on("tap",function(){a.fireEvent("jumpToPage",a)})},hide:function(){var a=this;if(a.loaded){a.fireEvent("showArticlesContainer");Ext.Container.prototype.hide.apply(this,arguments)}}},0,["readerpagenumber"],["component","container","readerpagenumber"],{component:true,container:true,readerpagenumber:true},["widget.readerpagenumber"],0,[InfinityMobile.view,"ReaderPageNumber"],0));Ext.application({name:"InfinityMobile",profiles:["phone","largetablet","tablet","desktop"],models:["MyModel"],stores:["EditionFlatplan","LatestEditionFlatplan","ArchiveStore","SettingStore","SearchStore","SearchHighlightStore","MediaStore","ArticleStore","LanguageStore","PuzzleArchiveStore"],views:["ReaderMenuSponsor","CustomCheckbox","ReaderView","ReaderSpecialSupplementsItem","ReadAloudControls","StoryWindowPreferences","ReaderPuzzleArchive","ReaderSectionPopupItem","ReaderSectionPopup","ReaderEdgeBrowserPopup","ReaderZoomSlider","BackgroundWrapAdItem","ReaderPagesItem","PrintPreview","ClippingLoad","ClippingOptionsMenu","ReaderTicker","ReaderAudioMediaObject","ArticleSectionItemImg","ArticleSectionItem","ArticlesSectionContainer","ArticlesContainer","ClippingOptions","clippingPrompt","ClippingBox","ReaderLiveAdvertObject","LeftSideAdvertCover","ReaderLiveArticlePopoverItem","ArticleReader","NavButton","ClippingMenuEmailPrompt","ClippingMenuPreview","ClippingMenuPrompt","ClippingMenuDeletePrompt","ClippingMenuThumb","StickyNote","PrintMenu","ReaderAudioObject","LayoutZoomSlider","ClippingMenuImageScroller","ClippingMenu","ReaderLanguagePopup","ReaderOLinkObject","ReaderOVideo","ReaderOGallery","ReaderOGalleryItem","ReaderOGalleryLoading","ReaderOVideoObject","ReaderOGalleryObject","ReaderVideoLinkObject","ReaderLightbox","ReaderImageLinkObject","Note","Main","Reader","ReaderToolbar","ReaderToolbarBottom","ReaderPages","Blocker","ReaderMenuItem","ReaderMenuClose","ReaderMenuSection","ReaderMenuSectionItem","2DInfiniteCarousel","InfiniteCarousel","ReaderPageViewer","ReaderPageViewerPDF","LayoutView","LayoutViewController","LayoutTextView","ReaderSearchItem","ReaderArchiveItem","ReaderMediaObject","ReaderAnimationObject","ReaderLinkObject","ReaderArticleObject","ArticleCarousel","ReaderArticlePopoverItem","ReaderVideoObject","ReaderVideoObjectControls","Overlay","ReaderImageObject","PageRestriction","FullscreenPrompt","ReaderArchiveMonthItem","PDFInfiniteCarousel","ArticleReaderTopBarBtn","BookmarkItem","ReaderMenuShare","ReaderMenuShareItem","ReaderMenuTTS","ClippingArea","ReaderImageGallery","ReaderImageGalleryItem","ReaderPuzzleArchiveItem","ReaderArchivePageButton","ReaderArticleHelper","LightboxLink","ClippingItems","ReaderPrintItem","ReaderDownloadItem","ReaderImageGalleryAdvert","AdvertPageViewer","ReaderMessagePrompt","ReaderPageNumber"],controllers:["AppController","LayoutController","ReaderController","ReaderToolbarController","ReaderMenuController","ReaderSearchController","ReaderDownloadController","SubscribeController","MediaController","DataCaptureController","PrintController","ClippingController","ArticleController","PdfController","PageTurnController","PushController","BookmarkController","TrackingController"]});(Ext.cmd.derive("InfinityMobile.view.ArticleReaderLiveNewsBtn",Ext.Container,{config:{cls:"sectionBtn"},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.section!=null){a.section=a.config.section}a.setHtml('<img class="sectionBtn" style="height:30px;" src="../assets/dynamicarticles/live-news-icon.gif"/><span style="margin:0px 5px;white-space:nowrap;position:relative;top:-3px;font-family:Open Sans, sans-serif;font-size:14px;font-weight:bold;color:#929292;">'+language.dynamicArticles.liveNews+"</span>");a.element.on({tap:function(){a.fireEvent("liveNewsTiles",a)},painted:function(){var b=$(a.element.down("span").dom).width()+40;a.setWidth(b)}})}},0,["articlereaderlivenewsbtn"],["component","container","articlereaderlivenewsbtn"],{component:true,container:true,articlereaderlivenewsbtn:true},["widget.articlereaderlivenewsbtn"],0,[InfinityMobile.view,"ArticleReaderLiveNewsBtn"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderSectionBtn",Ext.Container,{config:{style:"padding-left:10px;padding-right:10px;",cls:"sectionBtn"},initialize:function(){var a=this;Ext.Container.prototype.initialize.apply(this,arguments);if(a.config.section!=null){a.section=a.config.section}a.setHtml('<span  style="position:relative;top:10px;font-family:Open Sans, sans-serif;;font-size:14px;font-weight:bold;">'+a.section+"</span>");if(a.section==language.dynamicArticles.all){a.element.dom.style.color="#b22930";a.element.on({painted:function(){$(a.element.down("span").dom).css("white-space","nowrap");var b=$(a.element.down("span").dom).width()+20;a.setWidth(b)},scope:a})}a.element.on({tap:function(){a.fireEvent("loadSection",a.section)}})}},0,["articlereadersectionbtn"],["component","container","articlereadersectionbtn"],{component:true,container:true,articlereadersectionbtn:true},["widget.articlereadersectionbtn"],0,[InfinityMobile.view,"ArticleReaderSectionBtn"],0));(Ext.cmd.derive("InfinityMobile.view.ArticleReaderToggleViewOptions",Ext.Container,{config:{top:40,modal:true,hideOnMaskTap:true,zIndex:12,items:[{itemId:"paperViewBtn",top:40,height:40,width:200,layout:"hbox",style:"background-color:#d2d2d2;cursor:pointer;",items:[{height:25,top:8,width:60,style:"background-image:url('../assets/dynamicarticles/replica-paper-ic-grey@2x.png');background-position:50% 50%;background-repeat:no-repeat;background-size:contain;"},{itemId:"text",height:25,top:12.5,left:60}]},{itemId:"dynamicViewBtn",top:80,height:40,width:200,layout:"hbox",style:"background-color:#d2d2d2;cursor:pointer;",items:[{height:25,top:8,width:60,style:"background-image:url('../assets/dynamicarticles/dynamic-mode-ic-grey@2x.png');background-position:50% 50%;background-repeat:no-repeat;background-size:contain;"},{itemId:"text",height:25,top:12.5,left:60}]}]},initialize:function(){var c=this;var b=c.getComponent("paperViewBtn");b.getComponent("text").setHtml('<p style="font-family:Open Sans, sans-serif;font-size:13px;">'+language.dynamicArticles.replica+"</p>");b.element.on({tap:function(){c.fireEvent("replicaPaperView",c)}});var a=c.getComponent("dynamicViewBtn");a.getComponent("text").setHtml('<p style="font-family:Open Sans, sans-serif;font-size:13px;">'+language.dynamicArticles.advanced+"</p>");a.element.on({tap:function(){c.fireEvent("dynamicView",c)}});c.getModal().addCls("modal")}},0,["articlereadertoggleviewoptions"],["component","container","articlereadertoggleviewoptions"],{component:true,container:true,articlereadertoggleviewoptions:true},["widget.articlereadertoggleviewoptions"],0,[InfinityMobile.view,"ArticleReaderToggleViewOptions"],0));(Ext.cmd.derive("InfinityMobile.view.DataCaptureForm",Ext.Container,{config:{height:"80%",width:600,fullscreen:true,modal:true,centered:true,style:"background-color:white;border-radius:5px;",layout:{type:"vbox",packed:"middle"},items:[{itemId:"brandingLogo",height:120,width:"calc(100% - 10px)",margin:"20 10 20 10"},{itemId:"welcomeMsg",padding:"20 60 20 60",style:"text-align:center;"},{itemId:"form",padding:"20 40 20 40",defaults:{margin:"10 0 10 0"},items:[{itemId:"firstname",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="First Name"/>'},{itemId:"surname",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Last Name"/>'},{itemId:"email",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Email Address*"/>'},{itemId:"houseNo",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="House No/Name"/>'},{itemId:"address",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Address"/>'},{itemId:"postcode",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Postcode"/>'},{itemId:"telephone",width:"100%",height:50,html:'<input type="text" style="height:40px;width:100%;" placeholder="Telephone No"/>'},{itemId:"required",html:"* Required Field",style:"font-size:12px;"},{itemId:"termsCheckbox",html:"<input type='checkbox' style:'height:10px;'/><label style='padding-left:5px;font-size:14px;'></label><a style='padding-left:5px;font-size:14px;'></a>"},{itemId:"updatedCheckbox",html:"<input type='checkbox' style:'height:10px;'/><label style='padding-left:5px;font-size:14px;'>Keep me updated on the latest news</label>"},{itemId:"errorMsg",hidden:true,html:"*Please make sure the required fields above are completed.",style:"color:red;"}]},{itemId:"buttonContainer",width:"calc(100%-10px)",height:180,layout:{type:"vbox",pack:"middle"},padding:"10 40 10 40",defaults:{margin:"10 0 10 0"},items:[{itemId:"registerBtn",cls:"pointerCursor",height:60,width:"calc(100%-10px)",style:"text-align:center;vertical-align: middle;line-height:60px;",html:"<p>Register</p>"},{itemId:"skipBtn",cls:"pointerCursor",height:60,width:"100%",style:"text-align:center;color:rgb(155, 155, 155);background-color:rgb(229, 229, 229);vertical-align:middle;line-height:60px;",html:"Skip"}]}]},initialize:function(){var a=this;if(a.config.logo!=null){a.logo=a.config.logo}if(a.config.welcomeText!=null){a.welcomeText=a.config.welcomeText}if(a.config.settings!=null){a.settings=a.config.settings}a.brandingLogo=a.getComponent("brandingLogo");a.welcomeTextArea=a.getComponent("welcomeMsg");a.form=a.getComponent("form");a.buttonContainer=a.getComponent("buttonContainer");a.registerBtn=a.buttonContainer.getComponent("registerBtn");a.skipBtn=a.buttonContainer.getComponent("skipBtn");a.errorMsg=a.form.getComponent("errorMsg");a.termsCheck=a.form.getComponent("termsCheckbox");if(Ext.os.is.Desktop){a.element.dom.style.overflowY="scroll";if(Ext.browser.is.IE){a.brandingLogo.element.dom.style.minHeight="120px";a.registerBtn.element.dom.style.minHeight="60px";a.skipBtn.element.dom.style.minHeight="60px"}}else{a.setScrollable({direction:"vertical"})}a.brandingLogo.setStyle({backgroundImage:"url("+a.logo+")",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"});a.welcomeTextArea.setHtml(language.dataCapture.containerText);a.setupFormFields();if(!Ext.os.is.Desktop){a.setupTouchDevices()}a.registerBtn.element.on({tap:a.register,scope:a});a.registerBtn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.skipBtn.element.on({tap:function(){this.fireEvent("closeDataCapture",this);this.destroy()},scope:a})},setupTouchDevices:function(){var a=this;var b=function(){this.focus()};a.firstname.element.on({tap:b});a.surname.element.on({tap:b});a.email.element.on({tap:b});a.houseNo.element.on({tap:b});a.address.element.on({tap:b});a.postcode.element.on({tap:b});a.telephone.element.on({tap:b});a.updatedCheckbox.element.on({tap:b});a.termsCheck.element.on({tap:b})},setupFormFields:function(){var a=this;a.firstname=a.form.getComponent("firstname");a.surname=a.form.getComponent("surname");a.email=a.form.getComponent("email");a.houseNo=a.form.getComponent("houseNo");a.address=a.form.getComponent("address");a.postcode=a.form.getComponent("postcode");a.telephone=a.form.getComponent("telephone");a.updatedCheckbox=a.form.getComponent("updatedCheckbox");a.hasTerms=false;$(a.email.element.down("input").dom).attr("placeholder",language.dataCapture.email+"*");a.requiredText=a.form.getComponent("required");a.requiredText.setHtml(language.dataCapture.required);if(a.settings.firstname!=null){if(a.settings.firstname.hasFirstname!=null){if(a.settings.firstname.required=="true"){$(a.firstname.element.down("input").dom).attr("placeholder",language.dataCapture.firstName+"*");a.firstname.required=true}else{a.firstname.required=false;$(a.firstname.element.down("input").dom).attr("placeholder",language.dataCapture.firstName)}}else{a.firstname.hide()}}else{a.firstname.hide()}if(a.settings.surname!=null){if(a.settings.surname.hasSurname!=null){if(a.settings.surname.required=="true"){$(a.surname.element.down("input").dom).attr("placeholder",language.dataCapture.lastName+"*");a.surname.required=true}else{$(a.surname.element.down("input").dom).attr("placeholder",language.dataCapture.lastName);a.surname.required=false}}else{a.surname.hide()}}else{a.surname.hide()}if(a.settings.houseNo!=null){if(a.settings.houseNo.hasHouseNo!=null){if(a.settings.houseNo.required=="true"){$(a.houseNo.element.down("input").dom).attr("placeholder",language.dataCapture.houseNo+"*");a.houseNo.required=true}else{$(a.houseNo.element.down("input").dom).attr("placeholder",language.dataCapture.houseNo);a.houseNo.required=false}}else{a.houseNo.hide()}}else{a.houseNo.hide()}if(a.settings.address!=null){if(a.settings.address.hasAddress!=null){if(a.settings.address.required=="true"){$(a.address.element.down("input").dom).attr("placeholder",language.dataCapture.address+"*");a.address.required=true}else{$(a.address.element.down("input").dom).attr("placeholder",language.dataCapture.address);a.address.required=false}}else{a.address.hide()}}else{a.address.hide()}if(a.settings.postcode!=null){if(a.settings.postcode.hasPostcode!=null){if(a.settings.postcode.required=="true"){$(a.postcode.element.down("input").dom).attr("placeholder",language.dataCapture.postCode+"*");a.postcode.required=true}else{$(a.postcode.element.down("input").dom).attr("placeholder",language.dataCapture.postCode);a.postcode.required=false}}else{a.postcode.hide()}}else{a.postcode.hide()}if(a.settings.telephone!=null){if(a.settings.telephone.hasTelephone!=null){if(a.settings.telephone.required=="true"){$(a.telephone.element.down("input").dom).attr("placeholder",language.dataCapture.telephone+"*");a.telephone.required=true}else{$(a.telephone.element.down("input").dom).attr("placeholder",language.dataCapture.telephone);a.telephone.required=false}}else{a.telephone.hide()}}else{a.telephone.hide()}if(a.settings.hasOptIn=="true"){a.updatedCheckbox.element.down("label").dom.innerHTML=language.dataCapture.optIn}else{a.updatedCheckbox.hide()}if(a.settings.terms!=null){a.hasTerms=true;if(a.settings.terms.termsUrl!=null){a.termsCheck.element.down("a").dom.href=a.settings.terms.termsUrl;a.termsCheck.element.down("a").dom.innerHTML=language.dataCapture.terms}else{a.termsCheck.element.down("label").dom.innerHTML=language.dataCapture.terms}}else{a.termsCheck.hide()}a.registerBtn.setHtml(language.register);if(a.settings.showSkip!="true"){a.skipBtn.hide()}else{a.skipBtn.setHtml(language.skip)}},register:function(){var t=this;var d=false;var l={};var q=null;var k=null;var p=null;var h=null;var e=null;var u=null;var s=null;var f=t.firstname.element.down("input").dom;var n=t.surname.element.down("input").dom;var r=t.email.element.down("input").dom;var c=t.houseNo.element.down("input").dom;var a=t.address.element.down("input").dom;var b=t.postcode.element.down("input").dom;var m=t.telephone.element.down("input").dom;var o=t.updatedCheckbox.element.down("input");var j=t.termsCheck.element.down("input");if(t.firstname.required){if(f.value.length==0){f.style.border="1px solid red";d=true}else{l.firstname=f.value;f.style.border=""}}else{if(f.value.length>0){l.firstname=f.value}}if(t.surname.required){if(n.value.length==0){n.style.border="1px solid red";d=true}else{l.surname=n.value;n.style.border=""}}else{if(n.value.length>0){l.surname=n.value}}if(t.validateEmail(r.value)){if(r.value.length==0){r.style.border="1px solid red";d=true}else{l.email=r.value;r.style.border=""}}else{r.style.border="1px solid red";d=true}if(t.houseNo.required){if(c.value.length==0){c.style.border="1px solid red";d=true}else{l.houseNo=c.value;c.style.border=""}}else{if(c.value.length>0){l.houseNo=c.value}}if(t.address.required){if(a.value.length==0){a.style.border="1px solid red";d=true}else{l.address=a.value;a.style.border=""}}else{if(a.value.length>0){l.houseNo=a.value}}if(t.postcode.required){if(b.value.length==0){b.style.border="1px solid red";d=true}else{l.postcode=b.value;b.style.border=""}}else{if(b.value.length>0){l.postcode=b.value}}if(t.telephone.required){if(m.value.length==0){m.style.border="1px solid red";d=true}else{l.telephone=m.value;m.style.border=""}}else{if(m.value.length>0){l.postcode=m.value}}if(!t.updatedCheckbox.isHidden()){if(o.is(":checked")){l.keepMeUpdated="true"}}var g=true;if(!t.termsCheck.isHidden()){console.log(j);if(j.dom.checked){g=true}else{g=false}}console.log(d,g);if(d||!g){t.errorMsg.show()}else{t.fireEvent("sendData",t,l);t.destroy()}},validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}},0,["datacaptureform"],["component","container","datacaptureform"],{component:true,container:true,datacaptureform:true},["widget.datacaptureform"],0,[InfinityMobile.view,"DataCaptureForm"],0));(Ext.cmd.derive("InfinityMobile.view.FullscreenImageGalleryItem",Ext.Container,{config:{pageNo:"",page:"",style:"color:white",cls:"innerhtmlfullheight"},initialize:function(){var a=this;a.on("painted",a.setImage,a,{delay:10,single:true})},setImage:function(){var a=this;a.imageurl=a.getPage().url;console.log("SETTING IMAGE",a.getPage().url);a.setHtml("<div class='backgroundImage' style='width:100%;height:100%;background:url("+a.imageurl+");background-position:center;background-size:contain;'></div>")}},0,["imagegalleryitem"],["component","container","imagegalleryitem"],{component:true,container:true,imagegalleryitem:true},["widget.imagegalleryitem"],0,[InfinityMobile.view,"FullscreenImageGalleryItem"],0));(Ext.cmd.derive("InfinityMobile.view.ImageCarousel",Ext.Carousel,{initialize:function(){var a=this;Ext.carousel.Carousel.prototype.initialize.call(this);a.on("activeitemchange","handleItemChange",this);a._visiblePages=Math.min(a._visiblePages,a.getData().length);a.setCards();Ext.Viewport.on("orientationchange",function(){if(a.isDestroyed==null){a.onSizeChange()}})},config:{indicator:false,data:false,pageNumber:0,skipActiveItemChange:true,pageTemplate:false,visiblePages:3,directionLock:true,landscapePageIncrement:1,mode:"single"},setPageTemplate:function(a){this.pageTemplate=a},setCards:function(){var j=this;j._skipActiveItemChange=true;var k=1;if(j._pageNumber==0){for(var e=0;e<j._visiblePages;e++){var b=(e*k);j.add(j.createCard(j.getData()[b],b,j.getData()))}j.setActiveItem(0)}else{if(j._pageNumber==(j.getData().length-1)){for(var e=(j._pageNumber-2);e<j.getData().length;e++){j.add(j.createCard(j.getData()[e],e,j.getData()))}j.setActiveItem(2)}else{var f=j._pageNumber;var a=j.createCard(j.getData()[f],f,j.getData());j.add(a);var c=parseFloat(j._pageNumber-(1*k));var d=j.createCard(j.getData()[c],c,j.getData());j.insert(0,d);var h=parseFloat(j._pageNumber)+(1*k);var g=j.createCard(j.getData()[h],h,j.getData());j.add(g);j.setActiveItem(1)}}j._skipActiveItemChange=false},handleItemChange:function(f,d,e,a){var c=this;var b=1;if(!c._skipActiveItemChange){if(d.getPageNo()>e.getPageNo()){if(e.getPageNo()==0||d.getPageNo()==(c.getData().length-1)){}else{c.addCardToFront(f,f.getItems().items[0],b)}c._pageNumber+=b;c._pageNumber=Math.min(c._pageNumber,(c.getData().length-1))}else{if(d.getPageNo()==0||e.getPageNo()==(c.getData().length-1)){}else{c.addCardToBack(f,f.getItems().items[2],b)}c._pageNumber-=b;c._pageNumber=Math.max(c._pageNumber,0)}}c.fireEvent("pagechange",c,d)},updateItemCSS:function(f,d){var e=this;var a=f.getItems().items;for(var c=0;c<a.length;c++){var b=a[c];if(b._itemId!=d._itemId){b.setCls("")}}d.setCls("selecteditem")},createCard:function(f,b,a,c){var e=this;var d;if(!e.pageTemplate){d={pageNo:b,html:"Page: "+b}}else{d=e.pageTemplate(f,b,a)}return d},addCardToFront:function(f,c,b){var d=this;c._skipActiveItemChange=true;f.remove(c,true);var a=1;var e=(d._pageNumber+b+a);e=Math.min(parseInt(e),(d.getData().length-1));f.add(d.createCard(d.getData()[e],e,d.getData()))},addCardToBack:function(f,a,c){var d=this;var b=1;if(a!=null){a._skipActiveItemChange=true;f.remove(a,true);var e=(d._pageNumber-c-b);e=Math.max(e,0);f.insert(0,d.createCard(d.getData()[e],e,d.getData()))}},jumpToFirst:function(){this.jumpToPage(0)},jumpToLast:function(){this.jumpToPage((this.getData().length-1))},jumpToPage:function(b){var c=this;var a=b;var a=Math.max(a,(this.getData().length-1));a=Math.min(a,0);if(b!=c._pageNumber){if(b==(c._pageNumber+1)){c.next()}else{if(b==(c._pageNumber-1)){c.previous()}else{c.removeAll(true);c._pageNumber=b;c.setCards()}}}}},0,["imagecarousel"],["component","container","carousel","imagecarousel"],{component:true,container:true,carousel:true,imagecarousel:true},["widget.imagecarousel"],0,[InfinityMobile.view,"ImageCarousel"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutAdvertView",InfinityMobile.view.LayoutView,{config:{advertState:false,style:"text:align:center"},initialize:function(){var a=this;InfinityMobile.view.LayoutView.prototype.initialize.apply(this,arguments);a.on("painted",a.initializePage,a,{delay:10,single:true});Ext.Viewport.on({scope:a})},initializePage:function(){var b=this;var a=b.getState(b.json,"adType","portrait");b.advertsArray=[];if(currentProfile=="tablet"){b.advertsArray.push("../assets/adverts/skyscraper-ad1.png");b.advertsArray.push("../assets/adverts/skyscraper-ad2.png")}else{b.advertsArray.push("../assets/adverts/banner-ad-1.png");b.advertsArray.push("../assets/adverts/banner-ad-2.png")}b.toggleAd()},loadDfpAd:function(){var e=this;var b=e.getState(e.json,"adNetwork","portrait");if(b==""){b="1234"}var c=e.getState(e.json,"adUnit","portrait");if(c==""){c="travel/asia/food"}var a=e.getState(e.json,"adWidth","portrait");if(a==""){a="768"}var d=e.getState(e.json,"adHeight","portrait");if(d==""){d="90"}var f="adBlock"},toggleAd:function(){var b=this;if(!b.getAdvertState()){var a=b.advertsArray[0];if(currentProfile=="tablet"){b.setHtml("<img src='"+a+"' style='width:120px; height:600' />")}else{b.setHtml("<div style='text-align:center'><img src='"+a+"' style='width:320px; max-width:100%;' /></div>")}}else{var a=b.advertsArray[1];if(currentProfile=="tablet"){b.setHtml("<img src='"+a+"' style='width:120px; height:600' />")}else{b.setHtml("<div style='text-align:center'><img src='"+a+"' style='width:320px; max-width:100%;' /></div>")}}b.setAdvertState(!b.getAdvertState())}},0,["layoutadvertview"],["component","container","layoutview","layoutadvertview"],{component:true,container:true,layoutview:true,layoutadvertview:true},["widget.layoutadvertview"],0,[InfinityMobile.view,"LayoutAdvertView"],0));(Ext.cmd.derive("InfinityMobile.view.LayoutTextFieldView",InfinityMobile.view.LayoutView,{config:{html:"<input style='width:100%; height:100%; border:none; background-color:rgba(0,0,0,0); color:red; padding:5px' placeholder='Searching' />"},initialize:function(){var a=this;console.log(a);a.input=a.element.down("input");InfinityMobile.view.LayoutView.prototype.initialize.apply(this,arguments);a.checkEvents()},layoutViewStyleOrientation:function(b,a,e){var d=this;var g=InfinityMobile.view.LayoutView.prototype.layoutViewStyleOrientation.apply(this,arguments);var c=d.getState(b,"textColor",a,e);d.input.dom.style.color=c;var f=d.getState(b,"placeHolder",a,e);d.input.dom.placeholder=f;return g},checkEvents:function(){var c=this;var a=c.json;if(a.events.onValueChange!=null){var b=a.events.onValueChange[0];c.input.on("change",function(){c.fireCustomEvent("onValueChange",b)})}},fireCustomEvent:function(a,c,d){var b=this;mainPanel.fireEvent("trapEvent",a,b.json,b.input.dom.value,null,null)}},0,["layouttextfieldview"],["component","container","layoutview","layouttextfieldview"],{component:true,container:true,layoutview:true,layouttextfieldview:true},["widget.layouttextfieldview"],0,[InfinityMobile.view,"LayoutTextFieldView"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderDownloadScreen",Ext.Container,{config:{fullscreen:true,style:"padding:0px; border-radius:0px;background-color:white;color: #4591B8; font-size:15px",layout:"vbox",pagesXml:"",items:[{itemId:"topBar",height:40,style:"background-color:#e6e6e6;",layout:"hbox",items:[{itemId:"backButton",height:"100%",width:"75px",padding:"10 10 10 5",layout:{type:"hbox",align:"center"},items:[{html:"<img src='../assets/download/back-arrow.png' style='height:20px' />",height:20},{width:5},{html:"Back"}]}]},{itemId:"content",flex:1,cls:"innerhtmlfullheight"}]},initialize:function(){var a=this;a.topBar=a.getComponent("topBar");a.backButton=a.topBar.getComponent("backButton");a.content=a.getComponent("content");a.pagesXml=a.getPagesXml();a.setBackListener();if(a.config.downloadUrl!=null){a.downloadUrl=a.config.downloadUrl;a.loadFrame()}},setBackListener:function(){var a=this;a.backButton.element.on("tap",function(){a.fireEvent("back",a)})},loadFrame:function(){var a=this;a.content.setHtml("<iframe src='"+a.downloadUrl+"' style='width:100%;height:inherit;border:none;' />")}},0,["downloadscreen"],["component","container","downloadscreen"],{component:true,container:true,downloadscreen:true},["widget.downloadscreen"],0,[InfinityMobile.view,"ReaderDownloadScreen"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderImageGalleryThumb",Ext.Container,{config:{width:140,margin:5},initialize:function(){var a=this;if(a.config.url!=null){a.url=a.config.url}if(a.config.carousel!=null){a.carousel=a.config.carousel}if(a.config.carouselType!=null){a.carouselType=a.config.carouselType}if(a.config.index!=null){a.index=a.config.index}if(a.url!=null){a.url=a.url.replace(/ /g,"%20")}var b=new Image();b.src=a.url;b.onload=function(){var c=this.naturalWidth/this.naturalHeight;a.setStyle({backgroundImage:"url("+a.url+")",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"})};a.element.on({tap:function(){var c=this;if(c.carousel.jumpToPage!=null){c.carousel.jumpToPage(parseInt(c.index))}else{c.carousel.setActiveItem(parseInt(c.index))}},scope:a})}},0,["readerimagegallerythumb"],["component","container","readerimagegallerythumb"],{component:true,container:true,readerimagegallerythumb:true},["widget.readerimagegallerythumb"],0,[InfinityMobile.view,"ReaderImageGalleryThumb"],0));(Ext.cmd.derive("InfinityMobile.view.ReaderPrompt",Ext.Container,{config:{modal:true,centered:true,width:"300px",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,items:[{id:"promptToolBar",height:40,padding:8,items:[{top:10,left:10}]},{id:"promptBodyContainer",padding:"10 20",layout:"vbox",flex:1,items:[{itemId:"promptContainerText",margin:"0 0 20px 0"},{itemId:"buttonArea",padding:"0 20px",layout:"hbox",items:[{itemId:"okBtn",cls:"pointerCursor",flex:1,padding:8,style:"text-align:center;margin: 5px;border-style:solid;background-color:#458FBB;width:120px;color:white;"}]}]}]},initialize:function(){var a=this;a.promptBody=a.getComponent("promptBodyContainer");a.btnArea=a.promptBody.getComponent("buttonArea");a.btn=a.btnArea.getComponent("okBtn");a.promptToolBar=a.getComponent("promptToolBar");a.promptContainerText=a.promptBody.getComponent("promptContainerText");a.checkValues();a.setMessage();a.promptToolBar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});a.btn.setHtml(language.ok);a.handleKeyDown();a.setupEvents()},handleKeyDown:function(){var a=this;a.keyDownFunction=window.onkeydown;window.onkeydown=null},checkValues:function(){var a=this;if(a.config.title!=null){a.title=a.config.title}if(a.config.message!=null){a.message=a.config.message}},setMessage:function(){var a=this;a.promptContainerText.setHtml(a.message);a.promptToolBar.setHtml(a.config.title)},setupEvents:function(){var a=this;a.btn.element.on({tap:function(){window.onkeydown=a.keyDownFunction;a.destroy()},scope:a})}},0,["readerprompt"],["component","container","readerprompt"],{component:true,container:true,readerprompt:true},["widget.readerprompt"],0,[InfinityMobile.view,"ReaderPrompt"],0));(Ext.cmd.derive("InfinityMobile.view.Ticker",Ext.Container,{config:{padding:"5px",zIndex:"1000000"},initialize:function(){var b=this;var a=b.config.url;b.str="";$.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q="+encodeURIComponent(a),dataType:"json",async:true,success:function(c){if(c.responseData.feed&&c.responseData.feed.entries){$.each(c.responseData.feed.entries,function(f,g){b.str+="<a class='tickerLink' href='"+g.link+"' target='_blank'>"+g.title+"</a>  &nbsp&nbsp&#9899&nbsp&nbsp  "})}b.str=b.str.substring(0,b.str.length-18);b.setHtml('<p class="marquee" style="color:white;">'+b.str+"</p>");b.element.dom.style.backgroundColor="#1e1e1e";b.element.dom.style.color="white";b.element.dom.style.overflow="hidden";try{document.styleSheets[0].insertRule("@keyframes marquee {0% { text-indent:100% ;} 100% {text-indent:"+(b.element.dom.children[0].scrollWidth*-1)+"px}}",0);if(window.navigator.appName=="Netscape"||window.navigator.appName=="Microsoft Internet Explorer"){b.element.dom.style.animation="marquee 50s linear infinite;"}}catch(d){console.log(d)}}})}},0,["ticker"],["component","container","ticker"],{component:true,container:true,ticker:true},["widget.ticker"],0,[InfinityMobile.view,"Ticker"],0));(Ext.cmd.derive("InfinityMobile.view.clippingError",Ext.Container,{config:{modal:true,centered:true,width:"300px",style:"background-color:white;border:1px solid black;border-radius:5px;padding:0px;",fullscreen:true,zIndex:1000000,items:[{id:"clippingPromptToolBar",height:40,items:[{top:10,left:10}]},{id:"clippingPromptBodyContainer",padding:"20",layout:"vbox",flex:1,items:[{itemId:"clippingPromptContainerText",margin:"0 0 20px 0"},{itemId:"buttonArea",padding:"20",layout:"hbox",items:[{itemId:"okBtn",cls:"pointerCursor",flex:1,style:"text-align:center;margin: 5px;border-style:solid;height:30px;background-color:#458FBB;width:120px;color:white;"}]}]}]},initialize:function(){var a=this;a.promptBody=a.getComponent("clippingPromptBodyContainer");a.btnArea=a.promptBody.getComponent("buttonArea");a.btn=a.btnArea.getComponent("okBtn");a.clippingPromptToolBar=a.getComponent("clippingPromptToolBar");a.clippingPromptContainerText=a.promptBody.getComponent("clippingPromptContainerText");a.clippingPromptContainerText.setHtml(language.clippings.invalidClippingText+"<br /><br />"+language.pleaseTryAgain);a.clippingPromptToolBar.setHtml(language.clippings.invalidClipping);a.clippingPromptToolBar.setStyle({color:"#"+settings.reader.overlayTitleBarTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.overlayTitleBarColour)+", 0.9)"});a.btn.setHtml(language.ok);a.btn.element.on({tap:a.onTap,scope:a});a.btn.setStyle({color:"#"+settings.reader.buttonTextColour,backgroundColor:"rgba("+hexToRgb(settings.reader.buttonColour)+",0.9)"});a.keyUpFunc=window.onkeypress;window.onkeypress=null},onTap:function(){var a=this;window.onkeypress=a.keyUpFunc;a.destroy()}},0,["clippingerror"],["component","container","clippingerror"],{component:true,container:true,clippingerror:true},["widget.clippingerror"],0,[InfinityMobile.view,"clippingError"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ArticleReaderPanelContainer",Ext.Container,{config:{cls:"articlereaderpanelcontainer",layout:{type:"hbox"},margin:"50 5 5 5",style:"display:inline;width:1540px;"},initialize:function(){var a=this;a.setStyle("height:"+($(document).height()-120)+"px;")},onResize:function(){var a=this;if(a!=null){a.setStyle("height:"+($(document).height()-120)+"px;")}}},0,["articlereaderpanelcontainer"],["component","container","articlereaderpanelcontainer"],{component:true,container:true,articlereaderpanelcontainer:true},["widget.articlereaderpanelcontainer"],0,[InfinityMobile.view.desktop,"ArticleReaderPanelContainer"],0));(Ext.cmd.derive("InfinityMobile.view.desktop.ReaderLiveArticlePopoverItem",Ext.Container,{config:{mediaObject:"",pageNo:"",page:"",cls:"loading",style:"background-color:white",layout:"vbox",items:[{itemId:"content",flex:1,padding:"0 0 10px 0"}]},initialize:function(){var a=this;a.content=a.getComponent("content");a.setContentStyle();a.on("painted",a.getContent,a,{delay:10,single:true});a.element.down(".x-container").dom.style.overflow="hidden";a.element.down(".x-container").dom.style.overflowY="scroll"},setContentStyle:function(){var a=this;if(currentProfile=="tablet"){a.content.setPadding("0 20px 0 20px")}},getContent:function(){var j=this;var e=Ext.getStore("SettingStore");if(e.data.items[0].raw.reader.popupAdvert!=null){var f=e.data.items[0].raw.reader.popupAdvert.position;if(f=="top"){switch(currentProfile){case"phone":var g=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var g=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break}j.add(g);g.show()}}var k="";if(j.getPage().headdeck!=null){k="<div class='contentDeck font25'></div><br />"}var b="";if(j.getPage().images!=null){b="<div class='contentImages' >";for(var d=0;d<j.getPage().images.length;d++){b+="<div class='contentImage'><img src='"+j.getPage().images[d].url+"' /></div>"}b+="</div><br />"}var h="<div class='contentHead font35' >"+j.getPage().headline+"</div><br />"+k+b+"<div class='contentByline font15'>"+j.getPage().byline+"</div><br /><div class='contentBody font15'>"+j.getPage().content+"</div><br />";var a=h.match(/<body[^>]*>([^<]*(?:(?!<\/?body)<[^<]*)*)<\/body\s*>/i);if(a){h=a[1]}h+="<script>setText()<\/script>";console.log(j.getPage());if(j.getPage().link!=null){h+="<br /><br /><p class='fullStoryLink' ontouchstart='window.open(\""+j.getPage().link+"\")' onclick='window.open(\""+j.getPage().link+"\")'>Click here to view full story</p>"}j.removeSpinner();j.content.setHtml(h);j.setImages();if(j.content.element!=null){setText(j.content.element.dom)}j.setStyle({visibility:"inherit"});if(e.data.items[0].raw.reader.popupAdvert!=null){if(f=="bottom"){switch(currentProfile){case"phone":var c=Ext.create("InfinityMobile.view.phone.ArticlePopoverAd",{});break;case"tablet":var c=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{});break;case"desktop":var c=Ext.create("InfinityMobile.view.tablet.ArticlePopoverAd",{padding:"10px 0 0 0"});break}j.add(c);c.show()}}},removeSpinner:function(){var a=this;a.removeCls("loading")},setImages:function(){var f=this;var d=1;var c=1;var b=f.id;if(currentProfile=="tablet"){var e=$("#"+b+" img").get(0);if(e!=null){if(e.naturalWidth==0){e.onload=function(){var g=this;if(g.naturalWidth<(screen.width/2)){var h=$("#"+b+" .articleContent")[0];h.className="articleContent float"}}}}}if($("#"+b+" .contentImage").size()>1){if(currentProfile=="phone"){$("#"+b+" .nextImage")[0].childNodes[0].textContent="NEXT";$("#"+b+" .previousImage")[0].childNodes[0].textContent="PREVIOUS"}c=$("#"+b+" .contentImage").size();if(c>1){$("#"+b+" .contentImage:gt(0)").hide();$("#"+b+" .previousImage").hide();a()}else{if(c==1){$("#"+b+" .imageControls").hide()}}$("#"+b+" .nextImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").next();h.hide();d++;a();g.fadeIn();$("#"+b+" .previousImage").show();if(g.is("#"+b+" .contentImage:last")){$("#"+b+" .nextImage").hide()}});$("#"+b+" .previousImage").click(function(){var h=$("#"+b+" .contentImage:visible");var g=$("#"+b+" .contentImage:visible").prev();h.hide();d--;a();g.fadeIn();$("#"+b+" .nextImage").show();if(g.is("#"+b+" .contentImage:first")){$("#"+b+" .previousImage").hide()}})}else{$("#"+b+" .imageControls").hide()}function a(){var g="Image "+d.toString()+" of "+c.toString();$("#"+b+" .imageCount").text(g)}}},0,["readerlivearticlepopoveritem"],["component","container","readerlivearticlepopoveritem"],{component:true,container:true,readerlivearticlepopoveritem:true},["widget.readerlivearticlepopoveritem"],0,[InfinityMobile.view.desktop,"ReaderLiveArticlePopoverItem"],0));