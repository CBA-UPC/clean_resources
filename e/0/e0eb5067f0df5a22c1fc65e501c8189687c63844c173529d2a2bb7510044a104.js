(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[38],{"/5so":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("mgFK");function a(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return t.isMsa?[4,Object(r.a)("consumerInstallInfo",e)]:[2,null];case 1:return[2,n.sent()||null]}}))}))}},"28zg":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("QjXU"),r=n("MJsD"),a=n("B5kz"),o=n("gCKw"),c=n("mJgL"),u=n("W7wX"),s=n("s1V1"),l=n("ohjr"),d=n("8VPm");function f(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,a.a.fetchQuery([e.key],(function(){var t={featureGatesPromise:Object(o.a)(),featureSettingsPromise:Object(c.a)(),userEntitlementsPromise:Object(s.a)(),contextPromise:Object(r.a)(),identityPromise:Object(u.a)()};return Object(l.a)(t,e)}),d.a)];case 1:return[2,t.sent()]}}))}))}},"6MXh":function(e,t,n){"use strict";function i(e,t,n,i,r,a,o,c){if(void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),void 0===c&&(c=!1),!document)return null;if(r){var u=document.getElementById(r);if(null!=u)return t&&t(),u}var s=document.createElement("script");if(s.src=e,r&&(s.id=r),t&&(s.onload=t),n&&(s.onerror=function(){var e;n(),o&&(null===(e=s.parentNode)||void 0===e||e.removeChild(s))}),a&&(s.crossOrigin="anonymous"),c&&(s.async=!0),i){var l=document.getElementsByTagName("script")[0];if(l&&l.parentNode)return l.parentNode.insertBefore(s,l)}return document.body.appendChild(s)}n.d(t,"a",(function(){return i}))},CDFH:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("mgFK");function a(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return t.isMsa?[4,Object(r.a)("workloadPublicData",e)]:[2,null];case 1:return[2,n.sent()||null]}}))}))}},CDuu:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("MJsD"),r=n("B5kz"),a=n("gCKw"),o=n("mJgL"),c=n("W7wX"),u=n("s1V1"),s=n("ohjr"),l=n("8VPm");function d(e){var t=[e.key];return Object(r.c)(t,(function(){var t={featureGatesPromise:Object(a.a)(),featureSettingsPromise:Object(o.a)(),userEntitlementsPromise:Object(u.a)(),contextPromise:Object(i.a)(),identityPromise:Object(c.a)()};return Object(s.a)(t,e)}),l.a)}},"Coo+":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("NrNW"),r=n("B5kz"),a=n("CaQ9"),o=n("+vVg"),c=n("bIL4");function u(){var e=Object(i.a)().data,t=Object(a.a)().data;return Object(r.c)(c.b,(function(){return Object(o.a)(t,e)}),{staleTime:1/0,cacheTime:1/0,enabled:e&&t})}},"D/tM":"DCX/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),r=n("28zg"),a=n("ddw+");function o(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Object(r.a)(a.a)]}))}))}},GeVZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function r(e){if(e&&e.length){var t=e.match(i);if(t)return{href:e,protocol:t[1],host:t[2],hostname:t[3],port:t[4],path:t[5],search:t[6],hash:t[7]}}}},NZpx:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("CDuu"),r=n("ddw+");function a(){return Object(i.a)(r.a)}},P8ZZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("NrNW"),r=n("B5kz"),a=n("CaQ9"),o=n("CDFH");function c(){var e=Object(i.a)().data,t=Object(a.a)().data;return Object(r.c)(["WorkloadPublicDataConfig"],(function(){return Object(o.a)(e,t)}),{cacheTime:1/0,staleTime:1/0,enabled:!!e&&!!t})}},S6Pj:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return!!e&&e.focus instanceof Function&&e!==document.body}},aADZ:function(e,t,n){"use strict";function i(e){if(void 0===e)return NaN;var t=parseInt(e);return Number.isNaN(t)?NaN:t}n.d(t,"a",(function(){return i}))},bcUD:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("QjXU"),r=n("CaQ9"),a=n("wVmX"),o=n("Coo+"),c=n("mXGw"),u=n("S6Pj"),s=n("a3FV"),l=n("MJsD"),d=n("B5kz"),f=n("CMIS"),m=n("Wa5Y"),v={dime:void 0,dimeDisabled:!1,dimeLoadPromise:void 0},b=n("W7wX"),O=n("cenr"),p=n("Dn7E"),j=function(e){var t=e.eventName,n=e.dimeExperience,r=e.result,a=void 0===r?"":r,o=e.metaData,c=void 0===o?"":o,u=e.extraInfo,s=void 0===u?"":u;return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var e,r,o,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:e="",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(b.a)()];case 2:return(null==(r=i.sent())?void 0:r.userCountryCode)&&(e=null==r?void 0:r.userCountryCode),[3,4];case 3:return i.sent(),[3,4];case 4:if((o={}).DimeExperience=n,o.State=a,o.UserCountryCode=e,u=s?s+";":"","string"==typeof c&&c)u+=c;else try{u+=JSON.stringify(c)}catch(e){}return o.DebugInfo=u,Object(O.a)(t,o),Object(p.a)({featureName:"Upsell",eventName:t,area:"Other",params:{DimeExperience:n,State:a,DebugInfo:u,UserCountryCode:e}}),[2]}}))}))},h=n("GeVZ"),_=n("Ot9e"),g=n("6MXh"),w=function(e){var t=e.dimeJSUrl,n=e.puid,r=e.upn,a=e.pwaEnabled,o=e.preferredCulture,c=e.sessionId;return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return v.dimeLoadPromise||(performance.mark("LoadDimeScript_Started"),v.dimeLoadPromise=new Promise((function(e){Object(g.a)(t,(function(){j({eventName:s.a.DimeLoadScript,dimeExperience:"",result:"Succeeded"}),performance.mark("LoadDimeScript_Completed"),function(e,t,n,r,a){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var o;return Object(i.__generator)(this,(function(i){if(v.dime)return[2,1];if(v.dimeDisabled)return[2,2];if("undefined"==typeof Dime)throw v.dimeDisabled=!0,j({eventName:s.a.DimeInitialize,dimeExperience:"",result:"Failed",metaData:"Dime Undefined"}),new Error("Unable to initialize. Dime is undefined.");performance.mark("DimeInitialize_Start"),o={partnerId:n?"officepwa":"officedotcom",language:r,sessionId:a,authHint:n?e:t,userInfo:{puid:e}};try{return v.dime=new Dime(o),performance.mark("DimeInitialize_Complete"),j({eventName:s.a.DimeInitialize,dimeExperience:"",result:"Succeeded"}),[2,1]}catch(e){throw v.dimeDisabled=!0,j({eventName:s.a.DimeInitialize,dimeExperience:"",result:"Failed",metaData:e&&"object"==typeof e?e:void 0}),new Error("Error encountered while initializing Dime.")}return[2]}))}))}(n,r,a,o,c).then((function(){e(1)})).catch((function(){e(2)}))}),(function(){j({eventName:s.a.DimeLoadScript,dimeExperience:"",result:"Failed"}),e(2)}),!1,"dimeScriptReact")}))),[2,v.dimeLoadPromise]}))}))},D=function(e){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([n.e(4),n.e(105)]).then(n.bind(null,"DZQ9"))];case 1:return t.sent().launchUrl(e,{action:"Upsell"}),[2]}}))}))};var C=n("gB6C"),P=n("pdjy"),N=(n("DCX/"),n("m118"),[]),E=n("rbGx"),S=n("NZpx"),I=n("NrNW"),k=n("kPR3"),y=function(e){var t,n=e.experiences,b=e.disableSubscriptionCheck,O=void 0!==b&&b,p=e.disableWarmup,g=void 0!==p&&p,y=function(){var e=Object(I.a)().data,t=Object(k.a)().data,n=Object(S.a)().data,i=Object(r.a)().data;return Object(c.useMemo)((function(){if(e&&t&&n&&i)return{dimeJSUrl:t.dimeJSUrl,dimeTimeoutMs:t.dimeTimeoutMs,preferredCulture:e.preferredCulture,puid:i.puid,pwaEnabled:n.pwaEnabled,sessionId:e.sessionId,upn:i.userPrincipalName||""}}),[n,e,t,i])}(),U=Object(c.useContext)(E.a),x=Object(o.a)().data,T=Object(r.a)().data,F=Object(a.a)(),L=Object(c.useCallback)((function(e,t){y&&function(e){var t,n=e.dimeActionCreators,r=e.dimeExperience,a=e.dimeJSUrl,o=e.dimeTimeoutMs,c=e.preferredCulture,b=e.puid,O=e.pwaEnabled,p=e.sessionId,g=e.targetUrl,C=e.upn;Object(i.__awaiter)(this,void 0,void 0,(function(){var e,P,N,E,S,I,k;return Object(i.__generator)(this,(function(y){switch(y.label){case 0:return v.dimeDisabled?(j({eventName:s.a.DimeLaunch,dimeExperience:r,result:"Failed",metaData:"RedirectToPOC;DimeDisabled"}),D(g),[2]):(e=null,P=w({dimeJSUrl:a,puid:b,upn:C,pwaEnabled:O,preferredCulture:c,sessionId:p}),N=new Promise((function(t){e=setTimeout((,o)})),[4,Promise.race([P,N])]);case 1:if(E=y.sent(),e&&clearTimeout(e),1!==E)return v.dimeDisabled=!0,j({eventName:s.a.DimeLaunch,dimeExperience:r,result:"Failed",metaData:"TimeOut"}),[2];try{S=function(e){if(e&&e.indexOf("ocid=")>0){var t=Object(h.a)(e);if(t){var n=Object(_.a)(t.search);return""!==n.ocid?n.ocid:"PROD_OfficeCom"}}return"PROD_OfficeCom"}(g),I={experience:r,campaignId:S},j({eventName:s.a.DimeLaunch,dimeExperience:r,result:"Start"}),null==n||n.setDialogState("Open"),k=document.activeElement,null===(t=v.dime)||void 0===t||t.launch(I,(function(){j({eventName:s.a.DimeTransactionCompleted,dimeExperience:r}),null==n||n.setConvertedToPaid(!0),function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(l.a)()];case 1:return[4,(e=i.sent()).getIdentity()];case 2:return t=i.sent(),n={headers:(a={accept:"application/json"},a["X-OfficeHome-UserId"]=t.puid,a["X-OfficeHome-TenantId"]=t.tenantId,a)},r="".concat(e.officeHomeApiRoot,"/api/workloadpublicdata/consumer"),r="".concat(r,"?forceRefresh=true"),[2,Object(m.a)(s.a.OfficeConsumerWorkloadPublicDataFetch,"Office_Consumer_Workload_Public_Data_Fetch",r,n,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome").then((function(e){if(!e.data)throw new Error("No data returned from Consumer workload public data endpoint");return function(e){var t=["WorkloadPublicDataConfig"];d.a.cancelQueries(t),d.a.setQueryData(t,e)}(e.data),e.data})).catch((function(e){Object(f.a)({eventName:s.a.OfficeConsumerWorkloadPublicDataFetch,message:"Failed to get consumer workload public data with error: ".concat(e)})}))]}}))}))}().then((function(e){j(e?{eventName:s.a.DimeForceRefreshWorkloadPublicData,dimeExperience:r,result:"",metaData:{hasBusinessLicense:e.hasBusinessLicense}}:{eventName:s.a.DimeForceRefreshWorkloadPublicData,dimeExperience:r,result:"Failed",metaData:"NoResponse"})})).catch((function(e){j({eventName:s.a.DimeForceRefreshWorkloadPublicData,dimeExperience:r,result:"Failed",metaData:e})}))})).then((function(e){j({eventName:s.a.DimeCompleted,dimeExperience:r,result:null==e?void 0:e.status,metaData:null==e?void 0:e.metaData}),null==n||n.setDialogState("Closed"),Object(u.a)(k)&&(null==k||k.focus())}))}catch(e){v.dimeDisabled=!0,j({eventName:s.a.DimeLaunch,dimeExperience:r,result:"Failed",metaData:e&&"object"==typeof e?e:void 0,extraInfo:"RedirectToPOC;LaunchException"}),D(g)}return[2]}}))}))}(Object(i.__assign)(Object(i.__assign)({},y),{dimeActionCreators:U,dimeExperience:e,targetUrl:t}))}),[y,U]);return Object(c.useMemo)((function(){var e;if((null==T?void 0:T.isMsa)&&(!F||O)&&!(null==T?void 0:T.isPipl)&&(null===(e=null==x?void 0:x.result)||void 0===e?void 0:e.ShowConsumerUpsell))return g||function(e,t){t&&(t.pwaEnabled&&(null===window||void 0===window?void 0:window.prelaunchmode)||e.forEach((function(e){!function(e,t){-1===N.indexOf(e)&&(N.push(e),j({eventName:s.a.DimeWarmup,dimeExperience:e}),function(e,t){Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return Object(C.a)((function(){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,w(t)];case 1:return 1===n.sent()&&function(e){if(v.dime){performance.mark("DimePreload_Start");var t=e.experiences.toString();j({eventName:s.a.DimePreload,dimeExperience:t,result:"Start"}),v.dime.preload(e).catch((function(e){j({eventName:s.a.DimePreload,dimeExperience:t,result:"Failed",metaData:e&&"object"==typeof e?e:void 0})}))}}(e),[2]}}))}))}),P.d),[2]}))}))}({experiences:[e]},t))}(e,t)})))}(n,y),L}),[O,g,L,n,null==T?void 0:T.isMsa,null==T?void 0:T.isPipl,F,y,null===(t=null==x?void 0:x.result)||void 0===t?void 0:t.ShowConsumerUpsell])}},"faO/":gCKw:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("QjXU"),r=n("MJsD"),a=n("B5kz"),o=n("W7wX"),c=n("XcEc");function u(){var e=this;return a.a.fetchQuery(["FeatureGates"],(function(){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e,t,n;return Object(i.__generator)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([Object(r.a)(),Object(o.a)()])];case 1:return e=i.__read.apply(void 0,[a.sent(),2]),t=e[0],n=e[1],[2,Object(c.a)(n,t)]}}))}))}),{staleTime:1/0,cacheTime:1/0})}},gYHC:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),r=n("mgFK"),a=n("aADZ"),o={key:"InstallConfig",isGetClientGeneratedConfigEnabled:getClientGeneratedConfig:function(e){var t,n,i,r,o,c,u,s,l,d,f,m,v,b,O=e.featureGates,p=e.featureSettings,j=e.componentContext.preferredCulture,h=p.install,_=null!==(n=null===(t=O.ecsInstallNoLicenseOptionsGates)||void 0===t?void 0:t.ecsInstallNoLicenseOptionsEnabled)&&void 0!==n&&n,g=null!==(r=null===(i=O.installGates)||void 0===i?void 0:i.installPwaInstallMoveEnabled)&&void 0!==r&&r,w=null!==(o=null==h?void 0:h.buyOffice365Url)&&void 0!==o?o:"",D=null!==(c=null==h?void 0:h.consumerDirectInstallUrl)&&void 0!==c?c:"",C=null!==(u=null==h?void 0:h.consumerInstallLink)&&void 0!==u?u:"",P=null!==(s=null==h?void 0:h.consumerSSUInstallLink)&&void 0!==s?s:"",N=null!==(l=null==h?void 0:h.dimeJSUrl)&&void 0!==l?l:"",E=Object(a.a)(null!==(d=null==h?void 0:h.dimeTimeoutMs)&&void 0!==d?d:"5000"),S=null!==(f=null==h?void 0:h.goPremiumUrl)&&void 0!==f?f:"",I=null!==(m=null==h?void 0:h.haveOfficeProductKeyUrl)&&void 0!==m?m:"",k=null!==(v=null==h?void 0:h.installApiRoot)&&void 0!==v?v:"",y=null!==(b=null==h?void 0:h.needHelpInstallingOfficeUrl)&&void 0!==b?b:"";return{buyOffice365Url:w,commercialMySoftwarePageUrl:function(e){var t,n=null===(t=e.resources)||void 0===t?void 0:t.adminPortalRootUrl;return n?"".concat(n,"/account#installs"):""}(p),consumerDirectInstallUrl:D,consumerInstallLink:C,consumerSSUInstallLink:P.replace("{0}",j),dimeJSUrl:N,dimeTimeoutMs:E,ecsInstallNoLicenseOptionsEnabled:_,goPremiumUrl:S,haveOfficeProductKeyUrl:I,installApiRoot:k,needHelpInstallingOfficeUrl:y,pwaInstallMoveEnabled:g}},getServerGeneratedConfig:function(e){return function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(r.a)("installConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}}},kPR3:m118:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),r=n("28zg"),a=n("gYHC");function o(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Object(r.a)(a.a)]}))}))}},mJgL:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("QjXU"),r=n("MJsD"),a=n("B5kz"),o=n("W7wX"),c=n("yNE0");function u(){var e=this;return a.a.fetchQuery(["FeatureSettings"],(function(){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e,t,n;return Object(i.__generator)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([Object(r.a)(),Object(o.a)()])];case 1:return e=i.__read.apply(void 0,[a.sent(),2]),t=e[0],n=e[1],[2,Object(c.a)(n,t)]}}))}))}),{staleTime:1/0,cacheTime:1/0})}},vz6o:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("D/tM"),r=function(e){var t=e.consumerInstallConfig,n=e.workloadPublicDataConfig;return!!(null==n?void 0:n.hasBusinessLicense)||!!t&&function(e){return e!==i.a.NotSubscribed&&e!==i.a.NotDetected&&e!==i.a.NonActive&&e!==i.a.Perpetual&&e!==i.a.Perpetual2019}(t.currentSkuInfo.skuType)}},wVmX:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("zsD3"),r=n("P8ZZ"),a=n("mXGw"),o=n("vz6o"),c=function(){var e=Object(i.a)().data,t=Object(r.a)().data;return Object(a.useMemo)((,[e,t])}},yNE0:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("QjXU"),r=n("mgFK"),a=n("CRHC"),o=n("m32Q"),c=n("lkvL"),u=n("a3FV"),s=n("0TX8"),l=n("Wa5Y");function d(e,t,n,r,a,o,c){return Object(i.__awaiter)(this,void 0,void 0,(function(){var d,f,m;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:d={},f={method:"GET",responseType:"json",url:"".concat(r,"/api/featureSettings")},i.label=1;case 1:return i.trys.push([1,4,,5]),[4,Object(s.a)(f,n,a,t)];case 2:return i.sent(),[4,Object(l.a)(u.a.FeatureSettingsRequest,"FeatureSettings",f.url,f,c,o,r,e,"OfficeHome",{})];case 3:return(m=i.sent().data)?[2,m]:[3,5];case 4:return i.sent(),[3,5];case 5:return[2,d]}}))}))}var f="featureSettings";function m(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(r.a)(f,e)];case 1:return[2,t.sent()]}}))}))}function v(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return[2,Object(a.a)((function(){return function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,m(t)];case 1:return void 0!==(n=i.sent())?[3,3]:[4,d(t.correlationId,(,t.inMockMode,t.officeHomeApiRoot,t.workload,t.getAccessToken,t.jwtAuthEnabled)];case 2:n=i.sent(),i.label=3;case 3:return[2,n]}}))}))}(e,t)}),(function(){return Object(o.a)({userId:e.puid,collectionName:f,collectionVersion:1,key:f})}),(function(t){return Object(c.a)({userId:e.puid,collectionName:f,collectionVersion:1,key:f,data:0===Object.keys(t).length?null:t})}))]}))}))}},zsD3:function(e,t,n){"use strict";n.d(t,"a",();var i=n("NrNW"),r=n("B5kz"),a=n("CaQ9"),o=n("/5so");function c(){var e=Object(i.a)().data,t=Object(a.a)().data;return Object(r.c)(["ConsumerInstallInfoConfig"],(,{cacheTime:1/0,staleTime:1/0,enabled:!!e&&!!t})}}}]);
//# sourceMappingURL=38.b642e7f2968bccdde95e.chunk.v7.js.map