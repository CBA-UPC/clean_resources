(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{1041:function(t,e,n){"use strict";n.r(e);var a=n(974),s=n(894),i=n(526),o=n(38),c=n(654),m=n(507),r={components:{BaseSpinner:n(515).a,BaseButton:m.a,CommentWysiwyg:CommentWysiwygSkeleton:a.a,UserProfileAvatarLegacy:s.a,BaseRecaptcha:,props:{comment:{type:Object,required:!0}},data:computed:{buttonDisabled(){return!this.commentContent.content||this.originalCommentContent===this.commentContent.content},isOwncaptcha,createdmethods:{async load(){const t=Object(o.c)(this.comment.commentId);await this.$options.components.CommentWysiwyg(),this.commentContent=await t,this.keepOriginalContent("load")},async save(){try{const t=this.captcha?await this.$refs.captcha.execute():null;await this.$store.dispatch("comments/update",{async:Object(o.l)(Object.assign({},this.commentContent,{mentions:this.$refs.wysiwyg.updateMentions(),shortcodes:this.$refs.wysiwyg.updateShortcodes(),commentId:this.comment.commentId}),t).then(().finally(Object(c.a)(this,"saving"))}),await this.$refs.wysiwyg.clearRestore(),this.track("submit_comment","contribution"),this.$emit("saved"),this.$emit("update:edit",!1)}catch(t){this.track("submit_comment_error","engagement")}},keepOriginalContent(t){("load"===t||"init"===t&&!this.editorInitTimedOut)&&(this.originalCommentContent=this.commentContent.content)},cancel(){this.track("cancel_comment_edit_form"),this.$emit("canceled"),this.$emit("update:edit",!1)},track(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"engagement";Object(i.a)().record({category:"comment_edit_form",action:t,label:e})},onEditorReady(){this.$emit("ready"),setTimeout((,100)}}},l=r,d=n(45),h=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("section",{staticClass:"comments-item-inner space--h-3 space--v-3 space--fromW3-h-4 comments-item-inner--edit",attrs:{id:"comment-edit-form"}},[e("div",{staticClass:"flex boxAlign-jc--all-c"},[e("UserProfileAvatarLegacy",{staticClass:"comment-avatar flex--shrink-0",attrs:{user:t.comment.user,"avatar-class":"width--all-12 height--all-full"}}),e("div",{staticClass:"flex--grow-1"},[t.commentContent?e("CommentWysiwyg",t._b({ref:"wysiwyg",attrs:{disabled:t.saving},on:{"~update":ready:t.onEditorReady},scopedSlots:t._u([{key:"action",fn:function(){return[e("BaseButton",{staticClass:"button--toW3-square space--ml-a",attrs:{variant:"tertiary",mode:"default"},on:{click:t.cancel}},[e("BaseIcon",{attrs:{name:"cross"}}),e("span",{staticClass:"hide--toW3 space--ml-2"},[t._v(t._s("Annuler"))])],1),e("BaseButton",{staticClass:"button--toW3-square space--ml-1",attrs:{variant:"primary",mode:"brand",seal:t.saving,disabled:t.buttonDisabled},on:{click:t.save}},[t.saving?e("BaseSpinner",{staticClass:"spinner--centered"}):t._e(),e("BaseIcon",{attrs:{name:"tick"}}),e("span",{staticClass:"hide--toW3 space--ml-2"},[t._v(t._s("Mettre Ã  jour"))])],1)]},proxy:!0}],null,!1,2823831227)},"CommentWysiwyg",t.commentContent,!1,!0)):e("CommentWysiwygSkeleton",{attrs:{loading:""}}),t.captcha?e("BaseRecaptcha",{ref:"captcha"}):t._e()],1)],1)])}),[],!1,null,null,null);e.default=h.exports}}]);