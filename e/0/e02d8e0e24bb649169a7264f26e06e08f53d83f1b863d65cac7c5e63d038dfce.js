(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{1266:function(t,e,i){"use strict";i.r(e);var s=i(5),a=i(1103),n=i(93),r=i(509),l=i(821),o=i(872),c=i(811),u=i(507),d=i(17),h=i(155),p=i(87),m=i(589),k=i(564),f=i(890),b=i(845),L=i(965),g=i(846),v=i(1117),_={components:{BaseButton:u.a,ControlLoader:o.a,FormRow:r.o,ThreadDuplicates:l.a,ControlLinkErrors:c.a,CheckLinkDuplicates:f.a,CheckBlockedLinks:b.a,GetLinkSuggestion:L.a,GetLinkMerchantSuggestion:g.a,EventTrigger:v.a,FormInputLabeled:r.i,FormInputIcon:r.h,FormInputButton:r.g},mixins:[m.b],props:{},data:()=>Object.assign({},Object(p.d)({thread:{namespace:"threadForm",path:"thread",deep:!0}}),{submitLink:"",hasDuplicates:!1,hasErrors:!1}),computed:{canSubmit(){return!this.hasDuplicates&&!this.hasErrors},dealType:()=>d.a,duplicatesFilter:()=>({type:{ne:d.g}})},validations:()=>({link:[Object(k.n)(!0)]}),watch:{"thread.link"(){this.resetLinkData()}},methods:Object.assign({},Object(n.b)("threadForm",["removeAllGalleryImages"]),{resetLink(){this.thread.link="",this.hasDuplicates=!1,this.hasErrors=!1,this.resetLinkData()},resetLinkData(){this.submitLink="",this.$v.clear("link"),this.removeAllGalleryImages()},async validateLink(){await this.$v.validate("link",this.thread.link)},async submit(){await this.validateLink(),!this.$v.error.link&&this.thread.link&&(this.submitLink=this.thread.link)},showFullForm(){Object(h.b)({type:"submit",target:this.$el}),this.$emit("show-full-form")},continueWithLink(){this.showFullForm()},submitWithoutLink(){this.resetLink(),this.$emit("show-full-form")},setDuplicates(t){let{hasDuplicates:e}=t;this.hasDuplicates=e},setLinkErrors(t){let{hasErrors:e}=t;this.hasErrors=e}})},w=i(45),D=Object(w.a)(_,(function(){var t=this,e=t._self._c;return e("section",{directives:[{name:"track",rawName:"v-track:linkForm.view",value:{type:t.dealType},expression:"{ type: dealType }",arg:"linkForm",modifiers:{view:!0}}],staticClass:"flex flex--dir-col flex--grow-1 space--fromW2-h-4 space--h-3 space--t-3 space--b-2"},[e("div",{staticClass:"flex--grow-1 space--mb-3"},[e("h1",{staticClass:"size--all-xxxl size--fromW2-xxl text--b text--color-charcoalTint space--t-3"},[t._v(" "+t._s("Comparte una oferta con millones de personas")+" ")]),e("p",{staticClass:"size--all-l text--color-greyShade space--mt-3 space--fromW2-mt-1 space--mb-3"},[t._v(" "+t._s("Pega el link donde se puede comprar la oferta o encontrar más información")+" ")]),e("form",{staticClass:"width--all-12",on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"flex boxAlign-ai--all-c"},[e("div",{staticClass:"flex--grow-1"},[e("ol",[e("FormRow",[e("FormInputLabeled",{attrs:{id:"link",inputmode:"url",name:"link",placeholder:"https://www.pagina.com/oferta..."},on:{change:t.validateLink},scopedSlots:t._u([{key:"prependIcon",fn:function(){return[e("FormInputIcon",{attrs:{name:"link"}})]},proxy:!0},{key:"appendButton",fn:function(){return[t.thread.link?e("FormInputButton",{on:{click:t.resetLink}}):t._e()]},proxy:!0}]),model:{value:t.thread.link,callback:function(e){t.$set(t.thread,"link","string"==typeof e?e.trim():e)},expression:"thread.link"}})],1)],1)]),t.canSubmit?e("div",{staticClass:"hide--toW2 space--ml-2"},[e("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithLink.click",arg:"submitWithLink",modifiers:{click:!0}}],staticClass:"width--all-12",attrs:{variant:"primary",mode:"brand",type:"submit",disabled:!t.thread.link}},[t._v(" "+t._s("¡Empecemos!")+" ")])],1):t._e()]),t.submitLink?e("CheckBlockedLinks",{attrs:{link:t.submitLink},on:{request:t.setLinkErrors},scopedSlots:t._u([{key:"default",fn:function({isLoading:i,hasErrors:s,errors:a}){return[s?e("ControlLinkErrors",{attrs:{"error-messages":a},on:{cancel:t.resetLink}}):e("CheckLinkDuplicates",{attrs:{link:t.submitLink,filter:t.duplicatesFilter},on:{request:t.setDuplicates},scopedSlots:t._u([{key:"default",fn:function({isLoading:a,hasDuplicates:n,duplicates:r,isSoftDuplicates:l}){return[e("div",[e("GetLinkSuggestion",{attrs:{link:t.submitLink,"keep-alive":!i}}),e("GetLinkMerchantSuggestion",{attrs:{link:t.submitLink,"keep-alive":!i}}),i||a?e("ControlLoader",[t._v(t._s("Checando duplicados"))]):n?e("ThreadDuplicates",{attrs:{type:t.dealType,threads:r,"is-soft-duplicates":l},on:{cancel:t.resetLink,continue:t.continueWithLink}}):t._e(),e("EventTrigger",{attrs:{"is-loading":i||a,"has-errors":s||n},on:{trigger:t.showFullForm}})],1)]}}],null,!0)})]}}],null,!1,2951915348)}):t._e(),e("ControlLinkErrors",{attrs:{"error-messages":t.$v.messages.link},on:{cancel:t.resetLink}}),t.canSubmit?e("div",{staticClass:"hide--fromW2 space--mt-3"},[e("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithLink.click",arg:"submitWithLink",modifiers:{click:!0}}],staticClass:"width--all-12 space--mb-3",attrs:{variant:"primary",mode:"brand",type:"submit",disabled:!t.thread.link}},[t._v(" "+t._s("¡Empecemos!")+" ")])],1):t._e()],1)]),t.canSubmit?e("div",{staticClass:"hAlign--all-c"},[e("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithoutLink.click",arg:"submitWithoutLink",modifiers:{click:!0}}],attrs:{variant:"tertiary",mode:"default"},on:{click:t.submitWithoutLink}},[t._v(" "+t._s("No se necesita link")+" ")])],1):t._e()])}),[],!1,null,null,null),y=D.exports,S=Object(s.defineComponent)({__name:"deal-submission-wizard",setup:t=>({__sfc:!0,ThreadSubmissionWizardContent:a.a,DealSubmissionLinkForm:y,DEAL_TYPE:d.a})}),F=Object(w.a)(S,(function(){var t=this,e=t._self._c,i=t._self._setupProxy;return e(i.ThreadSubmissionWizardContent,{attrs:{"thread-type":i.DEAL_TYPE}},[e(i.DealSubmissionLinkForm,{staticClass:"flex--grow-1",on:{"show-full-form":function(e){return t.$emit("show-full-form")}}})],1)}),[],!1,null,null,null);e.default=F.exports},890:function(t,e,i){"use strict";var s=i(5),a=i(544),n=i(616),r=i(715);const l=()=>{let t=null;const e=Object(s.ref)([]),i=Object(s.ref)(!1),{isLoading:l,setLoader:o}=Object(a.a)(),c=()=>{e.value=[],i.value=!1,l.value&&Object(r.a)(t)};return{duplicates:e,checkDuplicates:(s,a)=>{s&&(c(),((s,a)=>{t=Object(n.a)(s,a),t.request.then((t=>{t&&(e.value=t.threads,i.value=t.isSoftDuplicates)})).finally(o())})(s,a))},resetDuplicates:c,isLoading:l,isSoftDuplicates:i}};var o=Object(s.defineComponent)({__name:"check-link-duplicates",props:{link:null,filter:null},setup(t){const e=t,{duplicates:i,isLoading:a,isSoftDuplicates:n,checkDuplicates:r,resetDuplicates:o}=l(),c=Object(s.computed)((()=>!!i.value.length));return Object(s.watch)((()=>e.link),(()=>{r(e.link,e.filter)}),{immediate:!0}),Object(s.onBeforeUnmount)((()=>{o()})),{__sfc:!0,props:e,duplicates:i,isLoading:a,isSoftDuplicates:n,checkDuplicates:r,resetDuplicates:o,hasDuplicates:c}}}),c=i(45),u=Object(c.a)(o,(function(){var t=this,e=t._self._c,i=t._self._setupProxy;return e("div",[t._t("default",null,{isLoading:i.isLoading,duplicates:i.duplicates,isSoftDuplicates:i.isSoftDuplicates,hasDuplicates:i.hasDuplicates,reset:i.resetDuplicates})],2)}),[],!1,null,null,null);e.a=u.exports},965:function(t,e,i){"use strict";var s=i(93),a=i(654),n=i(715),r=i(611);let l=null,o=null;var c={props:{link:{type:String,default:""},keepAlive:{type:Boolean,default:!1}},watch:{link:{handler:"linkChange",immediate:!0}},beforeDestroy(){this.keepAlive||this.cancelRequest()},methods:Object.assign({},Object(s.b)("threadForm",["getFormSuggestionsFromLink","getProductSpecificationFromLink","clearFormSuggestionsFromLink"]),{linkChange(t,e){t!==e&&(this.reset(),this.link&&(this.request(),this.requestProductSpecification()))},async request(){l=await this.getFormSuggestionsFromLink({url:this.link}),l&&l.request.then(r.a).catch((()=>{})).finally(Object(a.a)(this,"isLoading"))},async requestProductSpecification(){o=await this.getProductSpecificationFromLink({url:this.link}),o&&o.request.catch((()=>{}))},cancelRequest(){this.isLoading&&(Object(n.a)(l),Object(n.a)(o))},reset(){this.cancelRequest(),this.clearFormSuggestionsFromLink()}}),render(){return this.$scopedSlots.default?this.$scopedSlots.default({isLoading:this.isLoading}):null}},u=i(45),d=Object(u.a)(c,undefined,undefined,!1,null,null,null);e.a=d.exports}}]);n({},e,{file:i,url:r,trigger:{$trigger:e.trigger?o()(e.trigger):t}}))}}),{target:".redactor/textarea",events:["click"]}),w.prepareRedactors(),a.a.add("wysiwyg","init",w.prepareRedactors),o()(document).on("wysiwyg-update",(function(){setTimeout(w.prepareRedactors,0)})),e.b=w},316:function(t,e,n){var r,o,i;i=this,r=[n(0)],void 0===(o=function(t){return i.returnExportsGlobal=function(t){"use strict";var e,n,r,o,i,a,s,l;e=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.setPos=function(t){var e,n,r,o;return(o=s.getSelection())&&(r=0,n=!1,(e=function(t,i){var s,l,c,u,h,d;for(d=[],c=0,u=(h=i.childNodes).length;c<u&&(s=h[c],!n);c++)if(3===s.nodeType){if(r+s.length>=t){n=!0,(l=a.createRange()).setStart(s,t-r),o.removeAllRanges(),o.addRange(l);break}d.push(r+=s.length)}else d.push(e(t,s));return d})(t,this.domInputor)),this.domInputor},e.prototype.getIEPosition=function(){return this.getPosition()},e.prototype.getPosition=function(){var t,e;return e=this.getOffset(),t=this.$inputor.offset(),e.left-=t.left,e.top-=t.top,e},e.prototype.getOldIEPos=function(){var t,e;return e=a.selection.createRange(),(t=a.body.createTextRange()).moveToElementText(this.domInputor),t.setEndPoint("EndToEnd",e),t.text.length},e.prototype.getPos=function(){var t,e,n;return(n=this.range())?((t=n.cloneRange()).selectNodeContents(this.domInputor),t.setEnd(n.endContainer,n.endOffset),e=t.toString().length,t.detach(),e):a.selection?this.getOldIEPos():void 0},e.prototype.getOldIEOffset=function(){var t,e;return(t=a.selection.createRange().duplicate()).moveStart("character",-1),{height:(e=t.getBoundingClientRect()).bottom-e.top,left:e.left,top:e.top}},e.prototype.getOffset=function(e){var n,r,o,i,l;return s.getSelection&&(o=this.range())?(o.endOffset-1>0&&o.endContainer!==this.domInputor&&((n=o.cloneRange()).setStart(o.endContainer,o.endOffset-1),n.setEnd(o.endContainer,o.endOffset),r={height:(i=n.getBoundingClientRect()).height,left:i.left+i.width,top:i.top},n.detach()),r&&0!==(null!=r?r.height:void 0)||(n=o.cloneRange(),l=t(a.createTextNode("|")),n.insertNode(l[0]),n.selectNode(l[0]),r={height:(i=n.getBoundingClientRect()).height,left:i.left,top:i.top},l.remove(),n.detach())):a.selection&&(r=this.getOldIEOffset()),r&&(r.top+=t(s).scrollTop(),r.left+=t(s).scrollLeft()),r},e.prototype.range=function(){var t;if(s.getSelection)return(t=s.getSelection()).rangeCount>0?t.getRangeAt(0):null},e}(),n=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.getIEPos=function(){var t,e,n,r,o,i;return e=this.domInputor,r=0,(o=a.selection.createRange())&&o.parentElement()===e&&(n=e.value.replace(/\r\n/g,"\n").length,(i=e.createTextRange()).moveToBookmark(o.getBookmark()),(t=e.createTextRange()).collapse(!1),r=i.compareEndPoints("StartToEnd",t)>-1?n:-i.moveStart("character",-n)),r},e.prototype.getPos=function(){return a.selection?this.getIEPos():this.domInputor.selectionStart},e.prototype.setPos=function(t){var e,n;return e=this.domInputor,a.selection?((n=e.createTextRange()).move("character",t),n.select()):e.setSelectionRange&&e.setSelectionRange(t,t),e},e.prototype.getIEOffset=function(t){var e;return e=this.domInputor.createTextRange(),t||(t=this.getPos()),e.move("character",t),{left:e.boundingLeft,top:e.boundingTop,height:e.boundingHeight}},e.prototype.getOffset=function(e){var n,r,o;return n=this.$inputor,a.selection?((r=this.getIEOffset(e)).top+=t(s).scrollTop()+n.scrollTop(),r.left+=t(s).scrollLeft()+n.scrollLeft(),r):(r=n.offset(),o=this.getPosition(e),{left:r.left+o.left-n.scrollLeft(),top:r.top+o.top-n.scrollTop(),height:o.height})},e.prototype.getPosition=function(t){var e,n,o,i,a;return e=this.$inputor,o=function(t){return t=t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),/firefox/i.test(navigator.userAgent)&&(t=t.replace(/\s/g,"&nbsp;")),t},void 0===t&&(t=this.getPos()),a=e.val().slice(0,t),n=e.val().slice(t),i="<span style='position: relative; display: inline;'>"+o(a)+"</span>",i+="<span id='caret' style='position: relative; display: inline;'>|</span>",i+="<span style='position: relative; display: inline;'>"+o(n)+"</span>",new r(e).create(i).rect()},e.prototype.getIEPosition=function(t){var e,n;return n=this.getIEOffset(t),e=this.$inputor.offset(),{left:n.left-e.left,top:n.top-e.top,height:n.height}},e}(),r=function(){function e(t){this.$inputor=t}return e.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],e.prototype.mirrorCss=function(){var e,n=this;return e={position:"absolute",left:-9999,top:0,zIndex:-2e4},"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),t.each(this.css_attr,(function(t,r){return e[r]=n.$inputor.css(r)})),e},e.prototype.create=function(e){return this.$mirror=t("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(e),this.$inputor.after(this.$mirror),this},e.prototype.rect=function(){var t,e,n;return n={left:(e=(t=this.$mirror.find("#caret")).position()).left,top:e.top,height:t.height()},this.$mirror.remove(),n},e}(),o={contentEditable:function(t){return!(!t[0].contentEditable||"true"!==t[0].contentEditable)}},i={pos:function(t){return t||0===t?this.setPos(t):this.getPos()},position:function(t){return a.selection?this.getIEPosition(t):this.getPosition(t)},offset:function(t){return this.getOffset(t)}},a=null,s=null,l=function(t){var e;return(e=null!=t?t.iframe:void 0)?(s=e.contentWindow,a=e.contentDocument||s.document):(s=window,a=document)},t.fn.caret=function(r,a,s){var c;return i[r]?(t.isPlainObject(a)?(l(a),a=void 0):l(s),c=o.contentEditable(this)?new e(this):new n(this),i[r].apply(c,[a])):t.error("Method "+r+" does not exist on jQuery.caret")},t.fn.caret.EditableCaret=e,t.fn.caret.InputCaret=n,t.fn.caret.Utils=o,t.fn.caret.apis=i}(t)}.apply(e,r))||(t.exports=o)},317:function(t,e,n){var r,o;r=[n(0)],o=function(t){return u=[].slice,h={}.hasOwnProperty,d=function(t,e){for(var n in e)h.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n=function(){function t(t){this.currentFlag=null,this.controllers={},this.aliasMaps={},this.$inputor=$(t),this.setupRootElement(),this.listen()}return t.prototype.createContainer=function(t){return this.$el=this.$inputor.parents(".redactor-box").find(".atwho-container")},t.prototype.setupRootElement=function(t,e){if(null==e&&(e=!1),t)this.window=t.contentWindow,this.document=t.contentDocument||this.window.document,this.iframe=t;else{this.document=this.$inputor[0].ownerDocument,this.window=this.document.defaultView||this.document.parentWindow;try{this.iframe=this.window.frameElement}catch(t){throw this.iframe=null,new Error("iframe auto-discovery is failed.\nPlease use `setIframe` to set the target iframe manually.")}}return this.createContainer((this.iframeAsRoot=e)?this.document:document)},t.prototype.controller=function(t){var e,n,r,o;if(this.aliasMaps[t])n=this.controllers[this.aliasMaps[t]];else for(r in o=this.controllers)if(e=o[r],r===t){n=e;break}return n||this.controllers[this.currentFlag]},t.prototype.setContextFor=function(t){return this.currentFlag=t,this},t.prototype.reg=function(t,e){var n,r;return n=(r=this.controllers)[t]||(r[t]=this.$inputor.is("[contentEditable]")?new i(this,t):new l(this,t)),e.alias&&(this.aliasMaps[e.alias]=t),n.init(e),this},t.prototype.listen=function(){return this.$inputor.on("compositionstart",(t=this,function(e){var n;return null!=(n=t.controller())&&n.view.hide(),t.isComposing=!0})).on("compositionend",function(t){return function(e){return t.isComposing=!1}}(this)).on("keyup.atwhoInner",function(t){return function(e){return t.onKeyup(e)}}(this)).on("keydown.atwhoInner",function(t){return function(e){return t.onKeydown(e)}}(this)).on("scroll.atwhoInner",function(t){return function(e){var n;return null!=(n=t.controller())?n.view.hide(e):void 0}}(this)).on("blur.atwhoInner",function(t){return function(e){var n;if(n=t.controller())return n.view.hide(e,n.getOpt("displayTimeout"))}}(this)).on("click.atwhoInner",function(t){return function(e){return t.dispatch(e)}}(this));var t},t.prototype.shutdown=function(){var t,e;for(t in e=this.controllers)e[t].destroy(),delete this.controllers[t];return this.$inputor.off(".atwhoInner"),this.$el.remove()},t.prototype.dispatch=function(t){return $.map(this.controllers,(e=this,function(n){var r;return(r=n.getOpt("delay"))?(clearTimeout(e.delayedCallback),e.delayedCallback=setTimeout((function(){if(n.lookUp(t))return e.setContextFor(n.at)}),r)):n.lookUp(t)?e.setContextFor(n.at):void 0}));var e},t.prototype.onKeyup=function(t){var e;switch(t.keyCode){case a.ESC:t.preventDefault(),null!=(e=this.controller())&&e.view.hide();break;case a.DOWN:case a.UP:case a.CTRL:$.noop();break;case a.P:case a.N:t.ctrlKey||this.dispatch(t);break;default:this.dispatch(t)}},t.prototype.onKeydown=function(t){var e,n;if((e=null!=(n=this.controller())?n.view:void 0)&&e.visible())switch(t.keyCode){case a.ESC:t.preventDefault(),e.hide(t);break;case a.UP:t.preventDefault(),e.prev();break;case a.DOWN:t.preventDefault(),e.next();break;case a.P:if(!t.ctrlKey)return;t.preventDefault(),e.prev();break;case a.N:if(!t.ctrlKey)return;t.preventDefault(),e.next();break;case a.TAB:case a.ENTER:case a.SPACE:if(!e.visible())return;if(!this.controller().getOpt("spaceSelectsMatch")&&t.keyCode===a.SPACE)return;t.preventDefault(),e.choose(t);break;default:$.noop()}},t}(),r=function(){function t(t,e){this.app=t,this.at=e,this.$inputor=this.app.$inputor,this.id=this.$inputor[0].id||this.uid(),this.setting=null,this.query=null,this.pos=0,this.range=null,0===(this.$el=$("#atwho-ground-"+this.id,this.app.$el)).length&&this.app.$el.append(this.$el=$("<div id='atwho-ground-"+this.id+"'></div>")),this.model=new s(this),this.view=new c(this)}return t.prototype.uid=function(){return(Math.random().toString(16)+"000000000").substr(2,8)+(new Date).getTime()},t.prototype.init=function(t){return this.setting=$.extend({},this.setting||$.fn.atwho.default,t),this.view.init(),this.model.reload(this.setting.data)},t.prototype.destroy=function(){return this.trigger("beforeDestroy"),this.model.destroy(),this.view.destroy(),this.$el.remove()},t.prototype.callDefault=function(){var t,e,n;n=arguments[0],t=2<=arguments.length?u.call(arguments,1):[];try{return o[n].apply(this,t)}catch(t){return e=t,$.error(e+" Or maybe At.js doesn't have function "+n)}},t.prototype.trigger=function(t,e){var n,r;return null==e&&(e=[]),e.push(this),r=(n=this.getOpt("alias"))?t+"-"+n+".atwho":t+".atwho",this.$inputor.trigger(r,e)},t.prototype.callbacks=function(t){return this.getOpt("callbacks")[t]||o[t]},t.prototype.getOpt=function(t,e){try{return this.setting[t]}catch(t){return null}},t.prototype.insertContentFor=function(t){var e,n;return n=this.getOpt("insertTpl"),e=$.extend({},t.data("item-data"),{"atwho-at":this.at}),this.callbacks("tplEval").call(this,n,e)},t.prototype.renderView=function(t){var e;return e=this.getOpt("searchKey"),t=this.callbacks("sorter").call(this,this.query.text,t.slice(0,1001),e),this.view.render(t.slice(0,this.getOpt("limit")))},t.arrayToDefaultHash=function(t){var e,n,r,o;if(!$.isArray(t))return t;for(o=[],n=0,r=t.length;n<r;n++)e=t[n],$.isPlainObject(e)?o.push(e):o.push({name:e});return o},t.prototype.lookUp=function(t){var e,n;if(e=this.catchQuery(t))return n=function(t){return t&&t.length>0?this.renderView(this.constructor.arrayToDefaultHash(t)):this.view.hide()},this.model.query(e.text,$.proxy(n,this)),e},t}(),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.catchQuery=function(){var t,e,n,r,o,i;return e=this.$inputor.val(),t=this.$inputor.caret("pos",{iframe:this.app.iframe}),i=e.slice(0,t),"string"==typeof(r=this.callbacks("matcher").call(this,this.at,i,this.getOpt("startWithSpace")))&&r.length<=this.getOpt("maxLen",20)?(n=(o=t-r.length)+r.length,this.pos=o,r={text:r,headPos:o,endPos:n},this.trigger("matched",[this.at,r.text])):(r=null,this.view.hide()),this.query=r},e.prototype.insert=function(t,e){var n,r,o,i,a;return a=""+(o=(r=(n=this.$inputor).val()).slice(0,Math.max(this.query.headPos-this.at.length,0)))+(t+=i=""===(i=this.getOpt("suffix"))?i:i||" ")+r.slice(this.query.endPos||0),n.val(a),n.caret("pos",o.length+t.length,{iframe:this.app.iframe}),n.is(":focus")||n.focus(),n.change()},e}(r),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype._getRange=function(){var t;if((t=this.app.window.getSelection()).rangeCount>0)return t.getRangeAt(0)},e.prototype._setRange=function(t,e,n){if(null==n&&(n=this._getRange()),n)return e=$(e)[0],"after"===t?(n.setEndAfter(e),n.setStartAfter(e)):(n.setEndBefore(e),n.setStartBefore(e)),n.collapse(!1),this._clearRange(n)},e.prototype._clearRange=function(t){var e;return null==t&&(t=this._getRange()),(e=this.app.window.getSelection()).removeAllRanges(),e.addRange(t)},e.prototype._movingEvent=function(t){var e;return"click"===t.type||(e=t.which)===a.RIGHT||e===a.LEFT||e===a.UP||e===a.DOWN},e.prototype._unwrap=function(t){var e;return(e=(t=$(t).unwrap().get(0)).nextSibling)&&e.nodeValue&&(t.nodeValue+=e.nodeValue,$(e).remove()),t},e.prototype.catchQuery=function(t){var e,n,r,o,i,s,l,c,u,h;if(!this.app.isComposing&&(u=this._getRange())&&u.commonAncestorContainer.nodeType===Node.TEXT_NODE){if(t.which===a.ENTER)return(n=$(u.startContainer).closest(".atwho-query")).contents().unwrap(),n.is(":empty")&&n.remove(),(n=$(".atwho-query",this.app.document)).text(n.text()).contents().last().unwrap(),void this._clearRange();if(/firefox/i.test(navigator.userAgent)){if($(u.startContainer).is(this.$inputor))return void this._clearRange();t.which===a.BACKSPACE&&u.startContainer.nodeType===document.ELEMENT_NODE&&(l=u.startOffset-1)>=0?((h=u.cloneRange()).setStart(u.startContainer,l),$(h.cloneContents()).contents().last().is(".atwho-inserted")&&(o=$(u.startContainer).contents().get(l),this._setRange("after",$(o).contents().last()))):t.which===a.LEFT&&u.startContainer.nodeType===document.TEXT_NODE&&(e=$(u.startContainer.previousSibling)).is(".atwho-inserted")&&0===u.startOffset&&this._setRange("after",e.contents().last())}return $(u.startContainer).closest(".atwho-inserted").addClass("atwho-query").siblings().removeClass("atwho-query"),(n=$(".atwho-query",this.app.document)).length>0&&n.is(":empty")&&0===n.text().length&&n.remove(),this._movingEvent(t)||n.removeClass("atwho-inserted"),(h=u.cloneRange()).setStart(u.startContainer,0),s=this.callbacks("matcher").call(this,this.at,h.toString(),this.getOpt("startWithSpace")),0===n.length&&"string"==typeof s&&(r=u.startOffset-this.at.length-s.length)>=0&&(u.setStart(u.startContainer,r),n=$("<span/>",this.app.document).attr(this.getOpt("editableAtwhoQueryAttrs")).addClass("atwho-query"),u.surroundContents(n.get(0)),i=n.contents().last().get(0),/firefox/i.test(navigator.userAgent)?(u.setStart(i,i.length),u.setEnd(i,i.length),this._clearRange(u)):this._setRange("after",i,u)),"string"==typeof s&&s.length<=this.getOpt("maxLen",20)?(c={text:s,el:n},this.trigger("matched",[this.at,c.text]),this.query=c):(this.view.hide(),this.query={el:n},n.text().indexOf(this.at)>=0&&(this._movingEvent(t)&&n.hasClass("atwho-inserted")?n.removeClass("atwho-query"):!1!==this.callbacks("afterMatchFailed").call(this,this.at,n)&&this._setRange("after",this._unwrap(n.text(n.text()).contents().first()))),null)}},e.prototype.insert=function(t,e){var n,r,o;return r=(r=this.getOpt("suffix"))?r:r||" ",this.query.el.removeClass("atwho-query").addClass("atwho-inserted").html(t),(n=this._getRange())&&(n.setEndAfter(this.query.el[0]),n.collapse(!1),n.insertNode(o=this.app.document.createTextNode(r)),this._setRange("after",o,n)),this.$inputor.is(":focus")||this.$inputor.focus(),this.$inputor.change()},e}(r),s=function(){function t(t){this.context=t,this.at=this.context.at,this.storage=this.context.$inputor}return t.prototype.destroy=function(){return this.storage.data(this.at,null)},t.prototype.saved=function(){return this.fetch()>0},t.prototype.query=function(t,e){var n,r,o;return n=this.fetch(),r=this.context.getOpt("searchKey"),n=this.context.callbacks("filter").call(this.context,t,n,r)||[],o=this.context.callbacks("remoteFilter"),n.length>0||!o&&0===n.length?e(n):o.call(this.context,t,e)},t.prototype.fetch=function(){return this.storage.data(this.at)||[]},t.prototype.save=function(t){return this.storage.data(this.at,this.context.callbacks("beforeSave").call(this.context,t||[]))},t.prototype.load=function(t){if(!this.saved()&&t)return this._load(t)},t.prototype.reload=function(t){return this._load(t)},t.prototype._load=function(t){return"string"==typeof t?$.ajax(t,{dataType:"json"}).done((e=this,function(t){return e.save(t)})):this.save(t);var e},t}(),c=function(){function t(t){this.context=t,this.$el=$(this.context.$el).parents(".atwho-container").find(".atwho-view"),this.timeoutID=null,this.bindEvent()}return t.prototype.init=function(){var t;return t=this.context.getOpt("alias")||this.context.at.charCodeAt(0),this.$el.attr({id:"at-view-"+t})},t.prototype.destroy=function(){return this.$el.remove()},t.prototype.bindEvent=function(){var t,e;return(t=this.$el).on("mouseenter.atwho-view","li",(function(e){return t.find(".cur").removeClass("cur"),$(e.currentTarget).addClass("cur")})).on("click.atwho-view","li",(e=this,function(n){return t.find(".cur").removeClass("cur"),$(n.currentTarget).addClass("cur"),e.choose(n),n.preventDefault()}))},t.prototype.visible=function(){return this.$el.is(":visible")},t.prototype.choose=function(t){var e,n;if((e=this.$el.find(".cur")).length&&(n=this.context.insertContentFor(e),this.context.insert(this.context.callbacks("beforeInsert").call(this.context,n,e),e),this.context.trigger("inserted",[e,t]),this.hide(t)),this.context.getOpt("hideWithoutSuffix"))return this.stopShowing=!0},t.prototype.next=function(){var t;return(t=this.$el.find(".cur").removeClass("cur").next()).length||(t=this.$el.find("li:first")),t.addClass("cur")},t.prototype.prev=function(){var t;return(t=this.$el.find(".cur").removeClass("cur").prev()).length||(t=this.$el.find("li:last")),t.addClass("cur")},t.prototype.show=function(){if(!this.stopShowing)return this.visible()?void 0:(this.$el.show(),this.$el.parent(".atwho-container").show(),this.context.trigger("shown"));this.stopShowing=!1},t.prototype.hide=function(t,e){var n,r;if(this.visible())return isNaN(e)?(this.$el.parent(".atwho-container").hide(),this.$el.hide(),this.context.trigger("hidden",[t])):(r=this,n=function(){return r.hide()},clearTimeout(this.timeoutID),this.timeoutID=setTimeout(n,e))},t.prototype.render=function(t){var e,n,r,o,i,a,s;if($.isArray(t)&&t.length>0){for(this.$el.empty(),n=this.$el,i=this.context.getOpt("displayTpl"),a=0,s=t.length;a<s;a++)r=t[a],r=$.extend({},r,{"atwho-at":this.context.at}),o=this.context.callbacks("tplEval").call(this.context,i,r),(e=$(this.context.callbacks("highlighter").call(this.context,o,this.context.query.text))).data("item-data",r),n.append(e);return this.show(),this.context.getOpt("highlightFirst")?n.find("li:first").addClass("cur"):void 0}this.hide()},t}(),a={DOWN:40,UP:38,ESC:27,TAB:9,ENTER:13,CTRL:17,P:80,N:78,LEFT:37,UP:38,RIGHT:39,DOWN:40,BACKSPACE:8,SPACE:32},o={beforeSave:function(t){return r.arrayToDefaultHash(t)},matcher:function(t,e,n){var r,o,i;return r="A-Za-z0-9_."+(o="\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f")+"가-하|@+-",t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),n&&(t="(?:^|\\s)"+t),(i=new RegExp(t+"(["+r+"]*)$|"+t+"([^"+o+"]*)$","gi").exec(e))?i[2]||i[1]:null},filter:function(t,e,n){var r,o,i,a;for(a=[],o=0,i=e.length;o<i;o++)r=e[o],~new String(r[n]).toLowerCase().indexOf(t.toLowerCase())&&a.push(r);return a},remoteFilter:null,sorter:function(t,e,n){var r,o,i,a;if(!t)return e;for(a=[],o=0,i=e.length;o<i;o++)(r=e[o]).atwho_order=new String(r[n]).toLowerCase().indexOf(t.toLowerCase()),r.atwho_order>-1&&a.push(r);return a.sort((function(t,e){return t.atwho_order-e.atwho_order}))},tplEval:function(t,e){var n;n=t;try{return"string"!=typeof t&&(n=t(e)),n.replace(/\$\{([^\}]*)\}/g,(function(t,n,r){return e[n]}))}catch(t){return""}},highlighter:function(t,e){var n,r;return n="A-Za-z0-9_.\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f가-하",e?(r=new RegExp(">\\s*(["+n+"]*?)("+e.replace("+","\\+")+")(["+n+"]*?)\\s*<","ig"),t.replace(r,(function(t,e,n,r){return"> "+e+"<strong>"+n+"</strong>"+r+" <"}))):t},beforeInsert:function(t,e){return t},beforeReposition:function(t){return t},afterMatchFailed:function(t,e){}},e={load:function(t,e){var n;if(n=this.controller(t))return n.model.load(e)},isSelecting:function(){var t;return null!=(t=this.controller())?t.view.visible():void 0},hide:function(){var t;return null!=(t=this.controller())?t.view.hide():void 0},setIframe:function(t,e){return this.setupRootElement(t,e),null},run:function(){return this.dispatch()},destroy:function(){return this.shutdown(),this.$inputor.data("atwho",null)}},$.fn.atwho=function(t){var r,o;return o=arguments,r=null,this.filter('textarea, input, [contenteditable=""], [contenteditable=true]').each((function(){var i,a;return(a=(i=$(this)).data("atwho"))||i.data("atwho",a=new n(this)),"object"!=typeof t&&t?e[t]&&a?r=e[t].apply(a,Array.prototype.slice.call(o,1)):$.error("Method "+t+" does not exist on jQuery.caret"):a.reg(t.at,t)})),r||this},void($.fn.atwho.default={at:void 0,alias:void 0,data:null,displayTpl:"<li>${name}</li>",insertTpl:"${atwho-at}${name}",callbacks:o,searchKey:"name",suffix:void 0,hideWithoutSuffix:!1,startWithSpace:!0,highlightFirst:!0,limit:5,maxLen:20,displayTimeout:300,delay:null,spaceSelectsMatch:!1,editableAtwhoQueryAttrs:{}});var e,n,r,o,i,a,s,l,c,u,h,d}.apply(e,r),void 0===o||(t.exports=o)},52:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i={};i.legacyUpload=!(window.File&&window.FileList&&window.Blob&&window.FormData),i.inputToJson=function(t,e,n){var r,o,a=t.match(/^(\w+|\[(\w*)])(.*$)/),s=n;return a?(r=void 0===a[2]?a[1]:a[2],o=a[3],r?(s||(s={}),s[r]?i.inputToJson(o,e,s[r]):s[r]=i.inputToJson(o,e)):(s||(s=[]),s.push(i.inputToJson(o,e)))):s=e,s},i.toJson=function(t,e){var n={};return t.serializeArray().forEach((function(t){i.inputToJson(t.name,t.value,n)})),e&&(i.legacyUpload&&new Error("browser does not support file api or FormData"),t.find("input[type=file][name]").each((function(t,e){i.getFiles(o()(e)).forEach((function(t){i.inputToJson(e.name,t,n)}))}))),n},i.jsonToInputs=function(t,e,n){return e||(e=[]),o.a.each(t,(function(t,r){var a=n?n+"["+t+"]":t;r&&"object"==typeof r?i.jsonToInputs(r,e,a):e.push(o()('<input type="hidden"/>').prop("name",a).prop("value",r))})),e},i.formData=function(t){var e;return window.FormData||new Error("browser does not support FormData"),e=new window.FormData,function t(n,r){var i;return o.a.each(n,(function(n,o){i=r?r+"["+n+"]":n,!o||"object"!=typeof o||o instanceof window.File||o instanceof window.Blob?e.append(i,o):t(o,i)})),e}(t)},i.sendJson=function(t,e,n){const r=o.a.Deferred(),a=o.a.ajax(e,{type:n||"POST",xhr:function(){const t=o.a.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",(function(t){t.lengthComputable&&r.notify(t.loaded,t.total)})),t},data:"string"==typeof t?t:i.formData(t),success:r.resolve,error:r.reject,cache:!1,contentType:!1,processData:!1}),s=r.promise();return s.abort=function(){a.abort()},s},i.send=function(t,e){return"multipart/form-data"===t.attr("enctype")?i.legacyUpload?function(t){return t.submit(),o.a.Deferred().promise()}(t):i.sendJson(i.toJson(t,!0),t.attr("action"),t.attr("method")):o.a.ajax(t.attr("action"),{type:t.attr("method"),data:e?t.serialize().concat("&",o.a.param(e)):t.serialize(),beforeSend:(t,e)=>{t.requestUrl=e.url}})},i.resetFile=function(t){try{t.val(""),t.val()&&t.prop("type","text").prop("type","file")}catch(t){}return t.data("imageControlExcludes",[])},i.excludeFile=function(t,e){var n=t.data("imageControlExcludes")||[];return-1===n.indexOf(e)&&n.push(e),t.data("imageControlExcludes",n)},i.unExcludeFile=function(t,e){var n=t.data("imageControlExcludes")||[],r=n.indexOf(e);return-1!==r&&n.splice(r,1),t.data("imageControlExcludes",n)},i.getFiles=function(t){const e=t.data("imageControlExcludes"),n=[];for(let e=0;e<t[0].files.length;e+=1)n.push(t[0].files[e]);return n.filter((function(t,n){return!e||-1===e.indexOf(n)}))},i.postStatic=function(t,e){o()("<form/>").attr("method","post").attr("action",e).append(i.jsonToInputs(t)).appendTo(document.body).submit()},e.a=i},637:function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return h})),n.d(e,"g",(function(){return d})),n.d(e,"a",(function(){return p})),n.d(e,"d",(function(){return g})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return v}));var r=n(749),o=n.n(r),i=n(107),a=n(1),s=n(521),l=n(566),c=n(4);const u=(t,e)=>{let{variation:n}=e;try{if(!t)return"";if(o()(t))return t;if(Object(i.d)(t))return Object(i.e)(t,t.slots[0].name,n);const e=[["re",300,300],["ft","jpg"],["qt",60]];return new s.a(t).apply(e).toString()}catch(t){}return null},h=t=>{try{return!(!t||o()(t))&&(Object(i.d)(t)?!!Object(i.f)(t,t.slots[0].name,{}).isPoorQuality:t.isPoorQuality)}catch(t){}return!1},d=async t=>{let{bucket:e,value:n,fileName:r}=t;return"string"==typeof n?await Object(a.hd)({url:n,bucket:e}):await Object(a.gd)({file:n,bucket:e,fileName:r})},p=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["image/jpg","image/jpeg","image/png","image/gif","image/webp"];return(null==t?void 0:t.type)&&e.includes(t.type)};function f(t){c.a.dispatch("pageMsgs/set",[Object.assign({type:"error",priority:"low"},t)])}function g(){f({body:t(":attribute mag niet groter zijn dan :max kilobytes",{replaces:{attribute:"image",max:l.d}})})}function m(e){f({body:t("Sorry, we accepteren maar :max_allowed aantal afbeeldingen.",{replaces:{max_allowed:e},count:e})})}function v(t){f({title:"paste-local-file"===t?"Lokale afbeeldingen plakken (vanaf het klembord) is niet mogelijk.":"Het slepen van lokale afbeeldingen is niet mogelijk.",body:"Gebruik in plaats daarvan de upload-knop."})}}).call(this,n(70).translation)},725:function(t,e,n){"use strict";var r=n(526),o=n(509),i=n(566),a={components:{FormInput:o.e},props:{showFileName:{required:!0,type:Boolean,default:!1},disableControl:{type:Boolean,default:!1},value:{required:!1},mode:{type:String,default:"default"}},computed:{selectedFileName(){return this.value?this.value.name:"Niks geselecteerd"},labelMode(){return"brand"===this.mode?"button--mode-brand":"button--mode-default"}},methods:{selectFile(){this.$emit("input",Object(i.b)(this.$refs.file.$el))}}},s=n(45),l=Object(s.a)(a,(function(){var t=this,e=t._self._c;return e("span",{staticClass:"tGrid tGrid--auto width--all-12 hide--js-off"},[e("span",{staticClass:"tGrid-cell tGrid-cell--shrink"},[e("label",{staticClass:"button button--type-secondary button--shape-circle width--all-12",class:[t.labelMode,{"button--disabled":t.disableControl}]},[t._v(" "+t._s("Kies")+" "),e("FormInput",{ref:"file",staticClass:"hide",attrs:{disabled:t.disableControl,type:"file",accept:".jpg, .jpeg, .png, .gif, .webp",name:"file"},on:{change:t.selectFile}})],1)]),t.showFileName?e("span",{staticClass:"tGrid-cell vAlign--all-m space--l-2"},[e("span",{staticClass:"mute--text size--all-m box--all-b overflow--ellipsis-tableFix"},[t._v(t._s(t.selectedFileName))])]):t._e()])}),[],!1,null,null,null).exports,c=n(507),u={__name:"alignment-selector-control",setup:t=>({__sfc:!0,alignments:[{name:"left",icon:"align-left",label:"Links"},{name:"center",icon:"align-center",label:"Midden"}],SegmentedButton:c.b})},h=Object(s.a)(u,(function(){var t=this,e=t._self._c,n=t._self._setupProxy;return e("div",{staticClass:"flex"},t._l(n.alignments,(function(r){return e(n.SegmentedButton,t._g(t._b({key:r.name,staticClass:"width--all-6",attrs:{name:r.name,mandatory:""}},"SegmentedButton",t.$attrs,!1),t.$listeners),[e("BaseIcon",{attrs:{name:r.icon,left:""}}),t._v(" "+t._s(r.label)+" ")],1)})),1)}),[],!1,null,null,null).exports,d=n(637);const p=Object(r.a)().set({label:"engagement"});var f={components:{BaseButton:c.a,FormList:o.l,FormRow:o.o,FormLabel:o.k,FormContent:o.c,FormInput:o.e,FileUploadControl:l,AlignmentSelectorControl:h},inheritAttrs:!1,props:{isLoading:{type:Boolean,required:!0},hasAlignmentSelector:{type:Boolean,default:!1},hasUrlInput:{type:Boolean,default:!1},immediateUpload:{type:Boolean,default:!1},showFileName:{type:Boolean,default:!1},mode:{type:String,default:"default"}},data:()=>({file:null,url:null,alignment:"left"}),computed:{noSelectionMade(){return!this.file&&!this.url},shouldDisableFileControl(){return!(!this.isLoading&&!this.url)},shouldDisableURLControl(){return!(!this.isLoading&&!this.file)},shouldDisableSubmitControl(){return!(!this.isLoading&&!this.noSelectionMade)}},methods:{submit(){const t=this.file?"FILE":"URL",e=this.file?this.file:this.url;if("FILE"===t&&Object(i.a)(e))return void Object(d.d)();let n={type:t,value:e};this.hasAlignmentSelector&&(n=Object.assign(n,{alignment:this.alignment})),this.$emit("submit",n)},handleURL(){p.record({action:"add_image_url"})},handleFile(){p.record({action:"add_image"}),this.immediateUpload&&this.submit()}}},g=Object(s.a)(f,(function(){var t=this,e=t._self._c;return e("FormList",[t._t("above"),e("FormRow",{attrs:{disabled:t.shouldDisableFileControl}},[e("FormLabel",[t._v(t._s("Upload afbeelding"))]),e("FormContent",[e("FileUploadControl",{attrs:{mode:t.mode,"disable-control":t.shouldDisableFileControl,"show-file-name":t.showFileName},on:{input:t.handleFile},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1)],1),t.hasUrlInput?e("FormRow",{attrs:{disabled:t.shouldDisableURLControl}},[e("FormLabel",[t._v(t._s("Afbeelding uit URL"))]),e("FormContent",[e("FormInput",{attrs:{name:"url",placeholder:"Afbeeldings-URL",disabled:t.shouldDisableURLControl},on:{input:t.handleURL},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}})],1)],1):t._e(),t.hasAlignmentSelector?e("FormRow",[e("FormLabel",[t._v(t._s("Plaatsing"))]),e("FormContent",[e("AlignmentSelectorControl",{attrs:{"selected-value":t.alignment},on:{"update:selectedValue":function(e){t.alignment=e},"update:selected-value":function(e){t.alignment=e}}})],1)],1):t._e(),e("FormRow",[e("FormContent",[e("BaseButton",{staticClass:"width--all-12",attrs:{variant:"primary",mode:"brand",disabled:t.shouldDisableSubmitControl},on:{click:function(e){return t.submit()}}},[t._v(" "+t._s("Plaats afbeelding")+" ")])],1)],1),t._t("default")],2)}),[],!1,null,null,null);e.a=g.exports}}]);