function $_global_core(){SPAnimation={};SPAnimation.g_Curves=new Array(7);SPAnimation.g_Curves[0]=new SPCurve(0,0,0,0,0,0);SPAnimation.g_Curves[1]=new SPCurve(1,1,0,0,0,0);SPAnimation.g_Curves[2]=new SPCurve(2,2,0,0,0,0);SPAnimation.g_Curves[3]=new SPCurve(3,3,.1,.9,.2,1);SPAnimation.g_Curves[4]=new SPCurve(4,3,.42,0,1,1);SPAnimation.g_Curves[5]=new SPCurve(5,3,0,0,.58,1);SPAnimation.g_Curves[6]=new SPCurve(6,3,.42,0,.58,1);SPKeyFrame.prototype={type:0,curveID:0,startTime:0,endTime:0,startValue:0,endValue:0,relativeTo:0,operationType:0};SPAnimation.Attribute={PositionX:1,PositionY:2,Height:3,Width:4,Opacity:5};SPAnimation.ID={Basic_Show:0,Basic_SlowShow:1,Basic_Fade:2,Basic_Move:3,Basic_Size:4,Content_SlideInFadeInRight:5,Content_SlideInFadeInRightInc:6,Content_SlideOutFadeOutRight:7,Content_SlideInFadeInLeft:8,Content_SlideInFadeInLeftInc:9,SmallObject_SlideInFadeInTop:10,SmallObject_SlideInFadeInLeft:11,Test_Instant:12,Test_Hold:13,Basic_Opacity:14,Basic_QuickShow:15,Basic_QuickFade:16,Content_SlideInFadeInGeneric:17,Basic_StrikeThrough:18,SmallObject_SlideInFadeInBottom:19,SmallObject_SlideOutFadeOutBottom:20,Basic_QuickSize:21};SPAnimation.g_Animations=new Array(22);SPAnimation.g_Animations[SPAnimation.ID.Basic_Show]=new Animation(SPAnimation.ID.Basic_Show,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_SlowShow]=new Animation(SPAnimation.ID.Basic_SlowShow,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,700,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickShow]=new Animation(SPAnimation.ID.Basic_QuickShow,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Fade]=new Animation(SPAnimation.ID.Basic_Fade,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickFade]=new Animation(SPAnimation.ID.Basic_QuickFade,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Move]=new Animation(SPAnimation.ID.Basic_Move,[new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,0,367,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Size]=new Animation(SPAnimation.ID.Basic_Size,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,367,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.Height,3,0,367,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickSize]=new Animation(SPAnimation.ID.Basic_QuickSize,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,167,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.Height,3,0,167,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInRight]=new Animation(SPAnimation.ID.Content_SlideInFadeInRight,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,-100,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,367,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInRightInc]=new Animation(SPAnimation.ID.Content_SlideInFadeInRightInc,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,100,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideOutFadeOutRight]=new Animation(SPAnimation.ID.Content_SlideOutFadeOutRight,[new SPKeyFrame(SPAnimation.Attribute.Opacity,0,0,1,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInLeft]=new Animation(SPAnimation.ID.Content_SlideInFadeInLeft,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,100,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,367,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInLeftInc]=new Animation(SPAnimation.ID.Content_SlideInFadeInLeftInc,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,-100,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInTop]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInTop,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,-40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInLeft]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInLeft,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Test_Instant]=new Animation(SPAnimation.ID.Test_Instant,[new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Test_Hold]=new Animation(SPAnimation.ID.Test_Hold,[new SPKeyFrame(SPAnimation.Attribute.PositionX,1,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,1,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Opacity]=new Animation(SPAnimation.ID.Basic_Opacity,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInGeneric]=new Animation(SPAnimation.ID.Content_SlideInFadeInGeneric,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_StrikeThrough]=new Animation(SPAnimation.ID.Basic_StrikeThrough,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,167,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInBottom]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInBottom,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideOutFadeOutBottom]=new Animation(SPAnimation.ID.SmallObject_SlideOutFadeOutBottom,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,1,0,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,0,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,40,0,1)]);SPAnimation.g_AnimationEngine=function(){return null}();SPAnimation.Logging=window.location.search.indexOf("AnimationLogging=1")!=-1;SPAnimation.g_AnimationWSA=null;SPAnimation.DATAID_SPANIMATION=9423;SPAnimation.g_AnimationThrottleCutoffFPS=11;SPAnimation.g_AnimationThrottleNumInstance=3;!IsNullOrUndefined(window.sessionStorage)&&IsNullOrUndefined(window.sessionStorage.SPAnimationEnabled)&&TrySetProperty(window.sessionStorage,"SPAnimationEnabled",1);!IsNullOrUndefined(window.localStorage)&&IsNullOrUndefined(window.localStorage.SPAnimationEnabled)&&TrySetProperty(window.localStorage,"SPAnimationEnabled",1);SPAnimation.Settings={};SPAnimation.Settings.EnableAnimation=SPAnimation.Settings.DisableAnimation=function(){TrySetProperty(window.localStorage,"SPAnimationEnabled",0);typeof UpdateAnimationUserControl!="undefined"&&UpdateAnimationUserControl(false)};SPAnimation.Settings.DisableSessionAnimation=SPAnimation.Settings.IsAnimationEnabled=UpdateAnimationStateFromQuery();SPAnimation.State=SPAnimation_State;SPAnimation.Object=SPAnimation_Object;AnimationEngine.prototype={AnimationQueue:new Array(0),sharedTimer:null,sharedCancelTimer:null,frameInterval:1e3/60,resetInterval:3e4,sharedTimerRefs:0,conflictTable:new Array(0),currentAnimationIndex:-1,temporaryIDGenerator:0};AnimationEngine.prototype.LocalStepper=function(){SPAnimation.g_AnimationEngine.StepAllAnimations()};AnimationEngine.prototype.LocalStopper=AnimationEngine.prototype.StartEngine=AnimationEngine.prototype.StopEngine=AnimationEngine.prototype.StartAnimation=function(a){this.AnimationQueue[this.sharedTimerRefs++]=a};AnimationEngine.prototype.StopAnimation=AnimationEngine.prototype.StepAllAnimations=AnimationEngine.prototype.CheckForConflictingAnimations=AnimationEngine.prototype.RemoveTemporaryIds=SPAnimation_State.prototype={Index:0,Data:new Array(0)};SPAnimation_State.prototype.SetAttribute=SPAnimation_State.prototype.GetAttribute=SPAnimation_State.prototype.GetDataIndex=SPAnimation_Object.prototype={animationID:-1,delay:0,element:null,finalState:null,finishFunc:null,extraData:null,arrAnimationUnits:null,idxAnimUnit:0};SPAnimation_Object.prototype.Initialize=SPAnimation_Object.prototype.RunAnimation=SPAnimation_Object.prototype.ValidateParametersForAnimation=SPAnimation_Object.prototype.AdvanceToFinalState=SPAnimation_Object.prototype.GenerateAnimationUnits=SPAnimation_Object.prototype.FindMatchingAnimationUnit=SPAnimation_Object.prototype.GetFinalValue=AnimationUnit.prototype={element:null,delay:0,duration:0,startValue:null,perElementStartValue:null,targetValue:null,curveID:null,finishFunc:null,extraData:null,startTime:null,fIsExecuting:false};AnimationUnit.prototype.Initialize=AnimationUnit.prototype.StartAnimation=AnimationUnit.prototype.StopAnimation=AnimationUnit.prototype.StepAnimation=AnimationUnit.prototype.PositionFunction=AnimationUnit.prototype.SetStyle=AnimationUnit.prototype.StyleLeftSetter=AnimationUnit.prototype.StyleTopSetter=function(a,b){a.style.top=String(b)+"px";SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+a.id+", top: "+String(a.style.top)+", timestamp: "+String(Number(new Date)))};AnimationUnit.prototype.StyleHeightSetter=function(a,b){a.style.height=String(b)+"px";SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+a.id+", height: "+String(a.style.height)+", timestamp: "+String(Number(new Date)))};AnimationUnit.prototype.StyleWidthSetter=AnimationUnit.prototype.StyleOpacitySetter=AnimationTelemetry.prototype={perfData:null,logData:null,perfDataIndex:0,logDataIndex:0,animationIndex:0,startTime:null,duration:null,numUnits:0};AnimationTelemetry.prototype.Start=AnimationTelemetry.prototype.Stop=AnimationTelemetry.prototype.AddPerfData=function(a){this.perfData[this.perfDataIndex++]=a};AnimationTelemetry.prototype.LogData=AnimationTelemetry.prototype.CalculateStatistics=AnimationTelemetry.prototype.CalculateAndShowStatistics=AnimationTelemetry.prototype.ShowAnimationStats=SPAnimation.g_TelemetryObject=new AnimationTelemetry;SPAnimation.g_LastAnimationTelemetryData=null;SPAnimationUtility={};SPAnimationUtility.BasicAnimator={};SPAnimationUtility.BasicAnimator.FadeIn=SPAnimationUtility.BasicAnimator.FadeOut=SPAnimationUtility.BasicAnimator.Move=SPAnimationUtility.BasicAnimator.StrikeThrough=SPAnimationUtility.BasicAnimator.PositionAbsolute=SPAnimationUtility.BasicAnimator.PositionRelative=SPAnimationUtility.BasicAnimator.PositionAbsoluteExact=function(a,e,d,b,c){if(a==null)return;a.style.position="absolute";SPAnimationUtility.BasicAnimator.PositionElement(a,e,d,b,c)};SPAnimationUtility.BasicAnimator.PositionRelativeExact=SPAnimationUtility.BasicAnimator.ResetPosition=SPAnimationUtility.BasicAnimator.GetLeftOffset=function(a){if(a==null)return 0;var b=a.offsetLeft;while(a.offsetParent!=null){a=a.offsetParent;if(SPAnimationUtility.BasicAnimator.IsPositioned(a)&&!(browseris.firefox&&a.tagName.toUpperCase()=="TD"))break;b+=a.offsetLeft}return b};SPAnimationUtility.BasicAnimator.GetTopOffset=SPAnimationUtility.BasicAnimator.IsPositioned=SPAnimationUtility.BasicAnimator.GetDefaultCloneId=SPAnimationUtility.BasicAnimator.CloneElement=SPAnimationUtility.BasicAnimator.CommonResize=SPAnimationUtility.BasicAnimator.Resize=function(d,b,c,a,e){SPAnimationUtility.BasicAnimator.CommonResize(d,b,c,a,e,SPAnimation.ID.Basic_Size)};SPAnimationUtility.BasicAnimator.QuickResize=SPAnimationUtility.BasicAnimator.ResizeContainerAndFillContent=SPAnimationUtility.BasicAnimator.GetRightOffset=SPAnimationUtility.BasicAnimator.PositionElement=SPAnimationUtility.BasicAnimator.GetWindowScrollPosition=SPAnimationUtility.RowAddInfo=function(){};SPAnimationUtility.RowMoveInfo=function(){};SPAnimationUtility.TableAnimator=SPAnimUtil_TableAnimator;SPAnimUtil_TableAnimator.prototype={tableElement:null,tbody:null,headerRow:null,footer:null,fAnimatable:false,topOffset:0,leftOffset:0,headerRowHeight:0,itemRowHeight:0,headerColWidths:null,itemColWidths:null};SPAnimUtil_TableAnimator.prototype.AnimatePaging=SPAnimUtil_TableAnimator.prototype.ResetPagingAnimation=SPAnimUtil_TableAnimator.prototype.AnimateSort=SPAnimUtil_TableAnimator.prototype.PrepareForSortAnimation=SPAnimUtil_TableAnimator.prototype.AnimateFooter=SPAnimUtil_TableAnimator.prototype.Initialize=SPAnimUtil_TableAnimator.prototype.GetTableBody=SPAnimUtil_TableAnimator.prototype.GetColumnWidths=SPAnimUtil_TableAnimator.prototype.IncrementRefCount=SPAnimUtil_TableAnimator.prototype.DecrementRefCount=SPAnimUtil_TableAnimator.prototype.IsErrorRow=IsMenuShown=false;ChevronContainer=null;itemTableDeferred=null;imageCell=null;onKeyPress=false;downArrowText=null;currentEditMenu=null;currentItemID=null;currentItemAppName=null;currentItemProgId=null;currentItemIcon=null;currentItemOpenControl=null;currentItemOpenApp=null;currentItemFileUrl=null;currentItemFSObjType=null;currentItemContentTypeId=null;currentItemCheckedOutUserId=null;currentItemCheckoutExpires=null;currentItemModerationStatus=null;currentItemUIString=null;currentItemCheckedoutToLocal=null;bIsCheckout=0;currentItemCanModify=null;currentItemPermMaskH=null;currentItemPermMaskL=null;currentItemEvtType=0;currentItemIsEventsExcp=null;currentItemIsEventsDeletedExcp=null;g_MaximumSelectedItemsAllowed=100;g_CustomActionDialogHandlers={};g_CustomActionDialogHandlerId=0;g_ExpGroupWPState=new LRUCache;DocOpen={CLIENT:0,BROWSER:1};hoverTR=null;ecbTD=null;ProtocolCommand={View:"ofv",Edit:"ofe",New:"nft"};phManager=new function(){var a=false,c=false,b={};this.ShouldTryProtocolHandler=this.SetProtocolHandlerEnabled=this.IsProtocolHandlerEnabled=function(d,e){if(IsStrNullOrEmpty(d))return false;if((browseris.ie10standardUp||browseris.msEdge)&&typeof navigator.msLaunchUri=="undefined"&&d!="ms-project")return false;if(b[d]!=null)return b[d];if(c)return a;c=true;if(d==="ms-project")if(typeof navigator.msLaunchUri=="function"){a=true;return a}if(Boolean(window.ActiveXObject))try{if(d==="ms-project")var g=new ActiveXObject("WinProj.Activator");else var h=new ActiveXObject("SharePoint.OpenDocuments.5");a=true}catch(i){}else if(IsSupportedNPApiBrowserOnWin()){var f=CreateNPApiOnWindowsPlugin("application/x-sharepoint");if(f!=null)try{if(f.GetOfficeVersion()=="15")a=true}catch(i){}else if(browseris.chrome&&!e)a=true}else if(browseris.safari&&!e)a=true;return a};this.CreateProtocolHandlerUrl=function(c,f,d,g){var a=[],b=c.split("|");if(b.length==2){a.push(b[0]);a.push(":");a.push(f);return a.join("")}else if(b.length==3)c=b[0];a.push(c);a.push(":");a.push(d);a.push("|u|");a.push(f);if(d==ProtocolCommand.New){a.push("|s|");a.push(g)}var e=a.join("");return browseris.mac&&browseris.chrome?encodeURI(e):e}};CBSelectedValues_InitializePrototype();PageContextInfo_InitializePrototype();g_ExtensionNotSupportCheckoutToLocal=["ascx","asp","aspx","htm","html","master","odc","exe","bat","com","cmd","onetoc2"];g_ExtensionDefaultForRead=["jpg","jpeg","bmp","png","gif","onetoc2","one","odc"];bValidSearchTerm=false;fListControl=false;fListErrorShown=false;fNewDoc=false;fNewDoc2=false;fNewDoc3=false;SPDesignerDownloadUrl="http://o15.officeredir.microsoft.com/r/rlidSPD2013Download";SPDesignerProgID="SharePoint.WebPartPage.Document";CtxRgiid_InitializePrototype();g_varSkipRefreshOnFocus=0;g_useDialogAlwaysList=["upload.aspx","uploadex.aspx","deploydeveloperapp.aspx"];LRUCache_InitializePrototype();v_stsOpenDoc=null;v_strStsOpenDoc=null;g_AdditionalNavigateHierarchyQString="";httpFolderTarget=null;httpFolderSource=null;httpFolderDiv=null;previousClickedItemRow=null;Point.prototype={x:undefined,y:undefined,toString:;isdlg=ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"));_spBodyOnLoadFunctionNames!=null&&typeof _spBodyOnLoadFunctionNames!="undefined"&&_spBodyOnLoadFunctionNames.push("SearchOnBodyLoad");isdlg==null&&SetEvent("resize",FixRibbonAndWorkspaceDimensionsForResize,window);QstringStruct.prototype.toString=QstringStructToString;QstringStruct.prototype.toArray=QstringStructToArray;Diff.prototype={left:[],right:[]};QstringStruct.Diff=function(h,g){for(var f=new QstringStruct(h).toArray(),e=new QstringStruct(g).toArray(),b={},d=new Diff,a=0;a<f.length;a++)b[f[a]]|=1;for(a=0;a<e.length;a++)b[e[a]]|=2;for(var c in b)if(b[c]==1)d.left.push(c);else b[c]==2&&d.right.push(c);return d};g_listItemCache={};g_fSkipAnimation=false;g_fSkipNextTabExpandAnimation=false;g_InViewPort=1;g_OutOfViewPortCloserToTop=2;g_OutOfViewPortCloserToBottom=3;g_NotificationEngine=null;g_notiExpireTimerId=-1;g_standardNotiCt=null;g_statusNotiCt=null;SPNotifications={};SPNotifications.ContainerID={Basic:0,Status:1};g_SPNotificationEventID_Count=5;SPNotifications.EventID={OnShow:0,OnHide:1,OnDisplayNotification:2,OnRemoveNotification:3,OnNotificationCountChanged:4,OnDisposing:5};SP.UI.Notify={};SP.UI.Notify.Notification=SPNotification;SP.UI.Notify.NotificationContainer=SPNotificationContainer;SP.UI.Notify.addNotification=SP.UI.Notify.removeNotification=SP.UI.Notify.showLoadingNotification=NotificationEngine.prototype={Initialized:false,Notifications:undefined,Containers:undefined,Initialize:undefined,AddNotification:undefined,AddContainer:undefined,DisposeNotification:undefined,SetExpireTimer:undefined,RetireNotificationInternal:undefined};(function(){var d=null,b=-1;NotificationEngine.prototype.Initialize=NotificationEngine.prototype.Reset=NotificationEngine.prototype.AddNotification=NotificationEngine.prototype.AddContainer=NotificationEngine.prototype.DisposeNotification=NotificationEngine.prototype.SetExpireTimer=NotificationEngine.prototype.RetireNotificationInternal=SPNotification.prototype={id:undefined,elm:undefined,strHtml:undefined,strTooltip:undefined,bSticky:undefined,bIsAdd:undefined,bNoAnimate:undefined,bHidden:undefined,onclickHandler:undefined,container:undefined,extraData:undefined,expires:undefined};SPNotification.prototype.Initialize=function(e,i,h,f,d,g){var c="notification_"+String(getUniqueIndex()),b=document.createElement("span");b.id=c;this.id=c;this.bIsAdd=true;this.elm=b;this.strHtml=i;this.extraData=g;this.bSticky=h;this.strTooltip=f;this.onclickHandler=d;this.bHidden=false;a().AddNotification(e,this)};SPNotification.prototype.Show=function(a){if(Boolean(a)==true)this.bNoAnimate=true;this.container.AddNotification(this)};SPNotification.prototype.Hide=SPNotificationContainer.prototype={id:undefined,element:undefined,bIsShown:undefined,bIsBlocked:undefined,nDisposalState:undefined,nNotificationLayer:25,nDisplayDuration:7e3,nMaxNotifications:20,events:undefined,items:undefined,pending:undefined,blockedUpdates:undefined};SPNotificationContainer.prototype.Initialize=SPNotificationContainer.prototype.Dispose=SPNotificationContainer.prototype.AddNotification=SPNotificationContainer.prototype.RemoveNotification=SPNotificationContainer.prototype.ShowAllNotifications=SPNotificationContainer.prototype.Update=SPNotificationContainer.prototype.Clear=SPNotificationContainer.prototype.GetCount=SPNotificationContainer.prototype.GetHiddenCount=SPNotificationContainer.prototype.SetEventHandler=SPNotificationContainer.prototype.FireEvent=SPNotificationContainer.prototype.Show=SPNotificationContainer.prototype.Hide=SPNotificationContainer.prototype.BlockUpdatesInternal=SPNotificationContainer.prototype.UnblockUpdatesInternal=var e=function(b,i){var a=b.elm,e=b.onclickHandler,f=b.strTooltip,h=b.bNoAnimate,g=a.className="ms-trcnoti-base";SetOpacity(a,0);var c=document.createElement("div");c.className="ms-trcnoti-bg";AttachEvent("click",g,c);var d=document.createElement("div");d.className=i;c.appendChild(d);a.appendChild(c);if(Boolean(f))a.title=f;a.setAttribute("role","alert");return d},c=tion h(){var g=i(),q=g.ctr,f=g.root,b=g.ovrflw,d=g.host,a=new SPNotificationContainer(SPNotifications.ContainerID.Status,d,75,3);ar h=function(h){var q=e(h,"ms-trcnoti-status"),m=h.strHtml,b=h.extraData,k=document.createElement("div"),d=document.createElement("div"),a=document.createElement("div");d.className="ms-trcnoti-body";k.className="ms-trcnoti-gfx";a.className="ms-trcnoti-txt ms-core-defaultFont ms-trc-noti-title";if(b.img!=null){var i=document.createElement("img");i.src=b.img;if(browseris.ie){i.removeAttribute("width");i.removeAttribute("height")}k.appendChild(i)}if(b.sip!=null)if(browseris.ie5up){var p=j(h.id,m,b.sip);a.appendChild(p);for(var g=p.getElementsByTagName("img"),c=0,r=g.length;c<r;c++)g[c].name=="imnmark"&&IMNRC(g[c].getAttribute("sip"),g[c])}else{var o=document.createElement("span");o.innerHTML=m;a.insertBefore(o,a.firstChild)}else{var l=document.createElement("span");l.className="ms-core-defaultFont ms-textLarge";l.innerHTML=m;a.appendChild(l)}a.appendChild(document.createTextNode(" "));var n=document.createElement("span");n.className="ms-textSmall";n.innerHTML=b.txt;a.appendChild(n);d.appendChild(a);if(b.dt!=null){var f=document.createElement("div");f.className="ms-trcnoti-dt ms-metadata";if(browseris.ie)f.style.paddingBottom="1px";f.innerHTML=b.dt;d.appendChild(f)}q.appendChild(k);q.appendChild(d)},p=function(b){d.setAttribute("aria-live","polite");d.setAttribute("aria-relevant","all");if(IsAccessibilityFeatureEnabled())b();else{var a=new SPAnimation.State;a.SetAttribute(SPAnimation.Attribute.Opacity,1);f.style.top="0px";var c=new SPAnimation.Object(SPAnimation.ID.SmallObject_SlideInFadeInTop,0,f,a,b,null);c.RunAnimation()}f.style.display="block"},o=l=n=k=m=a.SetEventHandler(SPNotifications.EventID.OnShow,p);a.SetEventHandler(SPNotifications.EventID.OnHide,o);a.SetEventHandler(SPNotifications.EventID.OnDisplayNotification,l);a.SetEventHandler(SPNotifications.EventID.OnRemoveNotification,n);a.SetEventHandler(SPNotifications.EventID.OnNotificationCountChanged,k);a.SetEventHandler(SPNotifications.EventID.OnDisposing,m);g_statusNotiCt=a}addNotification=removeNotification=otificationEngine.GetInstance=a})();cGCMinimumWidth=400;cGCMinimumHeight=200;cGCMaxGCResizeCount=10;glGCObjectHeight=0;glGCObjectWidth=0;glGCResizeCounter=0;objGCGlobal=null;PositionInfo_InitializePrototype();ecbManager={callOutPar:null,DismissECB:;ecbItems="ECBItems";SYSTEM_ACCOUNT_ID=1073741823;resetItemGlobals();_spBodyOnLoadFunctions.push(InitFullScreenMode);filterTable=null;bIsFilterMenuShown=false;bIsFilterDataLoaded=false;filterImageCell=null;currentFilterMenu=null;loadingFilterMenu=null;ctxFilter=null;bIsFilterKeyPress=false;filterStr=null;strFieldName="";bMenuLoadInProgress=false;strFilteredValue=null;bIsMultiFilter=false;fnOnFilterMouseOut=null;if(typeof String.prototype.trim=="undefined")String.prototype.trim=if(typeof Object.create==="undefined")Object.create=if(typeof Object.keys==="undefined")Object.keys=RibbonBlock.prototype={initialTabId:null,buildMinimized:true,initStarted:false,initialTabSelectedByUser:false,launchedByKeyboard:false};kfnDisableEvent=new Function("return false");g_menuHtc_lastMenu=null;g_uniqueNumber=0;g_MenuEndOfDOM=false;ElementPosition_InitializePrototype();MenuTag_InitializePrototype();MMU_chDelim=",";MMU_chDelimEnc="%2c";MMU_postbackPrefix="javascript:__doPostBack(";MMU_chDelim2="%";MMU_chDelim2Enc="%25";MHash_InitializePrototype();ParseContext_InitializePrototype();MMU_reDelimEnc=new RegExp(MMU_chDelimEnc,"g");MMU_reDelim2Enc=new RegExp(MMU_chDelim2Enc,"g");MMU_reDelimDec=new RegExp(MMU_chDelim,"g");MMU_reDelim2Dec=new RegExp(MMU_chDelim2,"g");g_MMU_HighlightedEcbTable=null;g_MMU_HighlightedEcbTableOpen=null;g_MMU_OpenTimeoutHandle=null;g_MMU_theFormActionAtPageLoad=null;g_MMU_Form0ActionAtPageLoad=null;g_MMU_Form0ActionAtPreMenuOpen=null;g_MMU_RequestTimeoutTimeoutHandle=null;_AddSilverlightWebPartPopupUI_InitializePrototype();_ConfigSilverlightWebpartPopupUI_InitializePrototype();_launchNotificationId=null;_tenantAppData=null;typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("core.js")}var SPAnimation;nction Animation(a,b){this.ID=a;this.keyFrames=b}ction SPAnimation_Object(a,f,e,b,c,d){this.Initialize(a,f,e,b,c,d)}ationUtility; IsMenuShown,ChevronContainer,itemTableDeferred,imageCell,onKeyPress,downArrowText,currentEditMenu,currentItemID,currentItemAppName,currentItemProgId,currentItemIcon,currentItemOpenControl,currentItemOpenApp,currentItemFileUrl,currentItemFSObjType,currentItemContentTypeId,currentItemCheckedOutUserId,currentItemCheckoutExpires,currentItemModerationStatus,currentItemUIString,currentItemCheckedoutToLocal,bIsCheckout,currentItemCanModify,currentItemPermMaskH,currentItemPermMaskL,currentItemEvtType,currentItemIsEventsExcp,currentItemIsEventsDeletedExcp,g_MaximumSelectedItemsAllowed,g_CustomActionDialogHandlers,g_CustomActionDialogHandlerId,g_ExpGroupWPState,DocOpen,hoverTR,ecbTD;nction IsEventTargetAnchor(a){var b=a.srcElement!=null?a.srcElement:a.target;return b!=null&&b.tagName.toUpperCase()=="A"?true:false}unction ShowMenuForTrOuter(d,b,c){if(b==null)return true;var a=b.srcElement;return a==null?true:a.tagName.toLowerCase()=="div"&&a.className.indexOf("ms-list-itemLink")>=0?ShowCalloutMenuForTr(d,b,c):true}unction ShowCalloutMenuForTrInner(h,c,g){if(IsEventRightClickOnAnchor(c))return true;var b=GetAncestor(h,"TR"),e=GetEcbTdFromRow(b),a=GetEcbDivFromEcbTd(e),d=GetEcbAffordanceDivFromRow(b);if(a==null)return true;g&&SingleItemSelectByElement(b,false);var f=GetAttributeFromItemTable(a,"ItemId","Id");OpenCallout(d,c,a,f);return false}unction ShowECBMenuForTr(d,b){if(IsEventRightClickOnAnchor(b))return true;var c=GetAncestor(d,"TR"),f=GetEcbTdFromRow(c),a=GetEcbDivFromEcbTd(f);if(a==null)return true;c.className.indexOf("s4-itm-selected")<0&&SingleItemSelectByElement(c,false);var g=IsAjaxMenu(a);itemTable=a;currentItemID=GetAttributeFromItemTable(a,"ItemId","Id");currentCtx=g_ctxDict[a.getAttribute("CTXName")];if(g){var e=FIsMouseCursorInsideElement(b,d);return CreateAjaxMenu(b,e)}else return CreateMenu(b)}var ProtocolCommand,phManager;function CBSelectedValues(b,a){this.strList=b;this.fAllChecked=a}unction PageContextInfo(e,n,h,m,q,p,r,k,s,c,a,j,l,o,g,i,f,d,b){this.webServerRelativeUrl=e;this.webAbsoluteUrl=j;this.siteAbsoluteUrl=i;this.layoutsUrl=o;this.webLanguage=n;this.siteClientTag=l;this.currentLanguage=h;this.webUIVersion=m;this.pageListId=q;this.pageItemId=p;this.userId=r;this.alertsEnabled=k;this.siteServerRelativeUrl=c;this.allowSilverlightPrompt=a;this.tenantAppVersion=g;this.themedImageRootPath=f;this.themedImageFileNames=d;this.clientServerTimeDelta=b}function PageContextInfo_InitializePrototype(){PageContextInfo.prototype.webServerRelativeUrl="";PageContextInfo.prototype.webAbsoluteUrl="";PageContextInfo.prototype.siteAbsoluteUrl="";PageContextInfo.prototype.serverRequestPath="";PageContextInfo.prototype.layoutsUrl="";PageContextInfo.prototype.siteClientTag="";PageContextInfo.prototype.webLanguage=0;PageContextInfo.prototype.webTitle=null;PageContextInfo.prototype.webLogoUrl=null;PageContextInfo.prototype.currentCultureName=null;PageContextInfo.prototype.currentUICultureName=null;PageContextInfo.prototype.currentLanguage=0;PageContextInfo.prototype.crossDomainPhotosEnabled=false;PageContextInfo.prototype.webUIVersion=0;PageContextInfo.prototype.pageListId="";PageContextInfo.prototype.pageItemId=0;PageContextInfo.prototype.userId="";PageContextInfo.prototype.systemUserKey="";PageContextInfo.prototype.alertsEnabled=false;PageContextInfo.prototype.customMarkupInCalculatedFieldDisabled=false;PageContextInfo.prototype.siteServerRelativeUrl="";PageContextInfo.prototype.allowSilverlightPrompt="";PageContextInfo.prototype.tenantAppVersion=null;PageContextInfo.prototype.themedImageRootPath=null;PageContextInfo.prototype.themedImageFileNames=null;PageContextInfo.prototype.clientServerTimeDelta=0}var _groupCollapse,_spPageContextInfo,bGridViewPresent,_fV4Calendar,_spCustomNavigateHierarchy,g_ExtensionNotSupportCheckoutToLocal,g_ExtensionDefaultForRead,bValidSearchTerm,ListCtrlObj,fListControl,fListErrorShown,fNewDoc,fNewDoc2,fNewDoc3,SPDesignerDownloadUrl,SPDesignerProgID;function CtxRgiid(b,a){this.ctx=b;this.rgiid=a}unction FilterNoteField(b,g,i,o){if(o!=13)return;event.returnValue=false;var a=window.location.href,m=/&Paged=TRUE&p_[^&]*&PageFirstRow=[^&]*/gi;a=a.replace(m,"");var f=GetUrlKeyValue("View",true);if(f==""){a=StURLSetVar2(a,"View",b);f=b}var e;if(b.toUpperCase()!=f.toUpperCase()){var k=escapeProperly(b);if(k.toUpperCase()!=f.toUpperCase()){var p=/\?[^?]*/i;e=a.indexOf("?");if(e!=-1)a=a.replace(p,"?View="+b);else a=a+"?View="+b}}var c=a.match(new RegExp("FilterField([0-9]+)="+g));if(c==null){e=a.indexOf("?");if(e!=-1)a=a+"&";else a=a+"?";var d=0,h;do{d++;h=a.match(new RegExp("FilterField"+String(d)+"=[^&]*&FilterValue"+String(d)+"=[^&]*"))}while(h!=null);a=a+"FilterField"+String(d)+"="+g+"&FilterValue"+String(d)+"="+escapeProperly(i);a=a.replace("Filter=1&","")}else{var n=parseInt(c[1]),l=a.match(new RegExp("&FilterValue"+String(n)+"=[^&]*")),q="&"+c[0]+l[0],j="&FilterField"+c[1]+"="+g+"&FilterValue"+c[1]+"="+escapeProperly(i);a=a.replace(q,j);a=a.replace("Filter=1&","")}window.location.href=STSPageUrlValidation(a)}function _SelectField(k,m){var a=ajaxNavigate.get_href(),i=ajaxNavigate.get_hash(),b=false,e=/\#.*/i;a=a.replace(e,"");var h=GetUrlKeyValue("View",true),g=GetUrlKeyValue("PageView",true),j=GetUrlKeyValue("ID",true),f=GetUrlKeyValue("ContentTypeId",true);if(k.toUpperCase()!=h.toUpperCase()){var c=escapeProperly(k);if(c.toUpperCase()!=h.toUpperCase()){e=/\?[^?]*/i;var l=a.indexOf("?");if(l!=-1)a=a.replace(e,"?View="+c);else a=a+"?View="+c;b=true}}if(!b&&GetUrlKeyValue("SelectedID")!=""){var d=/&SelectedID=[^&]*/gi;a=a.replace(d,"");d=/\?SelectedID=[^&]*&?/;a=a.replace(d,"?")}a=a+"&SelectedID=";a=a+m;if(b&&g!="")a=a+"&PageView="+g;if(j!="")a=a+"&ID="+j;if(f!="")a=a+"&ContentTypeId="+f;if(i!="")a=a+i;_SubmitFormPost(a);return false}nction CompleteDecode(b){if(typeof b=="undefined"||b==null)return b;var a=b,c=unescapeProperly(a);while(a!=c){a=c;c=unescapeProperly(a)}return a}function FilterFieldV3(l,k,i,t,r,G){var g,a=Boolean(r)?r:CanonicalizeUrlEncodingCase(ajaxNavigate.get_href()),v=new URI(a,{disableEncodingDecodingForLegacyCode:true});a="?"+v.getQuery();var e,q,b=a.match(new RegExp("[&?]Paged=TRUE[^&]*"));if(b!=null){var c=/&p_[^&]*/gi;a=a.replace(c,"");c=/&PageFirstRow=[^&]*/gi;a=a.replace(c,"");c=/&PageLastRow=[^&]*/gi;a=a.replace(c,"");c=/&PagedPrev=TRUE[^&]*/i;a=a.replace(c,"");b=a.match(new RegExp("[?]Paged=TRUE[^&]*"));if(b!=null){g=a.substr(b.index).indexOf("&");if(g!=-1)a=a.substr(0,b.index+1)+a.substr(g+b.index+1);else a=a.substr(0,b.index)}else{c=/&Paged=TRUE[^&]*/i;a=a.replace(c,"")}}var u=GetUrlKeyValue("View",true);if(u==""){a=StURLSetVar2(a,"View",l);u=l}if(CompleteDecode(l.toUpperCase())!=CompleteDecode(u.toUpperCase())){var H=/\?[^?]*/i;g=a.indexOf("?");if(g!=-1)a=a.replace(H,"?View="+l);else a=a+"?View="+l}var s=true;b=a.match(new RegExp("FilterField([0-9]+)="+k+"&"));if(!Boolean(b)){b=a.match(new RegExp("FilterFields([0-9]+)="+k+"&"));s=false}if(!Boolean(b))if(0==t){a=a.replace("Filter=1&","");a=a.replace("?Filter=1","")}else{g=a.indexOf("?");if(g!=-1)a=a+"&";else a=a+"?";var m=0;do{m++;q=a.match(new RegExp("FilterField"+String(m)+"=[^&]*"));if(!Boolean(q))q=a.match(new RegExp("FilterFields"+String(m)+"=[^&]*"))}while(q!=null);a=a+"FilterField"+String(m)+"="+k+"&FilterValue"+String(m)+"="+escapeProperly(i);a=a.replace("Filter=1&","")}else{e=parseInt(b[1]);var f=a.match(new RegExp("FilterValue"+String(e)+"=[^&]*"));if(!Boolean(f))f=a.match(new RegExp("FilterValues"+String(e)+"=[^&]*"));var C=a.match(new RegExp("&FilterOp"+String(e)+"=[^&]*")),z=a.match(new RegExp("&FilterLookupId"+String(e)+"=[^&]*")),B=a.match(new RegExp("&FilterData"+String(e)+"=[^&]*")),j="&"+b[0]+f[0];if(0==t){if(a.indexOf(j)==-1){var F=b[0];j=F+f[0]+"&"}a=a.replace(j,"");if(C!=null)a=a.replace(String(C[0]),"");if(z!=null)a=a.replace(String(z[0]),"");if(B!=null)a=a.replace(String(B[0]),"");a=restructureFilterUrl(a,e);a=a.replace("Filter=1&","");a=a.replace("?Filter=1","");a=a.replace("&Filter=1","")}else{var o;if(a.indexOf(j)==-1){j="?"+b[0]+f[0];o="?"}else o="&";var p;if(ctxFilter==null||!ctxFilter.IsClientRendering)p=o+"FilterField"+b[1]+"="+k+"&FilterValue"+b[1]+"="+escapeProperly(i);else{var w=false,d=String(f[0].substr(f[0].indexOf("=")+1)),h=[],n=[];if(s){d=unescapeProperly(d);if(i!=d){h.push(d);h.push(i)}}else{n=ParseMultiColumnValue(unescapeProperly(d),";#",true);for(var A in n){if(n[A]==i){w=true;continue}h.push(n[A])}!w&&h.push(i)}d=escapeProperly(ConvertMultiColumnValueToString(h,null,false));var x="FilterField",y="&FilterValue";if(h.length>1){x="FilterFields";y="&FilterValues"}p=o+x+b[1]+"="+k+y+b[1]+"="+d;if(d==""&&s){p="";a=restructureFilterUrl(a,e)}}a=a.replace(j,p);a=a.replace("Filter=1&","");a=a.replace("&Filter=1","")}}var E=b;b=a.match(new RegExp("FilterField([0-9]+)="));if(!Boolean(b))b=a.match(new RegExp("FilterFields([0-9]+)="));if(b==null&&t==0&&ctxFilter!=null&&(!ctxFilter.IsClientRendering||E!=null&&!Boolean(r)))a=a+"&FilterClear=1";else a=a.replace("&FilterClear=1","");v.setQuery(a);a=v.getString();if(G){var D=a.indexOf("?");D=a.substr(D+1).indexOf("?");return a}else _SubmitFormPost(a);return null}function restructureFilterUrl(a,h){var b=h+1,f=a.match(new RegExp("FilterField"+String(b)+"=[^&]*")),g=false;if(!Boolean(f)){f=a.match(new RegExp("FilterFields"+String(b)+"=[^&]*"));g=f!=null}for(var e=h;f!=null;e++){var c=g?"FilterFields"+String(e):"FilterField"+String(e),d=g?"FilterFields"+String(b):"FilterField"+String(b);a=a.replace(d,c);c=g?"FilterValues"+String(e):"FilterValue"+String(e);d=g?"FilterValues"+String(b):"FilterValue"+String(b);a=a.replace(d,c);c="FilterOp"+String(e);d="FilterOp"+String(b);a=a.replace(d,c);c="FilterLookupId"+String(e);d="FilterLookupId"+String(b);a=a.replace(d,c);c="FilterData"+String(e);d="FilterData"+String(b);a=a.replace(d,c);b++;f=a.match(new RegExp("FilterField"+String(b)+"=[^&]*"));if(!Boolean(f))f=a.match(new RegExp("FilterFields"+String(b)+"=[^&]*"))}return a}function CanonicalizeUrlEncodingCase(c){for(var b="",a=0;a<c.length;a++){var d=c.charAt(a);if(d=="%"&&a+2<c.length){b+=d;a++;b+=c.charAt(a).toString().toUpperCase();a++;b+=c.charAt(a).toString().toUpperCase()}else b+=d}return b}ction HandleFilter(e,b,d){if(FV4UI()){var a;try{a=typeof inplview.HandleFilterReal}catch(h){a="undefined"}var g="inplview.HandleFilterReal",c=g.split(".");if(c.length>1){var f=function(){inplview.HandleFilterReal(e,b,d)};EnsureScript(c[0],a,f)}return}_SubmitFormPost(b)}unction DemoteIntoFormBody(e,c,b){var d=GetUrlKeyValue(b,false,c);if(d.length>0){var a=document.createElement("INPUT");if(a!=null){a.setAttribute("type","hidden");a.setAttribute("id",b);a.setAttribute("name",b);a.setAttribute("value",d);e.appendChild(a);return RemoveUrlKeyValue(b,c)}}return c}function RemoveUrlKeyValue(c,a){var b=new RegExp(c+"=[^&]*&");a=a.replace(b,"");b=new RegExp(c+"=[^&]*");a=a.replace(b,"");return a}ar g_varSkipRefreshOnFocus;unction RefreshOnFocusForOneRow(){RefreshOnFocus()}tion _EnterFolder(c){var b=RemoveParametersFromUrl(window.location.href),a=RemoveParametersFromUrl(c),d=a!=null&&a.length>0&&a.charAt(0)=="/"&&a.length<b.length&&b.indexOf(a)==b.length-a.length;if(!d&&a.toLowerCase()!=b.toLowerCase())STSNavigate(c);else _SubmitFormPost(c)}function _HandleFolder(f,e,s,l,h,k,c,n,d,a,b,o,p,m,j,r){var q=Boolean(a)&&a!="",i=Boolean(b)&&b!="",g=!IsNullOrUndefined(f.getAttribute("isEdit"));if(q&&i||a=="OneNote.Notebook"&&g){if(c=="FALSE"&&f!=null&&g&&!IsNullOrUndefined(d))c=d;DispEx(f,e,l,h,k,c,n,d,a,b,o,p,m,j,r)}else{e!=null&&CancelEvent(e);_EnterFolder(s)}}ar g_useDialogAlwaysList;unction GetCtxFromFormUrl(c){var d=null,a=GetUrlKeyValue("LISTID",false,c.toUpperCase());if(a=="")a=GetUrlKeyValue("LIST",false,c.toUpperCase());if(a!=""&&g_ctxDict!=null)for(var e in g_ctxDict){var b=g_ctxDict[e];if(Boolean(b.listName)&&b.listName.toUpperCase()==a.toUpperCase()){d=b;break}}return d}function UseDialogsForFormsWithCtx(a){return a==null||typeof a.NavigateForFormsPages=="undefined"?false:!Boolean(a.NavigateForFormsPages)}unction _STSNavigateWithCheckoutAlert(a,g,b,e,f,d,c){CheckoutAlertBeforeNavigate(a,g,b,e,f,d,c)&&STSNavigate(a)}function ShowInPopUI(b,a,c){var d=function(){if(a==null&&typeof b.fromRibbon=="boolean"&&b.fromRibbon&&typeof b.currentCtx!="undefined"&&b.currentCtx!=null)a=b.currentCtx;if(typeof a!="undefined"&&a!=null&&a.clvp!=null){var d=a.clvp;GetFocusInfo(b,d);d.ShowPopup(c)}else STSNavigate(c)};EnsureScript("inplview",typeof inplview,d)}unction CheckoutviaXmlhttp(c,b){var a,e;a=new XMLHttpRequest;if(a==null)return false;a.open("POST",c+"/_vti_bin/lists.asmx",false);a.setRequestHeader("Content-Type","text/xml; charset=utf-8");a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CheckOutFile");var d='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CheckOutFile xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>'+b+"</pageUrl></CheckOutFile></soap:Body></soap:Envelope>";a.send(d);return a.status==200&&a.responseText.indexOf("true")!=0}function FSupportCheckoutToLocal(a){var c=true;if(a==null||a=="")return false;a=a.toLowerCase();for(var b=0,b=0;b<g_ExtensionNotSupportCheckoutToLocal.length;b++)if(a==g_ExtensionNotSupportCheckoutToLocal[b])return false;return true}unction CheckoutDocument(g,a,e){var b=null,c=true,d=false;if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;var f=SzExtension(unescapeProperly(a));if(FSupportCheckoutToLocal(f)&&e=="SharePoint.OpenDocuments.3")b=StsOpenEnsureEx2(e);if(b!=null&&!browseris.chrome)try{c=typeof b.CheckoutDocumentPrompt!="undefined"&&b.CheckoutDocumentPrompt(unescapeProperly(a),false,"");c&&RefreshOnFocus();d=c;if(d||!(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()))return c}catch(i){}if(!d){var h="FileName="+escapeProperly(unescapeProperly(a))+"&Checkout=true";NavigateToCheckinAspx(g,h)}return true}function NewOrEditV4Core(a,b,c){var d=a!=null&&EnsureScript("inplview",typeof InitAllClvps,d);if(c)_OpenPopUpPage(b,RefreshOnDialogClose);else _OpenPopUpPage(b,RefreshPage);return false}function _NewItem2(b,a){if(UseDialogsForNewItem(a)||UseDialogsForFormsPages(a))return NewOrEditV4Core(b,a);else{_NewItem(a);return undefined}}function _NewItem(a){GoToPage(a)}unction _EditItem(a){GoToPage(a)}function _CorrectUrlForRefreshPageSubmitForm(){var b=window.location.href;if(typeof g_MinimalDownload!="undefined"&&g_MinimalDownload){var d=ajaxNavigate.getSavedFormAction();if(d!=null&&d.length>0)b=d}var a=ajaxNavigate.getParam("ServerFilter");if(typeof a!="undefined"&&null!=a&&a.length>0){a=a.replace(/-/g,"&").replace(/&&/g,"-");var f=GetUrlKeyValue("RootFolder",true,a),e=GetUrlKeyValue("RootFolder",true);if(""==f&&""!=e)a+="&RootFolder="+e;var c=new URI(b,{disableEncodingDecodingForLegacyCode:true});c.setFragment("");c.setQuery(a);return c.getString()}return b}function _RefreshPage(a){var b=function(){SetFocusBack(a)};if(a==1)_SubmitFormPost(_CorrectUrlForRefreshPageSubmitForm());else EnsureScript("inplview",typeof InitAllClvps,b)}function AJAXRefreshView(a,c){if(a==null||!(typeof a.fakeEvent=="boolean"&&a.fakeEvent||typeof a.csrAjaxRefresh=="boolean"&&a.csrAjaxRefresh||typeof a.fromRibbon=="boolean"&&a.fromRibbon))_RefreshPage(c);else if(c==SP.UI.DialogResult.OK){var b;try{b=typeof inplview.HandleRefreshView}catch(g){b="undefined"}var f="inplview.HandleRefreshView",d=f.split(".");if(d.length>1){var e=function(){inplview.HandleRefreshView(a)};EnsureScript(d[0],b,e)}}}ction OpenPopUpPageWithTitle(f,a,d,b,c){var e={url:f,args:null,title:c,dialogReturnValueCallback:a,width:d,height:b};OpenPopUpPageWithDialogOptions(e)}ction _OpenPopUpPage(d,a,c,b){OpenPopUpPageWithTitle(d,a,c,b,null)} _ExportList(a){var b=typeof navigator.msProtocols=="function"&&navigator.msProtocols.excel;!b&&g_ssImporterObj==null&&EnsureSSImporter();if(!b&&g_ssImporterObj==null)(g_fSSImporter||GetCookie("EnsureSSImporter")==null)&&EnsureSSImporter(true);if(IsSupportedMacBrowser()){if(g_fSSImporter!=null&&typeof g_ssImporterObj.IqyExportEnabled!="undefined"&&g_ssImporterObj.IqyExportEnabled&&typeof g_ssImporterObj.IqyExport!="undefined"){var c=g_ssImporterObj.IqyExport(makeAbsUrl(a));if(!c)window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else if(confirm(Strings.STS.L_ExportListSpreadsheet_Text))window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else if(b||g_fSSImporter!=false&&typeof g_ssImporterObj.IqyImportEnabled!="undefined"&&g_ssImporterObj.IqyImportEnabled()||confirm(Strings.STS.L_ExportListSpreadsheet_Text))window.location.href=STSPageUrlValidation(makeAbsUrl(a))}itSearch(){_SubmitSearchForView("")}ocumentWithProgID2(e,a,h,g,f,b,i){editDocumentWithProgIDNoUI(e,a,h,g,f,b,i,c,d);unction d(){alert(Strings.STS.L_EditDocumentProgIDError_Text)}}function editDocumentWithProgIDNoUI(a,d,e,h,n,l,c,i,j){var b,f=false;e=e.replace(/(?:\.\d+)$/,"");if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;var m=SzExtension(unescapeProperly(a));if(phManager.ShouldTryProtocolHandler(c)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(c,a,ProtocolCommand.Edit,null),function(){PHSucceed(c,true)},function(){PHSucceed(c,false);g()});return}g();function g(){var a=k();if(a==1&&i!=null)i();else a==2&&j!=null&&j()}function k(){if(!IsNullOrUndefined(c)&&c!=""&&phManager.IsProtocolHandlerEnabled(c)){window.location.href=phManager.CreateProtocolHandlerUrl(c,a,ProtocolCommand.Edit,null);return 0}if(FSupportCheckoutToLocal(m))try{b=StsOpenEnsureEx2(e+".3");if(b!=null){if(h=="1"){if(typeof b.CheckoutDocumentPrompt=="undefined")return 1;if(!b.CheckoutDocumentPrompt(a,true,d))return 1}else{if(l=="1")f=true;if(!b.EditDocument3(window,a,f,d))return 1}var g=false;g=b.PromptedOnLastOpen();if(g)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus();return 0}}catch(i){}if(h=="1")if(confirm(Strings.STS.L_ConfirmCheckout_Text))NavigateToCheckinAspx(n,"FileName="+escapeProperly(unescapeProperly(a))+"&Checkout=true");else return 0;b=StsOpenEnsureEx2(e);if(b!=null){try{if(!b.EditDocument2(window,a,d))return 1;if(e=="SharePoint.OpenXMLDocuments")SetWindowRefreshOnFocus();else window.onfocus=RefreshOnNextFocus;return 0}catch(i){}try{window.onfocus=null;if(SzExtension(a)=="ppt"&&d=="")d="PowerPoint.Slide";if(!b.EditDocument(a,d))return 1;SetWindowRefreshOnFocus();return 0}catch(i){return 2}}return 1}}n createNewDocumentWithRedirect(f,b,a,g,e,h,d,c){if(h)if(IsClientAppInstalled(a,c,null))createNewInClient(f,b,a,g,c);else createNewInBrowser(e,b,a,d);else if(IsClientAppInstalled(a,c,null)&&d!=1)createNewInClient(f,b,a,g,c);else createNewInBrowser(e,b,a,d)}unction createNewInBrowser(a,f,g,e){a=a+"&SaveLocation="+makeAbsUrl(escapeProperly(f));a=AddInfoPathParametersToUrl(a,g,null,e);a=AddSourceToUrl(a);var d=new URI(a),b=false;if(Boolean(d)){var c=d.getPath(true);if(Boolean(c)&&c.toLowerCase().indexOf("createnewdocument.aspx")!=-1)b=true}if(b)_OpenPopUpPage(a,OnCloseDialogNavigate);else STSNavigate(a)}function OnCloseDialogNavigate(b,a){b==SP.UI.DialogResult.OK&&Boolean(a)&&STSNavigate(a)} ExpDataViewGroupOnPageLoad(){ExpGroupOnPageLoad("PageLoad")}function ExpGroupOnPageLoad(a){var b=document.getElementById("GroupByColFlag");if(b!=null){g_ExpGroupNeedsState=true;ExpGroupParseCookie(a)}}function ExpGroupParseCookie(a){var d=GetCookie(ExpGroupWPListName);if(d==null)return;g_ExpGroupParseStage=true;for(var e=d.split(ExpGroupCookieDelimiter),c=e.length-1;c>=0;c--){var b=e[c];LRUCache_Add(g_ExpGroupWPState,b);if(g_ExpGroupTable[b]==null)document.getElementById("GroupByCol"+b)!=null&&ExpGroupParseCookieForWebPart(b,a)}g_ExpGroupParseStage=false;if(Boolean(a)&&g_ExpGroupXSLTQueue.length>0)ExpGroupFetchData(g_ExpGroupXSLTQueue.shift(),a);else!Boolean(a)&&g_ExpGroupCAMLQueue.length>0&&ExpGroupFetchData(g_ExpGroupCAMLQueue.shift(),a)}v_stsOpenDoc,v_strStsOpenDoc;function NavigateParentOrSelf(b,a){if(b.target=="_top"&&typeof window.frameElement.navigateParent!="undefined")window.frameElement.navigateParent(a);else STSNavigate(a)}nction _DispDocItemExWithServerRedirect(d,c,j,g,i,f,k,a){var e=a!=null&&a!="",h=IsClientAppInstalled(f,null,d)&&HasRights(16,0)||SzExtension(d.href)=="pdf";if(e){a=a.substring(1);e=a!=""}if(e)if(k=="1"||!h){var b=a;b=AddInfoPathParametersToUrl(b,f,d,DocOpen.BROWSER);b=AddSourceToUrl(b);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(b);else if(c.shiftKey||c.ctrlKey)return true;else NavigateParentOrSelf(d,b);c.cancelBubble=true;c.returnValue=false;return false}return DispDocItemExWithEvent(d,c,j,g,i,f)}unction DispDocItemExWithEvent(g,f,r,o,q,c,l,p){var h;itemTable=FindSTSMenuTable(g,"CTXName");if(!browseris.ie&&!IsSupportedMacBrowser()&&!IsSupportedNPApiBrowserOnWin()){if(browseris.ie)event.cancelBubble=false;h=g.href;if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(h);else STSNavigate(h);return false}var a,b,e=true,i="",s=document.getElementById("FileDialogViewTable");if(s!=null){if(browseris.ie){event.cancelBubble=false;event.returnValue=false}return true}var d=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"",k=Boolean(g.getAttribute("isEdit"))||d=="ms-infopath";b=itemTable!=null?GetAttributeFromItemTable(itemTable,"Url","ServerUrl"):"";if(b==null||b==""){if(k)b=g.editHref;if(!Boolean(b))b=g.href}else b=SzServer(g.href)+b;var j=SzExtension(b),n=k&&HasRights(0,4)&&!FDefaultOpenForReadOnly(j)&&(!Boolean(currentItemCheckedOutUserId)||currentItemCheckedOutUserId==ctx.CurrentUserId);if(!Boolean(d))d=g.getAttribute("App");if(phManager.ShouldTryProtocolHandler(d)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(d,b,n?ProtocolCommand.Edit:ProtocolCommand.View,null),;return CancelMyEvent(false,a,f,true)}return m();function m(){phManager.SetProtocolHandlerEnabled(d,null);if(l!=null&&!(k&&(p||browseris.chrome))){l();return CancelMyEvent(false,a,f,true)}if(Boolean(d)&&phManager.IsProtocolHandlerEnabled(d))if(d!=null&&d!=""){window.location.href=phManager.CreateProtocolHandlerUrl(d,b,n?ProtocolCommand.Edit:ProtocolCommand.View,null);return CancelMyEvent(false,a,f,true)}if(currentItemProgId==null&&itemTable!=null)currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType");if(currentItemProgId!=null)i=currentItemProgId;if(FDefaultOpenForReadOnly(j)){if(c.indexOf("SharePoint.OpenDocuments")>=0)c="SharePoint.OpenDocuments.3"}else if(!FSupportCheckoutToLocal(j))c="";if(currentItemCheckedOutUserId==null&&itemTable!=null&&typeof itemTable.COUId=="string")currentItemCheckedOutUserId=itemTable.COUId;if(currentItemCheckedoutToLocal==null&&itemTable!=null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&currentItemCheckedOutUserId==ctx.CurrentUserId&&(c==""||c.indexOf("SharePoint.OpenDocuments")>=0)&&FSupportCheckoutToLocal(j)||c=="SharePoint.OpenDocuments")c="SharePoint.OpenDocuments.3";var s=2;if(c!=""&&HasRights(16,0)){if(c.indexOf(".3")>=0)s=3;a=StsOpenEnsureEx2(c);if(a==null&&s==3){c=c.replace(".3",".2");a=StsOpenEnsureEx2(c);s=2}}if(a!=null)if(s==2||itemTable==null&&currentItemCheckedOutUserId==null||ctx.isVersions==1&&(itemTable==null||typeof itemTable.isMostCur!="string"||itemTable.isMostCur=="0")){try{if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&(currentItemCheckedOutUserId==ctx.CurrentUserId||ctx.CurrentUserId==null))if(currentItemCheckedoutToLocal=="1"){alert(Strings.STS.L_OpenDocumentLocalError_Text);e=false}else e=typeof a.EditDocument2!="undefined"&&a.EditDocument2(window,b,i);else e=typeof a.ViewDocument2!="undefined"&&a.ViewDocument2(window,b,i)}catch(v){e=false}if(e)window.onfocus=RefreshOnNextFocus}else{var m=0;if(currentItemCheckedOutUserId!="")if(currentItemCheckedOutUserId!=ctx.CurrentUserId&&ctx.CurrentUserId!=null)m=1;else if(currentItemCheckedoutToLocal==null||currentItemCheckedoutToLocal!="1")m=2;else m=4;else if(!HasRights(0,4)||FDefaultOpenForReadOnly(j))m=1;else if(ctx.isForceCheckout==true)m=3;try{if(k)e=typeof a.EditDocument3!="undefined"&&a.EditDocument3(window,b,false,i);else e=typeof a.ViewDocument3!="undefined"&&a.ViewDocument3(window,b,m,i)}catch(v){e=false}if(e){var t=typeof a.PromptedOnLastOpen!="undefined"&&a.PromptedOnLastOpen();if(t)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus()}}else currentItemCheckedoutToLocal=="1"&&alert(Strings.STS.L_OpenDocumentLocalError_Text);if(a==null||!e){if(r=="TRUE"&&o=="TRUE"&&q=="TRUE"){if(itemTable==null)return e;if(browseris.ie){event.cancelBubble=true;event.returnValue=false}else if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){typeof f.preventDefault!="undefined"&&f.preventDefault();typeof f.stopPropagation!="undefined"&&f.stopPropagation()}var u=new Function("return "+itemTable.getAttribute("CTXName")+".HttpRoot;");h=u()+"/_layouts/15/htmltrverify.aspx?doc="+escapeProperly(b);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(h);else GoToPage(h)}else if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(g.href);else{CancelMyEvent(false,a,f,true);STSNavigate(g.href)}return false}return CancelMyEvent(e,a,f)}}function CancelMyEvent(b,d,a,c){if(browseris.ie){if(event!=null){event.cancelBubble=true;event.returnValue=false}}else if(IsSupportedMacBrowser()||IsSupportedNPApiBrowserOnWin()){if(c||d!=null&&b){typeof a.preventDefault!="undefined"&&a.preventDefault();typeof a.stopPropagation!="undefined"&&a.stopPropagation()}return true}return b}function DispDocItemEx2(b,c,m,k,l,s,j,d,g){var a,u=false,p=g!=null&&g!="",e=IsClientAppInstalled(d,null,b)&&HasRights(16,0),f=!IsNullOrUndefined(b.getAttribute("isEdit"));function q(){a=g;a=AddInfoPathParametersToUrl(a,d,b,DocOpen.BROWSER);a=AddSourceToUrl(a);if(f){var e=new URI(a);e.setQueryParameter("action","edit");a=e.getString()}if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(a);else if(c.shiftKey||c.ctrlKey)return true;else NavigateParentOrSelf(b,a);c.cancelBubble=true;c.returnValue=false;typeof c.preventDefault!="undefined"&&c.preventDefault();typeof c.stopPropagation!="undefined"&&c.stopPropagation();return false}function n(){!ViewDoc(b.href,d)&&editDocumentWithProgIDNoUI(b.href,currentItemProgId,d,"0",ctx.HttpRoot,"0",i,o,o);var a=StsOpenEnsureEx2(d);return CancelMyEvent(false,a,c)}if(SzExtension(b.href).indexOf("pdf")!=-1)if(!e||j=="1"){var h=b,r=f&&Boolean(h.editHref)?h.editHref:h.href;h.href=r;STSNavigate(r);return false}else return n();if(p){itemTable=FindSTSMenuTable(b,"CTXName");var i=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(i))i=b.getAttribute("App");var t=!e&&(browseris.ie10standardUp||browseris.msEdge||browseris.chrome&&f)&&Boolean(i)&&(j=="0"||f)&&HasRights(0,32);if(!t&&(j=="1"&&!(e&&f&&HasRights(0,32))||!e))return q();else if(e)return d==""||d.indexOf("SharePoint.OpenDocuments")>=0?DispDocItemExWithEvent(b,c,m,k,l,s):n()}eturn DispDocItemExWithEvent(b,c,m,k,l,d,p?q:null,e)}unction AddSourceToUrl(a){var d=a.toLowerCase().indexOf("/wopiframe.aspx?")>0;if(d){document.cookie="WOPISessionContext="+GetSource()+";path=/;";return a}else{var b=GetSource(),c=a.length+b.length;if(c>1950)return a;else{var e=a.indexOf("?")>=0?"&":"?";return a+e+"Source="+b}}}ction _VerifyHref(a,d,c,f,b){var g=d.button==Sys.UI.MouseButton.rightButton,i=GetRedirectedHref(a.href,c,f,null,b,false,g,a),h=b!=null&&b.length>1,e=IsClientAppInstalled(f,null,a)&&HasRights(16,0);if(h){if(c=="1"&&!(e&&!IsNullOrUndefined(a.getAttribute("isEdit")))||!e){if(Boolean(a.getAttribute("isEdit")))a.editHref=a.href;if(c=="1")a.href=i;d.cancelBubble=true;d.returnValue=true}DetachEvent("mousedown",VerifyHref,a)}return false}function GetRedirectedHref(c,k,e,f,b,g,j,h){var d=b!=null&&b!=""&&(!g||f!=null&&f!=""),i=IsClientAppInstalled(e,null,h)&&HasRights(16,0);if(d){b=b.substring(1);d=b!=""}var a=c;if(d)if(g||k=="1"||!i){a=b;if(!IsInfoPathProgId(e)&&c.indexOf("?")<0&&j)a=c+"?Web=1";else if(GetUrlKeyValue("Web",true,c,true)=="1")a=c;else{a=AddInfoPathParametersToUrl(a,e,h,DocOpen.BROWSER);a=AddSourceToUrl(a)}a=STSPageUrlValidation(a)}return a}function _DispEx(p,a,h,e,g,k,c,o,m,b,j,l,i,f,d){if(a.shiftKey||a.ctrlKey)return true;var n=document.getElementById("FileDialogViewTable");if(n!=null){a.cancelBubble=false;a.returnValue=false;return true}if(typeof ctx=="undefined"||ctx==null)ctx=new ContextInfo;CtxSetCurrentUserId(l);if(i=="1")CtxSetIsForceCheckout(true);else CtxSetIsForceCheckout(false);currentItemCheckedOutUserId=j;currentItemCheckedoutToLocal=f;currentItemProgId=m;if(d!=null&&d!=""){SetCurrentPermMaskFromString(d,null);if(c=="0"&&!HasRights(0,32))c="1"}a.cancelBubble=true;if(b!=null&&b!="")b=b.substring(1);return DispDocItemEx2(p,a,h,e,g,k,c,o,b)}function IsClientAppInstalled(c,e,b){if(e!=null&&phManager.IsProtocolHandlerEnabled(e,true))return true;if(b!=null){itemTable=FindSTSMenuTable(b,"CTXName");var a=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(a))a=b.getAttribute("App");if(Boolean(a)&&phManager.IsProtocolHandlerEnabled(a,true))return true}var d=null;if(c!="")d=StsOpenEnsureEx2(c);return d!=null}n _MoveToDate(a,b){_MoveToViewDate(a,null,b)}n NewItemDay(b,a){NewItemDT(b,a,null)}vigateHierarchyQString;unction SetAdditionalNavigateHierarchyQString(a){g_AdditionalNavigateHierarchyQString=a}unction ParseMultiColumnValue(b,f,i){var d,e=[];if(f==null)f=";#";var p=f.charCodeAt(0),o=f.charCodeAt(1);if(b==null||b.length==0)return e;var h=f.charAt(0),n=h+h,l=new RegExp(n,"g"),k=f.charAt(0),c=0;if(b.substr(0,2)==f){Boolean(i)&&e.push("");c=2}var a=c,g=false,j=b.length;while(a<j){var m=b.indexOf(h,a);if(m>=0){a=m;a++;if(b.charCodeAt(a)==o){if(a-1>c){d=b.substr(c,a-c-1);if(g)d=d.replace(l,k);e.push(d);g=false}else e.push("");a++;c=a;continue}else if(b.charCodeAt(a)==p){a++;g=true;continue}else throw"ArgumentException";}else a=j}if(a>c){d=b.substr(c,a-c);if(g)d=d.replace(l,k);e.push(d)}else Boolean(i)&&e.push("");return e}function ConvertMultiColumnValueToString(f,b,c){if(b==null)b=";#";if(c==null)c=true;for(var h=b.charAt(0),i=h+h,j=new RegExp(b.charAt(0),"g"),g=false,d="",e=0;e<f.length;e++){var a=f[e];if(a!=null&&a.length>0)a=a.replace(j,i);if(a!=null&&a.length>0)g=true;if(c||e!=0)d+=b;d+=a}if(g){if(c)d+=b;return d}else return""}var httpFolderTarget,httpFolderSource,httpFolderDiv;function NavigateHttpFolderCore(){var a;if(httpFolderDiv==null){httpFolderDiv=document.createElement("DIV");document.body.appendChild(httpFolderDiv);httpFolderDiv.onreadystatechange=NavigateHttpFolderCore;typeof httpFolderDiv.addBehavior!="undefined"&&httpFolderDiv.addBehavior("#default#httpFolder")}if(typeof httpFolderDiv.readyState=="string"&&httpFolderDiv.readyState=="complete"){httpFolderDiv.onreadystatechange=null;try{a=typeof document.frames!="undefined"&&typeof document.frames.item!="undefined"?document.frames.item(httpFolderTarget):null;if(a!=null){var d=typeof a.document!="undefined"?a.document:null;if(d!=null){var f=typeof d.body!="undefined"?d.body:null;if(f!=null&&typeof f.innerText=="string")f.innerText=Strings.STS.L_WebFoldersRequired_Text}}}catch(i){}var b=false;try{var g="";if(typeof httpFolderDiv.navigateFrame!="undefined")g=httpFolderDiv.navigateFrame(httpFolderSource,httpFolderTarget);if(g=="OK")b=true}catch(i){}if(!b&&0==httpFolderSource.search(new RegExp("http://[a-zA-Z0-9-.]+(:80)?/"))){var h=httpFolderSource.replace(/http:\/\/([a-zA-Z0-9\-\.]+)(:80)?[\/]/,"//$1/").replace(/[\/]/g,"\\");try{a=typeof document.frames!="undefined"&&typeof document.frames.item!="undefined"?document.frames.item(httpFolderTarget):null;if(a!=null){a.onload=null;var c=typeof a.document!="undefined"?a.document:null;if(c!=null){var e=typeof c.location!="undefined"?c.location:null;if(e!=null&&typeof e.href=="string"){e.href=h;b=true}}}}catch(i){}}if(!b)if(browseris.ie)alert(Strings.STS.L_WebFoldersError_IE_Text);else alert(Strings.STS.L_WebFoldersError_Text)}}function NavigateHttpFolder(a,b){if("/"==a.charAt(0))a=window.location.protocol+"//"+window.location.host+a;httpFolderSource=a;httpFolderTarget=b;NavigateHttpFolderCore()}function NavigateHttpFolderIfSupported(b,a){if(a=="_blank")if(SupportsNavigateHttpFolder())NavigateHttpFolder(b,a);else alert(Strings.STS.L_WebFoldersError_Text);else alert(Strings.STS.L_NoExplorerView_Text)}ction SendEmail(c){var a;try{a=typeof SP.Ribbon.EMailLink.openMailerWithUrl}catch(f){a="undefined"}var e="SP.Ribbon.EMailLink.openMailerWithUrl",b=e.split(".");if(b.length>1){var d=EnsureScript(b[0],a,d)}}nction CopyPageAddressToClipboard(){CopyStringToClipboard(window.location.href)}nction EnsureCheckoutAndChangeLayoutModeToEdit(e,d,g){var a,c=function(){var a;try{a=typeof browserScript.MSOLayout_ChangeLayoutMode}catch(e){a="undefined"}var d="browserScript.MSOLayout_ChangeLayoutMode",b=d.split(".");if(b.length>1){var c=function(){browserScript.MSOLayout_ChangeLayoutMode(g)};EnsureScript(b[0],a,c)}},f=h=b;try{b=typeof SP.ClientContext}catch(i){b="undefined"}EnsureScript("SP.js",b,h)}function _ChangeLayoutMode(e,f){var a;try{a=typeof browserScript.MSOLayout_ChangeLayoutMode}catch(g){a="undefined"}var d="browserScript.MSOLayout_ChangeLayoutMode",b=d.split(".");if(b.length>1){var c=function(){browserScript.MSOLayout_ChangeLayoutMode(e,f)};EnsureScript(b[0],a,c)}}unction OpenWebPartMenu(e,f,g,h,i){var a;try{a=typeof browserScript.MSOWebPartPage_OpenMenu}catch(j){a="undefined"}var d="browserScript.MSOWebPartPage_OpenMenu",b=d.split(".");if(b.length>1){var c=EnsureScript(b[0],a,c)}return true}unction _WebPartMenuKeyboardClick(e,c,d,f){var a;try{a=typeof browserScript.MSOMenu_KeyboardClick}catch(i){a="undefined"}var h="browserScript.MSOMenu_KeyboardClick",b=h.split(".");if(b.length>1){var g=EnsureScript(b[0],a,g)}}function _ShowToolPane2Wrapper(e,f,g){var a;try{a=typeof browserScript.MSOTlPn_ShowToolPane2Wrapper}catch(h){a="undefined"}var d="browserScript.MSOTlPn_ShowToolPane2Wrapper",b=d.split(".");if(b.length>1){var c=EnsureScript(b[0],a,c)}}function ChangeWebPartPageView(c){var a;try{a=typeof browserScript.MSOLayout_ToggleView}catch(f){a="undefined"}var e="browserScript.MSOLayout_ToggleView",b=e.split(".");if(b.length>1){var d=function(){browserScript.MSOLayout_ToggleView(c)};EnsureScript(b[0],a,d)}}function _SetupFixedWidthWebParts(){var a;try{a=typeof browserScript.MSOWebPartPage_SetupFixedWidthWebParts}catch(e){a="undefined"}var d="browserScript.MSOWebPartPage_SetupFixedWidthWebParts",b=d.split(".");if(b.length>1){var c=EnsureScript(b[0],a,c)}}unction EnsureSelectionHandlerDeferred(n,g,j){var c=window["ctx"+String(j)];if(!FV4UI()||c==null){g.onmouseover=null;return}if(c.BaseViewID=="MapView"&&(IsStrNullOrEmpty(g.className)||g.className.indexOf("ms-mapviewtable")==-1))return;ctxInitItemState(c);var e=g.querySelector(".ms-selectall-span");if(e!=null){$addHandler(e,"keydown",;$addHandler(e,"mousedown",function(){e.style.outline="none"});$addHandler(e,"mouseup",}for(var k=g.rows,h=0;h<k.length;h++){var a=k[h];if(HasCssClass(a,"ms-viewheadertr")){var b=a.cells[0];if(b!=null){var f=b.getElementsByTagName("INPUT")[0];if(f!=null)f.className="s4-selectAllCbx";else f=b.querySelector(".ms-selectall-span");if(f!=null){c.SelectAllCbx=f;if(typeof f.onfocus!="undefined")c.TableCbxFocusHandler=f.onfocus;f.onfocus=null}}}var l=a.getAttribute("iid");if(l!=null){var i=false;if(ItemIsCurrentlySelected(c,l,a)){i=true;c.CurrentSelectedItems++}if(ItemIsCurrentlyVisible(a)){c.TotalListItems++;c.LastSelectableRowIdx=h}if(a.cells.length>0){b=a.cells[0];var d=b.querySelector(".s4-itm-cbx");if(d!=null){if(!i)d.checked=false;if(typeof d._setup=="undefined"||!Boolean(d._setup)){d._setup=true;var m=TooltipOfRow(a);if(m!=null)d.title=m;d.onblur=HideItemCbx;d.onfocus=DisplayItemCbx;d.onclick=ToggleItemRowSelection;b.onclick=ToggleItemRowSelection;if(d.nodeName=="DIV"){$addHandler(b,"keydown",a,b));$addHandler(b,"mousedown",function(a){return function(){a.style.outline="none"}}(b));$addHandler(b,"mouseup",b))}}if(a.getAttribute("automode")==null)a.onclick=SingleItemSelect}UpdateAutoMode(a);AddSpaceToEmptyTDs(a);AddBorderToLastCell(a)}}}c.TableMouseoverHandler=g.onmouseover;g.onmouseover=null;AddKeyDownEventHandler(g,j)}nction ItemIsCurrentlyVisible(a){return a==null||a.parentNode==null?false:GetCurrentEltStyle(a.parentNode,"display")=="none"||GetCurrentEltStyle(a,"display")=="none"?false:true}function ItemIsCurrentlySelected(b,c,d){if(b==null||!Boolean(c))return false;var a=GetSelectedItemsDict(b);return a==null||a[c]==null||d.className.indexOf("s4-itm-selected")<0?false:true}unction OnListViewKeyDown(a,b){var d=GetListContextFromContextNumber(String(b));if(d==null||d.inGridMode)return;var e=a.keyCode,c=a.shiftKey||a.ctrlKey;if(IsCallOutOn())return;switch(e){case Sys.UI.Key.del:HandleItemDelete(a,b);break;case Sys.UI.Key.up:SelectNextRow(b,-1,c,a);break;case Sys.UI.Key.down:SelectNextRow(b,1,c,a);break;case Sys.UI.Key.enter:if(IsEventTargetAnchor(a))return;if(a.target!=null&&!IsStrNullOrEmpty(a.target.className)&&a.target.className.indexOf("ms-lstItmLinkAnchor")>=0)OpenCallOutOrECB(b,a);else ListItem_Open(b,a)}}nction OpenDocItem(h,f,b){var a=GetListItemDataFromTrInternal(f,b),c=b,g=GetEcbTdFromRow(b),e=GetEcbDivFromEcbTd(g);if(e!=null)c=e.querySelector("a.ms-draggable");if(c==null)c=b;var d=f.ListSchema;return DispEx(c,h,"TRUE","FALSE",a["File_x0020_Type.url"],a["File_x0020_Type.progid"],d.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"],Boolean(a.CheckoutUser)?a.CheckoutUser[0].id:"",d.Userid,d.ForceCheckout,a.IsCheckedoutToLocal,a.PermMask)}tRow(b,c){var a=null;if(b!=null&&b.nodeName.toLowerCase()!="tr")return null;if(c==1)a=b.nextSibling;else if(c==-1)a=b.previousSibling;if(a!=null){var d=a.getAttribute("iid");return d!=null&&d.length>0?a:GetNextRow(a,c)}return a}function HandleItemDelete(h,e){var b=window["ctx"+String(e)],a=GetLastSelectedRowIndex(b);if(a==-1)a=0;b.LastRowIndexSelected=a;var c;try{c=typeof inplview.DeleteSelectedItems}catch(i){c="undefined"}var g="inplview.DeleteSelectedItems",d=g.split(".");if(d.length>1){var f=function(){inplview.DeleteSelectedItems(b)};EnsureScript(d[0],c,f)}return false}nction TooltipOfRow(d){for(var c=d.cells,a=0,a=0;a<c.length;a++){var e=c[a];if(HasCssClass(e,"ms-vb-title"))return GetInnerText(e).trim()}var b=d.getAttribute("iid");if(b!=null){var f=b.split(",");if(f.length>2)return""+f[1]}return null}ion GetEcbDivFromEcbTd(a){return a==null?null:a.querySelector("div.ms-vb.itx")}n ToggleAllItems2(b,f,g){var a=window["ctx"+String(f)];if(a==null){b.checked=false;return}if(a.inGridMode){SPGridToggleAllItems(a);return}var c=b;while(c.tagName!="TABLE")c=c.parentNode;var e=c.rows,d=CountTotalItems(a);if(d==0){b.checked=false;return}if(g){if(d>g_MaximumSelectedItemsAllowed){b.checked=false;alert(Strings.STS.L_BulkSelection_TooManyItems);return}SelectAllItems(a,e)}else DeselectAllItems(a,e,true)}tion RefreshCommandUI(){if(IsFullNameDefined("SP.Ribbon.PageManager")){var a=SP.Ribbon.PageManager.get_instance();a!=null&&a.get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null)}}function _CommandUIExecuteCommand(b){if(IsFullNameDefined("SP.Ribbon.PageManager")){var a=SP.Ribbon.PageManager.get_instance();a!=null&&a.get_commandDispatcher().executeCommand(b,null)}}function OnItemSelectionChanged(d,a,b){var e=d;if(FV4UI()){var c=function(){var d=[];if(typeof _ribbon!="undefined"&&_ribbon!=null){var c=e.clvp;if(c!=null)if(b)c.EnsureEcbInfo(RefreshCommandUI,d,a);else c.EnsureEcbInfo(null,null,a)}};EnsureScript("inplview",typeof InitAllClvps,c)}}nction GroupNameFromRow(e){var c=e.parentNode,a=c.id;if(a==null||a==""){var b=c.previousSibling;if(b!=null&&b.childNodes.length==0&&b.tagName==c.tagName)a=b.id}if(a==null||a=="")return null;var d=a.substr(4,a.length-6);return d==""?null:d}function GroupStringFromGroupName(a){if(a==null||a=="")return null;var c=document.getElementById("titl"+a+"_");if(c==null)return null;var b=c.getAttribute("groupString");return b==""?null:b}var previousClickedItemRow;unction SingleItemSelectByElement(b,a){return SingleItemSelectInternal(null,false,b,a,false)}unction OpenCalloutAndSelectItem(a,b,e,c){var d=GetAncestor(a,"TR");SingleItemSelectInternal(b,false,d,false,true);OpenCallout(a,b,e,c)}function SingleItemSelect(a){if(a==null)a=window.event;var c=a.shiftKey,b=a.ctrlKey;if(c){MultiItemSelect(a);return false}else{var d=SingleItemSelectInternal(a,true,null,b,false);return b?false:d}}function SingleItemSelectInternal(e,g,a,k,l){var d=true;if(g){var j=GetEventSrcElement(e);if(j!=null&&ElementContainsLink(j))return undefined;if(IsCallOutOn())return true;a=GetItemRow(e);if(clearECBMenu(j,a==null?null:CtxFromRow(a))){CancelEvent(e);return false}}if(a==null)return false;var c=a;while(c.tagName!="TABLE")c=c.parentNode;var q=c.rows,b=CtxFromRow(a);if(g){var m=a.getAttribute("iid"),p=m.split(",");d=!ItemIsCurrentlySelected(b,m,a);if(!k&&CountSelectedItems(b)>1)d=true}if(d&&!k)if(CountSelectedItems(b)>0)for(var h=c==null?null:c.querySelectorAll("tr[class*='s4-itm-selected']"),n=h==null?0:h.length,i=0;i<n;i++){var f=h[i],o=f.getAttribute("iid");ItemIsSelectable(f)&&ItemIsCurrentlySelected(b,o,f)&&ToggleItemRowSelection2(b,f,false,false,l)}ToggleItemRowSelection2(b,a,d,true,l);UpdateSelectAllCbx(b,d);previousClickedItemRow=a;g&&CancelEvent(e);return true}function Point(a,b){this.x=a;this.y=b}tion ToggleItemRowSelection(b,a){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectItemStart);if(b==null)b=window.event;if(b.keyCode==Sys.UI.Key.enter)return false;MenuHtc_hide();if(a==null)a=GetItemRow(b);var c=CtxFromRow(a),f=a.getAttribute("iid"),d=!ItemIsCurrentlySelected(c,f,a);if(d&&CountSelectedItems(c)==g_MaximumSelectedItemsAllowed){var e=GetItemRowCbx(a);e.checked=false;alert(Strings.STS.L_BulkSelection_TooManyItems);CancelEvent(b);return true}ToggleItemRowSelection2(c,a,d,true,false);UpdateSelectAllCbx(c,d);previousClickedItemRow=a;if(window.event!=null)window.event.cancelBubble=true;else b.stopPropagation();IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectItemEnd);return true}function ToggleItemRowSelection2(b,a,g,e,f){var d=a.getAttribute("iid"),c=d.split(",");if(c[1]=="")return false;SelectListItem(b,d,c,a,g,f);OnItemSelectionChanged(b,GroupNameFromRow(a),e);return true}function UpdateSelectAllCbx(a,c){if(a==null||a.SelectAllCbx==null)return;a.SelectAllCbx.checked=false;if(c){var d=CountTotalItems(a),b=CountSelectedItems(a);if(b==d&&b>0)a.SelectAllCbx.checked=true}}function SelectListItem(a,c,f,d,e,g){var b=GetItemRowCbx(d);if(b==null)return;b.checked=e;if(typeof a.dictSel=="undefined")a.dictSel=[];if(e){AddCssClassToElement(d,"s4-itm-selected");if(a.dictSel[c]==null){a.CurrentSelectedItems++;a.dictSel[c]={id:f[1],fsObjType:f[2]}}b.nodeName.toUpperCase()!="INPUT"&&b.setAttribute("aria-checked","true")}else{RemoveCssClassFromElement(d,"s4-itm-selected");if(a.dictSel[c]!=null){delete a.dictSel[c];a.CurrentSelectedItems--}b.nodeName.toUpperCase()!="INPUT"&&b.setAttribute("aria-checked","false")}!g&&FocusRow(a,c,d)}unction SetFocusOnRowDelayed(c,a){if(a==null||c==null)return;a.focus();if(browseris.webKit){var b=ElementInViewportVertical(a,document.getElementById("s4-workspace"));if(b!=g_InViewPort){var d=b==g_OutOfViewPortCloserToTop?true:false;a.scrollIntoView(d)}}c.RowFocusTimerID=null}function CountTotalItems(a){if(a.TotalListItems==null)a.TotalListItems=0;return a.TotalListItems}ction GetCurrentCtx(d){var c=document.getElementById("_wpSelected");if(c==null)return null;var a=c.getAttribute("value");if(a==null||a==""){if(Boolean(d))c=GetWebPartDiv(d)}else{a=a.substr(12);c=document.getElementById(a)}if(c==null)return null;var b;if(typeof _spWebPartComponents!="undefined"&&_spWebPartComponents!=null&&_spWebPartComponents[a]&&_spWebPartComponents[a].storageId)b=_spWebPartComponents[a].storageId;else b=c.getAttribute("WebPartID");if(b==null)return null;b=b.toUpperCase();var e=g_ViewIdToViewCounterMap["{"+b+"}"];if(e==null)return null;var f=window["ctx"+e];return f}function GetLastSelectableRowIdx(c,d){if(c==null||d==null)return-1;for(var b=c.rows,a=b.length-1;a>=0;a--){var e=b[a];if(d(e))return a}return-1}ction HasCssClass(d,f,e){var c=d.className;if(c==null)return false;for(var a=c.split(" "),b=0;b<a.length;b++)if(a[b]==f){if(e){a.splice(b,1);d.className=a.join(" ")}return true}return false}nction AddCssClassToElement(a,b){var c=a.className;if(c!=null){if(!HasCssClass(a,b))a.className=a.className+" "+b}else a.className=b}lg;function QstringStruct(b){if(b==null)b="";if(b.indexOf("?")==0)b=b.substring(1);this.nonFilterParams={};this.filterParams={};for(var f=b.split("&"),e=0;e<f.length;e++){var h=f[e],a=h.split("=");if(a.length==2)if(a[0].search("^Filter")!=-1){var d=a[0].match(new RegExp("[0-9]*$")),c;if(typeof this.filterParams[d]!="undefined")c=this.filterParams[d];else{c={};this.filterParams[d]=c}var g=a[0].match(new RegExp("^Filter[^0-9]*"));c[g]=a[1]}else this.nonFilterParams[a[0]]=a[1]}}function QstringStructToString(){var a=this.toArray();return"?"+a.join("&")}function QstringStructToArray(){var c=[],b,a,d=1,f=typeof this.filterParams.length=="number"?this.filterParams.length:0;for(b in this.filterParams){var e=this.filterParams[b];for(b in e){a=[];a.push(b);a.push(d);a.push("=");a.push(e[b]);c.push(a.join(""))}d++}for(b in this.nonFilterParams){a=[];a.push(b);a.push("=");a.push(this.nonFilterParams[b]);c.push(a.join(""))}return c}function Diff(){}function ReconcileQstringFilters(k,l){var c=[];c.push(new QstringStruct(k));c.push(new QstringStruct(l));for(var g=[],j,e,a,b=0;b<c.length;b++)for(e in c[b].nonFilterParams)if(b==0||typeof c[0].nonFilterParams[e]=="undefined"&&b==1){a=[];a.push(e);a.push("=");a.push(c[b].nonFilterParams[e]);g.push(a.join(""))}var i=1,h={};for(b=0;b<c.length;b++)for(j in c[b].filterParams){var d=c[b].filterParams[j],f=typeof d.FilterField=="string"?d.FilterField:null;if(f==null)f=typeof d.FilterFields=="string"?d.FilterFields:null;if(f!=null&&typeof h[f]=="undefined"){for(e in d){a=[];a.push(e);a.push(i);a.push("=");a.push(d[e]);g.push(a.join(""))}i++;h[d.FilterField]=d}}return g.join("&")}tion GetAncestorByTagNames(b,c){if(b==null)return null;var a=b.parentNode;while(a!=null){if(Array.contains(c,a.tagName))break;a=a.parentNode}return a}r g_listItemCache;r g_fRibbonAnimationEnabled,g_fSkipAnimation,g_fSkipNextTabExpandAnimation;tion setupPageDescriptionCallout(){var b=document.getElementById("ms-pageDescription");if(Boolean(b)){var a=GetInnerText(b),c=document.getElementById("ms-pageDescriptionDiv");if(Boolean(a)){setInnerText(b,a);a=a.replace(/(\n|\r|\t| )/g,"");if(Boolean(a)){SPAnimationUtility.BasicAnimator.FadeIn(document.getElementById("ms-pageDescriptionDiv"),null,null);EnsureScriptFunc("callout.js","Callout",}}}}function SendAjaxFormPostWithFormDigest(d,b,c){var a=new XMLHttpRequest;a.open("POST",d,true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");b!=null&&a.setRequestHeader("Content-length",b.length);a.setRequestHeader("Connection","Keep-alive");a.setRequestHeader("x-requestdigest",document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value);a.setRequestHeader("x-requested-with","XMLHttpRequest");a.onreadystatechange=function(){if(a.readyState==4)c!=null&&c(a)};a.send(b)}ar g_InViewPort,g_OutOfViewPortCloserToTop,g_OutOfViewPortCloserToBottom;function ElementInViewportVertical(b,a){if(b==null)return g_InViewPort;if(a==null)a=document.body;var f=AbsTop(b),g=AbsTop(a),h=a.scrollTop,e=g+h,i=b.offsetHeight,d=f-e,c=e+a.offsetHeight-(f+i);return d>=0&&c>=0?g_InViewPort:Math.abs(d)<Math.abs(c)?g_OutOfViewPortCloserToTop:g_OutOfViewPortCloserToBottom}ction GetCurrentUICultureOrNone(){var a="none";if(_spPageContextInfo!=null&&Boolean(_spPageContextInfo.currentUICultureName))a=_spPageContextInfo.currentUICultureName;return a}function GetSuiteLinks(d,b){var f=GetCurrentUICultureOrNone(),e=null,a=null,c=false;if(!IsNullOrUndefined(window.localStorage)&&typeof window.localStorage.SPSuiteLinksJson=="string"){if(GetCurrentUserKey()==window.localStorage.SPSuiteLinksUserKey){e=window.localStorage.SPSuiteLinksLanguage;a=window.localStorage.SPSuiteLinksJson;var g=Date.parse(window.localStorage.SPSuiteLinksDate);c=!(g>0)||+new Date-g>24*60*60*1e3}}else if(typeof SPSuiteNavBar!="undefined"&&typeof SPSuiteNavBar.cachedJson=="string"&&!IsStrNullOrEmpty(SPSuiteNavBar.cachedJson)){c=false;e=f;a=SPSuiteNavBar.cachedJson}if(typeof SP._yam!=="undefined")if(!c&&Boolean(a)&&a.indexOf(SP._yam?"ShellNewsfeed":"ShellYammer")!==-1)c=true;if(e!=f||a==null){if(d!=null)d(function(a){SP.SOD.executeFunc("suitelinks.js","CacheSuiteLinks",function(){CacheSuiteLinks(a);b!=null&&b(a)})});else b!=null&&b(null);return}if(c)d!=null&&d(function(b){SP.SOD.executeFunc("suitelinks.js","CacheSuiteLinks",function(){if(CacheSuiteLinks(b))a=b})});b!=null&&b(a)}function CtxFromElement(e){if(e==null)return null;var f=null,j=null;f=GetAncestor(e,"TABLE");var b=f.getElementsByTagName("SCRIPT");if(b==null)return null;var a;if(b.length>0)a=b[0];while(!fIsNullOrUndefined(a)&&!fIsNullOrUndefined(a.id)&&a.id.indexOf("scriptBodyWPQ")==-1)a=a.previousSibling;var c=null,d=null;if(!fIsNullOrUndefined(a)&&!fIsNullOrUndefined(a.id)){c=a.id;var h=c.indexOf("WPQ");if(h!=-1)d=c.substr(h)}if(!fIsNullOrUndefined(d)&&!fIsNullOrUndefined(g_ctxDict))for(var i in g_ctxDict){var g=g_ctxDict[i];if(g.wpq==d)return g}return null}var g_NotificationEngine,g_notiExpireTimerId,g_standardNotiCt,g_statusNotiCt,SPNotifications,g_SPNotificationEventID_Count,addNotification,removeNotification;ction SPStatusNotificationData(c,d,a,b){this.txt=c;this.dt=d;this.img=a;this.sip=b}function addSharingNotification(g,h,b,e,d,c){var a;if(e)a=STSHtmlEncode(Strings.STS.L_SharingNotificationAccessRequestsMode);else if(d)a=STSHtmlEncode(Strings.STS.L_SharingNotificationGuestLink);else if(c)a=STSHtmlEncode(Strings.STS.L_SharingNotificationExternalUsers);else if(b!==null&&b.length>0)a=STSHtmlEncode(StBuildParam(Strings.STS.L_SharingNotificationPrefixText,b.join(Strings.STS.L_SharingNotificationUserSeparator)));else a=STSHtmlEncode(Strings.STS.L_SharingNotificationEmptyText);var f=new SPStatusNotificationData("",a,h,null),i=new SP.UI.Notify.Notification(SPNotifications.ContainerID.Status,STSHtmlEncode(g),false,null,null,f);window.setTimeout(200)}var cGCMinimumWidth,cGCMinimumHeight,cGCMaxGCResizeCount,glGCObjectHeight,glGCObjectWidth,glGCResizeCounter;CGlobal;ction GCGridNewRow(a){if(TestGCObject(a))typeof a.SelectNewRow!="undefined"&&a.SelectNewRow()}function GCRefresh(a){if(TestGCObject(a))typeof a.Refresh!="undefined"&&a.Refresh()}unction PositionInfo(c,d,b,a){this.left=c;this.top=d;this.width=b;this.height=a}function PositionInfo_InitializePrototype(){PositionInfo.prototype.left=0;PositionInfo.prototype.top=0;PositionInfo.prototype.width=0;PositionInfo.prototype.height=0}nction resetItemGlobals(){currentItemAppName=null;currentItemProgId=null;currentItemIcon=null;currentItemOpenControl=null;currentItemModerationStatus=null;currentItemUIString=null;currentItemCheckedoutToLocal=null;currentItemOpenApp=null;currentItemCanModify=null;currentItemFileUrl=null;currentItemFSObjType=null;currentItemContentTypeId=null;currentItemCheckedOutUserId=null;currentItemCheckoutExpires=null;currentItemPermMaskH=null;currentItemPermMaskL=null;currentItemIsEventsExcp=null;currentItemIsEventsDeletedExcp=null}var ecbManager;unction GetSelectedElement(a,c,b){while(a!=null&&a.tagName!=c&&(b==null||a.tagName!=b))a=a.parentNode;return a}function setupMenuContext(a){currentCtx=a}unction FindSTSMenuTable(a,c){var b=a.getAttribute(c);while(a!=null&&(b==null||b=="")){a=GetSelectedElement(a.parentNode,"TABLE","DIV");if(a!=null)b=a.getAttribute(c)}return a}on CreateHiddenCtxMenu(b,a){return CreateCtxImg_Helper(b,a,false)}unction CreateCtxImg_Helper(c,j,i){var a=FindCtxImg(c);if(a!=null&&typeof a.shown=="boolean"&&a.shown==true)return a;if(a==null){a=document.createElement("DIV");a.className="s4-ctx";var b=[];b.push("<span>\u00a0</span>");b.push("<a onfocus='");if(c.tagName=="TD")b.push("OnChildItem(this.parentNode.parentNode); return false;'");else if(c.tagName=="TH")b.push("OnChildColumn(this.parentNode.parentNode); return false;'");else b.push("return false;'");b.push("href='javascript:;' onclick='PopMenuFromChevron(event); return false;' title='");b.push(Strings.STS.L_OpenMenu_Text+"'></a>");b.push("<span>\u00a0</span>");a.innerHTML=b.join("");delete b;c.appendChild(a)}if(typeof a.shown=="undefined"){for(var h=a.getElementsByTagName("SPAN"),k=h.length,f=0;f<k;f++)if(browseris.ie&&browseris.iever==6)h[f].style.lineHeight="1px";var e=a.getElementsByTagName("A")[0];e.onfocusout=j;var d=e.getElementsByTagName("img")[0],g=d==null;if(g)d=document.createElement("img");d.style.visibility="hidden";if(c.getAttribute("IsECB")=="TRUE"||c.getAttribute("IsCallout")=="TRUE"||c.getAttribute("role")=="gridcell")d.src=!IsElementRtl(c)?GetThemedImageUrl("ecbbutton.png"):GetThemedImageUrl("ecbbuttonrtl.png");else d.src=GetThemedImageUrl("ecbarw.png");d.alt=Strings.STS.L_OpenMenu_Text;d.setAttribute("ms-jsgrid-click-passthrough","true");g&&e.appendChild(d)}i&&ShowCtxImg(a,true,c);return a}nction ShowCtxImg(a,c,b){EnsureScriptFunc("mQuery.js","m$",function(){var e=null,d=null;if(a!=null)e=a.getElementsByTagName("A")[0];if(e!=null)d=e.getElementsByTagName("IMG")[0];if(d!=null){var f=b.tagName=="TH";if(c==true){AddCssClassToElement(a,"s4-ctx-show");f&&AddCssClassToElement(b,"ms-headerCellStyleHover");PositionCtxImg(a,b);d.style.visibility="visible";a.shown=true;ChevronContainer=b;if(a.onmouseover==null)a.onmouseover=function(){!HasCssClass(a,"s4-ctx-show-hover")&&AddCssClassToElement(a,"s4-ctx-show-hover")};a.onmouseout=function(c){if(!IsMenuOn()&&!IsCallOutOn()&&!IsFilterMenuOn()){if(c==null)c=window.event;var b=Boolean(c.relatedTarget)?c.relatedTarget:c.toElement;while(b!=null&&b.tagName!="BODY"){if(b==this)return;b=b.parentNode}b!=null&&RemoveCssClassFromElement(a,"s4-ctx-show-hover")}}}else{d.style.visibility="hidden";RemoveCssClassFromElement(a,"s4-ctx-show");RemoveCssClassFromElement(a,"s4-ctx-show-hover");a.shown=false;a.onmouseout=null;ChevronContainer=null;if(f){RemoveCssClassFromElement(b,"ms-headerCellStyleHover");RemoveCssClassFromElement(b,"ms-headerCellStylePressed");RemoveCssClassFromElement(b,"ms-headerCellStyleMenuOpen")}}}})}unction GetElemHeight(c,d,g,h){var e=browseris.ie9standardUp;if(!e&&d&&!g&&!h)return c.clientHeight;var b=window.getComputedStyle(c,null),a=getWidthFromPxString(b.height);if(e||d){var f=getWidthFromPxString(b.paddingTop)+getWidthFromPxString(b.paddingBottom);if(e)a=Math.max(c.clientHeight,a+f)-f;if(d)a+=f}if(g)a+=getWidthFromPxString(GetCurrentEltStyle(c,"border-top-width"))+getWidthFromPxString(GetCurrentEltStyle(c,"border-bottom-width"));var i=0;if(h)a+=getWidthFromPxString(b.marginTop)+getWidthFromPxString(b.marginBottom);return a}function PositionCtxImg(b,a){var j=0,c=0,f=HasCssClass(b.parentNode,"ms-positionRelative"),o=GetPosition(a),s=GetPosition(b.offsetParent);if(!window.browseris.chrome&&getCurrentEltStyleByNames(a,["border-collapse","borderCollapse"])=="collapse"){var k=a.offsetHeight-a.clientHeight;o.height+=k;o.top-=k}var n=m$(f?a:a).offset(),m=m$(f?b.parentNode:b.offsetParent).offset();j=n.top-m.top;if(f){var g,h;if(!IsElementRtl(a)){g=getCurrentEltStyleByNames(a,["padding-right","paddingRight"]);h=getCurrentEltStyleByNames(a,["border-right-width","borderRightWidth"])}else{g=getCurrentEltStyleByNames(a,["padding-left","paddingLeft"]);h=getCurrentEltStyleByNames(a,["border-left-width","borderLeftWidth"])}var r=getWidthFromPxString(g),q=getWidthFromPxString(h);c=-r-q}else{c=n.left-m.left;if(!IsElementRtl(a))c=c+a.offsetWidth-b.offsetWidth;j+=b.offsetParent.scrollTop;c+=b.offsetParent.scrollLeft}var l=String(c)+"px",d=b.style;d.top=String(j)+"px";if(!IsElementRtl(a)&&f)d.right=l;else d.left=l;var i=GetElemHeight(a,true,false,false);if(browseris.ie9standardUp){var e=GetAncestorByTagNames(a,["TR","TH"]);if(e!=null&&e.nextSibling!=null){var p=e.nextSibling.offsetTop-e.offsetTop-e.offsetHeight;i+=p}}d.height=String(i)+"px";d.lineHeight=String(Math.max(i-2,0))+"px";d.margin="0px"}function getCurrentEltStyleByNames(d,c){var a=null,b=0;while(b<c.length){a=GetCurrentEltStyle(d,c[b]);if(a!=null)break;b++}return a}function getWidthFromPxString(b){if(typeof b!="string")return 0;var a=b.trim(),c=Number(a.substring(0,a.length-2).trim());return isNaN(c)?0:c}nction OutItem(b){var a=null;if(b!=null&&typeof b.callOut!="undefined"&&Boolean(b.callOut)&&ecbManager.callOutPar!=null)a=ecbManager.callOutPar;if(!IsMenuOn()&&(itemTable!=null||a!=null)){var d=itemTable!=null&&itemTable.tagName=="TABLE";if(d){if(IsAjaxMenu(itemTable))itemTable.className="ms-unselectedtitle itx";else itemTable.className="ms-unselectedtitle";itemTable.onclick=null;itemTable.oncontextmenu=null;itemTable.onmouseout=null}else{if(a==null)a=GetAncestorByTagNames(itemTable,["TD","TH"]);if(a!=null&&a.getAttribute!=null&&a.getAttribute("IsCallout")=="TRUE")if(typeof CalloutManager==="object"&&calloutManager.containsOneCalloutOpen(a)){ecbManager.callOutPar=a;return true}var c=null;if(b==null)b=window.event;if(b!=null){c=typeof b.toElement!="undefined"&&b.toElement!=null?b.toElement:b.relatedTarget;if(a!=null&&c!=null&&IsContained(c,a))return true}if(a!=null){a.onclick=null;a.oncontextmenu=null;a.onmouseout=null;RemoveCtxImg(a)}}if(d&&imageCell!=null){GetFirstChildElement(imageCell).style.visibility="hidden";imageCell.className=""}resetExecutionState()}return undefined}unction IsMenuOn(){if(!IsMenuShown)return false;var a=false;a=MenuHtc_isOpen(currentEditMenu);if(!a)IsMenuShown=false;return a}function _ListHeaderMenu_OnMouseDown(a){if(a!=null&&a.tagName=="TH")if(HasCssClass(a,"ms-headerCellStyleHover")){RemoveCssClassFromElement(a,"ms-headerCellStyleHover");AddCssClassToElement(a,"ms-headerCellStylePressed")}}function _PopMenuFromChevron(d){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSFilterSortStart);if(d==null)d=window.event;var g=Boolean(d.srcElement)?d.srcElement:d.target,b=g.parentNode;while(b.tagName!="TD"&&b.tagName!="TH"&&b.tagName!="BODY")b=b.parentNode;var c,a;if(b.tagName=="TD"){c=b.getElementsByTagName("DIV");var f=null;for(a=0;a<c.length;a++)if(c[a].getAttribute("CtxNum")!=null)f=c[a];f!=null&&OnItemDeferCall(f)}else if(b.tagName=="TH"){c=b.getElementsByTagName("DIV");var e=null;for(a=0;a<c.length;a++)if(c[a].getAttribute("CtxNum")!=null)e=c[a];e!=null&&OnMouseOverFilterDeferCall(e)}IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSFilterSortEnd);return false}function PopMenu(a){if(!IsMenuEnabled())return true;if(a==null)a=window.event;var b;if(a==null)return true;if(browseris.nav6up)b=a.which;else b=a.keyCode;if(!IsMenuOn()&&(a.shiftKey&&b==13||a.altKey&&b==40)){onKeyPress=true;var d=Boolean(a.srcElement)?a.srcElement:a.target,c=FindSTSMenuTable(d,"CTXName");if(c==null)return false;OnItemDeferCall(c);if(IsAjaxMenu(c))CreateAjaxMenu(a);else CreateMenu(a);onKeyPress=false;return false}else return true}function CreateMenuEx(h,a,e,g){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSECBClickStart);if(a==null)return undefined;IsMenuShown=true;document.body.onclick=null;var d;d=BuildMenu(h);d.setAttribute("hideicons","true");currentEditMenu=d;a.onmouseout=null;var b=null,c=null;if(a.tagName=="SPAN"&&HasCssClass(a,"js-callout-ecbMenu"))b=a;else{c=FindCtxImg(a);if(c==null){b=GetAncestorByTagNames(a,["TD","TR"]);if(b==null)b=a;else c=FindCtxImg(a)}}c!=null&&typeof c.shown=="boolean"&&c.shown==false&&ShowCtxImg(c,true,b);OMenu(d,b,null,g,-1,false,false,e);if(itemTable!=null&&itemTable.tagName!="DIV"){var f=itemTable.getAttribute("CTXName");if(f==undefined||f=="")itemTable=GetSelectedElement(a,"TABLE","DIV")}if(b.tagName=="TD")b.onclick=SingleItemSelect;d._onDestroy=OutItem;if(e!=null)e.cancelBubble=true;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSECBClickEnd);return false}function BuildMenuWithInit(a){resetItemGlobals();setDocType();currentItemID=GetAttributeFromItemTable(itemTable,"ItemId","Id");currentItemCheckedOutUserId=typeof itemTable.COUId=="string"?itemTable.COUId:null;currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");return BuildMenu(a)}function BuildMenu(a){var b=CMenu(currentItemID+"_menu");if(b==null)return null;else if(Boolean(a.isVersions))AddVersionMenuItems(b,a);else if(a.listTemplate==121)AddSolutionsCatalogMenuItems(b,a);else if(a.listBaseType==1)AddDocLibMenuItems(b,a);else if(a.listTemplate==200)AddMeetingMenuItems(b,a);else AddListMenuItems(b,a);InsertFeatureMenuItems(b,a);SP.SOD.notifyEventAndExecuteWaitingJobs("CleanupContextMenu",[b,a]);return b}function GetParentLinkFromEvent(a){if(a==null)a=window.event;var c=Boolean(a.srcElement)?a.srcElement:a.target,b=GetSelectedElement(c,"A");return b!==null&&b.tagName==="A"?b:null}function isInvalidAjaxMenuElement(a){return a===null||typeof a==="undefined"||onKeyPress==false&&IsInCtxImg(a)==null&&a.className.indexOf("js-callout-action")===-1&&a.className.indexOf("ms-lstItmLinkAnchor")===-1&&(a.tagName=="A"||a.parentNode.tagName=="A")}function CreateAjaxMenu(b,g){if(!IsContextSet())return undefined;if(b==null)b=window.event;if(itemTable==null||itemTable.tagName=="TABLE"&&imageCell==null)return undefined;var e=GetParentLinkFromEvent(b);if(isInvalidAjaxMenuElement(e)){e=Boolean(b.srcElement)?b.srcElement:b.target;if(isInvalidAjaxMenuElement(e))return undefined}var a=itemTable,f=a.parentNode;if(f!=null&&parseInt(f.getAttribute("creatingAjax"))==1)return undefined;a.parentNode.setAttribute("creatingAjax","1");var d=currentCtx,c=null;if(g&&b!=null&&b.clientX!=null&&b.clientY!=null&&b.clientX!=0&&b.clientY!=0){c={};c.clientX=b.clientX;c.clientY=b.clientY}var h=function(e,b){if(b!=undefined)if(typeof d.IsClientRendering!="undefined"&&d.IsClientRendering){b.FileRef!=undefined&&a.setAttribute("Url",b.FileRef);b.FileDirRef!=undefined&&a.setAttribute("DRef",b.FileDirRef);b.File_x0020_Type!=undefined&&a.setAttribute("Ext",b.File_x0020_Type);b.HTML_x0020_File_x0020_Type!=undefined&&a.setAttribute("Type",b.HTML_x0020_File_x0020_Type);b.FSObjType!=undefined&&a.setAttribute("OType",b.FSObjType);b.CheckedOutUserId!=undefined&&a.setAttribute("COUId",b.CheckedOutUserId);b._HasCopyDestinations!=undefined&&a.setAttribute("HCD",b._HasCopyDestinations);b._CopySource!=undefined&&a.setAttribute("CSrc",b._CopySource);b._ModerationStatus!=undefined&&a.setAttribute("MS",b["_ModerationStatus."]);b.ContentType!=undefined&&a.setAttribute("CType",b.ContentType);b.ContentTypeId!=undefined&&a.setAttribute("CId",b.ContentTypeId);b._UIVersion!=undefined&&a.setAttribute("UIS",b._UIVersion);b._SourceUrl!=undefined&&a.setAttribute("SUrl",b._SourceUrl);b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"]!=undefined&&a.setAttribute("Icon",b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"]);if(d.ListSchema.IsDocLib){b["serverurl.progid"]!=undefined&&a.setAttribute("sred",b["serverurl.progid"]);b["ctxt.ListSchema.DefaultItemOpen"]!=undefined&&a.setAttribute("defaultio",d.ListSchema.DefaultItemOpen);b.IsCheckedoutToLocal!=undefined&&a.setAttribute("cout",b.IsCheckedoutToLocal)}OnItemDeferCall(a);CreateMenuEx(e,a,c,false);a.parentNode.removeAttribute("creatingAjax")}else{a.parentNode.replaceChild(b,a);b.onclick=typeof a.onclick!="undefined"?a.onclick:undefined;b.onmousehover=OnItem;OnItemDeferCall(b);CreateMenuEx(e,b,c);b.parentNode.removeAttribute("creatingAjax")}};FetchEcbInfo(d,itemTable.id,itemTable.tagName,h);b.cancelBubble=true;return false}var ecbItems;function FetchEcbInfo(a,e,i,f){var b=[],g=false,d=escapeUrlForCallback(a.HttpRoot);b.push(d);d[d.length-1]!="/"&&b.push("/");b.push("_layouts/15/inplview.aspx?Cmd=Ctx&List=");b.push(a.listName);a.HasRelatedCascadeLists==1&&a.CascadeDeleteWarningMessage==null&&b.push("&CascDelWarnMessage=1");if(a.view!=null){b.push("&View=");b.push(a.view)}b.push("&ViewCount=");b.push(a.ctxId);if(typeof a.isXslView!="undefined"&&a.isXslView){b.push("&IsXslView=TRUE");b.push("&Field=");if(itemTable!=null)b.push(GetAttributeFromItemTable(itemTable,"Field","Field"));else b.push("LinkFilename");if(typeof a.IsClientRendering!="undefined"&&a.IsClientRendering){b.push("&IsCSR=TRUE");if(Boolean(a.listName)){var k=ecbItems+"_"+a.listName.toLowerCase();if(document.getElementById(k)==null){b.push("&CustomAction=TRUE");g=true}else if(Boolean(a.ExternalDataList)){CallBackWithRowData(a,e,a.ListData,f);return}}}}b.push("&ID=");b.push(e);var h=GetUrlKeyValue("RootFolder",true,ajaxNavigate.get_href());if(h.length>0){b.push("&RootFolder=");b.push(h)}b.push("&ListViewPageUrl=");var l=new URI(ajaxNavigate.get_href(),{disableEncodingDecodingForLegacyCode:true});d=l.getStringWithoutQueryAndFragment();b.push(d);if(typeof a.overrideScope!="undefined"){b.push("&OverrideScope=");b.push(escapeProperly(a.overrideScope))}if(typeof a.searchTerm!="undefined"&&a.searchTerm!=null){b.push("&InplaceSearchQuery=");b.push(escapeProperlyCore(a.searchTerm,true))}else if(typeof a.completedSearchTerm!="undefined"&&a.completedSearchTerm!=null){b.push("&InplaceSearchQuery=");b.push(escapeProperlyCore(a.completedSearchTerm,true))}typeof a.fullListSearch!="undefined"&&a.fullListSearch!=null&&a.fullListSearch==true&&b.push("&InplaceFullListSearch=true");var j=b.join(""),c;if(window.XMLHttpRequest!=null){c=new XMLHttpRequest;c.open("POST",j,true);c.onreadystatechange=c.send(null)}}unction CreateMenu(a){if(!IsContextSet())return undefined;var c=currentCtx;if(a==null)a=window.event;var b=a.srcElement!=null?a.srcElement:a.target;return itemTable==null||itemTable.tagName=="TABLE"&&imageCell==null||onKeyPress==false&&IsInCtxImg(b)==null&&(b.tagName=="A"||b.parentNode.tagName=="A")?undefined:CreateMenuEx(c,itemTable,a)}function AddSendSubMenu(z,b){var k=[];k.Copy=Strings.STS.L_SubmitFileCopyWarning_Text;k.Move=Strings.STS.L_SubmitFileMoveWarning_Text;k.Link=Strings.STS.L_SubmitFileLinkWarning_Text;var d=Strings.STS.L_Send_Text,s=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),g,n,h;if(currentItemFileUrl!=null){n=unescapeProperly(currentItemFileUrl);g=escapeProperly(n);h=SzExtension(n);if(h!=null&&h!="")h=h.toLowerCase()}var l=itemTable.getAttribute("SRed"),u=itemTable.getAttribute("DefaultIO");if(u=="0"&&!HasRights(0,32))u="1";var q=currentItemProgId!="SharePoint.WebPartPage.Document"&&(l==null||l==""||HasRights(0,32))&&h!="aspx",r=HasRights(16,0),p=currentItemFSObjType!="1"&&b.listBaseType==1&&(l==null||l==""||HasRights(0,32));if(!q&&!r&&!p)return;var e=CASubM(z,d,"","",String(400));CUIInfo(e,"SendTo",["SendTo","PopulateSendToMenu"]);e.IsSubMenu=true;e.id="ID_Send";e.style.display="none";var c;if(q){if(typeof b.SendToLocationName!="undefined"&&b.SendToLocationName!=null&&b.SendToLocationName!=""&&typeof b.SendToLocationUrl!="undefined"&&b.SendToLocationUrl!=null&&b.SendToLocationUrl!=""){var a="STSNavigate('"+b.HttpRoot+"/_layouts/15/copy.aspx?SourceUrl="+g+"&FldUrl="+escapeProperly(b.SendToLocationUrl);a=AddSourceToUrl(a)+"')";c=CAMOpt(e,b.SendToLocationName,a,"");CUIInfo(c,"SendToRecommendedLocation",["SendToRecommendedLocation"])}if(typeof itemTable.getAttribute("HCD")!="undefined"&&itemTable.getAttribute("HCD")=="1"){d=Strings.STS.L_ExistingCopies_Text;a="STSNavigate('"+b.HttpRoot+"/_layouts/15/updatecopies.aspx?SourceUrl="+g;a=AddSourceToUrl(a)+"')";var f=b.imagesPath+"existingLocations.gif";c=CAMOpt(e,d,a,f);c.id="ID_ExistingCopies";CUIInfo(c,"SendToExistingCopies",["SendToExistingCopies"])}d=Strings.STS.L_OtherLocation_Text;a="NavigateToSendToOtherLocationV4(event, '"+b.HttpRoot+"/_layouts/15/copy.aspx?SourceUrl="+g;a=AddSourceToUrl(a)+"')";f=b.imagesPath+"sendOtherLoc.gif";c=CAMOpt(e,d,a,f);c.id="ID_OtherLocation";CUIInfo(c,"SendToOtherLocation",["SendToOtherLocation"]);if(typeof b.OfficialFileNames=="string"&&b.OfficialFileNames!=""){var o=b.OfficialFileNames.split("__HOSTSEPARATOR__");if(o!=null)for(var m=0;m<o.length;m++){var A=o[m],i=A.split(",");d=i[0];var y=0,x="Copy";if(i.length==3){d=i[0].replace(/%2c/g,",").replace(/%25/g,"%");y=i[1];x=i[2]}a='if(confirm("'+StBuildParam(k[x],STSScriptEncode(d))+"\")!=0) SubmitFormPost('"+b.HttpRoot+"/_layouts/15/SendToOfficialFile.aspx?ID="+escapeProperly(d)+"&Index="+String(y)+"&SourceUrl="+g;a=AddSourceToUrl(a)+"')";f="";c=CAMOpt(e,d,a,f);var t="SendToOfficialFile"+String(m);CUIInfo(c,t,[t])}}CAMSep(e)}if(r){d=Strings.STS.L_SendToEmail_Text;s=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");var j=ctx.HttpRoot.substr(0);if(j[j.length-1]!="/")j+="/";var v=-1,w="";v=j.substring(8).indexOf("/")+8;w=j.substr(0,v)+escapeProperlyCore(unescapeProperly(s),true);a="javascript:SendEmail('"+w+"')";f=ctx.imagesPath+"gmailnew.gif";c=CAMOpt(e,d,a,f);CUIInfo(c,"EmailLink",["EmailLink"]);c.id="ID_SendToEmail"}if(p){ctx.listTemplate!=119&&AddWorkspaceMenuItem(e,ctx);if(ctx.listTemplate!=119){a="STSNavigate('"+ctx.HttpRoot+"/_layouts/15/download.aspx?SourceUrl="+g+"&FldUrl="+escapeProperly(ctx.SendToLocationUrl);a=AddSourceToUrl(a)+"')";c=CAMOpt(z,Strings.STS.L_DownloadACopy_Text,a,"");CUIInfo(c,"DownloadCopy",["DownloadCopy"]);c.id="ID_DownloadACopy"}}}function AddDocTransformSubMenu(m,k){if(typeof rgDocTransformers=="undefined"||rgDocTransformers==null)return;var n=rgDocTransformers,b=null,c=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),e;if(currentItemFileUrl!=null)e=escapeProperly(unescapeProperly(currentItemFileUrl));var h=c.lastIndexOf(".");if(h>0)for(var j=c.substring(h+1,c.length).toLowerCase(),f=false,a=0;a<rgDocTransformers.length;a++)if(rgDocTransformers[a].ConvertFrom==j){var g=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),l=new RegExp("/|"+g+"|/");if(g!=null&&!l.test(rgDocTransformers[a].ExcludedContentTypes)){if(!f){b=CASubM(m,Strings.STS.L_DocTran_Text,ctx.imagesPath+"ConvertDocument.gif",Strings.STS.L_DocTran_Text,String(500));b.IsSubMenu=true;b.Id="ID_ConvertDocument";f=true}var d="STSNavigate('"+k.HttpRoot+"/_layouts/15/"+escapeProperlyCore(rgDocTransformers[a].TransformUIPage,true)+"?FileName="+e+"&TID="+rgDocTransformers[a].Id;d=AddSourceToUrl(d)+"')";var i;i=CAMOpt(b,rgDocTransformers[a].Name,d,"");i.Id="ID_Transform"+rgDocTransformers[a].Id}}}function AddMeetingMenuItems(g,b){if(itemTable.getAttribute("menuType")=="Orphaned"){var a,f=GetAttributeFromItemTable(itemTable,"ItemId","Id"),c=Strings.STS.L_Move_Text,e="GoToMtgMove('"+b.listUrlDir+"',"+f+",'"+itemTable.getAttribute("DateTime")+"','"+itemTable.getAttribute("DateTimeISO")+"')",d="";a=CAMOpt(g,c,e,d);a.id="ID_Move";c=Strings.STS.L_Keep_Text;e="MtgKeep('"+b.HttpPath+"','"+b.listName+"',"+f+")";d="";a=CAMOpt(g,c,e,d);a.id="ID_Keep";c=Strings.STS.L_Delete_Text;e="MtgDelete('"+b.HttpPath+"','"+b.listName+"',"+f+")";d=b.imagesPath+"delitem.gif";a=CAMOpt(g,c,e,d);a.id="ID_Delete"}}function AddListMenuItems(d,a){if(typeof Custom_AddListMenuItems!="undefined")if(Custom_AddListMenuItems(d,a))return;if(currentItemFileUrl==null)currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");var g;if(currentItemFileUrl!=null)g=escapeProperly(unescapeProperly(currentItemFileUrl));var j=currentItemID;if(currentItemIsEventsExcp==null){currentItemIsEventsExcp=false;currentItemIsEventsDeletedExcp=false;currentItemEvtType=parseInt(itemTable.getAttribute("EventType"));if(currentItemEvtType!=null&&(currentItemEvtType==2||currentItemEvtType==3||currentItemEvtType==4)){currentItemIsEventsExcp=true;if(currentItemEvtType==3)currentItemIsEventsDeletedExcp=true;if(currentItemID.indexOf(".")!=-1)j=currentItemID.split(".")[0]}}var c,b,f;if(a.listBaseType==3&&a.listTemplate==108){var e=Strings.STS.L_Reply_Text;if(itemTable.getAttribute("Ordering").length>=504)b="alert('"+Strings.STS.L_ReplyLimitMsg_Text+"')";else{b="STSNavigate('"+a.newFormUrl+"&Threading="+escapeProperly(itemTable.getAttribute("Ordering"))+"&Guid="+escapeProperly(itemTable.getAttribute("ThreadID"))+"&Subject="+escapeProperly(itemTable.getAttribute("Subject"));b=AddSourceToUrl(b)+"')"}f=a.imagesPath+"reply.gif";c=CAMOpt(d,e,b,f,null,String(100));c.id="ID_Reply"}AddSharedNamespaceMenuItems(d,a);var i=itemTable.getAttribute("CId");if(i!=null&&i.indexOf("0x0106")==0&&HasRights(16,0)){e=Strings.STS.L_ExportContact_Text;b="STSNavigate('"+a.HttpPath+"&Cmd=Display&CacheControl=1&List="+a.listName+"&ID="+currentItemID+"&Using="+escapeProperly(a.listUrlDir)+"/vcard.vcf')";f=a.imagesPath+"exptitem.gif";c=CAMOpt(d,e,b,f,null,String(350));CUIInfo(c,"ExportContact",["ExportContact"]);c.id="ID_ExportContact"}CAMSep(d);a.verEnabled==1&&AddVersionsMenuItem(d,a,g);if(HasRights(0,4)&&a.isModerated==true&&HasRights(0,16)&&HasRights(0,135168)&&a.listBaseType!=4&&currentItemID.indexOf(".0.")<0){e=Strings.STS.L_ModerateItem_Text;b="NavigateToApproveRejectAspx(event, '"+a.HttpRoot+"/_layouts/15/approve.aspx?List="+a.listName+"&ID="+j;b=AddSourceToUrl(b)+"')";f=a.imagesPath+"apprj.gif";c=CAMOpt(d,e,b,f,null,String(850));CUIInfo(c,"Moderate",["Moderate"]);c.id="ID_ModerateItem"}CAMSep(d);AddWorkflowsMenuItem(d,a);var h=typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&_spPageContextInfo.alertsEnabled;if(currentItemID.indexOf(".0.")<0&&HasRights(128,0)&&!a.ExternalDataList&&h){e=Strings.STS.L_Subscribe_Text;b="NavigateToSubNewAspxV4(event, '"+a.HttpRoot+"', 'List="+a.listName+"&ID="+currentItemID+"')";f="";c=CAMOpt(d,e,b,f,null,String(1100));c.id="ID_Subscribe";CUIInfo(c,"Subscribe",["Subscribe"])}(h||!a.ExternalDataList&&HasRights(0,4))&&CAMSep(d);AddManagePermsMenuItem(d,a,a.listName,currentItemID);if(currentItemID.indexOf(".0.")<0&&HasRights(0,8)&&!currentItemIsEventsExcp){if(a.listBaseType==4)e=Strings.STS.L_DeleteResponse_Text;else e=Strings.STS.L_DeleteItem_Text;b="DeleteListItem()";f=a.imagesPath+"delitem.gif";c=CAMOpt(d,e,b,f,null,String(1180));CUIInfo(c,"Delete",["Delete"]);c.id="ID_DeleteItem";CUIInfo(c,"Delete",["Delete"])}var k=currentItemProgId!=null&&currentItemProgId!="";if(currentItemFSObjType=="1"&&!k&&HasRights(0,4)&&a.ContentTypesEnabled&&a.listTemplate!=108){e=Strings.STS.L_CustomizeNewButton_Text;b="STSNavigate('"+a.HttpRoot+"/_layouts/15/ChangeContentTypeOrder.aspx?List="+a.listName+"&RootFolder="+g;b=AddSourceToUrl(b)+"')";f="";c=CAMOpt(d,e,b,f,null,String(1170));CUIInfo(c,"ChangeNewButton",["ChangeNewButton"]);c.id="ID_CustomizeNewButton"}}function ReplaceUrlTokens(c,d){var e;if(c==null||c==""){c="";return c}if(currentItemID!=null)c=c.replace(/{ItemId}/g,currentItemID);var a=null,b=null,f=c.indexOf("?");if(-1!=f&&f+2<c.length){a=c.substr(f+1);b=c.substr(0,f+1)}else b=c;if(currentItemFileUrl!=null){if(null!=a){e=escapeProperly(unescapeProperly(currentItemFileUrl));a=a.replace(/{ItemUrl}/g,e)}b=b.replace(/{ItemUrl}/g,currentItemFileUrl)}if(d.HttpRoot!=null){if(null!=a){e=escapeProperly(unescapeProperly(d.HttpRoot));a=a.replace(/{SiteUrl}/g,e)}b=b.replace(/{SiteUrl}/g,d.HttpRoot)}if(d.listName!=null){if(null!=a){e=escapeProperly(d.listName);a=a.replace(/{ListId}/g,e)}b=b.replace(/{ListId}/g,d.listName)}if(d.listUrlDir!=null){if(null!=a){e=escapeProperly(unescapeProperly(d.listUrlDir));a=a.replace(/{ListUrlDir}/g,e)}b=b.replace(/{ListUrlDir}/g,d.listUrlDir)}var g=GetSource();b=b.replace(/{Source}/g,g);if(a!=null)if(b.length+a.length+g.length>1950)a=a.replace(/{Source}/g,"");else a=a.replace(/{Source}/g,g);return null==a?b:b+a}var SYSTEM_ACCOUNT_ID;unction InsertFeatureMenuItems(x,f){CAMSep(x);var j=GetAttributeFromItemTable(itemTable,"Ext","FileType"),k=GetAttributeFromItemTable(itemTable,"Type","HTMLType"),h=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),n=null,l=null,q=ecbItems;if(f!=null){n=String(f.listTemplate);if(null!=f.listName&&0<f.listName.length){l=f.listName.toLowerCase();q=q+"_"+l}}if(j!=null)j=j.toLowerCase();if(k!=null)k=k.toLowerCase();if(h!=null)h=h.toLowerCase();var v,o=document.getElementById(q),m=new Array(0),a=null,d=0,t=[];if(o!=null)for(var p=0;p<o.childNodes.length;p++){var b=o.childNodes[p],B=GetInnerText(b.childNodes[5]),C=GetInnerText(b.childNodes[6]),z=parseInt(GetInnerText(b.childNodes[3])),A=parseInt(GetInnerText(b.childNodes[4]));if(!UseCustomAction(B,C,z,A,j,k,h,n,l))continue;a={};a.Title=GetInnerText(b.childNodes[0]);a.ImageUrl=GetInnerText(b.childNodes[1]);a.Action=GetInnerText(b.childNodes[2]);a.Sequence=parseInt(GetInnerText(b.childNodes[7]));var i=GetInnerText(b.childNodes[8]);a.ProductId=i.length>0?i:null;a.FromTenantApp=false;if(i!=null&&i.length>0)t[i]=true;m.push(a)}var u=GetTenantAppData();if(u!=null){var w=u.apps;for(d=0;d<w.length;d++)for(var r=w[d],s=0;s<r.customActions.length;s++)try{a=r.customActions[s];if(!UseCustomAction(a.registrationType,a.registrationId,parseInt(a.rightsHigh),parseInt(a.rightsLow),j,k,h,n,l))continue;if(typeof t[a.productId]!="undefined")continue;var c={};c.Title=a.title;c.ImageUrl=a.imageUrl;c.Action=a.action;c.Sequence=parseInt(a.sequence);c.ProductId=a.productId;c.FromTenantApp=true;c.AppTitle=r.title;m.push(c)}catch(D){throw D;}}for(d=0;d<m.length;d++){a=m[d];var e=ReplaceUrlTokens(a.Action,f),g=null;if(a.FromTenantApp){if(e.startsWith("javascript:LaunchApp"))g=e;else if(e.substr(0,11)!="javascript:")g="STSNavigate('"+STSScriptEncode(e)+"')"}else if(e.substr(0,11)=="javascript:")g=e;else g="STSNavigate('"+STSScriptEncode(e)+"')";if(g!=null){var y=a.ImageUrl==null?null:ReplaceUrlTokens(a.ImageUrl,f);v=CIMOpt(x,a.Title,g,y,null,String(a.Sequence));v.id="ID_"+a.Title}}}function GetRootFolder2(d){var b=GetUrlKeyValue("RootFolder",false),c=d.clvp;if(c!=null&&c.rootFolder!=null)b=c.rootFolder;if(b==""||bValidSearchTerm){var a;if(itemTable!=null)a=GetAttributeFromItemTable(itemTable,"DRef","FileDirRef");if(a!=null&&a!="")if(a.substring(0,1)=="/")b=a;else b="/"+a;else b=d.listUrlDir}return b} AddSharedNamespaceMenuItems(i,a){var j=GetRootFolder(a);setupMenuContext(a);if(currentItemFileUrl==null)currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");if(currentItemFSObjType==null)currentItemFSObjType=String(parseInt(GetAttributeFromItemTable(itemTable,"OType","FSObjType")));if(currentItemContentTypeId==null)currentItemContentTypeId=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedoutToLocal==null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedoutToLocal!="1")currentItemCheckedoutToLocal="0";var l=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID);bIsCheckout=0;if(a.isForceCheckout==true&&currentItemCheckedOutUserId==""&&currentItemFSObjType!="1")bIsCheckout=1;var k;if(currentItemFileUrl!=null)k=escapeProperly(unescapeProperly(currentItemFileUrl));var c,d,b,g;if(a.listBaseType==1)d=Strings.STS.L_ViewProperties_Text;else if(a.listBaseType==4)d=Strings.STS.L_ViewResponse_Text;else d=Strings.STS.L_ViewItem_Text;var f="";if(currentItemContentTypeId!=null&&currentItemContentTypeId!="")f="&ContentTypeID="+currentItemContentTypeId;var e="&";if(a.displayFormUrl.indexOf("?")==-1)e="?";var h=a.displayFormUrl+e+"ID="+currentItemID+f;h=AddSourceToUrl(h)+j;if(301==a.listTemplate)b="EditItem('"+h+"')";else b="EditItem2(event, '"+STSScriptEncode(h)+"')";c=CAMOpt(i,d,b,g,null,String(200));CUIInfo(c,"ViewProperties",["ViewProperties"]);if(a.listBaseType==1)c.id="ID_ViewProperties";else c.id="ID_ViewItem";if(HasRights(0,4)&&!l&&!currentItemIsEventsDeletedExcp){if(a.listBaseType==1)d=Strings.STS.L_EditProperties_Text;else if(a.listBaseType==4)d=Strings.STS.L_EditResponse_Text;else d=Strings.STS.L_EditItem_Text;e="&";if(a.editFormUrl.indexOf("?")==-1)e="?";if(a.listBaseType==1){b="EditItemWithCheckoutAlert(event, '"+a.editFormUrl+e+"ID="+currentItemID+f;b=AddSourceToUrl(b)+j+"',"+String(bIsCheckout)+",'"+currentItemCheckedoutToLocal+"','"+STSScriptEncode(currentItemFileUrl)+"','"+a.HttpRoot+"')"}else if(FV4UI())b="EditItem2(event, '"+STSScriptEncode(a.editFormUrl)+e+"ID="+currentItemID+f+"')";else{b="EditItem('"+a.editFormUrl+e+"ID="+currentItemID+f;b=AddSourceToUrl(b)+"')"}g=a.imagesPath+"edititem.gif";c=CAMOpt(i,d,b,g,null,String(220));if(a.listBaseType==1){c.id="ID_EditProperties";CUIInfo(c,"EditProperties",["EditProperties"])}else{c.id="ID_EditItem";CUIInfo(c,"EditProperties",["EditProperties"])}if(a.listTemplate==106&&currentItemID.indexOf(".0.")>0){var n=currentItemID.indexOf(".0."),m=currentItemID.substr(0,n);d=Strings.STS.L_EditSeriesItem_Text;b="EditItem2(event, '"+STSScriptEncode(a.editFormUrl)+e+"ID="+m+f;b=AddSourceToUrl(b)+"')";g=a.imagesPath+"recurrence.gif";c=CAMOpt(i,d,b,g,null,String(230));CUIInfo(c,"EditSeriesItem",["EditSeriesItem"]);c.id="ID_EditSeriesItem"}}}function AddSolutionsCatalogMenuItems(a,f){if(HasRights(0,4))if(currentItemFSObjType!="1"){var d=true,b=GetAttributeFromItemTable(itemTable,"Url",null);if(b.length>4){var h=b.substr(b.length-4).toLowerCase();if(h==".wsp"){var c=GetAttributeFromItemTable(itemTable,"SolutionHash",null),g=GetAttributeFromItemTable(itemTable,"Hash",null),i=GetAttributeFromItemTable(itemTable,"SolutionItemID",null),e=GetAttributeFromItemTable(itemTable,"Status",null),j=GetAttributeFromItemTable(itemTable,"id",null);if(c!="")if(e=="")AddSolutionMenuActivate(a);else if(c==g){d=false;AddSolutionMenuDeactivate(a)}else AddSolutionMenuUpgrade(a)}}d&&AddSolutionMenuDelete(a,f)}}function AddSolutionMenuHelper(i,d,f,e,g,b,c){var a,h="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "'+f+'")';a=CAMOpt(i,d,h,e,null,String(g));CUIInfo(a,b,[b]);a.id=c}function AddSolutionMenuActivate(a){typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,Strings.STS.L_ActivateSolution_Text,"ACT","",1210,"ActivateSolution","ID_ActivateSolution")}function AddSolutionMenuDeactivate(a){typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,Strings.STS.L_DeactivateSolution_Text,"DEA","",1220,"DeactivateSolution","ID_DeactivateSolution")}function AddSolutionMenuUpgrade(a){typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,Strings.STS.L_UpgradeSolution_Text,"UPG","",1230,"UpgradeSolution","ID_UpgradeSolution")}function AddSolutionMenuDelete(h,b){var a,c;currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");if(currentItemFileUrl!=null)c=escapeProperly(unescapeProperly(currentItemFileUrl));var e=Strings.STS.L_DeleteDocItem_Text,d="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")d="true";var g="DeleteDocLibItem('"+b.HttpPath+"&Cmd=Delete&List="+b.listName+"&ID="+currentItemID+"&owsfileref="+c+"&NextUsing="+GetSource()+"',"+d+")",f=b.imagesPath+"delitem.gif";a=CAMOpt(h,e,g,f,null,"310");a.id="ID_DeleteDocItem";CUIInfo(a,"Delete",["Delete"])}function RunSolutionOperation(a,g){if(a==null&&!IsContextSet())return;var b=currentCtx!=null?currentCtx:typeof a.currentCtx=="object"?a.currentCtx:null,e=currentItemID!=null?currentItemID:typeof a.currentItemID=="string"?a.currentItemID:"";if(b==null)return;var f=b.listUrlDir,i=GetSource(),c=f+"/Forms/Activate.aspx?Op="+g+"&ID="+e+"&Source="+i;if(b.listBaseType==1)c=c+GetRootFolder(b);var h=function(){},j=d;try{d=typeof SP.UI.ModalDialog.showModalDialog}catch(k){d="undefined"}EnsureScript("SP.UI.Dialog.js",d,j)}function AddDocLibMenuItems(c,a){if(typeof window.Custom_AddDocLibMenuItems!="undefined")if(window.Custom_AddDocLibMenuItems(c,a))return;var l=GetRootFolder(a),b,e,d,f;AddSharedNamespaceMenuItems(c,a);var g;if(currentItemFileUrl!=null)g=escapeProperly(unescapeProperly(currentItemFileUrl));var h=itemTable.getAttribute("SRed"),i=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID);if(HasRights(0,4)&&HasRights(16,0)&&!i&&(h==null||h==""||HasRights(0,32)))if(a.isWebEditorPreview==0&&a.listBaseType==1)if(a.listTemplate!=119){setDocType();if(currentItemAppName!=""&&currentItemOpenControl!="")if(!(a.IsAppWeb&&currentItemProgId==SPDesignerProgID)){e="";if(currentItemAppName!=" ")e=StBuildParam(Strings.STS.L_EditIn_Text,currentItemAppName);else{var k=StsOpenEnsureEx2(currentItemOpenControl+".3");if(k!=null)e=Strings.STS.L_EditInApplication_Text}if(e!=""){d="editDocumentWithProgID2('"+currentItemFileUrl+"', '"+currentItemProgId+"', '"+currentItemOpenControl+"', '"+String(bIsCheckout)+"', '"+a.HttpRoot+"', '"+currentItemCheckedoutToLocal+"', '"+currentItemOpenApp+"')";f=a.imagesPath+currentItemIcon;b=CAMOpt(c,e,d,f,null,String(260));b.id="ID_EditIn_"+currentItemAppName;b.style.cssText="display:none";CUIInfo(b,"EditDocument",["EditDocument"])}}}CAMSep(c);if(HasRights(0,4))if(currentItemFSObjType!="1")a.listBaseType==1&&AddCheckinCheckoutMenuItem(c,a,g);(a.verEnabled==1||a.isModerated)&&currentItemFSObjType!="1"&&AddVersionsMenuItem(c,a,g);if(HasRights(0,4))if(a.isModerated==true&&HasRights(0,16)&&((currentItemModerationStatus==String(2)||!a.EnableMinorVersions)&&currentItemCheckedOutUserId==""||currentItemFSObjType=="1")){e=Strings.STS.L_ModerateItem_Text;d="NavigateToApproveRejectAspx(event, '"+a.HttpRoot+"/_layouts/15/approve.aspx?List="+a.listName+"&ID="+currentItemID;d=AddSourceToUrl(d)+GetRootFolder(a)+"')";f=a.imagesPath+"apprj.gif";b=CAMOpt(c,e,d,f,null,String(850));CUIInfo(b,"Moderate",["Moderate"]);b.id="ID_ModerateItem"}CAMSep(c);AddWorkflowsMenuItem(c,a);if(currentItemFSObjType!="1"){if(a.PortalUrl!=null){e=Strings.STS.L_AddToMyLinks_Text;d="Portal_Tasks('PinToMyPage')";f="";b=CAMOpt(c,e,d,f,null,String(1e3));CUIInfo(b,"AddToMyLinks",["AddToMyLinks"]);b.id="ID_AddToMyLinks";b.style.display="none"}}else a.listBaseType==1&&HasRights(16,0)&&AddWorkOfflineMenuItem(c,a,currentItemFileUrl);if(HasRights(128,0)&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&typeof _spPageContextInfo.alertsEnabled=="boolean"&&_spPageContextInfo.alertsEnabled){e=Strings.STS.L_Subscribe_Text;d="NavigateToSubNewAspxV4(event, '"+a.HttpRoot+"', 'List="+a.listName+"&ID="+currentItemID+"')";f="";b=CAMOpt(c,e,d,f,null,String(1100));CUIInfo(b,"Subscribe",["Subscribe"]);b.id="ID_Subscribe";b.style.display="none"}if(currentItemFSObjType!="1"){AddSendSubMenu(c,a);AddGotoSourceItemMenuItem(c,a,itemTable,currentItemFSObjType);AddDocTransformSubMenu(c,a)}CAMSep(c);AddManagePermsMenuItem(c,a,a.listName,currentItemID);if(HasRights(0,8)&&!i){e=Strings.STS.L_DeleteDocItem_Text;var j="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")j="true";d="DeleteDocLibItem('"+a.HttpPath+"&Cmd=Delete&List="+a.listName+"&ID="+currentItemID+"&owsfileref="+g+"&NextUsing="+GetSource()+"',"+j+")";f=a.imagesPath+"delitem.gif";b=CAMOpt(c,e,d,f,null,String(1190));b.id="ID_DeleteDocItem";CUIInfo(b,"Delete",["Delete"])}if(HasRights(0,4)&&currentItemFSObjType=="1"&&a.ContentTypesEnabled&&a.listTemplate!=108){e=Strings.STS.L_CustomizeNewButton_Text;d="STSNavigate('"+a.HttpRoot+"/_layouts/15/ChangeContentTypeOrder.aspx?List="+a.listName+"&RootFolder="+g;d=AddSourceToUrl(d)+"')";f="";b=CAMOpt(c,e,d,f,null,String(1170));CUIInfo(b,"ChangeNewButton",["ChangeNewButton"]);b.id="ID_CustomizeNewButton"}}function AddManagePermsMenuItem(h,a,f,g){if(!HasRights(0,131072)||currentItemIsEventsExcp||a.ExternalDataList||currentItemEvtType==5)return;var c=Strings.STS.L_SharedWithDialogTitle,e="EnsureScriptFunc('sharing.js', 'DisplaySharedWithDialog', function () { DisplaySharedWithDialog('"+a.HttpRoot+"', '"+f+"','"+g+"'); })",d=a.imagesPath+"permissions16.png",b=CAMOpt(h,c,e,d,null,String(1160));b.id="ID_MngPerms";CUIInfo(b,"ManagePermissions",["ManagePermissions"])}function AddGotoSourceItemMenuItem(i,h,e,g){if(g!="1"){var a=e.getAttribute("CSrc");if(typeof a!="undefined"&&a!=null&&a!=""){var c=Strings.STS.L_GoToSourceItem_Text,f="NavigateToSourceItem(event, '"+STSScriptEncode(a)+"')",d=h.imagesPath+"goToOriginal.gif",b=CAMOpt(i,c,f,d,null,String(440));b.id="ID_GoToSourceItem";CUIInfo(b,"GotoSourceItem",["GotoSourceItem"])}}}function CheckoutSingleItemFromECB(c,d){var a;try{a=typeof inplview.CheckOutSingleItem}catch(g){a="undefined"}var f="inplview.CheckOutSingleItem",b=f.split(".");if(b.length>1){var e=EnsureScript(b[0],a,e)}}function AddCheckinCheckoutMenuItem(g,a,f){var b,d,e,c;if(!HasRights(0,4))return;if(currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID))return;if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedOutUserId!=""){if(currentItemCheckedOutUserId==a.CurrentUserId||a.CurrentUserId==null||HasRights(0,256)){d=Strings.STS.L_Checkin_Text;if(!FV4UI())c="NavigateToCheckinAspx('"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+f+"')";else c="CheckInSingleItemFromECB(event, currentCtx, itemTable)";e=a.imagesPath+"checkin.gif";b=CAMOpt(g,d,c,e,null,String(300));b.id="ID_Checkin";CUIInfo(b,"CheckIn",["CheckIn"]);d=Strings.STS.L_DiscardCheckou_Text;c="UnDoCheckOutwithNotification('"+a.HttpRoot+"', '"+f+"')";e=a.imagesPath+"unchkout.gif";b=CAMOpt(g,d,c,e,null,String(310));b.id="ID_DiscardCheckou";CUIInfo(b,"DiscardCheckOut",["DiscardCheckOut"])}}else if(typeof g_disableCheckoutInEditMode=="undefined"||!g_disableCheckoutInEditMode){d=Strings.STS.L_Checkout_Text;currentItemOpenControl==""&&setDocType();var l="",j=itemTable.getAttribute("SRed");if(j==null||j==""||HasRights(0,32)){if(!FV4UI())c="CheckoutDocument('"+a.HttpRoot+"', '"+f+"', '"+l+"')";else c="CheckoutSingleItemFromECB(currentCtx, itemTable)";e=a.imagesPath+"checkout.gif";b=CAMOpt(g,d,c,e,null,String(300));b.id="ID_Checkout";CUIInfo(b,"CheckOut",["CheckOut"])}if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(a.EnableMinorVersions){if(currentItemUIString==null)currentItemUIString=GetAttributeFromItemTable(itemTable,"UIS","UIString");var k=parseInt(currentItemUIString)%512;if((currentItemModerationStatus==String(1)||currentItemModerationStatus==String(3))&&a.isModerated||!a.isModerated&&k!=0){d=Strings.STS.L_PublishItem_Text;c="PublishMajorVersion(event, '"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+f+"&Publish=true')";e=a.imagesPath+"pubmajor.gif";b=CAMOpt(g,d,c,e,null,String(320));CUIInfo(b,"Publish",["Publish"]);b.id="ID_PublishItem"}else{var i,h=false;if(!a.isModerated||currentItemModerationStatus==String(0)){d=Strings.STS.L_UnPublishItem_Text;i="ID_UnPublishItem";e=a.imagesPath+"unpub.gif"}else{d=Strings.STS.L_CancelPublish_Text;i="ID_CancelPublish";e=a.imagesPath+"unapprv.gif";h=true}c="UnPublish('"+a.HttpRoot+"', 'FileName="+f+"&UnPublish=true',"+String(h)+")";b=CAMOpt(g,d,c,e,null,String(330));if(h)CUIInfo(b,"CancelApproval",["CancelApproval"]);else CUIInfo(b,"Unpublish",["Unpublish"]);b.id=i}}}}function AddWorkflowsMenuItem(h,a){if(HasRights(0,4)&&!a.ExternalDataList){var f=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(f==null||f.substr(0,8)!="0x010801"){var g=a.imagesPath+"workflows.png",c,d=(""+currentItemID).indexOf(".0.");if(d>0)c=currentItemID.substr(0,d);else c=currentItemID;var b="STSNavigate('"+a.HttpRoot+"/_layouts/15/Workflow.aspx?ID="+c+"&List="+a.listName;b=AddSourceToUrl(b)+"')";var e=CAMOpt(h,Strings.STS.L_Workflows_Text,b,g,null,String(900));CUIInfo(e,"ViewWorkflows",["ViewWorkflows"]);e.id="ID_Workflows"}}}function AddWorkspaceMenuItem(e,b){var a,c,d=GetAttributeFromItemTable(itemTable,"SUrl","SourceUrl");if(d!=null&&d!=""&&d!="%20"){if(HasRights(0,135168)){c="STSNavigate('"+b.HttpRoot+"/_layouts/15/publishback.aspx?list="+b.listName+"&item="+currentItemID+GetRootFolder(b)+"')";a=CAMOpt(e,Strings.STS.L_PublishBack_Text,c,"",null,String(1140));CUIInfo(a,"PublishBack",["PublishBack"]);a.id="ID_PublishBack"}}else if(HasRights(0,8388608)&&HasRights(0,135168)&&HasRights(0,67108864)){c="STSNavigate('"+b.HttpRoot+"/_layouts/15/createws.aspx?list="+b.listName+"&item="+currentItemID+GetRootFolder(b)+"')";a=CAMOpt(e,Strings.STS.L_CreateDWS_Text,c,"",null,String(1140));CUIInfo(a,"CreateDocumentWorkspace",["CreateDocumentWorkspace"]);a.id="ID_CreateDWS"}}function AddVersionsMenuItem(i,a,h){if(currentItemID!=null){var d=currentItemID.toString();if(d.indexOf(".0.")>=0)return}var b=currentItemID;if(currentItemIsEventsExcp)if(currentItemID.indexOf(".")!=-1)b=currentItemID.split(".")[0];if(!HasRights(0,64))return;var e=Strings.STS.L_Versions_Text,g="NavigateToVersionsAspxV4(event, '"+a.HttpRoot+"', 'list="+a.listName+"&ID="+b+"&FileName="+h+"')",f=a.imagesPath+"versions.gif",c=CAMOpt(i,e,g,f,null,String(800));CUIInfo(c,"ViewVersions",["ViewVersions"]);c.id="ID_Versions"}function AddWorkOfflineMenuItem(j,a,i){var b=GetStssyncData("documents",Strings.STS.L_WorkOffline_Text,a.imagesPath+"tbsprsht.gif",a.imagesPath);if(b!=null){var d=b.BtnText,h=b.BtnImagePath;if(d!=null){var f="";if(typeof a.SiteTitle=="string"&&a.SiteTitle!=null)f=STSScriptEncode(a.SiteTitle);var c="";if(typeof a.ListTitle=="string"&&a.ListTitle!=null)c=STSScriptEncode(a.ListTitle);var g="javascript:ExportHailStorm('documents','"+a.HttpRoot+"','"+STSScriptEncode(a.listName)+"','"+STSScriptEncode(f)+"','"+c+"','"+STSScriptEncode(a.listUrlDir)+"','','"+STSScriptEncode(unescapeProperly(a.listUrlDir))+"'";g+=",'"+STSScriptEncode(unescapeProperly(i))+"','"+currentItemID+"')";var e=CAMOpt(j,d,g,h);CUIInfo(e,"ConnectFolderToClient",["ConnectFolderToClient"]);e.id="ID_WorkOffline"}}}unction NavigateToApproveRejectAspx(b,a){if(FV4UI())ShowInPopUI(b,currentCtx,a);else STSNavigate(a)}function PublishMajorVersion(d,b,c){var a=b+"/_layouts/15/Checkin.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else SubmitFormPost(a)}function _NavigateToSubNewAspx(b,c){var a=b+"/_layouts/15/SubNew.aspx?"+c;a=AddSourceToUrl(a);STSNavigate(a)}function NavigateToSubNewAspxV4(d,b,c){var a=b+"/_layouts/15/SubNew.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else STSNavigate(a)}function NavigateToVersionsAspx(b,c){var a=b+"/_layouts/15/Versions.aspx?"+c;a=AddSourceToUrl(a);STSNavigate(a)}unction NavigateToSendToOtherLocationV4(b,a){if(FV4UI())ShowInPopUI(b,currentCtx,a);else STSNavigate(a)}function UnDoCheckOutwithNotification(a,c){var b=UnDoCheckOut(a,c);if(b){var d=Strings.STS.L_Notification_DiscardCheckOut;addNotification(d,true)}}function UnDoCheckOut(f,c){try{var b=null,e=SzExtension(unescapeProperly(c));if(FSupportCheckoutToLocal(e))b=StsOpenEnsureEx2("SharePoint.OpenDocuments.3");if(b!=null&&typeof b.DiscardLocalCheckout=="function"){var a=unescapeProperly(c);if(a.charAt(0)=="/")a=window.location.protocol+"//"+window.location.host+a;var d=b.DiscardLocalCheckout(a);if(d){SetWindowRefreshOnFocus();return d}if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){if(!confirm(Strings.STS.L_UndoCheckoutWarning_Text))return false}else return d}else if(!confirm(Strings.STS.L_UndoCheckoutWarning_Text))return false}catch(g){}NavigateToCheckinAspx(f,"FileName="+c+"&DiscardCheckout=true");return true}ction NavigateToManagePermsPageEx(c,b,d,f){var e=",LISTITEM",a=c+"/_layouts/15/User.aspx?obj="+b+","+d+e+"&List="+b;a=AddSourceToUrl(a);if(f)typeof window.frameElement.navigateParent=="function"&&window.frameElement.navigateParent(a);else STSNavigate(a)}function NavigateToSourceItem(e,a){var d=a.match(/[^\/]*\/\/[^\/]*/g),c=d[0];a=escapeProperly(a);var b=c+"/_layouts/15/copyutil.aspx?GoToDispForm=1&Use=url&ItemUrl="+a;b=AddSourceToUrl(b);STSNavigate(b)}function setDocType(){var b=GetAttributeFromItemTable(itemTable,"Icon","DocIcon"),a=Boolean(b)?b.split("|"):[];currentItemIcon=a[0];currentItemAppName=a[1];currentItemOpenControl=a[2];if(a[3]==null)currentItemOpenApp="";else currentItemOpenApp=a[3];currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType")}function DeleteListItem(){if(!IsContextSet())return;var b=currentCtx,e=currentItemID,c=Strings.STS.L_STSRecycleConfirm_Text;if(!b.RecycleBinEnabled||b.ExternalDataList)c=Strings.STS.L_STSDelConfirm_Text;if(Boolean(b.HasRelatedCascadeLists)&&b.CascadeDeleteWarningMessage!=null)c=b.CascadeDeleteWarningMessage+c;if(confirm(c)){var g=Strings.STS.L_Notification_Delete,f=addNotification(g,true),a=b.clvp;if(b.ExternalDataList&&a!=null){a.DeleteItemCore(e);a.pendingItems=[];typeof a.cctx.executeQueryAsync!="undefined"&&a.cctx.executeQueryAsync(}else{var d=b.HttpPath+"&Cmd=Delete&List="+b.listName+"&ID="+e+"&NextUsing="+GetSource();if(null!=currentItemContentTypeId)d+="&ContentTypeId="+currentItemContentTypeId;SubmitFormPost(d)}}}function DeleteDocLibItem(d,e){if(!IsContextSet())return;var b=currentCtx,h=currentItemID,g=currentItemFSObjType,a,c=false;if(currentItemFSObjType=="1"){if(currentItemContentTypeId!=null){d+="&ContentTypeId="+currentItemContentTypeId;if(currentItemContentTypeId.substr(0,8).toLowerCase()=="0x0120d5")c=true}if(c)a=b.RecycleBinEnabled?Strings.STS.L_STSRecycleConfirm2_Text:Strings.STS.L_STSDelConfirm2_Text;else a=b.RecycleBinEnabled?Strings.STS.L_STSRecycleConfirm1_Text:Strings.STS.L_STSDelConfirm1_Text}else a=b.RecycleBinEnabled?Strings.STS.L_STSRecycleConfirm_Text:Strings.STS.L_STSDelConfirm_Text;if(Boolean(b.HasRelatedCascadeLists)&&b.CascadeDeleteWarningMessage!=null)a=b.CascadeDeleteWarningMessage+a;if(e&&currentItemFSObjType!="1")a=Strings.STS.L_NotifyThisIsCopy_Text+a;if(confirm(a)){var f=Strings.STS.L_Notification_Delete;addNotification(f,true);SubmitFormPost(d,false,true)}}function EditMenuDefaultForOnclick(){if(!IsContextSet())return;var a=currentCtx;if(Boolean(a.isVersions))STSNavigate(itemTable.getAttribute("verUrl"));else if(a.listTemplate==200){var b=currentItemID;MtgNavigate(b)}else EditListItem()}unction _DoNavigateToTemplateGallery(a,b){document.cookie="MSOffice_AWS_DefSaveLoc="+a;STSNavigate(b)}nction ChangeContentType(d){var b=document.getElementById(d),a=window.location.href,e=a.indexOf("?");if(a.indexOf("?")<=0)a=a+"?ContentTypeId="+b.value;else if(a.indexOf("&ContentTypeId=")<=0)a=a+"&ContentTypeId="+b.value;else{var c=/&ContentTypeId=[^&]*/i;a=a.replace(c,"&ContentTypeId="+b.value)}STSNavigate(a)}function _TopHelpButtonClick(a){if(typeof navBarHelpOverrideKey!="undefined")return HelpWindowKey(navBarHelpOverrideKey);if(a!=null)HelpWindowKey(a);else HelpWindowKey("HelpHome")}nction HelpWindowHelper(a){if(SuiteLinksEmptyOrSuiteHelpLinkIsCached())GetSuiteLinks(null,;else{var b=GetSPHelpUrl(a);ShowHelpWindow(b)}}function _HelpWindowKey(a){if(a!=null)HelpWindowHelper("&Key="+a+"&ShowNav=true");else HelpWindowHelper("&Key=HelpHome&ShowNav=true")}unction _HelpWindow(){HelpWindowKey("HelpHome")}unction SetFullScreenMode(d){var c=document.body,b=document.getElementById("fullscreenmode"),a=document.getElementById("exitfullscreenmode");if(c!=null){SetCookieEx("WSS_FullScreenMode",d,true,window);if(d){AddCssClassToElement(c,"ms-fullscreenmode");if(b!=null&&a!=null){b.style.display="none";a.style.display=""}}else{RemoveCssClassFromElement(c,"ms-fullscreenmode");if(b!=null&&a!=null){b.style.display="";a.style.display="none"}}if("undefined"!=typeof document.createEvent&&"function"==typeof window.dispatchEvent){var e=document.createEvent("Event");e.initEvent("resize",false,false);window.dispatchEvent(e)}else"undefined"!=typeof document.createEventObject&&document.body.fireEvent("onresize");CallWorkspaceResizedEventHandlers()}}nction EditSelectedImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_EditSelectedImages()}function DeleteImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_DeleteImages()}function SendImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_SendImages()}able,bIsFilterMenuShown,bIsFilterDataLoaded,filterImageCell,currentFilterMenu,loadingFilterMenu,ctxFilter,bIsFilterKeyPress,filterStr,strFieldName,bMenuLoadInProgress,strFilteredValue,bIsMultiFilter,fnOnFilterMouseOut;unction setupFilterMenuContext(a){ctxFilter=a}nction OnMouseOverFilterDeferCall(elm){if(!IsFilterMenuEnabled(elm))return false;if(IsFilterMenuOn()||bMenuLoadInProgress)return false;if(window.location.href.search(new RegExp("[\\?&]Filter=1"))!=-1)return false;if(typeof elm.FilterDisable!=undefined&&elm.FilterDisable=="TRUE")return false;if(IsFieldNotFilterable(elm)&&IsFieldNotSortable(elm))return false;if(filterTable==elm)return true;filterTable!=null&&OnMouseOutFilter();filterTable=elm;var isTable=filterTable.tagName=="TABLE",curCtx;try{curCtx=eval("ctx"+filterTable.getAttribute("CtxNum"))}catch(e){}if(typeof curCtx=="undefined")return false;var createCtx=new Function("setupFilterMenuContext(ctx"+filterTable.getAttribute("CtxNum")+");");createCtx();if(isTable){filterTable.className="ms-selectedtitle";SetEvent("click",CreateFilterMenu,filterTable);SetEvent("contextmenu",CreateFilterMenu,filterTable);SetEvent("mouseout",OnMouseOutFilter,filterTable)}else{var par=filterTable.parentNode;SetEvent("click",CreateFilterMenu,par);SetEvent("contextmenu",CreateFilterMenu,par);SetEvent("mouseout",OnMouseOutFilter,par);CreateCtxImg(par,OnMouseOutFilter)}if(isTable){var titleParent=filterTable.childNodes[0],titleRow=titleParent.childNodes[0];filterImageCell=titleRow.childNodes[titleRow.childNodes.length-1];var filterArrow=filterImageCell.childNodes[0];filterArrow.src=ctxFilter.imagesPath+"menudark.gif";filterArrow.alt=Strings.STS.L_OpenMenu_Text;filterArrow.style.visibility="visible";if(IsElementRtl(filterTable)){filterImageCell.style.right=null;filterImageCell.style.left="1px"}else{filterImageCell.style.left=null;filterImageCell.style.right="1px"}filterImageCell.className="ms-menuimagecell"}return true}function OnMouseOutFilter(a){if(!IsFilterMenuOn()&&filterTable!=null&&!bMenuLoadInProgress){var c=filterTable.tagName=="TABLE",b=filterTable.parentNode;if(c||b==null){filterTable.className="ms-unselectedtitle";filterTable.onclick=null;filterTable.oncontextmenu=null;filterTable.onmouseout=null}else{if(a==null)a=window.event;if(a!=null){var d=typeof a.toElement!="undefined"&&a.toElement!=null?a.toElement:a.relatedTarget;if(b!=null&&d!=null&&IsContained(d,b))return}b.onclick=null;b.oncontextmenu=null;b.onmouseout=null;RemoveCtxImg(b)}if(c&&filterImageCell!=null&&filterImageCell.childNodes.length>0){filterImageCell.childNodes[0].style.visibility="hidden";filterImageCell.className=""}resetFilterMenuState()}}nction CreateFilterMenu(b){if(filterTable==null||filterTable.tagName=="TABLE"&&filterImageCell==null)return true;var a=filterTable.tagName=="DIV"?filterTable.parentNode:filterTable,c=FindCtxImg(a);c!=null&&c.shown==false&&ShowCtxImg(c,true,a);if(b==null)b=window.event;bIsFilterMenuShown=true;window.origBodyOnClickHandler=document.body.onclick;window.document.body.onclick=null;currentFilterMenu=CMenu("filter_menu");loadingFilterMenu=CMenu("filter_menu_loading");currentFilterMenu.setAttribute("CompactMode","true");addSortMenuItems(currentFilterMenu,loadingFilterMenu);if(filterStr==null)addFilterMenuItems(currentFilterMenu,loadingFilterMenu);else addAdHocFilterMenuItems(currentFilterMenu,loadingFilterMenu);if(HasCssClass(a,"ms-headerCellStylePressed")||HasCssClass(a,"ms-headerCellStyleHover")){RemoveCssClassFromElement(a,"ms-headerCellStylePressed");RemoveCssClassFromElement(a,"ms-headerCellStyleHover");AddCssClassToElement(a,"ms-headerCellStyleMenuOpen")}b!=null&&b.stopPropagation!=null&&b.stopPropagation();return false}function GetUrlWithNoSortParameters(e){var a=ajaxNavigate.get_href(),h=new URI(a,{disableEncodingDecodingForLegacyCode:true});h.setFragment("");a=h.getString();var b,f=0,d,g;do{d=e.indexOf("=",f);if(d==-1)return a;b=e.substring(f,d);if(b!="")a=RemoveQueryParameterFromUrl(a,b);if(typeof b=="string"&&b.length>"FilterField".length&&b.substring(0,"FilterField".length)=="FilterField"){var c=b.substring("FilterField".length);a=RemoveQueryParameterFromUrl(a,"FilterValue"+c);a=RemoveQueryParameterFromUrl(a,"FilterLookupId"+c);a=RemoveQueryParameterFromUrl(a,"FilterOp"+c);a=RemoveQueryParameterFromUrl(a,"FilterData"+c)}g=e.indexOf("&",d+1);if(g==-1)return a;f=g+1}while(b!="");return a}unction addSortMenuItems(b,a){if(IsFieldNotSortable(filterTable)){CAMOptFilter(b,a,Strings.STS.L_NotSortable_Text,"","",false,"fmi_ns");CAMSep(b);CAMSep(a);return}var e="",f="",d="",g=GetThemedLocalizedImageUrl("SortUpGlyph.png"),h=GetThemedLocalizedImageUrl("SortDownGlyph.png");if(filterStr==null){var c=ctxFilter.queryString;if(null==c||c=="")c=filterTable.getAttribute("SortFields");else{var z=GetUrlKeyValue("SortField",true,c),w=filterTable.getAttribute("SortFields"),v=GetUrlKeyValue("SortField",true,w);if(z!=v){c=SetUrlKeyValue("SortField",v,false,c);c=SetUrlKeyValue("SortDir",GetUrlKeyValue("SortDir",true,w),false,c)}}var l=new URI(c,{disableEncodingDecodingForLegacyCode:true});if(l.getQuery().length>0)c=l.getQuery();var r=c.indexOf("&SortDir");if(r==-1){CAMOptFilter(b,a,Strings.STS.L_NotSortable_Text,"","",false,"fmi_ns");CAMSep(b);CAMSep(a);return}var q=c.indexOf("&",r+1),t=GetUrlWithNoSortParameters(c);t=RemovePagingArgs(t);l=new URI(t,{disableEncodingDecodingForLegacyCode:true});var k="?"+l.getQuery();if(k.length>1)k+="&";var C=k;if(q<0)q=c.length;k+=c.substr(0,r)+"&SortDir=Asc"+c.substr(q);l.setQuery(k);e="HandleFilter(event, '"+STSScriptEncode(l.getString())+"', 1);";k=C;k+=c.substr(0,r)+"&SortDir=Desc"+c.substr(q);l.setQuery(k);f="HandleFilter(event, '"+STSScriptEncode(l.getString())+"', 1);";if(e.indexOf("?")>=0)e.substr(e.indexOf("?")+1).indexOf("?")>=0;d=filterTable.getAttribute("FieldType");strFieldName=filterTable.getAttribute("Name")}else{var s=" ",j=filterStr.lastIndexOf(s);d=filterStr.substring(j+1);if(d.substring(0,2)=="x:")d=d.substring(2);var o=filterStr.substring(0,j);j=o.lastIndexOf(s);strFieldName=o.substring(j+1);if(strFieldName.substring(0,1)=="@")strFieldName=strFieldName.substring(1);o=filterStr.substring(0,j);j=o.lastIndexOf(s);if(j>0)strFieldName=o.substring(0,j);var B=filterTable.tagName=="TABLE",i=null;if(B){var y=filterTable.childNodes[0],A=y.childNodes[0],x=A.childNodes[0];i=x.childNodes[0];if(i.tagName=="TABLE"){var n=i.childNodes[0];n=n.childNodes[0];n=n.childNodes[1];i=n.childNodes[0]}}else i=filterTable.firstChild;if(i.tagName=="DIV")i=i.childNodes[0];var m=i.href;m=m.replace(/%20/g," ");if(m.indexOf("'ascending'")>0){e=m;f=m.replace("'ascending'","'descending'")}else{f=m;e=m.replace("'descending'","'ascending'")}}d=d.toLowerCase();if(d=="dateTime"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else if(d=="integer"||d=="number"||d=="currency"){CAMOptFilter(b,a,Strings.STS.L_SmallestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_LargestOnTop_Text,f,h,true,"fmi_desc")}else if(d=="text"||d=="user"||d=="string"){CAMOptFilter(b,a,Strings.STS.L_AOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_ZOnTop_Text,f,h,true,"fmi_desc")}else if(d=="calculated"){var p=filterTable.getAttribute("ResultType");if(p=="Number"||p=="Currency"){CAMOptFilter(b,a,Strings.STS.L_SmallestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_LargestOnTop_Text,f,h,true,"fmi_desc")}else if(p=="dateTime"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else if(p=="boolean"){CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}else{CAMOptFilter(b,a,Strings.STS.L_AOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_ZOnTop_Text,f,h,true,"fmi_desc")}}else if(d=="attachments"){CAMOptFilter(b,a,Strings.STS.L_BlanksOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_AttachmentsOnTop_Text,f,h,true,"fmi_desc")}else if(d=="lookup"){var u=filterTable.getAttribute("Name");if(u=="Last_x0020_Modified"||u=="Created_x0020_Date"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else{CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}}else{CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}CAMSep(b);CAMSep(a)}tion addFilterMenuItems(n,k){if(IsFieldNotFilterable(filterTable)){addFilteringDisabledMenuItem(n);return}var e=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(e==null)return;var c=ctxFilter.queryString;if(null==c||c=="")c=e.getAttribute("FilterLink");(c==null||c=="")&&window.alert("Unexpected");if(c=="?"){var r=ajaxNavigate.getParam("InplviewHash"+ctxFilter.view);if(Boolean(r))c+=DecodeHashAsQueryString(r)}var h=escapeProperly(filterTable.getAttribute("Name"));strFilteredValue=null;var a="",d=0,b,f;do{d++;var s=false;b=c.match(new RegExp("FilterField"+String(d)+"=[^&#]*"));if(!Boolean(b))b=c.match(new RegExp("FilterFields"+String(d)+"=[^&#]*"));f=c.match(new RegExp("&FilterValue"+String(d)+"=[^&#]*"));if(!Boolean(f)){f=c.match(new RegExp("&FilterValues"+String(d)+"=[^&#]*"));s=true}if(b!=null&&f!=null){if(strFilteredValue==null){strFilteredValue=getFilterValueFromUrl(b.toString()+f.toString(),h);bIsMultiFilter=s}a=a+"&"+b.toString()+f.toString();var q=c.match(new RegExp("&FilterOp"+String(d)+"=[^&#]*"));if(q!=null)a=a+q.toString();var i=c.match(new RegExp("&FilterLookupId"+String(d)+"=[^&#]*"));if(i!=null)a=a+i.toString();var m=c.match(new RegExp("&FilterData"+String(d)+"=[^&#]*"));if(m!=null)a=a+m.toString();if(i!=null&&m==null&&strFilteredValue!=null){addFilteringDisabledMenuItem(n);return}}}while(null!=b);var p=strFilteredValue!=null,t=StBuildParam(Strings.STS.L_DontFilterBy_Text,filterTable.getAttribute("DisplayName")),u="javascript:HandleFilter(event, '"+STSScriptEncode(FilterFieldV3(ctxFilter.view,h,"",0,ctxFilter.queryString,true))+"')",l;if(p)l=GetThemedImageUrl("DeleteFilterGlyph.png");else l=GetThemedImageUrl("DisabledDeleteFilterGlyph.png");CAMOptFilter(n,k,t,u,l,p,"fmi_clr");var v=CAMOpt(k,Strings.STS.L_Loading_Text,"");v.setAttribute("enabled","false");setTimeout("ShowFilterLoadingMenu()",500);k._onDestroy=OnMouseOutFilter;b=c.match(new RegExp("MembershipGroupId=[^&]*"));if(b!=null)a=a+"&"+b.toString();b=c.match(new RegExp("InstanceID=[^&]*"));if(b!=null)a=a+"&"+b.toString();if(a!=null&&a.length>0){if(ctxFilter.overrideFilterQstring!=null&&ctxFilter.overrideFilterQstring.length>0)a="&"+ReconcileQstringFilters(a.substring(1),ctxFilter.overrideFilterQstring)}else if(ctxFilter.overrideFilterQstring!=null&&ctxFilter.overrideFilterQstring.length>0)a="&"+ctxFilter.overrideFilterQstring;var j="",g;if(ctxFilter!=null&&(g=ctxFilter.clvp)!=null&&g.rootFolder!=null&&g.rootFolder.length>0)j="&RootFolder="+escapeProperlyCore(g.rootFolder,false);else{b=c.match(new RegExp("RootFolder=[^&]*"));if(b!=null)j="&"+b.toString()}var o="";b=a.match(new RegExp("OverrideScope=[^&]*"));if(ctxFilter!=null&&typeof ctxFilter.overrideScope!="undefined"&&b==null)o="&OverrideScope="+escapeProperlyCore(ctxFilter.overrideScope,false);if(browseris.safari){e.src="/_layouts/15/blank.htm";e.style.offsetLeft="-550px";e.style.offsetTop="-550px";e.style.border="0px";e.style.display="block"}e.src=ctxFilter.HttpRoot+"/_layouts/15/filter.aspx?ListId="+ctxFilter.listName+j+o+"&FieldInternalName="+h+"&ViewId="+ctxFilter.view+"&FilterOnly=1&Filter=1"+a;bMenuLoadInProgress=true}function getFilterValueFromUrl(b,f){var a,c,e;a=b.indexOf("=");if(a==-1)return null;c=b.indexOf("&");if(c==-1)return null;if(c<a)return null;b=CanonicalizeUrlEncodingCase(b);e=b.substring(a+1,c);if(e==f){var d;a=b.indexOf("=",c+1);if(a==-1)return null;d=b.substr(a+1);d=unescapeProperly(d);return d}return null}function _OnIframeLoad(){bMenuLoadInProgress=false;if(filterTable!=null&&filterTable.getAttribute("Name")!=null){var b=null;b=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(b!=null){var a=null,e=filterTable.getAttribute("Name");if(typeof b.contentDocument!="undefined")a=b.contentDocument;if(a==null&&null!=b.contentWindow)a=b.contentWindow.document;if(a==null)a=b.ownerDocument;if(a!=null){var h=a.getElementById("diidFilterCustomTable");if(h!=null&&(typeof b.contentWindow!="undefined"&&null!=b.contentWindow&&typeof b.contentWindow.CustomPopulateFilterMenu!="undefined"&&null!=b.contentWindow.CustomPopulateFilterMenu||typeof a.defaultView!="undefined"&&null!=a.defaultView&&typeof a.defaultView.CustomPopulateFilterMenu!="undefined"&&null!=a.defaultView.CustomPopulateFilterMenu))if(null!=b.contentWindow)b.contentWindow.CustomPopulateFilterMenu(currentFilterMenu,h,"FilterIframe"+filterTable.getAttribute("CtxNum"),ctxFilter.view,e);else a.defaultView.CustomPopulateFilterMenu(currentFilterMenu,h,"FilterIframe"+filterTable.getAttribute("CtxNum"),ctxFilter.view,e);else{var i=a.getElementById("diidFilter"+e);e=escapeProperly(e);if(i!=null){var k=i.childNodes.length;if(k>500)addFilterOptionMenuItem();else for(var d=i.childNodes,c=1;c<k;c++){var g;if(d[c].innerText)g=d[c].innerText;else if(d[c].textContent)g=d[c].textContent;else g=d[c].innerHTML;var m="javascript:HandleFilter(event, '"+STSScriptEncode(FilterFieldV3(ctxFilter.view,e,d[c].value,c,ctxFilter.queryString,true))+"')",j=CAMOpt(currentFilterMenu,g,m);ctxFilter.IsClientRendering&&j.setAttribute("checked","false");if(strFilteredValue!=null){var f=[];if(bIsMultiFilter)f=ParseMultiColumnValue(strFilteredValue,";#",true);else f.push(strFilteredValue);for(var l in f)f[l]!=null&&f[l]==d[c].value&&j.setAttribute("checked","true")}}}else{alert(Strings.STS.L_FilterThrottled_Text);return}}bIsFilterDataLoaded=true;if(loadingFilterMenu!=null)loadingFilterMenu._onDestroy=null;if(currentFilterMenu!=null){currentFilterMenu._onDestroy=OnMouseOutFilter;FilterOMenu(currentFilterMenu,filterTable)}}}}}function addFilterOptionMenuItem(){var a=ajaxNavigate.get_href();a=StURLSetVar2(a,"Filter","1");a=StURLSetVar2(a,"View",ctxFilter.view);a="javascript:SubmitFormPost('"+a+"')";CAMOpt(currentFilterMenu,Strings.STS.L_FilterMode_Text,a)}tion _OnClickFilter(d,b){if(!IsFilterMenuEnabled(d)){alert(Strings.STS.L_SortNotAllowed);return false}if(FV4UI()){if(browseris.ie){b.cancelBubble=true;b.returnValue=false}else b.stopPropagation();var c;try{c=typeof inplview.OnClickFilterV4}catch(b){c="undefined"}var i="inplview.OnClickFilterV4",g=i.split(".");if(g.length>1){var h=EnsureScript(g[0],c,h)}return false}var e=FindSTSMenuTable(d,"CTXNum");if(e!=null&&e.getAttribute("SortFields")!=null){var f=e.getAttribute("SortFields"),a=GetUrlWithNoSortParameters(f);a=RemovePagingArgs(a);if(a.indexOf("?")<0)a+="?";else a+="&";SubmitFormPost(a+f)}if(!bIsFileDialogView)b.cancelBubble=true;return false}function ToggleSelectionAllUsers(b){var a=document.getElementById("spToggleUserSelectionCheckBox_"+b.toString());if(a!=null){var f="spUserSelectionCheckBox_"+b.toString(),e=document.getElementsByName(f);a.checked=!a.checked;for(var d=0;d<e.length;d++){var h=e[d];h.checked=a.checked}var g="cbxUserSelectAll"+b.toString(),c=document.getElementById(g);if(c!=null)if(a.checked)c.src="/_layouts/15/images/checkall.gif";else c.src="/_layouts/15/images/unchecka.gif"}}_errMsg,L_SSCDlgInvalidCharacter_TEXT,g_btnCreateId,g_txtTitleId,g_CusValTxtTitle;tion RibbonBlock(){}var _ribbon; _spRibbonInstantiateByRibbonControl;menuHtc_lastMenu,g_uniqueNumber,g_MenuEndOfDOM;nction MenuHtc_show(oMaster,oParent,fForceRefresh,fFlipTop,yOffset,fShowClose,fShowCheckBoxes,evt){MenuHtc_hide();MenuHtc_init(oMaster);oMaster._oParent=oParent;oMaster._fIsRtL=IsElementRtl(oMaster._oParent);if((browseris.ie||browseris.nav)&&IsAccessibilityFeatureEnabledProxy()){var menu=null;if(oParent.foa!=null){var foa=oParent.foa;menu=byid(foa);if(menu==null)menu=eval(foa)}if(menu!=null)typeof menu.onblur!="undefined"&&menu.onblur!=null&&menu.onblur();RenderAccessibleMenu(oMaster,fForceRefresh);g_menuHtc_lastMenu=oMaster}else{SetBodyEventHandlers(null);AssureId(oParent);var result=ShowRoot(oMaster,oParent,fForceRefresh,fFlipTop,yOffset,fShowClose,fShowCheckBoxes,evt);g_menuHtc_lastMenu=oMaster;SetBodyEventHandlers(HandleDocumentBodyClick)}if(browseris.ie)if(window.event!=null)window.event.cancelBubble=true;return false}PrepContents(a){var c;a._fLargeIconMode=a.getAttribute("largeIconMode")=="true";a._fHideIcons=a.getAttribute("hideicons")=="true";a._fCompactItemsWithoutIcons=a.getAttribute("CompactMode")=="true";if(!browseris.safari){c=document.createElement("span");a._oContents=c;c.style.display="none";var b=a.innerHTML;if(b.indexOf("<IE:MENUITEM ")<0&&b.indexOf("<MENUITEM ")>=0){b="<?XML:NAMESPACE PREFIX = IE />"+b;b=b.replace(/<MENUITEM/g,"<IE:MENUITEM");b=b.replace(/<\/MENUITEM/g,"</IE:MENUITEM")}c.innerHTML=b}else{c=a.cloneNode(true);a._oContents=c;c.style.display="none"}a._wzMArrPath="/_layouts/15/images/MArr.gif";a._wzMArrPathRtL="/_layouts/15/images/MArrRtL.gif"}ction AdjustScrollPosition(d,e,b){var a=d;while(a!=null&&a!=e&&a!=d.offsetParent&&a.tagName!=null&&a.tagName.toLowerCase()!="body"&&a.tagName.toLowerCase()!="html"&&!(getElementOverFlowStyle(a)=="hidden")){if(a.scrollWidth>a.clientWidth&&a.offsetWidth>=a.clientWidth&&a.clientWidth!=0)if(!IsElementRtl(a)){if(a.scrollLeft>0)b.x-=a.scrollLeft}else if(browseris.ie8standardUp)b.x+=a.scrollLeft;else if(browseris.firefox)b.x-=a.scrollLeft;else{var c=getElementOverFlowStyle(a);if(browseris.ie||browseris.safari&&(c=="auto"||c=="scroll"))b.x+=a.scrollWidth-a.clientWidth-a.scrollLeft}if(a.scrollTop>0)b.y-=a.scrollTop;a=a.parentNode}}on TransferEventToMenu(b,c){var a;if(browseris.ie)a={srcElement:b,keyCode:c.keyCode};else a={target:b,which:c.which};PopupKeyDown(a)}function MenuHtcInternal_Show(c,b,B,k,y,x,m){var q,A,z,p;!Boolean(c._oContents)&&PrepContents(c);var i="ms-core-menu-box";if(c._fLargeIconMode)i+="Big";if(!Boolean(c._fHideIcons))i+=" ms-core-menu-hasIcons";i+=" ms-core-defaultFont ms-shadow";q=new MenuTag("div",i);p=new MenuTag("ul","ms-core-menu-list");var t=c._arrPopup,r=c._arrSelected,e=c._nLevel,a=t[e];if(!Boolean(c._oContents)||IsOpen(c))return;if(null==a&&!Boolean(c._oRoot)){c._nLevel=0;e=0;c._oRoot=c._oContents}var h=e==0;k=k&&h;if(null==a){a=CreateMenuTag(q);a.title="";t[e]=a;a.isMenu=true;a.master=c;a.level=e;var j=CreateMenuTag(p);a.style.top="0px";a.style.position="fixed";a.style.visibility="hidden";if(c._fIsRtL){a.style.right="0px";a.setAttribute("dir","rtl")}else{a.style.left="0px";a.setAttribute("dir","ltr")}a.contentEditable=false;a.appendChild(j);if(g_MenuEndOfDOM==true)document.body.appendChild(a);else if(b.tagName=="TABLE")b.parentNode.appendChild(a);else b.appendChild(a);FixUpMenuStructure(c);var n=0,u=c._oRoot;e=c._nLevel;for(var w=u.childNodes.length,l=0;l<w;l++){var f=u.childNodes[l];if(f.nodeType!=1)continue;if(!FIsIType(f,"label")){var g=CreateMenuItem(c,f,MakeID3(c,e,n),null,x);null!=g&&j.appendChild(g);n++}}if(c.id=="filter_menu"||y){g=document.createElement("div");g.id=MakeID3(c,e,n);g.className="ms-core-menu-closebutton";f=document.createElement("button");g.appendChild(f);f.id="fmi_cls";f.innerHTML=Strings.STS.L_CloseButtonCaption;f.onclick=MenuHtc_hide;j.appendChild(g)}a.oncontextmenu=kfnDisableEvent;a.ondragstart=kfnDisableEvent;a.onselectstart=kfnDisableEvent;if(b._onmouseover==null&&typeof b.onmouseover!="undefined")b._onmouseover=b.onmouseover;if(b._onmouseout==null&&typeof b.onmouseout!="undefined")b._onmouseout=b.onmouseout;if(b._onmousedown==null&&typeof b.onmousedown!="undefined")b._onmousedown=b.onmousedown;if(b._onclick==null&&typeof b.onclick!="undefined")b._onclick=b.onclick;if(b._oncontextmenu==null&&typeof b.oncontextmenu!="undefined")b._oncontextmenu=b.oncontextmenu;if(h)if(b._onkeydown==null&&typeof b.onkeydown!="undefined")b._onkeydown=b.onkeydown;if(browseris.nav){SetEvent("keypress",function(){return false},a);SetEvent("keyup",a);SetEvent("keydown",a);SetEvent("mousedown",function(a){TrapMenuClick(a);return false},a);SetEvent("mouseover",function(a){PopupMouseOver(a);return false},a);SetEvent("mouseout",function(a){PopupMouseLeave(a);return false},a);SetEvent("click",a);SetEvent("mouseover",function(a){PopupMouseOverParent(a);return false},b);SetEvent("mouseout",function(a){PopupMouseLeaveParent(a);return false},b);SetEvent("mousedown",function(a){TrapMenuClick(a);return false},b);SetEvent("click",function(a){TrapMenuClick(a);return false},b);SetEvent("contextmenu",b);if(h)b.onkeydown=else{SetEvent("keydown",new Function("PopupKeyDown(event); event.cancelBubble = true; return false;"),a);SetEvent("mousedown",new Function("TrapMenuClick(event); return false;"),a);SetEvent("mouseover",new Function("PopupMouseOver(event); return false;"),a);SetEvent("mouseout",new Function("PopupMouseLeave(event); return false;"),a);SetEvent("click",new Function("PopupMouseClick(event); TrapMenuClick(event); return false;"),a);SetEvent("mouseover",new Function("PopupMouseOverParent(event); return false;"),b);SetEvent("mouseout",new Function("PopupMouseLeaveParent(event); return false;"),b);SetEvent("mousedown",new Function("TrapMenuClick(event); return false;"),b);SetEvent("click",new Function("TrapMenuClick(event); return false;"),b);SetEvent("contextmenu",new Function("TrapMenuClick(event); return false;"),b);if(h)b.onkeydown=if(h){var s=c.getAttribute("onunloadtext");null!=s&&SetEvent("unload",new Function(s),a)}}else{var v=r[e];null!=v&&UnselectItem(v)}r[e]=null;var d;if(browseris.ie&&m==null){var o=document.body.scrollLeft;d=document.createElement("iframe");AssureId(d);d.src="/_layouts/blank.htm";d.style.position="absolute";d.style.display="none";d.scrolling="no";d.frameBorder=0;if(g_MenuEndOfDOM==true)document.body.appendChild(d);else if(b.tagName=="TABLE")b.parentNode.appendChild(d);else b.appendChild(d);a.style.zIndex="103";a._backgroundFrameId=d.id;if(o!=document.body.scrollLeft)document.body.scrollLeft=o}a.style.width=String(a.offsetWidth)+"px";if(c._fIsRtL)a.style.right="";a.style.position="absolute";SetMenuPosition(c,b,a,k,h,m);a.style.visibility="visible";NavigateToMenu(c);if(browseris.ie&&m==null){SetBackFrameSize(null,a);a.onresize=new Function("SetBackFrameSize(event, null);");d.style.display="block";d.style.zIndex=String(101)}}unction SetMenuPosition(M,D,c,L,w,E){var x=GetWindowPosition(),j=x.width,m=x.height,d=c.offsetWidth,h=c.offsetHeight,K=false,J=false;if(d>j-50){K=true;d=j-50<0?0:j-50}if(h>=m-50){J=true;h=m-50<0?0:m-50}if(K){c.style.width=String(d)+"px";c.style.overflowX="scroll"}if(J){c.style.height=String(h)+"px";c.style.overflowY="scroll"}d=c.offsetWidth;h=c.offsetHeight;var y=x.x,P=x.y,v=j,b=0,r=0,O=D,k;if(E!=null)k=new ElementPosition(E.clientX,E.clientY,0,0);else k=MenuHtc_GetElementPosition(O,null);b=k.x;r=k.y;var g;if(w){g=k.width;r+=k.height}else g=k.width+1;var N=!L&&!document.body.WZ_ATTRIB_FLIPPED,u,C,z,A;if(!M._fIsRtL){var s,q;if(w){z=b;s=b+d;q=b+g-d}else{z=b+g;s=b+g+d;q=b-d}A=q;u=s>v&&q>y;C=!(q<y&&s<v)}else{var p,t;if(w){p=b+g-d;t=b+d;A=b}else{p=b-d;t=b+g+d;A=b+g}z=p;u=p<y&&t<v;C=!(t>v&&p>y)}var i=N?u:C,B=i?A:z,f,n;if(typeof window.pageXOffset!="undefined"){f=window.pageXOffset;n=window.pageYOffset}else{var l=document.body.parentNode;if(!IsElementRtl(document.body)){f=document.body.scrollLeft;f+=l.scrollLeft}else if(browseris.ie8standard){f=-document.body.scrollLeft;f+=-l.scrollLeft}else{var F=getElementOverFlowStyle(document.body);if(browseris.ie||browseris.safari&&(F=="auto"||F=="scroll"))f=-document.body.scrollWidth+document.body.clientWidth+document.body.scrollLeft;f+=-l.scrollWidth+l.offsetWidth+l.scrollLeft}n=document.body.scrollTop;n+=l.scrollTop}if(d>=j)B=f;else if(B-f+d>=j)B=f+j-d;var o;if(h>=m)o=n;else if(r+h-n>=m)o=n+m-h;else o=r;if(browseris.safari)o+=window.pageYOffset;else o+=document.documentElement.scrollTop;c.setAttribute("flipped",String(L?i&&u:i));var a=B,e=o;if(browseris.safari)e-=window.pageYOffset;else e-=document.documentElement.scrollTop;if(g_MenuEndOfDOM==false)if(!w){if(M._fIsRtL)if(browseris.ie)if(i)a=a-b;else a=a-b+1;else if(i)a=a-b;else a=a-b+3;else if(browseris.ie)if(i)a=a-b+1;else a=a-b;else if(i)a=a-b+3;else a=a-b;if(e==0)e=D.offsetTop-c.offsetParent.firstChild.scrollTop;else e=e-r+D.offsetTop-c.offsetParent.firstChild.scrollTop;if(browseris.ie8standard)e=e-1}else if(c.offsetParent!=null&&c.offsetParent.tagName.toLowerCase()!="body"){var G,H,I=MenuHtc_GetElementPosition(c.offsetParent);G=I.x;H=I.y;e=e-H;a=a-G}else{a=a+document.documentElement.scrollLeft;e=e+document.documentElement.scrollTop}c.style.left=String(a)+"px";c.style.top=String(e)+"px";c.LeftForBackIframe=a;c.TopForBackIframe=e}eClick(a){var h=GetEventPopup(a),b=h.master,c=h.level;if(c<0)return;var g=b._arrSelected,i=g[c],e=GetEventSrcItem(b,GetEventSrcElement(a));if(i!=e)if(null!=e)g[c]=e;UpdateLevel(b,c);var d=null,f=false;if(browseris.nav){if(null!=a&&null!=a.target){f=a.target.className=="hierarchy";d=a.target.getAttribute("onExpand")}}else if(null!=a&&null!=a.srcElement){f=a.srcElement.className=="hierarchy";d=a.srcElement.getAttribute("onExpand")}EngageSelection(b,true,false,false,f,d)}tion ExecuteOnClick(fnOnClick,oMaster){try{if(browseris.safari)if(FIStringEquals(typeof fnOnClick,"string"))eval("var document=window.document; {"+fnOnClick+"}");else fnOnClick();else{if(FIStringEquals(typeof fnOnClick,"string"))fnOnClick=new Function("event","var document=window.document; {"+fnOnClick+"}");var oTemp=window.document.body.appendChild(window.document.createElement("span"));oTemp.master=oMaster;oTemp.onclick=fnOnClick;var evt,ctxVar=null;if(typeof currentCtx!="undefined"&&currentCtx!=null)ctxVar=currentCtx;else if(typeof ctxFilter!="undefined"&&ctxFilter!=null)ctxVar=ctxFilter;if(browseris.ie)evt={srcElement:oTemp,fakeEvent:1,currentCtx:ctxVar};else evt={target:oTemp,fakeEvent:1,currentCtx:ctxVar};oTemp.onclick(evt);oTemp.parentNode.removeChild(oTemp)}}catch(e){}}function EngageSelection(oMaster,fDoSelection,fDelayExpandSM,fEnterSM,fExpand,fCommand){var nLevel=oMaster._nLevel,arrSelected=oMaster._arrSelected,oItem=arrSelected[nLevel];if(null==oItem||oItem.optionDisabled)return;if(FIsIType(oItem,"submenu"))if(fDelayExpandSM)SetShowSubMenuEvnt(oMaster);else{ShowSubMenu(oMaster,nLevel,oItem);fEnterSM&&MoveMenuSelection(oMaster,1)}else if(fDoSelection){var fEnabled=oItem.getAttribute("enabled");if(fEnabled!="false")if(!fExpand){var fnOnClick=oItem.getAttribute("onMenuClick");if(null!=fnOnClick){var noHideMenu=false,executed=false;if(oMaster.id=="filter_menu"){ExecuteOnClick(fnOnClick,oMaster);executed=true;RefreshOpenedSortMenu(oMaster,nLevel);RefreshClearAndFilterMenu(oMaster,oItem,nLevel);var idValue=oMaster._wzPrefixID+"_"+String(nLevel)+"_";if(oItem.id!=idValue+String(1)&&oItem.id!=idValue+String(0)&&!oMaster.hideMenu)noHideMenu=true}if(!noHideMenu){HideMenu(oMaster,1);!executed&&ExecuteOnClick(fnOnClick,oMaster);HideMenu(oMaster,2)}}else{var oItemAnchor=oItem.firstChild,fnClick=oItemAnchor.onclick;null!=fnClick&&fnClick()}}else eval(fCommand)}}function RefreshClearAndFilterMenu(n,i,r){if(ctxFilter==null)return;var h=parseInt(i.id.substr(i.id.lastIndexOf("_")+1)),y=n._oRoot,e=y.childNodes,u=filterTable.getAttribute("Name"),k=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum")),g=null;if(typeof k.contentDocument!="undefined")g=k.contentDocument;if(g==null&&null!=k.contentWindow)g=k.contentWindow.document;if(g==null)g=k.ownerDocument;var s=g.getElementById("diidFilter"+u);if(s==null)return;var q=s==null?null:s.childNodes,p=true,c=null;if(e[h].id!="fmi_asc"&&e[h].id!="fmi_desc"&&e[h].id!="fmi_clr"){c=document.getElementById(i.id+"_ICON");if(i.getAttribute("checked")=="true"){i.setAttribute("checked","false");if(c!=null){c.checked=false;window.setTimeout(function(){c.checked=false},0)}}else{i.setAttribute("checked","true");if(c!=null){c.checked=true;window.setTimeout(0)}}}else if(e[h].id=="fmi_asc"||e[h].id=="fmi_desc")p=false;for(var f="",w=q==null?0:q.length,d=-1,o=0,j=1;o<e.length&&j<w;o++,j++){f=n._wzPrefixID+"_"+String(r)+"_"+String(o);var a=document.getElementById(f);if(d<0){var b=a.firstChild;if(b!=null)b=b.firstChild;if(b!=null)b=b.nextSibling;if(b!=null&&b.id=="fmi_clr")d=o;j=0;continue}var v=FilterFieldV3(ctxFilter.view,escapeProperly(u),q[j].value,j,ctxFilter.queryString,true),x="javascript:HandleFilter(event, '"+STSScriptEncode(v)+"')";a.setAttribute("onMenuClick",x);if(h==d){a.setAttribute("checked","false");var t=document.getElementById(f+"_ICON");if(t!=null)t.checked=false}if(a.getAttribute("checked")=="true")p=false}if(d<0)return;f=n._wzPrefixID+"_"+String(r)+"_"+String(d);a=document.getElementById(f);if(a==null)return;var l=document.getElementById(f+"_ICON"),m=document.getElementById(MakeID3(n,r,d));if(!p){a.setAttribute("enabled","true");a.disabled=false;a.optionDisabled=false;a.setAttribute("iconSrc",GetThemedImageUrl("DeleteFilterGlyph.png"));if(l!=null)l.src=GetThemedImageUrl("DeleteFilterGlyph.png");m!=null&&RemoveCssClassFromElement(m,"ms-core-menu-itemDisabled")}else{a.setAttribute("enabled","false");a.disabled=true;a.optionDisabled=true;a.setAttribute("iconSrc",GetThemedImageUrl("DisabledDeleteFilterGlyph.png"));if(l!=null)l.src=GetThemedImageUrl("DisabledDeleteFilterGlyph.png");m!=null&&Menu_AddCssClassToElement(m,"ms-core-menu-itemDisabled")}}function RefreshOpenedSortMenu(i,j){if(ctxFilter==null)return;var e="",d="",a=ctxFilter.queryString;if(a==null)a="";var k=new URI(a,{disableEncodingDecodingForLegacyCode:true});a="?"+k.getQuery();a=RemovePagingArgs(a);var f=filterTable.getAttribute("SortFields"),c=a.indexOf("&SortDir="),b=a.indexOf("&",c+1);if(c==-1){c=f.indexOf("&SortDir=");b=f.indexOf("&SortField=");e=a+f.substr(b,c-b)+"&SortDir=Asc";d=a+f.substr(b,c-b)+"&SortDir=Desc"}else if(c!=-1){e=a.substr(0,c)+"&SortDir=Asc";d=a.substr(0,c)+"&SortDir=Desc";if(b!=-1){e+=a.substr(b);d+=a.substr(b)}}e="HandleFilter(event, '"+STSScriptEncode(e)+"', 1);";d="HandleFilter(event, '"+STSScriptEncode(d)+"', 1);";var g=i._wzPrefixID+"_"+String(j)+"_"+String(0),h=document.getElementById(g);h.setAttribute("onMenuClick",e);g=i._wzPrefixID+"_"+String(j)+"_"+String(1);h=document.getElementById(g);h.setAttribute("onMenuClick",d)}reateMenuOption(o,j,c,y,C,E){var a=null,h,b,n,B,e,k,q,G=null,f,m,D,l,A,s,i,v,t,d,u,F=new MenuTag("span",null),x=new MenuTag("div",null);h=CreateMenuTag(x);b=CreateMenuTag(x);n=CreateMenuTag(F);B=CreateMenuTag(x);a=document.createElement("a");a.className="ms-core-menu-link";j.getAttribute("isindented")=="true"&&Menu_AddCssClassToElement(a,"ms-core-menu-indent");a.id=y+"_Anchor";a.appendChild(h);a.appendChild(b);a.appendChild(n);a.appendChild(B);a.href="javascript:;";a.setAttribute("onclick","return false;");if(o._fCompactItemsWithoutIcons&&null==c.getAttribute("iconSrc"))b.className="ms-core-menu-labelCompact";else b.className="ms-core-menu-label";b.id=c.id;if(c.getAttribute("enabled")=="false"){j.disabled=true;Menu_AddCssClassToElement(j,"ms-core-menu-itemDisabled");var p=document.createElement("span");p.appendChild(document.createTextNode(Strings.STS.L_DisabledMenuItem));p.className="ms-accessible ms-core-menu-disabledText";b.appendChild(p);a.setAttribute("aria-disabled","true")}e=EvalAttributeValue(c,"text","textScript");if(e==null||e==""){k=c.firstChild;if(k!=null&&k.nodeType==3)e=k.nodeValue}q=EvalAttributeValue(c,"description","descriptionScript");if(q!=null&&e!=null&&o._fLargeIconMode){f=document.createElement("span");f.className="ms-core-menu-title";m=document.createTextNode(e);D=document.createElement("br");l=document.createElement("span");A=document.createTextNode(q);l.className="ms-core-menu-itemDescription";b.appendChild(f);f.appendChild(m);b.appendChild(D);b.appendChild(l);l.appendChild(A)}else if(e!=null){f=document.createElement("span");f.className="ms-core-menu-title";s=c.getAttribute("hierarchy");if(s!=null){i=document.createElement("span");v=c.getAttribute("onExpand");v!=null&&i.setAttribute("onExpand",v);i.className="hierarchy";b.appendChild(i);i.innerHTML=s;b.appendChild(f);f.innerHTML=e}else{m=document.createTextNode(e);b.appendChild(f);f.appendChild(m)}}if(e!=null)a.title=e;t=document.createElement("span");t.innerHTML=Boolean(C)?C:"";b.appendChild(t);if(Boolean(o._fHideIcons))h.className="ms-hide";else if(o._fLargeIconMode)h.className="ms-core-menu-iconLarge";else h.className="ms-core-menu-icon";var w=null,g=null,r=false,z=false;if(c.getAttribute("checked")=="true"){z=true;r=true}else if(c.getAttribute("checked")=="false"&&(currentFilterMenu!=null&&currentFilterMenu.id=="filter_menu"||E))r=true;else{w=EvalAttributeValue(c,"iconSrc","iconScript");g=c.getAttribute("iconAltText")}if(r){d=document.createElement("INPUT");d.setAttribute("type","checkbox");z&&d.setAttribute("checked","yes");d.title=Boolean(g)?g:"";h.appendChild(d);d.id=y+"_ICON";d.setAttribute("style","padding-left:0px")}else if(Boolean(w)){d=document.createElement("img");d.src=w;d.alt=Boolean(g)?g:"";d.title=Boolean(g)?g:"";h.appendChild(d);d.id=y+"_ICON"}u=c.getAttribute("accessKeyText");if(null!=u)n.innerHTML=u;else n.className="ms-accessible";SetIType(j,"option");j.appendChild(a)}nction MergeAttributes(c,b){if(!browseris.nav&&typeof c.mergeAttributes!="undefined"&&c.mergeAttributes!=null)c.mergeAttributes(b);else{var d=b.attributes,f=0;if(typeof d.length!="undefined"&&d.length!=null)f=d.length;for(var e=0;e<f;e++){var a=d[e];a!=null&&a.specified&&a.nodeName!="id"&&a.nodeName!="ID"&&a.nodeName!="name"&&c.setAttribute(a.nodeName,a.nodeValue)}b.getAttribute("type")!=null&&c.setAttribute("type",b.getAttribute("type"));if(b.submenuRoot!=null)c.submenuRoot=b.submenuRoot}}Htc_html;MU_chDelim,MMU_chDelimEnc,MMU_postbackPrefix,MMU_chDelim2,MMU_chDelim2Enc;tion MHash_Keys(){return this._keys}MU_reDelimEnc,MMU_reDelim2Enc,MMU_reDelimDec,MMU_reDelim2Dec;function MMU_EncVal(a){return a.replace(MMU_reDelimDec,MMU_chDelimEnc).replace(MMU_reDelim2Dec,MMU_chDelim2Enc)}MU_HighlightedEcbTable,g_MMU_HighlightedEcbTableOpen,g_MMU_OpenTimeoutHandle;theFormActionAtPageLoad,g_MMU_Form0ActionAtPageLoad,g_MMU_Form0ActionAtPreMenuOpen;ar g_MMU_RequestTimeoutTimeoutHandle;r loadingMessageMenuItem;n NavigateToManageCopiesPage(a,b){STSNavigate(a+"/_layouts/15/managecopies.aspx?ItemUrl="+b+"&Source="+GetSource())}function AddVersionMenuItemsCore(b,c){if(currentItemID!=null){var f=currentItemID;if(f.indexOf(".0.")>=0)return}if(!HasRights(0,64))return;var a,e=itemTable.getAttribute("isCur"),h=itemTable.getAttribute("Level"),g=itemTable.getAttribute("canViewProperty");if(currentItemFSObjType==null)currentItemFSObjType=String(parseInt(GetAttributeFromItemTable(itemTable,"OType","FSObjType")));if(g!="0"){a=CAMOpt(b,Strings.STS.L_ViewVersion_Text,"javascript:ViewVersion()","");a.id="ID_ViewVersion"}if(HasRights(0,4)){a=CAMOpt(b,Strings.STS.L_RestoreVersion_Text,"javascript:RestoreVersion()","");a.id="ID_RestoreVersion"}if(HasRights(0,128)&&e!="1"){a=CAMOpt(b,Strings.STS.L_DeleteVersion_Text,"javascript:DeleteVersion()","");a.id="ID_DeleteVersion"}if(HasRights(0,16)&&HasRights(0,4))if((c.isModerated||c.EnableMinorVersions)&&currentItemFSObjType!="1"&&h==String(1)&&e=="1"){var d=Strings.STS.L_DenyVersion_Text;if(c.EnableMinorVersions)d=Strings.STS.L_UnPublishVersion_Text;a=CAMOpt(b,d,"javascript:TakeOfflineVersion()","");a.id="ID_TakeOfflineVersion"}}function ViewVersion(){if(!IsContextSet())return;STSNavigate(itemTable.getAttribute("verUrl"))}nction DeleteVersion(){if(!IsContextSet())return;var a=currentCtx;if(itemTable.getAttribute("isCur")!="0")alert(Strings.STS.L_Version_NoDelete_Current_ERR);else{var b=a.HttpPath+"&op=Delete&ver="+itemTable.getAttribute("verId");confirm(a.RecycleBinEnabled?Strings.STS.L_Version_Recycle_Confirm_Text:Strings.STS.L_Version_Delete_Confirm_Text)&&SubmitFormPost(b)}}function DeleteAllVersions(b,a){if(b<=1)alert(Strings.STS.L_Version_NoDeleteAll_None_ERR);else confirm(a.RecycleBinEnabled?Strings.STS.L_Version_RecycleAll_Confirm_Text:Strings.STS.L_Version_DeleteAll_Confirm_Text)&&SubmitFormPost(a.HttpPath+"&op=DeleteAll")}function DeleteAllMinorVersions(b,a){if(b<=1)alert(Strings.STS.L_Version_NoDeleteAll_None_ERR);else confirm(a.RecycleBinEnabled?Strings.STS.L_Version_RecycleAllMinor_Confirm_Text:Strings.STS.L_Version_DeleteAllMinor_Confirm_Text)&&SubmitFormPost(a.HttpPath+"&op=DeleteAllMinor")}r _spFullDownloadList;ction SPUpdatePage(a){if("undefined"==typeof g_MinimalDownload||!g_MinimalDownload||IsAccessibilityFeatureEnabled())return true;a=GetAbsoluteUrl(a);if(browseris.ie&&browseris.iever<10){var n=a.indexOf("?");if(-1==n)n=a.length;var m=a.indexOf("#");if(-1==m)m=a.length;var w=Math.min(n,m);a=encodeURI(decodeURI(a.substr(0,w)))+a.substr(w)}var c=true,v="/_layouts/15/start.aspx",o=v.length,u=window.location.pathname,r=u.length,b=a.indexOf("#");if(-1!=b){var q=a.substr(0,b).toLowerCase().indexOf("/_layouts/15/start.aspx");if(-1!=q)if(a.length>b+2&&"/"==a[b+1])if(a.length>b+3&&"/"==a[b+2])a=a.substr(b+2);else a=a.substr(0,q)+a.substr(b+1)}if(r>=o&&v==u.substr(r-o))if(a.charAt(0)=="/"){if(!IsFailoverTarget(GetTargetHandler(a))){ajaxNavigate.update(a);c=false}}else{if(a.indexOf("/")==-1){var f=ajaxNavigate.get_href(),t=f.indexOf("?");if(t!=-1)f=f.substr(0,t);var p=f.lastIndexOf("/");if(p!=-1)a=f.substr(0,p+1)+a}var g=a.indexOf("//");if(-1!=g){var j=a.indexOf("/",g+2);if(-1!=j){var e=a.substr(g+2,j-(g+2)),i="",l=e.indexOf(":");if(-1!=l){i=e.substr(l+1);if(i=="80")i="";e=e.substr(0,l)}if(window.location.hostname==e&&window.location.port==i)if(!IsFailoverTarget(GetTargetHandler(a.substr(j)))){ajaxNavigate.update(a.substr(j));c=false}}else if(window.location.hostname==a.substr(g+2)){ajaxNavigate.update("");c=false}}else c=true}else if("undefined"!==typeof g_WebServerRelativeUrl){var k=document.createElement("a");k.href=a;a=k.href;k.href=g_WebServerRelativeUrl;var h=k.href;if(a.length>=h.length&&h.toLowerCase()==a.substr(0,h.length).toLowerCase()){var d=h;if("/"==d[d.length-1])d+="/_layouts/15/start.aspx".substr(1);else d+="/_layouts/15/start.aspx";if(!IsFailoverTarget(GetTargetHandler(GetServerRelativeUrlFromURL(a)))){d+="#/"+GetServerRelativeUrlFromURL(a);window.location.href=d;c=false}}}if(!c){g_MDNav=false;var s=window.event;s!=null&&cancelDefault(s)}return c}NotificationId;function LaunchAppInternal(c,d,e,b,f){var g=_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,a=escapeUrlForCallback(g)+"/_layouts/15/appredirect.aspx";if(typeof d!="undefined"&&d!=null&&typeof e!="undefined"&&e!=null)a+="?client_id="+escapeProperly(d)+"&redirect_uri="+escapeProperly(e);else if(typeof c!="undefined"&&c!=null)a+="?instance_id="+escapeProperly(c);else throw"appOAuthId, launchUrl, appInstanceId are null";if(f)a+="&tsapp=1";if(typeof b!="undefined"&&b!=null)SetupAndOpenDialogForCustomAction(a,b.width,b.height,b.title);else window.location.href=a}var _tenantAppData;function GetTenantAppData(){var b=_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl;if(_tenantAppData!=null)return _tenantAppData;if(_spPageContextInfo.tenantAppVersion=="none"){_tenantAppData={isCorpSite:false,apps:[]};return _tenantAppData}var a=new XMLHttpRequest;a.open("GET",escapeUrlForCallback(b)+"/_layouts/15/tenantappinfo.ashx?etag="+escapeProperly(String(_spPageContextInfo.tenantAppVersion))+"&lcid="+escapeProperly(""+String(_spPageContextInfo.currentLanguage)),false);a.send("");if(a.status<400&&a.getResponseHeader("Content-Type").indexOf("application/json")!=-1)try{_tenantAppData=JSON.parse(a.responseText)}catch(c){}return _tenantAppData}$_global_core();