"use strict";(self.webpackChunkWPS_Drive=self.webpackChunkWPS_Drive||[]).push([[1627],{41478:function(t,e,n){n.r(e),n.d(e,{SettingComp:function(){return I},createInstance:function(){return Z},hasPermission:);var r=n(18487),i=n(56451),s=n(37311),c=n(2406),a=n.n(c),o=n(95272),u=n(423),p=n(45821),d=n(28152),l=n.n(d),m=n(75326),f=n(47189),h=function(t){return t.then(().catch(()},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.keys(e).map(().join("&"),r="".concat(u.V1).concat(t,"?").concat(n);window.open(r,"front_end")},w={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"k-company-admin-doc-setting-item"},[n("div",{staticClass:"k-company-admin-doc-setting-item-left"},[t._t("left",[t._v(t._s(t.title))])],2),t._v(" "),n("div",{staticClass:"k-company-admin-doc-setting-item-right"},[t._t("right",[n("KdSwitch",{attrs:{value:t.switchValue},nativeOn:{click:function(e){return t.switchClick(e)}}})])],2)])},staticRenderFns:[],components:{KdSwitch:l()},props:{switchValue:{type:Boolean,default:!1},title:{type:String,default:""}},methods:{switchClick:function(){this.$emit("switchClick")}}},g=(0,m.Z)({baseURL:u.UX,withCredentials:!0}),k=function(){var t=(0,s.Z)(a().mark((function t(e,n,r){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,f.B3M)({comp_id:e,user_id:n,permissions:[r]});case 2:return i=t.sent,t.abrupt("return",!!i&&!!i.is_has);case 4:case"end":return t.stop()}}),t)})));return (),y=function(){var t=(0,s.Z)(a().mark((function t(e){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.get("/drive/v1/adm/companies/".concat(e,"/links/ranges"));case 2:return n=t.sent,t.abrupt("return","anyone"!==n.data.range.value);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var _=function(){var t=(0,s.Z)(a().mark((function t(e,n){var r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=["file_strategy.settings.general.all.spreadctrl.edit","links.settings.ranges.view","company.document.watermark.settings"].map(function(){var t=(0,s.Z)(a().mark((function t(r){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,f.B3M)({comp_id:e,user_id:n,permissions:[r]});case 2:return i=t.sent,t.abrupt("return",!!i&&!!i.is_has);case 4:case"end":return t.stop()}}),t)})));return ()),t.next=4,Promise.all(r);case 4:return i=t.sent,t.abrupt("return",i.some(());case 6:case"end":return t.stop()}}),t)})));return (),b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("Item",{attrs:{switchValue:t.value,title:t.t("title")},on:{switchClick:t.switchClick}}):t._e()},staticRenderFns:[],components:{Item:w},props:{companyId:{type:Number,required:!0},userId:{type:Number,required:!0}},data:function(){return{value:!1,show:!1}},created:function(){this.init()},methods:{init:function(){var t=this;return(0,s.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkPermission();case 2:if(t.show){e.next=5;break}return t.$emit("noPermission"),e.abrupt("return");case 5:t.getShareSetting();case 6:case"end":return e.stop()}}),e)})))()},getShareSetting:function(){var t=this;return(0,s.Z)(a().mark((function e(){var n,r,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(y(t.companyId));case 2:if(n=e.sent,r=(0,i.Z)(n,2),s=r[0],c=r[1],!s){e.next=8;break}return e.abrupt("return");case 8:t.value=c;case 9:case"end":return e.stop()}}),e)})))()},checkPermission:function(){var t=this;return(0,s.Z)(a().mark((function e(){var n,r,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(k(t.companyId,t.userId,"links.settings.ranges.view"));case 2:if(n=e.sent,r=(0,i.Z)(n,2),s=r[0],c=r[1],!s){e.next=8;break}return e.abrupt("return");case 8:t.show=c;case 9:case"end":return e.stop()}}),e)})))()},t:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return p.t.apply(void 0,["logic.CompanyAdminDocSettings.shareOutside."+t].concat(n))},switchClick:function(){this.$emit("report","ban_share"),v("/base/securityctl/securitydoc",{action:"clickShareOutside"}),this.$emit("close")}}},x={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("Item",{attrs:{switchValue:t.value,title:t.t("title")},on:{switchClick:t.switchClick}}):t._e()},staticRenderFns:[],components:{Item:w},props:{companyId:{type:Number,required:!0},userId:{type:Number,required:!0}},data:function(){return{value:!1,show:!1}},created:function(){this.init()},methods:{init:function(){var t=this;return(0,s.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkPermission();case 2:if(t.show){e.next=5;break}return t.$emit("noPermission"),e.abrupt("return");case 5:t.getSetting();case 6:case"end":return e.stop()}}),e)})))()},getSetting:function(){var t=this;return(0,s.Z)(a().mark((function e(){var n,r,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h((a=t.companyId,o=void 0,o={company_id:a},g.get("/drive/v1/user/companies/file/strategy/spread/control",{params:o}).then(()));case 2:if(n=e.sent,r=(0,i.Z)(n,2),s=r[0],c=r[1],!s){e.next=8;break}return e.abrupt("return");case 8:t.value=c;case 9:case"end":return e.stop()}var a,o}),e)})))()},checkPermission:function(){var t=this;return(0,s.Z)(a().mark((function e(){var n,r,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(k(t.companyId,t.userId,"file_strategy.settings.general.all.spreadctrl.edit"));case 2:if(n=e.sent,r=(0,i.Z)(n,2),s=r[0],c=r[1],!s){e.next=8;break}return e.abrupt("return");case 8:t.show=c;case 9:case"end":return e.stop()}}),e)})))()},t:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return p.t.apply(void 0,["logic.CompanyAdminDocSettings.fileOutside."+t].concat(n))},switchClick:function(){this.$emit("report","ban_transfer"),v("/base/securityctl/securitydoc",{action:"clickFileOutside"}),this.$emit("close")}}},C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("Item",{staticClass:"k-company-admin-doc-setting-watermark",attrs:{switchValue:t.value,title:t.t("title")},on:{switchClick:t.clickHandler},scopedSlots:t._u([{key:"right",fn:function(){return[n("span",{staticClass:"btn",on:{click:t.clickHandler}},[t._v(t._s(t.t("setting")))])]},proxy:!0}],null,!1,279698373)}):t._e()},staticRenderFns:[],components:{Item:w},props:{companyId:{type:Number,required:!0},userId:{type:Number,required:!0}},data:created:methods:{t:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return p.t.apply(void 0,["logic.CompanyAdminDocSettings.showWatermark."+t].concat(n))},init:function(){var t=this;return(0,s.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkPermission();case 2:if(t.show){e.next=5;break}return t.$emit("noPermission"),e.abrupt("return");case 5:case"end":return e.stop()}}),e)})))()},checkPermission:function(){var t=this;return(0,s.Z)(a().mark((function e(){var n,r,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(k(t.companyId,t.userId,"company.document.watermark.settings"));case 2:if(n=e.sent,r=(0,i.Z)(n,2),s=r[0],c=r[1],!s){e.next=8;break}return e.abrupt("return");case 8:t.show=c;case 9:case"end":return e.stop()}}),e)})))()},clickHandler:function(){this.$emit("report","watermark_setting"),v("/base/securityctl/watermark",{}),this.$emit("close")}}},I={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"k-admin-func-doc-settings"},[t.loading?n("KLoading"):[n("div",[t._v(t._s(t.t("desc")))]),t._v(" "),n("div",{staticClass:"settings-container"},[t.hasContent?t._l(t.compList,(function(e,r){return n(e.comp,{key:r,tag:"component",attrs:{companyId:t.companyId,userId:t.userId},on:{report:t.report,noPermission:close:t.close}})})):[n("div",{staticClass:"empty"},[t._v("\n          "+t._s(t.t("noPermission"))+"\n        ")])]],2)]],2)},staticRenderFns:[],name:"KCompanyAdminDocSettings",components:{KLoading:o.Z,ForbidShareDocOutside:b,ForbidFileDocOutside:x,ShowWatermark:C},props:{onDwEvent:{type:Function,default:required:!1},companyId:{required:!0,type:Number},userId:{type:Number,required:!0},source:{type:String,default:"docsWeb",require:!0}},data:function(){return{loading:!1,compList:[{comp:b,show:!0},{comp:x,show:!0},{comp:C,show:!0}]}},computed:{hasContent:isPC:,methods:{handleNoPermission:function(t){this.compList[t].show=!1,this.compList.every(()},init:function(){var t=this;return(0,s.Z)(a().mark((function e(){var n,r,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,n=[],e.next=4,h(Promise.all(n));case 4:r=e.sent,s=(0,i.Z)(r,1),c=s[0],t.loading=!1,c&&(t.$emit("onLoadError",c),t.onLoadError&&t.onLoadError(c));case 9:case"end":return e.stop()}}),e)})))()},t:customDialogClose:function(t){this.report("close"),t()},close:report:,created:install:,S={},Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.title,n=void 0===e?(0,p.t)("logic.CompanyAdminDocSettings.dialog.title"):e,i=t.width,s=void 0===i?"400px":i,c=t.closeOnClickModal,a=void 0!==c&&c,o=(0,r.Z)({entry:I,pages:[{title:n,className:"k-dialog-page-company-doc-settings",width:s,body:I,footer:null,closeOnClickModal:a,useNewLayout:!0,customClose:!0}]});return o.dw=S,o},P=Z();e.default=P}}]);
