(function(window) {
	try {
		window.BAMX = window.BAMX || {};
		window.BAMX.GLOBALS = window.BAMX.GLOBALS || {
			LOADED: {},
			PROMISE: {},
			AUCTION_MAP: {},
			BAM_BOX: {}
		};

		var CONTAINED_BAMX_OBJ = {
			IS_IFRAME: window.BAMX.IS_IFRAME,
			DEBUG_MODE: false,
			ENV: 'release',
			GITHASH: '3882f88e1f2ec7e873f747349d3921096a78c65c',
			CORE_CONFIG: {
				isPreview: false
			}
		};

		/* Preview mode can be turned on if isPreview is set to true
		 * in the BAMX window object.
		 */
		if (window.BAMX.CORE_CONFIG && window.BAMX.CORE_CONFIG.isPreview) {
			CONTAINED_BAMX_OBJ.CORE_CONFIG.isPreview = window.BAMX.CORE_CONFIG.isPreview;
		}
		window.BAMX.CORE_CONFIG = CONTAINED_BAMX_OBJ.CORE_CONFIG;

		// Prevent amd from causing Bluebird to try and load using amd
		if (typeof(window.define) === 'function' && window.define.amd) {
			window._bamDefine = window.define;
			window.define = null;
		}

		"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}unction _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _get=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();!,"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),Array.from||(Array.from=)),"function"!=typeof Object.assign&&(Object.assign=,String.prototype.contains=String.prototype.contains||String.prototype.includes||(String.prototype.includes=,String.prototype.startsWith=String.prototype.startsWith||String.prototype.endsWith=String.prototype.endsWith||Array.prototype.find||(Array.prototype.find=,Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.some||(Array.prototype.some=,window,document,CONTAINED_BAMX_OBJ),window,CONTAINED_BAMX_OBJ),window,CONTAINED_BAMX_OBJ),window,document,CONTAINED_BAMX_OBJ),window,document,CONTAINED_BAMX_OBJ),window,CONTAINED_BAMX_OBJ),window,CONTAINED_BAMX_OBJ),window,CONTAINED_BAMX_OBJ),window,document,CONTAINED_BAMX_OBJ);!);"use strict";_slicedToArray=),_get=_createClass=);!window,CONTAINED_BAMX_OBJ),(window,document,CONTAINED_BAMX_OBJ),function(t,e,i){var r=function(r){function n(t,e,r){_classCallCheck(this,n);var a=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return a.config=t||a.constructor.config,e=e||i.DataLayer,a.dataLayer=new e,a.components=new Map,r&&(r=i.lib.getClass(r),a.componentConfig=new r),a.localStorageCheckoutKey="bamx_trigger_checkout",a.localStorageClickIdKey="nrtv_cids",a.elementSelector="body",a.currentPageClickId=null,a.previousPageClickId=null,a.isLanding=!1,a}return _inherits(n,r),_createClass(n,[{key:"getOrganizationId",value:function(){return this.config.merch_id}},{key:"getElement",value:function(){return e.querySelector(this.elementSelector)}},{key:"getCurrentUrl",value:function(){return t.location.href}},{key:"getCheckoutsFired",value},{key:"setCheckoutsFired",value},{key:"parseClickIdFromUrl",value},{key:"validateCid",value},{key:"getClickIdFromURL",value:function(){var t=this.getClickIdFromCurrentUrl(),e=!1;if(t?this.currentPageClickId=t:(t=this.getClickIdFromPreviousUrl(),e=!!t),t&&".nrtv_plchldr."!==t)if(this.getClickIdsFromLocalStorage()){var r=this.getClickIdsFromLocalStorage();r.includes(t)||(r.push(t),e&&(this.previousPageClickId=t)),r.length>1e4&&r.splice(0,1),this.setClickIds(r)}else i.lib.localStorage.setItem(this.localStorageClickIdKey,t)}},{key:"getClickIdsFromLocalStorage",value},{key:"setClickIds",value},{key:"getClickIdFromCurrentUrl",value:function(){var e=new URL(t.location.href);return this.validateCid(e.searchParams.get("nrtv_cid"))||this.parseClickIdFromUrl(decodeURIComponent(t.location.href))}},{key:"getClickIdFromPreviousUrl",value:function(){var t=void 0,e=i.lib.getReferer();if(e){var r=new URL(e);t=this.validateCid(r.searchParams.get("nrtv_cid"))||this.parseClickIdFromUrl(decodeURIComponent(e))}return t}},{key:"checkLandingReferrer",value:function(){var t=i.lib.getReferer();t&&(this.isLanding=t.includes("narrativ.com"))}},{key:"triggerEvent",value:function(t,e,r){var n=this,a=!1,o=null;this.currentPageClickId?o=this.currentPageClickId:this.previousPageClickId&&(o=this.previousPageClickId,a=!0);var s=!(!o&&!this.isLanding);if(!o){var l=this.getClickIdsFromLocalStorage();l&&l.length>0&&(o=l[l.length-1])}var u=this.getOrganizationId(),c=this.getOrganizationType();return this.getEventPayload(t,e).then(function(l){return"page_impression"===e&&o&&(l.user.cids=o,l.user.is_landing=s,a&&(l.user.cid_from_referrer=a)),l.events.push(r),"page_impression"===e&&s&&n.sendImpressionsToInngest(l,u),i.core.triggerEvent(t,e,l,c,u)})}},{key:"sendImpressionsToInngest",value:function(t,e){var r=Object.assign({},t);return r.branch="test"===i.ENV?"preview":"main",r.merchant_id=e,fetch("https://inn.gs/e/GtiBJxrO2V2MLP2mlTYk6e9ltTKshf_oDCvm7MwSjksbaToHlbBGSw7El1js7UUITicQ_3FC7oTuco7YTF1TdQ",{method:"POST",body:JSON.stringify({data:r})})}},{key:"getIpOrFingerprint",value:function(){return Promise.any([new Promise(function(t,e){return fetch("https://howl-partners.vercel.app/api/fp").then(function(t){return t.json()}).then(function(i){i&&i.fp?t({ip:"",fp:i.fp}):e("api/fp not found")}).catch(function(t){return e(t)})}),new Promise(function(t,e){return fetch("https://events.release.narrativ.com/ip").then(function(t){return t.json()}).then(function(i){i&&i.ip?t({ip:i.ip,fp:""}):e("events.release.narrativ not found")}).catch(function(t){return e(t)})}),new Promise(function(t,e){return fetch("https://api.ipify.org/?format=json").then(function(t){return t.json()}).then(function(i){i&&i.ip?t({ip:i.ip,fp:""}):e("ipify not found")}).catch(function(t){return e(t)})})])}},{key:"sendToNext",value:function(t,e){var r=e;r.branch="test"===i.ENV?"preview":"main";try{Promise.allSettled([this.nextToInngest(t,r)])}catch(t){console.error("sendToNext error",t)}}},{key:"nextToInngest",value:function(t,e){var i=this;return new Promise(function(r,n){i.getIpOrFingerprint().then(function(i){return i&&i.ip&&(e.ip=i.ip),i&&i.fp&&(e.fp=i.fp),fetch("https://inn.gs/e/W4FRV_AXbn34mZO01ZIAFrr6A24BjEGVPBO2x-gTnTio23BIQ9jDyaWYQC5Jg-BDTkVSN7zxykgu3yjuMr3z2g",{method:"POST",body:JSON.stringify({id:"checkout.created-"+t,data:e})})}).then).then(function(t){r(t)}).catch)})}},{key:"triggerCheckoutEvent",value:function(){var t=this,e=this.getOrganizationId()+"-"+this.dataLayer.getOrderId();if(this.getCheckoutsFired()[e])return void console.warn("Suppressing duplicate checkout event for key: "+e);var i=this.dataLayer.getCheckoutEventData();return this.triggerInteractionEvent("checkout",i).then(function(){var r={merchant_id:t.getOrganizationId(),checkoutData:i};t.sendToNext(e,r),t.setCheckoutsFired(e)})}},{key:"onWidgetLoad",value:function(){this.addListeners(),this.addElementViewer(),this.checkLandingReferrer(),this.getClickIdFromURL(),this.triggerPageImpression(),this.LOADED=!0,this.location=this.getCurrentUrl()}},{key:"onDomLoad",value:function(){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"onDomLoad",this).call(this),t.BAMX_EVENT_DATA||(t.BAMX_EVENT_DATA={}),this.dataLayer.shouldTriggerCheckout()&&this.triggerCheckoutEvent(),this.checkForComponents()}},{key:"onDomMutation",value:function(){this.checkForComponents()}},{key:"instantiateComponents",value},{key:"checkForComponents",value},{key:"run",value}]),n}(i.MerchantWidget);i.MerchantJsTag=r,i.lib.setClass("MerchantJsTag",i.MerchantJsTag)}(window,document,CONTAINED_BAMX_OBJ)(window,CONTAINED_BAMX_OBJ)(window,CONTAINED_BAMX_OBJ)(window,CONTAINED_BAMX_OBJ)(window,CONTAINED_BAMX_OBJ)(window,CONTAINED_BAMX_OBJ);"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}();!function(t,e){var a=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"getPurchasedProductData",value:function(t){var e=this.getPurchasedProduct(t),a=this.parsePrice(e.product_price),r=this.parseQuantity(e.product_quantity),s=a/r;return{quantity:this.formatField(r,1e4),price:this.parsePrice(s),currency:this.formatField(this.getCurrency(),3),id:this.formatField(e.product_id?e.product_id.toString():null,255),name:this.formatField(this.optional(e.product_name),255),brand:this.formatField(this.optional(e.product_brand),255),image_url:this.formatField(this.optional(e.product_image),2048),size:this.formatField(this.optional(e.product_size),20),color:this.formatField(this.optional(e.product_color),20)}}}]),e}(e.DataLayer);e.lib.setClass("UltaDataLayer",a)}(window,CONTAINED_BAMX_OBJ),function(t,e){var a={merchant:{is_active:!0,merchant_type:2,deduct_returns:!1,is_pilot:!1,cpc_fee_rate:null,widget_options:{amp:!1,linkmate:!1,enable_verbose_logging:!1},goal_take_rate:null,subscription_info:{sub_tier:"free",sub_end_date:1685127663,sub_amount_usd:0,sub_start_date:1685127663,sub_gmv_capacity:0,sub_payment_frequency:"quarterly"},logo_url:"https://static.bam-x.com/assets/logos/merchants/ultabeauty.png",epp_fee_rate:null,merch_id:1158,show_in_dashboard:!0,url:"http://www.ulta.com/",commission_rate:null,is_feed_importer_enabled:!0,pricing_model:"EPP",full_name:"Ulta Beauty",expected_import_frequency:36,fee_model:null,slug:"ultabeauty",cover_image_url:"https://static.bam-x.com/assets/cover_images/merchants/ultabeauty.jpeg",short_name:"Ulta Beauty",ssu_config:{ssu_title:"Earn with Ulta Beauty on Howl",ssu_subtitle:"Join now in time for 21 Days of Beauty",ssu_bullet_points:["Earn commission on all products","Get exclusive  access to promotions and launches","Easily track your performance and get paid with Howl"],ssu_logo_image_url:"https://static.bam-x.com/assets/ssu_logos/merchants/ultabeauty.png",ssu_header_image_url:"https://static.bam-x.com/assets/ssu_header_images/merchants/ultabeauty.jpeg"}},publisher:null,slug:"ultabeauty",merch_id:1158,dataLayerClass:"UltaDataLayer"};new(e.lib.getClass("JsTagLib"))(a).run()}(window,CONTAINED_BAMX_OBJ);

		if (window._bamDefine) {
			window.define = window._bamDefine;
		}

		window.BAMX.VERSION = window.BAMX.VERSION || {};
		window.BAMX.VERSION['3882f88e1f2ec7e873f747349d3921096a78c65c'] = CONTAINED_BAMX_OBJ;
		window.BAMX.GITHASH = '3882f88e1f2ec7e873f747349d3921096a78c65c';
		window.BAMX.get =;
	} catch (e) {
		try {
			if (CONTAINED_BAMX_OBJ.DEBUG) {
				console.error(e);
			}

		} catch (e2) {}
	}

})(window);
