(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[578],{"5FTO":function(e,t,i){},"6oTH":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=new Map([["mru","Recent"],["unpinned-mru","Recent"],["pinned-mru","Pinned"],["shared-mru","Shared"],["trending-docs","Trending"],["classNotebook-mru","ClassNotebooks"],["app-items-mru","AppItems"],["app-items-forms","AppItems"],["app-items-deleted","Other"],["groupItemsForms","AppItems"],["groupItemsFormsDeleted","Other"]])},ALB0:GHXR:function(e,t,i){"use strict";i.r(t),i.d(t,"MruModuleNgFactory",(function(){return wt}));var n=i("keVe"),a=i("QjXU"),r=i("laSs"),s=i("UAwW"),o=i("3Vsh"),l=i("lrJm"),c=i("dOgD"),u=i("dx17"),h=i("Ry9Z"),d=i("+YV+"),p=i("rmEM"),m=i("1ygu"),b=i("CC5A"),f=i("hhzZ"),S=i("BaAg"),v=i("p6Zr"),g=i("Eu1D"),T=i("6oTH"),y=i("2lMP"),M=i("L/Tc"),w=i("QOOv"),I=i("JT1q"),A=i("7Rc8"),C=i("fKR7"),L=i("7wk3"),D=i("AXqk"),E=i("W3Zz"),x=i("hZW2"),R=i("7Gwk"),k=i("rBEp"),F=i("Z0U4"),N=i("Dpxn"),O=i("v3sZ"),P=i("p6gk"),U=i("EqbI"),V=i("Uqr9"),W=i("6GOa"),_=i("w1PR"),z=i("BJbw"),j=i("gO/A"),B=i("4/We"),H=i("cgnd"),G=i("/I02"),q=i("PBJH"),Z=i("JH4S"),K=i("ZBli"),J=i("JScD"),X=i("9MHL"),Q=i("rBrS"),Y=i("TDzr"),$=function(){function e(t){for(var i,n=[],a=[],r=0;r<t.length;r++){var s=t[r];s.isPinned?n.push(s):a.push(s)}this.documents=((i={})[e.PinnedStateKey]=n,i[e.UnpinnedStateKey]=a,i[e.AllCategoryKey]=t,i)}return e.prototype.getAllPinnedDocuments=function(){return this.documents[e.PinnedStateKey]||[]},e.prototype.getAllUnpinnedDocuments=function(){return this.documents[e.UnpinnedStateKey]||[]},e.prototype.getAllDocuments=function(){return this.documents[e.AllCategoryKey]||[]},e.prototype.removeItem=function(e){var t=e.isPinned?this.getAllPinnedDocuments():this.getAllUnpinnedDocuments();this.deleteItemFromList(t,e),this.deleteItemFromList(this.getAllDocuments(),e)},e.prototype.addItem=function(e){var t=e.isPinned?this.getAllPinnedDocuments():this.getAllUnpinnedDocuments();this.addItemToList(t,e),this.addItemToList(this.getAllDocuments(),e)},e.prototype.deleteItemFromList=function(e,t){if(e)for(var i=0;i<e.length;i++)if(e[i].id===t.id)return void e.splice(i,1)},e.prototype.addItemToList=function(e,t){if(e){for(var i=0;i<e.length;i++)if(e[i].lastViewedTime<=t.lastViewedTime)return void e.splice(i,0,t);e.push(t)}},e.AllCategoryKey="all",e.PinnedStateKey="pinned",e.UnpinnedStateKey="unpinned",e}(),ee=i("3GGT"),te=i("R7NL"),ie=i("OyI4"),ne=i("kpuN"),ae=i("wwmn"),re=i("casz"),se=i("ZtId"),oe=i("pOWU"),le=i("oAX+"),ce=i("TOqr"),ue=function(e){function t(i,n,a,r,s,o,l,c,u,h,d){var p=e.call(this,i,n,a,r,s,o,l,c,u,o.config.sharedWithMeV2Enabled?"docs/v2.0/sharedwithme":"docs/sharedwithme",o.config.supportedFileTypesSwM,d)||this;return p.updateContentService=h,p.mruConfig=o.config,p.sharingTypeParam=p.mruConfig.sharedWithMeV2Enabled&&!p.mruConfig.sharedAttachmentsEnabled?t.sharingSpecifier:"",p.sharedDocsDataStreamMap=new Map,p}return Object(a.__extends)(t,e),t.prototype.getSharedDocuments=function(e,t){var i=this,n=this.serviceBaseUrl+"?"+this.requestParams(e,t)+this.sharingTypeParam;if(this.sharedDocsDataStreamMap.has(n))return this.sharedDocsDataStreamMap.get(n);var a=this.updateContentService.getOrAddUpdateStream("sharedwithme-"+n,(),r=this.fetchSharedData(n,"cache-only"),s=this.fetchSharedData(n,"network-first"),o=le.a.createResultsWithCacheObservable(r,s,a,();return this.sharedDocsDataStreamMap.set(n,o),o},t.prototype.handleQueryParam=function(e,t,i){"mocksharedwithme"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)},t.prototype.fetchSharedData=function(e,t){var i=this;return new Promise((function(n,a){var r=i.mruConfig.sharedWithMeV2Enabled?"2":"1";i.get("Shared_With_Me_Request","Shared_With_Me",e,(function(e){e.instrument((function(e,t){t.RequestId=i.getRequestIdFromResponse(e),e.ok&&(t.SharedWithMeVersion=r,e.data&&e.data.shared_documents?t.ActualSize=e.data.shared_documents.length.toString():t.HttpCode=ee.a.UnexpectedResponse.toString())})).then((function(e){e.ok&&e.data&&e.data.shared_documents?(e.data.shared_documents.sort((),n({items:e.data.shared_documents,fromCache:e.fromCache})):a(new oe.b(e,"No data returned"))})).catch((function(e){i.globalErrorHandler.handleError(e,"sMMaG")}))}),a,i.getNewRequestConfig(!1),t)}))},t.sharingSpecifier="&sharingTypes=ShareFlow",t.Éµprov=n.kc({factory:function(){return new t(n.lc(ne.b),n.lc(f.a),n.lc(te.a),n.lc(G.a),n.lc(ae.a),n.lc(w.a),n.lc(ce.q),n.lc(l.b),n.lc(H.b),n.lc(se.a),n.lc(re.a))},token:t,providedIn:"root"}),t}(ie.a),he=function(){function e(e,t,i,a,r,s,o,l,c,u,h,d,p,m,b,f,S,v,g,T,y,M,w,I,A,C,L,D,E,x,R,k,F,N,O){this.capabilitiesService=e,this.changeDetector=t,this.clientStartupConfigService=i,this.contextService=a,this.dataSecurityService=r,this.deviceDetector=s,this.documentService=o,this.eventService=l,this.formsService=c,this.instrumentationService=u,this.jumpListService=h,this.locService=d,this.mruConfigService=p,this.officeFeedService=m,this.onenoteGraphService=b,this.oneNoteService=f,this.onNoteConfigService=S,this.performanceService=v,this.mruDataService=g,this.sharedWithMeService=T,this.activatedRoute=y,this.globalErrorHandler=M,this.userContextService=w,this.uploadConfigService=I,this.activityDescriptionService=A,this.officeRouteService=C,this.swayServiceConfigService=L,this.analyticsService=D,this.browserPaintMeasurementService=E,this.urlAuthenticatorService=x,this.oneDriveUploadService=R,this.createMenuService=k,this.oneDriveService=F,this.themingService=N,this.visualService=O,this.numLoggableItems=0,this.isVisualRefresh=!1,this.emptyViewName="empty-view",this.tabImpressionIndex=0,this.isFormsApp=!1,this.stateChanged=new n.q,this.listAnimation=this.capabilitiesService.capabilities.disableAnimation?"None":"FadeAndScale"}return e.prototype.ngOnInit=function(){var t=this;y.a.isFirstClick=!0,this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.isFormsApp=this.fileType===S.b.Forms,this.showInCardView=this.isFormsApp,this.filterEnabled=this.isFormsApp,this.onFilter=this.onFilter.bind(this),this.defaultView=this.isFormsApp?"Card":"List";var i=this.capabilitiesService.capabilities;this.stateChanged.emit({state:g.a.Loading}),this.componentArea=f.b.Documents,this.recentSectionLandmarkAriaLabel=this.locService.RecentDocumentsLandmarkAriaLabel,this.themed=this.userContextService.user.themed,this.mruConfig=this.mruConfigService.config,this.pinnedDocsEnabled=this.mruConfig.mruPinEnabled,this.selectedTab=0,this.tileViewEnabled=this.mruConfig.tileViewEnabled||this.isFormsApp,this.trendingDocsEnabled=this.mruConfig.trendingAroundMeEnabled&&this.fileType!==S.b.Sway&&!this.isFormsApp,this.mobile=!this.deviceDetector.isDesktopDevice(),this.appFilter=this.fileType?new Set([this.fileType]):null,this.appSuffix=this.fileType?"-"+S.b[this.fileType].toLowerCase():"",this.maxInitialDocumentCards=this.maxInitialDocs||2*e.maxCardsPerLine,this.maxInitialDocuments=this.maxInitialDocs||this.mruConfig.maxInitialListItems,this.maxTotalDocuments=this.maxTotalDocs||this.mruConfig.maxTotalListItems,this.showAnalytics=this.mruConfig.analyticsEnabled&&this.fileType===S.b.Sway,this.showActivity=!this.showAnalytics&&this.mruConfig.activityEnabled&&this.fileType!==S.b.OneNote&&!this.isFormsApp,this.showSharing=!this.showAnalytics&&this.mruConfig.sharingStatusEnabled&&!this.isFormsApp,this.showMobileShareAndActivity=this.mruConfig.mobileShareAndActivityEnabled,this.isConsumer=this.clientStartupConfigService.config.authType===H.a.MSA,this.newMruEmptyStateEnabled=this.isConsumer&&this.capabilitiesService.capabilities.newMruEmptyStateEnabled,this.sharedWithMeViewEnabled=this.mruConfig.sharedWithMeViewEnabled&&this.fileType!==S.b.Sway&&!(this.isConsumer&&this.isFormsApp),this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe())),this.capabilitiesService.capabilities.visualBackgroundEnabled&&(this.visualRefreshSubscription=this.visualService.visualConfigSubscription.subscribe())),i.oneDriveUploadEnabled&&this.uploadConfigService.config&&this.fileType!==S.b.Sway&&this.fileType!==S.b.OneNote&&!this.isFormsApp&&this.oneDriveUploadService.uploadEnabledPromise.then((function(e){return t.uploadEnabled=e})),this.createMenuService.createButtonEnabledPromise.then()),this.routeSubscription=this.officeRouteService.subscribeToRouteChangeEnd((function(e){if(e.currentRoute){var i=e.currentRoute.route,n=e.previousRoute?e.previousRoute.route:null;("Templates"===n&&"Start"===i||null!==n&&"OfficeHome"===i)&&(t.listAnimation="None"),("Content"===n||t.isFormsApp&&("MyForms"===n||"GroupForms"===n))&&t.mruDataService.updateMruDocuments(t.appFilter)}})),this.recentTabListModel=new b.b({id:this.isFormsApp?Q.a.FormsTabList:Q.a.Recent,area:this.componentArea,tabs:[],logImpression:this.logTabImpression.bind(this),headerText:this.title,tabActivationAriaLabel:this.locService.MruTabActivationAriaLabel}),this.recentMruStreamData||(this.recentMruStreamData=this.mruDataService.getMruDocuments(this.appFilter)),this.recentMruStream=this.recentMruStreamData.results.subscribe((function(e){return t.processRecentMruTask(e)})),this.recentMruStreamData.initialCompletion.then((function(e){e&&(t.globalErrorHandler.handleCacheObservableError(e,"jM9a5","al4U3"),t.recentTab||t.stateChanged.emit({state:g.a.Failed}))}));var n=this.recentMruStreamData.results.pipe(Object(o.a)(1)).toPromise().then((function(e){return e?e.items.length:Promise.reject("Observable completed with no values")}));(i.isPwaInUwp||this.isConsumer)&&n.then((function(e){return t.eventService.broadcastEvent({name:"mruReady",args:[e]})})),this.initialTabsPromise=n.then((function(){S.b.OneNote===t.fileType&&t.onNoteConfigService.config.enableOneNoteApis&&t.recentTabListModel.updateOrAddTab(t.createMyAppItemsLoadingTab(t.fileType)),t.sharedWithMeViewEnabled&&(t.createSharedLoadingTab(),t.recentTabListModel.updateOrAddTab(t.sharedWithMeTab)),S.b.OneNote===t.fileType&&t.userContextService.user.isEdu&&t.onNoteConfigService.config.enableOneNoteApis&&t.recentTabListModel.updateOrAddTab(t.createClassNoteBookLoadingTab()),t.trendingDocsEnabled&&(t.createTrendingLoadingTab(),t.recentTabListModel.updateOrAddTab(t.trendingTab))})).catch((function(){}))},e.prototype.ngOnDestroy=function(){var e,t,i,n,a,r,s;this.logPendingTabImpression(),null===(e=this.recentMruStream)||void 0===e||e.unsubscribe(),null===(t=this.routeSubscription)||void 0===t||t.unsubscribe(),null===(i=this.sharedWithMeSubscription)||void 0===i||i.unsubscribe(),null===(n=this.trendingDocSubscription)||void 0===n||n.unsubscribe(),null===(a=this.appItemStreamSubscription)||void 0===a||a.unsubscribe(),null===(r=this.themeShadesSubscription)||void 0===r||r.unsubscribe(),null===(s=this.visualRefreshSubscription)||void 0===s||s.unsubscribe()},e.prototype.onTabClicked=function(e){this.selectedTab=e,this.focusFirstItem=!1,this.updateNumLoggableItems(),this.updateWithNewZeroStateCheck()},e.prototype.onDeleteItem=function(e){var t=this;if(5===e.deleteOption)e.item.fileType===S.b.Forms&&(this.sendMruItemState(0,e.item),this.formsService.unpinSharedForm(e.item.docId).then((function(){var i=t.sharedData,n=i.value.findIndex());i.value.splice(n,1),i.fromCache=!1,t.processSharedDocTask(i,!1),t.sendMruItemState(1,e.item)})).catch()));else if(3===e.deleteOption);else{var i=e.item;this.documents.removeItem(i),this.mruDataService.removeDocument(Object(I.h)(i)),this.updateListModels(),this.setFocusOnStateChange(e.index)}},e.prototype.onFilter=function(e){this.updateListModels(e),this.focusOnFilter=!0,this.screenReaderText=e?this.locService.format(this.locService.FilterResultsFound,this.recentTabListModel.tabs[this.selectedTab].listModel.items.length.toString()):this.locService.NoFiltersApplied},e.prototype.onChangePinState=function(e){var t=e.item;this.documents.removeItem(t),t.isPinned=e.isPinned,this.documents.addItem(t),this.updateListModels(),this.mruDataService.updatePinnedState(Object(I.h)(t)),this.changeDetector.detectChanges(),this.setFocusOnStateChange(e.index,e.element)},e.prototype.trackByIndex,e.prototype.updateEmptyStates=function(){!this.appSuffix&&this.recentTabListModel&&this.recentTabListModel.tabs&&this.recentTabListModel.tabs.length&&(this.pinnedTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-pinned-darkmode":"emptystate-icons-sprite emptystate-pinned",this.recentTabListModel.updateOrAddTab(this.pinnedTab),this.recentTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-recent-darkmode":"emptystate-icons-sprite emptystate-recent",this.recentTabListModel.updateOrAddTab(this.recentTab),this.sharedWithMeTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-swm-darkmode":"emptystate-icons-sprite emptystate-swm",this.recentTabListModel.updateOrAddTab(this.sharedWithMeTab),this.trendingTab&&(this.trendingTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-discover-darkmode":"emptystate-icons-sprite emptystate-discover",this.recentTabListModel.updateOrAddTab(this.trendingTab)))},e.prototype.setFocusOnStateChange=function(e,t){var i=this;setTimeout((function(){var n,a=i.recentTabListModel.tabs[i.selectedTab];if(0===a.listModel.items.length)n=i.documentService.nativeDocument.getElementById("tab-list-header-link-"+a.id);else if(t&&a!==i.pinnedTab)n=t.nativeElement;else{var r=a.listModel.items[(!a.listModel.maxItemCount||e<a.listModel.maxItemCount)&&e<a.listModel.items.length?e:a.listModel.items.length];n=r?i.documentService.nativeDocument.getElementById(a.id+"-"+r.getId()):null}n&&n.focus()}),0)},e.prototype.isEmptyRecentView=function(){return this.recentTab&&this.recentTabListModel.tabs[this.selectedTab]===this.recentTab&&this.recentTab.listModel&&this.recentTab.listModel.items&&0===this.recentTab.listModel.items.length&&!this.recentTab.hasError&&!this.fileType},e.prototype.getSharedDocuments,e.prototype.getTamyDocuments,e.prototype.waitOnItemInflations=function(e){return Object(s.a)(e.map())).toPromise()},e.prototype.processShared=function(e){var t=this;if(e){var i=null,n=this.maxTotalDocuments;return this.isFormsApp?n=(i=e.map((function(e,i){return Object(I.b)(e,"forms_shared_item_"+i,"FormsSharedDocsImpression",t.contextService.isRtl,t.clientStartupConfigService.config.authType,!1,C.a.SharedForm)}))).length:i=e.map((function(e,i){return Object(I.g)(e,"shared_item_"+i,"SharedDocsImpression",t.contextService.isRtl,t.clientStartupConfigService.config.authType,!1)})),new p.a(i,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,n,(function(e,n){return t.logTabImpression(i,"shared-mru",e,n,!1)}),this.listAnimation,{isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp})}},e.prototype.getNotebooks,e.prototype.processAppItems=function(e){var t=this;return new Promise((function(i){var n,r;if(e.value){var s=[];try{for(var o=Object(a.__values)(e.value),l=o.next();!l.done;l=o.next())t.fileType===S.b.OneNote&&s.push(Promise.resolve(l.value))}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}Promise.all(s).then((function(e){var n=e.filter()).map((function(e,i){if(t.fileType===S.b.OneNote)return Object(I.c)(e,S.a.fileTypeNameFromType(t.fileType)+"_item_"+i,S.a.fileTypeNameFromType(t.fileType)+"Impression",t.contextService.isRtl,t.clientStartupConfigService.config.authType,!1)}));i(new p.a(n,t.locService.ShowMoreMruResultsAriaLabel,t.locService.ShowLessMruResultsAriaLabel,t.locService.ShowMoreMruResultsUpdateAriaLabel,t.locService.ShowLessMruResultsUpdateAriaLabel,t.maxInitialDocuments,t.maxTotalDocuments,(function(e,i){return t.logTabImpression(n,"app-items-mru",e,i,!1)}),t.listAnimation,{isSmallMobileCards:t.isFormsApp,isEvenPadding:t.isFormsApp}))}))}else i(void 0)}))},e.prototype.getClassNoteBooks,e.prototype.processClassNoteBooks=function(e){var t=this;if(e){var i=e.map((function(e,i){return Object(I.a)(e,"classnotebook_item_"+i,"ClassNoteBookImpression",t.contextService.isRtl,t.clientStartupConfigService.config.authType,!1)}));return new p.a(i,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(function(e,n){return t.logTabImpression(i,"classNotebook-mru",e,n,!1)}),this.listAnimation)}},e.prototype.createClassNoteBookLoadingTab=function(){var e=this,t=this.createClassNoteBookTab();return t.onLoad,t},e.prototype.createClassNoteBookTab=function(e){var t=this.locService.ClassNotebookTabTitle;return{id:"classNotebook-mru",title:t,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,t),listModel:e,zeroExperienceTitle:this.locService.NoClassNotebooksTitle,zeroExperienceSubtitle:this.locService.NoClassNotebooksSubTitle,zeroExperienceImage:"zero-docs-icon-sprite zero-docs-icon-sprite-icon-emptyfolder-208x208",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:null,loaded:!!e,fromCache:!1}},e.prototype.createMyAppItemsLoadingTab=function(e){var t=this;if(e===S.b.OneNote){var i=!1;return this.myAppItemsTab=this.createMyAppItemsTab(),this.myAppItemsTab.onLoad=function(){return new Promise((function(n,a){var r=null;e===S.b.OneNote&&(r=t.getNotebooks()),t.appItemStreamSubscription=r.results.subscribe((function(e){e.fromCache&&(i=!0),function(e){return new Promise((function(n){t.processAppItems(e).then((function(a){a&&(t.myAppItemsTab.listModel=a,t.myAppItemsTab.fromCache=e.fromCache,t.myAppItemsTab.loaded=!0,!e.fromCache&&i&&t.recentTabListModel.updateOrAddTab(t.myAppItemsTab)),n()}))}))}(e).then())})),r.initialCompletion.then((function(e){i=!0,e&&(t.globalErrorHandler.handleCacheObservableError(e,"uLfZP","yUFz9"),e.cacheError&&e.networkError&&a())}))}))},this.myAppItemsTab}},e.prototype.createMyAppItemsTab=function(e){var t={id:"app-items-mru",title:"",ariaLabel:"",listModel:e,zeroExperienceTitle:"",zeroExperienceSubtitle:"",zeroExperienceImage:"emptystate-icons-sprite emptystate-recent",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:null,loaded:!!e,fromCache:!1,showCardsInTileView:this.showInCardView};return this.fileType===S.b.OneNote&&(t.zeroExperienceTitle=this.locService.NoOwnedOneNoteItems,t.zeroExperienceSubtitle=this.locService.NoOwnedOneNoteItemsMemo,t.title=this.locService.MyNotebooksTabTitle,t.ariaLabel=this.locService.format(this.locService.DocumentTabAriaLabelFormat,this.locService.MyNotebooksTabTitle)),t},e.prototype.createSharedLoadingTab=function(){var e=this;this.sharedWithMeTab=this.createSharedTab(),this.sharedWithMeTab.onLoad=function(){return new Promise((function(t,i){var n=null;n=e.isFormsApp?e.formsService.getSharedForms():e.getSharedDocuments();var a=!1;e.sharedWithMeSubscription=n.results.subscribe((function(i){i.fromCache&&(a=!0),e.processSharedDocTask(i,a),t()})),n.initialCompletion.then((function(t){a=!0,t&&(e.globalErrorHandler.handleCacheObservableError(t,"Vu9AW","idjiA"),t.cacheError&&t.networkError&&i())}))}))}},e.prototype.processSharedDocTask=function(e,t){var i;this.sharedData&&e.fromCache||(this.sharedData=e),i=this.processShared(this.isFormsApp?this.sharedData.value:this.sharedData.items),this.sharedWithMeTabListData=i.items,this.sharedWithMeTab.listModel=i,this.sharedWithMeTab.fromCache=this.sharedData.fromCache,this.sharedWithMeTab.loaded=!0,!this.sharedData.fromCache&&t&&this.recentTabListModel.updateOrAddTab(this.sharedWithMeTab)},e.prototype.createSharedTab=function(){var e=this.locService.SharedDocumentsSectionTitleLowercase;return{id:"shared-mru",title:e,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,e),listModel:null,zeroExperienceTitle:this.locService.appResource("NoSharedWithMeTitle",this.fileType),zeroExperienceSubtitle:this.locService.appResource("NoSharedWithMeSubtitle",this.fileType),zeroExperienceImage:this.newMruEmptyStateEnabled?this.darkMode?"empty-state-image empty-state-image--shared-dark":"empty-state-image empty-state-image--shared":this.darkMode?"emptystate-icons-sprite-darkmode emptystate-sharedwithme-darkmode":"emptystate-icons-sprite emptystate-swm",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:this.createAttribution(this.mruConfig.oneDriveSharedViewId),loaded:!1,fromCache:!1,showCardsInTileView:this.showInCardView}},e.prototype.processTamy=function(e){var t=this,i=(e.items||[]).map((function(i,n){return Object(I.d)(i,"trending_item_"+n,e.impressionId,t.contextService.isRtl,t.clientStartupConfigService.config.authType,e.fromCache,!0)}));return new p.a(i,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(function(e,n){return t.logTabImpression(i,"trending-docs",e,n,!1)}),this.listAnimation,{initialTileItemCount:this.maxInitialDocumentCards})},e.prototype.createTrendingLoadingTab=function(){var e=this,t=this.locService.TrendingDocumentsSectionTitle;this.trendingTab={id:"trending-docs",title:t,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,t),listModel:null,zeroExperienceTitle:this.locService.appResource("NoDiscoverTitle",this.fileType),zeroExperienceSubtitle:this.locService.appResource("NoDiscoverSubtitle",this.fileType),zeroExperienceImage:this.darkMode?"emptystate-icons-sprite-darkmode emptystate-discover-darkmode":"emptystate-icons-sprite emptystate-discover",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:this.createAttribution(this.mruConfig.oneDriveDiscoverViewId),loaded:!1,fromCache:!1,showCardsInTileView:!0},this.trendingTab.onLoad=function(){return new Promise((function(t,i){var n=!1,a=e.getTamyDocuments();e.trendingDocSubscription=a.results.subscribe((function(i){i.fromCache&&(n=!0),e.processTamyTask(i,n),t()})),a.initialCompletion.then((function(t){n=!0,t&&(e.globalErrorHandler.handleCacheObservableError(t,"IyhlP","HFUrB"),t.cacheError&&t.networkError&&i())}))}))}},e.prototype.processTamyTask=function(e,t){var i=this.processTamy(e);this.trendingTab.listModel=i,this.trendingTab.fromCache=e.fromCache,this.trendingTab.loaded=!0,!e.fromCache&&t&&this.recentTabListModel.updateOrAddTab(this.trendingTab)},e.prototype.processRecentMruTask=function(t){var i=this;if(!this.contextService.isNewConsumerUserExperience||t.items&&t.items.length){var n,r,s=(t.items||[]).map((function(e,n){return Object(I.e)(e,"mru_item_"+n,t.impressionId,i.locService,i.contextService.isRtl,i.clientStartupConfigService.config.authType,t.fromCache)}));if(this.documents){var l=this.documents.getAllUnpinnedDocuments().slice(0,this.maxTotalDocuments).concat(this.documents.getAllPinnedDocuments().slice(0,this.maxTotalDocuments));this.copyInflationData(l,s)}if(this.documents=new $(s),this.impressionId=t.impressionId,this.pinnedDocsEnabled){var c=this.documents.getAllPinnedDocuments();n=new p.a(c,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,c.length,(function(e,n){return i.logTabImpression(i.pinnedTab.listModel.items,"pinned-mru",e,n,t.fromCache)}),this.listAnimation,{isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp,isVisualRefresh:this.isVisualRefresh}),r=new p.a(this.documents.getAllDocuments(),this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(function(e,n){i.logTabImpression(i.recentTab.listModel.items,"pinned-mru",e,n,t.fromCache),i.focusFirstItem=!1}),this.listAnimation,{infiniteShowMoreEnabled:this.mruConfig.infiniteShowMoreEnabled,isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp,isVisualRefresh:this.isVisualRefresh})}else r=new p.a(s,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(function(e,n){i.logTabImpression(i.recentTab.listModel.items,"mru",e,n,t.fromCache),i.focusFirstItem=!1}),this.listAnimation,{infiniteShowMoreEnabled:this.mruConfig.infiniteShowMoreEnabled,isSmallMobileCards:this.isFormsApp,isEvenPadding:this.isFormsApp,isVisualRefresh:this.isVisualRefresh});var u=this.locService.RecentDocumentsSectionTitleLowercase;if(this.recentTab={id:this.pinnedDocsEnabled?"unpinned-mru":"mru",title:u,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,u),listModel:r,timestampHeader:this.lastOpened,zeroExperienceTitle:this.newMruEmptyStateEnabled?this.locService.NoRecentNewConsumerTitle:this.locService.appResource("NoRecentTitle",this.fileType),zeroExperienceSubtitle:this.newMruEmptyStateEnabled?this.uploadEnabled?this.locService.NoRecentNewConsumerSubtitle:this.locService.NoRecentNewConsumerSubtitleWithNoUpload:this.locService.appResource(this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled&&this.fileType!==S.b.Sway?"NoRecentSubtitleDragAndDrop":"NoRecentSubtitle",this.fileType),zeroExperienceImage:this.newMruEmptyStateEnabled?this.darkMode?"empty-state-image empty-state-image--recent-dark":"empty-state-image empty-state-image--recent":this.darkMode?"emptystate-icons-sprite-darkmode emptystate-recent-darkmode":"emptystate-icons-sprite emptystate-recent",showZeroExperience:!0,errorTitle:null,attribution:this.createAttribution(this.mruConfig.oneDriveRecentViewId),loaded:!0,fromCache:t.fromCache,footerText:null,showCardsInTileView:this.showInCardView},this.recentTabListModel.updateOrAddTab(this.recentTab),n){var h=void 0,d=void 0,b=void 0;this.capabilitiesService.capabilities.replacePinActionEnabled?(h=this.locService.FavoritedDocumentSectionTitle,d=this.locService.NoFavoritedTitle,b=this.locService.NoFavoritedSubtitle):(h=this.locService.PinnedDocumentsSectionTitleLowercase,d=this.locService.appResource("NoPinnedTitle",this.fileType),b=this.locService.appResource("NoPinnedSubtitle",this.fileType)),this.pinnedTab={id:"pinned-mru",title:h,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,h),listModel:n,timestampHeader:this.lastOpened,zeroExperienceTitle:d,zeroExperienceSubtitle:b,zeroExperienceImage:this.newMruEmptyStateEnabled?this.darkMode?"empty-state-image empty-state-image--pinned-dark":"empty-state-image empty-state-image--pinned":this.darkMode?"emptystate-icons-sprite-darkmode emptystate-pinned-darkmode":"emptystate-icons-sprite emptystate-pinned",showZeroExperience:!0,errorTitle:null,attribution:this.createAttribution(this.mruConfig.oneDriveRecentViewId),loaded:!0,fromCache:t.fromCache,showCardsInTileView:this.showInCardView},this.recentTabListModel.updateOrAddTab(this.pinnedTab)}if(this.oneDriveUploadService.uploadEnabledPromise.then((function(e){e&&i.uploadConfigService.config&&i.uploadConfigService.config.dragAndDropEnabled&&i.fileType!==S.b.Sway&&i.fileType!==S.b.OneNote&&!i.isFormsApp&&(i.recentTab.footerText=i.locService.UploadFooter)})),this.updateNumLoggableItems(),r.items.length?(this.markMruReady(t.fromCache),this.updateWithNewZeroStateCheck()):Promise.all([this.oneDriveUploadService.uploadEnabledPromise,this.initialTabsPromise,this.createMenuService.createButtonEnabledPromise]).then()),this.stateChanged.emit({state:g.a.Displayed}),e.shellDeeplinkPromise||(e.shellDeeplinkPromise=this.activatedRoute.queryParams.pipe(Object(o.a)(1)).toPromise().then((function(e){var t=e.section;t&&"recentdocs"===t.toLowerCase()&&(i.initialListState=m.a.Open,i.focusFirstItem=!0,setTimeout(),1e3))}))),this.showAnalytics){var f=Object(a.__spread)(this.documents.getAllPinnedDocuments().slice(0,this.maxTotalDocuments),this.documents.getAllUnpinnedDocuments().slice(0,this.maxTotalDocuments));this.analyticsService.prefetchAnalytics(f,t.fromCache)}this.appFilter&&0!==this.appFilter.size||this.jumpListService.registerRecentJumpList(s)}else this.forceHideMru=!0},e.prototype.copyInflationData=function(e,t){var i,n,r=function(t){var i=null;e.some((function(e){return e.documentUrl===t.documentUrl&&(i=e,!0)}))&&t.copyInflationData(i,s.mruConfig.mruActivityEnabled)},s=this;try{for(var o=Object(a.__values)(t),l=o.next();!l.done;l=o.next())r(l.value)}catch(e){i={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}},e.prototype.createAttribution=function(e){var t=this;if(this.fileType===S.b.Sway)return{title:this.locService.AllSways,url:this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.swayServiceConfigService.config.myEndpoint),tooltip:this.locService.AllSwaysLinkTooltip,ariaLabel:this.locService.AllSwaysLinkAriaLabel,referral:v.a.Sway,zeroTitle:this.locService.AllSways};if(this.isFormsApp)return this.formsService.getAllMyFormsLink();var i=this.capabilitiesService.capabilities.outgoingLoginHintEnabled,n=this.clientStartupConfigService.config.loginHint,a={title:this.locService.MoreInOneDrive,url:K.a.appendLoginHint(this.contextService.sharedContext.oneDriveUrl,n,i),ariaLabel:this.locService.MoreInOneDrive,referral:v.a.OneDrive,zeroTitle:this.locService.GoToOneDrive};return this.oneDriveService.getMyDriveRootUrl().then((function(r){if(r&&r.userRoot){var s={};t.clientStartupConfigService.config.authType===H.a.MSA?s.qt=e:s.view=e,i&&(s.login_hint=n),a.url=K.a.appendQueryParams(r.userRoot,s)}})).catch()),a},e.prototype.updateWithNewZeroStateCheck=function(){this.emptyRecentNewButtonEnabled=this.isEmptyRecentView(),this.recentTab.attribution=!this.mobile&&this.emptyRecentNewButtonEnabled?null:this.createAttribution(this.mruConfig.oneDriveRecentViewId)},e.prototype.updateListModels=function(e){var t=e&&new RegExp(e,"i");this.pinnedDocsEnabled&&(this.pinnedTab.listModel.items=this.documents.getAllPinnedDocuments().filter((function(e){return!t||t.test(e.fileName)})),this.pinnedTab.listModel.maxItemCount=this.pinnedTab.listModel.items.length),this.sharedWithMeTab&&this.sharedWithMeTabListData&&(this.sharedWithMeTab.listModel.items=this.sharedWithMeTabListData.filter((function(e){return!t||t.test(e.fileName)}))),this.recentTab.listModel.items=this.documents.getAllDocuments().filter()),this.updateNumLoggableItems(),this.updateWithNewZeroStateCheck()},e.prototype.logTabImpression=function(e,t,i,n,a,r){var s=this;void 0===r&&(r=b.a.Loaded);var o=e.slice(0,i);this.logOtelImpressionEvent(e,t,o,a,r),this.pendingTabImpressionEvent&&this.logPendingTabImpression();var l=this.createImpressionEvent(e,t,o,n,a,r),c=++this.tabImpressionIndex;this.pendingTabImpressionEvent={event:l,items:o,id:c},r===b.a.Loaded?(this.updateNumLoggableItems(),this.waitOnItemInflations(o).then((function(){s.pendingTabImpressionEvent&&s.pendingTabImpressionEvent.id===c&&s.logPendingTabImpression()}))):this.logPendingTabImpression()},e.prototype.logPendingTabImpression=function(){if(this.pendingTabImpressionEvent){var e=this.pendingTabImpressionEvent.event;this.fillInflatedImpressionParams(e.params,this.pendingTabImpressionEvent.items),e.record(),this.pendingTabImpressionEvent=null}},e.prototype.fillInflatedImpressionParams=function(e,t){var i=this;e.ActivityDistribution=t.map()).reduce((function(e,t,i){return e+(0===i?"":";")+M.a[t]}),""),e.IsNewDistribution=t.map((function(e){return"boolean"==typeof e.isNew?e.isNew.toString():"undefined"})).reduce((function(e,t,i){return e+(0===i?"":";")+t}),""),e.IsSharedDistribution=t.map((function(e){return e.sharing&&"boolean"==typeof e.sharing.shared?e.sharing.shared.toString():"undefined"})).reduce((function(e,t,i){return e+(0===i?"":";")+t}),"")},e.prototype.createImpressionEvent=function(e,t,i,n,a,r,s){void 0===r&&(r=b.a.Loaded);var o=!i||this.dataSecurityService.securityLevel>=2?i:i.filter((function(e){return!e.isLocal})),l=S.a.distributionFromFileItems(o),c={};if(c.RenderSize=(o?o.length:0).toString(),c.Distribution=l,c.ElementId=t,c.TotalSize=this.getNumLoggableItems(e).toString(),c.State=n,c.TabState=b.a[r],c.ImpressionId=this.impressionId,c.FromServiceWorkerCache=(!!a).toString(),void 0!==s&&(c.Index=s.toString()),e.length>0){var u=e[0].timeSinceLastOpenInSeconds();null!==u&&(c.InactivityDuration=u.toString())}return this.instrumentationService.generateEvent("Mru_Impression","Generic_Impression",0,c)},e.prototype.logOtelImpressionEvent=function(e,t,i,n,a){void 0===a&&(a=b.a.Loaded);var s=!i||this.dataSecurityService.securityLevel>=2?i:i.filter((function(e){return!e.isLocal})),o=S.a.distributionFromFileItems(s),l=s?s.length:0;Object(r.a)({id:this.impressionId,eventName:"Mru",area:"Documents",subArea:T.a[t],fromCache:!!n,renderSize:l,totalSize:this.getNumLoggableItems(e),distribution:o})},e.prototype.markMruReady=function(e){this.performanceService.mark(e?"Cached_MRU_Ready":"MRU_Ready"),this.browserPaintMeasurementService.recordWhenPainted("MRU")},e.prototype.updateNumLoggableItems=function(){var e=this.recentTabListModel.tabs[this.selectedTab];this.numLoggableItems=e&&e.listModel?this.getNumLoggableItems(e.listModel.items):0},e.prototype.getNumLoggableItems=function(e){return e?this.dataSecurityService.securityLevel>=2?e.length:e.filter()).length:0},e.prototype.sendMruItemState,e.maxCardsPerLine=4,e}(),de=he,pe(),me=i("fYis"),be=i("7IJ8"),fe=i("QhWD"),Se=i("RsrG"),ve=i("6Po3"),ge=i("WLAd"),Te=i("9gjh"),ye=i("7J/E"),Me=i("55A9"),we=i("EYcb"),Ie=i("qCYW"),Ae=i("pd4Y"),Ce=i("y1jW"),Le=i("Bc8L"),De=i("kfAr"),Ee=i("1Bt+"),xe=i("OPwp"),Re=i("uNUv"),ke=i("6u39"),Fe=i("TIi1"),Ne=i("Xc4i"),Oe=i("EUVs"),Pe=i("BMb5"),Ue=i("hoyd"),Ve=i("DQbD"),We=i("GmnP"),_e=i("U8M1"),ze=i("hjJp"),je=i("345u"),Be=i("xoWf"),He=i("X+PR"),Ge=n.Fb({encapsulation:2,styles:[],data:{}});function qe(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,be.a,[fe.a,n.W,f.a,H.b,re.a,Se.a,ve.a,n.F,ge.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),n.Zb(2,{showAsLink:0,fileType:1,numDocuments:2}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,2,0,!0,i.fileType,(null==i.recentTabListModel||null==i.recentTabListModel.tabs[i.selectedTab]||null==i.recentTabListModel.tabs[i.selectedTab].listModel||null==i.recentTabListModel.tabs[i.selectedTab].listModel.items?null:i.recentTabListModel.tabs[i.selectedTab].listModel.items.length)||0);e(t,1,0,"upload-button#UploadButtonModule",n)}),null)}function Ze(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"],[null,"changePinState"]],(function(e,t,i){var n=!0,a=e.component;return"deleteItem"===t&&(n=!1!==a.onDeleteItem(i)&&n),"changePinState"===t&&(n=!1!==a.onChangePinState(i)&&n),n}),Te.b,Te.a)),n.bc(512,null,ye.a,ye.a,[q.a,G.a,Me.a,Y.a,R.a,we.a,H.b]),n.Gb(2,770048,null,0,y.a,[u.a,B.a,H.b,Ie.a,G.a,Ae.a,E.c,x.a,Ce.b,R.a,f.a,Le.a,q.a,w.a,De.a,ye.a,c.a,F.a,N.a,U.a,V.b,n.K,Ee.a,xe.b,Re.a,ke.a,Fe.a,Ne.a,Oe.a,Pe.b,Ue.a,A.a,Ve.a,We.a,ne.b,_e.a],{item:[0,"item"],index:[1,"index"],view:[2,"view"],listId:[3,"listId"],focusOnLoad:[4,"focusOnLoad"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem",changePinState:"changePinState"})],(function(e,t){var i=t.component;e(t,2,0,t.parent.context.item,t.parent.context.index,t.parent.context.itemView,t.parent.context.listId,!i.focusOnFilter&&t.parent.context.focusOnLoad,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function Ke(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"],[null,"changePinState"]],),Te.b,Te.a)),n.bc(512,null,ye.a,ye.a,[q.a,G.a,Me.a,Y.a,R.a,we.a,H.b]),n.Gb(2,770048,null,0,y.a,[u.a,B.a,H.b,Ie.a,G.a,Ae.a,E.c,x.a,Ce.b,R.a,f.a,Le.a,q.a,w.a,De.a,ye.a,c.a,F.a,N.a,U.a,V.b,n.K,Ee.a,xe.b,Re.a,ke.a,Fe.a,Ne.a,Oe.a,Pe.b,Ue.a,A.a,Ve.a,We.a,ne.b,_e.a],{item:[0,"item"],index:[1,"index"],view:[2,"view"],listId:[3,"listId"],focusOnLoad:[4,"focusOnLoad"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem",changePinState:"changePinState"})],(function(e,t){var i=t.component;e(t,2,0,t.parent.context.item,t.parent.context.index,t.parent.context.itemView,t.parent.context.listId,!i.focusOnFilter&&0===t.parent.context.index,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function Je(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Ze)),n.Gb(2,16384,null,0,ce.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Ke)),n.Gb(4,16384,null,0,ce.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],),null)}function Xe(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,be.a,[fe.a,n.W,f.a,H.b,re.a,Se.a,ve.a,n.F,ge.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),n.Zb(2,{buttonOrigin:0,fileType:1,numDocuments:2}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,2,0,i.emptyViewName,i.fileType,i.numLoggableItems);e(t,1,0,"upload-button#UploadButtonModule",n)}),null)}function Qe(e){return n.jc(0,[(e()(),n.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),n.Gb(1,475136,null,0,be.a,[fe.a,n.W,f.a,H.b,re.a,Se.a,ve.a,n.F,ge.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),n.Zb(2,{buttonOrigin:0,numDocuments:1,withAnimation:2,showDropdown:3}),(e()(),n.qb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,2,0,i.emptyViewName,i.numLoggableItems,!1,!1);e(t,1,0,"create-menu#CreateMenuModule",n)}),null)}function Ye(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,4,"div",[["class","buttons-container buttons-container--empty"]],null,null,null,null,null)),(e()(),n.qb(16777216,null,null,1,null,Xe)),n.Gb(2,16384,null,0,ce.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(16777216,null,null,1,null,Qe)),n.Gb(4,16384,null,0,ce.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],),null)}function $e(e){return n.jc(0,[(e()(),n.Hb(0,0,[[1,0],["recentTab",1]],null,15,"div",[],null,null,null,null,null)),n.Gb(1,278528,null,0,ce.i,[n.x,n.y,n.o,n.K],{ngClass:[0,"ngClass"]},null),n.Zb(2,{"recent-tab__height-restrictor":0}),(e()(),n.Hb(3,0,null,null,1,"div",[["aria-live","polite"],["class","visually-hidden"]],null,null,null,null,null)),(e()(),n.gc(4,null,["",""])),(e()(),n.Hb(5,0,null,null,8,"ohp-tab-list",[],null,[[null,"tabClicked"]],),ze.b,ze.a)),n.Gb(6,4308992,null,1,je.b,[B.a,E.c,f.a,q.a,Be.a,n.h,H.b,l.b],{model:[0,"model"],columnsEnabled:[1,"columnsEnabled"],tileViewEnabled:[2,"tileViewEnabled"],listState:[3,"listState"],defaultStateNoMinHeight:[4,"defaultStateNoMinHeight"],customButtonEnabled:[5,"customButtonEnabled"],defaultView:[6,"defaultView"],pillTabs:[7,"pillTabs"],showFilter:[8,"showFilter"],filterInput:[9,"filterInput"],isVisualRefresh:[10,"isVisualRefresh"]},{tabClicked:"tabClicked"}),n.cc(603979776,2,{tabListItems:1}),(e()(),n.Hb(8,0,null,0,3,"div",[["ohpTabListButton",""]],null,null,null,null,null)),n.Gb(9,16384,null,0,je.a,[],null,null),(e()(),n.qb(16777216,null,null,1,null,qe)),n.Gb(11,16384,null,0,ce.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null),(e()(),n.qb(0,null,null,1,null,Je)),n.Gb(13,16384,[[2,4]],0,je.c,[n.S],null,null),(e()(),n.qb(16777216,null,null,1,null,Ye)),n.Gb(15,16384,null,0,ce.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!(null!=i.recentTabListModel.tabs[i.selectedTab].listModel&&i.recentTabListModel.tabs[i.selectedTab].listModel.items.length)||i.recentTabListModel.tabs[i.selectedTab].hasError);e(t,1,0,n),e(t,6,1,[i.recentTabListModel,!0,i.tileViewEnabled,i.initialListState,!0,i.uploadEnabled&&i.headless,i.defaultView,i.fluentRefresh,(null==i.recentTabListModel||null==i.recentTabListModel.tabs[i.selectedTab]?null:i.recentTabListModel.tabs[i.selectedTab].loaded)&&i.filterEnabled,i.onFilter,i.isVisualRefresh]),e(t,11,0,i.uploadEnabled&&i.headless),e(t,15,0,i.emptyRecentNewButtonEnabled&&!i.newMruEmptyStateEnabled&&(i.createButtonEnabled||i.uploadEnabled))}),))}function et(e){return n.jc(0,[n.cc(671088640,1,{recentTabElement:0}),(e()(),n.qb(16777216,null,null,1,null,$e)),n.Gb(2,16384,null,0,ce.k,[n.W,n.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,(null==i.recentTabListModel.tabs?null:i.recentTabListModel.tabs.length)&&!i.forceHideMru)}),null)}var tt=n.Db("ohp-mru-component",he,(function(e){return n.jc(0,[(e()(),n.Hb(0,0,null,null,1,"ohp-mru-component",[],null,null,null,et,Ge)),n.Gb(1,245760,null,0,he,[B.a,n.h,H.b,G.a,D.a,E.c,x.a,R.a,Y.a,f.a,k.a,q.a,w.a,c.a,P.a,U.a,O.a,V.b,A.a,ue,He.a,l.b,Z.a,J.a,u.a,F.a,W.a,h.a,L.a,z.a,X.a,d.a,N.a,_.b,j.a],null,null)],),null)}),{fileType:"fileType",maxInitialDocs:"maxInitialDocs",maxTotalDocs:"maxTotalDocs",headless:"headless",recentMruStreamData:"recentMruStreamData",title:"title"},{stateChanged:"stateChanged"},[]),it=i("xIlw"),nt=i("+a0u"),at=i("lQwO"),rt=i("+P5Z"),st=i("izKO"),ot=i("L9A/"),lt=i("CfLe"),ct=i("ej7j"),ut=i("VY7U"),ht=i("T/SX"),dt=i("up2P"),pt=i("D8EG"),mt=i("D6F8"),bt=i("9InZ"),ft=i("upmJ"),St=i("T6pR"),vt=i("sVeK"),gt=i("+5ti"),Tt=i("XWg3"),yt=i("ci1G"),Mt=i("CCRL"),wt=n.Eb(pe,[],(function(e){return n.Tb([n.Ub(512,n.k,n.hb,[[8,[me.a,tt]],[3,n.k],n.D]),n.Ub(4608,ce.m,ce.l,[n.z]),n.Ub(1073742336,ce.c,ce.c,[]),n.Ub(1073742336,it.a,it.a,[]),n.Ub(1073742336,nt.a,nt.a,[]),n.Ub(1073742336,at.a,at.a,[]),n.Ub(1073742336,rt.a,rt.a,[]),n.Ub(1073742336,st.a,st.a,[]),n.Ub(1073742336,ot.a,ot.a,[]),n.Ub(1073742336,lt.a,lt.a,[]),n.Ub(1073742336,ct.a,ct.a,[]),n.Ub(1073742336,He.o,He.o,[[2,He.u],[2,He.n]]),n.Ub(1073742336,ut.a,ut.a,[]),n.Ub(1073742336,ht.a,ht.a,[]),n.Ub(1073742336,dt.a,dt.a,[]),n.Ub(1073742336,pt.a,pt.a,[]),n.Ub(1073742336,mt.a,mt.a,[]),n.Ub(1073742336,bt.a,bt.a,[]),n.Ub(1073742336,ft.a,ft.a,[]),n.Ub(1073742336,St.a,St.a,[]),n.Ub(1073742336,vt.a,vt.a,[]),n.Ub(1073742336,gt.b,gt.b,[]),n.Ub(1073742336,Tt.g,Tt.g,[]),n.Ub(1073742336,yt.a,yt.a,[]),n.Ub(1073742336,pe,pe,[]),n.Ub(256,Mt.a,de,[])])}))},UAwW:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("QjXU"),a=i("SQAW"),r=i("0Cfz"),s=i("2uMA"),o=i("ZO6L"),l=i("EgzG"),c=i("f0qX")var h=function(e)return n.__extends(t,e),t.prototype.notifyNext,t.prototype.notifyComplete,t}(l.a)},rBrS}]);
//# sourceMappingURL=mru.a7a2a817c05dcedd6e1e.chunk.v7.js.map