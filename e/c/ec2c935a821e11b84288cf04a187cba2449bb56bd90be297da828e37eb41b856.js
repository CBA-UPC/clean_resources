!function(){window.DCTMTAG=window.DCTMTAG||[],window.DCTMTAG.events=window.DCTMTAG.events||{custom:{}},window.dcDataStorage=Array.isArray(window.dcDataStorage)&&window.dcDataStorage||[],DCTMTAG.debug=DCTMTAG.debug||!1;var d=window.DCTMTAG.shift();if(void 0!==d){d.surveyCSSPath||(d.surveyCSSPath="s.dc-tag.jp/css/survey.min.css"),d.surveyControlPath||(d.surveyControlPath="sv.dc-tag.jp/control"),d.surveyAnswerPath||(d.surveyAnswerPath="sv.dc-tag.jp/answer"),d.sscKeyName||(d.sscKeyName="dc_ssc_idsig");function r(e){if(!d.debug)return!1;var t=e.tags||[];h("TAG LIST [length: "+t.length+"] :");for(var n=0;n<t.length;n++){var a=t[n],i="";try{a.survey?i=["--tag_id:",String(a.id),"[survey],"," survey_id:",a.survey.id," priority:",a.survey.priority," answers_limit:",a.survey.answers_limit].join(""):160<(i=["--tag_id:",String(a.id),"[",a.event.type,"],"," tag:",a.tag_text.replace(/\n/g,"")].join("")).length&&(i=i.substr(0,160)+" ...")}catch(e){i=["ERROR tagInfoMassage: ",e.message].join("")}h(i)}}
var s="dc_cl_id",c={queue:{start:[],onload:[],dom:[],value:[],custom:[]}},l=(c.event={onload:function(){if(0<c.queue.onload.length)for(var e=0;e<c.queue.onload.length;e++)h("Tag Event: INSERT[onload]_event, tag_id:"+c.queue.onload[e].id),p(c.queue.onload[e],document)},dom:function(){if(0<c.queue.dom.length)for(var e=0;e<c.queue.dom.length;e++)h("Tag Event: INSERT[dom]_event, tag_id:"+c.queue.dom[e].id),p(c.queue.dom[e],document);if(0<c.queue.value.length)for(e=0;e<c.queue.value.length;e++)c.event.value(c.queue.value[e])},value:function(e){h("Tag Event: WaitValue, tag_id:"+e.id+", target:"+e.event.target+", timeout:"+e.event.timeout),function r(s,o,d,u){return function(){var e=d.split("."),t=void 0,n="window",a=r(s+1,o,d,u);"window"===e[0]&&e.shift();for(var i=0;i<e.length;i++){n+="."+e[i];try{t=Function("'use strict';return ("+n+")")()}catch(e){h("Tag Event: WaitValue, tag_id:"+o.id+", valueError"+n),t=void 0}if(!t)break}h("Tag Event: WaitValue, tag_id:"+o.id+", value:"+s+" times "+t),
t?(h("Tag Event: WaitValue, tag_id:"+o.id+" Fire"),p(o,document)):s<u[1]?setTimeout(a,u[0]):s>=u[1]&&u[2]?(h("Tag Event: WaitValue, tag_id:"+o.id+" Timeout-true"),p(o,document)):h("Tag Event: WaitValue, tag_id:"+o.id+" Timeout-false")}}(0,e,Array.isArray(e.event.target)?e.event.target[0]:e.event.target,e.event.timeout)()},custom:function(e){var t;2<e.event.target.length?(t=e.event.target.slice(2),h("Tag Event: WaitValue, tag_id:"+e.id+", target:"+e.event.target+", timeout:"+e.event.timeout),c.event.checkVarExistsArray(0,e,t,e.event.timeout)()):2==e.event.target.length&&p(e,document)},checkVarExistsArray:function(s,o,d,u){return function(){for(var t=Array(d.length),e=c.event.checkVarExistsArray(s+1,o,d,u),n=0;n<d.length;n++){var a="window",i=d[n].split(".");"window"===i[0]&&i.shift();for(var r=0;r<i.length;r++){a+="."+i[r];try{t[n]=Function("'use strict';return ("+a+")")()}catch(e){h("Tag Event: WaitValue, tag_id:"+o.id+", valueError"+a),t[n]=void 0}if(!t[n])break}}h(
"Tag Event: WaitValue, tag_id:"+o.id+", value:"+s+" times "+t),t.every(?(h("Tag Event: WaitValue, tag_id:"+o.id+" Fire"),p(o,document)):s<u[1]?setTimeout(e,u[0]):s>=u[1]&&u[2]?(h("Tag Event: WaitValue, tag_id:"+o.id+" Timeout-true"),p(o,document)):h("Tag Event: WaitValue, tag_id:"+o.id+" Timeout-false")}},customEventInit:function(){var e=window.dcDataStorage,t=dcDataStorage=[];DCTMTAG.events.custom[d.acid]=function(e){if("string"!=typeof e)return!1;var t=!1;l.setFqProfile();for(var n=0;n<c.queue.custom.length;n++){var a=c.queue.custom[n];a&&a.event&&Array.isArray(a.event.target)&&e===a.event.target[0]&&(t=!0,c.triggers.compareItems(a)?0===a.event.target[1]?h("Tag Event: INSERT_REJECTED[custom], tag_id:"+a.id+", The insert limit has been reached."):(h("Tag Event: INSERT[custom], tag_id:"+a.id+", eventName:"+a.event.target[0]+", limit:"+a.event.target[1]),c.event.custom(a)):h("Tag Trigger: tag_id:"+a.id+" is excluded by trigger."))}return t||h(
"Tag Event: TAG_NOT_EXIST[custom], eventName:"+e),!0},t.push=function(){var e=[].slice.call(arguments,0),t=!1;h("Tag Event: EVENT_PUSH, "+JSON.stringify(e));for(var n=0;n<e.length;n++){var a,i=e[n].container_id;for(a in DCTMTAG.events.custom)(void 0===i||i==a)&&(t=DCTMTAG.events.custom[a](e[n].event))}t||h("Tag Event: CONTAINER_NOT_EXIST[custom], container_id:"+i)};for(var n=0;n<e.length;n++)(void 0===e[n].container_id||e[n].container_id==d.acid)&&t.push(e[n])}},c.triggers={compareItems:function(i){function e(e){if(e.hasOwnProperty("conditions"))for(var t=0;t<e.conditions.length;t++)if(c.triggers.operator[e.conditions[t].operator]&&c.triggers.item[e.conditions[t].item_name]){var n=e.conditions[t].operator,a=(-1<c.triggers.frequencyItems.indexOf(e.conditions[t].item_name)&&(n="jsfq"),c.triggers.operator[n](c.triggers.item[e.conditions[t].item_name](e.conditions[t],i),e.conditions[t].item_value));if(h("Tag Trigger: ----"+e.conditions[t].item_name+" <"+n+"> "+e.conditions[t
].item_value.join(",")+": "+a),0==a)return}return 1}if(h("Tag Trigger: tag_id:"+i.id+" :"),!(i.triggers&&i.triggers.group_id&&0<Object.keys(i.triggers.group_id).length))return!0;if(i.triggers.group_id.hasOwnProperty("0")){if(h("Tag Trigger: --group_0:"),!e(i.triggers.group_id[0]))return!1;if(1===Object.keys(i.triggers.group_id).length)return!0}for(var t in i.triggers.group_id)if("0"!==t&&i.triggers.group_id.hasOwnProperty(t)&&(h("Tag Trigger: --group_"+t+":"),e(i.triggers.group_id[t])))return!0;return!1},item:{freq_all:function(e,t){return!(l.isExcludeID(t.id)||!m.initParam.enablecookie||!m.storageSupported||(l.setTags[t.id]={},l.setTags[t.id].type=e.item_name,l.setTags[t.id].value=e.item_value[0],0))},freq_daycount:function(e,t){return c.triggers.item.freq_all(e,t)},freq_1day:function(e,t){return c.triggers.item.freq_all(e,t)},freq_repeat:url:,operator:{eq:function(e,t){return e==t[0]},jsfq:,frequencyItems:["freq_daycount","freq_1day","freq_repeat"]},{FQ_COOKIE:"_dctagfq",FQ_LSNAME:"dctagfq",MAX_DAYS:10,MAX_TIMES:9,MAX_MINUTES:14400,MAX_TAGS:44,EXPIRE_SEC:864e3,tagInfos:{},setTags:{},excludeTags:[],setTagFq:function(e){if(l.setTags.hasOwnProperty(e)){var t=l.setTags[e];switch(h("FQ SET: tag_id:"+e+", param:"+JSON.stringify(t)),t.type){case"freq_daycount":l._dctag_fq_days(t.value,e);break;case"freq_1day":l._dctag_fq_times(t.value,e);break;case"freq_repeat":l._dctag_fq_minutes(t.value,e)}}},isExcludeID:_cookieGetItem:function(){if(!m.storageSupported)return"";try{var e=localStorage.getItem(l.FQ_LSNAME);return e?decodeURIComponent(e):m.getCookieValue(l.FQ_COOKIE)||""}catch(e){return h("LocalStorage is not available"),m.storageSupported=!1,""}},_cookieSetTagInfos:function(){if(m.storageSupported){var e,t=[];for(e in l.tagInfos){var n=l.tagInfos[e],a=n[0],i=n[1],n=n[2];t.push(e+":"+a+"."+i+"."+n)}try{var r=t.join("|");
localStorage.setItem(l.FQ_LSNAME,encodeURIComponent(r)),h("FQ SET: updateFqCookie, "+r)}catch(e){m.storageSupported=!1,h("LocalStorage is not available")}}},_cookieGetTagInfos:function(){var e=l._cookieGetItem();if(void 0===e)return{};for(var t=parseInt((new Date).getTime()/1e3),n=new RegExp("(\\d+?):(\\d+?)\\.(\\d)\\.(\\d)"),a={},i=e.split("|"),r=0;r<i.length;r++){var s,o,d,u,c=n.exec(i[r]);null!=c&&(s=parseInt(c[1]),o=parseInt(c[2]),d=parseInt(c[3]),c=parseInt(c[4]),0<(u=o-t)?(a[s]=[o,d,c],h("FQ GET: IsValid, tag_id:"+s+", count:"+c+"/"+d+", diffSec:"+u+", diffDays:"+(u/86400).toFixed(1))):h("FQ GET: Expired, tag_id:"+s+", count:"+c+"/"+d+", diffSec:"+u+", diffDays:"+(u/86400).toFixed(1)))}return a},setFqProfile:function(){l.tagInfos=l._cookieGetTagInfos();var e,t=[];for(e in l.tagInfos){var n=l.tagInfos[e][1],a=l.tagInfos[e][2];(0==n||0<n&&n<=a)&&t.push(parseInt(e))}l.excludeTags=t,h("FQ GET: Excluded tag_id List: ["+l.excludeTags.join(",")+"]")},getTagFq:function(e){e=l.tagInfos[e]
return void 0===e?[0,0,0]:e},updateTagFq:function(e,t,n,a){l.tagInfos=l._cookieGetTagInfos();var t=parseInt(t.getTime()/1e3),i=Object.keys(l.tagInfos).length;h("FQ SET: updateFq, tag_id:"+e+", tms:"+t+", maxCount:"+n+", curCount:"+a+", currentKeyLength:"+i),i>l.MAX_TAGS&&void 0===l.tagInfos[e]?h("FQ SET: WARNING, "+i+" << The ID limit has been exceeded."):(l.tagInfos[e]=[t,n,a],l._cookieSetTagInfos())},dateLineTm:_dctag_fq_days:function(e,t){var n=l.dateLineTm(),e=parseInt(e);n.setDate(n.getDate()+e-1),l.updateTagFq(t,n,0,0)},_dctag_fq_times:function(e,t){var n=l.dateLineTm(),a=l.getTagFq(t)[2]+1,e=parseInt(e);e>l.MAX_TIMES&&(e=l.MAX_TIMES),l.updateTagFq(t,n,e,a)},_dctag_fq_minutes:function(e,t){var n=new Date,e=parseInt(e);n.setMinutes(n.getMinutes()+e),l.updateTagFq(t,n,0,0)}}),o={idLength:16,expDays:720,setCookie:function(e,t,n){var a=[],t=t?encodeURIComponent(t):"",e=(a.push(e+"="+t+";"),
void 0!==n.expires?a.push("Expires="+n.expires+";"):void 0!==n.maxage&&a.push("Max-Age="+n.maxage+";"),n.domain||""),t=(a.push("Domain="+e+";"),n.path||"/"),e=(a.push("Path="+t+";"),n.secure&&a.push("Secure;"),n.httponly&&a.push("HttpOnly;"),n.samesite&&a.push("SameSite="+n.samesite+";"),a.join(" "));h("SET Cookie: "+e),document.cookie=e},getCookie:isExactId:function(e){return new RegExp("^[a-zA-Z1-9][a-zA-Z0-9]{"+(o.idLength-1)+"}$").test(e)},create:function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789",t="",n=0;n<o.idLength;n++){var a=Math.floor(Math.random()*e.length);t+=e.charAt(a),0===n&&(e+="0")}return t},setCLID:function(){function e(e,t,n){for(var a=window.location.hostname.split("."),i=[];0<a.length&&(i.unshift(a.pop()),n.domain=i.join("."),o.setCookie(s,e,n),!t||o.getCookie(s)!==e););}var t,n,a;navigator.cookieEnabled&&void 0!==document.cookie&&(t=o.getCookie(s),o.isExactId(t)||(t=o.create()),
o.setCookie(s,"",{expires:new Date("1970").toUTCString(),samesite:"Lax"}),n=window.location.hostname,a=new Date(Date.now()+24*o.expDays*60*60*1e3).toUTCString(),"localhost"===n?o.setCookie(s,t,{expires:a,samesite:"Lax"}):/\d*\.\d*\.\d*\.\d*$/.test(n)?o.setCookie(s,t,{domain:n,expires:a,secure:!0,samesite:"None"}):(e("",!1,{expires:new Date("1970").toUTCString(),secure:!0,samesite:"None"}),e(t,!0,{expires:a,secure:!0,samesite:"None"})))}},m={initParam:{},storageSupported:!0,getMetadata:function(e){try{var t=e.toLowerCase(),n=e.toUpperCase(),a=e[0].toUpperCase()+e.slice(1).toLowerCase(),i=document.head.children||{},r=i[t]||i[n]||i[a],s="";r&&(s=r.getAttribute("content"))}catch(e){h("Error: getMetadata, "+e.name+": "+e.message);s=""}return s},getCookieValue:function(e){var t=document.cookie;if(t)for(var n=t.split("; "),a=0,i=n.length;a<i;a++)if((t=n[a].split("="))[0]===e)return decodeURIComponent(t[1]);return""},getSSCookie:function(e){e=m.getCookieValue(e);return e?e.split("_")[0]:void 0
},isMobileDevice:function(){return!(!navigator.userAgent||!/android.+mobile|ipod|iphone/.test(navigator.userAgent.toLowerCase()))||!(!navigator.userAgentData||!navigator.userAgentData.mobile)},getParam:function(){var e={};return e.url=window.location.href,e.domain_name=window.location.hostname,e.referrer=document.referrer,e.protocol=window.location.protocol.slice(0,-1),e.title=document.title||"",e.description=m.getMetadata("description"),e.enablecookie=navigator.cookieEnabled,e.keywords=m.getMetadata("keywords"),e.dc_cl_id=m.getCookieValue(s)||void 0,e.dc_ssc_id=m.getSSCookie(d.sscKeyName),e}},f={baseElementID:"dctmSurveyMain",elementPrefix:"dctmSurvey",init:function(e){f.getDisplayItem(e.sort()},getDisplayItem:function(t){if(t.length<1)return h("SURVEY: No target item."),!1;var n=t.shift(),e={survey_id:n.survey.id},a="https://"+d.surveyControlPath;n.survey&&n.survey.id?u(a,JSON.stringify(e),function(e){
!e.answered&&e.answer_count<n.survey.answers_limit?f.createSurvey(n):(l.setTagFq(n.id),f.getDisplayItem(t))}):h("API Request: Error, Abort this request - surveyItem undefined")},displayAlert:function(e){var t=f.elementPrefix;e.target.validity&&e.target.validity.valid||"SELECT"===e.target.tagName&&""!==e.target.value?this.msgElement.classList.add(t+"NotDisplay"):this.msgElement.classList.remove(t+"NotDisplay")},checkValidation:function(e){var t=[];for(var n=0;n<e.length;n++)t.push(function(e,t){var n=f.elementPrefix,a=e.querySelectorAll(":invalid"),e=e.getElementsByClassName(n+"invalidMsg")[0];if(0<a.length)return e.classList.remove(n+"NotDisplay"),t;e.classList.add(n+"NotDisplay")}(e[n],n));return!(0<(t=t.filter().length&&(document.getElementById(f.elementPrefix+"Content").scrollTop=e[t[0]].offsetTop,1))},sendResult:function(e){if(e.preventDefault(),!f.checkValidation(this.surveyItemList))return!1;for(var e={},t=(e.survey_id=this.survey_id,
e.td_client_id=m.getCookieValue("_td"),[]),n=0;n<this.surveyTagText.survey_items.length;n++){var a=this.surveyItemList[n].getElementsByClassName(f.elementPrefix+"Answer_"+Number(n+1));switch(this.surveyTagText.survey_items[n].type){case"short":case"string":s=a[0].value;break;case"pulldown":for(var i=a[0].getElementsByTagName("option"),r=0;r<i.length;r++)i[r].selected&&(s=i[r].text);break;case"radio":case"checkbox":for(var s={},r=0;r<this.surveyTagText.survey_items[n].items.length;r++)s[a[r].value]=Number(a[r].checked)}t.push(s)}e.answer=t;var o="https://"+d.surveyAnswerPath;u(o,JSON.stringify(e),function(){h("API Request: Success - Send survey answer")}),f.toggleDisplay(document.getElementById(f.baseElementID),"answered",this.tag_id)},createForm:function(e,t){var n=f.elementPrefix,a=n+"Answer_",i={short:"このフィールドを入力してください。",string:"このフィールドを入力してください。",pulldown:"プルダウンから１つ選択してください。",radio:"１つ選択してください。",checkbox:"当てはまるものを全て選択してください。"},r=document.createElement("div"),s=(
r.className=n+"FormWrap",[]);switch(s.push("<p>"+t.description),t.mandatory&&s.push('<span class="',n,'MandatoryMsg">　※必須</span>'),s.push("</p>"),t.type){case"short":s.push(["<input ",'id="',a,e,'" ','class="',a,e,'" ','type="text"','name="',a,e,'" ','maxlength="15"'].join("")),t.mandatory&&s.push(" required"),s.push(">"),s.push(['<span class="',n,"invalidMsg"," ",n,'NotDisplay">',i[t.type],"</span>"].join("")),s.push(['<p class="',n,'StringLimit">',"15文字以内","</p>"].join(""));break;case"string":s.push(["<textarea ",'id="',a,e,'" ','class="',a,e,'" ','name="',a,e,'" ','rows="5" ','cols="33" ','maxlength="80"'].join("")),t.mandatory&&s.push(" required"),s.push("></textarea>"),s.push(['<span class="',n,"invalidMsg"," ",n,'NotDisplay">',i[t.type],"</span>"].join("")),s.push(['<p class="',n,'StringLimit">',"80文字以内","</p>"].join(""));break;case"pulldown":s.push(["<select ",'name="',a,e,'" ','id="',a,e,'"'].join("")),window.CSS&&(window.CSS.supports("-webkit-appearance: none"
)||window.CSS.supports("appearance: none"))?s.push('class="',a,e," ",n,'PullDownParts" '):s.push('class="',a,e,'" '),t.mandatory&&s.push(" required"),s.push(">"),s.push('<option value="" disabled selected>選択してください。</option>');for(var o=0;o<t.items.length;o++)s.push(["<option ",'value="',o,'" ','class="',a,e,'">',t.items[o].value,"</option>"].join(""));s.push("</select>"),s.push(['<span class="',n,"invalidMsg"," ",n,'NotDisplay">',i[t.type],"</span>"].join(""));break;case"radio":for(o=0;o<t.items.length;o++)s.push("<div>"),s.push(["<input ",'type="radio" ','class="',a,e,'" ','id="',a,e,"_",o+1,'" ','name="',a,e,'" ','value="',t.items[o].value,'"'].join("")),t.mandatory&&s.push(" required"),s.push(">"),s.push(["<label ",'for="',a,e,"_",o+1,'" ','class="',n,'RadioLabel">',t.items[o].value,"</label>"].join("")),s.push("</div>");s.push(['<span class="',n,"invalidMsg"," ",n,'NotDisplay">',i[t.type],"</span>"].join(""));break;case"checkbox":for(o=0;o<t.items.length;o++)s.push("<div>"),s.push(
["<input ",'type="checkbox" ','class="',a,e,'" ','id="',a,e,"_",o+1,'" ','name="',a,e,'"  ','value="',t.items[o].value,'">'].join("")),s.push(["<label ",'for="',a+e+"_"+(o+1)+'" ','class="',n,'SelectLabel">',t.items[o].value,"</label>"].join("")),s.push("</div>");s.push(["<input ",'type="checkbox" ','class="',a,e,"_check ",,n,'MandatoryCheck" ','id="',a,e,'_check" ','name="',a,e,'" ','value=""'].join("")),t.mandatory&&s.push(" required"),s.push(">"),s.push(['<span class="',n,"invalidMsg"," ",n,'NotDisplay">',i[t.type],"</span>"].join(""))}return r.insertAdjacentHTML("afterbegin",s.join("")),r},checkboxControl:function(e){var t=document.getElementById(f.elementPrefix+"Main"),n=t.getElementsByClassName(e.target.className),a=t.getElementsByClassName(e.target.className+"_check")[0],t=e.target.checked;if(t)for(var i=0;i<n.length;i++)(this.exclude||this.targetSurvey.items[i].exclude)&&(n[i].checked=!1);if(e.target.checked=t,this.targetSurvey.mandatory){a.checked=!1;for(i=0;i<n.length;i++)n[i
].checked&&(a.checked=!0);a.dispatchEvent(this.statusChangeEvent)}},toggleDisplay:function(e,t,n){var a=f.elementPrefix+"Open",i=f.elementPrefix+"Close",r=f.elementPrefix+"Visible";"open"===t?(e.classList.remove(i),e.classList.add(a)):"answered"===t?(e.classList.remove(a),e.classList.add(i),e.getElementsByClassName("dctmSurveyHead")[0].children[0].innerHTML="<span>ご協力</span><span>ありがとうございます</span>",window.setTimeout(function(){e.classList.remove(r),window.setTimeout(function(){e.remove?e.remove():e.parentNode.removeChild(e)},1e3)},1e3),n&&l.setTagFq(n)):"cancel"===t&&(e.classList.remove(r),window.setTimeout(function(){e.remove?e.remove():e.parentNode.removeChild(e)},1e3),n)&&l.setTagFq(n)},loadCSS:function(e){for(var t="https://"+d.surveyCSSPath,n=document.getElemength;a++)if SurveyCSS is already loaded."),e.style.display="",!1;var i=document,r=i.createElement("link");r.href=t,r.rel="stylesheet",r.type="text/css",
r.onload=function(){e.style.display=""},r.onerror=function(){h("SURVEY: loadCSS, ERROR")},i.getElementsByTagName("head")[0].appendChild(r)},createSurvey:function(e){var t=e.survey,n=JSON.parse(e.tag_text),a=[],i=document.createElement("div"),r=(i.id=f.baseElementID,i.style.display="none",f.loadCSS(i),f.elementPrefix),s=(m.isMobileDevice()?i.classList.add(r+"SP"):i.classList.add(r+"PC"),m.isMobileDevice()?n.display_type.sp:n.display_type.pc),o=(h(["SURVEY: survey_id=",t.id,", isMobileDevice=",m.isMobileDevice(),", displayType=",s].join("")),['<div id="',r,'Container">','<div class="',r,'Head">',"<p><span>アンケートに</span><span>ご協力ください</span></p>",'<div class="',r,'CloseBtn"></div>',"</div>",'<div id="',r,'Content">','<div id="',r,'ContentInner">','<form action="" method="post" class="',r,'FormArea">','<div id="',r,'SendWrapper">',"<p>","ご回答いただいた情報の取り扱いに関しては<br>",'<a hre,"をご確認ください。","</p>","<button>送信</button>","</div></form></div></div></div>"
].join(""));i.insertAdjacentHTML("afterbegin",o),"banner"==s?(i.classList.add(r+"Close"),i.getElementsByClassName(r+"Head")[0].addEventListener("click",{tag_id:e.id,handleEvent:function(e){f.toggleDisplay(i,"open",this.tag_id)}},{once:!0})):"popup"==s&&i.classList.add(r+"Open");for(var d=0;d<n.survey_items.length;d++){var u=i.getElementsByClassName(r+"FormArea")[0].insertBefore(f.createForm(d+1,n.survey_items[d]),i.getElementsByClassName(r+"FormArea")[0].lastChild);if("checkbox"==n.survey_items[d].type)for(var c=new Event("change",{bubbles:!0,cancelable:!0}),l=0;l<n.survey_items[d].items.length;l++)u.getElementsByTagName("input")[l].addEventListener("change",{targetSurvey:n.survey_items[d],exclude:n.survey_items[d].items[l].exclude,statusChangeEvent:c,handleEvent:f.checkboxControl});for(var g=u.querySelectorAll(":invalid"),l=0;l<g.length;l++){var p={validMsg")[0],handleEvent:f.displayAlert};g[l].addEventListener("change",p)}a.push(u)}function v(
){if(document.body&&document.getElementById(f.baseElementID))return h("SURVEY: insertElement, Another survey has been displayed."),!1;document.body.insertBefore(i,null),window.setTimeout(function(){i.classList.add(r+"Visible")},100)}i.getElementsByClassName(r+"CloseBtn")[0].addEventListener("click",{tag_id:e.id,handleEvent:function(e){e.stopPropagation(),f.toggleDisplay(i,"cancel",this.tag_id)}}),i.getElementsByTagName("button")[0].addEventListener("click",{tag_id:e.id,survey_function(e,t){var n,a,g;t.body?(n=e.tag_text||"",a=e.id,l.setTagFq(a),"custom"==e.event.type&&"number"==typeof e.event.target[1]&&0<e.event.target[1]&&e.event.target[1]--,g=function(e,t){t&&(e.addEventListener?e.onload=t:e.onreadystatechange=function(){e.readyState in{loaded:1,complete:1}&&(e.onreadystatechange=null,t())})},function o(d,u,c,l){return function(){
try{if(0<u.length){var e=u.shift(),t=o(d,u,c,l);if("SCRIPT"==String(e.nodeName.toUpperCase()))a=d,i=e,r=t,(s=document.createElement("script")).async=!1,s.type="text/javascript",s.id=i.id,s.text=i.text||i.textContent||i.innerHTML||"",i.charset&&(s.charset=i.charset),(i=i.getAttribute("src"))&&(s.src=i,g(s,r)),a.insertBefore(s,null),i||r();else if(e.innerHTML&&0<=e.innerHTML.toLowerCase().indexOf("<script")){for(var n=[];e.firstChild;)n.push(e.removeChild(e.firstChild));d.insertBefore(e,null),o(e,n,tinsertBefore(e,null),t()}else c()}catch(e){h("Error: insertTag, "+e.name+": "+e.message),window.setTimeout(l,0)}var a,i,r,s}}(t.body,function(e){(t=document.createElement("div")).innerHTML="tx<div>"+e+"</div>";for(var t=t.lastChild,n=[];t.firstChild;)n.push(t.removeChild(t.firstChild));return n}(n),function(){},function(){})()):window.setTimeout(function(){h("Waiting <body>: start, tag_id:"+e.id),p(e,t)},200)},u=function(e,t,n){var a;window.fetch?(h("API Request: Fetch, Body:"+t)
,fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded; charset=utf-8","Accept-Encoding":"gzip"},body:t,mode:"cors",credentials:"include"}).then(function(e){if(200==e.status)return e.json();throw new Error("Error Response - Response.status:"+e.status)}).then(function(e){n(e)}).catch(function(e){h("API Response: "+e.message)})):(h("API Request: XMLHttpRequest, Body:"+t),(a=new XMLHttpRequest).onreadystatechange=function(){var e;4==this.readyState&&200==this.status&&(e=JSON.parse(this.responseText),n(e))},a.withCredentials=!0,a.open("POST",e,!0),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),a.setRequestHeader("Accept-Encoding","gzip"),a.send(t))},h=function(e){if(!d.debug)return!1;var t="[DCTAG-LOG:"+(new Date).getTime()+":"+d.acid+"]";console.log(t,String(e))},a=function(e){var t=RegExp("[0-9]+");return!(!e||!t.test(e))};try{
-1<window.location.search.indexOf("dctagdebugmode")&&(d.debug=!0),!0===d.debug&&h("START DEBUG MODE"),l.setFqProfile(),o.setCLID(),m.initParam=m.getParam();var e=new Blob([JSON.stringify(m.initParam)]),t=new FileReader;t.onload=function(e){n((e=e&&e.srcElement)?e.result.substr(e.result.indexOf(",")+1):"")},t.readAsDataURL(e)}catch(e){h("Error: init, "+e.name+": "+e.message),n("")}}function i(e){r(e);for(var t=e.tags,n=[],a=[],i=0;i<t.length;i++)t[i].survey?(t[i].triggers={group_id:{0:{conditions:[{item_name:"freq_repeat",item_value:["1440"],operator:"eq"}]}}},c.triggers.compareItems(t[i])?(h("Tag Trigger: tag_id:"+t[i].id+" is pushed survey List"),a.push(t[i])):(h("Tag Trigger: tag_id:"+t[i].id+" is excluded by trigger."),n.push(t[i].id))):t[i].event&&c.queue[t[i].event.type]?"custom"==t[i].event.type||c.triggers.compareItems(t[i])?(h("Tag Trigger: tag_id:"+t[i].id+" is pushed ["+t[i].event.type+"] queue."),c.queue[t[i].event.type].push(t[i])):(h("Tag Trigger: tag_id:"+t[i
].id+" is excluded by trigger."),n.push(t[i].id)):(h("Tag Trigger: tag_id:"+t[i].id+" is excluded because event type that does not exist."),n.push(t[i].id));h("Tag Trigger: Excluded tag_id List : ["+n.join(", ")+"]");for(i=0;i<c.queue.start.length;i++)h("Tag Event: start, tag_id:"+c.queue.start[i].id),p(c.queue.start[i],document);switch(h("ReadyState: "+document.readyState),document.readyState){case"loading":window.addEventListener("DOMContentLoaded",c.event.dom),window.addEventListener("load",c.event.onload);break;case"interactive":window.addEventListener("load",c.event.onload);for(i=0;i<c.queue.dom.length;i++)h("Tag Event: INSERT[dom]_interactive, tag_id: "+c.queue.dom[i].id),p(c.queue.dom[i],document);for(i=0;i<c.queue.value.length;i++)c.event.value(c.queue.value[i]);break;case"complete":for(i=0;i<c.queue.dom.length;i++)h("Tag Event: INSERT[dom]_complete, tag_id: "+c.queue.dom[i].id),p(c.queue.dom[i],document);for(i=0;i<c.queue.value.length;i++)c.event.value(c.queue.value[i]);for(
i=0;i<c.queue.onload.length;i++)h("Tag Event: INSERT[onload]_complete,  tag_id: "+c.queue.onload[i].id),p(c.queue.onload[i],document)}0<c.queue.custom.length&&c.event.customEventInit(),0<a.length&&f.init(a)}function n(e){var t,n="https://"+d.server+"/post/"+d.acid;a(d.acid)?window.fetch?(h("API Request: Fetch, id: "+d.acidh(n,{meon","Content-Type":"application/x-www-form-urlencoded; charset=utf-8","Accept-Encoding":"gzip"},body:e,mode:"cors",credentials:"include"}).then(function(e){if(200==e.status)return e.json();throw new Error("Error Response - Response.status:"+e.status)}).then(function(e){i(e)}).catch(function(e){h("API Response: "+e.message)})):(h("API Request: XMLHttpRequest, id: "+d.acid+", Body:"+e),(t=new XMLHttpRequest).onreadystatechange=function(){4==this.readyState&&200==this.status&&i(JSON.parse(this.responseText))},t.withCredentials=!0,t.open("POST",n,!0),t.setRequestHeader("Accept","application/json"),
t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),t.setRequestHeader("Accept-Encoding","gzip"),t.send(e)):h("API Request: Error, Abort this request - Incorrect ID: "+d.acid)}}();