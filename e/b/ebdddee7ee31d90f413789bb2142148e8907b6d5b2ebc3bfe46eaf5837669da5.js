!function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};ar r=n=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||function(){return this}()||Function("return this")(),o=i=!o((),s={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,u={f:a&&!s.call({1:2},1)?s},c=l={}.toString,h=d="".split,f=o(()?Object,p=g=function(t){return f(p(t))},v=y=m={}.hasOwnProperty,_=function(t,e){return m.call(t,e)},b=n.document,w=v(b)&&v(b.createElement),S=C=!i&&!o((),E=Object.getOwnPropertyDescriptor,O={f:i?E:,P=A=Object.defineProperty,I={f:i?A:,T=i?x=L="__core-js_shared__",j=n[L]||x(L,{}),D=Function.toString;"function"!=typeof j.inspectSource&&(j.inspectSource=function(t){return D.call(t)});var k,M,R,N=j.inspectSource,U=n.WeakMap,B="function"==typeof U&&/native code/.test(N(U)),F=e(()),G=0,W=Math.random(),$,V=F("keys"),K,Q={},H=n.WeakMap;if(B){var q=j.state||(j.state=new H),z=q.get,J=q.has,Y=q.set;k,M,R=function(t){return J.call(q,t)}}else{var X=K("state");Q[X]=!0,k,M,R=function(t){return _(t,X)}}var Z,tt,et={set:k,get:M,has:R,enforce,getterFor},rt=e()),nt=n,ot,it,st=Math.ceil,at=Math.floor,ut,ct=Math.min,lt,ht=Math.max,dt=Math.min,ft,pt,gt={includes:pt(!0),indexOf:pt(!1)},vt=gt.indexOf,yt,mt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_t=mt.concat("length","prototype"),bt={f:Object.getOwnPropertyNames||function(t){return yt(t,_t)}},wt={f:Object.getOwnPropertySymbols},St=it("Reflect","ownKeys")|,Ct,Et=/#|\.prototype\./,Ot,Pt=Ot.normalize,At=Ot.data={},It=Ot.NATIVE="N",Tt=Ot.POLYFILL="P",xt=Ot,Lt=O.f,jt,Dt=n.Promise,kt,Mt="process"==h(n.process),Rt=it("navigator","userAgent")||"",Nt=n.process,Ut=Nt&&Nt.versions,Bt=Ut&&Ut.v8;Bt?tt=(Z=Bt.split("."))[0]+Z[1]:Rt&&(!(Z=Rt.match(/Edge\/(\d+)/))||Z[1]>=74)&&(Z=Rt.match(/Chrome\/(\d+)/))&&(tt=Z[1]);var Ft=tt&&+tt,Gt=!!Object.getOwnPropertySymbols&&!o()),Wt=Gt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,$t=F("wks"),Vt=n.Symbol,Kt=Wt?Vt:Vt&&Vt.withoutSetter||$,Qt,Ht=I.f,qt=Qt("toStringTag"),zt,Jt=Qt("species"),Yt,Xt,Zt,te={},ee=Qt("iterator"),re=Array.prototype,ne,oe,ie={};ie[Qt("toStringTag")]="z";var se="[object z]"===String(ie),ae=Qt("toStringTag"),ue="Arguments"==h(function(){return arguments}()),ce=se?h,le=Qt("iterator"),he,de,fe,pe,ge=Qt("iterator"),ve=!1;try{var ye=0,me={next,return};me[ge]=function(){return this},Array.from(me,(function(){throw 2}))}catch(t){}var _e,be,we,Se,Ce=Qt("species"),Ee,Oe=it("document","documentElement"),Pe=/(iphone|ipod|ipad).*applewebkit/i.test(Rt),Ae=n.location,Ie=n.setImmediate,Te=n.clearImmediate,xe=n.process,Le=n.MessageChannel,je=n.Dispatch,De=0,ke={},Me="onreadystatechange",Re,Ne,Ue,Be;Ie&&Te||(Ie,Te,Mt?_e=function(t){xe.nextTick(Ne(t))}:je&&je.now?_e:Le&&!Pe?(we=(be=new Le).port2,be.port1.onmessage=Ue,_e=oe(we.postMessage,we,1)):n.addEventListener&&"function"==typeof postMessage&&!n.importScripts&&Ae&&"file:"!==Ae.protocol&&!o(Be)?(_e=Be,n.addEventListener("message",Ue,!1)):_e=Me in S("script"));var Fe,Ge,We,$e,Ve,Ke,Qe,He,qe={set:Ie,clear:Te},ze=/web0s(?!.*chrome)/i.test(Rt),Je=O.f,Ye=qe.set,Xe=n.MutationObserver||n.WebKitMutationObserver,Ze=n.document,tr=n.process,er=n.Promise,rr=Je(n,"queueMicrotask"),nr=rr&&rr.value;nr||(Fe,Pe||Mt||ze||!Xe||!Ze?er&&er.resolve?(Qe=er.resolve(void 0),He=Qe.then,$e=function(){He.call(Qe,Fe)}):$e=Mt:(Ve=!0,Ke=Ze.createTextNode(""),new Xe(Fe).observe(Ke,{characterData:!0}),$e));var or,ir,sr,ar,ur=nr|,cr,lr={f},hr,dr,fr=qe.set,pr=Qt("species"),gr="Promise",vr=et.get,yr=et.set,mr=et.getterFor(gr),_r=Dt,br=n.TypeError,wr=n.document,Sr=n.process,Cr=it("fetch"),Er=lr.f,Or=Er,Pr=!!(wr&&wr.createEvent&&n.dispatchEvent),Ar="function"==typeof PromiseRejectionEvent,Ir="unhandledrejection",Tr=xt(gr,)),xr=Tr||!Se()),Lr,jr,Dr,kr,Mr,Rr,Nr,Ur,Br;Tr&&(_r,(or).prototype=kt(_r.prototype,{then,catch}),ir,lr.f=Er,"function"==typeof Dt&&(ar=Dt.prototype.then,rt(Dt.prototype,"then",),{unsafe:!0}),"function"==typeof Cr&&jt({global:!0,enumerable:!0,forced:!0},{fetch}))),jt({global:!0,wrap:!0,forced:Tr},{Promise:_r}),zt(_r,gr,!1),Yt(gr),sr=it(gr),jt({target:gr,stat:!0,forced:Tr},{reject}),jt({target:gr,stat:!0,forced:Tr},{resolve}),jt({target:gr,stat:!0,forced:xr},{all,race});var Fr,Gr=Object.keys|,Wr=i?Object.defineProperties,$r="prototype",Vr="script",Kr=K("IE_PROTO"),Qr=function(){},Hr,qr;Q[Kr]=!0;var zr=Object.create|,Jr=Qt("unscopables"),Yr=Array.prototype;null==Yr[Jr]&&I.f(Yr,Jr,{configurable:!0,value:zr(null)});var Xr,Zr=gt.includes;jt({target:"Array",proto:!0},{includes}),Xr("includes");var tn,en=!!Dt&&o());jt({target:"Promise",proto:!0,real:!0,forced:en},{finally}),"function"!=typeof Dt||Dt.prototype.finally||rt(Dt.prototype,"finally",it("Promise").prototype.finally),"function"!=typeof Promise.prototype.finally&&(Promise.prototype.finally=function(t){return this.then((e=>this.constructor.resolve(t()).then()))).catch((e=>this.constructor.resolve(t()).then())))}),window.__knownBlocker=!!function(){try{const t=["OPR","n !im","sByTa","1003447LuLqWg","dow","sibil","ing","Opera","style","565qdizXE","getEl","232331sDoJoU","18LCDgxI","cssTe","8949RXqNfR","s: 43","play:","porta","nt; o","tInto","Conte","mport","1gfBELn","ock","getOw","textC","toStr","ntWin","ement","sheet","ortan","injec","lengt","hidde","ant; ","nProp","ptor","dbl","type","89029nRIyjx","ertyD","index","get","1153xndIzo","349hFSaxZ","3toLzmo"," none","gName","conte","proto","1DNflRb","1153390UmUDUA","8264wGiSvY"];function e(e,r){return t[e-=493]}return function(t,r){const n=e;for(;;)try{if(700794===-parseInt(n(504))*parseInt(n(505))+parseInt(n(497))*-parseInt(n(516))+parseInt(n(510))*-parseInt(n(529))+parseInt(n(518))*parseInt(n(499))+parseInt(n(521))*-parseInt(n(519))+parseInt(n(493))+parseInt(n(506))*parseInt(n(498)))break;t.push(t.shift())}catch(e){t.push(t.shift())}}(t),function(){const t=e,r="a"+t(544)+t(530),n=Object[t(531)+t(542)+t(494)+"escri"+t(543)](HTMLIFrameElement[t(503)+t(545)],t(502)+t(534)+"dow");if(n&&n[t(496)]){if(-1!==n[t(496)][t(533)+t(513)]()[t(495)+"Of"](t(538)+t(526)+t(527)+t(534)+t(511)))return r}const o=navigator.userAgent;if(-1!==o[t(495)+"Of"](t(514))||-1!==o[t(495)+"Of"](t(507))){const e=document[t(517)+t(535)+t(509)+t(501)]("head")[0];if(e){const n=e[t(517)+"ement"+t(509)+t(501)](t(515));for(let e=0,o=n[t(539)+"h"];e<o;e++)try{const o=n[e];if(o&&!o[t(532)+"ontent"]&&o[t(536)]){const e=o.sheet.rules;if(e)for(let n=0,o=e.length;n<o;n++)try{if(-1!==e[n][t(520)+"xt"].indexOf("{ dis"+t(523)+t(500)+" !imp"+t(537)+"t; vi"+t(512)+"ity: "+t(540)+t(508)+t(524)+t(525)+"rphan"+t(522)+"21 !i"+t(528)+t(541)+"}"))return r}catch(t){}}}catch(t){}}}}()}catch(r){}}(),function(t){t.Default="default",t.Grey="grey",t.Dark="dark",t.System="system"}(tn||(tn={}));const rn="ru_RU",nn=(t,e)=>{const r=(null==t?void 0:t.config)||(null==t?void 0:t.Config);return null==r?void 0:r[e]},on=864e5;var sn,an,un,cn,ln=!o()),hn=K("IE_PROTO"),dn=Object.prototype,fn=ln?Object.getPrototypeOf,pn=Qt("iterator"),gn=!1;[].keys&&("next"in(un=[].keys())?(an=fn(fn(un)))!==Object.prototype&&(sn=an):gn=!0);var vn=null==sn||o());vn&&(sn={}),_(sn,pn)||T(sn,pn,(function(){return this}));var yn={IteratorPrototype:sn,BUGGY_SAFARI_ITERATORS:gn},mn=yn.IteratorPrototype,_n=function(){return this},bn=Object.setPrototypeOf||("__proto__"in{}():void 0),wn=yn.IteratorPrototype,Sn=yn.BUGGY_SAFARI_ITERATORS,Cn=Qt("iterator"),En="keys",On="values",Pn="entries",An,In="Array Iterator",Tn=et.set,xn=et.getterFor(In),Ln(Array,"Array",),),"values");te.Arguments=te.Array,Xr("keys"),Xr("values"),Xr("entries");var jn={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Dn=Qt("iterator"),kn=Qt("toStringTag"),Mn=Ln.values;for(var Rn in jn){var Nn=n[Rn],Un=Nn&&Nn.prototype;if(Un){if(Un[Dn]!==Mn)try{T(Un,Dn,Mn)}catch(t){Un[Dn]=Mn}if(Un[kn]||T(Un,kn,Rn),jn[Rn])for(var Bn in Ln)if(Un[Bn]!==Ln[Bn])try{T(Un,Bn,Ln[Bn])}catch(t){Un[Bn]=Ln[Bn]}}}var Fn,Gn="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Wn=I.f,$n=n.Int8Array,Vn=$n&&$n.prototype,Kn=n.Uint8ClampedArray,Qn=Kn&&Kn.prototype,Hn=$n&&fn($n),qn=Vn&&fn(Vn),zn=Object.prototype,Jn=zn.isPrototypeOf,Yn=Qt("toStringTag"),Xn=$("TYPED_ARRAY_TAG"),Zn=Gn&&!!bn&&"Opera"!==ce(n.opera),to=!1,eo={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},ro={BigInt64Array:8,BigUint64Array:8},no;for(Fn in eo)n[Fn]||(Zn=!1);if((!Zn||"function"!=typeof Hn||Hn===Function.prototype)&&(Hn,Zn))for(Fn in eo)n[Fn]&&bn(n[Fn],Hn);if((!Zn||!qn||qn===zn)&&(qn=Hn.prototype,Zn))for(Fn in eo)n[Fn]&&bn(n[Fn].prototype,qn);if(Zn&&fn(Qn)!==qn&&bn(Qn,qn),i&&!_(qn,Yn))for(Fn in to=!0,Wn(qn,Yn,{get}),eo)n[Fn]&&T(n[Fn],Xn,Fn);var oo={NATIVE_ARRAY_BUFFER_VIEWS:Zn,TYPED_ARRAY_TAG:to&&Xn,aTypedArray,aTypedArrayConstructor,exportTypedArrayMethod,exportTypedArrayStaticMethod,isView,isTypedArray:no,TypedArray:Hn,TypedArrayPrototype:qn},io=oo.NATIVE_ARRAY_BUFFER_VIEWS,so=n.ArrayBuffer,ao=n.Int8Array,uo=!io||!o((function(){ao(1)}))||!o((function(){new ao(-1)}))||!Se(),!0)||o()),co,lo=Math.abs,ho=Math.pow,fo=Math.floor,po=Math.log,go=Math.LN2,vo,yo,mo,_o=bt.f,bo=I.f,wo=et.get,So=et.set,Co="ArrayBuffer",Eo="DataView",Oo="prototype",Po="Wrong index",Ao=n[Co],Io=Ao,To=n[Eo],xo=To&&To[Oo],Lo=Object.prototype,jo=n.RangeError,Do=vo,ko=yo,Mo,Ro,No,Uo,Bo=function(t){return Do(t,23,4)},Fo,Go,Wo,$o;if(Gn){if(!o())||!o())||o())){for(var Vo,Ko=(Io)[Oo]=Ao[Oo],Qo=_o(Ao),Ho=0;Qo.length>Ho;)(Vo=Qo[Ho++])in Io||T(Io,Vo,Ao[Vo]);Ko.constructor=Io}bn&&fn(xo)!==Lo&&bn(xo,Lo);var qo=new To(new Io(2)),zo=xo.setInt8;qo.setInt8(0,2147483648),qo.setInt8(1,2147483649),!qo.getInt8(0)&&qo.getInt8(1)||kt(xo,{setInt8:function(t,e){zo.call(this,t,e<<24>>24)},setUint8},{unsafe:!0})}else Io,To,i&&(Go(Io,"byteLength"),Go(To,"buffer"),Go(To,"byteLength"),Go(To,"byteOffset")),kt(To[Oo],{getInt8,getUint8,getInt16,getUint16,getInt32,getUint32,getFloat32:function(t){return ko(Wo(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64,setInt8:function(t,e){$o(this,1,t,Mo,e)},setUint8,setInt16:function(t,e){$o(this,2,t,Ro,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){$o(this,2,t,Ro,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){$o(this,4,t,No,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){$o(this,4,t,No,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){$o(this,4,t,Bo,e,arguments.length>2?arguments[2]:void 0)},setFloat64});zt(Io,Co),zt(To,Eo);var Jo={ArrayBuffer:Io,DataView:To},Yo,Xo=oo.aTypedArrayConstructor,Zo,ti=Array.isArray|,ei=Qt("species"),ri,ni=[].push,oi,ii={forEach:oi(0),map:oi(1),filter:oi(2),some:oi(3),every:oi(4),find:oi(5),findIndex:oi(6),filterOut:oi(7)},si,ai=e((function(t){var e=bt.f,r=ii.forEach,o=et.get,s=et.set,a=I.f,u=O.f,l=Math.round,h=n.RangeError,d=Jo.ArrayBuffer,f=Jo.DataView,p=oo.NATIVE_ARRAY_BUFFER_VIEWS,g=oo.TYPED_ARRAY_TAG,m=oo.TypedArray,b=oo.TypedArrayPrototype,w=oo.aTypedArrayConstructor,S=oo.isTypedArray,C="BYTES_PER_ELEMENT",E="Wrong length",P,A,x,L,j,D;i?(p||(O.f=j,I.f=D,A(b,"buffer"),A(b,"byteOffset"),A(b,"byteLength"),A(b,"length")),jt({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:j,defineProperty:D}),t.exports):t.exports}));ai("Int32",));var ui=oo.aTypedArray;(0,oo.exportTypedArrayMethod)("fill",(function(t){return mo.apply(ui(this),arguments)}));var ci=oo.aTypedArray;(0,oo.exportTypedArrayMethod)("set",),o()));var li=oo.aTypedArray,hi=[].sort;(0,oo.exportTypedArrayMethod)("sort",));var di,fi=[],pi=fi.sort,gi=o()),vi=o()),yi=di("sort");jt({target:"Array",proto:!0,forced:gi||!vi||!yi},{sort});var mivar bi={UNSUPPORTED_Y:o((function(){var t=_i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),BROKEN_CARET:o())},wi=RegExp.prototype.exec,Si=F("native-string-replace",String.prototype.replace),Ci=wi,Ei(),Oi=bi.UNSUPPORTED_Y||bi.BROKEN_CARET,Pi=void 0!==/()??/.exec("")[1];(Ei||Pi||Oi)&&(Ci);var Ai=Ci;jt({target:"RegExp",proto:!0,forced:/./.exec!==Ai},{exec:Ai}),jt({global:!0},{globalThis:n});var Ii=Qt("species"),Ti=!o()),xi="$0"==="a".replace(/./,"$0"),Li=Qt("replace"),ji=!!/./[Li]&&""===/./[Li]("a","$0"),Di=!o()),ki,Mi={codeAt:ki(!1),charAt:ki(!0)}.charAt,Ri,Ni=Math.floor,Ui="".replace,Bi=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Fi=/\$([$&'`]|\d{1,2})/g,Gi,Wi,$i=Math.max,Vi=Math.min;("replace",2,));var Ki=I.f,Qi=n.Symbol;if(i&&"function"==typeof Qi&&(!("description"in Qi.prototype)||void 0!==Qi().description)){var Hi={},qi;Ct(qi,Qi);var zi=qi.prototype=Qi.prototype;zi.constructor=qi;var Ji=zi.toString,Yi="Symbol(test)"==String(Qi("test")),Xi=/^Symbol\((.*)\)[^)]+$/;Ki(zi,"description",{configurable:!0,get}),jt({global:!0,forced:!0},{Symbol:qi})}function Zi(){}Promise.resolve();const ts=[];function es(t){let e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zi;const n=new Setreturn{set:o,update,subscribe}}const rs=/mini-mail\.ru$/.test(window.location.host),ns=/\.devmail\.ru$/.test(window.location.host),os="devmail.ru",is=rs?"mini-mail.ru":"mail.ru",ss=ns?os:is;var as,us,cs,ls,hs,ds,fs,ps,gs;!function(t){t.BUILD="2.155.1",t.MODERN_BROWSERS_REGEXP=/(Edge\/(79(?:\.0)?|79(?:\.([1-9]|\d{2,}))?|([8-9]\d|\d{3,})(?:\.\d+)?|83(?:\.0)?|83(?:\.([1-9]|\d{2,}))?|(8[4-9]|9\d|\d{3,})(?:\.\d+)?))|((Chromium|Chrome)\/(61\.0|61\.([1-9]|\d{2,})|(6[2-9]|[7-9]\d|\d{3,})\.\d+|83\.0|83\.([1-9]|\d{2,})|(8[4-9]|9\d|\d{3,})\.\d+)(?:\.\d+)?)|(Version\/(13\.0|13\.([1-9]|\d{2,})|(1[4-9]|[2-9]\d|\d{3,})\.\d+|14\.0|14\.([1-9]|\d{2,})|(1[5-9]|[2-9]\d|\d{3,})\.\d+|15\.0|15\.([1-9]|\d{2,})|(1[6-9]|[2-9]\d|\d{3,})\.\d+|16\.0|16\.([1-9]|\d{2,})|(1[7-9]|[2-9]\d|\d{3,})\.\d+|17\.0|17\.([1-9]|\d{2,})|(1[8-9]|[2-9]\d|\d{3,})\.\d+)(?:\.\d+)? Safari\/)|(Firefox\/(60\.0|60\.([1-9]|\d{2,})|(6[1-9]|[7-9]\d|\d{3,})\.\d+)\.\d+)|(Firefox\/(60\.0|60\.([1-9]|\d{2,})|(6[1-9]|[7-9]\d|\d{3,})\.\d+)(pre|[ab]\d+[a-z]*)?)/}(as||(as={}))(us||(us={}))(cs||(cs={})),function(t){t.Show="show",t.Hide="hide"}(ls||(ls={})),function(t){t.Show="show",t.Hide="hide"}(hs||(hs={})),function(t){t.Show="show",t.Hide="hide",t.Load="load",t.Focus="focus"}(ds||(ds={})),function(t){t.Show="show",t.Hide="hide"}(fs||(fs={}))(ps||(ps={})),function(t){t.Show="show",t.Hide="hide",t.SetMainFrameContainer="setMainFrameContainer",t.ResetMainFrameContainer="resetMainFrameContainer",t.OpenMarusia="openMarusia",t.SilenceMarusia="silenceMarusia"}(gs||(gs={}));const vs=window.__PH;es(function(t){if(vs&&t in vs)return vs[t]}("xray")||{send:()=>{}},(()=>{})).subscribe;const ys=t=>{var e,r;const n=nn(t.omicronConfig,"cloudStoriesCounterEnabled")||(null===(e=t.experiments)||void 0===e?void 0:e.switchCloudStoriesCounter),o=nn(t.omicronConfig,"cloudStoriesCounterCrossNavEnabled")||(null===(r=t.experiments)||void 0===r?void 0:r.switchCloudStoriesCounterCrossNav);return t.isCrossNav?o:n},ms;class _sgetListenersNumber(t){return[...this._events.get(t)||[],...this._oneTimeEvents.get(t)||[]].length}on(t,e){const r=[...this._events.get(t)||[],e];return this._events.set(t,r),this}removeListener(t,e){const r=(this._events.get(t)||[]).filter());return this._events.set(t,r),this}once(t,e){const r=[...this._oneTimeEvents.get(t)||[],e];return this._oneTimeEvents.set(t,r),this}emit(t,e,r){const n=e||ms;(this._events.get(t)||[]).forEach((t=>t({data:r},n)));return(this._oneTimeEvents.get(t)||[]).forEach()),this._oneTimeEvents.delete(t),this}static relay(t,e,r){t.forEach())}}class bs extends _son(t,e){return super.on(t,e),this._executeListenerIfHasData(t,e),this}removeListener(t,e){return super.removeListener(t,e),this.getListenersNumber(t)||this._eventsData.delete(t),this}emit(t,e,r){return super.emit(t,e,r),this._eventsData.set(t,r),this}_executeListenerIfHasData(t,e){const r=this._eventsData.get(t);r&&e({data:r},ms)}}var ws=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=document.createElement("script"),n=document.querySelector("head")return e&&(r.defer=!0,r.async=!0),r.src=t,"opera"in window&&"complete"!==document.readyState?window.addEventListener("DOMContentLoaded",o):o(),r},Ss=[],Cs={maxSize:500,getLog,clear};var Es={log:function(){try{(console.debug||console.log).apply(console,arguments)}catch(t){}},error:function(){try{console.error.apply(console,arguments)}catch(t){}},warn}function Ps(t){return t&&"object"===Os(t)&&!As(t)function Is(){for(var t={},e=0;e<arguments.length;++e){var r=arguments[e];for(var n in r)t[n]&&Ps(t[n])&&Ps(r[n])?t[n]=Is(t[n],r[n]):t[n]=r[n]}return t}var Ts=["p","email","split","utm","r","pgid","o_ss","o_v"],xs=!1;function Ls(){this._batchesByUrls={},this._timeoutId=null,this._config={maxBatchSize:6e4,maxChunkSize:4e3,timeout:1e3,idle:!1},"undefined"!=typeof window&&window.addEventListener("beforeunload",this.process.bind(this,!0))}function js(t){return"s".concat(t,"s").replace(/s+/g,"s").replace(/^s$/g,"")function ks(t,e){for(var r=-1,n=0;n<t.length;n++)if(e===t[n]){r=n;break}return r}Ls.prototype.setConfig=function(t){if(!xs)return t.timeout=Math.max(1e3,t.timeout||0),this._config=Is(this._config,t),void(xs=!0);var e=[];for(var r in t)r in this._config?e.push(r):this._config[r]=t[r];e.length&&Es.warn("Queue config field(s) "+e.join(", ")+" are already set and can't be modified")},Ls.prototype.getConfig=function(){return Is(this._config,{})},Ls.prototype.push=function(t,e){!function(t){for(Ss.push(t);Ss.length>Cs.maxSize;)Ss.shift()}(e);var r=t+"/batch?"+Ls._buildQueryString(e);e=Ls._stringifyParams(e);var n=JSON.stringify(e);if(n.length+2>this._config.maxBatchSize)Es.error("Radar #"+e.uid+" body is too long: "+n);else{this._batchesByUrls[r]||(this._batchesByUrls[r]=[[]]);var o,i=this._batchesByUrls[r];for(o=0;o<i.length;++o){var s=i[o];if(JSON.stringify(s.concat([e])).length<=this._config.maxBatchSize){s.push(e);break}}o===i.length&&i.push([e]),this._timeoutId||"function"!=typeof setTimeout||(this._timeoutId=setTimeout(this.process.bind(this),this._config.timeout))}},Ls.prototype.process=function(t){for(var e in clearTimeout(this._timeoutId),this._timeoutId=null,this._batchesByUrls){for(var r=this._batchesByUrls[e],n=0;n<r.length;++n)this._send(e,r[n],t);delete this._batchesByUrls[e]}},Ls.prototype.isIdle,Ls._buildQueryString=function(t){for(var e=[],r=0;r<Ts.length;++r){var n=Ts[r],o="string"==typeof t[n]?t[n]:JSON.stringify(t[n]);delete t[n],void 0!==o&&o.length&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}var i=[];for(var s in t.baseQuery)i.push(s);i=i.sort();for(var a=0;a<i.length;++a){var u=i[a];e.push(encodeURIComponent(u)+"="+encodeURIComponent(t.baseQuery[u]))}return delete t.baseQuery,e.join("&")},Ls.prototype._send=function(t,e,r){var n={url:t,data:"batch="+encodeURIComponent(JSON.stringify(e)),type:"POST",async:!0};if(!this._config.idle)if(r&&window.navigator.sendBeacon)window.navigator.sendBeacon(n.url,n.data);else{var o=new XMLHttpRequest;"function"==typeof this._config.beforeSend&&!this._config.beforeSend(o,n)?o.abort():(o.open(n.type,n.url,n.async),o.withCredentials=!0,o.send(n.data))}},Ls._stringifyParams=function(t){var e={};for(var r in t)"i"!==r?e[r]="string"==typeof t[r]?t[r]:JSON.stringify(t[r]):e.i=Ls._stringifyI(t.i);return e},Ls._stringifyI=function(t){var e=[];for(var r in t){var n=t[r];e.push(r+":"+n)}return e.join(",")};var Ms=0,Rs=["radarPrefix","split","r","pgid","utm","o_ss","o_v"],Ns=!1,Us=new Ls,Bs="xray_rlog_dot_error",Fs="xray_rlog_msg_abs",Gs="xray_too_long",Ws="xray_not_configured",$s="xray_send_dwh-with-skipdwh";function Vs(){this._config={xrayRadarUrl:"https://xray.mail.ru",pgid:(Date.now()+Math.random()).toString(36),radarPrefix:"",r:"undefined"!=typeof document&&document.referrer||"",defaultParams:{p:"mail",t_feature:"",v:1,skipdwh:!1}}}Vs.prototype.logger=Cs,Vs.prototype.setConfig=function(t,e){if((t=t||{}).split&&(t.split=js(t.split)),Ns)for(var r=0;r<Rs.length;++r)delete t[Rs[r]];Ns=!0,t.defaultParams&&t.defaultParams.i&&(t.defaultParams.i=this._formatIntervals(t.defaultParams.i),delete this._config.defaultParams.i),this._config=e?t:Is(this._config,t),t.gaTrackingId&&this._initGA(t.gaTrackingId)},Vs.prototype.addSplit=function(t){this._config.split=js("".concat(this._config.split||"","s").concat(t))},Vs.prototype.getConfig=function(){return Is(this._config,{})},Vs.prototype.getTotalSended=function(){return Ms},Vs.prototype.setQueueConfig=Ls.prototype.setConfig.bind(Us),Vs.prototype.getQueueConfig=Ls.prototype.getConfig.bind(Us),Vs.prototype.getInstanceCopy=function(){var t=new Vs;return Ns=!1,t.setConfig(this._config,!0),t},Vs.prototype.send,Vs.prototype._send=function(t,e,r,n){if(n&&!Ns&&t!==Ws){var o=e||{};o.t=t,this._logOwnError(o,Ws),Es.warn("Your xray instance is not configured")}if(e=Is(e||{},{}),this._config.middlewares)for(var i=0;i<this._config.middlewares.length;i++){var s=(0,this._config.middlewares[i])(t,e,r);t=s.t,e=s.params,r=s.ga}t=As(t)?t.join("_"):t,e.i&&(e.i=this._formatIntervals(e.i)),e=Is(this._config.defaultParams,e,{t:t,split:this._config.split,r:this._config.r,pgid:this._config.pgid,utm:this._config.utm,o_ss:this._config.o_ss,o_v:this._config.o_v,baseQuery:this._config.baseQuery,uid:Ms++}),n&&e.skipdwh&&e.dwh&&this._logOwnError(e,$s);for(var a=[e.t_feature,this._config.radarPrefix],u=0;u<a.length;++u)a[u]&&(e.t=a[u]+"_"+e.t);delete e.t_feature;try{e=this._validateParams(e,n)}catch(t){return Es.log("xray",e.uid,e),void Es.error(t.message)}if(this._config.verbose&&Es.log("xray",e.uid,e.t,e,r?"GA: "+!!r:void 0),Us.push(this._config.xrayRadarUrl,e),!0!==r||this._config.gaTrackingId){var c="string"==typeof r?r:this._config.gaTrackingId;if(r&&c&&!Us.isIdle()){if(e.i){for(var l in e.i)this._sendGA(t+"_"+l,e.i[l],c);return}this._sendGA(t,e.v,c)}}else Es.error("Radar #"+e.uid+": no GA tracking id specified")},Vs.prototype.sendImmediately=function(t,e,r){this.send(t,e,r),Us.process()},Vs.prototype.addMiddleware=function(t){this._config.middlewares||(this._config.middlewares=[]),-1===ks(this._config.middlewares,t)&&this._config.middlewares.push(t)},Vs.prototype.removeMiddleware=function(t){if(this._config.middlewares){var e=ks(this._config.middlewares,t);e>-1&&this._config.middlewares.splice(e,1)}},Vs.prototype._sendGA=function(t,e,r){"function"!=typeof gtag&&this._initGA(r);var n=t.split(/_/g),o=n[1]||n[0],i=n[1]?n[0]:"",s=n.slice(2).join("_"),a={value:e,send_to:r};i&&(a.event_category=i),s&&(a.event_label=s),gtag("event",o,a)},Vs.prototype._initGA=function(t){if(!window.gtag){var e=document.createElement("script");e.src="https://www.googletagmanager.com/gtag/js?id="+t,e.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(e),window.dataLayer=window.dataLayer||[],window.gtag,gtag("js",new Date)}gtag("config",t,{send_page_view:!1})},Vs.prototype._logOwnError=function(t,e,r){var n="xray_err",o=n,i=t.p;if(i){if(i.length+8+1>32){i=i.slice(0,23)}o="".concat(i,"_").concat(n)}var s=t.t;s.length>64&&(s=s.slice(0,64)),this._send(e,{skipdwh:!0,rlog:o,rlog_message:{t:s,err:e,value:r}},!1,!1)},Vs.prototype._validateParams=function(t,e){(t=Ds(t)).rlog&&-1!==t.rlog.indexOf(".")&&(e&&this._logOwnError(t,Bs,t.rlog),Es.error("Radar #".concat(t.uid,": rlog can not contain file extension")),delete t.rlog,delete t.rlog_message),t.rlog&&t.rlog_message||(t.rlog_message&&(e&&this._logOwnError(t,Fs),Es.error("Radar #".concat(t.uid,": rlog_message would not be sent without rlog"))),delete t.rlog,delete t.rlog_message);var r={32:[t.p,t.rlog],64:[t.p+"_"+t.t]};for(var n in t.i)r[32].push(n),r[64].push(t.p+"_"+t.t+"_"+n);for(var o in r)for(var i=r[o],s=0;s<i.length;++s)if(i[s]&&i[s].length>o)throw e&&this._logOwnError(t,Gs,i[s].slice(0,o)),new Error("Radar #".concat(t.uid,": value is too long: ").concat(r[o][s])+" (len: ".concat(i[s].length,", limit: ").concat(o,")"));return t},Vs.prototype._formatIntervals=function(t){if(Ps(t))return t;var e={};if(As(t)){for(var r=0;r<t.length;++r){var n=t[r].split(":");e[n[0]]=+n[1]||this._config.defaultParams.v}return e}if("string"==typeof t){var o=t.split(",");return this._formatIntervals(o)}};var Ks,Qs,Hs,qs,zs,Js=new Vs;function Ys(t,e){for(var r=t.split("&"),n=r[0],o={},i=1;i<r.length;++i){var s=r[i].split("="),a=decodeURIComponent(s[0]),u=decodeURIComponent(s[1]);try{u=JSON.parse(u)}catch(t){}o[a]=u}(e=e||{}).immediately?Js.sendImmediately(n,o,e.ga):Js.send(n,o,e.ga)}Ys.setConfig=function(t){Js.setConfig(Ds({verbose:t.verbose,pgid:t.pgid,split:t.split,xrayRadarUrl:t.xrayRadarUrl||t.XRAY_RADAR_URL,radarPrefix:t.radarPrefix||t.RadarPrefix,utm:t.utm,o_ss:t.o_ss,o_v:t.o_v,baseQuery:t.baseQuery,gaTrackingId:t.gaTrackingId||t.GA_TRACKING_ID,defaultParams:t.defaultParams||Ds({p:t.project,email:t.ActiveEmail})})),Js.setQueueConfig(Ds({maxBatchSize:t.MAX_BATCH_SIZE,maxChunkSize:t.MAX_CHUNK_SIZE,beforeSend:t.beforeSend,timeout:t.timeout,idle:t.idle}))},Ys.getConfig=Vs.prototype.getConfig.bind(Js),Ys.addSplit=Vs.prototype.addSplit.bind(Js),Ys.setQueueConfig=Vs.prototype.setQueueConfig.bind(Js),Ys.getQueueConfig=Vs.prototype.getQueueConfig.bind(Js),Ys.getTotalSended=Vs.prototype.getTotalSended.bind(Js),Ys.send=Vs.prototype.send.bind(Js),Ys.sendImmediately=Vs.prototype.sendImmediately.bind(Js),Ys.getInstanceCopy=Vs.prototype.getInstanceCopy.bind(Js),Ys.addMiddleware=Vs.prototype.addMiddleware.bind(Js),Ys.removeMiddleware=Vs.prototype.removeMiddleware.bind(Js)(Ks||(Ks={}))(Qs||(Qs={}))(Hs||(Hs={}))(qs||(qs={}))(zs||(zs={}));const Xs=(t,e)=>{!ns&&Ys.send(t,e)};class Zs{constructor(t){this._emitter=new _s,this._instantEmitter=new bs,this._instantEvents=t||[]}getListenersNumber(t){return this._getApiMethod(t,"getListenersNumber")(t)}on(t,e){return this._getApiMethod(t,"on")(t,e),this}removeListener(t,e){return this._getApiMethod(t,"removeListener")(t,e),this}once(t,e){return this._getApiMethod(t,"once")(t,e),this}emit(t,e,r){return this._getApiMethod(t,"emit")(t,e,r),this}_getApiMethod(t,e){return this._instantEvents.includes(t)?this._instantEmitter[e].bind(this._instantEmitter):this._emitter[e].bind(this._emitter)}}class ta extends Zs{constructor(t){let{extendedSettings:e,isDebug:r,siteId:n,isModern:o,experimentId:i,omicron_ShortSegments:s,omicron_Version:a,email:u,idleXray:c=!1}=t;super([cs.InvalidServerSideAuth,cs.ColorThemeChange,cs.ThemeChange,cs.SearchBoxMount,cs.SetPonyMode]),this.xray=(t=>{let{isDebug:e,experimentId:r,siteId:n,isLiteVersion:o=!1,omicron_ShortSegments:i,omicron_Version:s,email:a,idle:u}=t;return Ys.setConfig({idle:u,verbose:e,split:r||"",defaultParams:{p:"whiteline"+(o?"-lite":""),email:a,i:o?n:Ks[n]||"unknown"+(n?`_${n}`:""),skipdwh:!0},o_ss:i,o_v:s}),Ys})({isDebug:r,experimentId:i,siteId:n,omicron_ShortSegments:s,omicron_Version:a,email:u,idle:c}),Xs("load_inline"),Xs(o?"is-modern":"is-legacy"),Xs(`load_inline_${as.BUILD}`),(null==e?void 0:e.hasExternal)&&ws(e.bundleUrl,!0)}}var ea=Qt("match"),ra=I.f,na=bt.f,oa=et.set,ia=Qt("match"),sa=n.RegExp,aa=sa.prototype,ua=/a/g,ca=/a/g,la=new sa(ua)!==ua,ha=bi.UNSUPPORTED_Y;if(i&&xt("RegExp",!la||ha||o()))){for(var da=function(t,e){var r,n,o,i=this instanceof da,s=v(r=t)&&(void 0!==(n=r[ea])?!!n:"RegExp"==h(r)),a=void 0===e;if(!i&&s&&t.constructor===da&&a)return t;la?s&&!a&&(t=t.source):t instanceof da&&(a&&(e=mi.call(t)),t=t.source),ha&&(o=!!e&&e.indexOf("y")>-1)&&(e=e.replace(/y/g,""));var u=si(la?new sa(t,e):sa(t,e),i?this:aa,da);return ha&&o&&oa(u,{sticky:o}),u},fa,pa=na(sa),ga=0;pa.length>ga;)fa(pa[ga++]);aa.constructor=da,da.prototype=aa,rt(n,"RegExp",da)}Yt("RegExp");const va="s",ya=`${va}_`,ma=t=>!(t===va||t.startsWith(ya)||"ph"===t);function _a(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];let[n,o,i]=e;if(void 0!==o){let t="",e=i||{};null===o?e=Object.assign(Object.assign({},e),{expires:-1}):t=o.toString();const r=ma(n)?encodeURIComponent(t):t,s=()=>{if(e.expires&&"number"==typeof e.expires){return`; expires=${new Date(Date.now()+e.expires*on).toUTCString()}`}return""},a=e.path?`; path=${e.path}`:"",u=e.domain?`; domain=${e.domain}`:"",c=e.samesite?`; SameSite=${e.samesite}`:"",l=e.secure?"; secure":"";return document.cookie=`${n}=${r}${s()}${a}${u}${c}${l}`,t}if(document.cookie){let t=(document.cookie.match(new RegExp(`(?:^|; ?)${n}\\=(\\S*?)(?:; ?|$)`))||[])[1];if(ma(n)&&t)try{t=decodeURIComponent(t)}catch(t){}return t}}var ba=function(){if(function(t,e,r){if(!/Version\/.* Safari\//.test(t)||/Chrom(e|ium)/.test(t))return!1;var n=t.match(/\(Macintosh;.*Mac OS X (\d+)_(\d+)[_\d]*.*\) AppleWebKit\//);return n&&n[1]===String(e)&&n[2]===String(r)}(navigator.userAgent,10,14)||function(t,e){var r=t.match(/\(iP.+; CPU .*OS (\d+)[_\d]*.*\) AppleWebKit\//);return r&&r[1]===String(e)}(navigator.userAgent,12))return"";var t,e;return document.cookie="_s_test=1;path=/;SameSite=None;Secure",t="_s_test",((e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(e[1]):void 0)?(document.cookie="_s_test=1;path=/;max-age=-1;SameSite=None;Secure",";SameSite=None;Secure"):""};function wa(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];let[n,o,i,s]=e;const a=new RegExp(`(^|\\|)(${i}=)(.*?)(\\||$)`),u=Object.assign({domain:o,expires:365,path:"/"},";SameSite=None;Secure"===ba()&&{samesite:"None",secure:!0});let c,l;if(i){if(c=_a(n)||"",l=(c.match(a)||[])[3],void 0!==s){let t=null,e="";if(void 0!==l||null===s){let r;r=null===s?(t,e,r,n,o,i,s)=>0===i?"":o:`$1$2${s}$4`,t=c.replace(a,r),e=t}else c&&(e=`${c}|`),e=`${e+i}=${s}`;_a(n,""===t?null:e,u)}else s=l;return s}}const Sa={__domain:`.${ss}`,__prefix:null,_S_cookie_set_get_remove:wa,_getPrefix(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={prefix:t.prefix||Sa.__prefix,domain:t.domain||Sa.__domain};if(!e.prefix||!e.domain)throw new Error("run setProject before");return e},_throw_noValue_Erro,getGlobal,setGlobal:(t,e)=>(void 0===e&&Sa._throw_noValue_Error(),wa(va,Sa.__domain,t,e),Sa.getGlobal(t)),removeGlobal(t){const e=Sa.getGlobal(t);return wa(va,Sa.__domain,t,null),e},setProject(t,e){if(!t||!e)throw new Error("project is not valid");e.startsWith(".")||(e=`.${e}`),Sa.__prefix=t,ns&&(e=e.replace(/.[a-z0-9\-]*.[a-z0-9]*$/,`.${os}`)),Sa.__domain=e},getLocal(t,e){const r=Sa._getPrefix(e);return wa(`${ya}${r.prefix}`,r.domain,t)},setLocal(t,e,r){const n=Sa._getPrefix(r);return void 0===e&&Sa._throw_noValue_Error(),wa(`${ya}${n.prefix}`,n.domain,t,e),Sa.getLocal(t,n)},removeLocal(t,e){const r=Sa._getPrefix(e),n=Sa.getLocal(t,r);return wa(`${ya}${r.prefix}`,r.domain,t,null),n}}class EagetQuery(){const t=this._invoke.bind(this);return t.replaceImpl=this.replaceImpl.bind(this),t}_invoke(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this._fn?this._fn.apply(this._context,e):this._invocations.push(e)}replaceImpl(t,e){if(this._fn)return;const r=e||window;this._invocations.forEach((e=>{t.apply(r,e)})),delete this._invocations,this._fn=t,this._context=r}}let Oa=!1;class Pa extends _s{constructor(t){if(super(),this.show=(new Ea).getQuery(),this.hide=(new Ea).getQuery(),this.insert=(new Ea).getQuery(),t.authGate){const e={allow_external:t.enableExtDomains,vk:t.social.vk?1:null,ok:t.social.ok?1:null,fb:t.social.fb?1:null,mobile_redirect:!!t.authGateMobileRedirect,app_id_mytracker:t.appIdMytracker};t.authGateSuccessRedirectUrl&&(e.success_redirect=t.authGateSuccessRedirectUrl),t.siteId&&Ks[t.siteId]&&(e.project=Ks[t.siteId]),t.enableLoginByPhone&&(e.supports_ph_acc=1),window.__AG_onload=()=>{const t=window.__AG;t&&(t.setSettings(e),this.show.replaceImpl(function(t,e){return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:"navi"};var n;if(t))!function(t,e,r){if(t.focus){const n=r&&"string"==typeof r?r:"login";t.focus(n,))}}(t,e,r.focus);else{if(r){const{preview:e}=function(t){const e=new URLSearchParams(t),r={};return e.forEach()),r}(window.location.search);if(e&&(r.preview=e),!r.type)switch(r.formType){case"login":r.type="login";break;case"relogin":r.type="choice"}!r.success_redirect&&r.successPage&&(r.success_redirect=r.successPage);const o={dwh:{source:r.source},skipdwh:!1};if(Xs("open_auth_form",o),"qrAuth"===r.type)return void(null===(n=null==t?void 0:t.qrAuthForm)||void 0===n||n.show())}t.show(r)}}}(t,this)),this.hide.replaceImpl(function(t){retur}(t)),this.insert.replaceImpl(function(t){return(e,r)=>{t.insert&&(Oa=!0,t.insert(e,r))}}(t)),this.isVisible,_s.relay([ds.Show,ds.Hide,ds.Load],t,this))},ws(function(t,e){const r=new URL(t);return r.searchParams?(Object.entries(e).forEach()),r.toString()):t}(t.authGateVersion||"https://img.imgsmail.ru/ag/2.8.3/authGate.js",{onload:"__AG_onload"}))}}class Aa extends _s{constructor(){super(...arguments),this.show=(new Ea).getQuery(),this.hide=(new Ea).getQuery()}}class Ia extends _s{constructor(){super(...arguments),this.show=(new Ea).getQuery(),this.hide=(new Ea).getQuery()}}class Ta extends _s{constructor(){super(...arguments),this.show=(new Ea).getQuery(),this.hide=(new Ea).getQuery()}}class xa extends _s{constructor(){super(...arguments),this.show=(new Ea).getQuery(),this.hide=(new Ea).getQuery()}}var La,ja={left:La(!1),right:La(!0)},Da=ja.left,ka=di("reduce");jt({target:"Array",proto:!0,forced:!ka||!Mt&&Ft>79&&Ft<83},{reduce});var Ma=e((function(e,r){!function(e){var r;(r||(r={}));const n=t=>Object.entries(t).reduce(((t,e)=>{let[r,n]=e;return null==n?t:Object.assign(t,{[r]:n})}),{})function i(t,e){return Object.entries(e).every((e=>{let[r,n]=e;return n(t[r])}))ass c extends Error}class l extends Error{constructor(){super("Cant display iframe. iframeNode.contentWindow is empty"),Object.setPrototypeOf(this,l.prototype)}}class h extends Error{constructor(){super("containerNode is null"),Object.setPrototypeOf(this,h.prototype)}}class d extends Error}class f(t,e,r){const n=this.listeners.get(t);null==n||n.forEach())}}var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}ar y=v((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.NullStorage=void 0;var r=function()return Object.defineProperty(t.prototype,"length",{get,enumerable:!1,configurable:!0}),t.prototype.key=function(t){var e;return null!==(e=Object.keys(this._data)[t])&&void 0!==e?e:null},t.prototype.getItem,t.prototype.getAsJSON=function(t){var e=this.getItem(t);return null==e?e:JSON.parse(e)},t.prototype.setItem=function(t,e){this._data[t]="".concat(e)},t.prototype.setAsJSON,t.prototype.removeItem,t.prototype.clear,t}();e.NullStorage=r}));g(y),y.NullStorage;var m=v((function(t,e){var r=p&&p.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.SafetyStorage=void 0;var n,o=function(){function t(t){this._init=t,this._storage=new y.NullStorage;try{this._storage=!t.disabled&&t.storage?t.storage():this._storage}catch(t){this._error("init",t)}}return t.prototype._key=function(t,e){var r,n=null!==(r=null==e?void 0:e.keyPattern)&&void 0!==r?r:this._init.keyPattern;return n?"function"==typeof n?n(t):(n||"{key}").replace("{key}",t):t},t.prototype._error=function(){for(var t,e,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];null===(e=(t=this._init).onerror)||void 0===e||e.call.apply(e,r([t],n,!1))},Object.defineProperty(t.prototype,"length",{get:function(){try{return this._storage.length}catch(t){return this._error("length",t),0}},enumerable:!1,configurable:!0}),t.prototype.key=function(t){try{return this._storage.key(t)}catch(e){return this._error("key",e,t),null}},t.prototype.getItem=function(t,e){void 0===e&&(e={});try{var r=e.default,n=this._storage.getItem(this._key(t,e));return null==n&&r&&null!=(n=r())&&this.setItem(t,n,e),null!=n?n:null}catch(e){return this._error("get",e,t),null}},t.prototype.getAsJSON=function(t,e){var r;void 0===e&&(e={});try{var n=e.defaultJSON,o=this.getItem(t,e);if(null==o&&n){var i=null!==(r=n())&&void 0!==r?r:null;return null!=i&&this.setAsJSON(t,i,e),null!=i?i:null}return null==o?null:JSON.parse(o)}catch(e){return this._error("get",e,t),null}},t.prototype.setItem=function(t,e,r){try{this._storage.setItem(this._key(t,r),e)}catch(r){this._error("set",r,t,e)}},t.prototype.setAsJSON=function(t,e,r){try{this.setItem(t,JSON.stringify(e),r)}catch(r){this._error("set",r,t,e)}},t.prototype.removeItem=function(t,e){try{this._storage.removeItem(this._key(t,e))}catch(e){this._error("remove",e,t)}},t.prototype.clear=function(t){var e;try{if(!(null!==(e=null==t?void 0:t.keyPattern)&&void 0!==e?e:this._init.keyPattern))return void this._storage.clear();for(var r=this._key("<any>",t),o=new RegExp("^".concat(n(r).replace("<any>","(.+)"),"$")),i=this._storage.length;i--;){var s=this.key(i);s&&o.test(s)&&this.removeItem(s,{keyPattern:!1})}}catch(t){this._error("clear",t)}},t}();e.SafetyStorage=o}));g(m),m.SafetyStorage;var _=v((function(t,e){var r,n=p&&p.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=p&&p.__assign||function(){return o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.SafetyLocalStorage=void 0;var i=function(t){function e(e){return t.call(this,o({storage:function(){return localStorage}},e))||this}return n(e,t),e}(m.SafetyStorage);e.SafetyLocalStorage=i}));g(_),_.SafetyLocalStorage;var b=v((function(t,e){var r,n=p&&p.__extends||(r),o=p&&p.__assign||function(){return o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.SafetySessionStorage=void 0;var i=function(t){function e(e){return t.call(this,o({storage},e))||this}return n(e,t),e}(m.SafetyStorage);e.SafetySessionStorage=i}));g(b),b.SafetySessionStorage;var w=v((function(t,e){var r=p&&p.__assign|,n=p&&p.__spreadArray|;Object.defineProperty(e,"__esModule",{value:!0}),e.createSafetyStorages=void 0;var o=function(t){var e=function(e){return function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null===(r=t.onerror)||void 0===r||r.call.apply(r,n([t,e],o,!1))}};return[new _.SafetyLocalStorage(r(r({},t),{onerror:e("local")})),new b.SafetySessionStorage(r(r({},t),{onerror:e("session")})),new m.SafetyStorage(r(r({},t),{onerror:e("runtime")}))]};e.createSafetyStorages=o}));g(w),w.createSafetyStorages;var S=v());g(S),S.createSafetyStorages,S.SafetySessionStorage;var C=S.SafetyLocalStorage;S.SafetyStorage,S.NullStorage;const E=t=>{let e=!1;return function(){if(!e)return e=!0,t(...arguments)}},O=t=>{let e;const r=E((function(){e=t(...arguments)}));return function(){return r(...arguments),e}},P={WIDGETS_ACTIVE_PANEL:"WIDGETS_ACTIVE_PANEL",WIDGETS_IS_OPENED:"WIDGETS_IS_OPENED"};class A{constructor(t){this.storage=new C({keyPattern})}getActivePanel(){return this.storage.getAsJSON(P.WIDGETS_ACTIVE_PANEL)}saveActivePanel(t){return this.storage.setAsJSON(P.WIDGETS_ACTIVE_PANEL,t)const I=O());var T=v());g(T),T.Tag;var x=v((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.coreLoggerDispatchKnownError=e.coreLoggerDispatchAPIError=e.coreLoggerDispatchIgnoredError=e.coreLoggerDispatchSelfError=e.coreLoggerDispatchReactError=e.coreLoggerDispatchError=e.getCoreLogger=e.Tag=void 0,Object.defineProperty(e,"Tag",{enumerable:!0,get:function(){return T.Tag}});var r;e.getCoreLogger=r;var n=function(t,r,n){var o;null===(o=(0,e.getCoreLogger)())||void 0===o||o.dispatchError(t,r,n)};e.coreLoggerDispatchError=n;var o=function(t,r,n){var o;null===(o=(0,e.getCoreLogger)())||void 0===o||o.dispatchReactError(t,r,n)};e.coreLoggerDispatchReactError=o;var i=function(t,r,n,o){(0,e.coreLoggerDispatchError)(r,n,{category:t,tag:T.Tag.Self,log:o})};e.coreLoggerDispatchSelfError=i;var s=function(t,r,n,o){(0,e.coreLoggerDispatchError)(r,n,{category:t,tag:T.Tag.Ignore,log:o})};e.coreLoggerDispatchIgnoredError=s;var a=function(t,r,n,o){(0,e.coreLoggerDispatchError)(r,n,{category:t,tag:T.Tag.API,log:o})};e.coreLoggerDispatchAPIError=a;var u=function(t,r,n,o){(0,e.coreLoggerDispatchError)(r,n,{category:t,tag:T.Tag.Known,log:o})};e.coreLoggerDispatchKnownError=u}));g(x),x.coreLoggerDispatchKnownError,x.coreLoggerDispatchAPIError,x.coreLoggerDispatchIgnoredError,x.coreLoggerDispatchSelfError,x.coreLoggerDispatchReactError,x.coreLoggerDispatchError,x.getCoreLogger,x.Tag;var L=v((function(t,e){function r(t,e){var r=t<10?"0".concat(t):t;return e>1&&t<100&&(r="0".concat(r)),r}function n(t){var e=t/1e3;return"".concat(r(e/60%24|0),":").concat(r(e%60|0),".").concat(r(t%1e3|0,2))}Object.defineProperty(e,"__esModule",{value:!0}),e.timeFormat=e.zeroPad=e.now=void 0,e.now="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:Date.now,e.zeroPad=r,e.timeFormat=n}));g(L),L.timeFormat,L.zeroPad,L.now;var j=v((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.browserFormat=e.resetFormatStyle=e.nodeFromat=e.createFormat=void 0;var r=/:([^;]+)/g;function n(t,e){return function(r){return e(r,{base:t.level[r.level]||"",label:t.label[r.level]||""})}}e.createFormat=n,e.nodeFromat=n({level:{log:"[0m",info:"[34m",done:"[34m",warn:"[33m",error:"[31m",verbose:"[35m"},label:{log:"[4m",info:"[4m",done:"[4m",error:"[4m",warn:"[4m",verbose:"[4m"}},(function(t,e){var r=[];return null!=t.badge&&r.push(t.badge),null!=t.label&&r.push("".concat(e.base).concat(e.label).concat(t.label,"[0m")),null!=t.args&&r.push.apply(r,t.args),null!==t.meta&&r.push("".concat(t.meta.file,":").concat(t.meta.line,":").concat(t.meta.col)),r.push("[0m"),r}));var o="text-decoration: underline; font-weight: bold;"e.resetFormatStyle=i,e.browserFormat=n({level:{log:"color: #333;",info:"color: dodgerblue;",done:"color: #1aaa55;",warn:"color: orange;",error:"color: red;",verbose:"color: magenta;"},label:{log:o,info:o,done:o,warn:o,error:o,verbose:o}},(function(t,e){var r=[],n=[],o=t.args;if(t.ts>0&&(n.push("%c[%s] "),r.push(e.base,(0,L.timeFormat)(t.ts))),null!=t.badge&&(n.push("%s"),r.push(t.badge)),null!=t.label&&(n.push("%c%s%c "),r.push(e.label+e.base,t.label,i(e.label))),null!=o){var s=o.length;if(s>0){n.push("%c"),r.push(e.base);for(var a=0;a<s;a++){var u=o[a];n.push("".concat("string"==typeof u?"%s":"%o"," ")),r.push(u)}}}return null!=t.meta&&(n.push("%s"),r.push("".concat(t.meta.file,":").concat(t.meta.line,":").concat(t.meta.col))),r.unshift(n.join("")),r}))}));g(j),j.browserFormat,j.resetFormatStyle,j.nodeFromat,j.createFormat;var D=v());g(D),D.SCOPE,D.ENTRY;var k=v((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.universalOutput=e.browserOutput=e.nodeOutput=e.createOutput=void 0;var r=function(t){var e=t.out,r=t.format,n=e.log,o={},i=[];function s(t,a){if(null===t)return i.forEach((function(){e.groupEnd()})),void(i.length=0);var u=t.parent,c=i.length;if(!a||!t.printed){if(c>0){for(var l=c;l--&&i[l]!==u;)i[l].printed=!0,e.groupEnd();i.length=l+1}if(t.type===D.SCOPE)i.push(t),e.group.apply(e,r(t));else{if(!a&&u&&u.printed&&"#root"!==u.label)return void(o[u.cid]||(o[u.cid]=setTimeout((function(){i.forEach((function(){e.groupEnd()})),i.length=0;var t=[],n=u;do{t.unshift(n),n=n.parent}while(n&&"#root"!==n.label);t.forEach()),u.entries.forEach()),t.forEach())}),0)));t.printed=!0,n.apply(e,r(t))}}}return s};e.createOutput=r;var n=function(t){return void 0===t&&(t={}),(0,e.createOutput)({out:t.out||console,format:t.format||j.nodeFromat})};e.nodeOutput=n;var o=function(t){return void 0===t&&(t={}),(0,e.createOutput)({out:t.out||console,format:t.format||j.browserFormat})};e.browserOutput=o,e.universalOutput="undefined"==typeof self?e.nodeOutput:e.browserOutput}));g(k);var M=k.universalOutput;k.browserOutput,k.nodeOutput,k.createOutput;var R=v((function(t,e){var r=p&&p.__assign||function(){return r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.octoLogger=e.logger=e.createLogger=e.revertLoggerContext=e.switchLoggerContext=e.getLoggerContext=e.createScopeEntry=e.createLogEntry=e.isLogEntry=void 0;var n=new Date,o=0;function i(t){return t&&3===t.length&&t[0]&&t[1]>0&&t[2]>0}function s(t){return{file:t[0],line:t[1],col:t[2]}function u(t,e,r,n,i){return Object.defineProperty({cid:++o,ts:0,type:t,level:e,badge:r,label:n,args:i,meta:null,entries:[]},"parent",{writable:!0,enumerable:!1,value:null})}function c(t,e,r,n){return u(D.ENTRY,t,e,r,n)}function l(t,e,r,n){return u(D.SCOPE,t,e,r,n)}e.isLogEntry=a,e.createLogEntry=c,e.createScopeEntry=l;var h=nullfunction f(t,e){if(null===t)return h=null,null;var r=h,n=t.scope,o=t.scopeContext,i=null;return h=t,t.scope=e,t.scopeContext&&(i=t.scopeContext.parent,t.scopeContext.parent=e.scope()),{activeContext:r,ctx:t,scope:n,scopeContext:o,scopeContextParent:i}}function g(t){var e=t.ctx,r=t.scopeContext;e.scope=t.scope,e.scopeContext=r,r&&(r.parent=t.scopeContextParent),h=t.activeContext}function v(t,e){var o=function(e){return{add:function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o,u=i(r[0])?s(r.shift()):null;o=a(r[0])?r[0]:c("log",null,null,r),null!==u&&(o.meta=u),t.time&&(o.ts=(0,L.now)());var l=e.parent;return l&&(o.parent=l).entries.push(o)>t.storeLast&&l.entries.splice(0,1),!0!==t.silent&&t.output&&t.output(o),o}}},u=l("info","🚧","#root",[{time:n,created:new Date}]),d={logger:null,parent:u},f=o(d),p=e({createEntry:c,logger:f});return null==t.silent&&"undefined"!=typeof location&&(t.silent=!/^(about:|file:|https?:\/\/localhost\/)/.test("".concat(location))),null==t.time&&(t.time=!0),null==t.storeLast&&(t.storeLast=1e3),d.logger=f,["add","clear","scope","setup","entries","last","priny","m"].forEach((function(t){if(p.hasOwnProperty(t))throw new Error('[octoLogger] "'.concat(t,'" is a reserved identifier'))})),p.print=function(){var e=function(r){r.printed=!1,r.entries.forEach((function(r){r.printed=!1,t.output&&t.output(r),r.type===D.SCOPE&&e(r)}))};e(u),t.output&&t.output(null)},p.t)},p.clh)},p.see)},p.entries=function(){return u.entries},p.last=function(){return u.entries[u.entries.length-1]||null},p.scope=function r(n,u,f){var p=arguments,g=null;if(0===p.length)return this._scopeEntry;i(p[0])&&(g=s(p[0]),n=p[1],u=p[2],f=p[3]);var v=p.length>2;null==f&&"function"==typeof u&&(f=u,v=!1);var y=[n];v&&y.push(u);var m=a(n)?n:l("info",null,null,y);m.meta=g,d.logger.add(m);var _=o({parent:m,logger:null}),b=e({createEntry:c,logger:_});if(b.s)},b.scope=r,b._scopeEntry=m,"function"==typeof f){var w=h,S=d.parent,C=d.logger;h={entry:m,scope:b,logger:_,options:t,scopeContext:d},d.parent=m,f(b),h=w,d.parent=S,d.logger=C}return b},p}e.getLoggerContext=d,e.switchLoggerContext=f,e.revertLoggerContext=g,e.createLogger=v;var y={log:null,info:"❕ ",done:"✅ ",warn:"⚠️ ",error:"🛑 ",verbose:"🔎 "};e.logger=v({output:(0,k.universalOutput)()},(function(t){var e=t.logger;return Object.keys(y).reduce((function(t,r){return t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.add(c(r,y[r]||null,null,t))},t}),{})})),e.octoLogger=e.logger}));g(R),R.octoLogger,R.logger,R.createLogger,R.revertLoggerContext,R.switchLoggerContext,R.getLoggerContext,R.createScopeEntry,R.createLogEntry,R.isLogEntry;var N=v((function(t,e){var r=p&&p.__createBindin&(n=r),t[n]=e[r]}),n=pl(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.createScopeEntry=e.createLogEntry=e.createLogger=e.octoLogger=e.logger=void 0,n(x,e),Object.defineProperty(e,"logger",{enumerable:!0,get:function(){return R.logger}}),Object.defineProperty(e,"octoLogger",{enumerable:!0,get:function(){return R.octoLogger}}),Object.defineProperty(e,"createLogger",{enumerable:!0,get:function(){return R.createLogger}}),Object.defineProperty(e,"createLogEntry",{enumerable:!0,get:function(){return R.createLogEntry}}),Object.defineProperty(e,"createScopeEntry",{enumerable:!0,get:function(){return R.createScopeEntry}})}));g(N),N.createScopeEntry,N.createLogEntry;var U=N.createLogger;N.octoLogger,N.logger;const B=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"WIDGETS";return U({output:M()},(e=>{let{logger:r,createEntry:n}=e;return{ok(e){for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];r.add(n("info","👌 ",`${t}:OK`,[`[${e}]`,...i]))},info(e){for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];r.add(n("info","👀 ",`${t}:INFO`,[`[${e}]`,...i]))},error(e){for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];r.add(n("error","❌ ",`${t}:ERROR`,[`[${e}]`,...i]))}}}))};class F{constructor(t){this.scopedLogger=B(t.DEBUG_SCOPE),this.scopedLogger.setup({silent:!t.DEBUG})}info(){return this.scopedLogger.info(...arguments)}error(){return this.scopedLdLogger.ok(...arguments)}setDebug(t){this.scopedLogger.setup({silent:!t})}}class G{constructor(t){var e=this;this.options=t,this.subscribers=new Set,this.globalListener=t=>{if(!this.checkOrigin(t.origin))return;let e=null;try{e="string"==typeof t.data?JSON.parse(t.data):t.data,this.logger.info("HANDLE",e,t)}catch(e){return void this.handleError("HANDLE",{type:"JSONParseError",details:{event:t,error:e}})}e&&this.checkEventSource(e)&&this.subscribers.forEach((t=>{try{t(e)}catch(t){this.handleError("HANDLE",{type:"HandlerError",details:{error:t}})}}))},this.setDebug=function(){return e.logger.setDebug(...arguments)},this.consumerWindow=t.consumerWindow||window,this.targetWindow=this.options.targetWindow,this.consumerWindow.addEventListener("message",this.globalListener),this.logger=new F(t)}setConsumerWindow(t){this.clearSubscriptions(),this.consumerWindow=t,this.consumerWindow.addEventListener("message",this.globalListener)}setTargetWindow(t){this.targetWindow=t}subscribe(t){return this.subscribers.has(t)||(this.subscribers.add(t),thilogger.ok("UNSUBSCRIBE")}send(t){let e;const r=$(t,this.options.consumerId);try{e=JSON.stringify(r)}catch(t){return void this.handleError("SEND",{type:"JSONStringifyError",details:{error:t,eventType:r.type}})}try{this.logger.info("SEND",r),this.targetWindow.postMessage(e,this.getTargetOrigin()),this.logger.ok("SEND",r)}catch(t){this.handleError("SEND",{type:"SendError",details:{error:t,even.getTargetOrigin()===t}checkEventSource(t){return!!this.options.SKIP_EVENT_SOURCE_CHECK||t.sourceId===this.options.targetId}handleError(t,e){const{type:r,details:n}=e,o=W({type:r,details:n});this.options.onError(o),this.logger.error(t,o)}}function W(t){return{type:"ersign({},t),{sourceId:e})}const V=["autoplay","geolocation","microphone"],K=t=>V.reduce(((e,r)=>e+`rc' ${t}; `),""),Q=t=>!!t,H=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=document.createElement(t);return On]=t;r.setAttribute(e,n)})),r},q=(t,e)=>{if(t)for(const r in e)e.hasOwnProperty(r)&&(t.style[r]=e[r])};let z=0;const J=t=>{var{secureData:e,container:r}=t,n=a(t,["secureData","container"]);z++;const o=`mail-widgets-openIframeWithPOST-${z}`,i="iframeNode"in n?n.iframeNode:H("iframe"),s="src"in n?n.src:i.getAttribute("src");if(i.setAttribute("name",o),!s)throw new Error("Cant open iframe - no src");const u=H("form",{method:"POST",target:o,action:s});q(u,{visibility:"hidden",position:"absolute",left:"-999px",top:"-999px"});const c=ies(e).filter((t=>Q(t[1]))).map((t=>{let[e,r]=t;return H("input",{type:"hidden",name:e,value:r})}));return u.append(...c),document.documentElement.appendChild(u),r.appendChild(i),u.submit(),u.remove(),i},Y=(t,e)=>{const r=n(e),o=new URL(t);for(const t in r){const e=String(r[t]);o.searchParams.set(t,e)}return o.href},X=function(t){let e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{e=JSON.stringify(t)}catch(t){}return void 0===e?r:e};class Z{constructor(t,e,r,n){var o=this;this.debug_scope=t,this.path=e,this.options=r,this.testId=n,this.containerNode=null,this.iframeWindow=null,this.eventBus=new f,this.transportSubscribers=new Set,this.transport=null,this.readyPromise=null,this.readyTimeoutId=void 0,this.updateIframeSrc=this.safeCallSync((t=>{var e;const{query:r,DEBUG:n}=this.options,o=n?{debug:"true",debug_scope:this.debug_scope}:{},i=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.getQuery()),{parent_project:r.parent_project,theme:r.theme,bg_color:r.bg_color,blocked_projects:null===(e=r.blocked_projects)||void 0===e?void 0:e.join(","),target_origin:r.target_origin||window.origin,pony_mode:r.pony_mode?"true":void 0,dwh:X(r.dwh)||void 0}),o),{ftrs:r.ftrs||void 0}),t),s=`${this.widgetsIframeOrigin}/${this.path}`;return this.iframeSrc=Y(s,i),this.iframeSrc})),this.startReadyTimeout=function(){return o.readyTimeoutId=setTimeout(...arguments),o.readyTimeoutis.readyTimeoutId=void 0},this.subscribeToMessage=t=>{var e;return this.transportSubscribers.add(t),null===(e=this.transport)||void 0===e?void 0:e.subscribe(t)},this.unsubscribeFromMessage=t=>{var e;return this.transportSubscribers.delete(t),null===(e=this.transport)||void 0===e?void 0:e.unsubscribe(t)},this.subscribe=function(){return o.eventBus.subscribe(...argnsubscribe(...arguments)},this.renderToNode=this.safeCallAsync((t=>(this.readyPromise||(this.containerNode=t,this.updateIframeSrc(),this.insertIframeNode({container:this.containerNode}),this.initTransport(),this.readyPromise=this.subscribeAppReady()),this.readyPromise))),this.reloadIframe=this.safeCallAsync((()=>u(this,void 0,void 0,(function*(){if(this.killForRemount(),!this.containerNode)throw new h;return this.renderToNode(this.containerNode)})))),this.withReadyPromise=t=>{var e;return null===(e=this.readyPromise)||void 0===e?void 0:e.then(t).catch(this.options.defaultOnError)},this.setDebug=function(){var t;return null===(t=o.transport)||void 0===t?void 0:t.setDebug(...arguments)};const{iframeHost:i}=this.options;this.storage=I(r.activeEmail),this.widgetsIframeOrigin=`https://${i}`,this.iframeNode=document.createElement("iframe"),this.iframeNode.setAttribute("allow",K(this.widgetsIframeOrigin)),this.iframeNode.setAttribute("data-test-id",this.testId),this.iframeSrc=this.updateIframeSrc()||""}insertIframeNode(t){let{container:e}=t;return J({container:e,iframeNode:this.iframeNode,src:this.iframeSrc,secureData:{"x-email":this.options.activeEmail}})}subscribeAppReady(){return this.readyPromise=new Promise((t=>{var e;const r=e=>{var n;"AppReady"===e.type&&(t(this),this.stopReadyTimeout(),null===(n=this.transport)||void 0===n||n.unsubscribe(r))};null===(e=this.transport)||void 0===e||e.subscribe(r);const{DISPLAY_TIMEOUT:n}=this.options;n&&this.startReadyTimeout((()=>{t(this),this.options.defaultOnError(new c(n)),this.kill()}),n)})),this.readyPromise}initTransport(){if(!this.iframeNode.contentWindow)throw new l;this.iframeWindow=this.iframeNode.contentWindow,this)||void 0===e||e.send(t)},targetId:this.PM_TARGET_ID,targetWindow:this.iframeWindow,targetOrigin:this.widgetsIframeOrigin,consumerId:r.LOADER,consumerWindow:window,DEBUG:this.options.DEBUG,DEBUG_SCOPE:this.options.DEBUG_SCOPE}),this.options.handleMessage&&this.transport.subscribe(this.options.handleMessage),this.transport.subscribe(this.handleMessage),ype&&this.reloadIframe()})),this.tran=e?void 0:e.subscribe(t)Remount(){this._kill(!1)}_kill(t){var e;t&&(this.eventBus.clearSubscriptions(),this.transportSubscribers.clear()),null===(e=this.transport)||void 0===e||e.clearSubscriptions(),this.transport=null,this.stopReadyTimeout(),this.readyPromise=null,this.iframeWindow=null,this.iframeNode.remove(),this.onKill()}setDarkTheme(t){return this.options.query.theme=t?"dark":"light",this.withReadyPromise((()=>{var e;null===(e=this.transport)||void 0===e||e.send({type:"SetIsDark",data:t,error:void 0})}))}setPonyMode(t){return this.options.query.pony_mode=t,this.withReadyPromise((()=>{var e;null===(e=this.transport)||void 0===e||e.send({type:"SetIsPonyMode",data:t,error:void 0})}))}setBgColor(t){return this.options.query.bg_color=t,this.withReadyPromise((()=>{var e;null===(e=this.transport)||void 0===e||e.send({type:"SetBgColor",data:t,error:void 0})}))}resetBgColor(){return this.options.query.bg_color=void 0,this.withReadyPromise((()=>{var t;null===(t=this.transport)||void 0===t||t.send({type:"ResetBgColor",data:void 0,error:void 0})}))}handleError(t){return this.options.defaultOnError(t)}safeCallAsync(t){var e=this;return function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return u(e,void 0,void 0,(function*(){try{return yield t(...n)}catch(t){return this.handleError(t)}}))}}safeCallSync(t){var e=this;return function(){try{return t(...arguments)}catch(t){return e.handleError(t)}}}}const tt=["width","height"],et={width:s,height:s};class rt extends Z{constructor(t){super("BUTTON_IFRAME",`${t.version}/button`,t,"mail-widgets-button-frame"),this.options=t,this.PM_TARGET_ID=r.BUTTON,this.handleMessage=t=>{var e,r;switch(t.type){case"ButtonStyle":this.applyButtonSize(t.data);break;case"AddTitle":null===(e=this.containerNode)||void 0===e||e.setAttribute("title",t.data);break;case"RemoveTitle":null===(r=this.containerNode)||void 0===r||r.setAttribute("title","");break;case"ButtonClick":o(this.iframeNode,"mousedown"),o(this.iframeNode,"mouseup"),o(this.iframeNode,"click")}}}getQuery(){const{query:t}=this.options;return:t.text_color}}onKill(){}applyButtonSize(t){const e=n(t);i(e,et)&&tt.forEach((t=>{this.containerNode&&(this.containerNode.style[t]=`${e[t]}px`)}))}setTextColor(t){return this.options.query.text_color=t,this.withReadyPromise((()=>{var e;null===(e=this.transport)||void 0===e||e.send({type:"SetTextColor",data:t,error:void 0})}))}resetTextColor(){return this.options.query.text_color=void 0,this.withReadyPromise((()=>{var t;null===(t=this.transport)||void 0===t||t.send({type:"ResetTextColor",data:void 0,error:void 0})}))}passMainFrameEvent(t){return this.withReadyPromise((()=>{var e;null===(e=this.transport)||void 0===e||e.send({type:"MainFrameEvent",data:t,error:void 0})}))}}var nt=v((function(t,e){Object.defineProperty(e,"__esn!!t&&"string"==typeof t},n=[3,4,6,8],o=function(t){return t.replace("#","")},i=function(t){var e=r(t)?o(t):"";return n.includes(e.length)&&parseInt(e,16).toString(16).toLowerCase().padStart(e.length,"0")===e.toLowerCase()},s=/^rgb(a)?\(\s*((25[0-5]|2[0-4]\d|1\d{2}|\d{1,2})\s*,?\s*){2}(25[0-5]|2[0-4]\d|1\d{2}|\d{1,2})\s*(){return r(t)&&s.test(t)},u=function(t){switch(!0){case i(t):return"#".concat(o(t||""));case a(t):return t||"";default:return""}};e.isHex=i,e.isRGB=a,e.parseValidColor=u}));g(nt),nt.isHex,nt.isRGB;var ot=nt.parseValidColor;class it{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var e,r;this.isActivePIP=!1,this.dpipWindow=null,this.onLeaveDocumentPIP=(t,e)=>{this.options.insertToOriginalDocument(t,e),this.dpipWindow=null,this.isActivePIP=)||void 0===t||t.close()},this.options={insertToDPIPDocument:null!==(e=t.insertToDPe:(t,e)=>t.body.append(e),insertToOriginalDocument:null!==(r=t.insertToOriginr:(t,e)=>t.appendChild(e)}}openDocumentPIP(t){let{containerNode:e,node:r,documentBackground:n,onBeforeInsert:o,onAfterInsert:i,onBeforePIPLeave:s,onAfterPIPLeave:a,width:c,height:l}=t;return u(this,void 0,void 0,(function*(){if(this.isActivePIP)return;if(this.isActivePIP=!0,this.dpipWindow=yield at({width:c||r.offsetWidth,height:l||r.offsetHeight}),!this.dpipWindow)return;const t=document.createElement("style");t.textContent=st(n),this.dpipWindow.document.head.appendChild(t),null==o||o({dpipWindow:this.dpipWindow,node:r}),this.options.insertToDPIPDocument(this.dpipWindow.document,r),null==i||i({dpipWindow:this.dpipWindow,node:r}),this.dpipWindow.addEventListener("pagehide",(()=>{null==s||s({node:r}),this.onLeaveDocumentPIP(e,r),null==a||a({theight: 100%;\n\t}\n\t`}function at(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n;return u(this,void 0,void 0,(function*(){return(yield null===(n=window.documentPictureInPicture)||void 0===n?void 0:n.requctureInPicture"in window}const ct={width:s,height:s};class lt extends Z{constructor(t){super("WIDGETS_IFRAME",t.version,t,"mail-widgets-main-frame"),this.options=t,this.pipManager=null,this.dpipConfig={width:320,height:560},this.PM_TARGET_ID=r.MAIN,this.handleMessage=t=>{switch(t.type){case"DPIPConfig":this.applyRemoteDPIPCfg(t.data);break;case"UpdatePanel":this.options.query.default_panel=t.data;break;case"OpenInDPIP":this.openInDPIP()}},this.initDPIP()}getQuery(){const{query:t}=this.options;return{show_cross:t.show_cross?"true":void 0,defaunKill(){this.closeDPIP()}applyRemoteDPIPCfg(t){i(n(t),ct)&&(this.dpipConfig=Object.assign(this.dpipConfig,n(t)))}initDPIP(){ut()&&(this.pipManager=new it({insertToDPIPDocument:t=>{this.updateIframeSrc({opened_in_pip:"true",blocked_projects:void 0}),this.insertIframeNode({container:t.body})},insertToOriginalDocument:t=>{this.updateIframeSrc({opened_in_pip:void 0}),this.insertIframeNode({container:t})}}))}openInDPIP(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.withReadyPromise((()=>{var r;if(!this.containerNode)throw new h;return null===(r=this.pipManager)||void 0===r?void 0:r.openDocumentPIP({containerNode:this.containerNode,node:this.iframeNode,width:this.dpipConfig.width,height:this.dpipConfig.height,documentBackground:this.getDPIPBackground(),onBeforeInsert:function(){for(var r,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];null===(r=e.onBeforeInsert)||void 0===r||r.call(e,...o),t.eventBus.emit("DPIPBeforeOpen")},onAfterInsert:t=>{var r,n,o;const{dpipWindow:i}=t;if(this.iframeWindow=this.iframeNode.contentWindow,!this.iframeWindow)throw new d;null===(r=this.transport)||void 0===r||r.setTargetWindow(this.iframeWindow),null===(n=this.transport)||void 0===n||n.setConsumerWindow(i),this.subscribeAppReady(),null===(o=e.onAfterInsert)||void 0===o||o.call(e,t),this.eventBus.emit("DPIPOpened")},onBeforePIPLeave:function(){for(var r,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];null===(r=e.onBeforePIPLeave)||void 0===r||r.call(e,...o),t.eventBus.emit("DPIPBeforeClosed")},onAfterPIPLeave:t=>{var r,n,o;if(this.iframeWindow=this.iframeNode.contentWindow,!this.iframeWindow)throw new l;null===(r=this.transport)||void 0===r||r.setTargetWindow(this.iframeWindow),null===(n=this.transport)||void 0===n||n.setConsumerWindow(window),this.subscribeAppReady(),null===(o=e.onAfterPIPLeave)||void 0===o||o.call(e,t),this.eventBus.emit("DPIPClosed")}})}))}getDPIPBackground(){const t=ot(this.options.query.bg_color),e="dark"===this.options.query.theme;return ttorage.saveIsOpened(t)}setMarusiaGetParams(t){return this.withReadyPromise((()=>{var e;null===(e=this.transport)||void 0===e||e.send({type:"SetMarusiaGetParams",data:t,error:void 0})}))}resetMarusiaGetParams(){return this.withReadyPromise((()=>{var t;null===(t=this.transport)||void 0===t||t.send({type:"ResetMarusiaGetParams",data:void 0,error:void 0})}))}setActivePanel(t){return this.withReadyPromise((()=>{var e;null===(e=this.transport)||void 0===e||e.send({type:"SetActivePanel",data:t,error:void 0})}))}passButtonFrameEvent(t){return this.withReadyPromise((()=>{var e;null===(e=this.transport)||void 0===e||e.send({type:"ButtonFrameEvent",data:t,error:void 0})}))}}class ht{constructor(t){this.options=t,this.main=new lt(Object.assign(Object.assign(Object.assign({},this.options),this.options.main),{handleMessage:t=>{var e,r;this.button.passMainFrameEvent(t),null===(r=(e=this.options.main).handleMessage)||void 0===r||r.call(e,t)},DISPLAY_TIMEOUT:this.options.main.DISPLAY_TIMEOUT||this.options.DISPLAY_TIMEOUT,DEBUG:this.options.main.DEBUG||this.options.DEBUG,DEBUG_SCOPE:this.options.main.DEBUG_SCOPE||this.options.DEBUG_SCOPE})),this.button=new rt(Object.assign(Object.assign(Object.assign({},this.options),this.options.button),{handleMessage:t=>{var e,r;this.main.passButtonFrameEvent(t),null===(r=(e=this.options.button).handleMessage)||void 0===r||r.call(e,t)},DISPLAY_TIMEOUT:this.options.button.DISPLAY_TIMEOUT||this.options.DISPLAY_TIMEOUT,DEBUG:this.options.button.DEBUG||this.options.DEBUG,DEBUG_SCOPE:this.options.button.DEBUG_SCOPE||this.options.DEBUG_SCOPE}))}setDarkThemeToBoth(t){this.button.setDarkTheme(t),this.main.setPonyMode(t)}}e.ButtonIframeLoader=rt,e.ContainerNodeNullError=h,e.ContentWindowNullError=l,e.DPIPContentWindowNullError=d,e.DisplayTimeoutError=c,e.MAIL_WIDGETS_STORAGE_KEYS=P,e.MainIframeLoader=lt,e.PostMessageTransport=G,e.WidgetsLoader=ht,e.WidgetsLoaderStorage=A,e.getWidgetsLoaderStorage=I,Object.defineProperty(e,"__esModule",{value:!0})}(r)}));class Ra extends _s{constructor(t){super(),this.show=(new Ea).getQuery(),this.hide=(new Ea).getQuery(),this.setMainFrameContainer=(new Ea).getQuery(),this.resetMainFrameContainer=(new Ea).getQuery(),this.openMarusia=(new Ea).getQuery(),this.silenceMarusia=(new Ea).getQuery(),this.widgetsLoaderStorage=Ma.getWidgetsLoaderStorage(t)}}var Na=function(){return Na=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Na.apply(this,arguments)},Ua=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n},Ba=function(t,e,r){if(void 0===r&&(r=!1),!t||!e||"object"!=typeof t||"object"!=typeof e)return t;var n=Na({},t);for(var o in e)e.hasOwnProperty(o)&&(e[o]instanceof Array&&t[o]instanceof Array?n[o]=r?Ua(t[o],e[o]):e[o]:"object"==typeof e[o]&&"object"==typeof t[o]?n[o]=Ba(t[o],e[o],r):n[o]=e[o]);return n},Fa=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n},Ga={defaults:{},errorType:null,polyfills:{fetch:null,FormData:null,URLSearchParams:null,performance:null,PerformanceObserver:null,AbortController:null},polyfill:function(t,e){for(var r=void 0===e?{}:e,n=r.doThrow,o=void 0===n||n,i=r.instance,s=void 0!==i&&i,a=[],u=2;u<arguments.length;u++)a[u-2]=arguments[u];var c=this.polyfills[t]||("undefined"!=typeof self?self[t]:null)||("undefined"!=typeof global?global[t]:null);if(o&&!c)throw new Error(t+" is not defined");return s&&c?new(c.bind.apply(arResourceTimings()),!0)},$a={callbacks:new $a.callbacks.set(t,e)))}}},Va=ja.right,Ka=di("reduceRight");jt({target:"Array",proto:!0,forced:!Ka||!Mt&&Ft>79&&Ft<83},{reduceRight:function(t){return Va(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Qa=function(t){this.error=t},Ha=function(){return Ha=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Ha.+,o++)n[o]=i[s];return n},za="application/json",Ja="Co=o,this._deferre0===r&&(r={}),new t(e,r)},t.prototype.selfFactory=function(e){var r=void 0===e?{}:e,n=r.url,o=void 0===n?this._url:n,i=r.options,s=void 0===i?this._options:i,a=r.catchers,u=void 0===a?this._catchers:a,c=r.resolvers,l=void 0===c?this._resolvers:c,h=r.middlewares,d=void 0===h?this._middlewares:h,f=r.deferredChain,p=void 0===f?this._deferredChain:f;return new t(o,Ha({},s),new Map(u),qa(l),qa(d),qa(Ba(Ga.defaults,t):t,thturn Ga.errorType=t,th{},Ga.polyfills)t+"?"+r[1]:this._url?Ba(this._options,{url:Xa(this._url,t,tions,{headers:t||{}})})},t.prototype.accept=function(t){return this.headers({Accepteaders(((e={})[Jaaders({AuthorizationelfFactory({catcherns),{signal:t.signal})})},t.prototype.resolve=function(t,e){return void 0===e&&(e=!1),this.selfFactory({resolvers:e?[t]:qa(this._resolvers,[t])})},t.prototype.defer=function(t,e){return void 0===e&&(e=!1),this.selfFactory({deferredChain:e?[t]:qa(this._deferredChain,[t])})},t.prototype.middlewares=function(t,e){return void 0===e&&(e=!1),this.selfFactory({middlewares:e?t:qa(this._middlewares,t)})},t.prototype.method=function(t,e,r){void 0===e&&(e={}),void 0===r&&(r=null);var n=this._options.headers,o=r?"object"!=typeof r||n&&!Object.entries(n).every((function(t){var e=t[0],r=t[1];return e.toLowerCase()!==Ja.toLowerCase()||r.startsWith(za)}))?this.body(r):this.json(r):this;return function(t){var e=t._url,r=t._catchers,n=t._resolvers,o=t._middlewares,i=t._options,s=new Map(r),a=Ba(Ga.defaults,i),u=Ga.polyfill("AbortController",{doThrow:!1,instance:!0});!a.signal&&u&&(a.signal=u.signmeoength-2?n(r(e)):n(r)}))}}(o)(Ga.polyfill(ction(t)stat(r(t){return e?e(t):t})))}},p={res:f(null),json:f("json"),blob:f("blob"),formData:f("formData"),arrayBuffer:f("arrayBuff$a.observe({return e.ar:funct,e){return s.set(t,e),p},badRequest:function(t){return p.error(400,t)},unauthorized:function(t){return p.error(401,t)},forbidden:function(t){return p.error(403,t)},notFound:function(t){return p.error(404,t)},timeout:function(t){return p.error(408,t)},internalError:function(t){return p.error(500,t)},fetchError:function(t){return p.error( p.error("AbortErrction(e,r){return r(e,t)}),p)}((o=o.options(Ha(Ha({},e),{method:t})n e(t,t._url,t._options)}),o))},t.prototype.get=function(t){return this.method("GET",t)},t.prototype.delete=function(t){return this.method("DELETE",t)},t.prototype.put=function(t,e){return this.method("PUT",e,t)},t.prototype.post=function(t,e){return this.method("POSTthis.method("PATCH",e,t)},t.prototype.head=function(t){return this.method("Hthis.method("OPTION(this._options.meis._options),{body:t})})},t.prototype.json=function(t){var e,r=null===(e=Object.entries(this._options.headers||{}).find((function(t){var e=t[0],r=t[1];return e.toLowerCase()===Ja.toLowerCase()&&r.startsWith(za)})))||void 0===e?void 0:e[1];return this.content(r||za).body(JSON.stringify(e=!1),this.body(Za(t-form-urgth<2?c[0]+"?"+n:t+"&"+n};function Za(t,e,r,n){return void 0===e&&(e=!1),void 0===r&&(r=Ga.polyfill("FormData",{instance:!0})),void 0===n&&(n=[]),Object.entries(t).forEach((function(t){var ){return t?t+"["+e+"]":e}),null);if(s=s?s+"["+o+"]":o,i instanceof Array)for(var a=0,u=i;a<u.length;a++){var c=u[a];r.append(s+"[]",c)}else!e||"object"!=typeof i||e instanceof Array&&e.includes(o)?r.append(s,i):null!==i&?JSON.stringify(e):""+e)}var eu=Ya.factory;eu.default=Ya.factory;class ru{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.url=t"cors"}:{mode:"no-cors"}}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return eu().options(this.options).url(this.url+e).query(t).query({_:Math.round((new Date).getTime()+1e9*Math.random())}).get().fetchError(((t,e)=>{const r=`${t.message} in request to ${e._url}`;throw new Error(r)}))}getJson(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.get(t,e).json()}post(t){return eu(this.url).options(Object.assign(Object.assign({},this.options),{method:"post"})).formUrl(t).post()}}const nu=ns?"//portal.devmail.ru":`//portal.${ss}`,ou=ns?"//auth.devmail.ru":`//auth.${ss}`,iu=`//ok.ru/mapi?query=${encodeURIComponent('{"cmd":"getCounters"}')}`;var su;!function(t){t.OK="ok",t.NOAUTH="noauth",t.ERROR="error"}(su||(su={}));const au={mac:1,Socials:1};var uu,cu=new class extends ru{constructor(){super(nu)}getInfo(t,e,r){let n=Object.assign(Object.assign(Object.assign({},au),{gamescnt:1}),e);return ns&&(n=Object.assign(Object.assign({},n),{ldata:1})),t&&(n=Object.assign(Object.assign({},n),{Login:t})),r&&(n=Object.assign(Object.assign({},n),{ldata:1,target:1})),this.getJson(n,"/NaviData")}getListInfo(t,e,r){let n=Object.assign(Object.assign(Object.assign({},au),{ldata:1}),e);return t&&(n=Object.assign(Object.assign({},n),{Login:t})),r&&(n=Object.assign(Object.assign({},n),{target:1})),this.getJson(t,"/Domains")}};!function(t){t.OK="ok",t.NOAUTH="noauth",t.MRIM="mrim"}(uu||(uu={}));class lu extends ru{auth(t){const e={mac:1,Login:t};return this.getJson(e,"/cgi-bin/auth")}logout(t){const e={Login:t,mac:1};return this.getJson(e,"/cgi-bin/logout")}}class hu{static convert(t){let{status:e,data:r}=t;var n,o,i;const s=(null===(n=r)||void 0===n?void 0:n.ldata)||{};return{status:e,accounts:(null===(i=null===(o=r)||void 0===o?void 0:o.list)||void 0===i?void 0:i.map((t=>({email:t,active:r.email===t,firstName:s[t].first_name||"",lastName:s[t].last_name||"",socialId:hu.getSocialId(t),verified:!!s[t].verified,counters:{mail:s[t].mail_cnt}}))ok|fb)$/);return e&&e[1]}}const du="s_c";function fu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(let e=0;e<t.length;e+=1){const r=t[e].split("@")[1];if(["corp.mail.ru","vk.team"].includes(r))return Sa.setGlobal(du,Date.now()),!0}const e=Sa.getGlobal(du);if(e&&Date.now()>1*+e+on)return Sa.remo;t[c]=u}c++}l++}return c},vu=gu;jt({targe,0,void 0===t?1:ut(t)),n}}),function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-{rehis.blockSize=e,yu(this)};jt({target:"URL",proto:type.toSte.y,e.width,e.height)},t}(),bu="undefined"!=typeof window?window:{};/msie|trident/i.test(bu.navigator&&bu.nau((r?e:t)||0,(r?t:e)||0)};yu({devicePixelContentBoxSize:wu(),borderBoxSize:wu(),contentBoxSize:wu(),contentRect:new _u(0,0,0,0)});va{constructor(){super(iu)}};class Cu{constructor(t,e,r){let{eventType:n,counterKeys:o}=t;this.eventType=n,this.counterKeys=o,this.updateAccountCouneValue(t){this._value=t}updateData(t){this.eventEmitter.emit(this.eventType,null,this.parseSocialData(t));const e=this.summarizeCounters(this.parseSocialData(t),this.counterKeys);this.value!==e&&this.updateValue(e)}summarizeCounters(t,e){return Object.entries(t).reduce(((t,r)=>{let[n,o]=r;return t+(e[n]?o:0)}),0)}parseSocialData(t){return Object.entries(t).reduce(((t,e)=>{let[r,n]=e;return t[r]=["number","string"].includes(typeof n)?n:n.count,t}),{})}getDataFromApi(){}}class Eu extends Cu{constructor(t,e){super({eventType:us.UpdateCounterOK,counterKeys:Hs},t,e)}getDataFromApi(){Su.getJson().then((t=>{"no auth"===t.status?this.updateAccountCounter({ok:{}}):this.updateAccountCounter({ok:t.data||{}}),Xs("ok_counter_success"),Xs("social_counters_ok_success_api")})).catch((()=>{Xs("ok_counter_error"),Xs("social_counters_ok_er("//vk.com/feed2.php")}};class Pu extends Cu{constructor(t,e){super({eventType:us.UpdateCounterVK,counterKeys:Qs},t,e)}getDataFromApi(){Ou.getJson({act:"widget",utm_source:"mrg_ph"}).then((t=>{var e;-1!==(null===(e=t.user)||void 0===e?void 0:e.id)?this.updateAccountCounter({vk:t||{}}):this.updateAccountCounter({vk:{}}),Xs("vk_counter_success"),Xs("social_counters_v_counters_vk_error_api")}))}}let Au=!1;const Iu=(t,e,r)=>t&&e?`${t} ${e}`:t||e||(t=>{const e=null==t?void 0:t.match(/(.+)@(vk|ok|fb|ph)$/);return(null==e?vo)||t||""})(r),Tu=t=>t||"";class xu{constructor(t){let{ph:e,eventEmitter:r,activeUser:n,authUrl:o=ou,socialCountersSettings:i,stayInAccountList:s,isShowCloudStoriesCounter:a,addTargetToNaviData:u}=t;this.gamesCount=0,this.mailCount=0,this.moymirCount=0,this.loveCount=0,this.cloudCount=0,this.quotaCounters={mail:{},cloud:{}},this.restAccountsMailCount=0,this.accounts=[],this.ph=e,this.eventEmitter=r,this.activeUser=n||void 0,this.parentActiveUser=n||void 0,this.authApi=new lu(function(t){const e="mail.ru"===window.location.host,r=/\.mail\.ru$/.test(window.location.host);return e||r?ou:t}(o)),this.socialCountersSettings=i,this.okCounter=new Eu(this.updateSomeCounters.bind(this),r),this.vkCounter=new Pu(this.updateSomeCounters.bind(this),r),this.isShowCloudStoriesCounter=a,this.stayInAccountList=s,this.loadAccountsList(null,this.getSocialsParams(),u),this.socialCountersSettings.isShowOkCounter&&Xs("social_counters_hit_ok"),this.socialCountersSettings.isShowVKCounter&&Xs("social_counters_hit_vk")}getSocialsParams(){const t={};return this.socialCountersSettings.isShowVKCounter&&this.socialCountersSettings.isVKConnectForVKCounter&&(t.vk_connect=1),this.socialCountersSettings.isShowOkCounter&&this.socialCountersSettings.isServerApiForOKCounter&&(t.ok_counters=1),t}getCloudCounterParams(){const t={};return this.isShowCloudStoriesCounter&&(t.cstories=1),t}getCountersQueryParams(){const t=this.getSocialsParams(),e=this.getCloudCounterParams();return Object.assign(Object.assign({},t),e)}handleSocialCounters(t,e){let{vk_counters:r=null,ok_counters:n=null}=t;var o,i;r&&Object.values(r).length?(Xs("vk_counter_success"),Xs("social_counters_vk_server")):e&&(null===(o=this.socialCountersSettings)||void 0===o?void 0:o.isShowVKCounter)&&(this.vkCounter.getDataFromApi(),r&&Xs("social_counters_vk_repeat")),n&&Object.values(n).length?(Xs("ok_counter_success"),Xs("social_counters_ok_server")):e&&(null===(i=this.socialCountersSettings)||void 0===i?void 0:i.isShowOkCounter)&&(this.socialCountersSettings.isServerApiForOKCounter?this.socialCountersSettings.isClientApiAfterServerApiForOKCounter?this.okCounter.getDataFromApi():this.updateSomeCounters({ok:{}}):this.okCounter.getDataFromApi())}handleSocialCountersErrors(){var t,e;(null===(t=this.socialCountersSettings)||void 0===t?void 0:t.isShowVKCounter)&&(Xs("vk_counter_error"),Xs("social_counters_vk_error_server")),(null===(e=this.socialCountersSettings)||void 0===e?void 0:e.isShowOkCounter)&&(Xs("ok_counter_error"),Xs("social_counters_ok_error_server"))}loadAccountInfo(t,e,r){return cu.getInfo(t,e,r).then((t=>{var r;Xs("load_account_info_success"),t.status===su.OK?(this.handleUpdateAccount(t.data),this.handleSocialCounters(t.data,e),fu(null===(r=t.data)||void 0===r?void 0:r.list)):t.status===su.NOAUTH&&this.handlleSocialCountersErrors()}))}loadAccountsList(t,e,r){let n={};return cu.getListInfo(this.activeUser,e,r).then((t=>{var r;Xs("load_accounts_list_success"),t.status===su.OK?(this.handleUpdateAccount(t.data),this.handleSocialCounters(t.data,e),fu(null===(r=t.data)||void 0===r?void 0:r.list)):t.status===su.NOAUTH&&this.handleClearAccount(),n=t,Au||(Au=!0)})).catch((()=>{Xs("load_accounts_list_error"),this.handleSocialCountersErrors(),n={status:su.E()=>{t&&t(hu.convert(n))}))}logoutAccount(t,e){return this.authApi.logout(t).then((t=>{Xs("logout_account_success"),t.status===su.OK&&this.load("logout_account_error")}))}switchAccountWithReload(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return t?this.authApi.auth(t).then((o=>{let{status:i,data:s,location:a}=o;switch(Xs("switch_account_success"),i){case uu.OK:this.activeUserFullName=Iu(s.first_name,s.last_name,s.email),e?this.loadAccountsList(null,r):this.loadAccountInfo(s.email,r,n);break;case uu.MRIM:return(null===window||void 0===window?void 0:window.location)&&a&&(window.location.href=a),!1;case uu.NOAUTH:if(s.list.includes(t))return this.handleExpiredAccount(t),!1;s.email&&s.list.length?this.stayInAccountList?this.loadAccountInfo(s.email,r):this.loadAccountsList(null,r):s.list.length||this.handleClearAccwitch_account_error"),!0))):Promise.resolve(!0)}updateSomeCounters(t){"mail"in t&&this.updateCounterMail(+t.mail),"love"in t&&this.updateCounterLove(+t.love),"games"in t&&this.updateCounterGames(+t.games),"moymir"in t&&this.updateCounterMoyMir(+t.moymir),"ok"in t&&this.okCounter.updateData(t.ok),"vk"in t&&this.vkCounter.updateData(t.vk),"cloud-with-utm"in t&&this.updateCounterCloudStories(t["cloud-with-utm"]),this.emitAccountDataUpdate()}emitAccountDataUpdate(){this.eventEmitter.emit(us.AccountDataUpdate,null,{activeUser:this.activeUser,activeUserFullName:this.activeUserFullName,parentActiveUser:this.parentActiveUser,gamesCount:this.gamesCount,mailCount:this.mailCount,moymirCount:this.moymirCount,okCount:this.okCounter.value,vkCount:this.vkCounter.value,loveCount:this.loveCount,cloudCount:this.cloudCount,restAccountsMailCount:this.restAccountsMailCount,accounts:this.accounts,quotaCounters:this.quotaCounters})}updateCounterMail(t){"number"==typeof t&&this.mailCount!==t&&(this.eventEmitter.emit(us.UpdateCounterMail,null,{count:t}),this.mailCount=t)}updateCounterLove(t){"number"==typeof t&&this.loveCount!==t&&(this.eventEmitter.emit(us.UpdateCounterLove,null,{count:t}),this.loveCount=t)}updateCounterGames(t){"number"==typeof t&&this.gamesCount!==t&&(this.eventEmitter.emit(us.UpdateCounterGames,null,{count:t}),this.gamesCount=t)}updateCounterMoyMir(t){"number"==typeof t&&this.moymirCount!==t&&(this.eventEmitter.emit(us.UpdateCounterMoyMir,null,{count:t}),this.moymirCount=t)}updateCounterCloudStories(t){const e=this.isShowCloudStoriesCounter?t:0;Number.isInteger(e)&&this.cloudCount!==e&&(this.eventEmitter.emit(us.UpdateCounterCloudStories,null,{count:e}),this.cloudCount=e)}updateQuotaCounters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{mail:r={},cloud:n={}}=this.quotaCounters,{used_cnt:o}=r,{used_cnt:i,total_cnt:s}=n;let a=r,u=n,c=!1;o!==(null==t?void 0:t.used_cnt)&&(a=t,c=!0),i===(null==e?void 0:e.used_cnt)&&s===(null==e?void 0:e.total_cnt)||(u=e,c=!0),c&&(this.eventEmitter.emit(us.UpdateQuotaCounters,null,{mail:a,cloud:u}),this.quotaCounters={mail:a,cloud:u})}handleAuthChange(t,e){const r=Lu(t),n=()=>({email:r,list:t?t.list:[]});if(this.ph.getListenersNumber(cs.AuthChange)&&Au&&this.activeUser!==r)return(new Image).src=`//r3.${is}/k?auth=1&rnd=${Math.random()}`,void this.ph.emit(cs.AuthChange,e,n());Au||!this.activeUser||r||this.ph.emit(cs.InvalidServerSideAuth,null,n()),e()}handleUpdateAccount(t)=>{this.updateAccount(t)}))}updateAccount(t){if(this.parentActiveUser=t.email,this.activeUser=Lu(t),this.restAccountsMailCount=t.mail_notifier?+t.mail_notifier:0,t.ldata){const e=function(t){const e=[];return t.list.forEach((r=>{const n=t.ldata[r].children;let o;n&&(o={},Object.entries(n).forEach((t=>{let[r,n]=t;e.push({user:r,firstName:n.first_name,lastName:n.last_name,mailCounter:n.mail_cnt,verified:!1,child:!0}),o[r]={firstName:n.first_name,lastName:n.last_name,mailCounter:n.mail_cnt,isActive:n.active}})));const i=t.ldata[r];e.push({user:r,firstName:i.first_name,lastName:i.last_name,mailCounter:i.mail_cnt,verified:i.verified,child:i.child,chilt,e)=>(t.set(e.user,e),t)),new Map).values()]}(t);this.a>t.user===this.activeUser));this.activeUserFullName=Iu(Tu(r.firstName),Tu(r.lastName),Tu(r.user))}this.updateCounterMail(+t.mail_cnt),this.updateCounterMoyMir(+t.my_cnt),this.updateCounterGames(+t.games_cnt),this.updateCounterCloudStories(+t.cloud_stories_cnt),this.updateQuotaCounters(null==t?void 0:t.mail_quota_counters,null==t?void 0:t.cloud_quota_counters),t.ok_counters&&Object.values(t.ok_counters).length&&this.okCounter.updateData(t.ok_counters),t.vk_counters&&Object.values(t.vk_counters).length&&this.vkCounter.updateData(t.vk_counters),this.emitAccountDataUpdate()}handleClearAccount(){this.ph.getListenersNumber(cs.AuthLost)&&this.activeUser?this.ph.emit(cs.AuthLost,this.clearAccount,{}):this.handleAuthChange("",this.clearAccount.bind(this))}handleExpiredAccount(t){this.ph.authForm.show({type:"choice",email:t,from:"navi"})}clearAccount(){this.activeUser="",this.activeUserFullName="",this.parentActiveUser="",this.updateCounterMail(0),this.updateCounterLove(0),this.updateCounterGames(0),this.updateCounterMoyMir(0),this.updateCounterCloudStories(0),this.updateQuotaCounters({},{}),this.okCounter.updateData({}),this.vkCounter.updateData({}),this.restAccountsMailCount=0,this.accounts=[],thisactive_email||t.email:""}class ju{constructor(t,e){this._ph=t,this._options=e,document.addEventListener("visibilitychange",this.onVisibilityChange.bind(this))}onVisibilityChange(){const t="hidden"!==document.visibilityState,{socialCountersSettings:{isShowOkCounter:e,isShowVKCounter:r,updateSocialCountersOnVisibilityChange:n},isShowCloudStoriesCounter:o,isHideRightPart:i}=this._options,s=n?this._ph.getSocialsParams():null,a=o?this._ph.getCloudCounterParams():null;if(this._ph.emit(cs.VisibilityChange,null,{visible:t}),t){const t=this._ph.activeUser();t&&!i?(this._ph.switchAccount(t,!1,!1,Object.assign(Object.assign({},s),a)),s&&e&&Xs("social_counters_visibility_change_ok"),s&&r&&Xs("social_counters_visibility_change_vk"),a&&o&&Xs("cloud_counter_visibility_change")):this._ph.loadAccountInfo()}}}let Du,ku;window.__PH=new class extends ta{constructor(t){ku=t,ku||(console.warn("ERROR (PublicPH): no initial settings data"),ku={siteId:"",siteZone:"",experimentId:"",isWhiteline:!0,isDebug:"",activeEmail:"",maxAccounts:"20",counters:{},experiments:{},colorTheme:tn.Default,social:{vk:!1,ok:!1,fb:!1},lang:rn}),super({extendedSettings:t._,isDebug:!!ku.isDebug,siteId:ku.siteId,isModern:ku.isModern,experimentId:ku.experimentId,omicron_ShortSegments:ku.omicron_ShortSegments,omicron_Version:ku.omicron_Version,email:ku.activeEmail,idleXray:ku.idleXray}),this.authForm=new Pa(ku),this.authMenu=new Aa,this.settingsMenu=new Ta,this.searchMenu=new xa,this.marusiaMenu=new Ia,this.mailWidgets=new Ra(ku.activeEmail),this.cookie=Object.assign(_a,{s:Sa,fieldCookie:wa}),Ca()>1?(Sa.setGlobal("rt",1),Sa.setGlobal("dpr",Ca())):(Sa.removeGlobal("rt"),Sa.removeGlobal("dpr"));const e=new bs;Du=new xu({ph:this,eventEmitter:e,activeUser:ku.activeEmail,authUrl:ku.authUrl,socialCountersSettings:{isShowVKCounter:ku.isShowVKCounter,isVKConnectForVKCounter:ku.isVKConnectForVKCounter,isShowOkCounter:ku.isShowOkCounter,isServerApiForOKCounter:ku.isServerApiForOKCounter,isClientApiAfterServerApiForOKCounter:ku.isClientApiAfterServerApiForOKCounter,socialCountersTimer:ku.socialCountersTimer,updateSocialCountersOnVisibilityChange:ku.updateSocialCountersOnVisibilityChange},stayInAccountList:ku.stayInAccountListOnVisibilityChange,isShowCloudStoriesCounter:ys(ku),addTargetToNaviData:ku.addTargetToNaviData}),this.accountSern(us.AccountDataUpdate,t),on:(t,r)=r)=>e.removeListener(t,r)},new ju(this,{socialCountersSettings:Du.socialCountersSettings,isShowCloudStoriesCounter:Du.isShowCloudStoriesCounter,isHideRightPart:ku.isHideRightPart})}getSocialsParams(){return Du.getSocialsParams()}getCloudCounterParams(){return DgetCountersQueryParams()}getSearchPlaceholder(){return new Promise((t=>{thBoxMount,(e=>{t(e.data)}))}))}loadAccountInfo(t,e){return Du.loadAccountInfo(t,e)}loadAccountsList(t,e){return Du.loadAccountsList(t,e)}switchAccount(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;return Du.switchAccountWithReload(t,e,n,o).then((t=>{t&&r&&!this.getListenersNumber(cs.AuthChange)&&wi(){return Du.activeUser}isMultiAed(){return!!ku.authGate}isMarusiaMenuEnabled(){const t=this.activeUser(),e=ku.lang===rn;return!(!(ku.isOnMarusia&&e&&t)||/(@vk|@ok|@fb)$/.test(t))}isMailWidgetsEnabled(){return!!this.activeUser()&&!!ku&&!nn(ku.omicronConfig,"ph-mw-disabled")&&ku.isOnMailWidgets&&ku.isCrossNav}isMarusiaInMailWidgets(){return this.isMarusiaMenuEnabled()&&ku.mailWidgetsUseMarusia&&thDu.updateSomeCounters(t)}setColorTheme(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tn.Default;this.emit(cs.ColorThemeChange,null,{colorTheme:Object.values(tn).includes(t)?t:tn.Default})}setPonyMode(t){this.emit(cs.SetPonyMode,null,{ponyMode:!!t})}}(window.__PHS),Object.freeze(window.__PH)}();
