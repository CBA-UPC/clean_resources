"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9083],{99083:function(e,t,a){a.d(t,{ZP:function(){return TeamDetailsModal},Ry:function(){return useEditTeamReducer}});var r=a(52322),l=a(2784),n=a(56958),s=a(54297),i=a(53515),d=a(45152);function SelectWorkspaceMemberMultiple(e){var t;let{selected:a,onChange:l,placeHolder:n="Select owner"}=e,{workspace:o}=(0,d.cF)(),[{data:c}]=(0,i._)({variables:{workspaceId:null==o?void 0:o.id},pause:!(null==o?void 0:o.id)}),m=(null==c?void 0:null===(t=c.memberships)||void 0===t?void 0:t.map(e=>{let t=null==e?void 0:e.user;return{id:t.id,name:null==t?void 0:t.email,...t}}))||[];return(0,r.jsx)(s.Z,{allowCreate:!1,field:"name",diffField:"id",items:m,selected:a,onChange:l,placeHolder:n})}var o=a(78066),c=a(73235),m=a(66547),u=a(76526),p=a(26806);function _templateObject(){let e=(0,c._)(["\n    mutation CreateTeam($data: TeamCreateInput!) {\n  createTeam(data: $data) {\n    ...Team\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let f=(0,m.ZP)(_templateObject(),u.t);et h=(0,m.ZP)(updateTeam_templateObject(),u.t);var x=a(47330),b=a(86414),v=a(77512);let g={id:"",name:"",description:"",managers:[],members:[]};function formatOptionFromTeamMembers(e,t){return null==e?void 0:e.filter(.map(e=>{var t;return{...e.user,name:null===(t=e.user)||void 0===t?void 0:t.email}})}function useEditTeamReducer(){let[e,t]=(0,l.useReducer)(g);return{editTeam:e,updateEditTeam:t,setEditTeam:function(e){let a=formatOptionFromTeamMembers(e.members,x.qm.Manager),r=formatOptionFromTeamMembers(e.members,x.qm.Member);t({...e,managers:a,members:r})}}}function TeamDetailsModal(e){let{editTeam:t,updateEditTeam:a,open:l,handleClose:s}=e,[,i]=p.Db(f),[,c]=p.Db(h),{workspace:m}=(0,d.cF)(),u=!t.id,handleCreateTeam=async()=>{let{name:e,description:a,managers:r,members:l}=t,s=null==r?void 0:r.map(e=>e.id),d=null==l?void 0:l.map(e=>e.id);return n.A.promise(i({data:{name:e,description:a,managerIds:s,memberIds:d,workspaceId:m.id}}).then(e=>{let{data:t,error:a}=e;if(a)throw a;let r=null==t?void 0:t.createTeam;if(!r)throw Error("Team not created");b.Z.track("team_created")}),{loading:"Creating team...",error:e=>(console.error(e),"Error creating team"),success:()=>"Created team"})},handleUpdateTeam=async()=>{let{id:e,name:a,description:r,managers:l,members:s}=t;if(!e)return;let i=null==l?void 0:l.map(e=>e.id),d=null==s?void 0:s.map(;return n.A.promise(c({data:{id:e,name:a,description:r,managerIds:i,memberIds:d}}).then(,{loading:"Updating team...",error:success:)},onSubmit=async()=>{u?await handleCreateTeam():await handleUpdateTeam(),s()};return(0,r.jsxs)(o.Z,{title:u?"Create Team":"Edit Team",containerClass:"mt-10",containerPadding:"px-6 pt-4 pb-6",open:l,handleClose:s,handleReset:handleNext:onSubmit,nextText:u?"Create":"Save",nextDisabled:!t.name,nextOnEnter:!0,children:[(0,r.jsx)(v.oi,{labelText:"Name",className:"mb-4 w-full",name:"name",placeholder:"Enter name",onChange:e=>a({name:e}),value:t.name}),(0,r.jsx)(v.gx,{labelText:"Description",className:"mb-4 w-full",placeholder:"Enter description",name:"description",rows:1,onChange:e=>a({description:e}),value:t.description}),(0,r.jsx)("label",{className:"label-small",children:"Managers"}),(0,r.jsx)(SelectWorkspaceMemberMultiple,{selected:t.managers,onChange:e=>a({managers:e}),placeHolder:"Add managers"}),(0,r.jsx)("label",{className:"label-small mt-4",children:"Members"}),(0,r.jsx)(SelectWorkspaceMemberMultiple,{selected:t.members,onChange:placeHolder:"Add members"})]})}},54297:]);
//# sourceMappingURL=9083-ff3a60584b0cae66.js.map