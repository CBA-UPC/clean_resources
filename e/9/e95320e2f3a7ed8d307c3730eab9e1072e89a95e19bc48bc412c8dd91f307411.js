!this,function(){unction r(r){var t="";p[r.charAt(0)]&&(t=r.charAt(0),r=r.substring(1));var i="",n="",a=!0,o=!1,s=!1;"+"===t?a=!1:"."===t?(n=".",i="."):"/"===t?(n="/",i="/"):"#"===t?(n="#",a=!1):";"===t?(n=";",i=";",o=!0,s=!0):"?"===t?(n="?",i="&",o=!0):"&"===t&&(n="&",i="&",o=!0);for(var l=[],h=r.split(","),u=[],f={},d=0;d<h.length;d++){var m=h[d],v=null;if(m.indexOf(":")!==-1){var y=m.split(":");m=y[0],v=parseInt(y[1],10)}for(var g={};c[m.charAt(m.length-1)];)g[m.charAt(m.length-1)]=!0,m=m.substring(0,m.length-1);var E={truncate:v,name:m,suffices:g};u.push(E),f[m]=E,l.push(m)}var O=function(r){for(var t="",l=0,h=0;h<u.length;h++){var f=u[h],p=r(f.name);if(null===p||void 0===p||Array.isArray(p)&&0===p.length||"object"==typeof p&&0===Object.keys(p).length)l++;else if(t+=h===l?n:i||",",Array.isArray(p)){o&&(t+=f.name+"=");for(var c=0;c<p.length;c++)c>0&&(t+=f.suffices["*"]?i||",":",",f.suffices["*"]&&o&&(t+=f.name+"=")),t+=a?encodeURIComponent(p[c]).replace(/!/g,"%21"):e(p[c])}else if("object"==typeof p){o&&!f.suffices["*"]&&(t+=f.name+"=");var d=!0;for(var m in p)d||(t+=f.suffices["*"]?i||",":","),d=!1,t+=a?encodeURIComponent(m).replace(/!/g,"%21"):e(m),t+=f.suffices["*"]?"=":",",t+=a?encodeURIComponent(p[m]).replace(/!/g,"%21"):e(p[m])}else o&&(t+=f.name,s&&""===p||(t+="=")),null!=f.truncate&&(p=p.substring(0,f.truncate)),t+=a?encodeURIComponent(p).replace(/!/g,"%21"):e(p)}return t};return O.varNames=l,{prefix:n,substitution:O}}function t(e){if(!(this instanceof t))return new t(e);for(var i=e.split("{"),n=[i.shift()],a=[],o=[],s=[];i.length>0;){var l=i.shift(),h=l.split("}")[0],u=l.substring(h.length+1),f=r(h);o.push(f.substitution),a.push(f.prefix),n.push(u),s=s.concat(f.substitution.varNames)}this.fill=function(e){for(var r=n[0],t=0;t<o.length;t++){var i=o[t];r+=i(e),r+=n[t+1]}return r},this.varNames=s,this.template=e}tion s(e,r){if(e&&"object"==typeof e)if(void 0===r?r=e.id:"string"==typeof e.id&&(r=a(r,e.id),e.id=r),Array.isArray(e))for(var t=0;t<e.length;t++)s(e[t],r);else{"string"==typeof e.$ref&&(e.$ref=a(r,e.$ref));for(var i in e)"enum"!==i&&s(e[i],r)}}function l(e){e=e||"en";var r=P[e];return nction f(e){var r,t,i=new d,n={setErrorReporter:addFormat:function(){i.addFormat.apply(i,arguments)},language:addLanguage:function(e,r){var t;for(t in y)r[t]&&!r[y[t]]&&(r[y[t]]=r[t]);var i=e.split("-")[0];if(P[i]){P[e]=Object.create(P[i]);for(t in r)"undefined"==typeof P[i][t]&&(P[i][t]=r[t]),P[e][t]=r[t]}else P[e]=r,P[i]=r;return this},freshApi:validate:validateResult:validateMultiple:addSchema:function(){return i.addSchema.apply(i,arguments)},getSchema:function(){return i.getSchema.apply(i,arguments)},getSchemaMap:function(){return i.getSchemaMap.apply(i,arguments)},getSchemaUris:function(){return i.getSchemaUris.apply(i,arguments)},getMissingUris:dropSchemas:function(){i.dropSchemas.apply(i,arguments)},defineKeyword:defineError:function(e,r,t){if("string"!=typeof e||!/^[A-Z]+(_[A-Z]+)*$/.test(e))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof r||r%1!==0||r<1e4)throw new Error("Code number must be an integer > 10000");if("undefined"!=typeof y[e])throw new Error("Error already defined: "+e+" as "+y[e]);if("undefined"!=typeof g[r])throw new Error("Error code already used: "+g[r]+" as "+r);y[e]=r,g[r]=e,O[e]=O[r]=t;for(var i in P){var n=P[i];n[e]&&(n[r]=n[r]||n[e])}},reset:missing:[],error:null,valid:!0,normSchema:s,resolveUrl:a,getDocumentUri:o,errorCodes:y};return n.language(e||"en"),n}Object.keys||(Object.keys=)),Object.create||(Object.create=)),Array.isArray||(Array.isArray=,Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null===this)throw new TypeError;var r=Object(this),t=r.length>>>0;if(0===t)return-1;var i=0;if(arguments.length>1&&(i=Number(arguments[1]),i!==i?i=0:0!==i&&i!==1/0&&i!==-(1/0)&&(i=(i>0||-1)*Math.floor(Math.abs(i)))),i>=t)return-1;for(var n=i>=0?i:Math.max(t-Math.abs(i),0);n<t;n++)if(n in r&&r[n]===e)return n;return-1}),Object.isFrozen||(Object.isFrozen=;var p={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},c={"*":!0};t.prototype={toString:fillFromObject:;var d=d.prototype.defineKeyword=d.prototype.createError=d.prototype.returnError=d.prototype.collectError=d.prototype.prefixErrors=d.prototype.banUnknownProperties=d.prototype.addFormat=d.prototype.resolveRefs=function(e,r){if(void 0!==e.$ref){if(r=r||{},r[e.$ref])return this.createError(y.CIRCULAR_REFERENCE,{urls:Object.keys(r).join(", ")},"","",null,void 0,e);r[e.$ref]=!0,e=this.getSchema(e.$ref,r)}return e},d.prototype.getSchema=function(e,r){var t;if(void 0!==this.schemas[e])return t=this.schemas[e],this.resolveRefs(t,r);var i=e,n="";if(e.indexOf("#")!==-1&&(n=e.substring(e.indexOf("#")+1),i=e.substring(0,e.indexOf("#"))),"object"==typeof this.schemas[i]){t=this.schemas[i];var a=decodeURIComponent(n);if(""===a)return this.resolveRefs(t,r);if("/"!==a.charAt(0))return;for(var o=a.split("/").slice(1),s=0;s<o.length;s++){var l=o[s].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===t[l]){t=void 0;break}t=t[l]}if(void 0!==t)return this.resolveRefs(t,r)}void 0===this.missing[i]&&(this.missing.push(i),this.missing[i]=i,this.missingMap[i]=i)},d.prototype.searchSchemas=function(e,r){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.searchSchemas(e[t],r);else if(e&&"object"==typeof e){"string"==typeof e.id&&u(r,e.id)&&void 0===this.schemas[e.id]&&(this.schemas[e.id]=e);for(var i in e)if("enum"!==i)if("object"==typeof e[i])this.searchSchemas(e[i],r);else if("$ref"===i){var n=o(e[i]);n&&void 0===this.schemas[n]&&void 0===this.missingMap[n]&&(this.missingMap[n]=n)}}},d.prototype.addSchema=function(e,r){if("string"!=typeof e||"undefined"==typeof r){if("object"!=typeof e||"string"!=typeof e.id)return;r=e,e=r.id}e===o(e)+"#"&&(e=o(e)),this.schemas[e]=r,delete this.missingMap[e],s(r,e),this.searchSchemas(r,e)},d.prototype.getSchemaMap=d.prototype.getSchemaUris=function(e){var r=[];for(var t in this.schemas)e&&!e.test(t)||r.push(t);return r},d.prototype.getMissingUris=d.prototype.dropSchemas=d.prototype.reset=d.prototype.validateAll=function(e,r,t,i,n){var a;if(r=this.resolveRefs(r),!r)return null;if(r instanceof h)return this.errors.push(r),r;var o,s=this.errors.length,l=null,u=null;if(this.checkRecursive&&e&&"object"==typeof e){if(a=!this.scanned.length,e[this.validatedSchemasKey]){var f=e[this.validatedSchemasKey].indexOf(r);if(f!==-1)return this.errors=this.errors.concat(e[this.validationErrorsKey][f]),null}if(Object.isFrozen(e)&&(o=this.scannedFrozen.indexOf(e),o!==-1)){var p=this.scannedFrozenSchemas[o].indexOf(r);if(p!==-1)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[o][p]),null}if(this.scanned.push(e),Object.isFrozen(e))o===-1&&(o=this.scannedFrozen.length,this.scannedFrozen.push(e),this.scannedFrozenSchemas.push([])),l=this.scannedFrozenSchemas[o].length,this.scannedFrozenSchemas[o][l]=r,this.scannedFrozenValidationErrors[o][l]=[];else{if(!e[this.validatedSchemasKey])try{Object.defineProperty(e,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(e,this.validationErrorsKey,{value:[],configurable:!0})}catch(r){e[this.validatedSchemasKey]=[],e[this.validationErrorsKey]=[]}u=e[this.validatedSchemasKey].length,e[this.validatedSchemasKey][u]=r,e[this.validationErrorsKey][u]=[]}}var c=this.errors.length,d=this.validateBasic(e,r,n)||this.validateNumeric(e,r,n)||this.validateString(e,r,n)||this.validateArray(e,r,n)||this.validateObject(e,r,n)||this.validateCombinations(e,r,n)||this.validateHypermedia(e,r,n)||this.validateFormat(e,r,n)||this.validateDefinedKeywords(e,r,n)||null;if(a){for(;this.scanned.length;){var m=this.scanned.pop();delete m[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(d||c!==this.errors.length)for(;t&&t.length||i&&i.length;){var v=t&&t.length?""+t.pop():null,y=i&&i.length?""+i.pop():null;d&&(d=d.prefixWith(v,y)),this.prefixErrors(c,v,y)}return null!==l?this.scannedFrozenValidationErrors[o][l]=this.errors.slice(s):null!==u&&(e[this.validationErrorsKey][u]=this.errors.slice(s)),this.handleError(d)},d.prototype.validateFormat=d.prototype.validateDefinedKeywords=function(e,r,t){for(var i in this.definedKeywords)if("undefined"!=typeof r[i])for(var n=this.definedKeywords[i],a=0;a<n.length;a++){var o=n[a],s=o(e,r[i],r,t);if("string"==typeof s||"number"==typeof s)return this.createError(y.KEYWORD_CUSTOM,{key:i,message:s},"","",null,e,r).prefixWith(null,i);if(s&&"object"==typeof s){var l=s.code;if("string"==typeof l){if(!y[l])throw new Error("Undefined error code (use defineError): "+l);l=y[l]}else"number"!=typeof l&&(l=y.KEYWORD_CUSTOM);var h="object"==typeof s.message?s.message:{key:i,message:s.message||"?"},u=s.schemaPath||"/"+i.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(l,h,s.dataPath||null,u,null,e,r)}}return null},d.prototype.validateBasic=function(e,r,t){var i;return(i=this.validateType(e,r,t))?i.prefixWith(null,"type"):(i=this.validateEnum(e,r,t))?i.prefixWith(null,"type"):null},d.prototype.validateType=function(e,r){if(void 0===r.type)return null;var t=typeof e;null===e?t="null":Array.isArray(e)&&(t="array");var i=r.type;Array.isArray(i)||(i=[i]);for(var n=0;n<i.length;n++){var a=i[n];if(a===t||"integer"===a&&"number"===t&&e%1===0)return null}return this.createError(y.INVALID_TYPE,{type:t,expected:i.join("/")},"","",null,e,r)},d.prototype.validateEnum=function(e,r){if(void 0===r.enum)return null;for(var t=0;t<r.enum.length;t++){var n=r.enum[t];if(i(e,n))return null}return this.createError(y.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(e):e},"","",null,e,r)},d.prototype.validateNumeric=var m=Math.pow(2,-51),v=1-m;d.prototype.validateMultipleOf=d.prototype.validateMinMax=d.prototype.validateNaN=function(e,r){return"number"!=typeof e?null:isNaN(e)===!0||e===1/0||e===-(1/0)?this.createError(y.NUMBER_NOT_A_NUMBER,{value:e},"","/type",null,e,r):null},d.prototype.validateString=d.prototype.validateStringLength=d.prototype.validateStringPattern=d.prototype.validateArray=function(e,r,t){return Array.isArray(e)?this.validateArrayLength(e,r,t)||this.validateArrayUniqueItems(e,r,t)||this.validateArrayItems(e,r,t)||null:null},d.prototype.validateArrayLength=function(e,r){var t;return void 0!==r.minItems&&e.length<r.minItems&&(t=this.createError(y.ARRAY_LENGTH_SHORT,{length:e.length,minimum:r.minItems},"","/minItems",null,e,r),this.handleError(t))?t:void 0!==r.maxItems&&e.length>r.maxItems&&(t=this.createError(y.ARRAY_LENGTH_LONG,{length:e.length,maximum:r.maxItems},"","/maxItems",null,e,r),this.handleError(t))?t:null},d.prototype.validateArrayUniqueItems=d.prototype.validateArrayItems=d.prototype.validateObject=d.prototype.validateObjectMinMaxProperties=function(e,r){var t,i=Object.keys(e);return void 0!==r.minProperties&&i.length<r.minProperties&&(t=this.createError(y.OBJECT_PROPERTIES_MINIMUM,{propertyCount:i.length,minimum:r.minProperties},"","/minProperties",null,e,r),this.handleError(t))?t:void 0!==r.maxProperties&&i.length>r.maxProperties&&(t=this.createError(y.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:i.length,maximum:r.maxProperties},"","/maxProperties",null,e,r),this.handleError(t))?t:null},d.prototype.validateObjectRequiredProperties=d.prototype.validateObjectProperties=function(e,r,t){var i;for(var n in e){var a=t+"/"+n.replace(/~/g,"~0").replace(/\//g,"~1"),o=!1;if(void 0!==r.properties&&void 0!==r.properties[n]&&(o=!0,i=this.validateAll(e[n],r.properties[n],[n],["properties",n],a)))return i;if(void 0!==r.patternProperties)for(var s in r.patternProperties){var l=new RegExp(s);if(l.test(n)&&(o=!0,i=this.validateAll(e[n],r.patternProperties[s],[n],["patternProperties",s],a)))return i}if(o)this.trackUnknownProperties&&(this.knownPropertyPaths[a]=!0,delete this.unknownPropertyPaths[a]);else if(void 0!==r.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[a]=!0,delete this.unknownPropertyPaths[a]),"boolean"==typeof r.additionalProperties){if(!r.additionalProperties&&(i=this.createError(y.OBJECT_ADDITIONAL_PROPERTIES,{key:n},"","/additionalProperties",null,e,r).prefixWith(n,null),this.handleError(i)))return i}else if(i=this.validateAll(e[n],r.additionalProperties,[n],["additionalProperties"],a))return i}else this.trackUnknownProperties&&!this.knownPropertyPaths[a]&&(this.unknownPropertyPaths[a]=!0)}return null},d.prototype.validateObjectDependencies=d.prototype.validateCombinations=d.prototype.validateAllOf=d.prototype.validateAnyOf=d.prototype.validateOneOf=d.prototype.validateNot=d.prototype.validateHypermedia=function(e,r,i){if(!r.links)return null;for(var n,a=0;a<r.links.length;a++){var o=r.links[a];if("describedby"===o.rel){for(var s=new t(o.href),l=!0,h=0;h<s.varNames.length;h++)if(!(s.varNames[h]in e)){l=!1;break}if(l){var u=s.fillFromObject(e),f={$ref:u};if(n=this.validateAll(e,f,[],["links",a],i))return n}}}};var y={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},g={};for(var E in y)g[y[E]]=E;var O={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="ValidationError",h.prototype.prefixWith=var P={},_=f();return _.addLanguage("en-gb",O),_.tv4=_,_});
//# sourceMappingURL=tv4.min.js.map