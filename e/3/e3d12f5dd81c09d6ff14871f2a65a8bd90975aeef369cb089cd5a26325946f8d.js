(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[125],{r36c:function(e,t,i){"use strict";i.r(t),i.d(t,"ShellBootstrapService",();var n=i("QjXU"),r=i("V9hE"),o=i("lUkk"),s=i("CMIS"),a=i("laSs"),l=i("TfV2"),c=i("XjVN"),u=i("SQAW"),h=i("vcPZ"),S=i("SPVw"),f=i("y3b+"),p=i("vSs+"),v=i("hhzZ"),b=i("BaAg"),m=i("6nG3"),d=i("7Gwk"),g=i("Z0U4"),_=i("5aVq"),E=i("4/We"),C=i("cgnd"),B=i("LQqy"),O=i("/I02"),P=i("PBJH"),y=i("ufVG"),T=i("Hp80"),U=i("hZW2"),L=i("uzn7"),I=i("TIi1"),N=i("keVe"),w=function(){function e(e,t,i,n,r,o,s,a,l,c,u,h,S,f,p,v,b){this.capabilitiesService=e,this.clientStartupConfigService=t,this.consumerInstallConfigService=i,this.consumerPublicDataService=n,this.contextService=r,this.documentService=o,this.eventService=s,this.featureCalloutService=a,this.installConfigService=l,this.instrumentationService=c,this.locService=u,this.localStorageService=h,this.officeRouteService=S,this.reactShellConfigService=f,this.shellShimService=p,this.upsellDataService=v,this.urlLauncherService=b,this.BENEFITS_CALLOUT_SHOWN_LOCAL_STORAGE_KEY="_Benefits_Callout_Shown",this.BENEFITS_SHELL_BUTTON_ID="benefits",this.SHELL_SETTINGS_PANE_ID="Settings",this.isMsa=this.clientStartupConfigService.config.authType===C.a.MSA}return e.prototype.triggerMeetNow=function(){var e=this;this.isMsa&&this.reactShellConfigService.reactShellConfig.meetNowEnabled&&this.shellShimService.getShellShim().then(()},e.prototype.unsubscribe=e.prototype.triggerGoPremium=function(){var e=this;if(this.isMsa&&!this.goPremiumSubscription&&!this.clientStartupConfigService.config.isPipl){var t=this.officeRouteService.getRouteChangeEndObservable(),i=this.getFreeUserObservable();this.goPremiumSubscription=Object(c.b)(t,i).subscribe((function(t){var i=Object(n.__read)(t,2);e.renderGoPremium(i[0],i[1])}))}},e.prototype.triggerBenefits=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t,i=this;return Object(n.__generator)(this,(function(r){return this.isMsa&&this.installConfigService.config.dimeEnabled&&this.isBenefitsButtonSupportedInLocale()&&!this.benefitsSubscription?(e=this.officeRouteService.getRouteChangeEndObservable(),t=this.getPaidConsumerUserObservable(),this.benefitsSubscription=Object(c.b)(e,t).subscribe((),[2]):[2]}))}))},e.prototype.registerSettingsFlexPane=function(){var e,t;return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,a,c,u,h=this;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getShellShim()];case 1:return i=n.sent(),a="ShellVisualSettingsPaneToggle",null==i||i.Extensibility.AddOrUpdateCustomFlexpane({flexPaneID:this.SHELL_SETTINGS_PANE_ID,flexPaneTitle:null!==(e=this.locService.SettingsTitle)&&void 0!==e?e:"",onFlexPaneOpen:function(){Object(o.a)({eventName:a,area:"ShellHeader",id:a,result:"Open",target:"ShellHeader"},l.a.Enhanced)},onFlexPaneClose:function(){Object(o.a)({eventName:a,area:"ShellHeader",id:a,result:"Close",target:"ShellHeader"},l.a.Enhanced)},render:triggerControlID:this.SHELL_SETTINGS_PANE_ID}),[3,3];case 2:return c=n.sent(),Object(s.a)({eventName:"ShellVisualSettingsException"}),Object(r.a)("ShellVisualSettingsException",((u={}).Error=(null===(t=null==c?void 0:c.toString)||void 0===t?void 0:t.call(c))||"",u)),[3,3];case 3:return[2]}}))}))},e.prototype.registerSettingsFlexPaneFeedbackLink=function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(i){return this.feedbackOptions={linkText:e,onLinkClick:t},[2]}))}))},e.prototype.getShellShim=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return(null==(e=t.sent())?void 0:e.Extensibility)?[2,e]:(Object(s.a)({eventName:"ShellVisualSettingsExtensibilityUnavailable"}),[2,void 0])}}))}))},e.prototype.getFreeUserObservable=function(){var e=this;return new u.a((function(t){var i=!1;Promise.all([e.consumerInstallConfigService.getConfig(),e.hasBusinessLicense()]).then((function(r){var o=Object(n.__read)(r,2),s=!i&&e.isFreeUser(o[0],o[1]);t.next(s)})),e.eventService.whenEventFired("convertedToPaid",1).then((function(){i=!0,t.next(!1)}))}))},e.prototype.getPaidConsumerUserObservable=function(){var e=this;return new u.a((function(t){var i=!1;Promise.all([e.consumerInstallConfigService.getConfig(),e.hasBusinessLicense()]).then((function(r){var o=Object(n.__read)(r,2);t.next(i||e.isPaidConsumerUser(o[0],o[1]))})),e.eventService.whenEventFired("convertedToPaid",1).then(()}))},e.prototype.isPaidConsumerUser=function(e,t){if(t)return!0;var i=e&&e.currentSkuInfo?e.currentSkuInfo.skuType:m.b.NotDetected;return i===m.b.O365Home||i===m.b.O365HomeTrial||i===m.b.O365Personal},e.prototype.isFreeUser=function(e,t){var i=e&&e.currentSkuInfo?e.currentSkuInfo.skuType:m.b.NotDetected;return(i===m.b.NotSubscribed||i===m.b.NonActive)&&!t},e.prototype.hasBusinessLicense=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return this.capabilitiesService.capabilities.workloadPublicDataEnabled?[4,this.consumerPublicDataService.getConfig()]:[2,!1];case 1:return[2,e.sent().hasBusinessLicense]}}))}))},e.prototype.renderBenefits=function(e,t){var i=this;this.shellShimService.getShellShim().then((function(n){if(n.Extensibility){var r=i.getBenefitsData(e,t);n.Extensibility.AddOrUpdateCustomHeaderButton(r),r.hideButton||setTimeout((,500)}}))},e.prototype.renderSettingsFlexPane=function(e){var t=this;return Promise.all([i.e(8),i.e(6),i.e(7),i.e(9),i.e(12),i.e(21),i.e(688),i.e(0),i.e(1),i.e(2),i.e(15),i.e(45),i.e(59),i.e(108),i.e(708)]).then(i.bind(null,"aBjV")).then((),e},e.prototype.renderGoPremium=function(e,t){var i=this;t?(this.installConfigService.config.dimeEnabled&&this.upsellDataService.warmupDime("gopremium"),this.shellShimService.getShellShim().then(()):this.shellShimService.getShellShim().then((function(t){t.Extensibility&&t.Extensibility.AddOrUpdateCustomHeaderButton(i.getCustomGoPremiumData(e,!0))}))},e.prototype.getCustomMeetNowData=function(){var e=this;return this.instrumentationService.logImpressionEvent("Meet_Now_Button_Impression"),Object(a.a)({eventName:"Meet_Now_Button_Impression",area:v.b.Shell}),{id:"meetNow",iconFontName:"",ariaLabel:this.locService.MeetNowButtonLabel,affordanceMenuItemText:this.locService.MeetNowButtonLabel,overflowToAffordanceMenu:!0,onShow:function(){e.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(4),i.e(5)]).then(i.bind(null,"DZQ9")).then((function(t){t.launchUrl(e.reactShellConfigService.reactShellConfig.meetNowLinkUrl,{action:"OpenSkypeMeeting"})})):e.urlLauncherService.openUrl(e.reactShellConfigService.reactShellConfig.meetNowLinkUrl,"OpenSkypeMeeting","_blank")},onHide:function(){},hideButton:!1,isStateless:!0}},e.prototype.getCustomGoPremiumData=function(e,t){var n=this,r=this.hideButtonForGoPremium(e.currentRoute.route,e.currentRoute.app,t);return r||(this.instrumentationService.logImpressionEvent("Upsell_Button_Impression"),Object(a.a)({eventName:"Upsell_Button_Impression",area:v.b.Shell})),{id:"goPremium",iconFontName:"",iconFontFamily:"ohpOfficeMDL2Icons",ariaLabel:this.locService.GoPremiumButtonText,affordanceMenuItemText:this.locService.GoPremiumButtonText,overflowToAffordanceMenu:!0,onShow:function(){n.installConfigService.config.dimeEnabled?n.launchDime("gopremium",e.currentRoute.app):n.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(4),i.e(5)]).then(i.bind(null,"DZQ9")).then((function(t){t.launchUrl(n.getUpsellHref(e.currentRoute.app),{action:"Upsell"})})):n.urlLauncherService.openUrl(n.getUpsellHref(e.currentRoute.app),"Upsell",n.getUpsellTarget())},onHide:function(){},buttonText:this.locService.GoPremiumButtonText,hideButton:r,isStateless:!0}},e.prototype.getBenefitsData=function(e,t){var i=this;t&&this.instrumentationService.logGenericEvent("Benefits_Button_Eligible");var n=t&&this.capabilitiesService.capabilities.unityEnabled;return n&&(this.upsellDataService.warmupDime("paidconsumer-unity"),this.instrumentationService.logImpressionEvent("Benefits_Button_Impression"),Object(a.a)({eventName:"Benefits_Button_Impression",area:v.b.Shell})),{id:this.BENEFITS_SHELL_BUTTON_ID,iconFontName:"",iconFontFamily:"ohpOfficeMDL2Icons",ariaLabel:this.locService.BenefitsButtonText,affordanceMenuItemText:this.locService.BenefitsButtonText,overflowToAffordanceMenu:!0,oapp)},on(){},hideButton:!n,isStateless:!0}},e.prototype.isBenefitsButtonSupportedInLocale=function(){return["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","nl-NL","pt-BR","ru-RU","zh-CN"].indexOf(this.contextService.sharedContext.officeMarket)>=0},e.prototype.hideButtonForGoPremium=function(e,t,i){return!!(i||"Start"!==e&&("MyForms"!==e||t!==b.b.Forms)||t!==b.b.Word&&t!==b.b.Excel&&t!==b.b.PowerPoint&&t!==b.b.Forms&&t!==b.b.FormsQuiz)},e.prototype.getUpsellHref=function(e){return this.installConfigService.config.dimeEnabled?"#":this.getUpsellUrl(e)},e.prototype.getUpsellTarget=function(){return this.installConfigService.config.dimeEnabled?null:this.contextService.sharedContext.defaultLinkTarget},e.prototype.getUpsellUrl=function(e){var t=this.upsellDataService.getUpsellTrackingParam();return this.installConfigService.config.shellGoPremiumUrl.replace("{OEM}",t).replace("{APP}",b.b[e])},e.prototype.launchDime=function(e,t,i){var n="paidconsumer-unity"===e?this.installConfigService.config.paidConsumerSubscriptionBenefitsUrl:this.getUpsellUrl(t);if(this.installConfigService.config.dimeEnabled)return null==i||i.preventDefault(),this.upsellDataService.launchDime(e,n)},e.prototype.showBenefitsCallout=function(){if(this.capabilitiesService.capabilities.unityCalloutEnabled&&!this.localStorageService.get(this.BENEFITS_CALLOUT_SHOWN_LOCAL_STORAGE_KEY)){var e=this.documentService.nativeDocument.querySelector("#"+this.BENEFITS_SHELL_BUTTON_ID);e&&(this.featureCalloutService.addCallout(new h.a(e,"Benefits",v.b.Shell,this.locService.BenefitsCalloutTitle,this.locService.BenefitsCalloutSubtitle,null,null,null,!0,!0)),this.localStorageService.set(this.BENEFITS_CALLOUT_SHOWN_LOCAL_STORAGE_KEY,!0),this.instrumentationService.logImpressionEvent("Benefits_Callout_Impression"),Object(a.a)({eventName:"Benefits_Callout_Impression",area:v.b.Shell}))}},e.ɵprov=N.kc({factory:function(){return new e(N.lc(E.a),N.lc(C.b),N.lc(B.a),N.lc(T.a),N.lc(O.a),N.lc(U.a),N.lc(d.a),N.lc(S.a),N.lc(f.a),N.lc(v.a),N.lc(P.a),N.lc(L.a),N.lc(g.a),N.lc(y.a),N.lc(_.a),N.lc(p.a),N.lc(I.a))},token:e,providedIn:"root"}),e}()}}]);
//# sourceMappingURL=125.82500fa0c7a88f6790b6.chunk.v7.js.map