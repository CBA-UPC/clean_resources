/*! For license information please see 67.04aa1a89c62ccf8f3abd.chunk.v7.js.LICENSE.txt */
(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[67],{"0Bs5":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateUserFacts=t.deserializeUserFacts=void 0;var r=n("Zx2D");t.deserializeUserFacts=function(e){var t=[];for(var n in e.UserFacts)if(e.UserFacts.hasOwnProperty(n)){var i=e.UserFacts[n];i&&t.push(r.UserFact.deserialize(i))}return 0===t.length&&(t=null),t},t.validateUserFacts=function(e){if(e)for(var t in e)if(e.hasOwnProperty(t)&&!e[t])return!1;return!0}},"1V07":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"1dVd":function(e,t,n){"use strict";unction i(e,t=window.origin){return new Promise(((n,r)=>{const i=document.createElement("script");i.async=!0,i.readyState?i.onreadystatechange=i.onload=function(){n()},i.onerror=function(){r()},i.src=e,t&&"null"!==t&&(i.crossOrigin="anonymous");const o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(i,o)}))}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},"2ult":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"3d8J":"3ndD":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyStatCollection=void 0;var r=);t.SurveyStatCollection=r},"4p7e":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("ZqsM"),i=n("JUae"),o=n("svnR"),a=n("NIYO").f,s={};function u(e,t){try{if(s={},o.a){var n=o.b(r.a.DynamicSettings);if(!a(n)){var u=n);a(u)||(u.expiryDate="string"==typeof u.expiryDate?new Date(u.expiryDate):u.expiryDate,s[u.contentType]=u)}}if(s.isNOU)return t;var c=s.DynamicSettings&&s.DynamicSettings.content;if(!a(c)&&Object.prototype.hasOwnProperty.call(c,e)&&!a(c[e])){var l=c[e];if("number"==typeof t&&"number"!=typeof l){if("string"==typeof l){var d=-1===l.indexOf(".")?parseInt(l,10):parseFloat(l);return isNaN(d)?t:d}return t}return l}}catch(t){i.a().error("Common_Error",{ErrorMessage:"Error reading dynamic setting "+(t&&t.message),Type:e})}return t}},"58V+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityTrackingSet=void 0;var r=n("FFSN"),i=function(){eturn e.prototype.getIsOrdered=function(){return this.isOrdered},e.prototype.getList=function(){return this.list},e.prototype.getActivityTrackingInfo=function(e,t){var n;if(0===this.list.length)return n={Activities:[],IsListOrdered:this.isOrdered},JSON.stringify(n);for(var i=0,o=this.list;i<o.length;i++){var a=o[i],s=e.getCount(a.getActivity(),t),u={Activity:a.getActivity(),ActualCount:s,Count:a.getCount(),IsAggregate:a.getIsAggregate(),IsDiscrete:s%1==0};r.isNOU(n)?n={Activities:[u],IsListOrdered:this.isOrdered}:n.Activities.push(u)}return JSON.stringify(n)},e}();t.ActivityTrackingSet=i},"7P0z":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?,i=this&&this.__exportStar||Object.defineProperty(t,"__esModule",{value:!0}),t.GovernedChannelType=t.ICampaignDefinitions=t.Api=void 0,i(n("YMYX"),t),t.Api=n("YMYX"),i(n("JNQs"),t),i(n("9RDi"),t);var o=n("KCve");Object.defineProperty(t,"ICampaignDefinitions",{enumerable:!0,get:function(){return o.ICampaignDefinitions}});var a=n("CMUy");Object.defineProperty(t,"GovernedChannelType",{enumerable:!0,get:function(){return a.GovernedChannelType}})},"8+ih":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Survey=void 0;var r=n("7P0z"),i=n("iv/W"),o=n("FFSN"),a=function(){function e(){}return e.prototype.getCampaignId=function(){return this.getSurveyInfo().getBackEndId()},e.prototype.getLauncherType=function(){return this.getSurveyInfo().getLauncherType()},e.prototype.getClientFeedbackId=function(){return this.clientFeedbackId},e.prototype.getTags=e.prototype.submit=function(){var e=r.SurveyType[this.getType()],t=i.FloodgateEngine.getTransportFactory().makeTransporter(e);t.setManifestValues(this.getJsonElements()),this.clientFeedbackId=t.getClientFeedbackId(),t.submit()},e.prototype.getPreGeneratedClientFeedbackId=e}();t.Survey=a},"8YQH":"9RDi":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},BZmE:function(e,t,n){"use strict";n.d(t,"b",(function(){return Ne})),n.d(t,"a",(function(){return Ue})),n.d(t,"d",(function(){return Re})),n.d(t,"c",(function(){return ke}));var r=n("7P0z"),i=n("jtaB"),o=n.n(i),a=n("apcD"),s=n("jay/"),u=n("UUdt"),c=n("DX5p"),l=n("Y3a9"),d=n("HPVw"),p=n("4p7e"),g=n("ZeN8"),v=n("1dVd"),f=n("kZ16"),h=n("svnR");function m(e,t,n,r){var i=function(e,t,n){return{contentType:e,content:t,expiryDate:new Date(Date.now()+n),lastRetrievedDate:new Date}}(e,t,n);return function(e,t){Object(h.c)(null!=t?t:e.contentType,e)}(i,r),i}nction C(e){return!e||!e.expiryDate||e.expiryDate<new Date}function E(e){var t=Object(h.b)(e);return t&&(t.expiryDate="string"==typeof t.expiryDate?new Date(t.expiryDate):t.expiryDate),t}var T=n("tOIY"),b=n("QjXU"),A=n("ZqsM"),F={environment:"prod",userFactsUrl:"https://attributes.engagement.office.com/facts",userFactsRequestTimeOut:3e3,userFactsCacheExpiration:144e5,eventSamplingRate:1},I=F;unction O(){var e=_("eventSamplingRate");return e?e/100:.01}var w=new(function(){function e(){}return e.prototype.setSessionId=function(e){this.sessionId=e},e.prototype.setUserFactRules=function(e){this.userFactRules=e},e.prototype.getSessionId=function(){return this.sessionId},e.prototype.getUserFactRules=function(){return this.userFactRules},e}());function D(){return w}var P=n("JUae"),L=(n("Rvco"),n("NIYO"));function N(e,t,n,r,i){var o={method:"GET",headers:U(t,null,n)};return r?function(e,t,n){return void 0===t&&(t={}),new Promise((function(r,i){fetch(e,t).then(r,i),setTimeout((function(){return i(new Error("Service request timed out"))}),n)}))}(e,o,null!=i?i:5e3):fetch(e,o)}function U(e,t,n){var r="undefined"!=typeof Headers&&new Headers;if(r){if(L.f(e)||r.append("Authorization","Bearer "+e),!L.f(t))for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.append(i,t[i]);r.append("X-CorrelationId",L.c()),n&&r.append("X-ClientSessionId",n)}return r}var M,R=A.a.UserFacts;unction x(e){return null==e?void 0:e.map((function(e){return e.userFactName}))}function B(e,t,n,r,i){void 0===n&&(n=-1),void 0===r&&(r=void 0),void 0===i&&(i=-1);var o=t||{},a=o.headers,s=o.status,u=o.statusText,c=a&&a.get("X-ClientSessionId");return{CorrelationId:a&&a.get("X-CorrelationId")||void 0,Count:n,HttpStatusCode:s||void 0,HttpStatusText:u||void 0,FactNames:k(r),SamplingRate:i,SessionId:c,TimeMilliseconds:+new Date-e}}function V(e){var t=function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o,a,s;return Object(b.__generator)(this,(function(u){switch(u.label){case 0:t=+new Date,n=null,u.label=1;case 1:return u.trys.push([1,6,,7]),r=_("userFactsUrl"),i=O(),[4,N(r,e,D().getSessionId())];case 2:return 200!==(o=u.sent()).status&&204!==o.status?[3,4]:[4,o.json()];case 3:return a=u.sent(),(n=function(e){if(!e||0==e.length)return null;var t=function(e){var t=y(R);return t?e?(t.forEach((function(t){var n=t;if(1==(null==n?void 0:n.source)){var r=e.find(();if(!r)return void e.push(n);t.sourceDateTime>r.sourceDateTime&&(r.sourceDateTime=t.sourceDateTime,r.userFactValue=t.userFactValue,r.source=1)}})),e):t:e}(G(e));return m("UserFacts",t,_("userFactsCacheExpiration"),R),t}(a))&&0!==n.length?P.a().event("UserFacts_Common_Info",B(t,o,n.length,x(n),i),i):P.a().event("UserFacts_Common_Error_No_FactsReturned",B(t,o)),[3,5];case 4:P.a().event("UserFacts_Common_Error",B(t,o)),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),P.a().event("UserFacts_Common_Error",Object(b.__assign)(Object(b.__assign)({},B(t,null)),{error:Object(L.b)(s)})),[3,7];case 7:return[2,n]}}))}))}(e),n=_("userFactsRequestTimeOut");return Object(L.a)(n,t)}function G(e){var t=new Date(Date.now()).toISOString();return e.map((function(e){var n=function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t[i.charAt(0).toLowerCase()+i.substring(1)]=e[i]}return t}(e);return n.clientIngestionDateTime=t,n}))}function j(e,t){void 0===t&&(t=!0);var n="";for(var r in e||[])if(Object.prototype.hasOwnProperty.call(e,r)){var i=e[r];null!=i&&"object"!=typeof i&&(n+=(n?"&":"")+r+"="+(t?encodeURIComponent(i):i))}return n}!M||(M={}));var z=function(){return function(){}}(),q={scenario:"tulips",appId:"https://attributes.engagement.office.com/UserFacts.Read"};function J(e,t){return Object(b.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(b.__generator)(this,(function(a){switch(a.label){case 0:if((e=function(e){return function(e,t){var n=E(e);return C(n)?null:n.content}(R)}())&&0!=e.length)return[3,8];a.label=1;case 1:return a.trys.push([1,6,,7]),(r=t)?[4,t(q)]:[3,3];case 2:r=a.sent(),a.label=3;case 3:return(i=n=r)?[4,V(n)]:[3,5];case 4:i=a.sent(),a.label=5;case 5:return e=i,[3,7];case 6:return o=a.sent(),P.a().event("UserFacts_Common_Error",{error:Object(L.b)(o)}),[3,7];case 7:return[3,9];case 8:P.a().event("UserFacts_Common_LoadedFromCache",function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=void 0),{Count:e,FactNames:k(t)}}(null==e?void 0:e.length,x(e)),O()),a.label=9;case 9:return[2,e]}}))}))}var Y=function(){function e(e,t,n,r,i,o,a,s,u,c,l,d,p,g){var v,f,h,m;this.locale="en-us",this.country="US",this.locale=r,this.country=i,this.authTokenCallback=a,this.app=e,this.platform=t,this.version=n,this.packageVersion=g,this.sessionId=o,this.campaignFlights=s,this.campaignParameters=u,this.ageGroup=c,this.authType=l,this.messagingServiceSettings=p;var y=d&&-1!==["dogfood","edog","int","microsoft"].indexOf(d.toLowerCase()),S=y?null===(v=this.messagingServiceSettings)||void 0===v?void 0:v.campaignMetadataAggregatorInt:null===(f=this.messagingServiceSettings)||void 0===f?void 0:f.campaignMetadataAggregatorProd,C=y?null===(h=this.messagingServiceSettings)||void 0===h?void 0:h.setCampaignActionInt:null===(m=this.messagingServiceSettings)||void 0===m?void 0:m.setCampaignActionProd,E=y?T.n:T.o;this.campaignMetadataAggregatorPrefix=S||(y?T.i:T.j),this.setCampaignActionPrefix=C||E,this.getAuthToken=this.getAuthToken.bind(this)}return e.prototype.getContent=function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return S(A.a[e])?[4,this.refreshItemsInCacheFromTmsService([e])]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,this.retrieveCacheItemAndCreateContentResponse(e)]}}))}))},e.prototype.getMultipleContents=function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o;return Object(b.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.refreshItemsInCacheFromTmsService(e)];case 1:for(a.sent(),t=new Array,n=new Array,r=0,i=e;r<i.length;r++)o=this.createCachedContentResponse(i[r]),t.push(o);return this.refreshItemsInCacheFromTmsService(n),[2,t]}}))}))},e.prototype.getUserFactsContent=function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,()}))},e.prototype.sendBeaconRequestToService=function(e,t,n,r,i,o,a,s){return Object(b.__awaiter)(this,void 0,void 0,(function(){var u,c,l,d,g,v,f,h,m;return Object(b.__generator)(this,(function(y){switch(y.label){case 0:return this.sessionId=a,this.authTokenCallback=s,u={scenario:"TMS",appId:Object(p.a)("TulipsAppId",T.g.TMSAppID)},[4,this.getAuthToken(u)];case 1:return(c=y.sent())?[3,4]:(d=this.authTokenCallback.getUserPuid)?[4,this.authTokenCallback.getUserPuid()]:[3,3];case 2:d=y.sent(),y.label=3;case 3:l=d,y.label=4;case 4:g=+new Date,y.label=5;case 5:return y.trys.push([5,7,,8]),v={app:e,country:o,locale:i,platform:n,puid:l,version:r},f=JSON.stringify({actionName:t.actionName,actionUrl:t.actionUrl}),[4,this.sendRequest(v,c,"TmsActionUrl",this.setCampaignActionPrefix+T.m+"?",{"Content-Type":"application/json;charset=utf-8"},f,"POST")];case 6:return(h=y.sent())&&200===h.status?(P.a().info("WebSurfaces_SetCampaignAction_Requests",this.createTelemetryData(g,h,"Beacon"+t.actionName),.01),[2,!0]):(P.a().event("WebSurfaces_SetCampaignAction_Error",this.createTelemetryData(g,h,"Beacon"+t.actionName)),[2,!1]);case 7:return m=y.sent(),P.a().event("WebSurfaces_SetCampaignAction_Error",Object(b.__assign)({ErrorMessage:"Error fetching from TMS SetCampaignAction endpoint:"+Object(L.b)(m)},this.createTelemetryData(g,null,"Beacon"+t.actionName))),[2,!1];case 8:return[2]}}))}))},e.prototype.getTulipsServiceUserFactsContent=function(){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(e){return[2,J(0,this.getAuthToken)]}))}))},e.prototype.parseCampaignIdFromResponse=function(e){var t=null==e?void 0:e.map(();return null==t?void 0:t.toString()},e.prototype.createTelemetryData=function(e,t,n,r){var i=t||{},o=i.headers,a=i.status,s=i.statusText,u=o&&o.get("X-UserSessionId"),c=o&&o.get("X-CorrelationId");return{Type:n,TimeMilliseconds:+new Date-e,SessionId:u||this.sessionId,CorrelationId:c||void 0,HttpStatusCode:a||void 0,HttpStatusText:s||void 0,Flights:this.campaignFlights,CampaignId:r||void 0}},e.prototype.sendRequest=function(e,t,n,r,i,o,a){var s=j(e),u=Object(p.a)(n,r);return"POST"===a?function(e,t,n,r,i,o,a){var s={method:"POST",headers:U(n,r,i),body:t};return fetch(e,s)}(u+s,o,t,i,this.sessionId):N(u+s,t,this.sessionId)},e.prototype.retrieveCacheItemAndCreateContentResponse=function(e){var t,n=this.createCachedContentResponse(e);return S(A.a[e])?"UserFacts"===e?this.refreshItemsInCacheFromSubstrateTulipsService(e):this.refreshItemsInCacheFromTmsService([e]):"CampaignContent"===e&&P.a().event("Campaign_Retrieved_Cache",{campaignIds:this.parseCampaignIdFromResponse(null===(t=null==n?void 0:n.content)||void 0===t?void 0:t.campaigns)},O()),n},e.prototype.createCachedContentResponse=function(e){var t=new z;return t.content=y(A.a[e]),t.contentType=e,t},e.prototype.getAuthToken=function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o,a,s=this;return Object(b.__generator)(this,(function(u){switch(u.label){case 0:if(!this.authTokenCallback||!this.authTokenCallback.getAuthToken||!e)return[2,null];t=+new Date,n=r=O(),i=function(t,i){return void 0===i&&(i=-1),{Message:t,SamplingRate:r,Scenario:e.scenario,SessionId:s.sessionId,TimeMilliseconds:n(),TokenLegth:i,Type:e.appId}},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.authTokenCallback.getAuthToken(e)];case 2:return o=u.sent(),P.a().event("EngagementAuth_Request_Successful",i("getAuthToken Successful",null==o?void 0:o.length),r),[2,o];case 3:return a=u.sent(),P.a().event("EngagementAuth_Request_Error",i("Error getting token:"+Object(L.b)(a))),[3,4];case 4:return[2,null]}}))}))},e.prototype.refreshItemsInCacheFromTmsService=function(e){var t;return Object(b.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,d,g,v,f,y,C,E;return Object(b.__generator)(this,(function(F){switch(F.label){case 0:if(0===e.length)return[2];for(n=new Array,r=0,i=e;r<i.length;r++)S(A.a[o=i[r]])&&n.push(o);return 0===n.length?[2]:(-1===e.indexOf("DynamicSettings")&&e.push("DynamicSettings"),a={scenario:"TMS",appId:Object(p.a)("TulipsAppId",T.g.TMSAppID)},[4,this.getAuthToken(a)]);case 1:return(s=F.sent())?[3,4]:(c=this.authTokenCallback.getUserPuid)?[4,this.authTokenCallback.getUserPuid()]:[3,3];case 2:c=F.sent(),F.label=3;case 3:u=c,F.label=4;case 4:l=+new Date,F.label=5;case 5:return F.trys.push([5,10,,11]),d=document&&(document.documentElement||document.getElementsByTagName("body")[0]),g={pageWidth:window.innerWidth||d.clientWidth,pageHeight:window.innerHeight||d.clientHeight,screenWidth:screen?screen.width:void 0,screenHeight:screen?screen.height:void 0,colorDepth:screen?screen.colorDepth:void 0},v=h.b("obf-DebugOverrides",{}),f=v.replaceTmsQueryParams||Object(b.__assign)(Object(b.__assign)({country:this.country,locale:this.locale,app:this.app,platform:this.platform,version:this.version,campaignParams:j(g)+"&more=true&"+(this.campaignParameters||""),contentType:e.join(";"),puid:u,OFC_FLIGHTS:this.campaignFlights},v.addTmsQueryParams||{}),{ageGroup:this.ageGroup,sessionUserType:this.authType,packageVersion:this.packageVersion}),[4,this.sendRequest(f,s,"TmsServiceUrl",this.campaignMetadataAggregatorPrefix+T.h+"?")];case 6:return 200!==(y=F.sent()).status?[3,8]:[4,y.json()];case 7:return C=F.sent(),-1!==e.indexOf("MessageMetadata")&&void 0!==C.MessageMetadata&&m("MessageMetadata",C.MessageMetadata,Object(p.a)("TmsMessageMetadataExpiry",T.d),A.a.MessageMetadata),-1!==e.indexOf("UserGovernance")&&void 0!==C.UserGovernanceRules&&m("UserGovernance",C.UserGovernanceRules,Object(p.a)("TmsUserGovernanceRulesExpiry",T.f),A.a.UserGovernance),-1!==e.indexOf("CampaignContent")&&void 0!==C.CampaignContent&&m("CampaignContent",C.CampaignContent,Object(p.a)("TmsCampaignContentExpiry",T.a),A.a.CampaignContent),void 0!==C.DynamicSettings&&m("DynamicSettings",C.DynamicSettings,Object(p.a)("TmsDynamicSettingsExpiry",T.b),A.a.DynamicSettings),void 0!==C.LogLevelSettings&&m("LogLevelSettings",C.LogLevelSettings,Object(p.a)("TmsLogLevelSettingsExpiry",T.c),A.a.LogLevelSettings),P.a().event("WebSurfaces_CampaignMetadataAggregator_Requests",this.createTelemetryData(l,y,e.join(";"),this.parseCampaignIdFromResponse(null===(t=null==C?void 0:C.CampaignContent)||void 0===t?void 0:t.campaigns)),.01),[3,9];case 8:P.a().event("WebSurfaces_CampaignMetadataAggregator_Error",this.createTelemetryData(l,y,e.join(";"))),F.label=9;case 9:return[3,11];case 10:return E=F.sent(),P.a().event("WebSurfaces_CampaignMetadataAggregator_Error",Object(b.__assign)({ErrorMessage:"Error fetching from TMS:"+Object(L.b)(E)},this.createTelemetryData(l,null,e.join(";")))),[3,11];case 11:return[2]}}))}))},e.prototype.refreshItemsInCacheFromSubstrateTulipsService=function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o,a;return Object(b.__generator)(this,(function(s){switch(s.label){case 0:return S(A.a[e])?(t={scenario:"TulipsSubstrate",appId:Object(p.a)("TulipsAppId",T.g.TULIPSSubstrateAppID)},[4,this.getAuthToken(t)]):[2];case 1:if(!(n=s.sent()))return[2];r=+new Date,s.label=2;case 2:return s.trys.push([2,7,,8]),[4,this.sendRequest({},n,"TulipsServiceUrl",T.r)];case 3:return 200!==(i=s.sent()).status&&204!==i.status?[3,5]:[4,i.json()];case 4:return o=s.sent(),-1!==e.indexOf("UserFacts")&&void 0!==o&&m("UserFacts",G(o),T.e,A.a.UserFacts),P.a().event("UserFacts_Messaging_Requests",this.createTelemetryData(r,i,e),.01),[3,6];case 5:P.a().event("UserFacts_Common_Error",this.createTelemetryData(r,i,e)),s.label=6;case 6:return[3,8];case 7:return a=s.sent(),P.a().event("UserFacts_Common_Error",Object(b.__assign)({ErrorMessage:"Error fetching from TULIPS:"+Object(L.b)(a)},this.createTelemetryData(r,null,e))),[3,8];case 8:return[2]}}))}))},e}(),H=n("IqPN");class K{error(e,...t){f.b().logEvent({name:e},2,t)}info(e,...t){f.b().logEvent({name:e},3,t)}warn(e,...t){f.b().logEvent({name:e},3,t)}trace(e,...t){f.b().logEvent({name:e},3,t)}event(e,t,n){f.b().logEvent({name:e},3,t,n)}}class W{constructor(){var e,t;this.configuration=l.d(),Object(P.b)(new K);const n=this.configuration&&this.configuration.getFloodgateInitOptions(),r=this.configuration&&this.configuration.getCommonInitOptions(),i=n&&n.authTokenCallback;if(i&&(i.getAuthToken||i.getUserPuid)||this.isAugLoopEnabled()){const i=this.configuration.getCommonInitOptions();this.tmsgClient=new Y(i.appId.toString(),"Web",i.build,i.originalLocale,this.extractCountryFromLocale(i.originalLocale),this.configuration.getSdkSessionId(),n.authTokenCallback,n.augLoopCallback,n.campaignFlights,n.campaignQueryParameters,r.ageGroup,r.authenticationType,(null===(e=r.telemetryGroup)||void 0===e?void 0:e.audienceGroup)||(null===(t=r.telemetryGroup)||void 0===t?void 0:t.audience),n.messagingServiceSettings)}}getCampaignDefinitions(){const e=function(){var e=h.b("obf-DebugOverrides",{});return e&&e.tmsResponse&&e.tmsResponse.CampaignContent&&{contentType:"CampaignContent",content:e.tmsResponse.CampaignContent}}();return e&&e.content?Promise.resolve(e.content):this.tmsgClient?this.tmsgClient.getContent("CampaignContent").then((({content:e})=>e)):Promise.resolve(null)}etUserGovernanceRules(){return this.tmsgClient?this.tmsgClient.getContent("UserGovernance").then((({content:e})=>e)):Promise.resolve(null)}getMessageMetadata(){return this.tmsgClient?this.tmsgClient.getContent("MessageMetadata").then((({content:e})=>e)):Promise.resolve(null)}getUserFacts(){const e=function(){var e=h.b("obf-DebugOverrides",{});return e&&e.userFactsResponse&&{contentType:"UserFacts",content:e.userFactsResponse}}();if(e&&e.content)return Promise.resolve(e.content);if(!this.tmsgClient)return Promise.resolve(null);if(this.isAugLoopEnabled()){const e=Object(p.a)("TulipsLoadTimeout",T.q);return Object(H.createTimeoutPromise)(e,this.getAugLoopUserFacts()).then((e=>e)).catch(()}return this.getSubstrateUserFacts()}setCampaignAction(e){if(!this.tmsgClient)return;const t=this.configuration.getCommonInitOptions(),n=this.configuration.getFloodgateInitOptions();return this.tmsgClient.sendBeaconRequestToService(t.appId.toString(),e,"Web",t.build,t.originalLocale,this.extractCountryFromLocale(t.originalLocale),this.configuration.getSdkSessionId(),n.authTokenCallback)}extractCountryFromLocale(e){if(!e)return;const t=e.split("-");return 2===t.length?t[1]:void 0}getSubstrateUserFacts(){return this.tmsgClient?this.tmsgClient.getUserFactsContent("UserFacts").then((({content:e})=>e)):Promise.resolve(null)}getAugLoopUserFacts(){return this.tmsgClient?this.tmsgClient.getAugLoopUserFactsContent("UserFacts").then(():Promise.resolve(null)}isAugLoopEnabled(){var e,t,n;return null===(n=null===(t=null===(e=this.configuration)||void 0===e?void 0:e.getFloodgateInitOptions())||void 0===t?void 0:t.augLoopCallback)||void 0===n?void 0:n.isEnabled}}let Q,Z;unction $(){Z||(Z=v.a(function(){var e,t,n,r;const i=l.d().getCommonInitOptions(),o=(null===(e=i.telemetryGroup)||void 0===e?void 0:e.audienceGroup)||(null===(t=i.telemetryGroup)||void 0===t?void 0:t.audience),a=o&&-1!==["dogfood","edog","int","microsoft"].indexOf(o.toLowerCase()),s=a?null===(n=i.webSurfacesSettings)||void 0===n?void 0:n.webSurfacesIntUrl:null===(r=i.webSurfacesSettings)||void 0===r?void 0:r.webSurfacesProdUrl,u=a?g.a.WebSurfacesIntLink:g.a.WebSurfacesProdLink,c=a?"WebSurfacesIntLink":"WebSurfacesProdLink";return s||Object(p.a)(c,u)}(),null))}class ee{makeSurveyLauncher(e){return this.AcceptsSurvey(e)?new te(e):null}AcceptsSurvey(e){return!Object(H.isNOU)(e)&&e.getType()===r.Api.SurveyType.GenericMessagingSurface&&e.getLauncherType().toLocaleLowerCase()===ee.LAUNCHER_TYPE}}ee.LAUNCHER_TYPE="coachingux";class te{constructor(e){var t;this.survey=e,!Z&&e&&e.getSurveyInfo&&(null===(t=e.getSurveyInfo())||void 0===t?void 0:t.getBusinessLevel())===r.Api.SurveyInfoBusinessLevel.Critical&&setTimeout($,1e3)}launch(e){const t=this.survey&&this.survey.getSurveyInfo(),n=t&&t.getMetadata(),r=n&&n.getContentMetadata();if(!r)return;const i=new Date,o=()=>{const e=d.b();return e&&e.OfficeWebSurfaces},a=n=>{const i=o();n&&i.Initialize(n),i.RemoveSurface();const a=Object.assign(Object.assign({},r),{surfaceContext:{surveyForm:this.survey,surveyParams:e}});i.RenderSurface(a,null,t.getBackEndId())},s=e=>{f.b().logEvent(f.a.WebSurfaces.Common.Error.VALUE,1,{ErrorMessage:"Error loading websurfaces"+(e&&e.message?": "+e.message:""),TimeMilliseconds:Date.now()-+i})};try{if(o())return void a();$(),Z.then((()=>{const e=l.d().getCommonInitOptions(),n=l.d().getFloodgateInitOptions(),r=n&&n.onSurveyActivatedCallback,o=Object.assign(Object.assign(Object.assign({},e),n),{beaconCallback:e=>{if(e)return X().setCampaignAction(e)},surfaceInitTime:i,surfaceId:t.getBackEndId(),logSessionId:l.d().getSdkSessionId(),logSettings:Object(p.a)("LogLevelSettings",void 0),renderer:r,renderCallback:r&&r.onTeachingCampaignRender});a(o)})).catch(()}catch(e){s(e)}}}var ne=n("xYJg");const{isNOU:re}=a.Utils;class ie{makeSurveyLauncher(e){return this.AcceptsSurvey(e)?new oe(e):null}AcceptsSurvey(e){return!re(e)&&e.getType()!==r.Api.SurveyType.GenericMessagingSurface}}ie.LAUNCHER_TYPE=r.Api.LAUNCHER_TYPE_DEFAULT;class oe{constructor(e){this.survey=e}launch(){d.a().OfficeBrowserFeedback.floodgate.showSurvey(new ne.a(this.survey))}}const{isNOU:ae}=a.Utils;class se{tatic make(){return new se(new ie,new ee)}makeSurveyLauncher(e){if(ae(e))return null;switch(e.getLauncherType().toLocaleLowerCase()){case ee.LAUNCHER_TYPE:return this.makeGenericMessagingSurfaceLauncher(e);case ie.LAUNCHER_TYPE:default:return this.makeRudeSurveyLauncher(e)}}AcceptsSurvey(e){if(ae(e))return!1;switch(e.getType()){case r.Api.SurveyType.GenericMessagingSurface:return!ae(this.coachingUXLauncherFactory)&&this.coachingUXLauncherFactory.AcceptsSurvey(e);default:return l.d().checkIfSurveysEnabled()&&!ae(this.rudeSurveyLauncherFactory)&&this.rudeSurveyLauncherFactory.AcceptsSurvey(e)}}makeGenericMessagingSurfaceLauncher(e){return ae(this.coachingUXLauncherFactory)?null:this.coachingUXLauncherFactory.makeSurveyLauncher(e)}makeRudeSurveyLauncher(e){return ae(this.rudeSurveyLauncherFactory)?null:this.rudeSurveyLauncherFactory.makeSurveyLauncher(e)}}var ue=n("m3vj");class ce{makeTransporter(e){return new ue.a(l.d().getCommonInitOptions().environment,e,l.d().getCommonInitOptions().appId,"Survey",l.d().getCommonInitOptions().applicationGroup,l.d().getCommonInitOptions().telemetryGroup,l.d().getCommonInitOptions().webGroup)}}class le{var de,pe=n("wSjW"),ge=n("dGOb");class ve{loadStringResource(e){let t=ge.a();switch(e){case 5:return t.Floodgate.Nps.Rating.Points11Value0;case 6:return t.Floodgate.Nps.Rating.Points11Value1;case 7:return t.Floodgate.Nps.Rating.Points11Value2;case 8:return t.Floodgate.Nps.Rating.Points11Value3;case 9:return t.Floodgate.Nps.Rating.Points11Value4;case 10:return t.Floodgate.Nps.Rating.Points11Value5;case 11:return t.Floodgate.Nps.Rating.Points11Value6;case 12:return t.Floodgate.Nps.Rating.Points11Value7;case 13:return t.Floodgate.Nps.Rating.Points11Value8;case 14:return t.Floodgate.Nps.Rating.Points11Value9;case 15:return t.Floodgate.Nps.Rating.Points11Value10;case 16:return t.Floodgate.Nps.Rating.Points5Value1;case 17:return t.Floodgate.Nps.Rating.Points5Value2;case 18:return t.Floodgate.Nps.Rating.Points5Value3;case 19:return t.Floodgate.Nps.Rating.Points5Value4;case 20:return t.Floodgate.Nps.Rating.Points5Value5;case 4:return t.Floodgate.Nps.Rating.Question;case 21:return t.Floodgate.Nps.Comment.Question;case 3:return t.Floodgate.Nps.Prompt.No;case 1:return t.Floodgate.Nps.Prompt.Question;case 0:return t.Floodgate.Nps.Prompt.Title;case 2:return t.Floodgate.Nps.Prompt.Yes;default:return""}}getCustomStringclass fe{oad(){return this.loadAsyncTriggered||(this.loadAsync(),this.loadAsyncTriggered=!0),this.campaignDefinitions||[]}loadAsync(){const e=this,t=X().getCampaignDefinitions();t.then(();const n=Object(p.a)("TmsLoadTimeout",T.k),r=Object(H.createTimeoutPromise)(n,t);return new Promise(((t,n)=>{r.then((function(n){e.loadCampaignDefinitions(n),e.loadAsyncTriggered=!0,t(e.campaignDefinitions)})).catch((function(n){e.campaignDefinitions.length<=0&&e.loadCampaignDefinitions(X().getCachedCampaignDefinitions()),t(e.campaignDefinitions)})).catch(()}))}loadCampaignDefinitions(e){const t=e&&e.campaigns;t&&(this.campaignDefinitions=Object(s.FilterValidCampaignDefinitions)(t).result)}}function he(){try{var e=document&&(document.documentElement||document.getElementsByTagName("body")[0]);return{pageWidth:(null===window||void 0===window?void 0:window.innerWidth)||(null==e?void 0:e.clientWidth),pageHeight:(null===window||void 0===window?void 0:window.innerHeight)||(null==e?void 0:e.clientHeight),pageTop:(null===window||void 0===window?void 0:window.pageYOffset)||(null==e?void 0:e.scrollTop),pageLeft:(null===window||void 0===window?void 0:window.pageXOffset)||(null==e?void 0:e.scrollLeft),screenWidth:screen?screen.width:0,screenHeight:screen?screen.height:0,colorDepth:screen?screen.colorDepth:0,userAgent:null===navigator||void 0===navigator?void 0:navigator.userAgent}}catch(e){return null}}unction ye(e,t){if(!e)return null;var n=e[t];if(!n){var r=t.toLowerCase();n=e[Object.keys(e).find(()]}if(L.f(n))return null;if(!L.d(n)&&(L.g(n)||L.e(n)))return null;var i=(new Date).toISOString();return{userFactType:"Local",userFactName:t,userFactValue:n.toString(),sourceDateTime:i,storageDateTime:i,clientIngestionDateTime:i}}class Se{constructoroad(){return this.loadAsyncTriggered||(this.loadAsync(),this.loadAsyncTriggered=!0),this.userFacts||[]}loadAsync(){const e=X().getUserFacts().then((),t=Object(p.a)("TulipsLoadTimeout",T.q);return Object(H.createTimeoutPromise)(t,e).then((()=>this.userFacts)).catch((()=>((!this.userFacts||this.userFacts.length<=0)&&this.loadUserFacts(function(e){return y(R)}()),this.userFacts))).catch(()}getUserFact(e){let t=this.nameAndUserFactMap[e];return t||this.nameAndUserFactMap.hasOwnProperty(e)||(t=this.nameAndUserFactMap[e]=function(e,t,n){try{de||(de=[t,null==t?void 0:t.applicationSettings,null==t?void 0:t.telemetryGroup,null==t?void 0:t.applicationGroup,null==t?void 0:t.webGroup,n.getFloodgateInitOptions(),n,he(),me(n.getUserConsentGroup(),n.isFeedbackSurveyEnabledByAADC())]);var r=de.reduce((,null);return r||(r=function(e){var t=e&&e.split("__");if(!t||t.length<=1)return null;var n=null,r=t[0],i=t.pop();if(i&&1===t.length&&(n=ye(window[r]||window,i)),!n&&i&&t.length>1){"window"===r&&t.shift();var o=t.reduce((,window);o&&(n=ye(o,i))}return n&&(n.userFactName=e),n}(e)),r}catch(t){return P.a().event("UserFacts_LocalFact_Error",{ErrorMessage:"Error getting local fact - "+e+" "+Object(L.b)(t)+" "}),null}}(e,l.d().getCommonInitOptions,l.d())),t}loadUserFacts(e){e&&(this.userFacts=e||[],this.userFacts.map((),this.loadAsyncTriggered=!0,this.logUserFactInfo(this.userFacts))}logUserFactInfo(e){if(!e||e.length<=0)return;const t=Object(p.a)("TulipsIngestionTimeInterval",T.p);if(t<=0)return;let n;try{const r=Date.now(),i=e=>{const n=Date.parse(e);return!!isNaN(n)||r-n>t},o={Count:e.length,RefreshTime:t,IngestionTime:e[0].clientIngestionDateTime,SourcesExpired:e.filter((e=>e&&i(e.sourceDateTime))).length||void 0,StoragesExpired:e.filter((e=>e&&i(e.storageDateTime))).length||void 0,IngestionsExpired:e.filter(().length||void 0};n={Message:"UserFacts",Data:JSON.stringify(o)}}catch(e){n={ErrorMessage:"Error getting UserFact info"}}f.b().logEvent(f.a.UserFacts.Provider.Info.VALUE,3,n)}}var Ce=n("FFSN"),Ee=n("vVCL"),Te=n("U5wP");const be=new class{constructor(){this.personalizerClient=Te.a(),this.governanceServiceEnabled=!1,this.forceServicelessSurveyDisplay=!1,this.lastSurveyFailedSync=void 0,this.clientState=r.GovernanceServiceClientState.Disabled}setup(e){if(this.governanceServiceEnabled=e.getFloodgateInitOptions().governanceServiceEnabled,this.governanceServiceEnabled){if(this.clientInfo={applicationId:e.getCommonInitOptions().appId.toString(),sessionId:e.getCommonInitOptions().sessionId,version:e.getCommonInitOptions().build,surveyPlatform:1,hostPlatform:6,tenantId:e.getCommonInitOptions().telemetryGroup.tenantId,deviceId:e.getCommonInitOptions().telemetryGroup.deviceId,audience:e.getCommonInitOptions().telemetryGroup.audience},this.userId=e.getCommonInitOptions().telemetryGroup.loggableUserId,Object(Ce.isNOU)(this.clientInfo.sessionId))return void(this.clientState=r.GovernanceServiceClientState.InitializationFailed);if(Object(Ce.isNOU)(this.clientInfo.version))return void(this.clientState=r.GovernanceServiceClientState.InitializationFailed);if(!Object(Ce.isValidUserId)(this.userId))return void(this.clientState=r.GovernanceServiceClientState.InitializationFailed);this.forceServicelessSurveyDisplay=e.getFloodgateInitOptions().governanceServiceConfig.forceServicelessSurveyDisplay,this.retryLimit=e.getFloodgateInitOptions().governanceServiceConfig.retry,this.timeout=e.getFloodgateInitOptions().governanceServiceConfig.timeout,this.simpleRequestEnabled=e.getFloodgateInitOptions().governanceServiceConfig.simpleRequestEnabled,this.isProduction=0===e.getCommonInitOptions().environment,this.clientState=r.GovernanceServiceClientState.Enabled,this.dynamicTransport=new Ee.a(this.simpleRequestEnabled),this.isSurveyGovernanceEnabled=e.getFloodgateInitOptions().governanceServiceConfig.isSurveyLevelGovernanceEnabled}}isEnabled(e){return this.clientState===r.GovernanceServiceClientState.Enabled&&this.governanceServiceEnabled&&e===r.GovernedChannelType.Standard}isSurveyLevelGovernanceEnabled(){return this.isSurveyGovernanceEnabled}shouldForceDisplay(){return this.forceServicelessSurveyDisplay}getClientInfo(){return this.clientInfo}getClientState(){return this.clientState}getLastSurveyFailedSync(){return this.lastSurveyFailedSync}checkGovernancePermitAsync(e,t,n,r){return Object(b.__awaiter)(this,void 0,void 0,(function*(){const i=(this.isProduction?"https://oness.microsoft.com/api/v1.0/UserSurvey":"https://onessppe.microsoft.com/api/v1.0/UserSurvey")+(this.simpleRequestEnabled?"/SimpleRequest":""),o=this.buildSurveyInfo(e,t,r),a=this.buildBodyRequest(o,n),s={permission:!1,error:!1,isSurveyGoverned:!1};let u,c;try{const t=performance.now();let n;if(u=yield this.dynamicTransport.postRequestWithRetry(i,a,this.retryLimit,this.timeout),c=performance.now()-t,!u.ok)return this.lastSurveyFailedSync=o,s.errorMessage=`Server Error, status: ${u.status}, status text: ${u.statusText}`,s.error=!0,f.b().logEvent(f.a.GOVERNANCE_SERVICERESULT,1,{TimeMilliseconds:c,HttpStatusCode:u.status,HttpStatusText:u.statusText,AdditionalSurveyInfo:this.buildConfigTelemetryString(),CorrelationId:this.dynamicTransport.requestId,GovernanceRequestBody:a,GovernanceResponseText:n,CampaignId:e.getCampaignId(),SurveyId:e.getSurveyInfo().getId()}),s;n=yield u.text(),f.b().logEvent(f.a.GOVERNANCE_SERVICERESULT,1,{TimeMilliseconds:c,HttpStatusCode:u.status,HttpStatusText:u.statusText,AdditionalSurveyInfo:this.buildConfigTelemetryString(),CorrelationId:this.dynamicTransport.requestId,GovernanceRequestBody:a,GovernanceResponseText:n,CampaignId:e.getCampaignId(),SurveyId:e.getSurveyInfo().getId()});const r=JSON.parse(n);if(r.lastTriggerSurveyTime=Object(Ce.stringToDate)(new Date(r.lastTriggerSurveyTime).toISOString()),Object(Ce.isNumber)(r.timeUntilNextSurveyAllowed)&&Object(Ce.isDate)(r.lastTriggerSurveyTime)){if(this.isSurveyGovernanceEnabled&&Object(Ce.isNumber)(r.timeUntilSameSurveyAllowed)&&!Object(Ce.isNOU)(r.lastTriggerSameSurveyTime)){s.isSurveyGoverned=!0;try{r.lastTriggerSameSurveyTime=Object(Ce.stringToDate)(new Date(r.lastTriggerSameSurveyTime).toISOString())}catch(e){s.isSurveyGoverned=!1}}0!==r.timeUntilNextSurveyAllowed||this.isSurveyGovernanceEnabled&&s.isSurveyGoverned&&0!==r.timeUntilSameSurveyAllowed||(s.permission=!0,this.personalizerClient.isEnabled(e.getType(),e.getLauncherType(),e.getSurveyInfo().getGovernedChannelType())&&this.personalizerClient.setEventIdAndOverrideValueForSurveyId(this.dynamicTransport.requestId,0,r.actionId,e.getSurveyInfo().getId(),e.getCampaignId())),s.lastTriggerSurvey=r,this.lastSurveyFailedSync=void 0}else s.errorMessage="Service Response is not formatted correctly: "+n,s.error=!0,this.lastSurveyFailedSync=o}catch(e){this.lastSurveyFailedSync=o,f.b().logEvent(f.a.GOVERNANCE_SERVICEFAILURE,2,{ErrorMessage:e.toString(),AdditionalSurveyInfo:this.buildConfigTelemetryString(),CorrelationId:this.dynamicTransport.requestId,HttpStatusCode:null==u?void 0:u.status,HttpStatusText:null==u?void 0:u.statusText,GovernanceRequestBody:a}),s.error=!0,s.errorMessage=`Error: ${e.toString()}, Error stack: ${e.stack}`}return s}))}buildSurveyInfo(e,t,n){const i=r.Api.SurveyType[e.getType()],o=r.GovernanceServiceSurveyType[i],a=new Date,s=this.personalizerClient.isEnabled(e.getType(),e.getLauncherType(),e.getSurveyInfo().getGovernedChannelType());return{surveyId:e.getCampaignId(),surveyTriggerTime:a,surveyType:o,surveyLevelCooldown:t,surveyChannel:n,localOffsetTime:a.getTimezoneOffset(),personalizerEnabled:s,surveyGovernanceEnabled:this.isSurveyGovernanceEnabled}}buildBodyRequest(e,t){const n={userId:this.userId,userLevelCooldown:t,survey:e,client:this.clientInfo};return this.simpleRequestEnabled&&(this.dynamicTransport.requestId=Object(H.guid)(),n.requestId=this.dynamicTransport.requestId),JSON.stringify(n)}buildConfigTelemetryString;function Ae(){return be}let Fe,Ie,_e,Oe=!1,we=0,De=null,Pe=null,Le=null;function Ne(){if(!pe.a.isStorageAvailable())throw new Error("window.localStorage is not available.");d.a().OfficeBrowserFeedback.floodgate=d.a().OfficeBrowserFeedback.floodgate||{};let e=d.a().OfficeBrowserFeedback.floodgate.initOptions;if(e=e||{},void 0!==e.campaignDefinitions){const t=Object(s.FilterValidCampaignDefinitions)(e.campaignDefinitions);if(t.error)throw new Error("floodgate.initOptions.campaignDefinitions error: "+t.error);(new pe.a).write(r.Api.FloodgateStorageProviderFileType.CampaignDefinitions,JSON.stringify(e.campaignDefinitions))}const t=l.d();if(t.setFloodgateInitOptions(e),o.a.resetSessionActivity(),Te.a().setup(t),Ae().setup(t),),!t.getFloodgateInitOptions().surveyEnabled){const e=a.FloodgateEngine.getTelemetryLogger();e&&e.log_Event(c.TelemetryEvent.Floodgate.Start.SurveysDisabled,{Count:we,Message:"Floodgate initialized with surveys disabled (surveyEnabled is false)"})}}function Ue(){return Oe}function Me(e){De=e}unction ke(){Oe=!1,function(){we=0,De=null,Fe=null,Pe=null,Le=null}()}.g((function(){return Fe})),d.l((function(e=!1){return function(e,t=null){we++;const n=(e,t,n,r)=>{const i=a.FloodgateEngine.getTelemetryLogger();i&&i.log_Event(c.TelemetryEvent.Floodgate.Start.Failed,{Count:we,ErrorMessage:t,ErrorDetails:n&&n.stack},r),e(t)};if(!Oe)return new Promise(((e,t)=>{n(t,"CommonFloodgate is not initialized.",void 0,.01)}));if(De)return De;const i=new Promise(((i,o)=>{var d,g;try{const v=l.d().getCommonInitOptions(),f=[];if(!v)return void n(o,"Invalid floodgate common init options, state: "+Oe);let h=l.d().getFloodgateInitOptions();const m=a.FloodgateEngine.getTelemetryLogger(),y=(e,t,n)=>{m&&m.log_Event(e,t,n)};if(h||(y(c.TelemetryEvent.Floodgate.Start.Warning,{Count:we,ErrorMessage:"Invalid floodgate init options, state: "+Oe}),l.d().setFloodgateInitOptions({}),h=l.d().getFloodgateInitOptions()),t||Pe||h&&h.authTokenCallback&&(Pe=new fe,Le=new Se),Pe&&f.push(Pe),null===(d=null==h?void 0:h.dynamicCampaignConfig)||void 0===d?void 0:d.enabled)if(null===(g=null==h?void 0:h.dynamicCampaignConfig)||void 0===g?void 0:g.ecsClient){y(c.TelemetryEvent.Floodgate.Start.DynamicCampaignEnabled,{Count:we},.01);const e=new s.DynamicCampaignDefinitionProvider(h.dynamicCampaignConfig.ecsClient);f.push(e)}else y(c.TelemetryEvent.Floodgate.Start.DynamicCampaignClientUndefined,{Count:we},.1);const S=u.Governor.GetChannelCoolDown(r.GovernedChannelType.TeachingMessage),C=Object(p.a)("TeachingMessageCooldown",S);if(u.Governor.SetDefaultChannelCoolDown(r.GovernedChannelType.TeachingMessage,C),Fe=t||a.FloodgateEngine.make(v.build||"",se.make(),h.onSurveyActivatedCallback,xe(),h.settingStorageCallback,Ie||new ve,new le,new ce,f,Le,Ae(),h.isPriorityEnabled,h.appGovernanceProvider,Fe&&Fe.getSurveyClient()),!Fe)return Me(null),void n(o,"Failed to create floodgate engine");if(e||we>1)Fe.start(),i(null);else{const e=Fe.startAsync();if(!e)return Me(null),void n(o,"Failed to get floodgate engine");e.then(().catch((function(e){Me(null),n(o,"Failed to start floodgate engine",e)}))}}catch(e){Me(null),n(o,"Failed to load floodgate engine: "+(e&&e.toString()),e)}}));return Me(i),i.catch((),i}(e)})),d.m((function(){Fe&&Fe.stop(),Me(null)})),d.r(xe)},BlAL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileBasedCampaignStateProvider=t.HostBasedCampaignStateProvider=t.CampaignStateProviderFactory=t.CampaignState=void 0;var r=n("7P0z"),i=n("DX5p"),o=n("iv/W"),a=n("tc4T"),s=n("FFSN"),u=s.getDistantPast,c=s.isBoolean,l=s.isDate,d=s.isNOU,p=s.isString,g=s.isUtcDatetimeString,v=s.stringToDate,f=function(){eturn e.deserialize=e.prototype.validate=function(){if(!this.CampaignId||!p(this.CampaignId))return!1;if(d(this.LastNominationBuildNumber)||!p(this.LastNominationBuildNumber))return!1;if(!s.isNumber(this.DeleteAfterSecondsWhenStale)||this.DeleteAfterSecondsWhenStale<0)return!1;if(!c(this.IsCandidate)||!c(this.DidCandidateTriggerSurvey))return!1;if(this.IsCandidate){if(d(this.LastSurveyStartTimeUtc)||d(this.LastSurveyExpirationTimeUtc))return!1;if(!p(this.LastSurveyId))return!1}if(this.DidCandidateTriggerSurvey&&d(this.LastSurveyActivatedTimeUtc))return!1;if(d(this.LastSurveyId))this.LastSurveyId="";else if(!p(this.LastSurveyId))return!1;if(g(this.LastNominationTimeUtc))this.LastNominationTimeUtc=v(this.LastNominationTimeUtc);else if(!l(this.LastNominationTimeUtc))return!1;if(d(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=u();else if(g(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=v(this.LastSurveyActivatedTimeUtc);else if(!l(this.LastSurveyActivatedTimeUtc))return!1;if(d(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=u();else if(g(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=v(this.LastSurveyStartTimeUtc);else if(!l(this.LastSurveyStartTimeUtc))return!1;if(d(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=u();else if(g(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=v(this.LastSurveyExpirationTimeUtc);else if(!l(this.LastSurveyExpirationTimeUtc))return!1;if(d(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=u();else if(g(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=v(this.LastCooldownEndTimeUtc);else if(!l(this.LastCooldownEndTimeUtc))return!1;return!0},e.prototype.markCurrentSurveyTakenOnDate=function(e,t,n){this.DidCandidateTriggerSurvey=n,this.LastSurveyActivatedTimeUtc=null!=e?e:new Date,this.LastCooldownEndTimeUtc=s.addSecondsWithoutOverflow(this.LastSurveyActivatedTimeUtc,t)},e.prototype.getCooldownStartDate=e}();t.CampaignState=f;var h=function(){function e(){}return e.make=function(e,t){return t?new y(e,t):new S(e)},e}();t.CampaignStateProviderFactory=h;var m=function(){return function(){}}(),y=function(){function e(e,t){if(!t)throw new Error("host-based storage must not be null");this.hostBasedStorage=t,e&&(this.fileBasedStateProvider=new S(e))}return e.prototype.load=function(){var e,t=this.getStatesFromHost();return this.fileBasedStateProvider&&(e=this.fileBasedStateProvider.load()),a.MergeAndUpdateCampaignStates(e,t).find(0)},e.prototype.save=function(e){var t=this;if(e){var n=this.getStatesFromHost(),i=a.MergeAndUpdateCampaignStates(e,n),o=i.find(1),s=i.find(0);o&&o.forEach((function(e){var n=a.makeSettingItemValue(JSON.stringify(e));t.hostBasedStorage.upsertSettingItem(r.FloodgateStorageProviderFileType[r.FloodgateStorageProviderFileType.CampaignStates],e.CampaignId,n)})),this.fileBasedStateProvider&&this.fileBasedStateProvider.save(s)}},e.prototype.getStatesFromHost=function(){var e=[],t=this.hostBasedStorage.readSettingList(r.FloodgateStorageProviderFileType[r.FloodgateStorageProviderFileType.CampaignStates]);for(var n in t)if(t.hasOwnProperty(n)){var s=a.extractSettingItemValueSubString(t[n]),u={};try{u=JSON.parse(s);var c=f.deserialize(u);c&&e.push(c)}catch(e){o.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.HostBasedCampaignStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+s})}}return e},e}();t.HostBasedCampaignStateProvider=y;var S=function(){function e(e){if(!e)throw new Error("storage must not be null");this.storage=e}return e.prototype.load=function(){var e,t=this.storage.read(r.FloodgateStorageProviderFileType.CampaignStates);if(!t)return[];try{e=JSON.parse(t);var n=[];return e&&e.CampaignStates&&e.CampaignStates.forEach((function(e){var t=f.deserialize(e);t&&n.push(t)})),n}catch(e){return o.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.FileBasedCampaignStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+t}),[]}},e.prototype.save=function(e){if(e){var t=new m;t.CampaignStates=e;var n=JSON.stringify(t);this.storage.write(r.FloodgateStorageProviderFileType.CampaignStates,n)}},e}();t.FileBasedCampaignStateProvider=S},CMUy:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GovernedChannelType=void 0,t.GovernedChannelType||(t.GovernedChannelType={})),t.GovernedChannelType||(t.GovernedChannelType={}))},DX5p:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryEvent=void 0;var r=function(){function e(){}var t,n,r,i,o,a,s,u,c,l,d,p,g,v,f,h,m,y,S,C,E,T,b,A,F,I,_,O,w,D,P,L,N,U,M,R,k,x,B;return e.CampaignState=((t=function(){return function(){}}()).Deserialize=((n=function(){return function(){}}()).Failed="FloodgateCore_CampaignState_Deserialize_Failed",n),t),e.FileBasedCampaignStateProvider=((r=function(){return function(){}}()).Load=((i=function(){return function(){}}()).Failed="FloodgateCore_FileBasedCampaignStateProvider_Load_Failed",i),r),e.HostBasedCampaignStateProvider=((o=function(){return function(){}}()).GetStatesFromHost=((a=function(){return function(){}}()).Failed="FloodgateCore_HostBasedCampaignStateProvider_GetStatesFromHost_Failed",a),o),e.Floodgate=((s=function(){return function(){}}()).Initialize=((u=function(){return function(){}}()).Failed="FloodgateCore_Floodgate_Initialize_Failed",u),s.Start=((c=function(){return function(){}}()).Failed="FloodgateCore_Floodgate_Start_Failed",c.Warning="FloodgateCore_Floodgate_Start_Warning",c.SurveysDisabled="FloodgateCore_Floodgate_Start_SurveysDisabled",c.DynamicCampaignEnabled="FloodgateCore_Floodgate_Start_DynamicCampaignEnabled",c.DynamicCampaignClientUndefined="FloodgateCore_Floodgate_Start_DynamicCampaignClientUndefined",c),s.UserFactsLoad=((l=function(){return function(){}}()).Failed="FloodgateCore_Floodgate_UserFactsLoad_Failed",l),s.UserFactsSpecDeserialization=((d=function(){return function(){}}()).Failed="FloodgateCore_Floodgate_UserFactsSpecDeserialization_Failed",d),s.UserFactsSpecIsAMatch=((p=function(){return function(){}}()).Failed="FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Failed",p.Mismatch="FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Mismatch",p.Summary="FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Summary",p),s.RenderSurvey=((g=function(){return function(){}}()).Unsupported="FloodgateCore_Floodgate_RenderSurvey_Unsupported",g),s),e.FloodgateEngine=((v=function(){return function(){}}()).Make=((f=function(){return function(){}}()).Failed="FloodgateCore_FloodgateEngine_Make_Failed",f),v.Common=((h=function(){return function(){}}()).Error="FloodgateCore_FloodgateEngine_Common_Error",h),v.Start=((m=function(){return function(){}}()).Failed="FloodgateCore_FloodgateEngine_Start_Failed",m),v.StartAsync=((y=function(){return function(){}}()).Failed="FloodgateCore_FloodgateEngine_StartAsync_Failed",y.Stopped="FloodgateCore_FloodgateEngine_StartAsync_Stopped",y),v.OnSurveyActivated=((S=function(){return function(){}}()).ActivationStatsSuppressedSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationStatsSuppressedSurvey",S.ClosedChannelType="FloodgateCore_FloodgateEngine_OnSurveyActivated_ClosedChannelType",S.SurveyNotDefined="FloodgateCore_FloodgateEngine_OnSurveyActivated_SurveyNotDefined",S.SessionSuppressedSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_SessionSuppressedSurvey",S.ActivationExpiredSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationExpiredSurvey",S.ActivationIrrelevantSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationIrrelevantSurvey",S.Error="FloodgateCore_FloodgateEngine_OnSurveyActivated_Error",S),v.CheckGovernanceServiceAndActivateSurvey=((C=function(){return function(){}}()).GovernanceServiceForceToDisplay="FloodgateCore_FloodgateEngine_GovernanceService_GovernanceServiceForceToDisplay",C.GovernanceServiceClientCompleted="FloodgateCore_FloodgateEngine_GovernanceService_GovernanceServiceClientCompleted",C.GovernanceServiceSurveyInCooldown="FloodgateCore_FloodgateEngine_GovernanceService_GovernanceServiceSurveyInCooldown",C),v),e.GovernedChannelState=((E=function(){return function(){}}()).Deserialize=((T=function(){return function(){}}()).Failed="FloodgateCore_GovernedChannelState_Deserialize_Failed",T),E),e.FileBasedGovernedChannelStateProvider=((b=function(){return function(){}}()).Load=((A=function(){return function(){}}()).Failed="FloodgateCore_FileBasedGovernedChannelStateProvider_Load_Failed",A),b),e.HostBasedGovernedChannelStateProvider=((F=function(){return function(){}}()).GetStatesFromHost=((I=function(){return function(){}}()).Failed="FloodgateCore_HostBasedGovernedChannelStateProvider_GetStatesFromHost_Failed",I),F),e.SurveyStatCollectionActivation=((_=function(){return function(){}}()).FromJson=((O=function(){return function(){}}()).Failed="FloodgateCore_SurveyStatCollectionActivation_FromJson_Failed",O),_.ToJson=((w=function(){return function(){}}()).Failed="FloodgateCore_SurveyStatCollectionActivation_ToJson_Failed",w),_),e.HostBasedSurveyActivationStatsProvider=((D=function(){return function(){}}()).GetSurveyStatsFromHost=((P=function(){return function(){}}()).Failed="FloodgateCore_HostBasedSurveyActivationStatsProvider_GetSurveyStatsFromHost_Failed",P),D),e.SurveyStatCollectionEventActivity=((L=function(){return function(){}}()).FromJson=((N=function(){return function(){}}()).Failed="FloodgateCore_SurveyStatCollectionEventActivity_FromJson_Failed",N),L.ToJson=((U=function(){return function(){}}()).Failed="FloodgateCore_SurveyStatCollectionEventActivity_ToJson_Failed",U),L),e.SurveyActivity=((M=function(){return function(){}}()).LogActivity=((R=function(){return function(){}}()).EventsReprocessed="FloodgateCore_SurveyActivity_LogActivity_EventsReprocessed",R.SurveysReprocessed="FloodgateCore_SurveyActivity_LogActivity_SurveysReprocessed",R),M.SetActivityTrackingContracts=((k=function(){return function(){}}()).DuplicateSurveyID="FloodgateCore_SurveyActivity_SetActivityTrackingContracts_DuplicateSurveyID",k),M),e.DynamicCampaignDefinitionProvider=((x=function(){return function(){}}()).Load=((B=function(){return function(){}}()).EmptyEcsConfig="FloodgateCore_DynamicCampaignDefinitionProvider_Load_EmptyEcsConfig",B.InvalidEcsConfig="FloodgateCore_DynamicCampaignDefinitionProvider_Load_InvalidEcsConfig",B),x),e}();t.TelemetryEvent=r},DvkI:Dwqi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7P0z"),i=n("FFSN"),o=i.getDistantFuture,a=i.getDistantPast,s=i.isNOU,u=i.isDate,c=function(){function e(e){if(s(e))throw new Error("data must not be null");if(s(e.id)||""===e.id)throw new Error("data.id must not be null or empty");if(s(e.governedChannelType)&&(e.governedChannelType=r.GovernedChannelType.getDefault()),s(e.expirationTimeUtc)||""===e.expirationTimeUtc)throw new Error("data.expirationTimeUtc must not be null or empty");if(s(e.activationEvent))throw new Error("data.activationEvent must not be null");(s(e.backEndIdentifier)||""===e.backEndIdentifier)&&(e.backEndIdentifier=e.id),s(e.launcherType)&&(e.launcherType=r.LAUNCHER_TYPE_DEFAULT),this.data=e}return e.prototype.getId=function(){return this.data.id},e.prototype.getBackEndId=function(){return this.data.backEndIdentifier},e.prototype.getGovernedChannelType=function(){return this.data.governedChannelType},e.prototype.getRawStartTimeUtc=function(){return this.data.startTimeUtc},e.prototype.getStartTimeUtc=function(){if(s(this.data.startTimeUtc))return a();var e=new Date(this.data.startTimeUtc);return u(e)?e:o()},e.prototype.getExpirationTimeUtc=function(){if(s(this.data.expirationTimeUtc))return a();var e=new Date(this.data.expirationTimeUtc);return u(e)?e:a()},e.prototype.getRawExpirationTimeUtc=function(){return this.data.expirationTimeUtc},e.prototype.isActiveForDate=function(e){return!s(e)&&e>=this.getStartTimeUtc()&&e<=this.getExpirationTimeUtc()},e.prototype.getActivationEvent=function(){return this.data.activationEvent},e.prototype.getPreferredLaunchType=function(){return this.data.preferredLaunchType},e.prototype.isAdditionalDataRequested=function(e){if(s(this.data.additionalDataRequested))return!1;for(var t=0,n=this.data.additionalDataRequested;t<n.length;t++)if(n[t]===e)return!0;return!1},e.prototype.getLauncherType=function(){return this.data.launcherType},e.prototype.getMetadata=function(){return this.data.metadata},e.prototype.getTags=function(){return this.data.tags},e.prototype.getBusinessLevel=function(){return this.data.businessLevel},e.prototype.getMaxLaunches=function(){return this.data.maxLaunches},e.prototype.getMaxLaunchesPerSession=function(){return this.data.maxLaunchesPerSession},e.prototype.getDomElements=e.prototype.getJsonElements=e}();!function(e){var t=);e.SurveyDataSourceData=t}(c||(c={})),t.default=c},EnYi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignManager=void 0;var r=n("7P0z"),i=n("DX5p"),o=n("iv/W"),a=n("FFSN"),s=n("jay/"),u=n("BlAL"),c=n("pbdH"),l=a.getDistantFuture,d=a.getDistantPast,p=a.isArray,g=a.isNOU,v=function(){function e(e,t,n,r,i,o,a,s,u){if(!e)throw new Error("stateProvider must not be null");if(!p(t))throw new Error("definitionProviders is either null or not an array type");if(!n)throw new Error("stringProvider must not be null");if(g(i))throw new Error("currentBuildNumber must not be null");this.campaignStates={},this.campaignDefinitions={},this.userFacts=[],this.stateProvider=e,this.definitionProviders=t,this.stringProvider=n,this.surveyCandidacyChecker=u,this.userFactsProvider=s,this.environmentProvider=r,this.currentBuildNumber=i,o=o||new Date,this.isPriorityEnabled=a}return e.isStateUpForNomination=function(t,n,r,i){if(!t||!n)return!1;if(r=r||new Date,t.ForceCandidacy)return!0;var o=n.nominationScheme.getCampaignCooldown(t.IsCandidate&&t.DidCandidateTriggerSurvey);return!!o&&(!!e.hasBuildChangeDurationElapsed(o,t.LastNominationBuildNumber,i)||e.hasTimeIntervalDurationElapsed(o,t.getCooldownStartDate(),r))},e.isDateInRange=function(e,t,n){return e=e||new Date,t=t||d(),n=n||l(),t.getTime()<=e.getTime()&&n.getTime()>=e.getTime()},e.hasTimeIntervalDurationElapsed=function(e,t,n){if(g(e)||!(e instanceof s.CampaignDurationTimeInterval))return!1;if(!t||!n)return!1;var r=a.addSecondsWithoutOverflow(t,e.intervalSeconds);return n.getTime()>=r.getTime()},e.hasBuildChangeDurationElapsed=function(e,t,n){return!g(e)&&e instanceof s.CampaignDurationSingleBuildChange&&(g(t)||g(n)?null===t!=(null===n):!(t===n))},e.isCampaignInScope=function(t,n,r,i){return!(!t||(n=n||new Date,!e.isDateInRangeWithDefinition(n,t)||t.scope&&((t.scope instanceof s.CampaignScopeUserFactAny||t.scope instanceof s.CampaignScopeUserFactAll)&&t.scope.setUserFactsProvider(i),t.scope instanceof s.CampaignScopeEnvironmentCrossProduct&&t.scope.setEnvironmentProvider(r),!t.scope.isInScope())))},e.isDateInRangeWithDefinition=function(t,n){return!!n&&(t=t||new Date,e.isDateInRange(t,n.startTime?n.startTime:l(),n.endTime))},e.prototype.getActiveSurveys=function(){var e={},t=this.getPrioritizedCampaigns();for(var n in this.campaignStates)if(this.campaignStates.hasOwnProperty(n)){var r=this.campaignStates[n];if(!r.IsCandidate)continue;var i=t[r.CampaignId];if(!i)continue;var o=c.CampaignSurveyFactory.makeSurvey(r,i,this.stringProvider);if(!o)continue;if(this.surveyCandidacyChecker&&!this.surveyCandidacyChecker.isSurveyTrackable(o))continue;e[o.getSurveyInfo().getId()]=o}return e},e.prototype.modifyCampaignSurveyTakenDate=function(e,t,n){var r=this.campaignStates[e];if(r){t=t||new Date;var i=this.campaignDefinitions[e].nominationScheme.cooldownPeriod.asTimeIntervalSeconds();r.markCurrentSurveyTakenOnDate(t,i,n),this.saveCurrentState()}},e.prototype.getCampaignStates=function(){return this.campaignStates},e.prototype.getCampaignDefinitions=function(){return this.campaignDefinitions},e.prototype.getUserFacts=function(){return this.userFacts},e.prototype.onSurveyActivated=function(e,t){e&&this.modifyCampaignSurveyTakenDate(e.getBackEndId(),new Date,t)},e.prototype.refreshSurveyDefinitions=e.prototype.refreshSurveyDefinitionsAsync=function(e,t){var n=this;return new Promise((function(r,i){n.refreshSurveyDefinitionsPrivateAsync(e,t||new Date).then(().catch((function(e){i(e)}))}))},e.prototype.getAppSurveys=e.prototype.saveCurrentState=e.prototype.refreshSurveyDefinitionsPrivate=function(e,t){this.needRefreshSurveyDefinitions()?(this.lastCampaignRefreshTime=new Date,this.campaignDefinitions={},this.userFacts=[],this.loadFilterCampaigns(t,e)):this.FilterCampaignsOnRestart(t,e),this.campaignStates={},this.LoadFilterCampaignStates(t),this.evaluateCampaigns(t)},e.prototype.refreshSurveyDefinitionsPrivateAsync=function(e,t){var n;this.campaignStates={},this.campaignDefinitions={},this.userFacts=[],this.lastCampaignRefreshTime=null!==(n=this.lastCampaignRefreshTime)&&void 0!==n?n:new Date;var r=this;return new Promise(()},e.prototype.loadAndFilterCampaignDataAsync=function(e,t){e=e||new Date;for(var n=[],r=[],a=this.userFactsProvider&&this.userFactsProvider.loadAsync(),s=0,u=Object.keys(this.definitionProviders);s<u.length;s++){var c=this.definitionProviders[u[s]],l=c&&c.loadAsync();g(l)||(l=l.catch((),r.push(l))}var d=this;return new Promise((function(s,u){Promise.all(r).then((function(r){for(var u=0,c=Object.keys(r);u<c.length;u++){var l=r[c[u]];p(l)&&(n=n.concat(l))}var v=function(r){d.userFacts=r||[],d.FilterCampaignData(e,t,n),s()};g(a)?v():a.then(().catch((function(){o.FloodgateEngine.getTelemetryLogger().log_Error(i.TelemetryEvent.Floodgate.UserFactsLoad.Failed,"Failed to load from user facts provider"),v()}))})).catch(()}))},e.prototype.loadFilterCampaigns=function(t,n){t=t||new Date;for(var a=[],s=0,u=Object.keys(this.definitionProviders);s<u.length;s++){var c=u[s];try{var l=this.definitionProviders[c]&&this.definitionProviders[c].load();p(l)&&(a=a.concat(l))}catch(e){o.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider. "+e.toString())}}try{this.userFacts=this.userFactsProvider&&this.userFactsProvider.load()||[]}catch(e){o.FloodgateEngine.getTelemetryLogger().log_Error(i.TelemetryEvent.Floodgate.UserFactsLoad.Failed,"Failed to load from user facts provider. "+e)}for(var d in a)if(a.hasOwnProperty(d)){var g=a[d];if(n&&n.indexOf(g.governedChannelType)<0&&g.businessLevel!==r.SurveyInfoBusinessLevel.Critical)continue;if(!e.isCampaignInScope(g,t,this.environmentProvider,this.userFactsProvider))continue;this.campaignDefinitions[g.campaignId]=g}},e.prototype.FilterCampaignData=function(t,n,i){var o={};for(var s in i)if(i.hasOwnProperty(s)){if(o[(d=i[s]).campaignId]=d,n&&n.indexOf(d.governedChannelType)<0&&d.businessLevel!==r.SurveyInfoBusinessLevel.Critical)continue;if(!e.isCampaignInScope(d,t,this.environmentProvider,this.userFactsProvider))continue;this.campaignDefinitions[d.campaignId]=d}var u=this.stateProvider.load(),c=[];for(var s in u)u.hasOwnProperty(s)&&(this.campaignDefinitions.hasOwnProperty((l=u[s]).CampaignId)||c.push(l),this.campaignStates[l.CampaignId]=l);for(var s in c)if(c.hasOwnProperty(s)){var l;if(!(l=c[s]))continue;var d,p=!1;(d=o[l.CampaignId])?e.isStateUpForNomination(l,d,t,this.currentBuildNumber)&&(p=!0):l.LastNominationTimeUtc.getTime()<=a.subtractSecondsWithoutOverflow(t,l.DeleteAfterSecondsWhenStale).getTime()&&(p=!0),p&&delete this.campaignStates[l.CampaignId]}},e.prototype.getPrioritizedCampaigns=function(){var e=this,t={},n={};return Object.keys(this.campaignDefinitions||[]).forEach((function(r){var i=e.campaignDefinitions[r];e.campaignStates.hasOwnProperty(r)&&e.campaignStates[r].IsCandidate&&(t[r]=i,(i.tags&&i.tags.length>0?i.tags:[""]).forEach((function(e){var t=e+"_"+i.governedChannelType;n[t]=n[t]||[],n[t].push(i)})))})),Object.keys(n).forEach((function(i){var o;if(e.isPriorityEnabled||!i.endsWith("_"+r.GovernedChannelType.Standard)){var s=n[i];if(!(s.length<=1)){var u=a.findHighestPriorityDefinition(s),c=null!==(o=u[0].primaryPriority)&&void 0!==o?o:0;u[1]&&s.forEach((function(e){var n=e.primaryPriority;!g(e.primaryPriority)&&n>c&&delete t[e.campaignId]}))}}})),t},e.prototype.evaluateCampaigns=function(t){for(var n in t=t||new Date,this.campaignDefinitions)if(this.campaignDefinitions.hasOwnProperty(n)){var r=this.campaignDefinitions[n],i=this.campaignStates[r.campaignId];if(!i||e.isStateUpForNomination(i,r,t,this.currentBuildNumber)){var o=i?i.LastSurveyId:"",s=i?i.LastSurveyStartTimeUtc:d(),c=i?i.LastSurveyExpirationTimeUtc:d(),l=i?i.LastSurveyActivatedTimeUtc:d(),p=i?i.LastCooldownEndTimeUtc:d(),g=i&&i.ForceCandidacy||r.nominationScheme.evaluateNominationRules();g&&(o=a.guid(),s=r.nominationScheme.calculateSurveyStartTimeFromDate(t),c=r.nominationScheme.calculateSurveyExpirationTimeFromSurveyStartTime(s));var v=new u.CampaignState(r.campaignId,t,this.currentBuildNumber,r.nominationScheme.getActiveSurveyTimeIntervalSeconds(),!1,g,!1,l,o,s,c,p);this.campaignStates[v.CampaignId]=v}}},e.prototype.needRefreshSurveyDefinitions=e.prototype.FilterCampaignsOnRestart=function(t,n){for(var i in this.campaignDefinitions)if(this.campaignDefinitions.hasOwnProperty(i)){var o=this.campaignDefinitions[i];if(n&&n.indexOf(o.governedChannelType)<0&&o.businessLevel!==r.SurveyInfoBusinessLevel.Critical){delete this.campaignDefinitions[o.campaignId];continue}if(!e.isCampaignInScope(o,t,this.environmentProvider,this.userFactsProvider)){delete this.campaignDefinitions[o.campaignId];continue}}},e.prototype.LoadFilterCampaignStates=function(t){var n=this.stateProvider.load(),r=[];for(var i in n)n.hasOwnProperty(i)&&(this.campaignDefinitions.hasOwnProperty((o=n[i]).CampaignId)||r.push(o),this.campaignStates[o.CampaignId]=o);for(var i in r)if(r.hasOwnProperty(i)){var o;if(!(o=r[i]))continue;var s=this.campaignDefinitions[o.CampaignId],u=!1;s?e.isStateUpForNomination(o,s,t,this.currentBuildNumber)&&(u=!0):o.LastNominationTimeUtc.getTime()<=a.subtractSecondsWithoutOverflow(t,o.DeleteAfterSecondsWhenStale).getTime()&&(u=!0),u&&delete this.campaignStates[o.CampaignId]}},e}();t.CampaignManager=v},FFSN:function(e,t,n){"use strict";unction i(e){return null==e}function o(e){return"string"==typeof e}function a(e,n){if(!e)return null;if(n<0)return this.addSecondsWithoutOverflow(e,n=-n);var r=e.getTime()-1e3*n;return r>t.MIN_DATE_MILLISECONDS?new Date(r):new Date(t.MIN_DATE_MILLISECONDS)}function s(e){if(!e)return null;var t=e.match("^((?:[a-zA-Z]{2,3}(?:-[a-zA-Z]{3}){0,3})|(?:[a-zA-Z]{4,8}))(?:-([a-zA-Z]{4}))?(?:-([a-zA-Z]{2}|[0-9]{3}))?(-.*)?$");return!t||t.length<1||!i(t[4])?null:t[0]}function u(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}Object.defineProperty(t,"__esModule",{value:!0}),t.findHighestPriorityDefinition=t.safeParseObject=t.isValidUserId=t.fyShuffle=t.dateToShortUtcString=t.isUtcDatetimeString=t.overrideValues=t.stringToDate=t.makeArrayFromObjectValuesSortedByKeyString=t.guid=t.extractLanguageSubtag=t.isValidLanguageSubTag=t.subtractSecondsWithoutOverflow=t.addSecondsWithoutOverflow=t.MIN_DATE_MILLISECONDS=t.MAX_DATE_MILLISECONDS=t.getDistantFuture=t.getDistantPast=t.isBoolean=t.isString=t.isArray=t.isFunction=t.isObject=t.isNOU=t.isNumber=t.isEnumValue=t.isDate=t.timeAdd=void 0,t.timeAdd=function(e,t,n){switch(t.toLowerCase()){case"h":case"hour":return new Date(e.getTime()+36e5*n);case"m":case"minute":return new Date(e.getTime()+6e4*n);case"s":case"second":return new Date(e.getTime()+1e3*n);default:throw new Error("Invalid interval value of "+t)}},t.isDate=r,t.isEnumValue=t.isNumber=function(e){return null!==e&&!isNaN(e)&&isFinite(e)},t.isNOU=i,t.isObject=function(e){return null!=e&&"object"==typeof e},t.isFunction=t.isArray=t.isString=o,t.isBoolean=t.getDistantPast=t.getDistantFuture=function(){return new Date(640922112e5)},t.MAX_DATE_MILLISECONDS=864e13,t.MIN_DATE_MILLISECONDS=-864e13,t.addSecondsWithoutOverflow=function(e,n){if(!e)return null;if(n<0)return a(e,-1*n);var r=e.getTime()+1e3*n;return r<t.MAX_DATE_MILLISECONDS?new Date(r):new Date(t.MAX_DATE_MILLISECONDS)},t.subtractSecondsWithoutOverflow=a,t.isValidLanguageSubTag=function(e){if(!e)return!1;var t=s(e);return!!t&&t===e},t.extractLanguageSubtag=s,t.guid=function(){return(u()+u()+"-"+u()+"-4"+u().substr(0,3)+"-"+u()+"-"+u()+u()+u()).toLowerCase()},t.makeArrayFromObjectValuesSortedByKeyString=function(e){var t=Object.keys(e);t.sort();var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(e[t[r]]);return n},t.stringToDate=function(e){if(!o(e))return null;var t=e?new Date(e):null;return r(t)?t:null},t.overrideValues=function(e,t){if(!t)return t;var n=t;if(e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n},t.isUtcDatetimeString=function(e){return!!o(e)&&/^(\d{4}\-\d\d\-\d\dT\d\d:\d\d:\d\d(\.\d\d\d)?Z)$/.test(e)},t.dateToShortUtcString=function(e){if(!r(e))return null;eturn e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"Z"},t.fyShuffle=function(e){if(!i(e)){if(0===e.length||1===e.length)return e;for(var t=e.length-1;t>0;){var n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r,t--}return e}},t.isValidUserId=t.safeParseObject=function(e,t){try{var n=!e||"{"!==e[0]&&"["!==e[0]?void 0:JSON.parse(e);return null!=n?n:t}catch(e){}return t},t.findHighestPriorityDefinition=function(e){var t=!1;return[e.reduce((function(e,n){var r=n.primaryPriority||0,i=e.primaryPriority||0;return r!==i&&(t=!0),r<i?n:e})),t]}},FmCD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSON_SURVEYSPECIFICDATA_KEYNAME=t.JSON_SURVEYSTRINGS_KEYNAME=t.JSON_EXTENDEDMANIFESTDATA_KEYNAME=t.JSON_APPLICATION_KEYNAME=t.JSON_MULTIPLECHOICE_KEYNAME=t.JSON_QUESTION_KEYNAME=t.JSON_TITLE_KEYNAME=t.JSON_CVSURVEYPLATFORM_KEYNAME=t.JSON_CVSURVEYUIHOST_KEYNAME=t.JSON_CVSURVEYPRODUCTNAME_KEYNAME=t.JSON_RATINGOPTIONS_KEYNAME=t.JSON_CVSURVEYTHEME_KEYNAME=t.JSON_CVSURVEYFORMID_KEYNAME=t.JSON_CVSURVEY_KEYNAME=t.JSON_RATING_KEYNAME=t.JSON_COMMENT_KEYNAME=t.JSON_PROMPTNOTEXT_KEYNAME=t.JSON_PROMPTYESTEXT_KEYNAME=t.JSON_PROMPT_KEYNAME=t.JSON_INTERCEPTURL_KEYNAME=t.JSON_INTERCEPT_KEYNAME=t.DOM_MULTIPLECHOICE_TAGNAME=t.DOM_CVSURVEY_TAGNAME=t.DOM_RATING_TAGNAME=t.DOM_COMMENT_TAGNAME=t.DOM_PROMPT_TAGNAME=void 0,t.DOM_PROMPT_TAGNAME="Prompt",t.DOM_COMMENT_TAGNAME="Comment",t.DOM_RATING_TAGNAME="Rating",t.DOM_CVSURVEY_TAGNAME="CVSurvey",t.DOM_MULTIPLECHOICE_TAGNAME="MultipleChoice",t.JSON_INTERCEPT_KEYNAME="intercept",t.JSON_INTERCEPTURL_KEYNAME="url",t.JSON_PROMPT_KEYNAME="prompt",t.JSON_PROMPTYESTEXT_KEYNAME="yesButtonText",t.JSON_PROMPTNOTEXT_KEYNAME="noButtonText",t.JSON_COMMENT_KEYNAME="comment",t.JSON_RATING_KEYNAME="rating",t.JSON_CVSURVEY_KEYNAME="cvSurvey",t.JSON_CVSURVEYFORMID_KEYNAME="formId",t.JSON_CVSURVEYTHEME_KEYNAME="theme",t.JSON_RATINGOPTIONS_KEYNAME="options",t.JSON_CVSURVEYPRODUCTNAME_KEYNAME="productName",t.JSON_CVSURVEYUIHOST_KEYNAME="uiHost",t.JSON_CVSURVEYPLATFORM_KEYNAME="platform",t.JSON_TITLE_KEYNAME="title",t.JSON_QUESTION_KEYNAME="question",t.JSON_MULTIPLECHOICE_KEYNAME="multipleChoice",t.JSON_APPLICATION_KEYNAME="application",t.JSON_EXTENDEDMANIFESTDATA_KEYNAME="extendedManifestData",t.JSON_SURVEYSTRINGS_KEYNAME="surveyStrings",t.JSON_SURVEYSPECIFICDATA_KEYNAME="surveySpecificData"},GSP4:function(e,t,n){(function(t,n){!0,(function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:i=0,o=void 0,a=void 0,s=u="undefined"!=typeof window?window:void 0,c=u||{},l=c.MutationObserver||c.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;ar v=new Array(1e3);ar h=void 0;d?):l?):p?):void 0===u?function(){try{var e=Function("return this")().require("vertx");return o=e.runOnLoop||e.runOnContext,function(){return void 0!==o?g()}()}catch(e){return g()}}():g();var S=Math.random().toString(36).substring(2);function C(){}var E=void 0;unction b(e,t){if(e===t)I(e,function(){return new TypeError("You cannot resolve a promise with itself")}());else if(t)){var n=void 0;try{n=t.then}catch(t){return void I(e,t)}T(e,t,n)}else F(e,t)}ion w(t,n,r,i){var o=e(r),a=void 0,s=void 0,u=!0;if(o){try{a=r(i)}catch(e){u=!1,s=e}if(n===a)return void I(n,function(){return new TypeError("A promises callback cannot return that same promise.")}())}else a=i;n._state!==E||(o&&u?b(n,a):!1===u?I(n,s):1===t?F(n,a):2===t&&I(n,a))}var D=0;ar L=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(C),this.promise[S]||P(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?F(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&F(this.promise,this._result))):I(this.promise,))}return e.prototype._enumerate=e.prototype._eachEntry=e.prototype._settledAt=e.prototype._willSettleAt=e}(),N=function(){function t(e){this[S]=),this._result=this._state=void 0,this._subscribers=[],C!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?this,e):))}return t.prototype.catch=t.prototype.finally=t}();return N.prototype.then=m,N.all=N.race=N.resolve=y,N.reject=N._setScheduler=function(e){a=e},N._setAsap=N._asap=s,N.polyfill=N.Promise=N,N}))}).call(this,n("5IsQ"),n("pCvA"))},Go5c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7P0z"),i=function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.question)throw new Error("data.question must not be null or empty");if(!e.title)throw new Error("data.title must not be null or empty");if(!e.url)throw new Error("data.url must not be null or empty");this.data=e}return e.make=function(t){try{return new e(t)}catch(e){return null}},e.prototype.getType=function(){return"Intercept"},e.prototype.getTitle=function(){return this.data.title},e.prototype.getQuestion=function(){return this.data.question},e.prototype.getUrl=function(){return this.data.url},e.prototype.getDomElements=function(e){if(!e)throw new Error("Document must not be null");return[e.createElement(r.DOM_INTERCEPT_TAGNAME)]},e.prototype.getJsonElements=e.prototype.getComponentJson=function(){var e;return(e={})[r.JSON_TITLE_KEYNAME]=this.getTitle(),e[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),e[r.JSON_INTERCEPTURL_KEYNAME]=this.getUrl(),e},e}();!function(e){var t=function(){return function(){}}();e.InterceptComponentData=t}(i||(i={})),t.default=i},HAGu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasSurveyReachedMaxLaunches=t.hasSurveyReachedMaxLaunchesPerSession=t.isCriticalSurvey=t.isBusinessCriticalSurvey=t.isMultiLaunchSurvey=void 0;var r=n("7P0z"),i=n("FFSN");function o(e){var t=null==e?void 0:e.getMaxLaunches();return i.isNumber(t)&&t>1}function a(e){var t=null==e?void 0:e.getBusinessLevel();return!i.isNOU(t)&&t===r.SurveyInfoBusinessLevel.Critical}t.isMultiLaunchSurvey=o,t.isBusinessCriticalSurvey=a,t.isCriticalSurvey=t.hasSurveyReachedMaxLaunchesPerSession=function(e,t){var n;return!o(e)||!i.isNumber(e.getMaxLaunchesPerSession())||(null!==(n=t[e.getId()])&&void 0!==n?n:0)>=e.getMaxLaunchesPerSession()},t.hasSurveyReachedMaxLaunches=function(e,t){return!o(e)||((null==t?void 0:t.SurveyLaunchCount)||0)>=e.getMaxLaunches()}},HPVw:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"p",(function(){return a})),n.d(t,"q",(function(){return s})),n.d(t,"o",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"n",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"j",(function(){return v})),n.d(t,"i",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return y})),n.d(t,"g",(function(){return S})),n.d(t,"c",(function(){return C})),n.d(t,"r",(function(){return E}));const r=window;function i(){return F}function o(){return r}function a(e){b.setUiStrings=e,r.OfficeBrowserFeedback=r.OfficeBrowserFeedback||{},r.OfficeBrowserFeedback.setUiStrings=b.setUiStrings}function s(e){b.singleFeedback=e}function u(e){b.multiFeedback=e}function c(e){b.getFeedbackStatus=e}function l(e){b.createScreenshot=e}function d(e){b.isFeedbackSurveyEnabledByAADC=e}function p(e){A.customUXHandler=e}unction v(e){A.showFormSurvey=e}function f(e){A.showCustomSurvey=e}function h(e){A.initialize=e}function m(e){A.start=e}function y(e){A.stop=e}function S(e){A.getEngine=e}function C(e){A.getSettingIdMap=e}lass T{}const b=new A=b.floodgate,F={OfficeBrowserFeedback:b}},Igas:function(e,t,n){"use strict";(function(e){var t="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==e&&e||{},n="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&),o="FormData"in t,a="ArrayBuffer"in t;if(a)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView|| m(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&i&&e)?(this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=h(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=,this.arrayBuffer=this.text=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=v(t),r=/charset=([A-Za-z0-9_-]+)/.exec(e.type);return t.readAsText(e,r?r[1]:"utf-8"),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=,this.json=this}p.prototype.append=p.prototype.delete=p.prototype.get=p.prototype.has=p.prototype.set=p.prototype.forEach=p.prototype.keys=p.prototype.values=p.prototype.entries=r&&(p.prototype[Symbol.iterator]=p.prototype.entries);var y=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function S(e,n){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r=(n=n||{}).body;if(e instanceof S){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,n.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=n.credentials||this.credentials||"same-origin",!n.headers&&this.headers||(this.headers=new p(n.headers)),this.method=n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal||),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==n.cache&&"no-cache"!==n.cache)){var i=/([?&])_=[^&]*/;i.test(this.url)?this.url=this.url.replace(i,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}rototype.clone=m.call(S.prototype),m.call(T.prototype),T.prototype.clone=T.error=var b=[301,302,303,307,308];T.redirect=var A=t.DOMException;try{new A}catch(e){(A=.prototype=Object.create(Error.prototype),A.prototype.constructor=A}function F(e,n){return new Promise((function(r,o){var s=new S(e,n);if(s.signal&&s.signal.aborted)return o(new A("Aborted","AbortError"));var u=new XMLHttpRequest;f(u.onload=function(){var e={statusText:u.statusText,headers:E(u.getAllResponseHeaders()||"")};e.status=s.url.startsWith("file://")&&(u.status<200||u.status>599)?200:u.status,e.url="responseURL"in u?u.responseURL:e.headers.get("X-Request-URL");var t="response"in u?u.response:u.responseText;setTimeout((,0)},u.onerror=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},u.ontimeout=u.onabort=u.open(s.method,s.url),!0),"include"===s.credentials?u.withCredentials=!0:"omit"===s.credentials&&(u.withCredentials=!1),"responseType"in u&&(i?u.responseType="blob":a&&(u.responseType="arraybuffer")),n&&"object"==typeof n.headers&&!(n.headers instanceof p||t.Headers&&n.headers instanceof t.Headers)){var g=[];Object.getOwnPropertyNames(n.headers).forEach((),s.headers.forEach(()}else s.headers.forEach(();s.signal&&(s.signal.addEventListener("abort",d),u.onreadystatechange=,u.send(void 0===s._bodyInit?null:s._bodyInit)}))}F.polyfill=!0,t.fetch||(t.fetch=F,t.Headers=p,t.Request=S,t.Response=T)}).call(this,n("pCvA"))},IqPN:function(e,t,n){"use strict";n.r(t),n.d(t,"guid",(function(){return i})),n.d(t,"overrideValues",(function(){return o})),n.d(t,"isNOU",(function(){return a})),n.d(t,"isBoolean",(function(){return s})),n.d(t,"isString",(function(){return u})),n.d(t,"isInteger",(function(){return p})),n.d(t,"expectObject",(function(){return v})),n.d(t,"expectNumber",(function(){return f})),n.d(t,"expectString",(function(){return h})),n.d(t,"expectBoolean",(function(){return m})),n.d(t,"expectGuid",(function(){return y})),n.d(t,"expectArray",(function(){return S})),n.d(t,"expectEnum",(function(){return C})),n.d(t,"createTimeoutPromise",(function(){return E})),n.d(t,"checkCssSelectorToBeSet",(function(){return T})),n.d(t,"isTenantIdCommercial",(function(){return b}));var r=n("apcD");const{guid:i,overrideValues:o,isNOU:a,isBoolean:s,isString:u,isObject:c,isEnumValue:l}=r.Utils;ction v(e,t){if(!c(e))throw t+" is not an object: "+e}function f(e,t){if(!d(e))throw t+" is not a number: "+e}function h(e,t){if(!u(e))throw t+" is not a string: "+e}function m(e,t){if(!s(e))throw t+" is not a boolean: "+e}nction C(e,t,n){if(!d(e)||!l(e,t))throw n+" is not an enum: "+e}function E(e,t){const n=new Promise(();return Promise.race([t,n])}function T(e){try{for(let t=0;t<document.styleSheets.length;t++){const n=document.styleSheets[t];for(let t=0;t<n.rules.length;t++){const r=n.rules[t];if(!a(r.selectorText)&&r.selectorText.includes(e))return!0}}}catch(e){}return!1}function b(e){if(a(e)||""===e||!g(e))return!1;const t=e.toLowerCase();return"00000000-0000-0000-0000-000000000000"!==t&&"9188040d-6c67-4c5b-b112-36a304b66dad"!==t&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==t}},"J+Cg":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyEventActivityStats=t.SurveyStatCollectionEventActivity=void 0;var i=n("DX5p"),o=n("iv/W"),a=n("3ndD"),s=n("FFSN"),u=function(e){eturn r(t,e),t.fromJson=function(e){var n,r=new t;if(!e)return r;try{n=JSON.parse(e)}catch(e){return o.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+e.toString()}),r}return r.deserialize(n)?r:new t},t.toJson=t.prototype.accumulate=function(e){if(e){var t=e.getStats();for(var n in t)if(t.hasOwnProperty(n)){var r=this.getBySurveyId(n);if(r||((r=new c).Counts=[],this.addStats(n,r)),r.ExpirationTimeUtc=t[n].ExpirationTimeUtc,r.Counts.length<t[n].Counts.length){var i=r.Counts.slice();r.Counts=i}for(var o=0;o<t[n].Counts.length;o++)r.Counts[o]||(r.Counts[o]=0),r.Counts[o]+=t[n].Counts[o]}}},t.prototype.deserialize=function(e){var t=e.Surveys,n=new Date;for(var r in t)if(t.hasOwnProperty(r)){var i=new c;i.deserialize(t[r])&&i.ExpirationTimeUtc>n&&this.addStats(r,i)}return this.validate()},t.prototype.validate=t}(a.SurveyStatCollection);t.SurveyStatCollectionEventActivity=u;var c=);t.SurveyEventActivityStats=c},JNQs:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSON_ID_KEYNAME=t.JSON_SURVEY_KEYNAME=t.DOM_ID_TAGNAME=t.DOM_TYPE_VALUE=t.DOM_TYPE_TAGNAME=t.SurveyInfoBusinessLevel=void 0,t.SurveyInfoBusinessLevel||(t.SurveyInfoBusinessLevel={})),t.DOM_TYPE_TAGNAME="Type",t.DOM_TYPE_VALUE="Survey",t.DOM_ID_TAGNAME="SurveyID",t.JSON_SURVEY_KEYNAME="survey",t.JSON_ID_KEYNAME="surveyId"},JUae:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r={error:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},info:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},warn:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},trace:event:userFactEvent:;function i(){return r},KCve:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICampaignDefinitions=void 0;var r=function(){return function(){}}();t.ICampaignDefinitions=r},KmlV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FloodgateSettings=void 0;var r=);t.FloodgateSettings=r},"Kx/u":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7P0z"),i=function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.question)throw new Error("data.question must not be null or empty");if(!e.title)throw new Error("data.title must not be null or empty");if(!e.yesButtonLabel)throw new Error("data.yesButtonLabel must not be null or empty");if(!e.noButtonLabel)throw new Error("data.noButtonLabel must not be null or empty");this.data=e,this.selectedButton=0}return e.make=function(t){try{return new e(t)}catch(e){return null}},e.prototype.getType=e.prototype.getTitle=function(){return this.data.title},e.prototype.getQuestion=function(){return this.data.question},e.prototype.getYesButtonText=function(){return this.data.yesButtonLabel},e.prototype.getNoButtonText=e.prototype.setButtonSelected=e.prototype.getButtonSelected=function(){return this.selectedButton},e.prototype.getDomElements=e.prototype.getJsonElements=e.prototype.getComponentJson=function(){var e;return(e={})[r.JSON_TITLE_KEYNAME]=this.getTitle(),e[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),e[r.JSON_PROMPTYESTEXT_KEYNAME]=this.getYesButtonText(),e[r.JSON_PROMPTNOTEXT_KEYNAME]=this.getNoButtonText(),e},e.prototype.promptButtonToString=e}();!function(e){var t=function(){return function(){}}();e.PromptComponentData=t}(i||(i={})),t.default=i},LIHk:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GovernanceServiceClientState=t.GovernanceServiceSurveyType=void 0,t.GovernanceServiceSurveyType||(t.GovernanceServiceSurveyType={})),t.GovernanceServiceClientState||(t.GovernanceServiceClientState={}))},NIYO:function(e,t,n){"use strict";function r(e,t){var n=new Promise((function(t,n){var r=setTimeout((,e)}));return Promise.race([t,n])}function i(e){var t,n,r;return null!==(r=null===(n=null===(t=e)||void 0===t?void 0:t.message)||void 0===n?void 0:n.toString())&&void 0!==r?r:null==e?void 0:e.toString()}tion c(e){return null!=e&&"function"==typeof e}.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return l}))},OU4w:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},RCny:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"f",(function(){return d}));class r{}r.Alt="alt",r.AriaLabel="aria-label",r.AriaSelected="aria-selected",r.AriaOrientation="aria-orientation",r.AriaExpanded="aria-expanded",r.AriaControls="aria-controls",r.AriaHasPopups="aria-haspopup",r.AriaModal="aria-modal",r.AriaLabelledBy="aria-labelledby",r.AriaDescribedBy="aria-describedby",r.Class="class",r.DataHtml2CanvasIgnore="data-html2canvas-ignore",r.Disabled="disabled",r.Fill="fill",r.For="for",r.Preview="preview",r.Form="form",r.Height="height",r.HRef="href",r.Id="id",r.MaxLength="maxlength",r.Name="name",r.Placeholder="placeholder",r.Points="points",r.Rel="rel",r.Role="role",r.Source="src",r.Stroke="stroke",r.Style="style",r.TabIndex="tabindex",r.Target="target",r.Transform="transform",r.Type="type",r.Value="value",r.ViewBox="viewBox",r.Width="width",r.xlinkHref="xlink:href",r.X="x",r.Y="y";class i{}i.BlankWindow="_blank",i.Button="button",i.Dialog="dialog",i.Tab="tab",i.TabList="tablist",i.TabPanel="tabpanel",i.Checkbox="checkbox",i.Checked="checked",i.False="false",i.Zero="0",i.Polite="polite",i.Radio="radio",i.Submit="submit",i.ScreenshotPreview="ScreenshotPreview",i.Text="text",i.TextAreaMaxLength="1000",i.True="true",i.Unchecked="unchecked",i.NoReferrer="noreferrer",i.AriaOrientationValueVertical="vertical";class o{}o.AriaLiveTemplate="obf-AriaLiveTemplate",o.CheckBox="obf-CheckBox",o.FontTitle="obf-FontTitle",o.CloseButton="obf-CloseButton",o.FontSubtitle="obf-FontSubtitle",o.FontText="obf-FontText",o.FontSubText="obf-FontSubText",o.FontSubSubText="obf-FontSubSubText",o.Hidden="obf-Hidden",o.Link="obf-Link",o.MarginLeft60px="obf-MarginLeft60px",o.MarginLeft180px="obf-MarginLeft180px",o.NarrowLayout="obf-NarrowLayout",o.PrivacyStatementLinkDiv="obf-PrivacyStatementLinkDiv",o.PrivacyStatementLinkDivEudbUx="obf-PrivacyStatementLinkDivEudbUx",o.Rtl="obf-Rtl",o.Spinner="obf-Spinner",o.SpinnerCircle="obf-SpinnerCircle",o.SubmitButton="obf-SubmitButton",o.CancelButton="obf-CancelButton",o.TextInput="obf-TextInput",o.Visible="obf-Visible",o.Rating="obf-Rating",o.RatingGraphic="obf-RatingGraphic",o.RatingGraphicFilled="obf-RatingGraphic-Filled",o.ChoiceGroup="obf-ChoiceGroup",o.ChoiceGroupIcon="obf-ChoiceGroupIcon",o.OverallAnchor="obf-OverallAnchor",o.OverallAnchorActive="obf-OverallAnchorActive",o.OverallImage="obf-OverallImage",o.OverallText="obf-OverallText",o.SingleLayout="obf-SingleLayout",o.ShowRightBorder="obf-ShowRightBorder",o.SlideLeft="obf-slideLeft",o.TextAlignLeft="obf-TextAlignLeft",o.FormContainer="obf-FormContainer",o.FormWideContainer="obf-FormWideContainer",o.ThanksPanelTitle="obf-ThanksPanelTitle",o.ThanksPanelMessage="obf-ThanksPanelMessage",o.FormQuestionMiddleText="obf-FormQuestionMiddleText",o.FormMiddleText="obf-FormMiddleText",o.FormCategoriesDropdown="obf-FormCategoriesDropdown",o.FormComment="obf-FormComment",o.FormRatingContainer="obf-FormRatingContainer",o.FormRatingLabel="obf-FormRatingLabel",o.FormRating="obf-FormRating",o.FormEmailContainer="obf-FormEmailContainer",o.FormEmailInput="obf-FormEmailInput",o.FormEmailTextBox="obf-FormEmailTextBox",o.FormEmailCheckBox="obf-FormEmailCheckBox",o.FormEmailLabel="obf-FormEmailLabel",o.FormBottomContainer="obf-FormBottomContainer",o.FormSubmitButtonContainer="obf-FormSubmitButtonContainer",o.FormScreenshotContainer="obf-FormScreenshotContainer",o.FormScreenshotLabel="obf-FormScreenshotLabel",o.FormScreenshotCheckbox="obf-FormScreenshotCheckbox",o.FormScreenshotPreview="obf-FormScreenshotPreview",o.FormPrivacyConsentText="obf-TFormPrivacyConsentText",o.TFormEmailCheckbox="obf-TFormEmailCheckbox",o.TFormEmailLabel="obf-TFormEmailLabel ",o.EmailCheckBoxLabel="obf-EmailCheckBoxLabel",o.Toast="obf-Toast",o.ToastZoom="obf-ToastZoom";class a{}a.CloseButton="obf-CloseButton",a.ColumnSeparatorDiv="obf-ColumnSeparatorDiv",a.OverallAnchorsContainer="obf-OverallAnchorsContainer",a.OverallFrownAnchor="obf-OverallFrownAnchor",a.OverallFrownDiv="obf-OverallFrownDiv",a.OverallFrownImage="obf-OverallFrownImage",a.OverallFrownText="obf-OverallFrownText",a.OverallSmileAnchor="obf-OverallSmileAnchor",a.OverallSmileDiv="obf-OverallSmileDiv",a.OverallSmileImage="obf-OverallSmileImage",a.OverallSmileText="obf-OverallSmileText",a.OverallIdeaAnchor="obf-OverallIdeaAnchor",a.OverallIdeaDiv="obf-OverallIdeaDiv",a.OverallIdeaImage="obf-OverallIdeaImage",a.OverallIdeaText="obf-OverallIdeaText",a.OverallBugAnchor="obf-OverallBugAnchor",a.OverallBugDiv="obf-OverallBugDiv",a.OverallBugImage="obf-OverallBugImage",a.OverallBugText="obf-OverallBugText",a.QuestionLeftText="obf-QuestionLeftText",a.LeftFormContainer="obf-LeftFormContainer",a.LeftPanelContainer="obf-LeftPanelContainer",a.MainContainer="obf-MainContainer",a.MainContentHolder="obf-MainContentHolder",a.MiddleFormContainer="obf-MiddleFormContainer",a.OverlayBackground="obf-OverlayBackground",a.PrivacyStatementLink="obf-PrivacyStatementLink",a.PrivacyConsentText="obf-PrivacyConsentText",a.FirstTabbable="obf-FirstTabbable",a.LastTabbable="obf-LastTabbable",a.EmailCheckBox="obf-EmailCheckBox",a.SingleFormContainer="obf-SingleFormContainer",a.SingleFormQuestionMiddleText="obf-SingleFormQuestionMiddleText",a.SingleFormCategoriesDropdown="obf-SingleFormCategoriesDropdown",a.SingleFormComment="obf-SingleFormComment",a.SingleFormEmailInput="obf-SingleFormEmailInput",a.SingleFormRating="obf-SingleFormRating",a.SingleFormScreenshotCheckbox="obf-SingleFormScreenshotCheckbox",a.SingleFormScreenshotPreview="obf-SingleFormScreenshotPreview",a.SingleFormSubmitButton="obf-SingleFormSubmitButton",a.SingleFormCancelButton="obf-SingleFormCancelButton",a.SingleFormSubmitButtonSpinner="obf-SingleFormSubmitButtonSpinner",a.BasicFormContainer="obf-BasicFormContainer",a.BasicFormQuestionMiddleText="obf-BasicFormQuestionMiddleText",a.BasicFormCategoriesDropdown="obf-BasicFormCategoriesDropdown",a.BasicFormComment="obf-BasicFormComment",a.BasicFormEmailInput="obf-BasicFormEmailInput",a.BasicFormRating="obf-BasicFormRating",a.BasicFormScreenshotCheckbox="obf-BasicFormScreenshotCheckbox",a.BasicFormScreenshotPreview="obf-BasicFormScreenshotPreview",a.BasicFormSubmitButton="obf-BasicFormSubmitButton",a.BasicFormCancelButton="obf-BasicFormCancelButton",a.BasicFormSubmitButtonSpinner="obf-BasicFormSubmitButtonSpinner",a.ThanksPanelContainer="obf-ThanksPanelContainer",a.ThanksPanelCloseButton="obf-ThanksPanelCloseButton",a.ThanksPanelDiscussion="obf-ThanksPanelDiscussion",a.ThanksPanelVerticalContainer="obf-ThanksPanelVerticalContainer",a.ThanksPanelInnerContainer="obf-ThanksPanelInnerContainer",a.ThanksPanelParagraph="obf-ThanksPanelParagraph",a.FeedbackPortalIdeaContainer="obf-FeedbackPortalIdeaContainer",a.OverallFeedbackPortalIdeaAnchor="obf-OverallFeedbackPortalIdeaAnchor",a.ToastContainer="obf-ToastContainer",a.ToastCancel="obf-ToastCancel",a.TPromptContainer="obf-TPromptContainer",a.TPromptTitle="obf-TPromptTitle",a.TPromptText="obf-TPromptText",a.TFormContainer="obf-TFormContainer",a.TFormTitle="obf-TFormTitle",a.TFormRating="obf-TFormRating",a.TFormRatingQuestion="obf-TFormRatingQuestion",a.TFormCommentQuestion="obf-TFormCommentQuestion",a.TFormComment="obf-TFormComment",a.TFormEmailTextBox="obf-TFormEmailTextBox",a.TFormEmailCheckBox="obf-TFormEmailCheckBox",a.TFormEmailLabel="obf-TFormEmailLabel",a.TFormSubmitButton="obf-TFormSubmitButton",a.TFormCancelButton="obf-TFormCancelButton",a.TFormSubmitButtonSpinner="obf-TFormSubmitButtonSpinner",a.TFormSubmitButtonContainer="obf-TFormSubmitButtonContainer";class s{}s.Esc=27,s.Tab=9;class u{}u.Anchor="A",u.Button="button",u.Defs="defs",u.Div="div",u.FieldSet="fieldset",u.Form="form",u.Img="img",u.Input="input",u.Label="label",u.Legend="legend",u.Option="option",u.Polygon="polygon",u.Select="select",u.Span="span",u.Svg="svg",u.TextArea="textarea",u.Use="use";class c{}c.Button="Button";class l{}l.PrivacyStatementLink="https://go.microsoft.com/fwlink/?LinkId=521839";.No="1",d.Yes="2"},Rvco:U0vT:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},U5wP:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("QjXU"),i=n("7P0z"),o=n("apcD"),a=n("ZeN8"),s=n("kZ16"),u=n("vVCL");const c=new class{constructor(){this.personalizerEnabled=!1,this.dynamicTransport=new u.a,this.personalizerSurveyInformationMap={}}setup(e){this.personalizerEnabled=e.getFloodgateInitOptions().governanceServiceEnabled&&e.getFloodgateInitOptions().personalizerEnabled,this.personalizerEnabled&&(this.isProduction=0===e.getCommonInitOptions().environment,this.retryLimit=e.getFloodgateInitOptions().governanceServiceConfig.retry,this.timeout=e.getFloodgateInitOptions().governanceServiceConfig.timeout,this.requestUrl=this.isProduction?"https://oness.microsoft.com/api/v1.0/Reward":"https://onessppe.microsoft.com/api/v1.0/Reward")}setEventIdAndOverrideValueForSurveyId(e,t,n,r,i){if(!this.personalizerEnabled||o.Utils.isNOU(e)||o.Utils.isNOU(r))return!1;if(0!==t)return!1;const a=this.validateAndGetAutoDismissTime(n);return!o.Utils.isNOU(a)&&(this.personalizerSurveyInformationMap[r]={eventId:e,recommendedAutoDismissValue:a,userAction:void 0},!0)}getOverrideValueForSurveyId(e,t){if(this.personalizerEnabled&&!o.Utils.isNOU(t)&&this.infoExistsForSurveyId(t)&&0===e)return this.personalizerSurveyInformationMap[t].recommendedAutoDismissValue}logUserActionForSurveyAsync(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){!o.Utils.isNOU(e)&&this.infoExistsForSurveyId(t)&&(this.personalizerSurveyInformationMap[t].userAction=e);const r={error:!1},i=this.getValidatedActionPayloadForSurveyId(t);if(o.Utils.isNOU(i))return r.error=!0,r.errorMessage="Action Payload validation failed.",s.b().logEvent(s.a.PERSONALIZER_CLIENTFAILURE,1,{Message:"(PersonalizerClient.logUserActionForSurveyAsync) Error logging personalizer user action: "+r.errorMessage,CampaignId:n,SurveyId:t}),r;let a;try{const e=performance.now();a=yield this.dynamicTransport.postRequestWithRetry(this.requestUrl,JSON.stringify(i),this.retryLimit,this.timeout);const o=performance.now();return s.b().logEvent(s.a.PERSONALIZER_SERVICEREWARDRESULT,1,{TimeMilliseconds:o-e,HttpStatusCode:a.status,HttpStatusText:a.statusText,AdditionalSurveyInfo:this.buildConfigTelemetryString(),CorrelationId:this.dynamicTransport.requestId,CampaignId:n,PersonalizerUserAction:i.UserAction,PersonalizerEventId:i.EventId,SurveyId:t}),a.ok||(r.error=!0,r.errorMessage=`Server Error, status: ${a.status}, status text: ${a.statusText}`),r}catch(e){return r.error=!0,r.errorMessage=`Error: ${e.toString()}, Error stack: ${e.stack}`,s.b().logEvent(s.a.PERSONALIZER_CLIENTFAILURE,1,{Message:"(PersonalizerClient.logUserActionForSurveyAsync) Error logging personalizer user action: "+r.errorMessage,CampaignId:n,SurveyId:t,PersonalizerUserAction:i.UserAction,PersonalizerEventId:i.EventId}),r}}))}getEventIdForSurveyIdsEnabled(e,t,n){return e===i.Api.SurveyType.Fps&&t!==a.e&&"customux"!==t&&n===i.GovernedChannelType.Standard&&this.personalizerEnabled}getValidatedActionPayloadForSurveyId(e){if(!this.infoExistsForSurveyId(e))return;const t=this.personalizerSurveyInformationMap[e];return o.Utils.isNOU(t.eventId)||o.Utils.isNOU(t.userAction)||2!==t.userAction&&0!==t.userAction&&1!==t.userAction?void 0:{UserAction:t.userAction,EventId:t.eventId}}validateAndGetAutoDismissTime(e){if(!o.Utils.isNOU(e)&&"string"==typeof e)switch(parseInt(e,10)){case 0:return 0;case 7:return 1;case 14:return 2;case 21:return 3;case 28:return 4;case 60:return 5;case 90:return 6;case 120:return 7;case 150:return 8;default:return}}infoExistsForSurveyId(e){return!o.Utils.isNOU(e)&&!o.Utils.isNOU(this.personalizerSurveyInformationMap[e])};,UUdt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Governor=void 0;var r=n("7P0z"),i=n("pUrp"),o=n("yOOe"),a=n("FFSN").isNOU,s=function(){return function(e,t){this.name=e,this.cooldownSeconds=t}}(),u=function(){function e(e,t){if(this.channels=[],!e)throw new Error("channelStateProvider must not be null");this.channelStateProvider=e,this.loadChannels(),this.appGovernanceProvider=t}return e.GetChannelCoolDown=e.SetDefaultChannelCoolDown=e.prototype.isSurveyTrackable=e.prototype.refreshChannelData=e.prototype.getAvailableChannelData=function(){var e=[];for(var t in this.channels)if(this.channels.hasOwnProperty(t)){var n=this.channels[t];n.isOpen()&&e.push(n)}return e},e.prototype.isChannelOpen=function(e){if(a(e))throw new Error("type must not be null");return this.channels[e].isOpen()},e.prototype.startChannelCooldown=function(e,t){if(a(e))throw new Error("type must not be null");t=t||new Date,this.channels[e].setCooldownStartTime(t),this.saveChannelStates()},e.prototype.saveChannelStates=function(){var e=[];for(var t in this.channels)if(this.channels.hasOwnProperty(t)){var n=this.channels[t],r=new o.GovernedChannelState(n.getType(),n.getCooldownStartTime());e.push(r)}this.channelStateProvider.save(e)},e.prototype.loadChannels=function(){for(var t in this.loadChannelStatesFromProvider(),r.GovernedChannelType)if(r.GovernedChannelType.hasOwnProperty(t)){var n=Number(t);if(isNaN(n)||this.channels[n])continue;var o=e.defaultChannelData[n],a=new i.GovernedChannel(n,o.name,o.cooldownSeconds,null);this.channels[n]=a}},e.prototype.loadChannelStatesFromProvider=function(){this.channels=[];var t=this.channelStateProvider.load();for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],o=r.getType(),a=e.defaultChannelData[o],s=new i.GovernedChannel(o,a.name,a.cooldownSeconds,r.getCooldownStartTime());this.channels[s.getType()]=s}},e.defaultChannelData=[new s(r.GovernedChannelType[r.GovernedChannelType.Standard],14*(e.day=24*(e.hour=60*(e.minute=60)))),new s(r.GovernedChannelType[r.GovernedChannelType.Urgent],0),new s(r.GovernedChannelType[r.GovernedChannelType.Banner],15*e.day),new s(r.GovernedChannelType[r.GovernedChannelType.TeachingMessage],1*e.hour),new s(r.GovernedChannelType[r.GovernedChannelType.BusinessBar],3*e.hour)],e}();t.Governor=u},UZw0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityTrackingContract=void 0;var r=);t.ActivityTrackingContract=r},UmvI:function(e,t,n){"use strict";var r=this&&this.__extends||);Object.defineProperty(t,"__esModule",{value:!0});var i=n("7P0z"),o=n("Z+rh"),a=n("Kx/u"),s=n("iW5C"),u=n("FFSN"),c=n("8+ih"),l=n("Dwqi"),d=u.isNOU,p=u.overrideValues,g=function(e){function t(t){var n=e.call(this)||this;if(d(t))throw new Error("data must not be null");return n.surveyInfo=new l.default(t.baseData),n.prompt=new a.default(t.promptData),n.question=new o.default(t.commentData),n.rating=new s.default(t.ratingData),n}return r(t,e),t.make=t.makeNlqs=function(e,n,r){if(d(e)||d(n)||d(r))return null;var i=[],u=r.content;if(d(u)||d(u.comment)||d(u.prompt)||d(u.rating))return null;var c=new t.NlqsSurveyData;c.baseData=e,c.promptData=new a.default.PromptComponentData,c.ratingData=new s.default.RatingComponentData,c.commentData=new o.default.CommentComponentData,c.promptData.title=n.getCustomString(u.prompt.title),c.promptData.question=n.getCustomString(u.prompt.question),c.promptData.yesButtonLabel=n.getCustomString(u.prompt.yesLabel),c.promptData.noButtonLabel=n.getCustomString(u.prompt.noLabel),c.ratingData.question=n.getCustomString(u.rating.question),c.ratingData.isZeroBased=u.rating.isZeroBased,c.commentData.question=n.getCustomString(u.comment.question);for(var l=0,p=u.rating.ratingValuesAscending;l<p.length;l++){var g=n.getCustomString(p[l]);if(d(g))return null;i.push(g)}return c.ratingData.ratingValuesAscending=i,d(c.ratingData.question)||d(c.commentData.question)||d(c.promptData.title)||d(c.promptData.question)||d(c.promptData.yesButtonLabel)||d(c.promptData.noButtonLabel)||d(c.ratingData.ratingValuesAscending)?null:this.make(c)},t.prototype.getType=t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getTags=t.prototype.getComponent=function(e){switch(e){case"Comment":return this.getCommentComponent();case"Prompt":return this.getPromptComponent();case"Rating":return this.getRatingComponent();default:return null}},t.prototype.getDomElements=function(e){if(d(e))throw new Error("Document must not be null");var t=e.createElement(i.DOM_NLQS_TAGNAME);return this.getSurveyInfo().getDomElements(e).forEach((function(e){d(e)||t.appendChild(e)})),this.getCommentComponent().getDomElements(e).forEach((function(e){d(e)||t.appendChild(e)})),this.getRatingComponent().getDomElements(e).forEach((),[t]},t.prototype.getJsonElements=function(){var e={};return e=p(this.getSurveyInfo().getJsonElements(),e),e=p(this.getCommentComponent().getJsonElements(),e),p(this.getRatingComponent().getJsonElements(),e)},t}(c.Survey);!g||(g={})),t.default=g},VE5j:XR5y:XtAz:Y3a9:function(e,t,n){"use strict";n.d(t,"c",(function(){return s.c})),n.d(t,"a",(function(){return s.a})),n.d(t,"b",(),n.d(t,"d",(function(){return d})),n.d(t,"e",();var r=n("IqPN"),i=n("ZeN8");let o=["af","am","ar","as","az","be","bg","bn-BD","bn-IN","bs","ca","ca-Es-VALENCIA","chr-Cher","cs","cy","da","de","el","en-GB","es","es-MX","et","eu","fa","fi","fil","fr","fr-CA","ga","gd","gl","gu","ha-Latn-NG","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-KH","kn","ko","kok","ky","lb","lo","lt","lv","mi","mk","ml","mn","mr","ms","mt","nb-NO","ne","nl","nn-NO","or","pa","pl","prs","pt-BR","pt-PT","quz","ro","ru","sd","si","sk","sl","sq","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv","sw","ta","te","th","tk","tr","tt","ug","uk","ur","uz-Latn-UZ","vi","zh-Hans","zh-Hant"];const a={"ZH-CN":"zh-Hans","ZH-HK":"zh-Hant","ZH-MO":"zh-Hant","ZH-SG":"zh-Hans","ZH-TW":"zh-Hant"};var s=n("Pei2"),u=n("RCny");class c{tatic validateCategoryOptions(e){if(!e)return{show:!1};if(r.expectBoolean(e.show,"categories.show"),e.customCategories){r.expectArray(e.customCategories,"categories.customCategories");for(let t of e.customCategories)if(r.expectString(t,"custom category '"+t+"'"),t.length>20)throw"custom category '"+t+"' too long, max 20 characters."}return e}getFeedbackSubmitted(){return this.feedbackSubmitted}setFeedbackSubmitted(e){this.feedbackSubmitted=e}getCommonInitOptions(){return this.commonInitOptions}getInAppFeedbackInitOptions(){return this.inAppFeedbackInitOptions}getInAppFeedbackLaunchOptions(){return this.inAppFeedbackLaunchOptions}getFloodgateInitOptions(){return this.floodgateInitOptions}getFloodgateSurvey(){return this.floodgateSurvey}getCVRenderContext(){return this.cvRenderContext}tCommonInitOptions(e){r.expectObject(e,"passedInitOptions");let t={appId:e.appId,applicationGroup:e.applicationGroup||{},build:e.build,cid:e.cid,environment:e.environment,intlFilename:e.intlFilename,intlUrl:e.intlUrl,webSurfacesResourceBaseUrl:e.webSurfacesResourceBaseUrl,locale:e.locale,onError:e.onError,originalLocale:e.locale,primaryColour:e.primaryColour,secondaryColour:e.secondaryColour,sessionId:e.sessionId,stylesUrl:e.stylesUrl,telemetryGroup:e.telemetryGroup||{},userEmail:e.userEmail,webGroup:e.webGroup||{},eventSampling:e.eventSampling,petrolTimeout:e.petrolTimeout,isCommercialHost:e.isCommercialHost,customResourcesSetExternally:e.customResourcesSetExternally,emailPolicyValue:e.emailPolicyValue,screenshotPolicyValue:e.screenshotPolicyValue,ageGroup:e.ageGroup,authenticationType:e.authenticationType,applicationSettings:e.applicationSettings,webSurfacesSettings:e.webSurfacesSettings,privacyUrl:e.privacyUrl||u.i.PrivacyStatementLink,retentionDurationDays:e.retentionDurationDays,telemetrySink:e.telemetrySink};if(r.expectNumber(t.appId,"initOptions.appId"),!(t.appId%1==0&&t.appId>0))throw"initOptions.appId is not a positive integer: "+t.appId;if(void 0!==t.retentionDurationDays&&(r.expectNumber(t.retentionDurationDays,"initOptions.retentionDurationDays"),!(t.retentionDurationDays%1==0&&t.retentionDurationDays>0)))throw"initOptions.retentionDurationDays is not a positive integer: "+t.retentionDurationDays;const n=s.c.Strings|s.c.Css;if(void 0===t.customResourcesSetExternally)t.customResourcesSetExternally=s.c.None;else if("number"!=typeof t.customResourcesSetExternally||(t.customResourcesSetExternally|n)!==n)throw"initOptions.customResourcesSetExternally has an invalid value: "+t.customResourcesSetExternally;if((t.customResourcesSetExternally&s.c.Css)!==s.c.Css&&r.expectString(t.stylesUrl,"initOptions.stylesUrl"),(t.customResourcesSetExternally&s.c.Strings)!==s.c.Strings&&r.expectString(t.intlUrl,"initOptions.intlUrl"),void 0!==t.intlFilename?r.expectString(t.intlFilename,"initOptions.intlFilename"):t.intlFilename="officebrowserfeedbackstrings.js",r.expectNumber(t.environment,"initOptions.environment"),1!==t.environment&&0!==t.environment)throw"initOptions.environment has a bad value: "+t.environment;void 0!==t.userEmail?r.expectString(t.userEmail,"initOptions.userEmail"):t.userEmail="",void 0!==t.sessionId?r.expectString(t.sessionId,"initOptions.sessionId"):t.sessionId="00000000-0000-0000-0000-000000000000",t.telemetryGroup.processSessionId=t.sessionId,void 0!==t.cid&&(r.expectString(t.cid,"initOptions.cid"),t.applicationGroup.extendedManifestData=JSON.stringify({cid:t.cid})),void 0!==t.build?(r.expectString(t.build,"initOptions.build"),new RegExp("^[0-9]{1,9}(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?$").test(t.build)||(t.build="0.0.0.0")):t.build="0.0.0.0",t.telemetryGroup.officeBuild=t.build;let i=new RegExp("^#[0-9a-f]{3}([0-9a-f]{3})?$","i");if(void 0!==t.primaryColour&&(i.test(t.primaryColour)||(t.primaryColour=void 0)),void 0!==t.secondaryColour&&(i.test(t.secondaryColour)||(t.secondaryColour=void 0)),void 0!==t.locale?(r.expectString(t.locale,"initOptions.locale"),t.locale=function(e){let t=e.toLocaleUpperCase();if(t in a)return a[t];for(let e of o)if(e.toUpperCase()===t)return e;let n=t.split("-")[0];for(let e of o)if(e.toUpperCase()===n)return e;return"en"}(t.locale)):t.locale="en",void 0===t.onError&&(t.onError=,void 0!==t.petrolTimeout&&r.expectNumber(t.petrolTimeout,"initOptions.petrolTimeout"),void 0!==t.authenticationType?r.expectEnum(t.authenticationType,s.b,"initOptions.authenticationType"):t.authenticationType=s.b.Unauthenticated,void 0!==t.ageGroup?r.expectEnum(t.ageGroup,s.a,"initOptions.ageGroup"):t.ageGroup=s.a.Undefined,this.eventSampling=this.parseEventSamplingOption(t.eventSampling),this.commonInitOptions=t,this.commonPolicyAllowAADC=this.determineAADCPolicy(t.authenticationType,t.ageGroup),void 0===t.isCommercialHost||null==t.isCommercialHost?t.isCommercialHost=!1:r.expectBoolean(t.isCommercialHost,"initOptions.isCommercialHost"),void 0===t.emailPolicyValue)t.emailPolicyValue=0;else if("number"!=typeof t.emailPolicyValue||0!==t.emailPolicyValue&&1!==t.emailPolicyValue&&2!==t.emailPolicyValue)throw"initOptions.emailPolicyValue has an invalid value: "+t.emailPolicyValue;if(void 0===t.screenshotPolicyValue)t.screenshotPolicyValue=0;else if("number"!=typeof t.screenshotPolicyValue||0!==t.screenshotPolicyValue&&1!==t.screenshotPolicyValue&&2!==t.screenshotPolicyValue)throw"initOptions.screenshotPolicyValue has an invalid value: "+t.screenshotPolicyValue;void 0!==t.privacyUrl?r.expectString(t.privacyUrl,"initOptions.privacyUrl"):t.privacyUrl=u.i.PrivacyStatementLink,r.expectObject(t.telemetrySink,"initOptions.telemetrySink")}setInAppFeedbackInitOptions(e){r.expectObject(e,"passedInitOptions");let t={bugForm:e.bugForm,onDismiss:e.onDismiss,screenshot:e.screenshot,showEmailAddress:e.showEmailAddress,userEmail:e.userEmail,transitionEnabled:e.transitionEnabled,isShowThanks:e.isShowThanks,sendFeedbackPolicyValue:e.sendFeedbackPolicyValue,feedbackForumUrl:void 0!==e.feedbackForumUrl?e.feedbackForumUrl:void 0,myFeedbackForumUrl:void 0!==e.myFeedbackForumUrl?e.myFeedbackForumUrl:void 0};if(void 0===t.onDismiss&&(t.onDismiss=,void 0!==t.bugForm?r.expectBoolean(t.bugForm,"initOptions.bugForm"):t.bugForm=!1,void 0!==t.userEmail&&r.expectString(t.userEmail,"initOptions.userEmail"),void 0!==t.screenshot?r.expectBoolean(t.screenshot,"initOptions.screenshot"):t.screenshot=!0,void 0!==t.showEmailAddress?r.expectBoolean(t.showEmailAddress,"initOptions.showEmailAddress"):t.showEmailAddress=!0,void 0!==t.feedbackForumUrl?r.expectString(t.feedbackForumUrl,"initOptions.feedbackForumUrl"):t.feedbackForumUrl=void 0,void 0!==t.isShowThanks?r.expectBoolean(t.isShowThanks,"initOptions.isShowThanks"):t.isShowThanks=!0,void 0!==t.myFeedbackForumUrl?r.expectString(t.myFeedbackForumUrl,"initOptions.myFeedbackForumUrl"):t.myFeedbackForumUrl=void 0,void 0===t.transitionEnabled&&(t.transitionEnabled=!0),void 0===t.sendFeedbackPolicyValue)t.sendFeedbackPolicyValue=0;else if("number"!=typeof t.sendFeedbackPolicyValue||0!==t.sendFeedbackPolicyValue&&1!==t.sendFeedbackPolicyValue&&2!==t.sendFeedbackPolicyValue)throw"initOptions.sendFeedbackPolicyValue has an invalid value: "+t.sendFeedbackPolicyValue;this.inAppFeedbackInitOptions=t}setInAppFeedbackLaunchOptionsetFloodgateInitOptions(e){r.expectObject(e,"passedInitOptions");let t={autoDismiss:e.autoDismiss,campaignDefinitions:e.campaignDefinitions,campaignFlights:e.campaignFlights,campaignQueryParameters:e.campaignQueryParameters,onDismiss:e.onDismiss,onSurveyActivatedCallback:e.onSurveyActivatedCallback,settingStorageCallback:e.settingStorageCallback,uIStringGetter:e.uIStringGetter,authTokenCallback:e.authTokenCallback,surveyEnabled:e.surveyEnabled,showEmailAddress:e.showEmailAddress,augLoopCallback:e.augLoopCallback,customerVoiceSurveyParams:e.customerVoiceSurveyParams,surveyCSSParams:e.surveyCSSParams,governanceServiceEnabled:e.governanceServiceEnabled,governanceServiceConfig:e.governanceServiceConfig,personalizerEnabled:e.personalizerEnabled,messagingServiceSettings:e.messagingServiceSettings,isPriorityEnabled:e.isPriorityEnabled,isEudbUxEnabled:e.isEudbUxEnabled,appGovernanceProvider:e.appGovernanceProvider,dynamicCampaignConfig:e.dynamicCampaignConfig};void 0===t.autoDismiss&&(t.autoDismiss=0),void 0===t.onDismiss&&(t.onDismiss=,void 0===t.onSurveyActivatedCallback&&(t.onSurveyActivatedCallback={onSurveyActivated),void 0===t.uIStringGetter&&(t.uIStringGetter=,void 0===t.surveyEnabled?t.surveyEnabled=!0:r.expectBoolean(t.surveyEnabled,"surveyEnabled"),void 0!==t.showEmailAddress?r.expectBoolean(t.showEmailAddress,"initOptionsFloodgate.showEmailAddress"):t.showEmailAddress=!0,void 0!==t.governanceServiceEnabled?r.expectBoolean(t.governanceServiceEnabled,"initOptionsFloodgate.governanceServiceEnable"):t.governanceServiceEnabled=!0,t.governanceServiceEnabled&&(t.governanceServiceConfig=this.parseGovernanceServiceConfig(void 0!==t.governanceServiceConfig?t.governanceServiceConfig:{})),void 0===t.customerVoiceSurveyParams?t.customerVoiceSurveyParams={cvFlights:"",isCVSurveyEnabled:!0,productName:"",uiHost:""}:r.isNOU(t.customerVoiceSurveyParams.isCVSurveyEnabled)&&(t.customerVoiceSurveyParams.isCVSurveyEnabled=!0),void 0!==t.personalizerEnabled?r.expectBoolean(t.personalizerEnabled,"initOptionsFloodgate.personalizerEnabled"):t.personalizerEnabled=!1,void 0!==t.isPriorityEnabled?r.expectBoolean(t.isPriorityEnabled,"initOptionsFloodgate.isPriorityEnabled"):t.isPriorityEnabled=!0,void 0!==t.isEudbUxEnabled?r.expectBoolean(t.isEudbUxEnabled,"initOptionsFloodgate.isEudbUxEnabled"):t.isEudbUxEnabled=!0,t.dynamicCampaignConfig=this.parseDynamicCampaignConfig(void 0!==t.dynamicCampaignConfig?t.dynamicCampaignConfig:{enabled:!1}),this.floodgateInitOptions=t}setFloodgateSurvey(e){this.floodgateSurvey=e}heckIfSurveysEnabled(){return(!this.floodgateInitOptions||this.floodgateInitOptions.surveyEnabled)&&this.commonPolicyAllowAADC}isFeedbackSurveyEnabledByAADC(){return this.commonPolicyAllowAADC}getCVSurveyFlights(){return this.floodgateInitOptions&&this.floodgateInitOptions.customerVoiceSurveyParams?this.floodgateInitOptions.customerVoiceSurveyParams.cvFlights:""}isCVSurveyEnabled(){return!this.floodgateInitOptions||!this.floodgateInitOptions.customerVoiceSurveyParams||this.floodgateInitOptions.customerVoiceSurveyParams.isCVSurveyEnabled}etUIHost(){return this.floodgateInitOptions&&this.floodgateInitOptions.customerVoiceSurveyParams?this.floodgateInitOptions.customerVoiceSurveyParams.uiHost:""}getUIHostCVSurveyDispatcher(){return this.floodgateInitOptions&&this.floodgateInitOptions.customerVoiceSurveyParams?this.floodgateInitOptions.customerVoiceSurveyParams.uiHostCVSurveyDispatcher:""}getCSSPosition(){return this.floodgateInitOptions&&this.floodgateInitOptions.surveyCSSParams&&this.floodgateInitOptions.surveyCSSParams.cssPosition?this.floodgateInitOptions.surveyCSSParams.cssPosition:""}getCSSZIndex(){return this.floodgateInitOptions&&this.floodgateInitOptions.surveyCSSParams&&this.floodgateInitOptions.surveyCSSParams.cssZIndex?this.floodgateInitOptions.surveyCSSParams.cssZIndex:""}getCSSBottom(){return this.floodgateInitOptions&&this.floodgateInitOptions.surveyCSSParams&&this.floodgateInitOptions.surveyCSSParams.cssBottom?this.floodgateInitOptions.surveyCSSParams.cssBottom:""}etRuntimeCssVars(){var e,t,n;return null!==(n=null===(t=null===(e=this.floodgateInitOptions)||void 0===e?void 0:e.surveyCSSParams)||void 0===t?void 0:t.runtimeCssVars)&&void 0!==n?n:{}}getRuntimeHtmlDataAttrs(){var e,t,n;return null!==(n=null===(t=null===(e=this.floodgateInitOptions)||void 0===e?void 0:e.surveyCSSParams)||void 0===t?void 0:t.runtimeHtmlDataAttrs)&&void 0!==n?n:{}}getCSSVarString(){const e=[];return this.floodgateInitOptions&&this.floodgateInitOptions.surveyCSSParams&&(this.floodgateInitOptions.surveyCSSParams.cssPosition&&e.push("--obf-position:",this.floodgateInitOptions.surveyCSSParams.cssPosition,";"),this.floodgateInitOptions.surveyCSSParams.cssZIndex&&e.push("--obf-zIndex:",this.floodgateInitOptions.surveyCSSParams.cssZIndex,";"),this.floodgateInitOptions.surveyCSSParams.cssBottom&&e.push("--obf-bottom:",this.floodgateInitOptions.surveyCSSParams.cssBottom,";"),this.floodgateInitOptions.surveyCSSParams.cssRight&&e.push("--obf-right:",this.floodgateInitOptions.surveyCSSParams.cssRight,";")),e.join("")}determineAADCPolicy(e,t){return e===s.b.Unauthenticated||e===s.b.AAD||t!==s.a.MinorWithParentalConsent&&t!==s.a.MinorWithoutParentalConsent}getUserConsentGroup(){const e=this.commonInitOptions.authenticationType;if(e===s.b.Unauthenticated||e===s.b.AAD)return 1;switch(this.commonInitOptions.ageGroup){case s.a.Undefined:return 1;case s.a.MinorWithoutParentalConsent:case s.a.MinorWithParentalConsent:return 3;case s.a.Adult:return 1;case s.a.NotAdult:return 2;case s.a.MinorNoParentalConsentRequired:return 1;default:return 3}return 3}parseEventSamplingOption(e){let t={event:{}};if(void 0!==e)for(const n in e)if(e.hasOwnProperty(n))switch(e[n].type){case"Event":let i=e[n].sampleRate;if(r.expectNumber(i,"initOption.EventSampling.SampleRate"),r.expectString(e[n].name,"initOption.EventSampling.Name"),i<0||i>1)throw"initOption.EventSampling."+e[n].name+".SampleRate is out of range";t.event[e[n].name]=i;break;default:throw"initOption.EventSampling.Type value is not recognized"}return t}parseGovernanceServiceConfig(e){const t={forceServicelessSurveyDisplay:!0,retry:1,timeout:1e3,simpleRequestEnabled:!1,isSurveyLevelGovernanceEnabled:!1};return void 0!==e.forceServicelessSurveyDisplay&&(r.expectBoolean(e.forceServicelessSurveyDisplay,"initOptionsFloodgate.governanceServiceConfig.forceServicelessSurveyDisplay"),t.forceServicelessSurveyDisplay=e.forceServicelessSurveyDisplay),void 0!==e.retry&&(r.expectNumber(e.retry,"initOptionsFloodgate.governanceServiceConfig.retry"),t.retry=e.retry),void 0!==e.timeout&&(r.expectNumber(e.timeout,"initOptionsFloodgate.governanceServiceConfig.timeout"),t.timeout=e.timeout),void 0!==e.simpleRequestEnabled&&(r.expectBoolean(e.simpleRequestEnabled,"initOptionsFloodgate.governanceServiceConfig.simpleRequestEnabled"),t.simpleRequestEnabled=e.simpleRequestEnabled),void 0!==e.isSurveyLevelGovernanceEnabled&&(r.expectBoolean(e.isSurveyLevelGovernanceEnabled,"initOptionsFloodgate.governanceServiceConfig.isSurveyLevelGovernanceEnabled"),t.isSurveyLevelGovernanceEnabled=e.isSurveyLevelGovernanceEnabled),t}parseDynamicCampaignConfig(e){const t={enabled:!1,ecsClient:void 0};return void 0!==e.enabled&&(r.expectBoolean(e.enabled,"initOptionsFloodgate.dynamicCampaignConfig.enabled"),t.enabled=e.enabled),void 0!==e.ecsClient&&(r.expectObject(e.ecsClient,"initOptionsFloodgate.dynamicCampaignConfig.ecsClient"),t.ecsClient=e.ecsClient),t}}let l=new c;function d(){return l},YMYX:"Z+rh":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7P0z"),i=function(){eturn e.make=function(t){try{return new e(t)}catch(e){return null}},e.prototype.getType=function(){return"Comment"},e.prototype.getQuestion=function(){return this.data.question},e.prototype.setSubmittedText=function(e){this.userComment=e},e.prototype.getSubmittedText=function(){return this.userComment},e.prototype.getDomElements=e.prototype.getJsonElements=function(){var e={};return e[r.JSON_COMMENT_KEYNAME]=this.getSubmittedText(),e},e.prototype.getComponentJson=function(){var e;return(e={})[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),e},e}();!function(e){var t=function(){return function(){}}();e.CommentComponentData=t}(i||(i={})),t.default=i},ZeN8:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return c}));const r="customervoice",i="Customer Voice Survey UX";var o;!function(e){e[e.Smile=0]="Smile",e[e.Frown=1]="Frown",e[e.Idea=2]="Idea",e[e.Bug=3]="Bug",e[e.IdeaRedirect=4]="IdeaRedirect"}(o||(o={}));class a{}a.WebSurfacesIntLink="https://res-sdf.cdn.office.net/office-growth/resources/programmablesurfaces/int/officewebsurfaces.core.min.js",a.WebSurfacesProdLink="https://res.cdn.office.net/office-growth/resources/programmablesurfaces/prod/officewebsurfaces.core.min.js";class s{}s.TMSAppID="4c4f550b-42b2-4a16-93f9-fdb9e01bb6ed",s.TULIPSAppID="05c88d91-956e-46b4-91b0-77a33cc21a4d";const u="Web SDK v",c="UxId:built-in|comp2022_v1"},ZqsM:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return i}));var i=((r={}).CampaignContent="obf-TmsCampaignContent",r.DynamicSettings="obf-TmsDynamicSettings",r.LogLevelSettings="obf-LogLevelSettings",r.MessageMetadata="obf-TmsMessageMetadata",r.UserFacts="obf-UserFacts",r.UserGovernance="obf-TmsUserGovernance",r)},Zx2D:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserFact=void 0;var r=n("DX5p"),i=n("iv/W"),o=n("FFSN"),a=o.isNOU,s=o.isNumber,u=o.isArray,c=[0,1,2,3,4,5],l=function(){function e(e){this.input=e}return e.deserialize=function(t){return this.validate(t)?new e(t):null},e.validate=function(e){if(!e)return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Input is null or undefined for user fact"),!1;if(!e.Value&&e.Values&&(e.Value=e.Values),a(e.Name)||a(e.Type)||a(e.Value))return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Either of the required parameters Name: "+e.Name+", Type: "+e.Type+" or Value: "+e.Value+" are not provided for the user fact"),!1;if(!this.validateUserFactType(e.Type))return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Invalid UserFactType value "+e.Type+" is provided for user fact"),!1;if(6===e.Type)return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Unsupported UserFactType value "+e.Type+" is provided for user fact"),!1;if(e.LatencyType&&!this.validateLatencyType(e.LatencyType))return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Invalid LatencyType value "+e.LatencyType+" is provided for user fact of type "+e.Type),!1;if(e.LatencyType&&0!==e.LatencyType&&a(e.LatencyDurationInSeconds))return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"LatencyDurationInSeconds value "+e.LatencyDurationInSeconds+" is not provided for user fact of type "+e.Type),!1;if(e.LatencyDurationInSeconds&&!s(e.LatencyDurationInSeconds))return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Invalid LatencyDurationInSeconds value "+e.LatencyDurationInSeconds+" is provided for user fact of type "+e.Type),!1;if(1===e.Type&&a(e.IntervalType))return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Required parameter intervalType is not provided for user fact of type "+e.Type),!1;var t=this.getComparatorTypes(e.Type);return!(e.Comparator&&!e.Comparator,t)&&(i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,"Unsupported comparator type for user fact of type "+e.Type),1))},e.getComparatorTypes=function(e){switch(e){case 0:return[0,1];case 4:return[0,1,6,7,8,9];case 5:return[6,7,8,9];case 1:case 2:case 3:case 6:return c;default:p()}return c},e.validateLatencyType=function(e){return 0===e||3===e||1===e||2===e||p()},e.validateUserFactType=function(e){return 0===e||2===e||3===e||4===e||1===e||5===e||6===e||p()},e.prototype.isAMatch=function(e){if(!e||!e.userFactValue)return!1;if(!this.isLatencyAcceptable(e))return!1;try{var t=this.getType();return 0===t?function(e,t,n){return d(!!e,!!JSON.parse(t.userFactValue.toLowerCase()),n)}(this.getValue(),e,this.getComparator()):2===t?function(e,t,n){var r=Date.parse(t.userFactValue);if(!v(r,t.userFactValue,t.userFactName))return!1;var i=Date.parse(e);return!!v(i,e,null,2)&&d(i,r,n)}(this.getValue(),e,this.getComparator()):3===t?function(e,t,n){var r=parseInt(t.userFactValue,10);return!!v(r,t.userFactValue,t.userFactName)&&d(e,r,n)}(this.getValue(),e,this.getComparator()):4===t?function(e,t,n){return d(e.toLowerCase(),t.userFactValue.toLowerCase(),n)}(this.getValue(),e,this.getComparator()):1===t?function(e,t,n,o){var a=Date.parse(t.userFactValue);if(!v(a,t.userFactValue,t.userFactName))return!1;var s=Date.now(),u=0===o?s-a:a-s;return u<0?(i.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Mismatch,{ErrorMessage:"Interval type not acceptable - { Spec: "+e+', Name: "'+t.userFactName+'" }',TimeMilliseconds:u,Type:""+o}),!1):d(864e5*e,u,n)}(this.getValue(),e,this.getComparator(),this.getIntervalType()):5===t?this.getValue(),e,this.getComparator()):(i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,"Unsupported type of user fact was provided "+t),!1)}catch(e){return i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,e),!1}},e.prototype.getType=function(){return this.input.Type},e.prototype.getName=function(){return this.input.Name},e.prototype.getValue=function(){return this.input.Value},e.prototype.getComparator=function(){return this.input.Comparator||0},e.prototype.getLatencyType=e.prototype.getLatencyDurationInSeconds=function(){return this.input.LatencyDurationInSeconds},e.prototype.getIntervalType=function(){return this.input.IntervalType},e.prototype.isLatencyAcceptable=function(e){var t=this.getType();return!(!a(this.getLatencyDurationInSeconds())&&!function(e,t,n){var r;switch(e){case 0:break;case 1:r=n.sourceDateTime;break;case 2:r=n.storageDateTime;break;case 3:r=n.clientIngestionDateTime;break;default:p()}if(!a(r)){var i=Date.parse(r);return Date.now()-i<=1e3*t}return!0}(this.getLatencyType(),this.getLatencyDurationInSeconds(),e)&&(i.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Mismatch,{ErrorMessage:'Latency duration not acceptable - { Name: "'+e.userFactName+'" }',TimeMilliseconds:this.getLatencyDurationInSeconds(),Type:""+t}),1))},e}();function d(e,t,n){switch(n){case 0:return t===e;case 1:return t!==e;case 2:return t>e;case 3:return t>=e;case 4:return t<e;case 5:return t<=e;case 6:return g(e,t);case 7:return!g(e,t);case 8:return g(t,e);case 9:return!g(t,e);default:p()}}unction g(e,t){if("string"==typeof t){var n=t.toLowerCase();if("string"==typeof e)return-1!==e.toLowerCase().indexOf(n);if(u(e))return e.some((function(e){return e&&e.toString().toLowerCase()===n}))}return!!u(e)&&-1!==e.indexOf(t)}function v(e,t,n,o){if(!s(e)){var a="User fact "+n+" has invalid value "+t;return o&&(a="Invalid value "+t+" was provided for user fact of type "+o),i.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,a),!1}return!0}t.UserFact=l},apcD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=t.Api=void 0;var r=n("7P0z");Object.defineProperty(t,"Api",{enumerable:!0,get:function(){return r.Api}});var i=n("FFSN");t.Utils=i;var o=n("iv/W");Object.defineProperty(t,"FloodgateEngine",{enumerable:!0,get:function(){return o.FloodgateEngine}})},b1Ez:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedTracker=void 0;var r=function(){return function(){}}();t.IndexedTracker=r},crny:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},dGOb:dTWj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CountedActivitySequenceEventData=t.CountedActivitySequenceEvent=t.CountedActivityEventData=t.CountedActivityEvent=void 0;var r=n("mwxp"),i=n("58V+"),o=function(){eturn e.make=function(t){try{return new e(t)}catch(e){return null}},e.prototype.getActivity=function(){return this.data.activity},e.prototype.getCount=function(){return this.data.count},e.prototype.isAggregate=function(){return this.data.isAggregate},e.prototype.getType=function(){return"CountedActivity"},e.prototype.getTrackingSet=e}();t.CountedActivityEvent=o;var a=function(){return function(){}}();t.CountedActivityEventData=a;var s=function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.sequence)throw new Error("data.sequence must not be null");if(0===e.sequence.length)throw new Error("data.sequence size must be greater than 0");this.data=[];for(var t=0,n=e.sequence;t<n.length;t++)this.data.push(new o(n[t]))}return e.make=function(t){try{return new e(t)}catch(e){return null}},e.prototype.getSequence=function(){return this.data},e.prototype.getType=function(){return"CountedActivitySequence"},e.prototype.getTrackingSet=e}();t.CountedActivitySequenceEvent=s;var u=);t.CountedActivitySequenceEventData=u},dz40:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n("7P0z"),o=n("FFSN"),a=n("8+ih"),s=n("Dwqi"),u=o.isNOU,c=function(e){function t(t){var n=e.call(this)||this;if(!t)throw new Error("data must not be null");if(n.surveyInfo=new s.default(t.baseData),u(n.surveyInfo.getMetadata()))throw new Error("metadata must not be null");return n}return r(t,e),t.make=function(e){try{return new t(e)}catch(e){return null}},t.makeCustom=function(e){if(u(e))return null;var n=new t.GenericMessagingSurfaceSurveyData;return n.baseData=e,this.make(n)},t.prototype.getType=function(){return i.SurveyType.GenericMessagingSurface},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getTags=function(){return this.surveyInfo.getTags()},t.prototype.getComponent=t.prototype.getDomElements=function(e){return[]},t.prototype.getJsonElements=function(){return{}},t}(a.Survey);!function(e){var t=function(){return function(){}}();e.GenericMessagingSurfaceSurveyData=t}(c||(c={})),t.default=c},fFOh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FloodgateStorageProviderFileType=void 0,t.FloodgateStorageProviderFileType||(t.FloodgateStorageProviderFileType={}))},hxRT:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("kZ16");class i{log_TriggerMet(e,t,n,i,o){r.b().logEvent(r.a.SURVEY_FLOODGATE_TRIGGERMET,1,{CampaignId:e,SurveyId:t,SurveyType:n,SurveyActivityInfo:i,AdditionalSurveyInfo:o})}log_UserSelected(e,t,n,i){r.b().logEvent(r.a.SURVEY_FLOODGATE_USERSELECTED,1,{CampaignId:e,SurveyId:t,SurveyType:n,AdditionalSurveyInfo:i})}log_CampaignLoad_Failed(e){r.b().logEvent(r.a.SURVEY_FLOODGATE_CAMPAIGNLOAD_FAILED,2,{ErrorMessage:e})}log_Error(e,t){const n={name:e};r.b().logEvent(n,2,{ErrorMessage:t})}log_Event(e,t,n){const i={name:e};r.b().logEvent(i,1,t,n)}log_LocalError(e,...t){this.log_Local(2,e,t)}log_Local(e,t,...n){r.b().logLocal(e,n)}}},iW5C:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7P0z"),i=function(){eturn e.make=function(t){try{return new e(t)}catch(e){return null}},e.prototype.getType=function(){return"Rating"},e.prototype.getQuestion=function(){return this.data.question},e.prototype.getRatingValuesAscending=function(){return this.data.ratingValuesAscending},e.prototype.getSelectedRating=e.prototype.setSelectedRatingIndex=function(e){this.selectedIndex=this.isRatingIndexValid(e)?e:-1},e.prototype.getSelectedRatingIndex=function(){return this.selectedIndex},e.prototype.getDomElements=e.prototype.getJsonElements=function(){var e={};return e[r.JSON_RATING_KEYNAME]=this.isRatingIndexValid(this.getSelectedRatingIndex())?this.getNormalizedRatingScore():"Not rated",e},e.prototype.getComponentJson=function(){var e;return(e={})[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),e[r.JSON_RATINGOPTIONS_KEYNAME]=this.getRatingValuesAscending(),e},e.prototype.getNormalizedRatingScore=e.prototype.isRatingIndexValid=e}();!function(e){var t=function(){return function(){}}();e.RatingComponentData=t}(i||(i={})),t.default=i},iopB:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7P0z"),i=function(){eturn e.make=function(t){try{return new e(t)}catch(e){return null}},e.prototype.getType=function(){return"MultipleChoice"},e.prototype.getQuestion=function(){return this.data.question},e.prototype.getAvailableOptions=function(){return this.data.availableOptions},e.prototype.getOptionSelectedStates=function(){return this.optionStates},e.prototype.getMinNumberofSelectedOptions=function(){return this.data.minNumberOfSelectedOptions},e.prototype.getMaxNumberofSelectedOptions=function(){return this.data.maxNumberOfSelectedOptions},e.prototype.setOptionSelectedStates=e.prototype.ValidateMinNumberofSelectedOptions=e.prototype.ValidateMaxNumberofSelectedOptions=e.prototype.getDomElements=e.prototype.getJsonElements=e.prototype.getComponentJson=function(){var e;return(e={})[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),e[r.JSON_RATINGOPTIONS_KEYNAME]=this.getAvailableOptions(),e},e}();!function(e){var t=function(){return function(){}}();e.MultipleChoiceComponentData=t}(i||(i={})),t.default=i},"iv/W":function(e,t,n){"use strict";var r=this&&this.__awaiter||i=this&&this.__generator||Object.defineProperty(t,"__esModule",{value:!0}),t.FloodgateEngine=void 0;var o=n("7P0z"),a=n("UZw0"),s=n("jay/"),u=n("EnYi"),c=n("BlAL"),l=n("DX5p"),d=n("KmlV"),p=n("HAGu"),g=n("yOOe"),v=n("UUdt"),f=n("jtaB"),h=n("nIJ3"),m=n("J+Cg"),y=n("FFSN"),S=function(){function e(){}return e.prototype.log_TriggerMet=e.prototype.log_UserSelected=e.prototype.log_CampaignLoad_Failed=function(e){},e.prototype.log_Error=function(e,t){},e.prototype.log_Event=function(e,t){},e.prototype.log_LocalError=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},e}(),C={run:function(e){},shouldAcceptActivity:,E={},T=function(){function e(t,n,r,i,o,a,s,u,c){if(this.initializationStatus=0,this.candidateSurveys={},this.launchedSurveys={},this.launchedLaunchers=[],this.surveyEventSent=[],this.staleTriggeredSurveysQueue=[],!t)throw new Error("surveyClient must not be null");if(!n)throw new Error("activityListener must not be null");if(!r)throw new Error("launcherFactory must not be null");if(!i)throw new Error("onSurveyActivatedCallback must not be null");if(!o)throw new Error("storage must not be null");if(!a)throw new Error("governor must not be null");if(!u)throw new Error("transporterFactory must not be null");this.surveyClient=t,this.activityListener=n,this.launcherFactory=r,this.onSurveyActivatedCallback=i,this.storage=o,this.governor=a,this.surveyActivationStatsProvider=s,this.governanceServiceClient=c,e.transporterFactory=u,this.loggedFirstStart=!1,this.setPendingSurveys(null),this.activityListener.clearSurveys();var l=this;this.activityListener.setCallback({run:function(e,t){l.onSurveyActivated(e,t)},shouldAcceptActivity:function(e){return l.shouldAcceptActivity(e)}})}return e.setTelemetryLogger=e.getTelemetryLogger=function(){return e.telemetryLogger},e.getTransportFactory=function(){return e.transporterFactory},e.make=function(t,n,r,i,o,a,d,p,m,y,S,E,T,b){try{var A=g.GovernedChannelStateProviderFactory.make(i,o),F=h.SurveyActivationStatsProviderFactory.make(i,o),I=c.CampaignStateProviderFactory.make(i,o);m.unshift(new s.FileSystemCampaignDefinitionProvider(i));var _=new v.Governor(A,T),O={isSurveyTrackable:function(e){return _.isSurveyTrackable(e)}};return new e(b||new u.CampaignManager(I,m,a,d,t,new Date,E,y,O),new f.default(C,this.getTelemetryLogger),n,r,i,_,F,p,S)}catch(e){this.telemetryLogger.log_Event(l.TelemetryEvent.FloodgateEngine.Make.Failed,{ErrorMessage:e&&e.toString(),ErrorDetails:e&&e.stack})}},e.prototype.getSurveyClient=function(){return this.surveyClient},e.prototype.mergeAndSave=e.prototype.start=function(){if(2!==this.initializationStatus&&3!==this.initializationStatus)try{this.setInitializationStatus(2),this.loadSettingsAndPriorEventCounts();var t=this.getAvailableChannelTypes();this.surveyClient.refreshSurveyDefinitions(t),this.setPendingSurveysAndStartFloodgate(),this.setInitializationStatus(3)}catch(t){this.setInitializationStatus(1),e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.Start.Failed,{ErrorMessage:t&&t.toString(),ErrorDetails:t&&t.stack})}},e.prototype.startAsync=function(){if(2===this.initializationStatus||3===this.initializationStatus)return Promise.resolve();try{this.setInitializationStatus(2),this.loadSettingsAndPriorEventCounts();var t=this.getAvailableChannelTypes(),n=this;return new Promise((function(r,i){n.surveyClient.refreshSurveyDefinitionsAsync(t).then(().catch((function(t){n.setInitializationStatus(1),e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.StartAsync.Failed,{ErrorMessage:"Survey refresh error "+(t&&t.message)}),i(t)}))}))}catch(t){return this.setInitializationStatus(1),e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.StartAsync.Failed,{ErrorMessage:t&&t.toString(),ErrorDetails:t&&t.stack}),Promise.resolve()}},e.prototype.stop=e.prototype.getActivityListener=function(){return this.activityListener},e.prototype.setInitializationStatus=function(e){this.initializationStatus=e},e.prototype.saveSettings=e.prototype.loadSettingsAndPriorEventCounts=function(){try{this.previousSurveyActivationStats=this.surveyActivationStatsProvider.load(),this.previousSurveyEventActivityStats=m.SurveyStatCollectionEventActivity.fromJson(this.readString(o.FloodgateStorageProviderFileType.SurveyEventActivityStats));var t=this.previousSurveyEventActivityStats.getStats();for(var n in t)t.hasOwnProperty(n)&&this.surveyEventSent.push(n);this.floodgateSettings=d.FloodgateSettings.fromJson(this.readString(o.FloodgateStorageProviderFileType.FloodgateSettings))}catch(t){e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.Common.Error,{ErrorMessage:"Error loading prior settings/events "+(t&&t.toString())})}},e.prototype.getAvailableChannelTypes=e.prototype.setPendingSurveysAndStartFloodgate=function(){this.setPendingSurveys(this.surveyClient.getAppSurveys()),this.updateActivityListenerWithCurrentSurveyDefinitions(),this.setInitializationStatus(3),this.loggedFirstStart||(this.loggedFirstStart=!0,this.getActivityListener().logActivity(f.default.FloodgateStartActivityName))},e.prototype.updateSurveyActivationStats=function(e){var t=e.getSurveyInfo(),n=t.getId(),r=this.previousSurveyActivationStats.getStats()[n]||new h.SurveyActivationStats;r.Type=e.getType(),r.ExpirationTimeUtc=t.getExpirationTimeUtc(),r.ActivationTimeUtc=new Date,r.SurveyLaunchCount++,this.previousSurveyActivationStats.addStats(n,r),E.hasOwnProperty(n)||(E[n]=0),E[n]++},e.prototype.saveSurveyActivationHistory=function(){this.storage.fileLock(o.FloodgateStorageProviderFileType.SurveyActivationStats);try{var e=this.surveyActivationStatsProvider.load(),t=this.previousSurveyActivationStats.getStats(),n=new h.SurveyStatCollectionActivation;for(var r in this.launchedSurveys)if(this.launchedSurveys.hasOwnProperty(r)){var i=this.launchedSurveys[r].getSurveyInfo().getId();n.addStats(i,t[i])}e.accumulate(n),this.surveyActivationStatsProvider.save(e),this.previousSurveyActivationStats=e}finally{this.storage.fileUnlock(o.FloodgateStorageProviderFileType.SurveyActivationStats)}},e.prototype.saveSurveyEventActivityHistory=function(){this.storage.fileLock(o.FloodgateStorageProviderFileType.SurveyEventActivityStats);try{var e=m.SurveyStatCollectionEventActivity.fromJson(this.readString(o.FloodgateStorageProviderFileType.SurveyEventActivityStats)),t=new Date,n=new m.SurveyStatCollectionEventActivity,r=function(e){if(i.candidateSurveys.hasOwnProperty(e)){var r=new m.SurveyEventActivityStats,o=i.candidateSurveys[e];if(!o.getSurveyInfo().isActiveForDate(t))return"continue";r.ExpirationTimeUtc=o.getSurveyInfo().getExpirationTimeUtc();var a=o.getSurveyInfo().getActivationEvent().getTrackingSet(),s=[],u=[];a.getList().forEach((function(e){e&&(e.getIsAggregate()?s.push(e.getActivity()):u.push(e.getActivity()))})),r.Counts=new Array(s.length);for(var c=0;c<s.length;c++)r.Counts[c]=i.activityListener.moveSessionCountIntoBaseCount(s[c],o.getSurveyInfo().getId());for(var l=0,d=u;l<d.length;l++)i.activityListener.saveSessionTrackingActivity(d[l]);n.addStats(o.getSurveyInfo().getId(),r)}},i=this;for(var a in this.candidateSurveys)r(a);e.accumulate(n),this.writeString(o.FloodgateStorageProviderFileType.SurveyEventActivityStats,m.SurveyStatCollectionEventActivity.toJson(e)),this.previousSurveyEventActivityStats=e}finally{this.storage.fileUnlock(o.FloodgateStorageProviderFileType.SurveyEventActivityStats)}},e.prototype.setPendingSurveys=function(e){if(this.candidateSurveys={},e)for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];this.launcherFactory.AcceptsSurvey(n)&&(this.candidateSurveys[t]=n)}},e.prototype.getCurrentSurveyDefinitions=function(){var t=this,n=new Array,r=this.getAllCampaignDefinitionIDs(),i=this.getAllCandidateCampaignDefinitionIDs(),o=this.surveyClient.getCampaignDefinitions(),a=function(e){if(p.isBusinessCriticalSurvey(e))return!0;var n=t.previousSurveyActivationStats.getBySurveyId(e.getId());return!(!p.isMultiLaunchSurvey(e)||p.hasSurveyReachedMaxLaunches(e,n)||p.hasSurveyReachedMaxLaunchesPerSession(e,E))||!(n||!e.isActiveForDate(new Date))};for(var s in this.candidateSurveys)if(this.candidateSurveys.hasOwnProperty(s)){var u=this.candidateSurveys[s],c=u.getSurveyInfo();if(!o[null==c?void 0:c.getBackEndId()]||!a(c))continue;if(this.surveyEventSent.indexOf(s)<0){this.surveyEventSent.push(s);var l=this.getAdditionalSurveyInfoForTelemetry(u,null,r,i);e.telemetryLogger.log_UserSelected(c.getBackEndId(),c.getId(),u.getType(),JSON.stringify(l))}n.push(u)}return n},e.prototype.getAdditionalSurveyInfoForTelemetry=function(e,t,n,r){var i,o,a,s,u=this.surveyClient.getCampaignDefinitions()[e.getCampaignId()];i=u.nominationScheme.percentageNumerator,o=u.nominationScheme.percentageDenominator,a=u.nominationScheme.nominationPeriod.asTimeIntervalSeconds(),a=y.isNOU(a)?-1:a,s=u.nominationScheme.cooldownPeriod.asTimeIntervalSeconds(),s=y.isNOU(s)?-1:s;var c=e.getSurveyInfo();return{allCampaignDefinitionIDs:n,allCandidateCampaignDefinitionIDs:r,channelType:c.getGovernedChannelType(),contextCount:t?t.length:void 0,cooldownPeriodNumber:s,nominationPeriodNumber:a,percentageDenominator:o,percentageNumerator:i,surveyLauncherType:e.getLauncherType(),businessLevel:c.getBusinessLevel(),maxLaunches:c.getMaxLaunches(),maxLaunchesPerSession:c.getMaxLaunchesPerSession()}},e.prototype.getAllCandidateCampaignDefinitionIDs=function(){var e=[];for(var t in this.candidateSurveys)this.candidateSurveys.hasOwnProperty(t)&&e.push(this.candidateSurveys[t].getSurveyInfo().getBackEndId());return e},e.prototype.getAllCampaignDefinitionIDs=function(){var e=this.surveyClient.getCampaignDefinitions(),t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(e[n].campaignId);return t},e.prototype.updateActivityListenerWithCurrentSurveyDefinitions=function(){for(var e=[],t=0,n=this.getCurrentSurveyDefinitions();t<n.length;t++){var r=n[t].getSurveyInfo(),i=new a.ActivityTrackingContract(r.getId(),r.getActivationEvent().getTrackingSet());e.push(i)}this.activityListener.SetActivityTrackingContracts(e,this.previousSurveyEventActivityStats)},e.prototype.setCriticalPendingSurveysAndUpdateActivityListener=function(){var e={};for(var t in this.candidateSurveys)if(this.candidateSurveys.hasOwnProperty(t)){var n=this.candidateSurveys[t];p.isCriticalSurvey(n.getSurveyInfo())&&(e[t]=n)}Object.keys(e).length>0&&(this.setPendingSurveys(e),this.updateActivityListenerWithCurrentSurveyDefinitions())},e.prototype.shouldAcceptActivity=function(e){return 3===this.initializationStatus||e===f.default.FloodgateStartActivityName},e.prototype.onSurveyActivated=function(t,n){for(var r,i=0,o=this.getCurrentSurveyDefinitions();i<o.length;i++){var a=o[i];if(a.getSurveyInfo().getId()===t){r=a;break}}if(y.isNOU(r))e.getTelemetryLogger().log_Error(l.TelemetryEvent.FloodgateEngine.OnSurveyActivated.SurveyNotDefined,"Survey is not defined in the current survey definitions.");else try{var s=r.getSurveyInfo().getGovernedChannelType();this.governanceServiceClient.isEnabled(s)?(this.staleTriggeredSurveysQueue.push(r),1===this.staleTriggeredSurveysQueue.length&&this.checkGovernanceServiceAndActivateSurvey(r,s,n)):this.activateSurvey(r,s,n)}catch(t){e.telemetryLogger.log_Event(l.TelemetryEvent.FloodgateEngine.OnSurveyActivated.Error,{ErrorMessage:"Error activating survey "+(t&&t.toString()),ErrorDetails:t&&t.stack})}},e.prototype.activateSurvey=function(t,n,r){var i=!1;if(this.candidateSurveys[t.getSurveyInfo().getId()])if(t.getSurveyInfo().isActiveForDate(new Date)){if(this.governor.refreshChannelData(),p.isCriticalSurvey(t.getSurveyInfo()))i=!0;else if(this.governor.isChannelOpen(n))if(this.surveyActivationStatsProvider.load().getBySurveyId(t.getSurveyInfo().getId()))e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationStatsSuppressedSurvey,{CampaignId:t.getSurveyInfo().getBackEndId(),SurveyId:t.getSurveyInfo().getId()});else if(0===Object.keys(this.launchedSurveys).length)i=!0;else{var a=Object.values(this.launchedSurveys)[0];y.isNOU(a)||e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.OnSurveyActivated.SessionSuppressedSurvey,{CampaignId:a.getSurveyInfo().getBackEndId(),SurveyId:a.getSurveyInfo().getId()})}else e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ClosedChannelType,{ClosedChannelType:o.GovernedChannelType[n]});i&&(this.launchedSurveys[t.getSurveyInfo().getId()]=t)}else e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationExpiredSurvey,{CampaignId:t.getSurveyInfo().getBackEndId(),SurveyId:t.getSurveyInfo().getId()});else e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationIrrelevantSurvey,{CampaignId:t.getSurveyInfo().getBackEndId(),SurveyId:t.getSurveyInfo().getId()});if(this.updateSurveyActivationStats(t),this.mergeAndSave(),this.activityListener.clearSurveys(),this.staleTriggeredSurveysQueue=[],i){var s=t.getSurveyInfo().getActivationEvent().getTrackingSet().getActivityTrackingInfo(this.activityListener,t.getSurveyInfo().getId()),u=this.getAdditionalSurveyInfoForTelemetry(t,r,this.getAllCampaignDefinitionIDs(),this.getAllCandidateCampaignDefinitionIDs());u.governanceServiceClientState=this.governanceServiceClient.getClientState(),e.telemetryLogger.log_TriggerMet(t.getSurveyInfo().getBackEndId(),t.getSurveyInfo().getId(),t.getType(),s,JSON.stringify(u)),this.governor.startChannelCooldown(n);var c=t.getSurveyInfo(),d=!0;if(p.isBusinessCriticalSurvey(c))d=!1;else if(p.isMultiLaunchSurvey(c)){var g=this.previousSurveyActivationStats.getBySurveyId(c.getId());d=p.hasSurveyReachedMaxLaunches(c,g)}this.surveyClient.onSurveyActivated(c,d),this.launchLauncher(t,r),this.setCriticalPendingSurveysAndUpdateActivityListener()}},e.prototype.checkGovernanceServiceAndActivateSurvey=function(t,n,o){return r(this,void 0,void 0,(function(){var r,a,s,u,c,d;return i(this,(function(i){switch(i.label){case 0:return r=this.surveyClient.getCampaignDefinitions()[t.getCampaignId()],a=r.nominationScheme.cooldownPeriod.asTimeIntervalSeconds(),s=v.Governor.GetChannelCoolDown(n),[4,this.governanceServiceClient.checkGovernancePermitAsync(t,a,s,n)];case 1:return u=i.sent(),c=!1,d=JSON.stringify(this.createGorvernanceResponseTelemetry(u,t.getCampaignId())),e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.CheckGovernanceServiceAndActivateSurvey.GovernanceServiceClientCompleted,{Message:d}),3!==this.initializationStatus?[2]:(u.error?this.governanceServiceClient.shouldForceDisplay()&&(c=!0,e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.CheckGovernanceServiceAndActivateSurvey.GovernanceServiceForceToDisplay,{ErrorMessage:u.errorMessage})):u.permission?c=!0:(u.lastTriggerSurvey.timeUntilNextSurveyAllowed>0&&(this.governor.startChannelCooldown(n,u.lastTriggerSurvey.lastTriggerSurveyTime),this.clearSurveyWithChannel(n)),this.governanceServiceClient.isSurveyLevelGovernanceEnabled()&&u.isSurveyGoverned&&u.lastTriggerSurvey.timeUntilSameSurveyAllowed>0&&(e.getTelemetryLogger().log_Event(l.TelemetryEvent.FloodgateEngine.CheckGovernanceServiceAndActivateSurvey.GovernanceServiceSurveyInCooldown,{Message:d}),this.putSurveyOnCooldown(t,u))),c?(this.activateSurvey(t,n,o),[2]):this.staleTriggeredSurveysQueue.length<=1?(this.staleTriggeredSurveysQueue=[],[2]):(this.staleTriggeredSurveysQueue.shift(),this.checkGovernanceServiceAndActivateSurvey(this.staleTriggeredSurveysQueue[0],n,o),[2]))}}))}))},e.prototype.readString=e.prototype.writeString=e.prototype.launchLauncher=function(e,t){var n=this.launcherFactory.makeSurveyLauncher(e);n&&(this.launchedLaunchers.push(n),this.onSurveyActivatedCallback.onSurveyActivated(n,e,{contextInfo:t}))},e.prototype.clearSurveyWithChannel=function(e){var t={};for(var n in this.candidateSurveys)if(this.candidateSurveys.hasOwnProperty(n)){var r=this.candidateSurveys[n];r.getSurveyInfo().getGovernedChannelType()!==e&&(t[n]=r)}this.candidateSurveys=t,this.activityListener.UpdateActivityTrackingContracts(this.candidateSurveys)},e.prototype.createGorvernanceResponseTelemetry=function(e,t){return{CampaignId:t,FloodgateEngineStatus:this.initializationStatus.toString(),GovernanceServiceResult:e,StaleTriggeredSurveysQueueCount:this.staleTriggeredSurveysQueue.length-1}},e.prototype.putSurveyOnCooldown=function(e,t){this.surveyClient.modifyCampaignSurveyTakenDate(e.getCampaignId(),t.lastTriggerSurvey.lastTriggerSameSurveyTime,!0)},e.telemetryLogger=new S,e}();t.FloodgateEngine=T},jUN1:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n("7P0z"),o=n("Go5c"),a=n("FFSN"),s=n("8+ih"),u=n("Dwqi"),c=a.isNOU,l=function(e){function t(t){var n=e.call(this)||this;if(c(t))throw new Error("data must not be null");return n.surveyInfo=new u.default(t.baseData),n.intercept=new o.default(t.interceptData),n}return r(t,e),t.make=function(e){try{return new t(e)}catch(e){return null}},t.makeIntercept=function(e,n,r){if(c(e)||c(n)||c(r))return null;var i=r.content;if(c(i)||c(i.intercept))return null;var a=new t.InterceptSurveyData;return a.baseData=e,a.interceptData=new o.default.InterceptComponentData,a.interceptData.title=n.getCustomString(i.intercept.title),a.interceptData.question=n.getCustomString(i.intercept.question),a.interceptData.url=n.getCustomString(i.intercept.url),c(a.interceptData.title)||c(a.interceptData.question)||c(a.interceptData.url)?null:this.make(a)},t.prototype.getType=function(){return i.SurveyType.Intercept},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getInterceptComponent=function(){return this.intercept},t.prototype.getTags=function(){return this.surveyInfo.getTags()},t.prototype.getComponent=function(e){return"Intercept"===e?this.getInterceptComponent():null},t.prototype.getDomElements=t.prototype.getJsonElements=t}(s.Survey);!function(e){var t=function(){return function(){}}();e.InterceptSurveyData=t}(l||(l={})),t.default=l},"jay/":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicCampaignDefinitionProvider=t.FileSystemCampaignDefinitionProvider=t.FilterValidCampaignDefinitions=t.CampaignDefinition=t.CampaignSurveyTemplateIntercept=t.CampaignSurveyTemplateGenericMessagingSurface=t.CampaignSurveyTemplateNps11PointStatic=t.CampaignSurveyTemplateNps5PointStatic=t.CampaignSurveyTemplateNps=t.CampaignSurveyTemplateNlqs=t.CampaignSurveyTemplateFps=t.CampaignSurveyTemplate=t.CampaignSurveyMetadata=t.CampaignSurveyContentComment=t.CampaignSurveyContentRating=t.CampaignSurveyContentIntercept=t.CampaignSurveyContentPrompt=t.CampaignSurveyContentCVSurvey=t.CampaignSurveyContentMultipleChoice=t.CampaignSurveyContent=t.CampaignSurveyEventCountedActivitySequence=t.CampaignSurveyEventCountedActivity=t.CampaignSurveyEvent=t.CampaignNominationSchemeRatioPercentage=t.CampaignNominationScheme=t.CampaignDistributionRamp=t.CampaignDistribution=t.CampaignAdditionalDataRequested=t.CampaignDurationSingleBuildChange=t.CampaignDurationTimeInterval=t.CampaignDuration=t.CampaignScopeUserFactAll=t.CampaignScopeUserFactAny=t.CampaignScopeEnvironmentCrossProduct=t.CampaignScopeAny=t.CampaignScope=t.CampaignLanguageRangeLanguageSubtag=t.CampaignLanguageRange=void 0;var i=n("7P0z"),o=n("DX5p"),a=n("iv/W"),s=n("0Bs5"),u=n("FFSN"),c=u.getDistantFuture,l=u.isBoolean,d=u.isNOU,p=u.isNumber,g=u.isString,v=u.isUtcDatetimeString,f=u.stringToDate,h=function(){function e(){}return e.deserialize=function(e){var t;return e&&0===e.Type&&(t=m.deserialize(e)),void 0===t?null:t},e.prototype.validate=function(){return!0},e}();t.CampaignLanguageRange=h;var m=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return e&&(n.languageSubTag=e.Value),n.validate()?n:null},t.prototype.isInRange=function(e){if(d(e))return!1;var t=u.extractLanguageSubtag(e);return!d(t)&&t.toLocaleUpperCase()===this.languageSubTag.toLocaleUpperCase()},t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||d(this.languageSubTag)||!g(this.languageSubTag)||!u.isValidLanguageSubTag(this.languageSubTag))},t}(h);t.CampaignLanguageRangeLanguageSubtag=m;var y=function(){function e(){}return e.deserialize=function(e){var t;if(d(e))return null;switch(e.Type){case 0:t=S.deserialize(e);break;case 1:t=C.deserialize(e);break;case 2:t=E.deserialize(e);break;case 3:t=T.deserialize(e)}return void 0===t?null:t},e.prototype.validate=function(){return!0},e}();t.CampaignScope=y;var S=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){return new t},t.prototype.isInScope=function(){return!0},t.prototype.validate=t}(y);t.CampaignScopeAny=S;var C=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t,r=[];if(d(e))return null;for(var i in e.Languages)if(e.Languages.hasOwnProperty(i)){var o=e.Languages[i];o&&r.push(h.deserialize(o))}return 0===r.length&&(r=null),n.languageRanges=r,n.validate()?n:null},t.prototype.setEnvironmentProvider=function(e){this.environmentProvider=e},t.prototype.isInScope=function(){if(d(this.languageRanges))return!0;if(d(this.environmentProvider)||!this.environmentProvider.getLanguage())return!1;var e=this.environmentProvider.getLanguage();for(var t in this.languageRanges)if(this.languageRanges.hasOwnProperty(t)&&this.languageRanges[t].isInRange(e))return!0;return!1},t.prototype.validate=function(){if(!e.prototype.validate.call(this))return!1;if(this.languageRanges)for(var t in this.languageRanges)if(this.languageRanges.hasOwnProperty(t)&&!this.languageRanges[t])return!1;return!0},t}(y);t.CampaignScopeEnvironmentCrossProduct=C;var E=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return n.userFacts=s.deserializeUserFacts(e),n.validate()?n:null},t.prototype.setUserFactsProvider=function(e){this.userFactsProvider=e},t.prototype.isInScope=function(){var e=this;return!!d(this.userFacts)||!!this.userFactsProvider&&this.userFacts.some(()},t.prototype.validate=function(){return!!e.prototype.validate.call(this)&&s.validateUserFacts(this.userFacts)},t}(y);t.CampaignScopeUserFactAny=E;var T=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return n.userFacts=s.deserializeUserFacts(e),n.validate()?n:null},t.prototype.setUserFactsProvider=function(e){this.userFactsProvider=e},t.prototype.isInScope=function(){var e=this;if(d(this.userFacts))return!0;if(!this.userFactsProvider)return!1;var t=this.userFacts.filter((function(t){var n=e.userFactsProvider.getUserFact(t.getName());return!t.isAMatch(n)}));if(t.length>0){var n=t.map(();return a.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Summary,{Count:t.length,Message:n.toString()}),!1}return!0},t.prototype.validate=function(){return!!e.prototype.validate.call(this)&&s.validateUserFacts(this.userFacts)},t}(y);t.CampaignScopeUserFactAll=T;var b=function(){function e(){}return e.deserialize=function(e){var t;if(d(e))return null;switch(e.Type){case 0:t=A.deserialize(e);break;case 1:t=F.deserialize(e)}return void 0===t?null:t},e.prototype.validate=function(){return!0},e}();t.CampaignDuration=b;var A=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=t.prototype.asTimeIntervalSeconds=function(){return this.intervalSeconds},t.prototype.validate=function(){return!!e.prototype.validate.call(this)&&!!p(this.intervalSeconds)},t}(b);t.CampaignDurationTimeInterval=A;var F=b);t.CampaignDurationSingleBuildChange=F;var I=function(){function e(){}return e.deserialize=function(t){var n=new e;if(!d(t)){n.additionalData=[];for(var r=0,i=t;r<i.length;r++)"EmailAddress"===i[r]&&n.additionalData.push(0)}return n.validate()?n:null},e.prototype.validate=e}();t.CampaignAdditionalDataRequested=I;var _=);t.CampaignDistribution=_;var O=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||!p(this.maxDelaySeconds)||this.maxDelaySeconds<0||!p(this.chunks)||this.chunks<0)},t}(_);t.CampaignDistributionRamp=O;var w=function(){function e(){}return e.deserialize=e.prototype.getActiveSurveyTimeIntervalSeconds=function(){var e=this.nominationPeriod.asTimeIntervalSeconds();return p(e)?e:this.fallbackSurveyDurationSeconds},e.prototype.calculateSurveyStartTimeFromDate=e.prototype.calculateSurveyExpirationTimeFromSurveyStartTime=function(e){return e=e||new Date,u.addSecondsWithoutOverflow(e,this.getActiveSurveyTimeIntervalSeconds())},e.prototype.getCampaignCooldown=e.prototype.validate=function(){return!(d(this.nominationPeriod)||(d(this.cooldownPeriod)&&(this.cooldownPeriod=this.nominationPeriod),!p(this.nominationPeriod.asTimeIntervalSeconds())&&(!p(this.fallbackSurveyDurationSeconds)||this.fallbackSurveyDurationSeconds<=0)))},e}();t.CampaignNominationScheme=w;var D=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return d(e)?null:(e.DistributionModel&&(n.distributionModel=_.deserialize(e.DistributionModel)),e.CooldownPeriod&&(n.cooldownPeriod=b.deserialize(e.CooldownPeriod)),e.NominationPeriod&&(n.nominationPeriod=b.deserialize(e.NominationPeriod)),n.fallbackSurveyDurationSeconds=e.FallbackSurveyDurationSeconds,n.percentageDenominator=e.PercentageDenominator,n.percentageNumerator=e.PercentageNumerator,n.validate()?n:null)},t.prototype.evaluateNominationRules=t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||!p(this.percentageDenominator)||!p(this.percentageNumerator)||this.percentageDenominator<=0||this.percentageNumerator<0||this.percentageNumerator>this.percentageDenominator)},t}(w);t.CampaignNominationSchemeRatioPercentage=D;var P=function(){function e(){}return e.deserialize=function(e){var t;if(d(e))return null;switch(e.Type){case 0:t=L.deserialize(e);break;case 1:t=N.deserialize(e)}return void 0===t?null:t},e.prototype.validate=e}();t.CampaignSurveyEvent=P;var L=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return d(e)?null:(n.activity=e.Activity,n.count=e.Count,n.isAggregate=e.IsAggregate,n.validate()?n:null)},t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||d(this.activity)||!g(this.activity)||!p(this.count)||this.count<=0||!l(this.isAggregate))},t}(P);t.CampaignSurveyEventCountedActivity=L;var N=function(e){eturn r(t,e),t.deserialize=function(e){var n=new t,r=[];if(d(e))return null;for(var i in e.Sequence)if(e.Sequence.hasOwnProperty(i)){var o=e.Sequence[i];o&&r.push(L.deserialize(o))}return 0===r.length&&(r=null),n.sequence=r,n.validate()?n:null},t.prototype.validate=function(){if(!e.prototype.validate.call(this))return!1;if(d(this.sequence))return!1;for(var t in this.sequence)if(this.sequence.hasOwnProperty(t)&&!this.sequence[t])return!1;return!0},t}(P);t.CampaignSurveyEventCountedActivitySequence=N;var U=function(){function e(){}return e.deserialize=function(t,n){var r=new e;return d(t)?null:(r.prompt=k.deserialize(t.Prompt),r.rating=B.deserialize(t.Rating),r.comment=V.deserialize(t.Question),r.multipleChoice=M.deserialize(t.MultipleChoice),r.intercept=x.deserialize(t.Intercept),r.cvSurvey=R.deserialize(t.CVSurveyParams),r.validate(n)?r:null)},e.prototype.validate=function(e){return!(d(this.intercept)&&(d(this.prompt)||(e?d(this.rating)&&d(this.multipleChoice)&&d(this.comment):d(this.rating)||d(this.comment))))},e}();t.CampaignSurveyContent=U;var M=function(){function e(){}return e.deserialize=function(t){var n=new e;return d(t)?null:(n.question=t.Question,n.availableOptions=t.AvailableOptions,n.minNumberOfSelectedOptions=t.MinNumberOfSelectedOptions,n.maxNumberOfSelectedOptions=t.MaxNumberOfSelectedOptions,n.validate()?n:null)},e.prototype.validate=function(){if(d(this.question)||!g(this.question)||d(this.availableOptions)||!Array.isArray(this.availableOptions)||this.availableOptions.length<2||d(this.minNumberOfSelectedOptions)||!p(this.minNumberOfSelectedOptions)||d(this.maxNumberOfSelectedOptions)||!p(this.maxNumberOfSelectedOptions))return!1;for(var e in this.availableOptions)if(this.availableOptions.hasOwnProperty(e)&&!g(this.availableOptions[e]))return!1;return!0},e}();t.CampaignSurveyContentMultipleChoice=M;var R=function(){function e(){}return e.deserialize=function(t){var n=new e;return d(t)?null:(n.customerVoiceFormId=t.CustomerVoiceFormId,n.validate()?n:null)},e.prototype.validate=function(){return!d(this.customerVoiceFormId)&&g(this.customerVoiceFormId)},e}();t.CampaignSurveyContentCVSurvey=R;var k=function(){function e(){}return e.deserialize=function(t){var n=new e;return d(t)?null:(n.title=t.Title,n.question=t.Question,n.yesLabel=t.YesLabel,n.noLabel=t.NoLabel,n.validate()?n:null)},e.prototype.validate=function(){return!(d(this.title)||!g(this.title)||d(this.question)||!g(this.question)||d(this.yesLabel)||!g(this.yesLabel)||d(this.noLabel)||!g(this.noLabel))},e}();t.CampaignSurveyContentPrompt=k;var x=function(){function e(){}return e.deserialize=function(t){var n=new e;return d(t)?null:(n.title=t.Title,n.question=t.Question,n.url=t.Url,n.validate()?n:null)},e.prototype.validate=function(){return!(d(this.title)||!g(this.title)||d(this.question)||!g(this.question)||d(this.url)||!g(this.url))},e}();t.CampaignSurveyContentIntercept=x;var B=function(){function e(){}return e.deserialize=function(t){var n=new e;return d(t)?null:(n.isZeroBased=t.IsZeroBased,n.question=t.Question,n.ratingValuesAscending=t.RatingValuesAscending,n.validate()?n:null)},e.prototype.validate=function(){if(d(this.question)||!g(this.question)||d(this.ratingValuesAscending)||!Array.isArray(this.ratingValuesAscending)||this.ratingValuesAscending.length<2||this.ratingValuesAscending.length>11)return!1;if(d(this.isZeroBased))this.isZeroBased=!1;else if(!l(this.isZeroBased))return!1;for(var e in this.ratingValuesAscending)if(this.ratingValuesAscending.hasOwnProperty(e)&&!g(this.ratingValuesAscending[e]))return!1;return!0},e}();t.CampaignSurveyContentRating=B;var V=function(){function e(){}return e.deserialize=function(t){var n=new e;return d(t)?null:(n.question=t.Question,n.validate()?n:null)},e.prototype.validate=function(){return!(d(this.question)||!g(this.question))},e}();t.CampaignSurveyContentComment=V;var G=function(){function e(){}return e.deserialize=function(t){if(d(t))return null;var n=new e;return n.contentMetadata=t.ContentMetadata,n.validate()?n:null},e.prototype.validate=function(){return!(d(this.contentMetadata)||!u.isObject(this.contentMetadata))},e}();t.CampaignSurveyMetadata=G;var j=function(){function e(){}return e.deserialize=function(e){var t;if(d(e))return null;switch(e.Type){case 0:t=Y.deserialize(e);break;case 1:t=H.deserialize(e);break;case 2:t=z.deserialize(e);break;case 3:t=q.deserialize(e);break;case 4:t=J.deserialize(e);break;case 22:t=K.deserialize(e);break;case 5:t=W.deserialize(e)}return d(t)?null:t},e.prototype.validate=function(){return!d(this.activationEvent)},e}();t.CampaignSurveyTemplate=j;var z=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return d(e)?null:(n.activationEvent=P.deserialize(e.ActivationEvent),n.content=U.deserialize(e.Content,!0),n.validate()?n:null)},t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||d(this.content))},t}(j);t.CampaignSurveyTemplateFps=z;var q=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return d(e)?null:(n.activationEvent=P.deserialize(e.ActivationEvent),n.content=U.deserialize(e.Content),n.validate()?n:null)},t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||d(this.content))},t}(j);t.CampaignSurveyTemplateNlqs=q;var J=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return d(e)?null:(n.activationEvent=P.deserialize(e.ActivationEvent),n.content=U.deserialize(e.Content),n.validate()?n:null)},t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||d(this.content))},t}(j);t.CampaignSurveyTemplateNps=J;var Y=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return d(e)?null:(n.activationEvent=P.deserialize(e.ActivationEvent),n.validate()?n:null)},t.prototype.validate=function(){return!!e.prototype.validate.call(this)},t}(j);t.CampaignSurveyTemplateNps5PointStatic=Y;var H=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return d(e)?null:(n.activationEvent=P.deserialize(e.ActivationEvent),n.validate()?n:null)},t.prototype.validate=function(){return!!e.prototype.validate.call(this)},t}(j);t.CampaignSurveyTemplateNps11PointStatic=H;var K=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){if(d(e))return null;var n=new t;return n.activationEvent=P.deserialize(e.ActivationEvent),n.metadata=G.deserialize(e.Metadata),n.maxLaunches=e.MaxLaunches,n.maxLaunchesPerSession=e.MaxLaunchesPerSession,n.preferredLaunchType=e.PreferredLaunchType,n.validate()?n:null},t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||d(this.metadata)||(!d(this.maxLaunches)&&(!p(this.maxLaunches)||this.maxLaunches<=0)||!d(this.maxLaunchesPerSession)&&(!p(this.maxLaunchesPerSession)||this.maxLaunchesPerSession<=0)?(a.FloodgateEngine.getTelemetryLogger().log_LocalError("Invalid Multi Launch settings",this.maxLaunches,this.maxLaunchesPerSession),1):p(this.maxLaunches)&&p(this.maxLaunchesPerSession)&&this.maxLaunchesPerSession>this.maxLaunches?(a.FloodgateEngine.getTelemetryLogger().log_LocalError("Invalid Multi launch settings",this.maxLaunches,this.maxLaunchesPerSession),1):!d(this.preferredLaunchType)&&!g(this.preferredLaunchType)&&(a.FloodgateEngine.getTelemetryLogger().log_LocalError("Invalid launcher type",this.preferredLaunchType),1)))},t}(j);t.CampaignSurveyTemplateGenericMessagingSurface=K;var W=function(e){function t(){return e.call(this)||this}return r(t,e),t.deserialize=function(e){var n=new t;return d(e)?null:(n.activationEvent=P.deserialize(e.ActivationEvent),n.content=U.deserialize(e.Content),n.validate()?n:null)},t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||d(this.content))},t}(j);t.CampaignSurveyTemplateIntercept=W;var Q=function(){function e(){}return e.deserialize=function(t){var n=new e;if(d(t))return null;n.campaignId=t.CampaignId,n.governedChannelType=t.GovernedChannelType,n.startTime=t.StartTimeUtc,n.endTime=t.EndTimeUtc,n.launcherType=t.LauncherType,n.primaryPriority=t.PrimaryPriority,n.tags=t.Tags;var r=I.deserialize(t.AdditionalDataRequested);return n.additionalDataRequested=r?r.additionalData:[],t.SurveyTemplate&&(n.surveyTemplate=j.deserialize(t.SurveyTemplate)),t.NominationScheme&&(n.nominationScheme=w.deserialize(t.NominationScheme)),t.Scope&&(n.scope=y.deserialize(t.Scope)),d(t.BusinessLevel)||(n.businessLevel=t.BusinessLevel),n.validate()?n:(a.FloodgateEngine.getTelemetryLogger().log_LocalError("Invalid definition",t),null)},e.prototype.validate=function(){var e,t;if(d(this.scope)&&(this.scope=new S),d(this.campaignId)||!g(this.campaignId))return!1;if(!p(this.governedChannelType)||!u.isEnumValue(this.governedChannelType,i.GovernedChannelType))return!1;if(d(this.nominationScheme))return!1;if(d(this.surveyTemplate))return!1;if(!d(this.launcherType)&&!g(this.launcherType))return!1;if("customervoice"===this.launcherType&&d(null===(t=null===(e=this.surveyTemplate.content)||void 0===e?void 0:e.cvSurvey)||void 0===t?void 0:t.customerVoiceFormId))return!1;if(!d(this.primaryPriority)&&!p(this.primaryPriority))return!1;if(this.tags&&!Array.isArray(this.tags))return!1;if(d(this.startTime))this.startTime=c();else{if(!v(this.startTime))return!1;this.startTime=f(this.startTime)}if(d(this.endTime)||"string"==typeof this.endTime&&""===this.endTime)this.endTime=c();else{if(!v(this.endTime))return!1;this.endTime=f(this.endTime)}return!0},e}();function Z(e){var t=[];if(d(e))return{result:t,error:"Empty",invalidIndexes:[]};if(!Array.isArray(e))return{result:t,error:"Not an array",invalidIndexes:[]};for(var n=[],r=0;r<e.length;r++){var i=e[r];if(i){var o=Q.deserialize(i);o?t.push(o):n.push(r)}else n.push(r)}return{result:t,error:n.length>0?"Invalid campaign definitions at indexes: "+n.toString():void 0,invalidIndexes:n}}t.CampaignDefinition=Q,t.FilterValidCampaignDefinitions=Z;var X=function(){function e(e){if(d(e))throw new Error("storage must not be null");this.storage=e}return e.prototype.load=function(){var e,t=this.storage.read(i.FloodgateStorageProviderFileType.CampaignDefinitions);if(d(t))return[];try{e=JSON.parse(t)}catch(e){return a.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed(e.toString()),[]}return Z(e).result},e.prototype.loadAsync=function(){var e=this.load();return new Promise(()},e}();t.FileSystemCampaignDefinitionProvider=X;var $=function(){function e(e){if(this.prefixRegex=new RegExp(/^(Floodgate_Campaign_)/im),d(e))throw new Error("storage must not be null");this.ecsCampaignDefintionProvider=e}return e.prototype.load=function(){var e=this,t=[],n=this.ecsCampaignDefintionProvider.getConfig();if(u.isNOU(n))return t;if(0===Object.keys(null==n?void 0:n.config).length)return a.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.DynamicCampaignDefinitionProvider.Load.EmptyEcsConfig,{Count:0,Message:"Empty config returned from ECS"},.1),t;Object.entries(n.config).forEach((function(n){var r=n[1];if(e.prefixRegex.test(n[0])){if(!u.isObject(r))return!1;t.push(r)}}));var r=Z(t);return r.invalidIndexes.length>0&&a.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.DynamicCampaignDefinitionProvider.Load.InvalidEcsConfig,{Count:r.invalidIndexes.length,Message:r.invalidIndexes.toString()}),r.result},e.prototype.loadAsync=function(){return Promise.resolve(this.load())},e}();t.DynamicCampaignDefinitionProvider=$},jtaB:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("l6Yl"),i=n("DX5p"),o=n("b1Ez"),a=n("J+Cg"),s=n("FFSN"),u=[],c=0,l={},d=function(){function e(e,t){if(this.activityContext={},!e)throw new Error("callback must not be null");this.trackedActivityMap={},this.callback=e,this.loggerCallback=t}return e.resetSessionActivity=e.prototype.logActivity=function(e,t,n){void 0===t&&(t=1),this.logActivity_private(e,0,t,null,n)},e.prototype.logActivityStartTime=function(e,t){this.logActivity_private(e,1,0,t,null)},e.prototype.logActivityStopTime=function(e,t){this.logActivity_private(e,2,0,t,null)},e.prototype.SetActivityTrackingContracts=function(e,t){void 0===t&&(t=new a.SurveyStatCollectionEventActivity);var n=0;if(e&&0!==e.length&&t){for(var s={},u=[],c=0,d=e;c<d.length;c++){var p=d[c],g=p.trackingSet;if(-1===u.indexOf(p.surveyId)){u.push(p.surveyId);for(var v=t.getBySurveyId(p.surveyId),f=[g.getList().length],h=new Array(g.getList().length),m=0,y=0,S=0,C=g.getList();S<C.length;S++){var E=C[S];if(f[y]=0,E.getIsAggregate()&&v&&m<v.Counts.length&&(f[y]=v.Counts[m++]),l[E.getActivity()])for(var T=0,b=l[E.getActivity()];T<b.length;T++){var A=b[T];if(A.surveyId===p.surveyId){h[y]=A;break}}y++}var F=new r.default(g);F.initCounts(f,h,!1);for(var I=0,_=F.generateActivityIndexList();I<_.length;I++){var O=_[I],w=new o.IndexedTracker;w.index=O.index,w.surveyId=p.surveyId,w.tracker=F,s[O.activity]||(s[O.activity]=[]),s[O.activity].push(w)}}else n++}if(n>0){var D=this.loggerCallback&&this.loggerCallback();D&&D.log_Error(i.TelemetryEvent.SurveyActivity.SetActivityTrackingContracts.DuplicateSurveyID,"Duplicate surveyId passed in activityTrackingContracts. Duplicate count: "+n)}this.copyObject(this.trackedActivityMap,s)}},e.prototype.clearSurveys=e.prototype.saveSessionTrackingActivity=e.prototype.getCount=function(e,t){var n=this.getIndexedTracker(e,t);return n?n.tracker.getCount(n.index):0},e.prototype.getSessionCount=function(e,t){var n=this.getIndexedTracker(e,t);return n?n.tracker.getSessionCount(n.index):0},e.prototype.moveSessionCountIntoBaseCount=function(e,t){var n=this.getIndexedTracker(e,t);return n?n.tracker.moveSessionCountIntoBaseCount(n.index):0},e.prototype.getSurveyIds=function(e){if(!s.isNOU(e)){var t=this.trackedActivityMap[e];if(t)return t.map((function(e){return e.surveyId}))}},e.prototype.setCallback=function(e){this.callback=e},e.prototype.UpdateActivityTrackingContracts=function(e){if(s.isNOU(e)||0===Object.keys(e).length)this.clearSurveys();else for(var t in this.trackedActivityMap)if(this.trackedActivityMap.hasOwnProperty(t))for(var n=this.trackedActivityMap[t],r=n.length-1;r>=0;--r)e.hasOwnProperty(n[r].surveyId)||n.splice(r,1)},e.prototype.getIndexedTracker=function(e,t){var n=this.trackedActivityMap[e];if(n){for(var r,i=0,o=n;i<o.length;i++){var a=o[i];if(a.surveyId===t){r=a;break}}return r}},e.prototype.resetQueuedActivities=e.prototype.logActivity_private=function(t,n,r,o,a){var s=this;if(this.callback&&!this.callback.shouldAcceptActivity(t)&&(c++,u.length<e.MaxPendingActivitiesQueueSize&&u.push({activityName:t,logType:n,increment:r,timestamp:o})),t===e.FloodgateStartActivityName){if(c>0){var l=u.slice(0,25).map((function(e){return e.activityName})),d=this.loggerCallback&&this.loggerCallback();d&&d.log_Event(i.TelemetryEvent.SurveyActivity.LogActivity.EventsReprocessed,{ActivityNames:JSON.stringify(l),Count:u.length,Dropped:c-u.length},.05),u.map((function(e){return s.logActivity_core(e.activityName,e.logType,e.increment,e.timestamp,a)}))}c=0,this.resetQueuedActivities()}this.logActivity_core(t,n,r,o,a)},e.prototype.logActivity_core=function(e,t,n,r,i){var o=this.trackedActivityMap[e];if(o&&0!==o.length){var a=[];if(o.length>1){a=new Array(o.length);for(var u=0;u<a.length;u++)a[u]=u;a=s.fyShuffle(a)}else a.push(0);for(var c=0,l=a;c<l.length;c++){var d=o[l[c]];switch(t){case 1:d.tracker.startTime(d.index,r);continue;case 2:n=d.tracker.stopTime(d.index,r);case 0:break;default:continue}if(i){var p=d.surveyId;this.activityContext[p]=this.activityContext[p]||[],this.activityContext[p].push({activityName:e,context:i})}if(2===d.tracker.incrementActivity(d.index,n)){this.executeCallback(d.surveyId);break}}}},e.prototype.executeCallback=e.prototype.copyObject=e.FloodgateStartActivityName="FloodgateFirstStart",e.MaxPendingActivitiesQueueSize=100,e}();t.default=d},kZ16:function(e,t,n){"use strict";n.d(t,"a",(function(){return ue})),n.d(t,"c",(function(){return ge})),n.d(t,"b",(function(){return ve}));var r=n("7P0z");class i{constructor(e,t){if(!e)throw new Error("name must not be null");if(!t)throw new Error("version must not be null");this.name=e,this.version=t}getName(){return this.name}getPlatform(){return i.PLATFORM}getVersion(){return this.version}}i.PLATFORM="Web";class o{etId(){return this.id}}class a{etId(){return this.id}getLocale(){return this.locale}getSessionId(){return this.sessionId}getVersion(){return this.version}}class s{constructor(e,t,n,r){if(!e)throw new Error("name must not be null");if(!t)throw new Error("sessionId must not be null");if(!n&&0!==n||n<0)throw new Error("sequence must not be negative");this.name=e,this.id=t+s.ID_DELIMITER+n,this.sequence=n,this.sampleRate=r}getName(){return this.name}getId(){return this.id}getSource(){return s.SOURCE}etSequence(){return this.sequence}getSampleRate(){return this.sampleRate}}s.ID_DELIMITER=".",s.SOURCE="MsoThin",s.SCHEMA_VERSION=1;class u{constructor(e){this.audienceGroup=e}getAudienceGroup(){return this.audienceGroup}}r d=n("IqPN"),p=n("aCzR"),g=n("J78o"),v=n("3M/p");class f{constructor(e,t,n,r,i,o,a,s,u,c=p.b){if(!e)throw new Error("tenantToken must not be null");if(!r)throw new Error("app must not be null");if(!n)throw new Error("telemetrySink must not be null");if(!t)throw new Error("namespace must not be null");if(!i)throw new Error("session must not be null");this.namespace=t,this.oesApp=r,this.oesSession=i,this.oesHost=o,this.oesRelease=a,this.oesBrowser=s,this.oesDevice=u,this.sequence=1,this.oteljsTelemetryLogger=new g.a(void 0,this.getStaticPersistentDataFields(this.oesApp,this.oesHost,this.oesRelease,this.oesBrowser,this.oesDevice)),this.oteljsTelemetryLogger.setTenantToken(t,e,c),this.oteljsTelemetryLogger.addSink(n)}logEvent(e,t,n=1){if(!e)throw new Error("eventName must not be null");const r=this.createOTelTelemetryEvent(e,t,n);this.oteljsTelemetryLogger.sendTelemetryEvent(r),this.sequence++}addDynamicPersistentProperties(e,t){Object(d.isNOU)(this.oesSession)||e.dataFields.push(Object(v.d)("Session.Id",this.oesSession.getId())),Object(d.isNOU)(this.sequence)||e.dataFields.push(Object(v.b)("Event.Sequence",this.sequence)),Object(d.isNOU)(t)||e.dataFields.push(Object(v.b)("Event.SampleRate",t))}createOTelTelemetryEvent(e,t,n){const r={eventName:this.namespace+f.EVENT_NAME_DELIMITER+e,eventFlags:{diagnosticLevel:110},dataFields:[]};for(const e in t)if(t.hasOwnProperty(e)){const n=t[e];let i;switch(typeof n){case"string":i=Object(v.d)(e,n);break;case"number":i=Object(v.b)(e,n);break;case"boolean":i=Object(v.a)(e,n);break;default:continue}Object(d.isNOU)(i)||r.dataFields.push(i)}return this.addDynamicPersistentProperties(r,n),r}getStaticPersistentDataFields(e,t,n,r,i){const o=[];return Object(d.isNOU)(e)||(o.push(Object(v.d)("App.Name",e.getName())),o.push(Object(v.d)("App.Platform",e.getPlatform())),o.push(Object(v.d)("App.Version",e.getVersion()))),Object(d.isNOU)(n)||o.push(Object(v.d)("Release.AudienceGroup",n.getAudienceGroup())),Object(d.isNOU)(i)||o.push(Object(v.d)("Device.Id",i.getId())),Object(d.isNOU)(t)||(o.push(Object(v.d)("Host.Id",t.getId())),o.push(Object(v.d)("Host.Locale",t.getLocale())),o.push(Object(v.d)("Host.SessionId2",t.getSessionId())),o.push(Object(v.d)("Host.Version",t.getVersion()))),Object(d.isNOU)(r)||(o.push(Object(v.d)("Browser.Name",r.getName())),o.push(Object(v.d)("Browser.Version",r.getVersion()))),o}}f.EVENT_NAME_DELIMITER=".";var h,m,y,S,C,E,T,b,A,F,I,_,O,w,D,P,L,N,U,M,R,k,x,B,V,G,j,z,q,J,Y,H,K,W,Q,Z,X,$,ee,te,ne,re,ie,oe,ae,se=n("wSjW");class ue{}ue.InApp=((h=class{}).UI=((m=class{}).Picker=((y=class{}).Shown=((S=class{}).VALUE={name:"InApp_UI_Picker_Shown"},S),y),m.Form=((C=class{}).Shown=((E=class{}).VALUE={name:"InApp_UI_Form_Shown"},E),C.Submit=((T=class{}).VALUE={name:"InApp_UI_Form_Submit"},T),C),m),h),ue.SURVEY_FLOODGATE_CAMPAIGNLOAD_FAILED={name:"Survey_Floodgate_CampaignLoad_Failed"},ue.SURVEY_FLOODGATE_FILEREAD_FAILED={name:"Survey_Floodgate_FileRead_Failed"},ue.SURVEY_FLOODGATE_FILEWRITE_FAILED={name:"Survey_Floodgate_FileWrite_Failed"},ue.SURVEY_FLOODGATE_TRIGGERMET={name:"Survey_Floodgate_TriggerMet"},ue.SURVEY_FLOODGATE_USERSELECTED={name:"Survey_Floodgate_UserSelected"},ue.SURVEY_FLOODGATE_SHOWCUSTOMSURVEY_FAILED={name:"Survey_Floodgate_ShowCustomSurvey_Failed"},ue.SURVEY_UI_RENDER_CV_SURVEY_COMPLETED={name:"Survey_UI_Render_CVSurvey_Completed"},ue.SURVEY_UI_FORM_SHOWN={name:"Survey_UI_Form_Shown"},ue.SURVEY_UI_FORM_DISPATCHER_IMPLEMENTED={name:"Survey_UI_Form_Dispatcher_Implemented"},ue.SURVEY_UI_FORM_SUBMIT={name:"Survey_UI_Form_Submit"},ue.SURVEY_UI_FORM_SECONDARY_SUBMIT={name:"Survey_UI_Form_Secondary_Submit"},ue.SURVEY_UI_FORM_SUBMIT_ERROR={name:"Survey_UI_Form_Submit_Error"},ue.SURVEY_UI_FORM_USERCLOSED={name:"Survey_UI_Form_UserClosed"},ue.SURVEY_UI_THANKYOUPAGE_USERCLOSED={name:"Survey_UI_ThankYouPage_UserClosed"},ue.SURVEY_UI_FORM_NO_RETURN_TYPE={name:"Survey_UI_Form_No_Return_Type"},ue.SURVEY_UI_PROMPT_AUTODISMISSED={name:"Survey_UI_Prompt_AutoDismissed"},ue.SURVEY_UI_THANKYOUPAGE_AUTODISMISSED={name:"Survey_UI_ThankYouPage_AutoDismissed"},ue.SURVEY_UI_PROMPT_SHOWN={name:"Survey_UI_Prompt_Shown"},ue.SURVEY_UI_PROMPT_USERCLOSED={name:"Survey_UI_Prompt_UserClosed"},ue.SURVEY_UI_ADDITIONALPROMPT_USERCLOSED={name:"Survey_UI_AdditionalPrompt_UserClosed"},ue.SURVEY_UI_PROMPT_CLICKED={name:"Survey_UI_Prompt_Clicked"},ue.SURVEY_UI_ADDITIONALPROMPT_CLICKED={name:"Survey_UI_AdditionalPrompt_Clicked"},ue.SURVEY_UI_REDIRECTIONFAILURE={name:"Survey_UI_RedirectionFailure"},ue.GOVERNANCE_SERVICEFAILURE={name:"Gorvenance_ServiceFailure"},ue.GOVERNANCE_SERVICERESULT={name:"Gorvenance_ServiceResult"},ue.DYNAMICTRANSPORT_POST_ERROR={name:"DynamicTransport_Post_Error"},ue.FEEDBACK_SURVEYSDISABLED_AADC={name:"Feedback_SurveysDisabled_AADC"},ue.SURVEY_UI_DISABLED_AADC={name:"Survey_UI_Prevented_AADC"},ue.PERSONALIZER_SERVICEREWARDRESULT={name:"Personalizer_ServiceRewardResult"},ue.PERSONALIZER_CLIENTFAILURE={name:"Personalizer_ClientFailure"},ue.APPDATA_JSON_PARSE_ERROR={name:"AppData_JSON_Parse_Error"},ue.SURVEY_RENDER_OVERRIDE_ERROR={name:"Survey_Render_Override_Error"},ue.SURVEY_RENDER_OVERRIDE_SUCCESS={name:"Survey_Render_Override_Success"},ue.SURVEY_EVENT_KEY_ERROR={name:"Survey_Event_Key_Error"},ue.SURVEY_RENDER_CONTEXT_ERROR={name:"Survey_Render_Context_Error"},ue.Shared=((b=class{}).Upload=((A=class{}).Failed=((F=class{}).VALUE={name:"Shared_Upload_Failed"},F),A.Prevented=((I=class{}).VALUE={name:"Shared_Upload_Prevented_AADC"},I),A),b.Screenshot=((_=class{}).Render=((O=class{}).Failed=((w=class{}).VALUE={name:"Shared_Screenshot_Render_Failed"},w),O.Success=((D=class{}).VALUE={name:"Shared_Screenshot_Render_Success"},D),O),_.GetContent=((P=class{}).Failed=((L=class{}).DefaultImage=((N=class{}).Returned=((U=class{}).VALUE={name:"Shared_Screenshot_GetContent_Failed_DefaultImage_Returned"},U),N),L),P),_),b),ue.WebSurfaces=((M=class{}).Common=((R=class{}).Error=((k=class{}).VALUE={name:"WebSurfaces_Common_Error"},k),R.Info=((x=class{}).VALUE={name:"WebSurfaces_Common_Info"},x),R),M.CampaignMetadataAggregator=((B=class{}).Error=((V=class{}).VALUE={name:"WebSurfaces_CampaignMetadataAggregator_Error"},V),B.Requests=((G=class{}).VALUE={name:"WebSurfaces_CampaignMetadataAggregator_Requests"},G),B),M.SetCampaignAction=((j=class{}).Error=((z=class{}).VALUE={name:"WebSurfaces_SetCampaignAction_Error"},z),j.Requests=((q=class{}).VALUE={name:"WebSurfaces_SetCampaignAction_Requests"},q),j),M),ue.UserFacts=((J=class{}).Common=((Y=class{}).Error=((H=class{}).VALUE={name:"UserFacts_Common_Error"},H),Y.Info=((K=class{}).VALUE={name:"UserFacts_Common_Info"},K),Y),J.LocalFact=((W=class{}).Error=((Q=class{}).VALUE={name:"UserFacts_LocalFact_Error"},Q),W),J.Messaging=((Z=class{}).Requests=((X=class{}).VALUE={name:"UserFacts_Messaging_Requests"},X),Z),J.AugLoop=(($=class{}).Requests=((ee=class{}).VALUE={name:"UserFacts_AugLoop_Requests"},ee),$.Error=((te=class{}).VALUE={name:"UserFacts_AugLoop_Error"},te),$),J.Provider=((ne=class{}).Info=((re=class{}).VALUE={name:"UserFacts_Provider_Summary"},re),ne),J),ue.Common=((ie=class{}).Error=((oe=class{}).VALUE={name:"Common_Error"},oe),ie.Info=((ae=.VALUE={name:"Common_Info"},ae),ie);var ce=n("4p7e");const{isNOU:le}=d;let de,pe;function ge(e,t,n,r,s){const d=e.telemetryGroup?e.telemetryGroup:{},p=e.webGroup?e.webGroup:{};de=new fe(class{static create.create(he.getTenantToken(e.environment),"Office.Feedback",e.telemetrySink,new i(t,n),new o(r),new a(e.appId.toString(),e.originalLocale,e.sessionId,e.build),new u(d.audienceGroup),new c(p.browser,p.browserVersion),new l(d.deviceId)),s,e),pe=e.environment}function ve(){return de}class fe{constructor(e,t,n){if(this.SAMPLING_RESULT=Math.random(),!e)throw new Error("telemetryLogger must not be null");this.telemetryLogger=e,this.eventSampling=t,this.initOptionsCommon=n}logEvent(e,t,n,r){if(!e)throw new Error("eventId must not be null");let i;if(this.isEventSampled(e.name)?i=this.getEventSamplingRate(e.name):void 0!==r&&(i=r),le(t)||0===t){if(0===pe){const e="logSeverity must not be null or none";this.isConsoleLogEnabled&&console&&console.log("Floodgate event: ",fe.EVENT_NAME,e),this.telemetryLogger.logEvent(fe.EVENT_NAME,{ErrorMessage:e},i)}return!1}return(n=n||{})[fe.EVENT_ID]=e.name,(this.isLoggingEnabled(t,i)||this.isEventTelemetryEnabled(e.name))&&(i=null!=i?i:fe.DEFAULT_SAMPLE_RATE,this.telemetryLogger.logEvent(fe.EVENT_NAME,n,i)),this.isConsoleLogEnabled&&console&&console.log("Floodgate event: ",fe.EVENT_NAME,t,n),!0}logLocal(e,...t){this.isLoggingEnabled(e)&&this.isConsoleLogEnabled&&console&&console.log("LPP FG: ",e,t)}getUserSamplingRate(){return this.SAMPLING_RESULT}isEventTelemetryEnabled(e){var t,n,r,i;try{if(!this.dynamicLogSettings)return!1;const o=null===(n=null===(t=this.initOptionsCommon)||void 0===t?void 0:t.appId)||void 0===n?void 0:n.toString(),a=null===(i=null===(r=this.initOptionsCommon)||void 0===r?void 0:r.originalLocale)||void 0===i?void 0:i.toLowerCase(),s=`content_${e}`,u=this.dynamicLogSettings[`${s}_${o}_${a}`]||this.dynamicLogSettings[`${s}_${o}`]||this.dynamicLogSettings[`${s}_${a}`]||this.dynamicLogSettings[s];return null==u?void 0:u.isEnabled}catch(e){this.isConsoleLogEnabled&&console.log("FG: Error checking for dynamic log settings: ",e)}return!1}isLoggingEnabled(e,t){if(le(this.logLevel)){const e=this.getCurrentLogLevel();this.logLevel=le(e)?2:e}const n=null!=t?t:fe.DEFAULT_SAMPLE_RATE;return(e<=this.logLevel||0!==this.logLevel&&void 0!==t)&&this.SAMPLING_RESULT<=n&&0!==n}getCurrentLogLevel(){try{const e="undefined"!=typeof URLSearchParams&&new URLSearchParams(window.location.search)||void 0;let t=e&&e.get("obfconsolelog");if(!t){const e="undefined"!=typeof document&&document.referrer;t=e&&-1!==e.indexOf("obfconsolelog")}t&&(this.isConsoleLogEnabled=!0);const n=e&&e.get("obfloglevel");if(!le(n))return this.isConsoleLogEnabled=!0,parseInt(n,10);if(se.a.isStorageAvailable()){let e=(new se.a).read(r.FloodgateStorageProviderFileType.LogLevelSettings);e||(e=Object(ce.a)("LogLevelSettings",""));const t=e&&this.parseObject(e);if(t){this.dynamicLogSettings=t;let e=t.content;if(this.initOptionsCommon){const n=this.initOptionsCommon.appId&&this.initOptionsCommon.appId.toString(),r=this.initOptionsCommon.originalLocale&&this.initOptionsCommon.originalLocale.toLowerCase();e=t[`content_${n}_${r}`]||t[`content_${n}`]||t[`content_${r}`]||t.content}if(e)return e.consoleLog&&(this.isConsoleLogEnabled=!0),e.logLevel}}}catch(e){return void(this.isConsoleLogEnabled&&console.log("Error while getting the current log level: ",e))}return null}parseObjectetEventSamplingRate(e){let t=1;return this.eventSampling.event&&e in this.eventSampling.event&&(t=this.eventSampling.event[e]),t}isEventSampled(e){return!(!this.eventSampling.event||!(e in this.eventSampling.event))}}fe.EVENT_NAME="SDK",fe.EVENT_ID="EventId",fe.DEFAULT_SAMPLE_RATE=1;class he{he.TENANT_TOKEN_PRODUCTION="d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360",he.TENANT_TOKEN_PRE_PRODUCTION="2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736"},l6Yl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){if(!e)throw new Error("trackingSet must not be null");if(e.getList().length>32)throw new Error("trackingSet list size must be less than 32");this.isOrdered=e.getIsOrdered(),this.trackedActivities=e.getList(),this.currentIndex=0,this.activationMask=0,this.currentActivationFlags=0,this.isActivationByInitPending=!1,this.currentCounts=new Array(this.trackedActivities.length),this.currentStartTimes=new Array(this.trackedActivities.length),this.currentSessionCounts=new Array(this.trackedActivities.length);for(var t=0;t<this.trackedActivities.length;t++)this.currentCounts[t]=0,this.currentSessionCounts[t]=0;for(t=0;t<this.trackedActivities.length;t++)this.activationMask|=1<<t,this.trackedActivities[t].getCount()<1&&this.trackedActivities[t].setCount(1)}return e.prototype.getCount=function(e){return this.isValidIndex(e)?this.currentCounts[e]:0},e.prototype.getSessionCount=function(e){return this.isValidIndex(e)?this.currentSessionCounts[e]:0},e.prototype.getStartTime=e.prototype.moveSessionCountIntoBaseCount=e.prototype.initCounts=e.prototype.generateActivityIndexList=e.prototype.incrementActivity=function(e,t){if(!this.isValidIndex(e))return 0;if(t<0)throw new Error("increment must be non-negative");if(this.isOrdered&&e>this.currentIndex)return 0;var n=!this.hasCountCrossedThreshold(e);return this.currentCounts[e]+=t,this.currentSessionCounts[e]+=t,this.isActivationByInitPending?this.isPermittedIndexForActivationByInit(e)?this.commitActivation():0:n&&this.hasCountCrossedThreshold(e)?(this.finishActivityAtIndex(e),this.isActivated()?this.commitActivation():1):0},e.prototype.startTime=function(e,t){this.isValidIndex(e)&&(this.currentStartTimes[e]=t||new Date)},e.prototype.stopTime=function(e,t){if(!this.isValidIndex(e))return 0;var n=this.currentStartTimes[e];if(this.currentStartTimes[e]=null,!n)return 0;if(n>(t=t||new Date))return 0;var r=(t.getTime()-n.getTime())/1e3;return r%1==0&&(r+=.001),r},e.prototype.isValidIndex=e.prototype.isActivated=e.prototype.finishActivityAtIndex=e.prototype.hasCountCrossedThreshold=e.prototype.isPermittedIndexForActivationByInit=e.prototype.commitActivation=e}();!function(e){var t=function(){return function(){}}();e.ActivityIndex=t}(r||(r={})),t.default=r},l8Ue:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n("XtAz");var r=n("DvkI"),i=n("Y3a9"),o=n("HPVw"),a=n("kZ16");let s=!1,u=!1;function c(){if(!s){if(!o.a().OfficeBrowserFeedback.initOptions)throw new Error("Window.OfficeBrowserFeedback.initOptions not set");o.a().OfficeBrowserFeedback.sdkVersion=r.a,i.d().setCommonInitOptions(o.a().OfficeBrowserFeedback.initOptions),u=i.d().isFeedbackSurveyEnabledByAADC(),a.c(i.d().getCommonInitOptions(),"OfficeFeedbackSDK",r.a,i.d().getSdkSessionId(),i.d().getEventSampling()),s=!0,u||a.b().logEvent(a.a.FEEDBACK_SURVEYSDISABLED_AADC,1,{Data:JSON.stringify({ageGroup:i.d().getCommonInitOptions().ageGroup,authenticationType:i.d().getCommonInitOptions().authenticationType})})}}.n((function(){return u}))},"lj+m":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LAUNCHER_TYPE_DEFAULT=t.DOM_INTERCEPT_TAGNAME=t.DOM_NLQS_TAGNAME=t.DOM_FPS_TAGNAME=t.DOM_BPS_TAGNAME=t.DOM_PSAT_TAGNAME=t.DOM_NPS_TAGNAME=t.DOM_FEEDBACKSURVEY_TAGNAME=t.SurveyType=void 0,t.SurveyType||(t.SurveyType={})),t.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey",t.DOM_NPS_TAGNAME="Nps",t.DOM_PSAT_TAGNAME="Psat",t.DOM_BPS_TAGNAME="Bps",t.DOM_FPS_TAGNAME="Fps",t.DOM_NLQS_TAGNAME="Nlqs",t.DOM_INTERCEPT_TAGNAME="Intercept",t.LAUNCHER_TYPE_DEFAULT="survey"},lkXj:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n("7P0z"),o=n("Z+rh"),a=n("ziXt"),s=n("Kx/u"),u=n("iW5C"),c=n("FFSN"),l=n("8+ih"),d=n("Dwqi"),p=c.isNOU,g=c.overrideValues,v=function(e){function t(t){var n=e.call(this)||this;if(!t)throw new Error("data must not be null");return n.surveyInfo=new d.default(t.baseData),n.prompt=new s.default(t.promptData),n.question=new o.default(t.commentData),n.rating=new u.default(t.ratingData),n.cvSurvey=t.cvSurveyData?new a.default(t.cvSurveyData):null,n}return r(t,e),t.make=function(e){try{return new t(e)}catch(e){return null}},t.makeCustom=function(e,n,r){if(p(e)||p(n)||p(r))return null;var i=[],c=r.content;if(p(c)||p(c.comment)||p(c.prompt)||p(c.rating))return null;var l=new t.NpsSurveyData;l.baseData=e,l.promptData=new s.default.PromptComponentData,l.ratingData=new u.default.RatingComponentData,l.commentData=new o.default.CommentComponentData,l.promptData.title=n.getCustomString(c.prompt.title),l.promptData.question=n.getCustomString(c.prompt.question),l.promptData.yesButtonLabel=n.getCustomString(c.prompt.yesLabel),l.promptData.noButtonLabel=n.getCustomString(c.prompt.noLabel),l.ratingData.question=n.getCustomString(c.rating.question),l.ratingData.isZeroBased=c.rating.isZeroBased,l.commentData.question=n.getCustomString(c.comment.question);for(var d=0,g=c.rating.ratingValuesAscending;d<g.length;d++){var v=n.getCustomString(g[d]);if(p(v))return null;i.push(v)}return l.ratingData.ratingValuesAscending=i,p(l.ratingData.question)||p(l.commentData.question)||p(l.promptData.title)||p(l.promptData.question)||p(l.promptData.yesButtonLabel)||p(l.promptData.noButtonLabel)||p(l.ratingData.ratingValuesAscending)||c.cvSurvey&&(l.cvSurveyData=new a.default.CVSurveyComponentData,l.cvSurveyData.customerVoiceFormId=c.cvSurvey.customerVoiceFormId,p(l.cvSurveyData.customerVoiceFormId))?null:this.make(l)},t.make5Point=function(e,n){if(!e||!n)return null;var r=new t.NpsSurveyData;r.baseData=e,r.ratingData=new u.default.RatingComponentData,r.ratingData.isZeroBased=!1,r.commentData=new o.default.CommentComponentData,r.promptData=new s.default.PromptComponentData,r.ratingData.question=n.loadStringResource(4),r.commentData.question=n.loadStringResource(21),r.promptData.title=n.loadStringResource(0),r.promptData.question=n.loadStringResource(1),r.promptData.yesButtonLabel=n.loadStringResource(2),r.promptData.noButtonLabel=n.loadStringResource(3);var i=new Array(5);return i[0]=n.loadStringResource(16),i[1]=n.loadStringResource(17),i[2]=n.loadStringResource(18),i[3]=n.loadStringResource(19),i[4]=n.loadStringResource(20),r.ratingData.question&&r.commentData.question&&r.promptData.title&&r.promptData.question&&r.promptData.yesButtonLabel&&r.promptData.noButtonLabel&&i[0]&&i[1]&&i[2]&&i[3]&&i[4]?(r.ratingData.ratingValuesAscending=i,this.make(r)):null},t.make11Point=function(e,n){if(!e||!n)return null;var r=new t.NpsSurveyData;r.baseData=e,r.ratingData=new u.default.RatingComponentData,r.ratingData.isZeroBased=!0,r.commentData=new o.default.CommentComponentData,r.promptData=new s.default.PromptComponentData,r.ratingData.question=n.loadStringResource(4),r.commentData.question=n.loadStringResource(21),r.promptData.title=n.loadStringResource(0),r.promptData.question=n.loadStringResource(1),r.promptData.yesButtonLabel=n.loadStringResource(2),r.promptData.noButtonLabel=n.loadStringResource(3);var i=new Array(11);return i[0]=n.loadStringResource(5),i[1]=n.loadStringResource(6),i[2]=n.loadStringResource(7),i[3]=n.loadStringResource(8),i[4]=n.loadStringResource(9),i[5]=n.loadStringResource(10),i[6]=n.loadStringResource(11),i[7]=n.loadStringResource(12),i[8]=n.loadStringResource(13),i[9]=n.loadStringResource(14),i[10]=n.loadStringResource(15),r.ratingData.question&&r.commentData.question&&r.promptData.title&&r.promptData.question&&r.promptData.yesButtonLabel&&r.promptData.noButtonLabel&&i[0]&&i[1]&&i[2]&&i[3]&&i[4]&&i[5]&&i[6]&&i[7]&&i[8]&&i[9]&&i[10]?(r.ratingData.ratingValuesAscending=i,this.make(r)):null},t.prototype.getType=function(){return i.SurveyType.Nps},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getCVSurveyComponent=function(){return this.cvSurvey},t.prototype.getTags=function(){return this.surveyInfo.getTags()},t.prototype.getComponent=function(e){switch(e){case"Comment":return this.getCommentComponent();case"Prompt":return this.getPromptComponent();case"Rating":return this.getRatingComponent();case"CVSurvey":return this.getCVSurveyComponent();default:return null}},t.prototype.getDomElements=t.prototype.getJsonElements=function(){var e,t={};return t=g(this.getSurveyInfo().getJsonElements(),t),t=g(this.getCommentComponent().getJsonElements(),t),(t=g(this.getRatingComponent().getJsonElements(),t))[i.JSON_APPLICATION_KEYNAME]={},t[i.JSON_APPLICATION_KEYNAME][i.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify(((e={})[i.JSON_SURVEYSTRINGS_KEYNAME]=this.makeSurveyStrings(),e)),t},t.prototype.makeSurveyStrings=function(){var e={};return this.prompt&&(e[i.JSON_PROMPT_KEYNAME]=this.prompt.getComponentJson()),this.rating&&(e[i.JSON_RATING_KEYNAME]=[this.rating.getComponentJson()]),this.question&&(e[i.JSON_COMMENT_KEYNAME]=[this.question.getComponentJson()]),JSON.stringify(e)},t}(l.Survey);!function(e){var t=function(){return function(){}}();e.NpsSurveyData=t}(v||(v={})),t.default=v},m3vj:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("IqPN"),i=n("kZ16"),o=n("Y3a9");class a{constructor(e){this.screenshot=e}getContent(){let e;try{e=this.screenshot.toDataURL("image/jpeg").split(",")[1]}catch(t){i.b().logEvent(i.a.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE,2,{ErrorMessage:t.toString()}),e="iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSFlzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsvwXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQJZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPdsswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0CbqaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII="}let t=atob(e),n=[];for(let e=0;e<t.length;e++)n.push(t.charCodeAt(e));return new Blob([new Uint8Array(n)],{type:"image/jpeg"})}}var s=n("ZeN8"),u=n("DvkI"),c=n("HPVw");class l{constructor(e,t,n,r,i,o,a,l,p){this.manifestData={appId:t,application:o,clientFeedbackId:i,manifestType:e,source:"Client",submitTime:n,telemetry:a,type:d(r),web:l,sdkVersion:s.d+(void 0!==c.a().OfficeBrowserFeedback.sdkVersion?c.a().OfficeBrowserFeedback.sdkVersion:u.a),retentionDurationDays:p}}etComment(e){this.manifestData.comment=e}setEmail(e){this.manifestData.email=e}setCategory(e){this.manifestData.telemetry=this.manifestData.telemetry||{},this.manifestData.telemetry.featureArea=e}setAppData(e){this.manifestData.application=this.manifestData.application||{},this.manifestData.application.appData=e}setExtendedManifestDataComplianceInformation(e,t,n,r,i,o){this.manifestData.complianceChecks={authenticationType:e,ageGroup:t,policyAllowFeedback:n,policyAllowSurvey:r,policyAllowScreenshot:i,policyAllowContact:o}}setValues(e){if(e)for(let t in e)e.hasOwnProperty(t)&&(this.manifestData[t]=this.manifestData.hasOwnProperty(t)?r.overrideValues(e[t],this.manifestData[t]):e[t])}getContentppendUxId(e){!r.isNOU(e)&&r.isString(e)&&""!==e&&(this.manifestData.sdkVersion=this.manifestData.sdkVersion+","+e)}}lass p{constructor(e,t,n,i,a,s,u){var c,d,p,g,v,f,h,m;this.clientFeedbackId=r.guid(),this.manifest=new l(t,n,(new Date).toISOString(),i,this.clientFeedbackId,Object.assign({},a),Object.assign({},s),Object.assign({},u),o.d().getCommonInitOptions().retentionDurationDays),this.environment=e,this.manifest.setComplianceInformation(o.b[null!==(d=null===(c=o.d().getCommonInitOptions())||void 0===c?void 0:c.authenticationType)&&void 0!==d?d:o.b.Unauthenticated],o.a[null!==(g=null===(p=o.d().getCommonInitOptions())||void 0===p?void 0:p.ageGroup)&&void 0!==g?g:o.a.Undefined],this.ocpsEnumToString(null===(v=o.d().getInAppFeedbackInitOptions())||void 0===v?void 0:v.sendFeedbackPolicyValue),this.ocpsBooleanToString(null===(f=o.d().getFloodgateInitOptions())||void 0===f?void 0:f.surveyEnabled),this.ocpsEnumToString(null===(h=o.d().getCommonInitOptions())||void 0===h?void 0:h.screenshotPolicyValue),this.ocpsEnumToString(null===(m=o.d().getCommonInitOptions())||void 0===m?void 0:m.emailPolicyValue))}getClientFeedbackId(){return this.clientFeedbackId}getExtendedManifestData(){return this.manifest.getExtendedManifestData()}setComment(e){this.manifest.setComment(e)}setEmail(e){this.manifest.setEmail(e)}setCategory(e){this.manifest.setCategory(e)}setAppData(e){this.manifest.setAppData(e)}setExtendedManifestData(e){this.manifest.setExtendedManifestData(e)}etClientFeedbackId(e){this.manifest.setClientFeedbackId(e)}appendUxId(e){this.manifest.appendUxId(e)}getManifest(){return this.manifest}ubmit(){if(!o.d().isFeedbackSurveyEnabledByAADC())return i.b().logEvent(i.a.Shared.Upload.Prevented.VALUE,2,{Data:JSON.stringify({ageGroup:o.d().getCommonInitOptions().ageGroup,authenticationType:o.d().getCommonInitOptions().authenticationType})}),Promise.resolve();let e,t=this.manifest.getContent();const n=this.clientFeedbackId;return this.screenshot&&(e=this.screenshot.getContent()),function(e,t,n,r){if(void 0===t)return Promise.reject(new Error("Manifest cannot be undefined"));let i=new FormData;return i.append("Manifest",t),n&&i.append("Screenshot",n),r&&i.append("Diagnostics",r),function(e,t,n,r,i){let a=(e,r)=>new Promise(((i,o)=>{let s=new XMLHttpRequest;s.open("POST",t,!0),s.timeout=r,s.onload=()=>{!s,i,o)},s.ontimeout=()=>{e>0?a(e-1,2*r).then(i,o):o(new Error(`Request to '${t}' timed out. timeout: ${s.timeout}`))},s.onerror=()=>{e>0?a(e-1,r).then(i,o):o(new Error(`Request to '${t}' errored. ${s.status} - ${s.statusText} : ${s.responseText}`))},s.send(n)}));const s=o.d().getCommonInitOptions().petrolTimeout?o.d().getCommonInitOptions().petrolTimeout:8e3;return a(2,s)}(0,e?"https://petrol.office.microsoft.com/v1/feedback":"https://petrol-int.office.microsoft.com/v1/feedback",i)}(0===this.environment,t,e).catch((function(e){o.d().setFeedbackSubmitted(!1),o.d().getCommonInitOptions().onError("Payload submission failed: "+e.message+". ClientFeedbackId: "+n),i.b().logEvent(i.a.Shared.Upload.Failed.VALUE,2,{ErrorMessage:e.message,ClientFeedbackId:n})}))}ocpsBooleanToStringcpsEnumToString(e){if(!e)return"Not Configured";switch(e){case 2:return"Disabled";case 1:return"Enabled";default:return"Not Configured"}}}},mwxp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityTrackingData=void 0;var r=);t.ActivityTrackingData=r},nBDv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},nIJ3:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyActivationStats=t.FileBasedSurveyActivationStatsProvider=t.HostBasedSurveyActivationStatsProvider=t.SurveyActivationStatsProviderFactory=t.SurveyStatCollectionActivation=void 0;var i=n("7P0z"),o=n("DX5p"),a=n("iv/W"),s=n("tc4T"),u=n("3ndD"),c=n("FFSN"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.fromJson=function(e){var n,r=new t;if(!e)return a.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Input json is null or empty."}),r;try{n=JSON.parse(e)}catch(e){return a.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+e.toString()}),r}return r.deserialize(n)?r:new t},t.toJson=function(e){return e||(a.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.SurveyStatCollectionActivation.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),e=new t),JSON.stringify(e)},t.prototype.accumulate=function(e){if(e){var t=e.getStats();for(var n in t)t.hasOwnProperty(n)&&this.addStats(n,t[n])}},t.prototype.deserialize=function(e){var t=e.Surveys,n=new Date;for(var r in t)if(t.hasOwnProperty(r)){var i=new v;i.deserialize(t[r])&&i.ExpirationTimeUtc>n&&this.addStats(r,i)}return this.validate()},t.prototype.validate=function(){return c.isObject(this.getStats())},t}(u.SurveyStatCollection);t.SurveyStatCollectionActivation=l;var d=function(){function e(){}return e.make=function(e,t){return t?new p(e,t):new g(e)},e}();t.SurveyActivationStatsProviderFactory=d;var p=function(){function e(e,t){if(!t)throw new Error("host-based storage must not be null");this.hostBasedStorage=t,e&&(this.fileBasedStorageProvider=new g(e))}return e.prototype.load=function(){var e=this.getSurveyStatsFromHost(),t=new l;return this.fileBasedStorageProvider&&(t=this.fileBasedStorageProvider.load()),s.MergeAndUpdateSurveyActivationStats(t,e).find(0)},e.prototype.save=function(e){if(e){var t=this.getSurveyStatsFromHost(),n=s.MergeAndUpdateSurveyActivationStats(e,t),r=n.find(1),o=n.find(0);if(r){var a=r.getStats();for(var u in a)if(a.hasOwnProperty(u)){var c=s.makeSettingItemValue(JSON.stringify(a[u]));this.hostBasedStorage.upsertSettingItem(i.FloodgateStorageProviderFileType[i.FloodgateStorageProviderFileType.SurveyActivationStats],u,c)}}this.fileBasedStorageProvider&&this.fileBasedStorageProvider.save(o)}},e.prototype.getSurveyStatsFromHost=function(){var e=new l,t=this.hostBasedStorage.readSettingList(i.FloodgateStorageProviderFileType[i.FloodgateStorageProviderFileType.SurveyActivationStats]),n=new Date;for(var r in t)if(t.hasOwnProperty(r)){var u=s.extractSettingItemValueSubString(t[r]),c=new v;try{var d=JSON.parse(u);c.deserialize(d)}catch(e){a.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.HostBasedSurveyActivationStatsProvider.GetSurveyStatsFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+u})}c.ExpirationTimeUtc<=n?this.hostBasedStorage.deleteSettingItem(i.FloodgateStorageProviderFileType[i.FloodgateStorageProviderFileType.SurveyActivationStats],r):e.addStats(r,c)}return e},e}();t.HostBasedSurveyActivationStatsProvider=p;var g=);t.FileBasedSurveyActivationStatsProvider=g;var v=function(){eturn e.prototype.deserialize=function(e){var t,n;return this.ActivationTimeUtc=e.ActivationTimeUtc,this.ExpirationTimeUtc=e.ExpirationTimeUtc,this.Type=e.Type,this.SurveyLaunchCount=null!==(t=e.SurveyLaunchCount)&&void 0!==t?t:0,this.SurveyLaunchCountPerSession=null!==(n=e.SurveyLaunchCountPerSession)&&void 0!==n?n:0,this.validate()},e.prototype.validate=function(){return!!c.isUtcDatetimeString(this.ActivationTimeUtc)&&(this.ActivationTimeUtc=c.stringToDate(this.ActivationTimeUtc),!!c.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=c.stringToDate(this.ExpirationTimeUtc),!(!c.isNumber(this.SurveyLaunchCount)||!c.isNumber(this.SurveyLaunchCountPerSession))&&c.isEnumValue(this.Type,i.SurveyType)))},e}();t.SurveyActivationStats=v},pUrp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GovernedChannel=void 0;var r=n("7P0z"),i=n("FFSN"),o=function(){function e(e,t,n,o){if(!i.isEnumValue(e,r.GovernedChannelType))throw new Error("type is not a valid GovernedChannelType");if(!t)throw new Error("name must not be null or empty");if(n<0)throw new Error("cooldownSeconds must not be negative");this.type=e,this.name=t,this.cooldownSeconds=n,this.setCooldownStartTime(o)}return e.prototype.setCooldownStartTime=function(e){this.cooldownStartTime=e,this.cooldownEndTime=i.isNOU(this.cooldownStartTime)?i.getDistantPast():i.addSecondsWithoutOverflow(this.cooldownStartTime,this.cooldownSeconds)},e.prototype.isOpen=e.prototype.isOpenAtDate=e.prototype.getType=function(){return this.type},e.prototype.getName=function(){return this.name},e.prototype.getCooldownSeconds=function(){return this.cooldownSeconds},e.prototype.getCooldownStartTime=function(){return this.cooldownStartTime},e.prototype.getCooldownEndTime=function(){return this.cooldownEndTime},e}();t.GovernedChannel=o},pbdH:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignSurveyFactory=void 0;var r=n("7P0z"),i=n("dTWj"),o=n("zluK"),a=n("xrdt"),s=n("dz40"),u=n("jUN1"),c=n("UmvI"),l=n("lkXj"),d=n("Dwqi"),p=n("FFSN"),g=n("jay/"),v=p.dateToShortUtcString,f=p.isNOU,h=function(){function e(){}return e.makeSurvey=function(t,n,r){if(!(t&&n&&n.surveyTemplate&&r))return null;var i=e.makeSurveyDataSourceData(t,n),o=n.surveyTemplate;return o instanceof g.CampaignSurveyTemplateNps5PointStatic?l.default.make5Point(i,r):o instanceof g.CampaignSurveyTemplateNps11PointStatic?l.default.make11Point(i,r):o instanceof g.CampaignSurveyTemplateFps?a.default.makeFps(i,r,o):o instanceof g.CampaignSurveyTemplateNlqs?c.default.makeNlqs(i,r,o):o instanceof g.CampaignSurveyTemplateNps?l.default.makeCustom(i,r,o):o instanceof g.CampaignSurveyTemplateGenericMessagingSurface?s.default.makeCustom(i):o instanceof g.CampaignSurveyTemplateIntercept?u.default.makeIntercept(i,r,o):null},e.makeSurveyDataSourceData=function(t,n){if(!t||!n||!n.surveyTemplate)return null;var i=n.surveyTemplate,o=new d.default.SurveyDataSourceData;return o.activationEvent=e.makeEvent(t,i.activationEvent),o.metadata=e.makeMetadata(i.metadata),o.id=t.LastSurveyId,o.backEndIdentifier=t.CampaignId,o.expirationTimeUtc=v(t.LastSurveyExpirationTimeUtc),o.governedChannelType=n.governedChannelType,o.startTimeUtc=v(t.LastSurveyStartTimeUtc),o.additionalDataRequested=n.additionalDataRequested||[],o.launcherType=n.launcherType||r.LAUNCHER_TYPE_DEFAULT,o.preferredLaunchType=n.surveyTemplate.preferredLaunchType||"Default",o.businessLevel=n.businessLevel,o.tags=n.tags,f(i.maxLaunches)||(o.maxLaunches=i.maxLaunches),f(i.maxLaunchesPerSession)||(o.maxLaunchesPerSession=i.maxLaunchesPerSession),o},e.makeCountedActivityEventData=e.makeCountedActivityEvent=e.makeCountedActivitySequenceEvent=function(t,n){if(!t||!n)return null;var r=new i.CountedActivitySequenceEventData;r.sequence=[];for(var o=0,a=n.sequence;o<a.length;o++){var s=e.makeCountedActivityEventData(a[o]);if(!s)return null;r.sequence.push(s)}return new i.CountedActivitySequenceEvent(r)},e.makeEvent=e.makeMetadata=function(e){if(f(e)||f(e.contentMetadata))return null;var t=new o.Metadata;return t.contentMetadata=e.contentMetadata,new o.SurveyMetadata(t)},e}();t.CampaignSurveyFactory=h},svnR:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));var r="undefined"!=typeof window&&window;function i(){return r}function o(){try{var e="__storage_test__";return i().localStorage.setItem(e,e),i().localStorage.removeItem(e),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&0!==i().localStorage.length}}function a(e,t){if(!e)return t;try{var n=i().localStorage.getItem(e),r=!n||"{"!==n[0]&&"["!==n[0]?n:JSON.parse(n);return null!=r?r:t}catch(e){}return t}function s(e,t){if(e&&t)try{var n="string"==typeof t?t:JSON.stringify(t);i().localStorage.setItem(e,n)}catch(e){}}},tOIY:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"m",(function(){return v})),n.d(t,"n",(function(){return f})),n.d(t,"o",(function(){return h})),n.d(t,"r",(function(){return m})),n.d(t,"q",(function(){return y})),n.d(t,"p",(function(){return S})),n.d(t,"g",(function(){return C}));var r=144e5,i=144e5,o=144e5,a=144e5,s=144e5,u=864e5,c="campaignmetadataaggregator",l="https://messaging.engagement.office.com/",d="https://messaging.engagement.office.com/",p=3e3,g=5e3,v="setcampaignaction",f="https://messaging.action.office.com/",h="https://messaging.action.office.com/",m="https://substrate.office.com/OfficePersonalizationUserLifecycle/api/facts",y=3e3,S=864e5,C=)},tc4T:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MergeAndUpdateSurveyActivationStats=t.MergeAndUpdateCampaignStates=t.MergeAndUpdateGovernedChannelStates=t.makeSettingItemValue=t.extractSettingItemValueSubString=t.ItemCollection=void 0;var r=n("nIJ3"),i=);t.ItemCollection=i,t.extractSettingItemValueSubString=function(e){if(!e)return e;var t=e.indexOf(o)+o.length,n=e.indexOf(a);return t<0||n<0?e:e.substring(t,n)},t.makeSettingItemValue=function(e){return e?o+e+a:o+a},t.MergeAndUpdateGovernedChannelStates=function(e,t){var n=new i;if(!e&&!t)return n;if(!e)return n.add(0,t),n;if(!t)return n.add(0,e),n.add(1,e),n;var r=[],o=[];return e&&e.forEach((function(e){for(var n,i=-1,a=0;a<t.length;a++)if((n=t[a]).getType()===e.getType()){i=a;break}if(-1===i)return r.push(e),void o.push(e);e.getCooldownStartTime()>n.getCooldownStartTime()?(r.push(e),o.push(e)):r.push(n),t.splice(i,1)})),t&&t.forEach((function(e){r.push(e)})),n.add(0,r),o.length>0&&n.add(1,o),n},t.MergeAndUpdateCampaignStates=function(e,t){var n=new i;if(!e&&!t)return n;if(!e)return n.add(0,t),n;if(!t)return n.add(0,e),n.add(1,e),n;var r=[],o=[];return e&&e.forEach((function(e){for(var n,i=new Date,a=-1,s=0;s<t.length;s++)if((n=t[s]).CampaignId===e.CampaignId){a=s;break}return-1===a?(r.push(e),void o.push(e)):n.LastCooldownEndTimeUtc>i?(r.push(n),void t.splice(a,1)):e.LastCooldownEndTimeUtc>i?(r.push(e),o.push(e),void t.splice(a,1)):(e.getCooldownStartDate()>n.getCooldownStartDate()||e.getCooldownStartDate()===n.getCooldownStartDate()&&e.LastNominationTimeUtc>n.LastNominationTimeUtc?(r.push(e),o.push(e)):r.push(n),void t.splice(a,1))})),t&&t.forEach((function(e){r.push(e)})),n.add(0,r),o.length>0&&n.add(1,o),n},t.MergeAndUpdateSurveyActivationStats=function(e,t){var n=new i;if(!e&&!t)return n;if(!e)return n.add(0,t),n;if(!t)return n.add(0,e),n.add(1,e),n;var o=new r.SurveyStatCollectionActivation,a=new r.SurveyStatCollectionActivation,s=e.getStats(),u=t.getStats();for(var c in s)if(s.hasOwnProperty(c)){var l=u[c];if(!l){o.addStats(c,s[c]),a.addStats(c,s[c]);continue}s[c].ActivationTimeUtc>l.ActivationTimeUtc?(o.addStats(c,s[c]),a.addStats(c,s[c])):o.addStats(c,u[c]),delete u[c]}for(var c in u)u.hasOwnProperty(c)&&o.addStats(c,u[c]);n.add(0,o);var d=a.getStats();for(var p in d)if(d.hasOwnProperty(p)){n.add(1,a);break}return n};var o="<data>",a="</data>"},vVCL:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("FFSN"),i=n("kZ16"),o=(n("Igas"),n("QjXU")),a=(n("Rvco"),n("NIYO")),s=n("tOIY"),u=a.f,c=function(){eturn e.prototype.sendGetRequest=function(e,t,n,r){return Object(o.__awaiter)(this,void 0,void 0,(function(){var i;return Object(o.__generator)(this,(function(o){return i={method:"GET",headers:this.createHeaders(t)},[2,n?this.timeoutFetch(e,i,null!=r?r:s.l):fetch(e,i)]}))}))},e.prototype.sendPostRequest=function(e,t,n,r,i,a){return Object(o.__awaiter)(this,void 0,void 0,(function(){var u;return Object(o.__generator)(this,(function(o){return u={method:"POST",headers:this.createHeaders(n,r),body:t},[2,i?this.timeoutFetch(e,u,null!=a?a:s.l):fetch(e,u)]}))}))},e.prototype.createHeaders=function(e,t){var n="undefined"!=typeof Headers&&new Headers;if(n){if(u(e)||n.append("Authorization","Bearer "+e),!u(t))for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.append(r,t[r]);n.append("X-CorrelationId",a.c()),this.sessionId&&n.append("X-UserSessionId",this.sessionId)}return n},e.prototype.timeoutFetch=function(e,t,n){return void 0===t&&(t={}),new Promise((function(r,i){fetch(e,t).then(r,i),setTimeout((,n)}))},e}();class l extends c{constructor(e){super(),this.simpleRequestEnabled=!1,this.simpleRequestEnabled=null!=e&&e}postRequestWithRetry(e,t,n,r){const o=this;return new Promise((function(a,s){o.sendPostRequest(e,t,void 0,void 0,!0,r).then(a).catch((function(u){if(i.b().logEvent(i.a.DYNAMICTRANSPORT_POST_ERROR,2,{ErrorMessage:u.toString(),TimeMilliseconds:r,Count:n,CorrelationId:o.requestId}),n<=1)return s(u);o.postRequestWithRetry(e,t,n-1,r).then(a).catch(s)}))}))}createHeaders(e){const t="undefined"!=typeof Headers&&new Headers;return t&&(this.simpleRequestEnabled?this.createSimpleHeaders(t):this.createNormalHeaders(t),Object(r.isNOU)(e)||t.append("Authorization","Bearer "+e)),t}createNormalHeaders(e){this.requestId=Object(r.guid)(),e.append("X-Request-ID",this.requestId),e.append("Content-Type","application/json")}},wSjW:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("7P0z"),i=n("HPVw"),o=n("kZ16");const a={[r.FloodgateStorageProviderFileType.CampaignDefinitions]:"obf-CampaignDefinitions",[r.FloodgateStorageProviderFileType.CampaignStates]:"obf-CampaignStates",[r.FloodgateStorageProviderFileType.FloodgateSettings]:"obf-FloodgateSettings",[r.FloodgateStorageProviderFileType.GovernedChannelStates]:"obf-GovernedChannelStates",[r.FloodgateStorageProviderFileType.SurveyActivationStats]:"obf-SurveyActivationStats",[r.FloodgateStorageProviderFileType.SurveyEventActivityStats]:"obf-SurveyEventActivityStats",[r.FloodgateStorageProviderFileType.TmsCache_CampaignContent]:"obf-TmsCampaignContent",[r.FloodgateStorageProviderFileType.TmsCache_MessageMetadata]:"obf-TmsMessageMetadata",[r.FloodgateStorageProviderFileType.TmsCache_UserGovernance]:"obf-TmsUserGovernance",[r.FloodgateStorageProviderFileType.Tms_DynamicSettings]:"obf-TmsDynamicSettings",[r.FloodgateStorageProviderFileType.LogLevelSettings]:"obf-LogLevelSettings",[r.FloodgateStorageProviderFileType.UserFacts]:"obf-UserFacts",[r.FloodgateStorageProviderFileType.DebugOverrides]:"obf-DebugOverrides",[r.FloodgateStorageProviderFileType.DynamicCampaignDefinitions]:"obf-DynamicCampaignDefinitions"};class s{static isStorageAvailabletatic safeReadObject(e,t){if(!(e in r.FloodgateStorageProviderFileType))return t;try{let n=a[e];const r=i.b().localStorage.getItem(n),o=!r||"{"!==r[0]&&"["!==r[0]?r:JSON.parse(r);return null!=o?o:t}catch(e){}return t}fileLock(e){}ead(e){if(!(e in r.FloodgateStorageProviderFileType))return"";let t,n=a[e];try{t=i.b().localStorage.getItem(n)}catch(e){return o.b().logEvent(o.a.SURVEY_FLOODGATE_FILEREAD_FAILED,2,{ErrorMessage:e.toString(),FileName:n}),""}return t}write(e,t){if(!(e in r.FloodgateStorageProviderFileType))return;let n=a[e];try{i.b().localStorage.setItem(n,t)}catch(e){return void o.b().logEvent(o.a.SURVEY_FLOODGATE_FILEWRITE_FAILED,2,{ErrorMessage:e.toString(),FileName:n})}}}},xYJg:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("7P0z"),i=n("ZeN8");class o{constructor(e){if(this.showPrompt=!0,this.showEmailRequest=!1,!e)throw Error("survey must not be null");if(this.survey=e,e.getType()===r.Api.SurveyType.Intercept){this.isIntercept=!0;let t=e.getComponent("Intercept");if(!t)throw Error("intercept component must not be null");this.intercept=t}else{this.isIntercept=!1;let t=e.getComponent("Prompt"),n=e.getComponent("Comment"),r=e.getComponent("Rating"),o=e.getComponent("CVSurvey");if(!t)throw Error("prompt component must not be null");if(this.prompt=t,this.showEmailRequest=e.getSurveyInfo().isAdditionalDataRequested(0),!n)throw Error("comment component must not be null");if(this.comment=n,!r)throw Error("rating component must not be null");if(this.rating=r,o&&(this.cvSurvey=o,this.getLauncherType()===i.e&&!this.getCVSurveyFormId()))throw Error("CvSurveyId should not be null")}}getLauncherType(){return this.isIntercept?void 0:this.survey.getLauncherType()}getCVSurveyFormId(){return this.isIntercept?void 0:this.cvSurvey.getFormId()}getPreGeneratedClientFeedbackId(){return this.survey.getPreGeneratedClientFeedbackId()}getPromptQuestion(){return this.isIntercept?void 0:this.prompt.getQuestion()}getTitle(){return this.isIntercept?void 0:this.prompt.getTitle()}getPromptYesButtonText(){return this.isIntercept?void 0:this.prompt.getYesButtonText()}getPromptNoButtonText(){return this.isIntercept?void 0:this.prompt.getNoButtonText()}getRatingValuesAscending(){return this.isIntercept?void 0:this.rating.getRatingValuesAscending()}getRatingQuestion(){return this.isIntercept?void 0:this.rating.getQuestion()}getCommentQuestion(){return this.isIntercept?void 0:this.comment.getQuestion()}getInterceptTitle(){return this.isIntercept?this.intercept.getTitle():void 0}getInterceptQuestion(){return this.isIntercept?this.intercept.getQuestion():void 0}etValues(e,t){this.isIntercept||(this.rating.setSelectedRatingIndex(e),this.comment.setSubmittedText(t))}getJsonElements(){return this.survey.getJsonElements()}etCampaignId(){return this.survey.getSurveyInfo().getBackEndId()}getId(){return this.survey.getSurveyInfo().getId()}},xrdt:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n("7P0z"),o=n("Z+rh"),a=n("ziXt"),s=n("iopB"),u=n("Kx/u"),c=n("iW5C"),l=n("FFSN"),d=n("8+ih"),p=n("Dwqi"),g=l.isNOU,v=function(e){function t(t){var n=e.call(this)||this;if(g(t))throw new Error("data must not be null");return n.surveyInfo=new p.default(t.baseData),n.prompt=new u.default(t.promptData),n.question=t.commentData?new o.default(t.commentData):null,n.rating=t.ratingData?new c.default(t.ratingData):null,n.multipleChoice=t.multipleChoiceData?new s.default(t.multipleChoiceData):null,n.cvSurvey=t.cvSurveyData?new a.default(t.cvSurveyData):null,n}return r(t,e),t.make=function(e){try{return new t(e)}catch(e){return null}},t.makeFps=function(e,n,r){if(g(e)||g(n)||g(r))return null;var i=[],l=[],d=r.content;if(g(d)||g(d.prompt)||g(d.rating)&&g(d.multipleChoice)&&g(d.comment))return null;var p=new t.FpsSurveyData;if(p.baseData=e,p.promptData=new u.default.PromptComponentData,p.promptData.title=n.getCustomString(d.prompt.title),p.promptData.question=n.getCustomString(d.prompt.question),p.promptData.yesButtonLabel=n.getCustomString(d.prompt.yesLabel),p.promptData.noButtonLabel=n.getCustomString(d.prompt.noLabel),g(p.promptData.title)||g(p.promptData.question)||g(p.promptData.yesButtonLabel)||g(p.promptData.noButtonLabel))return null;if(d.rating){p.ratingData=new c.default.RatingComponentData,p.ratingData.question=n.getCustomString(d.rating.question),p.ratingData.isZeroBased=d.rating.isZeroBased;for(var v=0,f=d.rating.ratingValuesAscending;v<f.length;v++){var h=n.getCustomString(f[v]);if(g(h))return null;i.push(h)}if(p.ratingData.ratingValuesAscending=i,g(p.ratingData.question)||g(p.ratingData.ratingValuesAscending))return null}if(d.multipleChoice){p.multipleChoiceData=new s.default.MultipleChoiceComponentData,p.multipleChoiceData.question=n.getCustomString(d.multipleChoice.question),p.multipleChoiceData.minNumberOfSelectedOptions=d.multipleChoice.minNumberOfSelectedOptions,p.multipleChoiceData.maxNumberOfSelectedOptions=d.multipleChoice.maxNumberOfSelectedOptions;for(var m=0,y=d.multipleChoice.availableOptions;m<y.length;m++){if(h=n.getCustomString(y[m]),g(h))return null;l.push(h)}if(p.multipleChoiceData.availableOptions=l,g(p.multipleChoiceData.question)||g(p.multipleChoiceData.availableOptions))return null}return d.comment&&(p.commentData=new o.default.CommentComponentData,p.commentData.question=n.getCustomString(d.comment.question),g(p.commentData.question))||d.cvSurvey&&(p.cvSurveyData=new a.default.CVSurveyComponentData,p.cvSurveyData.customerVoiceFormId=d.cvSurvey.customerVoiceFormId,g(p.cvSurveyData.customerVoiceFormId))?null:this.make(p)},t.prototype.getType=function(){return i.SurveyType.Fps},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getMultipleChoiceComponent=function(){return this.multipleChoice},t.prototype.getCVSurveyComponent=function(){return this.cvSurvey},t.prototype.getTags=function(){return this.surveyInfo.getTags()},t.prototype.getComponent=function(e){switch(e){case"Comment":return this.getCommentComponent();case"Prompt":return this.getPromptComponent();case"Rating":return this.getRatingComponent();case"MultipleChoice":return this.getMultipleChoiceComponent();case"CVSurvey":return this.getCVSurveyComponent();default:return null}},t.prototype.getDomElements=function(e){if(g(e))throw new Error("Document must not be null");var t=e.createElement(i.DOM_FPS_TAGNAME);return this.getSurveyInfo().getDomElements(e).forEach((function(e){g(e)||t.appendChild(e)})),this.getCommentComponent().getDomElements(e).forEach((function(e){g(e)||t.appendChild(e)})),this.getRatingComponent()&&this.getRatingComponent().getDomElements(e).forEach((function(e){g(e)||t.appendChild(e)})),this.getMultipleChoiceComponent()&&this.getMultipleChoiceComponent().getDomElements(e).forEach((function(e){g(e)||t.appendChild(e)})),[t]},t.prototype.getJsonElements=function(){var e,t={};return(t=l.overrideValues(this.getSurveyInfo().getJsonElements(),t))[i.JSON_APPLICATION_KEYNAME]={},t[i.JSON_APPLICATION_KEYNAME][i.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify(((e={})[i.JSON_SURVEYSTRINGS_KEYNAME]=this.makeSurveyStrings(),e[i.JSON_SURVEYSPECIFICDATA_KEYNAME]=this.makeResponseString(),e)),t},t.prototype.makeResponseString=t.prototype.makeSurveyStrings=function(){var e={};return this.prompt&&(e[i.JSON_PROMPT_KEYNAME]=this.prompt.getComponentJson()),this.rating&&(e[i.JSON_RATING_KEYNAME]=[this.rating.getComponentJson()]),this.question&&(e[i.JSON_COMMENT_KEYNAME]=[this.question.getComponentJson()]),this.multipleChoice&&(e[i.JSON_MULTIPLECHOICE_KEYNAME]=[this.multipleChoice.getComponentJson()]),JSON.stringify(e)},t}(d.Survey);!function(e){var t=function(){return function(){}}();e.FpsSurveyData=t}(v||(v={})),t.default=v},yOOe:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileBasedGovernedChannelStateProvider=t.HostBasedGovernedChannelStateProvider=t.GovernedChannelStateProviderFactory=t.GovernedChannelState=void 0;var r=n("7P0z"),i=n("DX5p"),o=n("iv/W"),a=n("tc4T"),s=n("FFSN"),u=);t.GovernedChannelState=u;var c=);t.GovernedChannelStateProviderFactory=c;var l=function(){return function(){}}(),d=function(){eturn e.prototype.load=function(){var e,t=this.getStatesFromHost();return this.fileBasedStateProvider&&(e=this.fileBasedStateProvider.load()),a.MergeAndUpdateGovernedChannelStates(e,t).find(0)},e.prototype.save=function(e){var t=this;if(e){var n=this.getStatesFromHost(),i=a.MergeAndUpdateGovernedChannelStates(e,n),o=i.find(1),s=i.find(0);o&&o.forEach((function(e){var n=a.makeSettingItemValue(JSON.stringify(e));t.hostBasedStorage.upsertSettingItem(r.FloodgateStorageProviderFileType[r.FloodgateStorageProviderFileType.GovernedChannelStates],String(e.getType()),n)})),this.fileBasedStateProvider&&this.fileBasedStateProvider.save(s)}},e.prototype.getStatesFromHost=function(){var e=[],t=this.hostBasedStorage.readSettingList(r.FloodgateStorageProviderFileType[r.FloodgateStorageProviderFileType.GovernedChannelStates]);for(var n in t)if(t.hasOwnProperty(n)){var s=a.extractSettingItemValueSubString(t[n]),c={};try{c=JSON.parse(s);var l=u.deserialize(c);l&&e.push(l)}catch(e){o.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.HostBasedGovernedChannelStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+s})}}return e},e}();t.HostBasedGovernedChannelStateProvider=d;var p=function(){eturn e.prototype.load=function(){var e,t=this.storage.read(r.FloodgateStorageProviderFileType.GovernedChannelStates);if(!t)return[];try{e=JSON.parse(t);var n=[];return e&&e.ChannelStates&&e.ChannelStates.forEach((),n}catch(e){return o.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.FileBasedGovernedChannelStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+t}),[]}},e.prototype.save=e}();t.FileBasedGovernedChannelStateProvider=p},ziXt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7P0z"),i=function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.customerVoiceFormId)throw new Error("data.formID must not be null or empty");this.data=e}return e.make=function(t){try{return new e(t)}catch(e){return null}},e.prototype.getType=function(){return"CVSurvey"},e.prototype.getFormId=function(){return this.data.customerVoiceFormId},e.prototype.getDomElements=function(e){if(!e)throw new Error("Document must not be null");return[e.createElement(r.DOM_CVSURVEY_TAGNAME)]},e.prototype.getJsonElements=e.prototype.getComponentJson=function(){var e;return(e={})[r.JSON_CVSURVEYFORMID_KEYNAME]=this.getFormId(),e},e}();!function(e){var t=function(){return function(){}}();e.CVSurveyComponentData=t}(i||(i={})),t.default=i},zluK:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=t.SurveyMetadata=void 0;var r=n("FFSN"),i=);t.SurveyMetadata=i;var o=function(){return function(){}}();t.Metadata=o}}]);
//# sourceMappingURL=67.04aa1a89c62ccf8f3abd.chunk.v7.js.map