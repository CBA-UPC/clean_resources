"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[9439,3111],{71654:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Be});var s=n(50959),a=n(10226),r=n(85648),l=(n(86277),n(15994)),i=n(13220),c=n(18202),o=n(44926),u=n(43421),d=n(55895),g=n(17676),h=n(11527);const f=()=>{const e=(0,a.W6)(g.jHc,{loadingValue:!1}),{playbackHandleType:t,setPlaybackHandleType:n}=(0,i.l)();return e?(0,h.jsxs)(c.Z,{filterMatchQuery:"Playback handle",children:[(0,h.jsx)(o.M,{children:(0,h.jsx)(u.D,{htmlFor:"",children:"Custom playback handle"})}),(0,h.jsx)(d.m,{children:(0,h.jsx)(l.v,{id:"desktop.settings.playbackHandle",value:t,onSelect:e=>{n(e)},children:Object.values(i.L).map((e=>(0,h.jsx)("option",{value:e,children:e},e)))})})]}):null};n(46758),n(53321);var p=n(82187),x=n.n(p),m=n(15850),y=n(65432),j=n(99802);const b={section:"c6TyNYOUJRIsjYZJZofy",hidden:"V4Bh2Ch7KvYUdn2s9ZdX"};function v(e){let{children:t,filterMatchQuery:n}=e;const{filter:a}=(0,s.useContext)(y.fo),{setSectionMatch:r,sectionContainsMatch:l}=(0,m.c)(),i=(0,j.M)(a,n);(0,s.useEffect)((()=>{r(i)}),[i,r]);const c=!i&&!l;return(0,h.jsx)("div",{className:x()(b.section,{[b.hidden]:c}),children:t})}function w(e){return(0,h.jsx)(m.k,{children:(0,h.jsx)(v,{...e})})}var k=n(69736),M=n(4901);function C(e){let{children:t,className:n,semanticColor:a="textBase"}=e;const{filter:r}=(0,s.useContext)(y.fo);return(0,h.jsx)(k.x,{as:"h2",variant:"bodyMediumBold",semanticColor:a,className:n,children:(0,h.jsx)(M.o,{searchWords:[r],textToHighlight:t})})}var R=n(36879),S=n(40945);let E=function(e){return e.LIBRARY_COMPACT_MODE="library-compact-mode",e.NOW_PLAYING_VIEW="now-playing-view",e}({});var q=n(75630);const L=e=>{const{spec:t,logger:n}=(0,q.S)();return(0,s.useCallback)((s=>{s?n.logInteraction(t.settingsRowFactory({identifier:e}).hitSettingEnable()):n.logInteraction(t.settingsRowFactory({identifier:e}).hitSettingDisable())}),[e,n,t])},F=()=>{const[e,t]=(0,S.R)(),n=L(E.NOW_PLAYING_VIEW),a=(0,s.useCallback)((e=>{n(e),t(e)}),[t,n]);return(0,h.jsxs)(c.Z,{filterMatchQuery:r.ag.get("settings.npv"),children:[(0,h.jsx)(o.M,{children:(0,h.jsx)(u.D,{htmlFor:"settings.npv",children:r.ag.get("settings.npv")})}),(0,h.jsx)(d.m,{children:(0,h.jsx)(R.Z,{id:"settings.npv",value:e,onSelected:a})})]})},N=()=>(0,h.jsxs)(w,{filterMatchQuery:r.ag.get("settings.display"),children:[(0,h.jsx)(C,{children:r.ag.get("settings.display")}),(0,h.jsx)(F,{}),(0,h.jsx)(f,{})]});var z=n(52438);const A="sp_locale";var D=n(51450),Q=n(25440),P=n(84729);const W=()=>{const e=(0,s.useRef)(r.ag.getLocaleForTranslation()),[t,n]=(0,s.useState)(e.current);return(0,h.jsxs)(w,{filterMatchQuery:r.ag.get("desktop.settings.language"),children:[(0,h.jsx)(C,{children:r.ag.get("desktop.settings.language")}),(0,h.jsxs)(c.Z,{filterMatchQuery:r.ag.get("desktop.settings.selectLanguage"),children:[(0,h.jsx)(o.M,{children:(0,h.jsx)(u.D,{htmlFor:"desktop.settings.selectLanguage",children:r.ag.get("desktop.settings.selectLanguage")})}),(0,h.jsx)(d.m,{children:(0,h.jsxs)(l.v,{dir:"auto",value:t,id:"desktop.settings.selectLanguage",onSelect:e=>{if("system-language"===e)return n(e),void(0,D.kT)(A,document,(0,P.J)("open.spotify.com"));n(e),(0,D.pC)({name:A,value:e,domain:(0,P.J)("open.spotify.com"),days:365})},children:[(0,D.vQ)(A)&&(0,h.jsx)("option",{value:"system-language",children:`System Default Language (${r.ag.get("web.settings.systemDefaultLanguage")})`}),Q.ge.map((e=>(0,h.jsx)("option",{value:e,children:`${Q.k1[e].displayName} (${Q.k1[e].displayNameEn})`},e)))]})}),e.current!==t&&(0,h.jsx)("div",{children:(0,h.jsx)(z.P,{onClick:()=>{window.location.reload()},children:r.ag.get("error.reload")})})]})]})};var T=n(47895),Z=n(43461),H=n(12898);function O(){const e=(0,Z.f)(),[t,n]=(0,s.useState)(!1),a=(0,s.useCallback)((t=>{e.setEnabledState(t)}),[e]);return(0,s.useEffect)((()=>e.subscribeToEnabledState(n)),[e]),[t,a]}function U(){const e=(0,Z.f)(),[t,n]=(0,s.useState)(e.getPreset()),a=(0,s.useCallback)((t=>{e.setPreset(t)}),[e]);return(0,s.useEffect)((()=>e.subscribeToPresetChange((e=>{n(e)})))),[t,a]}n(45205);var I=n(49857);function V(e){return`${e>0?`+${e}`:e}dB`}const B={wrapper:"HGN6qJ4noxOV2YSJWj3g",preset:"PumO62RLWafcexCJx0oe",filters:"aOnWJeLmOj8plFB5QPSt",filter:"zrn877LGjVA_oYp2IKeu",input:"KGnDzV9IPjGQ8Ude8Cgl",label:"NWmefh0djDBBQmHr_mdf",gainLabel:"L9sAZBDUVTnJLn7TqR1E",gainLabelUp:"YKGOZh1y8HVOqQgbJB9F",gainLabelDown:"aPIPHZU8F7TMi6LEw_Yq",canvas:"gv7Rcc2ouDRSd0pto7Df"};function _(e){let{filter:t,onChange:n}=e;const a=(0,Z.f)(),l=(0,s.useRef)(null),[i]=U();(0,s.useEffect)((()=>{const e=i.filters.find((e=>e.key===t.key));l.current&&e&&(l.current.value=`${e.gain}`)}),[i,t.key]),(0,s.useEffect)((()=>{l.current&&l.current.setAttribute("aria-valuetext",r.ag.get("equalizer.filterA11yValueText",t.gain))}),[]);const c=(0,I.y1)(((e,t)=>{a.setFilterGain(e,t)}),100,{maxWait:200});return(0,h.jsxs)("div",{className:B.filter,children:[(0,h.jsx)("input",{"aria-label":r.ag.get("equalizer.filterLabel",t.frequency),ref:l,type:"range",min:-H.l5,max:H.l5,step:.1,defaultValue:t.gain,className:B.input,onChange:e=>{const s=parseFloat(e.target.value);e.target.setAttribute("aria-valuetext",r.ag.get("equalizer.filterA11yValueText",s)),c(t.key,s),n(s)}}),(0,h.jsx)("label",{className:B.label,children:(o=t.frequency,o>=1e3?o/1e3+"KHz":`${o}Hz`)})]});var o}const G=()=>{const[e,t]=(0,s.useState)(window.devicePixelRatio||1);return(0,s.useEffect)((()=>{const e=()=>{matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`).addEventListener("change",(()=>{t(window.devicePixelRatio),e()}),{once:!0})};e()}),[]),e};var J=n(76981);n(28593);function K(e,t){e.moveTo(t[0],t[1]);for(let n=2;n<t.length-1;n+=2)e.lineTo(t[n],t[n+1])}n(58465),n(2836);function Y(e){const t=.6,n=[],s=e.reduce(((e,t)=>(e.push(t.x),e.push(t.y),e)),[]);s.unshift(e[0].y),s.unshift(e[0].x),s.push(e[e.length-1].x),s.push(e[e.length-1].y);for(let a=2;a<s.length-4;a+=2)for(let e=0;e<=16;e++){const r=(s[a+2]-s[a-2])*t,l=(s[a+4]-s[a])*t,i=(s[a+3]-s[a-1])*t,c=(s[a+5]-s[a+1])*t,o=e/16,u=2*Math.pow(o,3)-3*Math.pow(o,2)+1,d=-2*Math.pow(o,3)+3*Math.pow(o,2),g=Math.pow(o,3)-2*Math.pow(o,2)+o,h=Math.pow(o,3)-Math.pow(o,2),f=u*s[a]+d*s[a+2]+g*r+h*l,p=u*s[a+1]+d*s[a+3]+g*i+h*c;n.push(f),n.push(p)}return n}n(27082);var $=n(39505);function X(e,t){const n=e.getContext("2d");n&&(n.clearRect(0,0,e.clientWidth,e.clientHeight),function(e,t,n){const s=t.clientWidth,a=t.clientHeight,r=s/n.length/2;e.beginPath();const l=e.createLinearGradient(s/2,0,s/2,a);l.addColorStop(0,"rgba(11%, 73%, 33%, 100%)"),l.addColorStop(1,"rgba(11%, 73%, 33%, 0%)"),e.fillStyle=l,K(e,Y(n)),e.lineTo(s-r,a),e.lineTo(r,a),e.fill()}(n,e,t),function(e,t){e.beginPath(),e.strokeStyle="rgb(11%, 73%, 33%)",e.lineWidth=4,K(e,Y(t)),e.stroke()}(n,t),function(e,t){e.fillStyle=$.ixZ,t.forEach((t=>{e.beginPath(),e.arc(t.x,t.y,4,0,2*Math.PI),e.fill()}))}(n,t))}const ee=60,te=300;function ne(e,t){const n=t.clientWidth/e.length;return e.map(((e,s)=>({x:s*n+n/2,y:t.clientHeight-(e+H.l5+3)/(2*H.l5+6)*t.clientHeight})))}function se(e){const t=(0,s.useRef)(null),n=G(),a=(0,s.useCallback)((()=>{var e;if(!t.current)return;const s=n,a=t.current.getBoundingClientRect();t.current.width=a.width*s,t.current.height=a.height*s,null===(e=t.current.getContext("2d"))||void 0===e||e.scale(s,s)}),[n]),r=(0,s.useCallback)((()=>{if(!t.current||!e.current)return;const n=ne(e.current,t.current);X(t.current,n)}),[e]),l=(0,s.useCallback)((n=>{if(!t.current||!e.current)return;const s=ne(e.current,t.current),a=ne(n,t.current);!function(e,t,n){const s=ee*(te/1e3);let a=0;const r=JSON.parse(JSON.stringify(t)),l=n.map(((e,n)=>e.y-t[n].y)),i=()=>{if(!(a>=s)){for(let e=0;e<r.length;e++){const i=t[e].y,u=l[e];r[e].y=(n=i,c=u,o=a,(o/=s/2)<1?c/2*Math.pow(o,3)+n:(o-=2,c/2*(Math.pow(o,3)+2)+n))}var n,c,o;X(e,r),a++,window.requestAnimationFrame(i)}};window.requestAnimationFrame(i)}(t.current,s,a)}),[e]);return(0,s.useEffect)((()=>{a(),r()}),[a,r]),(0,J.y)({refOrElement:t,onResize:()=>{a(),r()}}),{canvasRef:t,drawCanvas:r,animateCanvas:l}}function ae(){const[e,t]=O(),[n,a]=U(),l=(0,s.useRef)(n.filters.map((e=>e.gain))),{canvasRef:i,drawCanvas:c,animateCanvas:o}=se(l);return(0,s.useEffect)((()=>{const e=n.filters.map((e=>e.gain));"custom"!==n.key&&o(e),l.current=e}),[n,o]),(0,h.jsxs)("div",{className:B.wrapper,children:[(0,h.jsx)("canvas",{"aria-label":r.ag.get("equalizer.equalizer"),role:"img",className:B.canvas,ref:i}),(0,h.jsx)("label",{className:x()(B.gainLabel,B.gainLabelUp),children:V(H.l5)}),(0,h.jsx)("label",{className:x()(B.gainLabel,B.gainLabelDown),children:V(-H.l5)}),(0,h.jsx)("div",{className:B.filters,dir:"ltr",children:n.filters.map(((n,s)=>(0,h.jsx)(_,{filter:n,onChange:n=>{l.current[s]=n,c(),e||t(!0),a((0,H.f8)(l.current))}},n.key)))})]})}const re={container:"j7cPtD65ArW8eWnGNrUo",label:"ZzNb8P1Bz1VHtlhimIWM"};function le(){const[e,t]=O(),[n,s]=U();return(0,h.jsxs)("div",{className:re.container,children:[(0,h.jsx)(k.x,{as:"label",variant:"bodySmall",semanticColor:"textSubdued",htmlFor:"desktop.equalizer.preset",className:re.label,children:r.ag.get("equalizer.presets")}),(0,h.jsxs)(l.v,{id:"desktop.equalizer.preset",value:n.key,onSelect:n=>{s(n),e||t(!0)},children:["custom"===n.key&&(0,h.jsx)("option",{value:n.key,children:n.displayName}),Object.entries(H.PG).map((e=>{let[t,n]=e;return(0,h.jsx)("option",{value:t,children:n.displayName},t)}))]})]})}function ie(){const[e,t]=O(),[,n]=U();return(0,h.jsx)(z.P,{onClick:()=>{n(H.PG.flat.key),e||t(!0)},size:"small",children:r.ag.get("equalizer.reset")})}function ce(){const[e,t]=O();return(0,h.jsxs)(c.Z,{filterMatchQuery:r.ag.get("equalizer.equalizer"),children:[(0,h.jsx)(o.M,{children:(0,h.jsx)(u.D,{htmlFor:"settings.equalizer",children:r.ag.get("equalizer.equalizer")})}),(0,h.jsx)(d.m,{children:(0,h.jsx)(R.Z,{id:"settings.equalizer",value:e,onSelected:t})})]})}const oe={equalizerSection:"xK6HEWejcSHKyWfhNiJc",equalizerWrapper:"FulR95cAh4QPdw6wUeRw",equalizerResetButtonWrapper:"PiFWoUIRceOm8SHTCakS"};function ue(){const e=(0,Z.f)();return(0,a.W6)(T.Ro,{loadingValue:!1})&&e.isSupported()?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(ce,{}),(0,h.jsx)(c.Z,{filterMatchQuery:r.ag.get("equalizer.equalizer"),children:(0,h.jsxs)("div",{className:oe.equalizerSection,children:[(0,h.jsx)(le,{}),(0,h.jsx)("div",{className:oe.equalizerWrapper,children:(0,h.jsx)(ae,{})}),(0,h.jsx)("div",{className:oe.equalizerResetButtonWrapper,children:(0,h.jsx)(ie,{})})]})})]}):null}function de(){return(0,a.W6)(T.Ro,{loadingValue:!1})?(0,h.jsxs)(w,{filterMatchQuery:r.ag.get("desktop.settings.playback"),children:[(0,h.jsx)(C,{children:r.ag.get("desktop.settings.playback")}),(0,h.jsx)(ue,{})]}):null}var ge=n(59047),he=n(73247),fe=n(29132),pe=n(13188),xe=n(51292),me=n(24676),ye=n(87350),je=n(19039);const be=()=>{const[e,t]=(()=>{const e=(0,ge.NL)(),{user:t}=(0,fe.v9)(ye.Gg),n=(null==t?void 0:t.uri)??"",{enqueueSnackbar:a}=(0,je.D)(),{data:l,queryKey:i}=(0,me.J)(xe.kk,[{uri:n}]),c=(0,s.useCallback)((async e=>{let{showFollows:t}=e;await(0,xe.zK)(pe.b.getInstance(),{uri:n,showFollows:t})}),[n]),o=(0,he.D)({mutationFn:c,onMutate:async t=>{await e.cancelQueries({queryKey:i});const n=e.getQueryData(i);return e.setQueryData(i,t),{prevState:n,newState:t}},onError:(t,n,s)=>{e.setQueryData(i,null==s?void 0:s.prevState),a(r.ag.get("error.generic"))},onSettled:()=>{e.invalidateQueries({queryKey:i})}});return[(null==l?void 0:l.showFollows)??!0,o.mutate]})();return(0,h.jsxs)(c.Z,{filterMatchQuery:r.ag.get("desktop.settings.showFollows"),children:[(0,h.jsx)(o.M,{children:(0,h.jsx)(u.D,{htmlFor:"desktop.settings.showFollows",children:r.ag.get("desktop.settings.showFollows")})}),(0,h.jsx)(d.m,{children:(0,h.jsx)(R.Z,{id:"desktop.settings.showFollows",value:e,onSelected:e=>t({showFollows:e})})})]})},ve=()=>(0,a.W6)(g.AJT,{loadingValue:!1})?(0,h.jsxs)(w,{filterMatchQuery:r.ag.get("desktop.settings.social"),children:[(0,h.jsx)(C,{children:r.ag.get("desktop.settings.social")}),(0,h.jsx)(be,{})]}):null;n(70054);var we=n(1469),ke=n(24241),Me=n(60444),Ce=n(16941),Re=n(9443),Se=n(10628),Ee=n(24071);const qe=new(n(23120).o)("changeAttributes","mutation","ac50e9d82b3b8303c73512f297140e774a69eb0d6250769b5669e69b4be28886",null);n(85618);const Le=["personalizedRecommendations"],Fe=()=>{const{getGraphQLLoader:e}=(0,Ee.tc)(),t=e(),n=(0,ge.NL)(),a=(0,ke.o)(),r=(0,fe.I0)(),l=!(0,Re.k)(),i="1"===(0,Ce.m)("dsa-mode-enabled"),c="1"===(0,Ce.m)("dsa-mode-available"),o=(0,s.useCallback)((async e=>{if(l)throw new Error("User has to be online");await async function(e,t){const n=await e(qe,{input:{dsaModeEnabled:t,birthdate:null,filterAgeRestrictedContent:null,filterExplicitContent:null,lockFilterExplicitContent:null,optInTrialPremiumOnlyMarket:null}}),{errors:s,data:a}=n||{};if(null==a||!a.changeUserAccountAttributes)throw s&&s.length>0?new Error(`GraphQL error: ${s[0].message}`):new Error("Unknown GraphQL error!");if("ChangeUserAccountAttributesResult"!==a.changeUserAccountAttributes.__typename||"ChangeUserAccountAttributesResult"===a.changeUserAccountAttributes.__typename&&!a.changeUserAccountAttributes.success)throw new Error("Couldn't successfully set new value")}(t,e)}),[l,t]),u=(0,s.useRef)(i);u.current=i;const{data:d}=(0,we.a)({queryKey:Le,queryFn:()=>u.current});return[c??!1,d??!1,(0,he.D)({mutationFn:o,onMutate:async e=>{await n.cancelQueries({queryKey:Le});const t=n.getQueryData(Le);return n.setQueryData(Le,e),{prevState:t,newState:e}},onError:(e,t,s)=>{n.setQueryData(Le,null==s?void 0:s.prevState),r(Se.pR.actions.open())},onSuccess:()=>{null==a||a.getEvents().emit(Me.Yt.UPDATE,null)}}).mutate]};n(80378),n(75930),n(65484),n(35174),n(96241);var Ne=n(75802);const ze="xpVsqMQfmc20cBLG04zw",Ae=e=>{let{dsaModeEnabled:t,setDsaModeEnabled:n}=e;const a=(0,fe.I0)(),l=(0,Ne.TH)(),i=new URLSearchParams(l.search).get("highlight"),g=(0,s.useRef)(null);return(0,s.useEffect)((()=>{null!=i&&i.includes("dsa")&&g.current&&(g.current.focus(),document.documentElement.classList.remove("no-focus-outline"))}),[i]),(0,h.jsxs)(c.Z,{filterMatchQuery:r.ag.get("web-player.settings.personalized-recommendations"),children:[(0,h.jsxs)(o.M,{className:ze,children:[(0,h.jsx)(u.D,{htmlFor:"settings.dsaMode",children:r.ag.get("web-player.settings.personalized-recommendations")}),(0,h.jsx)(u.D,{htmlFor:"settings.dsaMode",variant:"marginal",children:r.ag.get("web-player.settings.personalized-recommendations-body-text")})]}),(0,h.jsx)(d.m,{children:(0,h.jsx)(R.Z,{id:"settings.dsaMode",value:!t,onSelected:e=>{e?n(!e):a(Se.j0.actions.open({onConfirm:()=>n(!e)}))},inputRef:g})})]})},De=e=>{let{sectionAbove:t}=e;const[n,s,a]=Fe();return n||t?(0,h.jsxs)(w,{filterMatchQuery:r.ag.get("web-player.settings.content-preferences"),children:[(0,h.jsx)(C,{children:r.ag.get("web-player.settings.content-preferences")}),t,n&&(0,h.jsx)(Ae,{dsaModeEnabled:s,setDsaModeEnabled:a})]}):null};var Qe=n(75067);const Pe=()=>{const{libraryRowMode:e,setLibraryRowMode:t}=(0,Qe.g)(),n=L(E.LIBRARY_COMPACT_MODE),a=(0,s.useCallback)((e=>{n(e),t(e?Qe.Z.COMPACT:Qe.Z.DEFAULT)}),[n,t]);return(0,h.jsxs)(c.Z,{filterMatchQuery:r.ag.get("settings.library.compactMode"),children:[(0,h.jsx)(o.M,{children:(0,h.jsx)(u.D,{htmlFor:"settings.library.compact-mode",children:r.ag.get("settings.library.compactMode")})}),(0,h.jsx)(d.m,{children:(0,h.jsx)(R.Z,{id:"settings.library.compact-mode",value:e===Qe.Z.COMPACT,onSelected:a})})]})},We=e=>{let{children:t}=e;return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(w,{filterMatchQuery:r.ag.get("settings.library"),children:[(0,h.jsx)(C,{children:r.ag.get("settings.library")}),t]})})},Te="LOsH9AUZc2uFRlhqtpRT",Ze=e=>{let{children:t,outerRef:n}=e;return(0,h.jsx)(y.hz,{uri:"spotify:internal:settings",children:(0,h.jsx)("div",{ref:n,className:Te,"data-testid":"settings-page",children:t})})};var He=n(36353),Oe=n(8824);const Ue="DQ9fp5DjBJxKHeHqtFwC",Ie="NnDXf1J9xlVM5AUuqVt1";function Ve(e){let{containerRef:t}=e;return(0,h.jsxs)("div",{className:Ue,children:[(0,h.jsx)(k.x,{as:"h1",variant:"titleSmall",className:Ie,semanticColor:"textBase",paddingBottom:He.o7,children:r.ag.get("desktop.settings.settings")}),(0,h.jsx)("div",{children:(0,h.jsx)(Oe.K,{placeholder:"",alwaysExpanded:!1,clearOnEscapeInElementRef:t,debounceFilterChangeTimeout:0})})]})}const Be=()=>{const e=(0,s.useRef)(null),t=(0,a.W6)(g.VDn),n=(0,a.W6)(g.uH2);return(0,h.jsxs)(Ze,{outerRef:e,children:[(0,h.jsx)(Ve,{containerRef:e}),t&&(0,h.jsx)(De,{}),(0,h.jsx)(W,{}),!n&&(0,h.jsx)(We,{children:(0,h.jsx)(Pe,{})}),(0,h.jsx)(N,{}),(0,h.jsx)(de,{}),(0,h.jsx)(ve,{})]})}}}]);
//# sourceMappingURL=xpui-routes-web-settings.4ea87198.js.map