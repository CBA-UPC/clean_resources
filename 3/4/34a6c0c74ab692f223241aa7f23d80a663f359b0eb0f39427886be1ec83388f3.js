(()=>{"use strict";var t={727:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});s(163).__exportStar(s(525),e)},707:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.STYLE_CUSTOM=e.STYLE_SECONDARY=e.STYLE_PRIMARY=e.ENTITY_EVENTS=void 0,e.ENTITY_EVENTS={progressorDataChange:"usetiful:progressorDataChange"},e.STYLE_PRIMARY="Primary",e.STYLE_SECONDARY="Secondary",e.STYLE_CUSTOM="Custom"},820:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getCookie=e.setCookie=void 0,e.setCookie=function(t,e,s){let i="";if(s){const t=new Date;t.setTime(t.getTime()+24*s*60*60*1e3),i=`; expires=${t.toUTCString()}`}document.cookie=`${t}=${e||""}${i}; path=/`};e.getCookie=t=>{const e=`${t}=`,s=document.cookie.split(";");for(let t=0;t<s.length;t+=1){let i=s[t];for(;" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return null}},797:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});s(163).__exportStar(s(820),e)},525:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=s(163);i.__exportStar(s(19),e),i.__exportStar(s(315),e),i.__exportStar(s(797),e),i.__exportStar(s(754),e),i.__exportStar(s(707),e),i.__exportStar(s(468),e)},754:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});s(163).__exportStar(s(614),e)},614:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFromLocalStorage=e.saveToLocalStorage=void 0;const i=s(727);e.saveToLocalStorage=function(t,e){window.localStorage.setItem(t,JSON.stringify(e));const s=new CustomEvent(i.ENTITY_EVENTS.progressorDataChange);document.dispatchEvent(s)},e.getFromLocalStorage=,42:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Template=void 0;const i=s(19);class r{constructor(t){this.setTheme=t=>{this.themeClasses=(0,i.getThemeClasses)(t,this.classDefinition)},this.createButton=t=>{const{color:e="Primary",label:s,className:i,attributes:r={},elementType:n="button",onClick:o,href:a="#"}=t,l=document.createElement(n);return"button"===n&&(l.type="button"),"a"===n&&(l.role="button",l.setAttribute("href",a)),l.innerHTML=s,l.classList.add(this.themeClasses.button),this.themeClasses[`button${e}`]&&l.classList.add(this.themeClasses[`button${e}`]),i&&l.classList.add(...i.trim().split(" ")),Object.keys(r).forEach((),"function"==typeof o&&l.addEventListener("click",(t=>{o(t)})),l},this.createActions=t=>{const{actions:e,alignment:s}=t,i=document.createElement("div");return i.classList.add(this.themeClasses.actions),i.classList.add(s),e.forEach((t=>{i.appendChild(t)})),i},this.createWatermarkBadge=t=>{const e=document.createElement("div");e.classList.add(t);const s=document.createElement("a");return s.innerHTML="Powered by Usetiful",s.setAttribute("href","https://www.usetiful.com/?utm_source=banner_badge"),e.appendChild(s),e},this.themeClasses=(0,i.getThemeClasses)(t,this.classDefinition)}classDefinition(t,e){return{overlay:`${e}-overlay`,actions:`${e}-actions`,button:`${t}-button`,buttonPrimary:`${t}-button-primary`,buttonSecondary:`${t}-button-secondary`}}}e.Template=r,e.default=r},315:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Template=void 0;const i=s(163);var r=s(42);Object.defineProperty(e,"Template",{enumerable:!0,get:function(){return i.__importDefault(r).default}}),i.__exportStar(s(42),e)},125:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getThemeClasses=e.getThemeHashFromURL=e.getClasses=void 0;e.getClasses=function(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=`${t}${s?`-${s}`:""}`,r=e(i,t);return Object.assign({prefix:i},r)};e.getThemeHashFromURL=t=>{var e,s,i,r;let n=null===(r=null===(i=null===(s=null===(e=null==t?void 0:t.split("/"))||void 0===e?void 0:e.pop())||void 0===s?void 0:s.split("-"))||void 0===i?void 0:i.pop())||void 0===r?void 0:r.replace(".css","");const o=n?n.indexOf("?"):0;return o>=0&&(n=null==n?void 0:n.substring(0,o)),n&&"default"!==n?n:null};e.getThemeClasses=(t,s)=>(0,e.getClasses)("uf",s,(0,e.getThemeHashFromURL)(t))},19:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});s(163).__exportStar(s(125),e)},468:107:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});s(163).__exportStar(s(642),e)},642:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=s(163);i.__exportStar(s(609),e),i.__exportStar(s(337),e),i.__exportStar(s(474),e)},904:337:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});s(163).__exportStar(s(449),e)},449:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.removeTagValue=e.updateTagValue=e.getTagValue=e.updateTagsFromLS=e.loadTagsFromLS=e.replaceTags=void 0;const i=s(904);e.replaceTags=t=>{const{usetifulTags:e}=window,s=Object.keys(e||{});return null==s||s.forEach((s=>{t=null==t?void 0:t.replace(`{${s}}`,e[s])})),t};e.loadTagsFromLS=()=>{const t=localStorage.getItem(i.tagsLSKey);if(t){const e=JSON.parse(t);Object.assign(window.usetifulTags,e)}};e.updateTagsFromLS=()=>{const t=localStorage.getItem(i.tagsLSKey);if(t){const e=JSON.parse(t);Object.entries(e).forEach((t=>{const[e,s]=t;if(window.usetifulTags[e]&&window.usetifulTags[e]!==s)window.usetifulTags[e]=s;else if(!window.usetifulTags[e]){const t={};t[e]=s,Object.assign(window.usetifulTags,t)}}))}};e.getTagValue=t=>{if(!t)return null;const e=localStorage.getItem(i.tagsLSKey);if(e){const s=JSON.parse(e);if(null!==s[t])return s[t]}return null};e.updateTagValue=(t,s)=>{if(!t)return;if(!s||0===s.toString().length)return void(0,e.removeTagValue)(t);const r=localStorage.getItem(i.tagsLSKey);if(r){const n=JSON.parse(r);null!==n[t]&&s!==n[t]&&(n[t]=s,window.localStorage.setItem(i.tagsLSKey,JSON.stringify(n)),(0,e.updateTagsFromLS)())}else{const r={};r[t]=s,window.localStorage.setItem(i.tagsLSKey,JSON.stringify(r)),(0,e.updateTagsFromLS)()}};e.removeTagValue=t=>{const e=localStorage.getItem(i.tagsLSKey);if(e){const s=JSON.parse(e);null!==s[t]&&(delete s[t],window.localStorage.setItem(i.tagsLSKey,JSON.stringify(s)))}window.usetifulTags&&window.usetifulTags[t]&&delete window.usetifulTags[t]}},474:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});s(163).__exportStar(s(39),e)},39:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},169:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=class{sStandard(){return""===this.scriptMode}isPlugin(){return"plugin"===this.scriptMode}isOffline(){return"offline"===this.scriptMode}getScriptElement(){const t=`#usetiful${this.scriptMode.length>0?this.scriptMode.charAt(0).toUpperCase()+this.scriptMode.slice(1):""}Script`,e=null===document||void 0===document?void 0:document.querySelector(t);return e||(console.warn(`Usetiful plugin: script element ${t} does not exist in dom.`),null)}}},711:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=s(163).__importDefault(s(460));e.default=class{constructor(t){this.parser=new i.default(t.getScriptElement()),this.apiToken=this.parser.parseString("token"),this.sourceFile=this.parser.parseString("source-file"),this.themePath=this.parser.parseString("theme-path"),this.isDebug=this.parser.parseBool("debug"),this.withDrafts=this.parser.parseBool("with-drafts"),this.onlyTips=this.parser.parseBool("only-tips"),this.onlyChecklists=this.parser.parseBool("only-checklists"),this.previewTourId=this.parser.parseNumber("preview-tour-id"),this.isDev=this.parser.parseShortHostname().startsWith("dev.")}}},460:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.element=t}parseBool(t){return!!this.element&&1===this.parseNumber(t)}parseNumber(t){if(!this.element)return 0;const e=this.element.getAttribute(`data-${t}`)||"0";return parseInt(e,10)||0}parseString(t){return this.element&&this.element.getAttribute(`data-${t}`)||""}parseHostname(){var t;return this.element?this.element.hasAttribute("data-hostname")?`${this.element.getAttribute("data-hostname")}/`:(null===(t=this.element.getAttribute("src"))||void 0===t?void 0:t.replace(/(\/\/.*?\/).*/g,"$1"))||"":""}parseProtocol(){return`${this.parseHostname().split("/")[0]}//`}parseShortHostname},336:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.apiToken=t,this.tokenLength=32,this.currentTime=e?new Date(e):new Date}getCharsFromHash(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return[t.charAt(0),t.charAt(e?6:t.length-2),t.slice(-1)]}etHashedCharsFromString(t){let e=0;const s=t.length;let i=0;if(s>0)for(;i<s;)e=(e<<5)-e+t.charCodeAt(i++)|0;return this.getCharsFromHash(e.toString())}validate(){return this.apiToken.length===this.tokenLength&&!0}}},646:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createScript=void 0;e.createScript=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(document&&null===document.querySelector(`#${t}`)){const i=document.createElement("script");i.id=t,null!==e&&(i.src=e),null!==s&&(i.type="text/javascript",i.innerHTML=s);const r=null===document||void 0===document?void 0:document.querySelector("body");return r&&r.appendChild(i),i}return document.querySelector(`#${t}`)}},609:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TokenSecurity=e.Settings=e.ContentResolver=void 0;const i=s(163);i.__exportStar(s(169),e),i.__exportStar(s(711),e),i.__exportStar(s(336),e),i.__exportStar(s(646),e);var r=s(169);Object.defineProperty(e,"ContentResolver",{enumerable:!0,get:function(){return i.__importDefault(r).default}});var n=s(711);Object.defineProperty(e,"Settings",{enumerable:!0,get:function(){return i.__importDefault(n).default}});var o=s(336);Object.defineProperty(e,"TokenSecurity",{enumerable:!0,get:)},163:(t,e,s)=>{s.r(e),s.d(e,{__assign:()=>n,__asyncDelegator:()=>E,__asyncGenerator:()=>k,__asyncValues:()=>I,__await:()=>C,__awaiter:()=>g,__classPrivateFieldGet:()=>A,__classPrivateFieldIn:()=>_,__classPrivateFieldSet:()=>O,__createBinding:()=>f,__decorate:()=>a,__esDecorate:()=>c,__exportStar:()=>v,__extends:()=>r,__generator:()=>m,__importDefault:()=>P,__importStar:()=>x,__makeTemplateObject:()=>L,__metadata:()=>p,__param:()=>l,__propKey:()=>u,__read:()=>w,__rest:()=>o,__runInitializers:()=>h,__setFunctionName:()=>d,__spread:()=>b,__spreadArray:()=>S,__spreadArrays:()=>T,__values:()=>y,default:);var i=ar n=ct.create?t.create? $={__extends:r,__assign:n,__rest:o,__decorate:a,__param:l,__metadata:p,__awaiter:g,__generator:m,__createBinding:f,__exportStar:v,__values:y,__read:w,__spread:b,__spreadArrays:T,__spreadArray:S,__await:C,__asyncGenerator:k,__asyncDelegator:E,__asyncValues:I,__makeTemplateObject:L,__importStar:x,__importDefault:P,__classPrivateFieldGet:A,__classPrivateFieldSet:O,__classPrivateFieldIn:_}}},e={};.d=s.g=),s.o=s.r=(()=>{const t="button",e="nextStepTrigger",i="tour",r="inProgress",n="closed",o="showProductTour",a="productTourStep",l="ufTag-",c="devkitCurrentChecklist",h="EXAMPLE_USER_ID",u="toursSelection",d="pulsatingPoint",p="questionMark",g="infoPoint",m="premium",f="enterprise",v="tour",y="checklist",w="assistant",b="usetiful:toursEvent",T="usetiful:tourEvent",S="usetiful:checklist.dismissed",C="usetiful:tour.closed",k="usetiful:setDisplay",E="usetiful:initContentLoader",I="usetiful:placeAllButton",L="usetiful:placeInitialTriggers",D="usetiful:setCurrentTour",x="usetiful:listenForRedirect",P="usetiful:stopListeningForRedirect",A="usetiful:goToNextStep",O="usetiful:goToPreviousStep",_="usetiful:closeTour",$="usetiful:setTourTriggerToLocalStorage",B="usetiful:moveToStep",R="usetiful:setProgress",N="usetiful:placeNextStepTrigger",U="usetiful:tipHidden",M="usetiful:reportProgress",j="usetiful:pauseContentLoader",F="usetiful:unpauseContentLoader",H="usetiful:reportFormAnswer",W="usetiful:reportError",q="usetiful:progressorDataChange";var V=s(107);const J="showSmartTip",K="showStep",z="click",G="show",Y="redirect",Q="delay",X="complete",Z="dismiss",tt="triggerEvent",et="pageAction",st="pageLeft",it="closeTour",rt="Progressor",nt="Reports",ot="PageLeft",at=Object.freeze({horizontalProgressBar:{title:"Horizontal Progress Bar",key:1},dots:{title:"Dots",key:2},stepNumber:{title:"Step Number",key:3},circleProgressBar:{title:"Circle Progress Bar",key:4}}),lt="uf_tags",ct="uf_reports_to_send",ht="POST",ut="step",dt="checklist",pt="checklistItem",gt="autoSegment",mt="tags",ft="form",vt="error",yt=new V.ContentResolver(!1),{apiToken:wt,sourceFile:bt,themePath:Tt,withDrafts:St,onlyTips:Ct,onlyChecklists:kt,previewTourId:Et,isDebug:It,isDev:Lt,parser:Dt}=new V.Settings(yt),xt=null!==window.localStorage.getItem("pauseProductionTour"),Pt=Et>0,At={};let Ot="";if(wt&&(Ot="/data.json"),St&&(At.withDrafts=It.toString()),Ct&&(At.onlyTips=It.toString()),kt&&(At.onlyChecklists=It.toString()),Pt&&(At.previewTourId=Et.toString()),""!==Ot&&Object.keys(At).length>0){const t=new URLSearchParams(At);Ot+=`?${t.toString()}`}const _t="tours",$t="uf_smartTips",Bt="checklistsRedirects",Rt="checklistsDismiss",Nt="uf_completed",Ut="uf_triggerTour",Mt="uf_manualRedirectURL",jt="uf_banners",Ft=Dt.parseHostname(),Ht=Dt.parseShortHostname(),Wt=Dt.parseProtocol(),qt=[Nt,_t,Bt,Rt,lt,jt],Vt=function(t){It&&(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?console.info(`%c Usetiful: ${t}`,"background: #387DFF; color: #edf3ff"):console.info(`Usetiful: ${t}`))},Jt=Kt=zt=t=>{let e=t;try{return!t||t instanceof Object||(e=JSON.parse(t)),e}catch(t){Vt("Targets field is not JSON.")}return!1};function Gt(t,e){const{name:s,showEverytime:i,autoplay:r,trigger:o}=t,a=!i&&e.getObjectStatus(s)!==n,l=r&&i,c=o&&"once-then-manual"===o.type&&e.getObjectStatus(s)===n;return Vt(`manualTourShown = ${a?a.toString():""}, automaticTourShow = ${l?l.toString():""}, showEverytime = ${i?i.toString():""}`),a||l||i||c}unction Qt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";window.postMessage&&window.postMessage({type:t,text:e,resource:"USETIFUL_SCRIPT"},"*")}const Xt=class{indServices(t){const e=[];return t.forEach((),e}registerClass(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];null===this.get(t)&&(this.instances[t]=new e(...this.findServices(s)))}registerConstant(t,e){null===this.get(t)&&(this.instances[t]=e)}registerFunction(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];null===this.get(t)&&(this.instances[t]=e(...this.findServices(s)))}get(t){return Object.prototype.hasOwnProperty.call(this.instances,t)?this.instances[t]:null}};var Zt=s(797);const te=class{constructor(){this.cookieName="usetiful-visitor-ident",this.cookieLifeTimeDays=365,this.isNewVisitor=!1,this.getIdent=()=>{let t=(0,Zt.getCookie)(this.cookieName);return t||(t=this.generateUUID(),this.isNewVisitor=!0,(0,Zt.setCookie)(this.cookieName,t,this.cookieLifeTimeDays)),t},this.generateUUID=()=>{let t=(new Date).getTime(),e=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(s=>{let i=16*Math.random();return t>0?(i=(t+i)%16|0,t=Math.floor(t/16)):(i=(e+i)%16|0,e=Math.floor(e/16)),("x"===s?i:i?3:8).toString(16)}))}}};var ee=function(t,e,s,i){return new(s||(s=Promise))((function(r,n){function o(t){try{l(i.next(t))}catch(t){n(t)}}function a(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}l((i=i.apply(t,e||[])).next())}))},se=function(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(s[i[r]]=t[i[r]])}return s};function ie(t){let{type:e,id:s,action:i,actionAt:r,visitorIdent:n,tags:o,debug:a,isDevKit:l}=t;return{id:s,type:e,event:{[J]:"show",[K]:"show",[G]:"show",[z]:"click",[it]:"close",[Y]:"redirect",[Q]:"delay",[tt]:"triggerEvent",[et]:"pageAction",[X]:"complete",[Z]:"dismiss"}[i],eventAt:"string"==typeof r?r:null==r?void 0:r.toISOString(),visitorIdent:n,isPreview:a,tags:o,isDevKit:l}}function re(t){let{entityId:e,tags:s,questionType:i,question:r,answer:n,formId:o}=t;return{formId:o,questionType:i,question:r,answer:n,tags:s,entityId:e,entityType:ut}}function ne(t){let{entityId:e,entityType:s,tags:i,name:r,text:n,code:o,url:a,spaceId:l}=t;return{spaceId:l,text:n,name:r,code:o,url:a,tags:i,entityId:e.toString(),entityType:s}}function oe(t){var{actionAt:e}=t,s=se(t,["actionAt"]);return delete s.tags,Object.assign(Object.assign({},s),{actionAt:null==e?void 0:e.toString()})}const ae=class{constructor(t,e,s,i){var r=this;this.batchSize=10,this.minSendInterval=1e4,this.maxSendInterval=6e4,this.sendIntervalId=null,this.syncToLS=()=>{window.localStorage.setItem(ct,JSON.stringify(this.data))},this.getLSData=()=>{const t=window.localStorage.getItem(ct),e=t?JSON.parse(t):[];return this.data&&this.data.length>0?this.data:e},this.add=t=>ee(this,void 0,void 0,(function*(){const e=this.getLSData(),s=yield this.usetifulTags.getTags(),i=Object.assign(Object.assign({},t),{actionAt:(new Date).toISOString(),visitorIdent:this.visitor.getIdent(),debug:!!this.debug,tags:s});var r,n;e.length>=1&&(r=t,n=e[e.length-1],!["entityId","stepIndex","id","action","question","answer","name"].find((t=>r[t]!==n[t])))||(this.data.push(i),this.send())})),this.send=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r.syncToLS();const e=r.getLSData(),s=e.length&&t,i=(new Date).getMilliseconds();if(!s&&(e.length<r.batchSize||i<r.nextPossibleSend))return;const n=e.filter((t=>t.action!==J&&t.type!==pt&&t.type!==dt&&t.reportType!==ft&&t.reportType!==vt)).map(oe),o=e.filter((t=>!t.reportType&&t.action!==st)).map(ie),a=e.filter((t=>t.reportType===ft)).map(re),l=e.filter((t=>t.reportType===vt)).map(ne);r.nextPossibleSend=(new Date).getMilliseconds()+r.minSendInterval,r.reschedule(),n.length&&r.api.post("/report",n),o.length&&r.reporterApi.postWithoutResponse(`${Ft}${r.reporterApi.basePath}/entity-events/`,o,!0),r.debug||(a.length&&a.forEach((t=>{r.reporterApi.postWithoutResponse(`${Ft}${r.reporterApi.basePath}/form-answers/`,t,!0)})),l.length&&l.forEach((t=>{r.reporterApi.postWithoutResponse(`${Ft}${r.reporterApi.basePath}/console-errors/`,t,!0)}))),r.clearData()},this.clearData=()=>{this.data=[],this.syncToLS()},this.reschedule=()=>{this.sendIntervalId&&clearInterval(this.sendIntervalId),this.sendIntervalId=setInterval((,this.maxSendInterval)},this.beforeunloadEvent=()=>{this.send(!0)},this.init=()=>{this.beforeUnload.setAction(nt,this.beforeunloadEvent),this.reschedule()},this.destroy=()=>{this.beforeUnload.removeAction(nt),clearInterval(this.sendIntervalId)},this.api=t,this.reporterApi=e,this.usetifulTags=s,this.debug=It,this.data=this.getLSData().length>0?this.getLSData():[],this.syncToLS(),this.visitor=new te,this.beforeUnload=i}},le=navigator.userAgent.indexOf("Opera")>-1,ce=navigator.userAgent.indexOf("Firefox")>-1,he=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),ue=!!document.documentMode,de=!ue&&!!window.StyleMedia,pe=!le&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),ge=(pe||le)&&!!window.CSS;const me=class{constructorequest(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=new XMLHttpRequest;return r.open(t,`${Ft}${this.basePath}${e}`,i),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Content-Type","application/json; charset=utf-8"),r.setRequestHeader("X-AUTH-TOKEN",this.apiToken),null!==s?r.send(JSON.stringify(s)):r.send(),r}requestWithPromise(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise(((r,n)=>{const o=this.request(t,e,s,i);o.onload=t=>{let{currentTarget:{status:e,response:s}}=t;e>=200&&e<300?r(s):n()},o.onerror=()=>{n()}}))}stWithoutResponse(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e&&fetch(t,{keepalive:!0,method:ht,headers:Object.assign(Object.assign({"Content-Type":"application/json"},s?{"X-AUTH-TOKEN":this.apiToken}:{}),i),body:JSON.stringify(e)}).catch((t=>{if("AbortError"===t.name)console.log("Fetch request was aborted");else{if(ce&&"NetworkError when attempting to fetch resource."===t.message)return;console.error("Fetch error:",t)}}))}},fe=t=>{let e=t.name;t.tourId?e=T:t.isToursContext&&(e=b);const s=new CustomEvent(e,{detail:{event:t.name,tourId:t.tourId,isToursContext:t.isToursContext,props:t.details}});return document.dispatchEvent(s),Vt(`Event name ${t.name} send to entityID: ${t.tourId}, toursContext: ${t.isToursContext}, and details ${t.details}`),s};const ve=class{constructor(t){var e=this;this.activeTriggers="[]",this.clearTourTriggerAfterDelay=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1500;s&&fe({isToursContext:!0,name:x}),setTimeout((()=>{window.usetiful_isAboutToRefresh?s&&(fe({isToursContext:!0,name:P}),window.usetiful_isAboutToRefresh=null):e.removeTriggerFromLocalStorage(t)}),i)},this.storage=t;const s=this.storage.getItem(Ut);s?this.setTriggers(s):this.setTriggers("[]"),this.tourTriggerFromURL=-1,this.stepTriggerFromURL=-1}dateTriggers(){const t=this.storage.getItem(Ut);this.setTriggers(t)}hasTourTrigger(t){const e=this.getTriggers(),s=JSON.parse(e);return!!s&&s.includes(t)}removeAllTriggersFromLocalStorage(){this.storage.removeItem(Ut),this.setTriggers("[]")}removeTriggerFromLocalStorage(t){const e=this.getTriggers(),s=JSON.parse(e);if(s){if(s.indexOf(t)>=0){const e=s.filter((e=>e!==t));e.length>0?(this.storage.setItem(Ut,JSON.stringify(e)),this.setTriggers(JSON.stringify(e))):this.removeAllTriggersFromLocalStorage()}}}setTourTriggerToLocalStorage(t){let e=[];const s=this.getTriggers(),i=JSON.parse(s);i&&(e=i.filter(()),e.push(t),e.length>0&&(this.setTriggers(JSON.stringify(e)),this.storage.setItem(Ut,JSON.stringify(e)))}hasTourTriggerInUrl(){try{this.tourTriggerFromURL=-1;const t=window.location.search,e=new URLSearchParams(t),s=e.get(o);if(s){const t=e.entries();for(const[e,s]of t)if(e.startsWith(l)){const t=e.replace(l,"");window.usetifulTags||(window.usetifulTags={}),window.usetifulTags[t]=s}this.tourTriggerFromURL=Number(s);const i=e.get(a);i&&(this.stepTriggerFromURL=Number(i))}return-1!==this.tourTriggerFromURL}catch(t){return!1}}checkTourTriggers(){if(this.hasTourTriggerInUrl()){const t=this.tourTriggerFromURL;this.removeAllTriggersFromLocalStorage(),this.setTourTriggerToLocalStorage(t)}}};let ye=window.location.href;const we="onPageChange",be="onElementHide",Te=()=>{const t=new CustomEvent(we);Vt("change url event call"),window.dispatchEvent(t)},Se=(t,e,i)=>s.g.setInterval((()=>((t,e,s)=>{var i;let r=document.body;if(s&&(r=null===(i=null===document||void 0===document?void 0:document.querySelector(s))||void 0===i?void 0:i.shadowRoot),r&&!r.contains(t)){const t=new CustomEvent(be,{detail:e});window.dispatchEvent(t)}})(t,e,i)),500),Ce=t=>clearInterval(t),ke=()=>setInterval((()=>{return(t=window.location.href)!==ye&&(Te(),ye=t),void(ye=window.location.href);var t}),500);const Ee=class{constructor(t,e){this.afterLoaded=(t,e)=>{t(e),window.addEventListener(we,(()=>{Vt("call page change event"),this.beforeUnload.beforeUnloadListener(),t(e)}))},this.loadConfig=t=>{if(new V.TokenSecurity(wt).validate())if(xt)Vt("Script is paused by plugin");else{const e=this.api.get(Ot);e.onload=e=>{let{currentTarget:{status:s,response:i}}=e;if(ke(),s>=200&&s<400){const e=JSON.parse(i);this.afterLoaded(t,e)}},e.onerror=()=>{Jt("Usetiful: connection error")}}else console.error(`The usetiful token "${wt}" has invalid format. Please check if you have inserted the script correctly.`)},this.loadCriticalCss=()=>{const t=document.getElementsByTagName("head")[0],e=document.createElement("style");e.innerHTML="[data-uf-content] {display: none}",t.appendChild(e)},this.loadTheme=(t,e)=>new Promise((e=>{let s=t;const i=document.querySelector(`link[href="${s}"]`);if(null===i||i.getAttribute("href")!==s){const t=document.getElementsByTagName("head")[0],i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=s,i.onload=t.appendChild(i)}else e(s)})),this.api=t,this.beforeUnload=e}};const Ie=class{constructor(){this.init=this.beforeUnloadListener=()=>{Vt("beforeUnloadListener event called"),this.actions.forEach(((t,e)=>{t&&(2===e?setTimeout((()=>t()),1):t())}))},this.placeListener=()=>{this.isListenerPlaced||(window.addEventListener("beforeunload",this.beforeUnloadListener),this.isListenerPlaced=!0)},this.removeListener=()=>{this.isListenerPlaced&&(window.removeEventListener("beforeunload",this.beforeUnloadListener),this.isListenerPlaced=!1)},this.setAction=(t,e)=>{switch(t){case ot:this.actions[0]=e;break;case nt:this.actions[1]=e;break;case rt:this.actions[2]=e}},this.removeAction=t=>{this.setAction(t,(()=>{}))},this.destroy=()=>{this.removeListener(),this.actions=new Array(3)},this.isListenerPlaced=!1,this.actions=new Array(3)}};var Le=s(727);const De=`${Wt}${Lt?"progressor-":"progressor."}${Ht}`;const xe=class{constructor(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"api";this.loadedUserData={},this.dataChanged=!1,this.beforeunloadEvent=this.setDataChanged=this.placeEventListeners=()=>{document.addEventListener(q,this.setDataChanged)},this.removeEventListeners=()=>{document.removeEventListener(q,this.setDataChanged)},this.apiToken=t,this.basePath=r,this.usetifulTags=e,this.beforeUnload=s,this.api=i,this.loadFromApi()}estroy(){this.beforeUnload.removeAction(rt),clearInterval(this.sendIntervalId),this.removeEventListeners()}request(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=new XMLHttpRequest;if(r.open(t,`${De}${this.basePath}/${e}`,i),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),null!==s?r.send(JSON.stringify(s)):r.send(),200===r.status){const{responseText:t}=r;return JSON.parse(t)}}oadFromApi(){const t=this.getUserId();if(null===t)return;const e={userId:t,accountToken:this.apiToken},s=this.request(ht,"get",e);s&&"string"==typeof s&&(this.loadedUserData=JSON.parse(s),this.addAutoSegmentToUsetifulTags(),this.addUserTagsToUsetifulTags(),this.addTagsToLS(),this.addBannersToLS())}getUserData(t){return this.isLoadedDataSameAsLS(),Object.prototype.hasOwnProperty.call(this.loadedUserData,t)?this.loadedUserData[t]:null}saveUserData(t,e){null!==this.getUserId()&&("object"!=typeof this.loadedUserData&&(this.loadedUserData={}),this.loadedUserData[t]=e,this.dataChanged=!0)}getDataToSend(){const t={};return qt.forEach((e=>{const s=window.localStorage.getItem(e);t[e]=null!==s?s:this.loadedUserData[e]||"[]"})),t[gt]=this.loadedUserData[gt],t[mt]=this.loadedUserData[mt],t}saveToApi(t){if(this.dataChanged){const e={userId:t,accountToken:this.apiToken,data:this.getDataToSend()};this.api.postWithoutResponse(`${De}${this.basePath}/save`,e,!1,{"x-requested-with":"XMLHttpRequest"}),this.dataChanged=!1}}setSaveInterval(){this.sendIntervalId=setInterval((()=>{const t=this.getUserId();null!==t&&this.saveToApi(t)}),1e4)}setUnloadListener(){this.beforeUnload.setAction(rt,(()=>{const t=this.getUserId();null!==t&&this.beforeunloadEvent(t)}))}isLoadedDataSameAsLS(){let t=!0;const e=Object.keys(this.loadedUserData),s=[];return e.forEach((e=>{this.loadedUserData[e]!==window.localStorage.getItem(e)&&(t=!1),s.length>0&&console.warn(`Usetiful: Data from progressor and local storage are not equal for these keys: '${s.toString()}. It may result in wrong progress state.'`)})),t}addAutoSegmentToUsetifulTags(){const t=this.getUserData(gt);null!==t&&(window.usetifulTags[gt]=t)}addUserTagsToUsetifulTags(){var t;const e=this.getUserData(mt);if(null===e)return;const s=JSON.parse(e);window.usetifulTags=null!==(t=window.usetifulTags)&&void 0!==t?t:{},s.forEach(()}addTagsToLS(){const t=this.getUserData(lt);if(null===t)return;const e=JSON.parse(t),s=localStorage.getItem(lt),i=s?JSON.parse(s):{};Object.assign(i,e),localStorage.setItem(lt,JSON.stringify(i))}addBannersToLS(){const t=this.getUserData(jt);if(null===t)return;const e=JSON.parse(t);(0,Le.saveToLocalStorage)(jt,e)}},Pe=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!1;return(s=>{const i=/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/i.test(s),r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4));(t?i:r)&&(e=!0)})(navigator.userAgent||navigator.vendor||window.opera),e},Ae=Pe(),Oe=Pe(!0),_e=!Oe&&!Ae;var $e=const Be=class{constructor(t){this.reportDataPrivacy=0,this.setReportDataPrivacy=t=>{this.reportDataPrivacy=t},this.api=t}getTags(){return $e(this,void 0,void 0,(function*(){const{usetifulTags:t}=window,e=Object.fromEntries(Object.entries(t||{}).filter((t=>{let[e,s]=t;return"userId"===e||null!=s&&""!==s}))),s="object"==typeof t?e:{};return s.autoGeneratedTags&&delete s.autoGeneratedTags,3===this.reportDataPrivacy?s:1===this.reportDataPrivacy?Object.fromEntries(Object.entries(s).filter(()):2===this.reportDataPrivacy?Object.fromEntries(Object.entries(s).filter(()):4===this.reportDataPrivacy?Object.assign({},yield this.getAutoGenTags()):5===this.reportDataPrivacy?Object.assign(Object.assign({},s),yield this.getAutoGenTags()):{}}))}getTag(t){const{usetifulTags:e}=window;return e&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:null}getUserId(){const t=this.getTag("userId");return t&&t!==h?t.toString():null}getAutoGenTags(){return new Promise((t=>{if(window.usetifulTags||(window.usetifulTags={}),window.usetifulTags.autoGeneratedTags&&window.usetifulTags.autoGeneratedTags.country)t(window.usetifulTags.autoGeneratedTags);else{const e=this.api.get("/geoip"),s=Object.assign(Object.assign({},(()=>{const t=navigator.userAgent;let e,s=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(s[1]))return e=/\brv[ :]+(\d+)/g.exec(t)||[],{browserName:"IE",browserVersion:e[1]||""};if("Chrome"===s[1]&&(e=t.match(/\bOPR|Edge\/(\d+)/),null!=e))return{browserName:"Opera",browserVersion:e[1]};s=s[2]?[s[1],s[2]]:[navigator.appName,navigator.appVersion,"-?"],e=t.match(/version\/(\d+)/i),null!=e&&s.splice(1,1,e[1]);const i={browserName:s[0],browserVersion:s[1]};return le?Object.assign(Object.assign({},i),{browserName:"Opera"}):ce?Object.assign(Object.assign({},i),{browserName:"Firefox"}):he?Object.assign(Object.assign({},i),{browserName:"Safari"}):ue?Object.assign(Object.assign({},i),{browserName:"IE"}):de?Object.assign(Object.assign({},i),{browserName:"Edge"}):pe?Object.assign(Object.assign({},i),{browserName:"Chrome"}):ge?Object.assign(Object.assign({},i),{browserName:"Blink"}):i})()),{browserLanguage:window.navigator.userLanguage||window.navigator.language,deviceType:Ae?"Mobile":Oe?"Tablet":"Desktop",screenSize:`${window.screen.width} x ${window.screen.height}`,domain:window.location.hostname,url:window.location.href});e.onload=e=>{let{currentTarget:{status:i,response:r}}=e;i>=200&&i<400?(window.usetifulTags.autoGeneratedTags=Object.assign({country:JSON.parse(r).country},s),t(window.usetifulTags.autoGeneratedTags)):t(Object.assign({country:"unknown"},s))}}}))}};const Re=class{constructor(t){this.parseBoolean=t=>!0===(t&&"string"==typeof t?JSON.parse(t):t),this.saveToStorage=()=>{const t=localStorage.getItem(this.getLocalStorageKey());this.progressorApi.saveUserData(this.getLocalStorageKey(),t)},this.progressorApi=t,this.alreadyParsed=!1,this.checklistData=[],this.processParseData()}rocessParseData(){if(this.alreadyParsed)return;const t=this.progressorApi.getUserData(this.getLocalStorageKey());if(t&&"string"==typeof t){const e=JSON.parse(t);this.saveToLocalStorage(e),this.checklistData=e}else this.loadFromLocalStorage(),this.saveToStorage();this.alreadyParsed=!0}loadFromLocalStorage(){const t=localStorage.getItem(this.getLocalStorageKey());t&&(this.checklistData=JSON.parse(t))}isChecklistDismiss(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t&&this.checklistData&&this.checklistData.length>0){const e=this.checklistData.find((e=>e.id===t));if(e)return this.parseBoolean(e.value)}return!1}sAllChecklistsDismissed(t){let e=!0;for(const s of t){const{id:t}=s;this.isChecklistDismiss(t)||(e=!1)}return e}setDismissValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){void 0!==this.checklistData.find((t=>t.id===e))?this.checklistData=this.checklistData.map(():this.checklistData.push({id:e,value:t}),this.saveToLocalStorage(this.checklistData),this.saveToStorage()}}saveToLocalStorage,Ne={overlay:"overlay",top:"top",left:"left",right:"right",bottom:"bottom",visible:"visible",bubble:"bubble",bubbleContent:"bubble-content",bubbleContentWithoutTitle:"bubble-content--without-title",beacon:"beacon",beaconAround:"beacon__around",beaconIconic:"beacon__iconic",beaconIconicQuestion:"beacon__iconic-question",beaconIconicInformation:"beacon__iconic-information",bubbleInvisible:"bubble--invisible",modal:"modal",modalInner:"modal-inner",dotProgressBPadding:"dot-progress--bpadding",circleProgressBPadding:"circle-progress--bpadding",title:"title",titleWithoutProgress:"title--without-progress",titleWithoutContent:"title--without-content",contentWithDescription:"content--with-description",description:"description",slideout:"slideout",slideoutInner:"slideout-inner",articleInner:"article-inner",actions:"actions",searchBox:"search-box",searchResults:"search-results",actionsPaddingAround:"actions--padding-around",redirect:"redirect",delay:"delay",redirectInner:"redirect-inner",triggerEventInner:"trigger-event-inner",pageActionInner:"page-action-inner",buttonMain:"button-main",buttonMainTourSelection:"button-selection",buttonMainLeft:"button-main--left",tourSelection:"tour-selection",button:"button",buttonIcon:"button-icon",buttonIconRight:"button-icon--right",buttonBlock:"btn-block",buttonPrimary:"button-primary",buttonClose:"close-button",buttonBack:"back-button",buttonGroup:"button-group",badge:"badge",badgeFree:"free-badge",spaceMaker:"space-maker",spaceMakerPlus:"space-maker--plus",spaceMakerDouble:"space-maker--double",done:"done",content:"content",contentWithoutTitle:"content--without-title",feedback:"feedback",reaction:"reaction",feedbackTitle:"feedback-title",npsTitles:"feedback-nps-titles",inProgress:"inprogress",progress:"progress",progressValue:"progress-value",dotProgress:"dot-progress",dotProgressRight:"dot-progress--right",dotProgressCenter:"dot-progress--center",dotProgressLeft:"dot-progress--left",dotProgressFree:"dot-progress--free",dotProgressItem:"dot-progress__item",dotProgressActiveItem:"dot-progress__item--active",circleProgress:"circle-progress",circleProgressRight:"circle-progress--right",circleProgressLeft:"circle-progress--left",circleProgressCenter:"circle-progress--center",circleProgressFree:"circle-progress--free",circleProgressInner:"circle-progress__inner",circleProgressBar:"circle-progress__bar",circleProgressBarLeft:"circle-progress__bar--left",circleProgressBarRight:"circle-progress__bar--right",circleProgressProgress:"circle-progress__progress",numberProgress:"number-progress",numberProgressRight:"number-progress--right",numberProgressLeft:"number-progress--left",numberProgressCenter:"number-progress--center",numberProgressFree:"number-progress--free",numberProgressDivider:"number-progress__divider",progressTop:"progress--top",progressBottom:"progress--bottom",progressbar:"progress-bar",notification:"notification",notificationInner:"notification-inner",notificationSearchInner:"notification-inner--search",static:"static",alert:"alert",preview:"preview",pointer:"pointer",bottomAction:"bottom-action",svgIcon:"svg-icon",textLeft:"text-left",textRight:"text-right",scrollable:"scrollable",congratulation:"congratulation",errorShake:"error-shake",formFieldset:"form-fieldset",formQuestion:"form-question",validationAlert:"validation-alert",error:"error"},Ue=["overlay","pointer"],Me=["svg-icon"],je=(t,e)=>{const s={};return Object.keys(Ne).forEach((i=>{Me.includes(i)?s[i]=Ne[i]:s[i]=`${Ue.includes(i)?e:t}-${Ne[i]}`})),s},Fe=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,Le.getClasses)("uf",je,(0,Le.getThemeHashFromURL)(t))},He="ufp",We=(0,Le.getClasses)("uf",je),qe=((0,Le.getClasses)(He,je),"pointer"),Ve="modal",Je="slideout",Ke="redirect",ze="delay",Ge="triggerEvent",Ye="pageAction",Qe="bottom",Xe="fill",Ze="click",ts="jsEvent",es="webhook",ss="next",is="previous",rs="jump",ns="goto",os="gototour",as="close";function ls(t,e){t&&t.width&&e.setAttribute("style",function(t){return t&&t.width?`max-width: 100%; width: ${t.width}px; min-width: auto;`:""}(t))}function cs(t,e){if(t&&t.classes){t.classes.split(" ").forEach(()}}const hs=/^UsetifulShadowDom\([^)]*\) /,us=t=>{let e=!0;if(!t)return!1;hs.test(t)&&(t=t.replace(hs,""));try{document.createDocumentFragment().querySelector(t)}catch(t){e=!1}return e},ds=t=>{var e;if(t)try{const s=t.match(hs);let i=s?s[0]:void 0;if(!i)return document.querySelector(t);i=i.replace("UsetifulShadowDom(",""),i=i.substring(0,i.length-2);const r=null===document||void 0===document?void 0:document.querySelector(i);return null===(e=null==r?void 0:r.shadowRoot)||void 0===e?void 0:e.querySelector(gs(t))}catch(e){console.error(`Usetiful: Your Usetiful content leads to an incorrect element selector ${t}. Please check it out inside the editor.`)}},ps=t=>{var e;if(t)try{const s=t.match(hs);let i=s?s[0]:void 0;if(!i)return document.querySelectorAll(t);i=i.replace("UsetifulShadowDom(",""),i=i.substring(0,i.length-2);const r=null===document||void 0===document?void 0:document.querySelector(i);return null===(e=null==r?void 0:r.shadowRoot)||void 0===e?void 0:e.querySelectorAll(gs(t))}catch(e){console.error(`Usetiful: Your Usetiful content leads to an incorrect element selector ${t}. Please check it out inside the editor.`)}},gs=ms=t=>{const e=t.match(hs),s=e?e[0]:void 0;let i;return s&&(i=s.replace("UsetifulShadowDom(",""),i=i.substring(0,i.length-2)),{shadowDomSelector:i,childSelector:gs(t),isAShadowDomSelector:Boolean(s)}},fs="attr changing",vs=(t,e)=>null!==t&&e in t,ys=(t,e)=>t&&vs(t,"nodeName")&&t.nodeName.toLowerCase()===e,ws=t=>{var e;Vt("called destroyElement"),t instanceof HTMLElement&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t))},bs=t=>{const e=ds(t);e instanceof HTMLElement&&(Vt(`called destroyElementBySelector ${t}`),ws(e))},Ts=(t,e)=>null!==t.closest(gs(e)),Ss=t=>!(t&&t.offsetWidth||(null==t?void 0:t.offsetHeight)||(null==t?void 0:t.getClientRects().length)),Cs=(t,e,s)=>{let i=null;if(t&&(i=ds(t)),!i&&e&&(i=ds(e)),!i&&s&&(i=s),!i)return!0;let r=i;for(;r;){const t=window.getComputedStyle(r);if("none"===t.display)return!0;if(t.visibility&&"visible"!==t.visibility)return console.log(r,`visi: ${t.visibility}`),!0;if("0"===t.opacity)return!0;if((r===i||r!==i&&"hidden"===t.overflow)&&(0===r.offsetWidth||0===r.offsetHeight||0===r.getClientRects().length))return!0;r=r.parentElement}return!1};var ks,Es,Is,Ls,Ds,xs=ks=new WeakMap,Es=new WeakMap,Is=new WeakMap,Ls=new WeakMap,Ds=new WeakMap;const Ps=class{constructor(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.createWrapper=t=>{const e=document.createElement("div");return t&&e.classList.add(t),e},this.setTheme=this.setIsWatermark=this.appendButtonDataAttributes=t=>{t.classList.contains(this.themeClasses.button)&&(t.dataset.ufButton="button"),t.classList.contains(this.themeClasses.buttonPrimary)&&(t.dataset.ufButton="button-primary"),t.classList.contains(this.themeClasses.buttonClose)&&(t.dataset.ufButton="close"),t.classList.contains(this.themeClasses.buttonMain)&&(t.dataset.ufButton="button-main")},this.createButton=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=document.createElement("button");return i.type="button",i.innerHTML=(0,V.replaceTags)(e),""!==s&&i.classList.add(s),t.appendButtonDataAttributes(i),i},this.createLink=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.themeClasses.button,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#";const r=document.createElement("a");return r.setAttribute("href",i),r.innerHTML=e,""!==s&&r.classList.add(s),t.appendButtonDataAttributes(r),r},this.createTitle=function(e,s){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.themeClasses.title;if(!i)return;const n=document.createElement(`h${e}`);return n.dataset.ufElement="title",n.innerHTML=(0,V.replaceTags)(s),""!==r&&n.classList.add(r),n},this.createBubble=t=>{let{ident:e,contentHTML:s,title:i,progressBar:r,alignment:n,actionNumbers:o,progressType:a,closeButton:l,appendAdditionalContent:c,hotspot:h,customStyle:u}=t;const d=document.querySelector(`.${this.themeClasses.prefix}-${e}`),{body:p}=document;if(d instanceof HTMLElement)return d;if(!(p instanceof HTMLBodyElement))return;const g=document.createElement("div");g.dataset.ufContent="bubble";const m=p.appendChild(g);m.classList.add(this.themeClasses.bubble,`${this.themeClasses.prefix}-${e}`),m.setAttribute("id",e),u&&(ls(u,m),cs(u,g));const f=document.createElement("div");f.classList.add(this.themeClasses.pointer),f.setAttribute("data-floating-arrow",""),m.appendChild(f),l instanceof HTMLButtonElement&&m.appendChild(l),i instanceof HTMLElement&&(i.dataset.ufElement="title",m.appendChild(i)),r instanceof HTMLElement&&m.appendChild(r);const v=this.createWrapper(this.themeClasses.bubbleContent);return null===i&&v.classList.add(this.themeClasses.bubbleContentWithoutTitle),v.innerHTML=(0,V.replaceTags)(s)||"",m.appendChild(v),c&&c(m),m.appendChild(this.createSpaceMaker(n,o,a)),this.isWatermark&&m.appendChild(this.createWatermarkBadge()),h&&m.classList.add(this.themeClasses.bubbleInvisible),m},this.createWatermarkBadge=()=>{const t=this.createWrapper(this.themeClasses.badgeFree);return t.appendChild(this.createLink("Powered by Usetiful","",`${Ft}?utm_source=tour_badge`)),t},this.createSpaceMaker=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=t.createWrapper(t.themeClasses.spaceMaker);return s&&"center"!==e||i!==at.dots.key?s||i!==at.stepNumber.key&&i!==at.circleProgressBar.key||r.classList.add(t.themeClasses.spaceMakerDouble):r.classList.add(t.themeClasses.spaceMakerPlus),r},ks.set(this,((t,e)=>{const s=this.createWrapper(this.themeClasses.progress),i=this.createWrapper(this.themeClasses.progressbar);return 0===t&&s.classList.add("hidden"),"top"===e?s.classList.add(this.themeClasses.progressTop):"bottom"===e&&s.classList.add(this.themeClasses.progressBottom),i.style.width=`${t}%`,s.appendChild(i),s})),Es.set(this,((t,e,s,i)=>{const r=this.createWrapper(this.themeClasses.dotProgress);return i&&"center"!==t?"left"===t&&i?r.classList.add(this.themeClasses.dotProgressRight):"right"===t&&i&&r.classList.add(this.themeClasses.dotProgressLeft):r.classList.add(this.themeClasses.dotProgressCenter),this.isWatermark&&r.classList.add(this.themeClasses.dotProgressFree),[...Array(e)].forEach(((t,e)=>{const i=document.createElement("span");i.classList.add(this.themeClasses.dotProgressItem),e===s-1&&i.classList.add(this.themeClasses.dotProgressActiveItem),r.appendChild(i)})),r})),Is.set(this,((t,e,s,i)=>{const r=this.createWrapper(this.themeClasses.numberProgress);i?"right"===s&&i&&r.classList.add(this.themeClasses.numberProgressLeft):r.classList.add(this.themeClasses.numberProgressCenter),this.isWatermark&&r.classList.add(this.themeClasses.numberProgressFree),r.innerHTML=t.toString();const n=document.createElement("span");return n.innerHTML="/",r.appendChild(n),r.innerHTML+=e.toString(),r})),Ls.set(this,((t,e,s)=>{let i=180*t/100*2,r=0;t>50&&(r=i-180,i=180);const n=this.createWrapper(this.themeClasses.circleProgress);s?"right"===e&&s&&n.classList.add(this.themeClasses.circleProgressLeft):n.classList.add(this.themeClasses.circleProgressCenter),this.isWatermark&&n.classList.add(this.themeClasses.circleProgressFree);const o=this.createWrapper(this.themeClasses.circleProgressInner),a=document.createElement("div"),l=this.createWrapper(this.themeClasses.circleProgressBar);l.classList.add(this.themeClasses.circleProgressBarLeft);const c=this.createWrapper(this.themeClasses.circleProgressProgress);c.style.transform=`rotate(${i}deg)`,l.appendChild(c);const h=this.createWrapper(this.themeClasses.circleProgressBar);h.classList.add(this.themeClasses.circleProgressBarRight);const u=this.createWrapper(this.themeClasses.circleProgressProgress);return u.style.transform=`rotate(${r}deg)`,h.appendChild(u),a.appendChild(l),a.appendChild(h),n.appendChild(o),n.appendChild(a),n})),this.progressBarController=(t,e,s)=>{const{title:i,publicTitle:r,position:n,type:o,alignment:a,actions:l}=t,c=""!==i&&!0===r,{progressType:h}=e,u=xs(this,Ds,"f").call(this,e.steps,s),d=u.activeStepIndex/(u.stepsLength/100);switch(h){case at.dots.key:return xs(this,Es,"f").call(this,a,u.stepsLength,u.activeStepIndex,l.length);case at.stepNumber.key:return xs(this,Is,"f").call(this,u.activeStepIndex,u.stepsLength,a,l.length);case at.circleProgressBar.key:return xs(this,Ls,"f").call(this,d,a,l.length);default:{let t="";return c||o===qe?c||(t=n&&"bottom"===n?"bottom":"top"):t="top",xs(this,ks,"f").call(this,d,t)}}},Ds.set(this,((t,e)=>{const s={stepsLength:0,activeStepIndex:0};return t.forEach(((t,i)=>{t.type!==Ke&&t.type!==ze&&(s.stepsLength+=1,i<=e&&(s.activeStepIndex+=1))})),s})),this.createBeacon=(t,e,s,i)=>{const r=this.createWrapper(this.themeClasses.beacon);r.dataset.ufElement="beacon",s&&s!==d&&(r.classList.add(this.themeClasses.beaconIconic),s===p&&r.classList.add(this.themeClasses.beaconIconicQuestion),s===g&&r.classList.add(this.themeClasses.beaconIconicInformation));const{body:n}=document;if(n.appendChild(r),!s||s===d){const t=document.createElement("div");t.classList.add(this.themeClasses.beaconAround),r.appendChild(t)}return r.setAttribute("id",t),r.style.zIndex=e,i&&i.classes&&r.classList.add(i.classes),r},this.removeAllBeacons=()=>{document.querySelectorAll(`.${this.themeClasses.beacon}`).forEach((),window.usetiful_smartTipsObserver&&window.usetiful_smartTipsObserver.length>0&&window.usetiful_smartTipsObserver.forEach(()},this.notifyUser=function(e,s,i,r,n,o){let a,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"bottom-right",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;const h=document.createElement("div");h.dataset.ufContent=e,c&&(h.dataset.id=c),h.setAttribute("style","display: none"),n&&h.classList.add(...n);const u=document.createElement("div");a=s instanceof HTMLElement?s:t.createTitle(3,s);const d=document.createElement("button");d.type="button",d.classList.add(t.themeClasses.buttonClose),d.dataset.ufButton="close";const p=if("checklist"===e&&(window.USETIFUL.checklist.close=p),d.addEventListener("click",p),d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg"><path stroke="#000" stroke-width="2" d="M1 16L16 1M1 1l15 15"/></svg>',u.appendChild(d),a instanceof HTMLElement&&u.appendChild(a),i){const e=document.createElement("div");e.classList.add(t.themeClasses.content),e.innerHTML=i,u.appendChild(e)}if(r){const t=r();u.append(t)}h.appendChild(u),h.classList.add(t.themeClasses.notification),u.classList.add(`${t.themeClasses.notificationInner}`),"bottom-left"===l?(h.style.left="0",h.classList.add(t.themeClasses.left)):(h.style.right="0",h.classList.add(t.themeClasses.right)),h.style.bottom="0",t.isWatermark&&u.append(t.createWatermarkBadge()),document.body.appendChild(h),h.classList.contains(We.visible)||h.classList.add(We.visible)},this.confirmation=(t,e,s,i,r,n)=>{const o=`${We.prefix}-confirmation`,a=`.${o}`;document.querySelector(a)||this.notifyUser("confirm",t,e,(()=>{const t=this.createWrapper(this.themeClasses.actions);t.classList.add("center");const e=this.createLink(s);e.addEventListener("click",(t=>{r(),bs(a),t.preventDefault(),t.stopPropagation()}),!1),t.append(e);const n=this.createLink(i);return n.addEventListener("click",(t=>{bs(a),t.preventDefault(),t.stopPropagation()}),!1),t.append(n),t}),[o],(()=>{}),n)},this.showElement=t=>{document.body.appendChild(t),t.classList.contains(We.visible)||t.classList.add(We.visible)},this.changeItemToDoneStyle=t=>{const e=document.querySelector(`button[data-id='${t}']`);if(e instanceof HTMLButtonElement){e.classList.add(this.themeClasses.done),e.dataset.ufStatus="done";const t=e.querySelector(`.${this.themeClasses.svgIcon}`);t&&(t.innerHTML='<svg class="svg-icon filled" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M12 3.75a8.25 8.25 0 100 16.5 8.25 8.25 0 000-16.5zM2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12z"/><path clip-rule="evenodd" d="M16.465 8.411a.75.75 0 01.124 1.054l-4.404 5.577a1.25 1.25 0 01-1.827.145l-2.866-2.635a.75.75 0 111.016-1.104l2.667 2.453 4.236-5.366a.75.75 0 011.054-.124z"/></svg>')}},this.checklistProgressUpdate=()=>{var t;const e=document.querySelectorAll(`.${this.themeClasses.notificationInner} .${this.themeClasses.actions} button`);if(0===e.length)return;let s=0;e.forEach((t=>{t.classList.contains(this.themeClasses.done)&&(s+=1)}));const i=Math.round(s/(e.length/100));if(!i)return;null===(t=document.querySelector(`.${this.themeClasses.progressbar}`))||void 0===t||t.setAttribute("style",`width: ${i}%;`);const r=document.querySelector(`.${this.themeClasses.progressValue}`);r&&(r.textContent=`${i}%`)},this.destructElement=t=>{const e=ps(`.${this.themeClasses.prefix}-${t}`);null==e||e.forEach(()},this.checkScrollableClass=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const i=window.innerHeight;0===e.clientHeight&&s>=0&&setTimeout((()=>t.checkScrollableClass(e,s-1)),50),Ae&&e.clientHeight>.8*i?e.classList.add(t.themeClasses.scrollable):e.classList.remove(t.themeClasses.scrollable)},this.themeClasses=Fe(e),this.isWatermark=s}};const As=class{constructor(t){var e=this;this.setTheme=this.placeAllButtons=(t,e,s)=>{Vt("placeAllButtons called"),this.setAvailableTours(t);const i=[];for(let r=0;r<t.length;r+=1)t[r].tourData.button&&e(t[r].tourData,s)&&i.push(t[r]);if(1===i.length)this.placeUsetifulButton(i[0].tourData);else if(i.length>1){const t=(t=>{if(t){const e=Math.max(...t.map((t=>t.objectPriority)));return t.filter((t=>t.objectPriority===e))}})(i);t&&(1===t.length?this.placeUsetifulButton(t[0].tourData):console.warn(`Usetiful: There are ${t.length} tours available on this page with usetiful button enabled: ${t.map(().toString()} \n and we can't decide based on the targeting which button to display first.`))}},this.getButtonLabelContent=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=`${t}`;return s&&s>0&&(i+=`<span class="${e.template.themeClasses.badge}">${s}</span>`),i},this.placeUsetifulButton=t=>{Vt("placeUsetifulButton called"),this.loader.loadTheme(t.theme,t.themeSlug).then((e=>{this.setTheme(e),this.prepareMainButton(`tour_${t.id}`,t.buttonLabel||"Usetiful Tour!",()}))},this.buttonContent="",this.template=new Ps,this.availableTours=[],this.loader=t}setButtonContent(t){this.buttonContent=t}getButtonContent(){return this.buttonContent}getButtonElement(){return this.id?document.querySelector(`[data-uf-id="${this.id}"][data-uf-button="button-main"]`):document.querySelector('[data-uf-button="button-main"]')}setAvailableTours(t){this.availableTours=t}repareMainButton(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(Vt("prepareMainButton called"),document.querySelector(`[data-uf-button="button-main"][data-uf-id="${t}"]`))return;this.destroy(),this.id=t,this.setButtonContent(e);const r=this.template.createLink((0,V.replaceTags)(e),this.template.themeClasses.buttonMain);r.dataset.ufId=t,r.setAttribute("style","display:none"),s&&r.addEventListener("click",(t=>{s(),t.stopImmediatePropagation(),t.preventDefault()}),!1);const n=document.body;n&&n.appendChild(r),r.classList.add(We.visible),i&&"bottom-left"===i&&r.classList.add(this.template.themeClasses.buttonMainLeft)}};class Os{constructor(t,e){this.placeAppearsTrigger=()=>{let t=!1;return this.availableOnPage.checkTriggerURL(this.trigger)&&this.isInitial&&(t=this.setAppearTrigger()),t},this.setAppearTrigger=()=>{Vt(`setAppearTrigger called for ${this.elementSelector} ...`);const t=2*this.loop;let e=!1,s=1;if(!this.availableOnPage.checkTriggerURL(this.trigger))return!1;const i=window.setInterval((()=>{Vt(`${this.id}: ${s} / ${t}: Waiting on the element '${this.elementSelector}' to appear...`);const i=this.availableOnPage.checkElement(this.elementSelector)&&!Ss(ds(this.elementSelector));!e&&i&&this.triggerFunction?(Vt(`${this.id}: Element appeared`),e=!0,this.triggerFunction(),this.isInitial||this.removeAppearTrigger()):-1===this.loop||t&&s<t?s+=1:e?this.isInitial&&!i&&(e=!1,Vt(`${this.id}: Element disappeared`)):t&&(this.removeAppearTrigger(),this.failFunction?this.failFunction():this.altSolution&&this.altSolution())}),500);return this.intervalId=i,!0},this.removeAppearTrigger=()=>{Vt(`${this.id}: remoteAppearTrigger called.`),this.intervalId&&(clearInterval(this.intervalId),Vt(`${this.id}: interval removed.`))},this.trigger=t,this.id=(+new Date).toString(36),this.eventType=t.type,this.eventName=this.eventType,"custom"===this.eventType&&(this.eventName=t.name),this.loop=t.loop?parseInt(t.loop,10):0,this.url=t.url,this.elementSelector=t.element,this.isInitial=!1,this.isChecklistItem=!1,this.isProgressOnClick=!1,this.failFunction=void 0,this.triggerFunction=()=>{},this.reverseTriggerFunction=()=>{},this.availableOnPage=e}}const _s=$s=Bs=(t,e)=>{const s=(0,V.replaceTags)(t);setTimeout((()=>{if(e){const t=window.open(s,"_blank");null==t||t.focus()}else window.location.href=s||"",$s(s)&&window.USETIFUL.reinitialize()}),1)},Rs=(t,e)=>!(!e.startsWith("/")&&!e.startsWith("."))||(t=new URL(t).hostname.replace("www.",""))===(e=new URL(e).hostname.replace("www.",""));class Ns{constructor(t){this.placeTrigger=t=>{if(Vt(`placeTrigger: Event ${t.eventName} on url: ${t.url} and element: ${t.elementSelector} with loop:${t.loop}.`),this.isTriggerMissing(t)){if("custom"===t.eventType){this.addToActiveTriggers(t);if(t.elementSelector&&ds(t.elementSelector)&&"window"!==t.elementSelector){const e=ds(t.elementSelector);e&&e.addEventListener(t.eventName,this.centralEventListener)}else this.placeCentralListener(t.eventName,t.elementSelector);return}switch(this.addToActiveTriggers(t),t.eventName){case"appears":t.placeAppearsTrigger()&&window.usetiful_intervals.push(t.intervalId);break;case"hover":{t.eventName="mouseover",this.placeCentralListener(t.eventName,t.elementSelector);const e=new Os(t.trigger,this.availableOnPage);e.eventName="mouseout",e.triggerFunction=t.reverseTriggerFunction,e.stepId=t.stepId,this.addToActiveTriggers(e),this.placeCentralListener(e.eventName,t.elementSelector);break}case"focus":t.eventName="focusin",this.placeCentralListener(t.eventName,t.elementSelector);break;case"mouseenter":t.eventName="mouseover",this.placeCentralListener(t.eventName,t.elementSelector);break;case"click":t.eventName="mouseup",this.placeCentralListener(t.eventName,t.elementSelector);break;default:this.placeCentralListener(t.eventName,t.elementSelector)}}},this.centralEventListener=t=>{const e=t.target||t.srcElement||t.currentTarget;if(Vt(`centralEventListener: called with event ${t.type} on element: ${e}`,!0),!(e instanceof Element||e instanceof HTMLElement||e instanceof Window))return;const s=this.searchInActiveTriggers(t.type,e);Kt(e),s.forEach((e=>{e.stepId?e.triggerFunction(e.stepId):e.isChecklistItem&&e.checklistItemId?e.triggerFunction(e.checklistItemId):e.triggerFunction(t)}))},this.updateListeners=()=>{Vt("Updating listeners on window.usetiful_activeTriggersOnElements..."),window.usetiful_activeListeners&&window.usetiful_activeListeners.forEach((),window.usetiful_activeListeners=[],window.usetiful_activeTriggersOnElements.forEach(()},this.placeCentralListener=(t,e)=>{var s,i;const r=ms(e||""),n=`${t}(${r.isAShadowDomSelector?r.shadowDomSelector:"window"})`;t&&window.usetiful_activeListeners&&-1===window.usetiful_activeListeners.indexOf(n)&&(window.usetiful_activeListeners.push(n),r.isAShadowDomSelector&&r.shadowDomSelector?null===(i=null===(s=document.querySelector(r.shadowDomSelector))||void 0===s?void 0:s.shadowRoot)||void 0===i||i.addEventListener(t,this.centralEventListener):window.addEventListener(t,this.centralEventListener))},this.removeCentralListener=t=>{if(!window.usetiful_activeListeners)return;const e=window.usetiful_activeListeners.indexOf(t);e>-1&&window.usetiful_activeListeners.splice(e,1)},this.hasProgressOnClickTrigger=t=>{const e=this.searchInActiveTriggers("mouseup",t);for(let t=0;t<e.length;t+=1)if(e[t].isProgressOnClick)return!0;return!1},this.isTriggerMissing=t=>{const e=this.searchInActiveTriggers(t.eventName,t.elementSelector);let s=!1;return e.forEach((e=>{e.isChecklistItem===t.isChecklistItem&&e.isProgressOnClick===t.isProgressOnClick&&e.isInitial===t.isInitial&&(s=!0)})),!s},this.searchInActiveTriggers=(t,e)=>{const s=window.usetiful_activeTriggersOnElements,i=e,r=[];for(let e=0;e<s.length;e+=1){const n="hover"===t||"focus"===t||"mouseenter"===t||"click"===t?s[e].eventType===t:s[e].eventName===t;if(_s(s[e],this.availableOnPage)&&n){const n=s[e].elementSelector;let o=!1;if("string"==typeof i)o=n===i;else{const e=!n||"window"===n;(e?window:ds(n))===i?o=!0:!i||i instanceof Window||e||"click"!==t&&"mouseup"!==t&&"wheel"!==t&&"mouseover"!==t||(o=Ts(i,n),!o&&ys(i,"a")&&(o=i&&null!==i.querySelector(n)))}o&&r.push(s[e])}}return r},this.addToActiveTriggers=this.removeFromActiveTriggers=t=>{const e=window.usetiful_activeTriggersOnElements.indexOf(t);Vt(`removing item on index ${e} from active triggers`),window.usetiful_activeTriggersOnElements.splice(e,1)},this.removeAllTriggers=t=>{Vt("removeAllTriggers called");[...window.usetiful_activeTriggersOnElements].forEach(((e,s)=>{if(!t&&e.isInitial&&e.isChecklistItem)return;if(Vt(`item ${s}...`),"custom"===e.eventType){if(this.removeFromActiveTriggers(e),window.removeEventListener(e.eventName,this.centralEventListener),e.elementSelector&&"window"!==e.elementSelector){const t=document.querySelector(e.elementSelector);t&&t.removeEventListener(e.eventName,this.centralEventListener)}return}"appears"===e.eventName?(this.removeFromActiveTriggers(e),e.removeAppearTrigger()):this.removeFromActiveTriggers(e)})),this.updateListeners()},this.triggersClearance=t=>{Vt("triggersClearance: Removing triggers from window.usetiful_activeTriggersOnElements..."),window.usetiful_activeTriggersOnElements&&window.usetiful_activeTriggersOnElements.length>0&&(this.removeAllTriggers(t),t&&window.usetiful_activeTriggersOnElements.length>0&&Jt("triggersClearance: No all active triggers were removed"))},window.usetiful_activeTriggersOnElements||(window.usetiful_activeTriggersOnElements=[]),window.usetiful_activeListeners||(window.usetiful_activeListeners=[]),this.availableOnPage=t}}const Us="all-types",Ms="desktop",js="mobile",Fs="tablet",Hs="tag-is-not",Ws="tag-contain",qs="tag-not-contain",Vs="tag-lower",Js="tag-higher",Ks="all-browsers",zs="chrome",Gs="firefox",Ys="edge",Qs="safari",Xs="opera",Zs="blink",ti="all-systems",ei="windows",si="macos",ii="android",ri="linux",ni=["Win32","Win64","Windows","WinCE"].indexOf(window.navigator.platform)>-1,oi=["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(window.navigator.platform)>-1,ai=["iPhone","iPad","iPod"].indexOf(window.navigator.platform)>-1,li=/Android/.test(window.navigator.userAgent),ci=/Linux/.test(window.navigator.platform);class hi{constructor(t){var e=this;this.getWildcardCharacter=this.containWildcard=t=>t.indexOf(this.wildcard)>-1,this.getWildcardIndexes=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.wildcard;const i=[];let r=t.indexOf(s,0);for(;r>=0;)i.push(r),r=t.indexOf(s,r+1);return i},this.checkWildcardURLExact=(t,e)=>{if(""===t.replace(new RegExp(this.wildcard,"g"),""))return!0;const s=t.split(this.getWildcardCharacter()),i=this.getWildcardIndexes(t),r=t.indexOf(s[0])>i[0]||s[0]===t.substring(0,i[0]),n=t.indexOf(s[s.length-1])<i[0]||s[s.length-1]===t.substring(i[i.length-1]+this.wildcard.length);return this.checkWildcardURLContains(t,e)&&r&&n},this.checkWildcardURLContains=(t,e)=>{const s=t.split(this.getWildcardCharacter());if(s.length>2){const t=[];for(let i=0;i<s.length-1;i++){const r=`${s[i]}${this.getWildcardCharacter()}${s[i+1]}`;t.push(this.checkWildcardStringContains(r,e))}return!t.includes(!1)}return this.checkWildcardStringContains(t,e)},this.checkWildcardStringContains=(t,e)=>{if(""===t.replace(new RegExp(this.wildcard,"g"),""))return!0;const s=t.indexOf(this.wildcard),i=t.substring(0,s),r=t.substring(s+this.wildcard.length),n=e.indexOf(i),o=e.indexOf(r);return!(i.length>0&&-1===n||r.length>0&&-1===o||i&&r&&n+i.length>o)},this.wildcard=t}}class ui{constructor(t,e,s){var r=this;this.checkIfInputContainWildcard=this.checkWildcardURLExact=t=>this.wildcard.checkWildcardURLExact(t,this.location),this.checkWildcardURLContains=this.checkURL=t=>{if(this.checkIfInputContainWildcard(t))return this.checkWildcardURLExact(t);try{return new RegExp(t,"i").test(this.location)}catch(e){return console.warn(`Entered regular expression'${t}' isn't valid.`),!1}},this.checkURLSimple=t=>this.checkIfInputContainWildcard(t)?this.checkWildcardURLContains(t):this.location.indexOf(t)>-1,this.checkURLNotContain=t=>this.checkIfInputContainWildcard(t)?!this.checkWildcardURLContains(t):-1===this.location.indexOf(t),this.checkURLExact=t=>this.checkIfInputContainWildcard(t)?this.checkWildcardURLExact(t):this.location===t,this.checkTag=(t,e,s)=>{var i,r;if(!window.usetifulTags||void 0===(null===(i=window.usetifulTags)||void 0===i?void 0:i[t]))return!1;const n=null===(r=window.usetifulTags)||void 0===r?void 0:r[t],o=parseInt(e,10),a=o.toString()===e;switch(s){case Hs:return n!==e||n!==o&&a;case Ws:return n.toString().indexOf(e)>=0;case qs:return-1===n.toString().indexOf(e);case Js:return"number"==typeof n?n>parseInt(e,10):parseInt(n,10)>parseInt(e,10);case Vs:return"number"==typeof n?n<parseInt(e,10):parseInt(n,10)<parseInt(e,10);default:return n===e||n===o&&a}},this.refreshURL=this.checkElement=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(us(t)){const s=ds(t);if(s)return!e||!s.textContent||new RegExp(e).test(s.textContent.trim())}return!1},this.checkAttribute=(t,e,s)=>{if(us(t)){const i=ds(t);if(i){const t=i.getAttribute(e);return!(!t||!s)&&new RegExp(s).test(t.trim())}}return!1},this.checkTriggerURL=t=>!!t&&(!t.url||""!==t.url&&this.checkURL(t.url)),this.checkDevice=t=>{let e=!1;switch(t){case Us:e=!0;break;case Ms:e=_e;break;case js:e=Ae;break;case Fs:e=Oe}return e},this.checkBrowser=t=>{let e=!1;switch(t){case Ks:e=!0;break;case zs:e=pe;break;case Gs:e=ce;break;case Qs:e=he;break;case Xs:e=le;break;case"ie":e=ue;break;case Ys:e=de;break;case Zs:e=ge}return e},this.checkOS=t=>{let e=!1;switch(t){case ti:e=!0;break;case ei:e=ni;break;case si:e=oi;break;case"ios":e=ai;break;case ii:e=li;break;case ri:e=ci}return e},this.checkTargetEntity=(t,e,s,i)=>{if(t[e])return!0;const r=[];return Object.keys(t).forEach((e=>{t[e]&&r.push(s(e))})),i?r.every((t=>t)):r.some((t=>t))},this.checkBrowserLanguage=t=>window.navigator&&window.navigator.language.indexOf(t)>-1,this.checkLS=this.checkTourState=(t,e)=>{const s="state",r=this.api.getStoredObjectData(t);switch(e){case"not-started":return!0;case"completed":return this.completionApi.isCompleted(i,parseInt(t,10));default:if(r&&r[s])return r[s]===e}return!1},this.checkChecklistState=(t,e)=>{switch(e){case"dismissed":return this.dismiss.isChecklistDismiss(t);case"completed":return this.completionApi.isCompleted("checklist",t);default:return!1}},this.checkReferrerURL=(t,e)=>e?document.referrer===t:document.referrer.indexOf(t)>-1,this.evaluate=(t,e,s)=>t?e&&s:e||s,this.checkByTargets=(t,e)=>{let s=!1;const i=!e||0===e;let r=!1,n=!1,o=!1;const a={},l={},c={};return!t||0===t.length||(Array.isArray(t)&&(i&&(s=!0),t.forEach((t=>{var e,h,u;switch(t.type){case"address-exact":s=this.evaluate(i,s,this.checkURLExact(t.url));break;case"address-simple":s=this.evaluate(i,s,this.checkURLSimple(t.url));break;case"address-not-contain":s=this.evaluate(i,s,this.checkURLNotContain(t.url));break;case"address":s=this.evaluate(i,s,this.checkURL(t.url));break;case"tag":s=this.evaluate(i,s,this.checkTag(t.name,t.text,t.operator));break;case"element":s=this.evaluate(i,s,this.checkElement(t.element));break;case"not-element":s=this.evaluate(i,s,!this.checkElement(t.element));break;case"element-text":s=this.evaluate(i,s,this.checkElement(t.element,t.text));break;case"element-attr":s=this.evaluate(i,s,this.checkAttribute(t.element,t.attr,t.text));break;case"target-device":(null===(e=t.device)||void 0===e?void 0:e.length)>0&&(r=!0,a[t.device]=!0);break;case"audience-browser":(null===(h=t.browser)||void 0===h?void 0:h.length)>0&&(n=!0,l[t.browser]=!0);break;case"audience-os":(null===(u=t.os)||void 0===u?void 0:u.length)>0&&(o=!0,c[t.os]=!0);break;case"audience-language":s=this.evaluate(i,s,this.checkBrowserLanguage(t.text));break;case"device-ls-data":s=this.evaluate(i,s,this.checkLS(t.name,t.text));break;case"device-tour-finished":s=this.evaluate(i,s,this.checkTourState(t.tours,t.state));break;case"checklist-state":s=this.evaluate(i,s,this.checkChecklistState(t.checklist,t.state));break;case"referrer-exact":s=this.evaluate(i,s,this.checkReferrerURL(t.url,!0));break;case"referrer-contains":s=this.evaluate(i,s,this.checkReferrerURL(t.url,!1))}})),r&&(s=this.evaluate(i,s,this.checkTargetEntity(a,Us,this.checkDevice,i))),n&&(s=this.evaluate(i,s,this.checkTargetEntity(l,Ks,this.checkBrowser,i))),o&&(s=this.evaluate(i,s,this.checkTargetEntity(c,ti,this.checkOS,i)))),s)},this.checkTargetWithWaiting=function(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60;return new Promise(((i,n)=>{let o=0;const a=setInterval((()=>{o+=1,r.checkAvailableOnPage(t,e)&&(i(null),clearInterval(a)),o>=s&&(clearInterval(a),n())}),500)}))},this.getParsedConditions=t=>{let e=t;try{return!t||t instanceof Object||(e=JSON.parse(t)),e}catch(t){Vt("Targets field is not JSON.")}return!1},this.location=window.location.href,this.wildcard=new hi("{}"),this.api=t,this.completionApi=e,this.dismiss=s}checkAvailableOnPage(t,e){const s=this.getParsedConditions(t);let i=s,r=[];s&&(i=s.filter((),r=s.filter(());let n=this.checkByTargets(i,e);r.length>0&&(!i||0===i.length)&&(n=1!==e);const o=[n];return r&&r.forEach((t=>{o.push(this.checkByTargets(t.targets,t.targetOperator))})),e?o.some((t=>t)):o.every(()}}const di="click",pi="tourCompletion",gi="pageEvent",mi="startTour",fi="immediately",vi="openURL",yi="nothing",wi="done",bi="open",Ti="inProgress",Si="pageEvent";Object.assign(Object.assign({},{url:"",type:"click",element:"",loop:"3"}),{tourId:0,action:"start"});const Ci=class{constructor(t,e){this.saveToStorage=()=>{const t=localStorage.getItem(Bt);this.progressorApi.saveUserData(Bt,t)},this.progressorApi=t,this.checklistData=[],this.alreadyParsed=!1,this.processParseData(),this.completionApi=e}processParseData(){if(this.alreadyParsed)return;const t=this.progressorApi.getUserData(Bt);if(t&&"string"==typeof t){const e=JSON.parse(t);this.saveToLocalStorage(e),this.checklistData=e}else this.loadFromLocalStorage(),this.saveToStorage();this.alreadyParsed=!0}loadFromLocalStorage(){const t=localStorage.getItem(Bt);t&&(this.checklistData=JSON.parse(t))}isRedirected(t){if(this.loadFromLocalStorage(),this.checklistData&&this.checklistData.length>0){return void 0!==this.checklistData.find((e=>e.id===t))}return!1}markAsRedirected(t){this.alreadyParsed=!1,this.processParseData();void 0!==this.checklistData.find(()||(this.checklistData.push({id:t}),this.completionApi.completeItem(pt,t,!0)),this.saveToLocalStorage(this.checklistData),this.saveToStorage()}saveToLocalStorage,ki=(t,e,s,o)=>{const a=new Ci(e,s),{id:l,onClickAction:c,tourId:h,completionOn:u,completionEvent:d}=t;switch(u){case di:if(c===mi){const t=o.getObjectStatus(h.toString());if(t===n)return wi;if(t===r)return Ti}else if((c===vi||c===yi)&&a.isRedirected(l))return wi;break;case gi:return a.isRedirected(l)?wi:Si;case fi:return wi;case pi:if(d){let t="number"!=typeof d.event.tourId?parseInt(d.event.tourId,10):d.event.tourId;if(0===t&&(t=h),t&&"complete"===d.event.action&&s.isCompleted(i,t)||"start"===d.event.action&&o.getObjectStatus(t.toString())===n)return wi}}return bi};var Ei=s(614);const Ii=["uf_progressorLastSaveSuccessful"];const Li=class{constructor(t,e,s){this.keysToRemove=Ii,this.toursData=[],this.checklistsData=[],this.api=t,this.progressorApi=e,this.completionApi=s}init(t,e){this.toursData=t,this.checklistsData=e,this.permanentlyRemoveFromLS(),this.restartTours(),this.api.saveToLocalStorage(this.api.getStoredData()),this.migrateStatesToCompletions(),this.migrateBannersFromCookieToLocalStorage()}permanentlyRemoveFromLS(){this.keysToRemove.forEach(()}restartTours(){this.toursData.filter((t=>{const e=this.api.getStoredObjectData(t.id.toString()),s=t.lastRestartOn,i=null==e?void 0:e.updatedAt;return i&&s&&s>i||s&&!i?t:null})).forEach((t=>{this.api.removeObject(t.id.toString()),this.completionApi.uncompleteItem(i,t.id)}))}migrateStatesToCompletions(){var t;if(null===window.localStorage.getItem(Nt)){const e=[];this.api.getDataByName(_t).forEach((t=>{t.state===n&&e.push({type:i,id:t.id,migration:!0,updatedAt:t.updatedAt})})),null===(t=this.checklistsData)||void 0===t||t.forEach((t=>{const s=t.items;let i=0;null==s||s.forEach((t=>{ki(t,this.progressorApi,this.completionApi,this.api)===wi&&(i+=1,e.push({type:pt,id:t.id,migration:!0,updatedAt:(new Date).toISOString()}))})),i===s.length&&e.push({type:dt,id:t.id,migration:!0,updatedAt:(new Date).toISOString()})})),window.localStorage.setItem(Nt,JSON.stringify(e)),this.completionApi.saveToStorage()}}migrateBannersFromCookieToLocalStorage(){var t;if(null===window.localStorage.getItem(jt)){const e=null!==(t=(0,Ei.getFromLocalStorage)(jt))&&void 0!==t?t:[],s=document.cookie,i=new Map,r="u-banner-version-",n=(new Date).toISOString();s.split(";").forEach((t=>{const[e,s]=t.trim().split("=");e.startsWith(r)&&i.set(e,decodeURIComponent(s))})),i.forEach(((t,s)=>{const i={id:s.replace(r,"").trim(),version:parseInt(t,10),updateAt:n};e.push(i)})),(0,Ei.saveToLocalStorage)(jt,e)}}},Di="smart-tips-group";const xi=class{constructor(t,e,s){var o=this;this.isGivenObject=(t,e)=>{var s;return(null==t?void 0:t.name)===e||t.id===e||(null===(s=null==t?void 0:t.id)||void 0===s?void 0:s.toString())===e},this.setProgressToLocalStorage=(t,e,s)=>{const{name:r,id:n}=e,o=(new Date).toISOString();this.type===i?(this.updateState(n,{state:t,name:r,currentStep:s||0,updatedAt:o}),this.updatePreviewStep(t,s||0)):this.updateState(n,{state:t,id:n,updatedAt:o})},this.getCurrentStepIndexLS=t=>this.getObjectState(t.toString(),"currentStep",0),this.getRunningToursFromLS=()=>{const t=this.getStoredData(),e=[];if(t&&t.length)for(const[s,i]of Object.entries(t)){i.id&&s&&i&&i.state===r&&e.push(i)}return e},this.closeTourInLS=(t,e)=>{var s,i;this.setProgressToLocalStorage(n,{name:e,id:t},0),null===(i=null===(s=window.USETIFUL)||void 0===s?void 0:s.user)||void 0===i||i.syncToProgressor()},this.closeInProgressTour=(t,e)=>{this.getObjectState(t.toString(),"state")===r&&this.closeTourInLS(t.toString(),e)},this.removeObject=t=>{let e=this.getStoredData();e=e.filter(().map((t=>t)),this.progressor&&this.saveToStorage(e),this.saveToLocalStorage(e)},this.removeDuplicities=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.getStoredData(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t,e)=>void 0!==e.id&&void 0!==t.id&&e.id.toString()===t.id.toString();if(t&&t.length){const s=[];return t.forEach((t=>{const i=s.find((s=>e(t,s)));if(i){if(!i.updatedAt||t.updatedAt>i.updatedAt){const i=s.findIndex(();s[i]=t}}else s.push(t)})),s}return[]},this.type=t,this.loadedFromStorage=!1,this.progressorAPI=s,this.progressor=t===i?this.progressorAPI:null,this.storageKeyName=e}getStoredData(){if(this.progressor&&!this.loadedFromStorage){const t=this.progressor.getUserData(this.storageKeyName);if(this.loadedFromStorage=!0,t&&"string"==typeof t){const e=JSON.parse(t);return this.saveToLocalStorage(e),e}}let t=[];const e=window.localStorage.getItem(this.storageKeyName);return e&&(t=JSON.parse(e)),t}getDataByName(t){let e=[];const s=window.localStorage.getItem(t);return s&&(e=JSON.parse(s)),e}getStoredObjectData(t){const e=this.getStoredData();let s=null;return e&&e.length&&(s=e.find(()||null),s}getObjectState(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.getStoredObjectData(t);return i&&i[e]?i[e]:s}setStateByProperty(t,e,s){const i=this.getStoredData().map((i=>this.isGivenObject(i,t)?Object.assign(Object.assign({},i),{[e]:s}):i));this.saveToLocalStorage(i)}updateState(t,e){let s=this.getStoredData();null===this.getStoredObjectData(t)&&(this.type===i?s.push(Object.assign({id:t},e)):this.type===Di&&s.push(Object.assign({},e))),s=s.map((s=>this.isGivenObject(s,t)?Object.assign(Object.assign({},s),e):s)),this.progressor&&this.saveToStorage(s),this.saveToLocalStorage(s)}saveToLocalStorage(t){const e=this.getStoredData(),s=this.removeDuplicities(t);this.shouldUpdateLocalStorage(e,s)&&window.localStorage.setItem(this.storageKeyName,JSON.stringify(s))}shouldUpdateLocalStorage(t,e){if(0===t.length)return!0;if(JSON.stringify(t)===JSON.stringify(e))return!1;if(t.some((t=>void 0===t.id||void 0===t.updatedAt)))return!0;return!!e.some((e=>!t.some((t=>void 0!==t.id&&void 0!==e.id&&t.id.toString()===e.id.toString()))))||e.some((e=>void 0!==t.find((t=>void 0!==t.id&&void 0!==e.id&&t.id.toString()===e.id.toString()&&e.updatedAt>=t.updatedAt))))}addToLocalStorageByKey(t,e,s){const i=this.getDataByName(t).concat(e),r=s?this.removeDuplicities(i,s):this.removeDuplicities(i);window.localStorage.setItem(t,JSON.stringify(r))}datePreviewStep(t,e){let s=e;t===n&&(s=-1),window.dispatchEvent(new CustomEvent("updatePreviewStep",{detail:s}))}getRunningTour(t){const e=this.getStoredData();if(e&&e.length)for(const[s,i]of Object.entries(e)){const e=i.id;if(e&&s&&i&&i.state===r&&(!t||t&&t.find((t=>t.id===e))))return e}return null}isTourReopenFromLS(t){return this.getObjectStatus(t)===n}};const Pi=class{constructor(t){this.saveToLocalStorage=this.isCompleted=(t,e)=>void 0!==this.api.getDataByName(this.getStorageKey()).find((s=>s.type===t&&s.id===e)),this.uncompleteItem=(t,e)=>{if(!this.isCompleted(t,e))return;const s=this.api.getDataByName(this.getStorageKey()),i=s.findIndex(();-1!==i&&(s.splice(i,1),this.saveToLocalStorage(JSON.stringify(s)),this.saveToStorage())},this.getStorageKey=()=>Nt,this.saveToStorage=()=>{const t=this.api.getDataByName(this.getStorageKey());this.api.progressorAPI.saveUserData(this.getStorageKey(),JSON.stringify(t))},this.api=t,this.loadDataFromProgressor()}loadDataFromProgressor(){const t=this.api.progressorAPI.getUserData(this.getStorageKey());if(t&&"string"==typeof t){const e=this.api.getDataByName(this.getStorageKey()),s=JSON.parse(t);this.api.shouldUpdateLocalStorage(e,s)&&this.saveToLocalStorage(t)}}completeItem(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCompleted(t,e))return;if(this.api.addToLocalStorageByKey(this.getStorageKey(),[{type:t,id:e,updatedAt:(new Date).toISOString()}],((t,e)=>void 0!==e.id&&void 0!==t.id&&e.id.toString()===t.id.toString()&&void 0!==e.type&&void 0!==t.type&&e.type.toString()===t.type.toString())),this.saveToStorage(),s){const s=new CustomEvent(M,{detail:{type:t,itemId:e,action:X,isDevKit:!1}});document.dispatchEvent(s)}}},Ai="BeforeUnload",Oi="SpaceApi",_i="ReporterApi",$i="Report",Bi="TourTriggersControl",Ri="CommonTriggersControl",Ni="Loader",Ui="ProgressorApi",Mi="UsetifulTags",ji="Dismiss",Fi="ButtonControl",Hi="AvailableOnPage",Wi="LocalStorageCleaner",qi="StorageApiTour",Vi="StorageApiSmartTips",Ji="CompletionApi",Ki={LocalStorage:"LocalStorage",apiToken:"apiToken",reporterBasePath:"reporterBasePath",license:"license",watermark:"watermark",assistantInstance:"assistantInstance",checklistInstance:"checklistInstance",toursInstance:"toursInstance",tourType:i,smartTipsType:Di,tourStorageKeyName:_t,smartTipsGroupStorageKeyName:$t},zi=new Xt,Gi=t=>zi.get(t),Yi=function Qi(t){return t.split("-")[0]}nction tr(t){return"y"===t?"height":"width"}t nr=Math.min,or=Math.max;onst lr={left:"right",right:"left",bottom:"top",top:"bottom"};function cr(t){return t.replace(/left|right|bottom|top/g,(t=>lr[t]))}onst ur={start:"end",end:"start"};onst pr=["top","right","bottom","left"],gr=pr.reduce((,[]);const mr=onst vr=ion Cr(t){return t instanceof wr(t).HTMLElement}Pr=Math.min,Ar=Math.max,Or=Math.round;ClippingRect:convertOffsetParentRelativeRectToViewportRelativeRect:isElement:kr,getDimensions:Fr,getOffsetParent:jr,getDocumentElement:$r,getElementRects:getClientRects:isRTL:;onst zr=Gr=()=>{(t=>{const e=document.querySelectorAll(`.${We.overlay}`);e&&Array.prototype.forEach.call(e,(e=>{e.classList.remove(t)}))})(We.visible)},Yr=()=>{(t=>{const e=document.querySelectorAll(`.${We.overlay}`);e&&Array.prototype.forEach.call(e,(e=>{e.classList.add(t)}))})(We.visible)},Qr=()=>{const t=document.querySelectorAll(`.${We.overlay}`);t&&Array.prototype.forEach.call(t,()};unction Zr(t,e){if(t.removeAttribute("data-show"),e){const t=document.getElementById(e);null==t||t.classList.remove("max-zindex")}const s=new CustomEvent(U,{detail:{bubbleId:t.getAttribute("id")}});document.dispatchEvent(s)}const tn=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"absolute";const e=(()=>{const t={};return["right","left","top","bottom"].forEach((e=>{let s=document.querySelector(`.${We.overlay}.${We[e]}`);s||(s=document.createElement("div"),s.classList.add(We.overlay,We[e]),document.body.appendChild(s)),t[e]=s})),t})();return Object.values(e).forEach((),Yr(),e},en=t=>({name:"backdrop",options:t,fn(e){var s,i;if(t)if(null===(i=null===(s=e.modifiersData)||void 0===s?void 0:s.hide)||void 0===i?void 0:i.isReferenceHidden)Gr();else{const{x:s,y:i,width:r,height:n}=e.rects.reference;!function(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const{top:r,left:n,right:o,bottom:a}=t,{x:l,y:c,width:h,height:u}=e||{x:0,y:0,width:0,height:0},{max:d,min:p,floor:g}=Math,{clientHeight:m,scrollHeight:f,clientWidth:v,scrollWidth:y}=document.body,{innerHeight:w,innerWidth:b}=window,T="fixed"===s?w-1:d(w,m,f),S="fixed"===s?b-1:d(v,y,b),C=g(d(l-i,0)),k=g(d(c-i,0)),E=g(p(l+i+h,S)),I=g(p(c+i+u,T));n.style.width=`${C}px`,n.style.height=`${T}px`,r.style.left=`${C}px`,r.style.width=E-C+"px",r.style.height=`${k}px`,a.style.left=`${C}px`,a.style.top=`${I}px`,a.style.width=E-C+"px",a.style.height=T-I+"px",o.style.left=`${E}px`,o.style.height=`${T}px`,o.style.width=S-E+"px"}(t,{x:s,y:i,width:r,height:n},e.strategy,5),Yr()}return e}}),sn=t=>t?function(t){return void 0===t&&(t={}),{name:"autoPlacement",options:t,async fn(e){var s,i,r,n,o;const{x:a,y:l,rects:c,middlewareData:h,placement:u,platform:d,elements:p}=e,{alignment:g=null,allowedPlacements:m=gr,autoAlignment:f=!0,...v}=t,y=g,f,m),w=await rr(e,v),b=null!=(s=null==(i=h.autoPlacement)?void 0:i.index)?s:0,T=y[b];if(null==T)return{};const{main:S,cross:C}=hr(T,c,await(null==d.isRTL?void 0:d.isRTL(p.floating)));if(u!==T)return{x:a,y:l,reset:{placement:y[0]}};const k=[w[Qi(T)],w[S],w[C]],E=[...null!=(r=null==(n=h.autoPlacement)?void 0:n.overflows)?r:[],{placement:T,overflows:k}],I=y[b+1];if(I)return{data:{index:b+1,overflows:E},reset:{placement:I}};const L=E.slice().sort((),D=null==(o=L.find(())?void 0:o.placement,x=null!=D?D:L[0].placement;return x!==u?{data:{index:b+1,overflows:E},reset:{placement:x}}:{}}}}():);function rn(t){return window.innerWidth<1e3?"auto":t}const nn=t=>{let{targetElement:e,bubble:s,orientation:i,extraModifier:r}=t;i=rn(i);const n=s.querySelector("[data-floating-arrow]");let o=[mr(25),sn("auto"===i),vr({padding:5,crossAxis:!0})];return r&&r.length&&(o=[...o,...r]),n&&o.push((({element:n})),zr(e,s,{placement:"auto"!==i?i:void 0,middleware:o}).then((t=>{let{x:e,y:i,placement:r,middlewareData:o}=t;Object.assign(s.style,{left:`${e}px`,top:`${i}px`}),s.setAttribute("data-floating-placement",r);const a=o.arrow;n&&Object.assign(n.style,{left:null!=(null==a?void 0:a.x)?`${null==a?void 0:a.x}px`:"",top:null!=(null==a?void 0:a.y)?`${null==a?void 0:a.y}px`:"",right:"",bottom:""})}))};const on=class{constructor(t,e){this.getReverseEventName=this.linkClickAction=t=>{t.target instanceof HTMLAnchorElement&&t.target.href&&window.open(t.target.href,t.target.target)},this.registerClickEventsInBubble=t=>{t.querySelectorAll("a").forEach((t=>{t.addEventListener("mousedown",this.linkClickAction)}))},this.unRegisterClickEventsInBubble=t=>{t.querySelectorAll("a").forEach((t=>{t.removeEventListener("mousedown",this.linkClickAction)}))},this.getTarget=(t,e)=>{const{target:s}=t;try{const t=s.closest(e);if(t)return t}catch(t){return s}return s},this.preActions=(t,e)=>{if("focus"===t){const t=ds(e);t instanceof Element&&!t.hasAttribute("tabindex")&&t.setAttribute("tabindex","0")}},this.processEvents=(t,e,s)=>{var i,r;const n=ms(e);n.isAShadowDomSelector&&n.childSelector&&(e=n.childSelector);let o,a=this.getReverseEventName(t)||"";this.preActions(t,e);const l=i=>{const r=this.getTarget(i,e);if(e&&r&&r instanceof HTMLElement&&r.matches(e)){switch(t){case"mouseover":r.removeEventListener(a,this.hideCallbackFunction),this.showPositionedElement(r,s,(()=>{this.hideCallbackFunction(s)})),r.addEventListener(a,(()=>{this.hideCallbackFunction(s)}));break;case"focus":o=Se(r,s,null==n?void 0:n.shadowDomSelector),this.showPositionedElement(r,s,(()=>{Ce(o),this.unRegisterClickEventsInBubble(s),this.hideCallbackFunction(s)})),this.registerClickEventsInBubble(s),r.addEventListener(a,(()=>{Ce(o),this.unRegisterClickEventsInBubble(s),this.hideCallbackFunction(s)}));break;case"click":o=Se(r,s,null==n?void 0:n.shadowDomSelector),this.showPositionedElement(r,s,(()=>{Ce(o),this.unRegisterClickEventsInBubble(s),this.hideCallbackFunction(s)})),this.registerClickEventsInBubble(s);break;default:a=""}o&&window.addEventListener(be,(t=>{let{detail:e}=t;Ce(o),this.unRegisterClickEventsInBubble(s),this.hideCallbackFunction(e)}))}};window.usetiful_smartTipsAddedEvents||(window.usetiful_smartTipsAddedEvents=[]),window.usetiful_smartTipsAddedEvents.push({eventName:t,eventFunction:l}),n.isAShadowDomSelector&&n.shadowDomSelector?null===(r=null===(i=document.querySelector(n.shadowDomSelector))||void 0===i?void 0:i.shadowRoot)||void 0===r||r.addEventListener(t,l,!0):document.addEventListener(t,l,!0)},this.showPositionedElement=(t,e,s)=>{this.showCallbackFunction(t,e,!1,s),window.addEventListener("resize",()},this.init=this.showCallbackFunction=t,this.hideCallbackFunction=e}},an="reaction",ln={activeStepId:0,values:{feedback:!1,surveyType:an,surveyId:null,surveyQuestion:"",surveyMinimalValueLabel:"",surveyMaximalValueLabel:""},handleUpdateValue:()=>{}},cn="Primary",hn="Secondary",un={};un[ss]={value:"Next",type:ss,styleType:cn},un[is]={value:"Previous",type:is,styleType:hn},un[rs]={value:"Go to",type:rs,styleType:cn,to:""},un[ns]={value:"Go to",type:ns,styleType:cn,url:""},un[os]={value:"Another tour",type:os,styleType:hn,url:"",tourId:0},un[as]={value:"Close",type:as,styleType:hn,cross:!1};const dn={actions:[un[ss]]},pn={actions:[un[is],un[ss]]},gn="Manual",mn="Automatic",fn=[Ke,ze,Ye,Ge],vn=([{name:qe,label:"Pointer",category:gn},{name:Ve,label:"Modal",category:gn},{name:Je,label:"Slideout",category:gn},{name:Ke,label:"Redirect",category:mn},{name:ze,label:"Delay",category:mn},{name:Ge,label:"Trigger event",category:mn,permissions:[m,f],helpMessage:"Send automated events when user reaches a certain step of the tour. This feature is available in premium plan or higher."},{name:Ye,label:"Page action",category:mn,permissions:[m,f],helpMessage:"Perform automatic action on the page when user reaches a certain step of the tour. This feature is available in premium plan or higher."}].filter((),{title:"Step",content:"Write your content here...",publicTitle:!0,surveyData:ln.values}),yn={};yn[qe]=Object.assign(Object.assign({type:qe,highlight:!0,coordinates:{left:0,top:0,right:0,bottom:0},element:"",progressOnClick:t,runDefaults:!1,position:"auto",positionType:"element"},vn),pn),yn[Ve]=Object.assign(Object.assign({type:Ve},vn),dn),yn[Je]=Object.assign(Object.assign({type:Je,element:"",progressOnClick:t,runDefaults:!1,position:"right"},vn),dn),yn[Ke]={type:Ke,title:"Redirect",automatic:!0},yn[ze]={type:ze,title:"Delay",delay:"3"},yn[Ge]={type:Ge,title:"Trigger Event",eventType:ts,webhookUrl:"",element:"",eventName:"",eventContent:""},yn[Ye]={type:Ye,title:"Page action",element:"",actionType:Ze,actionValue:""};const wn="element",bn="beacon";var Tn,Sn=function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)};Tn=new WeakMap;const Cn=class{constructor(t){this.init=()=>{window.usetiful_smartTipsAddedEvents&&window.usetiful_smartTipsAddedEvents.length&&window.usetiful_smartTipsAddedEvents.forEach((t=>{document.removeEventListener(t.eventName,t.eventFunction,!0)}));const t=Gi(Ni);if(Vt("Start loading smart tips."),void 0===this.smartTipsGroups)return void Vt("There is no smart tips here");Vt("Checking available smart tips...");for(const e of this.smartTipsGroups){const{name:s,targets:i,tips:r,theme:n,themeSlug:o,targetOperator:a}=e;this.template.removeAllBeacons();let l=0;const c=setInterval((()=>{l+=1,Gi(Hi).checkAvailableOnPage(zt(i),a)&&this.showToUser(e)&&(t.loadTheme(n,o).then((t=>{this.template.setTheme(t);for(const t of r)t.bubble=this.template.createBubble({ident:t.name,contentHTML:t.content,title:this.template.createTitle(4,t.title)||null,hotspot:t.hotspot,customStyle:t.customStyle||null}),this.initSmartTip(t);r.length&&(this.allAvailableSmarTipsWithBeacon.push(...r),this.hotspotController())})),clearInterval(c),this.localStorageHandler.setProgressToLocalStorage("seen",e)),l>=60&&(clearInterval(c),Vt(`smart tip ${s} stop loading (limit reached)`))}),500);window.usetiful_intervals.push(c)}const e=setInterval((,2e3);window.usetiful_intervals.push(e)},this.showToUser=t=>{const{id:e,trigger:s}=t;return!s||s&&("everytime"===s.type||"once"===s.type&&!this.localStorageHandler.getObjectState(e,"state"))},this.initSmartTip=t=>{const{id:e,name:s,element:i,displayOn:r,targetOn:n,hotspot:o,orientation:a,bubble:l}=t;if(Vt(`smart tip ${s} loaded`),l instanceof HTMLElement){const t=new on(((t,i,o,l)=>this.showSmartTipEventListener(t,i,a,o,s,e,l,void 0,r,n)),Zr);o&&n===bn||t.init(r,i,l)}},this.showSmartTipEventListener=(t,e,s,i,r,n,o,a,l,c,h,u)=>{if(Vt(`Smart tip displayOn: ${l} and targetOn ${c}.`),i)return;Xr(e);let d=h?ds(h):null;if(d||(d=u?ds(u):null),nn({targetElement:d||t,bubble:e,orientation:s}),this.waitingTips.indexOf(r.toString())<0&&this.waitingTips.push(r.toString()),window.setTimeout((()=>{if(this.waitingTips.indexOf(r.toString())>-1){Vt(`View of smart tip ${r.toString()} reported.`);const t=new CustomEvent(M,{detail:{type:"smartTip",entityId:r,stepIndex:0,action:J,itemId:n,isDevKit:!1}});document.dispatchEvent(t)}else Jt(`Smart tip ${r.toString()} was displayed for less than 1 sec. Sending to reporter skipped.`);this.waitingTips=this.waitingTips.filter(()}),1e3),a){const t=document.getElementById(a);null==t||t.classList.add("max-zindex")}if(o){const{body:s}=document;s&&setTimeout((()=>{this.oldTarget&&(this.oldTarget.removeEventListener("click",Sn(this,Tn,"f")),this.oldTarget=void 0),this.oldBeacon&&(this.oldBeacon.removeEventListener("click",Sn(this,Tn,"f")),this.oldBeacon=void 0),s.addEventListener("click",(()=>{o()}),{once:!0}),"click"===l&&(Vt(`Smart tip displayOn ${l} was displayed`),e.addEventListener("click",Sn(this,Tn,"f")),t.addEventListener("click",Sn(this,Tn,"f")),this.oldTarget=t,a&&(this.oldBeacon=document.getElementById(a),this.oldBeacon&&this.oldBeacon.addEventListener("click",Sn(this,Tn,"f"))))}),0)}},this.hotspotController=()=>{const t=this.allAvailableSmarTipsWithBeacon.filter((t=>t.hotspot)),e=[];t.forEach((t=>{const s=(t=>{if(!t)return;const e=[];for(let s=0;s<t.length;s+=1){const i=t[s];Cs(void 0,void 0,i)||e.push(i)}return e})(ps(t.element));null==s||s.forEach((s=>{let i=s.getAttribute("data-beacon-id");if(!i){const t=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,e="US";for(let s=0;s<t;s+=1)e+=Math.random().toString(36).substr(2,1);return e}();i=t,s.setAttribute("data-beacon-id",t)}e.push({element:s,beaconId:i,smartTip:t})}))}));const{added:s,deleted:i}=function(t,e){const s=e.filter((e=>!t.find((t=>t.beaconId===e.beaconId)))),i=t.filter(();return{added:s,deleted:i}}(this.hotSpotMemoryList,e);s.length&&s.forEach((t=>{const e=this.template.createBeacon(t.beaconId,function(t){var e;let s=t,i="auto";for(;s;){const{position:t}=getComputedStyle(s);if("static"!==t){const t=parseInt(null===(e=getComputedStyle(s))||void 0===e?void 0:e.zIndex,10);Number.isNaN(t)||(i=t.toString())}s=s.parentElement}return i}(t.element),t.smartTip.hotspot.type,t.smartTip.customStyle);if(t.smartTip.bubble&&(t.smartTip.bubble.classList.remove(this.template.themeClasses.bubbleInvisible),((t,e,s,i,r)=>{Zr(s),e.orientation||(e.orientation="auto"!==i?i:"right"),"top"!==e.orientation&&0!==e.offsetVertical&&(e.offsetVertical=e.offsetVertical<0?Math.abs(e.offsetVertical):-Math.abs(e.offsetVertical)),"left"===e.orientation&&0!==e.offsetHorizontal&&(e.offsetHorizontal=e.offsetHorizontal<0?Math.abs(e.offsetHorizontal):-Math.abs(e.offsetHorizontal));const n="top"===e.orientation||"bottom"===e.orientation,o={mainAxis:-15+(n?e.offsetVertical:e.offsetHorizontal),crossAxis:0+(n?e.offsetHorizontal:e.offsetVertical)},a=s=>zr(t,r,{placement:e.orientation,middleware:[mr(o)]}).then((t=>{let{x:e,y:i}=t;Object.assign(r.style,{left:`${e}px`,top:`${i}px`}),s&&s()}));Kr(t,r,(()=>a()),{animationFrame:!0}),Kr(t,r,(()=>a()),{ancestorScroll:!0})})(t.element,Object.assign({},t.smartTip.hotspot),t.smartTip.bubble,t.smartTip.orientation,e),t.smartTip.hotspot&&t.smartTip.targetOn!==wn)){new on(((e,s,i,r)=>this.showSmartTipEventListener(t.element,s,t.smartTip.orientation,i,t.smartTip.name,t.smartTip.id,r,t.beaconId,t.smartTip.displayOn)),().init(t.smartTip.displayOn,`#${t.beaconId}`,t.smartTip.bubble)}})),i.length&&i.forEach((t=>{const e=ds(`#${t.beaconId}`);null==e||e.remove()})),this.hotSpotMemoryList=e},Tn.set(this,(t=>{t.stopPropagation()})),this.registerListeners=()=>{document.addEventListener(U,(t=>{this.waitingTips=this.waitingTips.filter(()}))},this.smartTipsGroups=t,this.isWatermark=Gi(Ki.watermark),this.template=new Ps(null,this.isWatermark),this.localStorageHandler=Gi(Vi),this.oldTarget=null,this.oldBeacon=null,this.waitingTips=[],this.hotSpotMemoryList=[],this.allAvailableSmarTipsWithBeacon=[],this.registerListeners()}};var kn='<svg class="svg-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="9" stroke="#000" stroke-width="1.5" stroke-linecap="round"/></svg>';const En=class{constructor(t,e,s,i){this.checklistItemAction=t=>{const{id:e,onClickAction:s,tourId:i,url:r,urlOpenTargetBlank:n,completionOn:o}=this.checklistItem;if(s===mi&&i>0&&(r&&""!==r?this.tourTriggers.setTourTriggerToLocalStorage(i):this.runTourOnClickAction(t,i)),s!==yi&&r&&""!==r){o===di&&(this.redirects.markAsRedirected(e),this.processStateClasses());const t=n||!1;t&&this.updateProgressorData(),Bs((0,V.replaceTags)(r),t)}s===yi&&o===di&&(this.redirects.markAsRedirected(e),this.processStateClasses())},this.updateProgressorData=()=>{const t=Gi(Ui);t.saveToApi(t.getUserId())},this.computeItemState=()=>(((t,e,s,i)=>{const r=new Ci(e,s),{id:o,onClickAction:a,tourId:l,completionOn:c}=t;(c===di&&a===mi&&i.getObjectStatus(l.toString())===n||c===fi)&&r.markAsRedirected(o)})(this.checklistItem,Gi(Ui),this.completionApi,Gi(qi)),ki(this.checklistItem,Gi(Ui),this.completionApi,Gi(qi))),this.processStateClasses=()=>{const t=this.computeItemState();t!==Si&&this.changeItemStyle(t)},this.changeItemStyle=t=>{switch(t){case wi:this.itemElement.classList.add(this.template.themeClasses.done),this.itemElement.dataset.ufStatus="done",this.template.changeItemToDoneStyle(this.checklistItem.id),this.template.checklistProgressUpdate();break;case Ti:this.itemElement.classList.add(this.template.themeClasses.inProgress),this.itemElement.dataset.ufStatus="in-progress";break;case bi:this.itemElement.classList.remove(this.template.themeClasses.done),this.itemElement.dataset.ufStatus="init",this.itemElement.classList.remove(this.template.themeClasses.inProgress)}},this.checklistItemIcon=()=>{switch(this.computeItemState()){case bi:return kn;case wi:return'<svg class="svg-icon filled" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M12 3.75a8.25 8.25 0 100 16.5 8.25 8.25 0 000-16.5zM2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12z"/><path clip-rule="evenodd" d="M16.465 8.411a.75.75 0 01.124 1.054l-4.404 5.577a1.25 1.25 0 01-1.827.145l-2.866-2.635a.75.75 0 111.016-1.104l2.667 2.453 4.236-5.366a.75.75 0 011.054-.124z"/></svg>';case Ti:return'<svg class="svg-icon filled" width="20" height="20" viewBox="0 0 40 32" xmlns="http://www.w3.org/2000/svg"><path d="M3.968 12.061A3.965 3.965 0 000 16.027a3.965 3.965 0 003.968 3.967 3.966 3.966 0 100-7.933zm12.265 0a3.967 3.967 0 00-3.968 3.965c0 2.192 1.778 3.967 3.968 3.967s3.97-1.772 3.97-3.967a3.97 3.97 0 00-3.97-3.965zm11.857 0a3.967 3.967 0 10-.005 7.933 3.967 3.967 0 00.005-7.933z"/></svg>';default:return kn}},this.render=()=>(this.itemElement.innerHTML=`${this.checklistItemIcon()}<span>${(0,V.replaceTags)(this.checklistItem.title)}</span>`,this.itemElement),this.checklistItem=t,this.template=e,this.runTourOnClickAction=s,this.tourTriggers=i,this.itemElement=this.template.createButton("",this.template.themeClasses.button),this.itemElement.classList.add(this.template.themeClasses.buttonBlock),this.itemElement.dataset.id=this.checklistItem.id,this.itemElement.addEventListener("click",(t=>{if(t&&t.target instanceof HTMLElement){const e=t.target.closest('[data-uf-content="checklist"]'),s=null==e?void 0:e.dataset.id,i=new CustomEvent(M,{detail:{type:pt,entityId:s,itemId:this.checklistItem.id,action:z,isDevKit:!1}});document.dispatchEvent(i)}this.checklistItemAction(t)}),!1),this.completionApi=Gi(Ji),this.redirects=new Ci(Gi(Ui),this.completionApi),this.processStateClasses()}},In=(t,e)=>{const s=new CustomEvent(k,{detail:{type:t,id:e}});document.dispatchEvent(s)};window.USETIFUL||(window.USETIFUL={});class Ln{constructor(t,e){this.setTourSelection=this.isTourSelectionEnabled=t=>{const e=window.localStorage.getItem(u);return"enabled"===e||null===e&&!t},this.destroy=()=>{var t;this.hideTourSelection(),(null===(t=this.mainButton.id)||void 0===t?void 0:t.startsWith("checklist"))&&this.mainButton.destroy()},this.init=()=>{this.hideTourSelection(),((t,e,s)=>{const i={start:s=>{const i=t.find((t=>t.id===s));if(!i)throw new Error("Your checklist Id is not valid!");In(y,s),setTimeout((()=>{window.localStorage.setItem(c,i),window.localStorage.setItem(u,"enabled"),e(i)}),500)},close:()=>{},done:(i,r)=>{const n=localStorage.getItem(c);if(r)r!==n&&window.USETIFUL.checklist.close();else if(!(r=n))throw new Error("Please send checklistId as a second parameter or run a checklist by start API");const o=t.find((t=>t.id===r));if(!o)throw new Error("Your checklist Id is not valid!");i.forEach((t=>{if(!o.items.length||!o.items[t-1])throw new Error("Your row number is not valid!");const e=o.items[t-1];if("startTour"===e.onClickAction&&e.completionOn===di){let t=[];const s=localStorage.getItem(_t);s&&(t=JSON.parse(s)),t.push({id:e.tourId,name:"",currentStep:0,state:"closed"}),localStorage.setItem(_t,JSON.stringify(t))}else{let t=[];const s=localStorage.getItem(Bt);s&&(t=JSON.parse(s)),t.push({id:e.id}),localStorage.setItem(Bt,JSON.stringify(t))}})),s(),window.localStorage.setItem(c,o),window.localStorage.setItem(u,"enabled"),e(o)}};window.USETIFUL.checklist=i})(this.checklists,this.runChecklist,this.hideTourSelection)},this.dismissChecklist=t=>{Vt("dismiss checklist called");const e=new CustomEvent(M,{detail:{type:dt,entityId:t,action:Z,isDevKit:!1}});document.dispatchEvent(e),localStorage.removeItem(c),this.dismiss.setDismissValue(!0,t);const s=new Event(S);document.dispatchEvent(s)},this.getLiveChecklists=()=>{const t=[];return this.checklists.forEach((),t},this.checkAvailables=()=>(Vt("Start loading checklist"),Vt("Checking available checklists..."),new Promise(((t,e)=>{if(0===this.checklists.length)Vt("There is no checklists here"),e();else for(const e of this.checklists.sort(()){const{id:s,targets:i,targetOperator:r}=e;this.dismiss.isChecklistDismiss(s)||this.availableOnPage.checkTargetWithWaiting(zt(i),r).then((()=>{t(e)}),(()=>{}))}}))),this.showTourSelection=(t,e)=>{this.setTourSelection("enabled"),this.isLoaded=!0;const{id:s,name:i,items:r,labels:n,progressBar:o,dismiss:a,alignment:l,showCompleteMessage:c,completionEvent:h,congratulation:u}=t,{dismiss:{text:d,description:p,confirm:g,cancel:m}}=n,f=document.querySelector(`.${this.template.themeClasses.tourSelection}`),v=new CustomEvent(M,{detail:{type:dt,entityId:s,action:G,isDevKit:!1}});document.dispatchEvent(v);const y=this.getCompletedItems(r);if(f)return void f.classList.add(We.visible);const w=y.length===r.length;w&&(this.completionApi.completeItem(dt,s,!0),y.forEach((t=>{this.completionApi.completeItem(pt,t.id,!0)})));const b=("message"===h||c)&&w&&u;if(w&&"dismiss"===h)return this.dismissChecklist(s),void this.mainButton.destroy();const T=document.createElement("h3");T.dataset.ufElement="title",T.classList.add(this.template.themeClasses.title),o||T.classList.add(this.template.themeClasses.titleWithoutProgress),T.innerHTML=(0,V.replaceTags)(b?u.title:i);const S=[this.template.themeClasses.tourSelection];b&&S.push(this.template.themeClasses.congratulation),this.template.notifyUser("checklist",T,o&&!b?`<span class="${this.template.themeClasses.progressValue}">${Math.round(y.length/(r.length/100))}%</span><div class="${this.template.themeClasses.progress}"><div class="${this.template.themeClasses.progressbar}" style="width: ${Math.round(y.length/(r.length/100))}%;"></div></div>`:null,(()=>{const t=this.template.createWrapper(this.template.themeClasses.actions);if(b){t.classList.add(this.template.themeClasses.actionsPaddingAround);const e=document.createElement("div");e.innerHTML=(0,V.replaceTags)(u.content),t.append(e)}else for(const s of r){const i=new En(s,this.template,((t,s)=>e(t,s,!0,(()=>{this.hideTourSelection()}))),this.tourTriggers);t.append(i.render())}if(a){const e=this.template.createWrapper(this.template.themeClasses.bottomAction);e.classList.add(this.template.themeClasses.bottomAction);const i=this.template.createLink(d,"");i.addEventListener("click",(t=>{this.template.confirmation("",p,g,m,(()=>{bs(`.${this.template.themeClasses.notification}`),bs(`.${this.template.themeClasses.buttonMain}`),this.dismissChecklist(s)}),l),t.stopImmediatePropagation(),t.preventDefault()}),!1),e.append(i),t.append(e)}return t}),S,(,l,s)},this.hideTourSelection=()=>{bs(`.${this.template.themeClasses.tourSelection}`),this.selectedChecklist=null},this.isAvailableChecklist=()=>this.checklists&&this.checklists.length>0&&!this.dismiss.isAllChecklistsDismissed(this.checklists),this.showChecklist=t=>{localStorage.setItem(c,t.id),this.selectedChecklist=t,this.showTourSelection(t,((t,e)=>this.runTourOnClickAction(t,e,!0,(()=>{this.hideTourSelection()}))))},this.placeTriggers=()=>{this.isAvailableChecklist()&&(this.selectedChecklist?this.placeChecklistItemsTriggers(this.selectedChecklist):this.checkAvailables().then((t=>{this.placeChecklistItemsTriggers(t)})))},this.loadChecklist=()=>{this.isAvailableChecklist()?this.selectedChecklist?this.showTourSelection(this.selectedChecklist,this.runTourOnClickAction):this.checkAvailables().then((t=>{this.runChecklist(t)})):this.isLoaded=!1},this.getCompletedItems=t=>{const e=Gi(qi);return t.filter((t=>ki(t,Gi(Ui),this.completionApi,e)===wi))},this.runChecklist=t=>{if(this.isDestroyed)return;this.isLoaded=!0;const{id:e,button:s,items:i,theme:r,themeSlug:n,alignment:o}=t;this.loader.loadTheme(r,n).then((r=>{if(this.template.setTheme(r),this.mainButton.setTheme(r),null==s?void 0:s.visible){this.mainButton.setAvailableTours(i);const r=i.length-this.getCompletedItems(i).length;this.mainButton.prepareMainButton(`checklist_${e}`,this.mainButton.getButtonLabelContent((null==s?void 0:s.label)||"Get Started",r),(()=>{this.showChecklist(t)}),o),this.isTourSelectionEnabled(null==s?void 0:s.collapsed)&&this.showChecklist(t)}else this.showChecklist(t)}))},this.placeChecklistItemsTriggers=t=>{t.items.forEach((t=>{const{completionEvent:e,id:s}=t;if(t.completionOn===gi&&e.type===gi){const t=new Os(e.event,this.availableOnPage);t.isChecklistItem=!0,t.triggerFunction=this.markAsDoneEvent,t.checklistItemId=s;Gi(Ri).placeTrigger(t),this.placedTriggers.push(t)}}))},this.removeTriggers=()=>{if(this.placedTriggers.length>0){const t=Gi(Ri);this.placedTriggers.forEach((e=>{t.removeFromActiveTriggers(e)})),this.placedTriggers=[]}},this.markAsDoneEvent=t=>{new Ci(Gi(Ui),this.completionApi).markAsRedirected(t),this.template.changeItemToDoneStyle(t),this.template.checklistProgressUpdate()},this.destroyInstance=()=>{this.removeTriggers(),bs("[data-uf-button='button-main']"),bs("[data-uf-content='checklist']"),this.isDestroyed=!0,this.checklists=[]},this.checklists=t,this.runTourOnClickAction=e,this.tourTriggers=Gi(Bi),this.loader=Gi(Ni),this.selectedChecklist=null,this.mainButton=Gi(Fi),this.isWatermark=Gi(Ki.watermark),this.dismiss=Gi(ji),this.isLoaded=!1,this.template=new Ps(null,this.isWatermark),this.availableOnPage=Gi(Hi),this.isDestroyed=!1,this.placedTriggers=[],this.completionApi=Gi(Ji)}}var Dn='<svg xmlns="http://www.w3.org/2000/svg"><path stroke="#000" stroke-width="2" d="M1 16L16 1M1 1l15 15"/></svg>',xn='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 21"><path data-name="Rectangle 1" d="M25 21H4V0h21z" fill="none"/><path data-name="Path 1" d="M13.594 11.594l-5.16 5.16a.84.84 0 11-1.189-1.188L11.812 11 7.247 6.434a.84.84 0 011.188-1.188l5.16 5.16a.84.84 0 010 1.188z" fill="#1d1d1d"/></svg>';const Pn=class{constructor(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getThemeClasses=this.getTitle=t=>{const e=document.createElement("h3");return e.classList.add(this.getThemeClasses().title),e.dataset.ufElement="title",e.innerHTML=t,e},this.createLink=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_self";const r=document.createElement("a");return r.classList.add(t.getThemeClasses().button,t.getThemeClasses().buttonBlock),r.href=(0,V.replaceTags)(s),r.target=i,r.innerHTML=`<span>${(0,V.replaceTags)(e)}</span><div class="${[t.template.themeClasses.buttonIcon,t.template.themeClasses.buttonIconRight].join(" ")}">${xn}</div>`,r},this.createButton=(t,e)=>{const s=document.createElement("button");return s.classList.add(this.getThemeClasses().button,this.getThemeClasses().buttonBlock),s.onclick=e,s.innerHTML=`<span>${(0,V.replaceTags)(t)}</span><div class="${[this.getThemeClasses().buttonIcon,this.getThemeClasses().buttonIconRight].join(" ")}">${xn}</div>`,s},this.createSearchResult=(t,e,s)=>{const i=document.createElement("span"),r=document.createElement("a");return r.href="javascript:void(0);",r.onclick=s,r.innerText=t,i.innerHTML=`<p>${e}</p>`,i.prepend(r),i},this.showArticle=(t,e,s,i,r)=>{const n=document.createElement("div");n.dataset.ufContent="slideout",n.classList.add(this.getThemeClasses().slideout),"bottom-left"===s?(n.style.left="0px",n.classList.add(this.getThemeClasses().left)):(n.style.right="0px",n.classList.add(this.getThemeClasses().right)),n.style.bottom="0px";const o=document.createElement("div");o.classList.add(this.getThemeClasses().articleInner);const a=this.getTitle((0,V.replaceTags)(t)),l=document.createElement("div");l.classList.add(this.getThemeClasses().content),l.innerHTML=(0,V.replaceTags)(e);const c=this.createBackButton((t=>{"function"==typeof i&&(i(t),ws(n))})),h=this.createCloseButton(();o.appendChild(c),o.appendChild(h),o.appendChild(a),o.appendChild(l),n.appendChild(o),this.template.showElement(n)},this.createCloseButton=t=>{const e=document.createElement("button");return e.type="button",e.classList.add(this.getThemeClasses().buttonClose),e.addEventListener("click",t),e.innerHTML=Dn,this.template.appendButtonDataAttributes(e),e},this.createBackButton=t=>{const e=document.createElement("button");return e.type="button",e.classList.add(this.getThemeClasses().buttonBack),e.addEventListener("click",t),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="currentcolor"><path d="M13.648 6.89c0 .09-.035.169-.101.235l-4.031 4.031 4.03 4.031a.323.323 0 010 .47l-.515.515a.323.323 0 01-.469 0l-4.78-4.781a.323.323 0 010-.47l4.78-4.78a.323.323 0 01.47 0l.515.515a.323.323 0 01.101.235zm0 0"/></svg>',e},this.getSearchBox=()=>document.querySelector(`.${this.getThemeClasses().searchBox}`),this.createSearchBox=(t,e,s)=>{const i=document.createElement("div");i.classList.add(this.getThemeClasses().searchBox);const r=document.createElement("input");r.type="text",r.placeholder=(0,V.replaceTags)(t),r.addEventListener("keyup",(t=>{var s;const i=t.target.value,r=null===(s=this.getSearchBox())||void 0===s?void 0:s.querySelector('button[role="reset"]');i.length?null==r||r.removeAttribute("style"):null==r||r.setAttribute("style","display:none"),e(i)}));const n=document.createElement("button");return n.setAttribute("role","reset"),n.setAttribute("style","display:none"),n.innerHTML=Dn,n.onclick=()=>{var t,e;r.value="",s(),null===(e=null===(t=this.getSearchBox())||void 0===t?void 0:t.querySelector('button[role="reset"]'))||void 0===e||e.setAttribute("style","display:none")},i.appendChild(r),i.appendChild(n),i},this.showBox=t=>{const{title:e,content:s,createActions:i,closeAction:r,alignment:n="bottom-right",search:o,classes:a}=t;let l;const c=document.createElement("div");c.dataset.ufContent="assistant",c.setAttribute("style","display: none"),a&&c.classList.add(...a.split(" "));const h=document.createElement("div");h.classList.add(this.getThemeClasses().notificationInner),l=e instanceof HTMLElement?e:this.getTitle(e);const u=this.createCloseButton(();h.appendChild(u),h.appendChild(l);const d=document.createElement("div");d.classList.add(this.getThemeClasses().content),s instanceof HTMLElement?d.appendChild(s):d.innerHTML=s;const p=o(c);if(""!==s&&null!==p&&d.classList.add(this.template.themeClasses.contentWithDescription),""===s&&null===p&&l.classList.add(this.template.themeClasses.titleWithoutContent),p instanceof HTMLElement&&(d.appendChild(p),h.classList.add(this.getThemeClasses().notificationSearchInner)),h.appendChild(d),i){const t=i(c);h.append(t)}c.appendChild(h),c.classList.add(this.getThemeClasses().notification,this.getThemeClasses().tourSelection),"bottom-left"===n?(c.style.left="0px",c.classList.add(this.getThemeClasses().left)):(c.style.right="0px",c.classList.add(this.getThemeClasses().right)),c.style.bottom="0px",this.template.isWatermark&&h.append(this.template.createWatermarkBadge()),this.template.showElement(c)},this.template=new Ps(e,s)},An="Search in the knowledge base",On="reset";const _n=class{constructor(t,e,s){this.initSearchBox=t=>{if(this.assistantElement=t,this.options.search){const t=this.makeDelay();return this.template.createSearchBox(this.options.searchPlaceholder,(e=>{e.length||this.triggerCallbackFunction(On,null),t(e)})}))}return null},this.isCallbackDefined=()=>"function"==typeof this.callback,this.triggerCallbackFunction=(t,e)=>{if(null===this.callback)throw new Error("call must be initialized first");if(null===this.assistantElement)throw new Error("assistantElement must be initialized first");this.isCallbackDefined()&&this.callback(this.assistantElement,t,e)},this.makeDelay=()=>{let t;return e=>{clearTimeout(t),t=setTimeout((()=>{if(this.isCallbackDefined()&&e.length>=3){this.api.get(`/search?query=${e}`).onload=t=>{let{currentTarget:{status:e,response:s}}=t;if(e>=200&&e<400){const t=JSON.parse(s);this.triggerCallbackFunction("result",t)}}}}),this.options.delay)}},this.api=Gi(Oi),this.template=t,this.assistantElement=null,this.callback=s;const i={search:!1,delay:500,searchPlaceholder:An};this.options=Object.assign(Object.assign({},i),e)}};var $};const Bn="assistantSelection";const Rn=class{constructor(t,e){var s=this;this.getElementSelector=()=>`.${this.template.getThemeClasses().tourSelection}[data-uf-content="assistant"]`,this.disabledAssistantSelection=()=>{window.localStorage.setItem(Bn,"disabled")},this.enableAssistantSelectio},this.isAssistantSelectionEnabled=t=>{const e=window.localStorage.getItem(Bn);return"enabled"===e||null===e&&!t},this.getAvailable=()=>(Vt("Checking available assistant..."),new Promise(((t,e)=>{if(0===this.assistants.length)return Vt("There is no checklists here"),void e();this.assistants.forEach((e=>{Gi(Hi).checkTargetWithWaiting(zt(e.targets),e.targetOperator).then}),(()=>{}))}))}))),this.getLiveAssistants=()=>{const t=[];return this.assistants.forEach((e=>{e.contentType=w,e.objectPriority||(e.objectPriority=1),t.push(e)})),t},this.showArticle=(t,e,s,i)=>{t.classList.remove(We.visible),this.template.showArticle(e,s,i,(()=>{t.classList.add(We.visible)}))))},this.loadArticle=(t,e,s,i)=>{if(e in this.cache)this.showArticle(t,s,this.cache[e],i);else{this.api.requestWithPromise("GET",`/article/${e}`).then((r=>{const{content:n}=JSON.parse(r);this.cache[e]=n,this.showArticle(t,s,this.cache[e],i)}))}},this.fetchSearchItems=(t,e,s,i)=>{const r=document.createElement("div");return r.classList.add(this.template.getThemeClasses().searchResults),e.articles.length>0?e.articles.forEach((e=>{let{id:i,name:n,description:o}=e;r.appendChild(this.template.createSearchResult(n,o})))})):r.innerText=i,r},this.createActions=(t,e,s)=>{const i=document.createElement("div");return i.classList.add(this.template.getThemeClasses().actions),e.forEach((e=>{var{type:r}=e,n=$n(e,["type"]);let o;if("link"===r){const{title:t,url:e,urlOpenTargetBlank:s}=n;o=this.template.createLink(t,e,s?"_blank":"_self")}else if("article"===r){const{title:e,article:{id:i,name:r}}=n;o=this.template.createButton(e,(()=>{r&&this.loadArticle(t,i,r,s)}))}else if("tour"===r){const{title:t,tourId:e}=n;o=this.template.createButton(t,(t=>{e&&e>0&&this.runTourOnClickAction(t,e,!0}))}))}o&&i.appendChild(o)})),i},this.closeAssistant=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&s.disabledAssistantSelection(),s.selectedAssistant=null,t?ws(t):bs(s.getElementSelector())},this.destroy=()=>{var t;this.closeAssistant(null,!1),bs(this.getElementSelector()),(null===(t=this.mainButton.id)||void 0===t?void 0:t.startsWith("assistant"))&&this.mainButton.destroy()},this.showAssistant=t=>{const{id:e,name:s,description:i,isPublicDescription:r,items:n,alignment:o,search:a,searchAttributes:l}=t;if(this.selectedAssistant){if(this.selectedAssistant&&this.selectedAssistant.id!==t.id)this.closeAssistant();else if(document.querySelector(this.getElementSelector()))return}else this.selectedAssistant=t;this.enableAssistantSelection();const c=document.createElement("span");c.classList.add(this.template.getThemeClasses().description),c.innerHTML=(0,V.replaceTags)(i);const h={search:a};(null==l?void 0:l.placeholder)&&(h.searchPlaceholder=l.placeholder);const u=new _n(this.template,h,((t,e,s)=>{var i;const r=document.querySelector(`.${this.template.getThemeClasses().actions}`);if(r)if(r.innerHTML="","result"===e){const e=this.fetchSearchItems(t,s,o,l.emptyResults);r.appendChild(e)}else if("reset"===e){const e=this.createActions(t,n,o);null===(i=r.parentNode)||void 0===i||i.replaceChild(e,r)}}));this.template.showBox({id:e,type:"assistant",title:(0,V.replaceTags)(s),content:r?c:"",alignment:o,searc),closeAction:this.closeAssistant,createAction)})},this.runAssistant=t=>{if(this.isDestroyed)return;const{id:e,theme:s,themeSlug:i,description:r,button:n,alignment:o}=t;this.loader.loadTheme(s,i).then((s=>{this.template.setTheme(s),this.mainButton.setTheme(s);const i=document.createElement("span");i.classList.add(this.template.getThemeClasses().description),i.innerHTML=r,(null==n?void 0:n.visible)?(this.mainButton.prepareMainButton(`assistant_${e}`,this.mainButton.getButtonLabelContent((null==n?void 0:n.label)||"Need Help?"),(()=>{this.showAssistant(t)}),o),this.isAssistantSelectionEnabled(null==n?void 0:n.collapsed)&&this.showAssistant(t)):this.showAssistant(t)}))},this.init=()=>{this.destroy()},this.destroyInstance=()=>{bs("[data-uf-button='button-main']"),bs("[data-uf-content='assistant']"),this.isDestroyed=!0,this.assistants=[]},this.assistants=t,this.runTourOnClickAction=e,this.loader=Gi(Ni),this.mainButton=Gi(Fi),this.api=Gi(Oi),this.template=new Pn(null,!1),this.isDestroyed=!1,this.cache={},this.selectedAssistant=null}};const Nn=clas}destroy(){this.entity.destroy()}init(){this.entity.init(}getLiveContent(){switch(this.type){case v:return this.entity.getLiveTours();case y:return this.entity.getLiveChecklists();case w:return this.entity.getLiveAssistants()}}},Un="Conflict",Mn="MissingElement",jn="UserIdIssue",Fn="DuplicateScript",Hn="ConflictWarning",Wn=t=>{let{name:e,text:s,code:i=0,id:r,type:n=ut}=t;const o=new CustomEvent(W,{detail:{reportType:vt,name:e,text:s,code:i,url:window.location.href,entityId:r,entityType:n}});document.dispatchEvent(o)};const qn=class{constructor(t,e,s,i){var r=this;let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.waitForAvailableContent=()=>new Promise((t=>{if(this.availableContent.length>0)t(!0);else{const e=setInterval((()=>{this.getAvailableContent(),this.availableContent.length>0&&(clearInterval(e),t(!0))}),250)}})),this.filterEntitiey,this.filterByPriority=(t,e)=>t.filtere)),this.filterByTyp),this.filterAvailableTours=t=>{const{targets:e,targetOperator:s}=t.tourData;return this.availableOnPage.checkAvailableOnPage(zt(e),s)||Pt&&Et===t.id},this.filterRunnableTour=t=>{if(Pt&&Et===t.tourData.id)return!0;if("tour"===t.contentType){const{autoplay:e,showEverytime:s,id:i}=t.tourData;return e&&(s||this.localStorageTourHandler.getObjectStatus(i)!==n)}return!0},this.filterAvailableChecklists=t=>{const{id:e,targets:s,targetOperator:i}=t;return this.availableOnPage.checkAvailableOnPage(zt(s),i)&&!this.dismiss.isChecklistDismiss(e)},this.filterOutDismissedChecklists=t=>{const{id:e}=t;return!this.dismiss.isChecklistDismiss(e)},this.filterAvailableAssistants=t=>{const{targets:e,targetOperator:s}=t;return this.availableOnPage.checkAvailableOnPage(zt(e),s)},this.filterOutHidden=t=>void 0===this.hiddenContent.findd)),this.setLiveContent=()=>{for(const t in this.loaders)if(Object.hasOwnProperty.call(this.loaders,t)){const e=this.loaders[t].getLiveContent();e&&(this.liveContent[t]=e)}},this.getAvailableContent=()=>{let t=[];this.availableTours=this.liveContent[v].filter(this.filterAvailableTours),this.tours.availableTours=this.availableTours,this.availableChecklists=this.liveContent[y].filter(this.filterAvailableChecklists),this.availableAssistants=this.liveContent[w].filter(this.filterAvailableAssistants),t=[...this.availableTours,...this.availableChecklists,...this.availableAssistants],Vt("ContentLoader: Available content:"),Kt(t),this.availableContent=t},this.placeTriggers=()=>{this.tours.availableTours.length>0&&(this.tours.placeAllButtonEvent(),this.tours.placeInitialTriggersEvent()),this.availableChecklists.length>0&&this.placeChecklistItemsTriggers()},this.placeChecklistItemsTriggers=()=>{this.availableChecklists.forEach((t=>{this.checklist.placeChecklistItemsTriggers(t)}))},this.checkInProgressTours=()=>{const t=[],e=this.localStorageTourHandler.getRunningToursFromLS();return!!(e&&e.length>0&&(e.forEach((e=>{const{id:s}=e,i=this.availableTours.find((t=>t.id===s));if(i)t.push(i);else{const t=this.liveContent[v].find((t=>t.id===s)),i=null!=t?t:e;this.localStorageTourHandler.closeInProgressTour(i.id,i.name)}})),t.length>0))&&(this.displayContent(t),!0)},this.checkTourTriggers=()=>{const t=this.tours.tourTriggers.getTriggers(),e=JSON.parse(t),s=[];return e.forEach((t=>{const e=window.localStorage.getItem(Mt);if(e&&this.availableOnPage.checkURL(e)||!e){const e=this.liveContent[v].find((e=>e.id===parseInt(t,10)));e&&s.push(e)}e&&setTimeout}),500)})),s.length>0&&(this.displayContent(s,(()=>{this.tours.tourTriggers.clearTourTriggerAfterDelay(e[0],!0,500)})),!0)},this.checkPriorityTours=()=>{let t=!1;return t||(t=this.checkTourTriggers()),t||(t=this.checkInProgressTours()),t},this.prioritizeContent=()=>{if(this.checkPriorityTours())return;if(!this.availableContent||0===this.availableContent.length)return void this.waitForAvailableContent().then}));const t=this.availableContent.filter(this.filterRunnableTour).filter(this.filterOutHidden);if(this.contentToDisplay=[],this.isPriorityAcrossEntities)this.maxPriority=Math.max(...t.map((t=>t.objectPriority))),this.contentToDisplay=t.filter(this.filterEntities);else for(const e of this.contentPriorities){const s=this.filterByType(t,e),i=Math.max(...s.map((t=>t.objectPriority))),r=this.filterByPriority(s,i);if(1===r.length){this.contentToDisplay=r;break}r.length>1&&this.reportConflict(r)}this.contentToDisplay.length>0?(this.clearRefreshProp(),this.displayContent(this.contentToDisplay)):this.isAnyPotentialRunnableContent()&&setTimeout)),500)},this.displayContent=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(Vt("ContentLoader: displayContent called"),Kt(t),r.clearRefreshProp(),r.conflictReported=!1,1===t.length){const e=t[0];if(r.isTheDisplayContent(e.contentType,e.contentType===v?e.tourData.id:e.id))return;switch(r.setDisplayedContentType(e.contentType),e.contentType){case v:{r.destroyPreviousContent(v),r.setDisplayedContentId(e.tourData.id);const t=Pt&&Et===e.tourData.id;if(t){const t=r.tours.getTourByID(e.tourData.id),s=r.localStorageTourHandler.getCurrentStepIndexLS(e.tourData.id)>0||(null==t?void 0:t.tourData.autoplay);null==t||t.runTour({display:s})}else r.tours.runTourById(e.tourData.id);(e.tourData.autoplay||t)&&r.hideFromAvailable(e);break}case y:r.destroyPreviousContent(y),r.setDisplayedContentId(e.id),r.checklist.runChecklist(e);break;case w:r.destroyPreviousContent(w),r.setDisplayedContentId(e.id),r.assistant.runAssistant(e)}}else t.length>1?r.resolveConflict(t):console.warn("No content to run");e()},this.resolveConflict=t=>{Vt("ContentLoader: resolveConflict called"),Kt(t),this.contentPriorities.forEach((e=>{const s=t.filter((t=>t.contentType===e));1===s.length?this.displayContent([s[0]]):s.length>0&&this.reportConflict(s)}))},this.destroyPreviousContent=t=>{var e,s;switch(t){case v:this.checklist.destroy(),this.assistant.destroy();break;case y:null===(e=this.tours.currentTour)||void 0===e||e.closeTour(),this.assistant.destroy();break;case w:null===(s=this.tours.currentTour)||void 0===s||s.closeTour(),this.checklist.destroy()}},this.hideFromAvailabl},this.checkContentReferenceFunction=()=>{this.checkContent()},this.closeTourEven},this.pauseLoader=()=>{Vt("ContentLoader paused"),this.isPaused=!0},this.unPauseLoader=()=>{Vt("ContentLoader unpaused"),this.isPaused=!1,this.checkContent()},this.setDisplayFunction=t=>{this.isDestroyed||(this.setDisplayedContentType(t.detail.type),this.setDisplayedContentId(t.detail.id),this.destroyPreviousContent(this.displayedContentType))},this.registerLoadersByPriority=t=>{t.forEach((t=>{switch(t){case v:this.registerLoader(v,this.tours);break;case y:this.registerLoader(y,this.checklist);break;case w:this.registerLoader(w,this.assistant)}}))},this.registerLoader=(t,e)=>{null===this.getLoader(t)&&(this.loaders[t]=new Nn(t,e))},this.contentPriorities=i,this.isPriorityAcrossEntities=o,this.loaders={},this.assistant=t,this.checklist=e,this.tours=s,this.registerLoadersByPriority(this.contentPriorities),this.isDestroyed=!1,this.isPaused=!1,this.availableOnPage=Gi(Hi),this.localStorageTourHandler=Gi(qi),this.dismiss=Gi(ji);const[a]=this.contentPriorities;this.displayedContentId=null,this.displayedContentType=a,this.maxPriority=1,this.availableContent=[],this.liveContent={},this.availableTours=[],this.availableChecklists=[],this.availableAssistants=[],this.hiddenContent=[],this.contentToDisplay=[],this.conflictReported=!1}checkContent(){this.isDestroyed||this.isPaused||(this.getAvailableContent(),this.placeTriggers(),this.prioritizeContent())}init(){this.checkingContentInterval&&window.clearTimeout(this.timeoutID),this.removeEventListeners(),this.getLoaders().forEach((t=>{t.destroy()})),this.hiddenContent=[],this.resetDisplayContent(),this.getLoaders().forEach((t=>{t.init()})),this.setLiveContent(),this.checkContent(),this.isDestroyed||(this.checklist.placeTriggers(),this.placeEventListeners())}placeEventListeners(){document.addEventListener(S,this.checkContentReferenceFunction,!1),document.addEventListener(k,this.setDisplayFunction,!1),document.addEventListener(E,this.checkContentReferenceFunction,!1),document.addEventListener(C,this.closeTourEvent,!1),document.addEventListener(j,this.pauseLoader,!1),document.addEventListener(F,this.unPauseLoader,!1)}removeEventListeners(){document.removeEventListener(S,this.checkContentReferenceFunction,!1),document.removeEventListener(E,this.checkContentReferenceFunction,!1),document.removeEventListener(C,this.closeTourEvent,!1),document.removeEventListener(j,this.pauseLoader,!1),document.removeEventListener(F,this.unPauseLoader,!1}destroy(){this.removeEventListeners();const[t]=this.contentPriorities;this.displayedContentType=t,this.isDestroyed=!0,this.getLoaders().forEach})),this.timeoutID&&window.clearTimeout(this.timeoutID)}getLoadsAnyPotentialRunnableContent(){const t=this.liveContent[v].length>0&&this.liveContent[v].filter(this.filterRunnableTour).filter(this.filterOutHidden).length>0,e=this.liveContent[y].length>0&&this.liveContent[y].filter(this.filterOutDismissedChecklists).length>0,s=this.liveContent[w].length>0;return t||e||s}setDisplayedContentId(t){this.displayedContentId=t}setDisplayedContentType(t){this.displayedContentType=}resetDisplayContent(){const[t]=this.contentPriorities;this.setDisplayedContentType(t),this.setDisplayedContentId(null)}reportConflict(t){if(this.conflictReported)return;const e=t.map((t=>`\n${t.id.toString()}: ${t.name}`));console.warn(`Usetiful: There are ${t.length} ${t[0].contentType}s available on this page with the same priority: ${e} \n and we can't decide which one to display first.`),setTimeout((()=>{t.forEach((e=>{const s=t.filterd)).map((t=>`${t.id.toString()}: ${t.name}`));Wn({name:Un,text:`There is a conflict in priorities. Other ${e.contentType}${t.length-1>1?"s":""} with the same priority: ${s}`,id:e.id.toString(),type:e.contentType})}))}),500),this.conflictReported=!0}};const Vn=class{constructor(s,i,r,n){this.placeTrigger=()=>{this.shouldPlaceTrigger()?this.setProgressOnClickTrigger():this.type===e&&fe({name:N,tourId:this.tourId})},this.removeTrigge},this.shouldPlaceTrigger=()=>this.type&&this.type!==e&&this.type!==t,this.setProgressOnClickTrigger=()=>{if(Vt(`setProgressOnClickTrigger: Setting click trigger on ${this.pointerSelector}...`),this.commonTriggerController.hasProgressOnClickTrigger(this.pointerSelector))return;const t={type:this.eventName,element:this.pointerSelector,url:"",loop:"-1"},e=new Os(t,Gi(Hi));e.isProgressOnClick=!0,this.commonTriggerController.isTriggerMissing(e)&&(e.triggerFunction=this.elementTrigger,this.commonTriggerController.addToActiveTriggers(e),this.commonTriggerController.placeCentralListener(e.eventName,e.elementSelector))},this.removeProgressOnClickTrigger=()=>{if(Vt(`Removing progress trigger ${this.eventName} on ${this.pointerSelector} ...`),us(this.pointerSelector)){if(ds(this.pointerSelector)){this.commonTriggerController.searchInActiveTriggers(this.eventName,this.pointerSelector).forEach}))}}};switch(this.type=s||"",this.pointerSelector=i||"",this.elementTrigger=r|}),this.commonTriggerController=Gi(Ri),this.eventName="",this.tourId=n,s){case"element":this.eventName="mouseup";break;case"screen":this.eventName="mouseup",this.pointerSelector="body"}}},J};const Kn=class{constructor(t,e){this.runTriggerEvent=()=>{switch(this.stepData.eventType){case ts:this.runJsEvent();break;case es:this.runWebhookCall()}},this.runJsEvent=()=>{if(this.stepData.eventName){let t;try{if(""!==this.stepData.eventContent){t=(0,V.replaceTags)(this.stepData.eventContent);const[e]=JSON.parse(`[{ "bubbles": true, "detail": {${t}}}]`);this.options=e,this.event=new CustomEvent(this.stepData.eventName,this.options)}}catch(t){console.warn(`Trigger event step contains this error: ${t}`)}this.event&&this.element&&(It&&this.element.addEventListener(this.stepData.eventName})),this.element.dispatchEvent(this.event))}},this.runWebhookCall=()=>{if(this.stepData.webhookUrl)try{const t=(0,V.replaceTags)(this.stepData.webhookUrl),e=(0,V.replaceTags)(this.stepData.eventContent),s=JSON.parse(`{${e}}`);s&&((t,e,s)=>{let i=t,r="POST",n=[];const o=new URL(i);if(s){const{username:t,password:e,port:o,type:a,headers:l}=s;if(t&&e){const s=`${encodeURIComponent(t)}:${encodeURIComponent(e)}@`;i=i.replace(/^(https?:\/\/)/,`$1${s}`)}if(o){const t=new URL(i);t.port=o,i=t.toString()}a&&(r=a),l&&(n=l.map))))}const a=o.searchParams.get("x-auth-token");if(a&&(o.searchParams.delete("x-auth-token"),i=o.toString()),i.includes("webhook.office.com")){let t=[];n.length>0&&(t=n.reduce)),{})),fetch(i,{method:r,mode:"no-cors",headers:Object.assign({},t),body:JSON.stringify(e)}).catch)))}else{const t=new XMLHttpRequest;t.onreadystatechang},t.open(r,i,!0),i.includes("zapier.com")||t.setRequestHeader("Content-Type","application/json"),a&&t.setRequestHeader("x-auth-token",a),n.forEach})),e?t.send(JSON.stringify(e)):t.send()}})(t,s,this.stepData.webhookSettings)}catch(t){console.warn(`Trigger event step contains this error: ${t}`)}},this.runPageAction=()=>{if(this.stepData.actionType){if(!this.stepData.element)return void console.warn("Element for automated action is empty");switch(this.stepData.actionType){case Xe:{const t=ps(this.stepData.element);null==t||t.forEach((t=>{t instanceof HTMLInputElement&&this.stepData.actionValue&&(t.value=(0,V.replaceTags)(this.stepData.actionValue))}));break}case Ze:{const t=ds(this.stepData.element);if(t&&t instanceof HTMLElement){t.click();const e=new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(e)}break}}}},this.makeAutoRedirect=()=>{var t;const e=Y;if(!this.currentTour)return!1;if(this.stepData.automatic&&this.stepData.url){const s=!Rs(window.location.href,this.stepData.url);this.step.modifyURLBeforeRedirect(this.stepData);const i=this.currentTour.getTour(),r=null===(t=this.currentTour.getCurrentStep())||void 0===t?void 0:t.id;if(i&&r){const t=new CustomEvent(M,{detail:{type:ut,entityId:i.id,stepIndex:this.currentTour.getCurrentStepIndex(),action:e,itemId:r,isDevKit:!1}});document.dispatchEvent(t)}else console.error(`Could not send data to reporter before auto refirect for tour: ${i.id} and step: ${r}`);return"self"===this.stepData.tourName&&this.currentTour.goToNextStep(!1),(s||"self"!==this.stepData.tourName)&&this.currentTour.closeTour(st),Bs(this.stepData.url,!1),!0}return!1},this.step=t,this.stepData=t.stepData,this.stepData.eventName&&(this.event=new CustomEvent(this.stepData.eventName)),this.element=window,this.stepData.element&&""!==this.stepData.element&&ds(this.stepData.element)&&(this.element=ds(this.stepData.element)),this.stepData.type===Ke&&(this.currentTour=e)}};const zn=['<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke="#000" stroke-width="2"><circle cx="16" cy="16" r="14"/><path d="M8.5 12.5c.5-.833 2.5-2 4.5 0M19 12.5c.5-.833 2.5-2 4.5 0" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 25c5.85 0 8.438-4.667 9-7 0 0-5.458 1.273-9 1.273S7 18 7 18c.563 2.333 3.15 7 9 7z" stroke-linejoin="round"/></g></svg>','<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="14" stroke="#000" stroke-width="2"/><rect x="8" y="19" width="16" height="2" rx="1" fill="#000"/><ellipse cx="11.5" cy="12.5" rx="1.5" ry="2.5" fill="#000"/><ellipse cx="20.5" cy="12.5" rx="1.5" ry="2.5" fill="#000"/></svg>','<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke="#000" stroke-width="2"><circle cx="16" cy="16" r="14"/><path d="M19.91 13.495c.061-.97 2.649-2.496 3.997-2.067M12.59 13.495c-.061-.97-2.649-2.496-3.997-2.067" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 18c-4.55 0-6.563 2.667-7 4 0 0 4.245-.727 7-.727S23 22 23 22c-.438-1.333-2.45-4-7-4z" stroke-linejoin="round"/></g></svg>'],Gn="js-feedback";const Yn=class{constructor(t,e,s){this.send=t=>{const e=new Date,s={stepId:this.stepId,option:t,respondedAt:e.toISOString(),debug:this.debug,isPreview:Pt,isDev:Lt},i=this.usetifulTags.getUserId();return null!==i&&(s.userId=i),(0,V.updateTagValue)(`${this.stepId}-survey`,t.toString()),new Promise((t=>{const e="/surveys/{survey_id}/responses/".replace("{survey_id}",this.surveyData.surveyId.toString(10)),i=this.reporterApi.post(e,s);i.onloa}}))},this.clickButtonHandle=t=>{t.preventDefault();const e=t.target;if(e){const t=e.closest("button"),s=null==t?void 0:t.dataset.value;if(s){const t=Number(s);Number.isNaN(t)||(this.disabledAllButtonElements(),this.send(t).then((()=>{const t=document.querySelector(`.${Gn}`);if(t){t.innerHTML="";const e=this.template.createWrapper("");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><style>.cls-tick-1{fill:none;stroke:inherit;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}</style></defs><g id="tick-_tick" data-name="tick"><circle class="cls-tick-1" cx="12" cy="12" r="11"/><path class="cls-tick-1" d="M6 13l3 3 8-8"/></g></svg>';const s=this.template.createWrapper(this.template.themeClasses.feedbackTitle);s.innerHTML=this.surveyData.surveyThankYouMessage,t.appendChild(e),t.appendChild(s)}})))}}},this.init=()=>{const t=document.querySelectorAll(`.${this.template.themeClasses.feedback} button`);t&&t.forEach}))},this.disabledAllButtonElements=()=>{const t=document.querySelectorAll(`.${this.template.themeClasses.feedback} button`);t&&t.forEach((t=>{t instanceof HTMLButtonElement&&(t.disabled=!0)}))},this.getContent=()=>"nps"===this.surveyData.surveyType?this.getNpsContent():this.getEmojiesContent(),this.getEmojiesContent=()=>{const t=this.template.createWrapper(this.template.themeClasses.feedback);t.dataset.ufElement="feedback",t.classList.add(Gn),t.classList.add(this.template.themeClasses.reaction);const e=this.template.createWrapper(this.template.themeClasses.feedbackTitle);return e.innerHTML=this.surveyData.surveyQuestion,t.appendChild(e),zn.forEach(((e,s)=>{const i=document.createElement("button");i.dataset.value=(s+1).toString(10),i.type="button",i.innerHTML=e,t.appendChild(i)})),t},this.getNpsContent=()=>{const t=this.template.createWrapper(this.template.themeClasses.content),e=this.template.createWrapper(this.template.themeClasses.feedback);e.dataset.ufElement="feedback",e.classList.add(Gn),t.appendChild(e);const s=this.template.createWrapper(this.template.themeClasses.feedbackTitle);s.innerHTML=this.surveyData.surveyQuestion,e.appendChild(s);const i=this.template.createWrapper(this.template.themeClasses.buttonGroup);[...Array(11)].forEach(((t,e)=>{const s=e.toString(10),r=document.createElement("button");r.classList.add(this.template.themeClasses.button),r.dataset.value=s,r.type="button",r.innerHTML=s,i.appendChild(r)})),e.appendChild(i);const r=this.template.createWrapper(this.template.themeClasses.npsTitles);if(this.surveyData.surveyMinimalValueLabel){const t=document.createElement("span");t.classList.add(this.template.themeClasses.textLeft),t.innerHTML=this.surveyData.surveyMinimalValueLabel,r.appendChild(t)}if(this.surveyData.surveyMaximalValueLabel){const t=document.createElement("span");t.classList.add(this.template.themeClasses.textRight),t.innerHTML=this.surveyData.surveyMaximalValueLabel,r.appendChild(t)}return e.appendChild(r),t},this.stepId=e,this.surveyData=s,this.template=t,this.debug=It,this.reporterApi=Gi(_i),this.usetifulTags=Gi(Mi)}},Qn="previewTour",Xn=t=>{const e=t.target;if(!e)return;const s=e.closest(`.${We.formQuestion}`);if(null!==s){const t=s.getAttribute("id");switch(e.classList.remove(We.error),s.classList.remove(We.error),e.tagName.toLowerCase()){case"input":switch(e.getAttribute("type")){case"radio":(0,V.updateTagValue)(t,e.value);break;case"checkbox":setTimeout((()=>{(0,V.updateTagValue)(t,Zn(s))}),100);break;default:to("focusout",t,e)}break;case"select":to("change",t,e);break;case"textarea":to("focusout",t,e)}}},Zn=t=>{const e=[],s=t.querySelectorAll("input");return s.length>0&&s.forEach})),e.toString()},to=(t,e,s)=>{s.addEventListener(t}),{once:!0})};const eo=class{constructor(t){this.isEmpte,this.isValidEmai),this.hasSelectedInpu),this.validateForm=()=>{this.loadFormsData();let t=!0;return this.fieldSets.forEach(((e,s)=>{if(!this.formElement||null===!this.formElement[s])return void(t=!0);const i=[];for(let t=0;t<e.length;t+=1){const s=e[t];s.classList.remove(We.error);let r=!0;switch(s.tagName.toLowerCase()){case"select":r=!this.isEmpty(s);break;case"input":{const t=s;r=!t.required||t.required&&!this.isEmpty(t),r="email"!==s.getAttribute("type")||!t.required&&""===t.value?r:this.isValidEmail(t);break}case"div":{const t=s.querySelectorAll("input");t.length>0&&(r=this.hasSelectedInput(t));break}}r||i.push(s)}if(i.length>0){let e=`${this.formElement[s].dataset.validationMessage||"Update values in the following fields"}<ul>`;i.forEach((t=>{var s,i;t.classList.add(We.error);let r=null===(i=null===(s=t.closest(`.${We.formQuestion}`))||void 0===s?void 0:s.querySelector("label"))||void 0===i?void 0:i.textContent;r||(r="<i>Empty label</i>"),e+=`<li>${r}</li>`})),e+="</ul>",this.placeValidationMessage(e,this.formElement[s]),t=!1}else this.removeValidationMessage(this.formElement[s])})),t},this.removeValidationMessage=t=>{const e=t.querySelector(`section.${We.validationAlert}`);e&&e.parentNode&&e.parentNode.removeChild(e)},this.placeValidationMessage=(t,e)=>{this.wasValidated&&this.removeValidationMessage(e);const s=document.createElement("section");s.classList.add(We.validationAlert);const i=document.createElement("span");i.textContent=" ",s.appendChild(i);const r=document.createElement("span");r.innerHTML=t,s.appendChild(r),e.append(s),this.wasValidated=!0},this.storeDefaultValues=()=>{this.loadFormsData();this.getAllQuestions().forEach((t=>{const e=this.getFieldValue(this.getField(t));e&&(0,V.updateTagValue)(t.getAttribute("id"),e)}))},this.getFieldValue=t=>{var e,s;const i=t.tagName.toLowerCase(),r=t.querySelector("input");if("div"===i||"p"===i){if("checkbox"===(null==r?void 0:r.type))return Zn(t);if("radio"===(null==r?void 0:r.type)){const i=t.querySelector("input[checked]");return null!==(s=null!==(e=null==i?void 0:i.value)&&void 0!==e?e:(0,V.getTagValue)(t.id))&&void 0!==s?s:""}}return t.value},this.reportAnswers=t=>{if(!this.formElement)return;this.getAllQuestions().forEach((e=>{var s,i,r;const n=null!==(i=null===(s=e.querySelector("label"))||void 0===s?void 0:s.textContent)&&void 0!==i?i:e.getAttribute("id"),o=null!==(r=this.getFieldValue(this.getField(e)))&&void 0!==r?r:"",a=(t=>{switch(t.tagName.toLowerCase()){case"select":return"radio";case"input":if("checkbox"===t.getAttribute("type"))return"checkbox";break;default:{const e=t.querySelector("input");if(e&&("checkbox"===e.getAttribute("type")||"radio"===e.getAttribute("type")))return e.getAttribute("type");break}}return"text"})(this.getField(e)),l=new CustomEvent(H,{detail:{reportType:ft,questionType:a,question:n,entityId:t,entityType:ut,answer:o}});document.dispatchEvent(l)}))},this.stepElementClass=t,this.formElement=null,this.stepElement=null,this.fieldSets=[],this.wasValidated=!1,this.storeDefaultValues()}loadFormsData(){var t;this.stepElement=document.querySelector(`.${this.stepElementClass}`),this.stepElement&&(this.formElement=Array.from(null===(t=this.stepElement)||void 0===t?void 0:t.querySelectorAll(`.${We.formFieldset}`)),this.formElement.forEach(((t,e)=>{this.fieldSets[e]=[],this.fieldSets[e]=this.getFieldsToValidate(t)})))}getAllQuestions(){var t;const e=[];return null===(t=this.formElement)||void 0===t||t.forEach((t=>{const s=t.querySelectorAll(`.${We.formQuestion}`);e.push(...s)})),e}getField(t){const e=t.querySelector("input"),s=t.querySelector("textarea"),i=t.querySelector("select"),r=t.querySelectorAll('input[type="checkbox"]').length>1,n=t.querySelectorAll('input[type="radio"]').length>1;return!e||r||n?!s||r||n?i||t:s:e}getFieldsToValidate(t){if(!t)return[];const e=[];return t.querySelectorAll(`.${We.formQuestion}`).forEach((t=>{const s=t.dataset.required,i=t.querySelector("[required]"),r=t.querySelector("[type='email']"),n=t.querySelector("input"),o=t.querySelector("select");(s||i||r)&&(n&&n.closest(`.${We.formQuestion}`)!==t||o&&o.closest(`.${We.formQuestion}`)!==t)||(s?e.push(t):i?e.push(i):r&&e.push(r))})),e}},so=Le.STYLE_PRIMARY;Le.STYLE_SECONDARY,Le.STYLE_CUSTOM;const io=class{constructor(t,e,s,i,r){this.prepareAction=(t,e)=>{var s;const i=this.template.createButton(this.actionData.value),r=new eo(e),n=this.shouldValidateForm?()=>{if(!r.validateForm())return i.classList.add(We.errorShake),setTimeoe)}),500),!1;r.reportAnswers(this.stepId),fe({tourId:this.tourId,name:A})}:()=>{fe({tourId:this.tourId,name:A})};switch(this.actionData.type){case ss:i.addEventListener("click",(()=>{n()})),i.classList.add(this.template.themeClasses.button);break;case is:i.addEventListener("click",(()=>{fe({tourId:this.tourId,name:O})})),i.classList.add(this.template.themeClasses.button);break;case ns:i.addEventListener("click",(()=>{this.actionData.url&&(Pt&&Qt("stop preview"),Bs(this.actionData.url,!0))})),i.classList.add(this.template.themeClasses.button);break;case os:i.addEventListener("click",(()=>{if(!this.actionData.tourId)return void console.warn("TourId in another tour button doesn't exist");const e=parseInt(this.actionData.tourId,10);if(this.isCurrentTour(e)&&fe({name:A,details:{display:!1},tourId:this.tourId}),this.actionData.url){window.usetiful_isAboutToRefresh=!0;!Rs(window.location.href,this.actionData.url)||fe({name:$,details:{tourId:e},tourId:this.tourId}),this.isCurrentTour(e)||this.sendCloseTourEvent();const s=Object.assign({},this.actionData);t(s),s.url&&Bs(s.url,!1)}else if(this.isCurrentTour(e)||(fe({name:$,details:{tourId:e},tourId:this.tourId}),this.sendCloseTourEvent()),Pt){const e=Object.assign({},this.actionData);t(e),e.url&&(s=e.url,window.history.replaceState?window.history.replaceState(void 0,"",s):window.location.hash=s,window.location.reload())}var s})),i.classList.add(this.template.themeClasses.button);break;case as:i.addEventListener("click",(()=>{fe({tourId:this.tourId,name:_})})),i.classList.add(this.template.themeClasses.button);break;default:i.addEventListener("click",(()=>{fe({name:B,details:{stepId:this.actionData.to,display:!0},tourId:this.tourId})})),i.classList.add(this.template.themeClasses.button)}return(this.actionData.styleType?this.actionData.styleType===so:this.actionData.type===ss||this.actionData.type===os)&&i.classList.add(this.template.themeClasses.buttonPrimary),(null===(s=this.actionData)||void 0===s?void 0:s.classes)&&i.classList.add(...this.actionData.classes.split(" ")),this.template.appendButtonDataAttributes(i),i},this.sendCloseTourEvent=()=>{fe({name:_,details:{reason:st},tourId:this.tourId})},this.isCurrentTrId,this.actionData=t,this.template=s,this.tourName=e,this.tourId=i,this.shouldValidateForm=!1,this.stepId=r}};class ro{constructor(e,s,i){var n=this;this.doesStepElementExist=t=>null!==ds(`.${this.template.themeClasses.prefix}-${t}`),this.destructStep=t=>{Vt(`DestructStep: stepName ${this.stepData.name}`),Kt(this.stepData);const e=null==t?void 0:t.stepData;if(this.stepData){const t=this.stepData.progressOnClick||"",s=this.stepData.element||"",i=new Vn(t,s,this.elementTrigger,this.tourId);switch(this.stepData.type){case Ve:this.template.destructElement(this.stepData.name);break;case Je:this.template.destructElement(this.stepData.name),i.removeTrigger();break;case qe:i.removeTrigger(),this.destroy(),this.template.destructElement(this.stepData.name)}!this.stepData.highlight||!e||e.highlight&&"pointer"===e.type||setTimeor()),10)}},this.placeStepProgressTrigger=()=>{const{stepData:t}=this,e=new Vn((null==t?void 0:t.progressOnClick)||"",t.element||"",this.elementTrigger,this.tourId);t.type===qe&&this.isPositionTypeScreen()&&(e.pointerSelector="body"),e.placeTrigger()},this.isAppearsTrigger=()=>{var t,e,s;return(null===(t=this.stepData)||void 0===t?void 0:t.trigger)&&"appears"===(null===(e=this.stepData)||void 0===e?void 0:e.trigger.type)&&""!==(null===(s=this.stepData)||void 0===s?void 0:s.trigger.element)},this.waitForStep=(t,e,s)=>{var i,r;if(Vt(`WaitForStep called - ${t}`),!t||!(null===(i=this.stepData)||void 0===i?void 0:i.trigger))return;Gr();const n=new Os(null===(r=this.stepData)||void 0===r?void 0:r.trigger,this.availableOnPage);n.triggerFunction=e,n.failFunction=s,n.altSolut0)};n.setAppearTrigger()&&(window.usetiful_intervals.push(n.intervalId),n.intervalId&&this.tour.waiters.push(n.intervalId))},this.constructStep=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=K;if(n.isDevKit=e,Vt(`constructStep: step index ${n.tour.getCurrentStepIndex()}, display: ${t}`),t&&fe({name:R,details:{status:r},tourId:n.tourId}),n.doesStepElementExist(n.stepData.name)){const t=ds(`.${n.template.themeClasses.prefix}-${n.stepData.name}`);return t&&Ss(t)?void n.showCurrentStep():void 0}switch(Pt&&!n.isAppearsTrigger()&&Yt(),n.stepData.type){case Ve:n.isAppearsTrigger()?n.waitForStep(t,(()=>{n.prepareModal(t),Pt&&Yt()})):n.prepareModal(t);break;case Je:n.isAppearsTrigger()?n.waitForStep(t,(()=>{n.prepareSlideout(t),Pt&&Yt()})):n.prepareSlideout(t);break;case qe:if(!n.isCreatingIntervalRunning&&null==n.prepareStepPointer(t))return;break;case Ke:s=Y,n.stepData.tourName&&""!==n.stepData.tourName&&fe({name:$,details:{tourId:"self"!==n.stepData.tourName?n.stepData.tourId:n.tourId},tourId:n.tourId});if(new Kn(n,n.tour).makeAutoRedirect())return;"self"===n.stepData.tourName?fe({name:A,details:{display:!1},tourId:n.tourId}):fe({name:_,tourId:n.tourId}),n.stepData.url&&window.localStorage.setItem(Mt,n.stepData.url);break;case ze:if(n.stepData.delay){s=Q,Vt(`constructStep: Delay step. Waiting for ${n.stepData.delay}sec.`);const t=1e3*n.stepData.delay;window.usetiful_tourDelayTimeoutVar=setTimeout((()=>{window.usetiful_tourDelayTimeoutVar=void 0,fe({tourId:n.tourId,name:A})}),t)}break;case Ge:s=tt;new Kn(n,n.tour).runTriggerEvent(),fe({tourId:n.tourId,name:A});break;case Ye:{s=et,n.tourId&&fe({tourId:n.tourId,name:$});const t=new Kn(n,n.tour);n.tourTriggers.clearTourTriggerAfterDelay(n.tourId,!0,n.getTimeout()),n.performActionWithPotentialRedirect(n.tour.goToNextStep),t.runPageAction();break}}if(!t||n.localStorageTourHandler.isTourReopenFromLS(n.tour.name)&&0!==n.tour.getCurrentStepIndex()||window.usetiful_isAboutToRefresh)Vt("constructStep: reopen action is not send into report");else{const t=new CustomEvent(M,{detail:{type:ut,entityId:n.tourId,stepIndex:n.tour.getCurrentStepIndex(),action:s,itemId:n.stepData.id,isDevKit:n.isDevKit}});document.dispatchEvent(t)}},this.showAlternativeSolution=t=>{var e;if(It){bs(`.${this.template.themeClasses.notification}`);const s=t?`Step '${this.stepData.title}' can't be shown because the element <b>'${null===(e=this.stepData.trigger)||void 0===e?void 0:e.element}' didn't appear in given time limit</b> so the trigger timed out. <a href="https://usetiful.freshdesk.com/support/solutions/articles/77000481466-triggering-by-element-appears" target="_blank">Learn more</a>`:`Step '${this.stepData.title}' can't be shown. Pointing element <b>'${this.stepData.element}' doesn't exist on this page or is hidden</b>. <a href="https://usetiful.freshdesk.com/support/solutions/articles/77000488290-why-is-my-pointer-showing-in-right-bottom-corner-" target="_blank">Learn more</a>`;this.template.notifyUser("tour","Alert",s,(()=>{const t=this.template.createWrapper(this.template.themeClasses.actions),e=this.template.createLink("Close tour");e.addEventListener("click",(t=>{bs(`.${this.template.themeClasses.notification}`),this.tour.closeTour(),t.stopImmediatePropagation(),t.preventDefault()}),!1);const s=this.template.createLink("< Previous step");return s.addEventListener("click",(t=>{bs(`.${this.template.themeClasses.notification}`),this.tour.goToPreviousStep(),t.stopImmediatePropagation(),t.preventDefault()}),!1),t.append(s),t.append(e),t}),[We.aler>{}))}else{Vt(`constructAborted.Element ${this.stepData.element} doesn't exist`),Wn({name:Mn,text:`Element '${this.stepData.element}' doesn't exist. Step displayed as slideout.`,id:this.stepData.id}),this.tour.currentStep.destructStep();const t=new ro(Object.assign({},this.stepData),this.tour,this.template);t.stepData.type=Je,t.stepData.trigger={},t.stepData.actions||(t.stepData.actions=[{type:"previous",value:"<"},{type:"next",value:">"}]);const e=this.tour.getStepIndex(this.id);this.tour.updateCurrentStep(e),t.constructStep(!0)}},this.prepareModal=t=>{const e=this.template.createWrapper(this.template.themeClasses.modal);e.dataset.ufContent="modal",t&&e.classList.add(We.visible),e.classList.add(`${this.template.themeClasses.prefix}-${this.stepData.name}`);const s=this.template.createWrapper(this.template.themeClasses.modalInner),i=document.body.appendChild(e);this.stepData.customStyle&&(ls(this.stepData.customStyle,s),cs(this.stepData.customStyle,s));const r=i.appendChild(s);this.appendInnerElement(r),t&&window.scrollTo({top:0}),this.setStepElement(i)},this.prepareSlideout=t=>{const e=this.template.createWrapper(this.template.themeClasses.slideout);e.dataset.ufContent="slideout",e.classList.add(`${this.template.themeClasses.prefix}-${this.stepData.position}`,`${this.template.themeClasses.prefix}-${this.stepData.name}`),t&&e.classList.add(We.visible);const s=this.template.createWrapper(this.template.themeClasses.slideoutInner),i=document.body.appendChild(e),r=i.appendChild(s);this.stepData.customStyle&&(ls(this.stepData.customStyle,r),cs(this.stepData.customStyle,r)),this.appendInnerElement(r),this.placeStepProgressTrigger(),this.setStepElement(i)},this.failToDisplayPointer=()=>{Gr(),this.stepData.autoskip&&this.tour.autoSkip(this.stepData.autoskip)},this.prepareStepPointer=t=>{if(this.isPositionTypeElement()&&this.stepData.element){const e=ds(this.stepData.element),s=this.isAppearsTrigger();if(!e||Ss(e))return this.stepData.autoskip?(s?(Vt("prepareStepPointer: Step has trigger elementAppears. Waiting on the step element..."),this.waitForStep(t,(()=>{Pt&&Yt(),this.createPointer(!0)}),this.failToDisplayPointer)):(Vt(`prepareStepPointer: Step index ${this.tour.getCurrentStepIndex()} will be skipped.`),this.failToDisplayPointer()),null):(s||this.stepData.trigger?(Vt("prepareStepPointer: Step has trigger elementAppears. Waiting on the step element..."),this.waitForStep(t,(()=>{Pt&&Yt(),this.createPointer(!0)})),this.isCreatingIntervalRunning=!1):(Gr(),Jt(`prepareStepPointer: We couldn't find element of step ${this.stepData.name}. Showing alternative solution...`),this.doubleDelay()),null);this.createPointer()}else this.isPositionTypeScreen()&&this.createPointer();return!0},this.createPointer=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n.prepareBubble(),n.placeStepProgressTrigger(),t){const t=new CustomEvent(M,{detail:{type:ut,entityId:n.tourId,stepIndex:n.tour.getCurrentStepIndex(),action:K,itemId:n.stepData.id,isDevKit:n.isDevKit}});document.dispatchEvent(t)}},this.prepareBubble=()=>{var e,s,i,r;if(this.stepData&&this.stepData.element){const t=ds(this.stepData.element);this.setTargetElement(t)}if(this.isPositionTypeElement()&&!this.getTargetElement())return void Vt("Element doesn't exist");const n=""!==(null===(e=this.stepData)||void 0===e?void 0:e.title)&&!0===(null===(s=this.stepData)||void 0===s?void 0:s.publicTitle),o=this.template.createTitle(4,this.stepData.title,n);let a=null;this.tour.isProgress()&&(a=this.getProgressBar());const l=this.tour.tourData,{progressType:c}=l,h=this.template.createBubble({ident:this.stepData.name,contentHTML:this.stepData.content?this.stepData.content:"",title:o||null,progressBar:a,alignment:this.stepData.alignment?this.stepData.alignment:"down",actionNumbers:(null===(i=this.stepData.actions)||void 0===i?void 0:i.length)?null===(r=this.stepData.actions)||void 0===r?void 0:r.length:0,progressType:c,closeButton:this.createCloseButton(),appendAdditionalContent:e=>{this.prepareFeedback(e),(!this.stepData.progressOnClick||this.stepData.progressOnClick===t)&&this.stepData.actions&&this.stepData.actions.length>0&&e.appendChild(this.prepareActions())},hotspot:!1,customStyle:this.stepData.customStyle?this.stepData.customStyle:null,theme:this.tour.theme});this.positionPointerElement(),window.onresh)},this.setStepElement(h);const u=setInterval((()=>{const t=this.getStepElement();t&&t.offsetHeight>0&&(this.scrollIntoView(),clearInterval(u))}),100)},this.onResizeActions=t=>{this.isPositionTypeElement()&&this.getTargetElement()&&t&&!Ss(this.getTargetElement())&&!Ss(t)&&this.scrollIntoView()},this.scrollIntoView=()=>{var t,e,s;Vt("scroll bubble into view");try{const i=null===(t=this.getStepElement())||void 0===t?void 0:t.getAttribute("data-floating-placement");if(i&&function(t,e,s){return!(!s||!e)&&(t===Qe||"top"===t?e.offsetHeight+s.offsetHeight>.9*window.innerHeight:e.offsetHeight>.9*window.innerHeight)}(i,this.getTargetElement(),this.getStepElement())){const t=i===Qe?"end":"start";null===(e=this.getStepElement())||void 0===e||e.scrollIntoView({behavior:"smooth",block:t})}else{const t=window.innerWidth<=600?"end":"center";null===(s=this.getTargetElement())||void 0===s||s.scrollIntoView({behavior:"smooth",block:t})}}catch(t){}},this.positionPointerElement=()=>{const{stepData:t}=this,e=`.${this.template.themeClasses.prefix}-${t.name}`;return t.type===qe&&this.availableOnPage.checkElement(e)?(Vt(`positionPointerElement: Checking position: ${t.name}`),this.isPositionTypeElement()&&t.element&&this.availableOnPage.checkElement(t.element)&&this.setTargetElement(ds(t.element)),this.setStepElement(ds(e)),this.create()):(Vt("positionPointerElement: Element disappeared..."),!1)},this.appendInnerElement=e=>{const{title:s,publicTitle:i,content:r,progressOnClick:n,actions:o,alignment:a}=this.stepData,l=""!==s&&!0===i,c=e,h=this.template.createWrapper(this.template.themeClasses.content),u=this.template.createTitle(3,s,l);l||h.classList.add(this.template.themeClasses.contentWithoutTitle),h&&r&&(h.innerHTML=(0,V.replaceTags)(r)),c.appendChild(this.createCloseButton()),u&&c.appendChild(u),this.tour.isProgress()&&c.appendChild(this.getProgressBar()),c.appendChild(h),this.prepareFeedback(c),(!n||n===t&&o&&o.length>0)&&c.appendChild(this.prepareActions());const{progressType:d}=this.tour.tourData;c.appendChild(this.template.createSpaceMaker(a,null==o?void 0:o.length,d));Gi(Ki.watermark)&&c.appendChild(this.template.createWatermarkBadge()),this.template.checkScrollableClass(h)},this.createCloseButton=()=>{const t=this.template.createButton('<svg xmlns="http://www.w3.org/2000/svg"><path stroke="#000" stroke-width="2" d="M1 16L16 1M1 1l15 15"/></svg>',this.template.themeClasses.buttonClose);return t.addEventListener("clic()})),t},this.prepareFeedback=t=>{var e;if(null===(e=this.stepData.surveyData)||void 0===e?void 0:e.feedback){const e=new Yn(this.template,this.stepData.id,this.stepData.surveyData);t.appendChild(e.getContent()),e.init()}},this.prepareActions=()=>{if(!this.stepData)return;const t=this.template.createWrapper(this.template.themeClasses.actions);if(this.stepData.alignment&&t.classList.add(this.stepData.alignment),this.stepData.actions)for(const e of this.stepData.actions){const s=new io(e,this.tour.name,this.template,this.tourId,this.stepData.id);s.shouldValidateForm=this.isForm();const i=s.prepareAction(this.modifyURLBeforeRedirect,`${this.template.themeClasses.prefix}-${this.stepData.name}`);i&&t.appendChild(i)}return t},this.getProgressBar=()=>{const t=this.tour.getTour(),e=this.localStorageTourHandler.getCurrentStepIndexLS(this.tour.id);return this.template.progressBarController(this.stepData,t,e)},this.modifyURLBeforeRedirect=t=>{let e=t;t||(e=this.stepData),e.url||(e.url=window.location.href);let s=!1;if(!Rs(window.location.href,e.url)&&e.tourId){const t=this.tour.getNextStep(),i=!t,r=e.tourId.toString()!==this.tour.id.toString();if((r||!i&&!r)&&(e.url+=`${Pt?`${$s(e.url)?"&":"#"}${Qn}-`:`?${o}=`}${e.tourId}`,s=!0,!i&&!r)){const s=this.tour.getStepIndex(t.name);e.url+=Pt?`-${s}-${"self"===e.tourName?this.tour.name:e.tourName}`:`&${a}=${s}`}}s||"self"===e.tourName||Pt&&e.tourId&&(e.url+=`${$s(e.url)?"&":"#"}${Qn}-${e.tourId}`)},this.elementTrigger=t=>{var e;Kt(t);const s=[t.target];t.target&&t.target.parentElement&&(s.push(t.target.parentElement),t.target.parentElement.parentElement&&s.push(t.target.parentElement.parentElement));for(let t=0;t<s.length;t+=1){const e=s[t];if(e&&e.classList.contains(this.template.themeClasses.buttonClose))return}Vt("elementTrigger: trigger called",!0);const i=null===(e=this.tour.getCurrentStep())||void 0===e?void 0:e.stepData;if(!(!!i&&i.runDefaults)&&t&&(Jt(`elementTrigger: Preventing default ${t.type} action.`),t.preventDefault()),!this.tour)return!1;this.tourTriggers.setTourTriggerToLocalStorage(this.tour.id),this.tourTriggers.clearTourTriggerAfterDelay(this.tour.id,!0,this.getTimeout()),this.performActionWithPotentialRedirect(this.tour.goToNextStep)},this.getTimeout=()=>{let t=1500;const e=this.tour.getNextStep();return e&&e.stepData.type===ze&&e.stepData.delay&&(t+=1e3*e.stepData.delay),t},this.performActionWithPotentialRedirect=t=>{fe({tourId:this.tourId,name:x}),setTimeo()}),1)},this.isPositionTypeElement=()=>{var t;return!((!this.stepData||this.stepData.positionType)&&"element"!==(null===(t=this.stepData)||void 0===t?void 0:t.positionType))},this.isPositionTypeScreen=()=>{var t;return"screen"===(null===(t=this.stepData)||void 0===t?void 0:t.positionType)},this.isForm=()=>{var t;return null!==(null===(t=this.stepElement)||void 0===t?void 0:t.querySelector(`.${We.formFieldset}`))},this.id=e.id,this.name=e.name,this.stepData=e,this.stepElement=null,this.targetElement=null,this.tour=s,this.tourId=s.id,this.template=i||new Ps,this.tourTriggers=Gi(Bi),this.isCreatingIntervalRunning=!1,this.localStorageTourHandler=Gi(qi),this.availableOnPage=Gi(Hi),this.isDevKit=!1}setStepData(t){this.stepData=t}getStepData(){return this.stepData}setStepElement(t){this.stepElement=t}getStepElement(){return this.stepElem}destroy(){var t;window.usetiful_floatUpdateCanceler&&window.usetiful_floatUpdateCanceler(),window.usetiful_floatScrollUpdateCanceler&&window.usetiful_floatScrollUpdateCanceler(),this.floatingInstance=null,null===(t=this.unsubscribeElementRemove)||void 0===t||t.call(this),this.unsubscribeElementRemove=void 0}create(){Vt("StepControl::create called.");const t=this.isPositionTypeScreen(),e=t?(t=>{var e;if(!t||!t.coordinates)return null;let{top:s,left:i,right:r,bottom:n}=t.coordinates;"number"!=typeof s&&(s=parseInt(s,10)),"number"!=typeof i&&(i=parseInt(i,10)),"number"!=typeof r&&(r=parseInt(r,10)),"number"!=typeof n&&(n=parseInt(n,10));const{width:o,height:a}=(null===(e=document.body)||void 0===e?void 0:e.getBoundingClientRect())||{},l=(t,e,s)=>t||e?t||s-e:s/2,c=l(s,n,a),h=l(i,r,o);return{getBoundingClientRect:()=>{var t,e,s;const i=(null===(t=document.body)||void 0===t?void 0:t.getBoundingClientRect())||{},r=h+(null!==(e=null==i?void 0:i.left)&&void 0!==e?e:0),n=c+(null!==(s=null==i?void 0:i.top)&&void 0!==s?s:0);return{x:h,y:c,width:0,height:0,top:n,right:i.width-r,bottom:i.height-n,left:r}}}})(this.stepData):this.getTargetElement(),s=this.getStepElement();if(!e||!s)return;const i=!t&&Ss(e);if(i)return Vt("Target element is hidden."),void this.hideCurrentStep();if(!i&&null!==this.getStepElement()&&Ss(this.getStepElement())&&(Vt("Showing step element."),this.showCurrentStep()),Vt("Updating current coordinates because target element and step element aren't hidden."),(this.floatingInstance||this.unsubscribeElementRemove)&&(this.destroy(),Vt("Destroying floatingInstance just before creating new one - may be destroy should be called explicitly before")),Vt("Start calculation of new coordinates"),this.stepData&&s&&e){const i="absolute",r=rn(this.stepData.position),n=!t&&this.stepData.highlight?tn(i):void 0;this.floatingInstance=()=>nn({targetElement:e,bubble:s,orientation:r,extraModifier:[en(n)]}),window.usetiful_floatScrollUpdateCanceler=Kr(e,s,this.floatingInstance,{ancestorScroll:!0}),window.usetiful_floatUpdateCanceler=Kr(e,s,this.floatingInstance,{animationFrame:!0}),this.unsubscribeElementRemove=(t=>{let e,{targetElement:s,removeCallback:i,AddedCallback:r,selector:n,baseSelector:o}=t;try{const t=[s];let a=s.parentNode;for(;a;)t.push(a),a=a.parentNode;e=new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type?(i&&Array.from(e.removedNodes).find((e=>t.includes(e)))&&i("remove element"),r&&Array.from(e.addedNodes).find((e=>t.includes(e)||n&&e.matches&&e.matches(n)))&&r("add element")):"attributes"===e.type&&setTimeout((()=>{const a=e.target;if(a===s||t.includes(a)){const t=Cs(n,o,s);i&&t&&i(fs),r&&!t&&r(fs)}}),600)}))}));const l={attributes:!0,attributeFilter:["class","style"],childList:!0,subtree:!0};t.length&&e.observe(t[t.length-1],l)}catch(t){}ret()}})({targetElement:e,removeCallback:t=>{t!==fs&&(this.hideCurrentStep(),Qr())},AddedCallback:t=>{if(t!==fs&&this.stepData&&this.stepData.element){const t=ds(this.stepData.element);t&&(this.setTargetElement(t),this.create())}},selector:this.stepData.element})}}showCurrentStep(){this.stepElement&&Xr(this.stepElemet)}doubleDelay(){window.usetiful_tourPointerWaitingForElement=setTimeout((()=>{const{element:t}=this.stepData;t&&this.availableOnPage.checkElement(t)&&!Ss(ds(t))?this.createPointer(!0):window.usetiful_tourPointerWaitingForElement=setTimeout((()=>{t&&this.availableOnPage.checkElement(t)&&!Ss(ds(t))?this.createPointer(!0):this.showAlternativeSolution(!1)}),1500)}),1500)}}const no=ro;const oo=class{constructor(t,e){var s,o=this;this.contentType="tour",this.goToNextStepEvent=t=>{this.goToNextStep(t.detail.props&&void 0!==t.detail.props.display?t.detail.props.display:void 0)},this.goToPreviousStepEvent=()=>{this.goToPreviousStep()},this.closeTourEvent=t=>{this.closeTour(t.detail.props&&t.detail.props.reason?t.detail.props.reason:void 0)},this.setTourTriggerToLocalStorageEvent=t=>{this.tourTriggers.setTourTriggerToLocalStorage(t.detail.props&&t.detail.props.tourId?t.detail.props.tourId:this.id)},this.moveToStepEvent=t=>{if(!t.detail.props)return;let{stepId:e}=t.detail.props;if("string"==typeof t.detail.props.stepId){const s=parseInt(t.detail.props.stepId,10);s&&s.toString()===e&&(e=s)}this.moveToStep({display:t.detail.props.display,stepIdent:e})},this.setProgressEvent=t=>{this.localStorageTourHandler.setProgressToLocalStorage(t,this.getTour(),this.getCurrentStepIndex()),this.state=t},this.eventHandler=t=>{if(t.detail.tourId&&t.detail.tourId===this.id)switch(t.detail.event){case A:this.goToNextStepEvent(t);break;case O:this.goToPreviousStepEvent();break;case _:this.closeTourEvent(t);break;case $:this.setTourTriggerToLocalStorageEvent(t);break;case B:this.moveToStepEvent(t);break;case R:t.detail.props&&t.detail.props.status&&this.setProgressEvent(t.detail.props.status);break;case N:this.placeNextStepTrigger()}},this.placeTourListeners=()=>{document.addEventListener(T,this.eventHandler)},this.removeTourListeners=()=>{document.removeEventListener(T,this.eventHandler)},this.runTour=t=>{let{display:e=!1,startStep:s,isDevKit:i=!1,runByParent:o}=t,a=e;window.usetiful_isAboutToRefresh&&(a=!1),Vt(`runTour: Starting tour = ${this.tourData.name}, display = ${a}, licence = ${Gi(Ki.license)}, startStep = ${s}`,!0),this.placeTourListeners();const l=this.localStorageTourHandler.getObjectStatus(this.tourData.id.toString());if(i){if(l===r)return void Jt("Tour that you want to launch is already running");this.closeTour()}const{id:c,steps:h,theme:u,themeSlug:d,showEverytime:p,autoplay:g}=this.tourData;In(v,c),fe({isToursContext:!0,name:D,details:{value:this}}),this.loader.loadTheme(u,d).then((t=>{var e,r,u,d,m,f;null===(e=this.getCurrentStep())||void 0===e||e.update(),this.template.setTheme(t),this.template.setIsWatermark(Gi(Ki.watermark));let v=this.localStorageTourHandler.getCurrentStepIndexLS(c);if(void 0!==s)v=s;else{const t=this.localStorageTourHandler.getObjectState(this.tourData.id.toString(),"currentStep");v=t||0}const y=null===(r=this.getCurrentStep())||void 0===r?void 0:r.getStepData();if(y&&y.type===Ke&&v>0&&"self"!==y.tourName&&(Vt("runTour: Current step is redirect. Moving to the previous step."),Vt(`runTour: ${y.tourName}`),v-=1),!o&&this.isButton()&&Gt(this.tourData,this.localStorageTourHandler)&&(Gi(Hi).checkAvailableOnPage(this.tourData.targets,this.tourData.targetOperator)||Pt)?this.currentMainButton.placeUsetifulButton(this.tourData):this.currentMainButton.getButtonElement()&&this.currentMainButton.destroy(),a||p||l!==n){if(a)this.stepTriggersController.placeTourTriggers(h,this.triggerEvent,this.reverseTriggerEvent),this.updateCurrentStep(v),null===(u=this.getCurrentStep())||void 0===u||u.placeStepProgressTrigger();else if(!g&&0===v)return console.warn("Shouldn't be displayed and is manual tour"),void(null===(d=this.getCurrentStep())||void 0===d||d.stepData);(null===(m=this.getCurrentStep())||void 0===m?void 0:m.isAppearsTrigger())?null===(f=this.getCurrentStep())||void 0===f||f.waitForStep(a,(()=>{Yt(),this.moveToStep({stepIndex:v,display:a,isDevKitDirect:!1,isDevKitIndirect:i})})):this.moveToStep({stepIndex:v,display:a,isDevKitDirect:!1,isDevKitIndirect:i})}else console.warn("Tour has been seen and shouldn't be displayed")}))},this.destroy=()=>{this.removeTourListeners(),this.clearWaiters()},this.closeTour=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var s,a,l,c,h,u,d,p;Pt&&Qt("close tour"),(o.tourTriggers&&!o.tourTriggers.hasTourTrigger(o.id)||0===o.currentStepIndex)&&In("",null);let g=t;const m=o.getTour();if(!m||o.localStorageTourHandler.getObjectStatus(m.id.toString())!==r)return Vt("call closeTour but there is no running tour at this moment."),Qr(),void(null===(s=o.getCurrentStep())||void 0===s||s.destructStep());if(Vt(`closeTour: tour: ${m.name}, with reason: ${t}`,!0),g||(g=it),o.isLastStep()||o.isLastStepReached){Gi(Ji).completeItem(i,o.id)}const f=new CustomEvent(M,{detail:{type:ut,entityId:m.id,stepIndex:o.getCurrentStepIndex(),action:g,itemId:null===(a=o.getCurrentStep())||void 0===a?void 0:a.stepData.id,isDevKit:e}});document.dispatchEvent(f),Qr(),o.triggers&&o.triggers.triggersClearance(!0),o.clearWaiters(),null===(l=o.getCurrentStep())||void 0===l||l.destructStep(),(t===st&&!(null===(c=o.getCurrentStep())||void 0===c?void 0:c.stepData.tourName)||void 0===t||(null===(u=null===(h=o.getCurrentStepData())||void 0===h?void 0:h.getStepData())||void 0===u?void 0:u.type)===Ke&&"self"!==(null===(p=null===(d=o.getCurrentStepData())||void 0===d?void 0:d.getStepData())||void 0===p?void 0:p.tourName))&&(o.tourTriggers.removeTriggerFromLocalStorage(m.name),o.tourTriggers.removeTriggerFromLocalStorage(m.id)),!o.isLastStep()&&m.rememberLastStep||o.resetCurrentStep(),o.setProgressEvent(n),o.isLastStepReached=!1,Vt(`closeTour: ${m.name} has been closed.`,!t)})(),o.removeTourListeners(),fe({isToursContext:!0,name:L}),fe({isToursContext:!0,name:I})},this.clearWaiters=()=>{this.waiters&&this.waiters.length>0&&(this.waiters.forEach((t=>{clearInterval(t)})),this.waiters=[])},this.destructStepByName=t=>{const e=this.steps.fi==t));e&&e.destructStep()},this.triggerEvent=t=>{Vt(`triggerEvent called with param ${t}`,!0),""!==t&&this.moveToStep({stepIdent:t,display:!0})},this.reverseTriggerEvent=t=>{Vt(`reverseTriggerEvent called with param ${t}`),this.destructStepByName(t)},this.placeNextStepTrigger=()=>{if(this.hasNextStep()){const t=this.getNextStepWithTrigger();if(!t)return;if(t&&t.isAppearsTrigger())this.placeNextStepAppearTrigger(t);else{const e=this.currentStepIndex+1;if(!t.stepData.trigger)return;let s=null;s=window.usetiful_activeTriggersOnElements.find((e=>e.stepId===t.name));const i=this.getStepByIndex(e);let r=!1;s||(s=new Os(t.stepData.trigger,Gi(Hi)),r=!0),s.stepId=null==i?void 0:i.name,s.triggerFunction=()=>{this.moveToStep({stepIndex:e,display:!0})},r&&this.triggers.addToActiveTriggers(s)}}},this.placeNextStepAppearTrigger=t=>{const e=this.getStepIndex(t.stepData.name),s=this.currentStepIndex+1;e&&s&&t.waitForStep(true,(()=>{this.moveToStep({stepIndex:s,display:true})}),(()=>{var s;t.stepData.autoskip?(null===(s=this.getCurrentStep())||void 0===s||s.destructStep(t),Gr(),this.updateCurrentStep(e),this.autoSkip(t.stepData.autoskip)):t.showAlternativeSolution(!1)}))},this.autoSkip=t=>{var e;if(t){Vt("call autoSkip");const t=null===(e=this.getNextStep(!1))||void 0===e?void 0:e.stepData;t&&(t.type===Ve||t.type===Je||t.element&&ds(t.element))?t.trigger?"appears"===t.trigger.type&&ds(t.trigger.element)&&this.goToNextStep():this.goToNextStep():t?this.goToNextStep():(Jt("The last step of your tour has been autoskiped. Closing tour... "),this.closeTour())}},this.goToPreviousStep=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Vt("call goToPreviousStep"),o.moveToStep({stepIndex:o.getCurrentStepIndex()-1,display:!0,isDevKitDirect:t})},this.goToNextStep=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Vt("call goToNextStep"),Vt(`current step index is ${o.getCurrentStepIndex()}`);let s=t;window.usetiful_isAboutToRefresh&&(s=!1),o.moveToStep({stepIndex:o.getCurrentStepIndex()+1,display:s,isDevKitDirect:e})},this.getStepIndex=t=>{let e=-1;const s=this.getStepByIdent(t);return s&&(e=this.steps.indexOf(s)),e},this.getStepByIdent=t=>{let e;return e="string"==typeof t?this.getStepByName(t):this.getStepById(t),e},this.getStepById=t=>{let e;return this.steps&&(e=this.steps.find((e=>e.id===t))),e},this.getStepByName=t=>{let e;return this.steps&&(e=this.steps.find((e=>e.name===t))),e},this.moveToStep=t=>{var e,s,i,n,o,a,l;if(window.usetiful_tourDelayTimeoutVar)return;const{stepIdent:c,stepIndex:h,display:u,isDevKitDirect:d,isDevKitIndirect:p}=t;d&&this.checkRunningTour(),window.usetiful_tourDelayTimeoutVar&&(clearTimeout(window.usetiful_tourDelayTimeoutVar),window.usetiful_tourDelayTimeoutVar=void 0),window.usetiful_tourPointerWaitingForElement&&(clearTimeout(window.usetiful_tourPointerWaitingForElement),window.usetiful_tourPointerWaitingForElement=void 0);let g=-1;if(void 0!==c){Vt(`Move to stepId: ${c}`,!0);const t=this.getStepIndex(c);t>=0&&(g=t)}else void 0!==h&&(Vt(`Move to stepIndex: ${h}`,!0),g=h);const m=g-this.currentStepIndex,f=m<0,v=Math.abs(m)>1;let y=c?this.getStepByIdent(c):this.getStepByIndex(g);if(y){let t=y.stepData;if(0===g&&this.stepTriggersController.isAutomatedStep(t)){this.getNextStep()}const l=`.${this.template.themeClasses.prefix}-${null===(e=this.getCurrentStep())||void 0===e?void 0:e.stepData.name}`,c=ds(l),h=`.${this.template.themeClasses.prefix}-${t.name}`,m=ds(h);if((null===(s=this.getCurrentStep())||void 0===s?void 0:s.stepData.name)!==t.name&&c&&(Vt("JumpTo: Previous step is still visible so need to be destructed."),null===(i=this.getCurrentStep())||void 0===i||i.destructStep(y)),g&&m)return;const w=t&&t.element?ds(t.element):null;if(f&&((!w||Ss(w))&&(null==t?void 0:t.autoskip)||this.stepTriggersController.isAutomatedStep(t)&&!v)&&(Vt("Moving to previous step"),g-1>=0)){const e=this.getStepByIndex(g-1);t=null===(n=((t,e)=>{if(e.isTour()){if("string"==typeof t){const s=e.getStepIndex(t);if(s&&s>=0)return e.getStepByIndex(s)}if("number"==typeof t)return e.getStepByIndex(t)}return null})(null==e?void 0:e.stepData.name,this))||void 0===n?void 0:n.stepData,y=e,g-=1}Vt(`Move to step: ${null==t?void 0:t.name}, display:${u}`),y&&"number"==typeof g&&(u&&!this.localStorageTourHandler.isTourReopenFromLS(this.name)&&(this.getCurrentStepIndex()!==g?null===(o=this.getCurrentStep())||void 0===o||o.destructStep(y):null===(a=this.getStepByIndex(this.localStorageTourHandler.getCurrentStepIndexLS(this.id)))||void 0===a||a.destructStep(y)),this.updateCurrentStep(g),u?(y.constructStep(u,d||p),this.updateTriggers()):this.setProgressEvent(r))}else{if(d)throw new Error("Step not found");Vt("JumpTo: Step not found"),null===(l=this.getCurrentStep())||void 0===l||l.destructStep(),this.isLastStep()&&(this.isLastStepReached=!0),this.resetCurrentStep(),this.getTour()&&this.isButton()&&this.moveToStep({stepIndex:0,display:!1}),this.closeTour()}},this.updateTriggers=()=>{this.stepTriggersController.placeTourTriggers(this.tourData.steps,this.triggerEvent,this.reverseTriggerEvent)},this.tourData=t,this.name=t.name,this.id=t.id,this.objectPriority=t.objectPriority,this.steps=[],this.triggers=Gi(Ri),this.loader=Gi(Ni),this.currentMainButton=Gi(Fi),this.tourTriggers=Gi(Bi),this.template=new Ps,t.steps.forEach((t=>{this.steps.push(new no(t,this,this.template))})),this.localStorageTourHandler=Gi(qi),this.currentStepIndex=0,this.currentStep=null!==(s=this.steps[0])&&void 0!==s?s:null,this.state=n,this.waiters=[],this.stepTriggersController=e,this.isLastStepReached=!1}setTour(t){this.tourData=t}getTour(){return this.tourDta}isProgress(){var t;return null==(null===(t=this.tourData)||void 0===t?void 0:t.progress)||this.tourData.progress}isButton(){var t;return null==(null===(t=this.tourData)||void 0===t?void 0:t.button)||this.tourData.button}getStepByIndex(t){return this.getStepsLength()>0&&"number"==typeof t&&this.steps[t]||n[]}getCurrentStep(){return this.currentS0}setCurrentStepIndex(t){this.currentStepIndex=t}updateCurrentStep(t){this.setCurrentStepIndex(t);const e=this.steps[t];e&&(this.currentStepx}isLastStep(){return!(!this.tourData||!this.tourData.steps)&&this.currentStepIndex>=this.tourData.steps.length-1}getPreviousStep(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t&&this.currentStepIndex>0&&(this.currentStepIndex-=1),this.getStepByIndex(t?this.currentStepIndex:this.currentStepIndex-1)}getNextStep(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t&&(this.currentStepIndex+=1),this.getStepByIndex(t?this.currentStepIndex:this.currentStepIndex+1)}getNextStepWithTrigger(){for(let t=this.currentStepIndex+1;t<this.steps.length;t+=1)if(this.steps[t].stepData.trigger)return this.steps[t];return n()}hasNextStep(){return this.currentStepIndex+1<this.getStepsLengt:0}isSteps(){return!!this.tourData&&(this.tourData.steps&&this.getStepsLength()>0)}checkRunningTour(){if(this.localStorageTourHandler.getObjectStatus(this.id.toString())!==r)throw new Error("You should run a tour first")}};const ao=class{constructor(t){this.placeTourTriggers=(t,e,s)=>{Vt("placeTourTriggers: Placing tour triggers..."),t.forEach(((t,i)=>{let{trigger:r,name:n}=t;if(!r||0===i)return;const o=new Os(r,this.availableOnPage);o.triggerFunction=e,o.stepId=n,o.isInitial=!1,o.reverseTriggerFunction=s,this.CommonTriggersControl.placeTrigger(o)})),Vt("placeTourTriggers: Placed triggers:"),Kt(window.usetiful_activeTriggersOnElements)},this.placeInitialTriggers=(t,e)=>{var s,i;Vt("placeInitialTriggers");for(const r of t){let t=null===(i=null===(s=null==r?void 0:r.steps[0])||void 0===s?void 0:s.stepData)||void 0===i?void 0:i.trigger;t=!t&&r.steps[1]&&this.isAutomatedStep(r.steps[0].stepData)?r.steps[1].stepData.trigger:t;const{id:n}=r.tourData;if(t&&n&&Gt(r.tourData,this.localStorageHandler)){const s=new Os(t,this.availableOnPage);s.isInitial=!0,s.triggerFunctn)},s.reverseTriggerFunction=r.reverseTriggerEvent,this.CommonTriggersControl.placeTrigger(s)}}},this.isAutomatedStep=t=>!!(t&&t.type&&[ze,Ke,Ge,Ye].indexOf(t.type)>-1),this.CommonTriggersControl=Gi(Ri),this.localStorageHandler=Gi(qi),window.usetiful_activeTriggersOnElements=[],window.usetiful_activeListeners=[],this.availableOnPage=t}};window.USETIFUL||(window.USETIFUL={});window.USETIFUL.reinitialize=()=>{window.USETIFUL.user&&window.USETIFUL.user.getProgress(),Te()};class lo{constructor(t){var e=this;this.setTours=t=>{for(const e of t)this.tours.push(new oo(e,this.stepTriggersController))},this.placeAllButtonEvent=()=>{this.currentMainButton.placeAllButtons(this.availableTours,Gt,this.localStorageTourHandler)},this.placeInitialTriggersEvk)},this.setCurrentTour=t=>{t.detail.props.value instanceof oo&&(this.currentTour=t.detail.props.value)},this.beforeUnloadListener=()=>{window.usetiful_isAboutToRefresh=!0,fe({name:P,isToursContext:!0})},this.beforeUnloadEvr)},this.stopBeforeUnloadEvt)},this.eventHandler=t=>{if(t.detail.isToursContext)switch(t.detail.event){case I:this.placeAllButtonEvent();break;case L:this.placeInitialTriggersEvent();break;case D:this.setCurrentTour(t);break;case x:this.beforeUnloadEvent();break;case P:this.stopBeforeUnloadEvent()}},this.addTourEventsListeners=()=>{document.addEventListener(b,this.eventHandler)},this.removeTourEventsListeners=()=>{document.removeEventListener(b,this.eventHandler)},this.destroy=()=>{if(this.currentTour&&this.currentTour.isTour()&&this.currentTour.getCurrentStep()){const t=this.currentTour.currentStep;t.destructStep(),(t&&t.stepData.highlight||!t.stepData.highlight&&document.querySelectorAll(We.overlay).length>0)&&Gr()}},this.destroyInstance=()=>{Vt("destroy tours object"),this.tourInitClearExistingTimeouts(),this.checkingTargetsInterval&&window.clearInterval(this.checkingTargetsInterval),this.availableTours=[],this.availableOnPage.refreshURL(),bs("[data-uf-button='button-main']"),this.commonTriggers.triggersClearance(!0);const t=document.querySelectorAll("[data-uf-content]");t.length>0&&t.forEach((t=>{ws(t)})),this.removeTourEventsListeners(),this.tours.length>0&&(this.tours.forEach((t=>{t.destroy()})),this.tours=[]),this.destroy()},this.init=()=>{this.addTourEventsListeners(),Vt(`toursInit: Customer's license: ${Gi(Ki.license)}`),this.tourTriggers.checkTourTriggers(),(t=>{const e={start:function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=t.tours.find((t=>t.id===e));if(!r)throw new Error("Your tour Id is not valid!");const n=t.localStorageTourHandler.getRunningTour();if(n){if(e===n)return void console.warn("Tour that you want to run is already running.");if(s)return void t.showTourSwitcher({tour:r,runningTourId:n,runOptions:{isDevKit:!0}});{const e=t.getTourByID(n);null==e||e.closeTour(void 0,!0)}}r.runTour({display:!0,isDevkit:!0,startStep:i-1})},nextStep:()=>{var e;null===(e=t.currentTour)||void 0===e||e.goToNextStep(void 0,!0)},preStep:()=>{var e;null===(e=t.currentTour)||void 0===e||e.goToPreviousStep(!0)},close:()=>{var e;null===(e=t.currentTour)||void 0===e||e.closeTour(void 0,!0)},jumpTo:e=>{var s;null===(s=t.currentTour)||void 0===s||s.moveToStep({stepIndex:e-1,display:!0,isDevKitDirect:!0})},getState:()=>{const e=localStorage.getItem(_t);let s=[];e&&(s=JSON.parse(e));const i=[];return t.availableTours.forEach((t=>{const e=s.find((e=>e.id===t.id)),r={name:t.name,id:t.id,isAvailable:!0,state:e?e.state:"never run"};e&&"inProgress"===e.state&&(r.currentStep=null==e?void 0:e.currentStep),i.push(r)})),s.forEach((e=>{t.availableTours.find((t=>e.id===t.id))||(e.isAvailable=!1,"inProgress"!==e.state&&delete e.currentStep,i.push(e))})),i}};window.USETIFUL.tour=e})(this),window.addEventListener("click",Xn),window.addEventListener("focusin",Xn)},this.getLiveTours=()=>{const t=[];return this.tours.forEach((e=>{e.contentType=v,t.push(e)})),t},this.tourInitClearExistingTimeouts=()=>{window.usetiful_tourDelayTimeoutVar&&(clearTimeout(window.usetiful_tourDelayTimeoutVar),window.usetiful_tourDelayTimeoutVar=void 0),window.usetiful_tourPointerWaitingForElement&&(clearTimeout(window.usetiful_tourPointerWaitingForElement),window.usetiful_tourPointerWaitingForElement=void 0)},this.runTourOnClick=function(t,s){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};const o=e.getTourByID(s);if(!o)return void Jt("Tour that you want to run does not exist.");if(Vt("runTourOnClick called"),Vt(o.tourData.name),o.state===r)return void Jt("Tour that you want to run is already running.");"function"==typeof n&&n();const a=e.localStorageTourHandler.getRunningTour(e.availableTours);var l;null!==a&&e.localStorageTourHandler.getObjectStatus(s.toString())!==r?e.showTourSwitcher({tour:o,runningTourId:a,runByParent:i,parentHideFunction:n}):o.runTour({display:!0,runByParent:i}),t&&(t.stopImmediatePropagation(),"wheel"!==(l=t).type&&"scroll"!==l.type&&t.preventDefault())},this.runTourById=t=>{const e=this.getTourByID(t);e?e.runTour({display:!0}):console.warn(`runTourById: Tour with id ${t} not found`)},this.getTourBt)),this.showTourSwitcher=t=>{let{tour:e,runningTourId:s,runByParent:i=!1,parentHideFunction:r=(()=>{}),runOptions:n={}}=t;Wn({name:Hn,text:`User attempts to force-switch from tour ${s} to tour ${e.id}`,type:"tour",id:s}),this.template.confirmation("Switch to another tour",`Do you want to switch to the tour '${e.tourData.name}'?`,"Yes","No",(()=>{var t;if(s&&(!this.currentTour||this.currentTour&&this.currentTour.id.toString()!==s)){const t=this.getTourByID("string"==typeof s?parseInt(s,10):s);t&&(this.currentTour=t)}null===(t=this.currentTour)||void 0===t||t.closeTour(),"function"==typeof r&&r(),e.runTour(Object.assign({display:!0,runByParent:i},n))}),"")},this.toursData=t,this.currentTour=null,this.availableTours=[],this.commonTriggers=Gi(Ri),this.tourTriggers=Gi(Bi),this.localStorageTourHandler=Gi(qi),this.currentMainButton=Gi(Fi),this.template=new Ps,this.availableOnPage=Gi(Hi),this.stepTriggersController=new ao(this.availableOnPage),this.tours=[],this.setTours(this.toursData),this.beforeUnload=Gi(Ai)}}const co=t=>{let{type:e,entityId:s=0,stepIndex:i=0,action:r,itemId:n=0,isDevKit:o}=t;{const t=Gi($i);if(!t)return;Vt(`report of ${e} for entity ${n||s} with action ${r}`),t.add({type:e,id:n||s,entityId:s,tourId:"number"==typeof s?s:0,stepIndex:i,action:r,isDevKit:o})}}l)},uo=t=>{(t=>{let{reportType:e="form",question:s="",questionType:i="",answer:r="",formId:n,entityId:o=0}=t;{const t=Gi($i);if(!t)return;Vt(`report of form for entity ${o} with question ${s} with answer ${r}`),t.add({reportType:e,formId:n,questionType:i,question:s,answer:r,entityId:o})}})(t.detail)},po=t=>{(t=>{let{reportType:e="error",name:s="",text:i="",code:r=0,url:n="",entityId:o="0",entityType:a="",spaceId:l=0}=t;{const t=Gi($i);if(!t)return;Vt(`report of form for entity ${o} with question ${s} with answer ${i}`),t.add({reportType:e,name:s,text:i,code:r,url:n,entityType:a,entityId:o,spaceId:l})}})(t.detail)};const go=class{constructor(){this.visibilityAPI=this.getVisibilityAPI(),this.boundVisibilityHandler=this.handleVisibilityChange.bind(this)}init(){this.visibilityAPI.visibilityChange&&document.addEventListener(this.visibilityAPI.visibilityChange,this.boundVisibilityHandler,!1)}destroy(){document.removeEventListener(this.visibilityAPI.visibilityChange,this.boundVisibilityHandler,!1)}getVisibilityAPI(){if(void 0!==document.hidden)return{hidden:"hidden",visibilityChange:"visibilitychange",state:"visibilityState"};if(void 0!==document.msHidden)return{hidden:"msHidden",visibilityChange:"msvisibilitychange",state:"msVisibilityState"};if(void 0!==document.webkitHidden)return{hidden:"webkitHidden",visibilityChange:"webkitvisibilitychange",state:"webkitVisibilityState"};throw new Error("Page Visibility API is not supported.")}handleVisibilityChange(){if("visible"===document[this.visibilityAPI.state]){const t=new CustomEvent(F);document.dispatchEvent(t)}else{const t=new CustomEvent(j);document.dispatchEvent(t)}}};var mo=s(337),fo=s(904);window.USETIFUL||(window.USETIFUL={});const vo=(t,e)=>{(0,V.createScript)("u-banners-data",null,`window.uBanners = ${JSON.stringify(e)};`);(0,V.createScript)("u-banners",`${t}dist/u-banners.js?t=${Date.now()}`).onload=()=>{var t;null===(t=window.USETIFUL)||void 0===t||t.bannersInit()},window.addEventListener(()}))};!function(){if(window.usetiful_instance)return console.warn("The Usetiful script cannot be initialized because another Usetiful instance is already running. Check the implementation of the Usetiful code and prevent it from being called multiple times when page is loading."),void Wn({name:Fn,type:"account"});window.usetiful_instance=Date.now().toString(),(()=>{const{localStorage:t}=window;zi.registerConstant(Ki.apiToken,wt),zi.registerConstant(Ki.reporterBasePath,"reporter/api"),zi.registerClass(Oi,me,[Ki.apiToken]),zi.registerClass(_i,me,[Ki.apiToken,Ki.reporterBasePath]),zi.registerConstant(Ki.LocalStorage,t),zi.registerClass(Ai,Ie,[Ai]),zi.registerClass(Ni,Ee,[Oi,Ai]),zi.registerClass(Mi,Be,[Oi]),zi.registerClass($i,ae,[Oi,_i,Mi,Ai]),zi.registerClass(Bi,ve,[Ki.LocalStorage]),zi.registerClass(Ui,xe,[Ki.apiToken,Mi,Ai,Oi]),zi.registerConstant(Ki.tourType,i),zi.registerConstant(Ki.smartTipsType,Di),zi.registerConstant(Ki.tourStorageKeyName,_t),zi.registerConstant(Ki.smartTipsGroupStorageKeyName,$t),zi.registerClass(qi,xi,[Ki.tourType,Ki.tourStorageKeyName,Ui]),zi.registerClass(Vi,xi,[Ki.smartTipsType,Ki.smartTipsGroupStorageKeyName,Ui]),zi.registerClass(ji,Re,[Ui]),zi.registerClass(Fi,As,[Ni]),zi.registerClass(Ji,Pi,[qi]),zi.registerClass(Hi,ui,[qi,Ji,ji]),zi.registerClass(Ri,Ns,[Hi]),zi.registerClass(Wi,Li,[qi,Ui,Ji])})();const t=Gi(Ni),e=Gi(Mi),s=Gi(Ai),r=Gi(Ui),n=Gi(Wi),o=Gi($i);window.usetiful_intervals=[];let a=null,l=null,c=null,u=null,d=null,p=null;const g=t=>{let{tours:i=[],smartTipsGroups:g=[],checklists:m=[],assistants:f=[],banners:b=[],licence:T,reportPrivacyMode:S,watermark:C}=t;var k;n.init(i,m),Yi(Ki.license,T),Yi(Ki.watermark,C),(()=>{const t=Gi(Mi).getTag("userId");Vt(`Identified userId is: ${t}`),t&&t===h&&(console.error("Invalid UserID provided to Usetiful. Replace sample value with unique identificator for each logged-in user. Read more about how to use userIDs on https://help.usetiful.com/support/solutions/articles/77000514872-user-id-for-cross-device-support"),Wn({name:jn,text:"You are using an example userId.",type:"account"}))})(),e.setReportDataPrivacy(parseInt(S,10)),window.usetiful_intervals.length>0&&(k=window.usetiful_intervals,Vt(`Cleaning ${k.length} intervals...`),k.forEach((t=>{clearInterval(t)})),window.usetiful_intervals=[]),u&&(u=null),c&&(c=null),l&&(l=null),p&&(p.destroy(),p=null),a&&(a.destroy(),a=null),o&&(document.removeEventListener(M,ho),document.removeEventListener(H,uo),document.removeEventListener(W,po),o.destroy()),r&&r.destroy(),s&&s.destroy(),window.usetifulTags||(window.usetifulTags={}),window.removeEventListener("click",Xn),window.removeEventListener("focusin",Xn),(0,V.loadTagsFromLS)(),b.length&&vo(Ft,b),d=new Cn(g),l=new lo(i),u=new Rn(f,l.runTourOnClick),c=new Ln(m,l.runTourOnClick),p=new go,a=new qn(u,c,l,[v,y,w],!1),s.init(),r.init(),d.init(),p.init(),a.init(),document.addEventListener(M,ho),document.addEventListener(H,uo),document.addEventListener(W,po),o.init();const E=Gi(qi),I=Gi(ji);((t,e,s)=>{const i={getProgress:()=>{t.loadedUserData={},t.loadFromApi(),e.loadedFromStorage=!1,s.clearParsedData(),s.processParseData()},se=t},setTag:function(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];window.usetifulTags||(window.usetifulTags={}),window.usetifulTags[t]=e,(0,mo.updateTagValue)(t,e),s&&window.USETIFUL.user.syncToProgressor()},setTags:function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];window.usetifulTags||(window.usetifulTags={});for(const s in t)t[s]&&window.USETIFUL.user.setTag(s,t[s],e)},removeTag:function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];window.usetifulTags||(window.usetifulTags={}),delete window.usetifulTags[t],(0,mo.removeTagValue)(t),e&&window.USETIFUL.user.syncToProgressor()},removeAllTags:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(window.localStorage.removeItem(fo.tagsLSKey),window.usetifulTags)for(const t in window.usetifulTags)"userId"!==t&&delete window.usetifulTags[t];t&&window.USETIFUL.user.syncToProgressor()},clearProgress:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];window.localStorage.removeItem(_t),window.localStorage.removeItem(Nt),window.localStorage.removeItem($t),window.localStorage.removeItem(Bt),window.localStorage.removeItem(Rt),window.localStorage.removeItem(Ut),window.localStorage.removeItem(Mt),window.localStorage.removeItem(jt),window.USETIFUL.user.removeAllTags(t)},syncToProgressor:()=>{window.usetifulTags.userId&&fe({name:q})}};window.USETIFUL.user=i})(r,E,I)};t.loadCriticalCss(),t.loadConfig((t=>g(t)))}()})()})();