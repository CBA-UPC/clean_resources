(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[184],{"/MeB":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("QjXU"),o=n("BaAg"),r=n("n826"),s=(n("GmnP"),function(){function e(e,t,n){this.oneDriveGraphService=e,this.activatedRoute=t,this.fluidInstrumentationService=n,this.itemId=void 0,this.driveId=this.activatedRoute.snapshot.queryParams.drive}return e.prototype.ngOnDestroy=e.prototype.getMruFileItem=function(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!this.driveItemPromise&&!this.itemId)throw new Error("Fluid file item not set");!this.driveItemPromise&&this.itemId&&this.fetchDriveItem(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.driveItemPromise];case 2:return t=i.sent(),n=o.a.fileNameWithoutExtension(t.name),[2,{documentUrl:t.webDavUrl+"?web=1",canonicalUrl:t.webDavUrl,sharepointIds:t.sharepointIds,fileName:t.name,driveId:null===(e=t.parentReference)||void 0===e?void 0:e.driveId,docId:t.id,title:n}];case 3:throw r=i.sent(),this.driveItemPromise=void 0,this.fluidInstrumentationService.instrumentError("Mru_File_Item_Error","Mru_File_Item",r),r;case 4:return[2]}}))}))},e.prototype.setFluidFileItem=function(e){e!==this.itemId&&(this.driveId=this.activatedRoute.snapshot.queryParams.drive,this.itemId=e,this.fetchDriveItem())},e.prototype.getMruDataItem=function(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!this.driveItemPromise&&!this.itemId)throw new Error("Fluid file item not set");!this.driveItemPromise&&this.itemId&&this.fetchDriveItem(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.driveItemPromise];case 2:return t=i.sent(),n=o.a.fileNameWithoutExtension(t.name),[2,{Application:"Fluid",Category:"Document",ServerDocId:t.id,Title:n,MruV2Type:"DocumentUrl",Url:t.webDavUrl,DocId:t.id,DriveId:null===(e=t.parentReference)||void 0===e?void 0:e.driveId,FileName:t.name,WebUrl:t.webUrl,LastAccessedTime:new Date,FileType:"",Provenance:"",PathArray:[]}];case 3:throw r=i.sent(),this.driveItemPromise=void 0,r;case 4:return[2]}}))}))},e.prototype.getFileInfo=function(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!this.driveItemPromise&&!this.itemId)throw new Error("Fluid file item not set");!this.driveItemPromise&&this.itemId&&this.fetchDriveItem(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.driveItemPromise];case 2:return t=i.sent(),n=o.a.fileNameWithoutExtension(t.name),[2,{siteUrl:t.sharepointIds.siteUrl,siteId:t.sharepointIds.siteId,folderUrl:this.extractFolderUrlFromFileUrl(t.webDavUrl),createdBy:t.createdBy.user.displayName,filename:n,fileExtension:"."+o.a.getFileExtension(t.name),itemId:t.id,driveId:null===(e=t.parentReference)||void 0===e?void 0:e.driveId}];case 3:throw r=i.sent(),this.driveItemPromise=void 0,r;case 4:return[2]}}))}))},e.prototype.getListingVersions=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,o=this;return Object(i.__generator)(this,(function(s){return n=""+r.a.drivesEndpoint+e+"/"+r.a.itemsEndpoint+t+"/versions",[2,new Promise((function(e,t){return Object(i.__awaiter)(o,void 0,void 0,(function(){var o,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.oneDriveGraphService.getFileListingVersions(n)];case 1:return o=i.sent(),e(o),[3,3];case 2:return r=i.sent(),t(r),[3,3];case 3:return[2]}}))}))}))]}))}))},e.prototype.fetchDriveItem=function(e){var t=this;void 0===e&&(e=!1),this.driveItemPromise=this.oneDriveGraphService.getItemWithIds(this.driveId,this.itemId,"id,webUrl,webDavUrl,name,sharepointIds,createdBy,parentReference","network-only",null,!1,e),this.driveItemPromise.catch((function(e){t.driveItemPromise=void 0,t.fluidInstrumentationService.instrumentError("OneDrive_Graph_Item_Error","OneDrive_Graph_Item_Error",e.toString())}))},e.prototype.extractFolderUrlFromFileUrl=function(e){var t=e.lastIndexOf("/");return t>0&&t<e.length-1?e.substr(0,t+1):""},e}())},"/XTp":function(e,t,n){var i={"./af-za/HostUxStrings.json":["hnah",389],"./am-et/HostUxStrings.json":["2Ric",390],"./ar-sa/HostUxStrings.json":["uKRo",401],"./as-in/HostUxStrings.json":["+xQ7",412],"./az-latn-az/HostUxStrings.json":["YA9a",423],"./bg-bg/HostUxStrings.json":["FT37",434],"./bn-in/HostUxStrings.json":["k7lo",445],"./bs-latn-ba/HostUxStrings.json":["LQxH",456],"./ca-es-valencia/HostUxStrings.json":["Hmr7",474],"./ca-es/HostUxStrings.json":["mhOf",467],"./cs-cz/HostUxStrings.json":["Lxev",391],"./cy-gb/HostUxStrings.json":["8yKg",392],"./da-dk/HostUxStrings.json":["8O2y",393],"./de-de/HostUxStrings.json":["KN5r",394],"./el-gr/HostUxStrings.json":["EwrD",395],"./en-gb/HostUxStrings.json":["SbpT",396],"./en-us/HostUxStrings.json":["tsxt",397],"./es-es/HostUxStrings.json":["ZHfo",398],"./es-mx/HostUxStrings.json":["ECJZ",399],"./et-ee/HostUxStrings.json":["+gix",400],"./eu-es/HostUxStrings.json":["ukgP",402],"./fa-ir/HostUxStrings.json":["x4J+",403],"./fi-fi/HostUxStrings.json":["uSzb",404],"./fil-ph/HostUxStrings.json":["DGuw",405],"./fr-ca/HostUxStrings.json":["wWjm",406],"./fr-fr/HostUxStrings.json":["XKX+",407],"./ga-ie/HostUxStrings.json":["t/4C",408],"./gd-gb/HostUxStrings.json":["vxgM",409],"./gl-es/HostUxStrings.json":["SHFT",410],"./gu-in/HostUxStrings.json":["XSkG",411],"./he-il/HostUxStrings.json":["MqYH",413],"./hi-in/HostUxStrings.json":["Xmd2",414],"./hr-hr/HostUxStrings.json":["2oHt",415],"./hu-hu/HostUxStrings.json":["dVFb",416],"./hy-am/HostUxStrings.json":["RhZm",417],"./id-id/HostUxStrings.json":["xEwA",418],"./is-is/HostUxStrings.json":["2+Ng",419],"./it-it/HostUxStrings.json":["yALI",420],"./ja-jp/HostUxStrings.json":["4q68",421],"./ka-ge/HostUxStrings.json":["l6tm",422],"./kk-kz/HostUxStrings.json":["N2nT",424],"./km-kh/HostUxStrings.json":["ZIH6",425],"./kn-in/HostUxStrings.json":["cqAH",426],"./ko-kr/HostUxStrings.json":["oQm3",427],"./kok-in/HostUxStrings.json":["VBQe",428],"./lb-lu/HostUxStrings.json":["A6Kz",429],"./lo-la/HostUxStrings.json":["a55S",430],"./lt-lt/HostUxStrings.json":["iC1C",431],"./lv-lv/HostUxStrings.json":["zxEn",432],"./mi-nz/HostUxStrings.json":["PfHX",433],"./mk-mk/HostUxStrings.json":["4CXJ",435],"./ml-in/HostUxStrings.json":["o8/A",436],"./mr-in/HostUxStrings.json":["C1jq",437],"./ms-my/HostUxStrings.json":["OOWa",438],"./mt-mt/HostUxStrings.json":["f9+M",439],"./nb-no/HostUxStrings.json":["k0Vd",440],"./ne-np/HostUxStrings.json":["353G",441],"./nl-nl/HostUxStrings.json":["OI06",442],"./nn-no/HostUxStrings.json":["vjIZ",443],"./or-in/HostUxStrings.json":["Uq3Q",444],"./pa-in/HostUxStrings.json":["U6YD",446],"./pl-pl/HostUxStrings.json":["D76g",447],"./pt-br/HostUxStrings.json":["j5DP",448],"./pt-pt/HostUxStrings.json":["y5E1",449],"./quz-pe/HostUxStrings.json":["tmbB",450],"./ro-ro/HostUxStrings.json":["Al7C",451],"./ru-ru/HostUxStrings.json":["K6GF",452],"./sk-sk/HostUxStrings.json":["siDC",453],"./sl-si/HostUxStrings.json":["FKNP",454],"./sq-al/HostUxStrings.json":["SjxS",455],"./sr-cyrl-ba/HostUxStrings.json":["4/+h",457],"./sr-cyrl-rs/HostUxStrings.json":["LVIr",458],"./sr-latn-rs/HostUxStrings.json":["/fvh",459],"./sv-se/HostUxStrings.json":["6QFc",460],"./ta-in/HostUxStrings.json":["vupB",461],"./te-in/HostUxStrings.json":["kPP+",462],"./th-th/HostUxStrings.json":["3DNv",463],"./tr-tr/HostUxStrings.json":["K2jL",464],"./tt-ru/HostUxStrings.json":["0x8R",465],"./ug-cn/HostUxStrings.json":["7TTz",466],"./uk-ua/HostUxStrings.json":["PwB0",468],"./ur-pk/HostUxStrings.json":["QQdo",469],"./uz-uz/HostUxStrings.json":["Nkqs",470],"./vi-vn/HostUxStrings.json":["uKYG",471],"./zh-cn/HostUxStrings.json":["o3+W",472],"./zh-tw/HostUxStrings.json":["ba8N",473]};function o(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return n.e(t[1]).then((function(){return n.t(o,3)}))}o.keys=function(){return Object.keys(i)},o.id="/XTp",e.exports=o},"4Jcd":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("dFxn"),o=n("keVe"),r=function(){function e(e){this.config=e.parse("fluidConfig")||{fluidCatchUpFlyoutEnabled:!1,fluidMobileUpsellInstallButtonIOSUrl:null,fluidMobileUpsellInstallButtonAndroidUrl:null,fluidSelfHostSourcelessIframeEnabled:!1,fluidInformationProtectionEnabled:!1,fluidUnsupportedBrowser:null,microsoftEdgeIcon:null,googleChromeIcon:null,mozillaFirefoxIcon:null,safariIcon:null}}return e.prototype.resources=function(){return this.config},e.ɵprov=o.kc({factory:function(){return new e(o.lc(i.a))},token:e,providedIn:"root"}),e}()},"4Tvn":function(e,t,n){"use strict";n.r(t),n.d(t,"FluidContentModuleNgFactory",(function(){return xe}));var i=n("keVe"),o=n("ijCf"),r=n("PnKM"),s=n("Q3dK"),a=n("zvoD"),l=n("f0qX"),c=n("Jcv4"),u=n("BaAg"),d=n("Z0U4"),f=n("DQbD"),h=n("UYiR"),m=function(){function e(e,t,n,i){this.activatedRoute=e,this.tokenProvider=t,this.officeRouteService=n,this.fluidHostContext=i,this.action=void 0,this.itemId=void 0;var r=this.getRingFromAudience(this.fluidHostContext.audience);Object(o.a)({environment:r}),this.prefetchTokenForFluidDocument(),this.setupRouteChangeListener()}return Object.defineProperty(e.prototype,"renderFluidDocument",{get:function(){return this._renderFluidDocument},set,enumerable:!0,configurable:!0}),e.prototype.prefetchTokenForFluidDocument=function(){var e=new Array,t=this.activatedRoute.snapshot.queryParams.file;(null==t?void 0:t.length)>0&&e.push(t),Object(r.c)(this.tokenProvider,e)},e.prototype.setupRouteChangeListener=function(){var e=this,t={currentRoute:this.officeRouteService.getCurrentRoute()};this.officeRouteService.getRouteChangeEndObservable().pipe(Object(s.a)(t),Object(a.a)()),Object(l.a)()),Object(c.a)((function(t){return e.activatedRoute.queryParams.pipe(Object(s.a)({}),Object(a.a)()))}))).subscribe())},e.prototype.getRingFromAudience=function(e){switch(e){case"Automation":case"SyntheticTraffic":case"Local":return{audience:e,ring:"Prod"};default:return{audience:e}}},e}(),v=m,g=function(){return function(){}}(),p=n("zqZp"),S=n("QjXU"),b=n("GmnP"),I=n("EYcb"),P=n("n826"),y=n("5aVq"),j=n("BMb5"),C=n("PBJH"),w=n("lwM0"),F=function(){function e(e,t,n,o,r,s){var a=this;this.windowService=e,this.oneDriveGraphService=t,this.fluidInstrumentationService=n,this.errorDialogService=o,this.shellShimService=r,this.locService=s,this.isVersionHistorySession=!1,this.fileNameChanged=new i.q,this.disableInput=!1,this.dttComponent=null,this.renameFile=this.renameFile.bind(this),this.iframeClickListener=this.iframeClickListener.bind(this),this.setDTTRef=function(e){a.dttComponent=e}}return e.prototype.ngOnInit=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e,t,n=this;return Object(S.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return e=i.sent(),this.fileInfo.siteUrl?(this.driveUrl=this.fileInfo.siteUrl,this.fileInfo.siteUrl.match(u.c)?(this.driveTitle=this.fileInfo.createdBy,[4,this.canRenameFile()]):[3,3]):[3,4];case 2:return i.sent(),[3,4];case 3:this.oneDriveGraphService.getSiteTitle(this.fileInfo.siteId).then()).catch((function(e){n.fluidInstrumentationService.instrumentError("FluidFile_LocationInfo_Error","FluidFile_LocationInfo","Error when fetching site information. error: "+e.message)})),i.label=4;case 4:return e.DTT.SetProps(this.getProps()),this.fileInfo.folderUrl?(t=this.getPathFromUrl(this.fileInfo.folderUrl),this.folderName=t[t.length-1]):this.fluidInstrumentationService.instrumentError("FluidFile_LocationInfo_Error","FluidFile_LocationInfo","Error when fetching folder information."),[2]}}))}))},e.prototype.ngOnDestroy=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){return Object(S.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return e.sent().DTT.SetProps(null),[2]}}))}))},e.prototype.getCalloutProps=function(){var e=this;return function(){return{breadcrumbBrandName:e.driveTitle,breadcrumbBrandUrl:e.driveUrl,breadcrumbFolderName:e.folderName,breadcrumbFolderUrl:e.fileInfo.folderUrl,isVersionHistoryEnabled:e.isVersionHistoryEnabled,documentExtension:e.fileInfo.fileExtension}}},e.prototype.getProps=function(){var e=this;return{hideSaveStatus:!0,documentTitle:this.fileInfo.filename,readOnlyDocumentTitleInput:this.disableInput,versionHistoryButtonProps:{label:this.locService.DocumentTitleVersionHistory,onExecute:this.onVersionHistoryButtonClick},getCalloutAppProps:this.getCalloutProps(),onCalloutOpen:function(){return e.windowService.nativeWindow.addEventListener("blur",e.iframeClickListener)},onCalloutClose:function(){return e.windowService.nativeWindow.removeEventListener("blur",e.iframeClickListener)},onRename:this.renameFile,ref:this.setDTTRef}},e.prototype.getPathFromUrl=function(e){var t=w.a.decodeUrl(e);if(t){var n=t.split("://");if(n.length>1){var i=n[1].split("/");return i.pop(),i}}},e.prototype.renameFile=function(e){var t=this;this.isValidFileName(e)?this.oneDriveGraphService.renameFile(""+e+this.fileInfo.fileExtension,this.fileInfo.itemId,this.fileInfo.driveId).then((function(e){t.fileInfo.filename=u.a.fileNameWithoutExtension(e.name),t.fileNameChanged.emit(),t.shellShimService.getShellShim().then())})).catch((function(e){t.errorDialogService.showErrorDialog({category:"ServerSideError",error:"RenameFleFailed"}),t.fluidInstrumentationService.instrumentError("Document_Title_Rename_File_Error","Document_Title_Rename_File","DTT: Error when renaming a file. error: "+e.message)})):this.errorDialogService.showErrorDialog({category:"InvalidInput",error:"RenameFleFailed"})},e.prototype.iframeClickListener=function(){this.dttComponent&&this.dttComponent.closeCallout()},e.prototype.canRenameFile=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(S.__generator)(this,(function(i){switch(i.label){case 0:return this.isVersionHistorySession?(this.disableInput=!0,[2]):[4,this.oneDriveGraphService.getMyDriveRoot("network-first")];case 1:return e=i.sent(),-1!==(t=e.webUrl.lastIndexOf("/Documents"))&&(n=e.webUrl.substring(0,t),this.fileInfo.siteUrl!==n&&(this.disableInput=!0)),[2]}}))}))},e.prototype.isValidFileName=function(e){return!e.match(/["\*:<>\?\/\\\|]+/g)},e}(),D=n("qtH2"),U=n("CO6F"),x=n("mXGw"),_=n("3gnf"),H=n("bmzq"),k=n("w1PR"),O=function(e){function t(t,n,o,r,s,a){var l=e.call(this,t)||this;return l.themingService=n,l.windowService=o,l.oneDriveGraphService=r,l.fluidInstrumentationService=s,l.errorDialogService=a,l.fileNameChanged=new i.q,l.subscription=new _.a,l.disableInput=!1,l.dttComponent=null,l.headerColors={primary:"#2b579a",defaultBackground:"#2b579a",hoverBackground:"#124078",pressedBackground:"#002050",defaultText:"#A5B9D1"},l.documentIcons={chevronDown:{iconName:"ChevronDown",styles:{root:{fontSize:"8px"}}},chevronRight:{iconName:"ChevronRight",styles:{root:{fontSize:"8px"}}},folder:{iconName:"FabricFolder",styles:{root:{fontSize:"24px"}}}},l.headerStrings={location:"Location",documentName:"File Name",accessibilityMainFolder:"Main Folder",accessibilitySubFolder:"Sub Folder"},l.getCalloutProps,l.renameFile=l.renameFile.bind(l),l.iframeClickListener=l.iframeClickListener.bind(l),l.setDTTRef,l}return Object(S.__extends)(t,e),t.prototype.ngOnInit=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var t,n,o,r=this;return Object(S.__generator)(this,(function(s){switch(s.label){case 0:return(t=document.getElementById("documentTitle"))?(n=new i.o(t),this.target=n,Object(U.a)(void 0,{disableWarnings:!0}),this.subscription.add(this.themingService.themeShades.pipe(Object(l.a)((function(e){var t=e.theme.reactShellTheme;return{primary:t.Primary,defaultBackground:t.DefaultBackground,hoverBackground:t.HoverBackground,pressedBackground:t.PressedBackground,defaultText:t.DefaultText}}))).subscribe((function(e){r.headerColors=e,r.render()}))),this.fileInfo.siteUrl?(this.driveUrl=this.fileInfo.siteUrl,this.fileInfo.siteUrl.match(u.c)?(this.driveTitle=this.fileInfo.createdBy,[4,this.canRenameFile()]):[3,2]):[3,3]):(this.fluidInstrumentationService.instrumentError("Document_Title_Shell_Container_Not_Found","Document_Title_Shell_Container_Not_Found","Cannot render DTT as parent DOM element not found."),[2]);case 1:return s.sent(),[3,3];case 2:this.oneDriveGraphService.getSiteTitle(this.fileInfo.siteId).then()).catch((function(e){r.fluidInstrumentationService.instrumentError("FluidFile_LocationInfo_Error","FluidFile_LocationInfo","Error when fetching site information. error: "+e.message)})),s.label=3;case 3:return this.fileInfo.folderUrl?(o=this.getPathFromUrl(this.fileInfo.folderUrl),this.folderName=o[o.length-1]):this.fluidInstrumentationService.instrumentError("FluidFile_LocationInfo_Error","FluidFile_LocationInfo","Error when fetching folder information."),e.prototype.ngOnInit.call(this),[2]}}))}))},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t.prototype.getReactElement=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(S.__generator)(this,(function(t){return x?[2,x.createElement(D.a,{id:"documentTitleReact",hideSaveStatus:!0,colors:this.headerColors,strings:this.headerStrings,documentTitle:this.fileInfo.filename,readOnlyDocumentTitleInput:this.disableInput,icons:this.documentIcons,onCalloutOpen:function(){return e.windowService.nativeWindow.addEventListener("blur",e.iframeClickListener)},onCalloutClose,onRename:this.renameFile,ref:this.setDTTRef,getCalloutAppProps:this.getCalloutProps})]:[2,null]}))}))},t.prototype.getPathFromUrl=function(e){var t=w.a.decodeUrl(e);if(t){var n=t.split("://");if(n.length>1){var i=n[1].split("/");return i.pop(),i}}},t.prototype.renameFile=function(e){var t=this;this.isValidFileName(e)?this.oneDriveGraphService.renameFile(""+e+this.fileInfo.fileExtension,this.fileInfo.itemId,this.fileInfo.driveId).then((function(e){t.fileInfo.filename=u.a.fileNameWithoutExtension(e.name),t.fileNameChanged.emit(),t.render()})).catch((function(e){t.errorDialogService.showErrorDialog({category:"ServerSideError",error:"RenameFleFailed"}),t.fluidInstrumentationService.instrumentError("Document_Title_Rename_File_Error","Document_Title_Rename_File","DTT: Error when renaming a file. error: "+e.message)})):this.errorDialogService.showErrorDialog({category:"InvalidInput",error:"RenameFleFailed"})},t.prototype.iframeClickListener,t.prototype.canRenameFile=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(S.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.oneDriveGraphService.getMyDriveRoot("network-first")];case 1:return e=i.sent(),-1!==(t=e.webUrl.lastIndexOf("/Documents"))&&(n=e.webUrl.substring(0,t),this.fileInfo.siteUrl!==n&&(this.disableInput=!0)),[2]}}))}))},t.prototype.isValidFileName,t}(H.a),E=n("GNHe"),T=n("ZUnP"),L=n("rwSX"),R=n("4Jcd"),N=n("/I02"),B=n("9Hzm"),M=n("hZW2"),A=function(){function e(e){this.documentService=e,this.f6LoopMap=new Map([["O365_MainLink_NavMenu",this.shellHeaderHandler.bind(this)],["ohp-fluid-toolbar",this.fluidToolbarHandler.bind(this)],["left-nav-home",this.leftNavHandler.bind(this)],["feedbackContainer",this.feedbackContainerHandler.bind(this)],["owh-editing-canvas",this.fluidCanvasHandler.bind(this)]])}return e.prototype.enableFocusManager=function(){var e=this;this.f6LoopMap.forEach((function(t,n){var i;null===(i=e.documentService.nativeDocument.getElementById(n))||void 0===i||i.addEventListener("keydown",t)}))},e.prototype.disableFocusManager=function(){var e=this;this.f6LoopMap.forEach((function(t,n){var i;null===(i=e.documentService.nativeDocument.getElementById(n))||void 0===i||i.removeEventListener("keydown",t)}))},e.prototype.forceFocus=function(e){var t;null===(t=this.documentService.nativeDocument.getElementById(e))||void 0===t||t.focus()},e.prototype.getCommonHandler=function(e,t,n){var i,o;"F6"===e.key&&e.ctrlKey&&e.shiftKey?null===(i=this.documentService.nativeDocument.getElementById(t))||void 0===i||i.focus():"F6"===e.key&&e.ctrlKey&&(null===(o=this.documentService.nativeDocument.getElementById(n))||void 0===o||o.focus())},e.prototype.shellHeaderHandler=function(e){this.getCommonHandler(e,"owh-editing-canvas","ohp-fluid-toolbar")},e.prototype.leftNavHandler=function(e){this.getCommonHandler(e,"ohp-fluid-toolbar","feedbackContainer")},e.prototype.fluidToolbarHandler=function(e){this.getCommonHandler(e,"O365_MainLink_NavMenu","left-nav-home")},e.prototype.fluidCanvasHandler=function(e){this.getCommonHandler(e,"feedbackContainer","O365_MainLink_NavMenu")},e.prototype.feedbackContainerHandler,e.ɵprov=i.kc({factory:function(){return new e(i.lc(M.a))},token:e,providedIn:"root"}),e}(),V=function(e){function t(t,n,o,r,s,a,l){var c=e.call(this,t)||this;return c.tokenProvider=n,c.presenceColorProvider=o,c.fluidLoggerService=r,c.contextService=s,c.fluidFocusManager=a,c.fluidConfigService=l,c.share=new i.q,c.locale=Object(L.c)(c.contextService.sharedContext.officeMarket),c}return Object(S.__extends)(t,e),t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this)},t.prototype.ngOnDestro},t.prototype.ngAfterViewIni},t.prototype.getReactElement=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i,o,r=this;return Object(S.__generator)(this,(function(s){switch(s.label){case 0:return x?(e={themeDarker:"#792000",themeDark:"#A52C00",themeDarkAlt:"#C33400",themePrimary:"#D83B01",themeSecondary:"#DD4F1B",themeTertiary:"#E8825D",themeLight:"#F4BE88",themeLighter:"#F9DCD1",themeLightAlt:"#FEF6F4"},[4,this.fluidLoggerService.getLogger()]):[2,null];case 1:return t=s.sent(),n=function(){r.share.emit()},i=x.createRef(),o=new Promise((function(e,t){r.fileInfoDeferredPromise.then})}))})),[2,x.createElement(T.a,{appColors:e,container:this.container,presenceColorProvider:this.presenceColorProvider,logger:t,scrollingElementRef:i,tokenProvider:this.tokenProvider,fileInfoPromise:o,onShareButtonClick:n,localization:{locale:this.locale},hideFileLocation:!0,catchUpActivityFlyoutEnabled:this.fluidConfigService.config.fluidCatchUpFlyoutEnabled,showInformationProtection:this.fluidConfigService.config.fluidInformationProtectionEnabled,informationProtectionServicePromise:this.informationProtectionServiceDeferredPromise,settingsProvider:this.ecsSettingsProvider})]}}))}))},t}(H.a),z=n("RF0N"),q=n("A+1D"),G=n("Xbux"),W=n("g+v/"),K=function(e){function t(t,n,i,o){var r=e.call(this,t)||this;return r.contextService=n,r.windowService=i,r.fluidConfigService=o,r.messageActionHandler=function(e,t){"Reload"!==e&&"Upgrade"!==e||r.windowService.nativeWindow.location.reload()},r.locale=Object(L.c)(r.contextService.sharedContext.officeMarket),r}return Object(S.__extends)(t,e),t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this)},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t.prototype.getReactElement=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i;return Object(S.__generator)(this,(function(o){switch(o.label){case 0:return x?(e=[],this.fluidConfigService.config.fluidInformationProtectionEnabled&&this.informationProtectionServiceDeferredPromise&&this.resolvedUrlDeferredPromise?[4,Promise.all([this.informationProtectionServiceDeferredPromise,this.resolvedUrlDeferredPromise])]:[3,2]):[2,null];case 1:t=S.__read.apply(void 0,[o.sent(),2]),i=t[1],(n=t[0])&&i&&e.push(new W.a(n,i)),o.label=2;case 2:return e.push(new z.a(this.container,this.locale,this.messageActionHandler,this.hostLogger)),e.push(new q.a(this.component,this.locale,this.hostLogger)),[2,x.createElement(G.a,{locale:this.locale,bannerProviders:e,logger:this.hostLogger})]}}))}))},t}(H.a),Q=n("pkel"),X=n("1LNb"),Z=x.lazy})),J=function(e){function t(t,n,i,o){var r=e.call(this,t)||this;return r.feedbackService=n,r.officeRouteService=i,r.contextService=o,r.locale=Object(L.c)(r.contextService.sharedContext.officeMarket),r}return Object(S.__extends)(t,e),t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this)},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t.prototype.getReactElement=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e,t,n=this;return Object(S.__generator)(this,(function(i){return x?(e={themeDarker:"#792000",themeDark:"#A52C00",themeDarkAlt:"#C33400",themePrimary:"#D83B01",themeSecondary:"#DD4F1B",themeTertiary:"#E8825D",themeLight:"#F4BE88",themeLighter:"#F9DCD1",themeLightAlt:"#FEF6F4"},t=function(e,t){"Feedback"===e&&n.feedbackService.loadOCVFeedback(),"Close"!==e||t!==Q.a.fileNotFoundOrAccessDeniedError&&t!==Q.a.authorizationError||n.officeRouteService.back({route:"OfficeHome"})},[2,x.createElement(x.Suspense,{fallback:x.createElement(x.Fragment,null)},x.createElement(Z,{appColors:e,loadedInfoPromise:this.loadedInfoPromise,localization:{locale:this.locale},errorDialogActionHandlers:t,logger:this.hostLogger}))]):[2,null]}))}))},t}(H.a),Y=n("ccbu"),$=n("NBlT"),ee=n("hhzZ"),te=function(e}return Object(S.__extends)(t,e),t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this)},t.prototype.ngOnDestro},t.prototype.ngAfterViewIni},t.prototype.getReactElement=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e,t,n=this;return Object(S.__generator)(this,(function(i){return x&&Object(Y.b)()?(e=this.fluidConfigService.resources(),t=this.getAppStoreURL(e),[2,x.createElement($.a,{bodyText:this.locService.FluidMobileUpsell365BodyText,actionButtonText:this.locService.FluidMobileUpsellInstallButtonText,actionButtonOnClick:function(){n.fluidInstrumentationService.instrumentClickEvent("Fluid_MobileUpsell_Install_Click","mobile-upsell__action-button",ee.b.FluidContent),window.open(t,"_blank")}})]):[2,null]}))}))},t.prototype.getAppStoreURL=function(e){return Object(Y.a)()?e.fluidMobileUpsellInstallButtonIOSUrl:e.fluidMobileUpsellInstallButtonAndroidUrl},t}(H.a),ne=n("TOqr"),ie=n("/MeB"),oe=n("X+PR"),re=n("W5/U"),se=n("7Rc8"),ae=n("X0pd"),le=n("ICqK"),ce=n("4/We"),ue=n("y1jW"),de=i.Fb({encapsulation:2,styles:[],data:{}});function fe(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"shell-document-title",[],null,[[null,"fileNameChanged"]],(function(e,t,n){var i=!0;return"fileNameChanged"===t&&(i=!1!==e.component.onFileNameChanged()&&i),i}),null,null)),i.Gb(1,212992,null,0,F,[j.b,P.a,b.a,I.a,y.a,C.a],{fileInfo:[0,"fileInfo"],isVersionHistoryEnabled:[1,"isVersionHistoryEnabled"],isVersionHistorySession:[2,"isVersionHistorySession"],onVersionHistoryButtonClick:[3,"onVersionHistoryButtonClick"]},{fileNameChanged:"fileNameChanged"})]}),null)}function he(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-document-title",[],null,[[null,"fileNameChanged"]],(function(e,t,n){var i=!0;return"fileNameChanged"===t&&(i=!1!==e.component.onFileNameChanged()&&i),i}),null,null)),i.Gb(1,212992,null,0,O,[i.o,k.b,j.b,P.a,b.a,I.a],{fileInfo:[0,"fileInfo"]},{fileNameChanged:"fileNameChanged"})],(function(e,t){e(t,1,0,t.component.fileInfo)}),null)}function me(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,2,"ohp-fluid-toolbar",[["id","ohp-fluid-toolbar"],["tabindex","-1"]],null,[[null,"share"]]}),null,null)),i.bc(131584,null,E.a,E.a,[f.a]),i.Gb(3,4407296,null,0,V,[i.o,h.a,B.a,E.a,N.a,A,R.a],{container:[0,"container"],fileInfoDeferredPromise:[1,"fileInfoDeferredPromise"],informationProtectionServiceDeferredPromise:[2,"informationProtectionServiceDeferredPromise"],ecsSettingsProvider:[3,"ecsSettingsProvider"]},{share:"share"}),(e()(),i.Hb(4,0,null,null,1,"ohp-fluid-message-banner",[],null,null,null,null,null)),i.Gb(5,212992,null,0,K,[i.o,N.a,j.b,R.a],{container:[0,"container"],hostLogger:[1,"hostLogger"],informationProtectionServiceDeferredPromise:[2,"informationProtectionServiceDeferredPromise"],ecsSettingsProvider:[3,"ecsSettingsProvider"],resolvedUrlDeferredPromise:[4,"resolvedUrlDeferredPromise"],component:[5,"component"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.container,n.fileInfoDeferredPromise,n.informationProtectionServiceDeferredPromise,n.ecsSettingsProvider),e(t,5,0,n.container,n.hostLogger,n.informationProtectionServiceDeferredPromise,n.ecsSettingsProvider,n.resolvedUrlDeferredPromise,n.component)}),null)}function ve(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-fluid-error-dialog",[],null,null,null,null,null)),i.Gb(1,212992,null,0,J,[i.o,X.a,d.a,N.a],{loadedInfoPromise:[0,"loadedInfoPromise"],hostLogger:[1,"hostLogger"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.loadedInfoPromise,n.hostLogger)}),null)}function ge(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),i.Hb(1,0,null,null,1,"ohp-fluid-mobile-upsell",[["class","fluid-mobile-upsell"]],null,null,null,null,null)),i.Gb(2,4407296,null,0,te,[i.o,R.a,b.a,C.a],null,null)],(function(e,t){e(t,2,0)}),null)}function pe(e){return i.jc(0,[(e()(),i.qb(16777216,null,null,1,null,fe)),i.Gb(1,16384,null,0,ne.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,he)),i.Gb(3,16384,null,0,ne.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(4,0,null,null,9,"div",[["class","fluid-owh-container"],["id","owh-container"]],null,null,null,null,null)),(e()(),i.Hb(5,0,null,null,2,"div",[["class","fluid-toolbar-container"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,me)),i.Gb(7,16384,null,0,ne.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.qb(16777216,null,null,1,null,ve)),i.Gb(9,16384,null,0,ne.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null),(e()(),i.Hb(10,0,null,null,1,"div",[["class","fluid-editing-canvas-wrapper"]],null,null,null,null,null)),(e()(),i.Hb(11,0,null,null,0,"div",[["id","owh-editing-canvas"],["tabindex","0"]],null,null,null,null,null)),(e()(),i.qb(16777216,null,null,1,null,ge)),i.Gb(13,16384,null,0,ne.k,[i.W,i.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.fileInfo&&n.isShellDTTEnabled),e(t,3,0,n.fileInfo&&!n.isShellDTTEnabled),e(t,7,0,n.container&&n.component),e(t,9,0,n.loadedInfoPromise),e(t,13,0,n.container&&n.isMobile)}),null)}i.Db("ohp-fluid-content-owh-host",ae.a,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"ohp-fluid-content-owh-host",[],null,null,null,pe,de)),i.bc(131584,null,ie.a,ie.a,[P.a,oe.a,b.a]),i.bc(512,null,re.a,re.a,[se.a,ie.a]),i.bc(131584,null,E.a,E.a,[f.a]),i.Gb(4,770048,null,0,ae.a,[h.a,le.a,B.a,oe.a,ce.a,R.a,re.a,ie.a,I.a,d.a,ue.h,f.a,M.a,E.a,b.a,C.a,j.b],null,null)]}),null)}),{action:"action",itemId:"itemId"},{},[]);var Se=i.Fb({encapsulation:2,styles:[],data:{}});function be(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,4,"ohp-fluid-content-owh-host",[],null,null,null,pe,de)),i.bc(131584,null,ie.a,ie.a,[P.a,oe.a,b.a]),i.bc(512,null,re.a,re.a,[se.a,ie.a]),i.bc(131584,null,E.a,E.a,[f.a]),i.Gb(4,770048,null,0,ae.a,[h.a,le.a,B.a,oe.a,ce.a,R.a,re.a,ie.a,I.a,d.a,ue.h,f.a,M.a,E.a,b.a,C.a,j.b],{action:[0,"action"],itemId:[1,"itemId"]},null)]}),null}var Pe=i.Db("ohp-fluid-content-container",m,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-fluid-content-container",[],null,null,null,Ie,Se)),i.Gb(1,49152,null,0,m,[oe.a,h.a,d.a,f.a],null,null)],null,null)}),{renderFluidDocument:"renderFluidDocument"},{},[]),ye=n("+P5Z"),je=n("xIlw"),Ce=n("+a0u"),we=n("lQwO"),F}(),De=n("8rwQ"),Ue=n("CCRL"),xe=i.Eb(g,[],(function(e){return i.Tb([i.Ub(512,i.k,i.hb,[[8,[p.a,Pe]],[3,i.k],i.D]),i.Ub(4608,ne.m,ne.l,[i.z]),i.Ub(1073742336,ne.c,ne.c,[]),i.Ub(1073742336,ye.a,ye.a,[]),i.Ub(1073742336,je.a,je.a,[]),i.Ub(1073742336,Ce.a,Ce.a,[]),i.Ub(1073742336,we.a,we.a,[]),i.Ub(1073742336,Fe,Fe,[]),i.Ub(1073742336,De.a,De.a,[]),i.Ub(1073742336,g,g,[]),i.Ub(256,Ue.a,v,[])])}))},"9Hzm":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("keVe"),o=function(){function e(){this.colorPalette=["#C239B3","#CA5010","#E3008C","#A4262C","#498205","#69797E","#881798","#D13438","#0078D4","#038387","#750B1C","#986F0B","#4F6BED","#8764B8","#0B6A0B","#7A7574","#5C2E91","#005B70","#8E562E"],this.nextColorToAssignIndex=0,this.assignedColors=new Map}return Object.defineProperty(e.prototype,"PresenceColorProvider",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.getPresenceColorForUser=function(e){var t=this.assignedColors.get(e);if(t)return t;var n=this.colorPalette[this.nextColorToAssignIndex];return this.nextColorToAssignIndex=(this.nextColorToAssignIndex+1)%this.colorPalette.length,this.assignedColors.set(e,n),n},e.ɵprov=i.kc({factoe},token:e,providedIn:"root"}),e}()},DKWK:function(e,t,n){var i={"./af-za/InformationProtectionStrings.json":["V8va",476],"./am-et/InformationProtectionStrings.json":["wxsJ",477],"./ar-sa/InformationProtectionStrings.json":["/Av0",488],"./as-in/InformationProtectionStrings.json":["Mxfu",499],"./az-latn-az/InformationProtectionStrings.json":["czsS",510],"./bg-bg/InformationProtectionStrings.json":["1+Nk",521],"./bn-in/InformationProtectionStrings.json":["3d/0",532],"./bs-latn-ba/InformationProtectionStrings.json":["Fxrq",543],"./ca-es-valencia/InformationProtectionStrings.json":["pzUV",561],"./ca-es/InformationProtectionStrings.json":["O6+5",554],"./cs-cz/InformationProtectionStrings.json":["30ra",478],"./cy-gb/InformationProtectionStrings.json":["20aW",479],"./da-dk/InformationProtectionStrings.json":["fqk9",480],"./de-de/InformationProtectionStrings.json":["3xBy",481],"./el-gr/InformationProtectionStrings.json":["ilUf",482],"./en-gb/InformationProtectionStrings.json":["Ap8z",483],"./en-us/InformationProtectionStrings.json":["pIfM",484],"./es-es/InformationProtectionStrings.json":["fRAB",485],"./es-mx/InformationProtectionStrings.json":["D5h7",486],"./et-ee/InformationProtectionStrings.json":["rJ0w",487],"./eu-es/InformationProtectionStrings.json":["eXOV",489],"./fa-ir/InformationProtectionStrings.json":["jQ4d",490],"./fi-fi/InformationProtectionStrings.json":["qc6l",491],"./fil-ph/InformationProtectionStrings.json":["Xeu1",492],"./fr-ca/InformationProtectionStrings.json":["9kjR",493],"./fr-fr/InformationProtectionStrings.json":["3Zq1",494],"./ga-ie/InformationProtectionStrings.json":["Yae5",495],"./gd-gb/InformationProtectionStrings.json":["z077",496],"./gl-es/InformationProtectionStrings.json":["xSIw",497],"./gu-in/InformationProtectionStrings.json":["DGAR",498],"./he-il/InformationProtectionStrings.json":["5qEm",500],"./hi-in/InformationProtectionStrings.json":["D+s6",501],"./hr-hr/InformationProtectionStrings.json":["phkE",502],"./hu-hu/InformationProtectionStrings.json":["epKx",503],"./hy-am/InformationProtectionStrings.json":["WDlr",504],"./id-id/InformationProtectionStrings.json":["iWCl",505],"./is-is/InformationProtectionStrings.json":["L7qw",506],"./it-it/InformationProtectionStrings.json":["h+0S",507],"./ja-jp/InformationProtectionStrings.json":["Ot1g",508],"./ka-ge/InformationProtectionStrings.json":["0kiq",509],"./kk-kz/InformationProtectionStrings.json":["Ea3Z",511],"./km-kh/InformationProtectionStrings.json":["Tv0o",512],"./kn-in/InformationProtectionStrings.json":["5pWL",513],"./ko-kr/InformationProtectionStrings.json":["ikE1",514],"./kok-in/InformationProtectionStrings.json":["9zmC",515],"./lb-lu/InformationProtectionStrings.json":["6mQz",516],"./lo-la/InformationProtectionStrings.json":["bMXg",517],"./lt-lt/InformationProtectionStrings.json":["Pi7C",518],"./lv-lv/InformationProtectionStrings.json":["c8+B",519],"./mi-nz/InformationProtectionStrings.json":["VHN0",520],"./mk-mk/InformationProtectionStrings.json":["iaAK",522],"./ml-in/InformationProtectionStrings.json":["4RNE",523],"./mr-in/InformationProtectionStrings.json":["88Z2",524],"./ms-my/InformationProtectionStrings.json":["0aWg",525],"./mt-mt/InformationProtectionStrings.json":["+aLR",526],"./nb-no/InformationProtectionStrings.json":["F8+j",527],"./ne-np/InformationProtectionStrings.json":["Q7PB",528],"./nl-nl/InformationProtectionStrings.json":["yhDg",529],"./nn-no/InformationProtectionStrings.json":["j/hm",530],"./or-in/InformationProtectionStrings.json":["sp5b",531],"./pa-in/InformationProtectionStrings.json":["Txht",533],"./pl-pl/InformationProtectionStrings.json":["JisA",534],"./pt-br/InformationProtectionStrings.json":["ogcT",535],"./pt-pt/InformationProtectionStrings.json":["u2PL",536],"./quz-pe/InformationProtectionStrings.json":["H+kZ",537],"./ro-ro/InformationProtectionStrings.json":["rQgS",538],"./ru-ru/InformationProtectionStrings.json":["Gj3Z",539],"./sk-sk/InformationProtectionStrings.json":["s/mL",540],"./sl-si/InformationProtectionStrings.json":["frKa",541],"./sq-al/InformationProtectionStrings.json":["KbH2",542],"./sr-cyrl-ba/InformationProtectionStrings.json":["hfxS",544],"./sr-cyrl-rs/InformationProtectionStrings.json":["l4Ib",545],"./sr-latn-rs/InformationProtectionStrings.json":["0tkZ",546],"./sv-se/InformationProtectionStrings.json":["hsSc",547],"./ta-in/InformationProtectionStrings.json":["/V0Y",548],"./te-in/InformationProtectionStrings.json":["W0D9",549],"./th-th/InformationProtectionStrings.json":["UVG4",550],"./tr-tr/InformationProtectionStrings.json":["3AkG",551],"./tt-ru/InformationProtectionStrings.json":["jtIN",552],"./ug-cn/InformationProtectionStrings.json":["dg4Q",553],"./uk-ua/InformationProtectionStrings.json":["hiuS",555],"./ur-pk/InformationProtectionStrings.json":["GIWk",556],"./uz-uz/InformationProtectionStrings.json":["EQeW",557],"./vi-vn/InformationProtectionStrings.json":["klvU",558],"./zh-cn/InformationProtectionStrings.json":["5o9B",559],"./zh-tw/InformationProtectionStrings.json":["5Z98",560)}o.ke)},o.id="DKWK",e.exports=o},GNHe:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("QjXU"),o=n("t2cV"),r=n("+1lv"),s=(n("DQbD"),function(){function e(e){this.fluidHostContext=e}return e.prototype.getLogger=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return this.logger?[2,this.logger]:[3,1];case 1:return[4,r.a];case 2:return e=n.sent(),this.logger=new o.a({hostContextProps:this.fluidHostContext,hostTelemetrySink:e}),this.logger.loadFull(),window.addEventListener("unload)})),[2,this.logger]}}))}))},e.prototype.resetFluidLogger=function(){this.logger&&(this.logger=void 0)},e.prototype.ngOnDestr)},e}())},ICqK:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("lwM0"),o=n("pjz5"),r=n("keVe"),s=n("X+PR"),a=functione}return Object.defineProperty(e.prototype,"UrlProvider",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.getFileId=function(){return this.activatedRoute.snapshot.queryParams.item},e.prototype.getSiteUrl=function(){return o.a.getOrigin(i.a.decodeUrl(this.activatedRoute.snapshot.queryParams.file))},e.prototype.getDrivee},e.prototype.getComponentU"},e.prototype.getTelemetryQueryParam=function(){var e=this.activatedRoute.snapshot.queryParams.t,t=null;if(e){var n=atob(i.a.decodeUrl(e));t=JSON.parse(n)}return t},e.ɵprov=r.kc({fact))},token:e,providedIn:"root"}),e}()},R))},UYiR:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("QjXU"),o=n("BaAg"),r=n("p6Zr"),s=n("kpuN"),a=n("4/We"),l=n("GmnP"),c=n("keVe"),u=function,o}return Object(i.__extends)(t,e),t}(Error),d=functio=n}return Object.defineProperty(e.prototype,"TokenProvider",{is},enumerable:!0,configurable:!0}),e.prototype.getToken=function(e){var t,n,s;return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,l,c,d,f,h,m,v,g,p;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return l=this.getResourceUrl(e),this.fluidInstrumentationService.instrumentStart("Fluid_TokenFetch"),d=this.capabilitiesService.capabilities.fluidCapPopupEnabled,f={category:"ContentPage",fileType:o.b.Fluid},h="None",l?(c=o.a.referralFromFileLocation(l))!==r.a.OneDrive?[3,2]:[4,this.accessTokenService.getAccessToken(h="OneDrive",void 0,l,d,f)]:[3,17];case 1:return a=i.sent(),[3,16];case 2:return c!==r.a.SharePoint?[3,4]:[4,this.accessTokenService.getAccessToken(h="SharePoint",void 0,l,d,f)];case 3:return a=i.sent(),[3,16];case 4:return l.toLocaleLowerCase().indexOf("pushchannel.1drv.ms")>0?[4,this.accessTokenService.getAccessToken(h="FluidPushChannel",void 0,null,!1,f)]:[3,6];case 5:return a=i.sent(),[3,16];case 6:return l.toLocaleLowerCase().indexOf("graph.microsoft.com")>0?[4,this.accessTokenService.getAccessToken(h="Graph",void 0,null,d,f)]:[3,8];case 7:return a=i.sent(),[3,16];case 8:return l.toLocaleLowerCase().indexOf("augloop.office.com")>0?[4,this.accessTokenService.getAccessToken(h="AugLoop")]:[3,10];case 9:return a=i.sent(),[3,16];case 10:return l.toLocaleLowerCase().indexOf("www.office.com")>0||l.toLocaleLowerCase().indexOf("www.microsoft365.com")>0||l.toLocaleLowerCase().indexOf("m365.go.microsoft")>0||l.toLocaleLowerCase().indexOf("m365.cloud.microsoft")>0?[4,this.accessTokenService.getAccessToken(h="OfficeHome")]:[3,12];case 11:return a=i.sent(),[3,16];case 12:return l.toLocaleLowerCase().indexOf("substrate.office.com")>0?[4,this.accessTokenService.getAccessToken(h="Substrate",void 0,l,d,f)]:[3,14];case 13:return a=i.sent(),[3,16];case 14:return[4,this.accessTokenService.getAccessToken(h="SharePoint",void 0,l,d,f)];case 15:a=i.sent(),i.label=16;case 16:return[3,18];case 17:throw new u("Unknown token type","unsupported_token_resource",!1);case 18:if(a&&a.success)return p=void 0,a.expiryMs&&(p="expiry: "+a.expiryMs.toString()),this.fluidInstrumentationService.instrumentSuccess("Fluid_TokenFetch",void 0,p,h),[2,{token:a.token}];throw this.fluidInstrumentationService.instrumentFailure("Fluid_TokenFetch",{statusCode:null==(m=a.error)?void 0:m.statusCode,shouldSwallow:null==m?void 0:m.shouldSwallow,errorMessage:a.error?a.error.message:"Failed to fetch token"},void 0,h),v=null===(t=a.error)||void 0===t?void 0:t.statusCode,g=v>=500&&v<600||0===v||707===v||706===v,new u("Failed to acquire auth token for "+h,(null===(s=null===(n=a.error)||void 0===n?void 0:n.statusCode)||void 0===s?void 0:s.toString())||"undefined",g)}}))}))},e.prototype.getResourceUrl=function(e){var t,n;if(0!==e.length){var o=e[0].lastIndexOf("/"),r=o>-1?e[0].substring(0,o):"";try{for(var s=Object(i.__values)(e),a=s.next();!a.done;a=s.next()){var l=a.value;if(((o=l.lastIndexOf("/"))>-1?l.substring(0,o):"")!==r)return}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return""!==r?r:"https://graph.microsoft.com"}},e.ɵprov=c.kc({faca))},token:e,providedIn:"root"}),e}()},"W5/U":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),o=(n("7Rc8"),n("/MeB"),functir=t}return e.prototype.writeMruDocument=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.fluidFileContextProvider.getMruDataItem()];case 1:return e=t.sent(),this.mruDataService.writeMruDocument(e),[3,3];case 2:throw t.sent();case 3:return[2]}}))}))},e}())},X0pd:function(e,t,n){"use strict";(function(e){n.d(t,n E}));var i=n("QjXU"),o=n("ZaV9"),r=n("OhPl"),s=n("I357"),a=n("hKA3"),l=n("bi4m"),c=n("OS4L"),u=n("imCK"),d=n("7XjJ"),f=n("iKmF"),h=n("/tNJ"),m=n("lj3n"),v=n("kAir"),g=n("G3DH"),p=n("xg6W"),S=n("ccbu"),b=n("rwSX"),I=n("dP86"),P=n("ms7G"),y=n("hmeN"),j=n("oNyl"),C=n("Filu"),w=n("Ycsc"),F=n("IKyt"),D=n("fmN9"),U=n("lk48"),x=n("R7dW"),_=n("OPwp"),H=n("hhzZ"),k=(n("hZW2"),n("EYcb"),n("4Jcd"),n("Z0U4"),n("BMb5"),n("4/We"),n("PBJH"),n("ZfMd")),O=n("lwM0"),E=(n("/MeB"),n("DQbD"),n("GNHe"),n("W5/U"),n("9Hzm"),n("UYiR"),n("ICqK"),n("GmnP"),n("9X5B"),function(){function t(e,t,n,i,o,r,s,a,l,c,u,d,f,h,m,v,g){this.tokenProvider=e,this.urlProvider=t,this.presenceColorProvider=n,this.activatedRoute=i,this.capabilitiesService=o,this.fluidConfigService=r,this.mruItemService=s,this.fluidFileContextProvider=a,this.errorDialogService=l,this.officeRouteService=c,this.titleService=u,this.fluidHostContext=d,this.documentService=f,this.fluidLoggerService=h,this.fluidInstrumentationService=m,this.locService=v,this.windowService=g,this.shareMode=_.a.Share,this.fileInfo=void 0,this.fileInfoDeferredPromise=new p.a,this.isShellDTTEnabled=!1,this.isVersionHistoryEnabled=!1,this.informationProtectionServiceDeferredPromise=new p.a,this.resolvedUrlDeferredPromise=new p.a,this.isMobile=Object(S.b)(),this.isRedirectTelemetryData=!1,this.shareServiceDeferredPromise=new p.a}return t.prototype.ngOnInit=function(){this.isShellDTTEnabled=this.capabilitiesService.capabilities.shellDocumentTitleEnabledInFluid,this.fileVersion=this.activatedRoute.snapshot.queryParams.v?O.a.decodeUrl(this.activatedRoute.snapshot.queryParams.v):void 0,this.isVersionHistorySession=void 0!==this.fileVersion,this.isVersionHistoryEnabled=this.capabilitiesService.capabilities.fluidVersionHistoryEnabled&&void 0===this.fileVersion,this.loadPage()},t.prototype.ngOnChanges=function(e){var t,n,i;if(e.hasOwnProperty("action")||e.hasOwnProperty("itemId")||e.hasOwnProperty("v")){var o=(null===(t=e.action)||void 0===t?void 0:t.currentValue)===x.a.EditNew&&!e.action.firstChange,r=void 0!==(null===(n=e.itemId)||void 0===n?void 0:n.previousValue)&&this.itemId&&!e.itemId.firstChange,s=this.isVersionHistoryEnabled&&void 0!==(null===(i=e.v)||void 0===i?void 0:i.previousValue)&&!e.itemId.firstChange;(o||r||s)&&(this.unloadPage(!o),this.getEditingCanvasDiv().innerHTML="",this.loadPage())}},t.prototype.onShareClick=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(t){try{this.fluidInstrumentationService.instrumentStart("Fluid_ShareControl_Start"),this.shareServiceDeferredPromise.t"})}))}catch(e){this.errorDialogService.showErrorDialog({category:"ContentPage",error:"Generic"}),this.fluidInstrumentationService.instrumentError("Fluid_ShareControl_Error","Fluid_ShareControl",e.message)}return[2]}))}))},t.prototype.onFileNameChanged=function(){var e=this;this.fluidFileContextProvider.fetchDriveItem(!0),this.fluidFileContextProvider.getMruFileItem().tle)})),this.writeToMruService()},t.prototype.ngOnDes!0)},t.prototype.loadPage=function(){var t,n;return Object(i.__awaiter)(this,void 0,void 0,(function(){var s,l,f,v,I,F,D,U,_,H,E,T,L,R,N,B,M,A,V,z,q,G,W,K=this;return Object(i.__generator)(this,(function(Q){switch(Q.label){case 0:return this.fluidInstrumentationService.setCorrelationId(this.fluidHostContext.hostCorrelationId),this.fluidInstrumentationService.logPerformanceEventFromClick(this.fluidHostContext.getBootId(),"FluidContent_Document_Load_Page"),setTimeout((function(){void 0===K.container&&K.fluidInstrumentationService.instrumentError("FluidContent_Timeout","FluidContent_Timeout","FluidContent_Timeout: Page did not load after 30 seconds.")}),3e4),s=this.activatedRoute.snapshot.queryParams,l=this.urlProvider.getDriveId(),v=Object(P.c)(),I=void 0,this.siteUrl=O.a.decodeUrl(this.activatedRoute.snapshot.queryParams.siteUrl),F=new p.a,D=this.getEditingCanvasDiv(),this.parseRedirectTelemetryData(),this.fluidHostContext.hostScenarioName||this.updateFluidHostScenarioName(),U=this,[4,this.fluidLoggerService.getLogger()];case 1:return U.hostLogger=Q.sent(),_=y.a.startScenario(this.hostLogger,this.action===x.a.EditNew?"Create":"Load"),H=new j.a(this.hostLogger),E={iframeTitle:this.locService.FluidCanvasIFrameTitle,useServiceDeliveredDriver:this.capabilitiesService.capabilities.fluidUseServiceDeliveredDriver,onDise()},sourcelessIframeBundleUrl:this.fluidConfigService.config.fluidSelfHostSourcelessIframeEnabled&&Object(k.a)("sourceless-iframe/index.servicedelivereddriver.95258b895587686acf50.js")},this.ecsSettingsProvider=new g.a({ecsFilters:{userContext:this.fluidHostContext.userContext,audience:this.fluidHostContext.audience},hostName:"Office.com"},this.hostLogger),this.fluidConfigService.config.fluidInformationProtectionEnabled&&this.informationProtectionServiceDeferredPromise.resolve(this.capabilitiesService.capabilities.fluidMockMipEnabled?new Prom())})):Object(u.a)({tokenProvider:this.tokenProvider,logger:this.hostLogger,locale:Object(b.c)(this.fluidHostContext.hostLocaleContext.uiLanguage),settingsProvider:this.ecsSettingsProvider})),(T=new a.a).register("HostContext",this.fluidHostContext),T.register("TokenProvider",this.tokenProvider),T.register("NotificationService",F),T.register("ShareService",this.shareServiceDeferredPromise),T.register("PresenceColorProvider",this.presenceColorProvider),T.register("SettingsProvider",this.ecsSettingsProvider),T.register("StylingProvider",this.getStylingProvider()),T.register("InformationProtectionService",this.fluidConfigService.config.fluidInformationProtectionEnabled?this.informationProtectionServiceDeferredPromise:void 0),T.register("NamespaceLogger",this.hostLogger),L={logger:this.hostLogger,environment:this.getRingFromAudience(this.fluidHostContext.audience),persistentCacheConfig:{enabled:!0,maxCacheItemAge:2592e5,partitionKey:null===(t=this.fluidHostContext.userContext.user)||void 0===t?void 0:t.id}},this.action===x.a.EditNew?((R=s.abpId)&&(N={configurationType:"templateConfiguration",loadTemplateData:{configurationId:R}},v=Object(P.c)(N)),I=Promise.resolve({siteUrl:this.siteUrl,driveId:l,filename:"Untitled.fluid",filePath:""}),this.loadInSourcelessIframeResult=Object(C.a)({iframeHostingElement:D,hostContext:this.fluidHostContext,config:L,options:E,dependencySynthesizer:T,codeDetails:v})):(B=this.urlProvider.getFileId(),M=O.a.decodeUrl(this.activatedRoute.snapshot.queryParams.file),this.siteUrl||(this.siteUrl=M),A="/",(V=O.a.decodeUrl(s.containerPath))&&(z=e.from(V,"base64").toString())&&(A=z),this.fluidConfigService.config.fluidInformationProtectionEnabled&&Object(d.a)(this.informationProtectionServiceDeferredPromise,this.siteUrl,l,B),q=new URL(M),Object(o.d)(q,{siteUrl:this.siteUrl,driveId:l,itemId:B,dataStorePath:A,fileVersion:this.fileVersion}),f={url:q.href,headers:this.fluidConfigService.config.fluidInformationProtectionEnabled?{"X-CLP-Compliant-App":!0}:void 0},G={tokenProvider:this.tokenProvider,fileId:B,driveId:l,siteUrl:this.siteUrl,correlationId:this.fluidHostContext.hostCorrelationId},F.resolve(Object(h.a)(G)),this.shareServiceDeferredPromise.resolve(Object(m.a)({tokenProvider:this.tokenProvider,logger:this.hostLogger,appName:"Office.com",bootDocumentInfo:{itemId:B,driveId:l,siteUrl:this.siteUrl},localization:{locale:Object(b.c)(this.fluidHostContext.hostLocaleContext.uiLanguage)},tenantId:null===(n=this.fluidHostContext.userContext.user)||void 0===n?void 0:n.tenantId})),this.fluidInstrumentationService.logPerformanceEventFromClick(this.fluidHostContext.getBootId(),"FluidContent_Document_Load_Component"),W=Object(r.a)(q),this.loadInSourcelessIframeResult=Object(w.a)({containerRequest:f,iframeHostingElement:D,hostContext:this.fluidHostContext,config:L,options:E,preCheckInfo:W,dependencySynthesizer:T})),this.loadedInfoPromise=this.loadInSourcelessIframeResult.loadedInfo,null==H||H.registerSessionEndingErrorObserver(this.loadedInfoPromise),this.loadedInfoPromise.then((function(e){Promise.all([e.component,e.container]).then((function(e){var t=Object(i.__read)(e,2),n=t[0],o=t[1];return Object(i.__awaiter)(K,void 0,void 0,(function(){var e,t,r,s,a,l,c=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.component=n,this.container=o,I&&this.attachNewFileToContainer(I,F,_),[4,null===(a=this.component.ComponentCanvasProvider)||void 0===a?void 0:a.getCanvasComponent()];case 1:return e=i.sent()||this.component,(t=this.loadInSourcelessIframeResult.getRenderHostingElement()).style.display="none",[4,Promise.all([this.configureInformationProtection(t),this.renderAndTrackComponent(e,t)])];case 2:return i.sent(),t.style.display="block",(r=null!==(l=null==e?void 0:e.ComponentFocusable)&&void 0!==l?l:n.ComponentFocusable)&&r.giveFocus(),(null==r?void 0:r.setHostComponentFocusable)&&r.setHostComponentFocusable(this.getHostComponentFocusable()),this.setHostKeyboardShortcuts(e),this.container.on("closed",(function(e){e&&c.fluidInstrumentationService.instrumentError("FluidContent_Error","FluidContent",JSON.stringify(e))})),Object(S.b)()&&window.setTime!0)}),0),(s=this.urlProvider.getFileId())&&(this.fluidInstrumentationService.logPerformanceEventFromClick(this.fluidHostContext.getBootId(),"FluidContent_Document_Load_End"),this.fluidInstrumentationService.instrumentSuccess("FluidContent_Open",void 0!==this.fileVersion),_.setSuccess(),this.finishPostBootTasks(s,!1)),[2]}}))}))}),(function(e){K.fluidInstrumentationService.instrumentFailure("FluidContent_Open",e,void 0!==K.fileVersion);var t=e?JSON.stringify(e):"No error object: Opening file failed.";_.setFailure(t)}))}),(function(e){K.fluidInstrumentationService.instrumentBootError(K.fluidHostContext.hostScenarioLifecycle,e);var t=e?JSON.stringify(e):"No error object: Boot failed.";_.setFailure(t)})),[2]}}))}))},t.prototype.updateFluidHostScenarioName=function(){var e,t;if(this.action===x.a.EditNew){var n=this.activatedRoute.snapshot.queryParams.abpId;this.fluidHostContext.hostScenarioLifecycle="Create",this.fluidHostContext.hostScenarioName=n?"BlueprintCanvas":"Canvas"}else this.fluidHostContext.hostScenarioLifecycle="Load",this.fluidHostContext.hostScenarioName="Canvas";this.fluidHostContext.hostScenarioEntryPoint="DirectNav",this.fluidHostContext.hostScenarioStartTime=null===(t=null===(e=null===window||void 0===window?void 0:window.performance)||void 0===e?void 0:e.timing)||void 0===t?void 0:t.navigationStart},t.prototype.getComponentView=function(e){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.componentHTMLView?[2,this.componentHTMLView]:(n=this,[4,null===(t=e.HTMLViewable)||void 0===t?void 0:t.getView()]);case 1:return n.componentHTMLView=i.sent(),[2,this.componentHTMLView]}}))}))},t.prototype.renderAndTrackComponent=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,o,r,s,a,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:n=new F.a(this.hostLogger,{}),o=y.a.startActivity(this.hostLogger,D.a.RenderComponent),r=Object(I.b)(),i.label=1;case 1:return i.trys.push([1,6,,7]),[4,this.getComponentView(e)];case 2:return(s=i.sent())&&t?[4,s.HTMLView.render(t)]:[3,4];case 3:return i.sent(),l=Object(I.a)(r,!0),n.setSuccess({documentHidden:l>-1}),o.setSuccess(),[3,5];case 4:throw new Error("Requested component loaded but did not provide a renderer or hosting element");case 5:return[3,7];case 6:return a=i.sent(),l=Object(I.a)(r,!0),n.setFailureWithAdditionalProps(a,{documentHidden:l>-1}),o.setFailure(a),[3,7];case 7:return[2]}}))}))},t.prototype.configureInformationProtection=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return this.fluidConfigService.config.fluidInformationProtectionEnabled?this.container.resolvedUrl?[4,this.tryEnforceInformationProtection(this.informationProtectionServiceDeferredPromise,this.container,this.fluidHostContext,this.hostLogger,e)]:[3,2]:[2];case 1:return n.sent(),[3,3];case 2:this.container.once("connected",(function(){t.tryEnforceInformationProtection(t.informationProtectionServiceDeferredPromise,t.container,t.fluidHostContext,t.hostLogger,e)})),n.label=3;case 3:return[2]}}))}))},t.prototype.tryEnforceInformationProtection=function(e,t,n,o,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){var s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e&&t&&t.resolvedUrl&&r))return[3,5];s=n.HostContext.userContext.user.id,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(f.a)(t,t.resolvedUrl,r,e,s||null,o)];case 2:return i.sent(),[3,4];case 3:return i.sent(),this.fluidInstrumentationService.instrumentError("Fluid_InformationProtection_Error","Fluid_InformationProtection","Fail to enforce information protection"),[3,4];case 4:return[3,6];case 5:this.fluidInstrumentationService.instrumentError("Fluid_InformationProtection_Error","Fluid_InformationProtection","Fail to enforce information protection "+JSON.stringify({informationProtectionService:!!e,container:!!t,resolvedUrl:t.resolvedUrl,hostElement:!!r})),i.label=6;case 6:return[2]}}))}))},t.prototype.attachNewFileToContainer=function(e,t,n){var r;return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,l,c,u,d,f,v,g,p,S,I,P,j=this;return Object(i.__generator)(this,(function(C){switch(C.label){case 0:return[4,e];case 1:a=C.sent(),l=a.siteUrl,c=a.driveId,u=a.filePath,d=a.filename,f=Object(s.a)(l,c,u,d),v=new U.a(this.hostLogger),C.label=2;case 2:return C.trys.push([2,5,,6]),[4,y.a.startActivity(this.hostLogger,D.a.AttachContainer,(function(){return Object(i.__awaiter)(j,void 0,voi}))}))}))];case 3:return C.sent(),[4,y.a.startActivity(this.hostLogger,D.a.GetFileLink,(function(){return Object(i.__awaiter)(j,void 0,void 0,(function(){return Object(i.__generator)(t")]}))}))}))];case 4:if(!(g=C.sent()))throw new Error("container.getAbsoluteUrl returned undefined");return v.setSuccess(),this.fluidInstrumentationService.instrumentSuccess("FluidContent_CreateNew"),p=Object(o.b)(new URL(g)),I={tokenProvider:this.tokenProvider,fileId:S=p.itemId,driveId:c,siteUrl:l,correlationId:this.fluidHostContext.hostCorrelationId},t.resolve(Object(h.a)(I)),this.shareServiceDeferredPromise.resolve(Object(m.a)({tokenProvider:this.tokenProvider,logger:this.hostLogger,appName:"Office.com",bootDocumentInfo:{itemId:S,driveId:c,siteUrl:this.siteUrl},localization:{locale:Object(b.c)(this.fluidHostContext.hostLocaleContext.uiLanguage)},tenantId:null===(r=this.fluidHostContext.userContext.user)||void 0===r?void 0:r.tenantId})),this.finishPostBootTasks(S,!0),[3,6];case 5:return P=C.sent(),v.setFailure(P),n.setFailure(P),this.fluidInstrumentationService.instrumentFailure("FluidContent_CreateNew",P),[3,6];case 6:return[2]}}))}))},t.prototype.unloadPage=function(e){var t,n;null===(t=this.fluidHostContext)||void 0===t||t.resetFluidHostContext(e),this.fluidLoggerService.resetFluidLogger(),null===(n=this.componentHTMLView)||void 0===n||n.HTMLView.dispose(),this.container&&this.container.close(),this.component=void 0,this.container=void 0,this.loadedInfoPromise=void 0,this.fileInfo=void 0,this.isRedirectTelemetryData=!1,this.componentHTMLView=void 0},t.prototype.finishPostBootTasks=function(e,t){var n=this;void 0===t&&(t=!1),this.fluidFileContextProvider.setFluidFileItem(e),this.container&&this.container.resolvedUrl&&this.resolvedUrlDeferredPromise.resolve(this.container.resolvedUrl),-1===navigator.userAgent.indexOf("Mobile")&&this.fluidFileContextProvider.getFileInfo().then((function(e){n.fileVersion?n.fluidFileContextProvider.getListingVersions(e.driveId,e.itemId).then((function(t){var i=n.getDateTimeFromVersionList(t);i&&(e.filename+=" - "+i+" ("+n.locService.ReadOnlyState+")"),n.setUpDocumentTitle(e)})).ca,e)})):n.setUpDocumentTitle(e)})).catch((function(e){n.fluidInstrumentationService.instrumentError("Fluid_FileInfo_Error","Fluid_FileInfo",e),n.fileInfoDeferredPromise.reject(e)})),this.writeToMruService(),this.fluidFileContextProvider.getMruFileItem().then((function(e){var i;if(n.titleService.setTitle(e.title),t||n.isRedirectTelemetryData){var o=((i={}).action=x.a.Edit,i.drive=e.driveId,i.item=e.docId,i.file=e.canonicalUrl,i.abpId=void 0,i.folderUrl=void 0,i.siteUrl=e.sharepointIds.siteUrl,i.t=void 0,i);n.officeRouteService.updateQueryParams(o)}}))},t.prototype.setUpDocumentTitle=function(e){var t=this;this.fileInfo=e,this.fileInfoDeferredPromise.resolve(e);var n=decodeURI(new URL(e.folderUrl).pathname)+e.filename+e.fileExtension;this.onVersionHistoryButtonClick=function(){t.fluidInstrumentationService.instrumentClickEvent("Fluid_VersionHistoryDTTClick","VersionHistoryDTT",H.b.DocumentTitleComponent),t.windowService.nativeWindow.open(e.siteUrl+"/_layouts/15/modernversionhistory.aspx?FileName="+encodeURIComponent(n))}},t.prototype.getDateTimeFromVersionList=function(e){var t,n;try{for(var o=Object(i.__values)(e),r=o.next();!r.done;r=o.next()){var s=r.value;if(s.id===this.fileVersion){var a=new Date(s.lastModifiedDateTime);return a.toLocaleDateString()+" "+a.toLocaleTimeString()}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.getEditingCanvasDiv=function(){var e=this.documentService.nativeDocument.getElementById("owh-editing-canvas");if(!e){e=this.documentService.nativeDocument.createElement("owh-editing-canvas");var t=this.documentService.nativeDocument.getElementById("owh-container");t&&(t.id="fluid-content-full",t.appendChild(e))}return e},t.prototype.getHostComponentFocusable=function(){var e=this,t=this.getEditingCanvasDiv();return{get ComponentFocusable(){return this},giveFocus:function(){var t=e.documentService.nativeDocument.getElementById("feedbackContainer");return!!t&&(t.focus(),!0)},isComponentFocnt)}}},t.prototype.getStylingProvider=function(){var e=[];e.push([l.d.themeDarker,"#792000"],[l.d.themeDark,"#A52C00"],[l.d.themeDarkAlt,"#C33400"],[l.d.themePrimary,"#D83B01"],[l.d.themeSecondary,"#DD4F1B"],[l.d.themeTertiary,"#E8825D"],[l.d.themeLight,"#F4BE88"],[l.d.themeLighter,"#F9DCD1"],[l.d.themeLighterAlt,"#FEF6F4"],[l.d.neutralLighterAlt,"#faf9f8"],[l.d.neutralLighter,"#f3f2f1"],[l.d.neutralLight,"#edebe9"],[l.d.neutralQuaternaryAlt,"#e1dfdd"],[l.d.neutralQuaternary,"#d0d0d0"],[l.d.neutralTertiaryAlt,"#c8c6c4"],[l.d.neutralTertiary,"#a19f9d"],[l.d.neutralSecondary,"#605e5c"],[l.d.neutralSecondaryAlt,"#8a8886"],[l.d.neutralPrimaryAlt,"#3b3a39"],[l.d.neutralPrimary,"#323130"],[l.d.neutralDark,"#201f1e"],[l.d.black,"#000000"],[l.d.white,"#ffffff"]);var t=new v.a;return t.setThemeProperties(new Map(e)),t},t.prototype.parseRedirectTelemetryData=function(){var e=this.urlProvider.getTelemetryQueryParam();e&&(this.isRedirectTelemetryData=!0,e.or&&e.ct&&(this.fluidHostContext.hostScenarioName="Fluid."+e.or+"."+this.fluidHostContext.hostScenarioName,this.fluidHostContext.hostPerformanceData.OfficeDotCom={startTime:this.fluidHostContext.hostScenarioStartTime},this.fluidHostContext.hostScenarioStartTime=parseInt(e.ct)),e.rd&&e.rd.startTime&&(this.fluidHostContext.hostPerformanceData.SPORedirect={startTime:parseInt(e.rd.startTime),duration:parseInt(e.rd.duration)}),e.js&&e.js.startTime&&(this.fluidHostContext.hostPerformanceData.JsapiRedirect={startTime:parseInt(e.js.startTime),duration:parseInt(e.js.duration)}))},t.prototype.writeToMruService=function(){var e=this;this.mruItemService.writeMruDocument().cage)}))},t.prototype.setHostKeyboardShortcuts=function(e){var t,n=this;null===(t=null==e?void 0:e.KeyboardShortcutEmitter)||void 0===t||t.setShortcuts([{keyboardShortcutDescription:{type:"keydown",key:"F6",ctrlKey:!0,isOverride:!0},handler:function(){var e=n.documentService.nativeDocument.getElementById("O365_MainLink_NavMenu");e&&e.focus()}},{keyboardShortcutDescription:{type:"keydown",key:"F6",ctrlKey:!0,shiftKey:!0,isOverride:!0},hans()}}])},t.prototype.getRingFromAudience=function(e){switch(e){case"Automation":case"SyntheticTraffic":case"Local":return{audience:e,ring:"Prod"};default:return{audience:e}}},t}())}).call(this,n("zkTx").Buffer)},ZfMd:function(e,t,n){"use strp+e}n.d(t,"a",(function(){return i}))},bmzq:function(e,t,n){"use strict";var i=n("mXGw"),o=n("xARA"),r=functi=!1}return e.prototype.ngOnr()},e.prototype.render=function(){var e=this;return this.onRenderPromise=new Promise((function(t){i&&o?e.getReactElement().then((function(n){return!e.destroyed&&(e.rendered=!0,o.render(n,e.getTargetElementRef().nativeElement,t))})):t()})),this.onRenderPromise},e.prototype.ngOnDestroy=function(){i&&o&&(this.destroyed=!0,this.rendered&&o.unmountComponentAtNode(this.target.nativeElement))},e.prototype.getTargetElemenget},e}();t.a=r}}]);
//# sourceMappingURL=fl-cnt.4091dd2fa1562aaa7774.chunk.v7.js.map