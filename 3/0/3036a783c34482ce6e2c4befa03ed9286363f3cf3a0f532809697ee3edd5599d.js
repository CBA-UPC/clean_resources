(self.webpackChunkassets_nsk=self.webpackChunkassets_nsk||[]).push([[3480],{7618:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>C});var s=n(3057);onst o="js-active";var a=new WeakMap;class r{constructor(t,e){let{key:n,node:s}=t;var o,r,c;c={writable:!0,value:void 0},function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(o=this,r=a),r.set(o,c),this.key=n,this.node=s,this,a,e)}activate(){var t;(this,t=a,this,i(this,t,"get"))).getLayers(().forEach((t=>t.deactivate())),this.node.classList.add(o);const e=this.node.querySelector("a, button");null==e||e.focus()}ar c=new WeakSet;class h{constructor(){var t,e;((t=this,e=c),e.add(t),this.layers=[]}Layers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:return this.layers.filter(t)}noneOfLayersAreActive(){return this,c,l).call(this,this.getLayers(),()}}ar d=n(6617),u=n(8619),p=n(8832);var v=n(4104),b=n(1751),f=n(3258);onst m="js-atomsPartialButtonButton",L=["list","localization"];class C extends s.Z{constructor(){super(...arguments),y(this,"localizationLoaded",!1),y(this,"layersStack",[])}efineUi(){return{list:`#${this.id}List`,content:`#${this.id}Content`,refetchBtn:`#${this.id}RefetchBtn`,localization:`#${this.id}Localization`,changeLocalization:`#${this.id}ChangeLocalization`,activeLocalization:`#${this.id}ActiveLocalization`,tabs:`#${this.id} .${m}`}}fterInit(){this.ajax=new d.Z,this.createFetchMap(),this.createLayers(),this.setupTabs(),this.setupCardCloseListener(),this.setupIconListeners(),document.addEventListener(p.ej,this.onChangeLocalizationEvent.bind(this)),new b.Z(this.el.tabs,this.el.content)}createLayers(){this.layers=new h,L.map((t=>this.layers.create({key:t,node:this.el[t]})))}loseLayer(t){if(void 0===t)return void this.closeLayerOnTop();const e=this.layers.getLayer(t);if(!e)return;const n=this.layersStack.findIndex(();if(-1===n)return;const s=this.layersStack.splice(n,1)[0],i=this.getLayerOnTop();i&&!i.isActive()?i.activate():s.deactivate()}closeLayerOnTop(){if(this.isLayersStackEmpty())return;const t=this.layersStack.pop(),e=this.getLayerOnTop();e?e.activate():t.deactivate()}closeAllLayers(){this.layersStack=this.layersStack.filter(()}getLayerOnTop(){if(!this.isLayersStackEmpty())return this.layersStack.at(-1)}nChangeLocalizationEvent(t){const e=this.getLayerOnTop();"localization"===(null==e?void 0:e.key)?(this.closeLayer("localization"),this.onCardCloseButtonClick()):(this.dispatchClickEventToIcon(),this.closeAllLayers(),this.openLayer("localization")),t.details={handled:!0}}setupIconListeners(){this.nearbyIcon=document.getElementById(this.props.iconId),this.nearbyIcon&&(this.nearbyIcon.addEventListener("activateCard",this.onShowContentClick.bind(this)),this.nearbyIcon.addEventListener("deactivateCard",this.deactivateCard.bind(this)))}ispatchClickEventToIconreateFetchMap(){this.fetchMap={articles:{endpoint:this.props.articlesEndpoint,errorMessage:"W wybranej lokalizacji nie znaleziono artykułów."},companies:{endpoint:this.props.companiesEndpoint,errorMessage:"W wybranej lokalizacji nie znaleziono firm."}}}setupTabs(){const t=[...this.node.getElementsByClassName(m)];this.activateTab(t[0],!1),t.forEach((e=>{e.addEventListener("click",(()=>{t.forEach(this.deactivateTab),this.activateTab(e)}))}))}activateTab(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.classList.add(f.ACTIVE_CLASS),this.currentTabQuery=t.dataset.query,this.currentTabType=t.parentNode.dataset.tabType,this.el.content.dataset.tabType=this.currentTabType,e&&this.fetchContent(onCardCloseButtonClick(t){if(t){const{key:e}=t.details;this.closeLayer(e)}else this.closeLayerOnTop();this.isLayersStackEmpty()&&this.node.dispatchEvent(new Event("data-js-nearby-card-close")dispatchJsLoadEvent(){this.jsLoadEventDispatched||((t=>{let{id:e}=t;if(!e)throw new ReferenceError("LoadJsEvent cannot be dispatched without component ID");const n=new Event(`onJsLoadEvent:${e}`);document.dispatchEvent(n)})(this),this.jsLoadEventDispatched=!0)}setupLocalization(){if(this.localizationLoaded)return;this.localizationLoaded=!0;const t=new Event(p.QZ);t.source="nearby",t.callbac},document.dispatchEvent(t)}loadRequiredStylesheets(){this.loadedStylesheets||(this.props.requiredStylesheets.forEach})),this.loadedStylesheets=!0)}onLocalizationChange(t){let{value:e,showContent:n}=t;this.el.activeLocalization.textContent=`${e.name}, ${e.province.name}`,this.currentTerc=e.terc,this.fetchContent(),this.loadRequiredStylesheets(),n&&(this.closeLayer("localization"),this.isLayersStackEmpty()&&this.onCardCloseButtonClick()}fetchContent(){const{currentTabQuery:t,currentTabType:e,currentTerc:n}=this,{endpoint:s,errorMessage:i}=this.fetchMap[e];this.handleFetch(`${s}?terc=${n}${t?`&${t}`:""}`,i)}getNewAbortControllerSignal(){return this.abortController&&this.abortController.abort(),this.abortController=new u.H,this.abortController.signal}async handleFetch(t,e){const n=this.getNewAbortControllerSignal();this.clearContent(),this.hideRefetchBtn(),this.el.content.classList.add(f.LOADING_CLASS);try{const e=await this.ajax.get(t,{},{},!0,{cache:!0,signal:n});await this.handleFetchSuccess(e)}catch(t){"AbortError"!==t.name&&this.handleFetchError(t,e)}finally{this.el.content.classList.remove(f.LOADING_CLASS)}}async handleFetchSuccess(t){const[...e]=this.htmlToElement(t);e.forEach(this.loadJavascript.bind(this)),this.renderContent(e)}handleFetchError(t,e){if(404===t.status)return this.showContentMessage(e,f.MESSAGE_CLASS),void this.showRefetchBtn("Zmień lokalizację",this.onChangeLocalizationClick);this.showContentMessage("Błąd wczytywania. Sprawdź swoje połączenie z internetem.",f.ERROR_CLASS),this.showRefetchBtn("Spróbuj ponownie",this.fetchContent)}loadJavascript(t){const e=t.getElementsByTagName("script");e.length&&Array.from(e).forEach(this.evalScript)}Child(t)}renderContent(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.el.content.appHTML=""}showContentMessage(t,e){this.el.content.classList.add(e),this.el.content.textContent=t}showRefetchBtn(t,e){this.addEventRefetchBtn(e),this.el.refetchBtn.textContent=t,this.el.refetchBtn.classList.add(f.VISIBLE_CLASS)}hideRefetchBtn(){this.el.refetchBtn.classList.contains(f.VISIBLE_CLASS)&&(this.removeEventRefetchBtn(),this.el.refetchBtn.classList.remove(f.VISIBLE_CLASS))}addEventRefetchBtn(t){this.refetchBtnFunction=t.bind(this),this.el.refetchBtn.addEventListener("click",this.refetchBtnunction-hover"}},8619:(t,e,n)=>{"use strict";function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{H:()=>a,_:()=>i});class i exteborted")}}class o extends Evted",!1)}}class a{constructor(){s(this,"signal",new o),s(this,"abort",(()=>{const t=new CustomEvent("abort");this.signal.dispatchEvent(t),this.signal.aborted=!0}))}}},1751:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});class s{constructor(t,e){this.tabs=Array.from(t),this.tabpanels=e,this.firstTab=null,this.lastTab=null;for(let t=0;t<this.tabs.length;t+=1){let e=this.tabs[t];e.addEventListener("keydown",this.onKeydown.bind(this)),e.addEventListener("click",this.onClick.bind(this)),this.firstTab||(this.firstTab=e),this.lastTab=e}}setSelectedTab(t){for(let e=0;e<this.tabs.length;e+=1){let n=this.tabs[e];t===n?(n.setAttribute("aria-selected","true"),n.removeAttribute("tabindex")):(n.setAttribute("aria-selected","false"),n.tabIe+1]))Target)}}},6617:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var s=n(8619);const i=[];var o=new WeakSet;class a{constructor(){var t,e;(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t=this,e=o)return i}ajax(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if("GET"===e&&h.cache&&i.length&&i.find((e=>e.url===t))){const{response:e}=i.find((e=>e.url===t));return Promise.resolve(e)}return new Promise(((l,d)=>{var u;if(null!==(u=h.signal)&&void 0!==u&&u.aborted)return d(new s._);const p=new XMLHttpRequest;p.open(e,t);let v={"X-Requested-With":"XMLHttpRequest"};if("GET"!==e&&(v["Content-Type"]="application/x-www-form-urlencoded"),v=this.combineObjects(v,a),this.setRequestHeaders(p,v),p.onload=()=>{let e=p.response;e&&"application/json"==p.getResponseHeader("Content-Type")&&(e=JSON.parse(p.response)),200==p.status||201==p.status||204==p.status?(h.cache&&i.push({url:t,response:e}),l(e)):d(c?p:e)}, error")),new s._)},h.signal&&function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,o,r).call(this,p,h.signal),"GET"!==e){let t="";t=this.isContentMultipart(a)?this.payloadForMultipart(n):this.objectToParams(n),p.send(t)}else p.send()}))}payloadFoa(e,t),e}buildFormData(t,e,n){if(!e||"object"!=typeof e||e instanceof Date||e instanceof File){const s=null==e?"":e;t.append(n,s)}else Object.keys(e).forEach((s=>{this.buildFormData(t,e[s],n?`${n}[${s}]`:s)}))}isContentMultipart(t){return void 0!==t["Content-Type"]&&/multipart.form-data/.test(t["Content-Type"])}comb[t]})),n}setRequestHeaders(t,e){this.isContentMultipart(e)&&delete e["Content-Type"],Object.keys(e)(n,e[n])}))}post(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.ajax(t,"POST",e,n,s)}get(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return this.ajax(`${t}${this.objectToParams(e).length?`?${this.objectToParams(e)}`:""}`,"GET",{},n,s,i)}objectToParams(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(t).map((n=>{if("object"==typeof t[n]){const s=""===e?n:`${e}[${n}]`;return this.objectToParams(t[n],s)}return""===e?`${n}=${t[n]}`:`${e}[${n}]=${t[n]}`})).join("&")}}function r(t,e.abort()};e.addEventListener("abort",n),t.onreadystatechange=()=>{4===t.readyState&&e.removeEventListener("abort",n)}}},3057:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o}ponent=t}bindComponentElements(){if(0===Object.keys(this.component.ui).length)return;let t,e,n;for(t in this.component.ui)Object.prototype.hasOwnProperty.call(this.component.ui,t)&&(n=this.component.ui[t],e="#"===n.charAt(0)&&-1===n.indexOf(" "),e?(this.component.el[t]=document.getElementById(n.substring(1)),this.component.elExists[t]=!!this.component.el[t]):(this.component.el[t]=this.component.node?this.component.node.querySelectorAll(n):null,this.component.elExists[t]=!!(this.component.el[t]&&this.component.el[t].length>0)))}bindComponentEvents(){if(0===Object.keys(this.component.events).length)return;let t,e,n,s,i;for(t in this.component.events)if(Object.prototype.hasOwnProperty.call(this.component.events,t)){if(n=t.split(" ")[0],s=t.split(" ")[1],i=this.component.events[t],e=void 0!==s&&Object.prototype.hasOwnProperty.call(this.component.el,s)?this.component.el[s]:this.component.node,!e)continue;if(this.isNodeList(e)){let t;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&e[t].addEventListener(n,this.component[i].bind(this.component))}else e.addEventListener(n,this.component[i].bind(this.component))}}isNodeList(t){let e=Object.prototype.toString.call(t);return/^\[object (HTMLCollection|NodeList|Object)\]$/guments)}class o{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.id=t,this.className=e,this.props={},this.ui={},this.events={},this.el={},this.elExists={}}init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.ui=this.defineUi(),this.events=this.defineEvents(),this.props=this.defineProps(),i(this.props,t),this.node=""!==this.id?document.getElementById(this.id):document;const e=new s(this);e.bindComponentElements(),e.bindComponentEvents(),this.afrInit(){}defineUi(){return{}}defineEvents()return{}}}},4104:(t,e,n)=>{"use strict";n.d(e,{h:()=>s});const s=(t,e)=>new Promise((n=>{const s=document.createElement("link");s.rel="stylesheet",s.href=t,window.navigator.userAgent.includes("Mozilla")?n()()=>{n()},e.insertAdjacentElement("afterbegin",s)-active"}}]);