(self.webpackChunktama_web=self.webpackChunktama_web||[]).push([[4363],{13497:21960:79751:(e,t,r)=>{"use strict";r.d(t,{RJ:()=>O,Tf:()=>F,Uq:()=>j,e0:()=>N,fU:()=>L,ff:()=>$,jR:()=>B,rk:()=>Y});var o=r(66062),a=r(18274),i=r(55752),n=r.n(i),l=r(5663),d=r.n(l),p=r(7102),f=r.n(p),u=r(1029),s=r.n(u),y=r(22811),c=r(38193),m=r(42997),w=r(73614),g=r(68006),v=r(58813),b=r(90926),h=r(16176),A=r(64123),I=r(21960),T=r(71980),S=r(75457),_=r(13497),E=r(70317),M=r(59485),k=L=(0,a.H)({ttl:300},(e=>function(){var t=(0,o.Z)((function*(t,r){if(!e)return null;if(void 0!==n()(r(),["followState","followMap",e,"isFollowing"]))return null;try{if(t({type:M.Y,payload:{targetAmebaId:e}}),n()(r(),["followFeedState","feedMap","feed"],[]).some((t=>t.amebaId===e)))return t(k(e,!0));if(yield t((0,b.wn)()),(0,E.jl)(r())){if(n()(r(),["userState","sessionUser","amebaId"],"")===e)return t(k(e,!1));var o=r().amebloTokenState.amebloToken,a=yield m.tI(o,e);if(a.error)throw new Error(a.error);var i=!!n()(a,["data","relation","ameba_id"],"");return t(k(e,i))}yield t((0,g.HZ)(h.XN.INIT));var l=n()(r(),["followFeedState","feedMap","feed"],[]).some(();return t(k(e,l))}catch(d){return t(((e,t)=>({type:M.RN,payload:{targetAmebaId:e,error:t},error:!0}))(e,d))}}));return function(e,r){return t.apply(this,arguments)}}())),D=(0,a.H)({ttl:300},(e=>function(){var t=(0,o.Z)((function*(t,r){if(yield t((0,b.wn)()),!(0,E.jl)(r()))return null;var{force:o=!1}=e||{},a=r().followState.followActionMap.limit||{};if(!o&&f()(a.remainingTotal)&&f()(a.remainingPerDay))return null;try{t({type:M.Tl});var i=r().amebloTokenState.amebloToken,n=yield m.dS(i);if(n.error)throw new Error(n.error);var l,{remaining:d,remaining_per_day:p}=n.data||{};return p<=0?l=h.$i.DAILY:d<=0&&(l=h.$i.TOTAL),t(((!!l,l,d,p))}catch(u){return t((e=>({type:M.A_,payload:{error:e},error:!0}))(u))}}));return function(e,r){return t.apply(this,arguments)}}())),P=(e,t,r)=>({type:M.af,payload:{targetAmebaId:e,recommendedAmebaIds:t,sessionAmebaId:r}}),H=(e,t)=>({type:M.HP,payload:{targetAmebaId:e,error:t},error:!0}),Z=(0,a.H)({ttl:500},(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return function(){var a=(0,o.Z)((function*(o,a,i){var{fetchr:n}=i,l=a().followState.followSuggestMap[e]||{};if(l.isLoading||s()(l.suggestedAmebaIds))return null;o({type:M.Bg,payload:{targetAmebaId:e}});try{var d=((yield n.read(A.Z.RecommendBloggerToBlogger).params({amebaId:e,resultType:t?"official":"general",serviceCode:"blog_afterfollow_sp",length:"".concat(r)}).end()).data||[]).map(();yield Promise.all([o((0,b.h$)()),...d.map(()]);var p=a().userState.sessionUser.amebaId||"";return o(P(e,d,p))}catch(f){return o(H(e,f))}}));return ()})),U=()=>({type:M.rv}),x=(e,t,r,o,a,i)=>({type:M.F9,payload:{targetAmebaId:e,isUpperLimit:t,limitType:o,remainingTotal:a,remainingPerDay:i,isSetLatesetFollowedAmebaId:r}}),F=(0,a.H)({ttl:300},((e,t,r)=>function(){var a=(0,o.Z)((function*(o,a){try{if(o({type:M.Qm,payload:{targetAmebaId:e,actionRoute:t}}),!e)throw new Error("targetAmebaId is invalid");if(t===_.rd){yield o((0,w.Rs)(e));var i=n()(a().bloggerState.bloggerMap,[e,"attribute","isOfficial"])||!1;o(Z(e,i))}yield o((0,b.wn)());var l=(0,E.jl)(a()),d=t===_.a1;if(l){yield o(D());var{isUpperLimit:p,limitType:u}=a().followState.followActionMap;if(p){if(o(U()),u===h.$i.DAILY)return o((0,v.E)(I.G$));if(u===h.$i.TOTAL)return o((0,v.E)(I.UI))}var{followType:s,isBrowserPushNotificationEnabled:A,isMailNotificationEnabled:S}=r||{};if(s!==h.Ol.APPLICANTS&&s!==h.Ol.WATCHER)return o(U()),o((0,v.E)(I.Ft));var k=a().amebloTokenState.amebloToken,L=yield m.ZN(k,e,s,A,S,t);if(L.error)throw new Error(L.error);if(!L.data)throw new Error(L.data);var P,H=a().followState.followActionMap.limit||{},F=f()(H.remainingTotal)?H.remainingTotal-1:void 0,C=f()(H.remainingPerDay)?H.remainingPerDay-1:void 0;C<=0?P=h.$i.DAILY:F<=0&&(P=h.$i.TOTAL);var N=!!P;yield o(x(e,N,d,P,F,C))}else{var $=n()(y.parse(document.cookie),"P",null),R=yield c.tR($,e,(0,T.Z)(),t);if(!R.ok)throw new Error(yield R.text());var B=yield R.json(),O=(B?B.amebaIds:[]).length===h.xr;yield o(x(e,O,d))}return o((0,g.HZ)(h.XN.UPDATE))}catch(j){return o((e=>({type:M.VZ,payload:{error:e},error:!0}))(j))}}));return function(e,t){return a.apply(this,arguments)}}())),C=N=(0,a.H)({ttl:300},((e,t,r)=>function(){var a=(0,o.Z)((function*(o,a){try{if(o({type:M.Sm,payload:{targetAmebaId:e,actionRoute:t}}),!e)throw new Error("targetAmebaId is invalid");yield o((0,b.wn)());var i=(0,E.jl)(a()),{confirmed:l}=r||{};if(!l)return o(U()),o((0,v.E)(I.xC));if(i){var d=a().amebloTokenState.amebloToken,p=yield m.fv(d,e);if(p.error)throw new Error(p.error);if(!p.data)throw new Error(p.data);var u=a().followState.followActionMap.limit||{},s=f()(u.remainingTotal)?u.remainingTotal+1:void 0,w=f()(u.remainingPerDay)?u.remainingPerDay+1:void 0;yield o(C(e,s,w))}else{var A=n()(y.parse(document.cookie),"P",null),S=yield c.d5(A,e,(0,T.Z)(),t);if(!S.ok)throw new Error(yield S.text());yield o(C(e))}return o((0,g.HZ)(h.XN.UPDATE))}catch(_){return o((e=>({type:M.Og,payload:{error:e},error:!0}))(_))}}));return function(e,t){return a.apply(this,arguments)}}())),$=(0,a.H)({ttl:300},(e=>function(){var t=(0,o.Z)((function*(t){return e?t({type:M.Et,payload:{targetAmebaId:e}}):null}));return ())),R=B=(0,a.H)({ttl:200},(e=>function(){var t=(0,o.Z)((function*(t,r){if(!e)return null;var o={subscriptionButton:!1,profileInfo:!1},a=(0,E.jl)(r()),i=n()(r(),["followState","followMap",e,"isFollowing"],!1);if(a||i)return t(R(o));if(n()(r(),["followState","followActionMap","isUpperLimit"],!1))return t(R(o));var l=n()(r(),["historyState","browsingHistoryMap","browsingHistoryList"],[]);if(d()(l))return t(R(o));var p=l.filter(().length,f=n()(r(),["followState","followActionMap","hasFollowedUp"],!1),u={subscriptionButton:f?[]:[2],profileInfo:f?[2]:[1,3]},s={subscriptionButton:u.subscriptionButton.includes(p),profileInfo:u.profileInfo.includes(p)};return t(R(s))}));return ())),O=()=>({type:M.J1}),j=()=>({type:M.Ac}),Y=,58813:(e,t,r)=>{"use strict";r.d(t,{D:()=>l,E:);var o=r(22006),a=r.n(o),i=r(86264),n=e=>(t,r)=>{t({type:i.p,payload:{id:e}});var{modal:o}=r();1===o.openingModals.length&&a().on()},l=e=>(t,r)=>{t({type:i.U,payload:{id:e}});var{modal:o}=r();0===o.openingModals.length&&a().off()}},22006:]);