!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.getVPAIDAd=e():t.getVPAIDAd=e()}(self,(function(){return(()=>{var t={557:(t,e,n)=>{"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){var n=document.createElement(t);Object.entries(e||{}).forEach((function(t){var e=r(t,2),i=e[0],a=e[1];i.startsWith("on")&&i.toLowerCase()in window?n.addEventListener(i.toLowerCase().substr(2),a):n.setAttribute(i,a.toString())}));for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];return a.forEach((function(t){o(n,t)})),n}n.r(e),n.d(e,{default:()=>a});var o=function t(e,n){Array.isArray(n)?n.forEach((function(n){return t(e,n)})):e.appendChild(n.nodeType?n:document.createTextNode(n))}},298:t=>{t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function r(t,e){var n={enabled:!0,jsTimer:null},r=function(t){if("number"==typeof t)return t;if(!Array.isArray)throw new Error("Failed expanding timings: Value not a number or array: ".concat(t));var e=[];return t.forEach((function(t){if("number"!=typeof t){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),2!==n.length);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t.split(/x/i)),r=n[0],i=n[1];if(!r||r<=0||!/^\d+$/.test(i))throw new Error("Failed expanding timings: Expected (count)x(delay), got: ".concat(r,"x").concat(i));for(var a=0;a<parseInt(r,10);a+=1)e.push(parseInt(i,10))}else e.push(t)})),e}(e);return function e(){if(n.enabled){var i=r.length>1?r.shift():r[0];n.jsTimer=setTimeout((function(){try{t()}catch(t){console.error(t)}e()}),i)}}(),n}function i(t){t.enabled=!1,clearTimeout(t.jsTimer)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t,e,n){var r;try{r=t.document.cookie.split(";")}catch(t){return n}var i=!0,o=!1,s=void 0;try{for(var u,d=r[Symbol.iterator]();!(i=(u=d.next()).done);i=!0){var l=u.value;try{var c=a(l.split("=").map((function(t){return t.trim()})),2),p=c[0],h=c[1];if(p===e)return void 0===h?"":h}catch(t){}}}catch(t){o=!0,s=t}finally{try{i||null==d.return||d.return()}finally{if(o)throw s}}return n}function s(t){return"string"==typeof t&&/^1[YN-]{3}$/i.test(t)}function u(t){return!!s(t)&&"1---"!==t}function d(t){if(!s(t))return!1;var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),3!==n.length);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t.split(""))[2];return e&&"y"===e.toLowerCase()||!1}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e);var c=[0,"4x25","4x50","5x100","2x200","3x300","10x500","10x750",1e3];function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=o(t,"_sp_enable_dfp_personalized_ads");return e&&/^(true|false)$/i.test(e)?/^true$/i.test(e):null}function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return o(t,"us_privacy",null)}function v(t,e){return t.hasOwnProperty(e)||Object.keys(t).indexOf(e)>=0}function f(t){return"object"===l(t)&&null!==t&&!(!v(t,"consentData")||!v(t,"gdprApplies"))}function m(t){return!(!t||!t.googlePersonalizationData||"object"!==l(t.googlePersonalizationData))}function g(t){return!(!t||"object"!==l(t.purposeConsents)||"object"!==l(t.vendorConsents))}function y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;if(t._cmpWaitPromise)return t._cmpWaitPromise;var e=t.top;return t._cmpWaitPromise=new Promise((function(n){var a=function(){i(o),t.removeEventListener("message",s,!1)},o=r((function(){"function"==typeof t.__cmp&&(a(),n("obj")),e.postMessage(JSON.stringify({__cmp:{command:"ping",parameter:null}}),"*")}),c),s=function(t){var e=t.data;try{e="string"==typeof e?JSON.parse(e):e}catch(t){}e&&"object"===l(e)&&e.__cmpReturn&&(a(),n("msg"))};t.addEventListener("message",s,!1)})),t._cmpWaitPromise}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cmpCmd,n=void 0===e?"getConsentData":e,r=t.cmpParam,i=void 0===r?null:r,a=t.validate,o=void 0===a?f:a,s=t.win,u=void 0===s?window:s,d=u.top||u;if("getGooglePersonalization"===n){var l=p(u);if(null!==l)return Promise.resolve({googlePersonalizationData:{consentValue:l?1:0,created:null,lastUpdated:null}})}return y(u).then((function(t){return new Promise((function(e,r){if("obj"===t){var a=!1===i?[n]:[n,i];u.__cmp.apply(u,a.concat([function(t,n){if(!1===n||!o(t)){var i=new Error("Invalid consent payload from CMP");return i.name="InvalidConsentError",r(i)}e(t)}]))}else"msg"===t?(d.addEventListener("message",(function t(n){var r=n.data;try{r="string"==typeof r?JSON.parse(r):r}catch(t){}try{var i=r.__cmpReturn;i&&i.success&&o(i.returnValue)&&(d.removeEventListener("message",t,!1),e(i.returnValue))}catch(t){}}),!1),d.postMessage(JSON.stringify({__cmp:{command:n,parameter:i}}),"*")):r(new Error("Unknown CMP access method: ".concat(t)))}))}))}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;if(t._uspapiWaitPromise)return t._uspapiWaitPromise;var e=t.top,n="uspAPITest:".concat(Math.floor(9e6*Math.random()));return t._uspapiWaitPromise=new Promise((function(a){var o=function(){i(s),t.removeEventListener("message",u,!1)},s=r((function(){return"string"==typeof t.__uspStrOvr?(o(),a("ovr")):"function"==typeof t.__uspapi?(o(),a("obj")):void e.postMessage(JSON.stringify({__uspapiCall:{command:"getuspdata",version:1,callId:n}}),"*")}),c),u=function(t){var e=t.data;try{e="string"==typeof e?JSON.parse(e):e}catch(t){}e&&"object"===l(e)&&e.__uspapiReturn&&(o(),a("msg"))};t.addEventListener("message",u,!1)})),t._uspapiWaitPromise}function A(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.win,n=void 0===e?window:e,r=n.top||n,i=h(n);return i&&s(i)?Promise.resolve(i):b(n).then((function(t){return new Promise((function(e,i){if("obj"===t)n.__uspapi("getuspdata",1,(function(t,n){if(!1===n||t&&!s(t.uspString)){var r=new Error("Invalid USP payload from USP API");return r.name="InvalidConsentError",i(r)}e(t.uspString)}));else if("msg"===t){var a="uspAPI:".concat(Math.floor(9e6*Math.random()));r.addEventListener("message",(function t(n){var o=n.data;try{o="string"==typeof o?JSON.parse(o):o}catch(d){}try{var u=o.__uspapiReturn;if(u.callId===a){if(!(u&&u.success&&s(u.returnValue))){var d=new Error("Invalid USP payload response from USP API postMessage listener");return d.name="InvalidConsentError",i(d)}r.removeEventListener("message",t,!1),e(u.returnValue)}}catch(d){}}),!1),r.postMessage(JSON.stringify({__uspapiCall:{command:"getuspdata",version:1,callId:a}}),"*")}else{if("ovr"===t){var o=n.__uspStrOvr;if(s(o))return e(o);var u=new Error("Invalid USP payload response from USP override property: ".concat(o));return u.name="InvalidConsentError",i(u)}i(new Error("Unknown USP API access method: ".concat(t)))}}))}))}function E(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Timed-out waiting for result";return new Promise((function(r,i){t.then((function(t){clearTimeout(a),r(t)})).catch((function(t){clearTimeout(a),i(t)}));var a=setTimeout((function(){var t=new Error(n);t.name="TimeoutError",i(t)}),e)}))}function S(){return[]}function w(t,e){return t.length===e.length&&t.every((function(t,n){return e[n]===t}))}function C(t,e,n,r){var i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),2!==n.length);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(function(t,e,n,r){if(t._){var i=t._(e,n,r);if(i)return[!0,i.c]}for(var a=0;a<t.length;a+=1)if(t[a].m===e&&w(r,t[a].k))return[!0,t[a].c];return[!1]}(t,e,n,r)),a=i[0],o=i[1];if(a)return o;var s=e.apply(null,n);return t.push({m:e,a:n,k:r,c:s}),s}var P=["InvalidConsentError","TimeoutError"];function k(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.mem,r=void 0===n?[]:n,i=e.noConsent,a=void 0===i?"reject":i,o=e.timeout,s=void 0===o?null:o,u=e.type,d=void 0===u?"":u,l=e.win,c=void 0===l?window:l;return t="google"===d?C(r,_,[{cmpCmd:"getGooglePersonalization",cmpParam:!1,validate:m,win:c}],["getGooglePersonalization",c]):"vendor"===d||"vendors"===d?C(r,_,[{cmpCmd:"getVendorConsents",validate:g,win:c}],["getVendorConsents",c]):"usp"===d?C(r,A,[{win:c}],["getUSP",c]):C(r,_,[{win:c}],[c]),"number"==typeof s&&s>0&&(t=E(t,s,"Timed-out waiting for consent data")),t.catch((function(t){if(P.indexOf(t.name)>=0&&"resolve"===a)return null;throw t}))}function T(t){return k(Object.assign({},t,{type:""})).then((function(t){return t?t.consentData:t}))}function O(t){return k(Object.assign({},t,{type:"google"})).then((function(t){return t&&t.googlePersonalizationData?t.googlePersonalizationData.consentValue:t}))}function M(t){return k(Object.assign({},t,{noConsent:"resolve",type:"usp"}))}function x(t){return k(Object.assign({},t,{type:"vendor"}))}function j(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.mem,r=void 0===n?[]:n,i=e.type,a=void 0===i?"":i,o=e.win,s=void 0===o?window:o,u=!0;return k({mem:r,type:a,win:s}).then((function(e){u&&t(null,e)})).catch((function(e){u&&t(e,null)})),function(){u=!1}}function I(t,e){return j((function(e,n){e?t(e,null):t(null,n.consentData)}),e)}function L(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return j((function(e,n){e?t(e,null):t(null,n.googlePersonalizationData.consentValue)}),Object.assign({},e,{type:"google"}))}function D(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.mem,r=void 0===n?[]:n,i=e.win,a=void 0===i?window:i,o=!0;return k({mem:r,type:"usp",win:a}).then((function(e){o&&t(null,e)})).catch((function(e){o&&t(e,null)})),function(){o=!1}}function R(t,e){return j((function(e,n){e?t(e,null):t(null,n)}),Object.assign({},e,{type:"vendor"}))}n.d(e,"getConsentData",(function(){return k})),n.d(e,"getConsentString",(function(){return T})),n.d(e,"getGoogleConsent",(function(){return O})),n.d(e,"getUSPString",(function(){return M})),n.d(e,"getVendorConsentData",(function(){return x})),n.d(e,"onConsentData",(function(){return j})),n.d(e,"onConsentString",(function(){return I})),n.d(e,"onGoogleConsent",(function(){return L})),n.d(e,"onUSPString",(function(){return D})),n.d(e,"onVendorConsent",(function(){return R})),n.d(e,"createMem",(function(){return S})),n.d(e,"uspApplies",(function(){return u})),n.d(e,"uspOptsOut",(function(){return d}))}])}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(r,{default:()=>u});var e=function(){function e(t,n,r,i,a,o,s,u,d){var l=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.onAdImpression=n,this.onAdCompleted=r,this.wrapperEl=i,this.videoEl=a,this.eventsCBs=u,this.callEvent=d,this.width=o,this.height=s,this.adsManager={},this.eventsTranslator={AdLoaded:"LOADED",AdSkipped:"SKIPPED",AdStarted:"STARTED",AdStopped:"",AdLinearChange:"LINEAR_CHANGED",AdExpandedChanged:"EXPANDED_CHANGED",AdRemainingTimeChange:"AD_PROGRESS",AdVolumeChange:"VOLUME_CHANGED",AdImpression:"IMPRESSION",AdVideoStart:"STARTED",AdVideoFirstQuartile:"FIRST_QUARTILE",AdVideoMidpoint:"MIDPOINT",AdVideoThirdQuartile:"THIRD_QUARTILE",AdVideoComplete:"COMPLETE",AdClickThru:"CLICK",AdInteraction:"INTERACTION",AdUserAcceptInvitation:"",AdUserMinimize:"",AdUserClose:"USER_CLOSE",AdPaused:"PAUSED",AdPlaying:"RESUMED",AdLog:"LOG",AdError:"AD_ERROR"},"undefined"!=typeof google)this.launchAd(google,t);else{var c=document.createElement("script");c.src="//imasdk.googleapis.com/js/sdkloader/ima3.js",c.onload=function(){l.launchAd(google,t)},document.head.appendChild(c)}return{pause:function(){l.adsManager&&l.adsManager.pause()},resume:function(){l.adsManager&&l.adsManager.resume()}}}var n,r;return n=e,(r=[{key:"destroyMe",value:function(){this.adsManager&&this.adsManager.destroy&&this.adsManager.destroy()}},{key:"launchAd",value:function(t,e){this.videoEl.muted=!0,this.videoEl.autoplay=!0;var n=new t.ima.AdDisplayContainer(this.wrapperEl,this.videoEl),r=new t.ima.AdsLoader(n);r.getSettings().setVpaidMode(t.ima.ImaSdkSettings.VpaidMode.INSECURE),r.addEventListener(t.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(e){var n=new t.ima.AdsRenderingSettings;n.enablePreloading=!0,n.restoreCustomPlaybackStateOnAdBreakComplete=!0,this.adsManager=e.getAdsManager(this.videoEl,n),this.adsManager.addEventListener(t.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,o.bind(this)),this.adsManager.addEventListener(t.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,s.bind(this)),this.adsManager.addEventListener(t.ima.AdErrorEvent.Type.AD_ERROR,a.bind(this)),this.adsManager.addEventListener(t.ima.AdEvent.Type.COMPLETE,u.bind(this)),this.adsManager.addEventListener(t.ima.AdEvent.Type.IMPRESSION,this.onAdImpression);for(var r=0;r<Object.keys(this.eventsCBs).length;r++){var i=Object.keys(this.eventsCBs)[r];this.eventsTranslator[i]&&(t.ima.AdEvent.Type[this.eventsTranslator[i]]?this.adsManager.addEventListener(t.ima.AdEvent.Type[this.eventsTranslator[i]],this.eventsCBs[i]):this.adsManager.addEventListener(t.ima.AdErrorEvent.Type[this.eventsTranslator[i]],this.eventsCBs[i]))}try{var d=this.width,l=this.height;this.adsManager.init(d,l,t.ima.ViewMode.NORMAL),this.adsManager.start()}catch(t){console.error(t.toString())}}.bind(this),!1),r.addEventListener(t.ima.AdErrorEvent.Type.AD_ERROR,a.bind(this),!1);var i=new t.ima.AdsRequest;function a(e){var n=e.getError();this.adsManager&&this.adsManager.destroy&&this.adsManager.destroy(),n.getType(),t.ima.AdError.Type.AD_LOAD,this.callEvent("AdError")}function o(){this.adsManager&&this.adsManager.pause()}function s(){this.adsManager&&this.adsManager.resume()}function u(t){this.callEvent("AdVideoComplete"),this.onAdCompleted()}i.setAdWillAutoPlay(!0),i.setAdWillPlayMuted(!0),i.adTagUrl=e,r.requestAds(i),n.initialize(),this.videoEl.load()}}])&&t(n.prototype,r),e}(),i=n(298);var a=n(557).default;function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pixels_=[],this.slot_=null,this.videoSlot_=null,this.eventsCallbacks_={},this.attributes_={companions:"",desiredBitrate:256,duration:10,expanded:!1,height:0,icons:"",linear:!0,remainingTime:10,skippableState:!1,viewMode:"normal",width:0,volume:1},this.quartileEvents_=[{event:"AdImpression",value:0},{event:"AdVideoStart",value:0},{event:"AdVideoFirstQuartile",value:25},{event:"AdVideoMidpoint",value:50},{event:"AdVideoThirdQuartile",value:75},{event:"AdVideoComplete",value:100}],this.nextQuartileIndex_=0,this.parameters_={}}var n,r;return n=t,(r=[{key:"handshakeVersion",value:function(t){return"2.0"}},{key:"getDomainWithoutSubdomain",value:function(t){var e=document.createElement("iframe");document.body.appendChild(e);var n=new e.contentWindow.URL(t).hostname.split(".");return e.remove(),n.slice(0).slice(-(4===n.length?3:2)).join(".")}},{key:"generateGuid",value:function(t){return t?(0|16*Math.random()).toString(16):"10000000-1000-4000-8000-100000000000".replace(/1|0/g,this.generateGuid)}},{key:"pixelFirer",value:function(t,e){t.map((function(t){var n=document.createElement("img");n.setAttribute("src",t),n.setAttribute("alt",t),n.setAttribute("style","display:none"),n.width="1",n.height="1",e.document.body.appendChild(n)}))}},{key:"initAd",value:function(t,e,n,r,a,o){var s=this;this.attributes_.width=t,this.attributes_.height=e,this.attributes_.viewMode=n,this.attributes_.desiredBitrate=r,this.slot_=o.slot,this.videoSlot_=o.videoSlot,this.parameters_=JSON.parse(a.AdParameters);var u=function(){var t=window,e=!1;try{for(;t.parent.document!==t.document;){if(!t.parent.document){e=!0;break}t=t.parent}}catch(t){e=!0}return{topFrame:t,err:e}}(),d=function(t){var e=t.err,n=t.topFrame,r="";if(e)try{try{r=window.top.location.href}catch(t){var i=window.location.ancestorOrigins;r=i[i.length-1]}}catch(t){r=n.document.referrer}else r=n.location.href;return r}(u);if(this.pixelFirer(this.pixels_,u.topFrame),new Promise((function(t,e){var n=new XMLHttpRequest;n.open("GET","https://vpaid.vidoomy.com/sync/urls.json"),n.onload=function(){t(JSON.parse(n.response))},n.onerror=function(){e(n.response)},n.send()})).then((function(t){t=t.map((function(t){return t.replace("{{GDPR}}",s.parameters_.gdpr).replace("{{GDPR_CONSENT}}",s.parameters_.gdprcs)})),s.pixelFirer(t,u.topFrame)})),this.parameters_.d||(this.parameters_.d=this.getDomainWithoutSubdomain(d)),!this.parameters_.sp){var l=d;l=encodeURIComponent(l),this.parameters_.sp=l}if(!this.parameters_.dt){var c=/Mobi/i.test(window.navigator.userAgent);this.parameters_.dt=c?1:2}if(this.parameters_.h||(this.parameters_.h=e||1),this.parameters_.w||(this.parameters_.w=t||1),this.parameters_.ua||(this.parameters_.ua=navigator.userAgent),!this.parameters_.l){var p=navigator.language||navigator.userLanguage;p.indexOf("-")>-1&&(p=p.split("-")[1]),this.parameters_.l=p}this.parameters_.id||(this.parameters_.id=this.generateGuid()),this.parameters_.gdpr&&this.parameters_.gdprcs?(this.parameters_.gdpr=this.parameters_.gdpr?"1":"0",this.addBaseEventsAndLaunch(t,e,n,r,a,o)):(0,i.getConsentString)({noConsent:"resolve",timeout:1500}).then((function(i){s.parameters_.gdpr=i?"1":"0",s.parameters_.gdprcs=i||"",s.addBaseEventsAndLaunch(t,e,n,r,a,o)}))}},{key:"addBaseEventsAndLaunch",value:function(t,e,n,r,i,a){var o=this,s="https://a.vidoomy.com/api/rtbserver/ssp?id={{id}}&w={{w}}&h={{h}}&skip=1&ip={{ip}}&ua={{ua}}&l={{l}}&dt={{dt}}&c={{c}}&sid=&sname=Vidoomy&d={{d}}&sp={{sp}}&coppa=&gdpr={{gdpr}}&gdprcs={{gdprcs}}&pid={{pid}}&la={{la}}&lo={{lo}}&schain={{schain}}&zid={{zid}}&sspid={{sspid}}";Object.keys(this.parameters_).filter((function(t){return"vastUrl"!==t})).forEach((function(t){s=s.replace("{{".concat(t,"}}"),o.parameters_[t])})),this.vastUrl=s,this.log("initAd "+t+"x"+e+" "+n+" "+r),this.updateVideoSlot_(),this.videoSlot_.addEventListener("timeupdate",this.timeUpdateHandler_.bind(this),!1),this.videoSlot_.addEventListener("loadedmetadata",this.loadedMetadata_.bind(this),!1),this.videoSlot_.addEventListener("ended",this.stopAd.bind(this),!1),this.slot_.addEventListener("click",this.clickAd_.bind(this),!1),this.callEvent_("AdLoaded")}},{key:"clickAd_",value:function(){"AdClickThru"in this.eventsCallbacks_&&this.eventsCallbacks_.AdClickThru("","0",!0)}},{key:"loadedMetadata_",value:function(){this.attributes_.duration=this.videoSlot_.duration,this.callEvent_("AdDurationChange")}},{key:"timeUpdateHandler_",value:function(){if(!(this.nextQuartileIndex_>=this.quartileEvents_.length)){if(100*this.videoSlot_.currentTime/this.videoSlot_.duration>=this.quartileEvents_[this.nextQuartileIndex_].value){var t=this.quartileEvents_[this.nextQuartileIndex_].event;this.eventsCallbacks_[t]&&this.eventsCallbacks_[t](),this.nextQuartileIndex_+=1}this.videoSlot_.duration>0&&(this.attributes_.remainingTime=this.videoSlot_.duration-this.videoSlot_.currentTime)}}},{key:"updateVideoSlot_",value:function(){var t=this;null==this.videoSlot_&&(this.videoSlot_=a("video",{autoplay:!0,muted:!0}),this.log("Warning: No video element passed to ad, creating element."),this.slot_.appendChild(this.videoSlot_)),this.updateVideoPlayerSize_(),this.videoSlot_.setAttribute("autoplay","true"),this.videoSlot_.setAttribute("muted","true"),this.adsManager=new e(this.vastUrl,(function(){t.callEvent_("AdImpression"),t.slot_.querySelector("div").style.zIndex="5000"}),(function(){}),this.slot_,this.videoSlot_,this.attributes_.width,this.attributes_.height,this.eventsCallbacks_,this.callEvent_.bind(this))}},{key:"updateVideoPlayerSize_",value:function(){this.videoSlot_.setAttribute("width",this.attributes_.width),this.videoSlot_.setAttribute("height",this.attributes_.height)}},{key:"startAd",value:function(){this.log("Starting ad"),this.videoSlot_.play(),this.callEvent_("AdStarted")}},{key:"stopAd",value:function(){this.log("Stopping ad");var t=this.callEvent_.bind(this);setTimeout(t,75,["AdStopped"])}},{key:"resizeAd",value:function(t,e,n){this.log("resizeAd "+t+"x"+e+" "+n),this.attributes_.width=t,this.attributes_.height=e,this.attributes_.viewMode=n,this.updateVideoPlayerSize_(),this.callEvent_("AdSizeChange")}},{key:"pauseAd",value:function(){this.log("pauseAd"),this.adsManager.pause(),this.callEvent_("AdPaused")}},{key:"resumeAd",value:function(){this.log("resumeAd"),this.adsManager.resume(),this.callEvent_("AdPlaying")}},{key:"expandAd",value:function(){this.log("expandAd"),this.attributes_.expanded=!0,this.callEvent_("AdExpanded")}},{key:"collapseAd",value:function(){this.log("collapseAd"),this.attributes_.expanded=!1}},{key:"skipAd",value:function(){this.log("skipAd"),this.attributes_.skippableState&&this.callEvent_("AdSkipped")}},{key:"subscribe",value:function(t,e,n){this.log("Subscribe "+e);var r=t.bind(n);this.eventsCallbacks_[e]=r}},{key:"unsubscribe",value:function(t){this.log("unsubscribe "+t),this.eventsCallbacks_[t]=null}},{key:"getAdLinear",value:function(){return this.attributes_.linear}},{key:"getAdWidth",value:function(){return this.attributes_.width}},{key:"getAdHeight",value:function(){return this.attributes_.height}},{key:"getAdExpanded",value:function(){return this.log("getAdExpanded"),this.attributes_.expanded}},{key:"getAdSkippableState",value:function(){return this.log("getAdSkippableState"),this.attributes_.skippableState}},{key:"getAdRemainingTime",value:function(){return this.attributes_.remainingTime}},{key:"getAdDuration",value:function(){return this.attributes_.duration}},{key:"getAdVolume",value:function(){return this.log("getAdVolume"),this.attributes_.volume}},{key:"setAdVolume",value:function(t){this.attributes_.volume=t,this.log("setAdVolume "+t),this.callEvent_("AdVolumeChange")}},{key:"getAdCompanions",value:function(){return this.attributes_.companions}},{key:"getAdIcons",value:function(){return this.attributes_.icons}},{key:"log",value:function(t){}},{key:"callEvent_",value:function(t){console.log("LLAMANDO "+t),t in this.eventsCallbacks_&&this.eventsCallbacks_[t]()}}])&&o(n.prototype,r),t}();function u(){return new s}})(),r.default})()}));