import{getAutomationClass as l}from"./config.js";import{forceRepaintSVG as o,isFunction as m,noop as i,objDataset as h,resolve,isElement as p,domRemoveChildren as C}from"./croco.js";import{renderWithReset as v}from"./template-helpers.js";export const POPIN_VIEW_ID_DATASET="data-popin-content";export const POPIN_VIEW_DATASET="popinView";export class PopinContentView{constructor(t){this.isInitialized=false;this.$viewContent=document.createElement("div");const i=l("popin","viewContent");i&&this.$viewContent.classList.add(i);this.$viewContent.classList.add("js-popin-view-content","popin-content-container","l-fill-height","is-hidden","anim--fade-in");const o=resolve("options.noContentScroll",t);!o&&this.$viewContent.classList.add("l-overflow-auto");h(this.$viewContent,POPIN_VIEW_DATASET,this);this.setParams(t)}setParams(t){this.params=t;t.instanceId&&this.$viewContent.setAttribute(POPIN_VIEW_ID_DATASET,t.instanceId);["$btnSource","instanceId","type","popin","title","icon","subtitle","classname","options","closeClassName"].forEach(key=>{const value=t[key];if(value){this[key]=value}});["loadContents","openCallback","refreshCallback","closeCallback"].forEach(key=>{const value=t[key];this[key]=m(value)?value.bind(this):i})}async refreshContents(t,i){if(m(this.loadContents)&&(!this.isInitialized||t)&&this.popin){this.popin.setLoading(true);const{contents:o,footer:l,title,icon,subtitle:h,htmlContents:p,footerClass:C}=await this.loadContents(this.popin,this);title&&(this.title=title);h&&(this.subtitle=h);icon&&(this.icon=icon);if(o){this.displayContents(o,i)}else if(p){this.displayHtmlContents(p)}if(l){this.footerClass=`js-popin-view-footer ${C||"popin-footer flex flex--row-reverse flex-mt--col-reverse bg-white l-border-top flex-mt--justify-center flex--space-between"}`;if(!this.$viewFooter){this.$viewFooter=document.createElement("div");this.$viewFooter.className=this.footerClass}v(l,this.$viewFooter,{},true)}this.isInitialized=true;this.popin.setLoading(false);await this.refreshCallback(this.popin,this)}}displayContents(t,i){if(t){v(t,this.$viewContent,{},i);o(this.$viewContent);import("../modules/authentication.js").then(({exclusivityFlagInit:t})=>t(this.$viewContent))}}displayHtmlContents(t){if(p(t)){C(this.$viewContent);this.$viewContent.appendChild(t)}}}