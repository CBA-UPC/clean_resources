(()=>{var Nn=Object.defineProperty,Un=Object.defineProperties;var Fn=Object.getOwnPropertyDescriptors;var Vs=Object.getOwnPropertySymbols;var Vn=Object.prototype.hasOwnProperty,$n=Object.prototype.propertyIsEnumerable;var $s=W=Ce=var I=var Be=class{constructor(e={}){e=Object.assign({resolveTimeout:null,resolveValue:!0,rejectTimeout:null,rejectValue:!1},e),this._promise=new Promise(,this.then=this._promise.then.bind(this._promise),this.catch=this._promise.catch.bind(this._promise),this.finally=this._promise.finally.bind(this._promise),this[Symbol.toStringTag]="Promise";let{resolveTimeout:t,resolveValue:s,rejectTimeout:r,rejectValue:n}=e;t&&setTimeout(()=>this.resolve(s),t),r&&setTimeout(()=>this.reject(n),r)}};var Bs="layer";ar ct=i=>typeof i=="function"?i:function(){return i},Bn=typeof self!="undefined"?self:null,dt=typeof window!="undefined"?window:null,ut=Bn||dt||ut,jn="2.0.0",ye={connecting:0,open:1,closing:2,closed:3},Xn=1e4,Wn=1e3,ae={closed:"closed",errored:"errored",joined:"joined",joining:"joining",leaving:"leaving"},Te={close:"phx_close",error:"phx_error",join:"phx_join",reply:"phx_reply",leave:"phx_leave"},Fi={longpoll:"longpoll",websocket:"websocket"},Jn={complete:4},Dt=class{RefEvent(){!this.refEvent||this.channel.off(this.refEvent)}=Kn=class{constructor(i,e,t){this.state=ae.closed,this.topic=i,this.params=ct(e||{}),this.socket=t,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new Dt(this,Te.join,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new Xs(this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(()=>this.rejoinTimer.reset())),this.stateChangeRefs.push(this.socket.onOpen(),this.joinPush.receive("ok",,this.joinPush.receive("error",()=>{this.state=ae.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=ae.closed,this.socket.remove(this)}),this.onError(s=>{this.socket.hasLogger()&&this.socket.log("channel",`error ${this.topic}`,s),this.isJoining()&&this.joinPush.reset(),this.state=ae.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new Dt(this,Te.leave,ct({}),this.timeout).send(),this.state=ae.errored,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(Te.reply,}Error(i){return this.on(Te.error,e=>i(e))}ff(i,e){this.bindings=this.bindings.filter(t=>!(t.event===i&&(typeof e=="undefined"||e===t.ref)))}ave(i=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=ae.leaving;let e=()=>{this.socket.hasLogger()&&this.socket.log("channel",`leave ${this.topic}`),this.trigger(Te.close,"leave")},t=new Dt(this,Te.leave,ct({}),i);return t.receive("ok",()=>e()).receive("timeout",()=>e()),t.send(),this.canPush()||t.trigger("ok",{}),t}sMember(i,e,t,s){return this.topic!==i?!1:s&&s!==this.joinRef()?(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:i,event:e,payload:t,joinRef:s}),!1):!0}joinRef(){return this.joinPush.ref}losed(){return this.state===ae.closed}isErrored(){return this.state===ae.errored}isJoined(){return this.state===ae.joined}isJoining(){return this.state===ae.joining},Ht=class{static request(i,e,t,s,r,n,o){if(ut.XDomainRequest){let a=new ut.XDomainRequest;return this.xdomainRequest(a,i,e,s,r,n,o)}else{let a=new ut.XMLHttpRequest;return this.xhrRequest(a,i,e,t,s,r,n,o)}}tatic xhrRequest(i,e,t,s,r,n,o,a){return i.open(e,t,!0),i.timeout=n,i.setRequestHeader("Content-Type",s),i.onerror=i.onreadystatechange=()=>{if(i.readyState===Jn.complete&&a){let l=this.parseJSON(i.responseText);a(l)}},o&&(i.ontimeout=o),i.send(r),i}static parseJSON(i){if(!i||i==="")return null;try{return JSON.parse(i)}catch(e){return console&&console.log("failed to parse JSON response",i),null}}static serialize(i,e){let t=[];for(var s in i){if(!Object.prototype.hasOwnProperty.call(i,s))continue;let r=e?`${e}[${s}]`:s,n=i[s];typeof n=="object"?t.push(this.serialize(n,r)):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n))}return t.join("&")}static appendParams(i,e){if(Object.keys(e).length===0)return i;let t=i.match(/\?/)?"&":"?";return`${i}${t}${this.serialize(e)}`}},Vi=class{constructor(i){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.reqs=new Set,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(i),this.readyState=ye.connecting,this.poll()}normalizeEndpointoseAndRetry(i,e,t){this.close(i,e,t),this.readyState=ye.connecting}ll(){this.ajax("GET",null,()=>this.ontimeout(),i=>{if(i){var{status:e,token:t,messages:s}=i;this.token=t}else e=0;switch(e){case 200:s.forEach(,this.poll();break;case 204:this.poll();break;case 410:this.readyState=ye.open,this.onopen({}),this.poll();break;case 403:this.onerror(403),this.close(1008,"forbidden",!1);break;case 0:case 500:this.onerror(500),this.closeAndRetry(1011,"internal server error",500);break;default:throw new Error(`unhandled poll status ${e}`)}})}send(i){this.ajax("POST",i,()=>this.onerror("timeout"),e=>{(!e||e.status!==200)&&(this.onerror(e&&e.status),this.closeAndRetry(1011,"internal server error",!1))})}close(i,e,t){for(let r of this.reqs)r.abort();this.readyState=ye.closed;let s=Object.assign({code:1e3,reason:void 0,wasClean:!0},{code:i,reason:e,wasClean:t});typeof CloseEvent!="undefined"?this.onclose(new CloseEvent("close",s)):this.onclose(s)}ajax(i,e,t,s){let r,n=r=Ht.request(i,this.endpointURL(),"application/json",e,this.timeout,n,,this.reqs.add(r)}};var Ot={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encodedecodebinaryEncodebinaryDecodedecodePush(i,e,t){let s=e.getUint8(1),r=e.getUint8(2),n=e.getUint8(3),o=this.HEADER_LENGTH+this.META_LENGTH-1,a=t.decode(i.slice(o,o+s));o=o+s;let l=t.decode(i.slice(o,o+r));o=o+r;let d=t.decode(i.slice(o,o+n));o=o+n;let v=i.slice(o,i.byteLength);return{join_ref:a,ref:null,topic:l,event:d,payload:v}},decodeReply(i,e,t){let s=e.getUint8(1),r=e.getUint8(2),n=e.getUint8(3),o=e.getUint8(4),a=this.HEADER_LENGTH+this.META_LENGTH,l=t.decode(i.slice(a,a+s));a=a+s;let d=t.decode(i.slice(a,a+r));a=a+r;let v=t.decode(i.slice(a,a+n));a=a+n;let p=t.decode(i.slice(a,a+o));a=a+o;let _=i.slice(a,i.byteLength),y={status:p,response:_};return{join_ref:l,ref:d,topic:v,event:Te.reply,payload:y}},decodeBroadcast(i,e,t){let s=e.getUint8(1),r=e.getUint8(2),n=this.HEADER_LENGTH+2,o=t.decode(i.slice(n,n+s));n=n+s;let a=t.decode(i.slice(n,n+r));n=n+r;let l=i.slice(n,i.byteLength);return{join_ref:null,ref:null,topic:o,event:a,payload:l}}},Ws=class{constructor(i,e={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=e.timeout||Xn,this.transport=e.transport||ut.WebSocket||Vi,this.establishedConnections=0,this.defaultEncoder=Ot.encode.bind(Ot),this.defaultDecoder=Ot.decode.bind(Ot),this.closeWasClean=!1,this.binaryType=e.binaryType||"arraybuffer",this.connectClock=1,this.transport!==Vi?(this.encode=e.encode||this.defaultEncoder,this.decode=e.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder);let t=null;dt&&dt.addEventListener&&(dt.addEventListener("pagehide",,dt.addEventListener("pageshow",),this.heartbeatIntervalMs=e.heartbeatIntervalMs||3e4,this.rejoinAfterMs=this.reconnectAfterMs=this.logger=e.logger||null,this.longpollerTimeout=e.longpollerTimeout||2e4,this.params=ct(e.params||{}),this.endPoint=`${i}/${Fi.websocket}`,this.vsn=e.vsn||jn,this.heartbeatTimeoutTimer=null,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new Xs(this.reconnectAfterMs)}PointURL(){let i=Ht.appendParams(Ht.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return i.charAt(0)!=="/"?i:i.charAt(1)==="/"?`${this.protocol()}:${i}`:`${this.protocol()}://${location.host}${i}`}onnect(i){i&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=ct(i)),!this.conn&&(this.connectClock++,this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=e=>this.onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this.onConnClose(e))}Open(i){let e=this.makeRef();return this.stateChangeCallbacks.open.push([e,i]),e}onClose(i){let e=this.makeRef();return this.stateChangeCallbacks.close.push([e,i]),e}onError(i){let e=this.makeRef();return this.stateChangeCallbacks.error.push([e,i]),e}tbeatTimeout(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.triggerChanError(),this.closeWasClean=!1,this.teardown(()=>this.reconnectTimer.scheduleTimeout(),Wn,"heartbeat timeout"))}itForBufferDone(i,e=1){if(e===5||!this.conn||!this.conn.bufferedAmount){i();return}setTimeout(()=>{this.waitForBufferDone(i,e+1)},150*e)}waitForSocketClosed(i,e=1){if(e===5||!this.conn||this.conn.readyState===ye.closed){i();return}setTimeout(150*e)}onConnClose(i){let e=i&&i.code;this.hasLogger()&&this.log("transport","close",i),this.triggerChanError(),this.clearHeartbeats(),!this.closeWasClean&&e!==1e3&&this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(([,t])=>t(i))}riggerChanError(){this.channels.forEach(i=>{i.isErrored()||i.isLeaving()||i.isClosed()||i.trigger(Te.error)})}(i){for(let e in this.stateChangeCallbacks)this.stateChangeCallbacks[e]=this.stateChangeCallbacks[e].filter(([t])=>i.indexOf(t)===-1)}channel(i,e={}){let t=new Kn(i,e,this);return this.channels.push(t),t}nnMessage(i){this.decode(i.data,e=>{let{topic:t,event:s,payload:r,ref:n,join_ref:o}=e;n&&n===this.pendingHeartbeatRef&&(this.clearHeartbeats(),this.pendingHeartbeatRef=null,this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)),this.hasLogger()&&this.log("receive",`${r.status||""} ${t} ${s} ${n&&"("+n+")"||""}`,r);for(let a=0;a<this.channels.length;a++){let l=this.channels[a];!l.isMember(t,s,r,o)||l.trigger(s,r,n,o)}for(let a=0;a<this.stateChangeCallbacks.message.length;a++){let[,l]=this.stateChangeCallbacks.message[a];l(e)}})};var Js=(i,e,t)=>{e.forEach(s=>{i.addEventListener(s,t)})},Ks=(i,e,t)=>{e.forEach(},$i=class{constructor(e){this.defaults={idle:1e4,events:["mousemove","scroll","keydown","mousedown","touchstart"],onIdle:null,onActive:null,onHide:null,onShow:null,keepTracking:!0,startAtIdle:!1,recurIdleCall:!1},this.throwOnBadKey(Object.keys(e),Object.keys(this.defaults)),this.settings=Object.assign({},this.defaults,e),this.visibilityEvents=["visibilitychange","webkitvisibilitychange","mozvisibilitychange","msvisibilitychange"],this.clearTimeout=null,this.reset(),this.stopListener=this.idlenessEventsHandler=t=>{this.idle&&(this.idle=!1,this.settings.onActive&&this.settings.onActive.call()),this.resetTimeout(this.settings)},this.visibilityEventsHandler=t=>{document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?this.visible&&(this.visible=!1,this.settings.onHide&&this.settings.onHide.call()):this.visible||(this.visible=!0,this.settings.onShow&&this.settings.onShow.call())}}resetTimeout(e,t=this.settings.keepTracking){this.clearTimeout&&(this.clearTimeout(),this.clearTimeout=null),t&&this.timeout(this.settings)}timeout(e){var t=this.settings.recurIdleCall?{set:setInterval.bind(window),clear:clearInterval.bind(window)}:{set:setTimeout.bind(window),clear:clearTimeout.bind(window)},s=t.set(bind(this),this.settings.idle);this.clearTimeout=start(){return window.addEventListener("idle:stop",this.stopListener),this.timeout(this.settings),Js(window,this.settings.events,this.idlenessEventsHandler),(this.settings.onShow||this.settings.onHide)&&Js(document,this.visibilityEvents,this.visibilityEventsHandler),this}stop(){return window.removeEventListener("idle:stop",this.stopListener),Ks(window,this.settings.events,this.idlenessEventsHandler),this.resetTimeout(this.settings,!1),(this.settings.onShow||this.settings.onHide)&&Ks(document,this.visibilityEvents,this.visibilityEventsHandler),this}reset({idle:e=this.settings.startAtIdle,visible:t=!this.settings.startAtIdle}={}){return this.idle=e,this.visible=t,this}throwOnBadKey(e,t){e.forEach(function(s){if(!t.includes(s))throw`set: Unknown key ${s}`})}set(e){this.throwOnBadKey(Object.keys(e),Object.keys(this.defaults)),this.settings=Object.assign(this.settings,e)}};var Bi=class extends Ws{constructor(e,t={}){super(e,t);this.preventReconnect=!1,this.shouldReconnect=!1,this.idleMonitor=new $i({idle:3*60*1e3,onActive:this.onShowOrActive.bind(this),onShow:this.onShowOrActive.bind(this)}),this.idleMonitor.start()}onShowOrActive(){this.shouldReconnect&&this.idleMonitor.visible&&!this.idleMonitor.idle&&(this.shouldReconnect=!1,this.reconnectTimer.scheduleTimeout())}onConnClose(e){this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),this.clearHeartbeats(),this.preventReconnect||(this.closeWasClean?this.idleMonitor.stop():this.scheduleReconnect()),this.stateChangeCallbacks.close.forEach(}scheduleReconnect(){!this.idleMonitor.idle&&this.idleMonitor.visible?this.reconnectTimer.scheduleTimeout():(this.reconnectTimer.reset(),this.shouldReconnect=!0)}};var U="search",Mt="consecutive-reloads",qs=10,zs=5e3,Ys=1e4,Gs=3e4,Nt=["phx-click-loading","phx-change-loading","phx-submit-loading","phx-keydown-loading","phx-keyup-loading","phx-blur-loading","phx-focus-loading"],Z="data-phx-component";var Qs="track-static";var he="data-phx-ref",Ae="data-phx-ref-src",Ut="track-uploads",pe="data-phx-upload-ref",Ge="data-phx-preflighted-refs",Zs="data-phx-done-refs",ji="drop-target",ft="data-phx-active-refs",Qe=`${U}:live-file:updated`,pt="data-phx-skip",Xi="data-phx-prune",Wi="page-loading",Ji="phx-connected",Ft="phx-loading",Ki="phx-no-feedback",qi="phx-error",je="data-phx-parent-id",Vt="data-phx-main",xe="data-dfd-root-id",er="trigger-action",mt="feedback-for",$t="phx-has-focused",tr=["text","textarea","number","email","password","search","tel","url","date","time","datetime-local","color","range"],Bt=["checkbox","radio"],jt="phx-has-submitted",ce="data-dfd-view",ke=`[${ce}]`,zi="data-phx-sticky",Ie="data-phx-static",Xt="data-phx-readonly",gt="data-phx-disabled",vt="disable-with",_t="data-phx-disable-with-restore",Ze="hook",ir="debounce",sr="throttle",bt="update",rr="key",me="phxPrivate",Yi="auto-recover",Et="phx:live-socket:debug",Wt="phx:live-socket:profiling",Jt="phx:live-socket:latency-sim",nr="progress",Gi="mounted",or=1,ar=200,lr="dfd-",hr=3e4;var et="debounce-trigger",St="throttled",Qi="debounce-prev-key",cr={debounce:300,throttle:300},Zi="d",ge="s",re="c",es="e",ts="r",is="t",dr="p";var Kt=class{constructor(e,t,s){this.liveSocket=s,this.entry=e,this.offset=0,this.chunkSize=t,this.chunkTimer=null,this.uploadChannel=s.channel(`lvu:${e.ref}`,{token:e.metadata()})}error(e){clearTimeout(this.chunkTimer),this.uploadChannel.leave(),this.entry.error(e)}upload(){this.uploadChannel.onError(e=>this.error(e)),this.uploadChannel.join().receive("ok",.receive("error",e=>this.error(e))}isDoneeadNextChunk(){let e=new window.FileReader,t=this.entry.file.slice(this.offset,this.chunkSize+this.offset);e.onload=s=>{if(s.target.error===null)this.offset+=s.target.result.byteLength,this.pushChunk(s.target.result);else return q("Read error: "+s.target.error)},e.readAsArrayBuffer(t)}pushChunk(e){!this.uploadChannel.isJoined()||this.uploadChannel.push("chunk",e).receive("ok",()=>{this.entry.progress(this.offset/this.entry.file.size*100),this.isDone()||(this.chunkTimer=setTimeout(()=>this.readNextChunk(),this.liveSocket.getLatencySim()||0))})}};var q=ve=i=>{let e=typeof i;return e==="number"||e==="string"&&/^(0|[1-9]\d*)$/.test(i)};function ur(i=document){let e=new Set,t=i.querySelectorAll("*[id]");for(let s=0,r=t.length;s<r;s++)e.has(t[s].id)?console.error(`Multiple IDs detected: ${t[s].id}. Ensure unique element ids.`):e.add(t[s].id)}var fr=(i,e,t,s)=>{i.liveSocket.isDebugEnabled()&&console.log(`${i.id} ${e}: ${t} - `,s)},qt=i=>typeof i=="function"?i:tt=it=(i,e,t)=>{do{if(i.matches(`[${e}]`)&&!i.disabled)return i;i=i.parentElement||i.parentNode}while(i!==null&&i.nodeType===1&&!(t&&t.isSameNode(i)||i.matches(ke)));return null},st=i=>i!==null&&typeof i=="object"&&!(i instanceof Array),pr=ss=de=mr=function(i,e,t,s){i.forEach(r=>{new Kt(r,t.config.chunk_size,s).upload()})};var gr={canPushStatedropLocalupdateLocal(i,e,t,s,r){let n=this.getLocal(i,e,t),o=this.localKey(e,t),a=n===null?s:r(n);return i.setItem(o,JSON.stringify(a)),a},getLocal(i,e,t){return JSON.parse(i.getItem(this.localKey(e,t)))},updateCurrentState(i){!this.canPushState()||history.replaceState(i(history.state||{}),"",window.location.href)},pushState(i,e,t){if(this.canPushState()){if(t!==window.location.href){if(e.type=="redirect"&&e.scroll){let r=history.state||{};r.scroll=e.scroll,history.replaceState(r,"",window.location.href)}delete e.scroll,history[i+"State"](e,"",t||null);let s=this.getHashTargetEl(window.location.hash);s?s.scrollIntoView():e.type==="redirect"&&window.scroll(0,0)}}else this.redirect(t)},setCookiegetCookie(i){return document.cookie.replace(new RegExp(`(?:(?:^|.*;s*)${i}s*=s*([^;]*).*$)|^.*$`),"$1")},redirect(i,e){e&&gr.setCookie("__phoenix_flash__",e+"; max-age=60000; path=/"),window.location=i},localKeygetHashTargetEl(i){let e=i.toString().substring(1);if(e!=="")return document.getElementById(e)||document.querySelector(`a[name="${e}"]`)}},we=gr;var _e={byId(i){return document.getElementById(i)||q(`no id found for ${i}`)},removeClass(i,e){i.classList.remove(e),i.classList.length===0&&i.removeAttribute("class")},all(i,e,t){if(!i)return[];let s=Array.from(i.querySelectorAll(e));return t?s.forEach(t):s},childNodeLengthisUploadInput(i){return i.type==="file"&&i.getAttribute(pe)!==null},findUploadInputs(i){return this.all(i,`input[type="file"][${pe}]`)},findComponentNodeList(i,e){return this.filterWithinSameLiveView(this.all(i,`[${Z}="${e}"]`),i)},isPhxDestroyed(i){return!!(i.id&&_e.private(i,"destroyed"))},markPhxChildDestroyed(i){this.isPhxChild(i)&&i.setAttribute(ce,""),this.putPrivate(i,"destroyed",!0)},findPhxChildrenInFragment(i,e){let t=document.createElement("template");return t.innerHTML=i,this.findPhxChildren(t.content,e)},isIgnored(i,e){return(i.getAttribute(e)||i.getAttribute("data-phx-update"))==="ignore"},isPhxUpdate(i,e,t){return i.getAttribute&&t.indexOf(i.getAttribute(e))>=0},findPhxSticky(i){return this.all(i,`[${zi}]`)},findPhxChildren(i,e){return this.all(i,`${ke}[${je}="${e}"]`)},findParentCIDs(i,e){let t=new Set(e),s=e.reduce((r,n)=>{let o=`[${Z}="${n}"] [${Z}]`;return this.filterWithinSameLiveView(this.all(i,o),i).map(.forEach(a=>r.delete(a)),r},t);return s.size===0?new Set(e):s},filterWithinSameLiveView(i,e){return e.querySelector(ke)?i.filter(:i},withinSameLiveView(i,e){for(;i=i.parentNode;){if(i.isSameNode(e))return!0;if(i.getAttribute(ce)!==null)return!1}},privatedeletePrivateputPrivateupdatePrivate(i,e,t,s){let r=this.private(i,e);r===void 0?this.putPrivate(i,e,s(t)):this.putPrivate(i,e,s(r))},copyPrivatesputTitle(i){let e=document.querySelector("title"),{prefix:t,suffix:s}=e.dataset;document.title=`${t||""}${i}${s||""}`},debounce(i,e,t,s,r,n,o,a){let l=i.getAttribute(t),d=i.getAttribute(r);l===""&&(l=s),d===""&&(d=n);let v=l||d;switch(v){case null:return a();case"blur":this.once(i,"debounce-blur")&&i.addEventListener("blur",;return;default:let p=parseInt(v),_=()=>d?this.deletePrivate(i,St):a(),y=this.incCycle(i,et,_);if(isNaN(p))return q(`invalid throttle/debounce value: ${v}`);if(d){let C=!1;if(e.type==="keydown"){let H=this.private(i,Qi);this.putPrivate(i,Qi,e.key),C=H!==e.key}if(!C&&this.private(i,St))return!1;a(),this.putPrivate(i,St,!0),setTimeout(p)}else setTimeout(()=>{o()&&this.triggerCycle(i,et,y)},p);let w=i.form;w&&this.once(w,"bind-debounce")&&w.addEventListener("submit",()=>{Array.from(new FormData(w).entries(),([C])=>{let H=w.querySelector(`[name="${C}"]`);this.incCycle(H,et),this.deletePrivate(H,St)})}),this.once(i,"bind-debounce")&&i.addEventListener("blur",()=>this.triggerCycle(i,et))}},triggerCycle(i,e,t){let[s,r]=this.private(i,e);t||(t=s),t===s&&(this.incCycle(i,e),r())},once(i,e){return this.private(i,e)===!0?!1:(this.putPrivate(i,e,!0),!0)},incCycle(i,e,t=function(){}){let[s]=this.private(i,e)||[0,t];return s++,this.putPrivate(i,e,[s,t]),s},discardError(i,e,t){let s=e.getAttribute&&e.getAttribute(t),r=s&&i.querySelector(`[id="${s}"], [name="${s}"], [name="${s}[]"]`);!r||this.private(r,$t)||this.private(r.form,jt)||e.classList.add(Ki)},showError(i,e){(i.id||i.name)&&this.all(i.form,`[${e}="${i.id}"], [${e}="${i.name}"]`,},isPhxChildisPhxSticky(i){return i.getAttribute&&i.getAttribute(zi)!==null},firstPhxChild(i){return this.isPhxChild(i)?i:this.all(i,`[${je}]`)[0]},dispatchEvent(i,e,t={}){let r={bubbles:t.bubbles===void 0?!0:!!t.bubbles,cancelable:!0,detail:t.detail||{}},n=e==="click"?new MouseEvent("click",r):new CustomEvent(e,r);i.dispatchEvent(n)},cloneNode(i,e){if(typeof e=="undefined")return i.cloneNode(!0);{let t=i.cloneNode(!1);return t.innerHTML=e,t}},mergeAttrs(i,e,t={}){let s=t.exclude||[],r=t.isIgnored,n=e.attributes;for(let a=n.length-1;a>=0;a--){let l=n[a].name;s.indexOf(l)<0&&i.setAttribute(l,e.getAttribute(l))}let o=i.attributes;for(let a=o.length-1;a>=0;a--){let l=o[a].name;r?l.startsWith("data-")&&!e.hasAttribute(l)&&i.removeAttribute(l):e.hasAttribute(l)||i.removeAttribute(l)}},mergeFocusedInput(i,e){i instanceof HTMLSelectElement||_e.mergeAttrs(i,e,{exclude:["value"]}),e.readOnly?i.setAttribute("readonly",!0):i.removeAttribute("readonly")},hasSelectionRange(i){return i.setSelectionRange&&(i.type==="text"||i.type==="textarea")},restoreFocus(i,e,t){if(!_e.isTextualInput(i))return;let s=i.matches(":focus");i.readOnly&&i.blur(),s||i.focus(),this.hasSelectionRange(i)&&i.setSelectionRange(e,t)},isFormInput(i){return/^(?:input|select|textarea)$/i.test(i.tagName)&&i.type!=="button"},syncAttrsToProps(i){i instanceof HTMLInputElement&&Bt.indexOf(i.type.toLocaleLowerCase())>=0&&(i.checked=i.getAttribute("checked")!==null)},isTextualInputisNowTriggerFormExternal(i,e){return i.getAttribute&&i.getAttribute(e)!==null},syncPendingRef(i,e,t){let s=i.getAttribute(he);if(s===null)return!0;let r=i.getAttribute(Ae);return _e.isFormInput(i)||i.getAttribute(t)!==null?(_e.isUploadInput(i)&&_e.mergeAttrs(i,e,{isIgnored:!0}),_e.putPrivate(i,he,e),!1):(Nt.forEach(,e.setAttribute(he,s),e.setAttribute(Ae,r),!0)},cleanChildNodes(i,e){if(_e.isPhxUpdate(i,e,["append","prepend"])){let t=[];i.childNodes.forEach(s=>{s.id||(s.nodeType===Node.TEXT_NODE&&s.nodeValue.trim()===""||q(`only HTML element tags with an id are allowed inside containers with phx-update.

removing illegal node: "${(s.outerHTML||s.nodeValue).trim()}"

`),t.push(s))}),t.forEach(s=>s.remove())}},replaceRootContainer(i,e,t){let s=new Set(["id",ce,Ie,Vt,xe]);if(i.tagName.toLowerCase()===e.toLowerCase())return Array.from(i.attributes).filter(.forEach(,Object.keys(t).filter(.forEach(r=>i.setAttribute(r,t[r])),i;{let r=document.createElement(e);return Object.keys(t).forEach(,s.forEach(,r.innerHTML=i.innerHTML,i.replaceWith(r),r}},getSticky(i,e,t){let s=(_e.private(i,"sticky")||[]).find(([r])=>e===r);if(s){let[r,n,o]=s;return o}else return typeof t=="function"?t():t},deleteSticky(i,e){this.updatePrivate(i,"sticky",[],t=>t.filter()},putSticky(i,e,t){let s=t(i);this.updatePrivate(i,"sticky",[],r=>{let n=r.findIndex(;return n>=0?r[n]=[e,t,s]:r.push([e,t,s]),r})},applyStickyOperations(i){let e=_e.private(i,"sticky");!e||e.forEach(}},f=_e;var rt=class{static isActive(e,t){let s=t._phxRef===void 0,n=e.getAttribute(ft).split(",").indexOf(B.genFileRef(t))>=0;return t.size>0&&(s||n)}static isPreflighted(e,t){return e.getAttribute(Ge).split(",").indexOf(B.genFileRef(t))>=0&&this.isActive(e,t)}constructor(e,t,s){this.ref=B.genFileRef(t),this.fileEl=e,this.file=t,this.view=s,this.meta=null,this._isCancelled=!1,this._isDone=!1,this._progress=0,this._lastProgressSent=-1,this._onDone=function(){},this._onElUpdated=this.onElUpdated.bind(this),this.fileEl.addEventListener(Qe,this._onElUpdated)}metadata(){return this.meta}progress(e){this._progress=Math.floor(e),this._progress>this._lastProgressSent&&(this._progress>=100?(this._progress=100,this._lastProgressSent=100,this._isDone=!0,this.view.pushFileProgress(this.fileEl,this.ref,100,()=>{B.untrackFile(this.fileEl,this.file),this._onDone()})):(this._lastProgressSent=this._progress,this.view.pushFileProgress(this.fileEl,this.ref,this._progress)))}sDone(){return this._isDone}error(e="failed"){this.fileEl.removeEventListener(Qe,this._onElUpdated),this.view.pushFileProgress(this.fileEl,this.ref,{error:e}),B.clearFiles(this.fileEl)}onDone(e){this._onDone=()=>{this.fileEl.removeEventListener(Qe,this._onElUpdated),e()}}onElUpdated(){this.fileEl.getAttribute(ft).split(",").indexOf(this.ref)===-1&&this.cancel()}toPreflightPayload(){return{last_modified:this.file.lastModified,name:this.file.name,relative_path:this.file.webkitRelativePath,size:this.file.size,type:this.file.type,ref:this.ref}}uploader(e){if(this.meta.uploader){let t=e[this.meta.uploader]||q(`no uploader configured for ${this.meta.uploader}`);return{name:this.meta.uploader,callback:t}}else return{name:"channel",callback:mr}}zipPostFlight(e){this.meta=e.entries[this.ref],this.meta||q(`no preflight upload response returned with ref ${this.ref}`,{input:this.fileEl,response:e})}};var qn=0,B=class{static genFileRef(e){let t=e._phxRef;return t!==void 0?t:(e._phxRef=(qn++).toString(),e._phxRef)}static getEntryDataURL(e,t,s){let r=this.activeFiles(e).find(;s(URL.createObjectURL(r))}static hasUploadsInProgress(e){let t=0;return f.findUploadInputs(e).forEach(s=>{s.getAttribute(Ge)!==s.getAttribute(Zs)&&t++}),t>0}static serializeUploads(e){let t=this.activeFiles(e),s={};return t.forEach(r=>{let n={path:e.name},o=e.getAttribute(pe);s[o]=s[o]||[],n.ref=this.genFileRef(r),n.last_modified=r.lastModified,n.name=r.name||n.ref,n.relative_path=r.webkitRelativePath,n.type=r.type,n.size=r.size,s[o].push(n)}),s}static clearFiles(e){e.value=null,e.removeAttribute(pe),f.putPrivate(e,"files",[])}static untrackFile(e,t){f.putPrivate(e,"files",f.private(e,"files").filter(s=>!Object.is(s,t)))}static trackFiles(e,t){if(e.getAttribute("multiple")!==null){let s=t.filter(r=>!this.activeFiles(e).find(n=>Object.is(n,r)));f.putPrivate(e,"files",this.activeFiles(e).concat(s)),e.value=null}else f.putPrivate(e,"files",t)}static activeFileInputs(e){let t=f.findUploadInputs(e);return Array.from(t).filter(s=>s.files&&this.activeFiles(s).length>0)}static activeFiles(e){return(f.private(e,"files")||[]).filter(t=>rt.isActive(e,t))}static inputsAwaitingPreflight(e){let t=f.findUploadInputs(e);return Array.from(t).filter(}static filesAwaitingPreflight(e){return this.activeFiles(e).filter(}constructor(e,t,s){this.view=t,this.onComplete=s,this._entries=Array.from(B.filesAwaitingPreflight(e)||[]).map(,this.numEntriesInProgress=this._entries.length}entries(){return this._entries}initAdapterUpload(e,t,s){this._entries=this._entries.map(n=>(n.zipPostFlight(e),n.onDone(()=>{this.numEntriesInProgress--,this.numEntriesInProgress===0&&this.onComplete()}),n));let r=this._entries.reduce((n,o)=>{let{name:a,callback:l}=o.uploader(s.uploaders);return n[a]=n[a]||{callback:l,entries:[]},n[a].entries.push(o),n},{});for(let n in r){let{callback:o,entries:a}=r[n];o(a,t,e,s)}}};var zn={focusMain(){let i=document.querySelector("main h1, main, h1");if(i){let e=i.tabIndex;i.tabIndex=-1,i.focus(),i.tabIndex=e}},anyOf(i,e){return e.find(},isFocusable(i,e){return i instanceof HTMLAnchorElement&&i.rel!=="ignore"||i instanceof HTMLAreaElement&&i.href!==void 0||!i.disabled&&this.anyOf(i,[HTMLInputElement,HTMLSelectElement,HTMLTextAreaElement,HTMLButtonElement])||i instanceof HTMLIFrameElement||i.tabIndex>0||!e&&i.tabIndex===0&&i.getAttribute("tabindex")!==null&&i.getAttribute("aria-hidden")!=="true"},attemptFocus(i,e){if(this.isFocusable(i,e))try{i.focus()}catch(t){}return!!document.activeElement&&document.activeElement.isSameNode(i)},focusFirstInteractive(i){let e=i.firstElementChild;for(;e;){if(this.attemptFocus(e,!0)||this.focusFirstInteractive(e,!0))return!0;e=e.nextElementSibling}},focusFirst(i){let e=i.firstElementChild;for(;e;){if(this.attemptFocus(e)||this.focusFirst(e))return!0;e=e.nextElementSibling}},focusLast(i){let e=i.lastElementChild;for(;e;){if(this.attemptFocus(e)||this.focusLast(e))return!0;e=e.previousElementSibling}}},De=zn;var Yn={LiveFileUpload:{activeRefs(){return this.el.getAttribute(ft)},preflightedRefs(){return this.el.getAttribute(Ge)},mountedupdated(){let i=this.preflightedRefs();this.preflightedWas!==i&&(this.preflightedWas=i,i===""&&this.__view.cancelSubmit(this.el.form)),this.activeRefs()===""&&(this.el.value=null),this.el.dispatchEvent(new CustomEvent(Qe))}},LiveImgPreview:{mounted(){this.ref=this.el.getAttribute("data-phx-entry-ref"),this.inputEl=document.getElementById(this.el.getAttribute(pe)),B.getEntryDataURL(this.inputEl,this.ref,},destroyed,FocusWrap:{mounted(){this.focusStart=this.el.firstElementChild,this.focusEnd=this.el.lastElementChild,this.focusStart.addEventListener("focus",()=>De.focusLast(this.el)),this.focusEnd.addEventListener("focus",,this.el.addEventListener(`${U}:show-end`,,window.getComputedStyle(this.el).display!=="none"&&De.focusFirst(this.el)}}},vr=Yn;var zt=class{constructor(e,t,s){let r=new Set,n=new Set([...t.children].map(),o=[];Array.from(e.children).forEach(a=>{if(a.id&&(r.add(a.id),n.has(a.id))){let l=a.previousElementSibling&&a.previousElementSibling.id;o.push({elementId:a.id,previousElementId:l})}}),this.containerId=t.id,this.updateType=s,this.elementsToModify=o,this.elementIdsToAdd=[...n].filter(}perform(){let e=f.byId(this.containerId);this.elementsToModify.forEach(t=>{t.previousElementId?de(document.getElementById(t.previousElementId),s=>{de(document.getElementById(t.elementId),r=>{r.previousElementSibling&&r.previousElementSibling.id==s.id||s.insertAdjacentElement("afterend",r)})}):de(document.getElementById(t.elementId),s=>{s.previousElementSibling==null||e.insertAdjacentElement("afterbegin",s)})}),this.updateType=="prepend"&&this.elementIdsToAdd.reverse().forEach(t=>{de(document.getElementById(t),s=>e.insertAdjacentElement("afterbegin",s))})}};var _r=11;function Gn(i,e){var t=e.attributes,s,r,n,o,a;if(!(e.nodeType===_r||i.nodeType===_r)){for(var l=t.length-1;l>=0;l--)s=t[l],r=s.name,n=s.namespaceURI,o=s.value,n?(r=s.localName||r,a=i.getAttributeNS(n,r),a!==o&&(s.prefix==="xmlns"&&(r=s.name),i.setAttributeNS(n,r,o))):(a=i.getAttribute(r),a!==o&&i.setAttribute(r,o));for(var d=i.attributes,v=d.length-1;v>=0;v--)s=d[v],r=s.name,n=s.namespaceURI,n?(r=s.localName||r,e.hasAttributeNS(n,r)||i.removeAttributeNS(n,r)):e.hasAttribute(r)||i.removeAttribute(r)}}var Yt,Qn="http://www.w3.org/1999/xhtml",ne=typeof document=="undefined"?void 0:document,Zn=!!ne&&"content"in ne.createElement("template"),eo=!!ne&&ne.createRange&&"createContextualFragment"in ne.createRange();tion Gt(i,e){var t=i.nodeName,s=e.nodeName,r,n;return t===s?!0:(r=t.charCodeAt(0),n=s.charCodeAt(0),r<=90&&n>=97?t===s.toUpperCase():n<=90&&r>=97?s===t.toUpperCase():!1)} br={OPTION:function(i,e){var t=i.parentNode;if(t){var s=t.nodeName.toUpperCase();s==="OPTGROUP"&&(t=t.parentNode,s=t&&t.nodeName.toUpperCase()),s==="SELECT"&&!t.hasAttribute("multiple")&&(i.hasAttribute("selected")&&!e.selected&&(i.setAttribute("selected","selected"),i.removeAttribute("selected")),t.selectedIndex=-1)}rs(i,e,"selected")},INPUT:TEXTAREA:SELECT:function(i,e){if(!e.hasAttribute("multiple")){for(var t=-1,s=0,r=i.firstChild,n,o;r;)if(o=r.nodeName&&r.nodeName.toUpperCase(),o==="OPTGROUP")n=r,r=n.firstChild;else{if(o==="OPTION"){if(r.hasAttribute("selected")){t=s;break}s++}r=r.nextSibling,!r&&n&&(r=n.nextSibling,n=null)}i.selectedIndex=t}}},yt=1,Er=11,Sr=3,yr=8;nction lo(i){return function(t,s,r){if(r||(r={}),typeof s=="string")if(t.nodeName==="#document"||t.nodeName==="HTML"||t.nodeName==="BODY"){var n=s;s=ne.createElement("html"),s.innerHTML=n}else s=ro(s);else s.nodeType===Er&&(s=s.firstElementChild);var o=r.getNodeKey||ao,a=r.onBeforeNodeAdded||He,l=r.onNodeAdded||He,d=r.onBeforeElUpdated||He,v=r.onElUpdated||He,p=r.onBeforeNodeDiscarded||He,_=r.onNodeDiscarded||He,y=r.onBeforeElChildrenUpdated||He,w=r.skipFromChildren||He,C=r.addChild||H=r.childrenOnly===!0,k=Object.create(null),L=[];;nction Le(x,A,F){var P=o(A);P&&delete k[P],!(!F&&(d(x,A)===!1||(i(x,A),v(x),y(x,A)===!1)))&&(x.nodeName!=="TEXTAREA"?ot(x,A):br.TEXTAREA(x,A))}function ot(x,A){var F=w(x,A),P=A.firstChild,M=x.firstChild,Re,le,Se,Ve,ee;e:for(;P;){for(Ve=P.nextSibling,Re=o(P);!F&&M;){if(Se=M.nextSibling,P.isSameNode&&P.isSameNode(M)){P=Ve,M=Se;continue e}le=o(M);var Ye=M.nodeType,fe=void 0;if(Ye===P.nodeType&&(Ye===yt?(Re?Re!==le&&((ee=k[Re])?Se===ee?fe=!1:(x.insertBefore(ee,M),le?X(le):R(M,x,!0),M=ee):fe=!1):le&&(fe=!1),fe=fe!==!1&&Gt(M,P),fe&&Le(M,P)):(Ye===Sr||Ye==yr)&&(fe=!0,M.nodeValue!==P.nodeValue&&(M.nodeValue=P.nodeValue))),fe){P=Ve,M=Se;continue e}le?X(le):R(M,x,!0),M=Se}if(Re&&(ee=k[Re])&&Gt(ee,P))F||C(x,ee),Le(ee,P);else{var lt=a(P);lt!==!1&&(lt&&(P=lt),P.actualize&&(P=P.actualize(x.ownerDocument||ne)),C(x,P),oe(P))}P=Ve,M=Se}qe(x,M,le);var Pt=br[x.nodeName];Pt&&Pt(x,A)}var z=t,Ue=z.nodeType,ze=s.nodeType;if(!H){if(Ue===yt)ze===yt?Gt(t,s)||(_(t),z=oo(t,no(s.nodeName,s.namespaceURI))):z=s;else if(Ue===Sr||Ue===yr){if(ze===Ue)return z.nodeValue!==s.nodeValue&&(z.nodeValue=s.nodeValue),z;z=s}}if(z===s)_(t);else{if(s.isSameNode&&s.isSameNode(z))return;if(Le(z,s,H),L)for(var at=0,Pi=L.length;at<Pi;at++){var Fe=k[L[at]];Fe&&R(Fe,Fe.parentNode,!1)}}return!H&&z!==t&&t.parentNode&&(z.actualize&&(z=z.actualize(t.ownerDocument||ne)),t.parentNode.replaceChild(z,t)),z}}var ho=lo(Gn),ns=ho;var Xe=class{static patchEl(e,t,s){ns(e,t,{childrenOnly:!1,onBeforeElUpdated:(r,n)=>{if(s&&s.isSameNode(r)&&f.isFormInput(r))return f.mergeFocusedInput(r,n),!1}})}constructor(e,t,s,r,n){this.view=e,this.liveSocket=e.liveSocket,this.container=t,this.id=s,this.rootID=e.root.id,this.html=r,this.targetCID=n,this.cidPatch=ve(this.targetCID),this.callbacks={beforeadded:[],beforeupdated:[],beforephxChildAdded:[],afteradded:[],afterupdated:[],afterdiscarded:[],afterphxChildAdded:[],aftertransitionsDiscarded:[]}}before(e,t){this.callbacks[`before${e}`].push(t)}after(e,t){this.callbacks[`after${e}`].push(t)}trackBefore(e,...t){this.callbacks[`before${e}`].forEach(s=>s(...t))}trackAfter(e,...t){this.callbacks[`after${e}`].forEach(}markPrunableContentForRemoval(){f.all(this.container,"[phx-update=append] > *, [phx-update=prepend] > *",}perform(){let{view:e,liveSocket:t,container:s,html:r}=this,n=this.isCIDPatch()?this.targetCIDContainer(r):s;if(this.isCIDPatch()&&!n)return;let o=t.getActiveElement(),{selectionStart:a,selectionEnd:l}=o&&f.hasSelectionRange(o)?o:{},d=t.binding(bt),v=t.binding(mt),p=t.binding(vt),_=t.binding(er),y=t.binding("remove"),w=[],C=[],H=[],k=[],L=null,X=t.time("premorph container prep",;return this.trackBefore("added",s),this.trackBefore("updated",s,s),t.time("morphdom",()=>{ns(n,X,{childrenOnly:n.getAttribute(Z)===null,getNodeKey:onBeforeNodeAdded:g=>(this.trackBefore("added",g),g),onNodeAdded:g=>{g instanceof HTMLImageElement&&g.srcset?g.srcset=g.srcset:g instanceof HTMLVideoElement&&g.autoplay&&g.play(),f.isNowTriggerFormExternal(g,_)&&(L=g),f.discardError(n,g,v),(f.isPhxChild(g)&&e.ownsElement(g)||f.isPhxSticky(g)&&e.ownsElement(g.parentNode))&&this.trackAfter("phxChildAdded",g),w.push(g)},onNodeDiscarded:g=>{(f.isPhxChild(g)||f.isPhxSticky(g))&&t.destroyViewByEl(g),this.trackAfter("discarded",g)},onBeforeNodeDiscarded:g=>g.getAttribute&&g.getAttribute(Xi)!==null?!0:g.parentNode!==null&&f.isPhxUpdate(g.parentNode,d,["append","prepend"])&&g.id?!1:g.getAttribute&&g.getAttribute(y)?(k.push(g),!1):!this.skipCIDSibling(g),onElUpdated:g=>{f.isNowTriggerFormExternal(g,_)&&(L=g),C.push(g)},onBeforeElUpdated:(g,R)=>{if(f.cleanChildNodes(R,d),this.skipCIDSibling(R)||f.isPhxSticky(g))return!1;if(f.isIgnored(g,d)||g.form&&g.form.isSameNode(L))return this.trackBefore("updated",g,R),f.mergeAttrs(g,R,{isIgnored:!0}),C.push(g),f.applyStickyOperations(g),!1;if(g.type==="number"&&g.validity&&g.validity.badInput)return!1;if(!f.syncPendingRef(g,R,p))return f.isUploadInput(g)&&(this.trackBefore("updated",g,R),C.push(g)),f.applyStickyOperations(g),!1;if(f.isPhxChild(R)){let oe=g.getAttribute(ce);return f.mergeAttrs(g,R,{exclude:[Ie]}),oe!==""&&g.setAttribute(ce,oe),g.setAttribute(xe,this.rootID),f.applyStickyOperations(g),!1}return f.copyPrivates(R,g),f.discardError(n,R,v),o&&g.isSameNode(o)&&f.isFormInput(g)?(this.trackBefore("updated",g,R),f.mergeFocusedInput(g,R),f.syncAttrsToProps(g),C.push(g),f.applyStickyOperations(g),!1):(f.isPhxUpdate(R,d,["append","prepend"])&&H.push(new zt(g,R,R.getAttribute(d))),f.syncAttrsToProps(R),f.applyStickyOperations(R),this.trackBefore("updated",g,R),!0)}})}),t.isDebugEnabled()&&ur(t.doofinderMount),H.length>0&&t.time("post-morph append/prepend restoration",,t.silenceEvents(,f.dispatchEvent(document,`${U}:update`),w.forEach(g=>this.trackAfter("added",g)),C.forEach(,k.length>0&&(t.transitionRemoves(k),t.requestDOMUpdate(()=>{k.forEach(g=>{let R=f.firstPhxChild(g);R&&t.destroyViewByEl(R),g.remove()}),this.trackAfter("transitionsDiscarded",k)})),L&&(t.disconnect(),L.submit()),!0}isCIDPatch(){return this.cidPatch}skipCIDSibling(e){return e.nodeType===Node.ELEMENT_NODE&&e.getAttribute(pt)!==null}targetCIDContainer(e){if(!this.isCIDPatch())return;let[t,...s]=f.findComponentNodeList(this.container,this.targetCID);return s.length===0&&f.childNodeLength(e)===1?t:t&&t.parentNode}buildDiffHTML(e,t,s,r){let n=this.isCIDPatch(),o=n&&r.getAttribute(Z)===this.targetCID.toString();if(!n||o)return t;{let a=null,l=document.createElement("template");a=f.cloneNode(r);let[d,...v]=f.findComponentNodeList(a,this.targetCID);return l.innerHTML=t,v.forEach(p=>p.remove()),Array.from(a.childNodes).forEach(p=>{p.id&&p.nodeType===Node.ELEMENT_NODE&&p.getAttribute(Z)!==this.targetCID.toString()&&(p.setAttribute(pt,""),p.innerHTML="")}),Array.from(l.content.childNodes).forEach(p=>a.insertBefore(p,d)),d.remove(),a.outerHTML}}};var wt=class{static extract(e){let{[ts]:t,[es]:s,[is]:r}=e;return delete e[ts],delete e[es],delete e[is],{diff:e,title:r,reply:t||null,events:s||[]}}arentViewId(){return this.viewId}toString(e){return this.recursiveToString(this.rendered,this.rendered[re],e)}recursiveToString(e,t=e[re],s){s=s?new Set(s):null;let r={buffer:"",components:t,onlyCids:s};return this.toOutputBuffer(e,null,r),r.buffer}componentCIDs(e){return Object.keys(e[re]||{}).map(}isComponentOnlyDiff(e){return e[re]?Object.keys(e).length===1:!1}ergeDiff(e){let t=e[re],s={};if(delete e[re],this.rendered=this.mutableMerge(this.rendered,e),this.rendered[re]=this.rendered[re]||{},t){let r=this.rendered[re];for(let n in t)t[n]=this.cachedFindComponent(n,t[n],r,t,s);for(let n in t)r[n]=t[n];e[re]=t}}cachedFindComponent(e,t,s,r,n){if(n[e])return n[e];{let o,a,l=t[ge];if(ve(l)){let d;l>0?d=this.cachedFindComponent(l,r[l],s,r,n):d=s[-l],a=d[ge],o=this.cloneMerge(d,t),o[ge]=a}else o=t[ge]!==void 0?t:this.cloneMerge(s[e]||{},t);return n[e]=o,o}}mutableMerge(e,t){return t[ge]!==void 0?t:(this.doMutableMerge(e,t),e)}doMutableMerge(e,t){for(let s in t){let r=t[s],n=e[s];st(r)&&r[ge]===void 0&&st(n)?this.doMutableMerge(n,r):e[s]=r}}cloneMerge(e,t){let s=W(W({},e),t);for(let r in s){let n=t[r],o=e[r];st(n)&&n[ge]===void 0&&st(o)&&(s[r]=this.cloneMerge(o,n))}return s}runeCIDs(e){e.forEach(}get(){return this.rendered}isNewFingerprint(e={}){return!!e[ge]}templateStatic(e,t){return typeof e=="number"?t[e]:e}toOutputBuffer(e,t,s){if(e[Zi])return this.comprehensionToBuffer(e,t,s);let{[ge]:r}=e;r=this.templateStatic(r,t),s.buffer+=r[0];for(let n=1;n<r.length;n++)this.dynamicToBuffer(e[n-1],t,s),s.buffer+=r[n]}comprehensionToBuffer(e,t,s){let{[Zi]:r,[ge]:n}=e;n=this.templateStatic(n,t);let o=t||e[dr];for(let a=0;a<r.length;a++){let l=r[a];s.buffer+=n[0];for(let d=1;d<n.length;d++)this.dynamicToBuffer(l[d-1],o,s),s.buffer+=n[d]}}dynamicToBuffer(e,t,s){typeof e=="number"?s.buffer+=this.recursiveCIDToString(s.components,e,s.onlyCids):st(e)?this.toOutputBuffer(e,t,s):s.buffer+=e}recursiveCIDToString(e,t,s){let r=e[t]||q(`no component for CID ${t}`,e),n=document.createElement("template");n.innerHTML=this.recursiveToString(r,e,s);let o=n.content,a=s&&!s.has(t),[l,d]=Array.from(o.childNodes).reduce(([v,p],_,y)=>_.nodeType===Node.ELEMENT_NODE?_.getAttribute(Z)?[v,!0]:(_.setAttribute(Z,t),_.id||(_.id=`${this.parentViewId()}-${t}-${y}`),a&&(_.setAttribute(pt,""),_.innerHTML=""),[!0,p]):_.nodeValue.trim()!==""?(q(`only HTML element tags are allowed at the root of components.

got: "${_.nodeValue.trim()}"

within:
`,n.innerHTML.trim()),_.replaceWith(this.createSpan(_.nodeValue,t)),[!0,p]):(_.remove(),[v,p]),[!1,!1]);return!l&&!d?(q(`expected at least one HTML element tag inside a component, but the component is empty:
`,n.innerHTML.trim()),this.createSpan("",t).outerHTML):(!l&&d&&q("expected at least one HTML element tag directly inside a component, but only subcomponents were found. A component must render at least one HTML tag directly inside itself.",n.innerHTML.trim()),n.innerHTML)}createSpan(e,t){let s=document.createElement("span");return s.innerText=e,s.setAttribute(Z,t),s}};var co=1,Oe=class{static makeIDnstructor(e,t,s){this.__view=e,this.liveSocket=e.liveSocket,this.__callbacks=s,this.__listeners=new Set,this.__isDisconnected=!1,this.el=t,this.el.phxHookId=this.constructor.makeID();for(let r in this.__callbacks)this[r]=this.__callbacks[r]}__mounted(){this.mounted&&this.mounted()}__updated(){this.updated&&this.updated()}__beforeUpdate(){this.beforeUpdate&&this.beforeUpdate()}_reconnected(){this.__isDisconnected&&(this.__isDisconnected=!1,this.reconnected&&this.reconnected())}ushEvent(e,t={},s=function(){}){return this.__view.pushHookEvent(null,e,t,s)}pushEventTo(e,t,s={},r=function(){}){return this.__view.withinTargets(e,}handleEvent(e,t){let s=(r,n)=>n?e:t(r.detail);return this.liveSocket.doofinderMount.addEventListener(`${U}:${e}`,s),this.__listeners.add(s),s}removeHandleEvent(e){let t=e(null,!0);this.liveSocket.doofinderMount.removeEventListener(`${U}:${t}`,e),this.__listeners.delete(e)}upload(e,t){return this.__view.dispatchUploads(e,t)}uploadTo(e,t,s){return this.__view.withinTargets(e,r=>r.dispatchUploads(t,s))};var Qt=null,uo={exec(i,e,t,s,r){let[n,o]=r||[null,{}];(e.charAt(0)==="["?JSON.parse(e):[[n,o]]).forEach(([l,d])=>{l===n&&o.data&&(d.data=Object.assign(d.data||{},o.data)),this.filterToEls(s,d).forEach(v=>{this[`exec_${l}`](i,e,t,s,v,d)})})},isVisible(i){return!!(i.offsetWidth||i.offsetHeight||i.getClientRects().length>0)},exec_dispatch(i,e,t,s,r,{to:n,event:o,detail:a,bubbles:l}){a=a||{},a.dispatcher=s,f.dispatchEvent(r,o,{detail:a,bubbles:l})},exec_push(i,e,t,s,r,n){if(!t.isConnected())return;let{event:o,data:a,target:l,page_loading:d,loading:v,value:p,dispatcher:_}=n,y={loading:v,value:p,target:l,page_loading:!!d},w=i==="change"&&_?_:s,C=l||w.getAttribute(t.binding("target"))||w;t.withinTargets(C,(H,k)=>{if(i==="change"){let{newCid:L,_target:X,callback:g}=n;X=X||(s instanceof HTMLInputElement?s.name:void 0),X&&(y._target=X),H.pushInput(s,k,L,o||e,y,g)}else i==="submit"?H.submitForm(s,k,o||e,y):H.pushEvent(i,s,k,o||e,a,y)})},exec_navigate(i,e,t,s,r,{href:n,replace:o}){t.liveSocket.historyRedirect(n,o?"replace":"push")},exec_patch(i,e,t,s,r,{href:n,replace:o}){t.liveSocket.pushHistoryPatch(n,o?"replace":"push",s)},exec_focus(i,e,t,s,r){window.requestAnimationFrame(()=>De.attemptFocus(r))},exec_focus_first(i,e,t,s,r){window.requestAnimationFrame(()=>De.focusFirstInteractive(r)||De.focusFirst(r))},exec_push_focus(i,e,t,s,r){window.requestAnimationFrame(()=>Qt=r||s)},exec_pop_focus(i,e,t,s,r){window.requestAnimationFrame(},exec_add_class(i,e,t,s,r,{names:n,transition:o,time:a}){this.addOrRemoveClasses(r,n,[],o,a,t)},exec_remove_class(i,e,t,s,r,{names:n,transition:o,time:a}){this.addOrRemoveClasses(r,[],n,o,a,t)},exec_transition(i,e,t,s,r,{time:n,transition:o}){let[a,l,d]=o,v=()=>this.addOrRemoveClasses(r,a.concat(l),[]),p=()=>this.addOrRemoveClasses(r,d,a.concat(l));t.transition(n,v,p)},exec_toggle(i,e,t,s,r,{display:n,ins:o,outs:a,time:l}){this.toggle(i,t,r,n,o,a,l)},exec_show(i,e,t,s,r,{display:n,transition:o,time:a}){this.show(i,t,r,n,o,a)},exec_hide(i,e,t,s,r,{display:n,transition:o,time:a}){this.hide(i,t,r,n,o,a)},exec_set_attr(i,e,t,s,r,{attr:[n,o]}){this.setOrRemoveAttrs(r,[[n,o]],[])},exec_remove_attr(i,e,t,s,r,{attr:n}){this.setOrRemoveAttrs(r,[],[n])},show(i,e,t,s,r,n){this.isVisible(t)||this.toggle(i,e,t,s,r,null,n)},hide(i,e,t,s,r,n){this.isVisible(t)&&this.toggle(i,e,t,s,null,r,n)},toggle(i,e,t,s,r,n,o){let[a,l,d]=r||[[],[],[]],[v,p,_]=n||[[],[],[]];if(a.length>0||v.length>0)if(this.isVisible(t)){let y=()=>{this.addOrRemoveClasses(t,p,a.concat(l).concat(d)),window.requestAnimationFrame(()=>{this.addOrRemoveClasses(t,v,[]),window.requestAnimationFrame(()=>this.addOrRemoveClasses(t,_,p))})};t.dispatchEvent(new Event(`${U}:hide-start`)),e.transition(o,y,()=>{this.addOrRemoveClasses(t,[],v.concat(_)),f.putSticky(t,"toggle",w=>w.style.display="none"),t.dispatchEvent(new Event(`${U}:hide-end`))})}else{if(i==="remove")return;let y=()=>{this.addOrRemoveClasses(t,l,v.concat(p).concat(_)),f.putSticky(t,"toggle",w=>w.style.display=s||"block"),window.requestAnimationFrame(()=>{this.addOrRemoveClasses(t,a,[]),window.requestAnimationFrame(()=>this.addOrRemoveClasses(t,d,l))})};t.dispatchEvent(new Event(`${U}:show-start`)),e.transition(o,y,()=>{this.addOrRemoveClasses(t,[],a.concat(d)),t.dispatchEvent(new Event(`${U}:show-end`))})}else this.isVisible(t)?window.requestAnimationFrame(()=>{t.dispatchEvent(new Event(`${U}:hide-start`)),f.putSticky(t,"toggle",,t.dispatchEvent(new Event(`${U}:hide-end`))}):window.requestAnimationFrame(()=>{t.dispatchEvent(new Event(`${U}:show-start`)),f.putSticky(t,"toggle",y=>y.style.display=s||"block"),t.dispatchEvent(new Event(`${U}:show-end`))})},addOrRemoveClasses(i,e,t,s,r,n){let[o,a,l]=s||[[],[],[]];if(o.length>0){let d=()=>this.addOrRemoveClasses(i,a.concat(o),[]),v=()=>this.addOrRemoveClasses(i,e.concat(l),t.concat(o).concat(a));return n.transition(r,d,v)}window.requestAnimationFrame(()=>{let[d,v]=f.getSticky(i,"classes",[[],[]]),p=e.filter(C=>d.indexOf(C)<0&&!i.classList.contains(C)),_=t.filter(C=>v.indexOf(C)<0&&i.classList.contains(C)),y=d.filter(C=>t.indexOf(C)<0).concat(p),w=v.filter(.concat(_);f.putSticky(i,"classes",C=>(C.classList.remove(...w),C.classList.add(...y),[y,w]))})},setOrRemoveAttrs(i,e,t){let[s,r]=f.getSticky(i,"attrs",[[],[]]),n=e.map(.concat(t),o=s.filter(.concat(e),a=r.filter(l=>!n.includes(l)).concat(t);f.putSticky(i,"attrs",l=>(a.forEach(d=>l.removeAttribute(d)),o.forEach(,[o,a]))},hasAllClassesisToggledOut(i,e){return!this.isVisible(i)||this.hasAllClasses(i,e)},filterToEls(i,{to:e}){return e?f.all(document,e):[i]}},ue=uo;var Zt=(i,e,t=[])=>{let s=new FormData(i),r=[];s.forEach((o,a,l)=>{o instanceof File&&r.push(a)}),r.forEach(o=>s.delete(o));let n=new URLSearchParams;for(let[o,a]of s.entries())(t.length===0||t.indexOf(o)>=0)&&n.append(o,a);for(let o in e)n.append(o,e[o]);return n.toString()},nt=class{constructor(e,t,s,r,n){this.isDead=!1,this.liveSocket=t,this.flash=r,this.parent=s,this.root=s?s.root:this,this.el=e,this.id=this.el.id,this.ref=0,this.childJoins=0,this.loaderTimer=null,this.pendingDiffs=[],this.pruningCIDs=[],this.redirect=!1,this.href=null,this.joinCount=this.parent?this.parent.joinCount-1:0,this.joinPending=!0,this.destroyed=!1,this.joinCallback=this.stopCallback=function(){},this.pendingJoinOps=this.parent?null:[],this.viewHooks={},this.uploaders={},this.formSubmits=[],this.children=this.parent?null:{},this.root.children[this.id]={},this.channel=this.liveSocket.channel(`lv:${this.id}`,()=>({redirect:this.redirect?this.href:void 0,url:this.redirect?void 0:this.href||void 0,params:this.connectParams(n),session:this.getSession(),static:this.getStatic(),flash:this.flash}))}nectParams(e){let t=this.liveSocket.params(this.el),s=f.all(document,`[${this.binding(Qs)}]`).map(.filter(;return s.length>0&&(t._track_static=s),t._mounts=this.joinCount,t._live_referer=e,t}isConnected(){return this.channel.canPush()}getSession(){return this.el.getAttribute(ce)}getStatic(){let e=this.el.getAttribute(Ie);return e===""?null:e}destroy(e=function(){}){this.destroyAllChildren(),this.destroyed=!0,delete this.root.children[this.id],this.parent&&delete this.root.children[this.parent.id][this.id],clearTimeout(this.loaderTimer);let t=()=>{e();for(let s in this.viewHooks)this.destroyHook(this.viewHooks[s])};f.markPhxChildDestroyed(this.el),this.log("destroyed",()=>["the child has been removed from the parent"]),this.channel.leave().receive("ok",t).receive("error",t).receive("timeout",t)}setContainerClasses(...e){this.el.classList.remove(Ji,Ft,qi),this.el.classList.add(...e)}showLoader(e){if(clearTimeout(this.loaderTimer),e)this.loaderTimer=setTimeout(()=>this.showLoader(),e);else{for(let t in this.viewHooks)this.viewHooks[t].__disconnected();this.setContainerClasses(Ft)}}execAll(e){f.all(this.el,`[${e}]`,t=>this.liveSocket.execJS(t,t.getAttribute(e)))}hideLoader(){clearTimeout(this.loaderTimer),this.setContainerClasses(Ji),this.execAll(this.binding("connected"))}ansition(e,t,s=function(){}){this.liveSocket.transition(e,t,s)}withinTargets(e,t){if(e instanceof HTMLElement||e instanceof SVGElement)return this.liveSocket.owner(e,s=>t(s,e));if(ve(e))f.findComponentNodeList(this.el,e).length===0?q(`no component found matching phx-target of ${e}`):t(this,parseInt(e));else{let s=Array.from(document.querySelectorAll(e));s.length===0&&q(`nothing found matching the phx-target selector "${e}"`),s.forEach(r=>this.liveSocket.owner(r,n=>t(n,r)))}}applyDiff(e,t,s){this.log(e,()=>["",tt(t)]);let{diff:r,reply:n,events:o,title:a}=wt.extract(t);a&&f.putTitle(a),s({diff:r,reply:n,events:o})}onJoin(e){let{rendered:t,container:s}=e;if(s){let[r,n]=s;this.el=f.replaceRootContainer(this.el,r,n)}this.childJoins=0,this.joinPending=!0,this.flash=null,we.dropLocal(this.liveSocket.localStorage,window.location.pathname,Mt),this.applyDiff("mount",t,({diff:r,events:n})=>{this.rendered=new wt(this.id,r);let o=this.renderContainer(null,"join");this.dropPendingRefs();let a=this.formsForRecovery(o);this.joinCount++,a.length>0?a.forEach(([l,d,v],p)=>{this.pushFormRecovery(l,v,_=>{p===a.length-1&&this.onJoinComplete(_,o,n)})}):this.onJoinComplete(e,o,n)})}dropPendingRefs(){f.all(document,`[${Ae}="${this.id}"][${he}]`,}onJoinComplete({live_patch:e},t,s){if(this.joinCount>1||this.parent&&!this.parent.isJoinPending())return this.applyJoinPatch(e,t,s);f.findPhxChildrenInFragment(t,this.id).filter(n=>{let o=n.id&&this.el.querySelector(`[id="${n.id}"]`),a=o&&o.getAttribute(Ie);return a&&n.setAttribute(Ie,a),this.joinChild(n)}).length===0?this.parent?(this.root.pendingJoinOps.push([this,()=>this.applyJoinPatch(e,t,s)]),this.parent.ackJoin(this)):(this.onAllChildJoinsComplete(),this.applyJoinPatch(e,t,s)):this.root.pendingJoinOps.push([this,)}attachTrueDocEl(){this.el=f.byId(this.id),this.el.setAttribute(xe,this.root.id)}execNewMounted(){f.all(this.el,`[${this.binding(Ze)}], [data-phx-${Ze}]`,,f.all(this.el,`[${this.binding(Gi)}]`,e=>this.maybeMounted(e))}applyJoinPatch(e,t,s){this.attachTrueDocEl();let r=new Xe(this,this.el,this.id,t,null);if(r.markPrunableContentForRemoval(),this.performPatch(r,!1),this.joinNewChildren(),this.execNewMounted(),this.joinPending=!1,this.liveSocket.dispatchEvents(s),this.applyPendingUpdates(),e){let{kind:n,to:o}=e;this.liveSocket.historyPatch(o,n)}this.hideLoader(),this.joinCount>1&&this.triggerReconnected(),this.stopCallback()}triggerBeforeUpdateHook(e,t){this.liveSocket.triggerDOM("onBeforeElUpdated",[e,t]);let s=this.getHook(e),r=s&&f.isIgnored(e,this.binding(bt));if(s&&!e.isEqualNode(t)&&!(r&&pr(e.dataset,t.dataset)))return s.__beforeUpdate(),s}maybeMounted(e){let t=e.getAttribute(this.binding(Gi)),s=t&&f.private(e,"mounted");t&&!s&&(this.liveSocket.execJS(e,t),f.putPrivate(e,"mounted",!0))}maybeAddNewHook(e,t){let s=this.addHook(e);s&&s.__mounted()}performPatch(e,t){let s=[],r=!1,n=new Set;return e.after("added",o=>{this.liveSocket.triggerDOM("onNodeAdded",[o]),this.maybeAddNewHook(o),o.getAttribute&&this.maybeMounted(o)}),e.after("phxChildAdded",o=>{f.isPhxSticky(o)?this.liveSocket.joinRootViews():r=!0}),e.before("updated",(o,a)=>{this.triggerBeforeUpdateHook(o,a)&&n.add(o.id)}),e.after("updated",o=>{n.has(o.id)&&this.getHook(o).__updated()}),e.after("discarded",,e.after("transitionsDiscarded",o=>this.afterElementsRemoved(o,t)),e.perform(),this.afterElementsRemoved(s,t),r}afterElementsRemoved(e,t){let s=[];e.forEach(r=>{let n=f.all(r,`[${Z}]`),o=f.all(r,`[${this.binding(Ze)}]`);n.concat(r).forEach(a=>{let l=this.componentID(a);ve(l)&&s.indexOf(l)===-1&&s.push(l)}),o.concat(r).forEach(}),t&&this.maybePushComponentsDestroyed(s)}joinNewChildren(){f.findPhxChildren(this.el,this.id).forEach(e=>this.joinChild(e))}etDescendentByEl(e){return e.id===this.id?this:this.children[e.getAttribute(je)][e.id]}destroyDescendent(e){for(let t in this.root.children)for(let s in this.root.children[t])if(s===e)return this.root.children[t][s].destroy()}joinChild(e){if(!this.getChildById(e.id)){let s=new nt(e,this.liveSocket,this);return this.root.children[this.id][s.id]=s,s.join(),this.childJoins++,!0}}isJoinPending(){return this.joinPending}ackJoin(e){this.childJoins--,this.childJoins===0&&(this.parent?this.parent.ackJoin(this):this.onAllChildJoinsComplete())}onAllChildJoinsComplete(){this.joinCallback(()=>{this.pendingJoinOps.forEach(([e,t])=>{e.isDestroyed()||t()}),this.pendingJoinOps=[]})}update(e,t){if(this.isJoinPending()||this.liveSocket.hasPendingLink()&&this.root.isMain())return this.pendingDiffs.push({diff:e,events:t});this.rendered.mergeDiff(e);let s=!1;this.rendered.isComponentOnlyDiff(e)?this.liveSocket.time("component patch complete",()=>{f.findParentCIDs(this.el,this.rendered.componentCIDs(e)).forEach(n=>{this.componentPatch(this.rendered.getComponent(e,n),n)&&(s=!0)})}):ss(e)||this.liveSocket.time("full patch complete",()=>{let r=this.renderContainer(e,"update"),n=new Xe(this,this.el,this.id,r,null);s=this.performPatch(n,!0)}),this.liveSocket.dispatchEvents(t),s&&this.joinNewChildren()}renderContainer(e,t){return this.liveSocket.time(`toString diff (${t})`,()=>{let s=this.el.tagName,r=e?this.rendered.componentCIDs(e).concat(this.pruningCIDs):null,n=this.rendered.toString(r);return`<${s}>${n}</${s}>`})}componentPatch(e,t){if(ss(e))return!1;let s=this.rendered.componentToString(t),r=new Xe(this,this.el,this.id,s,t);return this.performPatch(r,!0)}ddHook(e){if(Oe.elementID(e)||!e.getAttribute)return;let t=e.getAttribute(`data-phx-${Ze}`)||e.getAttribute(this.binding(Ze));if(t&&!this.ownsElement(e))return;let s=this.liveSocket.getHookCallbacks(t);if(s){e.id||q(`no DOM ID for hook "${t}". Hooks require a unique ID on each element.`,e);let r=new Oe(this,e,s);return this.viewHooks[Oe.elementID(r.el)]=r,r}else t!==null&&q(`unknown hook found for "${t}"`,e)}destroyHook(e){e.__destroyed(),e.__cleanup__(),delete this.viewHooks[Oe.elementID(e.el)]}applyPendingUpdates(){this.pendingDiffs.forEach(({diff:e,events:t})=>this.update(e,t)),this.pendingDiffs=[]}onChannel(e,t){this.liveSocket.onChannel(this.channel,e,s=>{this.isJoinPending()?this.root.pendingJoinOps.push([this,()=>t(s)]):this.liveSocket.requestDOMUpdate(()=>t(s))})}bindChannel(){this.liveSocket.onChannel(this.channel,"diff",e=>{this.liveSocket.requestDOMUpdate(()=>{this.applyDiff("update",e,})}),this.onChannel("redirect",,this.onChannel("live_patch",e=>this.onLivePatch(e)),this.onChannel("live_redirect",e=>this.onLiveRedirect(e)),this.channel.onError(e=>this.onError(e)),this.channel.onClose(e=>this.onClose(e))}destroyAllChildren(){for(let e in this.root.children[this.id])this.getChildById(e).destroy()}onLiveRedirect(e){let{to:t,kind:s,flash:r}=e,n=this.expandURL(t);this.liveSocket.historyRedirect(n,s,r)}onLivePatch(e){let{to:t,kind:s}=e;this.href=this.expandURL(t),this.liveSocket.historyPatch(t,s)}expandURL(e){return e.startsWith("/")?`${window.location.protocol}//${window.location.host}${e}`:e}sDestroyed(){return this.destroyed}oin(e){this.showLoader(this.liveSocket.loaderTimeout),this.bindChannel(),this.isMain()&&(this.stopCallback=this.liveSocket.withPageLoading({to:this.href,kind:"initial"})),this.joinCallback=t=>{t=t||function(){},e?e(this.joinCount,t):t()},this.liveSocket.wrapPush(this,{timeout:!1},()=>this.channel.join().receive("ok",t=>{this.isDestroyed()||this.liveSocket.requestDOMUpdate(()=>this.onJoin(t))}).receive("error",t=>!this.isDestroyed()&&this.onJoinError(t)).receive("timeout",()=>!this.isDestroyed()&&this.onJoinError({reason:"timeout"})))}onJoinError(e){if(e.reason==="unauthorized"||e.reason==="stale")return this.log("error",()=>["unauthorized live_redirect. Falling back to page request",e]),this.onRedirect({to:this.href});if((e.redirect||e.live_redirect)&&(this.joinPending=!1,this.channel.leave()),e.redirect)return this.onRedirect(e.redirect);if(e.live_redirect)return this.onLiveRedirect(e.live_redirect);this.log("error",()=>["unable to join",e]),this.liveSocket.isConnected()&&this.liveSocket.reloadWithJitter(this)}onClose(e){if(!this.isDestroyed()){if(this.liveSocket.hasPendingLink()&&e!=="leave")return this.liveSocket.reloadWithJitter(this);this.destroyAllChildren(),this.liveSocket.dropActiveElement(this),document.activeElement&&document.activeElement.blur(),this.liveSocket.isUnloaded()&&this.showLoader(ar)}}onError(e){this.onClose(e),this.liveSocket.isConnected()&&this.log("error",()=>["view crashed",e]),this.liveSocket.isUnloaded()||this.displayError()}displayError(){this.isMain()&&f.dispatchEvent(window,`${U}:page-loading-start`,{detail:{to:this.href,kind:"error"}}),this.showLoader(),this.setContainerClasses(Ft,qi),this.execAll(this.binding("disconnected"))}pushWithReply(e,t,s,r=function(){}){if(!this.isConnected())return;let[n,[o],a]=e?e():[null,[],{}],l=function(){};return(a.page_loading||o&&o.getAttribute(this.binding(Wi))!==null)&&(l=this.liveSocket.withPageLoading({kind:"element",target:o})),typeof s.cid!="number"&&delete s.cid,this.liveSocket.wrapPush(this,{timeout:!0},()=>this.channel.push(t,s,hr).receive("ok",d=>{let v=p=>{d.redirect&&this.onRedirect(d.redirect),d.live_patch&&this.onLivePatch(d.live_patch),d.live_redirect&&this.onLiveRedirect(d.live_redirect),n!==null&&this.undoRefs(n),l(),r(d,p)};d.diff?this.liveSocket.requestDOMUpdate(()=>{this.applyDiff("update",d.diff,({diff:p,reply:_,events:y})=>{this.update(p,y),v(_)})}):v(null)}))}undoRefs(e){!this.isConnected()||f.all(document,`[${Ae}="${this.id}"][${he}="${e}"]`,t=>{let s=t.getAttribute(gt);t.removeAttribute(he),t.removeAttribute(Ae),t.getAttribute(Xt)!==null&&(t.readOnly=!1,t.removeAttribute(Xt)),s!==null&&(t.disabled=s==="true",t.removeAttribute(gt)),Nt.forEach(o=>f.removeClass(t,o));let r=t.getAttribute(_t);r!==null&&(t.innerText=r,t.removeAttribute(_t));let n=f.private(t,he);if(n){let o=this.triggerBeforeUpdateHook(t,n);Xe.patchEl(t,n,this.liveSocket.getActiveElement()),o&&o.__updated(),f.deletePrivate(t,he)}})}putRef(e,t,s={}){let r=this.ref++,n=this.binding(vt);return s.loading&&(e=e.concat(f.all(document,s.loading))),e.forEach(o=>{o.classList.add(`phx-${t}-loading`),o.setAttribute(he,r),o.setAttribute(Ae,this.el.id);let a=o.getAttribute(n);a!==null&&(o.getAttribute(_t)||o.setAttribute(_t,o.innerText),a!==""&&(o.innerText=a),o.setAttribute("disabled",""))}),[r,e,s]}componentID(e){let t=e.getAttribute&&e.getAttribute(Z);return t?parseInt(t):null}targetComponentID(e,t,s={}){if(ve(t))return t;let r=e.getAttribute(this.binding("target"));return ve(r)?parseInt(r):t&&(r!==null||s.target)?this.closestComponentID(t):null}closestComponentID(e){return ve(e)?e:e?de(e.closest(`[${Z}]`),:null}pushHookEvent(e,t,s,r){if(!this.isConnected())return this.log("hook",,!1;let[n,o,a]=this.putRef([],"hook");return this.pushWithReply(()=>[n,o,a],"event",{type:"hook",event:t,value:s,cid:this.closestComponentID(e)},,n}extractMeta(e,t,s){let r=this.binding("value-");for(let n=0;n<e.attributes.length;n++){t||(t={});let o=e.attributes[n].name;o.startsWith(r)&&(t[o.replace(r,"")]=e.getAttribute(o))}if(e.value!==void 0&&(t||(t={}),t.value=e.value,e.tagName==="INPUT"&&Bt.indexOf(e.type)>=0&&!e.checked&&delete t.value),s){t||(t={});for(let n in s)t[n]=s[n]}return t}pushEvent(e,t,s,r,n,o={}){this.pushWithReply(()=>this.putRef([t],e,o),"event",{type:e,event:r,value:this.extractMeta(t,n,o.value),cid:this.targetComponentID(t,s,o)})}pushFileProgress(e,t,s,r=function(){}){this.liveSocket.withinOwners(e.form,(n,o)=>{n.pushWithReply(null,"progress",{event:e.getAttribute(n.binding(nr)),ref:e.getAttribute(pe),entry_ref:t,progress:s,cid:n.targetComponentID(e.form,o)},r)})}pushInput(e,t,s,r,n,o){let a,l=ve(s)?s:this.targetComponentID(e.form,t),d=()=>this.putRef([e,e.form],"change",n),v;e.getAttribute(this.binding("change"))?v=Zt(e.form,{_target:n._target},[e.name]):v=Zt(e.form,{_target:n._target}),f.isUploadInput(e)&&e.files&&e.files.length>0&&B.trackFiles(e,Array.from(e.files)),a=B.serializeUploads(e);let p={type:"form",event:r,value:v,uploads:a,cid:l};this.pushWithReply(d,"event",p,_=>{if(f.showError(e,this.liveSocket.binding(mt)),f.isUploadInput(e)&&e.getAttribute("data-phx-auto-upload")!==null){if(B.filesAwaitingPreflight(e).length>0){let[y,w]=d();this.uploadFiles(e.form,t,y,l,C=>{o&&o(_),this.triggerAwaitingSubmit(e.form)})}}else o&&o(_)})}triggerAwaitingSubmit(e){let t=this.getScheduledSubmit(e);if(t){let[s,r,n,o]=t;this.cancelSubmit(e),o()}}getScheduledSubmit(e){return this.formSubmits.find(([t,s,r,n])=>t.isSameNode(e))}scheduleSubmit(e,t,s,r){if(this.getScheduledSubmit(e))return!0;this.formSubmits.push([e,t,s,r])}cancelSubmit(e){this.formSubmits=this.formSubmits.filter(([t,s,r])=>t.isSameNode(e)?(this.undoRefs(s),!1):!0)}disableForm(e,t={}){let s=p=>!(it(p,`${this.binding(bt)}=ignore`,p.form)||it(p,"data-phx-update=ignore",p.form)),r=p=>p.hasAttribute(this.binding(vt)),n=o=a=Array.from(e.elements),l=a.filter(r),d=a.filter(n).filter(s),v=a.filter(o).filter(s);return d.forEach(p=>{p.setAttribute(gt,p.disabled),p.disabled=!0}),v.forEach(p=>{p.setAttribute(Xt,p.readOnly),p.readOnly=!0,p.files&&(p.setAttribute(gt,p.disabled),p.disabled=!0)}),e.setAttribute(this.binding(Wi),""),this.putRef([e].concat(l).concat(d).concat(v),"submit",t)}pushFormSubmit(e,t,s,r,n){let o=()=>this.disableForm(e,r),a=this.targetComponentID(e,t);if(B.hasUploadsInProgress(e)){let[l,d]=o(),v=return this.scheduleSubmit(e,l,r,v)}else if(B.inputsAwaitingPreflight(e).length>0){let[l,d]=o(),v=this.uploadFiles(e,t,l,a,p=>{let _=Zt(e,{});this.pushWithReply(v,"event",{type:"form",event:s,value:_,cid:a},n)})}else{let l=Zt(e,{});this.pushWithReply(o,"event",{type:"form",event:s,value:l,cid:a},n)}}uploadFiles(e,t,s,r,n){let o=this.joinCount,a=B.activeFileInputs(e),l=a.length;a.forEach(d=>{let v=new B(d,this,()=>{l--,l===0&&n()});this.uploaders[d]=v;let p=v.entries().map(y=>y.toPreflightPayload()),_={ref:d.getAttribute(pe),entries:p,cid:this.targetComponentID(d.form,t)};this.log("upload",()=>["sending preflight request",_]),this.pushWithReply(null,"allow_upload",_,y=>{if(this.log("upload",,y.error){this.undoRefs(s);let[w,C]=y.error;this.log("upload",()=>[`error for entry ${w}`,C])}else{let w=C=>{this.channel.onError(()=>{this.joinCount===o&&C()})};v.initAdapterUpload(y,w,this.liveSocket)}})})}dispatchUploads(e,t){let s=f.findUploadInputs(this.el).filter(;s.length===0?q(`no live file inputs found matching the name "${e}"`):s.length>1?q(`duplicate live file inputs found matching the name "${e}"`):f.dispatchEvent(s[0],Ut,{detail:{files:t}})}pushFormRecovery(e,t,s){this.liveSocket.withinOwners(e,(r,n)=>{let o=e.elements[0],a=e.getAttribute(this.binding(Yi))||e.getAttribute(this.binding("change"));ue.exec("change",a,r,o,["push",{_target:o.name,newCid:t,callback:s}])})}pushLinkPatch(e,t,s){let r=this.liveSocket.setPendingLink(e),n=t?()=>this.putRef([t],"click"):null,o=a=this.pushWithReply(n,"live_patch",{url:e},l=>{this.liveSocket.requestDOMUpdate(()=>{l.link_redirect?this.liveSocket.replaceMain(e,null,s,r):(this.liveSocket.commitPendingLink(r)&&(this.href=e),this.applyPendingUpdates(),s&&s(r))})});a?a.receive("timeout",o):o()}formsForRecovery(e){if(this.joinCount===0)return[];let t=this.binding("change"),s=document.createElement("template");return s.innerHTML=e,f.all(this.el,`form[${t}]`).filter(.filter(.filter(r=>r.getAttribute(this.binding(Yi))!=="ignore").map(r=>{let n=s.content.querySelector(`form[id="${r.id}"][${t}="${r.getAttribute(t)}"]`);return n?[r,n,this.targetComponentID(n)]:[r,null,null]}).filter(([r,n,o])=>n)}maybePushComponentsDestroyed(e){let t=e.filter(s=>f.findComponentNodeList(this.el,s).length===0);t.length>0&&(this.pruningCIDs.push(...t),this.pushWithReply(null,"cids_will_destroy",{cids:t},()=>{this.pruningCIDs=this.pruningCIDs.filter(;let s=t.filter(r=>f.findComponentNodeList(this.el,r).length===0);s.length>0&&this.pushWithReply(null,"cids_destroyed",{cids:s},}))}ownsElement(e){return this.isDead||e.getAttribute(je)===this.id||de(e.closest(ke),t=>t.id)===this.id}submitForm(e,t,s,r={}){f.putPrivate(e,jt,!0);let n=this.liveSocket.binding(mt),o=Array.from(e.elements);this.liveSocket.blurActiveElement(this),this.pushFormSubmit(e,t,s,r,()=>{o.forEach(,navigator.userAgent.includes("Android")||this.liveSocket.restorePreviouslyActiveFocus()})};var Ct=class{constructor(e,t,s={}){if(this.unloaded=!1,!t||t.constructor.name==="Object")throw new Error(`
      a phoenix Socket must be provided as the second argument to the LiveSocket constructor. For example:

          import {Socket} from "phoenix"
          import {LiveSocket} from "phoenix_live_view"
          let liveSocket = new LiveSocket("/live", Socket, {...})
      `);this.socket=new t(e,s),this.bindingPrefix=s.bindingPrefix||lr,this.opts=s,this.params=qt(s.params||{}),this.viewLogger=s.viewLogger,this.metadataCallbacks=s.metadata||{},this.defaults=Object.assign(tt(cr),s.defaults||{}),this.activeElement=null,this.prevActive=null,this.silenced=!1,this.main=null,this.outgoingMainEl=null,this.clickStartedAtTarget=null,this.linkRef=1,this.roots={},this.href=window.location.href,this.pendingLink=null,this.currentLocation=tt(window.location),this.hooks=s.hooks||{},this.uploaders=s.uploaders||{},this.loaderTimeout=s.loaderTimeout||or,this.reloadWithJitterTimer=null,this.maxReloads=s.maxReloads||qs,this.reloadJitterMin=s.reloadJitterMin||zs,this.reloadJitterMax=s.reloadJitterMax||Ys,this.failsafeJitter=s.failsafeJitter||Gs,this.localStorage=s.localStorage||window.localStorage,this.sessionStorage=s.sessionStorage||window.sessionStorage,this.boundTopLevelEvents=!1,this.domCallbacks=Object.assign({onNodeAdded:qt(),onBeforeElUpdated:qt()},s.dom||{}),this.doofinderMount=s.doofinderMount,this.connectCallback=s.connectCallback||(()=>{}),this.disconnectCallback=s.disconnectCallback||(,this.unbindFunctions=[],this.transitions=new wr,window.addEventListener("pagehide",,this.socket.onOpen(()=>{this.isUnloaded()&&window.location.reload()}),this.socket.onOpen(()=>{this.connectCallback()})}isProfileEnabled(){return this.sessionStorage.getItem(Wt)==="true"}isDebugEnabled(){return this.sessionStorage.getItem(Et)==="true"}isDebugDisablednableDebug(){this.sessionStorage.setItem(Et,"true")}enableProfiling(){this.sessionStorage.setItem(Wt,"true")}isableProfiling(){this.sessionStorage.removeItem(Wt)}enableLatencySim(e){this.enableDebug(),console.log("latency simulator enabled for the duration of this browser session. Call disableLatencySim() to disable"),this.sessionStorage.setItem(Jt,e)}etLatencySim(){let e=this.sessionStorage.getItem(Jt);return e?parseInt(e):null}getSocket(){return this.socket}connect(){window.location.hostname==="localhost"&&!this.isDebugDisabled()&&this.enableDebug(),this.joinRootViews()&&(this.bindTopLevelEvents(),this.socket.connect())}disconnecteplaceTransport(e){clearTimeout(this.reloadWithJitterTimer),this.socket.replaceTransport(e),this.connect()}execJS(e,t,s=null){this.owner(e,}triggerDOM(e,t){this.domCallbacks[e](...t)}time(e,t){if(!this.isProfileEnabled()||!console.time)return t();console.time(e);let s=t();return console.timeEnd(e),s}log(e,t,s){if(this.viewLogger){let[r,n]=s();this.viewLogger(e,t,r,n)}else if(this.isDebugEnabled()){let[r,n]=s();fr(e,t,r,n)}}requestDOMUpdate(e){this.transitions.after(e)}transition(e,t,s=function(){}){this.transitions.addTransition(e,t,s)}onChannel(e,t,s){e.on(t,r=>{let n=this.getLatencySim();n?setTimeout(n):s(r)})}wrapPush(e,t,s){let r=this.getLatencySim(),n=e.joinCount;if(!r)return this.isConnected()&&t.timeout?s().receive("timeout",()=>{e.joinCount===n&&!e.isDestroyed()&&this.reloadWithJitter(e,()=>{this.log(e,"timeout",})}):s();let o={receives:[],receive;return setTimeout(()=>{e.isDestroyed()||o.receives.reduce(s())},r),o}reloadWithJitter(e,t){clearTimeout(this.reloadWithJitterTimer),this.disconnect();let s=this.reloadJitterMin,r=this.reloadJitterMax,n=Math.floor(Math.random()*(r-s+1))+s;we.updateLocal(this.localStorage,window.location.pathname,Mt,0,>this.maxReloads&&(n=this.failsafeJitter),this.reloadWithJitterTimer=setTimeout(n)}getHookCallbacks(e){return e&&e.startsWith("Phoenix.")?vr[e.split(".")[1]]:this.hooks[e]}isUnloaded(){return this.unloaded}isConnected(){return this.socket.isConnected()}getBindingPrefix(){return this.bindingPrefix}inRootViews(){if(this.doofinderMount){let e=this.newRootView(this.doofinderMount);return e.setHref(this.getHref()),e.join(),this.main=e,!0}else return!1}redirect(e,t){this.disconnect(this.disconnectCallback),we.redirect(e,t)}replaceMain(e,t,s=null,r=this.setPendingLink(e)){let n=this.currentLocation.href;this.outgoingMainEl=this.outgoingMainEl||this.main.el;let o=f.cloneNode(this.outgoingMainEl,"");this.main.showLoader(this.loaderTimeout),this.main.destroy(),this.main=this.newRootView(o,t,n),this.main.setRedirect(e),this.transitionRemoves(),this.main.join((a,l)=>{a===1&&this.commitPendingLink(r)&&this.requestDOMUpdate(()=>{f.findPhxSticky(document).forEach(d=>o.appendChild(d)),this.outgoingMainEl.replaceWith(o),this.outgoingMainEl=null,s&&requestAnimationFrame(s),l()})})}transitionRemoves(e){let t=this.binding("remove");e=e||f.all(document,`[${t}]`),e.forEach(s=>{document.body.contains(s)&&this.execJS(s,s.getAttribute(t),"remove")})}isPhxView(e){return e.getAttribute&&e.getAttribute(ce)!==null}newRootView(e,t,s){let r=new nt(e,this,null,t,s);return this.roots[r.id]=r,r}owner(e,t){let s=de(e.closest(ke),||this.main;s&&t(s)}withinOwners(e,t){this.owner(e,}getViewByEl(e){let t=e.getAttribute(xe);return de(this.getRootById(t),}getRootById(e){return this.roots[e]}destroyAllViews(){for(let e in this.roots)this.roots[e].destroy(),delete this.roots[e];this.main=null}destroyViewByEl(e){let t=this.getRootById(e.getAttribute(xe));t&&t.id===e.id?(t.destroy(),delete this.roots[t.id]):t&&t.destroyDescendent(e.id)}setActiveElement(e){if(this.activeElement===e)return;this.activeElement=e;let t=()=>{e===this.activeElement&&(this.activeElement=null),e.removeEventListener("mouseup",this),e.removeEventListener("touchend",this)};e.addEventListener("mouseup",t),e.addEventListener("touchend",t)}getActiveElement(){return document.activeElement===document.body?this.activeElement||document.activeElement:document.activeElement||document.body}dropActiveElement(e){this.prevActive&&e.ownsElement(this.prevActive)&&(this.prevActive=null)}restorePreviouslyActiveFocus(){this.prevActive&&this.prevActive!==document.body&&this.prevActive.focus()}blurActiveElement(){this.prevActive=this.getActiveElement(),this.prevActive!==document.body&&this.prevActive.blur()}bindTopLevelEvents({dead:e}={}){this.boundTopLevelEvents||(this.boundTopLevelEvents=!0,this.socket.onClose(t=>{t&&t.code===1e3&&this.main&&this.reloadWithJitter(this.main)}),this.unbindFunctions.push((()=>{let t=return document.body.addEventListener("click",t),)()),window.addEventListener("pageshow",t=>{t.persisted&&(this.getSocket().disconnect(),this.withPageLoading({to:window.location.href,kind:"redirect"}),window.location.reload())},!0),this.bindClicks(),e||this.bindForms(),this.bind({keyup:"keyup",keydown:"keydown"},(t,s,r,n,o,a)=>{let l=n.getAttribute(this.binding(rr)),d=t.key&&t.key.toLowerCase();if(l&&l.toLowerCase()!==d)return;let v=W({key:t.key},this.eventMeta(s,t,n));ue.exec(s,o,r,n,["push",{data:v}])}),this.bind({blur:"focusout",focus:"focusin"},(t,s,r,n,o,a)=>{if(!a){let l=W({key:t.key},this.eventMeta(s,t,n));ue.exec(s,o,r,n,["push",{data:l}])}}),this.bind({blur:"blur",focus:"focus"},(t,s,r,n,o,a,l)=>{if(l==="window"){let d=this.eventMeta(s,t,n);ue.exec(s,a,r,n,["push",{data:d}])}}),this.unbindFunctions.push((()=>{let t=return this.doofinderMount.addEventListener("dragover",t),()=>this.doofinderMount.removeEventListener("dragover",t)})()),this.unbindFunctions.push((()=>{let t=s=>{s.preventDefault();let r=de(it(s.target,this.binding(ji)),,n=r&&document.getElementById(r),o=Array.from(s.dataTransfer.files||[]);!n||n.disabled||o.length===0||!(n.files instanceof FileList)||(B.trackFiles(n,o),n.dispatchEvent(new Event("input",{bubbles:!0})))};return this.doofinderMount.addEventListener("drop",t),()=>this.doofinderMount.removeEventListener("drop",t)})()),this.on(Ut,t=>{let s=t.target;if(!f.isUploadInput(s))return;let r=Array.from(t.detail.files||[]).filter(;B.trackFiles(s,r),s.dispatchEvent(new Event("input",{bubbles:!0}))},this.doofinderMount))}unbindTopLevelEvents(){this.unbindFunctions.forEach(e=>e()),this.unbindFunctions=[]}eventMeta(e,t,s){let r=this.metadataCallbacks[e];return r?r(t,s):{}}setPendingLink(e){return this.linkRef++,this.pendingLink=e,this.linkRef}commitPendingLink(e){return this.linkRef!==e?!1:(this.href=this.pendingLink,this.pendingLink=null,!0)}getHref(){return this.href}ind(e,t){for(let s in e){let r=e[s];this.on(r,n=>{let o=this.binding(s),a=this.binding(`window-${s}`),l=n.target.getAttribute&&n.target.getAttribute(o);l?this.debounce(n.target,n,r,()=>{this.withinOwners(n.target,d=>{t(n,s,d,n.target,l,null)})}):f.all(document,`[${a}]`,d=>{let v=d.getAttribute(a);this.debounce(d,n,r,()=>{this.withinOwners(d,p=>{t(n,s,p,d,v,"window")})})})},this.doofinderMount)}}bindClicks(){let e=this.doofinderMount.addEventListener("click",e),this.unbindFunctions.push(,this.bindClick("click","click",!1),this.bindClick("mousedown","capture-click",!0)}bindClick(e,t,s){let r=this.binding(t),n=o=>{if(!this.isConnected())return;let a=null;if(s)a=o.target.matches(`[${r}]`)?o.target:o.target.querySelector(`[${r}]`);else{let d=this.clickStartedAtTarget||o.target;a=it(d,r),this.dispatchClickAway(o,d),this.clickStartedAtTarget=null}let l=a&&a.getAttribute(r);!l||(a.getAttribute("href")==="#"&&o.preventDefault(),!a.disabled&&this.debounce(a,o,"click",()=>{this.withinOwners(a,d=>{ue.exec("click",l,d,a,["push",{data:this.eventMeta("click",o,a)}])})}))};this.doofinderMount.addEventListener(e,n,s),this.unbindFunctions.push(}dispatchClickAway(e,t){let s=this.binding("click-away");f.all(document,`[${s}]`,r=>{r.isSameNode(t)||r.contains(t)||this.withinOwners(e.target,n=>{let o=r.getAttribute(s);ue.isVisible(r)&&ue.exec("click",o,n,r,["push",{data:this.eventMeta("click",e,e.target)}])})})}dispatchEvent(e,t={}){f.dispatchEvent(this.doofinderMount,`${U}:${e}`,{detail:t})}dispatchEvents(e){e.forEach(}withPageLoading(e,t){f.dispatchEvent(this.doofinderMount,`${U}:page-loading-start`,{detail:e});let s=()=>f.dispatchEvent(this.doofinderMount,`${U}:page-loading-stop`,{detail:e});return t?t(s):s}pushHistoryPatch(e,t,s){if(!this.isConnected())return we.redirect(e);this.withPageLoading({to:e,kind:"patch"},r=>{this.main.pushLinkPatch(e,s,n=>{this.historyPatch(e,t,n),r()})})}historyPatch(e,t,s=this.setPendingLink(e)){!this.commitPendingLink(s)||(we.pushState(t,{type:"patch",id:this.main.id},e),this.registerNewLocation(window.location))}historyRedirect(e,t,s){if(!this.isConnected())return we.redirect(e,s);if(/^\/[^\/]+.*$/.test(e)){let{protocol:n,host:o}=window.location;e=`${n}//${o}${e}`}let r=window.scrollY;this.withPageLoading({to:e,kind:"redirect"},n=>{this.replaceMain(e,s,()=>{we.pushState(t,{type:"redirect",id:this.main.id,scroll:r},e),this.registerNewLocation(window.location),n()})})}replaceRootHistory(){we.pushState("replace",{root:!0,type:"patch",id:this.main.id})}registerNewLocation(e){let{pathname:t,search:s}=this.currentLocation;return t+s===e.pathname+e.search?!1:(this.currentLocation=tt(e),!0)}bindForms(){let e=0,t=!1;this.on("submit",s=>{let r=s.target.getAttribute(this.binding("submit")),n=s.target.getAttribute(this.binding("change"));!t&&n&&!r&&(t=!0,s.preventDefault(),s.stopPropagation(),this.withinOwners(s.target,o=>{o.disableForm(s.target),window.requestAnimationFrame(}))},this.doofinderMount),this.on("submit",s=>{let r=s.target.getAttribute(this.binding("submit"));!r||(s.preventDefault(),s.stopPropagation(),s.target.disabled=!0,this.withinOwners(s.target,n=>{ue.exec("submit",r,n,s.target,["push",{}])}))},this.doofinderMount);for(let s of["change","input"])this.on(s,r=>{r.stopPropagation();let n=this.binding("change"),o=r.target,a=o.getAttribute(n),l=o.form&&o.form.getAttribute(n),d=a||l;if(!d||o.type==="number"&&o.validity&&o.validity.badInput)return;let v=a?o:o.form,p=e;e++;let{at:_,type:y}=f.private(o,"prev-iteration")||{};_===p-1&&s!==y||(f.putPrivate(o,"prev-iteration",{at:p,type:s}),this.debounce(o,r,s,()=>{this.withinOwners(v,w=>{f.putPrivate(o,$t,!0),f.isTextualInput(o)||this.setActiveElement(o),ue.exec("change",d,w,o,["push",{_target:r.target.name,dispatcher:v}])})}))},this.doofinderMount)}debounce(e,t,s,r){if(s==="blur"||s==="focusout")return r();let n=this.binding(ir),o=this.binding(sr),a=this.defaults.debounce.toString(),l=this.defaults.throttle.toString();this.withinOwners(e,d=>{let v=()=>!d.isDestroyed()&&document.body.contains(e);f.debounce(e,t,n,a,o,l,v,})}n(e,t,s=window){let r=s.addEventListener(e,r),this.unbindFunctions.push(}},wr=class{constructor(){this.transitions=new Set,this.pendingOps=[],this.reset()}reset(){this.transitions.forEach(,this.flushPendingOps()}after(e){this.size()===0?e():this.pushPendingOp(e)}addTransition(e,t,s){t();let r=setTimeout(()=>{this.transitions.delete(r),s(),this.size()===0&&this.flushPendingOps()},e);this.transitions.add(r)}ar ei=class{et data(){return JSON.parse(this._store.getItem(this._bucket))||{}}tItem(e,t){let s=this.data;s[e]=t,this.data=s}removeItem(e){let t=this.data;delete t[e],this.data=t}estroy(){this._store.removeItem(this._bucket)}popItem(e){let t=this.data,s=t[e];return delete t[e],this.data=t,s}};var os="dfd-animate",as="dfd-fixed-layout",Pe="hidden",ti="floating",ii="fullscreen",We="static";function si(i){let e=["left","top","right","bottom","width","height","scrollLeft","scrollTop","scrollWidth","scrollHeight"],t=e.reduce({}),s=i;if(s===window)t=Ce(W({},t),{width:s.outerWidth,height:s.outerHeight,clientWidth:s.innerWidth,clientHeight:s.innerHeight,scrollLeft:s.scrollX,scrollTop:s.scrollY,scrollWidth:document.scrollWidth,scrollHeight:document.scrollHeight});else{if(s===document)s=document.documentElement,t=Ce(W({},t),{width:s.offsetWidth,height:s.offsetHeight});else if(s.getBoundingClientRect){let r=s.getBoundingClientRect();t=e.reduce({})}t=Ce(W({},t),{clientWidth:s.clientWidth,clientHeight:s.clientHeight,scrollLeft:s.scrollLeft,scrollTop:s.scrollTop,scrollWidth:s.scrollWidth,scrollHeight:s.scrollHeight})}return t}function Cr(i){let e=i;for(;e&&getComputedStyle(e).position!=="fixed";)e=e.offsetParent;return!!e}"use strict";var ls=class{constructor(e,t={}){this.options=W({align:t.align,offsetX:0,offsetY:4,marginY:20,marginX:20,fillViewPortWidth:768},t),this.element=e}__origin__(e){let t=si(e),s=si(document),r=s.width<=this.options.fillViewPortWidth,n={width:t.width,top:t.top+t.height,left:t.left,fixed:Cr(e),align:function(){let o=Math.abs(t.left)*100/s.width,a=Math.abs(s.clientWidth-t.right)*100/s.width;switch(!0){case r:case Math.abs(o-a)<=15:return"center";case o<a:return"left";default:return"right"}}(),fillViewPort:r};return n.fixed||(n.top+=Math.abs(s.scrollTop),n.left+=Math.abs(s.scrollLeft)),n}update(e){let t=this.__origin__(e),s=document.documentElement,r=this.options.align||t.align,n=s.clientHeight-t.top-this.options.marginY,o=this.options.offsetX,a=this.options.offsetY;if(this.element.style.maxWidth=null,this.element.style.height=null,r!=="center"&&(this.element.style.marginLeft=null),this.element.style.position=t.fixed?"fixed":"absolute",r==="left"){let l=s.clientWidth-t.left-this.options.marginX,d=t.left;this.element.style.maxWidth=`${l-o}px`,this.element.style.left=`${d+o}px`,this.element.style.right=null}else if(r==="right"){let l=t.left+t.width-this.options.marginX+o,d=s.clientWidth-t.left-t.width;this.element.style.maxWidth=`${l+o}px`,this.element.style.right=`${d-o}px`,this.element.style.left=null}else{let l=s.clientWidth-t.left-t.width,d=Math.min(this.options.marginX,t.left,l);this.element.style.maxWidth=`${s.clientWidth-2*d}px`,this.element.style.left="50%",this.element.style.marginLeft=`-${si(this.element).width/2}px`}this.element.style.top=`${t.top+a}px`,this.element.style.height=`${n-a}px`}destroy(){["position","top","left","right","height","maxWidth","marginLeft"].forEach(,this.options=null,this.element=null}};function ri(i,e=66,t=!1){let s;return function(...r){s?Date.now()-s>=e?(i(...r),s=Date.now()):t&&console.log("throttle: discard execution"):(i(...r),s=Date.now())}}var Je=class{_animate__(){return new Promise(e=>{setTimeout(()=>{this.mount.classList.add(os),e()},10)})}get positionReference(){return this._positionReference}show(){return I(this,null,function*(){let e=this.hidden();return e&&(this.mount.removeAttribute(Pe),yield this.__animate__()),e})}hide(){return I(this,null,function*(){let e=!this.hidden();return e&&(this.mount.setAttribute(Pe,""),this.mount.classList.remove(os),this.mount.innerHTML=""),e})}updatePosition(e){return I(this,null,}var hs=class extends Je{constructor(e,t={}){super(e);this.handleWindowChange=ri(this.handleWindowChange.bind(this)),this._position=new ls(this.mount,t)}t position(){return this._position}how(){var e=t=>super[t];return I(this,null,function*(){let s=this.hidden();return s&&(this.mount.style.opacity="0",this.mount.removeAttribute(Pe)),this._position.update(this._positionReference),s&&(this.mount.setAttribute(Pe,""),this.mount.style.opacity=null,yield e("show").call(this),this.__addListeners__()),s})}hide(){var e=t=>super[t];return I(this,null,function*(){let s=!this.hidden();return s&&(this.__removeListeners__(),yield e("hide").call(this)),s})}updatePosition(e){var t=s=>super[s];return I(this,null,function*(){t("updatePosition").call(this,e),this._position.update(this._positionReference)})}destroy(){this.__removeListeners__(),this._position.destroy(),this._position=null,super.destroy()}};var cs=class extends Je{show(){var e=t=>super[t];return I(this,null,function*(){let s=this.hidden();return s&&(document.documentElement.classList.add(as),yield e("show").call(this)),s})}hide(){var e=t=>super[t];return I(this,null,function*(){let s=yield e("hide").call(this);return s&&document.documentElement.classList.remove(as),s})}};function ni(i=8){let e="";for(;e.length<i;)e=`${e}${Math.random().toString(36).substring(2)}`;return e.substr(0,i)}var fo=10,po=500;function ds(i,e={}){let t=document.querySelector(i);return t?Promise.resolve(t):new Promise((s,r)=>{let n=0,o=null,a=e.interval||po,l=e.times||fo;o=setInterval(function(){n++<l?(t=document.querySelector(i),t&&(clearInterval(o),s(t))):(clearInterval(o),r(`selector '${i}' not found`))},a)})}var us="data-dfd-id",oi="data-dfd-display",ai="data-dfd-mount-id",li="wrapper",hi="wrapper-source",mo=`insertion method should be one of ${["append","prepend","before","after","replace","replace-content"].join(" | ")}`,fs=class{constructor(e,t=We,s={}){this._type=null,this._insertionPoint=null,this._insertionMethod=null,this._screenType=null,this._theme=null,this._mount=e,this._displayMethod=null,this.setType(t,s)}__place__(){return I(this,arguments,function*(e={}){if(!(e.insertionPoint===this._insertionPoint&&e.insertionMethod===this._insertionMethod)){this._insertionPoint=e.insertionPoint||"body",this._insertionMethod=this.__resolveInsertionMethod__(e.insertionMethod);try{this.__placeMount__()}catch(t){console.warn("insertion point not found, falling back to body",t),this._insertionPoint="body",this._insertionMethod="append",this.__placeMount__()}}})}__resolveInsertionMethod__(e="append"){return this._insertionPoint==="body"&&!["append","prepend"].includes(e)?"append":e}__resolveInsertionPoint__(){return I(this,null,function*(){let e=yield ds(this._insertionPoint);return this._insertionMethod==="replace"?this.__wrapMount__(e):(this.__unwrapMount__(),e)})}__resolveInsertionPosition__(){switch(this._insertionMethod){case"before":return"beforebegin";case"replace":case"replace-content":case"prepend":return"afterbegin";case"append":return"beforeend";case"after":return"afterend";default:throw mo}}__placeMount__(){return I(this,null,function*(){let e=yield this.__resolveInsertionPoint__(),t=this.__resolveInsertionPosition__();this._insertionMethod==="replace-content"&&(e.innerHTML=""),e.insertAdjacentElement(t,this._mount)})}__getWrapperElement__(e){return document.querySelector(`[${oi}="${e}"][${ai}="${this._mount.id}"]`)}__ensureElementId__(e){return e.setAttribute("id",e.getAttribute("id")||`dfd-${ni(16)}`),e.getAttribute("id")}__wrapMount__(e){let t=this.__ensureElementId__(e),s=e.cloneNode(!1);return s.setAttribute(us,t),s.setAttribute(oi,li),s.setAttribute(ai,this._mount.id),e.setAttribute(us,t),e.setAttribute(oi,hi),e.setAttribute(ai,this._mount.id),e.insertAdjacentElement("beforebegin",s),this.__updateWrap__(),s}__unwrapMount__(){let e=this.__getWrapperElement__(li),t=this.__getWrapperElement__(hi);e&&(e.insertAdjacentElement("beforebegin",this._mount),e.remove(),t&&(t.setAttribute("id",t.dataset.dfdId),t.removeAttribute(us),t.removeAttribute(oi),t.removeAttribute(ai),t.removeAttribute("hidden")))}__updateWrap__(){let e=this.__getWrapperElement__(this.hidden?hi:li),t=this.__getWrapperElement__(this.hidden?li:hi);!e||!t||(e.setAttribute("id",e.dataset.dfdId),e.removeAttribute("hidden"),t.removeAttribute("id"),t.setAttribute("hidden",""))}get type(){return this._type}get method(){return this._displayMethod}w(){return I(this,null,function*(){yield this._displayMethod.show(),this.__updateWrap__()})}hide(){return I(this,null,}setType(e,t={}){var s;if(e!==this._type)switch(this._type=e,(s=this._displayMethod)==null||s.destroy(),e){case ti:this._displayMethod=new hs(this._mount,{align:t.align});break;case ii:this._displayMethod=new cs(this._mount);break;case We:default:this._displayMethod=new Je(this._mount)}this.__place__(t.placement)}updateTheme(e){if(e!==this._theme){let t=`dfd-${e}`,s=`dfd-${this._theme}`;e&&this._theme?this._mount.classList.replace(s,t):e?this._mount.classList.add(t):this._theme&&this._mount.classList.remove(s),this._theme=e}}updatePosition(e){var t;(t=this._displayMethod)==null||t.updatePosition(e)}destroy(){return I(this,null,function*(){var e;yield this.hide(),(e=this._displayMethod)==null||e.destroy(),this._displayMethod=null,this._mount=null,this._type=null,this._insertionPoint=null,this._insertionMethod=null,this._theme=null})}};var ps=class{constructor(e){this.el=document.createComment(e),document.body.appendChild(this.el)}on(e,t){if(this._checkReady())return this.el.addEventListener(e,t,{passive:!0}),()=>this.off(e,t)}once(e,t){if(this._checkReady())return this.el.addEventListener(e,t,{once:!0,passive:!0}),mit(e,t){if(this._checkReady()){let s=new CustomEvent(e,{detail:t,bubbles:!1,cancelable:!1,composed:!1});this.el.dispatchEvent(s)}}teardown(){this._checkReady()&&(this.el=this.el.remove())}_checkReady(){if(this.el)return!0;throw new Error("tried to access a dead event bus!")}};var Tr=var ms="__DF_DEBUG_MODE__",Ar="true",ci=window.sessionStorage;tion j(...i){go()&&console.log("[doofinder]",...i)}"use strict";var di=window.history,ui=class{constructor({installationId:e,autoload:t,urlHash:s}){this._installationId=e,this._autoload=t?Object.freeze(t):null,this._urlHash=s,this._initialState=null,this._currentState=null}getQueryParamValue(){return this._autoload?new URLSearchParams(window.location.search).get(this._autoload.param):null}et(e=!1){return this.__fromHash__()||this.__fromQuery__()||this.__fromURL__()||this.__fromCurrentState__(e)}static getQuery(e){if(e){let t=e.split("/"),s=t[t.length-1];return Object.fromEntries(new URLSearchParams(s)).q}return""}replace(e){j("[state] replace state:",e),e=this.absoluteURL(e),this._currentState=e,di.replaceState(e,"",this._urlHash?e:"")}save(e){j("[state] save state:",e),e=this.absoluteURL(e),this._currentState=e;let t=di.state;e!==t&&(this.valid(t)||(this._initialState=t),di.pushState(e,"",this._urlHash?e:""))}saveAbsoluteURL(){let e=this.absoluteURL("");j("[state] saveAbsoluteURL state",e),di.pushState(e,"",this._urlHash?e:"")}absoluteURLalid(e){return typeof e=="string"&&(Tr(this._installationId).test(e)||e.startsWith(`#/${this._installationId}/`))}validEvent({state:e}){let t=this.valid(e);switch(!0){case(this._initialState===null&&!t):case this._initialState===e:case(this._initialState&&e&&this._initialState.toString()===e.toString()):return!1;default:return t}}__fromHash__(){let e=this.valid(window.location.hash)?`#${window.location.hash.split("#",2)[1]}`:null;return j("[state] __fromHash__ state:",e),e}__fromQuery__(){if(!this._autoload){j("[state] __fromQuery__ with autoload false - state:",null);return}let e=this.getQueryParamValue(),t=e!=null?`#/${this._autoload.screen}/q=${e.trim()}`:null;return j("[state] __fromQuery__ state:",t),t}__fromURL__(){if(!this._autoload){j("[state] __fromURL__ with autoload false - state:",null);return}let t=this._autoload.urls.find(s=>location.pathname.search(s)===0)?`#/${this._autoload.screen}/`:null;return j("[state] __fromURL__ state:",t),t}__fromCurrentState__(e){return e?(j("[state] __fromCurrentState__ with isTransient true - state:",this._currentState),this._currentState):(j("[state] __fromCurrentState__ with isTransient false - state:",null),null)}};var gs="df:trigger:click",Tt="df:trigger:focus",At="df:trigger:input",vs="df:trigger:submit";var fi=1;"use strict";var vo="[dfd-carousel-btn-left]",_o="[dfd-carousel-btn-right]",Lr="[dfd-carousel-content]",pi="ltr",Rr={mounted(){this.btnLeftEl=this.el.querySelector(vo),this.btnRightEl=this.el.querySelector(_o),this.contentEl=this.el.querySelector(Lr),getComputedStyle(this.contentEl).direction==="rtl"&&(pi="rtl"),this.getVisibleChildren=()=>{let i=this.contentEl.getBoundingClientRect();return Array.from(this.contentEl.children).filter(e=>{let t=e.getBoundingClientRect();return i.left<=t.left&&i.right>=t.right})},this.nextPage=()=>{let i=this.getVisibleChildren();if(i.length<=0)return;let e=i.slice(-1).pop(),t=e.nextElementSibling;if(!t)return;let s=this.contentEl.getBoundingClientRect(),r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),o=r.width,a=t?n.x-r.x-r.width:0,l;pi==="ltr"?l=this.contentEl.scrollLeft+(r.x-s.x):l=this.contentEl.scrollLeft-(r.x+s.x),this.contentEl.scroll({left:l+o+a/2,behavior:"smooth"})},this.previousPage=()=>{let i=this.getVisibleChildren();if(i.length<=0)return;let e=i[0],t=e.previousElementSibling;if(!t)return;let s=this.contentEl.getBoundingClientRect(),r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),o=n.width-(s.x-n.x),a=t?r.x-n.x-n.width:0,l;pi==="ltr"?l=this.contentEl.scrollLeft-s.width:l=this.contentEl.scrollLeft+s.width,this.contentEl.scroll({left:l+o+a/2,behavior:"smooth"})},this.btnLeftEl.addEventListener("click",this.previousPage),this.btnRightEl.addEventListener("click",this.nextPage)},updated(){this.contentEl=this.el.querySelector(Lr),getComputedStyle(this.contentEl).direction==="rtl"&&(pi="rtl")},destroyed;var mi=240;unction Ir(i){return I(this,null,function*(){if(!bo(i))throw"invalid image, can't search";let e=yield Dr(i),t=yield Eo(e);return yield Dr(t)})}function Dr(i){return new Promise(function(e,t){let s=new FileReader;s.onload=function(){e(s.result)},s.onerror=s.readAsDataURL(i)})}function Eo(i){return new Promise(function(e,t){let s=new Image;s.onload=function(){let r=document.createElement("canvas");r.width=mi,r.height=mi,r.getContext("2d").drawImage(s,0,0,mi,mi),r.toBlob("image/jpeg")},s.onerror=s.src=i})}var Hr={mounted(){this.search=i=>I(this,null,function*(){this.el.dataset.status="loading";let e=yield Ir(i);this.pushEvent("search",{search:{image:e}})}),this.el.addEventListener("change",i=>this.search(i.target.files[0]))}};function _s(i){setTimeout(()=>{i.focus(),i.selectionStart=i.selectionEnd=i.value.length},0)}"use strict";var Or={mounted(){this.search=i=>{let e=this.el.dataset.dfdAction||"search";this.pushEvent(e,{search:{query:i}})},this.handleEvent("set-input-focus",,this.handleEvent("unset-input-focus",,this.el.addEventListener("input",,this.el.addEventListener("keydown",i=>{let e=this.el.getAttribute("dfd-value-suggestion");i.key==="Tab"&&e&&e!==this.el.value&&(this.el.value=e,_s(this.el),this.search(e))})}};use strict";var gi="doofinder.cart.add.click",So="doofinder.cart.add",vi="doofinder.cart.hide.price",_i="doofinder.cart.display.price",bs="dfd-btn-loading",Mr="dfd-btn-done",Nr="dfd-btn-error";function Ur(i){i.addToCartResolveTimeout=3e3,i.addToCartRejectTimeout=5e3,i.addToCartButtonFeedback=function(t,s){let r=yo.bind(null,t,s),n=To.bind(null,t,t.innerHTML),o=wo.bind(null,t,n),a=Co.bind(null,t,n);r().then(o,a)},i.handleCartAddClick=t=>{let s=t.detail.target?document.getElementById(t.detail.target.id):t.target,r=new Be({resolveTimeout:i.addToCartResolveTimeout,rejectTimeout:i.addToCartRejectTimeout});r.then(n=>{i.pushEvent("add-to-cart",{item:t.detail.item,dfid:t.detail.dfid},()=>{typeof n=="function"&&n()}),i.pushEvent("close-add-to-cart-button",{item:t.detail.item,dfid:t.detail.dfid})},n=>{typeof n=="function"&&n(),i.pushEvent("close-add-to-cart-button",{item:t.detail.item,dfid:t.detail.dfid})}),setTimeout(()=>i.tag.dispatch(So,Ce(W({},t.detail.item),{statusPromise:r})),1e3),i.addToCartButtonFeedback&&i.addToCartButtonFeedback(s,r)},i.handleHidePrice=t=>{let s=t.detail.target?document.getElementById(t.detail.target.id):t.target;s.closest(".dfd-card-row").querySelector(".dfd-card-pricing").style.display="none"},i.handleDisplayPrice=t=>{let s=t.detail.target?document.getElementById(t.detail.target.id):t.target;s.closest(".dfd-card-row").querySelector(".dfd-card-pricing").style.display="flex"};let e=!!i.tag&&!!i.tag.dom?i.tag.dom.mount:i.tag.mount;e.addEventListener(gi,i.handleCartAddClick),e.addEventListener(Ke(gi),i.handleCartAddClick),e.addEventListener(vi,i.handleHidePrice),e.addEventListener(Ke(vi),i.handleHidePrice),e.addEventListener(_i,i.handleDisplayPrice),e.addEventListener(Ke(_i),i.handleDisplayPrice)}function Fr(i){let e=!!i.tag&&!!i.tag.dom?i.tag.dom.mount:i.tag.mount;e.removeEventListener(gi,i.handleCartAddClick),e.removeEventListener(Ke(gi),i.handleCartAddClick),e.removeEventListener(vi,i.handleHidePrice),e.removeEventListener(Ke(vi),i.handleHidePrice),e.removeEventListener(_i,i.handleDisplayPrice),e.removeEventListener(Ke(_i),i.handleDisplayPrice)}function yo(i,e){return i.setAttribute("disabled",""),i.setAttribute("dfd-update","ignore"),i.innerHTML="",i.classList.add(bs),e}function wo(i,e){i.classList.remove(bs),i.classList.add(Mr),setTimeout(e,1e3)}function Co(i,e){i.classList.remove(bs),i.classList.add(Nr),setTimeout(e,2e3)}function To(i,e){i.classList.remove(Mr),i.classList.remove(Nr),i.innerHTML=e,i.removeAttribute("dfd-update"),i.removeAttribute("disabled")}"use strict";var Vr={mounted(){this.close=this.handleEvent("history-go",,this.handleEvent("close",()=>{let i=this.tag.searchQueryRetention?this.tag.state.get():"";this.tag.updateQuery(i),this.tag.disconnect()}),this.handleEvent("save-state",({state:i})=>{this.tag.state.save(i)}),this.handleEvent("replace-state",,this.handleEvent("disconnect",i=>{i.errors.forEach(,this.tag.destroy()}),this.handleEvent("load",i=>{this.tag.onLoad(i),this.pushEvent("ready")}),this.handleEvent("click-suggestion",i=>I(this,null,function*(){var e;this.tag.trigger.updateQuery((e=i==null?void 0:i.search)==null?void 0:e.query)})),this.handleEvent("search",,this.handleEvent("update-latest-searches",,this.el.addEventListener("contextmenu",i=>{let e=i.target.closest('[dfd-click="item-click"]');if(e){let t=e.getAttribute("dfd-value-link"),s=e.getAttribute("dfd-value-dfid");this.pushEvent("item-click",{link:t,dfid:s},}}),this.el.addEventListener("error",({target:i})=>{if(i.tagName!=="IMG")return;let e=i.closest('[data-dfd-role="card-thumbnail"]');setTimeout(()=>{e==null||e.parentElement.setAttribute("dfd-update","ignore"),e==null||e.classList.add("dfd-card-thumbnail-404")},1)},!0),this.applyOperationBySelector=function(i,e){if(i.startsWith("#")){let t=getElementById(i);e(t)}else this.el.querySelectorAll(i).forEach(},this.handleEvent("dom:add-class",({target:i,newClass:e})=>{this.applyOperationBySelector(i.selector,t=>t==null?void 0:t.classList.add(e))}),this.handleEvent("dom:remove-class",({target:i,oldClass:e})=>{this.applyOperationBySelector(i.selector,t=>t==null?void 0:t.classList.remove(e))}),this.handleEvent("dom:add-attribute",({target:i,name:e,value:t})=>{this.applyOperationBySelector(i.selector,s=>s==null?void 0:s.setAttribute(e,t))}),this.handleEvent("dom:remove-attribute",({target:i,name:e})=>{this.applyOperationBySelector(i.selector,}),this.handleEvent("redirection:update",({redirection:i})=>{this.tag.trigger.redirection=i}),Ur(this)},destroyed;var $r=Object.freeze({Linear:EaseInQuad:EaseOutQuad:EaseInOutQuad:EaseInCubic:EaseOutCubic:EaseInOutCubic:EaseInQuart:EaseOutQuart:EaseInOutQuart:EaseInQuint:EaseOutQuint:EaseInOutQuint:);function Br(i,e,t,s,r=$r.EaseInQuint){let n=Date.now(),o=e[i];return new Promise((a,l)=>{function d(){let v=Date.now(),p=Math.min(1,(v-n)/s),_=r(p);e[i]=o+_*(t-o),p<1?requestAnimationFrame(d):a()}o===t?a():requestAnimationFrame(d)})}var jr=Br.bind(null,"scrollTop"),Vh=Br.bind(null,"scrollLeft");function Ao(i){let e=i.scrollHeight>i.clientHeight,s=window.getComputedStyle(i).overflowY.indexOf("hidden")!==-1;return e&&!s}function Es(i){return!i||i===document.documentElement?document.documentElement:Ao(i)?i:Es(i.parentNode)}function Xr(i,e){return typeof i!="undefined"?i:e}var bi=class{constructor(e,t,s={}){let{threshold:r}=s;this.handleIntersection=this.handleIntersection.bind(this),this._callback=t,this._io=new IntersectionObserver(this.handleIntersection,{root:e,threshold:Xr(r,0)})}observe(e){this._io.disconnect(),e&&this._io.observe(e),j("[ScrollObserver][observe]",e)}unobserve(){this._io.disconnect(),j("[ScrollObserver][unobserve]")}handleIntersection([e]){j("[ScrollObserver][intersection detected] target:",e.target),this._callback(e)}};var Wr='[data-dfd-role~="scroll-sentinel"]',xo='[data-dfd-role~="scroll-top-sentinel"]',ko="div.dfd-card";function Ei(i,e,t){t?i.scrollTop=e:jr(i,e,250)}function Po(i){var s,r;let e=((s=document.querySelector(ko))==null?void 0:s.offsetHeight)||0,t=((r=document.querySelector(Wr))==null?void 0:r.offsetHeight)||0;return i.scrollHeight-t-e*2.6}var Jr={mounted(){this.sentinel=()=>this.el.querySelector(Wr),this.scrollTopSentinel=this.scrollTarget=this.refreshObservers=()=>{this.scrollObserver.observe(this.sentinel()),this.scrollTopObserver.observe(this.scrollTopSentinel())},this.changeBackToTopVisibility=this.scrollObserver=new bi(this.el,({target:i,isIntersecting:e})=>{if(!e)return;let t={index:i.dataset.index};this.debug('[push] "load-more", params:',t),this.pushEvent("load-more",t)}),this.scrollTopObserver=new bi(this.el,({isIntersecting:i})=>{this.changeBackToTopVisibility(!i)}),this.handleEvent("search",i=>{this.debug('[handle] "search", params:',i);let{index:e,page:t}=i,s=this.sentinel();t===1&&e===(s==null?void 0:s.dataset.index)&&(this.changeBackToTopVisibility(!1),Ei(this.el,0,!0)),this.refreshObservers()}),this.handleEvent("back-to-top",({id:i,fast:e})=>{this.debug(`[handle] "back-to-top", id: ${i}, fast: ${e}`),this.scrollTarget()==="window"?window.scrollTo(0,0):(!i||i===this.el.id)&&Ei(this.el,0,!!e)}),this.handleEvent("change-current-index",()=>{this.scrollObserver.observe(this.sentinel()),this.scrollTopObserver.observe(this.scrollTopSentinel()),Ei(this.el,0,!0)}),this.scrollObserver.observe(this.sentinel()),this.scrollTopObserver.observe(this.scrollTopSentinel())},destroyed,Ss={mounted(){this.hideVirtualKeyboard=ri(()=>{let i=document.querySelector("input:focus");i?(this.debug("[hideVirtualKeyboard][blur] input:",i),i.blur()):this.debug("[hideVirtualKeyboard][noop]")},100),this.debug("[observe][touchstart] hideVirtualKeyboard()"),this.el.addEventListener("touchstart",this.hideVirtualKeyboard)},destroyed(){this.debug("[unobserve][touchstart] hideVirtualKeyboard()"),this.el.removeEventListener("touchstart",this.hideVirtualKeyboard)}},ys={mounted(){this.transientTargetCard=()=>this.el.querySelector(`[dfd-value-dfid="${this.tag.popTargetItemId()}"]`),this.handleEvent("update-scroll",i=>{this.debug('[handle] "update-scroll", params:',i);let e=this.transientTargetCard();setTimeout(()=>{e!=null?e.scrollIntoView({block:"center"}):i.scroll_end&&Ei(Es(this.el),Po(this.el),!1)},1e3)})}};function Si(i,e,t,s){return new Intl.NumberFormat(i,{style:"currency",maximumFractionDigits:parseInt(t,10),numberingSystem:s,currency:e})}function yi(i,e,t){return new Intl.NumberFormat(i,{maximumFractionDigits:parseInt(e,10),numberingSystem:t})}var ws=class{ormat(e){let t=e<0,s=Math.pow(10,this.precision),r=(Math.round(e*s)/s).toFixed(this.precision),n=`${parseInt(Math.abs(r||0).toFixed(this.precision),10)}`,o=n.length>3?n.length%3:0,a=r.split(".")[1],l=[];return o>0&&l.push(`${n.substring(0,o)}${this.thousand}`),l.push(n.substring(o).replace(/(\d{3})(?=\d)/g,"$1"+this.thousand)),this.precision>0&&parseInt(a,10)>0&&l.push(`${this.decimal}${a}`),l=this.template.replace(/%s/g,this.symbol).replace(/%v/g,l.join("")),t&&(l=`-${l}`),l}};"use strict";var Me;((Me||(Me={}));var se;((se||(se={}));ar e=window.pageXOffset!==void 0,t=(i.compatMode||"")==="CSS1Compat",s=e?window.pageXOffset:t?i.documentElement.scrollLeft:i.body.scrollLeft,r=e?window.pageYOffset:t?i.documentElement.scrollTop:i.body.scrollTop;return{x:s,y:r}}o(i,e,t,s){if(s===100)return s;var r=xt(s,i),n=i[r-1],o=i[r];return t?s-n>(o-n)/2?o:n:e[r-1]?i[r-1]+Io(s-i[r-1],e[r-1]):s}var Qr=function(){eturn i.prototype.getDistance=i.prototype.getAbsoluteDistance=function(e,t,s){var r=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[r+1];)r++;else e===this.xPct[this.xPct.length-1]&&(r=this.xPct.length-2);!s&&e===this.xPct[r+1]&&r++,t===null&&(t=[]);var n,o=1,a=t[r],l=0,d=0,v=0,p=0;for(s?n=(e-this.xPct[r])/(this.xPct[r+1]-this.xPct[r]):n=(this.xPct[r+1]-e)/(this.xPct[r+1]-this.xPct[r]);a>0;)l=this.xPct[r+1+p]-this.xPct[r+p],t[r+p]*o+100-n*100>100?(d=l*n,o=(a-100*n)/t[r+p],n=1):(d=t[r+p]*l/100*o,o=0),s?(v=v-d,this.xPct.length+p>=1&&p--):(v=v+d,this.xPct.length-p>=1&&p++),a=t[r+p]*o;return e+v},i.prototype.toStepping=function(e){return e=$o(this.xVal,this.xPct,e),e},i.prototype.fromStepping=i.prototype.getStep=function(e){return e=jo(this.xPct,this.xSteps,this.snap,e),e},i.prototype.getDefaultStep=function(e,t,s){var r=xt(e,this.xPct);return(e===100||t&&e===this.xPct[r-1])&&(r=Math.max(r-1,1)),(this.xVal[r]-this.xVal[r-1])/s},i.prototype.getNearbySteps=i.prototype.countStepDecimals=i.prototype.hasNoSize=i.prototype.convert=i.prototype.handleEntryPoint=function(e,t){var s;if(e==="min"?s=0:e==="max"?s=100:s=parseFloat(e),!be(s)||!be(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(s),this.xVal.push(t[0]);var r=Number(t[1]);s?this.xSteps.push(isNaN(r)?!1:r):isNaN(r)||(this.xSteps[0]=r),this.xHighestCompleteStep.push(0)},i.prototype.handleStepPoint=function(e,t){if(!!t){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=As([this.xVal[e],this.xVal[e+1]],t,0)/Ts(this.xPct[e],this.xPct[e+1]);var s=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],r=Math.ceil(Number(s.toFixed(3))-1),n=this.xVal[e]+this.xNumSteps[e]*r;this.xHighestCompleteStep[e]=n}},i}(),Zr={to:function(i){return i===void 0?"":i.toFixed(2)},from:Number},en={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},Ne={tooltips:".__tooltips",aria:".__aria"};function Xo(i,e){if(!be(e))throw new Error("noUiSlider: 'step' is not numeric.");i.singleStep=e}function Wo(i,e){if(!be(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");i.keyboardPageMultiplier=e}function Jo(i,e){if(!be(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");i.keyboardMultiplier=e}function Ko(i,e){if(!be(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");i.keyboardDefaultStep=e}function qo(i,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");i.spectrum=new Qr(e,i.snap||!1,i.singleStep)}unction Yo(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");i.snap=e}function Go(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");i.animate=e}function Qo(i,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");i.animationDuration=e}function Zo(i,e){var t=[!1],s;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(s=1;s<i.handles;s++)t.push(e);t.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==i.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");t=e}i.connect=t}function ea(i,e){switch(e){case"horizontal":i.ort=0;break;case"vertical":i.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function tn(i,e){if(!be(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(i.margin=i.spectrum.getDistance(e))}unction ia(i,e){var t;if(!be(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||be(e[0])||be(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),i.padding=[i.spectrum.getDistance(e[0]),i.spectrum.getDistance(e[1])],t=0;t<i.spectrum.xNumSteps.length-1;t++)if(i.padding[0][t]<0||i.padding[1][t]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var s=e[0]+e[1],r=i.spectrum.xVal[0],n=i.spectrum.xVal[i.spectrum.xVal.length-1];if(s/(n-r)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}unction ra(i,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var t=e.indexOf("tap")>=0,s=e.indexOf("drag")>=0,r=e.indexOf("fixed")>=0,n=e.indexOf("snap")>=0,o=e.indexOf("hover")>=0,a=e.indexOf("unconstrained")>=0,l=e.indexOf("drag-all")>=0,d=e.indexOf("smooth-steps")>=0;if(r){if(i.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");tn(i,i.start[1]-i.start[0])}if(a&&(i.margin||i.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");i.events={tap:t||n,drag:s,dragAll:l,smoothSteps:d,fixed:r,snap:n,hover:o,unconstrained:a}}function na(i,e){if(e!==!1)if(e===!0||wi(e)){i.tooltips=[];for(var t=0;t<i.handles;t++)i.tooltips.push(e)}else{if(e=Ci(e),e.length!==i.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(s){if(typeof s!="boolean"&&!wi(s))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),i.tooltips=e}}unction aa(i,e){if(!wi(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");i.ariaFormat=e}unction ha(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");i.keyboardSupport=e}unction da(i,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");i.cssPrefix=e}function ua(i,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof i.cssPrefix=="string"?(i.cssClasses={},Object.keys(e).forEach():i.cssClasses=e}function sn(i){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:Zr,format:Zr},t={step:{r:!1,t:Xo},keyboardPageMultiplier:{r:!1,t:Wo},keyboardMultiplier:{r:!1,t:Jo},keyboardDefaultStep:{r:!1,t:Ko},start:{r:!0,t:zo},connect:{r:!0,t:Zo},direction:{r:!0,t:sa},snap:{r:!1,t:Yo},animate:{r:!1,t:Go},animationDuration:{r:!1,t:Qo},range:{r:!0,t:qo},orientation:{r:!1,t:ea},margin:{r:!1,t:tn},limit:{r:!1,t:ta},padding:{r:!1,t:ia},behaviour:{r:!0,t:ra},ariaFormat:{r:!1,t:aa},format:{r:!1,t:la},tooltips:{r:!1,t:na},keyboardSupport:{r:!0,t:ha},documentElement:{r:!1,t:ca},cssPrefix:{r:!0,t:da},cssClasses:{r:!0,t:ua},handleAttributes:{r:!1,t:oa}},s={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:en,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};i.format&&!i.ariaFormat&&(i.ariaFormat=i.format),Object.keys(t).forEach(function(l){if(!Cs(i[l])&&s[l]===void 0){if(t[l].r)throw new Error("noUiSlider: '"+l+"' is required.");return}t[l].t(e,Cs(i[l])?i[l]:s[l])}),e.pips=i.pips;var r=document.createElement("div"),n=r.style.msTransform!==void 0,o=r.style.transform!==void 0;e.transformRule=o?"transform":n?"msTransform":"webkitTransform";var a=[["left","top"],["right","bottom"]];return e.style=a[e.dir][e.ort],e}function fa(i,e,t){var s=Mo(),r=Uo(),n=r&&No(),o=i,a,l,d,v,p,_=e.spectrum,y=[],w=[],C=[],H=0,k={},L=i.ownerDocument,X=e.documentElement||L.documentElement,g=L.body,R=L.dir==="rtl"||e.ort===1?0:100;unction oe(h,c){var u=J(h,e.cssClasses.origin),m=J(u,e.cssClasses.handle);if(J(m,e.cssClasses.touchArea),m.setAttribute("data-handle",String(c)),e.keyboardSupport&&(m.setAttribute("tabindex","0"),m.addEventListener("keydown",),e.handleAttributes!==void 0){var E=e.handleAttributes[c];Object.keys(E).forEach(}return m.setAttribute("role","slider"),m.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),c===0?ie(m,e.cssClasses.handleLower):c===e.handles-1&&ie(m,e.cssClasses.handleUpper),u.handle=m,u}nction ot(h){ie(h,e.cssClasses.target),e.dir===0?ie(h,e.cssClasses.ltr):ie(h,e.cssClasses.rtl),e.ort===0?ie(h,e.cssClasses.horizontal):ie(h,e.cssClasses.vertical);var c=getComputedStyle(h).direction;return c==="rtl"?ie(h,e.cssClasses.textDirectionRtl):ie(h,e.cssClasses.textDirectionLtr),J(h,e.cssClasses.base)}function z(h,c){return!e.tooltips||!e.tooltips[c]?!1:J(h.firstChild,e.cssClasses.tooltip)}nction at(h){h!=null?(l[h].setAttribute("disabled",""),l[h].handle.removeAttribute("tabindex")):(o.setAttribute("disabled",""),l.forEach()}function Pi(h){h!=null?(l[h].removeAttribute("disabled"),l[h].handle.setAttribute("tabindex","0")):(o.removeAttribute("disabled"),l.forEach()}unction x(){Fe(),p=l.map(z),Ii("update"+Ne.tooltips,function(h,c,u){if(!(!p||!e.tooltips)&&p[c]!==!1){var m=h[c];e.tooltips[c]!==!0&&(m=e.tooltips[c].to(u[c])),p[c].innerHTML=m}})}unction F(h){if(h.mode===Me.Range||h.mode===Me.Steps)return _.xVal;if(h.mode===Me.Count){if(h.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var c=h.values-1,u=100/c,m=[];c--;)m[c]=c*u;return m.push(100),P(m,h.stepped)}return h.mode===Me.Positions?P(h.values,h.stepped):h.mode===Me.Values?h.stepped?h.values.map(:h.values:[]}unction M(h){ar u=F(h),m={},E=_.xVal[0],b=_.xVal[_.xVal.length-1],T=!1,S=!1,N=0;return u=Ro(u.slice().sort(),u[0]!==E&&(u.unshift(E),T=!0),u[u.length-1]!==b&&(u.push(b),S=!0),u.forEach(function(O,V){var $,D,Y,te=O,G=u[V+1],Q,Oi,Mi,Ni,Ns,Ui,Us,Fs=h.mode===Me.Steps;for(Fs&&($=_.xNumSteps[V]),$||($=G-te),G===void 0&&(G=te),$=Math.max($,1e-7),D=te;D<=G;D=c(D,$)){for(Q=_.toStepping(D),Oi=Q-N,Ns=Oi/(h.density||1),Ui=Math.round(Ns),Us=Oi/Ui,Y=1;Y<=Ui;Y+=1)Mi=N+Y*Us,m[Mi.toFixed(5)]=[_.fromStepping(Mi),0];Ni=u.indexOf(D)>-1?se.LargeValue:Fs?se.SmallValue:se.NoValue,!V&&T&&D!==G&&(Ni=0),D===G&&S||(m[Q.toFixed(5)]=[D,Ni]),N=Q}}),m}function Re(h,c,u){var m,E,b=L.createElement("div"),T=(m={},m[se.None]="",m[se.NoValue]=e.cssClasses.valueNormal,m[se.LargeValue]=e.cssClasses.valueLarge,m[se.SmallValue]=e.cssClasses.valueSub,m),S=(E={},E[se.None]="",E[se.NoValue]=e.cssClasses.markerNormal,E[se.LargeValue]=e.cssClasses.markerLarge,E[se.SmallValue]=e.cssClasses.markerSub,E),N=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],O=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];ie(b,e.cssClasses.pips),ie(b,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);unction $(D,Y,te){if(te=c?c(Y,te):te,te!==se.None){var G=J(b,!1);G.className=V(te,e.cssClasses.marker),G.style[e.style]=D+"%",te>se.NoValue&&(G=J(b,!1),G.className=V(te,e.cssClasses.value),G.setAttribute("data-value",String(Y)),G.style[e.style]=D+"%",G.innerHTML=String(u.to(Y)))}}return Object.keys(h).forEach(,b}unction Se(h){le();var c=M(h),u=h.filter,m=h.format||{to:;return v=o.appendChild(Re(c,u,m)),v}unction ee(h,c,u,m){var E=function(T){var S=Ye(T,m.pageOffset,m.target||c);if(!S||Ue()&&!m.doNotReject||Oo(o,e.cssClasses.tap)&&!m.doNotReject||h===s.start&&S.buttons!==void 0&&S.buttons>1||m.hover&&S.buttons)return!1;n||S.preventDefault(),S.calcPoint=S.points[e.ort],u(S,m)},b=[];return h.split(" ").forEach(function(T){c.addEventListener(T,E,n?{passive:!0}:!1),b.push([T,E])}),b}function Ye(h,c,u){var m=h.type.indexOf("touch")===0,E=h.type.indexOf("mouse")===0,b=h.type.indexOf("pointer")===0,T=0,S=0;if(h.type.indexOf("MSPointer")===0&&(b=!0),h.type==="mousedown"&&!h.buttons&&!h.touches)return!1;if(m){var N=if(h.type==="touchstart"){var O=Array.prototype.filter.call(h.touches,N);if(O.length>1)return!1;T=O[0].pageX,S=O[0].pageY}else{var V=Array.prototype.find.call(h.changedTouches,N);if(!V)return!1;T=V.pageX,S=V.pageY}}return c=c||Gr(L),(E||b)&&(T=h.clientX+c.x,S=h.clientY+c.y),h.pageOffset=c,h.points=[T,S],h.cursor=E||b,h}function fe(h){var c=h-Do(a,e.ort),u=c*100/Ve();return u=Yr(u),e.dir?100-u:u}function lt(h){var c=100,u=!1;return l.forEach(function(m,E){if(!ze(E)){var b=w[E],T=Math.abs(b-h),S=T===100&&c===100,N=T<c,O=T<=c&&h>b;(N||O||S)&&(u=E,c=T)}}),u}function Pt(h,c){h.type==="mouseout"&&h.target.nodeName==="HTML"&&h.relatedTarget===null&&Li(h,c)}function Cn(h,c){if(navigator.appVersion.indexOf("MSIE 9")===-1&&h.buttons===0&&c.buttonsProperty!==0)return Li(h,c);var u=(e.dir?-1:1)*(h.calcPoint-c.startCalcPoint),m=u*100/c.baseSize;Rs(u>0,m,c.locations,c.handleNumbers,c.connect)}function Li(h,c){c.handle&&(Ti(c.handle,e.cssClasses.active),H-=1),c.listeners.forEach(,H===0&&(Ti(o,e.cssClasses.drag),Hi(),h.cursor&&(g.style.cursor="",g.removeEventListener("selectstart",qr))),e.events.smoothSteps&&(c.handleNumbers.forEach(,c.handleNumbers.forEach(function(u){K("update",u)})),c.handleNumbers.forEach(}function Ri(h,c){if(!c.handleNumbers.some(ze)){var u;if(c.handleNumbers.length===1){var m=l[c.handleNumbers[0]];u=m.children[0],H+=1,ie(u,e.cssClasses.active)}h.stopPropagation();var E=[],b=ee(s.move,X,Cn,{target:h.target,handle:u,connect:c.connect,listeners:E,startCalcPoint:h.calcPoint,baseSize:Ve(),pageOffset:h.pageOffset,handleNumbers:c.handleNumbers,buttonsProperty:h.buttons,locations:w.slice()}),T=ee(s.end,X,Li,{target:h.target,handle:u,listeners:E,doNotReject:!0,handleNumbers:c.handleNumbers}),S=ee("mouseout",X,Pt,{target:h.target,handle:u,listeners:E,doNotReject:!0,handleNumbers:c.handleNumbers});E.push.apply(E,b.concat(T,S)),h.cursor&&(g.style.cursor=getComputedStyle(h.target).cursor,l.length>1&&ie(o,e.cssClasses.drag),g.addEventListener("selectstart",qr,!1)),c.handleNumbers.forEach(}}function Tn(h){h.stopPropagation();var c=fe(h.calcPoint),u=lt(c);u!==!1&&(e.events.snap||zr(o,e.cssClasses.tap,e.animationDuration),$e(u,c,!0,!0),Hi(),K("slide",u,!0),K("update",u,!0),e.events.snap?Ri(h,{handleNumbers:[u]}):(K("change",u,!0),K("set",u,!0)))}function An(h){var c=fe(h.calcPoint),u=_.getStep(c),m=_.fromStepping(u);Object.keys(k).forEach(function(E){E.split(".")[0]==="hover"&&k[E].forEach(})}function xn(h,c){if(Ue()||ze(c))return!1;var u=["Left","Right"],m=["Down","Up"],E=["PageDown","PageUp"],b=["Home","End"];e.dir&&!e.ort?u.reverse():e.ort&&!e.dir&&(m.reverse(),E.reverse());var T=h.key.replace("Arrow",""),S=T===E[0],N=T===E[1],O=T===m[0]||T===u[0]||S,V=T===m[1]||T===u[1]||N,$=T===b[0],D=T===b[1];if(!O&&!V&&!$&&!D)return!0;h.preventDefault();var Y;if(V||O){var te=O?0:1,G=Ms(c),Q=G[te];if(Q===null)return!1;Q===!1&&(Q=_.getDefaultStep(w[c],O,e.keyboardDefaultStep)),N||S?Q*=e.keyboardPageMultiplier:Q*=e.keyboardMultiplier,Q=Math.max(Q,1e-7),Q=(O?-1:1)*Q,Y=y[c]+Q}else D?Y=e.spectrum.xVal[e.spectrum.xVal.length-1]:Y=e.spectrum.xVal[0];return $e(c,_.toStepping(Y),!0,!0),K("slide",c),K("update",c),K("change",c),K("set",c),!1}function kn(h){h.fixed||l.forEach(,h.tap&&ee(s.start,a,Tn,{}),h.hover&&ee(s.move,a,An,{hover:!0}),h.drag&&d.forEach(function(c,u){if(!(c===!1||u===0||u===d.length-1)){var m=l[u-1],E=l[u],b=[c],T=[m,E],S=[u-1,u];ie(c,e.cssClasses.draggable),h.fixed&&(b.push(m.children[0]),b.push(E.children[0])),h.dragAll&&(T=l,S=C),b.forEach(}})}function Ii(h,c){k[h]=k[h]||[],k[h].push(c),h.split(".")[0]==="update"&&l.forEach(}unction ht(h){var c=h&&h.split(".")[0],u=c?h.substring(c.length):h;Object.keys(k).forEach(function(m){var E=m.split(".")[0],b=m.substring(E.length);(!c||c===E)&&(!u||u===b)&&(!Pn(b)||u===b)&&delete k[m]})}unction Lt(h,c,u,m,E,b,T){var S;return l.length>1&&!e.events.unconstrained&&(m&&c>0&&(S=_.getAbsoluteDistance(h[c-1],e.margin,!1),u=Math.max(u,S)),E&&c<l.length-1&&(S=_.getAbsoluteDistance(h[c+1],e.margin,!0),u=Math.min(u,S))),l.length>1&&e.limit&&(m&&c>0&&(S=_.getAbsoluteDistance(h[c-1],e.limit,!1),u=Math.min(u,S)),E&&c<l.length-1&&(S=_.getAbsoluteDistance(h[c+1],e.limit,!0),u=Math.max(u,S))),e.padding&&(c===0&&(S=_.getAbsoluteDistance(0,e.padding[0],!1),u=Math.max(u,S)),c===l.length-1&&(S=_.getAbsoluteDistance(100,e.padding[1],!0),u=Math.min(u,S))),T||(u=_.getStep(u)),u=Yr(u),u===h[c]&&!b?!1:u}unction Rs(h,c,u,m,E){var b=u.slice(),T=m[0],S=e.events.smoothSteps,N=[!h,h],O=[h,!h];m=m.slice(),h&&m.reverse(),m.length>1?m.forEach(function($,D){var Y=Lt(b,$,b[$]+c,N[D],O[D],!1,S);Y===!1?c=0:(c=Y-b[$],b[$]=Y)}):N=O=[!0];var V=!1;m.forEach(,V&&(m.forEach(,E!=null&&K("drag",T))}unction Ln(h,c){w[h]=c,y[h]=_.fromStepping(c);var u=Is(c,0)-R,m="translate("+Di(u+"%","0")+")";l[h].style[e.transformRule]=m,Ds(h),Ds(h+1)}unction $e(h,c,u,m,E,b){return E||(c=Lt(w,h,c,u,m,!1,b)),c===!1?!1:(Ln(h,c),!0)}function Ds(h){if(!!d[h]){var c=0,u=100;h!==0&&(c=w[h-1]),h!==d.length-1&&(u=w[h]);var m=u-c,E="translate("+Di(Is(c,m)+"%","0")+")",b="scale("+Di(m/100,"1")+")";d[h].style[e.transformRule]=E+" "+b}}function Hs(h,c){return h===null||h===!1||h===void 0||(typeof h=="number"&&(h=String(h)),h=e.format.from(h),h!==!1&&(h=_.toStepping(h)),h===!1||isNaN(h))?w[c]:h}function Rt(h,c,u){var m=Ci(h),E=w[0]===void 0;c=c===void 0?!0:c,e.animate&&!E&&zr(o,e.cssClasses.tap,e.animationDuration),C.forEach(;var b=C.length===1?0:1;if(E&&_.hasNoSize()&&(u=!0,w[0]=0,C.length>1)){var T=100/(C.length-1);C.forEach(}for(;b<C.length;++b)C.forEach(;Hi(),C.forEach(function(S){K("update",S),m[S]!==null&&c&&K("set",S)})}unction In(h,c,u,m){if(h=Number(h),!(h>=0&&h<C.length))throw new Error("noUiSlider: invalid handle number, got: "+h);$e(h,Hs(c,h),!0,!0,m),K("update",h),u&&K("set",h)}function Os(h){if(h===void 0&&(h=!1),h)return y.length===1?y[0]:y.slice(0);var c=y.map(e.format.to);return c.length===1?c[0]:c}unction Ms(h){var c=w[h],u=_.getNearbySteps(c),m=y[h],E=u.thisStep.step,b=null;if(e.snap)return[m-u.stepBefore.startValue||null,u.stepAfter.startValue-m||null];E!==!1&&m+E>u.stepAfter.startValue&&(E=u.stepAfter.startValue-m),m>u.thisStep.startValue?b=u.thisStep.step:u.stepBefore.step===!1?b=!1:b=m-u.stepBefore.highestStep,c===100?E=null:c===0&&(b=null);var T=_.countStepDecimals();return E!==null&&E!==!1&&(E=Number(E.toFixed(T))),b!==null&&b!==!1&&(b=Number(b.toFixed(T))),[b,E]}unction On(h,c){var u=Os(),m=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];m.forEach(function(b){h[b]!==void 0&&(t[b]=h[b])});var E=sn(t);m.forEach(,_=E.spectrum,e.margin=E.margin,e.limit=E.limit,e.padding=E.padding,e.pips?Se(e.pips):le(),e.tooltips?x():Fe(),w=[],Rt(Cs(h.start)?h.start:u,c)}n();var It={destroy:Dn,steps:Hn,on:Ii,off:ht,get:Os,set:Rt,setHandle:In,reset:Rn,disable:at,enable:Pi,__moveHandles:options:t,updateOptions:On,target:o,removePips:le,removeTooltips:Fe,getPositions:getTooltips:function(){return p},getOrigins:function(){return l},pips:Se};return It}function pa(i,e){if(!i||!i.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+i);if(i.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var t=sn(e),s=fa(i,t,e);return i.noUiSlider=s,s}var rn={__spectrum:Qr,cssClasses:en,create:pa};unction on(i){let e={};return{tofrom}function xs(i,e){let{min:t,max:s,from:r,to:n}=i;return t=parseFloat(t),s=parseFloat(s),t===s&&s++,r=parseFloat(r)||t,n=parseFloat(n)||s,{range:{min:t,max:s},start:[e.to(r),e.to(n)]}}function an(i,e,t,s={}){return rn.create(i,W({cssPrefix:"dfd-slider-",orientation:"horizontal",direction:s.rtl?"rtl":"ltr",tooltips:!0,padding:0,connect:!0,animate:!0,step:1,keyboardSupport:!0,format:e,pips:{mode:"count",values:3,density:6,format:e}},t))}function ln(i,e,t){let s=getComputedStyle(i).direction==="rtl",r=i.noUiSlider.options.direction==="rtl",n=i.noUiSlider.options.orientation==="vertical",a=i.noUiSlider.getTooltips().map(,l=i.noUiSlider.getOrigins();a.forEach(,i.noUiSlider.on("update",function(d,v,p,_,y){let w=[[]],C=[[]],H=[[]],k=0;a[0]&&(w[0][0]=0,C[0][0]=y[0],H[0][0]=d[0]);for(let L=1;L<y.length;L++)(!a[L]||y[L]-y[L-1]>e)&&(k++,w[k]=[],H[k]=[],C[k]=[]),a[L]&&(w[k].push(L),H[k].push(d[L]),C[k].push(y[L]));w.forEach(function(L,X){let g=L.length;for(let R=0;R<g;R++){let J=L[R];if(R===g-1){let oe=0;C[X].forEach(;let qe=n?"bottom":"right",Le=r?0:g-1,ot=1e3-C[X][Le];oe=(s&&!n?100:0)+oe/g-ot,a[J].innerHTML=nn(H[X]).join(t),a[J].style.display="block",a[J].style[qe]=oe+"%"}else a[J].style.display="none"}})})}"use strict";var hn={mounted(){let{facet:i,language:e,currency:t,currencyDecimal:s,currencyFormat:r,currencyPrecision:n,currencySymbol:o,currencyThousand:a,decimalPrecision:l,min:d,max:v,from:p,to:_,target:y}=this.el.dataset,w=this.el.dataset.autohideTooltips==="true",C=this.options.numberingSystem||"latn",H=(document.documentElement.getAttribute("dir")||"").toLowerCase()==="rtl",k=(()=>typeof r=="string"?new ws(r,o,a,s,parseInt(n,10)):t?Si(e,t,parseInt(n,10),C):yi(e,parseInt(l,10),C))();this.format=on(k),this.slider=an(this.el,this.format,xs({min:d,max:v,from:p,to:_},this.format),{rtl:H}),this.slider.on("change",L=>{let[X,g]=L,J={index:this.el.dataset.index,range:{[i]:{from:this.format.from(X),to:this.format.from(g)}}};y?this.pushEventTo(y,"slide",J):this.pushEvent("slide",J)}),w||ln(this.el,25," - ")},updated(){let{min:i,max:e,from:t,to:s}=this.el.dataset;this.slider.updateOptions(xs({min:i,max:e,from:t,to:s},this.format))},destroyed;"use strict";var cn={mounted(){let i=0,e=0;this.el.addEventListener("touchstart",!1),this.el.addEventListener("touchend",t=>{e=t.changedTouches[0].screenY,e>i&&this.pushEvent(this.el.dataset.action,{index:""})},!1)}};var Ai=window.SpeechRecognition||window.webkitSpeechRecognition||null,dn=["click"],un=["start","end","error","result"],ma="voice-search",fn="voice-status-change";function ga(i){return i.results.length>0?i.results[0][0].transcript:null}var pn={mounted(){!Ai||(this.recording=!1,this.driver=new Ai,this.driver.continuous=!1,this.driver.interimResults=!1,this.handleVoiceEvent=i=>{switch(i.type){case"end":case"error":this.driver.stop(),this.recording=!1,this.pushEvent(fn,{recording:!1});break;case"click":this.driver[this.recording?"stop":"start"](),this.recording=!this.recording,this.pushEvent(fn,{recording:this.recording});break;case"result":let e=ga(i);e&&this.pushEvent(ma,{query:e});break}},dn.forEach(i=>this.el.addEventListener(i,this.handleVoiceEvent)),un.forEach(i=>this.driver.addEventListener(i,this.handleVoiceEvent)))},destroyed(){dn.forEach(i=>this.el.removeEventListener(i,this.handleVoiceEvent)),un.forEach(i=>this.driver.removeEventListener(i,this.handleVoiceEvent)),this.driver=null}};function Ee(i,e,...t){var o;let s=((o=t.find()==null?void 0:o.options)||{},r={get tag(){return e},get options(){return s},debug(...a){j(`[hook][${i}]`,...a)}};return["mounted","beforeUpdate","updated","destroyed","disconnected","reconnected"].forEach(a=>{let l=t.map(d=>d[a]).filter(;r[a]=function(){l.length>0&&this.debug(`${a}()`),l.forEach(}}),r}unction ks(i,e,t){let s=t.x,r=s+t.width,n=t.y,o=n+t.height;return i>=s&&i<=r&&e>=n&&e<=o}function gn(i,e=!1){let t=Pr("__DF_LAYER_SERVER__")||`https://${i.toLowerCase()}-layer.doofinder.com`;return e?t.replace(/^http/,"ws"):t}function vn(){var i;if("maxTouchPoints"in navigator)return navigator.maxTouchPoints>0;if("msMaxTouchPoints"in navigator)return navigator.msMaxTouchPoints>0;{let e=(i=window.matchMedia)==null?void 0:i.call(window,"(pointer:coarse)");if((e==null?void 0:e.media)==="(pointer:coarse)")return!!e.matches;if("orientation"in window)return!0;{let t=navigator.userAgent;return/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(t)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(t)}}}function _n(i){let e=document.cookie.match(new RegExp("(?:^|; )"+i.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));if(e)return decodeURIComponent(e[1])}function bn(i){if(i instanceof PointerEvent)switch(i.pointerType){case"mouse":case"pen":case"touch":return!0;default:return!1}else if(i instanceof MouseEvent){let{pageX:e,pageY:t,target:s}=i;return!(e===t&&e===0&&va(s))}return!1}function va(i){return i.getAttribute("type")==="submit"&&(i.tagName==="BUTTON"||i.tagName==="INPUT")}function Ps(i){return typeof i=="undefined"?null:i}var _a="Search",En=vn(),Sn="latestSearches",ba="dfd-root",yn="dfdTarget",Ea=10,kt="transientState",Ls="isTransient",xi=class{constructor(e){this.__handleTriggerEvent__=this.__handleTriggerEvent__.bind(this),this.__handlePopstate__=this.__handlePopstate__.bind(this),this.__handleLinkClick__=this.__handleLinkClick__.bind(this),this.__handleDocumentClick__=this.__handleDocumentClick__.bind(this),this.__handleDocumentKeyup__=this.__handleDocumentKeyup__.bind(this),this.__updateSocketParams__=this.__updateSocketParams__.bind(this);let{id:t,installationId:s,zone:r,language:n,currency:o,exportResultsData:a,hashid:l,trigger:d,autoload:v,urlHash:p,search_query_retention:_,layerType:y}=e;this._installationId=s,this._zone=r,this._hashid=l,this._language=n,this._currency=o,this._exportResultsData=a,this._layerType=y,this._mount=this.__createMount__(t),this._mount.addEventListener("click",this.__handleLinkClick__),this._eventBus=new ps(this._mount.id),this._eventBusSubscriptions=[gs,Tt,At,vs].map(,this._trigger=d,this._trigger.setEventBus(this._eventBus),this._display=new fs(this._mount),this._state=new ui({installationId:s,autoload:v,urlHash:p}),this._data=new ei(`${s}.data`),this._sessionData=new ei(`${s}.data`,window.sessionStorage),this._params=this.__buildSocketParams__(e),this._hooks=this.__buildSocketHooks__(e),this._liveSocket=null,this._liveSocketConnectedPromise=new Be,this._theme=null,this._layerHook=null,_==null?this._searchQueryRetention=p:this._searchQueryRetention=_,this._transientQuery=null,this.closable&&this.mount.classList.add("dfd-closable"),window.addEventListener("popstate",this.__handlePopstate__),this._trigger.flushMessages(),this.__applyTransientState__(),this.__loadState__().then(()=>this.dispatch("doofinder.ready"))}__createMount__(e){let t=document.createElement("div");return t.id=e||`df-${ni(32)}`,t.dataset.dfdView=_a,t.setAttribute(Pe,""),t.classList.add(ba),Object.defineProperty(t,"doofinderTag",{value:this,writable:!1}),t}get mount(){return this._mount}get trigger(){return this._trigger}get display(){return this._display}get hashid(){return this._hashid}get installationId(){return this._installationId}get zone(){return this._zone}get language(){return this._language}get currency(){return this._currency}get exportResultsData(){return this._exportResultsData}get layerType(){return this._layerType}get searchQueryRetention(){return this._searchQueryRetention}get data(){return this._data}get state(){return this._state}get layerHook(){return this._layerHook||(this._layerHook=this.getHooksByName("Layer").pop()),this._layerHook}get closable(){return this.display.type!==We||!this.state.hasQueryParam}enableDebugebug(...e){j("[tag]",...e)}saveTransientState(e){this._sessionData.setItem(kt,e),this._sessionData.setItem(Ls,!0),this.debug("save transient state:",e)}__popTransientState__(){let e=this._sessionData.getItem(kt)||null;return this._sessionData.removeItem(kt),this.debug("pop transient state:",e),e}__handleTriggerEvent__(e){let{source:t,originalEvent:s}=e.detail,{query:r}=e.detail;!r&&this._transientQuery&&(r=this._transientQuery);let n=r?{query:r}:{};this.connect(n).then(()=>{this.__shouldDisplay__(e)?(this.show(t),e.type===At&&this.search(r)):e.type===vs&&this.submit(r,o=>{var l;if(!o)return;let{submit:a}=o||{};a&&((l=s==null?void 0:s.target.closest("form"))==null||l.submit())})})}__applyTransientState__(){let e=this._sessionData.getItem(kt);this._sessionData.getItem(Ls)&&(this._searchQueryRetention?(this.debug("apply transient state - search query retention true:",e),this.updateQuery(e)):(this.debug("apply transient state - search query retention false:",""),this._state.replace(""),this.updateQuery("")),this._sessionData.removeItem(Ls),this._sessionData.removeItem(kt))}__shouldDisplay__(e){let{query:t}=e.detail;switch(this._display.type){case ti:return(e.type===At||e.type===Tt)&&(this._display.screenType==="classic-initial"||!!t);case We:return(e.type===At||e.type===Tt)&&!!t;case ii:return e.type===gs||e.type===Tt;default:return!1}}__handlePopstate__(e){this.debug("handle pop state event:",e),this._liveSocket?this._state.validEvent(e)?this.__changeState__(e.state):this.disconnect():this.__loadState__()}__changeState__(e){this.debug("change state:",e),this.layerHook?this.layerHook.pushEvent("change-state",e):this.debug("tried to change state but hook did not exist:",e)}__handleLinkClick__(e){if(e.target.href){let t=e.target.closest("[dfd-value-dfid]"),s=t==null?void 0:t.getAttribute("dfd-value-dfid");s&&this._sessionData.setItem(yn,s),this._liveSocket.socket.preventReconnect=!0;let r=!0;this.saveTransientState(this._state.get(r))}else this._liveSocket.socket.preventReconnect=!1}popTargetItemId(){return this._sessionData.popItem(yn)}__handleDocumentClick__(e){if(this._display.type===We||!bn(e))return;let{clientX:t,clientY:s}=e;if(ks(t,s,this._mount.getBoundingClientRect()))return;let r=this._display.method.positionReference;!!r&&(ks(t,s,r.getBoundingClientRect())||e.target.closest('button[type="submit"]')&&e.target.closest("form")===r.closest("form"))||this.close()}__handleDocumentKeyup__(e){e.key==="Escape"&&this.layerType!=="category_pages"&&this.close()}__loadState__(){let e=this._state.get();return this.debug("load state:",e),e?(this._state.saveAbsoluteURL(),this.updateQuery(e),this.connect({state:e}).then():Promise.resolve()}updateQuery(e){let t=ui.getQuery(e);this._trigger.updateQuery(t),this._transientQuery=t}getLatestSearchesLoad(e){let{min_capture_length:t,capture_submit:s,align:r,display_type:n,insertion_point:o,insertion_method:a,screen_type:l,theme:d}=e;this.__updateTrigger__({min_capture_length:t,capture_submit:s}),this.__updateDisplay__({display_type:n,insertion_point:o,insertion_method:a,screen_type:l,theme:d,align:r}),this._liveSocketConnectedPromise.resolve(e)}__updateTrigger__({min_capture_length:e,capture_submit:t}){this._trigger.setCaptureLength(e),this._trigger.captureSubmit=t}__updateDisplay__({display_type:e,insertion_point:t,insertion_method:s,screen_type:r,theme:n,align:o}){this._display.setType(e,{placement:{insertionPoint:t,insertionMethod:s},align:o}),this._display.screenType=r,this._display.updateTheme(n),this._display.hidden||this.updatePosition()}updatePosition(e){return I(this,null,function*(){this._display.updatePosition({positionReference:e||(yield this._trigger.getElement())})})}close(){var e,t;this.closable&&((t=(e=this.getHooksByName("Layer"))==null?void 0:e.pop())==null||t.close())}show(e){return I(this,null,function*(){yield this.updatePosition(e),yield this._display.show(),this.dispatch("doofinder.show")})}hide(){return I(this,null,function*(){yield this._display.hide(),this.dispatch("doofinder.hide")})}dispatch(e,t={}){let s=Ce(W({},t),{tag:this});document.dispatchEvent(new CustomEvent(e,{detail:s}))}connect(e){if(!this._liveSocket){let s=`${gn(this._zone,!0)}/layer/${fi}`,r={params:hooks:this._hooks,doofinderMount:this._mount,disconnectCallback:()=>{this.__afterDisconnect__(),this.hide(),this.debug("layer died and can't reconnect automatically! \u{1F92C}")},metadata:{click:(n,o)=>({keys:{altKey:n.altKey,shiftKey:n.shiftKey,ctrlKey:n.ctrlKey,metaKey:n.metaKey}})}};this.debug(`creating live socket for layer: ${this._mount.id}`),this._liveSocket=new Ct(s,Bi,r),this._liveSocket.connect(),Doofinder.Session.setLive("layer"),document.addEventListener("click",this.__handleDocumentClick__),document.addEventListener("keyup",this.__handleDocumentKeyup__,{passive:!0})}return this._liveSocketConnectedPromise}open(){return I(this,arguments,function*(e={}){let{search:t,screen:s}=e,r=W({},e);t!=null&&!s&&(r.screen="fallback"),typeof t=="string"&&(delete r.search,r.query=t),yield this.connect(r),yield this.show(),typeof t=="object"&&this.search(t)})}__afterDisconnect__(){this._liveSocket&&(this._liveSocket.unbindTopLevelEvents(),this._liveSocket.destroyAllViews()),this._layerHook=null,this._liveSocket=null,this.dispatch("doofinder.disconnect")}disconnect(){var e;this.layerType!=="category_pages"&&(this.debug(`disconnecting from live socket: ${this._mount.id}`),(e=this._liveSocket)==null||e.disconnect(()=>{this.__afterDisconnect__(),this.hide(),document.removeEventListener("keyup",this.__handleDocumentKeyup__),document.removeEventListener("click",this.__handleDocumentClick__)}),this._liveSocketConnectedPromise=new Be)}destroy(){return I(this,null,function*(){var e;this.debug(`destroy: ${this._mount.id}`),(e=this._liveSocket)==null||e.disconnect(),this._liveSocket=null,this._eventBusSubscriptions.forEach(t=>t()),this._eventBusSubscriptions=null,this._eventBus.teardown(),this._eventBus=null,yield this._display.destroy(),this._display=null,window.removeEventListener("popstate",this.__handlePopstate__),document.removeEventListener("keyup",this.__handleDocumentKeyup__),document.removeEventListener("click",this.__handleDocumentClick__),this.dispatch("doofinder.destroy"),this._trigger.destroy()})}getHooksByName(e){if(this._liveSocket){let t=this._liveSocket.getViewByEl(this._mount);return Array.from(this._mount.querySelectorAll(`[dfd-hook="${e}"]`)).map(r=>t.getHook(r))}else return[]}search(e,t){var r;let s=typeof e=="string"?{query:e}:e;(r=this.layerHook)==null||r.pushEvent("search-suggest",{search:s},t)}changeLocale(e,t,s){var r;(r=this.layerHook)==null||r.pushEvent("change-locale",{language:e,currency:t},s)}submit(e,t){var s;(s=this.layerHook)==null||s.pushEvent("search-submit",{search:{query:e}},t)}__buildSocketParams__(e){let{params:t,vars:s,indices:r,state:n}=e,o={hashid:this._hashid,origin:window.location.hostname,indices:r,params:t,vars:s,state:n};return["indices","search-server"].filter(a=>!o[a]).forEach(,o}__buildSocketHooks__(e){let t=e.hooks||{},s={Carousel:Ee("Carousel",this,Rr,t.Carousel||{}),ImageSearch:Ee("ImageSearch",this,Hr),Input:Ee("Input",this,Or,t.Input||{}),Layer:Ee("Layer",this,Vr,t.Layer||{}),EmbeddedResults:Ee("EmbeddedResults",this,ys,En?Ss:{},t.EmbeddedResults||{}),Results:Ee("Results",this,Jr,En?Ss:{},ys,t.Results||{}),Slider:Ee("Slider",this,hn,t.Slider||{}),Swipe:Ee("Swipe",this,cn,t.Swipe||{}),VoiceSearch:Ee("VoiceSearch",this,pn,t.VoiceSearch||{})};return j("[tag] Hooks created:",this._mount.id,s),Object.keys(t).filter(.forEach(r=>{s[r]=Ee(r,this,t[r]||{})}),s}__updateSocketParams__(e){var n,o;let t=this._state.get(),s=this.__popTransientState__(),r=W(Ce(W({},mn(this._params)),{zone:this.zone,installation_id:this.installationId,language:this.language,currency:this.currency,session_id:Doofinder.Session.getSessionId(),session_alive:Doofinder.Session.isLive("layer"),user_id:Doofinder.Session.getUserId(),latest_searches:this.getLatestSearches(),voice_supported:!!Ai,export_results_data:Ps((n=this.exportResultsData)==null?void 0:n.slice(0,Ea)),ga_client_id:Ps((o=_n("_ga"))==null?void 0:o.substring(6)),layer_type:this.layerType}),e);return s&&!r.state&&(r.state=s),t&&(r.state=t),this.debug(`__updateSocketParams__ for layer: ${this._mount.id}`,r),r}};var ki=[];document.addEventListener("doofinder.destroy",i=>{ki=ki.filter(});var wn={getTagscreatedestroy(i){var e;i instanceof xi?i.destroy():(e=i==null?void 0:i.doofinderTag)==null||e.destroy()},enableDebug:xr,disableDebug:kr,debug:j,utils:{buildNumericFormatter:yi,buildCurrencyFormatter:Si}};Object.defineProperty(wn,"__version__",{value:fi});js(Bs,wn);})();
