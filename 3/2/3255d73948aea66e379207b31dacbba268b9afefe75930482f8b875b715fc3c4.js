/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={248:(e,t,n)=>{const{fireImpression:r}=n(148),{getAllExperiments:o,initialize:i,whenAvailable:a}=n(977),{ensureUserTestId:c}=n(548),s="TL6bJ6aeorhsvy5X8LGMVX",u=e=>`${c()}/${e}/${window.tracking?window.tracking.visit():"fixed-visit"}`;function l(e){window&&window.location&&window.location.search.match(/debug=true/g)&&console.log(`aa-experiment: ${e}`)}function d(e,t,n){try{const o=e.find(();if(o&&o.experimentKey&&o.variationKey){if(function(e,t){const n=localStorage.getItem(t);return!!n&&n===u(e)}(o.variationKey,n))return void l(`AA experiment already fired, clear ${n} in local storage for new impression`);r(o.experimentKey,o.variationKey,s).then((e=>{var t,r;e&&(t=o.variationKey,r=n,localStorage.setItem(r,u(t)))}))}else l("Not part of AA experiment, check you have the right whitelisted values")}catch(e){console.error(`Impression for ${t} failed`,e)}}function f(e){if(!e)return void l("ab-reader not available");const t=o();d(t,"metric_testing_aa","exp-aa-experiment"),d(t,"internal_aa","exp-aa-experiment-internal")}e.exports={impressionForAAExperiment:function(){i(),l("initialized, calling whenAvaialable"),a(f,5e3)}}},148:e=>{.exports.fireImpression=async function(e,n,r,o){if(!t(e)||!t(n)||!t(r))return console.error("ab-impression not well defined input parameter for the fireImpression method"),!1;let i=null;o&&(o.pageName&&o.pageSection&&o.pageStage?i=o:console.error("Page parameters format is wrong"));try{return await async function(e,t,n,r){let o={experimentName:e,variationName:t,nonInteraction:1,optimizelySdkKey:n,impressionEventVersion:2};&&(o={...o,pageName:r.pageName,pageSection:r.pageSection,pageStage:r.pageStage}),window&&window.tracking&&window.tracking.track?i(o):window.addEventListener("trackingReady",()}(e,n,r,i),!0}catch(e){return console.error(`Error sending impression: ${e}`),!1}}},977:(e,t,n)=>{"use strict";unction o(){var e;let t=null===(e=null===window||void 0===window?void 0:window.tracking)||void 0===e?void 0:e.visit();if(t)return t;const n=document.cookie.split(";").find(();return n&&(t=n.split("=")[1].trim()),t}n.r(t),n.d(t,{getAllExperiments:()=>v,getVariation:()=>p,initialize:()=>u,isAvailable:()=>d,whenAvailable:);const i=()=>(null===window||void 0===window?void 0:window.abReader)||{getVariation:getAllExperiments:isAvailable:;let a={};const c=function(){const e=e=>r(this,void 0,void 0,(function*(){return yield fetch(function(e){let t="https://endpoint1.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV0g2tKx_W3bClZ2AFy5A6Qm6p3SMABjYasCxtKOoSDSUz_J7rmKVIRxgRAJ6sn-OZjYmTbbdkGGD2lnWr9lIzj-sESQRQDX7x5h4Fxsp6nI4A==";return("localhost"===e||e.startsWith("staging"))&&(t="https://endpoint1.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV0dMTNP6vKpR5bvfATTE9UlwwTguYtz4F6mtpERUrZ5IWyFvjfmUSj-M73Phbv7JURISTMzhN3nPelI7FG-hkH1yrugMm06jK193TF2hATLRw=="),t}(window.location.hostname),{method:"POST",body:e,headers:{"Content-Type":"text/plain"}})}));return{log:t=>r(this,void 0,void 0,(function*(){try{yield e("string"==typeof t?t:JSON.stringify(Object.assign(Object.assign({},t),{host:window.location.href,agent:window.navigator.userAgent,component:"ab-reader",visit:o(),version:"3.0.5"})))}catch(e){console.error("ab-reader failed sending logs",null==e?void 0:e.message)}}))}}(),s="ab-script-loaded",u=()=>{if(a={},m())return;if(window.abReaderInitialized)return;const e=document.createElement("script");e.type="application/javascript",e.async=!0,e.src=function(e){let t="https://wexp.exp.vpsvc.com/experimentation/ab-lib/ab-reader.js";try{let n=e.match(/vistaprint\.[a-z]{2,3}(\.[a-z]{2,3})?/);return n&&n[0]&&(t=`https://www.${n[0]}/experimentation/ab-lib/ab-reader.js`),("localhost"===e||e.startsWith("staging.vistaprint"))&&(t="https://staging.vistaprint.com/experimentation/ab-lib/ab-reader.js"),t}catch(n){return b({message:`There was an error trying to get the script source for the following hostname: '${e}'`}),t}}(window.location.hostname),e.onload=document.head.appendChild(e),window.abReaderInitialized=!0},l=(e,t,n)=>{try{return e()}catch(e){b({message:`ab-reader library failed when calling ${t}.`,error:JSON.stringify(e)})}return n},d=()=>!!g("isAvailable")&&f(),f=()=>l((()=>{var e,t;return null!==(t=null===(e=window.abReader)||void 0===e?void 0:e.isAvailable())&&void 0!==t&&t}),"isAvailable",!1),p=e=>w("getVariation",e)?l((,"getVariation",null):null,v=()=>w("getAllExperiments")?l(i().getAllExperiments,"getAllExperiments",[]):[],h=(e,t)=>{const n="variationsResolved",r=()=>{window.removeEventListener(n,r),e(f())},o=()=>{window.removeEventListener(s,o),f()?e(!0):i()},i=()=>{var e;window.addEventListener(n,r),t&&(e=t,new Promise(()).then(()};f()?e(!0):window.abReader?i():window.addEventListener(s,o)},m=g=(e,t)=>{if(m())return!1;const n=t?` with experiment key [${t}]`:"";return!!window.abReaderInitialized||(b({message:`Library not initialized before using method ${e}${n}.`}),!1)},w=(e,t)=>{if(!g(e,t))return!1;const n=t?` with experiment key [${t}]`:"";return void 0!==window.abReader||(b({message:`ab-reader library not ready before using method ${e}${n}.`}),!1)};function b(e){const t="string"==typeof e?e:e.message;a[t]||(c.log(e),a[t]=1)}},548:(e,t,n)=>{const r=n(378),o=n(614),i=n(849),a=new(n(178))(r.set,r.get,o.v4,i.getRootCookieDomain);e.exports={ensureUserTestId:},178:e=>{const t="optimizelyEndUserId";.prototype.ensureUserTestId=function(){var e=this.getCookie(t);if(e)return e;e=this.getUuid();const n={domain:this.getRootCookieDomain(),expires:180};return this.setCookie(t,e,n),e},e.exports=n},849:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getCurrentDomain:()=>m,getCurrentTenant:()=>d,getCurrentTenantOrDefault:()=>l,getRootCookieDomain:()=>g});const r=function(){var e=window&&window.location&&window.location.hostname;if(!e||0===e.length)throw new Error("Hostname could not be determined for the current document.");return e},o=function(){var e=window&&window.document;if(!e)throw new Error("DOM document could not be determined.");return e};var i="vistaprint",a="promotique",c=[i,"vista",a],s=["masken","mondkapjes","masks","masker","maskit","masque","mascherine","munnbind","mascaras","mascarillas","munskydd"],u=["touch-free-payments"],l=function(e){var t=window&&window.location&&window.location.pathname;if(t&&"/"!==t)for(var n=t.split("/"),o=0;o<n.length;o+=1){if(-1!==s.indexOf(n[o].toLowerCase()))return"masks";if(-1!==u.indexOf(n[o].toLowerCase()))return"paypal"}var l=r().split(".").slice(-3);if(l[0]&&"brandstore"===l[0].toLocaleLowerCase()&&l[1]===i)return a;if(l[0]&&"novelty"===l[0].toLocaleLowerCase()&&l[1]===i)return a;for(var d=l.length-1;d>=0;d-=1)if(-1!==c.indexOf(l[d]))return l[d];return e},d=f="top_level_domain_resolution",p=null,v=function(e,t,n,r){var i=n.toUTCString();o().cookie=e+"="+t+";expires="+i+";path=/;domain="+r},h=function(){var e,t,n,i=r().split("."),a=new Date;a.setTime(a.getTime()+5e3);for(var c=i.length-1;c>=0;c-=1){var s=i.slice(c).join(".");if(v(f,"1",a,s),o().cookie.indexOf(f)>-1)return e=f,t=s,void 0,n=new Date(1970),v(e,"",n,t),s}return null},m=function(){return p||(p=h())},g=function(){var e=h();if(e&&"localhost"!==e)return new RegExp(/^[0-9.]+$/).test(e)?e:"."+e}},506:(e,t,n)=>{const r=n(378),{deserialize:o,deserializeCF:i}=n(630),a="puc-ctc",c="userContext",s=()=>{const e=r.get(c);if(!e){const e=r.get(a);return e?o(e):(console.warn("ctc-reader: Context cookie are missing. If you are developing locally check the readme;)"),[])}return i(e)};function u(){try{return!!r.get(c)||!!r.get(a)}catch(e){return console.warn("ctc-reader in isAvailable failed.",e),!1}}e.exports={isTreatmentEnabled:e=>{try{return s().includes(e)}catch(e){console.warn("ctc-reader in isTreatmentEnabled failed.",e)}},getAllTreatments:()=>{try{return s()}catch(e){return console.warn("ctc-reader in getAllTreatments failed.",e),[]}},isAvailable:u,whenAvailable:function(e){const t=u()?e():window.addEventListener("treatmentsResolved",t)}}},630:e=>{e.exports.deserialize=e=>e.split(",").map((e=>e.trim())).filter((e=>""!=e)),e.exports.deserializeCF=e=>{const t=JSON.parse(decodeURIComponent(e));return t.ctc&&t.ctc.v1?t.ctc.v1:[]}},844:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getCurrentCountry:()=>c,getCurrentCulture:()=>a});var r=function(){var e=("undefined"!=typeof window?window.location:void 0)&&window.location.hostname;if(!e||0===e.length)throw new Error("Hostname could not be determined for the current document.");return e},o=function(){return("undefined"!=typeof window?window.location:void 0)&&window.location.pathname||"/"},i=function(e,t){switch(("localhost"===e?"IE":"vista.com"===e?"/"===t?"us":t.substr(1,2):function(e){if(!e||0===e.length)throw new Error("Domain must be specified");var t=e.split(".");if(t.length<2)throw new Error("Domain '"+e+"' does hot have the right format.");return t.pop()}(e)).toLowerCase()){case"pt":return"PT";case"ie":return"IE";case"es":return"ES";case"in":return"IN";case"jp":return"JP";case"com":case"us":return"US";case"fr":return"FR";case"it":return"IT";case"uk":return"GB";case"de":return"DE";case"nl":return"NL";case"dk":return"DK";case"se":return"SE";case"at":return"AT";case"no":return"NO";case"fi":return"FI";case"be":return"BE";case"sg":return"SG";case"nz":return"NZ";case"au":return"AU";case"ca":return"CA";case"ch":return"CH"}throw new Error("Unknown country for host "+e+" and path "+t)},a=function(){return function(e,t){var n;switch(i(e,t).toUpperCase()){case"PT":return"pt-PT";case"IE":return"en-IE";case"ES":return"es-ES";case"IN":return"en-IN";case"US":return(n=t.toLowerCase()).startsWith("/es")||n.startsWith("/us/es")?"es-US":"en-US";case"GB":return"en-GB";case"FR":return"fr-FR";case"IT":return"it-IT";case"DE":return"de-DE";case"NL":return"nl-NL";case"DK":return"da-DK";case"SE":return"sv-SE";case"AT":return"de-AT";case"NO":return"nb-NO";case"FI":return"fi-FI";case"BE":return function(e){var t=e.toLowerCase();return t.startsWith("/fr")||t.startsWith("/fr-be")?"fr-BE":"nl-BE"}(t);case"SG":return"en-SG";case"JP":return"ja-JP";case"NZ":return"en-NZ";case"AU":return"en-AU";case"CA":return function(e){var t=e.toLowerCase();return t.startsWith("/fr")||t.startsWith("/ca/fr")?"fr-CA":"en-CA"}(t);case"CH":return function(e){var t=e.toLowerCase();return t.startsWith("/fr")?"fr-CH":t.startsWith("/it")?"it-CH":"de-CH"}(t)}throw new Error("Unknown culture for host "+e+" and path "+t)}(r(),o())},c=function(){var e=r(),t=o();return i(e,t)}},242:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getCurrentDomain:()=>m,getCurrentTenant:()=>d,getRootCookieDomain:()=>g});const r=function(){var e=window&&window.location&&window.location.hostname;if(!e||0===e.length)throw new Error("Hostname could not be determined for the current document.");return e},o=function(){var e=window&&window.document;if(!e)throw new Error("DOM document could not be determined.");return e};var i="vistaprint",a="promotique",c={vistaprint:i,vpsvc:i,localhost:i,vista:"vista",promotique:a},s=["brandstore.vistaprint.in","novelty.vistaprint.jp"],u=["masken","mondkapjes","masks","masker","maskit","masque","mascherine","munnbind","mascaras","mascarillas","munskydd"],l=["touch-free-payments"],d=function(){return function(e,t){if(t&&"/"!==t)for(var n=t.split("/"),r=0;r<n.length;r+=1){if(-1!==u.indexOf(n[r].toLowerCase()))return"masks";if(-1!==l.indexOf(n[r].toLowerCase()))return"paypal"}for(var o=e.split(".").slice(-3),i=0,d=s;i<d.length;i++){var f=d[i];if(e.endsWith(f))return a}for(var p=o.length-1;p>=0;p-=1)if(null!=c[o[p]])return c[o[p]];throw new Error("Could not resolve tenant for host "+e+" and path "+t)}(r(),window&&window.location&&window.location.pathname)},f="top_level_domain_resolution",p=null,v=function(e,t,n,r){var i=n.toUTCString();o().cookie=e+"="+t+";expires="+i+";path=/;domain="+r},h=function(){var e,t,n,i=r().split("."),a=new Date;a.setTime(a.getTime()+5e3);for(var c=i.length-1;c>=0;c-=1){var s=i.slice(c).join(".");if(v(f,"1",a,s),o().cookie.indexOf(f)>-1)return e=f,t=s,void 0,n=new Date(1970),v(e,"",n,t),s}return null},m=g=function(){var e=h();if(e&&"localhost"!==e)return new RegExp(/^[0-9.]+$/).test(e)?e:"."+e}},765:(e,t,n)=>{const r=n(378),{deserialize:o,deserializeCF:i}=n(170),a="puc-up",c="userContext",s=()=>{const e=r.get(c);if(!e){const e=r.get(a);return e?o(e):(console.warn("up-reader: Context cookie are missing. If you are developing locally check the readme;)"),{})}return i(e)};e.exports={getTrait:e=>{try{return s()[e]}catch(e){console.warn("up-reader in getTrait failed.",e)}},getAllTraits:()=>{try{return s()}catch(e){return console.warn("up-reader in getAllTraits failed.",e),{}}},isAvailable:function(){try{return!!r.get(c)||!!r.get(a)}catch(e){return console.warn("up-reader in isAvailable failed.",e),!1}}}},170:e=>{e.exports.deserialize=e=>{const t={};return decodeURIComponent(e).split(",").map(().filter(().forEach((n=>{const r=n.split(":");if(2!=r.length)throw new Error("malformed puc-up cookie",e);t[r[0]]=r[1]})),t},e.exports.deserializeCF=e=>{const t=JSON.parse(decodeURIComponent(e));return t.userProfile&&t.userProfile.v1?t.userProfile.v1:{}}},394:(e,t,n)=>{var r=n(986).setPermanentCookie;e.exports={setCanonicalId:function(e){var t=window&&window.vp&&window.vp.auth&&window.vp.auth.cache&&window.vp.auth.cache.canonicalId;t&&(e.addCommonData({canonicalId:t}),r("uc_id",t))}}},144:(e,t,n)=>{"use strict";function r(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var o=v((function(e){var t=h(),n=[],r=Object.keys(t).filter(().map((function(e){return t[e].length+e.length})).reduce((function(e,t){return e+t}),0),o=Object.keys(t).map(().reduce((,0);return n.push({message:"Cookie size",allCookieSize:o,contextCookieSize:r}),f((function(){if(n.length)return u(e.logBatch(n))}))}));function i(){}var a=v((function(e){var t,n,o=!1,i=h("userContext");return t=function(t){return o?t:m(c((,(function(){return u(e.log({message:"Malformed context cookie",contextCookie:i}))})))},(n=function(){if(!i)return r(e.log({message:"Missing context cookie."}),(function(){o=!0}))}())&&n.then?n.then(t):t(n)}));function c(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var s=v((function(e){var t=p();return e.addCommonData({culture:t,visitId:h("visit")}),m(c((function(){return r(o(e),(function(){return u(a(e))}))}),(function(t){return u(e.log({message:"Cloudflare logging failed",error:t.message}))})))}));function u(e,t){if(!t)return e&&e.then?e.then(i):Promise.resolve()}var l=v((function(e,t,n){return r(fetch(n,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},method:"post"}),(function(e){return f((function(){if(200!==e.status){var n="";return a=function(){return u(t.log({message:"Cloudflare invocation failed on: ".concat(e.status,"."),body:n}))},(o=c((function(){return r(e.text(),()}),i))&&o.then?o.then(a):a()}var o,a}))}))})),d=v((function(e,t,n,o){return c((function(){if(window&&window.location&&!window.location.hostname.includes("gallery."))return r(l(e,t,"https://".concat(window.location.hostname,"/context-update?requestor_url=").concat(encodeURIComponent(window.location.href),"&force_update=").concat(n,"&merge_canonical_id=").concat(o)),()}),(function(e){return u(t.log({message:"Cloudflare invocation failed on: ".concat(e.message,". ").concat(e)}))}))}));ar p=n(844).getCurrentCulture;function v(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var h=n(986).getCookie;function m(e){if(e&&e.then)return e.then(i)}var g=n(319).publish,w=n(506);t.invokeCloudflare=d,t.monitorCloudflarePerformance=s},986:(e,t,n)=>{"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=n(242),a=n(808).withConverter({read:function(e,t){return decodeURIComponent(e)},write:);e.exports={getCookie:deleteCookie:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.remove(e,{path:"/"},t))},setPermanentCookie:function(e,t){var n=i.getRootCookieDomain();a.set(e,t,{domain:n,expires:30})}}},319:(e,t,n)=>{"use strict";var r=n(638);e.exports={publish:},468:(e,t,n)=>{"use strict";ar o=a((function(e){var t,n,o=!1,i=h.isTreatmentEnabled("site_tagging_new_customer"),a=h.isTreatmentEnabled("site_tagging_repeat_customer");return t=function(e){if(o)return e;var t=i?"New":"Repeat";window.localStorage.setItem("NewOrRepeat",t)},(n=function(){if(i===a)return r(e.log("new and repeat at the same time"),(function(){o=!0}))}())&&n.then?n.then(t):t(n)})),i=a((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(i,a){try{var s=(t=t||p(),u(t),r(f(e,t,!1,n),(function(){return m.initialize(),m.whenAvailable((function(e){v("variationsResolved",e?m.getAllExperiments():[])}),300),c(),r(o(t),()})))}catch(e){return a(e)}return s&&s.then?s.then(void 0,a):s}(0,(function(e){if(t)return l(t.log({message:"Failed on: ".concat(e,"."),error:e?e.message:"empty error"}));console.log("UCI initialize failed: ".concat(e,"."))}))}));function a(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var c=n(248).impressionForAAExperiment;function s(){}var u=n(679).initReaders;function l(e,t){if(!t)return e&&e.then?e.then(s):Promise.resolve()}var d=n(144).monitorCloudflarePerformance,f=n(152).updateUserContext,p=n(26).initLogging,v=n(319).publish,h=n(506),m=n(977);e.exports.initialize=i,e.exports.updateUserContext=f},26:(e,t,n)=>{"use strict"; a=n(147).version;ar s={};function u(){}function l(e,t){if(!t)return e&&e.then?e.then(u):Promise.resolve()}exports.initLogging=function(){var e=c((function(e){return fetch("https://endpoint1.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV3EQ4nQYHTRNXvwIh7wG1qtDo1Cs-Od8UN-1Hh1VZY2ff5bs15kdkmq2i2SLnGbMI9iqBkIucyOxQP39Myz0rWW0WYb7LGdZaihjvO6IV9rCQ==",{method:"POST",body:e,headers:{"Content-Type":"text/plain"}})}));return{log:c((function(t){return f(d((function(){return l(e("string"==typeof t?t:JSON.stringify(o(o({},t),{},{host:window.location.hostname,agent:window.navigator.userAgent,component:"UCI",version:a},s))))}),(function(e){console.error("UCI failed",e?e.message:"")})))})),logBatch:c((function(t){var n=t.map((function(e){return JSON.stringify(o(o({},e),{},{component:"UCI",version:a}))}));return f(d((function(){return l(e(n.join("\n")))}),(function(e){console.error("UCI batch-log failed",e?e.message:"")})))})),addCommonData:}},316:e=>{"use strict";e.exports.getValidToken=function(){try{var e=window.localStorage.getItem("vp-access-token");return null===e?null:JSON.parse(e).value}catch(e){return console.error("failure in UCI when parsing the token",e),null}}},152:(e,t,n)=>{"use strict";function r(){}var o,i=(o=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(r,i){try{var l=(t||(t=s()),u(t),a(c(e,t,n,o)))}catch(e){return i(e)}return l&&l.then?l.then(void 0,i):l}(0,(function(e){return a(t.log({message:"update context failed on: ".concat(e,".")}))})))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(o.apply(this,e))}catch(e){return Promise.reject(e)}});ar c=n(144).invokeCloudflare,s=n(26).initLogging,u=n(394).setCanonicalId;e.exports.updateUserContext=i},679:(e,t,n)=>{"use strict";var r=n(506),o=n(765),i=n(319);e.exports.initReaders=function(){window.ctcReader=r,i.publish("ctcReaderReady"),window.upReader=o,i.publish("upReaderReady")}},638:(e,t,n)=>{var r=n.g.CustomEvent;e.exports=)?r:"undefined"!=typeof document&&"function"==typeof document.createEvent?,378:808:614:147:,t={};.d=n.g=),n.o=n.r=(()=>{"use strict";var e,t=n(468).initialize,r="userIdentity",o=n(316).getValidToken;(e=function(){var e=!1;return function(n,i){try{var a=function(){var n,i,a,c=o();return n=function(){if(null!==c)return n=t(c),r=o?r?r(n):n:(n&&n.then||(n=Promise.resolve(n)),r?n.then(r):n);var n,r,o},i=function(n){if(e)return n;window.addEventListener(r,(function e(n){var o=n.detail;o&&o.accessToken&&(window.removeEventListener(r,e),t(o.accessToken))}))},(a=n())&&a.then?a.then(i):i(a)}()}catch(e){return i(e)}return a&&a.then?a.then(void 0,i):a}(0,(function(e){console.error("user context initialization failed on: ".concat(e)),window.removeEventListener(r,handleIdentityUpdate)}))},()})()})();