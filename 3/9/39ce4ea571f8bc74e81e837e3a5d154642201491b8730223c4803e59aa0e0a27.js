(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[689,719,731,735],{"/5so":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("QjXU"),a=r("mgFK");function o(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return t.isMsa?[4,Object(a.a)("consumerInstallInfo",e)]:[2,null];case 1:return[2,r.sent()||null]}}))}))}},"0TX8":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("QjXU"),a=r("JYsJ");function o(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:e.params||(e.params={}),e.params.workload=r,(i=Object(a.a)("flight"))&&(e.params.flight=i),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,o()];case 2:return(c=n.sent())&&(e.headers||(e.headers={}),e.headers["X-OfficeHome-UserId"]=c.puid,e.headers["X-OfficeHome-TenantId"]=c.tenantId,c.authVersion&&(e.headers["X-OfficeHome-AuthVersion"]=c.authVersion),e.params[t?"mockauth":"auth"]=c.isMsa?"1":"2"),[3,4];case 3:return n.sent(),[3,4];case 4:return[2,e]}}))}))}},"5ANk":function(e,t,r){"use strict";.d(t,"a",(function(){return n}))},"D/tM":E7ar:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("tjsK");function a(e){try{return function(e){var t=document.getElementById(e),r=t&&t.textContent;return r?JSON.parse(r):void 0}(e)}catch(t){throw new n.a("Failure to parse "+e+" from response",t)}}},JYsJ:function(e,t,r){"use strict";.d(t,"a",(function(){return n}))},MJsD:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("QjXU"),a=r("B5kz"),o=r("zPZ9");function i(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){return[2,a.a.fetchQuery(["OfficeComponentContext"],(function(){return o.a}),{cacheTime:1/0,staleTime:1/0})]}))}))}},Ohvh:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("6ib3"),a={none:n.a.None,excel:n.a.Excel,onenote:n.a.OneNote,pdf:n.a.Pdf,powerpoint:n.a.PowerPoint,audio:n.a.Audio,video:n.a.Video,visio:n.a.Visio,word:n.a.Word,photos:n.a.Photos,text:n.a.Text,outlook:n.a.Outlook,sway:n.a.Sway,forms:n.a.Forms,formsquiz:n.a.FormsQuiz,project:n.a.Project,projectoperations:n.a.ProjectOperations,portfolio:n.a.Portfolio,news:n.a.NewsArticle,newsarticle:n.a.NewsArticle,onedrive:n.a.OneDrive,sharepoint:n.a.SharePoint,bohemia:n.a.Fluid,fluid:n.a.Fluid,powerbi:n.a.PowerBI,streamsvideo:n.a.StreamsVideo,yammer:n.a.Yammer,mindmeister:n.a.MindMeister,stream:n.a.Stream,monday:n.a.Monday,trello:n.a.Trello,platform:n.a.Platform,image:n.a.Image,media:n.a.Media,whiteboard:n.a.Whiteboard,meetingnotes:n.a.MeetingNotes,screenrecording:n.a.ScreenRecording,designer:n.a.Designer,list:n.a.List,clipchamp:n.a.Clipchamp};,W7wX:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("QjXU"),a=r("MJsD"),o=r("B5kz");function i(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(a.a)()];case 1:return e=t.sent(),[2,o.a.fetchQuery(["Identity"],(,{cacheTime:1/0,staleTime:1/0})]}}))}))}},WJ2C:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("QjXU"),a=r("MJsD"),o=r("B5kz"),i=r("W7wX"),c=r("/5so");function s(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(a.a)()];case 1:return e=r.sent(),[4,Object(i.a)()];case 2:return t=r.sent(),[2,o.a.fetchQuery(["ConsumerInstallInfoConfig"],(,{staleTime:1/0,cacheTime:1/0})]}}))}))}},Wa5Y:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("QjXU"),a=r("kb6k"),o=r("lAHu");function i(e,t,r,i,c,s,u,f,d,l,m,h){void 0===l&&(l={});var v="cache-only"===m;v&&(d="None");var p=Object(n.__assign)(Object(n.__assign)({},i),{url:r,method:"GET"});return Object(a.a)((function(r){return Object(o.a)(e,t,r,u,f,m,l.populateRequestEvent,l.onUploadProgress,l.onDownloadProgress,l.cancellationToken,l.timeoutInMs)}),e,t,p,c,s,d,l.mockParam,l.resourceUrl,l.rpsHeaderPrefix,l.additionalAuthErrors,l.isRetriableError,l.updateRequestWithAuth,v,l.silent,l.capDialogData,h)}},amPu:function(e,t,r){"use strict";function n(e,t,r){return e&&e.success?(t||(t={}),t.Authorization="".concat("RPSCompact"===e.format?r||"":"Bearer ").concat(e.token).trim(),t):null!=t?t:{}}r.d(t,"a",(function(){return n}))},"fTj/":function(e,t,r){"use strict";r.r(t),r.d(t,"getInstalledApp",(function(){return n.a})),r.d(t,"getInstalledAppsEx",(function(){return a.a})),r.d(t,"getLocalMru",(function(){return j})),r.d(t,"launchOfficeApp",(function(){return g.a})),r.d(t,"launchUri",(),r.d(t,"getDeviceId",(function(){return S})),r.d(t,"isSurfaceDevice",(function(){return _}));var n=r("W1wp"),a=r("vhka"),o=r("QjXU"),i=r("6ib3"),c=r("cenr"),s=r("a3FV"),u=r("8/lW"),f=r("Dn7E"),d=r("CMIS"),l=r("gY3Z");ar h=r("rjBA"),v=r("tBub"),p=r("Ohvh"),b=r("5ANk"),O=r("CKW3"),w=0;function j(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,r,a,j,g;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Object(O.a)()];case 1:return t=o.sent(),r=e?Array.from(e).map(().join(","):"",a=[{method:"LocalProviders.GetMruLocalDocuments",data:{apps:r}}],j=performance.now(),[2,new Promise((function(e,r){t.sendCommands(a).then((function(t){if(g=Object(l.a)(j),0!==t.status)throw new Error("Error in response: "+t.status);var r=JSON.parse(t.message["LocalProviders.GetMruLocalDocuments"]).mru.filter(m),a=function(){e(function(e){return e.map((function(e){var t=e.location.split("\\"),r=t.length>1?t[t.length-2]:"",n=e.location.substring(0,e.location.lastIndexOf("\\")),a=new Date(e.lastAccessedDate),o=e.applicationName.charAt(0).toUpperCase()+e.applicationName.substring(1),i=e.name.replace(/\0/gi,"").trim(),c=Object(h.a)(i),s=Object(v.a)(i),u="LocalBridgeFile:".concat(Object(b.a)());return{app:o,attribution:r,attributionUrl:n,canonicalUrl:e.location,containerTitle:r,createdDate:a,docId:"",driveId:"",extension:s,fileName:i,fileType:Object(p.a)(e.applicationName),id:u,isLocalFile:!0,isPinned:!1,isRedeemed:!0,lastAccessedTime:a,lastActionTime:a,lastModifiedTime:a,pathArray:[r],title:c,url:e.location,webUrl:void 0}}))}(r));var t={State:"Success"};t.Index=w.toString(),t.Latency=g.toString(),Object(c.a)(s.a.LocalMruFetch,t,[],u.a.Enhanced),Object(f.a)({featureName:"LocalMRU",eventName:"Parsed_Local_Documents",params:{state:"Success",index:w,latency:g}}),w++},o=function(){return r=r.filter((function(e){return e.applicationName.toLowerCase()!==i.a.OneNote.toLowerCase()}))};return Object(n.a)(i.a.OneNote).then((,()})).catch((function(e){g=g||Object(l.a)(j);var t={State:"Failed"};t.Error="getLocalMru failed: "+e,t.Index=(w++).toString(),t.Latency=g.toString(),Object(c.a)(s.a.LocalMruFetch,t,[],u.a.Enhanced),Object(d.a)({eventName:"Local_MRU_Fetch_Failed",errorType:"AppService_Error",message:e}),r("Local MRU failed")}))}))]}}))}))}var g=r("1R5x"),y=r("0mcE");function S(){try{if("undefined"!=typeof Windows&&void 0!==Windows.System.Profile.SystemIdentification&&void 0!==Windows.Security.Cryptography.CryptographicBuffer){var e=Windows.System.Profile.SystemIdentification.getSystemIdForPublisher();return void 0!==e&&e.id?Windows.Security.Cryptography.CryptographicBuffer.encodeToHexString(e.id):""}return""}catch(e){var t="Error in getDeviceId: ".concat(e);return Object(d.a)({eventName:"GetDeviceId",message:t}),""}}var x=r("muUJ");function _(){var e;try{if("undefined"!=typeof Windows&&void 0!==Windows.System.Profile.SystemManufacturers.SystemSupportInfo&&void 0!==Windows.System.Profile.SystemManufacturers.SystemSupportInfo.localDeviceInfo){var t=Windows.System.Profile.SystemManufacturers.SystemSupportInfo.localDeviceInfo.systemManufacturer,r=Windows.System.Profile.SystemManufacturers.SystemSupportInfo.localDeviceInfo.systemProductName;if(t&&r)return t.toLowerCase().indexOf("microsoft")>=0&&r.toLowerCase().indexOf("surface")>=0}return!1}catch(t){var n="Error in isSurfaceDevice: ".concat(t);return Object(x.a)(s.a.SurfaceDeviceDetectionError,((e={}).Error=n,e)),Object(d.a)({eventName:"Surface_Device_Detection_Error",message:n}),!1}}},kb6k:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("QjXU"),a=r("yOLj"),o=r("tyUq"),i=r("GMuP"),c=r("JYsJ"),s=r("amPu"),u=[0,11,22,33];function f(e,t,r,n){e&&(e.headers=Object(s.a)(t,e.headers,r),n&&n(e,t))}function d(e,t,r,s,d,l,m,h,v,p,b,O,w,j,g,y,S){return void 0===j&&(j=!1),new Promise((function(x,_){var P=m||"None",N="None"===P||"OfficeHome"===P&&!d,I=b||new Set;I.add(401);var M=function(e){var n=e.status,i=Number.NaN;!N&&I.has(n)?i=701:O&&O(n)&&(i=703),i!==Number.NaN&&(Object(a.a)(t,i,-1,"",j),Object(o.a)({eventName:r,fromCache:j,httpCode:i,latency:-1,error:""})),_({httpResponse:e})};if(h){var C=Object(c.a)(h);C&&(s.headers||(s.headers={}),s.headers["ohp-mock"]=C)}(N?Promise.resolve(void 0):l(P,!1,v,S,void 0,void 0,g,y)).then((function(c){if(!N){if(!c||!c.success){var d=c?c.error:"";return Object(a.a)(t,702,-1,"string"==typeof d?d:"",j),Object(o.a)({eventName:r,fromCache:j,httpCode:702,latency:-1,error:"string"==typeof d?d:""}),void _({httpResponse:{data:"CAP_Error"===d?d:null,status:702,headers:{},ok:!1,statusText:"Failed to fetch access token",fromCache:!1}})}f(s,c,p,w)}e(s).then(x,(function(t){if(!N&&I.has(t.status)){var r=function(e){var t,r,a=null===(r=Object.entries(e).find((function(e){return"www-authenticate"===Object(n.__read)(e,1)[0].toLowerCase()})))||void 0===r?void 0:r[1];if(null==a?void 0:a.includes("insufficient_claims")){var o=a.match(/claims=\"(\S+)\"/);if(o)return o[1];Object(i.a)({eventName:"Extract_ClaimsChallenge_Error",params:(t={},t.Error="Failed to extract insufficient claims value",t)})}return""}(t.headers);l(P,!0,v,void 0,!1,void 0,void 0,void 0,r).then((function(r){r.success?(f(s,r,p,w),e(s).then(x,M)):M(t)}))}else O&&O(t.status)?function(t,r){var n=r.headers),a=function(){var e=Math.floor(1e3*Math.random())%u.length;return u[e]}();n&&(a=Math.ceil(1e3*parseFloat(n||"0"))),setTimeout((,a)}(s,t):_({httpResponse:t})}))}))}))}},lAHu:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("c/bn"),a=r("JYsJ");function o(e,t,r,o,i,c,s,u,f,d,l){var m="".concat(o,"/");return r.url.startsWith("http")&&!m.startsWith("http")&&(m="".concat(window.location.origin,"/").concat(m)),0===r.url.lastIndexOf(m,0)&&function(e,t){e.headers||(e.headers={}),e.headers["X-OfficeHome-CorrelationId"]=t;var r=Object(a.a)("testtraffic");r&&(e.headers["X-OfficeHome-TestTraffic"]=r)}(r,i),Object(n.a)(e,t,r,c,s,u,f,d,l)}},mgFK:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("QjXU"),a=r("E7ar"),o=r("8wW2"),i=r("a3FV"),c=r("0TX8"),s=r("Wa5Y"),u=new Map;function f(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,a,u,f;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t.disableLegacyNetworkConfigs?[2,void 0]:(r=new URL("".concat(t.officeHomeApiRoot,"/api/config/").concat(e),window.location.origin),a={},[4,Object(c.a)(a,t.inMockMode,t.workload,t.getIdentity)]);case 1:return n.sent(),window.location.search&&(u=new URLSearchParams(window.location.search),a.params||(a.params={}),t.inMockMode?u.forEach(():u.has("scenarioid")&&(f=u.get("scenarioid"),a.params.scenarioid=null!=f?f:"")),[2,Object(s.a)(i.a.ConfigRequest,"Config",r.toString(),a,t.jwtAuthEnabled,t.getAccessToken,t.officeHomeApiRoot,t.correlationId,"OfficeHome",{populateRequestEvent:).then(().catch((function(e){Object(o.a)().handleError(e)}))]}}))}))}function d(e,t){var r=this;if(u.has(e))return u.get(e);var o=new Promise((function(o){return Object(n.__awaiter)(r,void 0,void 0,(function(){var r,i,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:r=void 0,n.label=1;case 1:return n.trys.push([1,5,,6]),(i=window.shellAndConfigResponse)?[4,i]:[3,3];case 2:if((c=n.sent())&&c[e]){try{o(JSON.parse(c[e]))}catch(t){o(c[e])}return[2]}return[3,4];case 3:if(r=Object(a.a)(e))return o(r),[2];n.label=4;case 4:return[3,6];case 5:return n.sent(),[3,6];case 6:return[4,f(e,t)];case 7:return r=n.sent(),o(r),[2]}}))}))}));return u.set(e,o),o}},rjBA:function(e,t,r){"use strict";function n(e){if(!e)return e;var t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)}r.d(t,"a",(function(){return n}))},tBub:function(e,t,r){"use strict";function n(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)}r.d(t,"a",(function(){return n}))},yOLj:function(e,t,r){"use strict";r.d(t,"a",();var n=r("8/lW"),a=r("ntFm");function o(e,t,r,o,i,c,s,u){void 0===i&&(i=!1),void 0===c&&(c={}),void 0===s&&(s=[]),void 0===u&&(u=n.a.Security),Object(a.a)(e,t,r,o,i,c,s,u).record()}}}]);
//# sourceMappingURL=689.6ce24fe6debf400513b6.chunk.v7.js.map