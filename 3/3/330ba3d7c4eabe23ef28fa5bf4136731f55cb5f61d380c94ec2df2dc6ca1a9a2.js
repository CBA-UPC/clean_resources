/*! For license information please see 1286.d83a19a8.chunk.js.LICENSE.txt */
(self.webpackChunkphotobucket_web=self.webpackChunkphotobucket_web||[]).push([[1286],{60190:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ke}});var r=t(61113),i=t(16031),o=t(17455),a=t(66271),s=t(29439),l=t(90297),c=t(17592),u=t(24813),d=t(57829),h=t(20201),f=t(47313),v=t(2655),m=(t(62599),t(58467)),p=t(91345),x=t(25258),g=t(52386),b=t(13549),Z=t(69883),j=t(66713),w=t(47131),y=t(46417),k=(0,c.ZP)(w.Z)((function(){return{position:"absolute",top:"50%",marginTop:-28,width:56,height:56,backgroundColor:"rgba(238,238,238, 0.5)",zIndex:1,"&:hover":{backgroundColor:"#eeeeee"}}}));function S(e,n,t){return n?(0,y.jsx)(k,{onClick:e,"aria-label":t,style:{left:12},"data-test":"prev-img",children:(0,y.jsx)(Z.Z,{})}):null}function T(e,n,t){return n?(0,y.jsx)(k,{onClick:e,"aria-label":t,style:{right:12},"data-test":"next-img",children:(0,y.jsx)(j.Z,{})}):null}var C=t(1413),M=t(99091),P=t(28662),I=t(15861),z=t(64687),E=t.n(z),L=t(72668),R=t(6965),U=t(28422),B=(0,c.ZP)("img",{shouldForwardProp:)((function(e){var n=e.isLoading;return{display:n?"none":void 0,userSelect:n?"none":void 0,WebkitTouchCallout:n?"none":void 0,objectFit:"contain",width:"100%",height:"100%"}})),F=(0,c.ZP)("video")((),H=(0,c.ZP)("div")((),N=(0,c.ZP)(w.Z)((function(){return{zIndex:11,position:"absolute",cursor:"pointer",top:0,bottom:0,left:0,right:0,margin:"auto",padding:"5px 10px",backgroundColor:"rgba(0,0,0,0.6)",width:"56px",height:"56px",borderRadius:"5px","& svg":{color:"white",width:"45px",height:"45px"}}}));function A(e){var n=e.media,t=(0,f.useRef)(null),r=(0,f.useRef)(null),i=(0,f.useState)(!1),o=(0,s.Z)(i,2),a=o[0],l=o[1],c=(0,f.useState)(!0),u=(0,s.Z)(c,2),d=u[0],h=u[1],v=(0,f.useState)(null),m=(0,s.Z)(v,2),p=m[0],g=m[1],Z=(0,L.a)(U.NJ7,{variables:{bucketId:n.bucketId,mediaId:n.id}}),j=Z.loading,w=Z.data;(0,f.useEffect)((function(){var e;null!==w&&void 0!==w&&null!==(e=w.bucketMedia)&&void 0!==e&&e.signedUrl&&g(w.bucketMedia.signedUrl)}),[w]);var k=(0,b.Z)(n),S=null===n||void 0===n?void 0:n.imageUrl;(0,f.useEffect)((function(){return h(!0)}),[n]),(0,f.useEffect)((function(){return l(!1)}),[n]);var T=(0,f.useCallback)((0,I.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.current||!p){e.next=10;break}return r.current.src=p,e.prev=2,e.next=5,r.current.play();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),x.Z.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[2,7]])}))),[p,r]),C=(0,f.useCallback)((function(){if(r.current)try{r.current.pause()}catch(e){x.Z.error(e)}}),[]),M=(0,f.useCallback)((,[C]);(0,f.useEffect)((,[a,M,T]);var z=function(e){e.stopPropagation(),e.currentTarget.src=P.h,x.Z.warn("There was an error while trying to play video")},A=function(){return h(!1)};return(0,f.useEffect)((function(){var e;null!==t&&void 0!==t&&null!==(e=t.current)&&void 0!==e&&e.complete&&A()}),[n]),a?(0,y.jsx)(H,{children:(0,y.jsxs)(F,{ref:r,onEnded:M,controls:!0,children:[(0,y.jsx)("track",{kind:"captions"}),p&&(0,y.jsx)("source",{src:p}),(0,y.jsx)("p",{children:"Your browser does not support HTML5 video."})]})}):(0,y.jsxs)(H,{children:[(0,y.jsx)(N,{onClick:function(){return l(!0)},size:"large",disabled:j,children:(0,y.jsx)(R.Z,{})}),d&&(0,y.jsx)(B,{id:"thumbnail-image",isLoading:d,src:k,srcSet:k,alt:n.originalFilename||"",onError:z}),S&&(0,y.jsx)(B,{ref:t,id:"full-image",isLoading:d,src:S,alt:n.originalFilename||"",onError:z,onLoad:A})]})}var D=t(57350),O=t(96628),V=t(36241),q=V.isMobile?-.15:.15,W=(0,D.createUseGesture)([O.e,O.f,O.w]),G={x:0,y:0,scale:1,rotateZ:0};var Y=(0,c.ZP)("img",{shouldForwardProp:function(e){return"isLoading"!==e&&"isBlurred"!==e}})((function(e){var n=e.isBlurred,t=e.isLoading;return{userSelect:t?"none":void 0,WebkitTouchCallout:t?"none":void 0,objectFit:"contain",filter:n?"blur(5px) brightness(95%)":"none",width:"100%",height:"100%"}}));function _(e){var n,t,r=e.media,o=e.isSelected,a=(0,f.useState)(!0),l=(0,s.Z)(a,2),c=l[0],u=l[1],d=(0,m.TH)(),h=new URLSearchParams(d.search).get("action"),v=null!==(n=null===r||void 0===r?void 0:r.width)&&void 0!==n?n:0,p=null!==(t=null===r||void 0===r?void 0:r.height)&&void 0!==t?t:0,g=function(e){var n=(0,m.s0)(),t=(0,m.TH)(),r=new URLSearchParams(t.search),o=Number(r.get("zoom")||1),a=(0,M.useSpring)((),l=(0,s.Z)(a,2),c=l[0],u=l[1],d=(0,f.useRef)(c.scale),h=(0,f.useRef)(null),v={min:.5,max:3};return(0,f.useEffect)((function(){o>0&&o<=10&&d.current.set(o)}),[o]),W({onDrag:function(e){var n=e.elapsedTime,t=e.pinching,r=(0,s.Z)(e.offset,2),i=r[0],o=r[1];if(!t&&!(n<250))return u.start({x:i,y:o})},onDragEnd:function(e){var r=e.pinching,i=e.elapsedTime;r||i<250&&n("".concat(t.pathname,"?action=focus"))},onPinch:function(e){var n=(0,s.Z)(e.offset,1)[0];V.isMobile&&(h.current?c.scale.set(n):x.Z.error("Invalid imgRef"))},onWheel:function(e){var n=(0,s.Z)(e.delta,2)[1],t=Math.max(.5,c.scale.get()-.01*n);t=Math.min(3,t),u.start({scale:t})}},{target:h,drag:{from:function(){return[c.x.get(),c.y.get()]},bounds:e,rubberband:q},pinch:{scaleBounds:v,bounds:e,rubberband:!0},wheel:{from:function(){return[c.x.get(),c.y.get()]},bounds:e,scaleBounds:v}}),{ref:h,style:c}}({left:-v/2,right:v/2,top:-p/2,bottom:p/2}),b=g.ref,Z=g.style,j=null===r||void 0===r?void 0:r.imageUrl;r.isBanned||!j||"zoom"!==h&&"focus"!==h||(j+="?height=".concat(p,"&width=").concat(v,"&quality=100"));return!r.isBanned&&r.isVideo&&o?(0,y.jsx)(A,{media:r}):j?(0,y.jsx)(M.animated.div,{style:(0,C.Z)({touchAction:"none"},Z),ref:b,children:(0,y.jsx)(Y,{draggable:!1,id:"full-image",isLoading:c,src:j,srcSet:j,alt:r.id,onLoad:ref:b,onError:)}):null}function J(e,n){return(null!==n&&void 0!==n&&n.isPrevious||null!==n&&void 0!==n&&n.isSelected)&&(0,f.isValidElement)(e)?(0,y.jsx)("div",{style:{display:"flex",position:"relative",height:"100%",justifyContent:"center",alignContent:"center",overflow:"hidden"},children:(0,y.jsx)(_,{media:e.props.media,isSelected:!(null===n||void 0===n||!n.isSelected)})}):null}function K(e){return e.map((function(e){return(0,f.isValidElement)(e)?(0,y.jsx)("div",{style:{position:"relative",height:70},children:e},e.key):e}))}var Q=t(28297),X=(0,c.ZP)("img",{shouldForwardProp:)((function(e){var n=e.isBlurred;return{objectFit:e.crop?"cover":"contain",filter:n?"blur(5px) brightness(95%)":"none",width:"100%",height:"100%"}}));function $(e){var n=e.media,t=e.crop,r=(0,m.TH)(),i=(0,m.s0)(),o=n.mediaType.includes("video")?P.h:P.N,a=null!==n&&void 0!==n&&n.filename?(0,b.Z)(n,180):o;n.isBanned&&(a="".concat(Q.ZP.assets.placeholderThumbnail));return(0,y.jsx)(X,{"data-test":"carousel-thumbnail-".concat(n.id),crop:t,isBlurred:!1,id:"thumbnail-image",src:a,srcSet:a,alt:null===n||void 0===n?void 0:n.id,onError:function(e){e.currentTarget.src=n.mediaType.includes("video")?P.h:P.N,e.currentTarget.srcset=n.mediaType.includes("video")?P.h:P.N},onClick:function(){var e=r.pathname.split("/");e.pop(),i("".concat(e.join("/"),"/").concat(n.id))}})}$.defaultProps={crop:!1};var ee=t(8566),ne=t(17189),te=t(72657);function re(e){var n,t=e.index,r=e.style,i=e.data,o=i.items,a=i.current,s=(null===(n=o[t])||void 0===n?void 0:n.id)===(null===a||void 0===a?void 0:a.id);return o[t]?(0,y.jsx)("div",{style:(0,C.Z)((0,C.Z)({},r),{},{border:s?"2px solid #000":"2px solid transparent"}),children:(0,y.jsx)($,{media:o[t],crop:!s})}):null}var ie=(0,f.forwardRef)((function(e,n){var t=e.children,r=e.style,i=e.onScroll;return(0,y.jsx)("div",{"data-test":"thumbnail-list",style:(0,C.Z)((0,C.Z)({},r),{},{overflowY:"hidden"}),onScroll:i,ref:n,children:t})}));function oe(e){var n=e.showThumbs,t=e.items,r=e.current,i=e.fetchMore,o=e.hasMore,a=(0,f.useRef)(null),s=t.findIndex((),l=(0,f.useEffect)((function(){var e,n=-1===s?0:s;null===(e=a.current)||void 0===e||e.scrollToItem(n)}),[s]);var c=function(){var e=(0,I.Z)(E().mark((function e(n,r){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t[r]||i();case 1:case"end":return e.stop()}}),e)})));return ();return n?(0,y.jsx)("div",{style:{position:"relative",height:100},children:(0,y.jsx)(ee.Z,{children:function(e){var n=e.width;return n?(0,y.jsx)(te.Z,{isItemLoaded:l,itemCount:t.length+Number(o),loadMoreItems:c,children:function(e){var i=e.onItemsRendered,o=e.ref;return(0,y.jsx)(ne.t7,{ref:itemData:{items:t,current:r},height:100,itemCount:t.length,itemSize:100,layout:"horizontal",width:n,onItemsRendered:i,outerElementType:ie,initialScrollOffset:100*s,children:re})}}):(0,y.jsx)("div",{})}})}):null}var ae=t(14647),se=t(11198),le=t(75908),ce=t(9289),ue=t(2135),de=t(81578),he=t(61776),fe=t(47196),ve=t(61689);function me(e){var n=e.media,t=(0,g.Z)().selectMedia;return n?(0,y.jsx)(w.Z,{color:"primary",onClick:function(){n&&(t(n.id),(0,p.nt)("bucketMediaDetails"))},id:"persistent-details-button","data-test":"persistent-details-button",children:(0,y.jsx)(ve.Z,{title:"Details",arrow:!0,children:(0,y.jsx)(fe.Z,{})})}):null}var pe=t(70306);function xe(){var e,n=(0,m.s0)(),t=(0,m.TH)(),r=new URLSearchParams(t.search),i=r.get("action"),o=Number(null!==(e=r.get("zoom"))&&void 0!==e?e:1);return(0,y.jsx)(ve.Z,{title:"zoom"===i?"Zoom out":"Zoom in",arrow:!0,children:(0,y.jsx)(w.Z,{color:"primary",onClick:function(){var e=o>=1&&o<5?o+.5:1;n("".concat(t.pathname,"?action=zoom&zoom=").concat(e))},"data-test":"zoom",id:"zoom-button",children:(0,y.jsx)(pe.Z,{})})})}function ge(e){var n=e.media;return n?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(me,{media:n}),(0,y.jsx)(de.Z,{media:n}),(0,y.jsx)(xe,{}),(0,y.jsx)(he.Z,{media:n})]}):null}function be(e){var n=e.media,t=(0,m.TH)(),r=(0,ue.lr)(),o=(0,s.Z)(r,1)[0],a=o.get("action"),l=(0,m.s0)(),c=((0,i.has)(t.state,"returnUri")?t.state:{returnUri:""}).returnUri,u=void 0===c?"":c,d=(0,m.UO)(),h=d.shareId,f=d.mode;return"slideshow"===f||"focus"===a?(0,y.jsx)(ce.Z,{disableGutters:!0,style:{color:"white"},children:(0,y.jsx)(w.Z,{color:"inherit",onClick:function(){var e=t.pathname;"slideshow"===f&&(e=e.substring(0,t.pathname.indexOf("slideshow"))),l(e)},"data-test":"close-slideshow",size:"large",children:(0,y.jsx)(se.Z,{fontSize:"small"})})}):(0,y.jsx)(le.Z,{position:"static",elevation:0,color:"inherit",sx:{color:"primary.main"},children:(0,y.jsxs)(ce.Z,{children:[(0,y.jsx)(w.Z,{onClick:function(){var e,t="";u?t=u:h&&(t="/share/".concat(h));var r,a={};(n&&(a.scrollTo=n.id),o.get("q"))&&(a.q=null!==(r=o.get("q"))&&void 0!==r?r:void 0);(0,i.isEmpty)(a)||(e="?".concat((0,ue.fW)(a))),l({pathname:t,search:e})},children:(0,y.jsx)(ae.Z,{fontSize:"small"})}),(0,y.jsx)("div",{style:{flex:1,display:"flex",justifyContent:"end"},children:(0,y.jsx)(ge,{media:n})})]})})}xe.defaultProps={isZoomMode:!1,handleZoomMode:void 0};var Ze=(0,c.ZP)("div",{shouldForwardProp:)((function(e){var n=e.fullScreen,t=e.focus;return{position:"relative",height:"100vh",backgroundColor:t?"#000":"transparent",width:n||t?"100%":"calc(100% - 400px)",display:"flex",flex:1,flexDirection:"column",transition:"width 225ms",".carousel-root, .carousel, .slider-wrapper, .slider, .slide":{height:"100%",position:"relative",display:"flex",alignItems:"center",maxHeight:t?"90vh":"80vh",width:"100%"}}}));function je(e){var n=e.items,t=e.fetchMore,r=e.hasMore,i=(0,m.TH)(),o=(0,h.Z)(),a=(0,u.Z)(o.breakpoints.down("sm")),c=(0,l.l)(p.nt),Z=(0,g.Z)().selectMedia,j=(0,f.useState)(null),w=(0,s.Z)(j,2),k=w[0],C=w[1],M=new URLSearchParams(i.search).get("action"),P=(0,m.UO)(),I=P.shareId,z=P.mediaId,E=P.mode,L=n.findIndex((function(e){return e.id===z})),R=n.find((),U=-1===L?0:L;(0,f.useEffect)((function(){C((function(e){return!R||e&&e.id===R.id?e:R}))}),[R]);return(0,y.jsxs)(Ze,{focus:"slideshow"===E||"focus"===M,fullScreen:a||!c,children:[(0,y.jsx)(be,{media:k}),(0,y.jsx)(d.Z,{style:{flex:1,position:"relative",display:"flex",alignItems:"center"},children:(0,y.jsx)(v.lr,{axis:"horizontal",onChange:function(e,i){if((0,f.isValidElement)(i)){r&&e>n.length-5&&t();var o=i.props.media;Z(o.id,{replace:!0}),C(o);var a=n[e+1];if(null!==a&&void 0!==a&&a.filename){var s=new Image,l=(0,b.Z)(a);s.src=l}var c="share/".concat(I,"/media/").concat(o.id);x.Z.debug(c)}},renderItem:J,renderThumbs:K,selectedItem:U,showIndicators:!1,showStatus:!1,autoPlay:"slideshow"===E,renderArrowPrev:S,renderArrowNext:T,infiniteLoop:"slideshow"===E,showThumbs:!1,useKeyboardArrows:!0,autoFocus:!0,children:n.map(()})}),(0,y.jsx)(oe,{showThumbs:"focus"!==M&&"slideshow"!==E,current:k,items:n,fetchMore:t,hasMore:r})]})}var we=t(69405);function ye(){var e=(0,we.Z)(),n=e.items,t=e.fetchMore,a=e.nextToken;return e.loading?(0,y.jsx)(o.Z,{}):(0,i.isEmpty)(n)?(0,y.jsx)(r.Z,{align:"center",variant:"h5",sx:{marginTop:12},children:"This share is empty"}):(0,y.jsx)(je,{items:n,fetchMore:t,hasMore:!!a})},69883:70306:46123:]);